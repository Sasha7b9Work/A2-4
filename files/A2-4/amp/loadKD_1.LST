A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN loadKD_1.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE loadKD_1.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1       ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236             
                     237     NAME    MAIN
                     238                     
0000                 239                             org 0h;    cseg AT 0
                     240     
0000 020000   F      241                 jmp begin;!!!!!!!!!!!1Main               ; Locate a jump to the start of code a
                             t 
                     242                                             
0003                 243                                                     org 3
0003 32              244                                                     reti
000B                 245                                                     org 0bh
000B 32              246                                                     reti
0013                 247                                                     org 13h
0013 32              248                                                     reti
001B                 249                                                     org 1bh
001B 32              250                                                     reti
0023                 251                                                     org 23h
0023 32              252                                                     reti
002B                 253                                                     org 2bh
002B 32              254                                                     reti
0033                 255                                                     org 33h
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     5

0033 32              256                                                     reti
003B                 257                                                     org 3bh
003B 32              258                                                     reti
0043                 259                                                     org 43h
0043 32              260                                                     reti
004B                 261                                                     org 4bh
004B 32              262                                                     reti
0053                 263                                                     org 53h
0053 32              264                                                     reti
005B                 265                                                     org 5bh
                     266                                                     
005B 32              267                                                     reti
0063                 268                                                     org 63h
0063 32              269                                                     reti
006B                 270                                                     org 6bh
006B 32              271                                                     reti
0073                 272                                                      org 73h
0073 32              273                                                     reti
                     274     
0093                 275                                                     org     93h
0093 32              276                                                     reti;jmp        keyb1           ;IE6
                     277     
009B                 278                                                     org     9bh
009B 32              279                                                     reti;jmp        keyb2      ;IE7
                     280     
                     281     
                     282     
                     283      
                     284       
                     285     
  00CA               286     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               287     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     288      
                     289                                                     
                     290     Main         SEGMENT  CODE
                     291     
----                 292                                     DSEG
                     293       
  0040               294     bufind  DATA    40h;буффер индикации 12byte     (коды koi и коды букв )
                     295     ;DATA 4ch
  004F               296     abin            DATA    4fh;4byte
  0053               297     adec            DATA    53h;10byte
  006E               298     chmas           DATA    6eh;
  006F               299     mabin           DATA    6fh
  0077               300     reacp           DATA    77h;результат чтения асп 4byte int (hex)
                     301     
                     302       
  003D               303     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               304     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       
                     305             
  0020               306     cellbit         DATA    20h
  0000               307     bitznak         BIT     cellbit.0       ;20.0           
  0001               308     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               309     znmat           BIT             cellbit.2       ;20.2
  0003               310     bitrs           BIT             cellbit.3       ;20.3
  0004               311     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               312     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               313     bitvi11         BIT             cellbit.6       ;20.6   бит режима выч R
  0007               314     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us
                     315     
  0021               316     cellbit1                DATA    21h
  0008               317     bitbuf          BIT     cellbit1.0      ;21.0           
  0009               318     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               319     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               320     bitmem          BIT             cellbit1.3      ;21.3
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     6

  000C               321     bmem11          BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               322     bmem12          BIT             cellbit1.5      ;21.5    бит ПАМ12
  000E               323     bmem13          BIT             cellbit1.6      ;21.6   бит ПАМ13        
  000F               324     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     325     
  0022               326     cellbit2                DATA    22h
  0010               327     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2         
  0011               328     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               329     bitvi12         BIT             cellbit2.2      ;22.2  
  0013               330     bitvi13         BIT             cellbit2.3      ;22.3
  0014               331     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               332     bitvi21         BIT             cellbit2.5      ;22.5    
  0016               333     bitvi31         BIT             cellbit2.6      ;22.6   бит ПАМ13        
                     334     ;bitnul         BIT             cellbit2.7      ;22.7 бит кнопки НУЛЬ   
                     335     
                     336             
                     337     
  005E               338     rez_Ame   data 5eh;      (РЕЗ1-AN)*K
  0062               339     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               340     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               341     rez_A0  data 6ah;
  007B               342     rez_A2   data 7bh; A2
                     343     
  0098               344     chinkor  data  98h;98..99;80h           ;счетчик интервала коррекции  2byte
  0081               345     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               346     chdel    data  83h              ; счетчик задержки
                     347     ;float
  0084               348     kor0_AN  data  84h              ;4byte  AN
  0088               349     rezAp    data  88h              ;4byte  A+
  008C               350     rezAm    data  8ch              ;4byte  A-
  0090               351     koefKp   data  90h              ;4byte  K+
  0094               352     koefKm   data  94h              ;4byte  K-
                     353     ;hex 
  009A               354     parT     data  9ah              ;параметр времени измерения
  009B               355     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               356     rez_A3   data  9ch              ;A3
                     357     ;FLOAT
  00A0               358     koefKD  data  0a0h         ;KD
  00A4               359     constE  data  0a4h         ;E
  00A8               360     constF  data  0a8h         ;F
  00AC               361     chind   data  0ach         ;счетчик индикации
  00AD               362     chbuf   data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               363     diap    data  0aeh         ;номер диапазона
  00AF               364     parN    data  0afh         ;N
  00B0               365     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               366     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               367     marker  data  0b2h         ;номер мигающего знакоместа
                     368     ;data  0b3h
                     369     ;внешнее ОЗУ 64K 
                     370     ;               XSEG AT 100h                                                               
                                                   
                     371             PUBLIC    MASS0
  0080               372     MASS0  xdata 0080h;
  0084               373     MASS1  xdata 0084h;
  0088               374     MASS2  xdata 0088h;
  008C               375     MASS3  xdata 008ch;
  0090               376     MASS4  xdata 0090h;
  0094               377     MASS5  xdata 0094h;
  0098               378     MASS6  xdata 0098h;
  009C               379     MASS7  xdata 009ch;
  00A0               380     MASS8  xdata 00a0h;
  00A4               381     MASS9  xdata 00a4h;
                     382     ;xdata 0038h;
                     383     
  0000               384                             rr0             EQU 00
  0001               385                     rr1       equ   01
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     7

  0006               386                     rr6   equ 06
  0002               387                     rr2       equ   02
  0003               388                     rr3       equ   03
  0007               389                     rr7   equ 07
                     390     
  0008               391                     r8   equ 08
  0009               392                     r9        equ   09
  000A               393                     r10       equ   10
  000B               394                     r11   equ 11
                     395     
                     396                     
                     397        
----                 398                  rseg     Main          ; Switch to this code segment.
                     399     
                     400                  using    0              ; Specify register bank for the following
                     401     
0100                 402     org 100h
                     403     ;$EJECT
                     404     
0100 7581E0          405     begin:     mov  sp, #0e0h
0103 75E900          406                                             mov             PCA0L,#00;=0x00;
0106 75D900          407                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          408                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A586          409                                             mov     P1MDOUT,#86h;8fh;=0x8f;
010F 75A600          410                                             mov     P2MDOUT,#00;=0x00;
                     411             
                     412             
0112 75B5FF          413             mov     P74OUT ,#0ffh;=0xff;
0115 75D103          414             mov     REF0CN,#03h;=0x03;
                     415             
0118 75E114          416             mov     XBR0,#14h;= 0x14;
011B 75E200          417             mov     XBR1,#00; =0x00;
011E 75E300          418             mov XBR2,#00;=0x00;
                     419      
0121 75FFDE          420             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
0124 75FFAD          421             mov     WDTCN,#0adh;=0xad;                                   
0127 758922          422             mov     TMOD,#22h;=0x22;        //регистр режимов
012A 758E30          423             mov     CKCON,#30h;=0x30; //сист частота/12     
012D 758CF9          424             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0130 758AF9          425             mov     TL0,#0f9h;=0xf9; 
0133 75E680          426             mov     EIE1,#80h;=0x80;
                     427     
0136 75D480          428             mov     DAC0CN,#80h;=0x80;
0139 75D780          429             mov     DAC1CN,#80h;=0x80;
013C 75B167          430             mov     OSCXCN,#67h;=0x67;
                     431     
                     432      
                     433     
013F E5B1            434     gener:     mov a, oscxcn
0141 B4E7FB          435                cjne a,#11100111b,gener
                     436                            
0144 75B288          437             mov     OSCICN,#88h;=0x84;
0147 75CA00          438         mov TMR2RLL,#0;=0;
014A 75CBD1          439         mov TMR2RLH,#0d1h;=0xd1;
                     440       
014D D28E            441                     setb  TCON.6                    ;регистр управления
014F D28C            442                      setb tcon.4
                     443     
0151 75EF00          444             mov     RSTSRC,#0;=00   ;//источники сброса 
                     445     
                     446             ;mov    IE,#80h;//10000000      ;//Снятие блокировки всех прерываний
0154 75E340          447          mov        XBR2,#40h
0157 75E106          448              mov    XBR0,#06h;16h
015A 75F803          449             mov             SPI0CN,#03
015D 759D31          450             mov             spi0ckr,#31H;;;;;;;;#04
                     451     ;ozu
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     8

0160 E4              452                             clr     a
0161 7800            453                             mov     r0,#00h 
0163 F6              454     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
0164 08              455                             inc     r0
0165 B87FFB          456                             cjne    r0,#7fh,mecle
0168 7880            457                             mov     r0,#80h
016A F6              458     meff:           mov     @r0,a 
016B F2              459                             movx @r0,a
016C 08              460                             inc     r0
016D B8DFFA          461                             cjne    r0,#0dfh,meff
0170 120000   F      462                             call    clmassix
0173 7898            463                             mov             r0,#chinkor
0175 7602            464                             mov             @r0,#02;600;
0177 08              465                             inc             r0
0178 7658            466                             mov             @r0,#58h;258h
                     467                             ;;;;
017A 7881            468                             mov             r0,#chavt
017C 7607            469                             mov             @r0,#07h;2eh
017E 08              470                             inc             r0
017F 76D0            471                             mov             @r0,#0d0h;0e0h
0181 789A            472                             mov             r0,#parT
0183 7702            473                             mov             @r1,#2                  ;Tizm=1s
0185 79AE            474                             mov             r1,#diap
0187 7705            475                             mov             @r1,#5                  ;10-7a
0189 79AF            476                             mov             r1,#parN
018B 7702            477                             mov             @r1,#2
                     478                             ;;;;;;
018D 900000   F      479                             mov             dptr,#ch_1              ;1->r2..r5 float
0190 120000   F      480                             call    ldc_long
0193 7890            481                             mov             r0,#koefKp         ;1(float)->koefKp
0195 120000   F      482                             call    saver2
0198 7894            483                             mov             r0,#koefKm              ;1(float)->koefKm
019A 120000   F      484                             call    saver2
                     485                              ;погасить индикатор
019D 7840            486                             mov             r0,#bufind
019F                 487     age1:
019F 76FD            488                             mov             @r0,#0fdh;" ";0ffh   ;-----
01A1 08              489                             inc             r0
01A2 B84BFA          490                             cjne    r0,#bufind+11,age1              
01A5 120000   F      491                             call    ind
                     492                     ;чтение пам прогр(5000h) 1 страница(ffh)
                     493     ;и запись во внешнее озу(0000h)
01A8 75A800          494     copyP:            mov           ie,#00h
01AB 7900            495                                     mov             r1,#0                   ;
01AD 7A50            496                                     mov             r2,#50h
01AF 7B00            497                                     mov             r3,#00
01B1 120000   F      498                                     call    copyPP
                     499                                     ;внести изменения во внешн озу
                     500                                     ;KD=3f 80 00 00 (KD=1)
01B4 7F0C            501                                     mov             r7,#12          ;diap
01B6 7900            502                                     mov             r1,#0
01B8 7400            503     gowr:                   mov             a,#00h
01BA F3              504                                     movx    @r1,a
01BB 09              505                                     inc             r1
01BC 7401            506                                     mov             a,#01h
01BE F3              507                                     movx    @r1,a
01BF 09              508                                     inc             r1
01C0 7486            509                                     mov             a,#86h
01C2 F3              510                                     movx    @r1,a
01C3 09              511                                     inc             r1
01C4 74A0            512                                     mov             a,#0a0h
01C6 F3              513                                     movx    @r1,a
01C7 09              514                                     inc             r1
01C8 DFEE            515                                     djnz    r7,gowr
                     516     ;стереть страницу пап прогр 
01CA 905000          517                                     mov             dptr,#5000h
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE     9

01CD 7FFF            518                                     mov             r7,#0ffh
01CF 120000   F      519                                     call    cle256
                     520     ;и запись в ячейки кофф памяти прогр (3000h) 
01D2 7FFF            521                                     mov             r7,#0ffh
01D4 7900            522                                     mov             r1,#0                           ;external r
                             am
01D6 905000          523                                     mov             dptr,#5000h
01D9 120000   F      524                                     call    wrpage
01DC 80FE            525                                     jmp             $
                     526     
                     527     
                     528     
                     529     
                     530     
                     531     
                     532     
                     533     
                     534     
                     535     
01DE 120000   F      536                             call    iniacp;инициализация acp
01E1 120000   F      537                             call    loadUS          ;us 10-7 A
                     538                             ;зажечь все лементы индикации
01E4 7840            539                             mov             r0,#bufind
01E6 76FE            540     ageon:          mov             @r0,#0feh;?
01E8 08              541                             inc             r0
01E9 B84BFA          542                             cjne    r0,#bufind+11,ageon             
01EC 120000   F      543                             call    ind
01EF 120000   F      544                             call    z_1s            ;1sec
                     545                             
01F2 120000   F      546                             call    z_ss
                     547                                     ;-7A
01F5 120000   F      548                        call z_1s            ;1sec
01F8 80FE            549                        jmp  $
                     550     
01FA 2093FD          551     rebyte:         jb              p1.3,$
01FD 3093FD          552                             jnb             p1.3,$
0200 7411            553                             mov             a,#11h
0202 120000   F      554                             call    write
                     555                             ;чтение acp
0205 120000   F      556                             call    read    
0208 F578            557                             mov     reacp+1,A       ;старший байт 
020A 120000   F      558                             call    read    
020D F579            559                             mov     reacp+2,A       ;средний байт 
020F 120000   F      560                             call    read
0212 F57A            561                             mov     reacp+3,A               ;мл байт
                     562                        ;;;;;;;;;;;
0214 7878            563                        mov          r0,#reacp+1
0216 E6              564                        mov          a,@r0
0217 20E724          565                             jb              acc.7,znplus;
021A D200            566                             setb    bitznak
021C 4480            567                             orl             a,#80h  ;ост содерж яч 
021E F6              568                             mov             @r0,a
                     569                                     
021F 18              570     mmm:            dec             r0;,#reacp
0220 76FF            571                             mov             @r0,#0ffh
0222 8022            572                             jmp             goznak
                     573     
                     574     
0224 750A00          575     labelA :        mov             r10,#0          
0227 750B00          576                             mov             r11,#0
022A 783D            577                             mov             r0,#chkl
022C 120000   F      578                             call    chcmp
022F 7000            579                             jnz             no0key
                     580                             ;разрешить ie6,ie7       
                     581                     ;       mov             EIE2,#30h ;EIE2.5,EIE2.4
                     582                     ;       mov             EIP2,#30h
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    10

                     583                        
0231 793D            584     no0key:         mov             r1,#chkl 
0233 120000   F      585                             call    chdec
0236 2004C1          586                             jb              bitizm,rebyte
                     587                              ;буфер 2 выдать на индикацию
0239 120000   F      588                              call   ind
                     589     
023C 80BC            590                             jmp             rebyte;???????????///
023E C200            591     znplus:         clr     bitznak
0240 547F            592                             anl             a,#7fh;fdh                      ;+
0242 F6              593                             mov             @r0,a
0243 18              594                             dec             r0;,#reacp
0244 7600            595                             mov             @r0,#00h
                     596                             
0246                 597     goznak: 
                     598     ;;;;;;;;;;;;;
0246 787A            599                             mov     r0,#reacp+3
0248 E6              600                             mov             a,@r0
0249 7F05            601                             mov             r7,#5;6
024B C3              602     sdvig3:         clr             c
024C 13              603                             rrc             a
024D DFFC            604                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
024F FA              605                             mov             r2,a    ;сохр байт
0250 18              606                             dec             r0              ;       reacp+2
0251 E6              607                             mov             a,@r0
0252 C0E0            608                             push    acc
0254 C3              609                             clr             c
0255 7F03            610                             mov             r7,#3;2
0257 C3              611     sdvig2:         clr             c
0258 33              612                             rlc             a
0259 DFFC            613                             djnz    r7,sdvig2 ;d12..d11      средний байт
025B 4A              614                             orl             a,r2
025C F57A            615                             mov             reacp+3,a;сформ мл байт
025E D0E0            616                             pop             acc
                     617                             
0260 7F05            618                             mov             r7,#5;6
0262 C3              619     sdvig1:         clr             c
0263 13              620                             rrc             a
0264 DFFC            621                             djnz    r7,sdvig1 ;d15,d14        ср байт
0266 FA              622                             mov             r2,a   ;сохр
0267 E578            623                             mov             a,reacp+1
0269 C0E0            624                             push    acc
                     625                     ;;      push    acc
026B 7F03            626                             mov             r7,#3;2
026D C3              627     sdvig0:         clr             c
026E 33              628                             rlc             a
026F DFFC            629                             djnz    r7,sdvig0 ;       d21..d16
0271 4A              630                             orl             a,r2
0272 F579            631                             mov             reacp+2,a       ; сформ средний  байт
0274 D0E0            632                             pop             acc       ;reacp+1
                     633                             ;;;;;;;;;;;;;;
0276 20E70C          634                             jb              acc.7,sdvm
0279 C3              635                             clr             c
027A 7F05            636                             mov             r7,#5;6
027C C3              637     sdvig4:         clr             c
027D 13              638                             rrc             a
027E DFFC            639                             djnz    r7,sdvig4 ;       d23,d22
0280 F578            640                             mov             reacp+1,a
0282 020000   F      641                             jmp             ankor;klmas
                     642     ;;;;;;;;;;;;                                    
0285 7F05            643     sdvm:           mov             r7,#5;6
0287 D3              644     sdvig6:         setb            c
0288 13              645                             rrc             a
0289 DFFC            646                             djnz    r7,sdvig6 ;       d23,d22
028B F578            647                             mov             reacp+1,a                               
                     648     ; reacp..reacp+3-результат чтения асп(hex) 
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    11

                     649     ;;;;;;;;;
                     650     
                     651        
                     652     
028D 789A            653                             mov             r0,#parT        ;параметр времени
028F 793F            654                             mov             r1,#chmasN
0291 B60125          655                             cjne    @r0,#1,noparT1
                     656                             ;РЕЗ+РЕЗ
0294 7877            657                             mov             r0,#reacp
0296 120000   F      658                             call    resar2          ;reacp->r2..r5
0299 7865            659                             mov             r0,#rez_A+3
029B 120000   F      660                             call    ladd
029E 789B            661                             mov             r0,#chbefore
02A0 B66312          662                             cjne    @r0,#99,nobef99
                     663                             ;РЕЗ/100
02A3 900000   F      664                             MOV        DPTR,#ch100 
02A6 120000   F      665                             CALL   ldc_ltemp                 ; ltemp <-- 100
02A9 120000   F      666                             call    divide
02AC 7862            667                             mov             r0,#rez_A
02AE 120000   F      668                             call    saver2          ;сумма 100 отсчетов /100
02B1 770A            669                             mov             @r1,#10         ;chmasN (n)=10
02B3 801C            670                             jmp             klmas           ;загр в массив скользящее ср
02B5 06              671     nobef99:        inc             @r0                     ;chbefore
02B6 020000   F      672                             jmp             rebyte;labelA;метка A
                     673     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     674     ;а потом уже располагаем  в скользящий массив  из n
                     675     
                     676     
                     677     
02B9 B60209          678     noparT1:        cjne    @r0,#2,noparT2
                     679                             ;РЕЗ+РЕЗ
02BC 789B            680                             mov             r0,#chbefore
02BE B609F4          681                             cjne    @r0,#9,nobef99
                     682                             ;РЕЗ/10
02C1 770A            683                             mov             @r1,#10         ;chmasN (n)=10
02C3 800C            684                             jmp             klmas           ;загр в массив скользящее ср
                     685     
02C5 B60300          686     noparT2:        cjne    @r0,#3,noparT3
02C8 B60404          687     noparT3:        cjne    @r0,#4,noparT4
02CB 770A            688                             mov             @r1,#10         ;n=10
02CD 8002            689                             jmp             klmas
02CF 7702            690     noparT4:   mov          @r1,#2          ;n=2
                     691     
                     692     ;загрузить А в массив из 2/10 значений
                     693     ;;;;;;;;;;;;;;;
02D1                 694     klmas:           
02D1 793F            695                             mov             r1,#chmasN
02D3 B70219          696                             cjne    @r1,#2,mas10
02D6 900080          697                             MOV        dptr,#MASS0
02D9 120000   F      698                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     699     
02DC 7862            700                             mov             r0,#rez_A
02DE 120000   F      701                             call    resar2          ;->r2..r5
02E1 900080          702                             mov                     dptr,#MASS0
02E4 120000   F      703                   call              saveIr2                 ; R2-R5 --> MAS0
                     704                     
02E7 900087          705                   MOV          dptr,#MASS1+3
02EA 120000   F      706                   CALL       addx
02ED 8077            707                       jmp           endsum
02EF 9000A0          708     mas10:          mov                     dptr,#MASS8
02F2 120000   F      709                     CALL            xCIKLWR         ;MASS8->MASS9
02F5 90009C          710                             mov                     dptr,#MASS7
02F8 120000   F      711                     CALL            xCIKLWR         ;MASS7->MASS8
02FB 900098          712                     MOV       dptr,#MASS6
02FE 120000   F      713                     CALL       xCIKLWR         ; MASS6 --> MASS7
0301 900094          714                     MOV        dptr,#MASS5
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    12

                     715                    
0304 120000   F      716                    CALL        xCIKLWR        ; MASS5 --> MASS6
0307 900090          717                    MOV         dptr,#MASS4
                     718                    
030A 120000   F      719                    CALL        xCIKLWR        ; MASS4 --> MASS5
030D 90008C          720                             mov                     dptr,#MASS3
                     721     
0310 120000   F      722                    CALL             xCIKLWR         ;MASS3->MASS4
0313 900088          723                     MOV        dptr,#MASS2
                     724                    
0316 120000   F      725                    CALL        xCIKLWR         ; MASS2 --> MASS3
0319 900084          726                    MOV         dptr,#MASS1
                     727                     
031C 120000   F      728                   CALL         xCIKLWR        ; MASS1 --> MASS2
031F 900080          729                    MOV         dptr,#MASS0
                     730                   
0322 120000   F      731                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     732     
                     733                             
0325 7862            734                             mov             r0,#rez_A
0327 120000   F      735                             call    resar2          ;->r2..r5
                     736                                     ;call   aform
032A 900080          737                                     mov                     dptr,#MASS0
032D 120000   F      738                   call              saveIr2                 ; R2-R5 --> MAS0
                     739              
0330 900087          740                   MOV          dptr,#MASS1+3
0333 120000   F      741                   CALL       addx
0336 90008B          742                   MOV          dptr,#MASS2+3
0339 120000   F      743                   CALL       addx
033C 90008F          744                   MOV          dptr,#MASS3+3
033F 120000   F      745                  CALL        addx
0342 900093          746                   MOV       dptr,#MASS4+3
0345 120000   F      747                   call       addx
0348 900097          748                     MOV        dptr,#MASS5+3
034B 120000   F      749                  CALL        addx
034E 90009B          750                   MOV          dptr,#MASS6+3
0351 120000   F      751                   CALL       addx
0354 90009F          752                   MOV          dptr,#MASS7+3
0357 120000   F      753                  CALL        addx
035A 9000A3          754                  MOV        dptr,#MASS8+3
035D 120000   F      755                   call       addx
0360 9000A7          756                     MOV                     dptr,#MASS9+3
0363 120000   F      757                  call        addx
                     758             ;23.03          
0366                 759     endsum:
0366 786E            760                                     mov             r0,#chmas               ;0..n(0..2,0..10)
0368 06              761                                     inc             @r0
0369 E6              762                                     mov             a,@r0   
036A 200108          763                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                     764                                     
036D B53F18          765                                     cjne    a,chmasN,masx5
0370 D201            766                                     setb    bitmas                  ;массив заполнен
0372 786E            767                                     mov             r0,#chmas
0374 E6              768                                     mov             a,@r0
0375 B40208          769     masfull:                cjne    a,#2,nochn2
0378 900000   F      770                                     MOV        DPTR,#ch2;10 
037B 120000   F      771                                     CALL   ldc_ltemp                 ; ltemp <-- 2
037E 8012            772                                     jmp             mas5div
                     773     
0380 900000   F      774     nochn2:                 MOV        DPTR,#ch10 
0383 120000   F      775                                     CALL   ldc_ltemp                 ; ltemp <-- 10
0386 800A            776                                     jmp             mas5div
                     777     
0388 856E0B          778     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
038B E4              779                                     clr     a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    13

038C F50A            780                                     mov     ltemp+2,a
038E F509            781                                     mov     ltemp+1,a
0390 F508            782                                     mov     ltemp,a
                     783     
0392                 784     mas5div:
0392 120000   F      785                                     CALL       zdiv;divide                           ; R2-R5 =
                     786                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                     787     
                     788                             
                     789      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     790     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     791     ;получен результат 3 байта и знак
0395 7866            792                             mov             r0,#rez_A1
0397 120000   F      793                             call    saver2           ;сохр среднее по массиву
039A 753F00          794                             mov             chmasN,#0
                     795      ;;;;;;;;;;;;
                     796      ;;;;;;;;;;;;
039D C3              797                             clr             c
039E 799A            798                             mov             r1,#parT
03A0 7402            799                             mov             a,#2
03A2 97              800                             subb    a,@r1
03A3 5007            801                             jnc             ankor           ;T<3
                     802                             ;A-=РЕЗ1                                ;T>3
03A5 785E            803                             mov             r0,#rez_Ame
03A7 120000   F      804                             call    saver2
03AA 802D            805                             jmp             gotoKD
                     806     
03AC 750A00          807     ankor:          mov             r10,#0          
03AF 750B00          808                             mov             r11,#0
03B2 7898            809                             mov             r0,#chinkor
03B4 120000   F      810                             call    chcmp
03B7 7003            811                             jnz             nokorr
                     812                             ;коррекция 0
03B9 020000   F      813                             jmp             kornul
                     814     
03BC 750A00          815     nokorr:         mov             r10,#00         ;       chavt
03BF 750B00          816                             mov             r11,#00h
03C2 7881            817                             mov              r0,#chavt      
03C4 120000   F      818                             call    chcmp           ;сравн счетчик авто калибровки с 0h
03C7 7040            819                             jnz             nonulavt        
03C9 750A02          820                             mov             r10,#02         
03CC 750B58          821                             mov             r11,#58h
03CF 7898            822                             mov             r0,#chinkor
03D1 120000   F      823                             call    chcmp
03D4 7038            824                             jnz             noavk
                     825                             ;автокалибровка
03D6 020000   F      826                             jmp             autoka
                     827     ;;;;;;;;;;
03D9 C3              828      gotoKD:                clr             c
03DA 799A            829                             mov             r1,#parT
03DC 7404            830                             mov             a,#4
03DE 97              831                             subb    a,@r1
03DF 5058            832                             jnc             afterK          ;T<5
                     833                             ;A1-=A- *KD                     ;T>5
                     834                             
03E1 785E            835                             mov             r0,#rez_Ame;->r2..r5   ???????????/
03E3 120000   F      836                             call    resar2
03E6 120400          837                             call    altof   ;r2..r5->float          
03E9 78A0            838                             mov             r0,#koefKD;->r8..r11
03EB 120000   F      839                             call    resar8
03EE 120201          840                             call    flmul
03F1 120341          841                             call    ftol                    ;float->int
03F4 7866            842                             mov             r0,#rez_A1
03F6 120000   F      843                             call    saver2
03F9 786A            844                             mov             r0,#rez_A0;->r8..r11 hex
03FB 120000   F      845                             call    resar8
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    14

03FE 120000   F      846                             call    lsub            ;A3=A-1-A0
0401 789C            847                             mov             r0,#rez_A3
0403 120000   F      848                             call    saver2
0406 020000   F      849                             jmp             labelB  
                     850      ;;;;;;;;;;;
0409 7981            851     nonulavt:       mov             r1,#chavt       
040B 120000   F      852                             call    chdec   ;dec            @r1                     ;chavt-1
040E 7998            853     noavk:          mov             r1,#chinkor
0410 120000   F      854                             call    chdec           ; chinkor-1
                     855     
                     856                             ;;;;;;;;;;;;;;
                     857                             ;;;;;;;;;;;;;
                     858     ;(РЕЗ1-АN)*K
0413 7866            859                             mov             r0,#rez_A1;->r2..r5
0415 120000   F      860                             call    resar2
0418 120400          861                             call    altof   ;r2..r5->float  6.06    
041B 7884            862                             mov             r0,#kor0_AN;->r8..r11
041D 120000   F      863                             call    resar8
                     864                             ;;call  altof   ;r2..r5->float
0420 1201CF          865                             call    flsub
0423 7890            866                             mov             r0,#koefKp;->r8..r11
0425 EA              867                             mov             a,r2
                     868                             ;jnb            acc.7,nminus
0426 300002          869                             jnb             bitznak,nminus
                     870                     
0429 7894            871                             mov             r0,#koefKm;->r8..r11
042B 120000   F      872     nminus:         call    resar8
042E 120201          873                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
0431 120341          874                             call    ftol                    ;float->int
0434 785E            875                             mov             r0,#rez_Ame
0436 120000   F      876                             call    saver2
                     877      ;;;;;;;;;;;;;;;;;;;;;;;;;;
                     878      ;;;;;;;;;;;;;;;;;;;;;;;;;;
0439 C2B4            879     afterK:                 clr             P3.4
043B 00              880                                     nop
043C 00              881                                     nop
043D D2B4            882                                     setb    P3.4
                     883     ;;;;;;;;;;;;;;
043F 120400          884                                     call    altof                   ;r2..r5->float
0442 900000   F      885                                     mov     dptr,#ch_220;220000
0445 120000   F      886                                     call    ldc_ltemp                       ;r8..r11=8
0448 1201D4          887                                     call    flcmp
044B 5053            888                                     jnc             rmo220          ;A>220000
044D 78A0            889                                     mov             r0,#koefKD              ;KD->r8..r11
044F 120000   F      890                                     call    resar8
0452 120201          891                                     call    flmul     ;A1-=A-*KD  fl
                     892                                     
0455 120341          893                                     call    ftol                    ;float->int
0458 7866            894                                     mov             r0,#rez_A1
045A 120000   F      895                                     call    saver2
045D 120400          896                                     call    altof                   ;r2..r5->float
0460 900000   F      897                                     mov     dptr,#ch_200;200000
0463 120000   F      898                                     call    ldc_ltemp                       ;r8..r11=8
0466 1201D4          899                                     call    flcmp
0469 506B            900                                     jnc             mo220           ;A>200000
046B 300406          901                                     jnb             bitizm,goA2     
046E 200531          902                                     jb              bitavp,yesavp   
0471 200646          903     noavp:                  jb              bitvi11,yesvich
0474                 904     goA2:                    ;A2=A1-
0474 7866            905                                      mov            r0,#rez_A1
0476 120000   F      906                                     call    resar2
0479 787B            907                                     mov             r0,#rez_A2
047B 120000   F      908                                     call    saver2
047E                 909     goA3A2:                  ;A3=A2-A0
047E 786A            910                                       mov           r0,#rez_A0
0480 120000   F      911                                     call    resar2
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    15

0483 789C            912                                     mov             r0,#rez_A3
0485 120000   F      913                                     call    saver2
                     914                                     ;;;;;;
0488 78AC            915     goonin:                 mov             r0,#chind
048A B6005F          916                                     cjne    @r0,#0,nochi0
048D C2B4            917                                     clr             P3.4
048F 00              918                                     nop
0490 00              919                                     nop
0491 D2B4            920                                     setb    P3.4      ;??????????????????????/
0493 805B            921                                     jmp             nop3_0
                     922     
0495 20B058          923                                     jb              P3.0,nop3_0     ;;;;;;;;;;;;;;;;;;;;;;;;;;
0498 786A            924                                     mov             r0,#rez_A0              ;r2..r5->rez_A0
049A 120000   F      925                                     call    saver2                  ;ЗАПОМНИТЬ СМЕЩЕНИЕ НУЛЯ
049D 020000   F      926                                     jmp             rebyte          ;age2
04A0 8034            927      rmo220:                jmp             mo220
                     928     
                     929     
                     930     ;;;;;;;;;;;;;;;;
04A2 900000   F      931     yesavp:                 mov     dptr,#ch_10th;10000
04A5 120000   F      932                                     call    ldc_ltemp                       ;r8..r11=8
04A8 1201D4          933                                     call    flcmp
04AB 40C4            934                                     jc              noavp           ;A>10000        
04AD 78AE            935                                     mov             r0,#diap                ;10-11
04AF B609BF          936                                     cjne    @r0,#9,noavp
04B2 17              937                                     dec             @r1             ;переключ диапазон на 1 поз
                             ицию вниз
04B3 B6FF02          938                                     cjne    @r0,#0ffh,clmasv
04B6 7600            939                                     mov             @r0,#0
04B8                 940     clmasv:         ;сбросить массив
                     941                                                                                              
04B8 80CE            942                                jmp     goonin
                     943     
04BA                 944     yesvich:        ;A2=E/A1-+F
04BA 78A4            945                                      mov            r0,#constE
04BC 120000   F      946                                     call    resar2
04BF 7866            947                                       mov           r0,#rez_A1
04C1 120000   F      948                                     call    resar8
04C4 1202B5          949                                     call    fldiv
04C7 78A8            950                                      mov    r0,#constF
04C9 120000   F      951                                     call    resar8
04CC 120164          952                                     call    fladd
04CF 787B            953                                     mov             r0,#rez_A2
04D1 120000   F      954                                     call    saver2
04D4 80A8            955                                     jmp             goA3A2
                     956     
04D6 300508          957     mo220:             jnb          bitavp,indoll
04D9 300405          958                                jnb          bitizm,indoll
04DC 78AE            959                                     mov             r0,#diap
04DE B60002          960                                     cjne    @r0,#0,nodi2
                     961                                ;10-2
04E1                 962     indoll:                 ;OLL
04E1 80A5            963                                     jmp             goonin  
                     964     
04E3 06              965     nodi2:             inc          @r0     ;переключить на 1 позицию вверх
                     966     
04E4 B60A01          967                                     cjne    @r0,#10,nodi9
04E7 16              968                                     dec             @r0
04E8                 969     nodi9:                  ;сбросить массив
04E8 D207            970                                     setb    bitzus  ;флаг задержки  после установки us         
                                                                   
04EA 809C            971                                jmp     goonin
                     972     
04EC 16              973     nochi0:                 dec             @r0                     ;СТИ-1
04ED 020000   F      974                                     jmp             labelB  
                     975     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    16

                     976             
                     977     ;;;;;;;;;;;;;;;
                     978     
04F0                 979     nop3_0: ;;      ;rez_A-rez_A0
                     980                     ;;                      mov             r0,#rez_A0
                     981                     ;;                      call    resar8
                     982                     ;;                      call    lsub
                     983                     ;;                      mov             r0,#rez_A
                     984                     ;;;                     call    saver2
                     985      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
04F0 789C            986                                             mov             r0,#rez_A3       ;A3 ->в десятич фо
                             рму(6дес разрядов и в кои)
04F2 120000   F      987                                             call    resar2
04F5 900000   F      988                                             mov             dptr,#ch100              
04F8 120000   F      989                                             call    ldc_ltemp        
04FB 120000   F      990                                             call    zdiv            ;rez_A3/100=r2..r5
                     991                                     
04FE EC              992                                             mov             a,r4
04FF 20E71B          993                                             jb              acc.7,aless0
0502 4408            994                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
0504 F5D3            995                                             mov             DAC0H,a
                     996                                                                             ;мл байт
0506 ED              997                                             mov             a,r5
0507 F5D2            998                                             mov             DAC0L,a
0509 801B            999                                             jmp             moveA3;goonind
                    1000     
050B B70206         1001     no3parN:                        cjne    @r1,#2,no2parN
                    1002                                             ;в байт 0  записать пробел
050E 7946           1003                                             mov             r1,#bufind+6
0510 7720           1004                                             mov             @r1,#" "
0512 8053           1005                                             jmp             seeind;moveA3
                    1006     
0514                1007     no2parN:                        ;в байты 0 и 1 записать пробел
0514 7945           1008                                             mov             r1,#bufind+5
0516 7720           1009                                             mov             @r1,#" "
0518 09             1010                                             inc             r1
0519 7720           1011                                             mov             @r1,#" "
051B 804A           1012                                             jmp             seeind;moveA3
                    1013     
051D F4             1014     aless0:                         cpl             a
051E 54F7           1015                                             anl             a,#0f7h         ;d11=0
0520 F5D3           1016                                             mov             DAC0H,a
                    1017                                                                             ;мл байт
0522 ED             1018                                             mov             a,r5
0523 F4             1019                                             cpl             a
0524 F5D2           1020                                             mov             DAC0L,a
                    1021     ;goonind:                  mov          r1,#parN        ; ??????
                    1022     ;                                       cjne    @r1,#3,no3parN
                    1023                                             
0526                1024     moveA3: 
0526 789C           1025                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
0528 120000   F     1026                                             call    resar2
                    1027                                     
052B 120000   F     1028                                             call    maform
052E 784F           1029                                             mov             r0,#abin
0530 120000   F     1030                                             call    saver2
                    1031     ;;;;;;;;
                    1032                                             
0533 7853           1033                                             mov             r0,#adec
0535 7952           1034                                             mov             r1,#abin+3      ;hex->10
0537 120000   F     1035                                             call    bindec
                    1036                                     
053A 785C           1037                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    17

053C 7946           1038                                             mov             r1,#bufind+6
053E 7F07           1039                                             mov             r7,#7
0540 E6             1040     bufdec:                         mov             a,@r0
0541 2430           1041                                             add             a,#30h
0543 F7             1042                                             mov             @r1,a
0544 19             1043                                             dec             r1
0545 18             1044                                             dec             r0
0546 DFF8           1045                                             djnz    r7,bufdec
0548 7847           1046                                             mov             r0,#bufind+7
054A 762D           1047                                             mov             @r0,#2dh
054C 7840           1048                                             mov             r0,#bufind
054E 762B           1049                                             mov             @r0,#2bh
0550 300202         1050                                             jnb             znmat,nozzmi;bitznak,nozzmi
0553 762D           1051                                             mov             @r0,#2dh
0555 7848           1052     nozzmi:                         mov             r0,#bufind+8
0557 7637           1053                                             mov             @r0,#37h;"T";
0559 08             1054                                             inc             r0
055A 7641           1055                                             mov             @r0,#"A";"E";
055C 08             1056                                             inc             r0
055D 7600           1057                                             mov             @r0,#00h
055F 08             1058                                             inc             r0;             mov             buf
                             ind+11
0560 76C0           1059                                             mov             @r0,#0c0h
0562 79AF           1060     goonind:                   mov          r1,#parN        ; ??????
0564 B703A4         1061                                             cjne    @r1,#3,no3parN
                    1062                                     
                    1063     ;moveA3:        
0567 120000   F     1064     seeind:                 call    ind
                    1065                                                 
056A 789A           1066                                     mov             r0,# parT
056C 79AC           1067                                             mov             r1,#chind
056E B60132         1068                                             cjne    @r0,#1,not1in
0571 78AD           1069     labelB:                         mov             r0,#chbuf         ;T=1
0573 B6002A         1070                                             cjne    @r0,#0,nobuf0
0576 200905         1071                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
0579 200A04         1072                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
057C 8018           1073                                             jmp             gocikle
                    1074     
057E                1075     yesprd: ;передать   A3 в буфер
057E 8000           1076                                             jmp             goonT
0580                1077     yesbuf: ;записать   A3 в буфер
0580 789A           1078     goonT:                          mov             r0,#parT
0582 79AD           1079                                             mov             r1,#chbuf
0584 B60102         1080                                             cjne    @r0,#1,nott1
                    1081                                     ;       mov             @r1,#
0587 800D           1082                                             jmp             gocikle
                    1083     
0589 B60502         1084     nott1:                          cjne    @r0,#5,nott5
                    1085     
058C 8008           1086                                             jmp             gocikle
                    1087     
058E C3             1088     nott5:           clr            c
058F 799A           1089                             mov             r1,#parT
0591 7404           1090                             mov             a,#4
0593 97             1091                             subb    a,@r1
0594 5008           1092                             jnc             yestt5          ;T<5
0596 300802         1093     gocikle:        jnb             bitbuf,nofz                                     
                    1094                                      ;0,5c
0599 C208           1095                             clr     bitbuf
059B 020000   F     1096     nofz:           jmp     labelA;rebyte
                    1097     
059E 80F6           1098     yestt5:         jmp             gocikle
                    1099     
05A0 16             1100     nobuf0:                         dec             @r0
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    18

05A1 80F3           1101                                             jmp             gocikle
                    1102     
                    1103     
05A3 B60204         1104     not1in:                         cjne    @r0,#2,not2in
05A6 7701           1105                                             mov             @r1,#1           ;T=2
05A8 80C7           1106                                             jmp     labelB
                    1107     
05AA B60304         1108     not2in:                         cjne    @r0,#3,not3in
05AD 7709           1109                                             mov             @r1,#9          ;T=3
05AF 80C0           1110                                             jmp     labelB
05B1 7713           1111     not3in:                         mov             @r1,#19
05B3 80BC           1112                                             jmp     labelB
                    1113     
                    1114     
                    1115     
                    1116     ;коррекция 0
05B5 7883           1117     KORnul:         mov             r0,#chdel
05B7 B60010         1118                             cjne    @r0,#0,nonuldel
                    1119                                     
05BA E585           1120                             mov             a,P5       ;p5.3=1
05BC 4408           1121                             orl             a,#08
05BE F585           1122                             mov             P5,a
05C0 00             1123                             nop
05C1 00             1124                             nop
                    1125                                     
05C2 E585           1126                             mov             a,P5              ;p5.0=0
05C4 54FE           1127                             anl             a,#0feh
05C6 F585           1128                             mov             P5,a
05C8 8025           1129                             jmp             chdelmo
                    1130     
05CA B62828         1131     nonuldel:       cjne    @r0,#40,no4del
                    1132                             ;рез ->AN
                    1133                     ;       mov             r0,#rez_A;->r2..r5
                    1134                     ;       call    resar2
05CD E577           1135                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
05CF FA             1136                                     mov             r2,a
05D0 E578           1137                                     mov             a,reacp+1
05D2 FB             1138                                     mov             r3,a
05D3 E579           1139                                     mov             a,reacp+2
05D5 FC             1140                                     mov             r4,a
05D6 E57A           1141                                     mov             a,reacp+3
05D8 FD             1142                                     mov             r5,a
                    1143                                     ;;;;;;;;;;
05D9 120400         1144                             call    altof           ;r2..r5->float
05DC 7884           1145                             mov             r0,#kor0_AN;->kor0_AN
05DE 120000   F     1146                             call    saver2
                    1147                                     
05E1 E585           1148                             mov             a,P5            ;p5.0=1
05E3 4401           1149                             orl             a,#01
05E5 F585           1150                             mov             P5,a
05E7 00             1151                             nop
05E8 00             1152                             nop
                    1153                                     
05E9 E585           1154                             mov             a,P5                    ;p5.3=0 
05EB 54F7           1155                             anl             a,#0f7h
05ED F585           1156                             mov             P5,a                    
                    1157                             
05EF 7883           1158     chdelmo:        mov             r0,#chdel
05F1 06             1159                             inc             @r0             ;chdel+1
05F2 020000   F     1160                             jmp              rebyte
                    1161     
05F5 B650F7         1162     no4del:         cjne    @r0,#80,chdelmo
05F8 7600           1163                             mov             @r0,#0          ;chdel
05FA 7898           1164                             mov             r0,#chinkor
05FC 7602           1165                             mov             @r0,#02;600;
05FE 08             1166                             inc             r0
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    19

05FF 7658           1167                             mov             @r0,#58h;258h
0601 020000   F     1168                             jmp              rebyte
                    1169     
                    1170     ;автокалибровка
0604                1171     autoka:  ;;  mov                r0,#chavt
                    1172                      ;;  call               chcmp
                    1173                      ;;  jz         nulavt
                    1174                     ;;   mov                r1,#chavt
                    1175                     ;;   call               chdec;chavt-1
                    1176                      ;; jmp         rebyte
0604                1177     nulavt:  ;;;;;
0604 7883           1178                             mov             r0,#chdel
0606 B6000C         1179                             cjne    @r0,#0,nndelch
0609 438508         1180                             orl             P5,#08             ;p5.3=1
060C 00             1181                             nop
060D 00             1182                             nop
060E 5385FD         1183                             anl             P5,#0fdh                ;p5.1=0
0611 06             1184                             inc             @r0
0612 020000   F     1185                             jmp              rebyte
                    1186     
0615 B6643D         1187     nndelch:        cjne    @r0,#100,n4delch
                    1188                             ;pez->A+
                    1189                             ;K+=000/(A+-AN)
                    1190                             ;mov            r0,#rez_A;->r2..r5
                    1191                             ;call   resar2
0618 E577           1192                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
061A FA             1193                                     mov             r2,a
061B E578           1194                                     mov             a,reacp+1
061D FB             1195                                     mov             r3,a
061E E579           1196                                     mov             a,reacp+2
0620 FC             1197                                     mov             r4,a
0621 E57A           1198                                     mov             a,reacp+3
0623 FD             1199                                     mov             r5,a
                    1200                                     ;;;;;;;;;;;;;;;
0624 120400         1201                             call    altof                   ;r2..r5->float
0627 7888           1202                             mov             r0,#rezAp;->rezAp
0629 120000   F     1203                             call    saver2                          
062C 7884           1204                             mov             r0,#kor0_AN;kor0_AN->r8..r11
062E 120000   F     1205                             call    resar8                          
0631 1201CF         1206                             call    flsub           ; r2..r5(A+-AN)
0634 120000   F     1207                             call    move28     ;r2..r5->r8..r11
0637 900000   F     1208                             mov             dptr,#CHtho;000->r2..r5 float
063A 120000   F     1209                             call    ldc_long                
063D 1202B5         1210                             call    fldiv
0640 EA             1211                             mov             a,r2
0641 547F           1212                             anl             a,#7fh
0643 FA             1213                             mov             r2,a
0644 7890           1214                             mov             r0,#koefKp;->koefKp
0646 120000   F     1215                             call    saver2
                    1216                       
                    1217                     ;       anl             P5,#0feh                ;p5.0=0 
0649 E585           1218                     mov             a,P5
064B 54FE           1219                             anl             a,#0feh
064D F585           1220                             mov             P5,a
064F 7883           1221                             mov             r0,#chdel
0651 06             1222                             inc             @r0                       ;ch+1
0652 020000   F     1223                             jmp             rebyte
                    1224     
0655 B6C845         1225     n4delch:        cjne    @r0,#200,n8delch
                    1226                             ; pez->A-
                    1227                             ;K-=000/(A--AN)
                    1228                     ;       mov     r0,#rez_A;->r2..r5
                    1229                     ;       call    resar2
0658 E577           1230                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
065A FA             1231                                     mov             r2,a
065B E578           1232                                     mov             a,reacp+1
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    20

065D FB             1233                                     mov             r3,a
065E E579           1234                                     mov             a,reacp+2
0660 FC             1235                                     mov             r4,a
0661 E57A           1236                                     mov             a,reacp+3
0663 FD             1237                                     mov             r5,a
                    1238                                     ;;;;;;;;;;;;;;;
0664 120400         1239                             call    altof                   ;r2..r5->float
0667 788C           1240                             mov             r0,#rezAm;->rezAm
0669 120000   F     1241                             call    saver2                          
066C 7884           1242                             mov             r0,#kor0_AN;kor0_AN->r8..r11
066E 120000   F     1243                             call    resar8                          
0671 1201CF         1244                             call    flsub                   ; r2..r5(A--AN)
0674 120000   F     1245                             call    move28                  ;r2..r5->r8..r11
0677 900000   F     1246                             mov             dptr,#CHtho     ;000->r2..r5 float
067A 120000   F     1247                             call    ldc_long                
067D 1202B5         1248                             call    fldiv
0680 EA             1249                             mov             a,r2
0681 547F           1250                             anl             a,#7fh
0683 FA             1251                             mov             r2,a
0684 7894           1252                             mov             r0,#koefKm;->koefKm
0686 120000   F     1253                             call    saver2
                    1254                        
                    1255                             ;orl            P5,#01                      ;p5.0=1
0689 E585           1256                             mov             a,P5
068B 4401           1257                             orl             a,#01
068D F585           1258                             mov             P5,a
068F 00             1259                             nop
0690 00             1260                             nop
                    1261                             ;orl            P5,#02h                 ;p5.1=1 
0691 E585           1262                             mov             a,P5
0693 4402           1263                             orl             a,#02
0695 F585           1264                             mov             P5,a
0697 7883           1265                             mov             r0,#chdel
0699 06             1266                             inc             @r0                       ;ch+1
069A 020000   F     1267                        jmp    rebyte
                    1268     
069D B6FF0C         1269     n8delch:        cjne    @r0,#255,n12delch
06A0 7600           1270                             mov             @r0,#0
06A2 7981           1271                             mov             r1,#chavt
06A4 779C           1272                             mov             @r1,#9ch;2eh;10=2ee0h
06A6 09             1273                             inc             r1
06A7 7740           1274                             mov             @r1,#40h;0e0h
06A9 020000   F     1275                             jmp             rebyte
06AC 06             1276     n12delch:       inc             @r0
06AD 020000   F     1277                             jmp             rebyte
                    1278     
06B0 020000   F     1279     rout6:          jmp             out6
06B3 020000   F     1280     rlabelF:        jmp             labelF  
06B6 020000   F     1281     rknrazr:        jmp             knrazr          
                    1282     ;;;;;;;;;;;;
06B9                1283     keyb1:  ;IE6 
06B9 C0E0           1284                                     push    acc
06BB C0D0           1285                                     push    psw
06BD C000           1286                                     push    rr0
06BF C001           1287                                     push    rr1
06C1 C002           1288                                     push    rr2
06C3 C003           1289                                     push    rr3
06C5 C004           1290                                     push    rr4
06C7 C005           1291                                     push    rr5
06C9 C006           1292                                     push    rr6
06CB C007           1293                                     push    rr7
                    1294                       ;;;;;;;;;;;;;;
                    1295                                     ;0,1s
06CD 20B6E0         1296                                     jb              p3.6,rout6
06D0 43B03F         1297                                     orl             p3,#03fh                ; p3.(5-0)<-3f
06D3 30B6DA         1298                                     jnb             p3.6,rout6              ;error
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    21

06D6 3004DA         1299                                     jnb             bitizm,rlabelF
06D9 75B0FE         1300                                     mov             p3,#0feh                ;реж IZM
06DC 30B663         1301                                     jnb             p3.6,izman
06DF 75B0FD         1302                                     mov             p3,#0fdh
06E2 30B6D1         1303                                     jnb             p3.6,rknrazr              ;labelC
06E5 75B0FB         1304                                     mov             p3,#0fbh
06E8 30B62F         1305                                     jnb             p3.6,knright            ;->
06EB 75B0F7         1306                                     mov             p3,#0f7h
06EE 30B67E         1307                                     jnb             p3.6,knopt                      ;T
06F1 75B0EF         1308                                     mov             p3,#0efh
06F4 30B608         1309                                     jnb             p3.6,pyskst                     ;pysk/stop
06F7 75B0DF         1310                                     mov             p3,#0dfh
06FA 30B627         1311                                jnb          p3.6,knvich
06FD 804E           1312                                     jmp             izmpaT
                    1313     
06FF 200A04         1314     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0702 D20A           1315                                     setb    bitbon  ;уст реж буфер вкл
0704 8047           1316                                     jmp             izmpaT
0706 C20A           1317     bufon:                  clr             bitbon  ;уст реж буфер выкл
0708 8043           1318                                     jmp             izmpaT
                    1319     
070A 79B0           1320     tizmri:                 mov             r1,#level
070C B70102         1321                                     cjne    @r1,#1,right2
                    1322                                     ;10s->HET
070F 8004           1323                                     jmp             right3
                    1324     
0711 07             1325     right2:                 inc             @r1
0712 120000   F     1326                                     call    lolevT
                    1327                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0715 120000   F     1328     right3:                 call    ind
0718 8031           1329                                     jmp             izmfun
                    1330     
071A                1331     knright:        
                    1332     
071A 79AE           1333                                     mov             r1,#diap
071C B70002         1334                                     cjne    @r1,#0,diinc
071F 802A           1335                                     jmp  izmfun
                    1336     
0721                1337     diinc:                  ;перекл диапазон 1 поз вверх сбр массив
0721 07             1338                                     inc             @r1
0722 8027           1339                                      jmp  izmfun
                    1340     
0724 200613         1341     knvich:            jb           bitvi11,onvich
0727 C204           1342                                     clr             bitizm
0729 D214           1343                                     setb    bitvich
072B 78B1           1344                                     mov             r0,#vichR
072D 7611           1345                                     mov             @r0,#11h;;????????or 0
                    1346                                     ;ВЫЧИСЛИТЬ
072F 900000   F     1347                                     mov     dptr,#teVICH
0732 120000   F     1348                                     call    lotext
0735 120000   F     1349                                call         ind
0738 803F           1350                                     jmp              viout;izmpaT
                    1351     
073A C214           1352     onvich:                 clr             bitvich
073C 78B1           1353                                     mov             r0,#vichR
073E 7600           1354                                     mov             @r0,#0
0740 800B           1355                                     jmp              izmpaT
                    1356                               ;;;;;;
0742 200404         1357     izman:                  jb              bitizm,knizmon
0745 D204           1358                                     setb    bitizm          ;уст реж ИЗМ ВКЛ
                    1359                                     ;заслать us
                    1360     
0747 8002           1361                                     jmp             izmfun
0749 C204           1362     knizmon:                clr             bitizm          ;уст реж ИЗМ ВЫКЛ
                    1363                                     ;заслать us
074B D208           1364     izmfun:                 setb    bitbuf
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    22

074D                1365     izmpaT:
074D 789A           1366     labelE:                 mov             r0,#parT
074F 793D           1367                                     mov             r1,#chkl
0751 B60108         1368                                     cjne    @r0,#1,izmt2
0754 7700           1369                                     mov             @r1,#0
0756 09             1370                                     inc             r1
0757 7702           1371                                     mov             @r1,#2
0759 020000   F     1372                                     jmp             out6
075C B60208         1373     izmt2:                  cjne    @r0,#2,izmt3
075F 7700           1374                                     mov             @r1,#0
0761 09             1375                                     inc             r1
0762 7714           1376                                     mov             @r1,#20
0764 020000   F     1377                                     jmp             out6
                    1378     
0767 7700           1379     izmt3:                  mov             @r1,#0
0769 09             1380                                     inc             r1
076A 77C8           1381                                     mov             @r1,#200
076C 020000   F     1382                                     jmp             out6
                    1383     
                    1384     
                    1385     
                    1386     
076F                1387     knopt: ;кнопка T
076F C204           1388                                clr          bitizm
0771 D210           1389                                setb         bitt2
0773 120000   F     1390                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
0776 120000   F     1391                                call         ind
                    1392     
0779 793D           1393     viout:          mov             r1,#chkl
077B 7703           1394                             mov             @r1,#03
077D 09             1395                             inc             r1
077E 77E8           1396                             mov             @r1,#0e8h               ;1000
0780 020000   F     1397                             jmp             out6
                    1398     
0783                1399     knrazr:          
0783 C3             1400     labelC:          clr            c
0784 78AF           1401                             mov             r0,#parN
0786 799A           1402                             mov             r1,#parT
0788 7402           1403                             mov             a,#2
078A 97             1404                             subb    a,@r1
078B 40C0           1405                             jc              labelE          ;T>2
078D B60104         1406                             cjne    @r0,#1,noN1c
0790 7602           1407                             mov             @r0,#2          ;N=2
0792 80B9           1408                             jmp             labelE
                    1409     
0794 B6020F         1410     noN1c:          cjne    @r0,#2,not_1
0797 B7010C         1411                             cjne    @r1,#1,not_1
079A C3             1412                             clr             c
079B 78AE           1413                             mov             r0,#diap
079D 7406           1414                             mov             a,#6            ;10-2..10-8
079F 96             1415                             subb    a,@r0
07A0 4004           1416                             jc              not_1       
07A2 7603           1417                             mov             @r0,#3          ;N=3      ;10-2..10-8
07A4 80A7           1418                             jmp             labelE
07A6 7601           1419     not_1:          mov             @r0,#1                          ;N=1
07A8 80A3           1420                             jmp     labelE
                    1421     
07AA 020000   F     1422     rtizmri:        jmp             tizmri
07AD                1423     labelf:                 
07AD 301019         1424                             jnb             bitt2,nofizm
07B0 75B0FB         1425                        mov          p3,#0fbh
07B3 30B613         1426                        jnb          p3.6,outF
07B6 799A           1427                        mov          r1,#parT
07B8 B70107         1428                        cjne         @r1,#1,noft1
07BB 7702           1429                        mov          @r1,#2
07BD 120000   F     1430                        call loadT           ;в буфер 2 записать НЕТ
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    23

                    1431                        ;0,5s
07C0 8001           1432                        jmp          ft1izm
                    1433     
07C2 17             1434     noft1:     dec          @r1
07C3 120000   F     1435     ft1izm:         call    loadT;в буфер 2 записать текст с соотв parT
07C6 120000   F     1436                             call    ind
07C9                1437     outF:;??????????????/
                    1438     
07C9 301460         1439     nofizm:         jnb             bitvich,noviR
07CC 78B1           1440                             mov             r0,#vichR
07CE B60B28         1441                             cjne    @r0,#11,no11v6
07D1 7611           1442                             mov             @r0,#11h                ;11= вычислить
07D3 900000   F     1443                             mov             dptr,#teVICH
07D6 120000   F     1444                             call    lotext
                    1445                             ;;???jmp                outF
07D9 75B0FB         1446     vvrr6:          mov             p3,#0fbh
07DC 20B6EA         1447                             jb              p3.6,outF
07DF B6130A         1448                     cjne    @r0,#13h,nor13
07E2 7611           1449                             mov             @r0,#11h                ;11= вычислить
07E4 900000   F     1450                             mov             dptr,#teVICH
07E7 120000   F     1451     vi1113:         call    lotext  ;в буфер 2 записать текст в соотв с состоянием
07EA 80DD           1452                             jmp             outF
                    1453                     
07EC B60B31         1454     nor13:          cjne    @r0,#11,nor11
07EF 7612           1455                             mov             @r0,#12h
07F1 900000   F     1456                             mov             dptr,#teIZMK    ;       изм конст
07F4 120000   F     1457                         call        lotext             
07F7 80EE           1458                             jmp             vi1113
                    1459     
07F9 B60C02         1460     no11v6:         cjne    @r0,#12,no12v6
07FC 80DB           1461                             jmp             vvrr6
07FE B60D02         1462     no12v6:         cjne    @r0,#13,no13v6
0801 80D6           1463                             jmp             vvrr6
                    1464     
                    1465     
0803 75B0FB         1466     no13v6:         mov             p3,#0fbh
0806 20B60F         1467                             jb              p3.6,chanZ
0809 78B2           1468                             mov             r0,#marker      
080B B60904         1469                             cjne    @r0,#9,mark0_8          ;курсор справа ?
080E 7600           1470                             mov             @r0,#0                          ; уст курсор в кр л
                             евую поз+1
0810 80B7           1471                             jmp             outF
                    1472     
0812 06             1473     mark0_8:        inc             @r0             ;       сдвинуть курсор вправо на 1
0813 B60A00         1474                             cjne    @r0,#10,outma
0816 80B1           1475     outma:          jmp             outF
                    1476     
0818 75B0FE         1477     chanZ:          mov             p3,#0feh
081B 20B602         1478                             jb              p3.6,chanma
                    1479                             ;изм знак в старшем разряде на противоположн
081E 80A9           1480                             jmp             outF
0820                1481     chanma:
                    1482                     
0820                1483     nor11:          ;       выход
0820 7613           1484                     mov             @r0,#13h  ;12->13
0822 900000   F     1485                     mov             dptr,#teOUT
0825 80C0           1486                     jmp             vi1113
                    1487     
                    1488     
                    1489     
0827 C206           1490     yesviR:         clr             bitvi11;????????/
0829 200C00         1491                             jb              bmem11,labelL
082C                1492     noviR:          
                    1493     
                    1494     
                    1495     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    24

                    1496     
                    1497     
082C                1498     labelL:
082C D007           1499     out6:                   pop             rr7     
082E D006           1500                                     pop             rr6
0830 D005           1501                                     pop             rr5
0832 D004           1502                                     pop             rr4
0834 D003           1503                                     pop             rr3
0836 D002           1504                                     pop             rr2
0838 D001           1505                                     pop             rr1                             
083A D000           1506                                     pop             rr0
083C D0D0           1507                                     pop             psw
083E D0E0           1508                                     pop             acc
                    1509     
0840 32             1510                             reti
                    1511     
0841 020000   F     1512     rknMEM:                 jmp             knMEM
0844 020000   F     1513     knKMP:             jmp          out7
0847 020000   F     1514     rout7:                  jmp             out7    
084A 020000   F     1515     rlabelH:                jmp             labelH
084D                1516     keyb2:  ;IE7
084D C0E0           1517                                     push    acc
084F C0D0           1518                                     push    psw
0851 C000           1519                                     push    rr0
0853 C001           1520                                     push    rr1
0855 C002           1521                                     push    rr2
0857 C003           1522                                     push    rr3
0859 C004           1523                                     push    rr4
085B C005           1524                                     push    rr5
085D C006           1525                                     push    rr6
085F C007           1526                                     push    rr7
                    1527                       ;;;;;;;;;;;;;;
                    1528                                ;0,1s
0861 20B7E3         1529                                     jb              p3.7,rout7
0864 43B03F         1530                                     orl             p3,#03fh                ; p3.(5-0)<-3f
0867 30B7DD         1531                                     jnb             p3.7,rout7              ;error
086A 3004DD         1532                                     jnb             bitizm,rlabelH
086D 75B0FE         1533                                     mov             p3,#0feh                ;реж IZM
0870 30B76B         1534                                     jnb             p3.7,knNUL
0873 75B0FD         1535                                     mov             p3,#0fdh
0876 30B7CB         1536                                     jnb             p3.7,knKMP
0879 75B0FB         1537                                     mov             p3,#0fbh
087C 30B74F         1538                                     jnb             p3.7,knleft
087F 75B0F7         1539                                     mov             p3,#0f7h
0882 30B73C         1540                                     jnb             p3.7,knAVP
0885 75B0EF         1541                                 mov         p3,#0efh
0888 30B7B6         1542                                     jnb             p3.7,rknMEM
088B 75B0DF         1543                                     mov             p3,#0dfh
088E 30B722         1544                                     jnb             p3.7,knmenu
0891 799A           1545     an_t7:                  mov             r1,#parT
0893 783D           1546                                     mov             r0,#chkl
0895 B70108         1547                                     cjne    @r1,#1,not1_7
0898 7600           1548                                     mov             @r0,#00
089A 08             1549                                     inc             r0
089B 7602           1550                                     mov             @r0,#2
089D 020000   F     1551                                     jmp             out7
                    1552                             
                    1553     
08A0 B70208         1554     not1_7:                 cjne    @r1,#2,not2_7
08A3 7600           1555                                     mov             @r0,#00
08A5 08             1556                                     inc             r0
08A6 7614           1557                                     mov             @r0,#20
08A8 020000   F     1558                                     jmp             out7
08AB 7600           1559     not2_7:                 mov             @r0,#00
08AD 08             1560                                     inc             r0
08AE 76C8           1561                                     mov             @r0,#200
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    25

08B0 020000   F     1562                                     jmp             out7
                    1563     
                    1564     
08B3 C204           1565     knmenu:                  clr            bitizm          ;off IZM
08B5 900000   F     1566                                     mov             dptr,#teTEST    ;в буф2 записать ТЕСТ-ИЗМЕР
08B8 120000   F     1567                                     call    lotext
08BB 120000   F     1568                                     call    ind
08BE 020000   F     1569                                     jmp             onmem11
                    1570     
08C1 200505         1571     knAVP:                  jb              bitavp,meavp
08C4 D205           1572                                     setb    bitavp
08C6 020000   F     1573                                     jmp             onmem11
08C9 C205           1574     meavp:                  clr             bitavp
08CB 020000   F     1575                                     jmp             onmem11
                    1576     
08CE 79AE           1577     knleft:            mov          r1,#diap
08D0 B70902         1578                                     cjne    @r1,#9,nodi6
08D3 80BC           1579                                     jmp             an_t7
                    1580     
08D5 B700B9         1581     nodi6:                  cjne    @r1,#0,an_t7
08D8 17             1582                                     dec             @r1              ;перекл диапазон 1 поз в с
                             бр массив
08D9 120000   F     1583                                     call    loadUS
08DC 80B3           1584                                jmp          an_t7
                    1585     
08DE 200F0E         1586     knNUL:                  jb              bitnul,ybnul
08E1 D20F           1587                                     setb    bitnul
08E3 789C           1588                                     mov             r0,#rez_A3      ;A3
08E5 120000   F     1589                                     call    resar2
08E8 786A           1590                                     mov             r0,#rez_A0      
08EA 120000   F     1591                                     call    saver2;A0<-A3
08ED 80A2           1592                                     jmp             an_t7
                    1593     
08EF C20F           1594     ybnul:                  clr             bitnul
08F1 900000   F     1595                                      mov    DPTR,#ch0 
08F4 120000   F     1596                                     CALL   ldc_long          ; r2..r5 <-- 0
08F7 786A           1597                                     mov             r0,#rez_A0      ;A0=0
08F9 120000   F     1598                                     call    saver2
08FC 8093           1599                                     jmp             an_t7
                    1600     
08FE 301018         1601     labelH:                 jnb             bitt2,nolah
0901 75B0FB         1602                                     mov             p3,#0fbh
0904 799A           1603                                     mov             r1,#parT
0906 20B778         1604                                     jb              p3.7,hnot1
                    1605                                     
0909 B7066D         1606                                     cjne    @r1,#6,hyest6
090C 07             1607                                     inc             @r1                     ;Tизм+1
                    1608                             
090D 120000   F     1609                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
0910 120000   F     1610     hnot2:                  call    ind
0913 020000   F     1611                                     jmp             out7
                    1612     
                    1613      ;rnoviR:       jmp             noviR
0916 020000   F     1614      rlabelK:       jmp             labelK          
                    1615      ;;;;;;;;;;;;;;;;;;;
0919 3014FA         1616     nolah:          jnb             bitvich,rlabelK 
091C 78B1           1617                             mov             r0,#vichR
091E B61151         1618                             cjne    @r0,#11h,hnor11;labelI
0921 75B0FB         1619                             mov             p3,#0fbh
0924 20B725         1620                             jb              p3.7,noh37;routF
0927 B60B0B         1621                     cjne    @r0,#11,hr12
092A 7613           1622                             mov             @r0,#13h        ;11= вычислить
092C 900000   F     1623                             mov             dptr,#teOUT;teVICH
092F 120000   F     1624     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
0932 020000   F     1625                             jmp             outF
0935 B60C07         1626     hr12:           cjne    @r0,#12,hnor12
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    26

0938 7611           1627                             mov             @r0,#11h
093A 900000   F     1628                             mov             dptr,#teVICH
093D 80F0           1629                             jmp             hvi1113         
093F B60D30         1630     hnor12:         cjne    @r0,#13,hnor11
0942 7612           1631                             mov             @r0,#12h
0944 900000   F     1632                             mov             dptr,#teIZMK    ;       изм конст
0947 120000   F     1633                         call        lotext             
094A 80E3           1634                             jmp             hvi1113
                    1635     
094C 75B0F7         1636     noh37:          mov             p3,#0f7h
094F 30B707         1637                             jnb             p3.7,routF
0952 B60B07         1638                             cjne    @r0,#11,norr11
0955 D214           1639                             setb    bitvich
0957 D204           1640                             setb    bitizm
0959 020000   F     1641     routF:          jmp             outF
                    1642     
095C B60C0D         1643     norr11:         cjne    @r0,#12,norr12
095F D215           1644                             setb    bitvi21
0961 900000   F     1645                             mov             dptr,#teAequ0
0964 120000   F     1646                             call    lotext
0967 120000   F     1647                             call    ind
096A 80ED           1648                             jmp             routF;???????//
                    1649     
096C C214           1650     norr12:         clr             bitvich
096E D204           1651                             setb    bitizm
0970 80E7           1652                             jmp             routF;???????//
                    1653     
0972 B61202         1654     hnor11:         cjne    @r0,#12h,hnor13
0975 80BE           1655                             jmp             hr12
0977 80C6           1656     hnor13:         jmp             hnor12          
                    1657                                     
                    1658                     
                    1659     
                    1660     
                    1661     
                    1662     ;;;;;;;;;;;;;;;;;
                    1663     
0979 900000   F     1664     hyest6:                 mov             dptr,#teNO
097C 120000   F     1665                                     call    lotext          ;в буфер2 записать НЕТ
                    1666                                     ;загрузить буфер 2 в инд
                    1667                                     ;0,5s
097F 808F           1668                                      jmp    hnot2
                    1669     
                    1670     
0981 75B0F7         1671     hnot1:                  mov             p3,#0f7h
0984 20B72F         1672                                     jb              p3.7,out7
0987 B70117         1673                                     cjne    @r1,#1,nohnot1
098A B70212         1674                                     cjne    @r1,#2,nohnot2
                    1675                                     ;в буфере 1 зажечь 1s
098D                1676     loadB:                  ;установить B1,B2 в соотв с Tизм   ??????
098D 120000   F     1677                                     call    iniacp;инициализация АЦП
0990 C3             1678                                      clr            c
0991 799A           1679                                  mov                r1,#parT
0993 7403           1680                                  mov                a,#3
0995 97             1681                                 subb                a,@r1
0996 4002           1682                                 jc                  loadB2;T>=2
                    1683                                     ;N=1
0998 801C           1684                                     jmp             out7
099A B70219         1685     loadB2:                 cjne    @r1,#2,out7
                    1686     ;N=2
099D 8017           1687                                     jmp             out7
099F                1688     nohnot2:                ;в буфере 1 зажечь <=0,1s
099F 80EC           1689                                     jmp             loadB
09A1                1690     nohnot1:                ;в буфере 1 зажечь 10s
09A1 80EA           1691                                     jmp             loadB
                    1692     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    27

09A3 C204           1693     knMEM:                  clr             bitizm          ;off IZM
09A5 120000   F     1694                                     call    lotext    ;в буф2 записать ОЧИСТКА
09A8 120000   F     1695                                     call    ind
09AB D20C           1696                                     setb    bmem11     ;ПАМ11
09AD 783D           1697     onmem11:                mov             r0,#chkl
09AF 7603           1698                                     mov             @r0,#03
09B1 08             1699                                     inc             r0
09B2 76E8           1700                                     mov             @r0,#0e8h               ;1000
09B4 8000           1701                                     jmp             out7
09B6                1702     labelK:
09B6                1703     labelI:
09B6 D007           1704     out7:              pop          rr7     
09B8 D006           1705                                     pop             rr6
09BA D005           1706                                     pop             rr5
09BC D004           1707                                     pop             rr4
09BE D003           1708                                     pop             rr3
09C0 D002           1709                                     pop             rr2
09C2 D001           1710                                     pop             rr1                             
09C4 D000           1711                                     pop             rr0
09C6 D0D0           1712                                     pop             psw
09C8 D0E0           1713                                     pop             acc
                    1714     
09CA 32             1715                                     reti
                    1716     
09CB 79AE           1717     loadUS:         mov             r1,#diap
09CD E7             1718                             mov             a,@r1
09CE 23             1719                             rl              a;*2
09CF FC             1720                             mov             r4,a                    ;save a
09D0 900000   F     1721                             mov             dptr,#tabus
09D3 93             1722                             movc    a,@a+dptr
09D4 FA             1723                             mov             r2,a                    ;high byte
09D5 E584           1724                             mov             a,p4
09D7 5401           1725                             anl             a,#01
09D9 4A             1726                             orl             a,r2
09DA F584           1727                             mov             p4,a
09DC 0C             1728                             inc             r4
09DD EC             1729                             mov             a,r4
09DE 93             1730                             movc    a,@a+dptr
09DF FB             1731                             mov             r3,a                    ;low byte
09E0 E585           1732                             mov             a,p5
09E2 5407           1733                             anl             a,#07
09E4 4B             1734                             orl             a,r3
09E5 F585           1735                             mov             p5,a
09E7 22             1736                             ret
                    1737     
                    1738     
09E8 88D8           1739     tabus:     db           88h,0d8h         ;10-2
09EA 88E8           1740                             db      88h,0e8h         ;10-3
09EC 88D0           1741                             db              88h,0d0h         ;10-4
09EE 88E0           1742                             db              88h,0e0h         ;10-5
09F0 92D8           1743                             db      92h,0d8h         ;10-6
09F2 92E8           1744                             db              92h,0e8h         ;10-7
09F4 A4D8           1745                             db              0a4h,0d8h        ;10-8
09F6 A4E8           1746                             db      0a4h,0e8h        ;10-9
09F8 C0D8           1747                             db              0c0h,0d8h        ;10-10
09FA C0E8           1748                             db              0c0h,0e8h        ;10-11
                    1749     
                    1750     ;загрузка текста в буфер 2 bufind+0..bufind9
                    1751     ;в зав от parT (Tизм)
09FC 799A           1752     loadT:          mov             r1,#parT
09FE 7840           1753     lolevT:         mov             r0,#bufind+0
0A00 7B09           1754                             mov             r3,#9
0A02 75F009         1755                             mov             b,#9
0A05 E7             1756                             mov             a,@r1
0A06 A4             1757                             mul             ab
0A07 FC             1758                             mov             r4,a                    ;save a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    28

0A08 900000   F     1759                             mov             dptr,#textT
0A0B 93             1760             lod1:   movc    a,@a+dptr
0A0C F6             1761                             mov             @r0,a
0A0D 08             1762                             inc             r0
0A0E 0C             1763                             inc             r4
0A0F EC             1764                             mov             a,r4
0A10 DBF9           1765                             djnz    r3,lod1
0A12 22             1766                             ret             
                    1767     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                    1768     ;dptr-адр строки текста         
0A13                1769     lotext:         
0A13 7B09           1770                             mov             r3,#9
0A15 7840           1771                             mov             r0,#bufind+0
0A17 E4             1772     lodt:           clr             a
0A18 93             1773                             movc    a,@a+dptr
0A19 F6             1774                             mov             @r0,a
0A1A 08             1775                             inc             r0
0A1B A3             1776                             inc             dptr
0A1C DBF9           1777                             djnz    r3,lodt
0A1E 22             1778                             ret             
                    1779     
                    1780     
0A1F FFFF543D       1781        textT:       db              0ffh,0ffh,"T","=",31h,"S",0ffh,0ffh,0ffh         ;0
0A23 3153FFFF                
0A27 FF                      
0A28 FFFF543D       1782                             db              0ffh,0ffh,"T","=",31h,30h,"S",0ffh,0ffh          ;1
0A2C 313053FF                
0A30 FF                      
0A31 FFFFFF48       1783        teNO:        db              0ffh,0ffh,0ffh,"H","E","T",0ffh,0ffh,0ffh        ;2
0A35 4554FFFF                
0A39 FF                      
0A3A FFFF302E       1784                             db              0ffh,0ffh,30h,".",31h,"S",0ffh,0ffh,0ffh         ;3
0A3E 3153FFFF                
0A42 FF                      
0A43 FFFF3530       1785                             db              0ffh,0ffh,35h,30h,"m","S",0ffh,0ffh,0ffh         ;4
0A47 6D53FFFF                
0A4B FF                      
0A4C FFFF3130       1786                             db              0ffh,0ffh,31h,30h,"m","S",0ffh,0ffh,0ffh         ;5
0A50 6D53FFFF                
0A54 FF                      
0A55 FFFFFF32       1787                             db              0ffh,0ffh,0ffh,32h,"m","S",0ffh,0ffh,0ffh        ;6
0A59 6D53FFFF                
0A5D FF                      
                    1788     
0A5E C2DBD7C8       1789      teVICH:        db              'В','Ы','Ч','И','С','Л','И','Т','Ь'
0A62 D1CBC8D2                
0A66 DC                      
0A67 FF413D2B       1790      teAequ0:       db              0ffh,'A','=','+',30h,30h,30h,30h,0ffh,0ffh
0A6B 30303030                
0A6F FFFF                    
0A71 FF423D2B       1791      teBequ0:       db              0ffh,'B','=','+',30h,30h,30h,30h,0ffh,0ffh
0A75 30303030                
0A79 FFFF                    
0A7B FFFF4D45       1792      teMENU:        db      0ffh,0ffh,'M','E','H','Ю',0ffh,0ffh,0ffh
0A7F 48DEFFFF                
0A83 FF                      
                    1793     
0A84 FFFF5445       1794      teTEST:        db      0ffh,0ffh,'T','E','C','T',0ffh,0ffh,0ffh
0A88 4354FFFF                
0A8C FF                      
                    1795     
0A8D FF4B41CB       1796      teKALIB:        db     0ffh ,'K','A','Л','И','Б','P',0ffh,0ffh
0A91 C8C150FF                
0A95 FF                      
0A96 C8C7CCC8       1797      teIZMK:        db      'И','З','М','И',0ffh,'О','Н','С','Т'
0A9A FFCECDD1                
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    29

0A9E D2                      
0A9F FFFFC2DB       1798      teOUT:         db      0ffh,0ffh,'В','Ы','Х','О','Д',0ffh,0ffh
0AA3 D5CEC4FF                
0AA7 FF                      
                    1799     
                    1800      ;;;;;;;;;;;;;;;;;;;         
                    1801     ;управление AD7731
0AA8 7403           1802     iniacp:         mov             a,#03
0AAA 120000   F     1803                             call    write
0AAD 7440           1804                             mov             a,#40h;b1=40h;80h
0AAF 120000   F     1805                             call    write
0AB2 7404           1806                             mov             a,#04;b2=04
0AB4 120000   F     1807                             call    write
0AB7 7402           1808                             mov             a,#02
0AB9 120000   F     1809                             call    write
0ABC 74A1           1810                             mov             a,#0a1h
0ABE 120000   F     1811                             call    write
0AC1 7474           1812                             mov             a,#74h
0AC3 120000   F     1813                             call    write
0AC6 2093FD         1814                             jb              p1.3,$
0AC9 7402           1815                             mov             a,#02
0ACB 120000   F     1816                             call    write
0ACE 7481           1817                             mov             a,#81h
0AD0 120000   F     1818                             call    write
0AD3 7474           1819                             mov             a,#74h
0AD5 120000   F     1820                             call    write
0AD8 2093FD         1821                             jb              p1.3,$
0ADB 7402           1822                             mov             a,#02
0ADD 120000   F     1823                             call    write
0AE0 7421           1824                             mov             a,#21h
0AE2 120000   F     1825                             call    write
0AE5 7474           1826                             mov             a,#74h
0AE7 120000   F     1827                             call    write
0AEA 22             1828                             ret
                    1829                             ;;;;;;;;;;;;;;;;
                    1830     
0AEB                1831      vvchif:;       clr     cellbi2.1
0AEB E5B2           1832                             mov             a,marker                        ;изм цифры
                    1833     ;                       mov             r0,#makoi                       ;0000
0AED 28             1834                             add             a,r0
0AEE F8             1835                             mov             r0,a
0AEF 06             1836                             inc             @r0
0AF0 B60A02         1837                             cjne    @r0,#0ah,chif
0AF3 7600           1838                             mov     @r0,#0
0AF5 22             1839     chif:           ret
                    1840     
                    1841     
                    1842     ;загрузка коф KD в зависимости от диапазона
0AF6                1843     loadKD:
                    1844     ;;;;;;;;;;;;
                    1845      ;;;;;;;;;;;;;;
                    1846     ;r7-количество байт
                    1847     ;dptr-адр 1-й ячейки сектора
                    1848     ;
0AF6                1849     cle256:
                    1850                              ; push rr7                                             ;стирание r
                             7 байт(запись в ячейки ff)
                    1851                                                             
0AF6 758F02         1852     mm3:            MOV             PSCTL,#02
                    1853                                     
0AF9 758F03         1854                                     MOV             PSCTL,#03
0AFC 75B6A5         1855                                     mov             FLSCL,#0a5h
0AFF 75B6F1         1856                                     mov             FLSCL,#0f1h
                    1857                                             
0B02 74FF           1858                                     mov             a,#0ffh
0B04 F0             1859                                     movx    @dptr,a                         ;wr
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    30

0B05 22             1860                                     ret
                    1861                                     
                    1862     ;;;;;;;;;;;;;;
                    1863     ;r7-количество байт
                    1864     ;dptr-адр ячейки для записи
                    1865     ;r1-адр ячейки
0B06                1866     wr4bait:
0B06                1867     mm5:
0B06 758F03         1868                             MOV             PSCTL,#03;00                            ;обязательн
                             о для каждого записи байта
                    1869                                     
0B09 758F01         1870                                     MOV             PSCTL,#01                       ;обязательн
                             о для каждого записи байта
                    1871     ;                               mov             FLKEY,#0a5h             ;обязательно для ка
                             ждого записи байта
                    1872     ;                               mov             FLKEY,#0f1h             ;обязательно для ка
                             ждого записи байта
                    1873                                             
0B0C E7             1874                               mov   a,@r1
0B0D F0             1875                                     movx    @dptr,a                         ;wr
0B0E A3             1876                                     inc             dptr
0B0F 09             1877                                     inc             r1
0B10 DFF4           1878                                     djnz    r7,mm5
0B12 22             1879                                     ret
                    1880     
                    1881     ;чтение памяти программ в r8..r11
                    1882     ;вх-r2,r3-адр яч памяти прогр
0B13 8A83           1883     re4byte:        mov                     dph,r2
0B15 8B82           1884                                             mov                     dpl,r3
0B17 E4             1885                                             clr                     a
0B18 93             1886                                             movc            a,@a+dptr
0B19 F508           1887                                             mov                     r8,a
0B1B A3             1888                                             inc                     dptr
0B1C E4             1889                                             clr                     a
0B1D 93             1890                                             movc            a,@a+dptr
0B1E F509           1891                                             mov                     r9,a
0B20 A3             1892                                             inc                     dptr
0B21 E4             1893                                             clr                     a
0B22 93             1894                                             movc            a,@a+dptr
0B23 F50A           1895                                             mov                     r10,a
0B25 A3             1896                                             inc                     dptr
0B26 E4             1897                                             clr                     a
0B27 93             1898                                             movc            a,@a+dptr
0B28 F50B           1899                                             mov                     r11,a                      
                                                  ;r8..r11
0B2A 22             1900                                             ret
                    1901     
                    1902     
                    1903     
                    1904     
                    1905     
                    1906                                                             
                    1907     
                    1908     ;;;;;;;;;;;;;
                    1909     ;r7-количество байт
                    1910     ;dptr-адр ячейки для записи
                    1911     ;r1-адр ячейки
                    1912     
0B2B                1913     wrpage:
0B2B                1914     WW5:
0B2B 75A800         1915                             mov             IE,#0
0B2E 75B601         1916                             MOV             FLSCL,#01;FLWE(FLSCL.0)обязательно для каждого запи
                             си байта
                    1917                                     
0B31 758F03         1918                             MOV             PSCTL,#03;FLWE(PSCTL.1,.0)обязательно для каждого з
                             аписи байта
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    31

0B34 758F00         1919                             MOV             PSCTL,#00
0B37 E3             1920                             movx    a,@r1
0B38 758F01         1921                             MOV             PSCTL,#01
0B3B F0             1922                             movx    @dptr,a                         ;wr
0B3C 758F00         1923                             MOV             PSCTL,#00
0B3F A3             1924                             inc             dptr
0B40 09             1925                             inc             r1
0B41 DFE8           1926                             djnz    r7,WW5
0B43 75A880         1927                             mov             IE,#80h
0B46 22             1928                             ret
                    1929                             
                    1930     ;;;;;;;;;;;;;;;;;;;;;;;;;
                    1931     ;чтение памяти программ во внешнее озу
                    1932     ;вх-r2,r3-адр яч памяти прогр
                    1933     ;r1- яч внешнее озу
0B47 8A83           1934     copyPP:         mov                     dph,r2
0B49 8B82           1935                                             mov                     dpl,r3
0B4B 7FFF           1936                                             mov                     r7,#0ffh
0B4D E4             1937     copy1:          clr                     a
0B4E 93             1938                                             movc            a,@a+dptr
0B4F F3             1939                                             movx                    @r1,a
0B50 A3             1940                                             inc                     dptr
0B51 09             1941                                             inc                     r1
0B52 DFF9           1942                                             djnz            r7,copy1
0B54 22             1943                                             ret
                    1944     ;;;;;;;;;;;;;;;;;;;;;;;;;
                    1945     
                    1946                                     
                    1947     
                    1948     
                    1949     
                    1950     ;$include (d:\amp\subr1.asm) 
                +1  1951      ;in-r1-count
0B55            +1  1952     chdec:          ;mov            r1,#chavt               ;chavt-1
0B55 E7         +1  1953                             mov             a,@r1
0B56 FC         +1  1954                             mov             r4,a
0B57 09         +1  1955                             inc             r1
0B58 E7         +1  1956                             mov             a,@r1
0B59 FD         +1  1957                             mov             r5,a
0B5A C202       +1  1958                             clr             rr2
0B5C C203       +1  1959                             clr             rr3
0B5E 900000   F +1  1960                             mov             dptr,#ch1        
0B61 120000   F +1  1961                             call    ldc_ltemp
0B64 120000   F +1  1962                             call    lsub
0B67 ED         +1  1963                             mov             a,r5
0B68 F7         +1  1964                             mov             @r1,a
0B69 19         +1  1965                             dec             r1
0B6A EC         +1  1966                             mov             a,r4
0B6B F7         +1  1967                             mov             @r1,a
0B6C 22         +1  1968                             ret      
                +1  1969     
                +1  1970     
                +1  1971     
                +1  1972     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
0B6D 784B       +1  1973      ind:    mov            r0,#bufind+11
0B6F 7F0C       +1  1974                      mov            r7,#12
0B71 C286       +1  1975      nexin: clr             p0.6
0B73 E6         +1  1976                     mov             a,@r0
0B74 F59B       +1  1977                     mov             SPI0DAT,a
0B76 20FBFD     +1  1978                     jb              TXBSY,$
0B79 D286       +1  1979                     setb    p0.6
0B7B 120000   F +1  1980                     call    z_9
0B7E 18         +1  1981                     dec             r0
0B7F DFF0       +1  1982                     djnz    r7,nexin
0B81 22         +1  1983                ret
                +1  1984     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    32

0B82 7A08       +1  1985     zapadc:   mov R2,#8
0B84 D297       +1  1986     sdv:      setb P1.7
0B86 33         +1  1987               rlc A
0B87 9296       +1  1988                     mov P1.6,C
0B89 120000   F +1  1989                     call tim2
                +1  1990                                     
0B8C C297       +1  1991                     clr P1.7
0B8E 120000   F +1  1992                     call tim2
0B91 DAF1       +1  1993                     djnz R2,sdv
0B93 D296       +1  1994                     setb P1.6
0B95 22         +1  1995                     ret
                +1  1996     
0B96 7A08       +1  1997     chtadc:   mov R2,#8
0B98 D297       +1  1998     sdv1:     setb P1.7
0B9A 120000   F +1  1999               call tim2
0B9D C297       +1  2000                     clr P1.7
0B9F A296       +1  2001                     mov C,P1.6
0BA1 33         +1  2002                     rlc A
0BA2 120000   F +1  2003                     call tim2
0BA5 DAF1       +1  2004                     djnz R2,sdv1
0BA7 22         +1  2005                     ret
                +1  2006     
0BA8 7E30       +1  2007     tim:      mov R6,#30h;38h
0BAA DEFE       +1  2008     tim1:     djnz R6,tim1
0BAC 22         +1  2009               ret
                +1  2010               
0BAD 7E10       +1  2011     tim2:     mov R6,#10h;14h
0BAF DEFE       +1  2012     tim3:     djnz R6,tim3
0BB1 22         +1  2013               ret
                +1  2014     
                +1  2015     ;запись из acc
0BB2 C3         +1  2016     write_x1: clr   c
0BB3            +1  2017     writeD_x1:
0BB3 92B1       +1  2018                       mov P3.1,c        ;запись
0BB5 F5A0       +1  2019               mov P2,A
0BB7 D2B3       +1  2020                       setb P3.3
0BB9 120000   F +1  2021                       call z_5
0BBC C2B3       +1  2022                       clr P3.3
0BBE 75A0FF     +1  2023                       mov P2,#0FFh
0BC1 22         +1  2024                       ret
                +1  2025     
                +1  2026     ;чтение в acc
0BC2 C3         +1  2027     read_x2:  clr   c  
0BC3 92B1       +1  2028               mov P3.1,c        ;чтение
0BC5 D2B2       +1  2029               setb P3.2
0BC7 D2B3       +1  2030                       setb P3.3
0BC9 120000   F +1  2031                     call z_5
0BCC E5A0       +1  2032                       mov A,P2
0BCE C2B3       +1  2033                       clr P3.3
0BD0 C2B2       +1  2034                       clr P3.2
0BD2 22         +1  2035                       ret
                +1  2036     
                +1  2037     
0BD3 120000   F +1  2038     loop:     call read_x2;x2    ;ожидание флага готовности
0BD6 20E7FA     +1  2039                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
0BD9 22         +1  2040                        ret           ;возврат, если бит А(7)<>1
                +1  2041                                      
                +1  2042                                        
                +1  2043     
                +1  2044     ;задержка 100 мкс
0BDA 7978       +1  2045     z_100:    mov R1,#78h     ;загрузка первого числа
0BDC 7A02       +1  2046     z100:     mov R2,#2h     ;загрузка второго числа
0BDE DAFE       +1  2047     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
0BE0 D9FA       +1  2048               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
0BE2 22         +1  2049               ret           
                +1  2050     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    33

                +1  2051     ;задержка 34 мкс
0BE3 7B8B       +1  2052     z_5:      mov R3,#8Bh      ;загрузка числа
0BE5 DBFE       +1  2053     ct:       djnz R3,ct
0BE7 22         +1  2054               ret
                +1  2055     
                +1  2056     ;задержка 15 мс
0BE8 79FA       +1  2057     z_15:     mov R1,#0FAh    ;загрузка первого числа
0BEA 7AED       +1  2058     z15:      mov R2,#0EDh   ;загрузка второго числа
0BEC DAFE       +1  2059     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
0BEE D9FA       +1  2060               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
0BF0 22         +1  2061               ret   
                +1  2062                                               
                +1  2063     ;????????
                +1  2064     ;задержка 1с
0BF1 7D1F       +1  2065     z_1s:   mov             r5,#01fh 
0BF3 7EFF       +1  2066     co2s:   mov     R6,#0ffh     
0BF5 7FFF       +1  2067     z1s:     mov    R7,#0ffh     
0BF7 DFFE       +1  2068     co1s:   djnz    R7, co1s        
0BF9 DEFA       +1  2069             djnz    R6, z1s 
0BFB DDF6       +1  2070                     djnz    r5,co2s
0BFD 22         +1  2071               ret           
                +1  2072     
0BFE 7D6F       +1  2073      z_ss:   mov            r5,#06fh 
0C00 7EFF       +1  2074     coss:   mov     R6,#0ffh     
0C02 7FFF       +1  2075     zss:     mov    R7,#0ffh     
0C04 DFFE       +1  2076     cozs:   djnz    R7, cozs        
0C06 DEFA       +1  2077             djnz    R6, zss 
0C08 DDF6       +1  2078                     djnz    r5,coss
0C0A 22         +1  2079               ret           
                +1  2080     ;dptr+4-приемник
                +1  2081     ;dptr-источник
                +1  2082     ;r7-кол байт  
0C0B            +1  2083     xCIKLWR:
0C0B 7F04       +1  2084                             mov             r7,#4   
0C0D E0         +1  2085     lwrx:   movx    a,@dptr
0C0E C083       +1  2086                             push    dph
0C10 C082       +1  2087                             push    dpl
0C12 A3         +1  2088                             inc             dptr
0C13 A3         +1  2089                             inc             dptr
0C14 A3         +1  2090                             inc             dptr
0C15 A3         +1  2091                             inc             dptr
0C16 F0         +1  2092                             movx    @dptr,a
0C17 D082       +1  2093                             pop             dpl
0C19 D083       +1  2094                             pop             dph
                +1  2095                             
0C1B A3         +1  2096                             inc             dptr
0C1C DFEF       +1  2097                             djnz    r7,lwrx
0C1E 22         +1  2098                             ret
                +1  2099     ;r2..r5->@dptr..@dptr+3                         
0C1F EA         +1  2100     saveIr2:                mov     a,r2
0C20 F0         +1  2101                                             movx    @dptr,a
0C21 A3         +1  2102                                             inc     dptr
0C22 EB         +1  2103                                             mov     a,r3
0C23 F0         +1  2104                                             movx    @dptr,a
0C24 A3         +1  2105                                             inc     dptr
0C25 EC         +1  2106                                             mov     a,r4
0C26 F0         +1  2107                                             movx    @dptr,a
0C27 A3         +1  2108                                             inc     dptr
0C28 ED         +1  2109                                             mov     a,r5
0C29 F0         +1  2110                                             movx    @dptr,a
0C2A 22         +1  2111                                             ret
                +1  2112     ;r2..r5-> @r0..@r0+3
                +1  2113     
0C2B EA         +1  2114     saver2:         mov     a,r2
0C2C F6         +1  2115                                             mov     @r0,a
0C2D 08         +1  2116                                             inc     r0
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    34

0C2E EB         +1  2117                                             mov     a,r3
0C2F F6         +1  2118                                             mov     @r0,a
0C30 08         +1  2119                                             inc     r0
0C31 EC         +1  2120                                             mov     a,r4
0C32 F6         +1  2121                                             mov     @r0,a
0C33 08         +1  2122                                             inc     r0
0C34 ED         +1  2123                                             mov     a,r5
0C35 F6         +1  2124                                             mov     @r0,a
0C36 22         +1  2125                                             ret 
                +1  2126     ;r8..r11-> @r0..@r0+3
                +1  2127     
0C37 E508       +1  2128     saver8:         mov     a,r8
0C39 F6         +1  2129                                             mov     @r0,a
0C3A 08         +1  2130                                             inc     r0
0C3B E509       +1  2131                                             mov     a,r9
0C3D F6         +1  2132                                             mov     @r0,a
0C3E 08         +1  2133                                             inc     r0
0C3F E50A       +1  2134                                             mov     a,r10
0C41 F6         +1  2135                                             mov     @r0,a
0C42 08         +1  2136                                             inc     r0
0C43 E50B       +1  2137                                             mov     a,r11
0C45 F6         +1  2138                                             mov     @r0,a
0C46 22         +1  2139                                             ret 
                +1  2140     
0C47 7F28       +1  2141     clmassix:       mov                     r7,#28h
0C49 900080     +1  2142                             mov     dptr,#MASS0        ;забить массив A нулями
0C4C 7400       +1  2143     clmax:          mov          a,#00h
0C4E F0         +1  2144                  movx    @dptr,a
0C4F A3         +1  2145                  inc     dptr
0C50 DFFA       +1  2146                 djnz                r7,clmax                
0C52 F56E       +1  2147                  mov     chmas,a
0C54 C201       +1  2148                  clr     bitmas
0C56 22         +1  2149                 ret
                +1  2150     
                +1  2151     ;r1-яЁшхьшъ
                +1  2152     ;r0-шёЄюўшъ
                +1  2153     ;r7-ъюы срщЄ  
0C57            +1  2154     CIKLWR:
0C57 7F04       +1  2155                             mov             r7,#4   
0C59 E6         +1  2156     lwr:    mov     a,@r0
0C5A F7         +1  2157                             mov     @r1,a
0C5B 09         +1  2158                             inc             r1
0C5C 08         +1  2159                             inc             r0
0C5D DFFA       +1  2160                             djnz    r7,lwr
0C5F 22         +1  2161                             ret     
                +1  2162     ;r2..r5-> @dptr..@dptr+3
                +1  2163     
0C60 120000   F +1  2164     zmul:   call    maform
0C63 120000   F +1  2165                     call    lmul
0C66 120000   F +1  2166                     call    bform
0C69 22         +1  2167                     ret
                +1  2168     
0C6A 120000   F +1  2169     zdiv:   call    maform
0C6D 120000   F +1  2170                     call    divide
0C70 120000   F +1  2171                     call    bform
0C73 22         +1  2172                     ret
                +1  2173     
0C74 EA         +1  2174     maform: mov a,r2
0C75 33         +1  2175             rlc a
0C76 5006       +1  2176             jnc             fo1m
0C78 D202       +1  2177                     setb            znmat
0C7A 120000   F +1  2178                     call   form4
0C7D 22         +1  2179                     ret
0C7E C202       +1  2180     fo1m:   clr             znmat
0C80 22         +1  2181                     ret
                +1  2182     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    35

0C81 300203     +1  2183     bform:  jnb             znmat,fo2m
0C84 120000   F +1  2184                     call    form4
0C87 22         +1  2185     fo2m:   ret
                +1  2186       
                +1  2187     ;r2..r5 яхЁхтхёЄш т фюя ъюф
0C88 ED         +1  2188     form4:          mov a,r5
0C89 F4         +1  2189             cpl a
0C8A 2401       +1  2190             add a,#1
0C8C FD         +1  2191             mov r5,a
0C8D EC         +1  2192             mov a,r4
0C8E F4         +1  2193             cpl a
0C8F 3400       +1  2194             addc    a,#0
0C91 FC         +1  2195             mov r4,a
0C92 EB         +1  2196             mov a,r3
0C93 F4         +1  2197                 cpl a
0C94 3400       +1  2198             addc    a,#0
0C96 FB         +1  2199             mov r3,a
0C97 EA         +1  2200             mov a,r2
0C98 F4         +1  2201             cpl a
0C99 3400       +1  2202             addc    a,#0
0C9B FA         +1  2203             mov r2,a
0C9C 22         +1  2204             ret
                +1  2205     
0C9D 120000   F +1  2206     zcmp:   call            maform
0CA0 120000   F +1  2207                     call            lcmp
0CA3 C0D0       +1  2208                     push            psw
0CA5 120000   F +1  2209                     call    bform
0CA8 D0D0       +1  2210                     pop             psw
0CAA 22         +1  2211                     ret
                +1  2212     
                +1  2213     
                +1  2214     ;@r0..@r0+3->r8..r11
                +1  2215     
0CAB E6         +1  2216     resar8: mov     a,@r0
0CAC F508       +1  2217                     mov     ltemp,a
0CAE 08         +1  2218                     inc     r0
0CAF E6         +1  2219                     mov     a,@r0
0CB0 F509       +1  2220                     mov     ltemp+1,a
0CB2 08         +1  2221                     inc     r0
0CB3 E6         +1  2222                     mov     a,@r0
0CB4 F50A       +1  2223                     mov     ltemp+2,a
0CB6 08         +1  2224                     inc     r0
0CB7 E6         +1  2225                     mov     a,@r0
0CB8 F50B       +1  2226                     mov     ltemp+3,a
0CBA 22         +1  2227                     ret
                +1  2228     
                +1  2229     ;
                +1  2230     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                +1  2231     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                +1  2232     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                +1  2233     ;r2 a    ўшёыю 180
                +1  2234     ;00 b4
                +1  2235     ;т_ї- mabin..mabin+2
                +1  2236     ;     80 01 00
                +1  2237      
0CBB C8         +1  2238     cond:   xch     a,r0    
0CBC F9         +1  2239                     mov     r1,a
0CBD C8         +1  2240                     xch     a,r0
0CBE 7C03       +1  2241                     mov     r4,#03
0CC0 7700       +1  2242     dcoa:   mov     @r1,#00
0CC2 09         +1  2243                     inc     r1
0CC3 DCFB       +1  2244                     djnz    r4,dcoa
0CC5 7B10       +1  2245                     mov     r3,#10h
0CC7 C3         +1  2246     dcob:   clr     c
0CC8 33         +1  2247                     rlc     a
0CC9 CA         +1  2248                     xch     a,r2
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    36

0CCA 33         +1  2249                     rlc     a
0CCB CA         +1  2250                     xch     a,r2
0CCC C8         +1  2251                     xch     a,r0
0CCD F9         +1  2252                     mov     r1,a
0CCE C8         +1  2253                     xch     a,r0
0CCF 7C03       +1  2254                     mov     r4,#03
0CD1 FD         +1  2255                     mov     r5,a
0CD2 E7         +1  2256     dcoc:   mov     a,@r1 
0CD3 37         +1  2257                     addc    a,@r1
0CD4 D4         +1  2258                     da      a
0CD5 F7         +1  2259                     mov     @r1,a
0CD6 09         +1  2260                     inc     r1
0CD7 DCF9       +1  2261                     djnz    r4,dcoc
0CD9 ED         +1  2262                     mov     a,r5
0CDA 4003       +1  2263                     jc      dcod
0CDC DBE9       +1  2264                     djnz    r3,dcob
0CDE C3         +1  2265                     clr     c
0CDF 00         +1  2266     dcod:   nop
0CE0 22         +1  2267                     ret
                +1  2268     
0CE1 8A08       +1  2269     move28: mov     ltemp,r2                        ;r2..r5->ltemp
0CE3 850309     +1  2270                     mov     ltemp+1,3
0CE6 85040A     +1  2271                     mov     ltemp+2,4
0CE9 85050B     +1  2272                     mov     ltemp+3,5
0CEC 22         +1  2273                     ret
                +1  2274     
                +1  2275     ;@r0..@r0+3->r2..r5
                +1  2276     
0CED E6         +1  2277     resar2: mov     a,@r0
0CEE FA         +1  2278                     mov     r2,a
0CEF 08         +1  2279                     inc     r0
0CF0 E6         +1  2280                     mov     a,@r0
0CF1 FB         +1  2281                     mov     r3,a
0CF2 08         +1  2282                     inc     r0
0CF3 E6         +1  2283                     mov     a,@r0
0CF4 FC         +1  2284                     mov     r4,a
0CF5 08         +1  2285                     inc     r0
0CF6 E6         +1  2286                     mov     a,@r0
0CF7 FD         +1  2287                     mov     r5,a
0CF8 22         +1  2288                     ret
                +1  2289     
                +1  2290     ;25mkc !!!!!!!!!!!!!!!1
0CF9 7B4B       +1  2291     z_9:      mov R3,#4Bh      ;загрузка числа
0CFB DBFE       +1  2292                    djnz R3,$
0CFD 22         +1  2293               ret
                +1  2294     
                +1  2295     ;запись   передаваемый байт в acc
                +1  2296     ;передача байта послед кодом старшими разрядами  вперед
0CFE 7A08       +1  2297     write:     mov R2,#8
0D00 C3         +1  2298                             clr  c  
0D01 C292       +1  2299     wr1:            clr             P1.2
0D03 00         +1  2300                         nop 
0D04 33         +1  2301                             rlc A
0D05 9291       +1  2302                             mov P1.1,C
0D07 120000   F +1  2303                        call tim2
0D0A D292       +1  2304                        setb P1.2
0D0C 120000   F +1  2305                call tim2
0D0F DAF0       +1  2306                       djnz R2,wr1
0D11 C291       +1  2307                       clr P1.1
0D13 22         +1  2308                      ret
                +1  2309     
                +1  2310     ;принимаемый байт в acc
                +1  2311     ;прием байта последовательным кодом старшими разрядами вперед
0D14 7A08       +1  2312     read:    mov R2,#8
0D16 C292       +1  2313     re1:     clr P1.2
0D18 120000   F +1  2314              call tim2        ;5mks
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    37

0D1B A290       +1  2315                     mov C,P1.0
0D1D 33         +1  2316                     rlc A           
0D1E D292       +1  2317                     setb P1.2
0D20 120000   F +1  2318                     call tim2
0D23 DAF1       +1  2319                     djnz R2,re1
0D25 22         +1  2320                     ret
                +1  2321     
                +1  2322      ;in r0-count   
                +1  2323     ;r10,r11-значение с котоым сравнивается счетчик
                +1  2324     ;r2..r5 -значение счетчика
0D26            +1  2325     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
0D26 E6         +1  2326                     mov                     a,@r0
0D27 FC         +1  2327                     mov                     r4,a
0D28 08         +1  2328                     inc                     r0
0D29 E6         +1  2329                     mov                     a,@r0
0D2A FD         +1  2330                     mov                     r5,a
0D2B 7B00       +1  2331                     mov                     r3,#0
0D2D 7A00       +1  2332                     mov                     r2,#0
0D2F 750800     +1  2333                     mov                     r8,#0;clr                       r8
0D32 750900     +1  2334                     mov                     r9,#0;clr                       r9
0D35 120000   F +1  2335                     call            lcmp
0D38 22         +1  2336                     ret
                +1  2337     
                +1  2338     
                +1  2339     
0D39 00000000   +1  2340     ch0:    db      00,00,00,00
0D3D 0000000A   +1  2341     ch10:   db      00,00,00,0ah                            ;10
0D41 00000005   +1  2342     ch5:    db      00,00,00,05                                             ;5
0D45 000003B9   +1  2343     ch954:  db 00,00,03,0b9h                                                ;954
0D49 000003E8   +1  2344     ch10000:        db 00,00,03h,0e8h                                               ;10000
0D4D 00000064   +1  2345     ch100:  db 00,00,00,64h ;100
0D51 00000002   +1  2346     ch2:    db      00,00,00,02                                             
                +1  2347     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  2348     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  2349     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
0D55 00000001   +1  2350     ch1:    db  00,00,00,01
0D59 3F800000   +1  2351     ch_1:   db      3fh,80h,00,00                   
0D5D 3F741EDF   +1  2352     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
0D61 47C35000   +1  2353     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000    
0D65 4856D800   +1  2354     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
0D69 4856D800   +1  2355     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
0D6D 461C4000   +1  2356     ch_10th:db  46h,1ch,40h,00;10000-2710h
                    2357     
                    2358     ;$include (d:\amp\sarifm3.asm) 
                +1  2359     ; ” ©« SARIFM.ASM 8.11.95
                +1  2360     ;файл арифметики
                +1  2361       
  0008          +1  2362     ltemp    equ       8           ;long temporary
  000C          +1  2363     xtemp    equ       12          ;other temporaries
  000A          +1  2364     DECSIZE  EQU       10
  0004          +1  2365     NUMSIZE  EQU       4
  0004          +1  2366     RR4  EQU       4
  0005          +1  2367     RR5  EQU       5
                +1  2368     
                +1  2369                                                     
                +1  2370     
                +1  2371                 ; rseg     ARIF          ; Switch to this code segment.
                +1  2372     ;             using    0              ; Specify register bank for the following
                +1  2373                                            ; program code.
                +1  2374     ;                                               cseg AT 400h
                +1  2375     ; Arithmetics:  CLEARING string
                +1  2376     ; Input:
                +1  2377     ; R0 - pointer to string,
                +1  2378     ; NUMSIZE - byte count if CLRNUM used,
                +1  2379     ; DECSIZE - byte count if CLRDEC used,
                +1  2380     ; R2 - byte count if CLEAR used;
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    38

                +1  2381     ; Output:  none.
                +1  2382     
0D71            +1  2383     CLRDEC:
0D71 7A0A       +1  2384         MOV R2, #DECSIZE
0D73 8002       +1  2385         SJMP    CLEAR
0D75            +1  2386     CLRNUM:
0D75 7A04       +1  2387         MOV R2, #NUMSIZE
                +1  2388         ;JMP    CLEAR
0D77            +1  2389     CLEAR:
0D77 E4         +1  2390         CLR A
0D78 F6         +1  2391     CLR11:  MOV @R0, A
0D79 08         +1  2392         INC R0
0D7A DAFC       +1  2393         DJNZ    R2, CLR11
0D7C 22         +1  2394         RET
                +1  2395     
                +1  2396     ;**********************************
                +1  2397     ;mov    r1,#abin+3
                +1  2398     ;mov    r0,#adec
                +1  2399     ; _ _ _ _
                +1  2400     ;     03ff
                +1  2401     ;ст     мл   - вход
                +1  2402     ; _ _ _ _ _ _ _ _ _ _
                +1  2403     ;             1 0 2 3
                +1  2404     ;ст                мл 
                +1  2405     ;**********************************
                +1  2406     
0D7D            +1  2407     BINDEC:
                +1  2408     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  2409     ; Input:
                +1  2410     ; R0 - pointer to destination (high digit is the first),
                +1  2411     ; R1 - pointer to source,
                +1  2412     ; NUMSIZE - byte count in binary number;
                +1  2413     ; DECSIZE - byte count in decimal number;
                +1  2414     ; Output:  none.
                +1  2415     ; Source saved
                +1  2416     
                +1  2417         ; 1. Clear result
0D7D 7A05       +1  2418         MOV R2, #DECSIZE/2
0D7F 120000   F +1  2419         CALL   CLEAR  ; incrementing R0
                +1  2420     
                +1  2421         ; 2. Prepare convertion
0D82 18         +1  2422         DEC R0
0D83 8804       +1  2423         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
0D85 8905       +1  2424         MOV RR5, R1 ; R5 - pointer to low byte of binary number
0D87 7B20       +1  2425         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  2426     
                +1  2427         ; 3. Convert cyrcle
0D89            +1  2428     BIN30:
                +1  2429     
                +1  2430         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
0D89 A905       +1  2431         MOV R1, RR5
0D8B 7A04       +1  2432         MOV R2, #NUMSIZE
0D8D E7         +1  2433     BIN31:  MOV A, @R1
0D8E 33         +1  2434         RLC A
0D8F F7         +1  2435         MOV @R1, A
0D90 19         +1  2436         DEC R1
0D91 DAFA       +1  2437         DJNZ    R2, BIN31
0D93 A905       +1  2438         MOV R1, RR5
0D95 E7         +1  2439         MOV A, @R1
0D96 92E0       +1  2440         MOV ACC.0, C
0D98 F7         +1  2441         MOV @R1, A
                +1  2442     
                +1  2443         ; 3.2. Doubling decimal result with <Carry>
0D99 A804       +1  2444         MOV R0, RR4
0D9B 7A05       +1  2445         MOV R2, #DECSIZE/2
0D9D E6         +1  2446     BIN32:  MOV A, @R0
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    39

0D9E 36         +1  2447         ADDC    A, @R0
0D9F D4         +1  2448         DA  A
0DA0 F6         +1  2449         MOV @R0, A
0DA1 18         +1  2450         DEC R0
0DA2 DAF9       +1  2451         DJNZ    R2, BIN32
                +1  2452     
                +1  2453         ; 3.3. End of convert cyrcle
0DA4 DBE3       +1  2454         DJNZ    R3, BIN30
                +1  2455     
                +1  2456         ; 4. Make bytes from half-bytes
0DA6 E8         +1  2457         MOV A, R0
0DA7 240A       +1  2458         ADD A, #DECSIZE
0DA9 F8         +1  2459         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
0DAA A904       +1  2460         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
0DAC 7A05       +1  2461         MOV R2, #DECSIZE/2
0DAE E7         +1  2462     BIN41:  MOV A, @R1
0DAF 540F       +1  2463         ANL A, #00FH
0DB1 F6         +1  2464         MOV @R0, A
0DB2 18         +1  2465         DEC R0
0DB3 E7         +1  2466         MOV A, @R1
0DB4 C4         +1  2467         SWAP    A
0DB5 540F       +1  2468         ANL A, #00FH
0DB7 F6         +1  2469         MOV @R0, A
0DB8 18         +1  2470         DEC R0
0DB9 19         +1  2471         DEC R1
0DBA DAF2       +1  2472         DJNZ    R2, BIN41
0DBC 22         +1  2473         RET
                +1  2474     
                +1  2475     
                +1  2476     ;*********************************
                +1  2477     ;mov    r0,#abin
                +1  2478     ;mov    r1,#adec
                +1  2479     ; _ _ _ _       -выход
                +1  2480     ; ff0000
                +1  2481     ;0004
                +1  2482     ;мл      ст
                +1  2483     
                +1  2484     ;ст                       мл
                +1  2485     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  2486     ;                       2 5 5
                +1  2487     ;                   1 0 2 4
                +1  2488     
0DBD            +1  2489     DECBIN:
                +1  2490     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  2491     ; Input:
                +1  2492     ; R0 - pointer to destination,
                +1  2493     ; R1 - pointer to source (high digit is the first),
                +1  2494     ; NUMSIZE - byte count in binary number;
                +1  2495     ; DECSIZE - byte count in decimal number;
                +1  2496     ; Output:  none
                +1  2497     ; Source cleared
                +1  2498     
                +1  2499         ; 1. Clear result
0DBD 120000   F +1  2500         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  2501     
                +1  2502         ; 2. Prepare convertion
0DC0 18         +1  2503         DEC R0
0DC1 8804       +1  2504         MOV RR4, R0 ; R4 - pointer to high byte of binary result
0DC3 8905       +1  2505         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
0DC5 900000   F +1  2506         MOV DPTR, #DECT2
0DC8 7B20       +1  2507         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  2508     
                +1  2509         ; 3. Convert cyrcle
0DCA            +1  2510     DEC30:
                +1  2511     
                +1  2512         ; 3.1. Divide decimal number by 2 and prepare <Carry>
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    40

0DCA C3         +1  2513         CLR C
0DCB A905       +1  2514         MOV R1, RR5
0DCD 7A0A       +1  2515         MOV R2, #DECSIZE
0DCF E7         +1  2516     DEC31:  MOV A, @R1
0DD0 540F       +1  2517         ANL A, #00FH
0DD2 92E4       +1  2518         MOV ACC.4, C
0DD4 93         +1  2519         MOVC    A,@A+DPTR
0DD5 F7         +1  2520         MOV @R1, A
0DD6 A2E7       +1  2521         MOV C, ACC.7
0DD8 09         +1  2522         INC R1
0DD9 DAF4       +1  2523         DJNZ    R2, DEC31
                +1  2524     
                +1  2525         ; 3.2. Rotate binary result one bit to right with <Carry>
0DDB A804       +1  2526         MOV R0, RR4
0DDD 7A04       +1  2527         MOV R2, #NUMSIZE
0DDF E6         +1  2528     DEC32:  MOV A, @R0
0DE0 13         +1  2529         RRC A
0DE1 F6         +1  2530         MOV @R0, A
0DE2 18         +1  2531         DEC R0
0DE3 DAFA       +1  2532         DJNZ    R2, DEC32
                +1  2533     
                +1  2534         ; 3.3. End of convert cyrcle
0DE5 DBE3       +1  2535         DJNZ    R3, DEC30
0DE7 22         +1  2536         RET
                +1  2537     
0DE8 00800181   +1  2538     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
0DEC 02820383                
0DF0 0484                    
0DF2 00000000   +1  2539         DB  00,00,00,00,00,00
0DF6 0000                    
0DF8 05850686   +1  2540         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
0DFC 07870888                
0E00 0989                    
                +1  2541     
                +1  2542     ;   Long comparison
                +1  2543     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  2544     ;   flags and acc set as though a long subtraction was done.
                +1  2545     ;*******************************
                +1  2546     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  2547     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  2548     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  2549     ;*******************************
0E02            +1  2550     lcmp:
0E02 C3         +1  2551         clr c
0E03 EA         +1  2552         mov a,r2
0E04 9508       +1  2553         subb    a,8
0E06 700F       +1  2554         jnz done
0E08 EB         +1  2555         mov a,r3
0E09 9509       +1  2556         subb    a,9
0E0B 7008       +1  2557         jnz done1
0E0D EC         +1  2558         mov a,r4
0E0E 950A       +1  2559         subb    a,10
0E10 7003       +1  2560         jnz done1
0E12 ED         +1  2561         mov a,r5
0E13 950B       +1  2562         subb    a,11
0E15            +1  2563     done1:
0E15 C2D2       +1  2564         clr ov      ;overflow is significant only for top byte
0E17            +1  2565     done:
0E17 22         +1  2566         ret
                +1  2567     
                +1  2568     ;   Load long into r2-5 from [dptr]
                +1  2569     
0E18            +1  2570     ldc_long:
0E18 E583       +1  2571         mov a,dph       ;is it in on board memory
0E1A 6010       +1  2572         jz  onboard     ;yes
0E1C E4         +1  2573         clr a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    41

0E1D 93         +1  2574         movc    a,@a+dptr
0E1E FA         +1  2575         mov r2,a
0E1F 7401       +1  2576         mov a,#1
0E21 93         +1  2577         movc    a,@a+dptr
0E22 FB         +1  2578         mov r3,a
0E23 7402       +1  2579         mov a,#2
0E25 93         +1  2580         movc    a,@a+dptr
0E26 FC         +1  2581         mov r4,a
0E27 7403       +1  2582         mov a,#3
0E29 93         +1  2583         movc    a,@a+dptr
0E2A FD         +1  2584         mov r5,a
0E2B 22         +1  2585         ret
0E2C            +1  2586     onboard:
0E2C A882       +1  2587         mov r0,dpl
0E2E E6         +1  2588         mov a,@r0
0E2F FA         +1  2589         mov r2,a
0E30 08         +1  2590         inc r0
0E31 E6         +1  2591         mov a,@r0
0E32 FB         +1  2592         mov r3,a
0E33 08         +1  2593         inc r0
0E34 E6         +1  2594         mov a,@r0
0E35 FC         +1  2595         mov r4,a
0E36 08         +1  2596         inc r0
0E37 E6         +1  2597         mov a,@r0
0E38 FD         +1  2598         mov r5,a
0E39 22         +1  2599         ret
                +1  2600     
                +1  2601     ;**************************************
                +1  2602     ;загрузить ltemp...+3 из памяти программ
                +1  2603     ;mov    dptr,#CH5
                +1  2604     ;call   ldc_ltemp        ltemp <--5
                +1  2605     ;**************************************
0E3A            +1  2606     ldc_ltemp:
0E3A E583       +1  2607         mov a,dph       ;is it in on board memory
0E3C 6014       +1  2608         jz  oboard      ;yes
0E3E E4         +1  2609         clr a
0E3F 93         +1  2610         movc    a,@a+dptr
0E40 F508       +1  2611         mov 8,a
0E42 7401       +1  2612         mov a,#1
0E44 93         +1  2613         movc    a,@a+dptr
0E45 F509       +1  2614         mov 9,a
0E47 7402       +1  2615         mov a,#2
0E49 93         +1  2616         movc    a,@a+dptr
0E4A F50A       +1  2617         mov 10,a
0E4C 7403       +1  2618         mov a,#3
0E4E 93         +1  2619         movc    a,@a+dptr
0E4F F50B       +1  2620         mov 11,a
0E51 22         +1  2621         ret
0E52            +1  2622     oboard:
0E52 A882       +1  2623         mov r0,dpl
0E54 8608       +1  2624         mov 8,@r0
0E56 08         +1  2625         inc r0
0E57 8609       +1  2626         mov 9,@r0
0E59 08         +1  2627         inc r0
0E5A 860A       +1  2628         mov 10,@r0
0E5C 08         +1  2629         inc r0
0E5D 860B       +1  2630         mov 11,@r0
0E5F 22         +1  2631         ret
                +1  2632     
                +1  2633     ;*****************************
                +1  2634     ;mov    dptr,#k1
                +1  2635     ;call   ldx_long
                +1  2636     ;k1->r2..r5
                +1  2637     ;*****************************
                +1  2638     ;   Load long into r2-5 from [dptr]
                +1  2639     ;
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    42

                +1  2640     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
0E60            +1  2641     ldx_long:
0E60 E583       +1  2642         mov a,dph       ;is it in on board memory
0E62 6014       +1  2643         jz  onboar1        ;yes
0E64 C082       +1  2644         push    dpl
0E66 C083       +1  2645         push    dph
0E68 E0         +1  2646         movx    a,@dptr
0E69 FA         +1  2647         mov r2,a
0E6A A3         +1  2648         inc dptr
0E6B E0         +1  2649         movx    a,@dptr
0E6C FB         +1  2650         mov r3,a
0E6D A3         +1  2651         inc dptr
0E6E E0         +1  2652         movx    a,@dptr
0E6F FC         +1  2653         mov r4,a
0E70 A3         +1  2654         inc dptr
0E71 E0         +1  2655         movx    a,@dptr
0E72 FD         +1  2656         mov r5,a
0E73 D083       +1  2657         pop dph
0E75 D082       +1  2658         pop dpl
0E77 22         +1  2659         ret
0E78            +1  2660     onboar1:
0E78 A882       +1  2661         mov r0,dpl
0E7A E6         +1  2662         mov a,@r0
0E7B FA         +1  2663         mov r2,a
0E7C 08         +1  2664         inc r0
0E7D E6         +1  2665         mov a,@r0
0E7E FB         +1  2666         mov r3,a
0E7F 08         +1  2667         inc r0
0E80 E6         +1  2668         mov a,@r0
0E81 FC         +1  2669         mov r4,a
0E82 08         +1  2670         inc r0
0E83 E6         +1  2671         mov a,@r0
0E84 FD         +1  2672         mov r5,a
0E85 22         +1  2673         ret
                +1  2674     
                +1  2675     ;*********************************
                +1  2676     ;mov    dptr,#k2
                +1  2677     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  2678     ;**********************************
0E86            +1  2679     ldx_ltemp:
0E86 E583       +1  2680         mov a,dph       ;is it in on board memory
0E88 6010       +1  2681         jz  oboard1     ;yes
0E8A E0         +1  2682         movx    a,@dptr
0E8B F508       +1  2683         mov 8,a
0E8D A3         +1  2684         inc dptr
0E8E E0         +1  2685         movx    a,@dptr
0E8F F509       +1  2686         mov 9,a
0E91 A3         +1  2687         inc dptr
0E92 E0         +1  2688         movx    a,@dptr
0E93 F50A       +1  2689         mov 10,a
0E95 A3         +1  2690         inc dptr
0E96 E0         +1  2691         movx    a,@dptr
0E97 F50B       +1  2692         mov 11,a
0E99 22         +1  2693         ret
0E9A            +1  2694     oboard1:
0E9A A882       +1  2695         mov r0,dpl
0E9C 8608       +1  2696         mov 8,@r0
0E9E 08         +1  2697         inc r0
0E9F 8609       +1  2698         mov 9,@r0
0EA1 08         +1  2699         inc r0
0EA2 860A       +1  2700         mov 10,@r0
0EA4 08         +1  2701         inc r0
0EA5 860B       +1  2702         mov 11,@r0
0EA7 22         +1  2703         ret
                +1  2704     ;   Long division routines for 8051
                +1  2705     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    43

                +1  2706     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  2707     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  2708     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  2709     ;   r1 must be saved by the caller.
                +1  2710     ;   This is long unsigned division.
                +1  2711     
                +1  2712     
                +1  2713     ;   Register usage:
                +1  2714     ;       r0 loop counter
                +1  2715     ;       xtemp (12-15) accumulates quotient
                +1  2716     ;       r5-r2 holds dividend
                +1  2717     ;       ltemp holds divisor
                +1  2718     
                +1  2719     ;************************************
                +1  2720     ;r2..r5-делимое
                +1  2721     ;ltemp..-делитель
                +1  2722     ;частное -r2..r5
                +1  2723     ;*************************************
0EA8            +1  2724     divide:
0EA8 E4         +1  2725         clr a
0EA9 F8         +1  2726         mov r0,a        ;initialize count
0EAA F50C       +1  2727         mov xtemp,a     ;zero quotient
0EAC F50D       +1  2728         mov xtemp+1,a
0EAE F50E       +1  2729         mov xtemp+2,a
0EB0 F50F       +1  2730         mov xtemp+3,a
0EB2 ED         +1  2731         mov a,r5        ;check for zero dividend
0EB3 4C         +1  2732         orl a,r4
0EB4 4B         +1  2733         orl a,r3
0EB5 4A         +1  2734         orl a,r2
0EB6 600B       +1  2735         jz  jfinis
0EB8 E508       +1  2736         mov a,ltemp     ;check for zero divisor
0EBA 4509       +1  2737         orl a,ltemp+1
0EBC 450A       +1  2738         orl a,ltemp+2
0EBE 450B       +1  2739         orl a,ltemp+3
0EC0 7037       +1  2740         jnz midl
0EC2 22         +1  2741         ret
                +1  2742     
0EC3 020000   F +1  2743     jfinis: jmp finis
                +1  2744     
0EC6            +1  2745     loops:
0EC6 EA         +1  2746         mov a,r2
0EC7 C3         +1  2747         clr c
0EC8 9508       +1  2748         subb    a,ltemp+0   ;is divisor greater than dividend yet
0ECA 4033       +1  2749         jc  yes     ;yes, go no further
0ECC 7013       +1  2750         jnz no
0ECE EB         +1  2751         mov a,r3
0ECF 9509       +1  2752         subb    a,ltemp+1
0ED1 402C       +1  2753         jc  yes
0ED3 700C       +1  2754         jnz no
0ED5 EC         +1  2755         mov a,r4
0ED6 950A       +1  2756         subb    a,ltemp+2
0ED8 4025       +1  2757         jc  yes
0EDA 7005       +1  2758         jnz no
0EDC ED         +1  2759         mov a,r5
0EDD 950B       +1  2760         subb    a,ltemp+3
0EDF 401E       +1  2761         jc  yes
0EE1            +1  2762     no:
0EE1 E50B       +1  2763         mov a,ltemp+3   ;shift divisor up one bit
0EE3 250B       +1  2764         add a,ltemp+3
0EE5 F50B       +1  2765         mov ltemp+3,a
0EE7 E50A       +1  2766         mov a,ltemp+2
0EE9 350A       +1  2767         addc    a,ltemp+2
0EEB F50A       +1  2768         mov ltemp+2,a
0EED E509       +1  2769         mov a,ltemp+1
0EEF 3509       +1  2770         addc    a,ltemp+1
0EF1 F509       +1  2771         mov ltemp+1,a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    44

0EF3 E508       +1  2772         mov a,ltemp+0
0EF5 3508       +1  2773         addc    a,ltemp+0
0EF7 F508       +1  2774         mov ltemp+0,a
0EF9            +1  2775     midl:
0EF9 08         +1  2776         inc r0      ;increment count
0EFA E508       +1  2777         mov a,ltemp+0   ;check for safe to shift some more
0EFC 30E7C7     +1  2778         jnb acc.7,loops  ;loop if top bit clear
0EFF            +1  2779     yes:
0EFF E508       +1  2780         mov a,ltemp+0
0F01 C3         +1  2781         clr c
0F02 9A         +1  2782         subb    a,r2        ;can we subtract now?
0F03 401A       +1  2783         jc  dosub       ;yes, go and do it
0F05 7015       +1  2784         jnz nosub
0F07 E509       +1  2785         mov a,ltemp+1
0F09 9B         +1  2786         subb    a,r3
0F0A 4013       +1  2787         jc  dosub
0F0C 700E       +1  2788         jnz nosub
0F0E E50A       +1  2789         mov a,ltemp+2
0F10 9C         +1  2790         subb    a,r4
0F11 400C       +1  2791         jc  dosub
0F13 7007       +1  2792         jnz nosub
0F15 E50B       +1  2793         mov a,ltemp+3
0F17 9D         +1  2794         subb    a,r5
0F18 4005       +1  2795         jc  dosub
0F1A 6003       +1  2796         jz  dosub
0F1C            +1  2797     nosub:
0F1C C3         +1  2798         clr c
0F1D 8012       +1  2799         sjmp    dosh
0F1F            +1  2800     dosub:
0F1F C3         +1  2801         clr c       ;subtract divisor from dividend
0F20 ED         +1  2802         mov a,r5
0F21 950B       +1  2803         subb    a,ltemp+3
0F23 FD         +1  2804         mov r5,a
0F24 EC         +1  2805         mov a,r4
0F25 950A       +1  2806         subb    a,ltemp+2
0F27 FC         +1  2807         mov r4,a
0F28 EB         +1  2808         mov a,r3
0F29 9509       +1  2809         subb    a,ltemp+1
0F2B FB         +1  2810         mov r3,a
0F2C EA         +1  2811         mov a,r2
0F2D 9508       +1  2812         subb    a,ltemp+0
0F2F FA         +1  2813         mov r2,a
0F30 D3         +1  2814         setb    c       ;now set bit for quotient
0F31            +1  2815     dosh:
0F31 E50F       +1  2816         mov a,xtemp+3
0F33 33         +1  2817         rlc a
0F34 F50F       +1  2818         mov xtemp+3,a
0F36 E50E       +1  2819         mov a,xtemp+2
0F38 33         +1  2820         rlc a
0F39 F50E       +1  2821         mov xtemp+2,a
0F3B E50D       +1  2822         mov a,xtemp+1
0F3D 33         +1  2823         rlc a
0F3E F50D       +1  2824         mov xtemp+1,a
0F40 E50C       +1  2825         mov a,xtemp+0
0F42 33         +1  2826         rlc a
0F43 F50C       +1  2827         mov xtemp+0,a
0F45 E508       +1  2828         mov a,ltemp+0       ;shift divisor down
0F47 C3         +1  2829         clr c
0F48 13         +1  2830         rrc a
0F49 F508       +1  2831         mov ltemp+0,a
0F4B E509       +1  2832         mov a,ltemp+1
0F4D 13         +1  2833         rrc a
0F4E F509       +1  2834         mov ltemp+1,a
0F50 E50A       +1  2835         mov a,ltemp+2
0F52 13         +1  2836         rrc a
0F53 F50A       +1  2837         mov ltemp+2,a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    45

0F55 E50B       +1  2838         mov a,ltemp+3
0F57 13         +1  2839         rrc a
0F58 F50B       +1  2840         mov ltemp+3,a
                +1  2841     
0F5A D8A3       +1  2842         djnz    r0,yes      ;and continue with the rest
                +1  2843     
0F5C            +1  2844     finis:
0F5C 8D0B       +1  2845         mov ltemp+3,r5
0F5E 8C0A       +1  2846         mov ltemp+2,r4
0F60 8B09       +1  2847         mov ltemp+1,r3
0F62 8A08       +1  2848         mov ltemp+0,r2
0F64 AD0F       +1  2849         mov r5,xtemp+3
0F66 AC0E       +1  2850         mov r4,xtemp+2
0F68 AB0D       +1  2851         mov r3,xtemp+1
0F6A AA0C       +1  2852         mov r2,xtemp+0
0F6C 22         +1  2853         ret         ;and return with the satisfaction of a job well done
                +1  2854     
                +1  2855     
                +1  2856     ;   Long multiplication
                +1  2857     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  2858     ;   other in ltemp. It really doesn't matter which one is where.
                +1  2859     
                +1  2860     ;**********************************
                +1  2861     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  2862     ;ст  мл
                +1  2863     ;**********************************
0F6D            +1  2864     llmul:
0F6D            +1  2865     almul:
0F6D            +1  2866     lmul:
0F6D ED         +1  2867         mov a,r5        ;low order byte
0F6E 850BF0     +1  2868         mov b,ltemp+3       ;times low order byte
0F71 A4         +1  2869         mul ab
0F72 F50F       +1  2870         mov xtemp+3,a       ;store low
0F74 85F00E     +1  2871         mov xtemp+2,b   ;and high
0F77 ED         +1  2872         mov a,r5        ;low order
0F78 850AF0     +1  2873         mov b,ltemp+2   ;times next
0F7B A4         +1  2874         mul ab
0F7C 250E       +1  2875         add a,xtemp+2   ;add in
0F7E F50E       +1  2876         mov xtemp+2,a
0F80 E5F0       +1  2877         mov a,b
0F82 3400       +1  2878         addc    a,#0
0F84 F50D       +1  2879         mov xtemp+1,a
0F86 ED         +1  2880         mov a,r5
0F87 8509F0     +1  2881         mov b,ltemp+1
0F8A A4         +1  2882         mul ab
0F8B 250D       +1  2883         add a,xtemp+1
0F8D F50D       +1  2884         mov xtemp+1,a
0F8F E5F0       +1  2885         mov a,b
0F91 3400       +1  2886         addc    a,#0
0F93 F50C       +1  2887         mov xtemp+0,a
0F95 ED         +1  2888         mov a,r5
0F96 8508F0     +1  2889         mov b,ltemp+0
0F99 A4         +1  2890         mul ab
0F9A 250C       +1  2891         add a,xtemp+0
0F9C F50C       +1  2892         mov xtemp+0,a
0F9E EC         +1  2893         mov a,r4
0F9F 850BF0     +1  2894         mov b,ltemp+3
0FA2 A4         +1  2895         mul ab
0FA3 250E       +1  2896         add a,xtemp+2
0FA5 F50E       +1  2897         mov xtemp+2,a
0FA7 E5F0       +1  2898         mov a,b
0FA9 350D       +1  2899         addc    a,xtemp+1
0FAB F50D       +1  2900         mov xtemp+1,a
0FAD E50C       +1  2901         mov a,xtemp+0
0FAF 3400       +1  2902         addc    a,#0
0FB1 F50C       +1  2903         mov xtemp+0,a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    46

0FB3 EC         +1  2904         mov a,r4
0FB4 850AF0     +1  2905         mov b,ltemp+2
0FB7 A4         +1  2906         mul ab
0FB8 250D       +1  2907         add a,xtemp+1
0FBA F50D       +1  2908         mov xtemp+1,a
0FBC E5F0       +1  2909         mov a,b
0FBE 350C       +1  2910         addc    a,xtemp+0
0FC0 F50C       +1  2911         mov xtemp+0,a
0FC2 EC         +1  2912         mov a,r4
0FC3 8509F0     +1  2913         mov b,ltemp+1
0FC6 A4         +1  2914         mul ab
0FC7 250C       +1  2915         add a,xtemp+0
0FC9 F50C       +1  2916         mov xtemp+0,a
                +1  2917     
0FCB EB         +1  2918         mov a,r3
0FCC 850BF0     +1  2919         mov b,ltemp+3
0FCF A4         +1  2920         mul ab
0FD0 250D       +1  2921         add a,xtemp+1
0FD2 F50D       +1  2922         mov xtemp+1,a
0FD4 E5F0       +1  2923         mov a,b
0FD6 350C       +1  2924         addc    a,xtemp+0
0FD8 F50C       +1  2925         mov xtemp+0,a
0FDA EB         +1  2926         mov a,r3
0FDB 850AF0     +1  2927         mov b,ltemp+2
0FDE A4         +1  2928         mul ab
0FDF 250C       +1  2929         add a,xtemp+0
0FE1 F50C       +1  2930         mov xtemp+0,a
                +1  2931     
0FE3 EA         +1  2932         mov a,r2
0FE4 850BF0     +1  2933         mov b,ltemp+3
0FE7 A4         +1  2934         mul ab
0FE8 250C       +1  2935         add a,xtemp+0
0FEA FA         +1  2936         mov r2,a
0FEB AB0D       +1  2937         mov r3,xtemp+1
0FED AC0E       +1  2938         mov r4,xtemp+2
0FEF AD0F       +1  2939         mov r5,xtemp+3
                +1  2940     
0FF1 22         +1  2941         ret         ;all done
                +1  2942     ;******************************
                +1  2943     ;из содержимого  r2-r5  вычесть
                +1  2944     ;содержимое          ltemp..ltemp+3
                +1  2945     ;******************************
0FF2            +1  2946     llsub:
0FF2            +1  2947      lsub:
0FF2 ED         +1  2948         mov a,r5
0FF3 C3         +1  2949         clr c
0FF4 950B       +1  2950         subb    a,11
0FF6 FD         +1  2951         mov r5,a
0FF7 EC         +1  2952         mov a,r4
0FF8 950A       +1  2953         subb    a,10
0FFA FC         +1  2954         mov r4,a
0FFB EB         +1  2955         mov a,r3
0FFC 9509       +1  2956         subb    a,9
0FFE FB         +1  2957         mov r3,a
0FFF EA         +1  2958         mov a,r2
1000 9508       +1  2959         subb    a,8
1002 FA         +1  2960         mov r2,a
1003 22         +1  2961         ret
                +1  2962     
                +1  2963     ;***********************************************
                +1  2964     ;                                                      ст мл
                +1  2965     ; cложение содержимого  r2..r5 с числом по адресу
                +1  2966     ;  r0- адрес младшего байта !!!
                +1  2967     ;результат- r2..r5
                +1  2968     ;***********************************************
                +1  2969     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    47

1004 C3         +1  2970     ladd:    clr       c
1005 ED         +1  2971          mov       a,r5
1006 26         +1  2972          add       a,@r0
1007 FD         +1  2973          mov       r5,a
1008 18         +1  2974          dec       r0
1009 EC         +1  2975          mov       a,r4
100A 36         +1  2976          addc      a,@r0
100B FC         +1  2977          mov       r4,a
100C 18         +1  2978          dec       r0
100D EB         +1  2979          mov       a,r3
100E 36         +1  2980          addc      a,@r0
100F FB         +1  2981          mov       r3,a
1010 18         +1  2982          dec       r0
1011 EA         +1  2983          mov       a,r2
1012 36         +1  2984          addc      a,@r0
1013 FA         +1  2985          mov       r2,a
1014 22         +1  2986          ret
                +1  2987     ;***********************************************
                +1  2988     ;                                                      ст мл
                +1  2989     ; cложение содержимого  r2..r5 с числом по адресу
                +1  2990     ;  r0- адрес младшего байта !!!
                +1  2991     ;результат- r2..r5
                +1  2992     ;***********************************************
                +1  2993     
1015 C3         +1  2994     laddx:    clr       c
1016 E2         +1  2995                                             movx            a,@r0
1017 2D         +1  2996                                             add                     a,r5
1018 FD         +1  2997               mov     r5,a
1019 18         +1  2998                             dec     r0
101A E2         +1  2999                             movx    a,@r0
101B 3C         +1  3000                             addc    a,r4
101C FC         +1  3001                             mov     r4,a
101D 18         +1  3002                             dec     r0
101E E2         +1  3003                             movx    a,@r0
101F 3B         +1  3004                             addc    a,r3
1020 FB         +1  3005                             mov     r3,a
1021 18         +1  3006                             dec     r0
1022 E2         +1  3007                             movx    a,@r0
1023 3A         +1  3008                             addc    a,r2
1024 FA         +1  3009                             mov       r2,a
1025 22         +1  3010                             ret
                +1  3011     
                +1  3012     ;***********************************************
                +1  3013     ;                                                      ст мл
                +1  3014     ; cложение содержимого  r2..r5 с числом по адресу
                +1  3015     ;  dptr- адрес младшего байта !!!
                +1  3016     ;результат- r2..r5
                +1  3017     ;***********************************************
                +1  3018     
1026 C3         +1  3019     addx:    clr       c
1027 E0         +1  3020                                             movx            a,@dptr
1028 2D         +1  3021                                             add                     a,r5
1029 FD         +1  3022               mov     r5,a
102A 120000   F +1  3023                             call            dedptr;dec     dptr
102D E0         +1  3024                             movx    a,@dptr
102E 3C         +1  3025                             addc    a,r4
102F FC         +1  3026                             mov     r4,a
1030 120000   F +1  3027                             call            dedptr;dec     dptr
1033 E0         +1  3028                             movx    a,@dptr
1034 3B         +1  3029                             addc    a,r3
1035 FB         +1  3030                             mov     r3,a
1036 120000   F +1  3031                             call            dedptr;dec     dptr
1039 E0         +1  3032                             movx    a,@dptr
103A 3A         +1  3033                             addc    a,r2
103B FA         +1  3034                             mov       r2,a
103C 22         +1  3035                             ret
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    48

                +1  3036     
103D C0D0       +1  3037     dedptr:         push    psw
103F C3         +1  3038                                             clr             c
1040 E582       +1  3039                                             mov             a,dpl
1042 9401       +1  3040                                             subb    a,#1
1044 F582       +1  3041                                             mov             dpl,a
1046 E583       +1  3042                                             mov             a,dph
1048 9400       +1  3043                                             subb    a,#0
104A F583       +1  3044                                             mov             dph,a
104C D0D0       +1  3045                                             pop             psw
104E 22         +1  3046                                             ret
                    3047     
                    3048     ;$include (d:\amp\floatm.asm)
                +1  3049     ;       Copyright (C) 1988 HI-TECH Software
                +1  3050     
                +1  3051     ;       Single Precision Floating point arithmetic routines for 8051
                +1  3052     
                +1  3053     ;       The format of floating point numbers is as follows:
                +1  3054     
                +1  3055     ;       -----------------
                +1  3056     ;       *     sign      *  1 bit
                +1  3057     ;       -----------------
                +1  3058     ;       *   exponent    *  8 bits
                +1  3059     ;       -----------------
                +1  3060     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  3061     ;       -----------------
                +1  3062     
                +1  3063     
                +1  3064     ;       As usual for the 8051 the memory layout has the most significant
                +1  3065     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  3066     ;       lowest address.
                +1  3067     
                +1  3068     ;       Calling conventions:
                +1  3069     
                +1  3070     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  3071     ;
                +1  3072     ;       Return value is in r2-r5
                +1  3073     
                +1  3074     ;       Naming conventions: A routine name is constructed by
                +1  3075     
                +1  3076     ;             ASOP
                +1  3077     
                +1  3078     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  3079     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  3080     ;       Conversion routines are named
                +1  3081     
                +1  3082     ;               AStof
                +1  3083     
                +1  3084     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  3085     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  3086     ;       Conversion from float to integer is ftol.
                +1  3087     
                +1  3088     ;               .ORG  5000h
                +1  3089     ;               .CODE
                +1  3090     ;       seg     c_text
                +1  3091     
                +1  3092     ;;      $MOD812
----            +1  3093             CSEG
                +1  3094             ;ORG 1000h
                +1  3095     
                +1  3096                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  3097             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  3098     
                +1  3099     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  3100     ;       macros
                +1  3101     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    49

                +1  3102     saveregs        macro
                +1  3103             push    7
                +1  3104             push    6
                +1  3105             push    1
                +1  3106             push    0
                +1  3107             endm
                +1  3108     
                +1  3109     restregs        macro
                +1  3110             pop     0
                +1  3111             pop     1
                +1  3112             pop     6
                +1  3113             pop     7
                +1  3114             endm
                +1  3115     
                +1  3116     ;addr   
                +1  3117     dan     macro   pad
                +1  3118             mov     a,r5
                +1  3119             add     a,pad+3
                +1  3120             mov     pad+3,a
                +1  3121             mov     a,pad+2
                +1  3122             addc    a,r4
                +1  3123             mov     pad+2,a
                +1  3124             mov     a,pad+1
                +1  3125             addc    a,r3
                +1  3126             mov     pad+1,a
                +1  3127             mov     a,pad+0
                +1  3128             addc    a,r2
                +1  3129             mov     pad,a
                +1  3130             endm
                +1  3131     
                +1  3132     addl    macro  addr
                +1  3133             mov     a,r5
                +1  3134             add     a,addr+3
                +1  3135             mov     r5,a
                +1  3136             mov     a,addr+2
                +1  3137             addc    a,r4
                +1  3138             mov     r4,a
                +1  3139             mov     a,addr+1
                +1  3140             addc    a,r3
                +1  3141             mov     r3,a
                +1  3142             mov     a,addr+0
                +1  3143             addc    a,r2
                +1  3144             mov     r2,a
                +1  3145             endm
                +1  3146     
                +1  3147     
                +1  3148     add1    macro
                +1  3149             mov     a,r5
                +1  3150             add     a,#1
                +1  3151             mov     r5,a
                +1  3152             clr     a
                +1  3153             addc    a,r4
                +1  3154             mov     r4,a
                +1  3155             clr     a
                +1  3156             addc    a,r3
                +1  3157             mov     r3,a
                +1  3158             clr     a
                +1  3159             addc    a,r2
                +1  3160             mov     r2,a
                +1  3161             endm
                +1  3162     
                +1  3163     shfdn   macro  addr
                +1  3164             clr     c
                +1  3165             mov     a,addr
                +1  3166             rrc     a
                +1  3167             mov     addr,a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    50

                +1  3168             mov     a,addr+1
                +1  3169             rrc     a
                +1  3170             mov     addr+1,a
                +1  3171             mov     a,addr+2
                +1  3172             rrc     a
                +1  3173             mov     addr+2,a
                +1  3174             mov     a,addr+3
                +1  3175             rrc     a
                +1  3176             mov     addr+3,a
                +1  3177             endm
                +1  3178     
                +1  3179     shfup   macro  addr
                +1  3180             clr     c
                +1  3181             mov     a,addr+3
                +1  3182             rlc     a
                +1  3183             mov     addr+3,a
                +1  3184             mov     a,addr+2
                +1  3185             rlc     a
                +1  3186             mov     addr+2,a
                +1  3187             mov     a,addr+1
                +1  3188             rlc     a
                +1  3189             mov     addr+1,a
                +1  3190             mov     a,addr
                +1  3191             rlc     a
                +1  3192             mov     addr,a
                +1  3193             endm
                +1  3194     
                +1  3195     rshift  macro
                +1  3196             clr     c
                +1  3197             mov     a,r2
                +1  3198             rrc     a
                +1  3199             mov     r2,a
                +1  3200             mov     a,r3
                +1  3201             rrc     a
                +1  3202             mov     r3,a
                +1  3203             mov     a,r4
                +1  3204             rrc     a
                +1  3205             mov     r4,a
                +1  3206             mov     a,r5
                +1  3207             rrc     a
                +1  3208             mov     r5,a
                +1  3209             endm
                +1  3210     rshift1 macro
                +1  3211             setb    c
                +1  3212             mov     a,r2
                +1  3213             rrc     a
                +1  3214             mov     r2,a
                +1  3215             mov     a,r3
                +1  3216             rrc     a
                +1  3217             mov     r3,a
                +1  3218             mov     a,r4
                +1  3219             rrc     a
                +1  3220             mov     r4,a
                +1  3221             mov     a,r5
                +1  3222             rrc     a
                +1  3223             mov     r5,a
                +1  3224             endm
                +1  3225     
                +1  3226     
                +1  3227     lshift  macro
                +1  3228             mov     a,r5
                +1  3229             rlc     a
                +1  3230             mov     r5,a
                +1  3231             mov     a,r4
                +1  3232             rlc     a
                +1  3233             mov     r4,a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    51

                +1  3234             mov     a,r3
                +1  3235             rlc     a
                +1  3236             mov     r3,a
                +1  3237             mov     a,r2
                +1  3238             rlc     a
                +1  3239             mov     r2,a
                +1  3240             endm
                +1  3241     
                +1  3242     neg1    macro
                +1  3243             clr     c
                +1  3244             clr     a
                +1  3245             subb    a,r5
                +1  3246             mov     r5,a
                +1  3247             clr     a
                +1  3248             subb    a,r4
                +1  3249             mov     r4,a
                +1  3250             clr     a
                +1  3251             subb    a,r3
                +1  3252             mov     r3,a
                +1  3253             clr     a
                +1  3254             subb    a,r2
                +1  3255             mov     r2,a
                +1  3256             endm
                +1  3257     
                +1  3258     negm    macro  addr
                +1  3259             clr     c
                +1  3260             clr     a
                +1  3261             subb    a,addr+3
                +1  3262             mov     addr+3,a
                +1  3263             clr     a
                +1  3264             subb    a,addr+2
                +1  3265             mov     addr+2,a
                +1  3266             clr     a
                +1  3267             subb    a,addr+1
                +1  3268             mov     addr+1,a
                +1  3269             clr     a
                +1  3270             subb    a,addr
                +1  3271             mov     addr,a
                +1  3272             endm
                +1  3273     
                +1  3274     copytor macro  addr
                +1  3275             mov     r2,addr
                +1  3276             mov     r3,addr+1
                +1  3277             mov     r4,addr+2
                +1  3278             mov     r5,addr+3
                +1  3279             endm
                +1  3280     
                +1  3281     
                +1  3282     copyrto macro  addr
                +1  3283             mov     addr,r2
                +1  3284             mov     addr+1,r3
                +1  3285             mov     addr+2,r4
                +1  3286             mov     addr+3,r5
                +1  3287             endm
                +1  3288     
                +1  3289     
                +1  3290     ;       Internal representation: in this set of routines a floating number
                +1  3291     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  3292     
                +1  3293     ;       Stack offset values
                +1  3294     ;ltemp   equ     28h
                +1  3295     
  0006          +1  3296     cntr    equ     6               ;r6 is the counter
  0007          +1  3297     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  3298     exp1    equ     0               ;exponent 1 in r0
  0002          +1  3299     mant1   equ     2               ;mantissa 1 in r2-5
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    52

  0001          +1  3300     exp2    equ     1               ;exponent 1 in r1
  0008          +1  3301     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  3302     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  3303     
                +1  3304     
                +1  3305     
                +1  3306     
                +1  3307     
                +1  3308     ;DECSIZE EQU     10
                +1  3309     ;NUMSIZE EQU     4
                +1  3310     ;RR4     EQU     4
                +1  3311     ;RR5     EQU     5
                +1  3312     
                +1  3313     ;       unpack1 - unpacks the left operand
                +1  3314     
009C            +1  3315     unpack1:
009C EA         +1  3316             mov     a,r2            ;get sign
009D 5480       +1  3317             anl     a,#80h
009F 530740     +1  3318             anl     sign,#40h       ;clear other bits
00A2 4207       +1  3319             orl     sign,a          ;store sign
00A4 EB         +1  3320             mov     a,r3            ;get lsb of exponent
00A5 33         +1  3321             rlc     a               ;rotate into carry
00A6 EA         +1  3322             mov     a,r2            ;get rest of exponent
00A7 33         +1  3323             rlc     a               ;and make it 8 bits
00A8 F8         +1  3324             mov     r0,a            ;store it
00A9 6006       +1  3325             jz      zer1            ;if zero, the whole thing is zero
00AB 430380     +1  3326             orl     mant1+1,#80h    ;set hidden bit
00AE 7A00       +1  3327             mov     r2,#0           ;clear upper byte of mantissa
00B0 22         +1  3328             ret
00B1            +1  3329     zer1:
00B1 E4         +1  3330             clr     a
00B2 FA         +1  3331             mov     r2,a
00B3 FB         +1  3332             mov     r3,a
00B4 FC         +1  3333             mov     r4,a
00B5 FD         +1  3334             mov     r5,a            ;zero mantissa
00B6 F8         +1  3335             mov     r0,a            ;zero exponent
00B7 22         +1  3336             ret
                +1  3337     
                +1  3338     ;       unpack2 - unpacks right operand
                +1  3339     
00B8            +1  3340     unpack2:
00B8 E508       +1  3341             mov     a,ltemp         ;get sign
00BA 13         +1  3342             rrc     a               ;shift down
00BB 5440       +1  3343             anl     a,#40h          ;mask out sign
00BD 530780     +1  3344             anl     sign,#80h       ;clear old bit
00C0 4207       +1  3345             orl     sign,a
00C2 E509       +1  3346             mov     a,ltemp+1       ;get lsb of exponent
00C4 33         +1  3347             rlc     a               ;rotate into carry
00C5 E508       +1  3348             mov     a,ltemp         ;get rest of exponent
00C7 33         +1  3349             rlc     a               ;and make it 8 bits
00C8 F9         +1  3350             mov     r1,a            ;store it
00C9 6007       +1  3351             jz      zer2            ;if zero, the whole thing is zero
00CB 430980     +1  3352             orl     mant2+1,#80h    ;set hidden bit
00CE 750800     +1  3353             mov     mant2,#0        ;clear upper byte
00D1 22         +1  3354             ret
00D2            +1  3355     zer2:
00D2 E4         +1  3356             clr     a
00D3 F508       +1  3357             mov     ltemp,a
00D5 F509       +1  3358             mov     ltemp+1,a
00D7 F50A       +1  3359             mov     ltemp+2,a
00D9 F50B       +1  3360             mov     ltemp+3,a               ;zero mantissa
00DB 22         +1  3361             ret
                +1  3362     
                +1  3363     ;       pack1 - put operand 1 back into float format
                +1  3364     
00DC            +1  3365     pack1:
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    53

00DC E8         +1  3366             mov     a,r0            ;get exponent
00DD C3         +1  3367             clr     c
00DE 13         +1  3368             rrc     a               ;shift down 1 bit
00DF 530780     +1  3369             anl     sign,#80h       ;mask sign bit
00E2 4F         +1  3370             orl     a,r7            ;or in sign bit
00E3 FA         +1  3371             mov     r2,a            ;store
00E4 E8         +1  3372             mov     a,r0            ;get other bit
00E5 03         +1  3373             rr      a               ;rotate into hi bit
00E6 5480       +1  3374             anl     a,#80h          ;mask
00E8 53037F     +1  3375             anl     mant1+1,#7Fh    ;clear hidden bit
00EB 4203       +1  3376             orl     mant1+1,a       ;put in
00ED 22         +1  3377             ret
                +1  3378     
                +1  3379     
                +1  3380     ;       norm1 - normalize the unpacked value in 1
                +1  3381     
00EE            +1  3382     norm1:
00EE E8         +1  3383             mov     a,r0            ;get exponent
00EF 60C0       +1  3384             jz      zer1            ;zero the mantissa if so
00F1 EA         +1  3385             mov     a,r2            ;get hi byte
00F2 6023       +1  3386             jz      norup           ;zero, so shift up if anything
00F4            +1  3387     nordn:
00F4 EA         +1  3388             mov     a,r2            ;get hi byte
00F5 B4010D     +1  3389             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  3390+3           add1                    ;add in a rounding bit
00F8 ED         +1  3391+1           mov     a,r5
00F9 2401       +1  3392+1           add     a,#1
00FB FD         +1  3393+1           mov     r5,a
00FC E4         +1  3394+1           clr     a
00FD 3C         +1  3395+1           addc    a,r4
00FE FC         +1  3396+1           mov     r4,a
00FF E4         +1  3397+1           clr     a
0100 3B         +1  3398+1           addc    a,r3
0101 FB         +1  3399+1           mov     r3,a
0102 E4         +1  3400+1           clr     a
0103 3A         +1  3401+1           addc    a,r2
0104 FA         +1  3402+1           mov     r2,a
0105            +1  3403     nordn1:
                +1  3404+3           rshift                  ;shift down 1 bit
0105 C3         +1  3405+1           clr     c
0106 EA         +1  3406+1           mov     a,r2
0107 13         +1  3407+1           rrc     a
0108 FA         +1  3408+1           mov     r2,a
0109 EB         +1  3409+1           mov     a,r3
010A 13         +1  3410+1           rrc     a
010B FB         +1  3411+1           mov     r3,a
010C EC         +1  3412+1           mov     a,r4
010D 13         +1  3413+1           rrc     a
010E FC         +1  3414+1           mov     r4,a
010F ED         +1  3415+1           mov     a,r5
0110 13         +1  3416+1           rrc     a
0111 FD         +1  3417+1           mov     r5,a
0112 08         +1  3418             inc     r0              ;adjust exponent
0113 EA         +1  3419             mov     a,r2            ;test high byte
0114 70DE       +1  3420             jnz     nordn           ;loop
0116 22         +1  3421             ret                     ;done
                +1  3422     
0117            +1  3423     norup:
0117 4B         +1  3424             orl     a,r3
0118 4C         +1  3425             orl     a,r4
0119 4D         +1  3426             orl     a,r5            ;test for zero mantissa
011A 6095       +1  3427             jz      zer1            ;it is - make it true zero
011C            +1  3428     norup1:
011C EB         +1  3429             mov     a,r3            ;get mantissa byte
011D 20E710     +1  3430             jb      acc.7,norup2    ;jump if set
0120 C3         +1  3431             clr     c
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    54

                +1  3432+3           lshift                  ;shift mantissa up
0121 ED         +1  3433+1           mov     a,r5
0122 33         +1  3434+1           rlc     a
0123 FD         +1  3435+1           mov     r5,a
0124 EC         +1  3436+1           mov     a,r4
0125 33         +1  3437+1           rlc     a
0126 FC         +1  3438+1           mov     r4,a
0127 EB         +1  3439+1           mov     a,r3
0128 33         +1  3440+1           rlc     a
0129 FB         +1  3441+1           mov     r3,a
012A EA         +1  3442+1           mov     a,r2
012B 33         +1  3443+1           rlc     a
012C FA         +1  3444+1           mov     r2,a
012D 18         +1  3445             dec     r0              ;adjust exponent
012E 80EC       +1  3446             jmp     norup1
0130            +1  3447     norup2:
0130 22         +1  3448             ret                     ;finito
                +1  3449     
                +1  3450     
                +1  3451     ;       fpdenorm - denormalize one of the two operands so that their
                +1  3452     ;       exponents are equal. This requires the smaller number to have
                +1  3453     ;       its exponent incremented and its mantissa shifted right.
                +1  3454     
0131            +1  3455     denorm:
0131 E8         +1  3456             mov     a,r0
0132 C3         +1  3457             clr     c
0133 99         +1  3458             subb    a,r1            ;compare exponents
0134 5029       +1  3459             jnc     up2a            ;shift operand 2
0136            +1  3460     up1:
0136 08         +1  3461             inc     r0              ;increment exponent
                +1  3462+3           rshift                  ;shift mantissa down
0137 C3         +1  3463+1           clr     c
0138 EA         +1  3464+1           mov     a,r2
0139 13         +1  3465+1           rrc     a
013A FA         +1  3466+1           mov     r2,a
013B EB         +1  3467+1           mov     a,r3
013C 13         +1  3468+1           rrc     a
013D FB         +1  3469+1           mov     r3,a
013E EC         +1  3470+1           mov     a,r4
013F 13         +1  3471+1           rrc     a
0140 FC         +1  3472+1           mov     r4,a
0141 ED         +1  3473+1           mov     a,r5
0142 13         +1  3474+1           rrc     a
0143 FD         +1  3475+1           mov     r5,a
0144 E8         +1  3476             mov     a,r0
0145 B501EE     +1  3477             cjne    a,exp2,up1      ;loop if still not equal
0148 22         +1  3478             ret
                +1  3479     
0149            +1  3480     up2:
0149 09         +1  3481             inc     r1              ;increment exponent 2
                +1  3482+3           shfdn   mant2           ;shift mantissa down
014A C3         +1  3483+1           clr     c
014B E508       +1  3484+1           mov     a,mant2
014D 13         +1  3485+1           rrc     a
014E F508       +1  3486+1           mov     mant2,a
0150 E509       +1  3487+1           mov     a,mant2+1
0152 13         +1  3488+1           rrc     a
0153 F509       +1  3489+1           mov     mant2+1,a
0155 E50A       +1  3490+1           mov     a,mant2+2
0157 13         +1  3491+1           rrc     a
0158 F50A       +1  3492+1           mov     mant2+2,a
015A E50B       +1  3493+1           mov     a,mant2+3
015C 13         +1  3494+1           rrc     a
015D F50B       +1  3495+1           mov     mant2+3,a
015F            +1  3496     up2a:
015F E8         +1  3497             mov     a,r0            ;compare exponents
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    55

0160 B501E6     +1  3498             cjne    a,exp2,up2
0163 22         +1  3499             ret                     ;all done
                +1  3500     ;------------------------------------------------------------------
                +1  3501     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  3502     
0164            +1  3503     fladd:
                +1  3504+3           saveregs
0164 C007       +1  3505+1           push    7
0166 C006       +1  3506+1           push    6
0168 C001       +1  3507+1           push    1
016A C000       +1  3508+1           push    0
016C 119C       +1  3509             call    unpack1
016E 11B8       +1  3510             call    unpack2
0170 3131       +1  3511             call    denorm
0172 E507       +1  3512             mov     a,sign
0174 30E70D     +1  3513             jnb     acc.7,ok1       ;test left sign
                +1  3514+3           neg1                    ;negate op1
0177 C3         +1  3515+1           clr     c
0178 E4         +1  3516+1           clr     a
0179 9D         +1  3517+1           subb    a,r5
017A FD         +1  3518+1           mov     r5,a
017B E4         +1  3519+1           clr     a
017C 9C         +1  3520+1           subb    a,r4
017D FC         +1  3521+1           mov     r4,a
017E E4         +1  3522+1           clr     a
017F 9B         +1  3523+1           subb    a,r3
0180 FB         +1  3524+1           mov     r3,a
0181 E4         +1  3525+1           clr     a
0182 9A         +1  3526+1           subb    a,r2
0183 FA         +1  3527+1           mov     r2,a
0184            +1  3528     ok1:
0184 E507       +1  3529             mov     a,sign
0186 30E615     +1  3530             jnb     acc.6,ok2       ;test right sign
                +1  3531+3           negm    mant2           ;negate op2
0189 C3         +1  3532+1           clr     c
018A E4         +1  3533+1           clr     a
018B 950B       +1  3534+1           subb    a,mant2+3
018D F50B       +1  3535+1           mov     mant2+3,a
018F E4         +1  3536+1           clr     a
0190 950A       +1  3537+1           subb    a,mant2+2
0192 F50A       +1  3538+1           mov     mant2+2,a
0194 E4         +1  3539+1           clr     a
0195 9509       +1  3540+1           subb    a,mant2+1
0197 F509       +1  3541+1           mov     mant2+1,a
0199 E4         +1  3542+1           clr     a
019A 9508       +1  3543+1           subb    a,mant2
019C F508       +1  3544+1           mov     mant2,a
019E            +1  3545     ok2:
                +1  3546+3           addl    mant2           ;add mantissas
019E ED         +1  3547+1           mov     a,r5
019F 250B       +1  3548+1           add     a,mant2+3
01A1 FD         +1  3549+1           mov     r5,a
01A2 E50A       +1  3550+1           mov     a,mant2+2
01A4 3C         +1  3551+1           addc    a,r4
01A5 FC         +1  3552+1           mov     r4,a
01A6 E509       +1  3553+1           mov     a,mant2+1
01A8 3B         +1  3554+1           addc    a,r3
01A9 FB         +1  3555+1           mov     r3,a
01AA E508       +1  3556+1           mov     a,mant2+0
01AC 3A         +1  3557+1           addc    a,r2
01AD FA         +1  3558+1           mov     r2,a
01AE E4         +1  3559             clr     a
01AF FF         +1  3560             mov     r7,a            ;clear sign
01B0 EA         +1  3561             mov     a,r2            ;get sign of result
01B1 30E70E     +1  3562             jnb     acc.7,ok3       ;all ok
01B4 FF         +1  3563             mov     r7,a            ;store sign
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    56

                +1  3564+3           neg1                    ;negate mantissa
01B5 C3         +1  3565+1           clr     c
01B6 E4         +1  3566+1           clr     a
01B7 9D         +1  3567+1           subb    a,r5
01B8 FD         +1  3568+1           mov     r5,a
01B9 E4         +1  3569+1           clr     a
01BA 9C         +1  3570+1           subb    a,r4
01BB FC         +1  3571+1           mov     r4,a
01BC E4         +1  3572+1           clr     a
01BD 9B         +1  3573+1           subb    a,r3
01BE FB         +1  3574+1           mov     r3,a
01BF E4         +1  3575+1           clr     a
01C0 9A         +1  3576+1           subb    a,r2
01C1 FA         +1  3577+1           mov     r2,a
01C2            +1  3578     ok3:
01C2 11EE       +1  3579             call    norm1
01C4 11DC       +1  3580             call    pack1           ;pack normalized result
                +1  3581+3           restregs                ;and return
01C6 D000       +1  3582+1           pop     0
01C8 D001       +1  3583+1           pop     1
01CA D006       +1  3584+1           pop     6
01CC D007       +1  3585+1           pop     7
01CE 22         +1  3586             ret
                +1  3587     ;-------------------------------------------------------------
                +1  3588     ;       Subtract the number ltemp from the number in r2-r5
                +1  3589     
01CF            +1  3590     flsub:
01CF 630880     +1  3591             xrl     ltemp,#80h      ;toggle sign bit
01D2 8090       +1  3592             jmp     fladd           ;and add!
                +1  3593     
                +1  3594     ;================================================================
                +1  3595     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  3596     
01D4            +1  3597     flcmp:
01D4 EA         +1  3598            mov     a,r2            ;get sign of left
01D5 6508       +1  3599            xrl     a,ltemp         ;calculate new sign
01D7 30E706     +1  3600            jnb     acc.7,cexp      ;same, go check exponent
                +1  3601     ;ifdef SMALL_MODEL
01DA EA         +1  3602             mov     a,r2            ;get sign of left again
01DB 33         +1  3603             rlc     a
01DC 5001       +1  3604             jnc     flout
                +1  3605     ;endif
01DE D3         +1  3606             setb    c
01DF 22         +1  3607     flout:          ret                    ;return with acc < 0
                +1  3608     
01E0            +1  3609     cexp:
01E0 C3         +1  3610            clr     c
01E1 EA         +1  3611            mov     a,r2            ;compare exponent and mantissa
01E2 9508       +1  3612            subb    a,ltemp
01E4 7010       +1  3613            jnz     fnd
01E6 EB         +1  3614            mov     a,r3
01E7 9509       +1  3615            subb    a,ltemp+1
01E9 700B       +1  3616            jnz     fnd
01EB EC         +1  3617            mov     a,r4
01EC 950A       +1  3618            subb    a,ltemp+2
01EE 7006       +1  3619            jnz     fnd
01F0 ED         +1  3620            mov     a,r5
01F1 950B       +1  3621            subb    a,ltemp+3
01F3 7001       +1  3622            jnz     fnd
01F5            +1  3623     cdone:
01F5 22         +1  3624            ret                     ;return with acc == 0
01F6            +1  3625     fnd:
01F6 8AF0       +1  3626           mov     b,r2             ;get sign of left value
01F8 30F7FA     +1  3627          jnb     b.7,cdone       ;if positive, finished
01FB B2E7       +1  3628            cpl   acc.7             ;toggle sign???????/
01FD 4401       +1  3629                         orl         a,#1                          ;make non-zero
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    57

01FF B3         +1  3630             cpl     c               ;c=0->1,c=1->0
0200 22         +1  3631             ret
                +1  3632     ;==============================================================
                +1  3633     
                +1  3634     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  3635     ;       the result in r2-r5
                +1  3636     
0201            +1  3637     flmul:
                +1  3638+3           saveregs
0201 C007       +1  3639+1           push    7
0203 C006       +1  3640+1           push    6
0205 C001       +1  3641+1           push    1
0207 C000       +1  3642+1           push    0
0209 119C       +1  3643             call    unpack1
020B 11B8       +1  3644             call    unpack2
020D E4         +1  3645             clr     a
020E F50C       +1  3646             mov     prod,a
0210 F50D       +1  3647             mov     prod+1,a        ;clear product
0212 F50E       +1  3648             mov     prod+2,a
0214 F50F       +1  3649             mov     prod+3,a
0216 7E07       +1  3650             mov     r6,#7           ;initialize counter
0218            +1  3651     mup1:
                +1  3652+3           shfdn   mant2           ;shift multiplier right
0218 C3         +1  3653+1           clr     c
0219 E508       +1  3654+1           mov     a,mant2
021B 13         +1  3655+1           rrc     a
021C F508       +1  3656+1           mov     mant2,a
021E E509       +1  3657+1           mov     a,mant2+1
0220 13         +1  3658+1           rrc     a
0221 F509       +1  3659+1           mov     mant2+1,a
0223 E50A       +1  3660+1           mov     a,mant2+2
0225 13         +1  3661+1           rrc     a
0226 F50A       +1  3662+1           mov     mant2+2,a
0228 E50B       +1  3663+1           mov     a,mant2+3
022A 13         +1  3664+1           rrc     a
022B F50B       +1  3665+1           mov     mant2+3,a
022D 5014       +1  3666             jnc     nobit           ;skip if lsb was zero
                +1  3667+3           dan     prod            ;add multiplicand to product
022F ED         +1  3668+1           mov     a,r5
0230 250F       +1  3669+1           add     a,prod+3
0232 F50F       +1  3670+1           mov     prod+3,a
0234 E50E       +1  3671+1           mov     a,prod+2
0236 3C         +1  3672+1           addc    a,r4
0237 F50E       +1  3673+1           mov     prod+2,a
0239 E50D       +1  3674+1           mov     a,prod+1
023B 3B         +1  3675+1           addc    a,r3
023C F50D       +1  3676+1           mov     prod+1,a
023E E50C       +1  3677+1           mov     a,prod+0
0240 3A         +1  3678+1           addc    a,r2
0241 F50C       +1  3679+1           mov     prod,a
0243            +1  3680     nobit:
                +1  3681+3           lshift                  ;shift multiplicand up
0243 ED         +1  3682+1           mov     a,r5
0244 33         +1  3683+1           rlc     a
0245 FD         +1  3684+1           mov     r5,a
0246 EC         +1  3685+1           mov     a,r4
0247 33         +1  3686+1           rlc     a
0248 FC         +1  3687+1           mov     r4,a
0249 EB         +1  3688+1           mov     a,r3
024A 33         +1  3689+1           rlc     a
024B FB         +1  3690+1           mov     r3,a
024C EA         +1  3691+1           mov     a,r2
024D 33         +1  3692+1           rlc     a
024E FA         +1  3693+1           mov     r2,a
024F DEC7       +1  3694             djnz    r6,mup1         ;loop if more
                +1  3695     
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    58

0251 7E11       +1  3696             mov     r6,#17          ;re-initalize counter
0253 8015       +1  3697             sjmp    mup3
0255            +1  3698     mup11:
                +1  3699+3           shfdn   prod            ;shift product right
0255 C3         +1  3700+1           clr     c
0256 E50C       +1  3701+1           mov     a,prod
0258 13         +1  3702+1           rrc     a
0259 F50C       +1  3703+1           mov     prod,a
025B E50D       +1  3704+1           mov     a,prod+1
025D 13         +1  3705+1           rrc     a
025E F50D       +1  3706+1           mov     prod+1,a
0260 E50E       +1  3707+1           mov     a,prod+2
0262 13         +1  3708+1           rrc     a
0263 F50E       +1  3709+1           mov     prod+2,a
0265 E50F       +1  3710+1           mov     a,prod+3
0267 13         +1  3711+1           rrc     a
0268 F50F       +1  3712+1           mov     prod+3,a
026A            +1  3713     mup3:
                +1  3714+3           shfdn   mant2           ;shift multiplier down
026A C3         +1  3715+1           clr     c
026B E508       +1  3716+1           mov     a,mant2
026D 13         +1  3717+1           rrc     a
026E F508       +1  3718+1           mov     mant2,a
0270 E509       +1  3719+1           mov     a,mant2+1
0272 13         +1  3720+1           rrc     a
0273 F509       +1  3721+1           mov     mant2+1,a
0275 E50A       +1  3722+1           mov     a,mant2+2
0277 13         +1  3723+1           rrc     a
0278 F50A       +1  3724+1           mov     mant2+2,a
027A E50B       +1  3725+1           mov     a,mant2+3
027C 13         +1  3726+1           rrc     a
027D F50B       +1  3727+1           mov     mant2+3,a
027F 5014       +1  3728             jnc     mup2            ;skip if bit not set
                +1  3729+3           dan     prod            ;add to prod
0281 ED         +1  3730+1           mov     a,r5
0282 250F       +1  3731+1           add     a,prod+3
0284 F50F       +1  3732+1           mov     prod+3,a
0286 E50E       +1  3733+1           mov     a,prod+2
0288 3C         +1  3734+1           addc    a,r4
0289 F50E       +1  3735+1           mov     prod+2,a
028B E50D       +1  3736+1           mov     a,prod+1
028D 3B         +1  3737+1           addc    a,r3
028E F50D       +1  3738+1           mov     prod+1,a
0290 E50C       +1  3739+1           mov     a,prod+0
0292 3A         +1  3740+1           addc    a,r2
0293 F50C       +1  3741+1           mov     prod,a
0295            +1  3742     mup2:
0295 DEBE       +1  3743             djnz    r6,mup11        ;loop if more
0297 E8         +1  3744             mov     a,r0            ;get exp1
0298 29         +1  3745             add     a,r1            ;add exp2
0299 247A       +1  3746             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029B F8         +1  3747             mov     r0,a            ;store
029C EF         +1  3748             mov     a,r7            ;get sign
029D 23         +1  3749             rl      a               ;rotate bit into msb
029E 6207       +1  3750             xrl     sign,a          ;xor with other bit
                +1  3751+3           copytor prod            ;copy prod to mant1
02A0 AA0C       +1  3752+1           mov     r2,prod
02A2 AB0D       +1  3753+1           mov     r3,prod+1
02A4 AC0E       +1  3754+1           mov     r4,prod+2
02A6 AD0F       +1  3755+1           mov     r5,prod+3
02A8 11EE       +1  3756             call    norm1           ;normalize
02AA 11DC       +1  3757             call    pack1
                +1  3758+3           restregs
02AC D000       +1  3759+1           pop     0
02AE D001       +1  3760+1           pop     1
02B0 D006       +1  3761+1           pop     6
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    59

02B2 D007       +1  3762+1           pop     7
02B4 22         +1  3763             ret
                +1  3764     ;-----------------------------------------------------------
                +1  3765     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  3766     
02B5            +1  3767     fldiv:
                +1  3768+3           saveregs
02B5 C007       +1  3769+1           push    7
02B7 C006       +1  3770+1           push    6
02B9 C001       +1  3771+1           push    1
02BB C000       +1  3772+1           push    0
02BD 119C       +1  3773             call    unpack1
02BF 11B8       +1  3774             call    unpack2
02C1 E4         +1  3775             clr     a
02C2 F50C       +1  3776             mov     prod,a
02C4 F50D       +1  3777             mov     prod+1,a
02C6 F50E       +1  3778             mov     prod+2,a
02C8 F50F       +1  3779             mov     prod+3,a
02CA E9         +1  3780             mov     a,r1            ;check for zero divisor
02CB 6067       +1  3781             jz      div9
02CD E8         +1  3782             mov     a,r0            ;check for zero dividend
02CE 6064       +1  3783             jz      div9
02D0 C3         +1  3784             clr     c
02D1 99         +1  3785             subb    a,r1            ;compute new exponent
02D2 2478       +1  3786             add     a,#127-7        ;unbias
02D4 F8         +1  3787             mov     r0,a            ;store back
02D5 EF         +1  3788             mov     a,r7            ;get sign
02D6 23         +1  3789             rl      a
02D7 6207       +1  3790             xrl     sign,a          ;compute new sign
02D9 7E1F       +1  3791             mov     r6,#24+7        ;initialize counter
02DB            +1  3792     div1:
                +1  3793+3           shfup   prod            ;shift quotient up
02DB C3         +1  3794+1           clr     c
02DC E50F       +1  3795+1           mov     a,prod+3
02DE 33         +1  3796+1           rlc     a
02DF F50F       +1  3797+1           mov     prod+3,a
02E1 E50E       +1  3798+1           mov     a,prod+2
02E3 33         +1  3799+1           rlc     a
02E4 F50E       +1  3800+1           mov     prod+2,a
02E6 E50D       +1  3801+1           mov     a,prod+1
02E8 33         +1  3802+1           rlc     a
02E9 F50D       +1  3803+1           mov     prod+1,a
02EB E50C       +1  3804+1           mov     a,prod
02ED 33         +1  3805+1           rlc     a
02EE F50C       +1  3806+1           mov     prod,a
02F0 C3         +1  3807             clr     c
02F1 EA         +1  3808             mov     a,r2            ;compare values
02F2 9508       +1  3809             subb    a,mant2
02F4 4028       +1  3810             jc      div2            ;skip if bigger
02F6 7013       +1  3811             jnz     div3
02F8 EB         +1  3812             mov     a,r3            ;compare values
02F9 9509       +1  3813             subb    a,mant2+1
02FB 4021       +1  3814             jc      div2            ;skip if bigger
02FD 700C       +1  3815             jnz     div3
02FF EC         +1  3816             mov     a,r4            ;compare values
0300 950A       +1  3817             subb    a,mant2+2
0302 401A       +1  3818             jc      div2            ;skip if bigger
0304 7005       +1  3819             jnz     div3
0306 ED         +1  3820             mov     a,r5            ;compare values
0307 950B       +1  3821             subb    a,mant2+3
0309 4013       +1  3822             jc      div2            ;skip if bigger
030B            +1  3823     div3:
030B ED         +1  3824             mov     a,r5
030C 950B       +1  3825             subb    a,mant2+3
030E FD         +1  3826             mov     r5,a
030F EC         +1  3827             mov     a,r4
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    60

0310 950A       +1  3828             subb    a,mant2+2               ;do subtraction
0312 FC         +1  3829             mov     r4,a
0313 EB         +1  3830             mov     a,r3
0314 9509       +1  3831             subb    a,mant2+1               ;do subtraction
0316 FB         +1  3832             mov     r3,a
0317 EA         +1  3833             mov     a,r2
0318 9508       +1  3834             subb    a,mant2         ;do subtraction
031A FA         +1  3835             mov     r2,a
031B 430F01     +1  3836             orl     prod+3,#1       ;set lsb in quotient
031E            +1  3837     div2:
                +1  3838+3           lshift                  ;shift dividend up
031E ED         +1  3839+1           mov     a,r5
031F 33         +1  3840+1           rlc     a
0320 FD         +1  3841+1           mov     r5,a
0321 EC         +1  3842+1           mov     a,r4
0322 33         +1  3843+1           rlc     a
0323 FC         +1  3844+1           mov     r4,a
0324 EB         +1  3845+1           mov     a,r3
0325 33         +1  3846+1           rlc     a
0326 FB         +1  3847+1           mov     r3,a
0327 EA         +1  3848+1           mov     a,r2
0328 33         +1  3849+1           rlc     a
0329 FA         +1  3850+1           mov     r2,a
032A DEAF       +1  3851             djnz    r6,div1         ;loop if more
                +1  3852+3           copytor prod            ;copy quotient
032C AA0C       +1  3853+1           mov     r2,prod
032E AB0D       +1  3854+1           mov     r3,prod+1
0330 AC0E       +1  3855+1           mov     r4,prod+2
0332 AD0F       +1  3856+1           mov     r5,prod+3
0334            +1  3857     div9:
0334 11EE       +1  3858             call    norm1           ;now normalize result
0336 11DC       +1  3859             call    pack1           ;pack it up
                +1  3860+3           restregs                ;restore registers
0338 D000       +1  3861+1           pop     0
033A D001       +1  3862+1           pop     1
033C D006       +1  3863+1           pop     6
033E D007       +1  3864+1           pop     7
0340 22         +1  3865             ret
                +1  3866     ;------------------------------------------------------------------
                +1  3867     
                +1  3868     ;       Float to long conversion: if the exponent is less than the
                +1  3869     ;       excess value, the result is zero. If the exponent is so large
                +1  3870     ;       that the value would be shifted out, the result is overflow.
                +1  3871     ;       Otherwise shift the mantissa up or down as required.
                +1  3872     
0341            +1  3873     ftol:
                +1  3874+3           saveregs
0341 C007       +1  3875+1           push    7
0343 C006       +1  3876+1           push    6
0345 C001       +1  3877+1           push    1
0347 C000       +1  3878+1           push    0
0349 EA         +1  3879             mov     a,r2
034A B4BF09     +1  3880             cjne    a,#0bfh,ne05
034D EB         +1  3881             mov     a,r3
034E 7006       +1  3882             jnz     ne05
0350 EC         +1  3883             mov     a,r4
0351 7003       +1  3884             jnz     ne05
0353 ED         +1  3885             mov     a,r5
0354 6024       +1  3886             jz      ftol1
0356 119C       +1  3887     ne05:   call    unpack1
0358 E8         +1  3888             mov     a,r0            ;get exponent
0359 2482       +1  3889             add     a,#-(127-1)     ;unbias
035B 20E71C     +1  3890             jb      acc.7,ftol1     ;jump if < 0
035E EF         +1  3891             mov     a,r7            ;get sign
035F 30E70D     +1  3892             jnb     acc.7,ftol4     ;skip if +ve
                +1  3893+3           neg1                    ;negate it
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    61

0362 C3         +1  3894+1           clr     c
0363 E4         +1  3895+1           clr     a
0364 9D         +1  3896+1           subb    a,r5
0365 FD         +1  3897+1           mov     r5,a
0366 E4         +1  3898+1           clr     a
0367 9C         +1  3899+1           subb    a,r4
0368 FC         +1  3900+1           mov     r4,a
0369 E4         +1  3901+1           clr     a
036A 9B         +1  3902+1           subb    a,r3
036B FB         +1  3903+1           mov     r3,a
036C E4         +1  3904+1           clr     a
036D 9A         +1  3905+1           subb    a,r2
036E FA         +1  3906+1           mov     r2,a
036F            +1  3907     ftol4:
036F E8         +1  3908             mov     a,r0            ;get exponent
0370 246A       +1  3909             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0372 20E727     +1  3910             jb      acc.7,ftol2     ;shift has to be right
0375 F8         +1  3911             mov     r0,a            ;save it
0376 24F8       +1  3912             add     a,#-8           ;if > 8, too big
0378 500E       +1  3913             jnc     ftol3
037A            +1  3914     ftol1:
037A E4         +1  3915             clr     a
037B FA         +1  3916             mov     r2,a
037C FB         +1  3917             mov     r3,a
037D FC         +1  3918             mov     r4,a
037E FD         +1  3919             mov     r5,a
037F            +1  3920     ftol9:
                +1  3921+3           restregs
037F D000       +1  3922+1           pop     0
0381 D001       +1  3923+1           pop     1
0383 D006       +1  3924+1           pop     6
0385 D007       +1  3925+1           pop     7
0387 22         +1  3926             ret
0388            +1  3927     ftol3:
0388 E8         +1  3928             mov     a,r0
0389 FE         +1  3929             mov     r6,a            ;store in counter
038A 60F3       +1  3930             jz      ftol9           ;if zero, do nothing
038C            +1  3931     ftol33:
                +1  3932+3           lshift                  ;shift up
038C ED         +1  3933+1           mov     a,r5
038D 33         +1  3934+1           rlc     a
038E FD         +1  3935+1           mov     r5,a
038F EC         +1  3936+1           mov     a,r4
0390 33         +1  3937+1           rlc     a
0391 FC         +1  3938+1           mov     r4,a
0392 EB         +1  3939+1           mov     a,r3
0393 33         +1  3940+1           rlc     a
0394 FB         +1  3941+1           mov     r3,a
0395 EA         +1  3942+1           mov     a,r2
0396 33         +1  3943+1           rlc     a
0397 FA         +1  3944+1           mov     r2,a
0398 DEF2       +1  3945             djnz    r6,ftol33       ;and loop
039A 80E3       +1  3946             sjmp    ftol9
039C            +1  3947     ftol2:
039C F4         +1  3948             cpl     a               ;complement
039D FE         +1  3949             mov     r6,a
039E 6022       +1  3950             jz      ftol22
03A0            +1  3951     ftol23:
03A0 EF         +1  3952             mov     a,r7
03A1 30E70F     +1  3953             jnb     acc.7,ftol24
                +1  3954+3           rshift1
03A4 D3         +1  3955+1           setb    c
03A5 EA         +1  3956+1           mov     a,r2
03A6 13         +1  3957+1           rrc     a
03A7 FA         +1  3958+1           mov     r2,a
03A8 EB         +1  3959+1           mov     a,r3
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    62

03A9 13         +1  3960+1           rrc     a
03AA FB         +1  3961+1           mov     r3,a
03AB EC         +1  3962+1           mov     a,r4
03AC 13         +1  3963+1           rrc     a
03AD FC         +1  3964+1           mov     r4,a
03AE ED         +1  3965+1           mov     a,r5
03AF 13         +1  3966+1           rrc     a
03B0 FD         +1  3967+1           mov     r5,a
03B1 800D       +1  3968             jmp     ftol25
03B3            +1  3969+3   ftol24: rshift                  ;shift down
03B3 C3         +1  3970+1           clr     c
03B4 EA         +1  3971+1           mov     a,r2
03B5 13         +1  3972+1           rrc     a
03B6 FA         +1  3973+1           mov     r2,a
03B7 EB         +1  3974+1           mov     a,r3
03B8 13         +1  3975+1           rrc     a
03B9 FB         +1  3976+1           mov     r3,a
03BA EC         +1  3977+1           mov     a,r4
03BB 13         +1  3978+1           rrc     a
03BC FC         +1  3979+1           mov     r4,a
03BD ED         +1  3980+1           mov     a,r5
03BE 13         +1  3981+1           rrc     a
03BF FD         +1  3982+1           mov     r5,a
03C0 DEDE       +1  3983     ftol25: djnz    r6,ftol23
03C2            +1  3984     ftol22:
                +1  3985+3           add1                    ;round
03C2 ED         +1  3986+1           mov     a,r5
03C3 2401       +1  3987+1           add     a,#1
03C5 FD         +1  3988+1           mov     r5,a
03C6 E4         +1  3989+1           clr     a
03C7 3C         +1  3990+1           addc    a,r4
03C8 FC         +1  3991+1           mov     r4,a
03C9 E4         +1  3992+1           clr     a
03CA 3B         +1  3993+1           addc    a,r3
03CB FB         +1  3994+1           mov     r3,a
03CC E4         +1  3995+1           clr     a
03CD 3A         +1  3996+1           addc    a,r2
03CE FA         +1  3997+1           mov     r2,a
03CF EF         +1  3998             mov     a,r7
03D0 30E70F     +1  3999             jnb     acc.7,ftol26
                +1  4000+3           rshift1
03D3 D3         +1  4001+1           setb    c
03D4 EA         +1  4002+1           mov     a,r2
03D5 13         +1  4003+1           rrc     a
03D6 FA         +1  4004+1           mov     r2,a
03D7 EB         +1  4005+1           mov     a,r3
03D8 13         +1  4006+1           rrc     a
03D9 FB         +1  4007+1           mov     r3,a
03DA EC         +1  4008+1           mov     a,r4
03DB 13         +1  4009+1           rrc     a
03DC FC         +1  4010+1           mov     r4,a
03DD ED         +1  4011+1           mov     a,r5
03DE 13         +1  4012+1           rrc     a
03DF FD         +1  4013+1           mov     r5,a
03E0 809D       +1  4014             jmp     ftol9
03E2            +1  4015+3   ftol26: rshift
03E2 C3         +1  4016+1           clr     c
03E3 EA         +1  4017+1           mov     a,r2
03E4 13         +1  4018+1           rrc     a
03E5 FA         +1  4019+1           mov     r2,a
03E6 EB         +1  4020+1           mov     a,r3
03E7 13         +1  4021+1           rrc     a
03E8 FB         +1  4022+1           mov     r3,a
03E9 EC         +1  4023+1           mov     a,r4
03EA 13         +1  4024+1           rrc     a
03EB FC         +1  4025+1           mov     r4,a
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    63

03EC ED         +1  4026+1           mov     a,r5
03ED 13         +1  4027+1           rrc     a
03EE FD         +1  4028+1           mov     r5,a
03EF 808E       +1  4029             jmp     ftol9
                +1  4030     
                +1  4031     ;       arithmetic integer to floating conversions
                +1  4032     
03F1            +1  4033     abtof:
03F1 ED         +1  4034             mov     a,r5
03F2 23         +1  4035             rl      a
03F3 FC         +1  4036             mov     r4,a
03F4 9C         +1  4037             subb    a,r4
03F5 FC         +1  4038             mov     r4,a
03F6 FB         +1  4039             mov     r3,a
03F7 FA         +1  4040             mov     r2,a
03F8 8006       +1  4041             jmp     altof
03FA            +1  4042     awtof:
03FA EC         +1  4043             mov     a,r4
03FB 23         +1  4044             rl      a
03FC FB         +1  4045             mov     r3,a
03FD 9B         +1  4046             subb    a,r3
03FE FB         +1  4047             mov     r3,a
03FF FA         +1  4048             mov     r2,a
0400            +1  4049     altof:
                +1  4050+3           saveregs
0400 C007       +1  4051+1           push    7
0402 C006       +1  4052+1           push    6
0404 C001       +1  4053+1           push    1
0406 C000       +1  4054+1           push    0
0408 EA         +1  4055             mov     a,r2            ;get sign
0409 5480       +1  4056             anl     a,#80h
040B FF         +1  4057             mov     r7,a            ;store it
040C 30E70D     +1  4058             jnb     acc.7,altof1    ;skip if +ve
                +1  4059+3           neg1
040F C3         +1  4060+1           clr     c
0410 E4         +1  4061+1           clr     a
0411 9D         +1  4062+1           subb    a,r5
0412 FD         +1  4063+1           mov     r5,a
0413 E4         +1  4064+1           clr     a
0414 9C         +1  4065+1           subb    a,r4
0415 FC         +1  4066+1           mov     r4,a
0416 E4         +1  4067+1           clr     a
0417 9B         +1  4068+1           subb    a,r3
0418 FB         +1  4069+1           mov     r3,a
0419 E4         +1  4070+1           clr     a
041A 9A         +1  4071+1           subb    a,r2
041B FA         +1  4072+1           mov     r2,a
041C            +1  4073     altof1:
041C 7896       +1  4074             mov     r0,#127+23      ;initialize exponent
041E 11EE       +1  4075             call    norm1           ;normalize it
0420 11DC       +1  4076             call    pack1           ;and pack up
                +1  4077+3           restregs
0422 D000       +1  4078+1           pop     0
0424 D001       +1  4079+1           pop     1
0426 D006       +1  4080+1           pop     6
0428 D007       +1  4081+1           pop     7
042A 22         +1  4082             ret
                +1  4083     
042B            +1  4084     lbtof:
042B 7C00       +1  4085             mov     r4,#0
042D            +1  4086     lwtof:
042D E4         +1  4087             clr     a
042E FB         +1  4088             mov     r3,a
042F FA         +1  4089             mov     r2,a
0430            +1  4090     lltof:
                +1  4091+3           saveregs
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    64

0430 C007       +1  4092+1           push    7
0432 C006       +1  4093+1           push    6
0434 C001       +1  4094+1           push    1
0436 C000       +1  4095+1           push    0
0438 7F00       +1  4096             mov     r7,#0           ;zero sign
043A 80E0       +1  4097             sjmp    altof1
                +1  4098     
                +1  4099     ;-------------------------------------------------------
                +1  4100     
                +1  4101     
                    4102     
                    4103     ;$include (d:\amp\wriread.asm)                                        
                    4104     END
                                                                             
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    65

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
ABIN . . . . . . .  D ADDR   004FH   A      296# 1029 1034
ABTOF. . . . . . .  C ADDR   03F1H   A      4033#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 565 608 616 624 632 634 993 1284 1508 1517 1713 2039 2440 2518 2521
                                           2778 3430 3513 3530 3562 3600 3628 3890 3892 3910 3953 3999 4058
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   1026H   R   SEG=MAIN   706 741 743 745 747 749 751 753 755 757 3019#
ADEC . . . . . . .  D ADDR   0053H   A      297# 1033 1037
AFTERK . . . . . .  C ADDR   0439H   R   SEG=MAIN   832 879#
AGE1 . . . . . . .  C ADDR   019FH   R   SEG=MAIN   487# 490
AGEON. . . . . . .  C ADDR   01E6H   R   SEG=MAIN   540# 542
ALESS0 . . . . . .  C ADDR   051DH   R   SEG=MAIN   993 1014#
ALMUL. . . . . . .  C ADDR   0F6DH   R   SEG=MAIN   2865#
ALTOF. . . . . . .  C ADDR   0400H   A      837 861 884 896 1144 1201 1239 4041 4049#
ALTOF1 . . . . . .  C ADDR   041CH   A      4058 4073# 4097
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   03ACH   R   SEG=MAIN   641 801 807#
AN_T7. . . . . . .  C ADDR   0891H   R   SEG=MAIN   1545# 1579 1581 1584 1592 1599
AUTOKA . . . . . .  C ADDR   0604H   R   SEG=MAIN   826 1171#
AWTOF. . . . . . .  C ADDR   03FAH   A      4042#
B. . . . . . . . .  D ADDR   00F0H   A      122# 1755 2868 2871 2873 2877 2881 2885 2889 2894 2898 2905 2909 2913
                                           2919 2923 2927 2933 3626 3627
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   241 405#
BFORM. . . . . . .  C ADDR   0C81H   R   SEG=MAIN   2166 2171 2183# 2209
BIN30. . . . . . .  C ADDR   0D89H   R   SEG=MAIN   2428# 2454
BIN31. . . . . . .  C ADDR   0D8DH   R   SEG=MAIN   2433# 2437
BIN32. . . . . . .  C ADDR   0D9DH   R   SEG=MAIN   2446# 2451
BIN41. . . . . . .  C ADDR   0DAEH   R   SEG=MAIN   2462# 2472
BINDEC . . . . . .  C ADDR   0D7DH   R   SEG=MAIN   1035 2407#
BITAVP . . . . . .  B ADDR   0020H.5 A      312# 902 957 1571 1572 1574
BITBON . . . . . .  B ADDR   0021H.2 A      319# 1072 1314 1315 1317
BITBUF . . . . . .  B ADDR   0021H.0 A      317# 1093 1095 1364
BITIZM . . . . . .  B ADDR   0020H.4 A      311# 586 901 958 1299 1342 1357 1358 1362 1388 1532 1565 1640 1651 1693
BITMAS . . . . . .  B ADDR   0020H.1 A      308# 763 766 2148
BITMEM . . . . . .  B ADDR   0021H.3 A      320#
BITMENU. . . . . .  B ADDR   0022H.1 A      328#
BITNUL . . . . . .  B ADDR   0021H.7 A      324# 1586 1587 1594
BITPRD . . . . . .  B ADDR   0021H.1 A      318# 1071
BITRS. . . . . . .  B ADDR   0020H.3 A      310#
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    66

BITT2. . . . . . .  B ADDR   0022H.0 A      327# 1389 1424 1601
BITVI11. . . . . .  B ADDR   0020H.6 A      313# 903 1341 1490
BITVI12. . . . . .  B ADDR   0022H.2 A      329#
BITVI13. . . . . .  B ADDR   0022H.3 A      330#
BITVI21. . . . . .  B ADDR   0022H.5 A      332# 1644
BITVI31. . . . . .  B ADDR   0022H.6 A      333#
BITVICH. . . . . .  B ADDR   0022H.4 A      331# 1343 1352 1439 1616 1639 1650
BITZNAK. . . . . .  B ADDR   0020H.0 A      307# 566 591 869
BITZUS . . . . . .  B ADDR   0020H.7 A      314# 970
BMEM11 . . . . . .  B ADDR   0021H.4 A      321# 1491 1696
BMEM12 . . . . . .  B ADDR   0021H.5 A      322#
BMEM13 . . . . . .  B ADDR   0021H.6 A      323#
BUFDEC . . . . . .  C ADDR   0540H   R   SEG=MAIN   1040# 1045
BUFIND . . . . . .  D ADDR   0040H   A      294# 486 490 539 542 1003 1008 1038 1046 1048 1052 1753 1771 1973
BUFON. . . . . . .  C ADDR   0706H   R   SEG=MAIN   1314 1317#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F5H   A      3623# 3627
CELLBIT. . . . . .  D ADDR   0020H   A      306# 307 308 309 310 311 312 313 314
CELLBIT1 . . . . .  D ADDR   0021H   A      316# 317 318 319 320 321 322 323 324
CELLBIT2 . . . . .  D ADDR   0022H   A      326# 327 328 329 330 331 332 333
CEXP . . . . . . .  C ADDR   01E0H   A      3600 3609#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   0D39H   R   SEG=MAIN   1595 2340#
CH1. . . . . . . .  C ADDR   0D55H   R   SEG=MAIN   1960 2350#
CH10 . . . . . . .  C ADDR   0D3DH   R   SEG=MAIN   774 2341#
CH100. . . . . . .  C ADDR   0D4DH   R   SEG=MAIN   664 988 2345#
CH10000. . . . . .  C ADDR   0D49H   R   SEG=MAIN   2344#
CH2. . . . . . . .  C ADDR   0D51H   R   SEG=MAIN   770 2346#
CH5. . . . . . . .  C ADDR   0D41H   R   SEG=MAIN   2342#
CH954. . . . . . .  C ADDR   0D45H   R   SEG=MAIN   2343#
CHANMA . . . . . .  C ADDR   0820H   R   SEG=MAIN   1478 1481#
CHANZ. . . . . . .  C ADDR   0818H   R   SEG=MAIN   1467 1477#
CHAVT. . . . . . .  D ADDR   0081H   A      345# 468 817 851 1271
CHBEFORE . . . . .  D ADDR   009BH   A      355# 661 680
CHBUF. . . . . . .  D ADDR   00ADH   A      362# 1069 1079
CHCMP. . . . . . .  C ADDR   0D26H   R   SEG=MAIN   578 810 818 823 2325#
CHDEC. . . . . . .  C ADDR   0B55H   R   SEG=MAIN   585 852 854 1952#
CHDEL. . . . . . .  D ADDR   0083H   A      346# 1117 1158 1178 1221 1265
CHDELMO. . . . . .  C ADDR   05EFH   R   SEG=MAIN   1129 1158# 1162
CHIF . . . . . . .  C ADDR   0AF5H   R   SEG=MAIN   1837 1839#
CHIND. . . . . . .  D ADDR   00ACH   A      361# 915 1067
CHINKOR. . . . . .  D ADDR   0098H   A      344# 463 809 822 853 1164
CHKL . . . . . . .  D ADDR   003DH   A      303# 577 584 1367 1393 1546 1697
CHMAS. . . . . . .  D ADDR   006EH   A      298# 760 767 778 2147
CHMASN . . . . . .  D ADDR   003FH   A      304# 654 695 765 794
CHTADC . . . . . .  C ADDR   0B96H   R   SEG=MAIN   1997#
CHTHO. . . . . . .  C ADDR   0D61H   R   SEG=MAIN   1208 1246 2353#
CH_1 . . . . . . .  C ADDR   0D59H   R   SEG=MAIN   479 2351#
CH_10TH. . . . . .  C ADDR   0D6DH   R   SEG=MAIN   931 2356#
CH_200 . . . . . .  C ADDR   0D69H   R   SEG=MAIN   897 2355#
CH_220 . . . . . .  C ADDR   0D65H   R   SEG=MAIN   885 2354#
CH_953 . . . . . .  C ADDR   0D5DH   R   SEG=MAIN   2352#
CIKLWR . . . . . .  C ADDR   0C57H   R   SEG=MAIN   2154#
CKCON. . . . . . .  D ADDR   008EH   A      30# 423
CLE256 . . . . . .  C ADDR   0AF6H   R   SEG=MAIN   519 1849#
CLEAR. . . . . . .  C ADDR   0D77H   R   SEG=MAIN   2385 2389# 2419
CLMASSIX . . . . .  C ADDR   0C47H   R   SEG=MAIN   462 2141#
CLMASV . . . . . .  C ADDR   04B8H   R   SEG=MAIN   938 940#
CLMAX. . . . . . .  C ADDR   0C4CH   R   SEG=MAIN   2143# 2146
CLR11. . . . . . .  C ADDR   0D78H   R   SEG=MAIN   2391# 2393
CLRDEC . . . . . .  C ADDR   0D71H   R   SEG=MAIN   2383#
CLRNUM . . . . . .  C ADDR   0D75H   R   SEG=MAIN   2386# 2500
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    67

CNTR . . . . . . .  N NUMB   0006H   A      3296#
CO1S . . . . . . .  C ADDR   0BF7H   R   SEG=MAIN   2068# 2068
CO2S . . . . . . .  C ADDR   0BF3H   R   SEG=MAIN   2066# 2070
COND . . . . . . .  C ADDR   0CBBH   R   SEG=MAIN   2238#
CONSTE . . . . . .  D ADDR   00A4H   A      359# 945
CONSTF . . . . . .  D ADDR   00A8H   A      360# 950
COPY1. . . . . . .  C ADDR   0B4DH   R   SEG=MAIN   1937# 1942
COPYP. . . . . . .  C ADDR   01A8H   R   SEG=MAIN   494#
COPYPP . . . . . .  C ADDR   0B47H   R   SEG=MAIN   498 1934#
COSS . . . . . . .  C ADDR   0C00H   R   SEG=MAIN   2074# 2078
COUNT. . . . . . .  C ADDR   0BDEH   R   SEG=MAIN   2047# 2047
COZS . . . . . . .  C ADDR   0C04H   R   SEG=MAIN   2076# 2076
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   0BE5H   R   SEG=MAIN   2053# 2053
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 428
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 995 1016
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 998 1020
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 429
DAC1H. . . . . . .  D ADDR   00D6H   A      97#
DAC1L. . . . . . .  D ADDR   00D5H   A      96#
DCOA . . . . . . .  C ADDR   0CC0H   R   SEG=MAIN   2242# 2244
DCOB . . . . . . .  C ADDR   0CC7H   R   SEG=MAIN   2246# 2264
DCOC . . . . . . .  C ADDR   0CD2H   R   SEG=MAIN   2256# 2261
DCOD . . . . . . .  C ADDR   0CDFH   R   SEG=MAIN   2263 2266#
DEC30. . . . . . .  C ADDR   0DCAH   R   SEG=MAIN   2510# 2535
DEC31. . . . . . .  C ADDR   0DCFH   R   SEG=MAIN   2516# 2523
DEC32. . . . . . .  C ADDR   0DDFH   R   SEG=MAIN   2528# 2532
DECBIN . . . . . .  C ADDR   0DBDH   R   SEG=MAIN   2489#
DECSIZE. . . . . .  N NUMB   000AH   A      2364# 2384 2418 2445 2458 2461 2515
DECT2. . . . . . .  C ADDR   0DE8H   R   SEG=MAIN   2506 2538#
DEDPTR . . . . . .  C ADDR   103DH   R   SEG=MAIN   3023 3027 3031 3037#
DENORM . . . . . .  C ADDR   0131H   A      3455# 3511
DIAP . . . . . . .  D ADDR   00AEH   A      363# 474 935 959 1333 1413 1577 1717
DIINC. . . . . . .  C ADDR   0721H   R   SEG=MAIN   1334 1337#
DIV1 . . . . . . .  C ADDR   02DBH   A      3792# 3851
DIV2 . . . . . . .  C ADDR   031EH   A      3810 3814 3818 3822 3837#
DIV3 . . . . . . .  C ADDR   030BH   A      3811 3815 3819 3823#
DIV9 . . . . . . .  C ADDR   0334H   A      3781 3783 3857#
DIVIDE . . . . . .  C ADDR   0EA8H   R   SEG=MAIN   666 2170 2724#
DONE . . . . . . .  C ADDR   0E17H   R   SEG=MAIN   2554 2565#
DONE1. . . . . . .  C ADDR   0E15H   R   SEG=MAIN   2557 2560 2563#
DOSH . . . . . . .  C ADDR   0F31H   R   SEG=MAIN   2799 2815#
DOSUB. . . . . . .  C ADDR   0F1FH   R   SEG=MAIN   2783 2787 2791 2795 2796 2800#
DPH. . . . . . . .  D ADDR   0083H   A      19# 1883 1934 2086 2094 2571 2607 2642 2645 2657 2680 3042 3044
DPL. . . . . . . .  D ADDR   0082H   A      18# 1884 1935 2087 2093 2587 2623 2644 2658 2661 2695 3039 3041
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 426
EIE2 . . . . . . .  D ADDR   00E7H   A      113#
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDSUM . . . . . .  C ADDR   0366H   R   SEG=MAIN   707 759#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    68

EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      3298#
EXP2 . . . . . . .  N NUMB   0001H   A      3300# 3477 3498
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINIS. . . . . . .  C ADDR   0F5CH   R   SEG=MAIN   2743 2844#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0164H   A      952 3503# 3592
FLCMP. . . . . . .  C ADDR   01D4H   A      887 899 933 3597#
FLDIV. . . . . . .  C ADDR   02B5H   A      949 1210 1248 3767#
FLMUL. . . . . . .  C ADDR   0201H   A      840 873 891 3637#
FLOUT. . . . . . .  C ADDR   01DFH   A      3604 3607#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 1855 1856 1916
FLSUB. . . . . . .  C ADDR   01CFH   A      865 1206 1244 3590#
FND. . . . . . . .  C ADDR   01F6H   A      3613 3616 3619 3622 3625#
FO1M . . . . . . .  C ADDR   0C7EH   R   SEG=MAIN   2176 2180#
FO2M . . . . . . .  C ADDR   0C87H   R   SEG=MAIN   2183 2185#
FORM4. . . . . . .  C ADDR   0C88H   R   SEG=MAIN   2178 2184 2188#
FT1IZM . . . . . .  C ADDR   07C3H   R   SEG=MAIN   1432 1435#
FTOL . . . . . . .  C ADDR   0341H   A      841 874 893 3873#
FTOL1. . . . . . .  C ADDR   037AH   A      3886 3890 3914#
FTOL2. . . . . . .  C ADDR   039CH   A      3910 3947#
FTOL22 . . . . . .  C ADDR   03C2H   A      3950 3984#
FTOL23 . . . . . .  C ADDR   03A0H   A      3951# 3983
FTOL24 . . . . . .  C ADDR   03B3H   A      3953 3969#
FTOL25 . . . . . .  C ADDR   03C0H   A      3968 3983#
FTOL26 . . . . . .  C ADDR   03E2H   A      3999 4015#
FTOL3. . . . . . .  C ADDR   0388H   A      3913 3927#
FTOL33 . . . . . .  C ADDR   038CH   A      3931# 3945
FTOL4. . . . . . .  C ADDR   036FH   A      3892 3907#
FTOL9. . . . . . .  C ADDR   037FH   A      3920# 3930 3946 4014 4029
GENER. . . . . . .  C ADDR   013FH   R   SEG=MAIN   434# 435
GOA2 . . . . . . .  C ADDR   0474H   R   SEG=MAIN   901 904#
GOA3A2 . . . . . .  C ADDR   047EH   R   SEG=MAIN   909# 955
GOCIKLE. . . . . .  C ADDR   0596H   R   SEG=MAIN   1073 1082 1086 1093# 1098 1101
GOONIN . . . . . .  C ADDR   0488H   R   SEG=MAIN   915# 942 963 971
GOONIND. . . . . .  C ADDR   0562H   R   SEG=MAIN   1060#
GOONT. . . . . . .  C ADDR   0580H   R   SEG=MAIN   1076 1078#
GOTOKD . . . . . .  C ADDR   03D9H   R   SEG=MAIN   805 828#
GOWR . . . . . . .  C ADDR   01B8H   R   SEG=MAIN   503# 515
GOZNAK . . . . . .  C ADDR   0246H   R   SEG=MAIN   572 597#
HNOR11 . . . . . .  C ADDR   0972H   R   SEG=MAIN   1618 1630 1654#
HNOR12 . . . . . .  C ADDR   093FH   R   SEG=MAIN   1626 1630# 1656
HNOR13 . . . . . .  C ADDR   0977H   R   SEG=MAIN   1654 1656#
HNOT1. . . . . . .  C ADDR   0981H   R   SEG=MAIN   1604 1671#
HNOT2. . . . . . .  C ADDR   0910H   R   SEG=MAIN   1610# 1668
HR12 . . . . . . .  C ADDR   0935H   R   SEG=MAIN   1621 1626# 1655
HVI1113. . . . . .  C ADDR   092FH   R   SEG=MAIN   1624# 1629 1634
HYEST6 . . . . . .  C ADDR   0979H   R   SEG=MAIN   1606 1664#
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 494 1915 1927
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
IND. . . . . . . .  C ADDR   0B6DH   R   SEG=MAIN   491 543 588 1064 1328 1349 1391 1436 1568 1610 1647 1695 1973#
INDOLL . . . . . .  C ADDR   04E1H   R   SEG=MAIN   957 958 962#
INIACP . . . . . .  C ADDR   0AA8H   R   SEG=MAIN   536 1677 1802#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZMAN. . . . . . .  C ADDR   0742H   R   SEG=MAIN   1301 1357#
IZMFUN . . . . . .  C ADDR   074BH   R   SEG=MAIN   1329 1335 1339 1361 1364#
IZMPAT . . . . . .  C ADDR   074DH   R   SEG=MAIN   1312 1316 1318 1355 1365#
IZMT2. . . . . . .  C ADDR   075CH   R   SEG=MAIN   1368 1373#
IZMT3. . . . . . .  C ADDR   0767H   R   SEG=MAIN   1373 1379#
JFINIS . . . . . .  C ADDR   0EC3H   R   SEG=MAIN   2735 2743#
KEYB1. . . . . . .  C ADDR   06B9H   R   SEG=MAIN   1283#
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    69

KEYB2. . . . . . .  C ADDR   084DH   R   SEG=MAIN   1516#
KLMAS. . . . . . .  C ADDR   02D1H   R   SEG=MAIN   670 684 689 694#
KNAVP. . . . . . .  C ADDR   08C1H   R   SEG=MAIN   1540 1571#
KNIZMON. . . . . .  C ADDR   0749H   R   SEG=MAIN   1357 1362#
KNKMP. . . . . . .  C ADDR   0844H   R   SEG=MAIN   1513# 1536
KNLEFT . . . . . .  C ADDR   08CEH   R   SEG=MAIN   1538 1577#
KNMEM. . . . . . .  C ADDR   09A3H   R   SEG=MAIN   1512 1693#
KNMENU . . . . . .  C ADDR   08B3H   R   SEG=MAIN   1544 1565#
KNNUL. . . . . . .  C ADDR   08DEH   R   SEG=MAIN   1534 1586#
KNOPT. . . . . . .  C ADDR   076FH   R   SEG=MAIN   1307 1387#
KNRAZR . . . . . .  C ADDR   0783H   R   SEG=MAIN   1281 1399#
KNRIGHT. . . . . .  C ADDR   071AH   R   SEG=MAIN   1305 1331#
KNVICH . . . . . .  C ADDR   0724H   R   SEG=MAIN   1311 1341#
KOEFKD . . . . . .  D ADDR   00A0H   A      358# 838 889
KOEFKM . . . . . .  D ADDR   0094H   A      352# 483 871 1252
KOEFKP . . . . . .  D ADDR   0090H   A      351# 481 866 1214
KOR0_AN. . . . . .  D ADDR   0084H   A      348# 862 1145 1204 1242
KORNUL . . . . . .  C ADDR   05B5H   R   SEG=MAIN   813 1117#
LABELA . . . . . .  C ADDR   0224H   R   SEG=MAIN   575# 1096
LABELB . . . . . .  C ADDR   0571H   R   SEG=MAIN   849 974 1069# 1106 1110 1112
LABELC . . . . . .  C ADDR   0783H   R   SEG=MAIN   1400#
LABELE . . . . . .  C ADDR   074DH   R   SEG=MAIN   1366# 1405 1408 1418 1420
LABELF . . . . . .  C ADDR   07ADH   R   SEG=MAIN   1280 1423#
LABELH . . . . . .  C ADDR   08FEH   R   SEG=MAIN   1515 1601#
LABELI . . . . . .  C ADDR   09B6H   R   SEG=MAIN   1703#
LABELK . . . . . .  C ADDR   09B6H   R   SEG=MAIN   1614 1702#
LABELL . . . . . .  C ADDR   082CH   R   SEG=MAIN   1491 1498#
LADD . . . . . . .  C ADDR   1004H   R   SEG=MAIN   660 2970#
LADDX. . . . . . .  C ADDR   1015H   R   SEG=MAIN   2994#
LBTOF. . . . . . .  C ADDR   042BH   A      4084#
LCMP . . . . . . .  C ADDR   0E02H   R   SEG=MAIN   2207 2335 2550#
LDC_LONG . . . . .  C ADDR   0E18H   R   SEG=MAIN   480 1209 1247 1596 2570#
LDC_LTEMP. . . . .  C ADDR   0E3AH   R   SEG=MAIN   665 771 775 886 898 932 989 1961 2606#
LDX_LONG . . . . .  C ADDR   0E60H   R   SEG=MAIN   2641#
LDX_LTEMP. . . . .  C ADDR   0E86H   R   SEG=MAIN   2679#
LEVEL. . . . . . .  D ADDR   00B0H   A      365# 1320
LLMUL. . . . . . .  C ADDR   0F6DH   R   SEG=MAIN   2864#
LLSUB. . . . . . .  C ADDR   0FF2H   R   SEG=MAIN   2946#
LLTOF. . . . . . .  C ADDR   0430H   A      4090#
LMUL . . . . . . .  C ADDR   0F6DH   R   SEG=MAIN   2165 2866#
LOADB. . . . . . .  C ADDR   098DH   R   SEG=MAIN   1676# 1689 1691
LOADB2 . . . . . .  C ADDR   099AH   R   SEG=MAIN   1682 1685#
LOADKD . . . . . .  C ADDR   0AF6H   R   SEG=MAIN   1843#
LOADT. . . . . . .  C ADDR   09FCH   R   SEG=MAIN   1390 1430 1435 1609 1752#
LOADUS . . . . . .  C ADDR   09CBH   R   SEG=MAIN   537 1583 1717#
LOD1 . . . . . . .  C ADDR   0A0BH   R   SEG=MAIN   1760# 1765
LODT . . . . . . .  C ADDR   0A17H   R   SEG=MAIN   1772# 1777
LOLEVT . . . . . .  C ADDR   09FEH   R   SEG=MAIN   1326 1753#
LOOP . . . . . . .  C ADDR   0BD3H   R   SEG=MAIN   2038# 2039
LOOPS. . . . . . .  C ADDR   0EC6H   R   SEG=MAIN   2745# 2778
LOTEXT . . . . . .  C ADDR   0A13H   R   SEG=MAIN   1348 1444 1451 1457 1567 1624 1633 1646 1665 1694 1769#
LSUB . . . . . . .  C ADDR   0FF2H   R   SEG=MAIN   846 1962 2947#
LTEMP. . . . . . .  N NUMB   0008H   A      778 780 781 782 2217 2220 2223 2226 2269 2270 2271 2272 2362# 2736 2737
                                           2738 2739 2748 2752 2756 2760 2763 2764 2765 2766 2767 2768 2769 2770 2771
                                           2772 2773 2774 2777 2780 2785 2789 2793 2803 2806 2809 2812 2828 2831 2832
                                           2834 2835 2837 2838 2840 2845 2846 2847 2848 2868 2873 2881 2889 2894 2905
                                           2913 2919 2927 2933 3301 3302 3341 3346 3348 3357 3358 3359 3360 3591 3599
                                           3612 3615 3618 3621
LWR. . . . . . . .  C ADDR   0C59H   R   SEG=MAIN   2156# 2160
LWRX . . . . . . .  C ADDR   0C0DH   R   SEG=MAIN   2085# 2097
LWTOF. . . . . . .  C ADDR   042DH   A      4086#
MABIN. . . . . . .  D ADDR   006FH   A      299#
MAFORM . . . . . .  C ADDR   0C74H   R   SEG=MAIN   1028 2164 2169 2174# 2206
MAIN . . . . . . .  C SEG    104FH       REL=UNIT   237 290# 398
MANT1. . . . . . .  N NUMB   0002H   A      3299# 3326 3375 3376
MANT2. . . . . . .  N NUMB   0008H   A      3301# 3352 3353 3484 3486 3487 3489 3490 3492 3493 3495 3534 3535 3537
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    70

                                           3538 3540 3541 3543 3544 3548 3550 3553 3556 3654 3656 3657 3659 3660 3662
                                           3663 3665 3716 3718 3719 3721 3722 3724 3725 3727 3809 3813 3817 3821 3825
                                           3828 3831 3834
MARK0_8. . . . . .  C ADDR   0812H   R   SEG=MAIN   1469 1473#
MARKER . . . . . .  D ADDR   00B2H   A      367# 1468 1832
MAS10. . . . . . .  C ADDR   02EFH   R   SEG=MAIN   696 708#
MAS5DIV. . . . . .  C ADDR   0392H   R   SEG=MAIN   772 776 784#
MASFULL. . . . . .  C ADDR   0375H   R   SEG=MAIN   763 769#
MASS0. . . . . . .  X ADDR   0080H   A      371 372# 697 702 729 737 2142
MASS1. . . . . . .  X ADDR   0084H   A      373# 705 726 740
MASS2. . . . . . .  X ADDR   0088H   A      374# 723 742
MASS3. . . . . . .  X ADDR   008CH   A      375# 720 744
MASS4. . . . . . .  X ADDR   0090H   A      376# 717 746
MASS5. . . . . . .  X ADDR   0094H   A      377# 714 748
MASS6. . . . . . .  X ADDR   0098H   A      378# 712 750
MASS7. . . . . . .  X ADDR   009CH   A      379# 710 752
MASS8. . . . . . .  X ADDR   00A0H   A      380# 708 754
MASS9. . . . . . .  X ADDR   00A4H   A      381# 756
MASX5. . . . . . .  C ADDR   0388H   R   SEG=MAIN   765 778#
MEAVP. . . . . . .  C ADDR   08C9H   R   SEG=MAIN   1571 1574#
MECLE. . . . . . .  C ADDR   0163H   R   SEG=MAIN   454# 456
MEFF . . . . . . .  C ADDR   016AH   R   SEG=MAIN   458# 461
MIDL . . . . . . .  C ADDR   0EF9H   R   SEG=MAIN   2740 2775#
MM3. . . . . . . .  C ADDR   0AF6H   R   SEG=MAIN   1852#
MM5. . . . . . . .  C ADDR   0B06H   R   SEG=MAIN   1867# 1878
MMM. . . . . . . .  C ADDR   021FH   R   SEG=MAIN   570#
MO220. . . . . . .  C ADDR   04D6H   R   SEG=MAIN   900 927 957#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOVE28 . . . . . .  C ADDR   0CE1H   R   SEG=MAIN   1207 1245 2269#
MOVEA3 . . . . . .  C ADDR   0526H   R   SEG=MAIN   999 1024#
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   0218H   A      3651# 3694
MUP11. . . . . . .  C ADDR   0255H   A      3698# 3743
MUP2 . . . . . . .  C ADDR   0295H   A      3728 3742#
MUP3 . . . . . . .  C ADDR   026AH   A      3697 3713#
N12DELCH . . . . .  C ADDR   06ACH   R   SEG=MAIN   1269 1276#
N4DELCH. . . . . .  C ADDR   0655H   R   SEG=MAIN   1187 1225#
N8DELCH. . . . . .  C ADDR   069DH   R   SEG=MAIN   1225 1269#
NE05 . . . . . . .  C ADDR   0356H   A      3880 3882 3884 3887#
NEXIN. . . . . . .  C ADDR   0B71H   R   SEG=MAIN   1975# 1982
NMINUS . . . . . .  C ADDR   042BH   R   SEG=MAIN   869 872#
NNDELCH. . . . . .  C ADDR   0615H   R   SEG=MAIN   1179 1187#
NO . . . . . . . .  C ADDR   0EE1H   R   SEG=MAIN   2750 2754 2758 2762#
NO0KEY . . . . . .  C ADDR   0231H   R   SEG=MAIN   579 584#
NO11V6 . . . . . .  C ADDR   07F9H   R   SEG=MAIN   1441 1460#
NO12V6 . . . . . .  C ADDR   07FEH   R   SEG=MAIN   1460 1462#
NO13V6 . . . . . .  C ADDR   0803H   R   SEG=MAIN   1462 1466#
NO2PARN. . . . . .  C ADDR   0514H   R   SEG=MAIN   1001 1007#
NO3PARN. . . . . .  C ADDR   050BH   R   SEG=MAIN   1001# 1061
NO4DEL . . . . . .  C ADDR   05F5H   R   SEG=MAIN   1131 1162#
NOAVK. . . . . . .  C ADDR   040EH   R   SEG=MAIN   824 853#
NOAVP. . . . . . .  C ADDR   0471H   R   SEG=MAIN   903# 934 936
NOBEF99. . . . . .  C ADDR   02B5H   R   SEG=MAIN   662 671# 681
NOBIT. . . . . . .  C ADDR   0243H   A      3666 3680#
NOBUF0 . . . . . .  C ADDR   05A0H   R   SEG=MAIN   1070 1100#
NOCHI0 . . . . . .  C ADDR   04ECH   R   SEG=MAIN   916 973#
NOCHN2 . . . . . .  C ADDR   0380H   R   SEG=MAIN   769 774#
NODI2. . . . . . .  C ADDR   04E3H   R   SEG=MAIN   960 965#
NODI6. . . . . . .  C ADDR   08D5H   R   SEG=MAIN   1578 1581#
NODI9. . . . . . .  C ADDR   04E8H   R   SEG=MAIN   967 969#
NOFIZM . . . . . .  C ADDR   07C9H   R   SEG=MAIN   1424 1439#
NOFT1. . . . . . .  C ADDR   07C2H   R   SEG=MAIN   1428 1434#
NOFZ . . . . . . .  C ADDR   059BH   R   SEG=MAIN   1093 1096#
NOH37. . . . . . .  C ADDR   094CH   R   SEG=MAIN   1620 1636#
NOHNOT1. . . . . .  C ADDR   09A1H   R   SEG=MAIN   1673 1690#
NOHNOT2. . . . . .  C ADDR   099FH   R   SEG=MAIN   1674 1688#
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    71

NOKORR . . . . . .  C ADDR   03BCH   R   SEG=MAIN   811 815#
NOLAH. . . . . . .  C ADDR   0919H   R   SEG=MAIN   1601 1616#
NON1C. . . . . . .  C ADDR   0794H   R   SEG=MAIN   1406 1410#
NONULAVT . . . . .  C ADDR   0409H   R   SEG=MAIN   819 851#
NONULDEL . . . . .  C ADDR   05CAH   R   SEG=MAIN   1118 1131#
NOP3_0 . . . . . .  C ADDR   04F0H   R   SEG=MAIN   921 923 979#
NOPART1. . . . . .  C ADDR   02B9H   R   SEG=MAIN   655 678#
NOPART2. . . . . .  C ADDR   02C5H   R   SEG=MAIN   678 686#
NOPART3. . . . . .  C ADDR   02C8H   R   SEG=MAIN   686 687#
NOPART4. . . . . .  C ADDR   02CFH   R   SEG=MAIN   687 690#
NOR11. . . . . . .  C ADDR   0820H   R   SEG=MAIN   1454 1483#
NOR13. . . . . . .  C ADDR   07ECH   R   SEG=MAIN   1448 1454#
NORDN. . . . . . .  C ADDR   00F4H   A      3387# 3420
NORDN1 . . . . . .  C ADDR   0105H   A      3389 3403#
NORM1. . . . . . .  C ADDR   00EEH   A      3382# 3579 3756 3858 4075
NORR11 . . . . . .  C ADDR   095CH   R   SEG=MAIN   1638 1643#
NORR12 . . . . . .  C ADDR   096CH   R   SEG=MAIN   1643 1650#
NORUP. . . . . . .  C ADDR   0117H   A      3386 3423#
NORUP1 . . . . . .  C ADDR   011CH   A      3428# 3446
NORUP2 . . . . . .  C ADDR   0130H   A      3430 3447#
NOSUB. . . . . . .  C ADDR   0F1CH   R   SEG=MAIN   2784 2788 2792 2797#
NOT1IN . . . . . .  C ADDR   05A3H   R   SEG=MAIN   1068 1104#
NOT1_7 . . . . . .  C ADDR   08A0H   R   SEG=MAIN   1547 1554#
NOT2IN . . . . . .  C ADDR   05AAH   R   SEG=MAIN   1104 1108#
NOT2_7 . . . . . .  C ADDR   08ABH   R   SEG=MAIN   1554 1559#
NOT3IN . . . . . .  C ADDR   05B1H   R   SEG=MAIN   1108 1111#
NOTT1. . . . . . .  C ADDR   0589H   R   SEG=MAIN   1080 1084#
NOTT5. . . . . . .  C ADDR   058EH   R   SEG=MAIN   1084 1088#
NOT_1. . . . . . .  C ADDR   07A6H   R   SEG=MAIN   1410 1411 1416 1419#
NOVIR. . . . . . .  C ADDR   082CH   R   SEG=MAIN   1439 1492#
NOZZMI . . . . . .  C ADDR   0555H   R   SEG=MAIN   1050 1052#
NULAVT . . . . . .  C ADDR   0604H   R   SEG=MAIN   1177#
NUMSIZE. . . . . .  N NUMB   0004H   A      2365# 2387 2425 2432 2507 2527
OBOARD . . . . . .  C ADDR   0E52H   R   SEG=MAIN   2608 2622#
OBOARD1. . . . . .  C ADDR   0E9AH   R   SEG=MAIN   2681 2694#
OK1. . . . . . . .  C ADDR   0184H   A      3513 3528#
OK2. . . . . . . .  C ADDR   019EH   A      3530 3545#
OK3. . . . . . . .  C ADDR   01C2H   A      3562 3578#
ONBOAR1. . . . . .  C ADDR   0E78H   R   SEG=MAIN   2643 2660#
ONBOARD. . . . . .  C ADDR   0E2CH   R   SEG=MAIN   2572 2586#
ONMEM11. . . . . .  C ADDR   09ADH   R   SEG=MAIN   1569 1573 1575 1697#
ONVICH . . . . . .  C ADDR   073AH   R   SEG=MAIN   1341 1352#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 437
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 430 434
OUT6 . . . . . . .  C ADDR   082CH   R   SEG=MAIN   1279 1372 1377 1382 1397 1499#
OUT7 . . . . . . .  C ADDR   09B6H   R   SEG=MAIN   1513 1514 1551 1558 1562 1611 1672 1684 1685 1687 1701 1704#
OUTF . . . . . . .  C ADDR   07C9H   R   SEG=MAIN   1426 1437# 1447 1452 1471 1475 1480 1625 1641
OUTMA. . . . . . .  C ADDR   0816H   R   SEG=MAIN   1474 1475#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 2564
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 1975 1979
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 408
P1 . . . . . . . .  D ADDR   0090H   A      32# 551 552 1814 1821 1986 1988 1991 1994 1998 2000 2001 2299 2302 2304
                                           2307 2313 2315 2317
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 409
P2 . . . . . . . .  D ADDR   00A0H   A      47# 2019 2023 2032
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 410
P3 . . . . . . . .  D ADDR   00B0H   A      62# 879 882 917 920 923 1296 1297 1298 1300 1301 1302 1303 1304 1305 1306
                                           1307 1308 1309 1310 1311 1425 1426 1446 1447 1466 1467 1477 1478 1529 1530
                                           1531 1533 1534 1535 1536 1537 1538 1539 1540 1541 1542 1543 1544 1602 1604
                                           1619 1620 1636 1637 1671 1672 2018 2020 2022 2028 2029 2030 2033 2034
P3IF . . . . . . .  D ADDR   00ADH   A      59#
P3MDOUT. . . . . .  D ADDR   00A7H   A      53#
P4 . . . . . . . .  D ADDR   0084H   A      20# 1724 1727
P5 . . . . . . . .  D ADDR   0085H   A      21# 1120 1122 1126 1128 1148 1150 1154 1156 1180 1183 1218 1220 1256 1258
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    72

                                           1262 1264 1732 1735
P6 . . . . . . . .  D ADDR   0086H   A      22#
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 413
PACK1. . . . . . .  C ADDR   00DCH   A      3365# 3580 3757 3859 4076
PARN . . . . . . .  D ADDR   00AFH   A      364# 476 1060 1401
PART . . . . . . .  D ADDR   009AH   A      354# 472 653 798 829 1066 1078 1089 1366 1402 1427 1545 1603 1679 1752
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 406
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 407
PCON . . . . . . .  D ADDR   0087H   A      23#
PROD . . . . . . .  N NUMB   000CH   A      3302# 3646 3647 3648 3649 3669 3670 3671 3673 3674 3676 3677 3679 3701
                                           3703 3704 3706 3707 3709 3710 3712 3731 3732 3733 3735 3736 3738 3739 3741
                                           3752 3753 3754 3755 3776 3777 3778 3779 3795 3797 3798 3800 3801 3803 3804
                                           3806 3836 3853 3854 3855 3856
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 1852 1854 1868 1870 1918 1919 1921 1923
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 1285 1507 1518 1712 2208 2210 3037
                                           3045
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   06FFH   R   SEG=MAIN   1309 1314#
R10. . . . . . . .  N NUMB   000AH   A      393# 575 807 815 820 1895 2134
R11. . . . . . . .  N NUMB   000BH   A      394# 576 808 816 821 1899 2137
R8 . . . . . . . .  N NUMB   0008H   A      391# 1887 2128 2333
R9 . . . . . . . .  N NUMB   0009H   A      392# 1891 2131 2334
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RE1. . . . . . . .  C ADDR   0D16H   R   SEG=MAIN   2313# 2319
RE4BYTE. . . . . .  C ADDR   0B13H   R   SEG=MAIN   1883#
REACP. . . . . . .  D ADDR   0077H   A      300# 557 559 561 563 599 615 623 631 640 647 657 1135 1137 1139 1141 1192
                                           1194 1196 1198 1230 1232 1234 1236
READ . . . . . . .  C ADDR   0D14H   R   SEG=MAIN   556 558 560 2312#
READ_X2. . . . . .  C ADDR   0BC2H   R   SEG=MAIN   2027# 2038
REBYTE . . . . . .  C ADDR   01FAH   R   SEG=MAIN   551# 586 590 672 926 1160 1168 1185 1223 1267 1275 1277
REF0CN . . . . . .  D ADDR   00D1H   A      92# 414
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RESAR2 . . . . . .  C ADDR   0CEDH   R   SEG=MAIN   658 701 735 836 860 906 911 946 987 1026 1589 2277#
RESAR8 . . . . . .  C ADDR   0CABH   R   SEG=MAIN   839 845 863 872 890 948 951 1205 1243 2216#
REZAM. . . . . . .  D ADDR   008CH   A      350# 1240
REZAP. . . . . . .  D ADDR   0088H   A      349# 1202
REZ_A. . . . . . .  D ADDR   0062H   A      339# 659 667 700 734
REZ_A0 . . . . . .  D ADDR   006AH   A      341# 844 910 924 1590 1597
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    73

REZ_A1 . . . . . .  D ADDR   0066H   A      340# 792 842 859 894 905 947
REZ_A2 . . . . . .  D ADDR   007BH   A      342# 907 953
REZ_A3 . . . . . .  D ADDR   009CH   A      356# 847 912 986 1025 1588
REZ_AME. . . . . .  D ADDR   005EH   A      338# 803 835 875
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RIGHT2 . . . . . .  C ADDR   0711H   R   SEG=MAIN   1321 1325#
RIGHT3 . . . . . .  C ADDR   0715H   R   SEG=MAIN   1323 1328#
RKNMEM . . . . . .  C ADDR   0841H   R   SEG=MAIN   1512# 1542
RKNRAZR. . . . . .  C ADDR   06B6H   R   SEG=MAIN   1281# 1303
RLABELF. . . . . .  C ADDR   06B3H   R   SEG=MAIN   1280# 1299
RLABELH. . . . . .  C ADDR   084AH   R   SEG=MAIN   1515# 1532
RLABELK. . . . . .  C ADDR   0916H   R   SEG=MAIN   1614# 1616
RMO220 . . . . . .  C ADDR   04A0H   R   SEG=MAIN   888 927#
ROUT6. . . . . . .  C ADDR   06B0H   R   SEG=MAIN   1279# 1296 1298
ROUT7. . . . . . .  C ADDR   0847H   R   SEG=MAIN   1514# 1529 1531
ROUTF. . . . . . .  C ADDR   0959H   R   SEG=MAIN   1637 1641# 1648 1652
RR0. . . . . . . .  N NUMB   0000H   A      384# 1286 1506 1519 1711
RR1. . . . . . . .  N NUMB   0001H   A      385# 1287 1505 1520 1710
RR2. . . . . . . .  N NUMB   0002H   A      387# 1288 1504 1521 1709 1958
RR3. . . . . . . .  N NUMB   0003H   A      388# 1289 1503 1522 1708 1959
RR4. . . . . . . .  N NUMB   0004H   A      1290 1502 1523 1707 2366# 2423 2444 2460 2504 2526
RR5. . . . . . . .  N NUMB   0005H   A      1291 1501 1524 1706 2367# 2424 2431 2438 2505 2514
RR6. . . . . . . .  N NUMB   0006H   A      386# 1292 1500 1525 1705
RR7. . . . . . . .  N NUMB   0007H   A      389# 1293 1499 1526 1704
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 444
RTIZMRI. . . . . .  C ADDR   07AAH   R   SEG=MAIN   1422#
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SAVEIR2. . . . . .  C ADDR   0C1FH   R   SEG=MAIN   703 738 2100#
SAVER2 . . . . . .  C ADDR   0C2BH   R   SEG=MAIN   482 484 668 793 804 843 848 876 895 908 913 925 954 1030 1146
                                           1203 1215 1241 1253 1591 1598 2114#
SAVER8 . . . . . .  C ADDR   0C37H   R   SEG=MAIN   2128#
SBUF0. . . . . . .  D ADDR   0099H   A      40#
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   0B84H   R   SEG=MAIN   1986# 1993
SDV1 . . . . . . .  C ADDR   0B98H   R   SEG=MAIN   1998# 2004
SDVIG0 . . . . . .  C ADDR   026DH   R   SEG=MAIN   627# 629
SDVIG1 . . . . . .  C ADDR   0262H   R   SEG=MAIN   619# 621
SDVIG2 . . . . . .  C ADDR   0257H   R   SEG=MAIN   611# 613
SDVIG3 . . . . . .  C ADDR   024BH   R   SEG=MAIN   602# 604
SDVIG4 . . . . . .  C ADDR   027CH   R   SEG=MAIN   637# 639
SDVIG6 . . . . . .  C ADDR   0287H   R   SEG=MAIN   644# 646
SDVM . . . . . . .  C ADDR   0285H   R   SEG=MAIN   634 643#
SEEIND . . . . . .  C ADDR   0567H   R   SEG=MAIN   1005 1012 1064#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      3297# 3318 3319 3344 3345 3369 3512 3529 3750 3790
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SP . . . . . . . .  D ADDR   0081H   A      17# 405
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    74

SPI0CKR. . . . . .  D ADDR   009DH   A      44# 450
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 449
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 1977
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABUS. . . . . . .  C ADDR   09E8H   R   SEG=MAIN   1721 1739#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 441 442
TEAEQU0. . . . . .  C ADDR   0A67H   R   SEG=MAIN   1645 1790#
TEBEQU0. . . . . .  C ADDR   0A71H   R   SEG=MAIN   1791#
TEIZMK . . . . . .  C ADDR   0A96H   R   SEG=MAIN   1456 1632 1797#
TEKALIB. . . . . .  C ADDR   0A8DH   R   SEG=MAIN   1796#
TEMENU . . . . . .  C ADDR   0A7BH   R   SEG=MAIN   1792#
TENO . . . . . . .  C ADDR   0A31H   R   SEG=MAIN   1664 1783#
TEOUT. . . . . . .  C ADDR   0A9FH   R   SEG=MAIN   1485 1623 1798#
TETEST . . . . . .  C ADDR   0A84H   R   SEG=MAIN   1566 1794#
TEVICH . . . . . .  C ADDR   0A5EH   R   SEG=MAIN   1347 1443 1450 1628 1789#
TEXTT. . . . . . .  C ADDR   0A1FH   R   SEG=MAIN   1759 1781#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 424
TH1. . . . . . . .  D ADDR   008DH   A      29#
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   0BA8H   R   SEG=MAIN   2007#
TIM1 . . . . . . .  C ADDR   0BAAH   R   SEG=MAIN   2008# 2008
TIM2 . . . . . . .  C ADDR   0BADH   R   SEG=MAIN   1989 1992 1999 2003 2011# 2303 2305 2314 2318
TIM3 . . . . . . .  C ADDR   0BAFH   R   SEG=MAIN   2012# 2012
TIZMRI . . . . . .  C ADDR   070AH   R   SEG=MAIN   1320# 1422
TL0. . . . . . . .  D ADDR   008AH   A      26# 425
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TMOD . . . . . . .  D ADDR   0089H   A      25# 422
TMR2RLH. . . . . .  D ADDR   00CBH   A      287# 439
TMR2RLL. . . . . .  D ADDR   00CAH   A      286# 438
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 1978
UNPACK1. . . . . .  C ADDR   009CH   A      3315# 3509 3643 3773 3887
UNPACK2. . . . . .  C ADDR   00B8H   A      3340# 3510 3644 3774
UP1. . . . . . . .  C ADDR   0136H   A      3460# 3477
UP2. . . . . . . .  C ADDR   0149H   A      3480# 3498
UP2A . . . . . . .  C ADDR   015FH   A      3459 3496#
VI1113 . . . . . .  C ADDR   07E7H   R   SEG=MAIN   1451# 1458 1486
VICHR. . . . . . .  D ADDR   00B1H   A      366# 1344 1353 1440 1617
VIOUT. . . . . . .  C ADDR   0779H   R   SEG=MAIN   1350 1393#
VVCHIF . . . . . .  C ADDR   0AEBH   R   SEG=MAIN   1831#
VVRR6. . . . . . .  C ADDR   07D9H   R   SEG=MAIN   1446# 1461 1463
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 420 421
WR1. . . . . . . .  C ADDR   0D01H   R   SEG=MAIN   2299# 2306
WR4BAIT. . . . . .  C ADDR   0B06H   R   SEG=MAIN   1866#
A51 MACRO ASSEMBLER  LOADKD_1                                                             01/24/2008 17:13:59 PAGE    75

WRITE. . . . . . .  C ADDR   0CFEH   R   SEG=MAIN   554 1803 1805 1807 1809 1811 1813 1816 1818 1820 1823 1825 1827
                                           2297#
WRITED_X1. . . . .  C ADDR   0BB3H   R   SEG=MAIN   2017#
WRITE_X1 . . . . .  C ADDR   0BB2H   R   SEG=MAIN   2016#
WRPAGE . . . . . .  C ADDR   0B2BH   R   SEG=MAIN   524 1913#
WW5. . . . . . . .  C ADDR   0B2BH   R   SEG=MAIN   1914# 1926
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 416 448
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 417
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 418 447
XCIKLWR. . . . . .  C ADDR   0C0BH   R   SEG=MAIN   698 709 711 713 716 719 722 725 728 731 2083#
XTEMP. . . . . . .  N NUMB   000CH   A      2363# 2727 2728 2729 2730 2816 2818 2819 2821 2822 2824 2825 2827 2849
                                           2850 2851 2852 2870 2871 2875 2876 2879 2883 2884 2887 2891 2892 2896 2897
                                           2899 2900 2901 2903 2907 2908 2910 2911 2915 2916 2921 2922 2924 2925 2929
                                           2930 2935 2937 2938 2939
YBNUL. . . . . . .  C ADDR   08EFH   R   SEG=MAIN   1586 1594#
YES. . . . . . . .  C ADDR   0EFFH   R   SEG=MAIN   2749 2753 2757 2761 2779# 2842
YESAVP . . . . . .  C ADDR   04A2H   R   SEG=MAIN   902 931#
YESBUF . . . . . .  C ADDR   0580H   R   SEG=MAIN   1072 1077#
YESPRD . . . . . .  C ADDR   057EH   R   SEG=MAIN   1071 1075#
YESTT5 . . . . . .  C ADDR   059EH   R   SEG=MAIN   1092 1098#
YESVICH. . . . . .  C ADDR   04BAH   R   SEG=MAIN   903 944#
YESVIR . . . . . .  C ADDR   0827H   R   SEG=MAIN   1490#
Z100 . . . . . . .  C ADDR   0BDCH   R   SEG=MAIN   2046# 2048
Z15. . . . . . . .  C ADDR   0BEAH   R   SEG=MAIN   2058# 2060
Z1S. . . . . . . .  C ADDR   0BF5H   R   SEG=MAIN   2067# 2069
ZAPADC . . . . . .  C ADDR   0B82H   R   SEG=MAIN   1985#
ZCMP . . . . . . .  C ADDR   0C9DH   R   SEG=MAIN   2206#
ZDIV . . . . . . .  C ADDR   0C6AH   R   SEG=MAIN   785 990 2169#
ZER1 . . . . . . .  C ADDR   00B1H   A      3325 3329# 3384 3427
ZER2 . . . . . . .  C ADDR   00D2H   A      3351 3355#
ZMUL . . . . . . .  C ADDR   0C60H   R   SEG=MAIN   2164#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      309# 1050 2177 2180 2183
ZNPLUS . . . . . .  C ADDR   023EH   R   SEG=MAIN   565 591#
ZSS. . . . . . . .  C ADDR   0C02H   R   SEG=MAIN   2075# 2077
ZZ . . . . . . . .  C ADDR   0BECH   R   SEG=MAIN   2059# 2059
Z_100. . . . . . .  C ADDR   0BDAH   R   SEG=MAIN   2045#
Z_15 . . . . . . .  C ADDR   0BE8H   R   SEG=MAIN   2057#
Z_1S . . . . . . .  C ADDR   0BF1H   R   SEG=MAIN   544 548 2065#
Z_5. . . . . . . .  C ADDR   0BE3H   R   SEG=MAIN   2021 2031 2052#
Z_9. . . . . . . .  C ADDR   0CF9H   R   SEG=MAIN   1980 2291#
Z_SS . . . . . . .  C ADDR   0BFEH   R   SEG=MAIN   546 2073#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
