A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp20.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp20.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236             
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                     jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
                     310                     
                     311     
                     312     ;;;;;
  0020               313      cellbit                DATA    20h
  0000               314     bitznak         BIT     cellbit.0       ;20.0           
  0001               315     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               316     znmat           BIT             cellbit.2       ;20.2
  0003               317     bitrs           BIT             cellbit.3       ;20.3
  0004               318     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               319     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               320     bitvi11         BIT             cellbit.6       ;20.6   бит режима выч R
  0007               321     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     6

                     322     
  0021               323     cellbit1                DATA    21h
  0008               324     bitbuf          BIT     cellbit1.0      ;21.0           
  0009               325     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               326     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               327     bitmem          BIT             cellbit1.3      ;21.3
  000C               328     bmem11          BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               329     bmem12          BIT             cellbit1.5      ;21.5    бит ПАМ12
  000E               330     bmem13          BIT             cellbit1.6      ;21.6   бит ПАМ13        
  000F               331     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     332     
  0022               333     cellbit2                DATA    22h
  0010               334     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               335     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               336     bitvi12         BIT             cellbit2.2      ;22.2  
  0013               337     bitvi13         BIT             cellbit2.3      ;22.3
  0014               338     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               339     bitvi21         BIT             cellbit2.5      ;22.5    
  0016               340     bitvi31         BIT             cellbit2.6      ;22.6   бит ПАМ13        
  0017               341     bitoll          BIT             cellbit2.7      ;22.7
                     342     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     343     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     344     ;и выдает т.н. буфер индикации  
  0023               345     cellbit3                DATA    23h
  0018               346     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               347     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               348     bitakt          BIT             cellbit3.2      ;22.2  бит такта
                     349     ;bit            BIT             cellbit3.3      ;22.3
                     350     ;bit            BIT             cellbit3.4      ;22.4    
                     351     ;bit            BIT             cellbit3.5      ;22.5    
                     352     ;bit            BIT             cellbit3.6      ;22.6            
                     353     ;bit            BIT             cellbit3.7      ;22.7
                     354             
  005E               355     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     356     ;hex
  0062               357     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               358     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               359     rez_A0  data 6ah;
  007B               360     rez_A2   data 7bh; A2
                     361     
  0098               362     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               363     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               364     chdel    data  83h              ; счетчик задержки
                     365     ;float
  0084               366     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               367     rezAp    data  88h              ;4byte  A+
  008C               368     rezAm    data  8ch              ;4byte  A-
  0090               369     koefKp   data  90h              ;4byte  K+
  0094               370     koefKm   data  94h              ;4byte  K-
                     371     ;hex 
  009A               372     parT     data  9ah              ;параметр времени измерения
  009B               373     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               374     rez_A3   data  9ch              ;A3
                     375     ;FLOAT
  00A0               376     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               377     constE  data  0a4h         ;констант E
  00A8               378     constF  data  0a8h         ;констант F
  00AC               379     chind   data  0ach         ;счетчик индикации
  00AD               380     chbuf   data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               381     diap    data  0aeh         ;номер диапазона
  00AF               382     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               383     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               384     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               385     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               386     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               387     load    data  0b7h         ;яч для загрузки текстов на индикатор
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     7

  00B8               388     work    data  0b8h        ;рабочая ячейка
  00BC               389     konstA  data  0bch        ;     введенная с крана константа A
  00C0               390     konstB  data  0c0h         ;    введенная с крана константа B
  00C4               391     nblok   data  0c4h         ;номер блока
                     392     ;data  0c5h
                     393     
                     394     ;внешнее ОЗУ 64K 
                     395     ;               XSEG AT 100h
                     396             PUBLIC    MASS0
  0080               397     MASS0  xdata 0080h;     массив измерения
  0084               398     MASS1  xdata 0084h;
  0088               399     MASS2  xdata 0088h;
  008C               400     MASS3  xdata 008ch;
  0090               401     MASS4  xdata 0090h;
  0094               402     MASS5  xdata 0094h;
  0098               403     MASS6  xdata 0098h;
  009C               404     MASS7  xdata 009ch;
  00A0               405     MASS8  xdata 00a0h;
  00A4               406     MASS9  xdata 00a4h;
                     407     ;xdata 0038h;
                     408     
  0000               409                             rr0             EQU 00
  0001               410                     rr1       equ   01
  0006               411                     rr6   equ 06
  0002               412                     rr2       equ   02
  0003               413                     rr3       equ   03
  0007               414                     rr7   equ 07
                     415     
  0008               416                     r8   equ 08
  0009               417                     r9        equ   09
  000A               418                     r10       equ   10
  000B               419                     r11   equ 11
                     420     
                     421                     
                     422        
----                 423                  rseg     Main          ; Switch to this code segment.
                     424     
                     425                  using    0              ; Specify register bank for the following
                     426     
0100                 427     org 100h
                     428     ;$EJECT
                     429     
0100 7581E0          430     begin:     mov  sp, #0e0h
0103 75E900          431                                             mov             PCA0L,#00;=0x00;
0106 75D900          432                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          433                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          434                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          435                                             mov     P2MDOUT,#00;=0x00;
                     436             
0112 75A73F          437             mov     P3MDOUT,#3fh;
0115 75B5FF          438             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          439             mov     REF0CN,#03h;=0x03;
                     440             
011B 75E114          441             mov     XBR0,#14h;= 0x14;
011E 75E200          442             mov     XBR1,#00; =0x00;
0121 75E300          443             mov XBR2,#00;=0x00;
0124 75B0C0          444             mov     P3,#0c0h
0127 75FFDE          445             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          446             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          447             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          448             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          449             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          450             mov     TL0,#0f9h;=0xf9; 
0139 75E680          451             mov     EIE1,#80h;=0x80;
                     452     
013C 75D480          453             mov     DAC0CN,#80h;=0x80;
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     8

013F 75D780          454             mov     DAC1CN,#80h;=0x80;
0142 75B167          455             mov     OSCXCN,#67h;=0x67;
                     456     
                     457      
                     458     
0145 E5B1            459     gener:     mov a, oscxcn
0147 B4E7FB          460                cjne a,#11100111b,gener
                     461                            
014A 75B288          462             mov     OSCICN,#88h;=0x84;
014D 75CA00          463         mov TMR2RLL,#0;=0;
0150 75CBD1          464         mov TMR2RLH,#0d1h;=0xd1;
                     465       
0153 D28E            466                     setb  TCON.6                    ;регистр управления
0155 D28C            467                      setb tcon.4
                     468     
0157 75EF00          469             mov     RSTSRC,#0;=00   ;//источники сброса 
                     470     
                     471             
015A 75E340          472          mov        XBR2,#40h
015D 75E106          473              mov    XBR0,#06h;16h
0160 75F803          474             mov             SPI0CN,#03
0163 759D31          475             mov             spi0ckr,#31H;;;;;;;;#04
                     476     ;       mov             EIE2,#20H
0166 75E730          477             mov             EIE2,#30H;00110000
0169 75A880          478             mov     IE,#80h;//10000000      ;//Снятие блокировки всех прерываний
                     479     ;ozu
016C E4              480                             clr     a
016D 7800            481                             mov     r0,#00h 
016F F6              482     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
0170 08              483                             inc     r0
0171 B87FFB          484                             cjne    r0,#7fh,mecle
0174 7880            485                             mov     r0,#80h
0176 F6              486     meff:           mov     @r0,a 
0177 F2              487                             movx @r0,a
0178 08              488                             inc     r0
0179 B8DFFA          489                             cjne    r0,#0dfh,meff
017C 120000   F      490                             call    clmassix
017F 7898            491                             mov             r0,#chinkor
0181 7600            492                             mov             @r0,#0;1;
0183 08              493                             inc             r0
0184 76C8            494                             mov             @r0,#0c8h;90h;
                     495                             ;;;;
0186 7881            496                             mov             r0,#chavt
0188 7603            497                             mov             @r0,#3;1
018A 08              498                             inc             r0
018B 7620            499                             mov             @r0,#20h;90h
                     500     
018D 78B2            501                                     mov             r0,#marker
018F 76FF            502                                     mov             @r0,#0ffh
                     503                             ;mov            r0,#chind
                     504                             ;mov            @r0,#1
                     505                     
0191 74FF            506                             mov             a,#0ffh
0193 F585            507                        mov          p5,a
0195 799A            508                             mov             r1,#parT
0197 7702            509                             mov             @r1,#2                  ;Tizm=1s
0199 79AE            510                             mov             r1,#diap
019B 7705            511                             mov             @r1,#5                  ;10-7a
019D 79AF            512                             mov             r1,#parN
019F 7702            513                             mov             @r1,#2
01A1 7400            514                             mov             a,#00h
01A3 F585            515                             mov             p5,a
01A5 D204            516                             setb    bitizm
                     517     
01A7 799B            518                             mov             r1,#chbefore
01A9 7700            519                             mov             @r1,#0
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE     9

                     520                             ;;;;;;
01AB 900000   F      521                             mov             dptr,#ch_1              ;1->r2..r5 float
01AE 120000   F      522                             call    ldc_long
01B1 7890            523                             mov             r0,#koefKp         ;1(float)->koefKp
01B3 120000   F      524                             call    saver2
01B6 7894            525                             mov             r0,#koefKm              ;1(float)->koefKm
01B8 120000   F      526                             call    saver2
01BB 78A0            527                             mov             r0,#koefKD
01BD 120000   F      528                             call    saver2  
                     529     ;START
                     530     ;                                       rez_A0=0;
                     531     ;        SUMM=0; //обнуление скользящего массива
                     532     ;        over_mas=0;
                     533     ;        count_mas=0;
                     534     
01C0 7840            535                             mov             r0,#bufind
01C2                 536     age2:
01C2 76FD            537                             mov             @r0,#0fdh         ;погасить индикатор
01C4 08              538                             inc             r0
01C5 B84CFA          539                             cjne    r0,#bufind+12,age2              
01C8 120000   F      540                             call    ind
01CB 120000   F      541                             call    z_1s
                     542     
                     543                                     ;зажечь все лементы индикации
01CE 7840            544                             mov             r0,#bufind
01D0 76FE            545     ageon:          mov             @r0,#0feh;?
01D2 08              546                             inc             r0
01D3 B84CFA          547                             cjne    r0,#bufind+12,ageon             
01D6 120000   F      548                             call    ind
01D9 120000   F      549                             call    z_1s            ;1sec
                     550     ;;;;;;;;;;;;;;;;
01DC 7840            551                             mov             r0,#bufind
01DE 7630            552                             mov             @r0,#30H;"A"
01E0 08              553                             inc             r0
01E1 7630            554                             mov             @r0,#30H;"В"
01E3 08              555                             inc             r0
01E4 7630            556                             mov             @r0,#30H;"Т"
01E6 08              557                             inc             r0
01E7 7634            558                             mov             @r0,#34H;2dh
01E9 08              559                             inc             r0
01EA 7635            560                             mov             @r0,#35H;"H"
01EC 08              561                             inc             r0
01ED 7636            562                             mov             @r0,#36h
01EF 08              563                             inc             r0
01F0 7637            564                             mov             @r0,#37h
01F2 08              565                             inc             r0
01F3 762D            566                             mov             @r0,#2dh
01F5 08              567                             inc             r0
01F6 7637            568                             mov             @r0,#37h
01F8 08              569                             inc             r0
01F9 7641            570                             mov             @r0,#"A";31h
01FB 08              571                             inc             r0
                     572                     
01FC 120000   F      573     dd:                     call    ind
01FF 120000   F      574                             call    z_15;z_1ms
                     575             ;       jmp             dd
                     576     ;;;;;;;;;;;;;;;;;;;
0202 7C40            577                             mov             r4,#40h
0204 7D04            578                             mov             r5,#04         
0206 120000   F      579                             call    iniacp;инициализация acp
0209 120000   F      580                             call    loadUS          ;us 10-7 A
                     581                             
020C C217            582     rebyte:         clr             bitoll
020E 3095FD          583                             jnb             p1.5,$
0211 2095FD          584                             jb              p1.5,$
0214 E586            585                             mov             a,P6            ;p6.4=0
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    10

0216 54EF            586                             anl             a,#0efh
0218 F586            587                             mov             P6,a
021A 00              588                             nop
021B 00              589                             nop
                     590                                     
021C E586            591                             mov             a,P6                    ;p6.4=1 
021E 4410            592                             orl             a,#10h
0220 F586            593                             mov             P6,a                        
0222 7411            594                             mov             a,#11h
0224 120000   F      595                             call    write
                     596                             ;чтение acp
0227 120000   F      597                             call    read    
022A F578            598                             mov     reacp+1,A       ;старший байт 
022C 120000   F      599                             call    read    
022F F579            600                             mov     reacp+2,A       ;средний байт 
0231 120000   F      601                             call    read
0234 F57A            602                             mov     reacp+3,A               ;мл байт
                     603                        ;;;;;;;;;;;
0236 7878            604                        mov          r0,#reacp+1
0238 E6              605                        mov          a,@r0
0239 20E72D          606                             jb              acc.7,znplus;
023C D200            607                             setb    bitznak
023E 4480            608                             orl             a,#80h  ;ост содерж яч 
0240 F6              609                             mov             @r0,a
                     610                                     
0241 18              611     mmm:            dec             r0;,#reacp
0242 76FF            612                             mov             @r0,#0ffh
0244 802B            613                             jmp             goznak
                     614     
                     615     
0246 750A00          616     labelA:         mov             r10,#0          
0249 750B00          617                             mov             r11,#0
024C 783D            618                             mov             r0,#chkl
024E 120000   F      619                             call    chcmp
0251 7000            620                             jnz             no0key
                     621                             ;разрешить ie6,ie7       
                     622                     ;       mov             EIE2,#30h ;EIE2.5,EIE2.4
                     623                     ;       mov             EIP2,#30h
                     624                        
0253 793D            625     no0key:         mov             r1,#chkl 
0255 120000   F      626                             call    chdec
0258 2004B1          627                             jb              bitizm,rebyte
                     628                              ;буфер 2 выдать на индикацию
                     629     ;3.11.06        
025B 120000   F      630                             call    ind
025E 120000   F      631                             call    z_01s
0261 120000   F      632                             call    z_01s
0264 120000   F      633                             call    z_01s
0267 80DD            634                             jmp             labelA
                     635     
0269 C200            636     znplus:         clr     bitznak
026B 547F            637                             anl             a,#7fh;fdh                      ;+
026D F6              638                             mov             @r0,a
026E 18              639                             dec             r0;,#reacp
026F 7600            640                             mov             @r0,#00h
                     641                             
0271                 642     goznak: 
                     643     ;;;;;;;;;;;;;
0271 787A            644                             mov     r0,#reacp+3
0273 E6              645                             mov             a,@r0
0274 7F05            646                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
0276 C3              647     sdvig3:         clr             c
0277 13              648                             rrc             a
0278 DFFC            649                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
027A FA              650                             mov             r2,a    ;сохр байт
027B 18              651                             dec             r0              ;       reacp+2
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    11

027C E6              652                             mov             a,@r0
027D C0E0            653                             push    acc
027F C3              654                             clr             c
0280 7F03            655                             mov             r7,#3;2
0282 C3              656     sdvig2:         clr             c
0283 33              657                             rlc             a
0284 DFFC            658                             djnz    r7,sdvig2 ;d12..d11      средний байт
0286 4A              659                             orl             a,r2
0287 F57A            660                             mov             reacp+3,a;сформ мл байт
0289 D0E0            661                             pop             acc
                     662                             
028B 7F05            663                             mov             r7,#5;6
028D C3              664     sdvig1:         clr             c
028E 13              665                             rrc             a
028F DFFC            666                             djnz    r7,sdvig1 ;d15,d14        ср байт
0291 FA              667                             mov             r2,a   ;сохр
0292 E578            668                             mov             a,reacp+1
0294 C0E0            669                             push    acc
                     670                     ;;      push    acc
0296 7F03            671                             mov             r7,#3;2
0298 C3              672     sdvig0:         clr             c
0299 33              673                             rlc             a
029A DFFC            674                             djnz    r7,sdvig0 ;       d21..d16
029C 4A              675                             orl             a,r2
029D F579            676                             mov             reacp+2,a       ; сформ средний  байт
029F D0E0            677                             pop             acc       ;reacp+1
                     678                             ;;;;;;;;;;;;;;
02A1 20E70B          679                             jb              acc.7,sdvm
02A4 C3              680                             clr             c
02A5 7F05            681                             mov             r7,#5;6
02A7 C3              682     sdvig4:         clr             c
02A8 13              683                             rrc             a
02A9 DFFC            684                             djnz    r7,sdvig4 ;       d23,d22
02AB F578            685                             mov             reacp+1,a
02AD 8008            686                             jmp             readyacp;ankor;klmas
                     687     ;;;;;;;;;;;;                                    
02AF 7F05            688     sdvm:           mov             r7,#5;6
02B1 D3              689     sdvig6:         setb            c
02B2 13              690                             rrc             a
02B3 DFFC            691                             djnz    r7,sdvig6 ;       d23,d22
02B5 F578            692                             mov             reacp+1,a
                     693                                                             
                     694     ; reacp..reacp+3-результат чтения асп(hex) 
                     695     ;;;;;;;;;
02B7                 696     readyacp:
02B7 789A            697                             mov             r0,#parT        ;параметр времени
02B9 793F            698                             mov             r1,#chmasN
02BB B60135          699                             cjne    @r0,#1,noparT1
                     700                             ;РЕЗ+РЕЗ
02BE 7877            701                             mov             r0,#reacp
02C0 120000   F      702                             call    resar2          ;reacp->r2..r5
02C3 78B6            703                             mov             r0,#summa+3;rez_A+3
02C5 120000   F      704                             call    ladd
02C8 78B3            705                             mov             r0,#summa;rez_A
02CA 120000   F      706                             call    saver2
02CD 793F            707                              mov            r1,#chmasN
02CF 770A            708                             mov             @r1,#10
02D1 789B            709                             mov             r0,#chbefore
02D3 B63819          710                             cjne    @r0,#56,nobef99;,99,nobef99
                     711                             ;РЕЗ/100
02D6 900000   F      712                             MOV        DPTR,#ch57;ch100 
02D9 120000   F      713     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
02DC 120000   F      714                             call    zdiv;divide
02DF 7862            715                             mov             r0,#rez_A
02E1 120000   F      716                             call    saver2          ;сумма 100 отсчетов /100
                     717                        ;;;;;
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    12

02E4 78B3            718                        mov          r0,#summa
02E6 120000   F      719                        call         clear4
                     720     ;                       mov             a,chmas
                     721     ;                       mov             @r1,a   ;->chmasN
02E9 799B            722                             mov             r1,#chbefore
02EB 7700            723                             mov             @r1,#0
02ED 8048            724                             jmp             klmas           ;загр в массив скользящее ср
02EF 06              725     nobef99:        inc             @r0                     ;chbefore
02F0 020000   F      726                             jmp             rebyte;labelA;метка A
                     727     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     728     ;а потом уже располагаем  в скользящий массив  из n
                     729     
                     730     
                     731     
02F3 B6021D          732     noparT1:        cjne    @r0,#2,noparT2
                     733                             ;РЕЗ+РЕЗ
02F6 7877            734                              mov            r0,#reacp
02F8 120000   F      735                             call    resar2          ;reacp->r2..r5
02FB 78B6            736                             mov             r0,#summa+3;rez_A+3
02FD 120000   F      737                             call    ladd
0300 78B3            738                             mov             r0,#summa;rez_A
0302 120000   F      739                             call    saver2
0305 789B            740                             mov             r0,#chbefore
0307 793F            741                             mov             r1,#chmasN
0309 770A            742                             mov             @r1,#10
030B B613E1          743                             cjne    @r0,#19,nobef99;,9,nobef99
                     744                             ;РЕЗ/10
030E 900000   F      745                             MOV        DPTR,#ch20;ch10 
0311 80C6            746                             jmp             allsum
                     747                             ;;;;;;;
                     748                             
                     749     
0313 B60302          750     noparT2:        cjne    @r0,#3,noparT3
0316 8003            751                             jmp             aapar
                     752     
0318 B60410          753     noparT3:        cjne    @r0,#4,noparT4
031B 7877            754     aapar:          mov             r0,#reacp
031D 120000   F      755                             call    resar2          ;reacp->r2..r5
0320 7862            756                             mov             r0,#rez_A
0322 120000   F      757                             call    saver2
0325 793F            758                              mov            r1,#chmasN
0327 770A            759                             mov             @r1,#10
                     760                     ;       mov             @r1,#10         ;n=10
0329 800C            761                             jmp             klmas
032B 7702            762     noparT4:   mov          @r1,#2          ;chmasN n=2
032D 7877            763                             mov             r0,#reacp
032F 120000   F      764                             call    resar2          ;reacp->r2..r5
0332 7862            765                             mov             r0,#rez_A
0334 120000   F      766                             call    saver2
                     767     ;загрузить А в массив из 2/10 значений
                     768     ;;;;;;;;;;;;;;;
0337                 769     klmas:           
0337 793F            770                             mov             r1,#chmasN
0339 B70219          771                             cjne    @r1,#2,mas10
033C 900080          772                             MOV        dptr,#MASS0
033F 120000   F      773                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     774     
0342 7862            775                             mov             r0,#rez_A
0344 120000   F      776                             call    resar2          ;->r2..r5
0347 900080          777                             mov                     dptr,#MASS0
034A 120000   F      778                   call              saveIr2                 ; R2-R5 --> MAS0
                     779                     
034D 900087          780                   MOV          dptr,#MASS1+3
0350 120000   F      781                   CALL       addx
0353 8077            782                       jmp           endsum
0355 9000A0          783     mas10:          mov                     dptr,#MASS8
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    13

0358 120000   F      784                     CALL            xCIKLWR         ;MASS8->MASS9
035B 90009C          785                             mov                     dptr,#MASS7
035E 120000   F      786                     CALL            xCIKLWR         ;MASS7->MASS8
0361 900098          787                     MOV       dptr,#MASS6
0364 120000   F      788                     CALL       xCIKLWR         ; MASS6 --> MASS7
0367 900094          789                     MOV        dptr,#MASS5
                     790                    
036A 120000   F      791                    CALL        xCIKLWR        ; MASS5 --> MASS6
036D 900090          792                    MOV         dptr,#MASS4
                     793                    
0370 120000   F      794                    CALL        xCIKLWR        ; MASS4 --> MASS5
0373 90008C          795                             mov                     dptr,#MASS3
                     796     
0376 120000   F      797                    CALL             xCIKLWR         ;MASS3->MASS4
0379 900088          798                     MOV        dptr,#MASS2
                     799                    
037C 120000   F      800                    CALL        xCIKLWR         ; MASS2 --> MASS3
037F 900084          801                    MOV         dptr,#MASS1
                     802                     
0382 120000   F      803                   CALL         xCIKLWR        ; MASS1 --> MASS2
0385 900080          804                    MOV         dptr,#MASS0
                     805                   
0388 120000   F      806                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     807     
                     808                             
038B 7862            809                             mov             r0,#rez_A
038D 120000   F      810                             call    resar2          ;->r2..r5
                     811                                     ;call   aform
0390 900080          812                                     mov                     dptr,#MASS0
0393 120000   F      813                   call              saveIr2                 ; R2-R5 --> MAS0
                     814              
0396 900087          815                   MOV          dptr,#MASS1+3
0399 120000   F      816                   CALL       addx
039C 90008B          817                   MOV          dptr,#MASS2+3
039F 120000   F      818                   CALL       addx
03A2 90008F          819                   MOV          dptr,#MASS3+3
03A5 120000   F      820                  CALL        addx
03A8 900093          821                   MOV       dptr,#MASS4+3
03AB 120000   F      822                   call       addx
03AE 900097          823                     MOV        dptr,#MASS5+3
03B1 120000   F      824                  CALL        addx
03B4 90009B          825                   MOV          dptr,#MASS6+3
03B7 120000   F      826                   CALL       addx
03BA 90009F          827                   MOV          dptr,#MASS7+3
03BD 120000   F      828                  CALL        addx
03C0 9000A3          829                  MOV        dptr,#MASS8+3
03C3 120000   F      830                   call       addx
03C6 9000A7          831                     MOV                     dptr,#MASS9+3
03C9 120000   F      832                  call        addx
                     833             ;23.03          
03CC                 834     endsum:
03CC 786E            835                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
03CE 06              836                                     inc             @r0
03CF E6              837                                     mov             a,@r0   
03D0 200105          838                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                     839                                     
03D3 B53F1B          840                                     cjne    a,chmasN,masx5
03D6 D201            841                                     setb    bitmas                  ;массив заполнен
03D8 853F6E          842     masfull:                mov             chmas,chmasN
03DB 783F            843                                     mov             r0,#chmasN
03DD E6              844                                     mov             a,@r0
                     845     ;masfull:
03DE B40208          846                                     cjne    a,#2,nochn2
03E1 900000   F      847                                     MOV        DPTR,#ch2;10 
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    14

03E4 120000   F      848                                     CALL   ldc_ltemp                 ; ltemp <-- 2
03E7 8012            849                                     jmp             mas5div
                     850     
03E9 900000   F      851     nochn2:                 MOV        DPTR,#ch10 
03EC 120000   F      852                                     CALL   ldc_ltemp                 ; ltemp <-- 10
03EF 800A            853                                     jmp             mas5div
                     854     
03F1 856E0B          855     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
03F4 E4              856                                     clr     a
03F5 F50A            857                                     mov     ltemp+2,a
03F7 F509            858                                     mov     ltemp+1,a
03F9 F508            859                                     mov     ltemp,a
                     860     
03FB                 861     mas5div:
03FB 120000   F      862                                     CALL       zdiv;divide                           ; R2-R5 =
                     863                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                     864     
                     865                             
                     866      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     867     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     868     ;получен результат 3 байта и знак
03FE 7866            869                             mov             r0,#rez_A1
0400 120000   F      870                             call    saver2           ;сохр среднее по массиву
                     871     ;;8.11.06                       mov             chmasN,#0
                     872      ;;;;;;;;;;;;
                     873      ;;;;;;;;;;;;
0403 C3              874                             clr             c
0404 799A            875                             mov             r1,#parT
0406 7402            876                             mov             a,#2
0408 97              877                             subb    a,@r1
0409 500A            878                             jnc             ankor           ;T<3
                     879                             ;A-=РЕЗ1                                ;T>3
040B 120402          880                             call    altof                   ;r2..r5->float
040E 785E            881                             mov             r0,#rez_Ame
0410 120000   F      882                             call    saver2
0413 8026            883                             jmp             gotoKD
                     884     
0415                 885     ankor:  ;       mov             r10,#0          
                     886                     ;       mov             r11,#0
0415 7898            887                             mov             r0,#chinkor
0417 E6              888                             mov             a,@r0
0418 30E703          889                             jnb             acc.7,nokorr
                     890                     ;       call    chcmp
                     891                     ;       jnc             nokorr
                     892                             ;коррекция 0
041B 020000   F      893                             jmp             kornul
041E 750A00          894     nokorr:         mov             r10,#00         ;       chavt
0421 750B00          895                             mov             r11,#00h
0424 7881            896                             mov              r0,#chavt      
0426 120000   F      897                             call    chcmp           ;сравн счетчик авто калибровки с 0h
0429 704D            898                             jnz             nonulavt        
042B 750A00          899                             mov             r10,#0;1;00;02          
042E 750BC8          900                             mov             r11,#0c8h;90h;0c8h;58h
0431 7898            901                             mov             r0,#chinkor
0433 120000   F      902                             call    chcmp
0436 7058            903                             jnz             noavk
                     904                             ;автокалибровка
0438 020000   F      905                             jmp             autoka;noavk;
                     906     ;;;;;;;;;;
043B C3              907      gotoKD:                clr             c
043C 799A            908                             mov             r1,#parT
043E 7404            909                             mov             a,#4
0440 97              910                             subb    a,@r1
0441 507E            911                             jnc             afterK          ;T<5
                     912                             ;A1-=A- *KD                     ;T>5
0443 120000   F      913                             call            findkoef                                ;r2,r3-hex
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    15

0446 12046C          914                                     call            rebyte2                         ;r2..r5- he
                             x
                     915                                     
0449 120402          916                                     call    altof                   ;r2..r5->float
044C 900000   F      917                                     mov     dptr,#CHtho;100000
044F 120000   F      918                                     call    ldc_ltemp                       ;r8..r11
0452 1202B7          919                                     call    fldiv
0455 120000   F      920                                     call    move28
                     921                             
0458 785E            922                             mov             r0,#rez_Ame;->r2..r5   ???????????/
045A 120000   F      923                             call    resar2
045D 120203          924                                     call    flmul
0460 120343          925                             call    ftol                    ;float->int
0463 7866            926                             mov             r0,#rez_A1
0465 120000   F      927                             call    saver2
0468 786A            928                             mov             r0,#rez_A0;->r8..r11 hex
046A 120000   F      929                             call    resar8
046D 120000   F      930                             call    lsub            ;A3=A-1-A0
0470 789C            931                             mov             r0,#rez_A3
0472 120000   F      932                             call    saver2
0475 020000   F      933                             jmp             labelB  
                     934      ;;;;;;;;;;; 9.11.06
0478 789A            935     nonulavt:        mov            r0,#parT
047A E6              936                             mov             a,@r0
047B 6401            937                             xrl             a,#01
047D 700C            938                             jnz             avtdec1
047F 7982            939                             mov             r1,#chavt+1     ;T=1 chavt-10
0481 120000   F      940                             call    tenmin
0484 7999            941     kordec10:       mov             r1,#chinkor+1
0486 120000   F      942                             call    tenmin
0489 8013            943                             jmp             rezmul
                     944     
048B 7981            945     avtdec1:        mov             r1,#chavt       
048D 120000   F      946                             call    chdec           ;chavt-1
                     947     ;                       jmp             kordec1;rezmul
0490 789A            948     noavk:          mov             r0,#parT
0492 E6              949                             mov             a,@r0
0493 6401            950                             xrl             a,#01
0495 7002            951                             jnz             kordec1
                     952                             ;T=1 chinkor-10
0497 8005            953                             jmp             rezmul
0499 7998            954     kordec1:        mov             r1,#chinkor
049B 120000   F      955                             call    chdec           ; chinkor-1
                     956                        ;9.11.06
                     957                             ;;;;;;;;;;;;;;
                     958                             ;;;;;;;;;;;;;
                     959     ;(РЕЗ1-АN)*K
049E                 960     rezmul:
049E 7866            961                             mov             r0,#rez_A1;->r2..r5
04A0 120000   F      962                             call    resar2
04A3 120402          963                             call    altof   ;r2..r5->float  6.06    
04A6 7884            964                             mov             r0,#kor0_AN;->r8..r11
04A8 120000   F      965                             call    resar8
                     966                             ;;call  altof   ;r2..r5->float
04AB 1201D1          967                             call    flsub
04AE 7890            968                             mov             r0,#koefKp;->r8..r11
04B0 EA              969                             mov             a,r2
                     970                             ;jnb            acc.7,nminus
04B1 300002          971                             jnb             bitznak,nminus
                     972                     
04B4 7894            973                             mov             r0,#koefKm;->r8..r11
04B6 120000   F      974     nminus:         call    resar8
04B9 120203          975                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
                     976                     
                     977                     ;;;;;;;;        call    ftol                    ;float->int
04BC 785E            978                             mov             r0,#rez_Ame
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    16

04BE 120000   F      979                             call    saver2
                     980      ;;;;;;;;;;;;;;;;;;;;;;;;;;
                     981      ;;;;;;;;;;;;;;;;;;;;;;;;;;
04C1                 982     afterK:                 
                     983     ;;;;;;;;;;;;;;
                     984                             ;;;;;;  call    altof                   ;r2..r5->float
04C1 EA              985                                     mov             a,r2
04C2 547F            986                                     anl             a,#7fh
04C4 FA              987                                     mov             r2,a
04C5 900000   F      988                                     mov     dptr,#ch_220;220000
04C8 120000   F      989                                     call    ldc_ltemp                       ;r8..r11=8
04CB 1201D6          990                                     call    flcmp
                     991                             ;       jnc             rmo220          ;A>220000
04CE 120000   F      992                                     call            findkoef                                ;r2
                             ,r3-hex
04D1 12046C          993                                     call            rebyte2                         ;r2..r5- he
                             x
                     994                                     
04D4 120402          995                                     call    altof                   ;r2..r5->float
04D7 900000   F      996                                     mov     dptr,#CHtho;100000
04DA 120000   F      997                                     call    ldc_ltemp                       ;r8..r11=8
04DD 1202B7          998                                     call    fldiv
04E0 120000   F      999                                     call    move28
04E3 785E           1000                                     mov             r0,#rez_Ame
04E5 120000   F     1001                                     call    resar2
                    1002                     
04E8 120203         1003                                     call    flmul     ;A1-=A-*KD  fl
                    1004                                     
04EB 120343         1005                                     call    ftol                    ;float->int
04EE 7866           1006                                     mov             r0,#rez_A1
04F0 120000   F     1007                                     call    saver2
04F3 120402         1008                                     call    altof                   ;r2..r5->float
04F6 900000   F     1009                                     mov     dptr,#ch_200;200000
04F9 120000   F     1010                                     call    ldc_ltemp                       ;r8..r11=8
04FC 1201D6         1011                                     call    flcmp
                    1012                                     ;jnc            mo220           ;A>200000
04FF 301806         1013                                     jnb             knizm,goA2;             bitizm,goA2     
0502 200526         1014                                     jb              bitavp,yesavp   
0505 200650         1015     noavp:                  jb              bitvi11,yesvich
0508                1016     goA2:                    ;A2=A1-
0508 7866           1017                                      mov            r0,#rez_A1
050A 120000   F     1018                                     call    resar2
050D 787B           1019                                     mov             r0,#rez_A2
050F 120000   F     1020                                     call    saver2
0512                1021     goA3A2:                  ;A3=A2-A0
0512 786A           1022                                       mov           r0,#rez_A0
0514 120000   F     1023                                     call    resar8
0517 120000   F     1024                                     call    lsub
051A 789C           1025                                     mov             r0,#rez_A3
051C 120000   F     1026                                     call    saver2
                    1027                                     ;;;;;;
051F                1028     goonin:            ;jmp         goonind;indA3;8.11.06
051F 78AC           1029                                     mov             r0,#chind
0521 B60005         1030                                     cjne    @r0,#0,rnochi0
0524 020000   F     1031                                     jmp             goonind;indA3
                    1032     ;                               clr             P3.4
                    1033     ;                               nop
                    1034     ;                               nop
                    1035     ;                               setb    P3.4      ;??????????????????????/
                    1036     ;                               jmp             nop3_0
                    1037     
                    1038     ;                               jb              P3.0,nop3_0     ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1039     ;                               mov             r0,#rez_A0              ;r2..r5->rez_A0
                    1040     ;                               call    saver2                  ;ЗАПОМНИТЬ СМЕЩЕНИЕ НУЛЯ
                    1041     ;                               jmp             rebyte          ;age2
0527 804B           1042      rmo220:                jmp             mo220
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    17

0529 8078           1043      rnochi0:               jmp             nochi0
                    1044     
                    1045     ;;;;;;;;;;;;;;;;
052B EA             1046     yesavp:                 mov             a,r2
052C 547F           1047                                     anl             a,#7fh
052E FA             1048                                     mov             r2,a
052F 900000   F     1049                                     mov     dptr,#ch_10th;10000
0532 120000   F     1050                                     call    ldc_ltemp                       ;r8..r11=8
0535 1201D6         1051                                     call    flcmp
0538 50CB           1052                                     jnc             noavp           ;A>10000        
053A 78AE           1053                                     mov             r0,#diap                ;10-11
053C B60902         1054                                     cjne    @r0,#9,avpgo
053F 80C4           1055                                     jmp             noavp
0541                1056     avpgo:                  
0541 06             1057                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
0542 B60A01         1058                                     cjne    @r0,#0ah,clmasv
0545 16             1059                                     dec             @r0
0546                1060     clmasv:         ;сбросить массив
0546 120000   F     1061                             call    loadUS
                    1062                             ;call   louizm
0549 120000   F     1063                             call     clmassix
054C 78B3           1064                                     mov             r0,#summa
054E 120000   F     1065                                     call    clear4
0551 786A           1066                                     mov             r0,#rez_A0
0553 120000   F     1067                                     call    clear4                                             
                                                   
0556 80C7           1068                                jmp     goonin
                    1069     
0558                1070     yesvich:        ;A2=E/A1-+F
0558 78A4           1071                                      mov            r0,#constE
055A 120000   F     1072                                     call    resar2
055D 7866           1073                                       mov           r0,#rez_A1
055F 120000   F     1074                                     call    resar8
0562 1202B7         1075                                     call    fldiv
0565 78A8           1076                                      mov    r0,#constF
0567 120000   F     1077                                     call    resar8
056A 120166         1078                                     call    fladd
056D 787B           1079                                     mov             r0,#rez_A2
056F 120000   F     1080                                     call    saver2
0572 809E           1081                                     jmp             goA3A2
                    1082     
0574 300508         1083     mo220:             jnb          bitavp,indoll
0577 301805         1084                                jnb          knizm,indoll;bitizm,indoll
057A 78AE           1085                                     mov             r0,#diap
057C B6000A         1086                                     cjne    @r0,#0,nodi2
                    1087                                ;10-2
057F 900000   F     1088     indoll:                 mov             dptr,#teOLL;OLL
0582 120000   F     1089                                     call    lotext
0585 D217           1090                                     setb    bitoll
0587 8096           1091                                     jmp             goonin  
                    1092     
0589 16             1093     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1094     
058A B6FF01         1095                                     cjne    @r0,#0ffh,nodi9
058D 06             1096                                     inc             @r0
                    1097     
058E 120000   F     1098     nodi9:          call    loadUS
                    1099                                     ;call   louizm
                    1100                                     ;сбросить массив
0591 120000   F     1101                                     call     clmassix
0594 78B3           1102                                     mov             r0,#summa
0596 120000   F     1103                                     call    clear4
0599 786A           1104                                     mov             r0,#rez_A0
059B 120000   F     1105                                     call    clear4  
059E D207           1106                                     setb    bitzus  ;флаг задержки  после установки us         
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    18

                                                                   
05A0 020000   F     1107                                jmp     goonin
                    1108     
05A3 16             1109     nochi0:                 dec             @r0                     ;СТИ-1
05A4 020000   F     1110                                     jmp             labelB  
                    1111     
                    1112             
                    1113     ;;;;;;;;;;;;;;;
                    1114     
05A7                1115     nop3_0: ;;      ;rez_A-rez_A0
                    1116                     ;;                      mov             r0,#rez_A0
                    1117                     ;;                      call    resar8
                    1118                     ;;                      call    lsub
                    1119                     ;;                      mov             r0,#rez_A
                    1120                     ;;;                     call    saver2
                    1121      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
05A7 789C           1122      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
05A9 120000   F     1123                                             call    resar2
05AC 900000   F     1124                                             mov             dptr,#ch100              
05AF 120000   F     1125                                             call    ldc_ltemp        
05B2 120000   F     1126                                             call    zdiv            ;rez_A3/100=r2..r5
                    1127                                     
05B5 EC             1128                                             mov             a,r4
05B6 20E71E         1129                                             jb              acc.7,aless0
05B9 4408           1130                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
05BB F5D3           1131                                             mov             DAC0H,a
                    1132                                                                             ;мл байт
05BD ED             1133                                             mov             a,r5
05BE F5D2           1134                                             mov             DAC0L,a
05C0 801E           1135                                             jmp             moveA3;
                    1136     
05C2 B70207         1137     no3parN:                        cjne    @r1,#2,no2parN
                    1138                                             ;в байт 0  записать пробел
05C5 7946           1139                                             mov             r1,#bufind+6
05C7 7720           1140                                             mov             @r1,#" ";0fdh;
05C9 020000   F     1141                                             jmp             seeind;moveA3
                    1142     
05CC                1143     no2parN:                        ;в байты 0 и 1 записать пробел
05CC 7945           1144                                             mov             r1,#bufind+5
05CE 7720           1145                                             mov             @r1,#" ";0fdh;" "
05D0 09             1146                                             inc             r1
05D1 7720           1147                                             mov             @r1,#" ";0fdh;" "
05D3 807B           1148                                             jmp             seeind;moveA3
05D5 8079           1149      rseeind:               jmp             seeind
05D7 F4             1150     aless0:                         cpl             a
05D8 54F7           1151                                             anl             a,#0f7h         ;d11=0
05DA F5D3           1152                                             mov             DAC0H,a
                    1153                                                                             ;мл байт
05DC ED             1154                                             mov             a,r5
05DD F4             1155                                             cpl             a
05DE F5D2           1156                                             mov             DAC0L,a
05E0                1157     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1158                                     
                    1159                                             
05E0                1160     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1161                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1162                     ;до конца цикла измерения результат не размещать в буфере
                    1163                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1164                     ;и возврату в режим измерения
05E0 201458         1165                                             jb              bitvich,rnorvich
05E3 201055         1166                                             jb              bitt2,rnorvich
05E6 2017EC         1167                                             jb              bitoll,rseeind
                    1168             
                    1169     ;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    19

05E9 789C           1170                                              mov            r0,#rez_A3
05EB 120000   F     1171                                             call    resar2
05EE 120343         1172                                             call    ftol                    ;float->int r2..r5
                    1173     ;;;;;;;;
05F1 789C           1174                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
05F3 120000   F     1175                                             call    resar2
                    1176                                     
05F6 120000   F     1177                                             call    maform
05F9 784F           1178                                             mov             r0,#abin
05FB 120000   F     1179                                             call    saver2
                    1180     ;;;;;;;;
                    1181                                             
05FE 7853           1182                                             mov             r0,#adec
0600 7952           1183                                             mov             r1,#abin+3      ;hex->10
0602 120000   F     1184                                             call    bindec
                    1185                                     
0605 785C           1186                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
0607 7946           1187                                             mov             r1,#bufind+6
0609 7F07           1188                                             mov             r7,#7
060B E6             1189     bufdec:                         mov             a,@r0
060C 2430           1190                                             add             a,#30h
060E F7             1191                                             mov             @r1,a
060F 19             1192                                             dec             r1
0610 18             1193                                             dec             r0
0611 DFF8           1194                                             djnz    r7,bufdec
0613 7847           1195                                             mov             r0,#bufind+7
0615 762D           1196                                             mov             @r0,#2dh          ;-2..-9
0617 7840           1197                                             mov             r0,#bufind
0619 762B           1198                                             mov             @r0,#2bh
061B 300202         1199                                             jnb             znmat,nozzmi;bitznak,nozzmi
061E 762D           1200                                             mov             @r0,#2dh
0620 79AE           1201     nozzmi:                         mov             r1,#diap
0622 7848           1202                                             mov             r0,#bufind+8
0624 E7             1203                                             mov             a,@r1
0625 B40808         1204                                             cjne    a,#8,nodi8
0628 7630           1205                                             mov             @r0,#30h                 ;10-10
062A 18             1206                                             dec             r0
062B 7663           1207                                             mov             @r0,#63h;31h
062D 08             1208                                             inc             r0
062E 8012           1209                                             jmp             seegoon
0630 B4090C         1210     nodi8:                          cjne    a,#9,nodis9
                    1211                                     
0633 7631           1212                                             mov             @r0,#31h           ;10-11
0635 18             1213                                             dec             r0
0636 7663           1214                                             mov             @r0,#63h;31h
                    1215                                     
0638 08             1216                                             inc             r0
0639 8007           1217                                             jmp             seegoon
                    1218     
063B 8051           1219     rnorvich:               jmp             norvich
063D 8083           1220     rno3parN:               jmp             no3parN
                    1221     
063F 2432           1222     nodis9:                         add             a,#32h
0641 F6             1223                                             mov             @r0,a;#37h;"T";
0642 08             1224     seegoon:                        inc             r0
0643 7641           1225                                             mov             @r0,#"A";"E";
0645 08             1226                                             inc             r0
0646 7600           1227                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
0648 08             1228                                             inc             r0;             mov             buf
                             ind+11
0649 76C0           1229                                             mov             @r0,#0c0h
                    1230                                             
                    1231     ;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    20

                    1232     ;;;;;;goonind:
064B 79AF           1233                                             mov             r1,#parN        ; ??????
064D B703ED         1234                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1235                                     
                    1236             
0650                1237     seeind:                         ;;;;;;;;;;;;;
0650 784A           1238                                             mov             r0,#bufind+10
0652 E6             1239                                             mov             a,@r0
0653 300F03         1240                                             jnb             bitnul,nnnul
0656 4408           1241                                             orl             a,#08h
0658 F6             1242                                             mov             @r0,a
0659 799A           1243      nnnul:                         mov             r1,#parT
065B B70304         1244                                             cjne    @r1,#3,nsec01
065E 4410           1245                                             orl             a,#10h
0660 800C           1246                                             jmp             nsec10   ;0,1s
0662 B70204         1247      nsec01:                        cjne    @r1,#2,nsec1
0665 4420           1248                                             orl             a,#20h    ;1s
0667 8005           1249                                             jmp             nsec10
0669 B70102         1250     nsec1:                          cjne    @r1,#1,nsec10
066C 4440           1251                                             orl             a,#40h
                    1252     
                    1253     ;;;;;;;;;;;;;;;;
066E F6             1254     nsec10:                         mov             @r0,a
066F 300504         1255                                             jnb             bitavp,nobavp
0672 4404           1256                                             orl             a,#04           ;bufind+10.2
0674 F6             1257                                             mov             @r0,a
0675 F6             1258                                             mov             @r0,a   
0676 301803         1259     nobavp:                    jnb          knizm,nobitizm
0679 4402           1260                                             orl             a,#02
067B F6             1261                                              mov            @r0,a
067C                1262     nobitizm:                       
067C 301A07         1263                                             jnb             bitakt,notakt
067F C21A           1264                                             clr             bitakt
0681 534AFE         1265                                             anl             bufind+10,#0feh
0684 8005           1266                                             jmp             taktind
0686 D21A           1267     notakt:                         setb    bitakt
0688 434A01         1268                                             orl             bufind+10,#01                      
                                          
068B 120000   F     1269     taktind:                        call    ind        ;пп выдачи на индикатор
068E                1270     norvich: 
068E 789A           1271                                     mov             r0,# parT
0690 79AC           1272                                             mov             r1,#chind
0692 B60177         1273                                             cjne    @r0,#1,rnot1in
0695                1274     labelB:                    ;;;;;;;;;;;
                    1275                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
0695 789F           1276                                                     mov     r0,#rez_A3+3
                    1277                             ;;;;;;;;
0697 79BB           1278                             mov             r1,#work+3
0699 E6             1279                             mov             a,@r0
069A 7F07           1280                             mov             r7,#7;кол сдв вправо
069C C3             1281     dvig3:          clr             c
069D 13             1282                             rrc             a
069E DFFC           1283                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
06A0 FA             1284                             mov             r2,a    ;сохр байт
06A1 18             1285                             dec             r0              ;rez_A3+2
06A2 E6             1286                             mov             a,@r0
06A3 C0E0           1287                             push    acc
06A5 C3             1288                             clr             c
06A6 7F01           1289                             mov             r7,#1
06A8 C3             1290     dvig2:          clr             c
06A9 33             1291                             rlc             a
06AA DFFC           1292                             djnz    r7,dvig2 ;d12..d11       средний байт
06AC 4A             1293                             orl             a,r2
06AD F7             1294                             mov             @r1,a;сформ мл байт
06AE 19             1295                             dec             r1
06AF D0E0           1296                             pop             acc
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    21

                    1297                             
06B1 7F07           1298                             mov             r7,#7
06B3 C3             1299     dvig1:          clr             c
06B4 13             1300                             rrc             a
06B5 DFFC           1301                             djnz    r7,dvig1 ;d18     ср байт
06B7 FA             1302                             mov             r2,a   ;сохр
06B8 18             1303                             dec             r0
06B9 E6             1304                             mov             a,@r0 ;rez_A3+1
06BA C0E0           1305                             push    acc
                    1306                     
06BC 7F01           1307                             mov             r7,#1
06BE C3             1308     dvig0:          clr             c
06BF 33             1309                             rlc             a
06C0 DFFC           1310                             djnz    r7,dvig0 ;        d21..d16
06C2 4A             1311                             orl             a,r2
06C3 F7             1312                             mov             @r1,a   ; сформ средний  байт
06C4 19             1313                             dec             r1
06C5 D0E0           1314                             pop             acc       ;rez_A3+1
                    1315                             ;;;;;;;;;;;;;;
                    1316     ;                       jb              acc.7,dvm
06C7 C3             1317                             clr             c
06C8 7F07           1318                             mov             r7,#7
06CA C3             1319     dvig4:          clr             c
06CB 13             1320                             rrc             a
06CC DFFC           1321                             djnz    r7,dvig4 ;        d22
06CE FA             1322                             mov             r2,a   ;сохр
06CF 18             1323                             dec             r0;     rez_A3
06D0 E6             1324                             mov             a,@r0
                    1325                             ;;;;;
06D1 7F01           1326                             mov             r7,#1
06D3 C3             1327     vig0:           clr             c
06D4 33             1328                             rlc             a
06D5 DFFC           1329                             djnz    r7,vig0 ;         d24..d30
06D7 4A             1330                             orl             a,r2
06D8 F7             1331                             mov             @r1,a   ; сформ   байт
06D9 19             1332                             dec             r1
06DA E6             1333                             mov             a,@r0
                    1334                             ;;;;;
06DB 20E709         1335                             jb              acc.7,dvm
06DE C3             1336                             clr             c
06DF 7F07           1337                             mov             r7,#7
06E1 C3             1338     vig4:           clr             c
06E2 13             1339                             rrc             a
06E3 DFFC           1340                             djnz    r7,vig4 ;         d
06E5 8006           1341                             jmp             endsdv
                    1342     ;;;;;;;;;;;;                                    
06E7 7F07           1343     dvm:            mov             r7,#7
06E9 D3             1344     dvig6:          setb            c
06EA 13             1345                             rrc             a
06EB DFFC           1346                             djnz    r7,dvig6 ;        d31
06ED F7             1347     endsdv:         mov             @r1,a
                    1348                                                             
                    1349      ;->work   
                    1350                             
06EE 900000   F     1351                             mov             dptr,#chzap
06F1 120000   F     1352                             call     ldc_long
06F4 78BB           1353                              mov            r0,#work+3
06F6 120000   F     1354                             call    ladd
06F9 ED             1355                             mov             a,r5
06FA F5D5           1356                             mov             DAC1L,a
                    1357                             
06FC EC             1358                             mov             a,r4
06FD F5D6           1359                             mov             DAC1H,a
                    1360     
                    1361                                             ;;;;;;;;;;
06FF 78AD           1362                                             mov             r0,#chbuf         ;T=1
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    22

0701 B6002F         1363                                             cjne    @r0,#0,nobuf0
0704 200907         1364                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
0707 200A06         1365                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
070A 801A           1366                                             jmp             gocikle
070C 8028           1367     rnot1in:                jmp             not1in
070E                1368     yesprd: ;передать   A3 в буфер
070E 8000           1369                                             jmp             goonT
0710                1370     yesbuf: ;записать   A3 в буфер
0710 789A           1371     goonT:                          mov             r0,#parT
0712 79AD           1372                                             mov             r1,#chbuf
0714 B60102         1373                                             cjne    @r0,#1,nott1
                    1374                                     ;       mov             @r1,#
0717 800D           1375                                             jmp             gocikle
                    1376     
0719 B60502         1377     nott1:                          cjne    @r0,#5,nott5
                    1378     
071C 8008           1379                                             jmp             gocikle
                    1380     
071E C3             1381     nott5:           clr            c
071F 799A           1382                             mov             r1,#parT
0721 7404           1383                             mov             a,#4
0723 97             1384                             subb    a,@r1
0724 500B           1385                             jnc             yestt5          ;T<5
0726 300805         1386     gocikle:        jnb             bitbuf,nofz                                     
0729 120000   F     1387                             call    z_01s    ;0,5c
072C C208           1388                             clr     bitbuf
072E 020000   F     1389     nofz:           jmp     labelA;rebyte
                    1390     
                    1391     
0731 80F3           1392     yestt5:         jmp             gocikle
                    1393     
0733 16             1394     nobuf0:                         dec             @r0
0734 80F0           1395                                             jmp             gocikle
                    1396     
                    1397     
0736 B60205         1398     not1in:                         cjne    @r0,#2,not2in
0739 7701           1399                                             mov             @r1,#1           ;T=2
073B 020000   F     1400                                             jmp     labelB
                    1401     
073E B60305         1402     not2in:                         cjne    @r0,#3,not3in
0741 7709           1403                                             mov             @r1,#9          ;T=3
0743 020000   F     1404                                             jmp     labelB
0746 7713           1405     not3in:                         mov             @r1,#19
0748 020000   F     1406                                             jmp     labelB
                    1407     
                    1408     
                    1409     ;;;;;;;;;;;3.11.06
                    1410     
                    1411     ;;коррекция 0
074B 7883           1412     KORnul:         mov             r0,#chdel
074D B60008         1413                             cjne    @r0,#0,nonuldel
                    1414                                     
                    1415                     ;       mov             a,P5       ;p5.3=1
                    1416                     ;       orl             a,#08
                    1417                     ;       mov             P5,a
                    1418                     ;       nop
                    1419                     ;       nop
                    1420                                     
                    1421                     ;       mov             a,P5              ;p5.0=0
                    1422                     ;       anl             a,#0feh
                    1423                     ;       mov             P5,a
                    1424             
0750 900000   F     1425                             mov             dptr,#kor0us
0753 120000   F     1426                             call    lospus          ;упр слово коррекции 0
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    23

0756 8013           1427                             jmp             chdelmo
                    1428     
0758 B60716         1429     nonuldel:       cjne    @r0,#7,no4del
                    1430                             ;рез ->AN
075B 7862           1431                             mov             r0,#rez_A;->r2..r5
075D 120000   F     1432                             call    resar2
                    1433                     ;       mov             a,reacp         ;r2..r5 &&&&&&&&&&&
                    1434                     ;               mov             r2,a
                    1435                     ;               mov             a,reacp+1
                    1436                     ;               mov             r3,a
                    1437                     ;               mov             a,reacp+2
                    1438                     ;               mov             r4,a
                    1439                     ;               mov             a,reacp+3
                    1440                     ;               mov             r5,a
                    1441                                     ;;;;;;;;;;
0760 120402         1442                             call    altof           ;r2..r5->float
0763 7884           1443                             mov             r0,#kor0_AN;->kor0_AN
0765 120000   F     1444                             call    saver2
                    1445                                     
                    1446                     ;       mov             a,P5            ;p5.0=1
                    1447                     ;       orl             a,#01
                    1448                     ;       mov             P5,a
                    1449                     ;       nop
                    1450                     ;       nop
                    1451                                     
                    1452                     ;       mov             a,P5                    ;p5.3=0 
                    1453                     ;       anl             a,#0f7h
                    1454                     ;       mov             P5,a                    
0768 120000   F     1455                             call    loadUS          ;восстан исходное упр слово
076B 7883           1456     chdelmo:        mov             r0,#chdel
076D 06             1457                             inc             @r0             ;chdel+1
076E 020000   F     1458                             jmp              rebyte
                    1459     
0771 B60EF7         1460     no4del:         cjne    @r0,#14,chdelmo
0774 7600           1461                             mov             @r0,#0          ;chdel
0776 7898           1462                             mov             r0,#chinkor
0778 7600           1463                             mov             @r0,#00;1;00;02;600;
077A 08             1464                             inc             r0
077B 76C8           1465                             mov             @r0,#0c8h;90h;0c8h;58h;258h
077D 120000   F     1466                             call    clmassix;сбросить массив скольз среднего
0780 020000   F     1467                             jmp              rebyte
                    1468     
                    1469     ;автокалибровка
0783                1470     autoka:  ;;  mov                r0,#chavt
                    1471                      ;;  call               chcmp
                    1472                      ;;  jz         nulavt
                    1473                     ;;   mov                r1,#chavt
                    1474                     ;;   call               chdec;chavt-1
                    1475                      ;; jmp         rebyte
0783                1476     nulavt:  ;;;;;
0783 7883           1477                             mov             r0,#chdel
0785 B6000E         1478                             cjne    @r0,#0,nndelch
0788 E585           1479                             mov   a,p5
078A 4404           1480                             orl             a,#04              ;p5.2=1
078C 00             1481                             nop
078D 00             1482                             nop
078E 543F           1483                             anl             a,#3fh          ;p5.6,p5.7=0
0790 F585           1484                             mov   p5,a
0792 06             1485                             inc             @r0
0793 020000   F     1486                             jmp              rebyte
                    1487     
0796 B6073D         1488     nndelch:        cjne    @r0,#7,n4delch
                    1489                             ;pez->A+
                    1490                             ;K+=000/(A+-AN)
                    1491                             ;mov            r0,#rez_A;->r2..r5
                    1492                             ;call   resar2
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    24

0799 E577           1493                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
079B FA             1494                                     mov             r2,a
079C E578           1495                                     mov             a,reacp+1
079E FB             1496                                     mov             r3,a
079F E579           1497                                     mov             a,reacp+2
07A1 FC             1498                                     mov             r4,a
07A2 E57A           1499                                     mov             a,reacp+3
07A4 FD             1500                                     mov             r5,a
                    1501                                     ;;;;;;;;;;;;;;;
07A5 120402         1502                             call    altof                   ;r2..r5->float
07A8 7888           1503                             mov             r0,#rezAp;->rezAp
07AA 120000   F     1504                             call    saver2                          
07AD 7884           1505                             mov             r0,#kor0_AN;kor0_AN->r8..r11
07AF 120000   F     1506                             call    resar8                          
07B2 1201D1         1507                             call    flsub           ; r2..r5(A+-AN)
07B5 120000   F     1508                             call    move28     ;r2..r5->r8..r11
07B8 900000   F     1509                             mov             dptr,#CH2tho;000->r2..r5 float
07BB 120000   F     1510                             call    ldc_long                
07BE 1202B7         1511                             call    fldiv
07C1 EA             1512                             mov             a,r2
07C2 547F           1513                             anl             a,#7fh
07C4 FA             1514                             mov             r2,a
07C5 7890           1515                             mov             r0,#koefKp;->koefKp
07C7 120000   F     1516                             call    saver2
                    1517                       
                    1518                     ;       anl             P5,#0feh                ;p5.0=0 
07CA E585           1519                     mov             a,P5
07CC 543B           1520                             anl             a,#3bh;acp-
07CE F585           1521                             mov             P5,a
07D0 7883           1522                             mov             r0,#chdel
07D2 06             1523                             inc             @r0                       ;ch+1
07D3 020000   F     1524                             jmp             rebyte
                    1525     
07D6 B60E3A         1526     n4delch:        cjne    @r0,#14,n8delch
                    1527                             ; pez->A-
                    1528                             ;K-=000/(A--AN)
                    1529                     ;       mov     r0,#rez_A;->r2..r5
                    1530                     ;       call    resar2
07D9 E577           1531                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
07DB FA             1532                                     mov             r2,a
07DC E578           1533                                     mov             a,reacp+1
07DE FB             1534                                     mov             r3,a
07DF E579           1535                                     mov             a,reacp+2
07E1 FC             1536                                     mov             r4,a
07E2 E57A           1537                                     mov             a,reacp+3
07E4 FD             1538                                     mov             r5,a
                    1539                                     ;;;;;;;;;;;;;;;
07E5 120402         1540                             call    altof                   ;r2..r5->float
07E8 788C           1541                             mov             r0,#rezAm;->rezAm
07EA 120000   F     1542                             call    saver2                          
07ED 7884           1543                             mov             r0,#kor0_AN;kor0_AN->r8..r11
07EF 120000   F     1544                             call    resar8                          
07F2 1201D1         1545                             call    flsub                   ; r2..r5(A--AN)
07F5 120000   F     1546                             call    move28                  ;r2..r5->r8..r11
07F8 900000   F     1547                             mov             dptr,#CH2tho    ;000->r2..r5 float
07FB 120000   F     1548                             call    ldc_long                
07FE 1202B7         1549                             call    fldiv
0801 EA             1550                             mov             a,r2
0802 547F           1551                             anl             a,#7fh
0804 FA             1552                             mov             r2,a
0805 7894           1553                             mov             r0,#koefKm;->koefKm
0807 120000   F     1554                             call    saver2
                    1555                        
080A 120000   F     1556                             call    loadus
080D 7883           1557                             mov             r0,#chdel
080F 06             1558                             inc             @r0                       ;ch+1
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    25

0810 020000   F     1559                        jmp    rebyte
                    1560     
0813 B6110F         1561     n8delch:        cjne    @r0,#17,n12delch
0816 7600           1562                             mov             @r0,#0
0818 7981           1563                             mov             r1,#chavt
081A 770C           1564                             mov             @r1,#0ch;6;1;
081C 09             1565                             inc             r1
081D 7780           1566                             mov             @r1,#80h;40h;
081F 120000   F     1567                             call   clmassix     ;сбросить массив среднего
0822 020000   F     1568                             jmp             rebyte
0825 06             1569     n12delch:       inc             @r0
0826 020000   F     1570                             jmp             rebyte
                    1571     
                    1572     ;in-r1-count
0829                1573     chdec:          ;mov            r1,#chavt               ;chavt-1
0829 E7             1574                             mov             a,@r1
082A FC             1575                             mov             r4,a
082B 09             1576                             inc             r1
082C E7             1577                             mov             a,@r1
082D FD             1578                             mov             r5,a
082E C202           1579                             clr             rr2
0830 C203           1580                             clr             rr3
0832 900000   F     1581                             mov             dptr,#ch1        
0835 120000   F     1582                             call    ldc_ltemp
0838 120000   F     1583                             call    lsub
083B ED             1584                             mov             a,r5
083C F7             1585                             mov             @r1,a
083D 19             1586                             dec             r1
083E EC             1587                             mov             a,r4
083F F7             1588                             mov             @r1,a
0840 22             1589                             ret      
                    1590     
                    1591     
                    1592     
                    1593     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
0841 75E700         1594      ind:   mov             EIE2,#00H;mov   IE,#00h
0844 120000   F     1595                     call    mign
0847 7840           1596                      mov            r0,#bufind;+11
0849 7F0C           1597                      mov            r7,#12
084B C286           1598      nexin: clr             p0.6
084D E6             1599                     mov             a,@r0
084E F59B           1600                     mov             SPI0DAT,a
0850 20FBFD         1601                     jb              TXBSY,$
0853 D286           1602                     setb    p0.6
0855 120000   F     1603                     call    z_9             ;25mks
0858 08             1604                     inc             r0;dec          r0
0859 DFF0           1605                     djnz    r7,nexin
085B 75E730         1606                     mov             EIE2,#30H;mov   IE,#80h
085E 22             1607                ret
                    1608     
                    1609     
085F 7A08           1610     zapadc:   mov R2,#8
0861 D297           1611     sdv:      setb P1.7
0863 33             1612               rlc A
0864 9296           1613                     mov P1.6,C
0866 120000   F     1614                     call tim2
                    1615                                     
0869 C297           1616                     clr P1.7
086B 120000   F     1617                     call tim2
086E DAF1           1618                     djnz R2,sdv
0870 D296           1619                     setb P1.6
0872 22             1620                     ret
                    1621     
0873 7A08           1622     chtadc:   mov R2,#8
0875 D297           1623     sdv1:     setb P1.7
0877 120000   F     1624               call tim2
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    26

087A C297           1625                     clr P1.7
087C A296           1626                     mov C,P1.6
087E 33             1627                     rlc A
087F 120000   F     1628                     call tim2
0882 DAF1           1629                     djnz R2,sdv1
0884 22             1630                     ret
                    1631     
0885 7E30           1632     tim:      mov R6,#30h;38h
0887 DEFE           1633     tim1:     djnz R6,tim1
0889 22             1634               ret
                    1635               
088A 7E10           1636     tim2:     mov R6,#10h;14h
088C DEFE           1637     tim3:     djnz R6,tim3
088E 22             1638               ret
                    1639     
                    1640     ;запись из acc
088F C3             1641     write_x1: clr   c
0890                1642     writeD_x1:
0890 92B1           1643                       mov P3.1,c        ;запись
0892 F5A0           1644               mov P2,A
0894 D2B3           1645                       setb P3.3
0896 120000   F     1646                       call z_5
0899 C2B3           1647                       clr P3.3
089B 75A0FF         1648                       mov P2,#0FFh
089E 22             1649                       ret
                    1650     
                    1651     ;чтение в acc
089F C3             1652     read_x2:  clr   c  
08A0 92B1           1653               mov P3.1,c        ;чтение
08A2 D2B2           1654               setb P3.2
08A4 D2B3           1655                       setb P3.3
08A6 120000   F     1656                     call z_5
08A9 E5A0           1657                       mov A,P2
08AB C2B3           1658                       clr P3.3
08AD C2B2           1659                       clr P3.2
08AF 22             1660                       ret
                    1661     
                    1662     
08B0 120000   F     1663     loop:     call read_x2;x2    ;ожидание флага готовности
08B3 20E7FA         1664                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
08B6 22             1665                        ret           ;возврат, если бит А(7)<>1
                    1666                                      
                    1667                                        
                    1668     
                    1669     
                    1670     
                    1671     ;dptr+4-приемник
                    1672     ;dptr-источник
                    1673     ;r7-кол байт  
08B7                1674     xCIKLWR:
08B7 7F04           1675                             mov             r7,#4   
08B9 E0             1676     lwrx:   movx    a,@dptr
08BA C083           1677                             push    dph
08BC C082           1678                             push    dpl
08BE A3             1679                             inc             dptr
08BF A3             1680                             inc             dptr
08C0 A3             1681                             inc             dptr
08C1 A3             1682                             inc             dptr
08C2 F0             1683                             movx    @dptr,a
08C3 D082           1684                             pop             dpl
08C5 D083           1685                             pop             dph
                    1686                             
08C7 A3             1687                             inc             dptr
08C8 DFEF           1688                             djnz    r7,lwrx
08CA 22             1689                             ret
                    1690     ;r2..r5->@dptr..@dptr+3                         
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    27

08CB EA             1691     saveIr2:                mov     a,r2
08CC F0             1692                                             movx    @dptr,a
08CD A3             1693                                             inc     dptr
08CE EB             1694                                             mov     a,r3
08CF F0             1695                                             movx    @dptr,a
08D0 A3             1696                                             inc     dptr
08D1 EC             1697                                             mov     a,r4
08D2 F0             1698                                             movx    @dptr,a
08D3 A3             1699                                             inc     dptr
08D4 ED             1700                                             mov     a,r5
08D5 F0             1701                                             movx    @dptr,a
08D6 22             1702                                             ret
                    1703     ;r2..r5-> @r0..@r0+3
                    1704     
08D7 EA             1705     saver2:         mov     a,r2
08D8 F6             1706                                             mov     @r0,a
08D9 08             1707                                             inc     r0
08DA EB             1708                                             mov     a,r3
08DB F6             1709                                             mov     @r0,a
08DC 08             1710                                             inc     r0
08DD EC             1711                                             mov     a,r4
08DE F6             1712                                             mov     @r0,a
08DF 08             1713                                             inc     r0
08E0 ED             1714                                             mov     a,r5
08E1 F6             1715                                             mov     @r0,a
08E2 22             1716                                             ret 
08E3 7F28           1717     clmassix:       mov                     r7,#28h
08E5 900080         1718                             mov     dptr,#MASS0        ;забить массив A нулями
08E8 7400           1719     clmax:          mov          a,#00h
08EA F0             1720                  movx    @dptr,a
08EB A3             1721                  inc     dptr
08EC DFFA           1722                 djnz                r7,clmax                
08EE F56E           1723                  mov     chmas,a
08F0 C201           1724                  clr     bitmas
08F2 22             1725                 ret
                    1726     
                    1727     ;r1-яЁшхьшъ
                    1728     ;r0-шёЄюўшъ
                    1729     ;r7-ъюы срщЄ  
08F3                1730     CIKLWR:
08F3 7F04           1731                             mov             r7,#4   
08F5 E6             1732     lwr:    mov     a,@r0
08F6 F7             1733                             mov     @r1,a
08F7 09             1734                             inc             r1
08F8 08             1735                             inc             r0
08F9 DFFA           1736                             djnz    r7,lwr
08FB 22             1737                             ret     
                    1738     ;r2..r5-> @dptr..@dptr+3
                    1739     
08FC 120000   F     1740     zmul:   call    maform
08FF 120000   F     1741                     call    lmul
0902 120000   F     1742                     call    bform
0905 22             1743                     ret
                    1744     
0906 120000   F     1745     zdiv:   call    maform
0909 120000   F     1746                     call    divide
090C 120000   F     1747                     call    bform
090F 22             1748                     ret
                    1749     
0910 EA             1750     maform: mov a,r2
0911 33             1751             rlc a
0912 5006           1752             jnc             fo1m
0914 D202           1753                     setb            znmat
0916 120000   F     1754                     call   form4
0919 22             1755                     ret
091A C202           1756     fo1m:   clr             znmat
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    28

091C 22             1757                     ret
                    1758     
091D 300203         1759     bform:  jnb             znmat,fo2m
0920 120000   F     1760                     call    form4
0923 22             1761     fo2m:   ret
                    1762       
                    1763     ;r2..r5 яхЁхтхёЄш т фюя ъюф
0924 ED             1764     form4:          mov a,r5
0925 F4             1765             cpl a
0926 2401           1766             add a,#1
0928 FD             1767             mov r5,a
0929 EC             1768             mov a,r4
092A F4             1769             cpl a
092B 3400           1770             addc    a,#0
092D FC             1771             mov r4,a
092E EB             1772             mov a,r3
092F F4             1773                 cpl a
0930 3400           1774             addc    a,#0
0932 FB             1775             mov r3,a
0933 EA             1776             mov a,r2
0934 F4             1777             cpl a
0935 3400           1778             addc    a,#0
0937 FA             1779             mov r2,a
0938 22             1780             ret
                    1781     
0939 120000   F     1782     zcmp:   call            maform
093C 120000   F     1783                     call            lcmp
093F C0D0           1784                     push            psw
0941 120000   F     1785                     call    bform
0944 D0D0           1786                     pop             psw
0946 22             1787                     ret
                    1788     
                    1789     
                    1790     ;@r0..@r0+3->r8..r11
                    1791     
0947 E6             1792     resar8: mov     a,@r0
0948 F508           1793                     mov     ltemp,a
094A 08             1794                     inc     r0
094B E6             1795                     mov     a,@r0
094C F509           1796                     mov     ltemp+1,a
094E 08             1797                     inc     r0
094F E6             1798                     mov     a,@r0
0950 F50A           1799                     mov     ltemp+2,a
0952 08             1800                     inc     r0
0953 E6             1801                     mov     a,@r0
0954 F50B           1802                     mov     ltemp+3,a
0956 22             1803                     ret
                    1804     
                    1805     ;
                    1806     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                    1807     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                    1808     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                    1809     ;r2 a    ўшёыю 180
                    1810     ;00 b4
                    1811     ;т_ї- mabin..mabin+2
                    1812     ;     80 01 00
                    1813      
0957 C8             1814     cond:   xch     a,r0    
0958 F9             1815                     mov     r1,a
0959 C8             1816                     xch     a,r0
095A 7C03           1817                     mov     r4,#03
095C 7700           1818     dcoa:   mov     @r1,#00
095E 09             1819                     inc     r1
095F DCFB           1820                     djnz    r4,dcoa
0961 7B10           1821                     mov     r3,#10h
0963 C3             1822     dcob:   clr     c
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    29

0964 33             1823                     rlc     a
0965 CA             1824                     xch     a,r2
0966 33             1825                     rlc     a
0967 CA             1826                     xch     a,r2
0968 C8             1827                     xch     a,r0
0969 F9             1828                     mov     r1,a
096A C8             1829                     xch     a,r0
096B 7C03           1830                     mov     r4,#03
096D FD             1831                     mov     r5,a
096E E7             1832     dcoc:   mov     a,@r1 
096F 37             1833                     addc    a,@r1
0970 D4             1834                     da      a
0971 F7             1835                     mov     @r1,a
0972 09             1836                     inc     r1
0973 DCF9           1837                     djnz    r4,dcoc
0975 ED             1838                     mov     a,r5
0976 4003           1839                     jc      dcod
0978 DBE9           1840                     djnz    r3,dcob
097A C3             1841                     clr     c
097B 00             1842     dcod:   nop
097C 22             1843                     ret
                    1844     
097D 8A08           1845     move28: mov     ltemp,r2                        ;r2..r5->ltemp
097F 850309         1846                     mov     ltemp+1,3
0982 85040A         1847                     mov     ltemp+2,4
0985 85050B         1848                     mov     ltemp+3,5
0988 22             1849                     ret
                    1850     
                    1851     ;@r0..@r0+3->r2..r5
                    1852     
0989 E6             1853     resar2: mov     a,@r0
098A FA             1854                     mov     r2,a
098B 08             1855                     inc     r0
098C E6             1856                     mov     a,@r0
098D FB             1857                     mov     r3,a
098E 08             1858                     inc     r0
098F E6             1859                     mov     a,@r0
0990 FC             1860                     mov     r4,a
0991 08             1861                     inc     r0
0992 E6             1862                     mov     a,@r0
0993 FD             1863                     mov     r5,a
0994 22             1864                     ret
                    1865     
                    1866     ;25mkc !!!!!!!!!!!!!!!1
0995 7B4B           1867     z_9:      mov R3,#4Bh      ;загрузка числа
0997 DBFE           1868                    djnz R3,$
0999 22             1869               ret
                    1870     
                    1871     ;запись   передаваемый байт в acc
                    1872     ;передача байта послед кодом старшими разрядами  вперед
099A 7A08           1873     write:     mov R2,#8
099C C3             1874                             clr  c  
099D C297           1875     wr1:            clr             p1.7;P1.2
099F 00             1876                         nop 
09A0 33             1877                             rlc A
09A1 9296           1878                             mov P1.6,C;P1.1,C
09A3 120000   F     1879                        call tim2
09A6 D297           1880                        setb P1.7;P1.2
09A8 120000   F     1881                call tim2
09AB DAF0           1882                       djnz R2,wr1
09AD C296           1883                       clr P1.6;P1.1
09AF 22             1884                      ret
                    1885     
                    1886     ;принимаемый байт в acc
                    1887     ;прием байта последовательным кодом старшими разрядами вперед
09B0 7A08           1888     read:    mov R2,#8
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    30

09B2 C297           1889     re1:     clr P1.7;P1.2
09B4 120000   F     1890              call tim2        ;5mks
09B7 A294           1891                     mov C,P1.4;P1.0
09B9 33             1892                     rlc A           
09BA D297           1893                     setb P1.7;P1.2
09BC 120000   F     1894                     call tim2
09BF DAF1           1895                     djnz R2,re1
09C1 22             1896                     ret
                    1897     
                    1898      ;in r0-count   
                    1899     ;r10,r11-значение с котоым сравнивается счетчик
                    1900     ;r2..r5 -значение счетчика
09C2                1901     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
09C2 E6             1902                     mov                     a,@r0
09C3 FC             1903                     mov                     r4,a
09C4 08             1904                     inc                     r0
09C5 E6             1905                     mov                     a,@r0
09C6 FD             1906                     mov                     r5,a
09C7 7B00           1907                     mov                     r3,#0
09C9 7A00           1908                     mov                     r2,#0
09CB 750800         1909                     mov                     r8,#0;clr                       r8
09CE 750900         1910                     mov                     r9,#0;clr                       r9
09D1 120000   F     1911                     call            lcmp
09D4 22             1912                     ret
                    1913     
                    1914     
                    1915     
                    1916     
                    1917     
                    1918     
                    1919                                 
09D5 020000   F     1920     rout6:          jmp             out6
09D8 020000   F     1921     rlabelF:        jmp             labelF  
09DB 020000   F     1922     rknrazr:        jmp             knrazr  
09DE 020000   F     1923     rknopt:         jmp             knopt
09E1 020000   F     1924     rizman:         jmp             izman   
09E4                1925     keyb1:  ;IE6 
09E4 C219           1926                                     clr             bitmig
09E6 C0E0           1927                                     push    acc
09E8 C0D0           1928                                     push    psw
09EA C000           1929                                     push    rr0
09EC C001           1930                                     push    rr1
09EE C002           1931                                     push    rr2
09F0 C003           1932                                     push    rr3
09F2 C004           1933                                     push    rr4
09F4 C005           1934                                     push    rr5
09F6 C006           1935                                     push    rr6
09F8 C007           1936                                     push    rr7
09FA 75E700         1937                                     mov             EIE2,#00H
                    1938                       ;;;;;;;;;;;;;;
09FD 120000   F     1939                                     call    z_01s;0,1s
                    1940                                     ;восстан знакоместо при мигании
                    1941                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0A00 78B2           1942                                     mov             r0,#marker
0A02 7440           1943                                     mov             a,#bufind
0A04 26             1944                                     add             a,@r0                   ;a=bufind+marker
0A05 F9             1945                                     mov             r1,a
0A06 A73C           1946                                     mov             @r1,savba
                    1947                                     ;;;;;;;;;;;
0A08 E5B0           1948                             mov             a,p3
0A0A 20E6C8         1949                                     jb              acc.6,rout6
0A0D E5B0           1950                                     mov             a,p3
0A0F 44FF           1951                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0A11 F5B0           1952                                     mov             p3,a
0A13 E5B0           1953                                     mov             a,p3
0A15 30E6BD         1954                                     jnb             acc.6,rout6             ;error
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    31

0A18 3004BD         1955                                     jnb             bitizm,rlabelF
0A1B 75B0FE         1956                                     mov             p3,#0feh                ;реж IZM
0A1E E5B0           1957                                     mov             a,p3
0A20 30E6BE         1958                                     jnb             acc.6,rizman
0A23 75B0FD         1959                                     mov             p3,#0fdh
0A26 E5B0           1960                                     mov             a,p3
0A28 30E6B0         1961                                     jnb             acc.6,rknrazr             ;labelC
0A2B 75B0FB         1962                                     mov             p3,#0fbh
0A2E E5B0           1963                                     mov             a,p3
0A30 30E638         1964                                     jnb             acc.6,knright           ;->
0A33 75B0F7         1965                                     mov             p3,#0f7h
0A36 E5B0           1966                                     mov             a,p3
0A38 30E6A3         1967                                     jnb             acc.6,rknopt                    ;T
0A3B 75B0EF         1968                                     mov             p3,#0efh
0A3E E5B0           1969                                mov          a,p3
0A40 30E60B         1970                                     jnb             acc.6,pyskst                    ;pysk/stop
0A43 75B0DF         1971                                     mov             p3,#0dfh
0A46 E5B0           1972                                     mov             a,p3
0A48 30E63C         1973                                jnb          acc.6,knvich
0A4B 020000   F     1974                                     jmp             izmpaT
                    1975     
0A4E 200A05         1976     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0A51 D20A           1977                                     setb    bitbon  ;уст реж буфер вкл
0A53 020000   F     1978                                     jmp             izmpaT
0A56 C20A           1979     bufon:                  clr             bitbon  ;уст реж буфер выкл
0A58 020000   F     1980                                     jmp             izmpaT
                    1981     
0A5B 79B0           1982     tizmri:                 mov             r1,#level
0A5D B70102         1983                                     cjne    @r1,#1,right2
                    1984                                     ;10s->HET
0A60 8004           1985                                     jmp             right3
                    1986     
0A62 07             1987     right2:                 inc             @r1
0A63 120000   F     1988                                     call    lolevT
                    1989                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0A66 120000   F     1990     right3:                 call    ind
0A69 806A           1991                                     jmp             izmfun
                    1992     
                    1993                             
                    1994                             
0A6B                1995     knright:        
                    1996     
0A6B 79AE           1997                                     mov             r1,#diap
                    1998                             ;перекл диапазон 1 поз вверх сбр массив
0A6D 17             1999                                     dec             @r1
0A6E B7FF04         2000                                     cjne    @r1,#0ffh,diinc
0A71 7700           2001                                     mov             @r1,#0
0A73 8060           2002                                     jmp  izmfun
0A75 120000   F     2003     diinc:                  call     clmassix
0A78 78B3           2004                                     mov             r0,#summa
0A7A 120000   F     2005                                     call    clear4
0A7D 786A           2006                                     mov             r0,#rez_A0
0A7F 120000   F     2007                                     call    clear4  
0A82 120000   F     2008                                     call    loadUS
0A85 804E           2009                                      jmp  izmfun
                    2010     
0A87 200610         2011     knvich:            jb           bitvi11,onvich
0A8A C204           2012                                     clr             bitizm
0A8C D214           2013                                     setb    bitvich
                    2014                                     
0A8E 78B1           2015                                     mov             r0,#vichR
0A90 7611           2016                                     mov             @r0,#11h;;????????or 0
                    2017                                     ;ВЫЧИСЛИТЬ
0A92 900000   F     2018                                     mov     dptr,#teVICH
0A95 120000   F     2019                                     call    lotext
                    2020                               ; call                ind
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    32

0A98 807A           2021                                     jmp              viout;izmpaT
                    2022     
0A9A C214           2023     onvich:                 clr             bitvich
0A9C 78B1           2024                                     mov             r0,#vichR
0A9E 7600           2025                                     mov             @r0,#0
0AA0 8037           2026                                     jmp              izmpaT
                    2027     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0AA2 301820         2028     louizm:            jnb          knizm,lou
0AA5 79AE           2029                                     mov             r1,#diap
0AA7 C3             2030                                     clr             c
0AA8 7403           2031                                     mov             a,#3
0AAA 97             2032                                     subb    a,@r1
0AAB 5006           2033                                     jnc             lldi23    ;10-2..10-5
                    2034                                     ;10-6..10-11
0AAD E584           2035                                     mov             a,p4
0AAF 54F7           2036                                     anl             a,#0f7h   ;d3
0AB1 F584           2037                                     mov             p4,a
0AB3 E7             2038     lldi23:                 mov             a,@r1
0AB4 6403           2039                                     xrl             a,#3
0AB6 7002           2040                                     jnz             lldi3
0AB8 8005           2041                                     jmp             lldi2   ;10-5
0ABA E7             2042     lldi3:                  mov             a,@r1
0ABB 6402           2043                                     xrl             a,#2            ;
0ABD 7006           2044                                     jnz             lou             
0ABF E585           2045     lldi2:                  mov             a,p5            ;10-4
0AC1 4408           2046                                     orl             a,#08
0AC3 F585           2047                                     mov             p5,a
0AC5 22             2048     lou:                    ret
                    2049                               ;;;;;;
0AC6 201807         2050     izman:                  jb              knizm,knizmon
0AC9 D218           2051                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2052                             ;       d3(k5 p4),d3(u5 p5)заслать us
0ACB 120000   F     2053                                     call    louizm 
0ACE 8005           2054                                     jmp             izmfun
0AD0 C218           2055     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0AD2 120000   F     2056                                     call    loadUS;восстановить us
0AD5                2057     izmfun:                 
0AD5 D208           2058                                     setb    bitbuf
0AD7 800E           2059                                     jmp             labelE;;;;;;;;;;;;
                    2060                                     ;;;;;;;;;;;;;;
0AD9                2061     izmpaT:
                    2062     ;;;;;;;;;;;;;;;;;
0AD9 C3             2063                             clr             c
0ADA 79AF           2064                             mov             r1,#parN
                    2065     
0ADC 78AE           2066                             mov             r0,#diap
0ADE 7406           2067                             mov             a,#6            
0AE0 96             2068                             subb    a,@r0
0AE1 5004           2069                             jnc             labelE          ;         ;10-2..10-8
                    2070                               
0AE3 7702           2071                             mov             @r1,#2          ;10-9..10-11            
0AE5 8000           2072                             jmp             labelE
                    2073     
                    2074     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0AE7 789A           2075     labelE:                 mov             r0,#parT
0AE9 793D           2076                                     mov             r1,#chkl
0AEB B60108         2077                                     cjne    @r0,#1,izmt2
0AEE 7700           2078                                     mov             @r1,#0
0AF0 09             2079                                     inc             r1
0AF1 7702           2080                                     mov             @r1,#2
0AF3 020000   F     2081                                     jmp             out6
0AF6 B60208         2082     izmt2:                  cjne    @r0,#2,izmt3
0AF9 7700           2083                                     mov             @r1,#0
0AFB 09             2084                                     inc             r1
0AFC 7714           2085                                     mov             @r1,#20
0AFE 020000   F     2086                                     jmp             out6
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    33

                    2087     
0B01 7700           2088     izmt3:                  mov             @r1,#0
0B03 09             2089                                     inc             r1
0B04 77C8           2090                                     mov             @r1,#200
0B06 020000   F     2091                                     jmp             out6
                    2092     
                    2093     
                    2094     
                    2095     
0B09                2096     knopt: ;кнопка T
0B09 C204           2097                                clr          bitizm
0B0B D210           2098                                setb         bitt2
0B0D 79B7           2099                                mov          r1,#load
0B0F 7704           2100                                mov          @r1,#4;1s
0B11 120000   F     2101                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2102                                
                    2103     
0B14 793D           2104     viout:          mov             r1,#chkl
0B16 7703           2105                             mov             @r1,#03
0B18 09             2106                             inc             r1
0B19 77E8           2107                             mov             @r1,#0e8h               ;1000
0B1B 020000   F     2108                             jmp             out6
                    2109     
0B1E                2110     knrazr:          
0B1E C3             2111     labelC:          clr            c
0B1F 78AF           2112                             mov             r0,#parN
0B21 799A           2113                             mov             r1,#parT
0B23 7402           2114                             mov             a,#2
0B25 97             2115                             subb    a,@r1
0B26 40BF           2116                             jc              labelE          ;T>2
0B28 B60104         2117                             cjne    @r0,#1,noN1c
0B2B 7602           2118                             mov             @r0,#2          ;N=2
0B2D 80B8           2119                             jmp             labelE
                    2120     
0B2F B60207         2121     noN1c:          cjne    @r0,#2,not_1
0B32 B70104         2122                             cjne    @r1,#1,not_1
                    2123                     ;       clr             c
                    2124                     ;       push    rr0
                    2125                     ;       mov             r0,#diap
                    2126                     ;       mov             a,#6            ;10-2..10-8
                    2127                     ;       subb    a,@r0
                    2128                     ;       jc              not_10
                    2129                     ;       pop             rr0         
0B35 7603           2130                             mov             @r0,#3          ;N=3      ;10-2..10-8
0B37 80AE           2131                             jmp             labelE
0B39                2132     not_10:         ;pop            rr0
0B39 7601           2133     not_1:          mov             @r0,#1                          ;N=1
0B3B 80AA           2134                             jmp     labelE
                    2135     
0B3D 020000   F     2136     rtizmri:        jmp             tizmri
0B40                2137     labelf:                 
0B40 301024         2138                             jnb             bitt2,nofizm
0B43 75B0FB         2139                        mov          p3,#0fbh
0B46 E5B0           2140                        mov          a,p3
0B48 20E60F         2141                        jb           acc.6,outF
0B4B 79B7           2142                        mov          r1,#load;parT
0B4D B70503         2143                        cjne         @r1,#5,noft1
                    2144                        ;t=10s
0B50 020000   F     2145                        jmp          out6;ft1izm
                    2146     
0B53 07             2147     noft1:     inc          @r1;dec         @r1
0B54 120000   F     2148     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2149                             ;call   ind
0B57 020000   F     2150                     jmp             out6;??????????????/
                    2151     
                    2152                             ;увеличить счетчик задержки клавиатуры
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    34

0B5A 783D           2153     outF:           mov             r0,#chkl
0B5C 7627           2154                             mov             @r0,#27h
0B5E 08             2155                             inc             r0
0B5F 7610           2156                             mov             @r0,#10h
0B61 020000   F     2157                             jmp             out6;out7
                    2158     
0B64 020000   F     2159     noviR1:         jmp             noviR
0B67 3014FA         2160     nofizm:         jnb             bitvich,noviR1
0B6A 78B1           2161                             mov             r0,#vichR
0B6C B61117         2162                             cjne    @r0,#11h,no11v6
0B6F 7612           2163                             mov             @r0,#12h                ;11= вычислить
0B71 900000   F     2164     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0B74 120000   F     2165                             call    lotext
0B77 80E1           2166                             jmp             outF
                    2167             
                    2168                     
0B79 B61163         2169     nor13:          cjne    @r0,#11h,nor11
0B7C 7612           2170                             mov             @r0,#12h
0B7E 900000   F     2171                             mov             dptr,#teIZMK    ;       изм конст
0B81 120000   F     2172                         call        lotext             
0B84 80D4           2173                             jmp             outF
                    2174     
0B86 B6120A         2175     no11v6:         cjne    @r0,#12h,no12v6
0B89 7613           2176                             mov             @r0,#13h
0B8B 900000   F     2177                             mov             dptr,#teOUT
0B8E 120000   F     2178                             call    lotext
0B91 80C7           2179                             jmp             outF
                    2180                     
0B93 B6130A         2181     no12v6:         cjne    @r0,#13h,no13v6
0B96 7611           2182                             mov             @r0,#11h
0B98 900000   F     2183                             mov             dptr,#teVICH
0B9B 120000   F     2184                             call    lotext
0B9E 80BA           2185                             jmp             outF
                    2186     
                    2187     
0BA0 75B0FB         2188     no13v6:         mov             p3,#0fbh
0BA3 E5B0           2189                             mov             a,p3
0BA5 20E612         2190                             jb              acc.6,chanZ
                    2191                     ;clr            bitmig
0BA8 78B2           2192                             mov             r0,#marker      
0BAA B60905         2193                             cjne    @r0,#9,mark0_8          ;курсор справа ?
0BAD E53A           2194                             mov             a,movleft
0BAF F6             2195                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
0BB0 80A8           2196                             jmp             outF
                    2197     
0BB2 06             2198     mark0_8:        inc             @r0             ;       сдвинуть курсор вправо на 1
0BB3 C219           2199                             clr             bitmig
0BB5 B60A00         2200                             cjne    @r0,#10,outma
0BB8 80A0           2201     outma:          jmp             outF
                    2202     
0BBA 75B0FE         2203     chanZ:          mov             p3,#0feh
0BBD E5B0           2204                             mov             a,p3
0BBF 20E60F         2205                             jb              acc.6,chanma
                    2206                             ;изм знак в старшем разряде на противоположн
0BC2 E543           2207                             mov             a,bufind+3
0BC4 B42B05         2208                             cjne            a,#2bh,noplus
0BC7 75432D         2209                             mov                     bufind+3,#2dh           ;+->-   
0BCA 808E           2210                             jmp             outF
0BCC                2211     noplus:
0BCC 75432B         2212                             mov                     bufind+3,#2bh           ;-/+-
0BCF 8089           2213                             jmp             outF
0BD1 75B0FD         2214     chanma:         mov             p3,#0fdh
0BD4 E5B0           2215                             mov             a,p3
0BD6 20E681         2216                             jb              acc.6,outF;labelL1
                    2217                             ;clr            bitmig
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    35

0BD9 120000   F     2218     labelL1:        call    vvchif  ;увеличить цифру 
                    2219     
0BDC 020000   F     2220                             jmp             outF
                    2221                     
0BDF                2222     nor11:          ;       выход
0BDF 7613           2223                     mov             @r0,#13h  ;12->13
0BE1 900000   F     2224                     mov             dptr,#teOUT
                    2225     ;               jmp             vi1113
                    2226     
                    2227     
                    2228     
0BE4 C206           2229     yesviR:         clr             bitvi11;????????/
0BE6 200C77         2230                             jb              bmem11,labelL
0BE9 020000   F     2231                             jmp             out6;???????//
0BEC 30112A         2232     noviR:          jnb             bitmenu,nbimenu
0BEF 75B0FB         2233                             mov             p3,#0fbh; реж кн меню ->
0BF2 20B610         2234                             jb              p3.6,rnorim6
0BF5 79B0           2235                             mov             r1,#level
0BF7 B7000E         2236                             cjne    @r1,#0,rimen6
0BFA 900000   F     2237                             mov             dptr,#teKALIB
0BFD 120000   F     2238                             call    lotext
0C00 7701           2239                             mov             @r1,#1
0C02 020000   F     2240                             jmp             out6
                    2241     
0C05 020000   F     2242     rnorim6:                jmp             norim6
                    2243     
0C08 900000   F     2244     rimen6:         mov             dptr,#teTEsT
0C0B 120000   F     2245                             call    lotext
0C0E 7700           2246                             mov             @r1,#0
0C10 020000   F     2247                             jmp             out6
                    2248     
0C13 020000   F     2249     moutF:          jmp             outF
                    2250     
0C16 020000   F     2251     rnnmemb:        jmp             nnmemb
0C19 300BFA         2252     nbimenu:        jnb             bitmem,rnnmemb
0C1C 79B0           2253                             mov             r1,#level
0C1E B71113         2254                        cjne         @r1,#11h,nomem11
                    2255                        
0C21 75B0FB         2256                        mov          p3,#0fbh
0C24 E5B0           2257                        mov          a,p3
0C26 20E6EA         2258                        jb           acc.6,moutF
0C29 7712           2259                        mov          @r1,#12h
0C2B 900000   F     2260                        mov          dptr,#teWR
0C2E 120000   F     2261                        call         lotext
0C31 020000   F     2262                        jmp          outF
                    2263     
0C34 B71213         2264     nomem11:   cjne         @r1,#12h,nomem12
0C37 75B0FB         2265                             mov             p3,#0fbh
0C3A E5B0           2266                        mov          a,p3
0C3C 20E6D4         2267                        jb           acc.6,moutF
0C3F 7713           2268                        mov          @r1,#13h
0C41 900000   F     2269                        mov          dptr,#teLIST
0C44 120000   F     2270                        call         lotext
0C47 020000   F     2271                        jmp          outF
0C4A B71313         2272     nomem12:         cjne           @r1,#13h,labelL
0C4D 75B0FB         2273                             mov             p3,#0fbh
0C50 E5B0           2274                        mov          a,p3
0C52 20E6BE         2275                        jb           acc.6,moutF
0C55 7711           2276                        mov          @r1,#11h
0C57 900000   F     2277                        mov          dptr,#teCLE
0C5A 120000   F     2278                        call         lotext
0C5D 020000   F     2279                          jmp                outF
                    2280     
0C60 78B0           2281     labelL:         mov             r0,#level
0C62 B6211B         2282                             cjne    @r0,#21h,labl21
0C65 75B0FB         2283                             mov             p3,#0fbh
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    36

0C68 E5B0           2284                             mov             a,p3
0C6A 20E610         2285                             jb              acc.6,loutF
0C6D B62108         2286                             cjne    @r0,#21h,lal22
0C70 7622           2287                             mov             @r0,#22h
                    2288                             ;БЛОК
0C72 120000   F     2289                             call    lotext
0C75 020000   F     2290                             jmp             outF
0C78 7621           2291     lal22:          mov             @r0,#21h
                    2292                             ;ПОЛНАЯ
0C7A 120000   F     2293                             call    lotext
0C7D 020000   F     2294     loutf:          jmp             outF
                    2295     
0C80 B6211B         2296     labl21:    cjne @r0,#21h,nolev1
0C83 75B0FB         2297                             mov             p3,#0fbh
0C86 E5B0           2298                             mov             a,p3
0C88 20E6F2         2299                             jb              acc.6,loutF
0C8B B62108         2300                             cjne    @r0,#21h,labl22
0C8E 7622           2301                             mov             @r0,#22h
                    2302                             ;БЛОК
0C90 120000   F     2303                             call    lotext
0C93 020000   F     2304                             jmp             outF
0C96 7621           2305     labl22:         mov             @r0,#21h
                    2306                             ;ПОЛНАЯ
0C98 120000   F     2307                             call    lotext
0C9B 020000   F     2308                             jmp             outF
                    2309                      
0C9E B6231A         2310     nolev1:         cjne    @r0,#23h,go31l
0CA1 75B0FB         2311     rigblo:         mov             p3,#0fbh
0CA4 20B61E         2312                             jb              p3.6,llev2
0CA7                2313     labL2:    ; mov         r1,#marker;а  уст курсор в правую позицию 
0CA7 78B2           2314                       mov           r0,#marker      ;курсор справа  ?
0CA9 E53B           2315                             mov             a,movrig
0CAB C3             2316                             clr             c
0CAC 96             2317                             subb    a,@r0
0CAD 6006           2318                             jz         equ1l
0CAF E53B           2319                             mov             a,movrig;уст в правую позицию
0CB1 F6             2320                             mov             @r0,a
0CB2 020000   F     2321                             jmp             outF                                             
0CB5 E53A           2322     equ1l:          mov             a,movleft;уст в левую позицию
0CB7 F6             2323                             mov             @r0,a   
0CB8 020000   F     2324                             jmp             outF
                    2325                     
                    2326     
0CBB B63102         2327     go31l:          cjne    @r0,#31h,go41l
0CBE 80E1           2328                             jmp             rigblo
0CC0 B6410B         2329     go41l:          cjne    @r0,#41h,norig2
0CC3 80DC           2330                             jmp             rigblo
                    2331     
0CC5 75B0FD         2332     llev2:          mov             p3,#0fdh
0CC8 20B6B2         2333                             jb              p3.6,loutF
0CCB 020000   F     2334                             jmp             labelL1
                    2335     
0CCE C3             2336     norig2:    clr          c               ;32,33,34,42
0CCF 7431           2337                             mov             a,#31h
0CD1 96             2338                             subb    a,@r0
0CD2 50A9           2339                             jnc             loutF
0CD4 75B0FB         2340     rigblok:        mov             p3,#0fbh  ;32,33,34,42
0CD7 20B614         2341                             jb              p3.6,lev2go
0CDA 78B2           2342     labelN:         mov             r0,#marker      ;курсор справа  ?
0CDC E53B           2343                             mov             a,movrig
0CDE C3             2344                             clr             c
0CDF 96             2345                             subb    a,@r0
0CE0 7006           2346                             jnz        noequ1
0CE2 E53A           2347                             mov             a,movleft;уст в крайнюю левую позицию
0CE4 F6             2348                             mov             @r0,a
0CE5 020000   F     2349                             jmp             outF
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    37

0CE8 120000   F     2350     noequ1:         call    marri;уст сдвиг в правую        позицию
0CEB 020000   F     2351                             jmp             outF
0CEE 75B0FD         2352     lev2go:         mov             p3,#0fdh
0CF1 30B603         2353                             jnb             p3.6,rlabelL1
0CF4 020000   F     2354                             jmp             outF
                    2355     
0CF7 020000   F     2356     rlabelL1:       jmp             labelL1
0CFA                2357     nnmemb:
0CFA                2358     norim6:    ;kn menu
0CFA D007           2359     out6:                   pop             rr7     
0CFC D006           2360                                     pop             rr6
0CFE D005           2361                                     pop             rr5
0D00 D004           2362                                     pop             rr4
0D02 D003           2363                                     pop             rr3
0D04 D002           2364                                     pop             rr2
0D06 D001           2365                                     pop             rr1                             
0D08 D000           2366                                     pop             rr0
0D0A D0D0           2367                                     pop             psw
0D0C D0E0           2368                                     pop             acc
0D0E 75E730         2369                                mov          EIE2,#30H
0D11 E5AD           2370                                mov          a,P3IF
0D13 54BF           2371                                     anl             a,#0bfh
0D15 F5AD           2372                                     mov             P3IF,a
0D17 75B0C0         2373                                     mov             P3,#0c0h
0D1A 32             2374                             reti
                    2375     
0D1B 020000   F     2376      rknMEM:                        jmp             knMEM
0D1E 020000   F     2377     knKMP:             jmp          out7
0D21 020000   F     2378     rout7:                  jmp             out7    
0D24 020000   F     2379     rlabelH:                jmp             labelH
0D27 020000   F     2380     rknNUL:         jmp             knNUL
0D2A 020000   F     2381     rknleft:                jmp             knleft
0D2D                2382     keyb2:  ;IE7
0D2D 75E700         2383                                     mov             EIE2,#00H
0D30 C0E0           2384                                     push    acc
0D32 C0D0           2385                                     push    psw
0D34 C000           2386                                     push    rr0
0D36 C001           2387                                     push    rr1
0D38 C002           2388                                     push    rr2
0D3A C003           2389                                     push    rr3
0D3C C004           2390                                     push    rr4
0D3E C005           2391                                     push    rr5
0D40 C006           2392                                     push    rr6
0D42 C007           2393                                     push    rr7
                    2394                                     ;mov            IE,#00h
                    2395                       ;;;;;;;;;;;;;;
0D44 120000   F     2396                               call  z_01s   ;0,1s
                    2397                               ;восстан знакоместо при мигании
                    2398                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0D47 78B2           2399                                     mov             r0,#marker
0D49 7440           2400                                     mov             a,#bufind
0D4B 26             2401                                     add             a,@r0                   ;a=bufind+marker
0D4C F9             2402                                     mov             r1,a
0D4D A73C           2403                                     mov             @r1,savba
                    2404                                     ;;;;;;;;;;;
0D4F E5B0           2405                             mov             a,p3
0D51 20E7CD         2406                                     jb              acc.7,rout7
0D54 E5B0           2407                                     mov             a,p3
0D56 74FF           2408                                     mov             a,#0ffh         ; p3.(5-0)<-3f
0D58 F5B0           2409                                     mov             p3,a
0D5A E5B0           2410                                     mov             a,p3
0D5C 30E7C2         2411                                     jnb             acc.7,rout7             ;error
0D5F 3004C2         2412                                     jnb             bitizm,rlabelH
0D62 75B0FE         2413                                     mov             p3,#0feh                ;реж IZM
0D65 E5B0           2414                                     mov             a,p3
0D67 30E7BD         2415                                     jnb             acc.7,rknNUL
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    38

0D6A 75B0FD         2416                                     mov             p3,#0fdh
0D6D E5B0           2417                                     mov             a,p3
0D6F 30E7AC         2418                                     jnb             acc.7,knKMP
0D72 75B0FB         2419                                     mov             p3,#0fbh
0D75 E5B0           2420                                     mov             a,p3
0D77 30E7B0         2421                                     jnb             acc.7,rknleft
0D7A 75B0F7         2422                                     mov             p3,#0f7h
0D7D E5B0           2423                                     mov             a,p3
0D7F 30E74E         2424                                     jnb             acc.7,knAVP
0D82 75B0EF         2425                                 mov         p3,#0efh
0D85 E5B0           2426                                     mov             a,p3
0D87 30E791         2427                                     jnb             acc.7,rknMEM
0D8A 75B0DF         2428                                     mov             p3,#0dfh
0D8D E5B0           2429                                     mov             a,p3    
0D8F 30E72E         2430                                     jnb             acc.7,knmenu
0D92                2431     an_t7:             ;;;;;;;;;;;;
                    2432                     
0D92 C3             2433                             clr             c
0D93 79AF           2434                             mov             r1,#parN
                    2435     
0D95 78AE           2436                             mov             r0,#diap
0D97 7406           2437                             mov             a,#6            
0D99 96             2438                             subb    a,@r0
0D9A 5002           2439                             jnc             goto7           ;         ;10-2..10-8
                    2440                               
0D9C 7702           2441                             mov             @r1,#2          ;10-9..10-11            
                    2442                             
                    2443                             ;;;;;;;;;;;;
0D9E 799A           2444     goto7:                  mov             r1,#parT
0DA0 783D           2445                                     mov             r0,#chkl
0DA2 B70108         2446                                     cjne    @r1,#1,not1_7
0DA5 7600           2447                                     mov             @r0,#00
0DA7 08             2448                                     inc             r0
0DA8 7602           2449                                     mov             @r0,#2
0DAA 020000   F     2450                                     jmp             out7
                    2451                             
                    2452     
0DAD B70208         2453     not1_7:                 cjne    @r1,#2,not2_7
0DB0 760E           2454                                     mov             @r0,#0eh;00
0DB2 08             2455                                     inc             r0
0DB3 7638           2456                                     mov             @r0,#38h;20
0DB5 020000   F     2457                                     jmp             out7
0DB8 7600           2458     not2_7:                 mov             @r0,#00
0DBA 08             2459                                     inc             r0
0DBB 76C8           2460                                     mov             @r0,#200
0DBD 020000   F     2461                                     jmp             out7
                    2462     
                    2463     
0DC0 C204           2464     knmenu:                  clr            bitizm          ;off IZM
0DC2 D211           2465                                     setb            bitmenu
0DC4 900000   F     2466                                     mov             dptr,#teMENU    ;в буф2 записать ТЕСТ-ИЗМЕР
0DC7 120000   F     2467                                     call    lotext
0DCA 120000   F     2468                                     call    ind;???????/
0DCD 020000   F     2469                                     jmp             onmem11
                    2470     
0DD0 200505         2471     knAVP:                  jb              bitavp,meavp
0DD3 D205           2472                                     setb    bitavp
0DD5 020000   F     2473                                     jmp             onmem11
0DD8 C205           2474     meavp:                  clr             bitavp
0DDA 020000   F     2475                                     jmp             onmem11
                    2476     
0DDD 79AE           2477     knleft:            mov          r1,#diap
0DDF 07             2478                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
0DE0 B70A03         2479                                     cjne    @r1,#0ah,nodi6
0DE3 17             2480                                     dec             @r1
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    39

0DE4 80AC           2481                                     jmp             an_t7
                    2482     
0DE6                2483     nodi6:             ;    cjne    @r1,#0,an_t7
0DE6 120000   F     2484                                      call    clmassix
0DE9 78B3           2485                                     mov             r0,#summa
0DEB 120000   F     2486                                     call    clear4  
0DEE 786A           2487                                     mov             r0,#rez_A0
0DF0 120000   F     2488                                     call    clear4  
0DF3 120000   F     2489                                     call    loadUS
0DF6 809A           2490                                jmp          an_t7
                    2491     
0DF8 200F0E         2492     knNUL:                  jb              bitnul,ybnul
0DFB D20F           2493                                     setb    bitnul
0DFD 789C           2494                                     mov             r0,#rez_A3      ;A3
0DFF 120000   F     2495                                     call    resar2
0E02 786A           2496                                     mov             r0,#rez_A0      
0E04 120000   F     2497                                     call    saver2;A0<-A3
0E07 8095           2498                                     jmp             goto7;an_t7
                    2499     
0E09 C20F           2500     ybnul:                  clr             bitnul
0E0B 900000   F     2501                                      mov    DPTR,#ch0 
0E0E 120000   F     2502                                     CALL   ldc_long          ; r2..r5 <-- 0
0E11 786A           2503                                     mov             r0,#rez_A0      ;A0=0
0E13 120000   F     2504                                     call    saver2
0E16 8086           2505                                     jmp             goto7;an_t7
                    2506     
0E18 30101E         2507     labelH:                 jnb             bitt2,nolah
0E1B 75B0FB         2508                                     mov             p3,#0fbh   ;вход в режим изм Т
0E1E 79B7           2509                                     mov             r1,#load;parT
0E20 20B70D         2510                                     jb              p3.7,rhnot1
0E23 B70003         2511                                     cjne    @r1,#0,inct;
0E26 020000   F     2512                                     jmp             out7;hyest6
0E29 17             2513     inct:                   dec             @r1                     ;Tизм+1
                    2514                             
0E2A 120000   F     2515                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
0E2D                2516     hnot2:          ;       call    ind
0E2D 020000   F     2517                                     jmp             out7
                    2518     
0E30 020000   F     2519      rhnot1:                jmp             hnot1
                    2520      ;rnoviR:       jmp             noviR
0E33 020000   F     2521      rlabelK:       jmp             labelK
0E36 020000   F     2522      rlabelI:       jmp             labelI          
                    2523      ;;;;;;;;;;;;;;;;;;;
0E39 3014F7         2524     nolah:          jnb             bitvich,rlabelK 
                    2525                             ;;;;;;
                    2526                             ;увеличить счетчик задержки клавиатуры
                    2527                     ;;              mov             r0,#chkl
                    2528                     ;;              mov             @r0,#27h
                    2529                     ;;              inc             r0
                    2530                     ;;              mov             @r0,#10h
                    2531                             ;;;;;;
                    2532     
0E3C 78B1           2533                             mov             r0,#vichR
0E3E B6115D         2534                             cjne    @r0,#11h,hnor11;rlabelI;;
0E41 75B0FB         2535                             mov             p3,#0fbh   ;<-
0E44 20B722         2536                             jb              p3.7,noh37;routF
0E47 B6110B         2537                     cjne    @r0,#11h,hr12
0E4A 7613           2538                             mov             @r0,#13h        ;11= вычислить
0E4C 900000   F     2539                             mov             dptr,#teOUT;teVICH
0E4F 120000   F     2540     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
0E52 020000   F     2541                             jmp             goto7;outF
0E55 B61207         2542     hr12:           cjne    @r0,#12h,hnor12
0E58 7611           2543     lovich:         mov             @r0,#11h
0E5A 900000   F     2544                             mov             dptr,#teVICH
0E5D 80F0           2545                             jmp             hvi1113         
0E5F B6133C         2546     hnor12:         cjne    @r0,#13h,hnor11
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    40

0E62 7612           2547     loizmk:         mov             @r0,#12h
0E64 900000   F     2548                             mov             dptr,#teIZMK    ;       изм конст
                    2549                                        
0E67 80E6           2550                             jmp             hvi1113
                    2551     
0E69 75B0F7         2552     noh37:          mov             p3,#0f7h
0E6C 20B707         2553                             jb              p3.7,routF
0E6F B61139         2554                             cjne    @r0,#11h,vvizko
0E72 D214           2555                             setb    bitvich    ;нажат ввод ВЫЧИСЛИТЬ
0E74 D204           2556                             setb    bitizm
0E76 020000   F     2557     routF:          jmp             goto7;outF
                    2558     ;
0E79 B6120A         2559     norr11:         cjne    @r0,#12h,norr12
0E7C 75B0FB         2560                             mov             p3,#0fbh   ;<-
0E7F 20B7E7         2561                             jb              p3.7,noh37;routF
0E82 760B           2562                             mov             @r0,#11;12->11
0E84 80D2           2563                             jmp             lovich
                    2564     
0E86 B613AD         2565     norr12:         cjne    @r0,#13h,rlabelI
0E89 75B0FB         2566                             mov             p3,#0fbh   ;<-
0E8C 20B7DA         2567                             jb              p3.7,noh37
0E8F 7612           2568                             mov             @r0,#12h
0E91 80CF           2569                             jmp             loizmk
                    2570                             ;;;;
0E93 C214           2571     clrvich:                clr             bitvich
0E95 D204           2572                             setb    bitizm
0E97 A8B2           2573                             mov             r0,marker
0E99 76FF           2574                             mov             @r0,#0ffh
0E9B 020000   F     2575                              jmp    goto7;  routF
                    2576     
                    2577      ;ввод изм конст
0E9E B612E5         2578     hnor11:         cjne    @r0,#12h,norr12;clrvich
0EA1 75B0FB         2579                              mov            p3,#0fbh   
0EA4 20B7C2         2580                             jb              p3.7,noh37;lovich;;изм конст <-  выч
0EA7 7611           2581                             mov             @r0,#11h
0EA9 80AD           2582                             jmp             lovich
                    2583     
0EAB 78B1           2584     vvizko:         mov             r0,#vichR
0EAD E6             2585                             mov             a,@r0
                    2586                     ;       cjne    @r0,#12h,clrvich
0EAE B412E2         2587                             cjne    a,#12h,clrvich
0EB1 7621           2588                             mov             @r0,#21h                ;изм конст->a=+0000     (vv
                             od)
0EB3 78B2           2589                             mov             r0,#marker
0EB5 7603           2590                             mov             @r0,#3;9
0EB7 753A03         2591                             mov             movleft,#3
0EBA 900000   F     2592                             mov             dptr,#teAequ0
0EBD 120000   F     2593                             call    lotext
0EC0 020000   F     2594                             jmp             goto7;routF
                    2595     ;hnor13:                jmp             hnor12          
0EC3 B6210C         2596     izchi:          cjne    @r0,#21h,tlabelI
                    2597     ;<- при вводе цифр А                            
                    2598                     ;        mov            p3,#0fbh   
                    2599                     ;       jnb             p3.7,li21
                    2600             ;clr            bitmig
0EC6 78B2           2601                             mov             r0,#marker
0EC8 16             2602                             dec             @r0
0EC9 B60201         2603                             cjne    @r0,#2,li21
0ECC 06             2604                             inc             @r0;marker=3 +/-
0ECD C219           2605     li21:           clr             bitmig
0ECF 020000   F     2606                             jmp             goto7;outF
                    2607     
0ED2 020000   F     2608     tlabelI:        jmp             labelI
                    2609     
                    2610     ;                       load    0 1 2 3 4 5             
0ED5 06050403       2611     sootv:          db              6,5,4,3,2,1;parT
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    41

0ED9 0201                    
                    2612     ;
                    2613     
                    2614     ;нажата кн ввод при наборе Т
0EDB 75B0F7         2615     hnot1:                  mov             p3,#0f7h
0EDE 20B795         2616                                     jb              p3.7,routF;out7
0EE1 B7053E         2617                                     cjne    @r1,#5,nohnot1  ;r1=load
0EE4 794A           2618                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
0EE6 E7             2619                                     mov             a,@r1
0EE7 4440           2620                                     orl             a,#40h;.6
0EE9 F7             2621                                     mov             @r1,a
0EEA 8000           2622                                     jmp             loadb
                    2623                                     
                    2624                                     
0EEC 789A           2625     loadB:                  mov             r0,#parT
0EEE 900000   F     2626                                     mov             dptr,#sootv
0EF1 79B7           2627                                     mov             r1,#load                
0EF3 E7             2628                                     mov             a,@r1;load
0EF4 93             2629                                     movc    a,@a+dptr
0EF5 F6             2630                                     mov             @r0,a
0EF6 120000   F     2631                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    2632                                      ;r4=b1 r5=b2
0EF9 120000   F     2633                                     call    iniacp;инициализация АЦП
0EFC 120000   F     2634                                     call    loadUS
0EFF D204           2635                                     setb    bitizm
0F01 C210           2636                                     clr             bitt2
0F03 C3             2637                                      clr            c
0F04 789A           2638                                  mov                r0,#parT
0F06 79AF           2639                                      mov            r1,#parN
0F08 7402           2640                                  mov                a,#2
0F0A 96             2641                                 subb                a,@r0
0F0B 5005           2642                                 jnc                 loadB2
0F0D 7701           2643                                     mov             @r1,#1;N=1         ;T>=2
0F0F 020000   F     2644     bout7:                  jmp             goto7;out7
                    2645     
0F12 B702FA         2646     loadB2:                 cjne    @r1,#2,bout7
0F15 7702           2647                                     mov             @r1,#2;N=2
0F17 020000   F     2648                                     jmp             goto7;out7
0F1A                2649     nohnot2:                ;в буфере 1 зажечь <=0,1s
0F1A 794A           2650                                     mov             r1,#bufind+10
0F1C E7             2651                                     mov             a,@r1
0F1D 4410           2652                                     orl             a,#10h;.4
0F1F F7             2653                                     mov             @r1,a
0F20 80CA           2654                                     jmp             loadB
0F22 B704F5         2655     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
0F25 794A           2656                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
0F27 E7             2657                                     mov             a,@r1
0F28 4420           2658                                     orl             a,#20h;.5
0F2A F7             2659                                     mov             @r1,a
0F2B 80BF           2660                                     jmp             loadB
                    2661     
                    2662     ;кнопка ПАМЯТЬ
0F2D C204           2663     knMEM:                  clr             bitizm          ;off IZM
0F2F 900000   F     2664                                     mov             dptr,#teCLE
0F32 120000   F     2665                                     call    lotext    ;в буф2 записать ОЧИСТКА
0F35 D20B           2666                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
0F37 78B0           2667                                     mov             r0,#level
0F39 7611           2668                                     mov             @r0,#11h
0F3B 783D           2669     onmem11:                mov             r0,#chkl
0F3D 7603           2670                                     mov             @r0,#03
0F3F 08             2671                                     inc             r0
0F40 76E8           2672                                     mov             @r0,#0e8h               ;1000
0F42 020000   F     2673                                     jmp             goto7;out7
                    2674     
0F45 020000   F     2675     rnomemk:                jmp             nomemk          ;
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    42

0F48                2676     labelK:
                    2677     ;;;;;;;;;;;;
                    2678     ;                               jnb             bitmenu,nomenu
                    2679     ;                               mov             p3,#0fbh
                    2680     ;                               mov             r1,#level
                    2681     ;                               jb              p3.7,vvmenu
                    2682                     
                    2683     
                    2684     ;nomenu:                        mov             p3,#0f7h;0efh;0f7h;vvod
                    2685     ;                               jb              p3.7,novvmn
                    2686     ;vvmenu:;ввод меню  (тест-калибровка)
                    2687     ;                               mov             dptr,#teTEST;тест
                    2688     ;                               call    lotext
                    2689     ;                               mov             @r1,#2
                    2690     ;                               jmp             out7
                    2691     ;novvmn:                        mov             p3,#0efh
                    2692     ;                               jb              p3.7,rimenu
                    2693                             
                    2694     ;                               jmp             out7
                    2695     
                    2696      ;rimenu:
                    2697     ;;;;;;;;;;;;
0F48 300BFA         2698                               jnb           bitmem,rnomemk
0F4B 78B0           2699                               mov           r0,#level
0F4D B61132         2700                               cjne          @r0,#11h,klev1;nome11
0F50 75B0FB         2701     lefmem11:         mov           p3,#0fbh
0F53 E5B0           2702                               mov           a,p3
0F55 20E70E         2703                               jb            acc.7,rkvvod0
0F58 B6110E         2704                               cjne          @r0,#11h,locle          ;<-memory
0F5B 7613           2705                               mov           @r0,#13h
0F5D 900000   F     2706     lolist:           mov           dptr,#teLIST
0F60 120000   F     2707                               call          lotext           ;ПРОСМОТР
0F63 020000   F     2708                               jmp   goto7;  outF
                    2709     
0F66 020000   F     2710     rkvvod0:        jmp             kvvod0
                    2711     
                    2712     
0F69 B6120B         2713     locle:          cjne            @r0,#12h,lowr           ;<-memory
0F6C 7611           2714                               mov           @r0,#11h                   ;ОЧИСТКА
0F6E 900000   F     2715     loadcle:          mov           dptr,#teCLE
0F71 120000   F     2716                               call          lotext
0F74 020000   F     2717                               jmp           goto7;outF
0F77 7612           2718      lowr:          mov             @r0,#12h
0F79 900000   F     2719      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
0F7C 120000   F     2720                             call    lotext
0F7F 020000   F     2721                             jmp             goto7;outF
0F82 B61202         2722      klev1:          cjne   @r0,#12h,klev2
0F85 80C9           2723                             jmp             lefmem11
0F87 B61302         2724     klev2:           cjne   @r0,#13h,klev22   ;11-13 нет
0F8A 80C4           2725                             jmp             lefmem11
                    2726     
                    2727     ;<- vvod на более низких уровнях
0F8C B62114         2728     klev22:         cjne    @r0,#21h,klev21
0F8F 75B0FB         2729     lev220:         mov             p3,#0fbh
0F92 20B72C         2730                             jb              p3.7,kgo23
0F95 B6213D         2731                             cjne    @r0,#21h,kfull
0F98 7622           2732                             mov             @r0,#22h
0F9A 900000   F     2733                             mov             dptr,#teBL
0F9D 120000   F     2734                             call    lotext
0FA0 020000   F     2735                             jmp             goto7;outF
                    2736                                     
0FA3 B62205         2737     klev21:         cjne    @r0,#22h,klev23
0FA6 80E7           2738                             jmp             lev220
                    2739     
0FA8 020000   F     2740     rlabL2:         jmp             labL2
                    2741     
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    43

0FAB B62376         2742     klev23:          cjne   @r0,#23h,labM
0FAE 75B0FB         2743                              mov    p3,#0fbh
0FB1 20B7F4         2744                              jb             p3.7,rlabL2
0FB4 75B0F7         2745                              mov    p3,#0f7h
0FB7 20B748         2746                              jb             p3.7,ddoutf
                    2747                              ;очистить блок памяти с набранным номером
0FBA C20B           2748                              clr    bitmem  ;сбр признак памяти 
0FBC D204           2749                              setb   bitizm
0FBE 020000   F     2750                              jmp    goto7;outF
                    2751                             
0FC1 75B0F7         2752     kgo23:           mov    p3,#0f7h
0FC4 20B73B         2753                             jb              p3.7,ddoutf
0FC7 B62107         2754                             cjne    @r0,#21h,go23no
                    2755                             ;очистить память
0FCA C20B           2756                             clr             bitmem
0FCC D204           2757                             setb    bitizm
0FCE 020000   F     2758                             jmp             goto7;outF
                    2759     
0FD1 7623           2760     go23no:    mov          @r0,#23h
0FD3 8035           2761                             jmp             loblok;БЛОК 00
                    2762     
0FD5 7621           2763     kfull:          mov             @r0,#21h
0FD7 8023           2764                             jmp             gofull          
0FD9                2765     nomemk:
0FD9 020000   F     2766                                     jmp             goto7;outF
                    2767                                     ;;;;;;;;;;
0FDC 75B0FB         2768     nome11:           mov           p3,#0fbh
0FDF E5B0           2769                               mov           a,p3
0FE1 20E70B         2770                               jb            acc.7,kvvod0
0FE4 B61204         2771                               cjne          @r0,#12h,mem12no        
0FE7 7611           2772                               mov           @r0,#11h                ;ОЧИСТКА
0FE9 8083           2773                               jmp            loadcle
                    2774     
0FEB                2775     mem12no:        ;cjne           @r0,#13h,lowr           
0FEB 7612           2776                               mov           @r0,#12h                   ;
0FED 808A           2777                               jmp           lowr1                     ;ЗАПИСЬ
                    2778     
0FEF 75B0F7         2779     kvvod0:           mov           p3,#0f7h
0FF2 20B70D         2780                               jb            p3.7,ddoutf
0FF5 78B0           2781                               mov           r0,#level
0FF7 B6110B         2782                               cjne          @r0,#11h,mvv11
0FFA 7621           2783                               mov           @r0,#21h                ;ПОЛНАЯ
0FFC 900000   F     2784     gofull:           mov           dptr,#teFULL
0FFF 120000   F     2785                               call          lotext
1002 020000   F     2786     ddoutf:                 jmp             goto7;outF
                    2787     
1005 B61215         2788     mvv11:            cjne          @r0,#12h,mvv12
1008 7631           2789                                     mov             @r0,#31h
100A 900000   F     2790     loblok:                 mov             dptr,#teBLOK;БЛОК 00
100D 120000   F     2791                                     call    lotext
1010 78B2           2792                                     mov             r0,#marker
1012 7607           2793                                     mov             @r0,#7
1014 753B08         2794                                     mov             movrig,#8
1017 753A07         2795                                     mov             movleft,#7
101A 020000   F     2796                                     jmp             goto7;outF
101D 7641           2797     mvv12:                  mov             @r0,#41h                ; БЛОК 00
101F 80E9           2798                                     jmp             loblok
                    2799     
                    2800     
                    2801     
1021 020000   F     2802     mlabL2:         jmp             labL2
                    2803     
1024 B63137         2804     labM:                   cjne    @r0,#31h,nom31
1027 75B0FB         2805                                     mov             p3,#0fbh
102A 30B7F4         2806                                     jnb             p3.7,mlabL2
102D 75B0F7         2807                                mov          p3,#0f7h
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    44

1030 20B7CF         2808                                jb           p3.7,ddoutf
                    2809                                
1033 7632           2810                                mov          @r0,#32h
                    2811                                     ;       считать с индикатора  
1035 7F0A           2812                                     mov             r7,#10
1037 7853           2813                                     mov             r0,#adec
1039 120000   F     2814                                     call    clearN
103C 120000   F     2815                                     call    upak2                   
103F 784F           2816                                     mov             r0,#abin
1041 7953           2817                                     mov             r1,#adec                        ;мл        
                              ст
1043 120000   F     2818                                     call    decbin                  ;abin..abin+3 (hex)
                    2819                                     ;call   loadr2                  ;r2..r5
                    2820                                     ;call   altof                   ;r2..r5->int
1046 78C4           2821                                mov          r0,#nblok       ;   сохранить
1048 E54F           2822                                mov          a,abin          ;;мл
104A F6             2823                                mov          @r0,a
104B 900000   F     2824                                mov          dptr,#tebBL;НАЧ БЛОК 000
104E 120000   F     2825                                call         lotext
1051 78B2           2826                                mov          r0,#marker
1053 7607           2827                                mov          @r0,#7
1055 753B09         2828                                mov          movrig,#9
1058 753A07         2829                                mov          movleft,#7
105B 020000   F     2830     rgoto7:            jmp     goto7;outF
                    2831     
105E B6324C         2832     nom31:             cjne         @r0,#32h,nom32
1061 75B0FB         2833                                     mov             p3,#0fbh
1064 20B714         2834                                     jb              p3.7,no31n
                    2835                                     
1067 78B2           2836     lefcur:         mov             r0,#marker      ;курсор слева?
1069 E53A           2837                             mov             a,movleft
106B C3             2838                             clr             c
106C 96             2839                             subb    a,@r0
106D 7006           2840                             jnz        noequ2
106F E53B           2841                             mov             a,movrig
1071 F6             2842                             mov             @r0,a;уст в крайнюю правую позицию
1072 020000   F     2843                             jmp             goto7
1075 120000   F     2844     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
1078 020000   F     2845                             jmp        goto7
                    2846                                     
107B 75B0F7         2847     no31n:             mov          p3,#0f7h
107E 20B7DA         2848                                     jb              p3.7,rgoto7
1081 7633           2849                                     mov             @r0,#33h
                    2850                                     ;запомнить номер ячейки блока
1083 7F0A           2851                                             mov             r7,#10
1085 7853           2852                                     mov             r0,#adec
1087 120000   F     2853                                     call    clearN
108A 120000   F     2854                                     call    upak3                   
108D 784F           2855                                     mov             r0,#abin
108F 7953           2856                                     mov             r1,#adec                        ;мл        
                              ст
1091 120000   F     2857                                     call    decbin                  ;abin..abin+3 (hex)
1094 120000   F     2858                                     call    loadr2                  ;r2..r5
1097 120402         2859                                     call    altof                   ;r2..r5->int
                    2860     
109A 900000   F     2861                                      mov            dptr,#teeBL;КОН БЛОК 000
109D 120000   F     2862                                call         lotext
10A0 78B2           2863                                mov          r0,#marker
10A2 7607           2864                                mov          @r0,#7
10A4 753B09         2865                                mov          movrig,#9
10A7 753A07         2866                                mov          movleft,#7
10AA 020000   F     2867                                jmp     goto7;
                    2868     
                    2869     
10AD B63328         2870     nom32:           cjne           @r0,#33h,nom33
10B0 75B0FB         2871                              mov            p3,#0fbh
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    45

10B3 30B7B1         2872                              jnb            p3.7,lefcur
10B6 75B0F7         2873                              mov            p3,#0f7h
10B9 20B79F         2874                              jb             p3.7,rgoto7
                    2875                              ;запомнить номер ячейки конца блока
10BC 7634           2876                              mov    @r0,#34h
10BE 7F0A           2877     INTn:                   mov             r7,#10
10C0 7853           2878                                     mov             r0,#adec
10C2 120000   F     2879                                     call    clearN
10C5 120000   F     2880                                     call    upak3                   
10C8 784F           2881                                     mov             r0,#abin
10CA 7953           2882                                     mov             r1,#adec                        ;мл        
                              ст
10CC 120000   F     2883                                     call    decbin                  ;abin..abin+3 (hex)
10CF 120000   F     2884                                     call    loadr2                  ;r2..r5
10D2 120402         2885                                     call    altof                   ;r2..r5->int
10D5 020000   F     2886     dgoto7:                  jmp            goto7
                    2887     
10D8 B63415         2888     nom33:          cjne            @r0,#34h,labelP
10DB 75B0FB         2889                               mov           p3,#0fbh
10DE 30B786         2890                              jnb            p3.7,lefcur
10E1 75B0F7         2891                              mov            p3,#0f7h
10E4 20B7EE         2892                              jb             p3.7,dgoto7
10E7 76FF           2893                              mov            @r0,#0ffh
                    2894                              ;T1<-число на индикаторе
10E9 C20B           2895                              clr            bitmem            ;vvod КОН БЛ 000
10EB D204           2896                              setb           bitizm
                    2897                                     
10ED 020000   F     2898                             jmp        goto7
10F0                2899     labelP:                                                         
                    2900     ;;;;;;;
10F0                2901     labelI:
10F0 75B0FE         2902                                     mov             p3,#0feh
10F3 E5B0           2903                                     mov             a,p3
10F5 20E703         2904                                     jb              acc.7,nopoint
                    2905                                     ;
10F8 020000   F     2906                                     jmp             goto7;out7
10FB 75B0FB         2907     nopoint:                mov             p3,#0fbh
10FE E5B0           2908                                     mov             a,p3
1100 20E711         2909                                     jb              acc.7,nopoin7
1103 78B2           2910                                     mov             r0,#marker
1105 B60305         2911                                     cjne    @r0,#3,nomarl;26
1108 7609           2912                                     mov             @r0,#9
110A 020000   F     2913                                     jmp             goto7;  out7
                    2914     
110D 16             2915     nomarl:                 dec             @r0                             ;нажата кн <- при в
                             воде цифр A=000000
110E C219           2916                                     clr             bitmig
1110 B60253         2917                                     cjne    @r0,#2,out7;26
1113 06             2918                                     inc             @r0
                    2919     ;нажат ввод А =000000 запомнить константу А
1114 75B0F7         2920     nopoin7:           mov          p3,#0f7h
1117 E5B0           2921                                     mov             a,p3
1119 20E74A         2922                                     jb              acc.7,out7
111C 78B1           2923                                     mov             r0,#vichR
111E E6             2924                                     mov             a,@r0
111F B62124         2925                                     cjne    @r0,#21h,no21p7
1122 7631           2926                                     mov             @r0,#31h
                    2927                             ;       считать с индикатора  упаковать в плавающий формат
                    2928                             ;   сохранить
1124 120000   F     2929                                     call    upak                    
1127 784F           2930                                     mov             r0,#abin
1129 7953           2931                                     mov             r1,#adec                        ;мл        
                              ст
112B 120000   F     2932                                     call    decbin                  ;abin..abin+3 (hex)
112E 120000   F     2933                                     call    loadr2                  ;r2..r5
1131 120402         2934                                     call    altof                   ;r2..r5->int
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    46

1134 78BC           2935                                     mov             r0,#konstA
1136 120000   F     2936                                     call    saver2
                    2937     ;26
1139 78B2           2938                                     mov             r0,#marker
113B 7603           2939                                     mov             @r0,#3
113D 900000   F     2940                                     mov             dptr,#teBequ0
1140 120000   F     2941                                     call    lotext
                    2942                                     
1143 020000   F     2943                                     jmp             goto7;out7
                    2944     
1146                2945     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    2946                             ;   сохранить
1146 120000   F     2947                                     call    upak                    
1149 784F           2948                                     mov             r0,#abin
114B 7953           2949                                     mov             r1,#adec                        ;мл        
                              ст
114D 120000   F     2950                                     call    decbin                  ;abin..abin+3 (hex)
1150 120000   F     2951                                     call    loadr2                  ;r2..r5
1153 120402         2952                                     call    altof                   ;r2..r5->int
1156 78C0           2953                                     mov             r0,#konstB
1158 120000   F     2954                                     call    saver2
                    2955     
115B 79B2           2956                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
115D 77FF           2957                                     mov             @r1,#0ffh
115F 78B1           2958                                     mov             r0,#vichR
1161 7611           2959                                     mov             @r0,#11h
1163 020000   F     2960                                jmp          lovich     ;ВЫЧИСЛИТЬ
                    2961     
                    2962     
1166                2963     out7:                   ;mov            IE,#80h
1166 D007           2964                                     pop             rr7     
1168 D006           2965                                     pop             rr6
116A D005           2966                                     pop             rr5
116C D004           2967                                     pop             rr4
116E D003           2968                                     pop             rr3
1170 D002           2969                                     pop             rr2
1172 D001           2970                                     pop             rr1                             
1174 D000           2971                                     pop             rr0
1176 D0D0           2972                                     pop             psw
1178 D0E0           2973                                     pop             acc
117A E5AD           2974                                     mov             a,P3IF
117C 547F           2975                                     anl             a,#7fh
117E F5AD           2976                                     mov             P3IF,a
1180 75B0C0         2977                                     mov             P3,#0c0h
1183 75E730         2978                                     mov             EIE2,#30H
1186 32             2979                                     reti
                    2980     
1187 79AE           2981     loadUS:         mov             r1,#diap
1189 E7             2982                             mov             a,@r1
118A 23             2983                             rl              a;*2
118B FC             2984                             mov             r4,a                    ;save a
118C 900000   F     2985                             mov             dptr,#tabus
118F 93             2986                             movc    a,@a+dptr
1190 FA             2987                             mov             r2,a                    ;high byte
1191 E584           2988                             mov             a,p4
1193 5401           2989                             anl             a,#01
1195 4A             2990                             orl             a,r2
1196 F584           2991                             mov             p4,a
1198 0C             2992                             inc             r4
1199 EC             2993                             mov             a,r4
119A 93             2994                             movc    a,@a+dptr
119B FB             2995                             mov             r3,a                    ;low byte
119C E585           2996                             mov             a,p5
119E 5401           2997                             anl             a,#01
11A0 4B             2998                             orl             a,r3
11A1 F585           2999                             mov             p5,a
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    47

11A3 799A           3000                             mov             r1,#parT
11A5 B7010E         3001                             cjne    @r1,#1,bret
11A8 79AE           3002                             mov             r1,#diap                  ;10s (parT=1)
11AA 7405           3003                             mov             a,#5                      ;10-8..10-11 p4.1=1
11AC C3             3004                             clr             c
11AD 97             3005                             subb    a,@r1
11AE 5006           3006                             jnc             bret
11B0 E584           3007                             mov             a,p4
11B2 4402           3008                             orl             a,#02
11B4 F584           3009                             mov             p4,a                     ;10-8..10-11 p4.1=1
11B6 120000   F     3010     bret:      call          louizm         ;us если вкл кн ИЗМЕР
11B9 22             3011                             ret
                    3012     
                    3013                             
                    3014     ;загр ус для кор 0,тестов ацп и т.д.
                    3015     ;dptr-
11BA E4             3016     lospus:         clr             a
                    3017                             ;movc   a,@a+dptr
                    3018                             ;mov            r2,a                    ;high byte
                    3019                             ;mov            a,p4
                    3020                             ;anl            a,#01
                    3021                             ;orl            a,r2
                    3022                             ;mov            p4,a
                    3023                             ;inc            dptr
11BB E4             3024                             clr             a
11BC 93             3025                             movc    a,@a+dptr
11BD FB             3026                             mov             r3,a                    ;low byte
11BE E585           3027                             mov             a,p5
11C0 54BF           3028                             anl             a,#0bfh;01
11C2 4B             3029                             orl             a,r3
11C3 F585           3030                             mov             p5,a
11C5 22             3031                             ret
                    3032     
11C6 80             3033     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                    3034     
                    3035     ;us кнопка измерения выкл
11C7 88D6           3036     tabus:     db           88h,0d6h         ;10-2
11C9 88F6           3037                             db      88h,0f6h         ;10-3
11CB 88D6           3038                             db              88h,0d6h         ;10-4
11CD 88F6           3039                             db              88h,0f6h         ;10-5
11CF 9AD6           3040                             db      9ah,0d6h         ;10-6
11D1 9AF6           3041                             db              9ah,0f6h         ;10-7
11D3 ACD6           3042                             db              0ach,0d6h        ;10-8
11D5 ACF6           3043                             db      0ach,0f6h        ;10-9
11D7 C8D6           3044                             db              0c8h,0d6h        ;10-10
11D9 C8F6           3045                             db              0c8h,0f6h        ;10-11
                    3046     
                    3047     
                    3048      ;загрузка текста в буфер 2 bufind+0..bufind9
                    3049     ;в зав от parT (Tизм)
11DB 79B7           3050     loadT:          mov             r1,#load;parT
11DD 7840           3051     lolevT:         mov             r0,#bufind+0
11DF 7B0A           3052                             mov             r3,#10
11E1 75F00A         3053                             mov             b,#10
11E4 E7             3054                             mov             a,@r1
11E5 A4             3055                             mul             ab
11E6 FC             3056                             mov             r4,a                    ;save a
11E7 900000   F     3057                             mov             dptr,#textT
11EA 93             3058             lod1:   movc    a,@a+dptr
11EB F6             3059                             mov             @r0,a
11EC 08             3060                             inc             r0
11ED 0C             3061                             inc             r4
11EE EC             3062                             mov             a,r4
11EF DBF9           3063                             djnz    r3,lod1
11F1 22             3064                             ret     
                    3065     ;загрузка текста в буфер 2 bufind+0..bufind9                    
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    48

                    3066     ;dptr-адр строки текста         
11F2                3067     lotext:         
11F2 7B0A           3068                             mov             r3,#10
11F4 7840           3069                             mov             r0,#bufind+0
11F6 E4             3070     lodt:           clr             a
11F7 93             3071                             movc    a,@a+dptr
11F8 F6             3072                             mov             @r0,a
11F9 08             3073                             inc             r0
11FA A3             3074                             inc             dptr
11FB DBF9           3075                             djnz    r3,lodt
11FD 22             3076                             ret                                     
                    3077                                     
11FE                3078     textT:          
11FE FD543D32       3079                             db              0fdh,"T","=",32h,"m","S",0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
1202 6D53FDFD                
1206 FDFD                    
1208 FD543D31       3080                             db              0fdh,"T","=",31h,30h,"m","S",0fdh,0fdh,0fdh
120C 306D53FD                
1210 FDFD                    
1212 FD543D35       3081                             db              0fdh,"T","=",35h,30h,"m","S",0fdh,0fdh,0fdh
1216 306D53FD                
121A FDFD                    
121C FD543D64       3082                             db              0fdh,"T","=",64h,31h,"S",0fdh,0fdh,0fdh
1220 3153FDFD                
1224 FD                      
1225 20202054       3083                             db              " "," "," ","T","=",31h,"S"," "," "," "
1229 3D315320                
122D 2020                    
122F 2020543D       3084                             db              " "," ","T","=",31h,30h,"S"," "," "," "  
1233 31305320                
1237 2020                    
                    3085     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                    3086     
1239 42753474       3087      teVICH:        db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
123D 79767454                
1241 7720                    
1243 20413D2B       3088      teAequ0:       db              " ",'A','=','+',30h,30h,30h,30h,30h,30h
1247 30303030                
124B 3030                    
124D 20423D2B       3089      teBequ0:       db              " ",'B','=','+',30h,30h,30h,30h,30h,30h
1251 30303030                
1255 3030                    
1257 20207145       3090      teMENU:        db              " "," ",71h,"E","H",72h," "," "," "," "
125B 48722020                
125F 2020                    
                    3091     
1261 20205445       3092      teTEST:        db      " "," ","T","E",79h,"T"," "," "," "," "
1265 79542020                
1269 2020                    
                    3093     
126B 204B4176       3094      teKALIB:        db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР
126F 74735020                
1273 202020                  
1276 74337120       3095      teIZMK:        db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
127A 4B304879                
127E 5420                    
1280 20204275       3096      teOUT:         db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
1284 58307820                
1288 2020                    
128A 2020304C       3097      teOLL:         db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
128E 4C202020                
1292 2020                    
1294 20203034       3098      teCLE:         db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
1298 7479544B                
129C 4120                    
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    49

129E 20203041       3099      teMEM:         db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
12A2 71795420                
12A6 20203341       3100      teWR:          db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
12AA 61747977                
12AE 2020                    
12B0 20206150       3101      teLIST:        db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
12B4 30797130                
12B8 545020                  
12BB 20206130       3102      teFULL:        db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
12BF 76484162                
12C3 2020                    
12C5 20207376       3103      teBLOK:        db      " "," ",73h,76h,30h,'K'," ",30h,30h," ";БЛОК 00
12C9 304B2030                
12CD 3020                    
12CF 20207376       3104      teBL:          db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
12D3 304B2020                
12D7 2020                    
12D9 48413420       3105      tebBL:         db      "H",'A',34h," ",73h,76h," ",30h,30h,30h; НАЧ БЛОК 000
12DD 73762030                
12E1 3030                    
12E3 4B304820       3106      teeBL:         db      "K",30h,"H"," ",73h,76h," ",30h,30h,30h; КОН БЛОК 000
12E7 73762030                
12EB 3030                    
                    3107      ;;;;;;;;;;;;;;;;;;;         
                    3108     ;управление AD7731
                    3109     ;r4=b1 r5=b2
12ED                3110     iniacp: ;управление AD7731
12ED 7403           3111                             mov             a,#03
                    3112     
12EF 120000   F     3113                             call    write
12F2 EC             3114                             mov             a,r4;#80h
12F3 120000   F     3115                             call    write
12F6 ED             3116                             mov             a,r5;#04
12F7 120000   F     3117                             call    write
12FA 7402           3118                             mov             a,#02
12FC 120000   F     3119                             call    write
12FF 74A1           3120                             mov             a,#0a1h
1301 120000   F     3121                             call    write
1304 7474           3122                             mov             a,#74h
1306 120000   F     3123                             call    write
1309 2095FD         3124                             jb              p1.5,$;p1.3,$
130C 7402           3125                             mov             a,#02
130E 120000   F     3126                             call    write
1311 7481           3127                             mov             a,#81h
1313 120000   F     3128                             call    write
1316 7474           3129                             mov             a,#74h
1318 120000   F     3130                             call    write
131B 2095FD         3131                             jb              p1.5,$;p1.3,$
131E 7402           3132                             mov             a,#02
1320 120000   F     3133                             call    write
1323 7421           3134                             mov             a,#21h
1325 120000   F     3135                             call    write
1328 7474           3136                             mov             a,#74h
132A 120000   F     3137                             call    write
132D 22             3138                             ret
                    3139                             ;;;;;;;;;;;;;;;;
                    3140     ;;;;;;;;;;;;;;;;;
132E 0000           3141     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
1330 8004           3142                                     db              80h,04h;40h,04h         ;10s
1332 4004           3143                                     db              40h,04h         ;1s
1334 4004           3144                                     db              40h,04h         ;0,1s
1336 2004           3145                                     db              20h,04h         ;50ms
1338 2004           3146                                     db              20h,04h          ;10ms
133A 1332           3147                                     db              13h,32h         ;2ms
                    3148     ;загр В1,В2 в завис от Т                                
133C 799A           3149     loab12:                 mov             r1,#parT
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    50

133E 900000   F     3150                                     mov             dptr,#tabB1_2
1341 E7             3151                                     mov             a,@r1
1342 23             3152                                     rl              a;*2
1343 FF             3153                                     mov             r7,a                    ;save a
1344 93             3154                                     movc    a,@a+dptr
1345 FC             3155                                     mov             r4,a   ;b1
1346 0F             3156                                     inc             r7
1347 EF             3157                                     mov             a,r7
1348 93             3158                                     movc    a,@a+dptr
1349 FD             3159                                     mov             r5,a
                    3160                                     ;после загр В1,2 загр упр слово для нового Т
                    3161                             
134A 22             3162                                     ret
                    3163     
                    3164     
                    3165     
                    3166     ;пп мигания индикации
134B 78B2           3167     mign:           mov             r0,#marker
                    3168                                     
134D B6FF03         3169                                     cjne    @r0,#0ffh,mignn
                    3170                                     ;реж изм мигает *
1350 C219           3171                                     clr             bitmig
1352 22             3172                                     ret
                    3173     
1353                3174     mignn:                  ;clr            c
1353 7440           3175                                     mov             a,#bufind
1355 26             3176                                     add             a,@r0                   ;a=bufind+marker
1356 F9             3177                                     mov             r1,a
1357 201907         3178                                     jb              bitmig,onmig
135A 873C           3179                                     mov             savba,@r1
                    3180                             ;       mov             a,@r1
                    3181                             ;       mov             savba,a
135C 7720           3182                                     mov             @r1,#" "
135E D219           3183                                     setb    bitmig
1360 22             3184                                     ret
                    3185     
1361 A73C           3186     onmig:                  mov             @r1,savba
                    3187                                     ;mov            a,savba
                    3188                                     ; mov           @r1,a
1363 C219           3189                                     clr             bitmig
1365 120000   F     3190                                     call    z_01s
                    3191                                     
1368 22             3192                                     ret
                    3193     ;bufind=30h..39h                                                                           
                                           ;
1369 C219           3194     vvchif:                 clr             bitmig
136B 79B2           3195                                     mov             r1,#marker
136D E7             3196                                     mov             a,@r1                   ;изм цифры
136E 7840           3197                                     mov             r0,#bufind                      ;0000
1370 28             3198                                     add             a,r0
1371 F8             3199                                     mov             r0,a
1372 06             3200                                     inc             @r0
1373 B63A02         3201                                     cjne    @r0,#3ah,chif
1376 7630           3202                                     mov             @r0,#30h
1378                3203     chif:   
1378 22             3204                             ret
                    3205     
                    3206       ;перевод маркера влево
1379                3207     marle:  
1379 C219           3208                     clr             bitmig
                    3209                     ;mov            savba,#0   нельзя обнулять
137B 78B2           3210             mov             r0,#marker
137D 16             3211                     dec             @r0
137E E6             3212                     mov             a,@r0
137F C3             3213                     clr             c
1380 953A           3214                     subb    a,movleft         ;крайне левое положение
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    51

1382 5001           3215                     jnc             rler
1384 06             3216                     inc             @r0
1385 22             3217     rler:   ret
                    3218         
                    3219     ;перевод маркера вправо
1386 C219           3220     marri:  clr             bitmig
1388 78B2           3221                     mov             r0,#marker
138A 06             3222                     inc         @r0
138B E53B           3223                     mov             a,movrig           ;крайне правое положение
138D C3             3224                     clr             c
138E 96             3225                     subb    a,@r0
138F 5001           3226                     jnc             rrir
1391 16             3227                     dec             @r0
1392 22             3228     rrir:   ret
                    3229         
                    3230     
                    3231     
                    3232     
1393 7852           3233     loadr2: mov             r0,#abin+3              ;r2..r5
1395 E6             3234                     mov             a,@r0                   ; ст мл   
1396 FA             3235                     mov             r2,a
1397 18             3236                     dec             r0
1398 E6             3237                     mov             a,@r0
1399 FB             3238                     mov             r3,a
139A 18             3239                     dec             r0
139B E6             3240                     mov             a,@r0
139C FC             3241                     mov             r4,a
139D 18             3242                     dec             r0
139E E6             3243                     mov             a,@r0
139F FD             3244                     mov             r5,a
13A0 22             3245                     ret
                    3246                                             
                    3247      ;;;;;;;;;;;;;;;;;;;      
                    3248      ;загрузка KD в зависимости от диап изм  
                    3249      ;koef->r8..r11
13A1 78AE           3250     loadKD:                 mov             r0,#diap
13A3 E6             3251                                     mov             a,@r0
13A4 900000   F     3252                                     mov             dptr,#diKDn
13A7 75F004         3253                                     mov             b,#4
13AA A4             3254                                     mul             ab
13AB FF             3255                                     mov             r7,a;save
13AC 93             3256                                     movc    a,@a+dptr
13AD F508           3257                                     mov             r8,a
13AF A3             3258                                     inc             dptr
13B0 EF             3259                                     mov             a,r7
13B1 93             3260                                     movc    a,@a+dptr
13B2 F509           3261                                     mov             r9,a
13B4 A3             3262                                     inc             dptr
13B5 EF             3263                                     mov             a,r7
13B6 93             3264                                     movc    a,@a+dptr
13B7 F50A           3265                                     mov             r10,a
13B9 A3             3266                                     inc             dptr
13BA EF             3267                                     mov             a,r7
13BB 93             3268                                     movc    a,@a+dptr
13BC F50B           3269                                     mov             r11,a
13BE 22             3270                                     ret
                    3271     
13BF 3F506B7B       3272      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
13C3 3F507FCC       3273                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
13C7 3F4F9D0B       3274                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
13CB 3F4FE869       3275                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
13CF 3F50294A       3276                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    52

13D3 3F50639E       3277                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
13D7 3F4BC9F0       3278                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
13DB 3F4C063B       3279                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
13DF 3F50EFDD       3280                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
13E3 3F512AD9       3281                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                    3282     
13E7 00000039       3283     ch57:   db      00,00,00,39h;57
13EB 00000014       3284     ch20:   db      00,00,00,14h;20
                    3285     
                    3286     
                    3287     
                    3288     
                    3289     ;$include (d:\amp\subr2.asm) 
                +1  3290      ;задержка 100 мкс
13EF 7978       +1  3291     z_100:    mov R1,#78h     ;загрузка первого числа
13F1 7A02       +1  3292     z100:     mov R2,#2h     ;загрузка второго числа
13F3 DAFE       +1  3293     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
13F5 D9FA       +1  3294               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
13F7 22         +1  3295               ret           
                +1  3296     
                +1  3297     ;задержка 34 мкс
13F8 7B8B       +1  3298     z_5:      mov R3,#8Bh      ;загрузка числа
13FA DBFE       +1  3299     ct:       djnz R3,ct
13FC 22         +1  3300               ret
                +1  3301     
                +1  3302     ;задержка 15 мс
13FD 79FA       +1  3303     z_15:     mov R1,#0FAh    ;загрузка первого числа
13FF 7AED       +1  3304     z15:      mov R2,#0EDh   ;загрузка второго числа
1401 DAFE       +1  3305     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
1403 D9FA       +1  3306               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
1405 22         +1  3307               ret   
                +1  3308                                               
                +1  3309      ;задержка 1 мс
1406 7910       +1  3310     z_1ms:     mov R1,#10h     
1408 7AED       +1  3311     ss1:       mov R2,#0EDh    
140A DAFE       +1  3312                djnz R2, $    
140C D9FA       +1  3313                djnz R1, ss1   
140E 22         +1  3314                ret   
                +1  3315     
                +1  3316      ;????????
                +1  3317     ;задержка 1с
140F 7D1F       +1  3318     z_1s:   mov             r5,#01fh 
1411 7EFF       +1  3319     co2s:   mov     R6,#0ffh     
1413 7FFF       +1  3320     z1s:     mov    R7,#0ffh     
1415 DFFE       +1  3321     co1s:   djnz    R7, co1s        
1417 DEFA       +1  3322             djnz    R6, z1s 
1419 DDF6       +1  3323                     djnz    r5,co2s
141B 22         +1  3324               ret
                +1  3325     ;задержка 0,1с
141C 7D03       +1  3326     z_01s:           mov            r5,#03h 
141E 7EFF       +1  3327     co02s:          mov     R6,#0ffh     
1420 7FFF       +1  3328     z01s:           mov     R7,#0ffh     
1422 DFFE       +1  3329                             djnz    R7, $   
1424 DEFA       +1  3330                     djnz    R6, z01s 
1426 DDF6       +1  3331                             djnz    r5,co02s
1428 22         +1  3332                      ret              
1429 000007FF   +1  3333     chzap:  db      00,00,07h,0ffh             
142D 00000000   +1  3334     ch0:    db      00,00,00,00
1431 0000000A   +1  3335     ch10:   db      00,00,00,0ah                            ;10
1435 00000005   +1  3336     ch5:    db      00,00,00,05                                             ;5
1439 000003B9   +1  3337     ch954:  db 00,00,03,0b9h                                                ;954
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    53

143D 000003E8   +1  3338     ch10000:        db 00,00,03h,0e8h                                               ;10000
1441 00000064   +1  3339     ch100:  db 00,00,00,64h ;100
1445 00000002   +1  3340     ch2:    db      00,00,00,02                                             
                +1  3341     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  3342     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  3343     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
1449 00000001   +1  3344     ch1:    db  00,00,00,01
144D 3F800000   +1  3345     ch_1:   db      3fh,80h,00,00                   
1451 3F741EDF   +1  3346     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
1455 47C35000   +1  3347     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
1459 3F800347   +1  3348     KD:             db      3fh,80h,03h,47h;1,0001
145D 48435000   +1  3349     CH2tho: db      48h,43h,50h,00;200000
1461 4856D800   +1  3350     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
1465 4856D800   +1  3351     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
1469 461C4000   +1  3352     ch_10th:db  46h,1ch,40h,00;10000-2710h
                +1  3353     
                +1  3354     ;r1- мл байт 2х байтного числа
146D            +1  3355     tenmin:         ;-10
146D C3         +1  3356                             clr             c
146E E7         +1  3357                     mov             a,@r1
146F 940A       +1  3358                             subb    a,#10
1471 F7         +1  3359                             mov             @r1,a
1472 19         +1  3360                             dec             r1
1473 E7         +1  3361                             mov             a,@r1
1474 9400       +1  3362                             subb    a,#0
1476 F7         +1  3363                             mov             @r1,a
1477 22         +1  3364                             ret
                +1  3365       ;r0-обнуление ячеек памяти  
1478 7F04       +1  3366       clear4:        mov    r7,#4
147A E4         +1  3367                             clr             a
147B F6         +1  3368       cl4:          mov             @r0,a
147C 08         +1  3369                             inc             r0
147D DFFC       +1  3370                             djnz    r7,cl4
147F 22         +1  3371                             ret     
                +1  3372     
                +1  3373      ;r0-обнуление ячеек памяти 
                +1  3374      ;R7- 
1480            +1  3375       clearN:        
1480 E4         +1  3376                             clr             a
1481 F6         +1  3377       cl4N:         mov             @r0,a
1482 08         +1  3378                             inc             r0
1483 DFFC       +1  3379                             djnz    r7,cl4N
1485 22         +1  3380                             ret     
                +1  3381     
                +1  3382       ;чтение номера байта с индикатора(2байта)
                +1  3383     ;bufind+8..bufind+9
                +1  3384     ;-  - - -
                +1  3385     ;- - - - - - - - - -
                +1  3386     ;adec..adec+9
                +1  3387     ;ст            мл
1486 7848       +1  3388     upak2:  mov             r0,#bufind+8;
1488 795C       +1  3389                     mov             r1,#adec+9
148A 7F02       +1  3390                     mov             r7,#2;2bait
148C C3         +1  3391     upa2:   clr             c
148D E6         +1  3392                     mov             a,@r0
148E 9430       +1  3393                     subb    a,#30h
1490 F7         +1  3394                     mov             @r1,a
1491 18         +1  3395                     dec             r0
1492 19         +1  3396                     dec             r1
1493 DFF7       +1  3397                     djnz    r7,upa2
1495 22         +1  3398                     ret  
                +1  3399         
                +1  3400      ;bufind+4..bufind+9
                +1  3401     ;-  - - -
                +1  3402     ;- - - - - - - - - -
                +1  3403     ;adec..adec+9
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    54

                +1  3404     ;ст            мл
1496 7849       +1  3405     upak:   mov             r0,#bufind+9;
1498 795C       +1  3406                     mov             r1,#adec+9
149A 7F06       +1  3407                     mov             r7,#6
149C C3         +1  3408     upa:    clr             c
149D E6         +1  3409                     mov             a,@r0
149E 9430       +1  3410                     subb    a,#30h
14A0 F7         +1  3411                     mov             @r1,a
14A1 18         +1  3412                     dec             r0
14A2 19         +1  3413                     dec             r1
14A3 DFF7       +1  3414                     djnz    r7,upa
14A5 22         +1  3415                     ret
                +1  3416     
                +1  3417      ;чтение номера байта с индикатора(3байта)
                +1  3418     ;bufind+3..bufind+9
                +1  3419     ;-  - - -
                +1  3420     ;- - - - - - - - - -
                +1  3421     ;adec..adec+9
                +1  3422     ;ст            мл
14A6 7849       +1  3423     upak3:  mov             r0,#bufind+9;
14A8 795C       +1  3424                     mov             r1,#adec+9
14AA 7F03       +1  3425                     mov             r7,#3;3bait
14AC C3         +1  3426     upa1:   clr             c
14AD E6         +1  3427                     mov             a,@r0
14AE 9430       +1  3428                     subb    a,#30h
14B0 F7         +1  3429                     mov             @r1,a
14B1 18         +1  3430                     dec             r0
14B2 19         +1  3431                     dec             r1
14B3 DFF7       +1  3432                     djnz    r7,upa1
14B5 22         +1  3433                     ret
                +1  3434     
                +1  3435     ;вых-r2,r3-адрес ячее памяти прогр
14B6            +1  3436     findkoef:
14B6 79AE       +1  3437                                     mov             r1,#diap
14B8 E7         +1  3438                                     mov             a,@r1
14B9 23         +1  3439                                     rl              a                                          
                                          ;diap*2(2bait )
14BA FC         +1  3440                                     mov             r4,a                                    ;sa
                             ve
14BB 900000   F +1  3441                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  3442                                     
14BE 93         +1  3443                                     movc    a,@a+dptr                       ;ст байт
14BF FA         +1  3444                                     mov             r2,a
14C0 A3         +1  3445                                     inc             dptr
14C1 EC         +1  3446                                     mov             a,r4
14C2 93         +1  3447                                     movc    a,@a+dptr
14C3 FB         +1  3448                                     mov             r3,a                    ;мл байт
14C4 22         +1  3449                                     ret
                +1  3450     
                +1  3451     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  3452     ;(5000h..5027h)
14C5 5000       +1  3453     diKDw:  dw              5000h                   ;10-2
14C7 5004       +1  3454                                     dw              5004h                   ;10-3
14C9 5008       +1  3455                                     dw              5008h                   ;10-4
14CB 500C       +1  3456                                     dw              500ch                   ;10-5
14CD 5010       +1  3457                                     dw              5010h                   ;10-6
14CF 5014       +1  3458                                     dw              5014h                   ;10-7
14D1 5018       +1  3459                                     dw              5018h                   ;10-8
14D3 501C       +1  3460                                     dw              501ch                   ;10-9
14D5 5020       +1  3461                                     dw              5020h                   ;10-10
14D7 5024       +1  3462                                     dw              5024h                   ;10-11
14D9 5028       +1  3463     dipar:  dw              5028h                   ;parol
                +1  3464     
14DB 000186A0   +1  3465     chthou: db      00,01,86h,0a0h  ;100.000
                +1  3466     
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    55

14DF AA08       +1  3467     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
14E1 AB09       +1  3468                                             mov     r3,ltemp+1
14E3 AC0A       +1  3469                                             mov     r4,ltemp+2
14E5 AD0B       +1  3470                                             mov     r5,ltemp+3
14E7 22         +1  3471                                             ret
                    3472     
                    3473     ;$include (d:\amp\sarifm3.asm) 
                +1  3474     ; ” ©« SARIFM.ASM 8.11.95
                +1  3475     ;файл арифметики
                +1  3476       
  0008          +1  3477     ltemp    equ       8           ;long temporary
  000C          +1  3478     xtemp    equ       12          ;other temporaries
  000A          +1  3479     DECSIZE  EQU       10
  0004          +1  3480     NUMSIZE  EQU       4
  0004          +1  3481     RR4  EQU       4
  0005          +1  3482     RR5  EQU       5
                +1  3483     
                +1  3484                                                     
                +1  3485     
                +1  3486                 ; rseg     ARIF          ; Switch to this code segment.
                +1  3487     ;             using    0              ; Specify register bank for the following
                +1  3488                                            ; program code.
                +1  3489     ;                                               cseg AT 400h
                +1  3490     ; Arithmetics:  CLEARING string
                +1  3491     ; Input:
                +1  3492     ; R0 - pointer to string,
                +1  3493     ; NUMSIZE - byte count if CLRNUM used,
                +1  3494     ; DECSIZE - byte count if CLRDEC used,
                +1  3495     ; R2 - byte count if CLEAR used;
                +1  3496     ; Output:  none.
                +1  3497     
14E8            +1  3498     CLRDEC:
14E8 7A0A       +1  3499         MOV R2, #DECSIZE
14EA 8002       +1  3500         SJMP    CLEAR
14EC            +1  3501     CLRNUM:
14EC 7A04       +1  3502         MOV R2, #NUMSIZE
                +1  3503         ;JMP    CLEAR
14EE            +1  3504     CLEAR:
14EE E4         +1  3505         CLR A
14EF F6         +1  3506     CLR11:  MOV @R0, A
14F0 08         +1  3507         INC R0
14F1 DAFC       +1  3508         DJNZ    R2, CLR11
14F3 22         +1  3509         RET
                +1  3510     
                +1  3511     ;**********************************
                +1  3512     ;mov    r1,#abin+3
                +1  3513     ;mov    r0,#adec
                +1  3514     ; _ _ _ _
                +1  3515     ;     03ff
                +1  3516     ;ст     мл   - вход
                +1  3517     ; _ _ _ _ _ _ _ _ _ _
                +1  3518     ;             1 0 2 3
                +1  3519     ;ст                мл 
                +1  3520     ;**********************************
                +1  3521     
14F4            +1  3522     BINDEC:
                +1  3523     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  3524     ; Input:
                +1  3525     ; R0 - pointer to destination (high digit is the first),
                +1  3526     ; R1 - pointer to source,
                +1  3527     ; NUMSIZE - byte count in binary number;
                +1  3528     ; DECSIZE - byte count in decimal number;
                +1  3529     ; Output:  none.
                +1  3530     ; Source saved
                +1  3531     
                +1  3532         ; 1. Clear result
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    56

14F4 7A05       +1  3533         MOV R2, #DECSIZE/2
14F6 120000   F +1  3534         CALL   CLEAR  ; incrementing R0
                +1  3535     
                +1  3536         ; 2. Prepare convertion
14F9 18         +1  3537         DEC R0
14FA 8804       +1  3538         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
14FC 8905       +1  3539         MOV RR5, R1 ; R5 - pointer to low byte of binary number
14FE 7B20       +1  3540         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  3541     
                +1  3542         ; 3. Convert cyrcle
1500            +1  3543     BIN30:
                +1  3544     
                +1  3545         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
1500 A905       +1  3546         MOV R1, RR5
1502 7A04       +1  3547         MOV R2, #NUMSIZE
1504 E7         +1  3548     BIN31:  MOV A, @R1
1505 33         +1  3549         RLC A
1506 F7         +1  3550         MOV @R1, A
1507 19         +1  3551         DEC R1
1508 DAFA       +1  3552         DJNZ    R2, BIN31
150A A905       +1  3553         MOV R1, RR5
150C E7         +1  3554         MOV A, @R1
150D 92E0       +1  3555         MOV ACC.0, C
150F F7         +1  3556         MOV @R1, A
                +1  3557     
                +1  3558         ; 3.2. Doubling decimal result with <Carry>
1510 A804       +1  3559         MOV R0, RR4
1512 7A05       +1  3560         MOV R2, #DECSIZE/2
1514 E6         +1  3561     BIN32:  MOV A, @R0
1515 36         +1  3562         ADDC    A, @R0
1516 D4         +1  3563         DA  A
1517 F6         +1  3564         MOV @R0, A
1518 18         +1  3565         DEC R0
1519 DAF9       +1  3566         DJNZ    R2, BIN32
                +1  3567     
                +1  3568         ; 3.3. End of convert cyrcle
151B DBE3       +1  3569         DJNZ    R3, BIN30
                +1  3570     
                +1  3571         ; 4. Make bytes from half-bytes
151D E8         +1  3572         MOV A, R0
151E 240A       +1  3573         ADD A, #DECSIZE
1520 F8         +1  3574         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
1521 A904       +1  3575         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
1523 7A05       +1  3576         MOV R2, #DECSIZE/2
1525 E7         +1  3577     BIN41:  MOV A, @R1
1526 540F       +1  3578         ANL A, #00FH
1528 F6         +1  3579         MOV @R0, A
1529 18         +1  3580         DEC R0
152A E7         +1  3581         MOV A, @R1
152B C4         +1  3582         SWAP    A
152C 540F       +1  3583         ANL A, #00FH
152E F6         +1  3584         MOV @R0, A
152F 18         +1  3585         DEC R0
1530 19         +1  3586         DEC R1
1531 DAF2       +1  3587         DJNZ    R2, BIN41
1533 22         +1  3588         RET
                +1  3589     
                +1  3590     
                +1  3591     ;*********************************
                +1  3592     ;mov    r0,#abin
                +1  3593     ;mov    r1,#adec
                +1  3594     ; _ _ _ _       -выход
                +1  3595     ; ff0000
                +1  3596     ;0004
                +1  3597     ;мл      ст
                +1  3598     
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    57

                +1  3599     ;ст                       мл
                +1  3600     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  3601     ;                       2 5 5
                +1  3602     ;                   1 0 2 4
                +1  3603     
1534            +1  3604     DECBIN:
                +1  3605     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  3606     ; Input:
                +1  3607     ; R0 - pointer to destination,
                +1  3608     ; R1 - pointer to source (high digit is the first),
                +1  3609     ; NUMSIZE - byte count in binary number;
                +1  3610     ; DECSIZE - byte count in decimal number;
                +1  3611     ; Output:  none
                +1  3612     ; Source cleared
                +1  3613     
                +1  3614         ; 1. Clear result
1534 120000   F +1  3615         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  3616     
                +1  3617         ; 2. Prepare convertion
1537 18         +1  3618         DEC R0
1538 8804       +1  3619         MOV RR4, R0 ; R4 - pointer to high byte of binary result
153A 8905       +1  3620         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
153C 900000   F +1  3621         MOV DPTR, #DECT2
153F 7B20       +1  3622         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  3623     
                +1  3624         ; 3. Convert cyrcle
1541            +1  3625     DEC30:
                +1  3626     
                +1  3627         ; 3.1. Divide decimal number by 2 and prepare <Carry>
1541 C3         +1  3628         CLR C
1542 A905       +1  3629         MOV R1, RR5
1544 7A0A       +1  3630         MOV R2, #DECSIZE
1546 E7         +1  3631     DEC31:  MOV A, @R1
1547 540F       +1  3632         ANL A, #00FH
1549 92E4       +1  3633         MOV ACC.4, C
154B 93         +1  3634         MOVC    A,@A+DPTR
154C F7         +1  3635         MOV @R1, A
154D A2E7       +1  3636         MOV C, ACC.7
154F 09         +1  3637         INC R1
1550 DAF4       +1  3638         DJNZ    R2, DEC31
                +1  3639     
                +1  3640         ; 3.2. Rotate binary result one bit to right with <Carry>
1552 A804       +1  3641         MOV R0, RR4
1554 7A04       +1  3642         MOV R2, #NUMSIZE
1556 E6         +1  3643     DEC32:  MOV A, @R0
1557 13         +1  3644         RRC A
1558 F6         +1  3645         MOV @R0, A
1559 18         +1  3646         DEC R0
155A DAFA       +1  3647         DJNZ    R2, DEC32
                +1  3648     
                +1  3649         ; 3.3. End of convert cyrcle
155C DBE3       +1  3650         DJNZ    R3, DEC30
155E 22         +1  3651         RET
                +1  3652     
155F 00800181   +1  3653     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
1563 02820383                
1567 0484                    
1569 00000000   +1  3654         DB  00,00,00,00,00,00
156D 0000                    
156F 05850686   +1  3655         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
1573 07870888                
1577 0989                    
                +1  3656     
                +1  3657     ;   Long comparison
                +1  3658     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  3659     ;   flags and acc set as though a long subtraction was done.
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    58

                +1  3660     ;*******************************
                +1  3661     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  3662     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  3663     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  3664     ;*******************************
1579            +1  3665     lcmp:
1579 C3         +1  3666         clr c
157A EA         +1  3667         mov a,r2
157B 9508       +1  3668         subb    a,8
157D 700F       +1  3669         jnz done
157F EB         +1  3670         mov a,r3
1580 9509       +1  3671         subb    a,9
1582 7008       +1  3672         jnz done1
1584 EC         +1  3673         mov a,r4
1585 950A       +1  3674         subb    a,10
1587 7003       +1  3675         jnz done1
1589 ED         +1  3676         mov a,r5
158A 950B       +1  3677         subb    a,11
158C            +1  3678     done1:
158C C2D2       +1  3679         clr ov      ;overflow is significant only for top byte
158E            +1  3680     done:
158E 22         +1  3681         ret
                +1  3682     
                +1  3683     ;   Load long into r2-5 from [dptr]
                +1  3684     
158F            +1  3685     ldc_long:
158F E583       +1  3686         mov a,dph       ;is it in on board memory
1591 6010       +1  3687         jz  onboard     ;yes
1593 E4         +1  3688         clr a
1594 93         +1  3689         movc    a,@a+dptr
1595 FA         +1  3690         mov r2,a
1596 7401       +1  3691         mov a,#1
1598 93         +1  3692         movc    a,@a+dptr
1599 FB         +1  3693         mov r3,a
159A 7402       +1  3694         mov a,#2
159C 93         +1  3695         movc    a,@a+dptr
159D FC         +1  3696         mov r4,a
159E 7403       +1  3697         mov a,#3
15A0 93         +1  3698         movc    a,@a+dptr
15A1 FD         +1  3699         mov r5,a
15A2 22         +1  3700         ret
15A3            +1  3701     onboard:
15A3 A882       +1  3702         mov r0,dpl
15A5 E6         +1  3703         mov a,@r0
15A6 FA         +1  3704         mov r2,a
15A7 08         +1  3705         inc r0
15A8 E6         +1  3706         mov a,@r0
15A9 FB         +1  3707         mov r3,a
15AA 08         +1  3708         inc r0
15AB E6         +1  3709         mov a,@r0
15AC FC         +1  3710         mov r4,a
15AD 08         +1  3711         inc r0
15AE E6         +1  3712         mov a,@r0
15AF FD         +1  3713         mov r5,a
15B0 22         +1  3714         ret
                +1  3715     
                +1  3716     ;**************************************
                +1  3717     ;загрузить ltemp...+3 из памяти программ
                +1  3718     ;mov    dptr,#CH5
                +1  3719     ;call   ldc_ltemp        ltemp <--5
                +1  3720     ;**************************************
15B1            +1  3721     ldc_ltemp:
15B1 E583       +1  3722         mov a,dph       ;is it in on board memory
15B3 6014       +1  3723         jz  oboard      ;yes
15B5 E4         +1  3724         clr a
15B6 93         +1  3725         movc    a,@a+dptr
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    59

15B7 F508       +1  3726         mov 8,a
15B9 7401       +1  3727         mov a,#1
15BB 93         +1  3728         movc    a,@a+dptr
15BC F509       +1  3729         mov 9,a
15BE 7402       +1  3730         mov a,#2
15C0 93         +1  3731         movc    a,@a+dptr
15C1 F50A       +1  3732         mov 10,a
15C3 7403       +1  3733         mov a,#3
15C5 93         +1  3734         movc    a,@a+dptr
15C6 F50B       +1  3735         mov 11,a
15C8 22         +1  3736         ret
15C9            +1  3737     oboard:
15C9 A882       +1  3738         mov r0,dpl
15CB 8608       +1  3739         mov 8,@r0
15CD 08         +1  3740         inc r0
15CE 8609       +1  3741         mov 9,@r0
15D0 08         +1  3742         inc r0
15D1 860A       +1  3743         mov 10,@r0
15D3 08         +1  3744         inc r0
15D4 860B       +1  3745         mov 11,@r0
15D6 22         +1  3746         ret
                +1  3747     
                +1  3748     ;*****************************
                +1  3749     ;mov    dptr,#k1
                +1  3750     ;call   ldx_long
                +1  3751     ;k1->r2..r5
                +1  3752     ;*****************************
                +1  3753     ;   Load long into r2-5 from [dptr]
                +1  3754     ;
                +1  3755     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
15D7            +1  3756     ldx_long:
15D7 E583       +1  3757         mov a,dph       ;is it in on board memory
15D9 6014       +1  3758         jz  onboar1        ;yes
15DB C082       +1  3759         push    dpl
15DD C083       +1  3760         push    dph
15DF E0         +1  3761         movx    a,@dptr
15E0 FA         +1  3762         mov r2,a
15E1 A3         +1  3763         inc dptr
15E2 E0         +1  3764         movx    a,@dptr
15E3 FB         +1  3765         mov r3,a
15E4 A3         +1  3766         inc dptr
15E5 E0         +1  3767         movx    a,@dptr
15E6 FC         +1  3768         mov r4,a
15E7 A3         +1  3769         inc dptr
15E8 E0         +1  3770         movx    a,@dptr
15E9 FD         +1  3771         mov r5,a
15EA D083       +1  3772         pop dph
15EC D082       +1  3773         pop dpl
15EE 22         +1  3774         ret
15EF            +1  3775     onboar1:
15EF A882       +1  3776         mov r0,dpl
15F1 E6         +1  3777         mov a,@r0
15F2 FA         +1  3778         mov r2,a
15F3 08         +1  3779         inc r0
15F4 E6         +1  3780         mov a,@r0
15F5 FB         +1  3781         mov r3,a
15F6 08         +1  3782         inc r0
15F7 E6         +1  3783         mov a,@r0
15F8 FC         +1  3784         mov r4,a
15F9 08         +1  3785         inc r0
15FA E6         +1  3786         mov a,@r0
15FB FD         +1  3787         mov r5,a
15FC 22         +1  3788         ret
                +1  3789     
                +1  3790     ;*********************************
                +1  3791     ;mov    dptr,#k2
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    60

                +1  3792     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  3793     ;**********************************
15FD            +1  3794     ldx_ltemp:
15FD E583       +1  3795         mov a,dph       ;is it in on board memory
15FF 6010       +1  3796         jz  oboard1     ;yes
1601 E0         +1  3797         movx    a,@dptr
1602 F508       +1  3798         mov 8,a
1604 A3         +1  3799         inc dptr
1605 E0         +1  3800         movx    a,@dptr
1606 F509       +1  3801         mov 9,a
1608 A3         +1  3802         inc dptr
1609 E0         +1  3803         movx    a,@dptr
160A F50A       +1  3804         mov 10,a
160C A3         +1  3805         inc dptr
160D E0         +1  3806         movx    a,@dptr
160E F50B       +1  3807         mov 11,a
1610 22         +1  3808         ret
1611            +1  3809     oboard1:
1611 A882       +1  3810         mov r0,dpl
1613 8608       +1  3811         mov 8,@r0
1615 08         +1  3812         inc r0
1616 8609       +1  3813         mov 9,@r0
1618 08         +1  3814         inc r0
1619 860A       +1  3815         mov 10,@r0
161B 08         +1  3816         inc r0
161C 860B       +1  3817         mov 11,@r0
161E 22         +1  3818         ret
                +1  3819     ;   Long division routines for 8051
                +1  3820     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  3821     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  3822     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  3823     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  3824     ;   r1 must be saved by the caller.
                +1  3825     ;   This is long unsigned division.
                +1  3826     
                +1  3827     
                +1  3828     ;   Register usage:
                +1  3829     ;       r0 loop counter
                +1  3830     ;       xtemp (12-15) accumulates quotient
                +1  3831     ;       r5-r2 holds dividend
                +1  3832     ;       ltemp holds divisor
                +1  3833     
                +1  3834     ;************************************
                +1  3835     ;r2..r5-делимое
                +1  3836     ;ltemp..-делитель
                +1  3837     ;частное -r2..r5
                +1  3838     ;*************************************
161F            +1  3839     divide:
161F E4         +1  3840         clr a
1620 F8         +1  3841         mov r0,a        ;initialize count
1621 F50C       +1  3842         mov xtemp,a     ;zero quotient
1623 F50D       +1  3843         mov xtemp+1,a
1625 F50E       +1  3844         mov xtemp+2,a
1627 F50F       +1  3845         mov xtemp+3,a
1629 ED         +1  3846         mov a,r5        ;check for zero dividend
162A 4C         +1  3847         orl a,r4
162B 4B         +1  3848         orl a,r3
162C 4A         +1  3849         orl a,r2
162D 600B       +1  3850         jz  jfinis
162F E508       +1  3851         mov a,ltemp     ;check for zero divisor
1631 4509       +1  3852         orl a,ltemp+1
1633 450A       +1  3853         orl a,ltemp+2
1635 450B       +1  3854         orl a,ltemp+3
1637 7037       +1  3855         jnz midl
1639 22         +1  3856         ret
                +1  3857     
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    61

163A 020000   F +1  3858     jfinis: jmp finis
                +1  3859     
163D            +1  3860     loops:
163D EA         +1  3861         mov a,r2
163E C3         +1  3862         clr c
163F 9508       +1  3863         subb    a,ltemp+0   ;is divisor greater than dividend yet
1641 4033       +1  3864         jc  yes     ;yes, go no further
1643 7013       +1  3865         jnz no
1645 EB         +1  3866         mov a,r3
1646 9509       +1  3867         subb    a,ltemp+1
1648 402C       +1  3868         jc  yes
164A 700C       +1  3869         jnz no
164C EC         +1  3870         mov a,r4
164D 950A       +1  3871         subb    a,ltemp+2
164F 4025       +1  3872         jc  yes
1651 7005       +1  3873         jnz no
1653 ED         +1  3874         mov a,r5
1654 950B       +1  3875         subb    a,ltemp+3
1656 401E       +1  3876         jc  yes
1658            +1  3877     no:
1658 E50B       +1  3878         mov a,ltemp+3   ;shift divisor up one bit
165A 250B       +1  3879         add a,ltemp+3
165C F50B       +1  3880         mov ltemp+3,a
165E E50A       +1  3881         mov a,ltemp+2
1660 350A       +1  3882         addc    a,ltemp+2
1662 F50A       +1  3883         mov ltemp+2,a
1664 E509       +1  3884         mov a,ltemp+1
1666 3509       +1  3885         addc    a,ltemp+1
1668 F509       +1  3886         mov ltemp+1,a
166A E508       +1  3887         mov a,ltemp+0
166C 3508       +1  3888         addc    a,ltemp+0
166E F508       +1  3889         mov ltemp+0,a
1670            +1  3890     midl:
1670 08         +1  3891         inc r0      ;increment count
1671 E508       +1  3892         mov a,ltemp+0   ;check for safe to shift some more
1673 30E7C7     +1  3893         jnb acc.7,loops  ;loop if top bit clear
1676            +1  3894     yes:
1676 E508       +1  3895         mov a,ltemp+0
1678 C3         +1  3896         clr c
1679 9A         +1  3897         subb    a,r2        ;can we subtract now?
167A 401A       +1  3898         jc  dosub       ;yes, go and do it
167C 7015       +1  3899         jnz nosub
167E E509       +1  3900         mov a,ltemp+1
1680 9B         +1  3901         subb    a,r3
1681 4013       +1  3902         jc  dosub
1683 700E       +1  3903         jnz nosub
1685 E50A       +1  3904         mov a,ltemp+2
1687 9C         +1  3905         subb    a,r4
1688 400C       +1  3906         jc  dosub
168A 7007       +1  3907         jnz nosub
168C E50B       +1  3908         mov a,ltemp+3
168E 9D         +1  3909         subb    a,r5
168F 4005       +1  3910         jc  dosub
1691 6003       +1  3911         jz  dosub
1693            +1  3912     nosub:
1693 C3         +1  3913         clr c
1694 8012       +1  3914         sjmp    dosh
1696            +1  3915     dosub:
1696 C3         +1  3916         clr c       ;subtract divisor from dividend
1697 ED         +1  3917         mov a,r5
1698 950B       +1  3918         subb    a,ltemp+3
169A FD         +1  3919         mov r5,a
169B EC         +1  3920         mov a,r4
169C 950A       +1  3921         subb    a,ltemp+2
169E FC         +1  3922         mov r4,a
169F EB         +1  3923         mov a,r3
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    62

16A0 9509       +1  3924         subb    a,ltemp+1
16A2 FB         +1  3925         mov r3,a
16A3 EA         +1  3926         mov a,r2
16A4 9508       +1  3927         subb    a,ltemp+0
16A6 FA         +1  3928         mov r2,a
16A7 D3         +1  3929         setb    c       ;now set bit for quotient
16A8            +1  3930     dosh:
16A8 E50F       +1  3931         mov a,xtemp+3
16AA 33         +1  3932         rlc a
16AB F50F       +1  3933         mov xtemp+3,a
16AD E50E       +1  3934         mov a,xtemp+2
16AF 33         +1  3935         rlc a
16B0 F50E       +1  3936         mov xtemp+2,a
16B2 E50D       +1  3937         mov a,xtemp+1
16B4 33         +1  3938         rlc a
16B5 F50D       +1  3939         mov xtemp+1,a
16B7 E50C       +1  3940         mov a,xtemp+0
16B9 33         +1  3941         rlc a
16BA F50C       +1  3942         mov xtemp+0,a
16BC E508       +1  3943         mov a,ltemp+0       ;shift divisor down
16BE C3         +1  3944         clr c
16BF 13         +1  3945         rrc a
16C0 F508       +1  3946         mov ltemp+0,a
16C2 E509       +1  3947         mov a,ltemp+1
16C4 13         +1  3948         rrc a
16C5 F509       +1  3949         mov ltemp+1,a
16C7 E50A       +1  3950         mov a,ltemp+2
16C9 13         +1  3951         rrc a
16CA F50A       +1  3952         mov ltemp+2,a
16CC E50B       +1  3953         mov a,ltemp+3
16CE 13         +1  3954         rrc a
16CF F50B       +1  3955         mov ltemp+3,a
                +1  3956     
16D1 D8A3       +1  3957         djnz    r0,yes      ;and continue with the rest
                +1  3958     
16D3            +1  3959     finis:
16D3 8D0B       +1  3960         mov ltemp+3,r5
16D5 8C0A       +1  3961         mov ltemp+2,r4
16D7 8B09       +1  3962         mov ltemp+1,r3
16D9 8A08       +1  3963         mov ltemp+0,r2
16DB AD0F       +1  3964         mov r5,xtemp+3
16DD AC0E       +1  3965         mov r4,xtemp+2
16DF AB0D       +1  3966         mov r3,xtemp+1
16E1 AA0C       +1  3967         mov r2,xtemp+0
16E3 22         +1  3968         ret         ;and return with the satisfaction of a job well done
                +1  3969     
                +1  3970     
                +1  3971     ;   Long multiplication
                +1  3972     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  3973     ;   other in ltemp. It really doesn't matter which one is where.
                +1  3974     
                +1  3975     ;**********************************
                +1  3976     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  3977     ;ст  мл
                +1  3978     ;**********************************
16E4            +1  3979     llmul:
16E4            +1  3980     almul:
16E4            +1  3981     lmul:
16E4 ED         +1  3982         mov a,r5        ;low order byte
16E5 850BF0     +1  3983         mov b,ltemp+3       ;times low order byte
16E8 A4         +1  3984         mul ab
16E9 F50F       +1  3985         mov xtemp+3,a       ;store low
16EB 85F00E     +1  3986         mov xtemp+2,b   ;and high
16EE ED         +1  3987         mov a,r5        ;low order
16EF 850AF0     +1  3988         mov b,ltemp+2   ;times next
16F2 A4         +1  3989         mul ab
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    63

16F3 250E       +1  3990         add a,xtemp+2   ;add in
16F5 F50E       +1  3991         mov xtemp+2,a
16F7 E5F0       +1  3992         mov a,b
16F9 3400       +1  3993         addc    a,#0
16FB F50D       +1  3994         mov xtemp+1,a
16FD ED         +1  3995         mov a,r5
16FE 8509F0     +1  3996         mov b,ltemp+1
1701 A4         +1  3997         mul ab
1702 250D       +1  3998         add a,xtemp+1
1704 F50D       +1  3999         mov xtemp+1,a
1706 E5F0       +1  4000         mov a,b
1708 3400       +1  4001         addc    a,#0
170A F50C       +1  4002         mov xtemp+0,a
170C ED         +1  4003         mov a,r5
170D 8508F0     +1  4004         mov b,ltemp+0
1710 A4         +1  4005         mul ab
1711 250C       +1  4006         add a,xtemp+0
1713 F50C       +1  4007         mov xtemp+0,a
1715 EC         +1  4008         mov a,r4
1716 850BF0     +1  4009         mov b,ltemp+3
1719 A4         +1  4010         mul ab
171A 250E       +1  4011         add a,xtemp+2
171C F50E       +1  4012         mov xtemp+2,a
171E E5F0       +1  4013         mov a,b
1720 350D       +1  4014         addc    a,xtemp+1
1722 F50D       +1  4015         mov xtemp+1,a
1724 E50C       +1  4016         mov a,xtemp+0
1726 3400       +1  4017         addc    a,#0
1728 F50C       +1  4018         mov xtemp+0,a
172A EC         +1  4019         mov a,r4
172B 850AF0     +1  4020         mov b,ltemp+2
172E A4         +1  4021         mul ab
172F 250D       +1  4022         add a,xtemp+1
1731 F50D       +1  4023         mov xtemp+1,a
1733 E5F0       +1  4024         mov a,b
1735 350C       +1  4025         addc    a,xtemp+0
1737 F50C       +1  4026         mov xtemp+0,a
1739 EC         +1  4027         mov a,r4
173A 8509F0     +1  4028         mov b,ltemp+1
173D A4         +1  4029         mul ab
173E 250C       +1  4030         add a,xtemp+0
1740 F50C       +1  4031         mov xtemp+0,a
                +1  4032     
1742 EB         +1  4033         mov a,r3
1743 850BF0     +1  4034         mov b,ltemp+3
1746 A4         +1  4035         mul ab
1747 250D       +1  4036         add a,xtemp+1
1749 F50D       +1  4037         mov xtemp+1,a
174B E5F0       +1  4038         mov a,b
174D 350C       +1  4039         addc    a,xtemp+0
174F F50C       +1  4040         mov xtemp+0,a
1751 EB         +1  4041         mov a,r3
1752 850AF0     +1  4042         mov b,ltemp+2
1755 A4         +1  4043         mul ab
1756 250C       +1  4044         add a,xtemp+0
1758 F50C       +1  4045         mov xtemp+0,a
                +1  4046     
175A EA         +1  4047         mov a,r2
175B 850BF0     +1  4048         mov b,ltemp+3
175E A4         +1  4049         mul ab
175F 250C       +1  4050         add a,xtemp+0
1761 FA         +1  4051         mov r2,a
1762 AB0D       +1  4052         mov r3,xtemp+1
1764 AC0E       +1  4053         mov r4,xtemp+2
1766 AD0F       +1  4054         mov r5,xtemp+3
                +1  4055     
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    64

1768 22         +1  4056         ret         ;all done
                +1  4057     ;******************************
                +1  4058     ;из содержимого  r2-r5  вычесть
                +1  4059     ;содержимое          ltemp..ltemp+3
                +1  4060     ;******************************
1769            +1  4061     llsub:
1769            +1  4062      lsub:
1769 ED         +1  4063         mov a,r5
176A C3         +1  4064         clr c
176B 950B       +1  4065         subb    a,11
176D FD         +1  4066         mov r5,a
176E EC         +1  4067         mov a,r4
176F 950A       +1  4068         subb    a,10
1771 FC         +1  4069         mov r4,a
1772 EB         +1  4070         mov a,r3
1773 9509       +1  4071         subb    a,9
1775 FB         +1  4072         mov r3,a
1776 EA         +1  4073         mov a,r2
1777 9508       +1  4074         subb    a,8
1779 FA         +1  4075         mov r2,a
177A 22         +1  4076         ret
                +1  4077     
                +1  4078     ;***********************************************
                +1  4079     ;                                                      ст мл
                +1  4080     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4081     ;  r0- адрес младшего байта !!!
                +1  4082     ;результат- r2..r5
                +1  4083     ;***********************************************
                +1  4084     
177B C3         +1  4085     ladd:    clr       c
177C ED         +1  4086          mov       a,r5
177D 26         +1  4087          add       a,@r0
177E FD         +1  4088          mov       r5,a
177F 18         +1  4089          dec       r0
1780 EC         +1  4090          mov       a,r4
1781 36         +1  4091          addc      a,@r0
1782 FC         +1  4092          mov       r4,a
1783 18         +1  4093          dec       r0
1784 EB         +1  4094          mov       a,r3
1785 36         +1  4095          addc      a,@r0
1786 FB         +1  4096          mov       r3,a
1787 18         +1  4097          dec       r0
1788 EA         +1  4098          mov       a,r2
1789 36         +1  4099          addc      a,@r0
178A FA         +1  4100          mov       r2,a
178B 22         +1  4101          ret
                +1  4102     ;***********************************************
                +1  4103     ;                                                      ст мл
                +1  4104     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4105     ;  r0- адрес младшего байта !!!
                +1  4106     ;результат- r2..r5
                +1  4107     ;***********************************************
                +1  4108     
178C C3         +1  4109     laddx:    clr       c
178D E2         +1  4110                                             movx            a,@r0
178E 2D         +1  4111                                             add                     a,r5
178F FD         +1  4112               mov     r5,a
1790 18         +1  4113                             dec     r0
1791 E2         +1  4114                             movx    a,@r0
1792 3C         +1  4115                             addc    a,r4
1793 FC         +1  4116                             mov     r4,a
1794 18         +1  4117                             dec     r0
1795 E2         +1  4118                             movx    a,@r0
1796 3B         +1  4119                             addc    a,r3
1797 FB         +1  4120                             mov     r3,a
1798 18         +1  4121                             dec     r0
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    65

1799 E2         +1  4122                             movx    a,@r0
179A 3A         +1  4123                             addc    a,r2
179B FA         +1  4124                             mov       r2,a
179C 22         +1  4125                             ret
                +1  4126     
                +1  4127     ;***********************************************
                +1  4128     ;                                                      ст мл
                +1  4129     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4130     ;  dptr- адрес младшего байта !!!
                +1  4131     ;результат- r2..r5
                +1  4132     ;***********************************************
                +1  4133     
179D C3         +1  4134     addx:    clr       c
179E E0         +1  4135                                             movx            a,@dptr
179F 2D         +1  4136                                             add                     a,r5
17A0 FD         +1  4137               mov     r5,a
17A1 120000   F +1  4138                             call            dedptr;dec     dptr
17A4 E0         +1  4139                             movx    a,@dptr
17A5 3C         +1  4140                             addc    a,r4
17A6 FC         +1  4141                             mov     r4,a
17A7 120000   F +1  4142                             call            dedptr;dec     dptr
17AA E0         +1  4143                             movx    a,@dptr
17AB 3B         +1  4144                             addc    a,r3
17AC FB         +1  4145                             mov     r3,a
17AD 120000   F +1  4146                             call            dedptr;dec     dptr
17B0 E0         +1  4147                             movx    a,@dptr
17B1 3A         +1  4148                             addc    a,r2
17B2 FA         +1  4149                             mov       r2,a
17B3 22         +1  4150                             ret
                +1  4151     
17B4 C0D0       +1  4152     dedptr:         push    psw
17B6 C3         +1  4153                                             clr             c
17B7 E582       +1  4154                                             mov             a,dpl
17B9 9401       +1  4155                                             subb    a,#1
17BB F582       +1  4156                                             mov             dpl,a
17BD E583       +1  4157                                             mov             a,dph
17BF 9400       +1  4158                                             subb    a,#0
17C1 F583       +1  4159                                             mov             dph,a
17C3 D0D0       +1  4160                                             pop             psw
17C5 22         +1  4161                                             ret
                    4162     
                    4163     ;$include (d:\amp\floatm.asm)
                +1  4164     ;       Copyright (C) 1988 HI-TECH Software
                +1  4165     
                +1  4166     ;       Single Precision Floating point arithmetic routines for 8051
                +1  4167     
                +1  4168     ;       The format of floating point numbers is as follows:
                +1  4169     
                +1  4170     ;       -----------------
                +1  4171     ;       *     sign      *  1 bit
                +1  4172     ;       -----------------
                +1  4173     ;       *   exponent    *  8 bits
                +1  4174     ;       -----------------
                +1  4175     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  4176     ;       -----------------
                +1  4177     
                +1  4178     
                +1  4179     ;       As usual for the 8051 the memory layout has the most significant
                +1  4180     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  4181     ;       lowest address.
                +1  4182     
                +1  4183     ;       Calling conventions:
                +1  4184     
                +1  4185     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  4186     ;
                +1  4187     ;       Return value is in r2-r5
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    66

                +1  4188     
                +1  4189     ;       Naming conventions: A routine name is constructed by
                +1  4190     
                +1  4191     ;             ASOP
                +1  4192     
                +1  4193     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  4194     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  4195     ;       Conversion routines are named
                +1  4196     
                +1  4197     ;               AStof
                +1  4198     
                +1  4199     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  4200     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  4201     ;       Conversion from float to integer is ftol.
                +1  4202     
                +1  4203     ;               .ORG  5000h
                +1  4204     ;               .CODE
                +1  4205     ;       seg     c_text
                +1  4206     
                +1  4207     ;;      $MOD812
----            +1  4208             CSEG
                +1  4209             ;ORG 1000h
                +1  4210     
                +1  4211                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  4212             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  4213     
                +1  4214     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  4215     ;       macros
                +1  4216     
                +1  4217     saveregs        macro
                +1  4218             push    7
                +1  4219             push    6
                +1  4220             push    1
                +1  4221             push    0
                +1  4222             endm
                +1  4223     
                +1  4224     restregs        macro
                +1  4225             pop     0
                +1  4226             pop     1
                +1  4227             pop     6
                +1  4228             pop     7
                +1  4229             endm
                +1  4230     
                +1  4231     ;addr   
                +1  4232     dan     macro   pad
                +1  4233             mov     a,r5
                +1  4234             add     a,pad+3
                +1  4235             mov     pad+3,a
                +1  4236             mov     a,pad+2
                +1  4237             addc    a,r4
                +1  4238             mov     pad+2,a
                +1  4239             mov     a,pad+1
                +1  4240             addc    a,r3
                +1  4241             mov     pad+1,a
                +1  4242             mov     a,pad+0
                +1  4243             addc    a,r2
                +1  4244             mov     pad,a
                +1  4245             endm
                +1  4246     
                +1  4247     addl    macro  addr
                +1  4248             mov     a,r5
                +1  4249             add     a,addr+3
                +1  4250             mov     r5,a
                +1  4251             mov     a,addr+2
                +1  4252             addc    a,r4
                +1  4253             mov     r4,a
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    67

                +1  4254             mov     a,addr+1
                +1  4255             addc    a,r3
                +1  4256             mov     r3,a
                +1  4257             mov     a,addr+0
                +1  4258             addc    a,r2
                +1  4259             mov     r2,a
                +1  4260             endm
                +1  4261     
                +1  4262     
                +1  4263     add1    macro
                +1  4264             mov     a,r5
                +1  4265             add     a,#1
                +1  4266             mov     r5,a
                +1  4267             clr     a
                +1  4268             addc    a,r4
                +1  4269             mov     r4,a
                +1  4270             clr     a
                +1  4271             addc    a,r3
                +1  4272             mov     r3,a
                +1  4273             clr     a
                +1  4274             addc    a,r2
                +1  4275             mov     r2,a
                +1  4276             endm
                +1  4277     
                +1  4278     shfdn   macro  addr
                +1  4279             clr     c
                +1  4280             mov     a,addr
                +1  4281             rrc     a
                +1  4282             mov     addr,a
                +1  4283             mov     a,addr+1
                +1  4284             rrc     a
                +1  4285             mov     addr+1,a
                +1  4286             mov     a,addr+2
                +1  4287             rrc     a
                +1  4288             mov     addr+2,a
                +1  4289             mov     a,addr+3
                +1  4290             rrc     a
                +1  4291             mov     addr+3,a
                +1  4292             endm
                +1  4293     
                +1  4294     shfup   macro  addr
                +1  4295             clr     c
                +1  4296             mov     a,addr+3
                +1  4297             rlc     a
                +1  4298             mov     addr+3,a
                +1  4299             mov     a,addr+2
                +1  4300             rlc     a
                +1  4301             mov     addr+2,a
                +1  4302             mov     a,addr+1
                +1  4303             rlc     a
                +1  4304             mov     addr+1,a
                +1  4305             mov     a,addr
                +1  4306             rlc     a
                +1  4307             mov     addr,a
                +1  4308             endm
                +1  4309     
                +1  4310     rshift  macro
                +1  4311             clr     c
                +1  4312             mov     a,r2
                +1  4313             rrc     a
                +1  4314             mov     r2,a
                +1  4315             mov     a,r3
                +1  4316             rrc     a
                +1  4317             mov     r3,a
                +1  4318             mov     a,r4
                +1  4319             rrc     a
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    68

                +1  4320             mov     r4,a
                +1  4321             mov     a,r5
                +1  4322             rrc     a
                +1  4323             mov     r5,a
                +1  4324             endm
                +1  4325     rshift1 macro
                +1  4326             setb    c
                +1  4327             mov     a,r2
                +1  4328             rrc     a
                +1  4329             mov     r2,a
                +1  4330             mov     a,r3
                +1  4331             rrc     a
                +1  4332             mov     r3,a
                +1  4333             mov     a,r4
                +1  4334             rrc     a
                +1  4335             mov     r4,a
                +1  4336             mov     a,r5
                +1  4337             rrc     a
                +1  4338             mov     r5,a
                +1  4339             endm
                +1  4340     
                +1  4341     
                +1  4342     lshift  macro
                +1  4343             mov     a,r5
                +1  4344             rlc     a
                +1  4345             mov     r5,a
                +1  4346             mov     a,r4
                +1  4347             rlc     a
                +1  4348             mov     r4,a
                +1  4349             mov     a,r3
                +1  4350             rlc     a
                +1  4351             mov     r3,a
                +1  4352             mov     a,r2
                +1  4353             rlc     a
                +1  4354             mov     r2,a
                +1  4355             endm
                +1  4356     
                +1  4357     neg1    macro
                +1  4358             clr     c
                +1  4359             clr     a
                +1  4360             subb    a,r5
                +1  4361             mov     r5,a
                +1  4362             clr     a
                +1  4363             subb    a,r4
                +1  4364             mov     r4,a
                +1  4365             clr     a
                +1  4366             subb    a,r3
                +1  4367             mov     r3,a
                +1  4368             clr     a
                +1  4369             subb    a,r2
                +1  4370             mov     r2,a
                +1  4371             endm
                +1  4372     
                +1  4373     negm    macro  addr
                +1  4374             clr     c
                +1  4375             clr     a
                +1  4376             subb    a,addr+3
                +1  4377             mov     addr+3,a
                +1  4378             clr     a
                +1  4379             subb    a,addr+2
                +1  4380             mov     addr+2,a
                +1  4381             clr     a
                +1  4382             subb    a,addr+1
                +1  4383             mov     addr+1,a
                +1  4384             clr     a
                +1  4385             subb    a,addr
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    69

                +1  4386             mov     addr,a
                +1  4387             endm
                +1  4388     
                +1  4389     copytor macro  addr
                +1  4390             mov     r2,addr
                +1  4391             mov     r3,addr+1
                +1  4392             mov     r4,addr+2
                +1  4393             mov     r5,addr+3
                +1  4394             endm
                +1  4395     
                +1  4396     
                +1  4397     copyrto macro  addr
                +1  4398             mov     addr,r2
                +1  4399             mov     addr+1,r3
                +1  4400             mov     addr+2,r4
                +1  4401             mov     addr+3,r5
                +1  4402             endm
                +1  4403     
                +1  4404     
                +1  4405     ;       Internal representation: in this set of routines a floating number
                +1  4406     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  4407     
                +1  4408     ;       Stack offset values
                +1  4409     ;ltemp   equ     28h
                +1  4410     
  0006          +1  4411     cntr    equ     6               ;r6 is the counter
  0007          +1  4412     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  4413     exp1    equ     0               ;exponent 1 in r0
  0002          +1  4414     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  4415     exp2    equ     1               ;exponent 1 in r1
  0008          +1  4416     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  4417     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  4418     
                +1  4419     
                +1  4420     
                +1  4421     
                +1  4422     
                +1  4423     ;DECSIZE EQU     10
                +1  4424     ;NUMSIZE EQU     4
                +1  4425     ;RR4     EQU     4
                +1  4426     ;RR5     EQU     5
                +1  4427     
                +1  4428     ;       unpack1 - unpacks the left operand
                +1  4429     
009E            +1  4430     unpack1:
009E EA         +1  4431             mov     a,r2            ;get sign
009F 5480       +1  4432             anl     a,#80h
00A1 530740     +1  4433             anl     sign,#40h       ;clear other bits
00A4 4207       +1  4434             orl     sign,a          ;store sign
00A6 EB         +1  4435             mov     a,r3            ;get lsb of exponent
00A7 33         +1  4436             rlc     a               ;rotate into carry
00A8 EA         +1  4437             mov     a,r2            ;get rest of exponent
00A9 33         +1  4438             rlc     a               ;and make it 8 bits
00AA F8         +1  4439             mov     r0,a            ;store it
00AB 6006       +1  4440             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  4441             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  4442             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  4443             ret
00B3            +1  4444     zer1:
00B3 E4         +1  4445             clr     a
00B4 FA         +1  4446             mov     r2,a
00B5 FB         +1  4447             mov     r3,a
00B6 FC         +1  4448             mov     r4,a
00B7 FD         +1  4449             mov     r5,a            ;zero mantissa
00B8 F8         +1  4450             mov     r0,a            ;zero exponent
00B9 22         +1  4451             ret
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    70

                +1  4452     
                +1  4453     ;       unpack2 - unpacks right operand
                +1  4454     
00BA            +1  4455     unpack2:
00BA E508       +1  4456             mov     a,ltemp         ;get sign
00BC 13         +1  4457             rrc     a               ;shift down
00BD 5440       +1  4458             anl     a,#40h          ;mask out sign
00BF 530780     +1  4459             anl     sign,#80h       ;clear old bit
00C2 4207       +1  4460             orl     sign,a
00C4 E509       +1  4461             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  4462             rlc     a               ;rotate into carry
00C7 E508       +1  4463             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  4464             rlc     a               ;and make it 8 bits
00CA F9         +1  4465             mov     r1,a            ;store it
00CB 6007       +1  4466             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  4467             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  4468             mov     mant2,#0        ;clear upper byte
00D3 22         +1  4469             ret
00D4            +1  4470     zer2:
00D4 E4         +1  4471             clr     a
00D5 F508       +1  4472             mov     ltemp,a
00D7 F509       +1  4473             mov     ltemp+1,a
00D9 F50A       +1  4474             mov     ltemp+2,a
00DB F50B       +1  4475             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  4476             ret
                +1  4477     
                +1  4478     ;       pack1 - put operand 1 back into float format
                +1  4479     
00DE            +1  4480     pack1:
00DE E8         +1  4481             mov     a,r0            ;get exponent
00DF C3         +1  4482             clr     c
00E0 13         +1  4483             rrc     a               ;shift down 1 bit
00E1 530780     +1  4484             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  4485             orl     a,r7            ;or in sign bit
00E5 FA         +1  4486             mov     r2,a            ;store
00E6 E8         +1  4487             mov     a,r0            ;get other bit
00E7 03         +1  4488             rr      a               ;rotate into hi bit
00E8 5480       +1  4489             anl     a,#80h          ;mask
00EA 53037F     +1  4490             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  4491             orl     mant1+1,a       ;put in
00EF 22         +1  4492             ret
                +1  4493     
                +1  4494     
                +1  4495     ;       norm1 - normalize the unpacked value in 1
                +1  4496     
00F0            +1  4497     norm1:
00F0 E8         +1  4498             mov     a,r0            ;get exponent
00F1 60C0       +1  4499             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  4500             mov     a,r2            ;get hi byte
00F4 6023       +1  4501             jz      norup           ;zero, so shift up if anything
00F6            +1  4502     nordn:
00F6 EA         +1  4503             mov     a,r2            ;get hi byte
00F7 B4010D     +1  4504             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  4505+3           add1                    ;add in a rounding bit
00FA ED         +1  4506+1           mov     a,r5
00FB 2401       +1  4507+1           add     a,#1
00FD FD         +1  4508+1           mov     r5,a
00FE E4         +1  4509+1           clr     a
00FF 3C         +1  4510+1           addc    a,r4
0100 FC         +1  4511+1           mov     r4,a
0101 E4         +1  4512+1           clr     a
0102 3B         +1  4513+1           addc    a,r3
0103 FB         +1  4514+1           mov     r3,a
0104 E4         +1  4515+1           clr     a
0105 3A         +1  4516+1           addc    a,r2
0106 FA         +1  4517+1           mov     r2,a
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    71

0107            +1  4518     nordn1:
                +1  4519+3           rshift                  ;shift down 1 bit
0107 C3         +1  4520+1           clr     c
0108 EA         +1  4521+1           mov     a,r2
0109 13         +1  4522+1           rrc     a
010A FA         +1  4523+1           mov     r2,a
010B EB         +1  4524+1           mov     a,r3
010C 13         +1  4525+1           rrc     a
010D FB         +1  4526+1           mov     r3,a
010E EC         +1  4527+1           mov     a,r4
010F 13         +1  4528+1           rrc     a
0110 FC         +1  4529+1           mov     r4,a
0111 ED         +1  4530+1           mov     a,r5
0112 13         +1  4531+1           rrc     a
0113 FD         +1  4532+1           mov     r5,a
0114 08         +1  4533             inc     r0              ;adjust exponent
0115 EA         +1  4534             mov     a,r2            ;test high byte
0116 70DE       +1  4535             jnz     nordn           ;loop
0118 22         +1  4536             ret                     ;done
                +1  4537     
0119            +1  4538     norup:
0119 4B         +1  4539             orl     a,r3
011A 4C         +1  4540             orl     a,r4
011B 4D         +1  4541             orl     a,r5            ;test for zero mantissa
011C 6095       +1  4542             jz      zer1            ;it is - make it true zero
011E            +1  4543     norup1:
011E EB         +1  4544             mov     a,r3            ;get mantissa byte
011F 20E710     +1  4545             jb      acc.7,norup2    ;jump if set
0122 C3         +1  4546             clr     c
                +1  4547+3           lshift                  ;shift mantissa up
0123 ED         +1  4548+1           mov     a,r5
0124 33         +1  4549+1           rlc     a
0125 FD         +1  4550+1           mov     r5,a
0126 EC         +1  4551+1           mov     a,r4
0127 33         +1  4552+1           rlc     a
0128 FC         +1  4553+1           mov     r4,a
0129 EB         +1  4554+1           mov     a,r3
012A 33         +1  4555+1           rlc     a
012B FB         +1  4556+1           mov     r3,a
012C EA         +1  4557+1           mov     a,r2
012D 33         +1  4558+1           rlc     a
012E FA         +1  4559+1           mov     r2,a
012F 18         +1  4560             dec     r0              ;adjust exponent
0130 80EC       +1  4561             jmp     norup1
0132            +1  4562     norup2:
0132 22         +1  4563             ret                     ;finito
                +1  4564     
                +1  4565     
                +1  4566     ;       fpdenorm - denormalize one of the two operands so that their
                +1  4567     ;       exponents are equal. This requires the smaller number to have
                +1  4568     ;       its exponent incremented and its mantissa shifted right.
                +1  4569     
0133            +1  4570     denorm:
0133 E8         +1  4571             mov     a,r0
0134 C3         +1  4572             clr     c
0135 99         +1  4573             subb    a,r1            ;compare exponents
0136 5029       +1  4574             jnc     up2a            ;shift operand 2
0138            +1  4575     up1:
0138 08         +1  4576             inc     r0              ;increment exponent
                +1  4577+3           rshift                  ;shift mantissa down
0139 C3         +1  4578+1           clr     c
013A EA         +1  4579+1           mov     a,r2
013B 13         +1  4580+1           rrc     a
013C FA         +1  4581+1           mov     r2,a
013D EB         +1  4582+1           mov     a,r3
013E 13         +1  4583+1           rrc     a
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    72

013F FB         +1  4584+1           mov     r3,a
0140 EC         +1  4585+1           mov     a,r4
0141 13         +1  4586+1           rrc     a
0142 FC         +1  4587+1           mov     r4,a
0143 ED         +1  4588+1           mov     a,r5
0144 13         +1  4589+1           rrc     a
0145 FD         +1  4590+1           mov     r5,a
0146 E8         +1  4591             mov     a,r0
0147 B501EE     +1  4592             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  4593             ret
                +1  4594     
014B            +1  4595     up2:
014B 09         +1  4596             inc     r1              ;increment exponent 2
                +1  4597+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  4598+1           clr     c
014D E508       +1  4599+1           mov     a,mant2
014F 13         +1  4600+1           rrc     a
0150 F508       +1  4601+1           mov     mant2,a
0152 E509       +1  4602+1           mov     a,mant2+1
0154 13         +1  4603+1           rrc     a
0155 F509       +1  4604+1           mov     mant2+1,a
0157 E50A       +1  4605+1           mov     a,mant2+2
0159 13         +1  4606+1           rrc     a
015A F50A       +1  4607+1           mov     mant2+2,a
015C E50B       +1  4608+1           mov     a,mant2+3
015E 13         +1  4609+1           rrc     a
015F F50B       +1  4610+1           mov     mant2+3,a
0161            +1  4611     up2a:
0161 E8         +1  4612             mov     a,r0            ;compare exponents
0162 B501E6     +1  4613             cjne    a,exp2,up2
0165 22         +1  4614             ret                     ;all done
                +1  4615     ;------------------------------------------------------------------
                +1  4616     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  4617     
0166            +1  4618     fladd:
                +1  4619+3           saveregs
0166 C007       +1  4620+1           push    7
0168 C006       +1  4621+1           push    6
016A C001       +1  4622+1           push    1
016C C000       +1  4623+1           push    0
016E 119E       +1  4624             call    unpack1
0170 11BA       +1  4625             call    unpack2
0172 3133       +1  4626             call    denorm
0174 E507       +1  4627             mov     a,sign
0176 30E70D     +1  4628             jnb     acc.7,ok1       ;test left sign
                +1  4629+3           neg1                    ;negate op1
0179 C3         +1  4630+1           clr     c
017A E4         +1  4631+1           clr     a
017B 9D         +1  4632+1           subb    a,r5
017C FD         +1  4633+1           mov     r5,a
017D E4         +1  4634+1           clr     a
017E 9C         +1  4635+1           subb    a,r4
017F FC         +1  4636+1           mov     r4,a
0180 E4         +1  4637+1           clr     a
0181 9B         +1  4638+1           subb    a,r3
0182 FB         +1  4639+1           mov     r3,a
0183 E4         +1  4640+1           clr     a
0184 9A         +1  4641+1           subb    a,r2
0185 FA         +1  4642+1           mov     r2,a
0186            +1  4643     ok1:
0186 E507       +1  4644             mov     a,sign
0188 30E615     +1  4645             jnb     acc.6,ok2       ;test right sign
                +1  4646+3           negm    mant2           ;negate op2
018B C3         +1  4647+1           clr     c
018C E4         +1  4648+1           clr     a
018D 950B       +1  4649+1           subb    a,mant2+3
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    73

018F F50B       +1  4650+1           mov     mant2+3,a
0191 E4         +1  4651+1           clr     a
0192 950A       +1  4652+1           subb    a,mant2+2
0194 F50A       +1  4653+1           mov     mant2+2,a
0196 E4         +1  4654+1           clr     a
0197 9509       +1  4655+1           subb    a,mant2+1
0199 F509       +1  4656+1           mov     mant2+1,a
019B E4         +1  4657+1           clr     a
019C 9508       +1  4658+1           subb    a,mant2
019E F508       +1  4659+1           mov     mant2,a
01A0            +1  4660     ok2:
                +1  4661+3           addl    mant2           ;add mantissas
01A0 ED         +1  4662+1           mov     a,r5
01A1 250B       +1  4663+1           add     a,mant2+3
01A3 FD         +1  4664+1           mov     r5,a
01A4 E50A       +1  4665+1           mov     a,mant2+2
01A6 3C         +1  4666+1           addc    a,r4
01A7 FC         +1  4667+1           mov     r4,a
01A8 E509       +1  4668+1           mov     a,mant2+1
01AA 3B         +1  4669+1           addc    a,r3
01AB FB         +1  4670+1           mov     r3,a
01AC E508       +1  4671+1           mov     a,mant2+0
01AE 3A         +1  4672+1           addc    a,r2
01AF FA         +1  4673+1           mov     r2,a
01B0 E4         +1  4674             clr     a
01B1 FF         +1  4675             mov     r7,a            ;clear sign
01B2 EA         +1  4676             mov     a,r2            ;get sign of result
01B3 30E70E     +1  4677             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  4678             mov     r7,a            ;store sign
                +1  4679+3           neg1                    ;negate mantissa
01B7 C3         +1  4680+1           clr     c
01B8 E4         +1  4681+1           clr     a
01B9 9D         +1  4682+1           subb    a,r5
01BA FD         +1  4683+1           mov     r5,a
01BB E4         +1  4684+1           clr     a
01BC 9C         +1  4685+1           subb    a,r4
01BD FC         +1  4686+1           mov     r4,a
01BE E4         +1  4687+1           clr     a
01BF 9B         +1  4688+1           subb    a,r3
01C0 FB         +1  4689+1           mov     r3,a
01C1 E4         +1  4690+1           clr     a
01C2 9A         +1  4691+1           subb    a,r2
01C3 FA         +1  4692+1           mov     r2,a
01C4            +1  4693     ok3:
01C4 11F0       +1  4694             call    norm1
01C6 11DE       +1  4695             call    pack1           ;pack normalized result
                +1  4696+3           restregs                ;and return
01C8 D000       +1  4697+1           pop     0
01CA D001       +1  4698+1           pop     1
01CC D006       +1  4699+1           pop     6
01CE D007       +1  4700+1           pop     7
01D0 22         +1  4701             ret
                +1  4702     ;-------------------------------------------------------------
                +1  4703     ;       Subtract the number ltemp from the number in r2-r5
                +1  4704     
01D1            +1  4705     flsub:
01D1 630880     +1  4706             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  4707             jmp     fladd           ;and add!
                +1  4708     
                +1  4709     ;================================================================
                +1  4710     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  4711     
01D6            +1  4712     flcmp:
01D6 EA         +1  4713            mov     a,r2            ;get sign of left
01D7 6508       +1  4714            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  4715            jnb     acc.7,cexp      ;same, go check exponent
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    74

                +1  4716     ;ifdef SMALL_MODEL
01DC EA         +1  4717             mov     a,r2            ;get sign of left again
01DD 33         +1  4718             rlc     a
01DE 5001       +1  4719             jnc     flout
                +1  4720     ;endif
01E0 D3         +1  4721             setb    c
01E1 22         +1  4722     flout:          ret                    ;return with acc < 0
                +1  4723     
01E2            +1  4724     cexp:
01E2 C3         +1  4725            clr     c
01E3 EA         +1  4726            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  4727            subb    a,ltemp
01E6 7010       +1  4728            jnz     fnd
01E8 EB         +1  4729            mov     a,r3
01E9 9509       +1  4730            subb    a,ltemp+1
01EB 700B       +1  4731            jnz     fnd
01ED EC         +1  4732            mov     a,r4
01EE 950A       +1  4733            subb    a,ltemp+2
01F0 7006       +1  4734            jnz     fnd
01F2 ED         +1  4735            mov     a,r5
01F3 950B       +1  4736            subb    a,ltemp+3
01F5 7001       +1  4737            jnz     fnd
01F7            +1  4738     cdone:
01F7 22         +1  4739            ret                     ;return with acc == 0
01F8            +1  4740     fnd:
01F8 8AF0       +1  4741           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  4742          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  4743            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  4744                         orl         a,#1                          ;make non-zero
0201 B3         +1  4745             cpl     c               ;c=0->1,c=1->0
0202 22         +1  4746             ret
                +1  4747     ;==============================================================
                +1  4748     
                +1  4749     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  4750     ;       the result in r2-r5
                +1  4751     
0203            +1  4752     flmul:
                +1  4753+3           saveregs
0203 C007       +1  4754+1           push    7
0205 C006       +1  4755+1           push    6
0207 C001       +1  4756+1           push    1
0209 C000       +1  4757+1           push    0
020B 119E       +1  4758             call    unpack1
020D 11BA       +1  4759             call    unpack2
020F E4         +1  4760             clr     a
0210 F50C       +1  4761             mov     prod,a
0212 F50D       +1  4762             mov     prod+1,a        ;clear product
0214 F50E       +1  4763             mov     prod+2,a
0216 F50F       +1  4764             mov     prod+3,a
0218 7E07       +1  4765             mov     r6,#7           ;initialize counter
021A            +1  4766     mup1:
                +1  4767+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  4768+1           clr     c
021B E508       +1  4769+1           mov     a,mant2
021D 13         +1  4770+1           rrc     a
021E F508       +1  4771+1           mov     mant2,a
0220 E509       +1  4772+1           mov     a,mant2+1
0222 13         +1  4773+1           rrc     a
0223 F509       +1  4774+1           mov     mant2+1,a
0225 E50A       +1  4775+1           mov     a,mant2+2
0227 13         +1  4776+1           rrc     a
0228 F50A       +1  4777+1           mov     mant2+2,a
022A E50B       +1  4778+1           mov     a,mant2+3
022C 13         +1  4779+1           rrc     a
022D F50B       +1  4780+1           mov     mant2+3,a
022F 5014       +1  4781             jnc     nobit           ;skip if lsb was zero
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    75

                +1  4782+3           dan     prod            ;add multiplicand to product
0231 ED         +1  4783+1           mov     a,r5
0232 250F       +1  4784+1           add     a,prod+3
0234 F50F       +1  4785+1           mov     prod+3,a
0236 E50E       +1  4786+1           mov     a,prod+2
0238 3C         +1  4787+1           addc    a,r4
0239 F50E       +1  4788+1           mov     prod+2,a
023B E50D       +1  4789+1           mov     a,prod+1
023D 3B         +1  4790+1           addc    a,r3
023E F50D       +1  4791+1           mov     prod+1,a
0240 E50C       +1  4792+1           mov     a,prod+0
0242 3A         +1  4793+1           addc    a,r2
0243 F50C       +1  4794+1           mov     prod,a
0245            +1  4795     nobit:
                +1  4796+3           lshift                  ;shift multiplicand up
0245 ED         +1  4797+1           mov     a,r5
0246 33         +1  4798+1           rlc     a
0247 FD         +1  4799+1           mov     r5,a
0248 EC         +1  4800+1           mov     a,r4
0249 33         +1  4801+1           rlc     a
024A FC         +1  4802+1           mov     r4,a
024B EB         +1  4803+1           mov     a,r3
024C 33         +1  4804+1           rlc     a
024D FB         +1  4805+1           mov     r3,a
024E EA         +1  4806+1           mov     a,r2
024F 33         +1  4807+1           rlc     a
0250 FA         +1  4808+1           mov     r2,a
0251 DEC7       +1  4809             djnz    r6,mup1         ;loop if more
                +1  4810     
0253 7E11       +1  4811             mov     r6,#17          ;re-initalize counter
0255 8015       +1  4812             sjmp    mup3
0257            +1  4813     mup11:
                +1  4814+3           shfdn   prod            ;shift product right
0257 C3         +1  4815+1           clr     c
0258 E50C       +1  4816+1           mov     a,prod
025A 13         +1  4817+1           rrc     a
025B F50C       +1  4818+1           mov     prod,a
025D E50D       +1  4819+1           mov     a,prod+1
025F 13         +1  4820+1           rrc     a
0260 F50D       +1  4821+1           mov     prod+1,a
0262 E50E       +1  4822+1           mov     a,prod+2
0264 13         +1  4823+1           rrc     a
0265 F50E       +1  4824+1           mov     prod+2,a
0267 E50F       +1  4825+1           mov     a,prod+3
0269 13         +1  4826+1           rrc     a
026A F50F       +1  4827+1           mov     prod+3,a
026C            +1  4828     mup3:
                +1  4829+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  4830+1           clr     c
026D E508       +1  4831+1           mov     a,mant2
026F 13         +1  4832+1           rrc     a
0270 F508       +1  4833+1           mov     mant2,a
0272 E509       +1  4834+1           mov     a,mant2+1
0274 13         +1  4835+1           rrc     a
0275 F509       +1  4836+1           mov     mant2+1,a
0277 E50A       +1  4837+1           mov     a,mant2+2
0279 13         +1  4838+1           rrc     a
027A F50A       +1  4839+1           mov     mant2+2,a
027C E50B       +1  4840+1           mov     a,mant2+3
027E 13         +1  4841+1           rrc     a
027F F50B       +1  4842+1           mov     mant2+3,a
0281 5014       +1  4843             jnc     mup2            ;skip if bit not set
                +1  4844+3           dan     prod            ;add to prod
0283 ED         +1  4845+1           mov     a,r5
0284 250F       +1  4846+1           add     a,prod+3
0286 F50F       +1  4847+1           mov     prod+3,a
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    76

0288 E50E       +1  4848+1           mov     a,prod+2
028A 3C         +1  4849+1           addc    a,r4
028B F50E       +1  4850+1           mov     prod+2,a
028D E50D       +1  4851+1           mov     a,prod+1
028F 3B         +1  4852+1           addc    a,r3
0290 F50D       +1  4853+1           mov     prod+1,a
0292 E50C       +1  4854+1           mov     a,prod+0
0294 3A         +1  4855+1           addc    a,r2
0295 F50C       +1  4856+1           mov     prod,a
0297            +1  4857     mup2:
0297 DEBE       +1  4858             djnz    r6,mup11        ;loop if more
0299 E8         +1  4859             mov     a,r0            ;get exp1
029A 29         +1  4860             add     a,r1            ;add exp2
029B 247A       +1  4861             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  4862             mov     r0,a            ;store
029E EF         +1  4863             mov     a,r7            ;get sign
029F 23         +1  4864             rl      a               ;rotate bit into msb
02A0 6207       +1  4865             xrl     sign,a          ;xor with other bit
                +1  4866+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  4867+1           mov     r2,prod
02A4 AB0D       +1  4868+1           mov     r3,prod+1
02A6 AC0E       +1  4869+1           mov     r4,prod+2
02A8 AD0F       +1  4870+1           mov     r5,prod+3
02AA 11F0       +1  4871             call    norm1           ;normalize
02AC 11DE       +1  4872             call    pack1
                +1  4873+3           restregs
02AE D000       +1  4874+1           pop     0
02B0 D001       +1  4875+1           pop     1
02B2 D006       +1  4876+1           pop     6
02B4 D007       +1  4877+1           pop     7
02B6 22         +1  4878             ret
                +1  4879     ;-----------------------------------------------------------
                +1  4880     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  4881     
02B7            +1  4882     fldiv:
                +1  4883+3           saveregs
02B7 C007       +1  4884+1           push    7
02B9 C006       +1  4885+1           push    6
02BB C001       +1  4886+1           push    1
02BD C000       +1  4887+1           push    0
02BF 119E       +1  4888             call    unpack1
02C1 11BA       +1  4889             call    unpack2
02C3 E4         +1  4890             clr     a
02C4 F50C       +1  4891             mov     prod,a
02C6 F50D       +1  4892             mov     prod+1,a
02C8 F50E       +1  4893             mov     prod+2,a
02CA F50F       +1  4894             mov     prod+3,a
02CC E9         +1  4895             mov     a,r1            ;check for zero divisor
02CD 6067       +1  4896             jz      div9
02CF E8         +1  4897             mov     a,r0            ;check for zero dividend
02D0 6064       +1  4898             jz      div9
02D2 C3         +1  4899             clr     c
02D3 99         +1  4900             subb    a,r1            ;compute new exponent
02D4 2478       +1  4901             add     a,#127-7        ;unbias
02D6 F8         +1  4902             mov     r0,a            ;store back
02D7 EF         +1  4903             mov     a,r7            ;get sign
02D8 23         +1  4904             rl      a
02D9 6207       +1  4905             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  4906             mov     r6,#24+7        ;initialize counter
02DD            +1  4907     div1:
                +1  4908+3           shfup   prod            ;shift quotient up
02DD C3         +1  4909+1           clr     c
02DE E50F       +1  4910+1           mov     a,prod+3
02E0 33         +1  4911+1           rlc     a
02E1 F50F       +1  4912+1           mov     prod+3,a
02E3 E50E       +1  4913+1           mov     a,prod+2
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    77

02E5 33         +1  4914+1           rlc     a
02E6 F50E       +1  4915+1           mov     prod+2,a
02E8 E50D       +1  4916+1           mov     a,prod+1
02EA 33         +1  4917+1           rlc     a
02EB F50D       +1  4918+1           mov     prod+1,a
02ED E50C       +1  4919+1           mov     a,prod
02EF 33         +1  4920+1           rlc     a
02F0 F50C       +1  4921+1           mov     prod,a
02F2 C3         +1  4922             clr     c
02F3 EA         +1  4923             mov     a,r2            ;compare values
02F4 9508       +1  4924             subb    a,mant2
02F6 4028       +1  4925             jc      div2            ;skip if bigger
02F8 7013       +1  4926             jnz     div3
02FA EB         +1  4927             mov     a,r3            ;compare values
02FB 9509       +1  4928             subb    a,mant2+1
02FD 4021       +1  4929             jc      div2            ;skip if bigger
02FF 700C       +1  4930             jnz     div3
0301 EC         +1  4931             mov     a,r4            ;compare values
0302 950A       +1  4932             subb    a,mant2+2
0304 401A       +1  4933             jc      div2            ;skip if bigger
0306 7005       +1  4934             jnz     div3
0308 ED         +1  4935             mov     a,r5            ;compare values
0309 950B       +1  4936             subb    a,mant2+3
030B 4013       +1  4937             jc      div2            ;skip if bigger
030D            +1  4938     div3:
030D ED         +1  4939             mov     a,r5
030E 950B       +1  4940             subb    a,mant2+3
0310 FD         +1  4941             mov     r5,a
0311 EC         +1  4942             mov     a,r4
0312 950A       +1  4943             subb    a,mant2+2               ;do subtraction
0314 FC         +1  4944             mov     r4,a
0315 EB         +1  4945             mov     a,r3
0316 9509       +1  4946             subb    a,mant2+1               ;do subtraction
0318 FB         +1  4947             mov     r3,a
0319 EA         +1  4948             mov     a,r2
031A 9508       +1  4949             subb    a,mant2         ;do subtraction
031C FA         +1  4950             mov     r2,a
031D 430F01     +1  4951             orl     prod+3,#1       ;set lsb in quotient
0320            +1  4952     div2:
                +1  4953+3           lshift                  ;shift dividend up
0320 ED         +1  4954+1           mov     a,r5
0321 33         +1  4955+1           rlc     a
0322 FD         +1  4956+1           mov     r5,a
0323 EC         +1  4957+1           mov     a,r4
0324 33         +1  4958+1           rlc     a
0325 FC         +1  4959+1           mov     r4,a
0326 EB         +1  4960+1           mov     a,r3
0327 33         +1  4961+1           rlc     a
0328 FB         +1  4962+1           mov     r3,a
0329 EA         +1  4963+1           mov     a,r2
032A 33         +1  4964+1           rlc     a
032B FA         +1  4965+1           mov     r2,a
032C DEAF       +1  4966             djnz    r6,div1         ;loop if more
                +1  4967+3           copytor prod            ;copy quotient
032E AA0C       +1  4968+1           mov     r2,prod
0330 AB0D       +1  4969+1           mov     r3,prod+1
0332 AC0E       +1  4970+1           mov     r4,prod+2
0334 AD0F       +1  4971+1           mov     r5,prod+3
0336            +1  4972     div9:
0336 11F0       +1  4973             call    norm1           ;now normalize result
0338 11DE       +1  4974             call    pack1           ;pack it up
                +1  4975+3           restregs                ;restore registers
033A D000       +1  4976+1           pop     0
033C D001       +1  4977+1           pop     1
033E D006       +1  4978+1           pop     6
0340 D007       +1  4979+1           pop     7
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    78

0342 22         +1  4980             ret
                +1  4981     ;------------------------------------------------------------------
                +1  4982     
                +1  4983     ;       Float to long conversion: if the exponent is less than the
                +1  4984     ;       excess value, the result is zero. If the exponent is so large
                +1  4985     ;       that the value would be shifted out, the result is overflow.
                +1  4986     ;       Otherwise shift the mantissa up or down as required.
                +1  4987     
0343            +1  4988     ftol:
                +1  4989+3           saveregs
0343 C007       +1  4990+1           push    7
0345 C006       +1  4991+1           push    6
0347 C001       +1  4992+1           push    1
0349 C000       +1  4993+1           push    0
034B EA         +1  4994             mov     a,r2
034C B4BF09     +1  4995             cjne    a,#0bfh,ne05
034F EB         +1  4996             mov     a,r3
0350 7006       +1  4997             jnz     ne05
0352 EC         +1  4998             mov     a,r4
0353 7003       +1  4999             jnz     ne05
0355 ED         +1  5000             mov     a,r5
0356 6024       +1  5001             jz      ftol1
0358 119E       +1  5002     ne05:   call    unpack1
035A E8         +1  5003             mov     a,r0            ;get exponent
035B 2482       +1  5004             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  5005             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  5006             mov     a,r7            ;get sign
0361 30E70D     +1  5007             jnb     acc.7,ftol4     ;skip if +ve
                +1  5008+3           neg1                    ;negate it
0364 C3         +1  5009+1           clr     c
0365 E4         +1  5010+1           clr     a
0366 9D         +1  5011+1           subb    a,r5
0367 FD         +1  5012+1           mov     r5,a
0368 E4         +1  5013+1           clr     a
0369 9C         +1  5014+1           subb    a,r4
036A FC         +1  5015+1           mov     r4,a
036B E4         +1  5016+1           clr     a
036C 9B         +1  5017+1           subb    a,r3
036D FB         +1  5018+1           mov     r3,a
036E E4         +1  5019+1           clr     a
036F 9A         +1  5020+1           subb    a,r2
0370 FA         +1  5021+1           mov     r2,a
0371            +1  5022     ftol4:
0371 E8         +1  5023             mov     a,r0            ;get exponent
0372 246A       +1  5024             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  5025             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  5026             mov     r0,a            ;save it
0378 24F8       +1  5027             add     a,#-8           ;if > 8, too big
037A 500E       +1  5028             jnc     ftol3
037C            +1  5029     ftol1:
037C E4         +1  5030             clr     a
037D FA         +1  5031             mov     r2,a
037E FB         +1  5032             mov     r3,a
037F FC         +1  5033             mov     r4,a
0380 FD         +1  5034             mov     r5,a
0381            +1  5035     ftol9:
                +1  5036+3           restregs
0381 D000       +1  5037+1           pop     0
0383 D001       +1  5038+1           pop     1
0385 D006       +1  5039+1           pop     6
0387 D007       +1  5040+1           pop     7
0389 22         +1  5041             ret
038A            +1  5042     ftol3:
038A E8         +1  5043             mov     a,r0
038B FE         +1  5044             mov     r6,a            ;store in counter
038C 60F3       +1  5045             jz      ftol9           ;if zero, do nothing
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    79

038E            +1  5046     ftol33:
                +1  5047+3           lshift                  ;shift up
038E ED         +1  5048+1           mov     a,r5
038F 33         +1  5049+1           rlc     a
0390 FD         +1  5050+1           mov     r5,a
0391 EC         +1  5051+1           mov     a,r4
0392 33         +1  5052+1           rlc     a
0393 FC         +1  5053+1           mov     r4,a
0394 EB         +1  5054+1           mov     a,r3
0395 33         +1  5055+1           rlc     a
0396 FB         +1  5056+1           mov     r3,a
0397 EA         +1  5057+1           mov     a,r2
0398 33         +1  5058+1           rlc     a
0399 FA         +1  5059+1           mov     r2,a
039A DEF2       +1  5060             djnz    r6,ftol33       ;and loop
039C 80E3       +1  5061             sjmp    ftol9
039E            +1  5062     ftol2:
039E F4         +1  5063             cpl     a               ;complement
039F FE         +1  5064             mov     r6,a
03A0 6022       +1  5065             jz      ftol22
03A2            +1  5066     ftol23:
03A2 EF         +1  5067             mov     a,r7
03A3 30E70F     +1  5068             jnb     acc.7,ftol24
                +1  5069+3           rshift1
03A6 D3         +1  5070+1           setb    c
03A7 EA         +1  5071+1           mov     a,r2
03A8 13         +1  5072+1           rrc     a
03A9 FA         +1  5073+1           mov     r2,a
03AA EB         +1  5074+1           mov     a,r3
03AB 13         +1  5075+1           rrc     a
03AC FB         +1  5076+1           mov     r3,a
03AD EC         +1  5077+1           mov     a,r4
03AE 13         +1  5078+1           rrc     a
03AF FC         +1  5079+1           mov     r4,a
03B0 ED         +1  5080+1           mov     a,r5
03B1 13         +1  5081+1           rrc     a
03B2 FD         +1  5082+1           mov     r5,a
03B3 800D       +1  5083             jmp     ftol25
03B5            +1  5084+3   ftol24: rshift                  ;shift down
03B5 C3         +1  5085+1           clr     c
03B6 EA         +1  5086+1           mov     a,r2
03B7 13         +1  5087+1           rrc     a
03B8 FA         +1  5088+1           mov     r2,a
03B9 EB         +1  5089+1           mov     a,r3
03BA 13         +1  5090+1           rrc     a
03BB FB         +1  5091+1           mov     r3,a
03BC EC         +1  5092+1           mov     a,r4
03BD 13         +1  5093+1           rrc     a
03BE FC         +1  5094+1           mov     r4,a
03BF ED         +1  5095+1           mov     a,r5
03C0 13         +1  5096+1           rrc     a
03C1 FD         +1  5097+1           mov     r5,a
03C2 DEDE       +1  5098     ftol25: djnz    r6,ftol23
03C4            +1  5099     ftol22:
                +1  5100+3           add1                    ;round
03C4 ED         +1  5101+1           mov     a,r5
03C5 2401       +1  5102+1           add     a,#1
03C7 FD         +1  5103+1           mov     r5,a
03C8 E4         +1  5104+1           clr     a
03C9 3C         +1  5105+1           addc    a,r4
03CA FC         +1  5106+1           mov     r4,a
03CB E4         +1  5107+1           clr     a
03CC 3B         +1  5108+1           addc    a,r3
03CD FB         +1  5109+1           mov     r3,a
03CE E4         +1  5110+1           clr     a
03CF 3A         +1  5111+1           addc    a,r2
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    80

03D0 FA         +1  5112+1           mov     r2,a
03D1 EF         +1  5113             mov     a,r7
03D2 30E70F     +1  5114             jnb     acc.7,ftol26
                +1  5115+3           rshift1
03D5 D3         +1  5116+1           setb    c
03D6 EA         +1  5117+1           mov     a,r2
03D7 13         +1  5118+1           rrc     a
03D8 FA         +1  5119+1           mov     r2,a
03D9 EB         +1  5120+1           mov     a,r3
03DA 13         +1  5121+1           rrc     a
03DB FB         +1  5122+1           mov     r3,a
03DC EC         +1  5123+1           mov     a,r4
03DD 13         +1  5124+1           rrc     a
03DE FC         +1  5125+1           mov     r4,a
03DF ED         +1  5126+1           mov     a,r5
03E0 13         +1  5127+1           rrc     a
03E1 FD         +1  5128+1           mov     r5,a
03E2 809D       +1  5129             jmp     ftol9
03E4            +1  5130+3   ftol26: rshift
03E4 C3         +1  5131+1           clr     c
03E5 EA         +1  5132+1           mov     a,r2
03E6 13         +1  5133+1           rrc     a
03E7 FA         +1  5134+1           mov     r2,a
03E8 EB         +1  5135+1           mov     a,r3
03E9 13         +1  5136+1           rrc     a
03EA FB         +1  5137+1           mov     r3,a
03EB EC         +1  5138+1           mov     a,r4
03EC 13         +1  5139+1           rrc     a
03ED FC         +1  5140+1           mov     r4,a
03EE ED         +1  5141+1           mov     a,r5
03EF 13         +1  5142+1           rrc     a
03F0 FD         +1  5143+1           mov     r5,a
03F1 808E       +1  5144             jmp     ftol9
                +1  5145     
                +1  5146     ;       arithmetic integer to floating conversions
                +1  5147     
03F3            +1  5148     abtof:
03F3 ED         +1  5149             mov     a,r5
03F4 23         +1  5150             rl      a
03F5 FC         +1  5151             mov     r4,a
03F6 9C         +1  5152             subb    a,r4
03F7 FC         +1  5153             mov     r4,a
03F8 FB         +1  5154             mov     r3,a
03F9 FA         +1  5155             mov     r2,a
03FA 8006       +1  5156             jmp     altof
03FC            +1  5157     awtof:
03FC EC         +1  5158             mov     a,r4
03FD 23         +1  5159             rl      a
03FE FB         +1  5160             mov     r3,a
03FF 9B         +1  5161             subb    a,r3
0400 FB         +1  5162             mov     r3,a
0401 FA         +1  5163             mov     r2,a
0402            +1  5164     altof:
                +1  5165+3           saveregs
0402 C007       +1  5166+1           push    7
0404 C006       +1  5167+1           push    6
0406 C001       +1  5168+1           push    1
0408 C000       +1  5169+1           push    0
040A EA         +1  5170             mov     a,r2            ;get sign
040B 5480       +1  5171             anl     a,#80h
040D FF         +1  5172             mov     r7,a            ;store it
040E 30E70D     +1  5173             jnb     acc.7,altof1    ;skip if +ve
                +1  5174+3           neg1
0411 C3         +1  5175+1           clr     c
0412 E4         +1  5176+1           clr     a
0413 9D         +1  5177+1           subb    a,r5
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    81

0414 FD         +1  5178+1           mov     r5,a
0415 E4         +1  5179+1           clr     a
0416 9C         +1  5180+1           subb    a,r4
0417 FC         +1  5181+1           mov     r4,a
0418 E4         +1  5182+1           clr     a
0419 9B         +1  5183+1           subb    a,r3
041A FB         +1  5184+1           mov     r3,a
041B E4         +1  5185+1           clr     a
041C 9A         +1  5186+1           subb    a,r2
041D FA         +1  5187+1           mov     r2,a
041E            +1  5188     altof1:
041E 7896       +1  5189             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  5190             call    norm1           ;normalize it
0422 11DE       +1  5191             call    pack1           ;and pack up
                +1  5192+3           restregs
0424 D000       +1  5193+1           pop     0
0426 D001       +1  5194+1           pop     1
0428 D006       +1  5195+1           pop     6
042A D007       +1  5196+1           pop     7
042C 22         +1  5197             ret
                +1  5198     
042D            +1  5199     lbtof:
042D 7C00       +1  5200             mov     r4,#0
042F            +1  5201     lwtof:
042F E4         +1  5202             clr     a
0430 FB         +1  5203             mov     r3,a
0431 FA         +1  5204             mov     r2,a
0432            +1  5205     lltof:
                +1  5206+3           saveregs
0432 C007       +1  5207+1           push    7
0434 C006       +1  5208+1           push    6
0436 C001       +1  5209+1           push    1
0438 C000       +1  5210+1           push    0
043A 7F00       +1  5211             mov     r7,#0           ;zero sign
043C 80E0       +1  5212             sjmp    altof1
                +1  5213     
                +1  5214     ;-------------------------------------------------------
                +1  5215     
                +1  5216     
                    5217     
                    5218     ;$include (d:\amp\wriread.asm)
                +1  5219     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  5220     cle256:          mov            IE,#00H
0441 75B601     +1  5221                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  5222                              MOV            PSCTL,#03
                +1  5223                                             
0447 7400       +1  5224                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  5225                                     movx    @dptr,a                         ;wr
044A 758F00     +1  5226                                     mov             PSCTL,#00
044D 75B600     +1  5227                                 mov         FLSCL,#00
0450 75A880     +1  5228                               mov           IE,#80H
0453 22         +1  5229                                     ret
                +1  5230     
                +1  5231     ;чтение памяти программ в r8..r11
                +1  5232     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  5233     re4byte:        mov                     dph,r2
0456 8B82       +1  5234                                             mov                     dpl,r3
0458 E4         +1  5235                                             clr                     a
0459 93         +1  5236                                             movc            a,@a+dptr
045A F508       +1  5237                                             mov                     r8,a
045C A3         +1  5238                                             inc                     dptr
045D E4         +1  5239                                             clr                     a
045E 93         +1  5240                                             movc            a,@a+dptr
045F F509       +1  5241                                             mov                     r9,a
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    82

0461 A3         +1  5242                                             inc                     dptr
0462 E4         +1  5243                                             clr                     a
0463 93         +1  5244                                             movc            a,@a+dptr
0464 F50A       +1  5245                                             mov                     r10,a
0466 A3         +1  5246                                             inc                     dptr
0467 E4         +1  5247                                             clr                     a
0468 93         +1  5248                                             movc            a,@a+dptr
0469 F50B       +1  5249                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  5250                                             ret
                +1  5251      ;чтение памяти программ в r2..r5
                +1  5252     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  5253     rebyte2:        mov                     dph,r2
046E 8B82       +1  5254                                             mov                     dpl,r3
0470 E4         +1  5255                                             clr                     a
0471 93         +1  5256                                             movc            a,@a+dptr
0472 FA         +1  5257                                             mov                     r2,a
0473 A3         +1  5258                                             inc                     dptr
0474 E4         +1  5259                                             clr                     a
0475 93         +1  5260                                             movc            a,@a+dptr
0476 FB         +1  5261                                             mov                     r3,a
0477 A3         +1  5262                                             inc                     dptr
0478 E4         +1  5263                                             clr                     a
0479 93         +1  5264                                             movc            a,@a+dptr
047A FC         +1  5265                                             mov                     r4,a
047B A3         +1  5266                                             inc                     dptr
047C E4         +1  5267                                             clr                     a
047D 93         +1  5268                                             movc            a,@a+dptr
047E FD         +1  5269                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  5270                                             ret
                +1  5271      
                +1  5272     
                +1  5273      ;r7-количество байт
                +1  5274     ;dptr-адр ячейки для записи
                +1  5275     ;r1-адр ячейки  внешнего озу
                +1  5276     
0480 75A800     +1  5277     wrpage:  mov            IE,#00H
0483 75B601     +1  5278     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  5279                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  5280                      movx           a,@r1
048A F0         +1  5281                      movx           @dptr,a                         ;wr
048B 758F00     +1  5282                      mov            PSCTL,#0
048E 75B600     +1  5283                      mov            FLSCL,#00
0491 A3         +1  5284                     inc                     dptr
0492 09         +1  5285                     inc                     r1
0493 DFEE       +1  5286                     djnz            r7,WW5
0495 75A880     +1  5287                     mov             IE,#80H
0498 22         +1  5288                     ret
                +1  5289                             
                +1  5290     
                +1  5291     
                +1  5292                                                             
                +1  5293     
                +1  5294     
                +1  5295     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  5296     ;чтение памяти программ во внешнее озу
                +1  5297     ;вх-r2,r3-адр яч памяти прогр
                +1  5298     ;r1- яч внешнее озу
0499 8A83       +1  5299     copyPP:         mov                     dph,r2
049B 8B82       +1  5300                                             mov                     dpl,r3
049D 7FFF       +1  5301                                             mov                     r7,#0ffh
049F E4         +1  5302     copy1:          clr                     a
04A0 93         +1  5303                                             movc            a,@a+dptr
04A1 F3         +1  5304                                             movx                    @r1,a
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    83

04A2 A3         +1  5305                                             inc                     dptr
04A3 09         +1  5306                                             inc                     r1
04A4 DFF9       +1  5307                                             djnz            r7,copy1
04A6 22         +1  5308                                             ret
                +1  5309     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  5310     
                +1  5311                                     
                +1  5312     
                +1  5313     ;r8..r11->@r0..@r0+3
                +1  5314     ;r0-адр ячейки
                +1  5315     ;сохранить в ячейке озу
04A7 E508       +1  5316     savelte:        mov     a,ltemp
04A9 F6         +1  5317                                             mov     @r0,a
04AA 08         +1  5318                                             inc     r0
04AB E509       +1  5319                                             mov     a,ltemp+1
04AD F6         +1  5320                                             mov     @r0,a
04AE 08         +1  5321                                             inc     r0
04AF E50A       +1  5322                                             mov     a,ltemp+2
04B1 F6         +1  5323                                             mov     @r0,a
04B2 08         +1  5324                                             inc     r0
04B3 E50B       +1  5325                                             mov     a,ltemp+3
04B5 F6         +1  5326                                             mov     @r0,a
04B6 22         +1  5327                                             ret
                +1  5328     
                +1  5329     ;
                +1  5330     
                +1  5331     
                +1  5332     
                +1  5333     
                +1  5334     
                +1  5335                     
                +1  5336     
                +1  5337     
                +1  5338     
                +1  5339     
                +1  5340      
                    5341     
                    5342                                                   
                    5343     END
                                                                             
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    84

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   031BH   R   SEG=MAIN   751 754#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1178 1183 2816 2822 2855 2881 2930 2948 3233
ABTOF. . . . . . .  C ADDR   03F3H   A      5148#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 606 653 661 669 677 679 889 1129 1287 1296 1305 1314 1335 1664 1927
                                           1949 1954 1958 1961 1964 1967 1970 1973 2141 2190 2205 2216 2258 2267 2275
                                           2285 2299 2368 2384 2406 2411 2415 2418 2421 2424 2427 2430 2703 2770 2904
                                           2909 2922 2973 3555 3633 3636 3893 4545 4628 4645 4677 4715 4743 5005 5007
                                           5025 5068 5114 5173
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   179DH   R   SEG=MAIN   781 816 818 820 822 824 826 828 830 832 4134#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1182 1186 2813 2817 2852 2856 2878 2882 2931 2949 3389 3406 3424
AFTERK . . . . . .  C ADDR   04C1H   R   SEG=MAIN   911 982#
AGE2 . . . . . . .  C ADDR   01C2H   R   SEG=MAIN   536# 539
AGEON. . . . . . .  C ADDR   01D0H   R   SEG=MAIN   545# 547
ALESS0 . . . . . .  C ADDR   05D7H   R   SEG=MAIN   1129 1150#
ALLSUM . . . . . .  C ADDR   02D9H   R   SEG=MAIN   713# 746
ALMUL. . . . . . .  C ADDR   16E4H   R   SEG=MAIN   3980#
ALTOF. . . . . . .  C ADDR   0402H   A      880 916 963 995 1008 1442 1502 1540 2859 2885 2934 2952 5156 5164#
ALTOF1 . . . . . .  C ADDR   041EH   A      5173 5188# 5212
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   0415H   R   SEG=MAIN   878 885#
AN_T7. . . . . . .  C ADDR   0D92H   R   SEG=MAIN   2431# 2481 2490
AUTOKA . . . . . .  C ADDR   0783H   R   SEG=MAIN   905 1470#
AVPGO. . . . . . .  C ADDR   0541H   R   SEG=MAIN   1054 1056#
AVTDEC1. . . . . .  C ADDR   048BH   R   SEG=MAIN   938 945#
AWTOF. . . . . . .  C ADDR   03FCH   A      5157#
B. . . . . . . . .  D ADDR   00F0H   A      122# 3053 3253 3983 3986 3988 3992 3996 4000 4004 4009 4013 4020 4024
                                           4028 4034 4038 4042 4048 4741 4742
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 430#
BFORM. . . . . . .  C ADDR   091DH   R   SEG=MAIN   1742 1747 1759# 1785
BIN30. . . . . . .  C ADDR   1500H   R   SEG=MAIN   3543# 3569
BIN31. . . . . . .  C ADDR   1504H   R   SEG=MAIN   3548# 3552
BIN32. . . . . . .  C ADDR   1514H   R   SEG=MAIN   3561# 3566
BIN41. . . . . . .  C ADDR   1525H   R   SEG=MAIN   3577# 3587
BINDEC . . . . . .  C ADDR   14F4H   R   SEG=MAIN   1184 3522#
BITAKT . . . . . .  B ADDR   0023H.2 A      348# 1263 1264 1267
BITAVP . . . . . .  B ADDR   0020H.5 A      319# 1014 1083 1255 2471 2472 2474
BITBON . . . . . .  B ADDR   0021H.2 A      326# 1365 1976 1977 1979
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    85

BITBUF . . . . . .  B ADDR   0021H.0 A      324# 1386 1388 2058
BITIZM . . . . . .  B ADDR   0020H.4 A      318# 516 627 1955 2012 2097 2412 2464 2556 2572 2635 2663 2749 2757 2896
BITMAS . . . . . .  B ADDR   0020H.1 A      315# 838 841 1724
BITMEM . . . . . .  B ADDR   0021H.3 A      327# 2252 2666 2698 2748 2756 2895
BITMENU. . . . . .  B ADDR   0022H.1 A      335# 2232 2465
BITMIG . . . . . .  B ADDR   0023H.1 A      347# 1926 2199 2605 2916 3171 3178 3183 3189 3194 3208 3220
BITNUL . . . . . .  B ADDR   0021H.7 A      331# 1240 2492 2493 2500
BITOLL . . . . . .  B ADDR   0022H.7 A      341# 582 1090 1167
BITPRD . . . . . .  B ADDR   0021H.1 A      325# 1364
BITRS. . . . . . .  B ADDR   0020H.3 A      317#
BITT2. . . . . . .  B ADDR   0022H.0 A      334# 1166 2098 2138 2507 2636
BITVI11. . . . . .  B ADDR   0020H.6 A      320# 1015 2011 2229
BITVI12. . . . . .  B ADDR   0022H.2 A      336#
BITVI13. . . . . .  B ADDR   0022H.3 A      337#
BITVI21. . . . . .  B ADDR   0022H.5 A      339#
BITVI31. . . . . .  B ADDR   0022H.6 A      340#
BITVICH. . . . . .  B ADDR   0022H.4 A      338# 1165 2013 2023 2160 2524 2555 2571
BITZNAK. . . . . .  B ADDR   0020H.0 A      314# 607 636 971
BITZUS . . . . . .  B ADDR   0020H.7 A      321# 1106
BMEM11 . . . . . .  B ADDR   0021H.4 A      328# 2230
BMEM12 . . . . . .  B ADDR   0021H.5 A      329#
BMEM13 . . . . . .  B ADDR   0021H.6 A      330#
BOUT7. . . . . . .  C ADDR   0F0FH   R   SEG=MAIN   2644# 2646
BRET . . . . . . .  C ADDR   11B6H   R   SEG=MAIN   3001 3006 3010#
BUFDEC . . . . . .  C ADDR   060BH   R   SEG=MAIN   1189# 1194
BUFIND . . . . . .  D ADDR   0040H   A      298# 535 539 544 547 551 1139 1144 1187 1195 1197 1202 1238 1265 1268
                                           1596 1943 2207 2209 2212 2400 2618 2650 2656 3051 3069 3175 3197 3388 3405
                                           3423
BUFON. . . . . . .  C ADDR   0A56H   R   SEG=MAIN   1976 1979#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      4738# 4742
CELLBIT. . . . . .  D ADDR   0020H   A      313# 314 315 316 317 318 319 320 321
CELLBIT1 . . . . .  D ADDR   0021H   A      323# 324 325 326 327 328 329 330 331
CELLBIT2 . . . . .  D ADDR   0022H   A      333# 334 335 336 337 338 339 340 341
CELLBIT3 . . . . .  D ADDR   0023H   A      345# 346 347 348
CEXP . . . . . . .  C ADDR   01E2H   A      4715 4724#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   142DH   R   SEG=MAIN   2501 3334#
CH1. . . . . . . .  C ADDR   1449H   R   SEG=MAIN   1581 3344#
CH10 . . . . . . .  C ADDR   1431H   R   SEG=MAIN   851 3335#
CH100. . . . . . .  C ADDR   1441H   R   SEG=MAIN   1124 3339#
CH10000. . . . . .  C ADDR   143DH   R   SEG=MAIN   3338#
CH2. . . . . . . .  C ADDR   1445H   R   SEG=MAIN   847 3340#
CH20 . . . . . . .  C ADDR   13EBH   R   SEG=MAIN   745 3284#
CH2THO . . . . . .  C ADDR   145DH   R   SEG=MAIN   1509 1547 3349#
CH5. . . . . . . .  C ADDR   1435H   R   SEG=MAIN   3336#
CH57 . . . . . . .  C ADDR   13E7H   R   SEG=MAIN   712 3283#
CH954. . . . . . .  C ADDR   1439H   R   SEG=MAIN   3337#
CHANMA . . . . . .  C ADDR   0BD1H   R   SEG=MAIN   2205 2214#
CHANZ. . . . . . .  C ADDR   0BBAH   R   SEG=MAIN   2190 2203#
CHAVT. . . . . . .  D ADDR   0081H   A      363# 496 896 939 945 1563
CHBEFORE . . . . .  D ADDR   009BH   A      373# 518 709 722 740
CHBUF. . . . . . .  D ADDR   00ADH   A      380# 1362 1372
CHCMP. . . . . . .  C ADDR   09C2H   R   SEG=MAIN   619 897 902 1901#
CHDEC. . . . . . .  C ADDR   0829H   R   SEG=MAIN   626 946 955 1573#
CHDEL. . . . . . .  D ADDR   0083H   A      364# 1412 1456 1477 1522 1557
CHDELMO. . . . . .  C ADDR   076BH   R   SEG=MAIN   1427 1456# 1460
CHIF . . . . . . .  C ADDR   1378H   R   SEG=MAIN   3201 3203#
CHIND. . . . . . .  D ADDR   00ACH   A      379# 1029 1272
CHINKOR. . . . . .  D ADDR   0098H   A      362# 491 887 901 941 954 1462
CHKL . . . . . . .  D ADDR   003DH   A      305# 618 625 2076 2104 2153 2445 2669
CHMAS. . . . . . .  D ADDR   006EH   A      302# 835 842 855 1723
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    86

CHMASN . . . . . .  D ADDR   003FH   A      306# 698 707 741 758 770 840 842 843
CHTADC . . . . . .  C ADDR   0873H   R   SEG=MAIN   1622#
CHTHO. . . . . . .  C ADDR   1455H   R   SEG=MAIN   917 996 3347#
CHTHOU . . . . . .  C ADDR   14DBH   R   SEG=MAIN   3465#
CHZAP. . . . . . .  C ADDR   1429H   R   SEG=MAIN   1351 3333#
CH_1 . . . . . . .  C ADDR   144DH   R   SEG=MAIN   521 3345#
CH_10TH. . . . . .  C ADDR   1469H   R   SEG=MAIN   1049 3352#
CH_200 . . . . . .  C ADDR   1465H   R   SEG=MAIN   1009 3351#
CH_220 . . . . . .  C ADDR   1461H   R   SEG=MAIN   988 3350#
CH_953 . . . . . .  C ADDR   1451H   R   SEG=MAIN   3346#
CIKLWR . . . . . .  C ADDR   08F3H   R   SEG=MAIN   1730#
CKCON. . . . . . .  D ADDR   008EH   A      30# 448
CL4. . . . . . . .  C ADDR   147BH   R   SEG=MAIN   3368# 3370
CL4N . . . . . . .  C ADDR   1481H   R   SEG=MAIN   3377# 3379
CLE256 . . . . . .  C ADDR   043EH   A      5220#
CLEAR. . . . . . .  C ADDR   14EEH   R   SEG=MAIN   3500 3504# 3534
CLEAR4 . . . . . .  C ADDR   1478H   R   SEG=MAIN   719 1065 1067 1103 1105 2005 2007 2486 2488 3366#
CLEARN . . . . . .  C ADDR   1480H   R   SEG=MAIN   2814 2853 2879 3375#
CLMASSIX . . . . .  C ADDR   08E3H   R   SEG=MAIN   490 1063 1101 1466 1567 1717# 2003 2484
CLMASV . . . . . .  C ADDR   0546H   R   SEG=MAIN   1058 1060#
CLMAX. . . . . . .  C ADDR   08E8H   R   SEG=MAIN   1719# 1722
CLR11. . . . . . .  C ADDR   14EFH   R   SEG=MAIN   3506# 3508
CLRDEC . . . . . .  C ADDR   14E8H   R   SEG=MAIN   3498#
CLRNUM . . . . . .  C ADDR   14ECH   R   SEG=MAIN   3501# 3615
CLRVICH. . . . . .  C ADDR   0E93H   R   SEG=MAIN   2571# 2587
CNTR . . . . . . .  N NUMB   0006H   A      4411#
CO02S. . . . . . .  C ADDR   141EH   R   SEG=MAIN   3327# 3331
CO1S . . . . . . .  C ADDR   1415H   R   SEG=MAIN   3321# 3321
CO2S . . . . . . .  C ADDR   1411H   R   SEG=MAIN   3319# 3323
COND . . . . . . .  C ADDR   0957H   R   SEG=MAIN   1814#
CONSTE . . . . . .  D ADDR   00A4H   A      377# 1071
CONSTF . . . . . .  D ADDR   00A8H   A      378# 1076
COPY1. . . . . . .  C ADDR   049FH   A      5302# 5307
COPYPP . . . . . .  C ADDR   0499H   A      5299#
COUNT. . . . . . .  C ADDR   13F3H   R   SEG=MAIN   3293# 3293
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   13FAH   R   SEG=MAIN   3299# 3299
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 453
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1131 1152
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1134 1156
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 454
DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1359
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1356
DCOA . . . . . . .  C ADDR   095CH   R   SEG=MAIN   1818# 1820
DCOB . . . . . . .  C ADDR   0963H   R   SEG=MAIN   1822# 1840
DCOC . . . . . . .  C ADDR   096EH   R   SEG=MAIN   1832# 1837
DCOD . . . . . . .  C ADDR   097BH   R   SEG=MAIN   1839 1842#
DD . . . . . . . .  C ADDR   01FCH   R   SEG=MAIN   573#
DDOUTF . . . . . .  C ADDR   1002H   R   SEG=MAIN   2746 2753 2780 2786# 2808
DEC30. . . . . . .  C ADDR   1541H   R   SEG=MAIN   3625# 3650
DEC31. . . . . . .  C ADDR   1546H   R   SEG=MAIN   3631# 3638
DEC32. . . . . . .  C ADDR   1556H   R   SEG=MAIN   3643# 3647
DECBIN . . . . . .  C ADDR   1534H   R   SEG=MAIN   2818 2857 2883 2932 2950 3604#
DECSIZE. . . . . .  N NUMB   000AH   A      3479# 3499 3533 3560 3573 3576 3630
DECT2. . . . . . .  C ADDR   155FH   R   SEG=MAIN   3621 3653#
DEDPTR . . . . . .  C ADDR   17B4H   R   SEG=MAIN   4138 4142 4146 4152#
DENORM . . . . . .  C ADDR   0133H   A      4570# 4626
DGOTO7 . . . . . .  C ADDR   10D5H   R   SEG=MAIN   2886# 2892
DIAP . . . . . . .  D ADDR   00AEH   A      381# 510 1053 1085 1201 1997 2029 2066 2436 2477 2981 3002 3250 3437
DIINC. . . . . . .  C ADDR   0A75H   R   SEG=MAIN   2000 2003#
DIKDN. . . . . . .  C ADDR   13BFH   R   SEG=MAIN   3252 3272#
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    87

DIKDW. . . . . . .  C ADDR   14C5H   R   SEG=MAIN   3441 3453#
DIPAR. . . . . . .  C ADDR   14D9H   R   SEG=MAIN   3463#
DIV1 . . . . . . .  C ADDR   02DDH   A      4907# 4966
DIV2 . . . . . . .  C ADDR   0320H   A      4925 4929 4933 4937 4952#
DIV3 . . . . . . .  C ADDR   030DH   A      4926 4930 4934 4938#
DIV9 . . . . . . .  C ADDR   0336H   A      4896 4898 4972#
DIVIDE . . . . . .  C ADDR   161FH   R   SEG=MAIN   1746 3839#
DONE . . . . . . .  C ADDR   158EH   R   SEG=MAIN   3669 3680#
DONE1. . . . . . .  C ADDR   158CH   R   SEG=MAIN   3672 3675 3678#
DOSH . . . . . . .  C ADDR   16A8H   R   SEG=MAIN   3914 3930#
DOSUB. . . . . . .  C ADDR   1696H   R   SEG=MAIN   3898 3902 3906 3910 3911 3915#
DPH. . . . . . . .  D ADDR   0083H   A      19# 1677 1685 3686 3722 3757 3760 3772 3795 4157 4159 5233 5253 5299
DPL. . . . . . . .  D ADDR   0082H   A      18# 1678 1684 3702 3738 3759 3773 3776 3810 4154 4156 5234 5254 5300
DVIG0. . . . . . .  C ADDR   06BEH   R   SEG=MAIN   1308# 1310
DVIG1. . . . . . .  C ADDR   06B3H   R   SEG=MAIN   1299# 1301
DVIG2. . . . . . .  C ADDR   06A8H   R   SEG=MAIN   1290# 1292
DVIG3. . . . . . .  C ADDR   069CH   R   SEG=MAIN   1281# 1283
DVIG4. . . . . . .  C ADDR   06CAH   R   SEG=MAIN   1319# 1321
DVIG6. . . . . . .  C ADDR   06E9H   R   SEG=MAIN   1344# 1346
DVM. . . . . . . .  C ADDR   06E7H   R   SEG=MAIN   1335 1343#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 451
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 477 1594 1606 1937 2369 2383 2978
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDSDV . . . . . .  C ADDR   06EDH   R   SEG=MAIN   1341 1347#
ENDSUM . . . . . .  C ADDR   03CCH   R   SEG=MAIN   782 834#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU1L. . . . . . .  C ADDR   0CB5H   R   SEG=MAIN   2318 2322#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      4413#
EXP2 . . . . . . .  N NUMB   0001H   A      4415# 4592 4613
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDKOEF . . . . .  C ADDR   14B6H   R   SEG=MAIN   913 992 3436#
FINIS. . . . . . .  C ADDR   16D3H   R   SEG=MAIN   3858 3959#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      1078 4618# 4707
FLCMP. . . . . . .  C ADDR   01D6H   A      990 1011 1051 4712#
FLDIV. . . . . . .  C ADDR   02B7H   A      919 998 1075 1511 1549 4882#
FLMUL. . . . . . .  C ADDR   0203H   A      924 975 1003 4752#
FLOUT. . . . . . .  C ADDR   01E1H   A      4719 4722#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 5221 5227 5278 5283
FLSUB. . . . . . .  C ADDR   01D1H   A      967 1507 1545 4705#
FND. . . . . . . .  C ADDR   01F8H   A      4728 4731 4734 4737 4740#
FO1M . . . . . . .  C ADDR   091AH   R   SEG=MAIN   1752 1756#
FO2M . . . . . . .  C ADDR   0923H   R   SEG=MAIN   1759 1761#
FORM4. . . . . . .  C ADDR   0924H   R   SEG=MAIN   1754 1760 1764#
FT1IZM . . . . . .  C ADDR   0B54H   R   SEG=MAIN   2148#
FTOL . . . . . . .  C ADDR   0343H   A      925 1005 1172 4988#
FTOL1. . . . . . .  C ADDR   037CH   A      5001 5005 5029#
FTOL2. . . . . . .  C ADDR   039EH   A      5025 5062#
FTOL22 . . . . . .  C ADDR   03C4H   A      5065 5099#
FTOL23 . . . . . .  C ADDR   03A2H   A      5066# 5098
FTOL24 . . . . . .  C ADDR   03B5H   A      5068 5084#
FTOL25 . . . . . .  C ADDR   03C2H   A      5083 5098#
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    88

FTOL26 . . . . . .  C ADDR   03E4H   A      5114 5130#
FTOL3. . . . . . .  C ADDR   038AH   A      5028 5042#
FTOL33 . . . . . .  C ADDR   038EH   A      5046# 5060
FTOL4. . . . . . .  C ADDR   0371H   A      5007 5022#
FTOL9. . . . . . .  C ADDR   0381H   A      5035# 5045 5061 5129 5144
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   459# 460
GO23NO . . . . . .  C ADDR   0FD1H   R   SEG=MAIN   2754 2760#
GO31L. . . . . . .  C ADDR   0CBBH   R   SEG=MAIN   2310 2327#
GO41L. . . . . . .  C ADDR   0CC0H   R   SEG=MAIN   2327 2329#
GOA2 . . . . . . .  C ADDR   0508H   R   SEG=MAIN   1013 1016#
GOA3A2 . . . . . .  C ADDR   0512H   R   SEG=MAIN   1021# 1081
GOCIKLE. . . . . .  C ADDR   0726H   R   SEG=MAIN   1366 1375 1379 1386# 1392 1395
GOFULL . . . . . .  C ADDR   0FFCH   R   SEG=MAIN   2764 2784#
GOONIN . . . . . .  C ADDR   051FH   R   SEG=MAIN   1028# 1068 1091 1107
GOONIND. . . . . .  C ADDR   05E0H   R   SEG=MAIN   1031 1157#
GOONT. . . . . . .  C ADDR   0710H   R   SEG=MAIN   1369 1371#
GOTO7. . . . . . .  C ADDR   0D9EH   R   SEG=MAIN   2439 2444# 2498 2505 2541 2557 2575 2594 2606 2644 2648 2673 2708
                                           2717 2721 2735 2750 2758 2766 2786 2796 2830 2843 2845 2867 2886 2898 2906
                                           2913 2943
GOTOKD . . . . . .  C ADDR   043BH   R   SEG=MAIN   883 907#
GOZNAK . . . . . .  C ADDR   0271H   R   SEG=MAIN   613 642#
HNOR11 . . . . . .  C ADDR   0E9EH   R   SEG=MAIN   2534 2546 2578#
HNOR12 . . . . . .  C ADDR   0E5FH   R   SEG=MAIN   2542 2546#
HNOT1. . . . . . .  C ADDR   0EDBH   R   SEG=MAIN   2519 2615#
HNOT2. . . . . . .  C ADDR   0E2DH   R   SEG=MAIN   2516#
HR12 . . . . . . .  C ADDR   0E55H   R   SEG=MAIN   2537 2542#
HVI1113. . . . . .  C ADDR   0E4FH   R   SEG=MAIN   2540# 2545 2550
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 478 5220 5228 5277 5287
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   0E29H   R   SEG=MAIN   2511 2513#
IND. . . . . . . .  C ADDR   0841H   R   SEG=MAIN   540 548 573 630 1269 1594# 1990 2468
INDA3. . . . . . .  C ADDR   05A7H   R   SEG=MAIN   1122#
INDOLL . . . . . .  C ADDR   057FH   R   SEG=MAIN   1083 1084 1088#
INIACP . . . . . .  C ADDR   12EDH   R   SEG=MAIN   579 2633 3110#
INTN . . . . . . .  C ADDR   10BEH   R   SEG=MAIN   2877#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   0EC3H   R   SEG=MAIN   2596#
IZMAN. . . . . . .  C ADDR   0AC6H   R   SEG=MAIN   1924 2050#
IZMFUN . . . . . .  C ADDR   0AD5H   R   SEG=MAIN   1991 2002 2009 2054 2057#
IZMPAT . . . . . .  C ADDR   0AD9H   R   SEG=MAIN   1974 1978 1980 2026 2061#
IZMT2. . . . . . .  C ADDR   0AF6H   R   SEG=MAIN   2077 2082#
IZMT3. . . . . . .  C ADDR   0B01H   R   SEG=MAIN   2082 2088#
JFINIS . . . . . .  C ADDR   163AH   R   SEG=MAIN   3850 3858#
KD . . . . . . . .  C ADDR   1459H   R   SEG=MAIN   3348#
KEYB1. . . . . . .  C ADDR   09E4H   R   SEG=MAIN   283 1925#
KEYB2. . . . . . .  C ADDR   0D2DH   R   SEG=MAIN   286 2382#
KFULL. . . . . . .  C ADDR   0FD5H   R   SEG=MAIN   2731 2763#
KGO23. . . . . . .  C ADDR   0FC1H   R   SEG=MAIN   2730 2752#
KLEV1. . . . . . .  C ADDR   0F82H   R   SEG=MAIN   2700 2722#
KLEV2. . . . . . .  C ADDR   0F87H   R   SEG=MAIN   2722 2724#
KLEV21 . . . . . .  C ADDR   0FA3H   R   SEG=MAIN   2728 2737#
KLEV22 . . . . . .  C ADDR   0F8CH   R   SEG=MAIN   2724 2728#
KLEV23 . . . . . .  C ADDR   0FABH   R   SEG=MAIN   2737 2742#
KLMAS. . . . . . .  C ADDR   0337H   R   SEG=MAIN   724 761 769#
KNAVP. . . . . . .  C ADDR   0DD0H   R   SEG=MAIN   2424 2471#
KNIZM. . . . . . .  B ADDR   0023H.0 A      346# 1013 1084 1259 2028 2050 2051 2055
KNIZMON. . . . . .  C ADDR   0AD0H   R   SEG=MAIN   2050 2055#
KNKMP. . . . . . .  C ADDR   0D1EH   R   SEG=MAIN   2377# 2418
KNLEFT . . . . . .  C ADDR   0DDDH   R   SEG=MAIN   2381 2477#
KNMEM. . . . . . .  C ADDR   0F2DH   R   SEG=MAIN   2376 2663#
KNMENU . . . . . .  C ADDR   0DC0H   R   SEG=MAIN   2430 2464#
KNNUL. . . . . . .  C ADDR   0DF8H   R   SEG=MAIN   2380 2492#
KNOPT. . . . . . .  C ADDR   0B09H   R   SEG=MAIN   1923 2096#
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    89

KNRAZR . . . . . .  C ADDR   0B1EH   R   SEG=MAIN   1922 2110#
KNRIGHT. . . . . .  C ADDR   0A6BH   R   SEG=MAIN   1964 1995#
KNVICH . . . . . .  C ADDR   0A87H   R   SEG=MAIN   1973 2011#
KOEFKD . . . . . .  D ADDR   00A0H   A      376# 527
KOEFKM . . . . . .  D ADDR   0094H   A      370# 525 973 1553
KOEFKP . . . . . .  D ADDR   0090H   A      369# 523 968 1515
KONSTA . . . . . .  D ADDR   00BCH   A      389# 2935
KONSTB . . . . . .  D ADDR   00C0H   A      390# 2953
KOR0US . . . . . .  C ADDR   11C6H   R   SEG=MAIN   1425 3033#
KOR0_AN. . . . . .  D ADDR   0084H   A      366# 964 1443 1505 1543
KORDEC1. . . . . .  C ADDR   0499H   R   SEG=MAIN   951 954#
KORDEC10 . . . . .  C ADDR   0484H   R   SEG=MAIN   941#
KORNUL . . . . . .  C ADDR   074BH   R   SEG=MAIN   893 1412#
KVVOD0 . . . . . .  C ADDR   0FEFH   R   SEG=MAIN   2710 2770 2779#
LABELA . . . . . .  C ADDR   0246H   R   SEG=MAIN   616# 634 1389
LABELB . . . . . .  C ADDR   0695H   R   SEG=MAIN   933 1110 1274# 1400 1404 1406
LABELC . . . . . .  C ADDR   0B1EH   R   SEG=MAIN   2111#
LABELE . . . . . .  C ADDR   0AE7H   R   SEG=MAIN   2059 2069 2072 2075# 2116 2119 2131 2134
LABELF . . . . . .  C ADDR   0B40H   R   SEG=MAIN   1921 2137#
LABELH . . . . . .  C ADDR   0E18H   R   SEG=MAIN   2379 2507#
LABELI . . . . . .  C ADDR   10F0H   R   SEG=MAIN   2522 2608 2901#
LABELK . . . . . .  C ADDR   0F48H   R   SEG=MAIN   2521 2676#
LABELL . . . . . .  C ADDR   0C60H   R   SEG=MAIN   2230 2272 2281#
LABELL1. . . . . .  C ADDR   0BD9H   R   SEG=MAIN   2218# 2334 2356
LABELN . . . . . .  C ADDR   0CDAH   R   SEG=MAIN   2342#
LABELP . . . . . .  C ADDR   10F0H   R   SEG=MAIN   2888 2899#
LABL2. . . . . . .  C ADDR   0CA7H   R   SEG=MAIN   2313# 2740 2802
LABL21 . . . . . .  C ADDR   0C80H   R   SEG=MAIN   2282 2296#
LABL22 . . . . . .  C ADDR   0C96H   R   SEG=MAIN   2300 2305#
LABM . . . . . . .  C ADDR   1024H   R   SEG=MAIN   2742 2804#
LADD . . . . . . .  C ADDR   177BH   R   SEG=MAIN   704 737 1354 4085#
LADDX. . . . . . .  C ADDR   178CH   R   SEG=MAIN   4109#
LAL22. . . . . . .  C ADDR   0C78H   R   SEG=MAIN   2286 2291#
LBTOF. . . . . . .  C ADDR   042DH   A      5199#
LCMP . . . . . . .  C ADDR   1579H   R   SEG=MAIN   1783 1911 3665#
LDC_LONG . . . . .  C ADDR   158FH   R   SEG=MAIN   522 1352 1510 1548 2502 3685#
LDC_LTEMP. . . . .  C ADDR   15B1H   R   SEG=MAIN   713 848 852 918 989 997 1010 1050 1125 1582 3721#
LDX_LONG . . . . .  C ADDR   15D7H   R   SEG=MAIN   3756#
LDX_LTEMP. . . . .  C ADDR   15FDH   R   SEG=MAIN   3794#
LEFCUR . . . . . .  C ADDR   1067H   R   SEG=MAIN   2836# 2872 2890
LEFMEM11 . . . . .  C ADDR   0F50H   R   SEG=MAIN   2701# 2723 2725
LEV220 . . . . . .  C ADDR   0F8FH   R   SEG=MAIN   2729# 2738
LEV2GO . . . . . .  C ADDR   0CEEH   R   SEG=MAIN   2341 2352#
LEVEL. . . . . . .  D ADDR   00B0H   A      383# 1982 2235 2253 2281 2667 2699 2781
LI21 . . . . . . .  C ADDR   0ECDH   R   SEG=MAIN   2603 2605#
LLDI2. . . . . . .  C ADDR   0ABFH   R   SEG=MAIN   2041 2045#
LLDI23 . . . . . .  C ADDR   0AB3H   R   SEG=MAIN   2033 2038#
LLDI3. . . . . . .  C ADDR   0ABAH   R   SEG=MAIN   2040 2042#
LLEV2. . . . . . .  C ADDR   0CC5H   R   SEG=MAIN   2312 2332#
LLMUL. . . . . . .  C ADDR   16E4H   R   SEG=MAIN   3979#
LLSUB. . . . . . .  C ADDR   1769H   R   SEG=MAIN   4061#
LLTOF. . . . . . .  C ADDR   0432H   A      5205#
LMUL . . . . . . .  C ADDR   16E4H   R   SEG=MAIN   1741 3981#
LOAB12 . . . . . .  C ADDR   133CH   R   SEG=MAIN   2631 3149#
LOAD . . . . . . .  D ADDR   00B7H   A      387# 2099 2142 2509 2627 3050
LOADB. . . . . . .  C ADDR   0EECH   R   SEG=MAIN   2622 2625# 2654 2660
LOADB2 . . . . . .  C ADDR   0F12H   R   SEG=MAIN   2642 2646#
LOADCLE. . . . . .  C ADDR   0F6EH   R   SEG=MAIN   2715# 2773
LOADKD . . . . . .  C ADDR   13A1H   R   SEG=MAIN   3250#
LOADR2 . . . . . .  C ADDR   1393H   R   SEG=MAIN   2858 2884 2933 2951 3233#
LOADT. . . . . . .  C ADDR   11DBH   R   SEG=MAIN   2101 2148 2515 3050#
LOADUS . . . . . .  C ADDR   1187H   R   SEG=MAIN   580 1061 1098 1455 1556 2008 2056 2489 2634 2981#
LOBLOK . . . . . .  C ADDR   100AH   R   SEG=MAIN   2761 2790# 2798
LOCLE. . . . . . .  C ADDR   0F69H   R   SEG=MAIN   2704 2713#
LOD1 . . . . . . .  C ADDR   11EAH   R   SEG=MAIN   3058# 3063
LODT . . . . . . .  C ADDR   11F6H   R   SEG=MAIN   3070# 3075
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    90

LOIZMK . . . . . .  C ADDR   0E62H   R   SEG=MAIN   2547# 2569
LOLEVT . . . . . .  C ADDR   11DDH   R   SEG=MAIN   1988 3051#
LOLIST . . . . . .  C ADDR   0F5DH   R   SEG=MAIN   2706#
LOOP . . . . . . .  C ADDR   08B0H   R   SEG=MAIN   1663# 1664
LOOPS. . . . . . .  C ADDR   163DH   R   SEG=MAIN   3860# 3893
LOSPUS . . . . . .  C ADDR   11BAH   R   SEG=MAIN   1426 3016#
LOTEXT . . . . . .  C ADDR   11F2H   R   SEG=MAIN   1089 2019 2165 2172 2178 2184 2238 2245 2261 2270 2278 2289 2293
                                           2303 2307 2467 2540 2593 2665 2707 2716 2720 2734 2785 2791 2825 2862 2941
                                           3067#
LOU. . . . . . . .  C ADDR   0AC5H   R   SEG=MAIN   2028 2044 2048#
LOUIZM . . . . . .  C ADDR   0AA2H   R   SEG=MAIN   2028# 2053 3010
LOUTF. . . . . . .  C ADDR   0C7DH   R   SEG=MAIN   2285 2294# 2299 2333 2339
LOVICH . . . . . .  C ADDR   0E58H   R   SEG=MAIN   2543# 2563 2582 2960
LOWR . . . . . . .  C ADDR   0F77H   R   SEG=MAIN   2713 2718#
LOWR1. . . . . . .  C ADDR   0F79H   R   SEG=MAIN   2719# 2777
LSUB . . . . . . .  C ADDR   1769H   R   SEG=MAIN   930 1024 1583 4062#
LTEMP. . . . . . .  N NUMB   0008H   A      855 857 858 859 1793 1796 1799 1802 1845 1846 1847 1848 3467 3468 3469
                                           3470 3477# 3851 3852 3853 3854 3863 3867 3871 3875 3878 3879 3880 3881
                                           3882 3883 3884 3885 3886 3887 3888 3889 3892 3895 3900 3904 3908 3918 3921
                                           3924 3927 3943 3946 3947 3949 3950 3952 3953 3955 3960 3961 3962 3963 3983
                                           3988 3996 4004 4009 4020 4028 4034 4042 4048 4416 4417 4456 4461 4463 4472
                                           4473 4474 4475 4706 4714 4727 4730 4733 4736 5316 5319 5322 5325
LWR. . . . . . . .  C ADDR   08F5H   R   SEG=MAIN   1732# 1736
LWRX . . . . . . .  C ADDR   08B9H   R   SEG=MAIN   1676# 1688
LWTOF. . . . . . .  C ADDR   042FH   A      5201#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   0910H   R   SEG=MAIN   1177 1740 1745 1750# 1782
MAIN . . . . . . .  C SEG    17C6H       REL=UNIT   237 294# 423
MANT1. . . . . . .  N NUMB   0002H   A      4414# 4441 4490 4491
MANT2. . . . . . .  N NUMB   0008H   A      4416# 4467 4468 4599 4601 4602 4604 4605 4607 4608 4610 4649 4650 4652
                                           4653 4655 4656 4658 4659 4663 4665 4668 4671 4769 4771 4772 4774 4775 4777
                                           4778 4780 4831 4833 4834 4836 4837 4839 4840 4842 4924 4928 4932 4936 4940
                                           4943 4946 4949
MARK0_8. . . . . .  C ADDR   0BB2H   R   SEG=MAIN   2193 2198#
MARKER . . . . . .  D ADDR   00B2H   A      385# 501 1942 2192 2314 2342 2399 2573 2589 2601 2792 2826 2836 2863 2910
                                           2938 2956 3167 3195 3210 3221
MARLE. . . . . . .  C ADDR   1379H   R   SEG=MAIN   2844 3207#
MARRI. . . . . . .  C ADDR   1386H   R   SEG=MAIN   2350 3220#
MAS10. . . . . . .  C ADDR   0355H   R   SEG=MAIN   771 783#
MAS5DIV. . . . . .  C ADDR   03FBH   R   SEG=MAIN   849 853 861#
MASFULL. . . . . .  C ADDR   03D8H   R   SEG=MAIN   838 842#
MASS0. . . . . . .  X ADDR   0080H   A      396 397# 772 777 804 812 1718
MASS1. . . . . . .  X ADDR   0084H   A      398# 780 801 815
MASS2. . . . . . .  X ADDR   0088H   A      399# 798 817
MASS3. . . . . . .  X ADDR   008CH   A      400# 795 819
MASS4. . . . . . .  X ADDR   0090H   A      401# 792 821
MASS5. . . . . . .  X ADDR   0094H   A      402# 789 823
MASS6. . . . . . .  X ADDR   0098H   A      403# 787 825
MASS7. . . . . . .  X ADDR   009CH   A      404# 785 827
MASS8. . . . . . .  X ADDR   00A0H   A      405# 783 829
MASS9. . . . . . .  X ADDR   00A4H   A      406# 831
MASX5. . . . . . .  C ADDR   03F1H   R   SEG=MAIN   840 855#
MEAVP. . . . . . .  C ADDR   0DD8H   R   SEG=MAIN   2471 2474#
MECLE. . . . . . .  C ADDR   016FH   R   SEG=MAIN   482# 484
MEFF . . . . . . .  C ADDR   0176H   R   SEG=MAIN   486# 489
MEM12NO. . . . . .  C ADDR   0FEBH   R   SEG=MAIN   2771 2775#
MIDL . . . . . . .  C ADDR   1670H   R   SEG=MAIN   3855 3890#
MIGN . . . . . . .  C ADDR   134BH   R   SEG=MAIN   1595 3167#
MIGNN. . . . . . .  C ADDR   1353H   R   SEG=MAIN   3169 3174#
MLABL2 . . . . . .  C ADDR   1021H   R   SEG=MAIN   2802# 2806
MMM. . . . . . . .  C ADDR   0241H   R   SEG=MAIN   611#
MO220. . . . . . .  C ADDR   0574H   R   SEG=MAIN   1042 1083#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   0C13H   R   SEG=MAIN   2249# 2258 2267 2275
MOVE28 . . . . . .  C ADDR   097DH   R   SEG=MAIN   920 999 1508 1546 1845#
MOVE82 . . . . . .  C ADDR   14DFH   R   SEG=MAIN   3467#
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    91

MOVEA3 . . . . . .  C ADDR   05E0H   R   SEG=MAIN   1135 1160#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2194 2322 2347 2591 2795 2829 2837 2866 3214
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2315 2319 2343 2794 2828 2841 2865 3223
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      4766# 4809
MUP11. . . . . . .  C ADDR   0257H   A      4813# 4858
MUP2 . . . . . . .  C ADDR   0297H   A      4843 4857#
MUP3 . . . . . . .  C ADDR   026CH   A      4812 4828#
MVV11. . . . . . .  C ADDR   1005H   R   SEG=MAIN   2782 2788#
MVV12. . . . . . .  C ADDR   101DH   R   SEG=MAIN   2788 2797#
N12DELCH . . . . .  C ADDR   0825H   R   SEG=MAIN   1561 1569#
N4DELCH. . . . . .  C ADDR   07D6H   R   SEG=MAIN   1488 1526#
N8DELCH. . . . . .  C ADDR   0813H   R   SEG=MAIN   1526 1561#
NBIMENU. . . . . .  C ADDR   0C19H   R   SEG=MAIN   2232 2252#
NBLOK. . . . . . .  D ADDR   00C4H   A      391# 2821
NE05 . . . . . . .  C ADDR   0358H   A      4995 4997 4999 5002#
NEXIN. . . . . . .  C ADDR   084BH   R   SEG=MAIN   1598# 1605
NMINUS . . . . . .  C ADDR   04B6H   R   SEG=MAIN   971 974#
NNDELCH. . . . . .  C ADDR   0796H   R   SEG=MAIN   1478 1488#
NNMEMB . . . . . .  C ADDR   0CFAH   R   SEG=MAIN   2251 2357#
NNNUL. . . . . . .  C ADDR   0659H   R   SEG=MAIN   1240 1243#
NO . . . . . . . .  C ADDR   1658H   R   SEG=MAIN   3865 3869 3873 3877#
NO0KEY . . . . . .  C ADDR   0253H   R   SEG=MAIN   620 625#
NO11V6 . . . . . .  C ADDR   0B86H   R   SEG=MAIN   2162 2175#
NO12V6 . . . . . .  C ADDR   0B93H   R   SEG=MAIN   2175 2181#
NO13V6 . . . . . .  C ADDR   0BA0H   R   SEG=MAIN   2181 2188#
NO21P7 . . . . . .  C ADDR   1146H   R   SEG=MAIN   2925 2945#
NO2PARN. . . . . .  C ADDR   05CCH   R   SEG=MAIN   1137 1143#
NO31N. . . . . . .  C ADDR   107BH   R   SEG=MAIN   2834 2847#
NO3PARN. . . . . .  C ADDR   05C2H   R   SEG=MAIN   1137# 1220
NO4DEL . . . . . .  C ADDR   0771H   R   SEG=MAIN   1429 1460#
NOAVK. . . . . . .  C ADDR   0490H   R   SEG=MAIN   903 948#
NOAVP. . . . . . .  C ADDR   0505H   R   SEG=MAIN   1015# 1052 1055
NOBAVP . . . . . .  C ADDR   0676H   R   SEG=MAIN   1255 1259#
NOBEF99. . . . . .  C ADDR   02EFH   R   SEG=MAIN   710 725# 743
NOBIT. . . . . . .  C ADDR   0245H   A      4781 4795#
NOBITIZM . . . . .  C ADDR   067CH   R   SEG=MAIN   1259 1262#
NOBUF0 . . . . . .  C ADDR   0733H   R   SEG=MAIN   1363 1394#
NOCHI0 . . . . . .  C ADDR   05A3H   R   SEG=MAIN   1043 1109#
NOCHN2 . . . . . .  C ADDR   03E9H   R   SEG=MAIN   846 851#
NODI2. . . . . . .  C ADDR   0589H   R   SEG=MAIN   1086 1093#
NODI6. . . . . . .  C ADDR   0DE6H   R   SEG=MAIN   2479 2483#
NODI8. . . . . . .  C ADDR   0630H   R   SEG=MAIN   1204 1210#
NODI9. . . . . . .  C ADDR   058EH   R   SEG=MAIN   1095 1098#
NODIS9 . . . . . .  C ADDR   063FH   R   SEG=MAIN   1210 1222#
NOEQU1 . . . . . .  C ADDR   0CE8H   R   SEG=MAIN   2346 2350#
NOEQU2 . . . . . .  C ADDR   1075H   R   SEG=MAIN   2840 2844#
NOFIZM . . . . . .  C ADDR   0B67H   R   SEG=MAIN   2138 2160#
NOFT1. . . . . . .  C ADDR   0B53H   R   SEG=MAIN   2143 2147#
NOFZ . . . . . . .  C ADDR   072EH   R   SEG=MAIN   1386 1389#
NOH37. . . . . . .  C ADDR   0E69H   R   SEG=MAIN   2536 2552# 2561 2567 2580
NOHNOT1. . . . . .  C ADDR   0F22H   R   SEG=MAIN   2617 2655#
NOHNOT2. . . . . .  C ADDR   0F1AH   R   SEG=MAIN   2649# 2655
NOKORR . . . . . .  C ADDR   041EH   R   SEG=MAIN   889 894#
NOLAH. . . . . . .  C ADDR   0E39H   R   SEG=MAIN   2507 2524#
NOLEV1 . . . . . .  C ADDR   0C9EH   R   SEG=MAIN   2296 2310#
NOM31. . . . . . .  C ADDR   105EH   R   SEG=MAIN   2804 2832#
NOM32. . . . . . .  C ADDR   10ADH   R   SEG=MAIN   2832 2870#
NOM33. . . . . . .  C ADDR   10D8H   R   SEG=MAIN   2870 2888#
NOMARL . . . . . .  C ADDR   110DH   R   SEG=MAIN   2911 2915#
NOME11 . . . . . .  C ADDR   0FDCH   R   SEG=MAIN   2768#
NOMEM11. . . . . .  C ADDR   0C34H   R   SEG=MAIN   2254 2264#
NOMEM12. . . . . .  C ADDR   0C4AH   R   SEG=MAIN   2264 2272#
NOMEMK . . . . . .  C ADDR   0FD9H   R   SEG=MAIN   2675 2765#
NON1C. . . . . . .  C ADDR   0B2FH   R   SEG=MAIN   2117 2121#
NONULAVT . . . . .  C ADDR   0478H   R   SEG=MAIN   898 935#
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    92

NONULDEL . . . . .  C ADDR   0758H   R   SEG=MAIN   1413 1429#
NOP3_0 . . . . . .  C ADDR   05A7H   R   SEG=MAIN   1115#
NOPART1. . . . . .  C ADDR   02F3H   R   SEG=MAIN   699 732#
NOPART2. . . . . .  C ADDR   0313H   R   SEG=MAIN   732 750#
NOPART3. . . . . .  C ADDR   0318H   R   SEG=MAIN   750 753#
NOPART4. . . . . .  C ADDR   032BH   R   SEG=MAIN   753 762#
NOPLUS . . . . . .  C ADDR   0BCCH   R   SEG=MAIN   2208 2211#
NOPOIN7. . . . . .  C ADDR   1114H   R   SEG=MAIN   2909 2920#
NOPOINT. . . . . .  C ADDR   10FBH   R   SEG=MAIN   2904 2907#
NOR11. . . . . . .  C ADDR   0BDFH   R   SEG=MAIN   2169 2222#
NOR13. . . . . . .  C ADDR   0B79H   R   SEG=MAIN   2169#
NORDN. . . . . . .  C ADDR   00F6H   A      4502# 4535
NORDN1 . . . . . .  C ADDR   0107H   A      4504 4518#
NORIG2 . . . . . .  C ADDR   0CCEH   R   SEG=MAIN   2329 2336#
NORIM6 . . . . . .  C ADDR   0CFAH   R   SEG=MAIN   2242 2358#
NORM1. . . . . . .  C ADDR   00F0H   A      4497# 4694 4871 4973 5190
NORR11 . . . . . .  C ADDR   0E79H   R   SEG=MAIN   2559#
NORR12 . . . . . .  C ADDR   0E86H   R   SEG=MAIN   2559 2565# 2578
NORUP. . . . . . .  C ADDR   0119H   A      4501 4538#
NORUP1 . . . . . .  C ADDR   011EH   A      4543# 4561
NORUP2 . . . . . .  C ADDR   0132H   A      4545 4562#
NORVICH. . . . . .  C ADDR   068EH   R   SEG=MAIN   1219 1270#
NOSUB. . . . . . .  C ADDR   1693H   R   SEG=MAIN   3899 3903 3907 3912#
NOT1IN . . . . . .  C ADDR   0736H   R   SEG=MAIN   1367 1398#
NOT1_7 . . . . . .  C ADDR   0DADH   R   SEG=MAIN   2446 2453#
NOT2IN . . . . . .  C ADDR   073EH   R   SEG=MAIN   1398 1402#
NOT2_7 . . . . . .  C ADDR   0DB8H   R   SEG=MAIN   2453 2458#
NOT3IN . . . . . .  C ADDR   0746H   R   SEG=MAIN   1402 1405#
NOTAKT . . . . . .  C ADDR   0686H   R   SEG=MAIN   1263 1267#
NOTT1. . . . . . .  C ADDR   0719H   R   SEG=MAIN   1373 1377#
NOTT5. . . . . . .  C ADDR   071EH   R   SEG=MAIN   1377 1381#
NOT_1. . . . . . .  C ADDR   0B39H   R   SEG=MAIN   2121 2122 2133#
NOT_10 . . . . . .  C ADDR   0B39H   R   SEG=MAIN   2132#
NOVIR. . . . . . .  C ADDR   0BECH   R   SEG=MAIN   2159 2232#
NOVIR1 . . . . . .  C ADDR   0B64H   R   SEG=MAIN   2159# 2160
NOZZMI . . . . . .  C ADDR   0620H   R   SEG=MAIN   1199 1201#
NSEC01 . . . . . .  C ADDR   0662H   R   SEG=MAIN   1244 1247#
NSEC1. . . . . . .  C ADDR   0669H   R   SEG=MAIN   1247 1250#
NSEC10 . . . . . .  C ADDR   066EH   R   SEG=MAIN   1246 1249 1250 1254#
NULAVT . . . . . .  C ADDR   0783H   R   SEG=MAIN   1476#
NUMSIZE. . . . . .  N NUMB   0004H   A      3480# 3502 3540 3547 3622 3642
OBOARD . . . . . .  C ADDR   15C9H   R   SEG=MAIN   3723 3737#
OBOARD1. . . . . .  C ADDR   1611H   R   SEG=MAIN   3796 3809#
OK1. . . . . . . .  C ADDR   0186H   A      4628 4643#
OK2. . . . . . . .  C ADDR   01A0H   A      4645 4660#
OK3. . . . . . . .  C ADDR   01C4H   A      4677 4693#
ONBOAR1. . . . . .  C ADDR   15EFH   R   SEG=MAIN   3758 3775#
ONBOARD. . . . . .  C ADDR   15A3H   R   SEG=MAIN   3687 3701#
ONMEM11. . . . . .  C ADDR   0F3BH   R   SEG=MAIN   2469 2473 2475 2669#
ONMIG. . . . . . .  C ADDR   1361H   R   SEG=MAIN   3178 3186#
ONVICH . . . . . .  C ADDR   0A9AH   R   SEG=MAIN   2011 2023#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 462
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 455 459
OUT6 . . . . . . .  C ADDR   0CFAH   R   SEG=MAIN   1920 2081 2086 2091 2108 2145 2150 2157 2231 2240 2247 2359#
OUT7 . . . . . . .  C ADDR   1166H   R   SEG=MAIN   2377 2378 2450 2457 2461 2512 2517 2917 2922 2963#
OUTF . . . . . . .  C ADDR   0B5AH   R   SEG=MAIN   2141 2153# 2166 2173 2179 2185 2196 2201 2210 2213 2216 2220 2249
                                           2262 2271 2279 2290 2294 2304 2308 2321 2324 2349 2351 2354
OUTMA. . . . . . .  C ADDR   0BB8H   R   SEG=MAIN   2200 2201#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 3679
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 1598 1602
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 433
P1 . . . . . . . .  D ADDR   0090H   A      32# 583 584 1611 1613 1616 1619 1623 1625 1626 1875 1878 1880 1883 1889
                                           1891 1893 3124 3131
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 434
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    93

P2 . . . . . . . .  D ADDR   00A0H   A      47# 1644 1648 1657
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 435
P3 . . . . . . . .  D ADDR   00B0H   A      62# 444 1643 1645 1647 1653 1654 1655 1658 1659 1948 1950 1952 1953 1956
                                           1957 1959 1960 1962 1963 1965 1966 1968 1969 1971 1972 2139 2140 2188 2189
                                           2203 2204 2214 2215 2233 2234 2256 2257 2265 2266 2273 2274 2283 2284 2297
                                           2298 2311 2312 2332 2333 2340 2341 2352 2353 2373 2405 2407 2409 2410 2413
                                           2414 2416 2417 2419 2420 2422 2423 2425 2426 2428 2429 2508 2510 2535 2536
                                           2552 2553 2560 2561 2566 2567 2579 2580 2615 2616 2701 2702 2729 2730 2743
                                           2744 2745 2746 2752 2753 2768 2769 2779 2780 2805 2806 2807 2808 2833 2834
                                           2847 2848 2871 2872 2873 2874 2889 2890 2891 2892 2902 2903 2907 2908 2920
                                           2921 2977
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2370 2372 2974 2976
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 437
P4 . . . . . . . .  D ADDR   0084H   A      20# 2035 2037 2988 2991 3007 3009
P5 . . . . . . . .  D ADDR   0085H   A      21# 507 515 1479 1484 1519 1521 2045 2047 2996 2999 3027 3030
P6 . . . . . . . .  D ADDR   0086H   A      22# 585 587 591 593
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 438
PACK1. . . . . . .  C ADDR   00DEH   A      4480# 4695 4872 4974 5191
PARN . . . . . . .  D ADDR   00AFH   A      382# 512 1233 2064 2112 2434 2639
PART . . . . . . .  D ADDR   009AH   A      372# 508 697 875 908 935 948 1243 1271 1371 1382 2075 2113 2444 2625 2638
                                           3000 3149
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 431
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 432
PCON . . . . . . .  D ADDR   0087H   A      23#
PROD . . . . . . .  N NUMB   000CH   A      4417# 4761 4762 4763 4764 4784 4785 4786 4788 4789 4791 4792 4794 4816
                                           4818 4819 4821 4822 4824 4825 4827 4846 4847 4848 4850 4851 4853 4854 4856
                                           4867 4868 4869 4870 4891 4892 4893 4894 4910 4912 4913 4915 4916 4918 4919
                                           4921 4951 4968 4969 4970 4971
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 5222 5226 5279 5282
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 1784 1786 1928 2367 2385 2972 4152
                                           4160
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0A4EH   R   SEG=MAIN   1970 1976#
R10. . . . . . . .  N NUMB   000AH   A      418# 616 894 899 3265 5245
R11. . . . . . . .  N NUMB   000BH   A      419# 617 895 900 3269 5249
R8 . . . . . . . .  N NUMB   0008H   A      416# 1909 3257 5237
R9 . . . . . . . .  N NUMB   0009H   A      417# 1910 3261 5241
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    94

RE1. . . . . . . .  C ADDR   09B2H   R   SEG=MAIN   1889# 1895
RE4BYTE. . . . . .  C ADDR   0454H   A      5233#
REACP. . . . . . .  D ADDR   0077H   A      304# 598 600 602 604 644 660 668 676 685 692 701 734 754 763 1493 1495
                                           1497 1499 1531 1533 1535 1537
READ . . . . . . .  C ADDR   09B0H   R   SEG=MAIN   597 599 601 1888#
READYACP . . . . .  C ADDR   02B7H   R   SEG=MAIN   686 696#
READ_X2. . . . . .  C ADDR   089FH   R   SEG=MAIN   1652# 1663
REBYTE . . . . . .  C ADDR   020CH   R   SEG=MAIN   582# 627 726 1458 1467 1486 1524 1559 1568 1570
REBYTE2. . . . . .  C ADDR   046CH   A      914 993 5253#
REF0CN . . . . . .  D ADDR   00D1H   A      92# 439
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RESAR2 . . . . . .  C ADDR   0989H   R   SEG=MAIN   702 735 755 764 776 810 923 962 1001 1018 1072 1123 1171 1175
                                           1432 1853# 2495
RESAR8 . . . . . .  C ADDR   0947H   R   SEG=MAIN   929 965 974 1023 1074 1077 1506 1544 1792#
REZAM. . . . . . .  D ADDR   008CH   A      368# 1541
REZAP. . . . . . .  D ADDR   0088H   A      367# 1503
REZMUL . . . . . .  C ADDR   049EH   R   SEG=MAIN   943 953 960#
REZ_A. . . . . . .  D ADDR   0062H   A      357# 715 756 765 775 809 1431
REZ_A0 . . . . . .  D ADDR   006AH   A      359# 928 1022 1066 1104 2006 2487 2496 2503
REZ_A1 . . . . . .  D ADDR   0066H   A      358# 869 926 961 1006 1017 1073
REZ_A2 . . . . . .  D ADDR   007BH   A      360# 1019 1079
REZ_A3 . . . . . .  D ADDR   009CH   A      374# 931 1025 1122 1170 1174 1276 2494
REZ_AME. . . . . .  D ADDR   005EH   A      355# 881 922 978 1000
RGOTO7 . . . . . .  C ADDR   105BH   R   SEG=MAIN   2830# 2848 2874
RHNOT1 . . . . . .  C ADDR   0E30H   R   SEG=MAIN   2510 2519#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RIGBLO . . . . . .  C ADDR   0CA1H   R   SEG=MAIN   2311# 2328 2330
RIGBLOK. . . . . .  C ADDR   0CD4H   R   SEG=MAIN   2340#
RIGHT2 . . . . . .  C ADDR   0A62H   R   SEG=MAIN   1983 1987#
RIGHT3 . . . . . .  C ADDR   0A66H   R   SEG=MAIN   1985 1990#
RIMEN6 . . . . . .  C ADDR   0C08H   R   SEG=MAIN   2236 2244#
RIZMAN . . . . . .  C ADDR   09E1H   R   SEG=MAIN   1924# 1958
RKNLEFT. . . . . .  C ADDR   0D2AH   R   SEG=MAIN   2381# 2421
RKNMEM . . . . . .  C ADDR   0D1BH   R   SEG=MAIN   2376# 2427
RKNNUL . . . . . .  C ADDR   0D27H   R   SEG=MAIN   2380# 2415
RKNOPT . . . . . .  C ADDR   09DEH   R   SEG=MAIN   1923# 1967
RKNRAZR. . . . . .  C ADDR   09DBH   R   SEG=MAIN   1922# 1961
RKVVOD0. . . . . .  C ADDR   0F66H   R   SEG=MAIN   2703 2710#
RLABELF. . . . . .  C ADDR   09D8H   R   SEG=MAIN   1921# 1955
RLABELH. . . . . .  C ADDR   0D24H   R   SEG=MAIN   2379# 2412
RLABELI. . . . . .  C ADDR   0E36H   R   SEG=MAIN   2522# 2565
RLABELK. . . . . .  C ADDR   0E33H   R   SEG=MAIN   2521# 2524
RLABELL1 . . . . .  C ADDR   0CF7H   R   SEG=MAIN   2353 2356#
RLABL2 . . . . . .  C ADDR   0FA8H   R   SEG=MAIN   2740# 2744
RLER . . . . . . .  C ADDR   1385H   R   SEG=MAIN   3215 3217#
RMO220 . . . . . .  C ADDR   0527H   R   SEG=MAIN   1042#
RNNMEMB. . . . . .  C ADDR   0C16H   R   SEG=MAIN   2251# 2252
RNO3PARN . . . . .  C ADDR   063DH   R   SEG=MAIN   1220# 1234
RNOCHI0. . . . . .  C ADDR   0529H   R   SEG=MAIN   1030 1043#
RNOMEMK. . . . . .  C ADDR   0F45H   R   SEG=MAIN   2675# 2698
RNORIM6. . . . . .  C ADDR   0C05H   R   SEG=MAIN   2234 2242#
RNORVICH . . . . .  C ADDR   063BH   R   SEG=MAIN   1165 1166 1219#
RNOT1IN. . . . . .  C ADDR   070CH   R   SEG=MAIN   1273 1367#
ROUT6. . . . . . .  C ADDR   09D5H   R   SEG=MAIN   1920# 1949 1954
ROUT7. . . . . . .  C ADDR   0D21H   R   SEG=MAIN   2378# 2406 2411
ROUTF. . . . . . .  C ADDR   0E76H   R   SEG=MAIN   2553 2557# 2616
RR0. . . . . . . .  N NUMB   0000H   A      409# 1929 2366 2386 2971
RR1. . . . . . . .  N NUMB   0001H   A      410# 1930 2365 2387 2970
RR2. . . . . . . .  N NUMB   0002H   A      412# 1579 1931 2364 2388 2969
RR3. . . . . . . .  N NUMB   0003H   A      413# 1580 1932 2363 2389 2968
RR4. . . . . . . .  N NUMB   0004H   A      1933 2362 2390 2967 3481# 3538 3559 3575 3619 3641
RR5. . . . . . . .  N NUMB   0005H   A      1934 2361 2391 2966 3482# 3539 3546 3553 3620 3629
RR6. . . . . . . .  N NUMB   0006H   A      411# 1935 2360 2392 2965
RR7. . . . . . . .  N NUMB   0007H   A      414# 1936 2359 2393 2964
RRIR . . . . . . .  C ADDR   1392H   R   SEG=MAIN   3226 3228#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    95

RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   05D5H   R   SEG=MAIN   1149# 1167
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 469
RTIZMRI. . . . . .  C ADDR   0B3DH   R   SEG=MAIN   2136#
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SAVBA. . . . . . .  D ADDR   003CH   A      307# 1946 2403 3179 3186
SAVEIR2. . . . . .  C ADDR   08CBH   R   SEG=MAIN   778 813 1691#
SAVELTE. . . . . .  C ADDR   04A7H   A      5316#
SAVER2 . . . . . .  C ADDR   08D7H   R   SEG=MAIN   524 526 528 706 716 739 757 766 870 882 927 932 979 1007 1020
                                           1026 1080 1179 1444 1504 1516 1542 1554 1705# 2497 2504 2936 2954
SBUF0. . . . . . .  D ADDR   0099H   A      40#
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   0861H   R   SEG=MAIN   1611# 1618
SDV1 . . . . . . .  C ADDR   0875H   R   SEG=MAIN   1623# 1629
SDVIG0 . . . . . .  C ADDR   0298H   R   SEG=MAIN   672# 674
SDVIG1 . . . . . .  C ADDR   028DH   R   SEG=MAIN   664# 666
SDVIG2 . . . . . .  C ADDR   0282H   R   SEG=MAIN   656# 658
SDVIG3 . . . . . .  C ADDR   0276H   R   SEG=MAIN   647# 649
SDVIG4 . . . . . .  C ADDR   02A7H   R   SEG=MAIN   682# 684
SDVIG6 . . . . . .  C ADDR   02B1H   R   SEG=MAIN   689# 691
SDVM . . . . . . .  C ADDR   02AFH   R   SEG=MAIN   679 688#
SEEGOON. . . . . .  C ADDR   0642H   R   SEG=MAIN   1209 1217 1224#
SEEIND . . . . . .  C ADDR   0650H   R   SEG=MAIN   1141 1148 1149 1237#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      4412# 4433 4434 4459 4460 4484 4627 4644 4865 4905
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   0ED5H   R   SEG=MAIN   2611# 2626
SP . . . . . . . .  D ADDR   0081H   A      17# 430
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 475
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 474
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 1600
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SS1. . . . . . . .  C ADDR   1408H   R   SEG=MAIN   3311# 3313
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      386# 703 705 718 736 738 1064 1102 2004 2485
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   132EH   R   SEG=MAIN   3141# 3150
TABUS. . . . . . .  C ADDR   11C7H   R   SEG=MAIN   2985 3036#
TAKTIND. . . . . .  C ADDR   068BH   R   SEG=MAIN   1266 1269#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 466 467
TEAEQU0. . . . . .  C ADDR   1243H   R   SEG=MAIN   2592 3088#
TEBBL. . . . . . .  C ADDR   12D9H   R   SEG=MAIN   2824 3105#
TEBEQU0. . . . . .  C ADDR   124DH   R   SEG=MAIN   2940 3089#
TEBL . . . . . . .  C ADDR   12CFH   R   SEG=MAIN   2733 3104#
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    96

TEBLOK . . . . . .  C ADDR   12C5H   R   SEG=MAIN   2790 3103#
TECLE. . . . . . .  C ADDR   1294H   R   SEG=MAIN   2277 2664 2715 3098#
TEEBL. . . . . . .  C ADDR   12E3H   R   SEG=MAIN   2861 3106#
TEFULL . . . . . .  C ADDR   12BBH   R   SEG=MAIN   2784 3102#
TEIZMK . . . . . .  C ADDR   1276H   R   SEG=MAIN   2164 2171 2548 3095#
TEKALIB. . . . . .  C ADDR   126BH   R   SEG=MAIN   2237 3094#
TELIST . . . . . .  C ADDR   12B0H   R   SEG=MAIN   2269 2706 3101#
TEMEM. . . . . . .  C ADDR   129EH   R   SEG=MAIN   3099#
TEMENU . . . . . .  C ADDR   1257H   R   SEG=MAIN   2466 3090#
TENMIN . . . . . .  C ADDR   146DH   R   SEG=MAIN   940 942 3355#
TEOLL. . . . . . .  C ADDR   128AH   R   SEG=MAIN   1088 3097#
TEOUT. . . . . . .  C ADDR   1280H   R   SEG=MAIN   2177 2224 2539 3096#
TETEST . . . . . .  C ADDR   1261H   R   SEG=MAIN   2244 3092#
TEVICH . . . . . .  C ADDR   1239H   R   SEG=MAIN   2018 2183 2544 3087#
TEWR . . . . . . .  C ADDR   12A6H   R   SEG=MAIN   2260 2719 3100#
TEXTT. . . . . . .  C ADDR   11FEH   R   SEG=MAIN   3057 3078#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 449
TH1. . . . . . . .  D ADDR   008DH   A      29#
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   0885H   R   SEG=MAIN   1632#
TIM1 . . . . . . .  C ADDR   0887H   R   SEG=MAIN   1633# 1633
TIM2 . . . . . . .  C ADDR   088AH   R   SEG=MAIN   1614 1617 1624 1628 1636# 1879 1881 1890 1894
TIM3 . . . . . . .  C ADDR   088CH   R   SEG=MAIN   1637# 1637
TIZMRI . . . . . .  C ADDR   0A5BH   R   SEG=MAIN   1982# 2136
TL0. . . . . . . .  D ADDR   008AH   A      26# 450
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   0ED2H   R   SEG=MAIN   2596 2608#
TMOD . . . . . . .  D ADDR   0089H   A      25# 447
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 464
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 463
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 1601
UNPACK1. . . . . .  C ADDR   009EH   A      4430# 4624 4758 4888 5002
UNPACK2. . . . . .  C ADDR   00BAH   A      4455# 4625 4759 4889
UP1. . . . . . . .  C ADDR   0138H   A      4575# 4592
UP2. . . . . . . .  C ADDR   014BH   A      4595# 4613
UP2A . . . . . . .  C ADDR   0161H   A      4574 4611#
UPA. . . . . . . .  C ADDR   149CH   R   SEG=MAIN   3408# 3414
UPA1 . . . . . . .  C ADDR   14ACH   R   SEG=MAIN   3426# 3432
UPA2 . . . . . . .  C ADDR   148CH   R   SEG=MAIN   3391# 3397
UPAK . . . . . . .  C ADDR   1496H   R   SEG=MAIN   2929 2947 3405#
UPAK2. . . . . . .  C ADDR   1486H   R   SEG=MAIN   2815 3388#
UPAK3. . . . . . .  C ADDR   14A6H   R   SEG=MAIN   2854 2880 3423#
VICHR. . . . . . .  D ADDR   00B1H   A      384# 2015 2024 2161 2533 2584 2923 2958
VIG0 . . . . . . .  C ADDR   06D3H   R   SEG=MAIN   1327# 1329
VIG4 . . . . . . .  C ADDR   06E1H   R   SEG=MAIN   1338# 1340
VIOUT. . . . . . .  C ADDR   0B14H   R   SEG=MAIN   2021 2104#
VVCHIF . . . . . .  C ADDR   1369H   R   SEG=MAIN   2218 3194#
VVIZKO . . . . . .  C ADDR   0EABH   R   SEG=MAIN   2554 2584#
VVRR6. . . . . . .  C ADDR   0B71H   R   SEG=MAIN   2164#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 445 446
A51 MACRO ASSEMBLER  AMP20                                                                12/27/2006 09:45:26 PAGE    97

WORK . . . . . . .  D ADDR   00B8H   A      388# 1278 1353
WR1. . . . . . . .  C ADDR   099DH   R   SEG=MAIN   1875# 1882
WRITE. . . . . . .  C ADDR   099AH   R   SEG=MAIN   595 1873# 3113 3115 3117 3119 3121 3123 3126 3128 3130 3133 3135
                                           3137
WRITED_X1. . . . .  C ADDR   0890H   R   SEG=MAIN   1642#
WRITE_X1 . . . . .  C ADDR   088FH   R   SEG=MAIN   1641#
WRPAGE . . . . . .  C ADDR   0480H   A      5277#
WW5. . . . . . . .  C ADDR   0483H   A      5278# 5286
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 441 473
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 442
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 443 472
XCIKLWR. . . . . .  C ADDR   08B7H   R   SEG=MAIN   773 784 786 788 791 794 797 800 803 806 1674#
XTEMP. . . . . . .  N NUMB   000CH   A      3478# 3842 3843 3844 3845 3931 3933 3934 3936 3937 3939 3940 3942 3964
                                           3965 3966 3967 3985 3986 3990 3991 3994 3998 3999 4002 4006 4007 4011 4012
                                           4014 4015 4016 4018 4022 4023 4025 4026 4030 4031 4036 4037 4039 4040 4044
                                           4045 4050 4052 4053 4054
YBNUL. . . . . . .  C ADDR   0E09H   R   SEG=MAIN   2492 2500#
YES. . . . . . . .  C ADDR   1676H   R   SEG=MAIN   3864 3868 3872 3876 3894# 3957
YESAVP . . . . . .  C ADDR   052BH   R   SEG=MAIN   1014 1046#
YESBUF . . . . . .  C ADDR   0710H   R   SEG=MAIN   1365 1370#
YESPRD . . . . . .  C ADDR   070EH   R   SEG=MAIN   1364 1368#
YESTT5 . . . . . .  C ADDR   0731H   R   SEG=MAIN   1385 1392#
YESVICH. . . . . .  C ADDR   0558H   R   SEG=MAIN   1015 1070#
YESVIR . . . . . .  C ADDR   0BE4H   R   SEG=MAIN   2229#
Z01S . . . . . . .  C ADDR   1420H   R   SEG=MAIN   3328# 3330
Z100 . . . . . . .  C ADDR   13F1H   R   SEG=MAIN   3292# 3294
Z15. . . . . . . .  C ADDR   13FFH   R   SEG=MAIN   3304# 3306
Z1S. . . . . . . .  C ADDR   1413H   R   SEG=MAIN   3320# 3322
ZAPADC . . . . . .  C ADDR   085FH   R   SEG=MAIN   1610#
ZCMP . . . . . . .  C ADDR   0939H   R   SEG=MAIN   1782#
ZDIV . . . . . . .  C ADDR   0906H   R   SEG=MAIN   714 862 1126 1745#
ZER1 . . . . . . .  C ADDR   00B3H   A      4440 4444# 4499 4542
ZER2 . . . . . . .  C ADDR   00D4H   A      4466 4470#
ZMUL . . . . . . .  C ADDR   08FCH   R   SEG=MAIN   1740#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      316# 1199 1753 1756 1759
ZNPLUS . . . . . .  C ADDR   0269H   R   SEG=MAIN   606 636#
ZZ . . . . . . . .  C ADDR   1401H   R   SEG=MAIN   3305# 3305
Z_01S. . . . . . .  C ADDR   141CH   R   SEG=MAIN   631 632 633 1387 1939 2396 3190 3326#
Z_100. . . . . . .  C ADDR   13EFH   R   SEG=MAIN   3291#
Z_15 . . . . . . .  C ADDR   13FDH   R   SEG=MAIN   574 3303#
Z_1MS. . . . . . .  C ADDR   1406H   R   SEG=MAIN   3310#
Z_1S . . . . . . .  C ADDR   140FH   R   SEG=MAIN   541 549 3318#
Z_5. . . . . . . .  C ADDR   13F8H   R   SEG=MAIN   1646 1656 3298#
Z_9. . . . . . . .  C ADDR   0995H   R   SEG=MAIN   1603 1867#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
