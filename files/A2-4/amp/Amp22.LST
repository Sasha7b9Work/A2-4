A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp22.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp22.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236             
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                       jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
                     310                     
                     311     
                     312     ;;;;;
  0020               313      cellbit                DATA    20h
  0000               314     bitznak         BIT     cellbit.0       ;20.0           
  0001               315     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               316     znmat           BIT             cellbit.2       ;20.2
  0003               317     bitrs           BIT             cellbit.3       ;20.3
  0004               318     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               319     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               320     bitvi11         BIT             cellbit.6       ;20.6   бит нажатия ввод режима вычислить R
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     6

                             !!!
  0007               321     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us
                     322     
  0021               323     cellbit1                DATA    21h
  0008               324     bitbuf          BIT     cellbit1.0      ;21.0           
  0009               325     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               326     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               327     bitmem          BIT             cellbit1.3      ;21.3
  000C               328     bmem11          BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               329     bmem12          BIT             cellbit1.5      ;21.5    бит ПАМ12
  000E               330     bmem13          BIT             cellbit1.6      ;21.6   бит ПАМ13        
  000F               331     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     332     
  0022               333     cellbit2                DATA    22h
  0010               334     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               335     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               336     bitvi12         BIT             cellbit2.2      ;22.2  
  0013               337     bitvi13         BIT             cellbit2.3      ;22.3
  0014               338     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               339     bitvi21         BIT             cellbit2.5      ;22.5    
  0016               340     bitvi31         BIT             cellbit2.6      ;22.6   бит ПАМ13        
  0017               341     bitoll          BIT             cellbit2.7      ;22.7
                     342     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     343     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     344     ;и выдает т.н. буфер индикации  
  0023               345     cellbit3                DATA    23h
  0018               346     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               347     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               348     bitakt          BIT             cellbit3.2      ;22.2  бит такта
  001B               349     bitznB          BIT             cellbit3.3      ;22.3 БИТ ЗНАКА ПРИ ВВОДЕ константы В
                     350     ;bit            BIT             cellbit3.4      ;22.4    
                     351     ;bit            BIT             cellbit3.5      ;22.5    
                     352     ;bit            BIT             cellbit3.6      ;22.6            
                     353     ;bit            BIT             cellbit3.7      ;22.7
                     354             
  005E               355     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     356     ;hex
  0062               357     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               358     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               359     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               360     rez_A2   data 7bh; A2
                     361     
  0098               362     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               363     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               364     chdel    data  83h              ; счетчик задержки
                     365     ;float
  0084               366     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               367     rezAp    data  88h              ;4byte  A+
  008C               368     rezAm    data  8ch              ;4byte  A-
  0090               369     koefKp   data  90h              ;4byte  K+
  0094               370     koefKm   data  94h              ;4byte  K-
                     371     ;hex 
  009A               372     parT     data  9ah              ;параметр времени измерения
  009B               373     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               374     rez_A3   data  9ch              ;A3
                     375     ;FLOAT
  00A0               376     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               377     constE  data  0a4h         ;констант E
  00A8               378     constF  data  0a8h         ;констант F
  00AC               379     chind   data  0ach         ;счетчик индикации
  00AD               380     chbuf   data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               381     diap    data  0aeh         ;номер диапазона
  00AF               382     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               383     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               384     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               385     marker  data  0b2h         ;номер мигающего знакоместа
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     7

  00B3               386     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               387     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               388     work    data  0b8h        ;рабочая ячейка
  00BC               389     konstA  data  0bch        ;     введенная с крана константа A
  00C0               390     konstB  data  0c0h         ;    введенная с крана константа B
  00C4               391     nblok   data  0c4h         ;номер блока
  00C5               392     Rez_del data  0c5h      ;сумма n-значений /n
  00C9               393     rez_R           data    0c9h            ;рез вычисления R
                     394     ;data  0cfh
                     395     
                     396     ;внешнее ОЗУ 64K 
                     397     ;               XSEG AT 100h
                     398             PUBLIC    MASS0
  0080               399     MASS0  xdata 0080h;     скользящий массив измерения
  0084               400     MASS1  xdata 0084h;
  0088               401     MASS2  xdata 0088h;
  008C               402     MASS3  xdata 008ch;
  0090               403     MASS4  xdata 0090h;
  0094               404     MASS5  xdata 0094h;
  0098               405     MASS6  xdata 0098h;
  009C               406     MASS7  xdata 009ch;
  00A0               407     MASS8  xdata 00a0h;
  00A4               408     MASS9  xdata 00a4h;
  00A8               409     MASS10  xdata 00a8h;
  00AC               410     MASS11  xdata 00ach;
  00B0               411     MASS12  xdata 00b0h;
  00B4               412     MASS13  xdata 00b4h;
  00B8               413     MASS14  xdata 00b8h;
  00BC               414     MASS15  xdata 00bch;
  00C0               415     MASS16  xdata 00c0h;
  00C4               416     MASS17  xdata 00c4h;
  00C8               417     MASS18  xdata 00c8h;
  00CC               418     MASS19  xdata 00cch;
                     419     ;xdata 0038h;
                     420     
  0000               421                             rr0             EQU 00
  0001               422                     rr1       equ   01
  0006               423                     rr6   equ 06
  0002               424                     rr2       equ   02
  0003               425                     rr3       equ   03
  0007               426                     rr7   equ 07
                     427     
  0008               428                     r8   equ 08
  0009               429                     r9        equ   09
  000A               430                     r10       equ   10
  000B               431                     r11   equ 11
                     432     
                     433                     
                     434        
----                 435                  rseg     Main          ; Switch to this code segment.
                     436     
                     437                  using    0              ; Specify register bank for the following
                     438     
0100                 439     org 100h
                     440     ;$EJECT
                     441     
0100 7581E0          442     begin:     mov  sp, #0e0h
0103 75E900          443                                             mov             PCA0L,#00;=0x00;
0106 75D900          444                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          445                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          446                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          447                                             mov     P2MDOUT,#00;=0x00;
                     448             
0112 75A73F          449             mov     P3MDOUT,#3fh;
0115 75B5FF          450             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          451             mov     REF0CN,#03h;=0x03;
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     8

                     452             
011B 75E114          453             mov     XBR0,#14h;= 0x14;
011E 75E200          454             mov     XBR1,#00; =0x00;
0121 75E300          455             mov XBR2,#00;=0x00;
0124 75B0C0          456             mov     P3,#0c0h
0127 75FFDE          457             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          458             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          459             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          460             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          461             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          462             mov     TL0,#0f9h;=0xf9; 
0139 75E680          463             mov     EIE1,#80h;=0x80;
                     464     
013C 75D480          465             mov     DAC0CN,#80h;=0x80;
013F 75D780          466             mov     DAC1CN,#80h;=0x80;
0142 75B167          467             mov     OSCXCN,#67h;=0x67;
                     468     
                     469      
                     470     
0145 E5B1            471     gener:     mov a, oscxcn
0147 B4E7FB          472                cjne a,#11100111b,gener
                     473                            
014A 75B288          474             mov     OSCICN,#88h;=0x84;
014D 75CA00          475         mov TMR2RLL,#0;=0;
0150 75CBD1          476         mov TMR2RLH,#0d1h;=0xd1;
                     477       
0153 D28E            478                     setb  TCON.6                    ;регистр управления
0155 D28C            479                      setb tcon.4
                     480     
0157 75EF00          481             mov     RSTSRC,#0;=00   ;//источники сброса 
                     482     
                     483             
015A 75E340          484          mov        XBR2,#40h
015D 75E106          485              mov    XBR0,#06h;16h
0160 75F803          486             mov             SPI0CN,#03
0163 759D31          487             mov             spi0ckr,#31H;;;;;;;;#04
                     488     ;       mov             EIE2,#20H
0166 75E730          489             mov             EIE2,#30H;00110000
0169 75A880          490             mov     IE,#80h;//10000000      ;//Снятие блокировки всех прерываний
                     491     ;ozu
016C E4              492                             clr     a
016D 7800            493                             mov     r0,#00h 
016F F6              494     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
0170 08              495                             inc     r0
0171 B87FFB          496                             cjne    r0,#7fh,mecle
0174 7880            497                             mov     r0,#80h
0176 F6              498     meff:           mov     @r0,a 
0177 F2              499                             movx @r0,a
0178 08              500                             inc     r0
0179 B8DFFA          501                             cjne    r0,#0dfh,meff
017C 120000   F      502                             call    clmassix
017F 7898            503                             mov             r0,#chinkor
0181 7600            504                             mov             @r0,#0;1;
0183 08              505                             inc             r0
0184 76C8            506                             mov             @r0,#0c8h;90h;
                     507                             ;;;;
0186 7881            508                             mov             r0,#chavt
0188 7603            509                             mov             @r0,#3;1
018A 08              510                             inc             r0
018B 7620            511                             mov             @r0,#20h;90h
                     512     
018D 78B2            513                                     mov             r0,#marker
018F 76FF            514                                     mov             @r0,#0ffh
                     515                             ;mov            r0,#chind
                     516                             ;mov            @r0,#1
                     517                     
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE     9

0191 74FF            518                             mov             a,#0ffh
0193 F585            519                        mov          p5,a
0195 799A            520                             mov             r1,#parT
0197 7702            521                             mov             @r1,#2                  ;Tizm=1s
0199 79AE            522                             mov             r1,#diap
019B 7705            523                             mov             @r1,#5                  ;10-7a
019D 79AF            524                             mov             r1,#parN
019F 7702            525                             mov             @r1,#2
01A1 7400            526                             mov             a,#00h
01A3 F585            527                             mov             p5,a
01A5 D204            528                             setb    bitizm
                     529     
01A7 799B            530                             mov             r1,#chbefore
01A9 7700            531                             mov             @r1,#0
                     532                             ;;;;;;
01AB 900000   F      533                             mov             dptr,#ch_1              ;1->r2..r5 float
01AE 120000   F      534                             call    ldc_long
01B1 7890            535                             mov             r0,#koefKp         ;1(float)->koefKp
01B3 120000   F      536                             call    saver2
01B6 7894            537                             mov             r0,#koefKm              ;1(float)->koefKm
01B8 120000   F      538                             call    saver2
01BB 78A0            539                             mov             r0,#koefKD
01BD 120000   F      540                             call    saver2  
                     541     ;START
                     542     ;                                       rez_A0=0;
                     543     ;        SUMM=0; //обнуление скользящего массива
                     544     ;        over_mas=0;
                     545     ;        count_mas=0;
                     546     
01C0 7840            547                             mov             r0,#bufind
01C2                 548     age2:
01C2 76FD            549                             mov             @r0,#0fdh         ;погасить индикатор
01C4 08              550                             inc             r0
01C5 B84CFA          551                             cjne    r0,#bufind+12,age2              
01C8 120000   F      552                             call    ind
01CB 120000   F      553                             call    z_1s
                     554     
                     555                                     ;зажечь все лементы индикации
01CE 7840            556                             mov             r0,#bufind
01D0 76FE            557     ageon:          mov             @r0,#0feh;?
01D2 08              558                             inc             r0
01D3 B84CFA          559                             cjne    r0,#bufind+12,ageon             
01D6 120000   F      560                             call    ind
01D9 120000   F      561                             call    z_1s            ;1sec
                     562     ;;;;;;;;;;;;;;;;
01DC 7840            563                             mov             r0,#bufind
01DE 7630            564                             mov             @r0,#30H;"A"
01E0 08              565                             inc             r0
01E1 7630            566                             mov             @r0,#30H;"В"
01E3 08              567                             inc             r0
01E4 7630            568                             mov             @r0,#30H;"Т"
01E6 08              569                             inc             r0
01E7 7634            570                             mov             @r0,#34H;2dh
01E9 08              571                             inc             r0
01EA 7635            572                             mov             @r0,#35H;"H"
01EC 08              573                             inc             r0
01ED 7636            574                             mov             @r0,#36h
01EF 08              575                             inc             r0
01F0 7637            576                             mov             @r0,#37h
01F2 08              577                             inc             r0
01F3 762D            578                             mov             @r0,#2dh
01F5 08              579                             inc             r0
01F6 7637            580                             mov             @r0,#37h
01F8 08              581                             inc             r0
01F9 7641            582                             mov             @r0,#"A";31h
01FB 08              583                             inc             r0
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    10

                     584                     
01FC 120000   F      585     dd:                     call    ind
01FF 120000   F      586                             call    z_15;z_1ms
                     587             ;       jmp             dd
                     588     ;;;;;;;;;;;;;;;;;;;
0202 7C60            589                             mov             r4,#60h
0204 7D00            590                             mov             r5,#00         
0206 120000   F      591                             call    iniacp;инициализация acp
0209 120000   F      592                             call    loadUS          ;us 10-7 A
                     593                             
020C C217            594     rebyte:         clr             bitoll
020E 3095FD          595                             jnb             p1.5,$
0211 2095FD          596                             jb              p1.5,$
0214 E586            597                             mov             a,P6            ;p6.4=0
0216 54EF            598                             anl             a,#0efh
0218 F586            599                             mov             P6,a
021A 00              600                             nop
021B 00              601                             nop
                     602                                     
021C E586            603                             mov             a,P6                    ;p6.4=1 
021E 4410            604                             orl             a,#10h
0220 F586            605                             mov             P6,a                        
0222 7411            606                             mov             a,#11h
0224 120000   F      607                             call    write
                     608                             ;чтение acp
0227 120000   F      609                             call    read    
022A F578            610                             mov     reacp+1,A       ;старший байт 
022C 120000   F      611                             call    read    
022F F579            612                             mov     reacp+2,A       ;средний байт 
0231 120000   F      613                             call    read
0234 F57A            614                             mov     reacp+3,A               ;мл байт
                     615                        ;;;;;;;;;;;
0236 7878            616                        mov          r0,#reacp+1
0238 E6              617                        mov          a,@r0
0239 20E72D          618                             jb              acc.7,znplus;
023C D200            619                             setb    bitznak
023E 4480            620                             orl             a,#80h  ;ост содерж яч 
0240 F6              621                             mov             @r0,a
                     622                                     
0241 18              623     mmm:            dec             r0;,#reacp
0242 76FF            624                             mov             @r0,#0ffh
0244 802B            625                             jmp             goznak
                     626     
                     627     
0246 750A00          628     labelA:         mov             r10,#0          
0249 750B00          629                             mov             r11,#0
024C 783D            630                             mov             r0,#chkl
024E 120000   F      631                             call    chcmp
0251 7000            632                             jnz             no0key
                     633                             ;разрешить ie6,ie7       
                     634                     ;       mov             EIE2,#30h ;EIE2.5,EIE2.4
                     635                     ;       mov             EIP2,#30h
                     636                        
0253 793D            637     no0key:         mov             r1,#chkl 
0255 120000   F      638                             call    chdec
0258 2004B1          639                             jb              bitizm,rebyte
                     640                              ;буфер 2 выдать на индикацию
                     641     ;3.11.06
                     642     ;                       mov             r0,#vichR
                     643     ;                                               mov             a,@r0
                     644     ;                                               cjne    @r0,#21h,poivich
                     645     ;                                               mov             a,bufind+7
                     646     ;                                               orl             a,#40h
                     647     ;                                               mov             bufind+7,a      
                     648     ;poivich:
025B 120000   F      649                             call    ind
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    11

025E 120000   F      650                             call    z_01s
0261 120000   F      651                             call    z_01s
0264 120000   F      652                             call    z_01s
0267 80DD            653                             jmp             labelA
                     654     
0269 C200            655     znplus:         clr     bitznak
026B 547F            656                             anl             a,#7fh;fdh                      ;+
026D F6              657                             mov             @r0,a
026E 18              658                             dec             r0;,#reacp
026F 7600            659                             mov             @r0,#00h
                     660                             
0271                 661     goznak: 
                     662     ;;;;;;;;;;;;;
0271 787A            663                             mov     r0,#reacp+3
0273 E6              664                             mov             a,@r0
0274 7F05            665                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
0276 C3              666     sdvig3:         clr             c
0277 13              667                             rrc             a
0278 DFFC            668                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
027A FA              669                             mov             r2,a    ;сохр байт
027B 18              670                             dec             r0              ;       reacp+2
027C E6              671                             mov             a,@r0
027D C0E0            672                             push    acc
027F C3              673                             clr             c
0280 7F03            674                             mov             r7,#3;2
0282 C3              675     sdvig2:         clr             c
0283 33              676                             rlc             a
0284 DFFC            677                             djnz    r7,sdvig2 ;d12..d11      средний байт
0286 4A              678                             orl             a,r2
0287 F57A            679                             mov             reacp+3,a;сформ мл байт
0289 D0E0            680                             pop             acc
                     681                             
028B 7F05            682                             mov             r7,#5;6
028D C3              683     sdvig1:         clr             c
028E 13              684                             rrc             a
028F DFFC            685                             djnz    r7,sdvig1 ;d15,d14        ср байт
0291 FA              686                             mov             r2,a   ;сохр
0292 E578            687                             mov             a,reacp+1
0294 C0E0            688                             push    acc
                     689                     ;;      push    acc
0296 7F03            690                             mov             r7,#3;2
0298 C3              691     sdvig0:         clr             c
0299 33              692                             rlc             a
029A DFFC            693                             djnz    r7,sdvig0 ;       d21..d16
029C 4A              694                             orl             a,r2
029D F579            695                             mov             reacp+2,a       ; сформ средний  байт
029F D0E0            696                             pop             acc       ;reacp+1
                     697                             ;;;;;;;;;;;;;;
02A1 20E70B          698                             jb              acc.7,sdvm
02A4 C3              699                             clr             c
02A5 7F05            700                             mov             r7,#5;6
02A7 C3              701     sdvig4:         clr             c
02A8 13              702                             rrc             a
02A9 DFFC            703                             djnz    r7,sdvig4 ;       d23,d22
02AB F578            704                             mov             reacp+1,a
02AD 8008            705                             jmp             readyacp;ankor;klmas
                     706     ;;;;;;;;;;;;                                    
02AF 7F05            707     sdvm:           mov             r7,#5;6
02B1 D3              708     sdvig6:         setb            c
02B2 13              709                             rrc             a
02B3 DFFC            710                             djnz    r7,sdvig6 ;       d23,d22
02B5 F578            711                             mov             reacp+1,a
                     712                                                             
                     713     ; reacp..reacp+3-результат чтения асп(hex) 
                     714     ;;;;;;;;;
02B7                 715     readyacp:
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    12

02B7 7898            716                                             mov             r0,#chinkor
02B9 E6              717                             mov             a,@r0
02BA 30E702          718                             jnb             acc.7,gopart
02BD 8044            719                                     jmp             sumt2
                     720                     
02BF                 721     gopart:
02BF 789A            722                             mov             r0,#parT        ;параметр времени
02C1 793F            723                             mov             r1,#chmasN
02C3 B6013A          724                             cjne    @r0,#1,noparT1
                     725                             ;РЕЗ+РЕЗ
02C6 7877            726                             mov             r0,#reacp
02C8 120000   F      727                             call    resar2          ;reacp->r2..r5
02CB 78B6            728                             mov             r0,#summa+3;rez_A+3
02CD 120000   F      729                             call    ladd
02D0 78B3            730                             mov             r0,#summa;rez_A
02D2 120000   F      731                             call    saver2
02D5 793F            732                              mov            r1,#chmasN
02D7 7714            733                             mov             @r1,#20;10
02D9 789B            734                             mov             r0,#chbefore
02DB B6631E          735                             cjne    @r0,#99,nobef99
                     736                             ;РЕЗ/100
02DE 900000   F      737                             MOV        DPTR,#ch100 
02E1 120000   F      738     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
02E4 120000   F      739                             call    zdiv;divide
02E7 7862            740                             mov             r0,#rez_A
02E9 120000   F      741                             call    saver2          ;сумма 100 отсчетов /100
02EC 78C5            742                             mov             r0,#Rez_del
02EE 120000   F      743                             call    saver2  
                     744                        ;;;;;
02F1 78B3            745                        mov          r0,#summa
02F3 120000   F      746                        call         clear4
                     747     ;                       mov             a,chmas
                     748     ;                       mov             @r1,a   ;->chmasN
02F6 799B            749                             mov             r1,#chbefore
02F8 7700            750                             mov             @r1,#0
02FA 8048            751                             jmp             klmas           ;загр в массив скользящее ср
02FC 06              752     nobef99:        inc             @r0                     ;chbefore
02FD 020000   F      753                             jmp             rebyte;labelA;метка A
                     754     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     755     ;а потом уже располагаем  в скользящий массив  из n
                     756     
                     757     
                     758     
0300 B6021D          759     noparT1:        cjne    @r0,#2,noparT2
                     760                             ;РЕЗ+РЕЗ
0303                 761     sumt2:
0303 7877            762                              mov            r0,#reacp
0305 120000   F      763                             call    resar2          ;reacp->r2..r5
0308 78B6            764                             mov             r0,#summa+3;rez_A+3
030A 120000   F      765                             call    ladd
030D 78B3            766                             mov             r0,#summa;rez_A
030F 120000   F      767                             call    saver2
0312 789B            768                             mov             r0,#chbefore
0314 793F            769                             mov             r1,#chmasN
0316 770A            770                             mov             @r1,#10
0318 B613E1          771                             cjne    @r0,#19,nobef99;9,nobef99
                     772                             ;РЕЗ/10
031B 900000   F      773                             MOV        DPTR,#ch20;ch10 
031E 80C1            774                             jmp             allsum
                     775                             ;;;;;;;
                     776                             
                     777     
0320 B60302          778     noparT2:        cjne    @r0,#3,noparT3
0323 8003            779                             jmp             aapar
                     780     
0325 B60410          781     noparT3:        cjne    @r0,#4,noparT4
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    13

0328 7877            782     aapar:          mov             r0,#reacp
032A 120000   F      783                             call    resar2          ;reacp->r2..r5
032D 7862            784                             mov             r0,#rez_A
032F 120000   F      785                             call    saver2
0332 793F            786                              mov            r1,#chmasN
0334 770A            787                             mov             @r1,#10
                     788                     ;       mov             @r1,#10         ;n=10
0336 800C            789                             jmp             klmas
0338 7702            790     noparT4:   mov          @r1,#2          ;chmasN n=2
033A 7877            791                             mov             r0,#reacp
033C 120000   F      792                             call    resar2          ;reacp->r2..r5
033F 7862            793                             mov             r0,#rez_A
0341 120000   F      794                             call    saver2
                     795     ;загрузить А в массив из 2/10 значений
                     796     ;;;;;;;;;;;;;;;
0344                 797     klmas:           
0344 793F            798                             mov             r1,#chmasN
0346 B7021A          799                             cjne    @r1,#2,mas10
0349 900080          800                             MOV        dptr,#MASS0
034C 120000   F      801                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     802     
034F 7862            803                             mov             r0,#rez_A
0351 120000   F      804                             call    resar2          ;->r2..r5
0354 900080          805                             mov                     dptr,#MASS0
0357 120000   F      806                   call              saveIr2                 ; R2-R5 --> MAS0
                     807                     
035A 900087          808                   MOV          dptr,#MASS1+3
035D 120000   F      809                   CALL       addx
0360 020000   F      810                       jmp           endsum
0363 B70A7A          811     mas10:                  cjne    @r1,#10,mas20
0366 9000A0          812                                             mov                     dptr,#MASS8
0369 120000   F      813                     CALL            xCIKLWR         ;MASS8->MASS9
036C 90009C          814                                             mov                     dptr,#MASS7
036F 120000   F      815                     CALL            xCIKLWR         ;MASS7->MASS8
0372 900098          816                     MOV       dptr,#MASS6
0375 120000   F      817                     CALL       xCIKLWR         ; MASS6 --> MASS7
0378 900094          818                     MOV        dptr,#MASS5
                     819                    
037B 120000   F      820                    CALL        xCIKLWR        ; MASS5 --> MASS6
037E 900090          821                    MOV         dptr,#MASS4
                     822                    
0381 120000   F      823                    CALL        xCIKLWR        ; MASS4 --> MASS5
0384 90008C          824                             mov                     dptr,#MASS3
                     825     
0387 120000   F      826                    CALL             xCIKLWR         ;MASS3->MASS4
038A 900088          827                     MOV        dptr,#MASS2
                     828                    
038D 120000   F      829                    CALL        xCIKLWR         ; MASS2 --> MASS3
0390 900084          830                    MOV         dptr,#MASS1
                     831                     
0393 120000   F      832                   CALL         xCIKLWR        ; MASS1 --> MASS2
0396 900080          833                    MOV         dptr,#MASS0
                     834                   
0399 120000   F      835                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     836     
                     837                             
039C 7862            838                             mov             r0,#rez_A
039E 120000   F      839                             call    resar2          ;->r2..r5
                     840                                     ;call   aform
03A1 900080          841                                     mov                     dptr,#MASS0
03A4 120000   F      842                   call              saveIr2                 ; R2-R5 --> MAS0
                     843              
03A7 900087          844                   MOV          dptr,#MASS1+3
03AA 120000   F      845                   CALL       addx
03AD 90008B          846                   MOV          dptr,#MASS2+3
03B0 120000   F      847                   CALL       addx
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    14

03B3 90008F          848                   MOV          dptr,#MASS3+3
03B6 120000   F      849                  CALL        addx
03B9 900093          850                   MOV       dptr,#MASS4+3
03BC 120000   F      851                   call       addx
03BF 900097          852                     MOV        dptr,#MASS5+3
03C2 120000   F      853                  CALL        addx
03C5 90009B          854                   MOV          dptr,#MASS6+3
03C8 120000   F      855                   CALL       addx
03CB 90009F          856                   MOV          dptr,#MASS7+3
03CE 120000   F      857                  CALL        addx
03D1 9000A3          858                  MOV        dptr,#MASS8+3
03D4 120000   F      859                   call       addx
03D7 9000A7          860                     MOV                     dptr,#MASS9+3
03DA 120000   F      861                  call        addx
03DD 020000   F      862                              jmp            endsum
                     863     
03E0 9000C8          864     mas20:          mov                     dptr,#MASS18
03E3 120000   F      865                     CALL            xCIKLWR         ;MASS18->MASS19
03E6 9000C4          866                                             mov                     dptr,#MASS17
03E9 120000   F      867                     CALL            xCIKLWR         ;MASS17->MASS18
03EC 9000C0          868                     MOV       dptr,#MASS16
03EF 120000   F      869                     CALL       xCIKLWR         ; MASS16 --> MASS17
03F2 9000BC          870                     MOV        dptr,#MASS15
                     871                    
03F5 120000   F      872                    CALL        xCIKLWR        ; MASS15 --> MASS16
03F8 9000B8          873                    MOV         dptr,#MASS14
                     874                    
03FB 120000   F      875                    CALL        xCIKLWR        ; MASS14 --> MASS15
03FE 9000B4          876                             mov                     dptr,#MASS13
                     877     
0401 120000   F      878                    CALL             xCIKLWR         ;MASS13->MASS14
0404 9000B0          879                     MOV        dptr,#MASS12
                     880                    
0407 120000   F      881                    CALL        xCIKLWR         ; MASS12 --> MASS13
040A 9000AC          882                    MOV         dptr,#MASS11
                     883                     
040D 120000   F      884                   CALL         xCIKLWR        ; MASS11 --> MASS12
0410 9000A8          885                    MOV         dptr,#MASS10
                     886                   
0413 120000   F      887                    CALL        xCIKLWR        ; MASS10 --> MASS11
0416 9000A4          888                                      MOV       dptr,#MASS9
0419 120000   F      889                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     890     
041C 9000A0          891                                             mov                     dptr,#MASS8
041F 120000   F      892                     CALL            xCIKLWR         ;MASS8->MASS9
0422 90009C          893                                             mov                     dptr,#MASS7
0425 120000   F      894                     CALL            xCIKLWR         ;MASS7->MASS8
0428 900098          895                     MOV       dptr,#MASS6
042B 120000   F      896                     CALL       xCIKLWR         ; MASS6 --> MASS7
042E 900094          897                     MOV        dptr,#MASS5
                     898                    
0431 120000   F      899                    CALL        xCIKLWR        ; MASS5 --> MASS6
0434 900090          900                    MOV         dptr,#MASS4
                     901                    
0437 120000   F      902                    CALL        xCIKLWR        ; MASS4 --> MASS5
043A 90008C          903                             mov                     dptr,#MASS3
                     904     
043D 120000   F      905                    CALL             xCIKLWR         ;MASS3->MASS4
0440 900088          906                     MOV        dptr,#MASS2
                     907                    
0443 120000   F      908                    CALL        xCIKLWR         ; MASS2 --> MASS3
0446 900084          909                    MOV         dptr,#MASS1
                     910                     
0449 120000   F      911                   CALL         xCIKLWR        ; MASS1 --> MASS2
044C 900080          912                    MOV         dptr,#MASS0
                     913                   
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    15

044F 120000   F      914                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     915     
                     916                             
0452 7862            917                             mov             r0,#rez_A
0454 120000   F      918                             call    resar2          ;->r2..r5
                     919                                     ;call   aform
0457 900080          920                                     mov                     dptr,#MASS0
045A 120000   F      921                   call              saveIr2                 ; R2-R5 --> MAS0
                     922              
045D 900087          923                   MOV          dptr,#MASS1+3
0460 120000   F      924                   CALL       addx
0463 90008B          925                   MOV          dptr,#MASS2+3
0466 120000   F      926                   CALL       addx
0469 90008F          927                   MOV          dptr,#MASS3+3
046C 120000   F      928                  CALL        addx
046F 900093          929                   MOV       dptr,#MASS4+3
0472 120000   F      930                   call       addx
0475 900097          931                     MOV        dptr,#MASS5+3
0478 120000   F      932                  CALL        addx
047B 90009B          933                   MOV          dptr,#MASS6+3
047E 120000   F      934                   CALL       addx
0481 90009F          935                   MOV          dptr,#MASS7+3
0484 120000   F      936                  CALL        addx
0487 9000A3          937                  MOV        dptr,#MASS8+3
048A 120000   F      938                   call       addx
048D 9000A7          939                     MOV                     dptr,#MASS9+3
0490 120000   F      940                  call        addx
                     941     ;27
0493 9000AB          942                                     MOV        dptr,#MASS10+3
0496 120000   F      943                   CALL       addx
0499 9000AF          944                                     MOV        dptr,#MASS11+3
049C 120000   F      945                   CALL       addx
049F 9000B3          946                   MOV          dptr,#MASS12+3
04A2 120000   F      947                   CALL       addx
04A5 9000B7          948                   MOV          dptr,#MASS13+3
04A8 120000   F      949                  CALL        addx
04AB 9000BB          950                   MOV       dptr,#MASS14+3
04AE 120000   F      951                   call       addx
04B1 9000BF          952                                     MOV        dptr,#MASS15+3
04B4 120000   F      953                     CALL     addx
04B7 9000C3          954                   MOV          dptr,#MASS16+3
04BA 120000   F      955                   CALL       addx
04BD 9000C7          956                   MOV          dptr,#MASS17+3
04C0 120000   F      957                  CALL        addx
04C3 9000CB          958                  MOV        dptr,#MASS18+3
04C6 120000   F      959                   call       addx
04C9 9000CF          960                                     MOV                     dptr,#MASS19+3
04CC 120000   F      961                  call        addx
                     962     
                     963     
                     964     
                     965             ;23.03          
04CF                 966     endsum:
04CF 786E            967                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
04D1 06              968                                     inc             @r0
04D2 E6              969                                     mov             a,@r0   
04D3 200105          970                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                     971                                     
04D6 B53F26          972                                     cjne    a,chmasN,masx5
04D9 D201            973                                     setb    bitmas                  ;массив заполнен
04DB 853F6E          974     masfull:                mov             chmas,chmasN
04DE 783F            975                                     mov             r0,#chmasN
04E0 E6              976                                     mov             a,@r0
                     977     ;masfull:
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    16

04E1 B40208          978                                     cjne    a,#2,nochn2
04E4 900000   F      979                                     MOV        DPTR,#ch2;10 
04E7 120000   F      980                                     CALL   ldc_ltemp                 ; ltemp <-- 2
04EA 801D            981                                     jmp             mas5div
                     982     
04EC B40A08          983     nochn2:         cjne    a,#10,nochn10
04EF 900000   F      984                                                     MOV        DPTR,#ch10 
04F2 120000   F      985                                     CALL   ldc_ltemp                 ; ltemp <-- 10
04F5 8012            986                                     jmp             mas5div
                     987     
04F7                 988     nochn10:
04F7 900000   F      989                                                     MOV        DPTR,#ch20 
04FA 120000   F      990                                     CALL   ldc_ltemp                 ; ltemp <-- 20
04FD 800A            991                                     jmp             mas5div
04FF 856E0B          992     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
0502 E4              993                                     clr     a
0503 F50A            994                                     mov     ltemp+2,a
0505 F509            995                                     mov     ltemp+1,a
0507 F508            996                                     mov     ltemp,a
                     997     
0509                 998     mas5div:
0509 120000   F      999                                     CALL       zdiv;divide                           ; R2-R5 =
                    1000                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                    1001     
                    1002                             
                    1003      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1004     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1005     ;получен результат 3 байта и знак
050C 7866           1006                             mov             r0,#rez_A1
050E 120000   F     1007                             call    saver2           ;сохр среднее по массиву
                    1008     ;;8.11.06                       mov             chmasN,#0
                    1009      ;;;;;;;;;;;;
                    1010      ;;;;;;;;;;;;
0511 C3             1011                             clr             c
0512 799A           1012                             mov             r1,#parT
0514 7402           1013                             mov             a,#2
0516 97             1014                             subb    a,@r1
0517 500A           1015                             jnc             ankor           ;T<3
                    1016                             ;A-=РЕЗ1                                ;T>3
0519 120402         1017                             call    altof                   ;r2..r5->float
051C 785E           1018                             mov             r0,#rez_Ame
051E 120000   F     1019                             call    saver2
0521 8022           1020                             jmp             gotoKD
                    1021     
0523                1022     ankor:  
0523 7898           1023                             mov             r0,#chinkor
0525 E6             1024                             mov             a,@r0
0526 30E703         1025                             jnb             acc.7,nokorr
                    1026                             ;коррекция 0
0529 020000   F     1027                             jmp             kornul
052C                1028     nokorr: 
                    1029                             ;mov            r10,#00         ;       chavt
                    1030                             ;mov            r11,#00h
052C 7881           1031                             mov              r0,#chavt      
052E E6             1032                             mov                     a,@r0;call      chcmp           ;сравн счет
                             чик авто калибровки с 0h
052F 30E750         1033                             jnb             acc.7,nonulavt;jnz              nonulavt        
0532 750A00         1034                             mov             r10,#0;1;00;02          
0535 750BC8         1035                             mov             r11,#0c8h;90h;0c8h;58h
0538 7898           1036                             mov             r0,#chinkor
053A 120000   F     1037                             call    chcmp
053D 705B           1038                             jnz             noavk
                    1039                             ;автокалибровка
053F 020000   F     1040                             jmp             autoka;noavk;
                    1041     
0542 020000   F     1042     rafterK:                jmp             afterK
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    17

                    1043     ;;;;;;;;;;
0545 C3             1044      gotoKD:                clr             c
0546 799A           1045                             mov             r1,#parT
0548 7404           1046                             mov             a,#4
054A 97             1047                             subb    a,@r1
054B 50F5           1048                             jnc             rafterK         ;T<5
                    1049                             ;A1-=A- *KD                     ;T>5
054D 120000   F     1050                             call            findkoef                                ;r2,r3-hex
0550 12046C         1051                                     call            rebyte2                         ;r2..r5- he
                             x
                    1052                                     
0553 120402         1053                                     call    altof                   ;r2..r5->float
0556 900000   F     1054                                     mov     dptr,#CHtho;100000
0559 120000   F     1055                                     call    ldc_ltemp                       ;r8..r11
055C 1202B7         1056                                     call    fldiv
055F 120000   F     1057                                     call    move28
                    1058                             
0562 785E           1059                             mov             r0,#rez_Ame;->r2..r5   ???????????/
0564 120000   F     1060                             call    resar2
0567 120203         1061                                     call    flmul
056A 120343         1062                             call    ftol                    ;float->int
056D 7866           1063                             mov             r0,#rez_A1
056F 120000   F     1064                             call    saver2
0572 786A           1065                             mov             r0,#rez_A0;->r8..r11 hex
0574 120000   F     1066                             call    resar8
0577 120000   F     1067                             call    lsub            ;A3=A-1-A0
057A 789C           1068                             mov             r0,#rez_A3
057C 120000   F     1069                             call    saver2
057F 020000   F     1070                             jmp             labelB  
                    1071      ;;;;;;;;;;; 9.11.06
0582 789A           1072     nonulavt:        mov            r0,#parT
0584 E6             1073                             mov             a,@r0
0585 6401           1074                             xrl             a,#01
0587 700C           1075                             jnz             avtdec1
0589 7982           1076                             mov             r1,#chavt+1     ;T=1 chavt-10
058B 120000   F     1077                             call    tenmin
058E 7999           1078     kordec10:       mov             r1,#chinkor+1
0590 120000   F     1079                             call    tenmin
0593 8018           1080                             jmp             rezmul
                    1081     
0595 7981           1082     avtdec1:        mov             r1,#chavt       
0597 120000   F     1083                             call    chdec           ;chavt-1
                    1084     ;                       jmp             kordec1;rezmul
059A 789A           1085     noavk:          mov             r0,#parT
059C E6             1086                             mov             a,@r0
059D 6401           1087                             xrl             a,#01
059F 7007           1088                             jnz             kordec1
                    1089                             ;T=1 chinkor-10
05A1 7999           1090                     mov             r1,#chinkor+1
05A3 120000   F     1091                             call    tenmin
05A6 8005           1092                             jmp             rezmul
05A8 7998           1093     kordec1:        mov             r1,#chinkor
05AA 120000   F     1094                             call    chdec           ; chinkor-1
                    1095                        ;9.11.06
                    1096                             ;;;;;;;;;;;;;;
                    1097                             ;;;;;;;;;;;;;
                    1098     ;(РЕЗ1-АN)*K
05AD                1099     rezmul:
05AD 7866           1100                             mov             r0,#rez_A1;->r2..r5
05AF 120000   F     1101                             call    resar2
05B2 120402         1102                             call    altof   ;r2..r5->float  6.06    
05B5 7884           1103                             mov             r0,#kor0_AN;->r8..r11
05B7 120000   F     1104                             call    resar8
                    1105                             ;;call  altof   ;r2..r5->float
05BA 1201D1         1106                             call    flsub
05BD 7890           1107                             mov             r0,#koefKp;->r8..r11
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    18

05BF EA             1108                             mov             a,r2
05C0 30E702         1109                             jnb             acc.7,nminus
                    1110                             ;jnb            bitznak,nminus
                    1111                     
05C3 7894           1112                             mov             r0,#koefKm;->r8..r11
05C5 120000   F     1113     nminus:         call    resar8
05C8 120203         1114                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
                    1115                     
                    1116                     ;;;;;;;;        call    ftol                    ;float->int
05CB 785E           1117                             mov             r0,#rez_Ame
05CD 120000   F     1118                             call    saver2
                    1119      ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1120      ;;;;;;;;;;;;;;;;;;;;;;;;;;
05D0                1121     afterK:                 
                    1122     ;;;;;;;;;;;;;;
                    1123                             ;;;;;;  call    altof                   ;r2..r5->float
05D0 EA             1124                                     mov             a,r2
05D1 547F           1125                                     anl             a,#7fh
05D3 FA             1126                                     mov             r2,a
05D4 900000   F     1127                                     mov     dptr,#ch_220;220000
05D7 120000   F     1128                                     call    ldc_ltemp                       ;r8..r11=8
05DA 1201D6         1129                                     call    flcmp
                    1130                             ;       jnc             rmo220          ;A>220000
05DD 120000   F     1131                                     call            findkoef                                ;r2
                             ,r3-hex
05E0 12046C         1132                                     call            rebyte2                         ;r2..r5- he
                             x
                    1133                                     
05E3 120402         1134                                     call    altof                   ;r2..r5->float
05E6 900000   F     1135                                     mov     dptr,#CHtho;100000
05E9 120000   F     1136                                     call    ldc_ltemp                       ;r8..r11=8
05EC 1202B7         1137                                     call    fldiv
05EF 120000   F     1138                                     call    move28
05F2 785E           1139                                     mov             r0,#rez_Ame
05F4 120000   F     1140                                     call    resar2
                    1141                     
05F7 120203         1142                                     call    flmul     ;A1-=A-*KD  fl
                    1143                                     
05FA 120343         1144                                     call    ftol                    ;float->int
05FD 7866           1145                                     mov             r0,#rez_A1
05FF 120000   F     1146                                     call    saver2
0602 120402         1147                                     call    altof                   ;r2..r5->float
0605 900000   F     1148                                     mov     dptr,#ch_200;200000
0608 120000   F     1149                                     call    ldc_ltemp                       ;r8..r11=8
060B 1201D6         1150                                     call    flcmp
                    1151                                     ;jnc            mo220           ;A>200000
060E 301806         1152                                     jnb             knizm,goA2;             bitizm,goA2     
0611 200528         1153                                     jb              bitavp,yesavp   
0614 200652         1154     noavp:                  jb              bitvi11,yesvich
0617                1155     goA2:                    ;A2=A1-
0617 7866           1156                                      mov            r0,#rez_A1
0619 120000   F     1157                                     call    resar2
061C 787B           1158                                     mov             r0,#rez_A2
061E 120000   F     1159                                     call    saver2
0621                1160     goA3A2:                  ;A3=A2-A0
0621 786A           1161                                       mov           r0,#rez_A0
0623 120000   F     1162                                     call    resar8
0626 120000   F     1163                                     call    lsub
0629 789C           1164                                     mov             r0,#rez_A3
062B 120000   F     1165                                     call    saver2
                    1166                                     ;;;;;;
062E                1167     goonin:            ;jmp         goonind;indA3;8.11.06
062E 78AC           1168                                     mov             r0,#chind
0630 B60006         1169                                     cjne    @r0,#0,rnochi0
0633 020000   F     1170                                     jmp             goonind;indA3
                    1171     ;                               clr             P3.4
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    19

                    1172     ;                               nop
                    1173     ;                               nop
                    1174     ;                               setb    P3.4      ;??????????????????????/
                    1175     ;                               jmp             nop3_0
                    1176     
                    1177     ;                               jb              P3.0,nop3_0     ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1178     ;                               mov             r0,#rez_A0              ;r2..r5->rez_A0
                    1179     ;                               call    saver2                  ;ЗАПОМНИТЬ СМЕЩЕНИЕ НУЛЯ
                    1180     ;                               jmp             rebyte          ;age2
0636 020000   F     1181      rmo220:                jmp             mo220
0639 020000   F     1182      rnochi0:               jmp             nochi0
                    1183     
                    1184     ;;;;;;;;;;;;;;;;
063C EA             1185     yesavp:                 mov             a,r2
063D 547F           1186                                     anl             a,#7fh
063F FA             1187                                     mov             r2,a
0640 900000   F     1188                                     mov     dptr,#ch_10th;10000
0643 120000   F     1189                                     call    ldc_ltemp                       ;r8..r11=8
0646 1201D6         1190                                     call    flcmp
0649 50C9           1191                                     jnc             noavp           ;A>10000        
064B 78AE           1192                                     mov             r0,#diap                ;10-11
064D B60902         1193                                     cjne    @r0,#9,avpgo
0650 80C2           1194                                     jmp             noavp
0652                1195     avpgo:                  
0652 06             1196                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
0653 B60A01         1197                                     cjne    @r0,#0ah,clmasv
0656 16             1198                                     dec             @r0
0657                1199     clmasv:         ;сбросить массив
0657 120000   F     1200                             call    loadUS
                    1201                             ;call   louizm
065A 120000   F     1202                             call     clmassix
065D 78B3           1203                                     mov             r0,#summa
065F 120000   F     1204                                     call    clear4
0662 786A           1205                                     mov             r0,#rez_A0
0664 120000   F     1206                                     call    clear4                                             
                                                   
0667 80C5           1207                                jmp     goonin
                    1208     
0669                1209     yesvich:        ;A2=E/A1-+F
0669 78C0           1210                                             mov             r0,#konstB
066B 120000   F     1211                                     call    resar2
066E 120000   F     1212                                     call    move28
0671 7866           1213                                     mov             r0,#rez_A1
0673 120000   F     1214                                     call    resar2                          ;HEX
                    1215                                     
0676 120402         1216                                     call            altof                   ;r2..r5->float
0679 EA             1217                                     mov             a,r2                    ;модуль
067A 547F           1218                                     anl             a,#7fh
067C FA             1219                                     mov             r2,a
067D 120166         1220                                     call            fladd                           ;A1+B
                    1221                                     
0680 900000   F     1222                                     mov     dptr,#CH_500;
0683 120000   F     1223                                     call    ldc_ltemp                       ;r8..r11
0686 1201D6         1224                                     call    flcmp
0689 4073           1225                                     jc                      mo500R;error <500 >22000
068B 900000   F     1226                                     mov     dptr,#CH_22T;
068E 120000   F     1227                                     call    ldc_ltemp                       ;r8..r11
0691 1201D6         1228                                     call    flcmp
0694 5074           1229                                     jnc             mo500I          ;error
                    1230                                     ;;;;;;;;;;;;
0696 120000   F     1231                                     call            move28
0699 C008           1232                                     push            r8
069B C009           1233                                     push            r9
069D C00A           1234                                     push            r10
069F C00B           1235                                     push            r11
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    20

06A1 78BC           1236                                     mov             r0,#konstA
06A3 120000   F     1237                                     call    resar2
06A6 900000   F     1238                                     mov             dptr,#CH_B
06A9 120000   F     1239                                     CALL   ldc_ltemp                 ; ltemp <-- 10-7
06AC 120203         1240                                     call            flmul                           ;A*10-7
06AF D00B           1241                                     pop                     r11
06B1 D00A           1242                                     pop                     r10
06B3 D009           1243                                     pop                     r9
06B5 D008           1244                                     pop                     r8
06B7 1202B7         1245                                     call            fldiv                   ;результат R
06BA 78C9           1246                                     mov                     r0,#rez_R
06BC 120000   F     1247                                     call            saver2
06BF 120343         1248                                     call            ftol                    ;float->hex
                    1249                                     ;;;;;;;;;;
06C2 784F           1250                                             mov             r0,#abin
06C4 120000   F     1251                                             call    saver2
                    1252     ;;;;;;;;
06C7 7840           1253                                                     mov             r0,#bufind
06C9                1254     age9:
06C9 7620           1255                             mov             @r0,#" "          ;погасить индикатор
06CB 08             1256                             inc             r0
06CC B84BFA         1257                             cjne    r0,#bufind+11,age9
                    1258                                             
06CF 78C9           1259                                             mov             r0,#rez_R
06D1 120000   F     1260                                             call            resar2
                    1261     ;;;;;;;;;;
06D4 900000   F     1262                                     mov             dptr,#CH_fl
06D7 120000   F     1263                                     CALL   ldc_ltemp
06DA 1202B7         1264                                     call            fldiv
                    1265     
06DD 78B8           1266                                     mov             r0,#work                ;степень +
06DF 7600           1267                                     mov             @r0,#0
06E1 78B9           1268                                     mov             r0,#work+1;степень -
06E3 7600           1269                                     mov             @r0,#0
06E5 900000   F     1270     compa1: mov     dptr,#ch_1;
06E8 120000   F     1271                                     call    ldc_ltemp                       ;r8..r11
06EB 1201D6         1272                                     call    flcmp
06EE 4026           1273                                     jc              equ0            ;<1
06F0 78B8           1274                                     mov             r0,#work                        ;степень +
06F2 06             1275                                     inc             @r0
06F3 900000   F     1276                                     mov             dptr,#ch_10;
06F6 120000   F     1277                                     call    ldc_ltemp                       ;r8..r11
06F9 1202B7         1278                                     call            fldiv
06FC 80E7           1279                                     jmp             compa1                          ;work значе
                             ние степени n(hex)  
                    1280                                     ;;;;;;;;;;;;;;;;;;;
06FE 900000   F     1281     mo500R: mov             dptr,#teOLR
0701 120000   F     1282                               call          lotext           ;ПРОСМОТР
0704 120000   F     1283                                     call            ind
0707 020000   F     1284                                     jmp                     nobitizm
070A 900000   F     1285     mo500I: mov             dptr,#teOLI
070D 120000   F     1286                               call          lotext           ;ПРОСМОТР
0710 120000   F     1287                                     call            ind
0713 020000   F     1288                                     jmp                     nobitizm
0716                1289     equ0:           ;;;;;   call            ftol                    ;float->int
0716 78B8           1290                                     mov             r0,#work                ;степень +
0718 B60019         1291                                     cjne    @r0,#0,equ00
                    1292                                     
071B 900000   F     1293     compa2: mov     dptr,#ch_1;
071E 120000   F     1294                                     call    ldc_ltemp                       ;r8..r11
0721 1201D6         1295                                     call    flcmp
0724 500E           1296                                     jnc             equ00           ;>1
0726 78B9           1297                                     mov             r0,#work+1                      ;степень -
0728 16             1298                                     dec             @r0                                        
                                          ;0,ff(-1),fe(-2)...
0729 900000   F     1299                                     mov             dptr,#ch_10;
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    21

072C 120000   F     1300                                     call    ldc_ltemp                       ;r8..r11
072F 120203         1301                                     call            flmul
0732 80E7           1302                                     jmp             compa2                          ;work значе
                             ние степени n(hex)  
                    1303     
                    1304     
0734                1305     equ00:          
0734 7853           1306                                                     mov             r0,#adec
0736 7952           1307                                             mov             r1,#abin+3      ;hex->10
0738 120000   F     1308                                             call    bindec
                    1309     
                    1310                                                     ;если степень полож убирать младший байт
                    1311                                                     ;чтобы уложиться в 5 разрядов, если отриц р
                             асполагать
                    1312                                                     ;число в bufind..bufind+5
073B 78B8           1313                                             mov             r0,#work
073D B60021         1314                                             cjne    @r0,#0,outr
0740 08             1315                                             inc             r0                      ;work+1
0741 B6FF05         1316                                             cjne            @r0,#0ffh,bufr3         ;6разрядов 
                             нужно вывести 5
0744 06             1317                                             inc                     @r0;!!!!!!!!!?
0745 785B           1318                                             mov                     r0,#adec+8;разместить в буф
                             ер индикации R
0747 8003           1319                                             jmp                     bufr30
                    1320                                             ;;;;;;;;;;;;;;
0749 06             1321     bufr3:          inc             @r0                     ;?!!!!!!!!n+1
074A 785C           1322                                                     mov             r0,#adec+9
074C 7945           1323     bufr30:         mov             r1,#bufind+5;6
074E 7F05           1324                                             mov             r7,#5;7
0750 E6             1325     bufr2:                          mov             a,@r0
0751 2430           1326                                             add             a,#30h
0753 F7             1327                                             mov             @r1,a
0754 19             1328                                             dec             r1
0755 18             1329                                             dec             r0
0756 DFF8           1330                                             djnz    r7,bufr2
                    1331     
0758 784F           1332                                             mov             r0,#abin
075A 120000   F     1333                                             call            clear4
075D 78B9           1334                                             mov             r0,#work+1
075F 801C           1335                                     jmp             outr5
                    1336     ;work!=0 значит после дел на 10**9 получили число > с чем 6 разрядов                       
                                          
0761 785C           1337     outr:                   mov             r0,#adec+9;разместить в буфер индикации R
0763 C3             1338                                             clr             c
0764 79B8           1339                                             mov             r1,#work
0766 E8             1340                                             mov             a,r0
0767 14             1341                                             dec             a                                  
                                  ;n-1
0768 97             1342                                             subb    a,@r1
0769 F8             1343                                             mov             r0,a                    ;adec+9-n !
                             !!!!!!!!!!!!!!
076A 7945           1344                                     mov             r1,#bufind+5;т к число разрядов > чем знако
                             мест
076C 7F05           1345                                             mov             r7,#5;7
076E E6             1346     bufr:                           mov             a,@r0
076F 2430           1347                                             add             a,#30h
0771 F7             1348                                             mov             @r1,a
0772 19             1349                                             dec             r1
0773 18             1350                                             dec             r0
0774 DFF8           1351                                             djnz    r7,bufr
                    1352     
0776 784F           1353                                             mov             r0,#abin
0778 120000   F     1354                                             call            clear4
077B 78B8           1355                                     mov             r0,#work
077D E6             1356     outr5:                  mov             a,@r0
077E F552           1357                                             mov             abin+3,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    22

                    1358                                                                     ;n(hex)->abin
0780 120000   F     1359                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
0783 2552           1360                                             add             a,abin+3
0785 F552           1361                                             mov             abin+3,a
0787 7853           1362                                             mov             r0,#adec
0789 7952           1363                                             mov             r1,#abin+3      ;hex->10
078B 120000   F     1364                                             call    bindec
078E 855C48         1365                                             mov             bufind+8,adec+9
0791 855B47         1366                                             mov             bufind+7,adec+8
0794 754966         1367                                             mov             bufind+9,#66h
0797 020000   F     1368                                             jmp             nobitizm;       goonin;call     ind
                    1369                                             
                    1370                                     ;;;;;;;;;;;;;;;;;;;;;
                    1371     ;;;;;;;;;;;;;
                    1372     
079A 300508         1373     mo220:             jnb          bitavp,indoll
079D 301805         1374                                jnb          knizm,indoll;bitizm,indoll
07A0 78AE           1375                                     mov             r0,#diap
07A2 B6000B         1376                                     cjne    @r0,#0,nodi2
                    1377                                ;10-2
07A5 900000   F     1378     indoll:                 mov             dptr,#teOLL;OLL
07A8 120000   F     1379                                     call    lotext
07AB D217           1380                                     setb    bitoll
07AD 020000   F     1381                                     jmp             goonin  
                    1382     
07B0 16             1383     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1384     
07B1 B6FF01         1385                                     cjne    @r0,#0ffh,nodi9
07B4 06             1386                                     inc             @r0
                    1387     
07B5 120000   F     1388     nodi9:          call    loadUS
                    1389                                     ;call   louizm
                    1390                                     ;сбросить массив
07B8 120000   F     1391                                     call     clmassix
07BB 78B3           1392                                     mov             r0,#summa
07BD 120000   F     1393                                     call    clear4
07C0 786A           1394                                     mov             r0,#rez_A0
07C2 120000   F     1395                                     call    clear4  
07C5 D207           1396                                     setb    bitzus  ;флаг задержки  после установки us         
                                                                   
07C7 020000   F     1397                                jmp     goonin
                    1398     
07CA 16             1399     nochi0:                 dec             @r0                     ;СТИ-1
07CB 020000   F     1400                                     jmp             labelB  
                    1401     
                    1402             
                    1403     ;;;;;;;;;;;;;;;
                    1404     
07CE                1405     nop3_0: ;;      ;rez_A-rez_A0
                    1406                     ;;                      mov             r0,#rez_A0
                    1407                     ;;                      call    resar8
                    1408                     ;;                      call    lsub
                    1409                     ;;                      mov             r0,#rez_A
                    1410                     ;;;                     call    saver2
                    1411      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
07CE 789C           1412      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
07D0 120000   F     1413                                             call    resar2
07D3 900000   F     1414                                             mov             dptr,#ch100              
07D6 120000   F     1415                                             call    ldc_ltemp        
07D9 120000   F     1416                                             call    zdiv            ;rez_A3/100=r2..r5
                    1417                                     
07DC EC             1418                                             mov             a,r4
07DD 20E71E         1419                                             jb              acc.7,aless0
07E0 4408           1420                                             orl             a,#08                   ;rez_A>0 d1
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    23

                             1=1
07E2 F5D3           1421                                             mov             DAC0H,a
                    1422                                                                             ;мл байт
07E4 ED             1423                                             mov             a,r5
07E5 F5D2           1424                                             mov             DAC0L,a
07E7 801E           1425                                             jmp             moveA3;
                    1426     
07E9 B70207         1427     no3parN:                        cjne    @r1,#2,no2parN
                    1428                                             ;в байт 0  записать пробел
07EC 7946           1429                                             mov             r1,#bufind+6
07EE 7720           1430                                             mov             @r1,#" ";0fdh;
07F0 020000   F     1431                                             jmp             seeind;moveA3
                    1432     
07F3                1433     no2parN:                        ;в байты 0 и 1 записать пробел
07F3 7945           1434                                             mov             r1,#bufind+5
07F5 7720           1435                                             mov             @r1,#" ";0fdh;" "
07F7 09             1436                                             inc             r1
07F8 7720           1437                                             mov             @r1,#" ";0fdh;" "
07FA 807B           1438                                             jmp             seeind;moveA3
07FC 8079           1439      rseeind:               jmp             seeind
07FE F4             1440     aless0:                         cpl             a
07FF 54F7           1441                                             anl             a,#0f7h         ;d11=0
0801 F5D3           1442                                             mov             DAC0H,a
                    1443                                                                             ;мл байт
0803 ED             1444                                             mov             a,r5
0804 F4             1445                                             cpl             a
0805 F5D2           1446                                             mov             DAC0L,a
0807                1447     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1448                                     
                    1449                                             
0807                1450     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1451                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1452                     ;до конца цикла измерения результат не размещать в буфере
                    1453                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1454                     ;и возврату в режим измерения
0807 201458         1455                                             jb              bitvich,rnorvich
080A 201055         1456                                             jb              bitt2,rnorvich
080D 2017EC         1457                                             jb              bitoll,rseeind
                    1458             
                    1459     ;;;;;;;;;;;;;;
0810 789C           1460                                              mov            r0,#rez_A3
0812 120000   F     1461                                             call    resar2
0815 120343         1462                                             call    ftol                    ;float->int r2..r5
                    1463     ;;;;;;;;
0818 789C           1464                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
081A 120000   F     1465                                             call    resar2
                    1466                                     
081D 120000   F     1467                                             call    maform
0820 784F           1468                                             mov             r0,#abin
0822 120000   F     1469                                             call    saver2
                    1470     ;;;;;;;;
                    1471                                             
0825 7853           1472                                             mov             r0,#adec
0827 7952           1473                                             mov             r1,#abin+3      ;hex->10
0829 120000   F     1474                                             call    bindec
                    1475                                     
082C 785C           1476                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
082E 7946           1477                                             mov             r1,#bufind+6
0830 7F07           1478                                             mov             r7,#7
0832 E6             1479     bufdec:                         mov             a,@r0
0833 2430           1480                                             add             a,#30h
0835 F7             1481                                             mov             @r1,a
0836 19             1482                                             dec             r1
0837 18             1483                                             dec             r0
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    24

0838 DFF8           1484                                             djnz    r7,bufdec
083A 7847           1485                                             mov             r0,#bufind+7
083C 762D           1486                                             mov             @r0,#2dh          ;-2..-9
083E 7840           1487                                             mov             r0,#bufind
0840 762B           1488                                             mov             @r0,#2bh
0842 300202         1489                                             jnb             znmat,nozzmi;bitznak,nozzmi
0845 762D           1490                                             mov             @r0,#2dh
0847 79AE           1491     nozzmi:                         mov             r1,#diap
0849 7848           1492                                             mov             r0,#bufind+8
084B E7             1493                                             mov             a,@r1
084C B40808         1494                                             cjne    a,#8,nodi8
084F 7630           1495                                             mov             @r0,#30h                 ;10-10
0851 18             1496                                             dec             r0
0852 7663           1497                                             mov             @r0,#63h;31h
0854 08             1498                                             inc             r0
0855 8012           1499                                             jmp             seegoon
0857 B4090C         1500     nodi8:                          cjne    a,#9,nodis9
                    1501                                     
085A 7631           1502                                             mov             @r0,#31h           ;10-11
085C 18             1503                                             dec             r0
085D 7663           1504                                             mov             @r0,#63h;31h
                    1505                                     
085F 08             1506                                             inc             r0
0860 8007           1507                                             jmp             seegoon
                    1508     
0862 8051           1509     rnorvich:               jmp             norvich
0864 8083           1510     rno3parN:               jmp             no3parN
                    1511     
0866 2432           1512     nodis9:                         add             a,#32h
0868 F6             1513                                             mov             @r0,a;#37h;"T";
0869 08             1514     seegoon:                        inc             r0
086A 7641           1515                                             mov             @r0,#"A";"E";
086C 08             1516                                             inc             r0
086D 7600           1517                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
086F 08             1518                                             inc             r0;             mov             buf
                             ind+11
0870 76C0           1519                                             mov             @r0,#0c0h
                    1520                                             
                    1521     ;;;;;;;;;;;;;;;
                    1522     ;;;;;;goonind:
0872 79AF           1523                                             mov             r1,#parN        ; ??????
0874 B703ED         1524                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1525                                     
                    1526             
0877                1527     seeind:                         ;;;;;;;;;;;;;
0877 784A           1528                                             mov             r0,#bufind+10
0879 E6             1529                                             mov             a,@r0
087A 300F03         1530                                             jnb             bitnul,nnnul
087D 4408           1531                                             orl             a,#08h
087F F6             1532                                             mov             @r0,a
0880 799A           1533      nnnul:                         mov             r1,#parT
0882 B70304         1534                                             cjne    @r1,#3,nsec01
0885 4410           1535                                             orl             a,#10h
0887 800C           1536                                             jmp             nsec10   ;0,1s
0889 B70204         1537      nsec01:                        cjne    @r1,#2,nsec1
088C 4420           1538                                             orl             a,#20h    ;1s
088E 8005           1539                                             jmp             nsec10
0890 B70102         1540     nsec1:                          cjne    @r1,#1,nsec10
0893 4440           1541                                             orl             a,#40h
                    1542     
                    1543     ;;;;;;;;;;;;;;;;
0895 F6             1544     nsec10:                         mov             @r0,a
0896 300504         1545                                             jnb             bitavp,nobavp
0899 4404           1546                                             orl             a,#04           ;bufind+10.2
089B F6             1547                                             mov             @r0,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    25

089C F6             1548                                             mov             @r0,a   
089D 301803         1549     nobavp:                    jnb          knizm,nobitizm
08A0 4402           1550                                             orl             a,#02
08A2 F6             1551                                              mov            @r0,a
08A3                1552     nobitizm:                       
08A3 301A07         1553                                             jnb             bitakt,notakt
08A6 C21A           1554                                             clr             bitakt
08A8 534AFE         1555                                             anl             bufind+10,#0feh
08AB 8005           1556                                             jmp             taktind
08AD D21A           1557     notakt:                         setb    bitakt
08AF 434A01         1558                                             orl             bufind+10,#01                      
                                          
08B2                1559     taktind:                
                    1560     
08B2 120000   F     1561                                             call    ind        ;пп выдачи на индикатор
08B5                1562     norvich: 
08B5 789A           1563                                     mov             r0,# parT
08B7 79AC           1564                                             mov             r1,#chind
08B9 B60177         1565                                             cjne    @r0,#1,rnot1in
08BC                1566     labelB:                    ;;;;;;;;;;;
                    1567                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
08BC 789F           1568                                                     mov     r0,#rez_A3+3
                    1569                             ;;;;;;;;
08BE 79BB           1570                             mov             r1,#work+3
08C0 E6             1571                             mov             a,@r0
08C1 7F07           1572                             mov             r7,#7;кол сдв вправо
08C3 C3             1573     dvig3:          clr             c
08C4 13             1574                             rrc             a
08C5 DFFC           1575                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
08C7 FA             1576                             mov             r2,a    ;сохр байт
08C8 18             1577                             dec             r0              ;rez_A3+2
08C9 E6             1578                             mov             a,@r0
08CA C0E0           1579                             push    acc
08CC C3             1580                             clr             c
08CD 7F01           1581                             mov             r7,#1
08CF C3             1582     dvig2:          clr             c
08D0 33             1583                             rlc             a
08D1 DFFC           1584                             djnz    r7,dvig2 ;d12..d11       средний байт
08D3 4A             1585                             orl             a,r2
08D4 F7             1586                             mov             @r1,a;сформ мл байт
08D5 19             1587                             dec             r1
08D6 D0E0           1588                             pop             acc
                    1589                             
08D8 7F07           1590                             mov             r7,#7
08DA C3             1591     dvig1:          clr             c
08DB 13             1592                             rrc             a
08DC DFFC           1593                             djnz    r7,dvig1 ;d18     ср байт
08DE FA             1594                             mov             r2,a   ;сохр
08DF 18             1595                             dec             r0
08E0 E6             1596                             mov             a,@r0 ;rez_A3+1
08E1 C0E0           1597                             push    acc
                    1598                     
08E3 7F01           1599                             mov             r7,#1
08E5 C3             1600     dvig0:          clr             c
08E6 33             1601                             rlc             a
08E7 DFFC           1602                             djnz    r7,dvig0 ;        d21..d16
08E9 4A             1603                             orl             a,r2
08EA F7             1604                             mov             @r1,a   ; сформ средний  байт
08EB 19             1605                             dec             r1
08EC D0E0           1606                             pop             acc       ;rez_A3+1
                    1607                             ;;;;;;;;;;;;;;
                    1608     ;                       jb              acc.7,dvm
08EE C3             1609                             clr             c
08EF 7F07           1610                             mov             r7,#7
08F1 C3             1611     dvig4:          clr             c
08F2 13             1612                             rrc             a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    26

08F3 DFFC           1613                             djnz    r7,dvig4 ;        d22
08F5 FA             1614                             mov             r2,a   ;сохр
08F6 18             1615                             dec             r0;     rez_A3
08F7 E6             1616                             mov             a,@r0
                    1617                             ;;;;;
08F8 7F01           1618                             mov             r7,#1
08FA C3             1619     vig0:           clr             c
08FB 33             1620                             rlc             a
08FC DFFC           1621                             djnz    r7,vig0 ;         d24..d30
08FE 4A             1622                             orl             a,r2
08FF F7             1623                             mov             @r1,a   ; сформ   байт
0900 19             1624                             dec             r1
0901 E6             1625                             mov             a,@r0
                    1626                             ;;;;;
0902 20E709         1627                             jb              acc.7,dvm
0905 C3             1628                             clr             c
0906 7F07           1629                             mov             r7,#7
0908 C3             1630     vig4:           clr             c
0909 13             1631                             rrc             a
090A DFFC           1632                             djnz    r7,vig4 ;         d
090C 8006           1633                             jmp             endsdv
                    1634     ;;;;;;;;;;;;                                    
090E 7F07           1635     dvm:            mov             r7,#7
0910 D3             1636     dvig6:          setb            c
0911 13             1637                             rrc             a
0912 DFFC           1638                             djnz    r7,dvig6 ;        d31
0914 F7             1639     endsdv:         mov             @r1,a
                    1640                                                             
                    1641      ;->work   
                    1642                             
0915 900000   F     1643                             mov             dptr,#chzap
0918 120000   F     1644                             call     ldc_long
091B 78BB           1645                              mov            r0,#work+3
091D 120000   F     1646                             call    ladd
0920 ED             1647                             mov             a,r5
0921 F5D5           1648                             mov             DAC1L,a
                    1649                             
0923 EC             1650                             mov             a,r4
0924 F5D6           1651                             mov             DAC1H,a
                    1652     
                    1653                                             ;;;;;;;;;;
0926 78AD           1654                                             mov             r0,#chbuf         ;T=1
0928 B6002F         1655                                             cjne    @r0,#0,nobuf0
092B 200907         1656                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
092E 200A06         1657                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0931 801A           1658                                             jmp             gocikle
0933 8028           1659     rnot1in:                jmp             not1in
0935                1660     yesprd: ;передать   A3 в буфер
0935 8000           1661                                             jmp             goonT
0937                1662     yesbuf: ;записать   A3 в буфер
0937 789A           1663     goonT:                          mov             r0,#parT
0939 79AD           1664                                             mov             r1,#chbuf
093B B60102         1665                                             cjne    @r0,#1,nott1
                    1666                                     ;       mov             @r1,#
093E 800D           1667                                             jmp             gocikle
                    1668     
0940 B60502         1669     nott1:                          cjne    @r0,#5,nott5
                    1670     
0943 8008           1671                                             jmp             gocikle
                    1672     
0945 C3             1673     nott5:           clr            c
0946 799A           1674                             mov             r1,#parT
0948 7404           1675                             mov             a,#4
094A 97             1676                             subb    a,@r1
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    27

094B 500B           1677                             jnc             yestt5          ;T<5
094D 300805         1678     gocikle:        jnb             bitbuf,nofz                                     
0950 120000   F     1679                             call    z_01s    ;0,5c
0953 C208           1680                             clr     bitbuf
0955 020000   F     1681     nofz:           jmp     labelA;rebyte
                    1682     
                    1683     
0958 80F3           1684     yestt5:         jmp             gocikle
                    1685     
095A 16             1686     nobuf0:                         dec             @r0
095B 80F0           1687                                             jmp             gocikle
                    1688     
                    1689     
095D B60205         1690     not1in:                         cjne    @r0,#2,not2in
0960 7701           1691                                             mov             @r1,#1           ;T=2
0962 020000   F     1692                                             jmp     labelB
                    1693     
0965 B60305         1694     not2in:                         cjne    @r0,#3,not3in
0968 7709           1695                                             mov             @r1,#9          ;T=3
096A 020000   F     1696                                             jmp     labelB
096D 7713           1697     not3in:                         mov             @r1,#19
096F 020000   F     1698                                             jmp     labelB
                    1699     
                    1700     
                    1701     ;;;;;;;;;;;3.11.06
                    1702     
                    1703     ;;коррекция 0
0972 7883           1704     KORnul:         mov             r0,#chdel
0974 B60008         1705                             cjne    @r0,#0,nonuldel
                    1706                                     
                    1707                     ;       mov             a,P5       ;p5.3=1
                    1708                     ;       orl             a,#08
                    1709                     ;       mov             P5,a
                    1710                     ;       nop
                    1711                     ;       nop
                    1712                                     
                    1713                     ;       mov             a,P5              ;p5.0=0
                    1714                     ;       anl             a,#0feh
                    1715                     ;       mov             P5,a
                    1716             
0977 900000   F     1717                             mov             dptr,#kor0us
097A 120000   F     1718                             call    lospus          ;упр слово коррекции 0
097D 8013           1719                             jmp             chdelmo
                    1720     
097F                1721     nonuldel:       ;cjne   @r0,#7,no4del
097F B60316         1722                                                     cjne    @r0,#3,no4del
                    1723                             ;рез ->AN
0982 7862           1724                             mov             r0,#rez_A;->r2..r5
0984 120000   F     1725                             call    resar2
                    1726                     ;       mov             a,reacp         ;r2..r5 &&&&&&&&&&&
                    1727                     ;               mov             r2,a
                    1728                     ;               mov             a,reacp+1
                    1729                     ;               mov             r3,a
                    1730                     ;               mov             a,reacp+2
                    1731                     ;               mov             r4,a
                    1732                     ;               mov             a,reacp+3
                    1733                     ;               mov             r5,a
                    1734                                     ;;;;;;;;;;
0987 120402         1735                             call    altof           ;r2..r5->float
098A 7884           1736                             mov             r0,#kor0_AN;->kor0_AN
098C 120000   F     1737                             call    saver2
                    1738                                     
                    1739                     ;       mov             a,P5            ;p5.0=1
                    1740                     ;       orl             a,#01
                    1741                     ;       mov             P5,a
                    1742                     ;       nop
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    28

                    1743                     ;       nop
                    1744                                     
                    1745                     ;       mov             a,P5                    ;p5.3=0 
                    1746                     ;       anl             a,#0f7h
                    1747                     ;       mov             P5,a                    
098F 120000   F     1748                             call    loadUS          ;восстан исходное упр слово
0992 7883           1749     chdelmo:        mov             r0,#chdel
0994 06             1750                             inc             @r0             ;chdel+1
0995 020000   F     1751                             jmp              rebyte
                    1752     
0998                1753     no4del:         ;cjne   @r0,#14,chdelmo
0998 B606F7         1754                                             cjne    @r0,#6,chdelmo
099B 7600           1755                             mov             @r0,#0          ;chdel
099D 7898           1756                             mov             r0,#chinkor
099F 7600           1757                             mov             @r0,#00;1;00;02;600;
09A1 08             1758                             inc             r0
09A2 76C8           1759                             mov             @r0,#0c8h;90h;0c8h;58h;258h
09A4 120000   F     1760                             call    clmassix;сбросить массив скольз среднего
09A7 020000   F     1761                             jmp              rebyte
                    1762     
                    1763     ;автокалибровка
09AA                1764     autoka:  ;;  mov                r0,#chavt
                    1765                      ;;  call               chcmp
                    1766                      ;;  jz         nulavt
                    1767                     ;;   mov                r1,#chavt
                    1768                     ;;   call               chdec;chavt-1
                    1769                      ;; jmp         rebyte
09AA                1770     nulavt:  ;;;;;
09AA 7883           1771                             mov             r0,#chdel
09AC B6000E         1772                             cjne    @r0,#0,nndelch
09AF E585           1773                             mov   a,p5
09B1 4404           1774                             orl             a,#04              ;p5.2=1
09B3 00             1775                             nop
09B4 00             1776                             nop
09B5 543F           1777                             anl             a,#3fh          ;p5.6,p5.7=0
09B7 F585           1778                             mov   p5,a
09B9 06             1779                             inc             @r0
09BA 020000   F     1780                             jmp              rebyte
                    1781     
09BD B6033D         1782     nndelch:        cjne    @r0,#3,n4delch
                    1783                             ;pez->A+
                    1784                             ;K+=000/(A+-AN)
                    1785                             ;mov            r0,#rez_A;->r2..r5
                    1786                             ;call   resar2
09C0 E577           1787                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
09C2 FA             1788                                     mov             r2,a
09C3 E578           1789                                     mov             a,reacp+1
09C5 FB             1790                                     mov             r3,a
09C6 E579           1791                                     mov             a,reacp+2
09C8 FC             1792                                     mov             r4,a
09C9 E57A           1793                                     mov             a,reacp+3
09CB FD             1794                                     mov             r5,a
                    1795                                     ;;;;;;;;;;;;;;;
09CC 120402         1796                             call    altof                   ;r2..r5->float
09CF 7888           1797                             mov             r0,#rezAp;->rezAp
09D1 120000   F     1798                             call    saver2                          
09D4 7884           1799                             mov             r0,#kor0_AN;kor0_AN->r8..r11
09D6 120000   F     1800                             call    resar8                          
09D9 1201D1         1801                             call    flsub           ; r2..r5(A+-AN)
09DC 120000   F     1802                             call    move28     ;r2..r5->r8..r11
09DF 900000   F     1803                             mov             dptr,#CH2tho;000->r2..r5 float
09E2 120000   F     1804                             call    ldc_long                
09E5 1202B7         1805                             call    fldiv
09E8 EA             1806                             mov             a,r2
09E9 547F           1807                             anl             a,#7fh
09EB FA             1808                             mov             r2,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    29

09EC 7890           1809                             mov             r0,#koefKp;->koefKp
09EE 120000   F     1810                             call    saver2
                    1811                       
                    1812                     ;       anl             P5,#0feh                ;p5.0=0 
09F1 E585           1813                     mov             a,P5
09F3 543B           1814                             anl             a,#3bh;acp-
09F5 F585           1815                             mov             P5,a
09F7 7883           1816                             mov             r0,#chdel
09F9 06             1817                             inc             @r0                       ;ch+1
09FA 020000   F     1818                             jmp             rebyte
                    1819     
09FD B6063A         1820     n4delch:        cjne    @r0,#6,n8delch
                    1821                             ; pez->A-
                    1822                             ;K-=000/(A--AN)
                    1823                     ;       mov     r0,#rez_A;->r2..r5
                    1824                     ;       call    resar2
0A00 E577           1825                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0A02 FA             1826                                     mov             r2,a
0A03 E578           1827                                     mov             a,reacp+1
0A05 FB             1828                                     mov             r3,a
0A06 E579           1829                                     mov             a,reacp+2
0A08 FC             1830                                     mov             r4,a
0A09 E57A           1831                                     mov             a,reacp+3
0A0B FD             1832                                     mov             r5,a
                    1833                                     ;;;;;;;;;;;;;;;
0A0C 120402         1834                             call    altof                   ;r2..r5->float
0A0F 788C           1835                             mov             r0,#rezAm;->rezAm
0A11 120000   F     1836                             call    saver2                          
0A14 7884           1837                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0A16 120000   F     1838                             call    resar8                          
0A19 1201D1         1839                             call    flsub                   ; r2..r5(A--AN)
0A1C 120000   F     1840                             call    move28                  ;r2..r5->r8..r11
0A1F 900000   F     1841                             mov             dptr,#CH2tho    ;000->r2..r5 float
0A22 120000   F     1842                             call    ldc_long                
0A25 1202B7         1843                             call    fldiv
0A28 EA             1844                             mov             a,r2
0A29 547F           1845                             anl             a,#7fh
0A2B FA             1846                             mov             r2,a
0A2C 7894           1847                             mov             r0,#koefKm;->koefKm
0A2E 120000   F     1848                             call    saver2
                    1849                        
0A31 120000   F     1850                             call    loadus
0A34 7883           1851                             mov             r0,#chdel
0A36 06             1852                             inc             @r0                       ;ch+1
0A37 020000   F     1853                        jmp    rebyte
                    1854     
0A3A B6090F         1855     n8delch:        cjne    @r0,#9,n12delch
0A3D 7600           1856                             mov             @r0,#0
0A3F 7981           1857                             mov             r1,#chavt
0A41 770C           1858                             mov             @r1,#0ch;6;1;
0A43 09             1859                             inc             r1
0A44 7780           1860                             mov             @r1,#80h;40h;
0A46 120000   F     1861                             call   clmassix     ;сбросить массив среднего
0A49 020000   F     1862                             jmp             rebyte
0A4C 06             1863     n12delch:       inc             @r0
0A4D 020000   F     1864                             jmp             rebyte
                    1865     
                    1866     ;in-r1-count
0A50                1867     chdec:          ;mov            r1,#chavt               ;chavt-1
0A50 E7             1868                             mov             a,@r1
0A51 FC             1869                             mov             r4,a
0A52 09             1870                             inc             r1
0A53 E7             1871                             mov             a,@r1
0A54 FD             1872                             mov             r5,a
0A55 C202           1873                             clr             rr2
0A57 C203           1874                             clr             rr3
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    30

0A59 900000   F     1875                             mov             dptr,#ch1        
0A5C 120000   F     1876                             call    ldc_ltemp
0A5F 120000   F     1877                             call    lsub
0A62 ED             1878                             mov             a,r5
0A63 F7             1879                             mov             @r1,a
0A64 19             1880                             dec             r1
0A65 EC             1881                             mov             a,r4
0A66 F7             1882                             mov             @r1,a
0A67 22             1883                             ret      
                    1884     
                    1885     
                    1886     
                    1887     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
0A68 75E700         1888      ind:   mov             EIE2,#00H;mov   IE,#00h
0A6B 120000   F     1889                     call    mign
0A6E 7840           1890                      mov            r0,#bufind;+11
0A70 7F0C           1891                      mov            r7,#12
0A72 C286           1892      nexin: clr             p0.6
0A74 E6             1893                     mov             a,@r0
0A75 F59B           1894                     mov             SPI0DAT,a
0A77 20FBFD         1895                     jb              TXBSY,$
0A7A D286           1896                     setb    p0.6
0A7C 120000   F     1897                     call    z_9             ;25mks
0A7F 08             1898                     inc             r0;dec          r0
0A80 DFF0           1899                     djnz    r7,nexin
0A82 75E730         1900                     mov             EIE2,#30H;mov   IE,#80h
0A85 22             1901                ret
                    1902     
                    1903     
0A86 7A08           1904     zapadc:   mov R2,#8
0A88 D297           1905     sdv:      setb P1.7
0A8A 33             1906               rlc A
0A8B 9296           1907                     mov P1.6,C
0A8D 120000   F     1908                     call tim2
                    1909                                     
0A90 C297           1910                     clr P1.7
0A92 120000   F     1911                     call tim2
0A95 DAF1           1912                     djnz R2,sdv
0A97 D296           1913                     setb P1.6
0A99 22             1914                     ret
                    1915     
0A9A 7A08           1916     chtadc:   mov R2,#8
0A9C D297           1917     sdv1:     setb P1.7
0A9E 120000   F     1918               call tim2
0AA1 C297           1919                     clr P1.7
0AA3 A296           1920                     mov C,P1.6
0AA5 33             1921                     rlc A
0AA6 120000   F     1922                     call tim2
0AA9 DAF1           1923                     djnz R2,sdv1
0AAB 22             1924                     ret
                    1925     
0AAC 7E30           1926     tim:      mov R6,#30h;38h
0AAE DEFE           1927     tim1:     djnz R6,tim1
0AB0 22             1928               ret
                    1929               
0AB1 7E10           1930     tim2:     mov R6,#10h;14h
0AB3 DEFE           1931     tim3:     djnz R6,tim3
0AB5 22             1932               ret
                    1933     
                    1934     ;запись из acc
0AB6 C3             1935     write_x1: clr   c
0AB7                1936     writeD_x1:
0AB7 92B1           1937                       mov P3.1,c        ;запись
0AB9 F5A0           1938               mov P2,A
0ABB D2B3           1939                       setb P3.3
0ABD 120000   F     1940                       call z_5
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    31

0AC0 C2B3           1941                       clr P3.3
0AC2 75A0FF         1942                       mov P2,#0FFh
0AC5 22             1943                       ret
                    1944     
                    1945     ;чтение в acc
0AC6 C3             1946     read_x2:  clr   c  
0AC7 92B1           1947               mov P3.1,c        ;чтение
0AC9 D2B2           1948               setb P3.2
0ACB D2B3           1949                       setb P3.3
0ACD 120000   F     1950                     call z_5
0AD0 E5A0           1951                       mov A,P2
0AD2 C2B3           1952                       clr P3.3
0AD4 C2B2           1953                       clr P3.2
0AD6 22             1954                       ret
                    1955     
                    1956     
0AD7 120000   F     1957     loop:     call read_x2;x2    ;ожидание флага готовности
0ADA 20E7FA         1958                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
0ADD 22             1959                        ret           ;возврат, если бит А(7)<>1
                    1960                                      
                    1961                                        
                    1962     
                    1963     
                    1964     
                    1965     ;dptr+4-приемник
                    1966     ;dptr-источник
                    1967     ;r7-кол байт  
0ADE                1968     xCIKLWR:
0ADE 7F04           1969                             mov             r7,#4   
0AE0 E0             1970     lwrx:   movx    a,@dptr
0AE1 C083           1971                             push    dph
0AE3 C082           1972                             push    dpl
0AE5 A3             1973                             inc             dptr
0AE6 A3             1974                             inc             dptr
0AE7 A3             1975                             inc             dptr
0AE8 A3             1976                             inc             dptr
0AE9 F0             1977                             movx    @dptr,a
0AEA D082           1978                             pop             dpl
0AEC D083           1979                             pop             dph
                    1980                             
0AEE A3             1981                             inc             dptr
0AEF DFEF           1982                             djnz    r7,lwrx
0AF1 22             1983                             ret
                    1984     ;r2..r5->@dptr..@dptr+3                         
0AF2 EA             1985     saveIr2:                mov     a,r2
0AF3 F0             1986                                             movx    @dptr,a
0AF4 A3             1987                                             inc     dptr
0AF5 EB             1988                                             mov     a,r3
0AF6 F0             1989                                             movx    @dptr,a
0AF7 A3             1990                                             inc     dptr
0AF8 EC             1991                                             mov     a,r4
0AF9 F0             1992                                             movx    @dptr,a
0AFA A3             1993                                             inc     dptr
0AFB ED             1994                                             mov     a,r5
0AFC F0             1995                                             movx    @dptr,a
0AFD 22             1996                                             ret
                    1997     ;r2..r5-> @r0..@r0+3
                    1998     
0AFE EA             1999     saver2:         mov     a,r2
0AFF F6             2000                                             mov     @r0,a
0B00 08             2001                                             inc     r0
0B01 EB             2002                                             mov     a,r3
0B02 F6             2003                                             mov     @r0,a
0B03 08             2004                                             inc     r0
0B04 EC             2005                                             mov     a,r4
0B05 F6             2006                                             mov     @r0,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    32

0B06 08             2007                                             inc     r0
0B07 ED             2008                                             mov     a,r5
0B08 F6             2009                                             mov     @r0,a
0B09 22             2010                                             ret 
0B0A 7F50           2011     clmassix:       mov                     r7,#50h;28h
0B0C 900080         2012                             mov     dptr,#MASS0        ;забить массив A нулями
0B0F 7400           2013     clmax:          mov          a,#00h
0B11 F0             2014                  movx    @dptr,a
0B12 A3             2015                  inc     dptr
0B13 DFFA           2016                 djnz                r7,clmax                
0B15 F56E           2017                  mov     chmas,a
0B17 C201           2018                  clr     bitmas
0B19 22             2019                 ret
                    2020     
                    2021     ;r1-яЁшхьшъ
                    2022     ;r0-шёЄюўшъ
                    2023     ;r7-ъюы срщЄ  
0B1A                2024     CIKLWR:
0B1A 7F04           2025                             mov             r7,#4   
0B1C E6             2026     lwr:    mov     a,@r0
0B1D F7             2027                             mov     @r1,a
0B1E 09             2028                             inc             r1
0B1F 08             2029                             inc             r0
0B20 DFFA           2030                             djnz    r7,lwr
0B22 22             2031                             ret     
                    2032     ;r2..r5-> @dptr..@dptr+3
                    2033     
0B23 120000   F     2034     zmul:   call    maform
0B26 120000   F     2035                     call    lmul
0B29 120000   F     2036                     call    bform
0B2C 22             2037                     ret
                    2038     
0B2D 120000   F     2039     zdiv:   call    maform
0B30 120000   F     2040                     call    divide
0B33 120000   F     2041                     call    bform
0B36 22             2042                     ret
                    2043     
0B37 EA             2044     maform: mov a,r2
0B38 33             2045             rlc a
0B39 5006           2046             jnc             fo1m
0B3B D202           2047                     setb            znmat
0B3D 120000   F     2048                     call   form4
0B40 22             2049                     ret
0B41 C202           2050     fo1m:   clr             znmat
0B43 22             2051                     ret
                    2052     
0B44 300203         2053     bform:  jnb             znmat,fo2m
0B47 120000   F     2054                     call    form4
0B4A 22             2055     fo2m:   ret
                    2056       
                    2057     ;r2..r5 яхЁхтхёЄш т фюя ъюф
0B4B ED             2058     form4:          mov a,r5
0B4C F4             2059             cpl a
0B4D 2401           2060             add a,#1
0B4F FD             2061             mov r5,a
0B50 EC             2062             mov a,r4
0B51 F4             2063             cpl a
0B52 3400           2064             addc    a,#0
0B54 FC             2065             mov r4,a
0B55 EB             2066             mov a,r3
0B56 F4             2067                 cpl a
0B57 3400           2068             addc    a,#0
0B59 FB             2069             mov r3,a
0B5A EA             2070             mov a,r2
0B5B F4             2071             cpl a
0B5C 3400           2072             addc    a,#0
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    33

0B5E FA             2073             mov r2,a
0B5F 22             2074             ret
                    2075     
0B60 120000   F     2076     zcmp:   call            maform
0B63 120000   F     2077                     call            lcmp
0B66 C0D0           2078                     push            psw
0B68 120000   F     2079                     call    bform
0B6B D0D0           2080                     pop             psw
0B6D 22             2081                     ret
                    2082     
                    2083     
                    2084     ;@r0..@r0+3->r8..r11
                    2085     
0B6E E6             2086     resar8: mov     a,@r0
0B6F F508           2087                     mov     ltemp,a
0B71 08             2088                     inc     r0
0B72 E6             2089                     mov     a,@r0
0B73 F509           2090                     mov     ltemp+1,a
0B75 08             2091                     inc     r0
0B76 E6             2092                     mov     a,@r0
0B77 F50A           2093                     mov     ltemp+2,a
0B79 08             2094                     inc     r0
0B7A E6             2095                     mov     a,@r0
0B7B F50B           2096                     mov     ltemp+3,a
0B7D 22             2097                     ret
                    2098     
                    2099     ;
                    2100     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                    2101     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                    2102     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                    2103     ;r2 a    ўшёыю 180
                    2104     ;00 b4
                    2105     ;т_ї- mabin..mabin+2
                    2106     ;     80 01 00
                    2107      
0B7E C8             2108     cond:   xch     a,r0    
0B7F F9             2109                     mov     r1,a
0B80 C8             2110                     xch     a,r0
0B81 7C03           2111                     mov     r4,#03
0B83 7700           2112     dcoa:   mov     @r1,#00
0B85 09             2113                     inc     r1
0B86 DCFB           2114                     djnz    r4,dcoa
0B88 7B10           2115                     mov     r3,#10h
0B8A C3             2116     dcob:   clr     c
0B8B 33             2117                     rlc     a
0B8C CA             2118                     xch     a,r2
0B8D 33             2119                     rlc     a
0B8E CA             2120                     xch     a,r2
0B8F C8             2121                     xch     a,r0
0B90 F9             2122                     mov     r1,a
0B91 C8             2123                     xch     a,r0
0B92 7C03           2124                     mov     r4,#03
0B94 FD             2125                     mov     r5,a
0B95 E7             2126     dcoc:   mov     a,@r1 
0B96 37             2127                     addc    a,@r1
0B97 D4             2128                     da      a
0B98 F7             2129                     mov     @r1,a
0B99 09             2130                     inc     r1
0B9A DCF9           2131                     djnz    r4,dcoc
0B9C ED             2132                     mov     a,r5
0B9D 4003           2133                     jc      dcod
0B9F DBE9           2134                     djnz    r3,dcob
0BA1 C3             2135                     clr     c
0BA2 00             2136     dcod:   nop
0BA3 22             2137                     ret
                    2138     
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    34

0BA4 8A08           2139     move28: mov     ltemp,r2                        ;r2..r5->ltemp
0BA6 850309         2140                     mov     ltemp+1,3
0BA9 85040A         2141                     mov     ltemp+2,4
0BAC 85050B         2142                     mov     ltemp+3,5
0BAF 22             2143                     ret
                    2144     
                    2145     ;@r0..@r0+3->r2..r5
                    2146     
0BB0 E6             2147     resar2: mov     a,@r0
0BB1 FA             2148                     mov     r2,a
0BB2 08             2149                     inc     r0
0BB3 E6             2150                     mov     a,@r0
0BB4 FB             2151                     mov     r3,a
0BB5 08             2152                     inc     r0
0BB6 E6             2153                     mov     a,@r0
0BB7 FC             2154                     mov     r4,a
0BB8 08             2155                     inc     r0
0BB9 E6             2156                     mov     a,@r0
0BBA FD             2157                     mov     r5,a
0BBB 22             2158                     ret
                    2159     
                    2160     ;25mkc !!!!!!!!!!!!!!!1
0BBC 7B4B           2161     z_9:      mov R3,#4Bh      ;загрузка числа
0BBE DBFE           2162                    djnz R3,$
0BC0 22             2163               ret
                    2164     
                    2165     ;запись   передаваемый байт в acc
                    2166     ;передача байта послед кодом старшими разрядами  вперед
0BC1 7A08           2167     write:     mov R2,#8
0BC3 C3             2168                             clr  c  
0BC4 C297           2169     wr1:            clr             p1.7;P1.2
0BC6 00             2170                         nop 
0BC7 33             2171                             rlc A
0BC8 9296           2172                             mov P1.6,C;P1.1,C
0BCA 120000   F     2173                        call tim2
0BCD D297           2174                        setb P1.7;P1.2
0BCF 120000   F     2175                call tim2
0BD2 DAF0           2176                       djnz R2,wr1
0BD4 C296           2177                       clr P1.6;P1.1
0BD6 22             2178                      ret
                    2179     
                    2180     ;принимаемый байт в acc
                    2181     ;прием байта последовательным кодом старшими разрядами вперед
0BD7 7A08           2182     read:    mov R2,#8
0BD9 C297           2183     re1:     clr P1.7;P1.2
0BDB 120000   F     2184              call tim2        ;5mks
0BDE A294           2185                     mov C,P1.4;P1.0
0BE0 33             2186                     rlc A           
0BE1 D297           2187                     setb P1.7;P1.2
0BE3 120000   F     2188                     call tim2
0BE6 DAF1           2189                     djnz R2,re1
0BE8 22             2190                     ret
                    2191     
                    2192      ;in r0-count   
                    2193     ;r10,r11-значение с котоым сравнивается счетчик
                    2194     ;r2..r5 -значение счетчика
0BE9                2195     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
0BE9 E6             2196                     mov                     a,@r0
0BEA FC             2197                     mov                     r4,a
0BEB 08             2198                     inc                     r0
0BEC E6             2199                     mov                     a,@r0
0BED FD             2200                     mov                     r5,a
0BEE 7B00           2201                     mov                     r3,#0
0BF0 7A00           2202                     mov                     r2,#0
0BF2 750800         2203                     mov                     r8,#0;clr                       r8
0BF5 750900         2204                     mov                     r9,#0;clr                       r9
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    35

0BF8 120000   F     2205                     call            lcmp
0BFB 22             2206                     ret
                    2207     
                    2208     
                    2209     
                    2210     
                    2211     
                    2212     
                    2213                                 
0BFC 020000   F     2214     rout6:          jmp             out6
0BFF 020000   F     2215     rlabelF:        jmp             labelF  
0C02 020000   F     2216     rknrazr:        jmp             knrazr  
0C05 020000   F     2217     rknopt:         jmp             knopt
0C08 020000   F     2218     rizman:         jmp             izman   
0C0B                2219     keyb1:  ;IE6 
0C0B 75E700         2220                                     mov             EIE2,#00H
                    2221                                     
0C0E C0E0           2222                                     push    acc
0C10 C0D0           2223                                     push    psw
0C12 C000           2224                                     push    rr0
0C14 C001           2225                                     push    rr1
0C16 C002           2226                                     push    rr2
0C18 C003           2227                                     push    rr3
0C1A C004           2228                                     push    rr4
0C1C C005           2229                                     push    rr5
0C1E C006           2230                                     push    rr6
0C20 C007           2231                                     push    rr7
                    2232                                     ;clr            bitmig
                    2233                       ;;;;;;;;;;;;;;
0C22 120000   F     2234                                     call    z_01s;0,1s
                    2235                                     ;восстан знакоместо при мигании
                    2236                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0C25 78B2           2237                                     mov             r0,#marker
0C27 7440           2238                                     mov             a,#bufind
0C29 26             2239                                     add             a,@r0                   ;a=bufind+marker
0C2A F9             2240                                     mov             r1,a
0C2B A73C           2241                                     mov             @r1,savba
                    2242                                     ;;;;;;;;;;;
0C2D E5B0           2243                             mov             a,p3
0C2F 20E641         2244                                     jb              acc.6,outviR;выход из режима выч R
0C32 E5B0           2245     gout6:                          mov             a,p3
0C34 44FF           2246                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0C36 F5B0           2247                                     mov             p3,a
0C38 E5B0           2248                                     mov             a,p3
0C3A 30E6BF         2249                                     jnb             acc.6,rout6             ;error
0C3D 3004BF         2250                                     jnb             bitizm,rlabelF
0C40 75B0FE         2251                                     mov             p3,#0feh                ;реж IZM
0C43 E5B0           2252                                     mov             a,p3
0C45 30E6C0         2253                                     jnb             acc.6,rizman
0C48 75B0FD         2254                                     mov             p3,#0fdh
0C4B E5B0           2255                                     mov             a,p3
0C4D 30E6B2         2256                                     jnb             acc.6,rknrazr             ;labelC
0C50 75B0FB         2257                                     mov             p3,#0fbh
0C53 E5B0           2258                                     mov             a,p3
0C55 30E641         2259                                     jnb             acc.6,knright           ;->
0C58 75B0F7         2260                                     mov             p3,#0f7h
0C5B E5B0           2261                                     mov             a,p3
0C5D 30E6A5         2262                                     jnb             acc.6,rknopt                    ;T
0C60 75B0EF         2263                                     mov             p3,#0efh
0C63 E5B0           2264                                mov          a,p3
0C65 30E615         2265                                     jnb             acc.6,pyskst                    ;pysk/stop
0C68 75B0DF         2266                                     mov             p3,#0dfh
0C6B E5B0           2267                                     mov             a,p3
0C6D 30E645         2268                                jnb          acc.6,knvich
0C70 020000   F     2269                                     jmp             izmpaT
                    2270     
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    36

0C73 3006BC         2271     outviR: jnb             bitvi11,gout6   
0C76 C214           2272                                     clr             bitvich                         ;выход из р
                             ежима выч R  
0C78 C206           2273                                     clr             bitvi11
0C7A 020000   F     2274                                     jmp             out6
                    2275     
0C7D 200A05         2276     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0C80 D20A           2277                                     setb    bitbon  ;уст реж буфер вкл
0C82 020000   F     2278                                     jmp             izmpaT
0C85 C20A           2279     bufon:                  clr             bitbon  ;уст реж буфер выкл
0C87 807E           2280                                     jmp             izmpaT
                    2281     
0C89 79B0           2282     tizmri:                 mov             r1,#level
0C8B B70102         2283                                     cjne    @r1,#1,right2
                    2284                                     ;10s->HET
0C8E 8004           2285                                     jmp             right3
                    2286     
0C90 07             2287     right2:                 inc             @r1
0C91 120000   F     2288                                     call    lolevT
                    2289                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0C94 120000   F     2290     right3:                 call    ind
0C97 806A           2291                                     jmp             izmfun
                    2292     
                    2293                             
                    2294                             
0C99                2295     knright:        
                    2296     
0C99 79AE           2297                                     mov             r1,#diap
                    2298                             ;перекл диапазон 1 поз вверх сбр массив
0C9B 17             2299                                     dec             @r1
0C9C B7FF04         2300                                     cjne    @r1,#0ffh,diinc
0C9F 7700           2301                                     mov             @r1,#0
0CA1 8060           2302                                     jmp  izmfun
0CA3 120000   F     2303     diinc:                  call     clmassix
0CA6 78B3           2304                                     mov             r0,#summa
0CA8 120000   F     2305                                     call    clear4
0CAB 786A           2306                                     mov             r0,#rez_A0
0CAD 120000   F     2307                                     call    clear4  
0CB0 120000   F     2308                                     call    loadUS
0CB3 804E           2309                                      jmp  izmfun
                    2310     
0CB5 200610         2311     knvich:            jb           bitvi11,onvich
0CB8 C204           2312                                     clr             bitizm
0CBA D214           2313                                     setb    bitvich
                    2314                                     
0CBC 78B1           2315                                     mov             r0,#vichR
0CBE 7611           2316                                     mov             @r0,#11h;;????????or 0
                    2317                                     ;ВЫЧИСЛИТЬ
0CC0 900000   F     2318                                     mov     dptr,#teVICH
0CC3 120000   F     2319                                     call    lotext
                    2320                               ; call                ind
0CC6 807A           2321                                     jmp              viout;izmpaT
                    2322     
0CC8 C214           2323     onvich:                 clr             bitvich
0CCA 78B1           2324                                     mov             r0,#vichR
0CCC 7600           2325                                     mov             @r0,#0
0CCE 8037           2326                                     jmp              izmpaT
                    2327     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0CD0 301820         2328     louizm:            jnb          knizm,lou
0CD3 79AE           2329                                     mov             r1,#diap
0CD5 C3             2330                                     clr             c
0CD6 7403           2331                                     mov             a,#3
0CD8 97             2332                                     subb    a,@r1
0CD9 5006           2333                                     jnc             lldi23    ;10-2..10-5
                    2334                                     ;10-6..10-11
0CDB E584           2335                                     mov             a,p4
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    37

0CDD 54F7           2336                                     anl             a,#0f7h   ;d3
0CDF F584           2337                                     mov             p4,a
0CE1 E7             2338     lldi23:                 mov             a,@r1
0CE2 6403           2339                                     xrl             a,#3
0CE4 7002           2340                                     jnz             lldi3
0CE6 8005           2341                                     jmp             lldi2   ;10-5
0CE8 E7             2342     lldi3:                  mov             a,@r1
0CE9 6402           2343                                     xrl             a,#2            ;
0CEB 7006           2344                                     jnz             lou             
0CED E585           2345     lldi2:                  mov             a,p5            ;10-4
0CEF 4408           2346                                     orl             a,#08
0CF1 F585           2347                                     mov             p5,a
0CF3 22             2348     lou:                    ret
                    2349                               ;;;;;;
0CF4 201807         2350     izman:                  jb              knizm,knizmon
0CF7 D218           2351                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2352                             ;       d3(k5 p4),d3(u5 p5)заслать us
0CF9 120000   F     2353                                     call    louizm 
0CFC 8005           2354                                     jmp             izmfun
0CFE C218           2355     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0D00 120000   F     2356                                     call    loadUS;восстановить us
0D03                2357     izmfun:                 
0D03 D208           2358                                     setb    bitbuf
0D05 800E           2359                                     jmp             labelE;;;;;;;;;;;;
                    2360                                     ;;;;;;;;;;;;;;
0D07                2361     izmpaT:
                    2362     ;;;;;;;;;;;;;;;;;
0D07 C3             2363                             clr             c
0D08 79AF           2364                             mov             r1,#parN
                    2365     
0D0A 78AE           2366                             mov             r0,#diap
0D0C 7406           2367                             mov             a,#6            
0D0E 96             2368                             subb    a,@r0
0D0F 5004           2369                             jnc             labelE          ;         ;10-2..10-8
                    2370                               
0D11 7702           2371                             mov             @r1,#2          ;10-9..10-11            
0D13 8000           2372                             jmp             labelE
                    2373     
                    2374     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0D15 789A           2375     labelE:                 mov             r0,#parT
0D17 793D           2376                                     mov             r1,#chkl
0D19 B60108         2377                                     cjne    @r0,#1,izmt2
0D1C 7700           2378                                     mov             @r1,#0
0D1E 09             2379                                     inc             r1
0D1F 7702           2380                                     mov             @r1,#2
0D21 020000   F     2381                                     jmp             out6
0D24 B60208         2382     izmt2:                  cjne    @r0,#2,izmt3
0D27 7700           2383                                     mov             @r1,#0
0D29 09             2384                                     inc             r1
0D2A 7714           2385                                     mov             @r1,#20
0D2C 020000   F     2386                                     jmp             out6
                    2387     
0D2F 7700           2388     izmt3:                  mov             @r1,#0
0D31 09             2389                                     inc             r1
0D32 77C8           2390                                     mov             @r1,#200
0D34 020000   F     2391                                     jmp             out6
                    2392     
                    2393     
                    2394     
                    2395     
0D37                2396     knopt: ;кнопка T
0D37 C204           2397                                clr          bitizm
0D39 D210           2398                                setb         bitt2
0D3B 79B7           2399                                mov          r1,#load
0D3D 7704           2400                                mov          @r1,#4;1s
0D3F 120000   F     2401                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    38

                    2402                                
                    2403     
0D42 793D           2404     viout:          mov             r1,#chkl
0D44 7703           2405                             mov             @r1,#03
0D46 09             2406                             inc             r1
0D47 77E8           2407                             mov             @r1,#0e8h               ;1000
0D49 020000   F     2408                             jmp             out6
                    2409     
0D4C                2410     knrazr:          
0D4C C3             2411     labelC:          clr            c
0D4D 78AF           2412                             mov             r0,#parN
0D4F 799A           2413                             mov             r1,#parT
0D51 7402           2414                             mov             a,#2
0D53 97             2415                             subb    a,@r1
0D54 40BF           2416                             jc              labelE          ;T>2
0D56 B60104         2417                             cjne    @r0,#1,noN1c
0D59 7602           2418                             mov             @r0,#2          ;N=2
0D5B 80B8           2419                             jmp             labelE
                    2420     
0D5D B60207         2421     noN1c:          cjne    @r0,#2,not_1
0D60 B70104         2422                             cjne    @r1,#1,not_1
                    2423                     ;       clr             c
                    2424                     ;       push    rr0
                    2425                     ;       mov             r0,#diap
                    2426                     ;       mov             a,#6            ;10-2..10-8
                    2427                     ;       subb    a,@r0
                    2428                     ;       jc              not_10
                    2429                     ;       pop             rr0         
0D63 7603           2430                             mov             @r0,#3          ;N=3      ;10-2..10-8
0D65 80AE           2431                             jmp             labelE
0D67                2432     not_10:         ;pop            rr0
0D67 7601           2433     not_1:          mov             @r0,#1                          ;N=1
0D69 80AA           2434                             jmp     labelE
                    2435     
0D6B 020000   F     2436     rtizmri:        jmp             tizmri
0D6E                2437     labelf:                 
0D6E 301024         2438                             jnb             bitt2,nofizm
0D71 75B0FB         2439                        mov          p3,#0fbh
0D74 E5B0           2440                        mov          a,p3
0D76 20E60F         2441                        jb           acc.6,outF
0D79 79B7           2442                        mov          r1,#load;parT
0D7B B70503         2443                        cjne         @r1,#5,noft1
                    2444                        ;t=10s
0D7E 020000   F     2445                        jmp          out6;ft1izm
                    2446     
0D81 07             2447     noft1:     inc          @r1;dec         @r1
0D82 120000   F     2448     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2449                             ;call   ind
0D85 020000   F     2450                     jmp             out6;??????????????/
                    2451     
                    2452                             ;увеличить счетчик задержки клавиатуры
0D88 783D           2453     outF:           mov             r0,#chkl
0D8A 7627           2454                             mov             @r0,#27h
0D8C 08             2455                             inc             r0
0D8D 7610           2456                             mov             @r0,#10h
0D8F 020000   F     2457                             jmp             out6;out7
                    2458     
0D92 020000   F     2459     noviR1:         jmp             noviR
0D95 3014FA         2460     nofizm:         jnb             bitvich,noviR1
0D98 78B1           2461                             mov             r0,#vichR
0D9A B6111A         2462                             cjne    @r0,#11h,no11v6
0D9D 7612           2463                             mov             @r0,#12h                ;11= вычислить
0D9F 900000   F     2464     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0DA2 120000   F     2465                             call    lotext
0DA5 80E1           2466                             jmp             outF
                    2467             
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    39

0DA7 020000   F     2468     rnor11:         jmp             nor11   
                    2469             
0DAA B611FA         2470     nor13:          cjne    @r0,#11h,rnor11
0DAD 7612           2471                             mov             @r0,#12h
0DAF 900000   F     2472                             mov             dptr,#teIZMK    ;       изм конст
0DB2 120000   F     2473                         call        lotext             
0DB5 80D1           2474                             jmp             outF
                    2475     
0DB7 B6120A         2476     no11v6:         cjne    @r0,#12h,no12v6
0DBA 7613           2477                             mov             @r0,#13h
0DBC 900000   F     2478                             mov             dptr,#teOUT
0DBF 120000   F     2479                             call    lotext
0DC2 80C4           2480                             jmp             outF
                    2481                     
0DC4 B6130A         2482     no12v6:         cjne    @r0,#13h,no13v6
0DC7 7611           2483                             mov             @r0,#11h
0DC9 900000   F     2484                             mov             dptr,#teVICH
0DCC 120000   F     2485                             call    lotext
0DCF 80B7           2486                             jmp             outF
                    2487     
                    2488     ;кн -> A= 0000
                    2489     ;кн -> B= +00000
0DD1 75B0FB         2490     no13v6:         mov             p3,#0fbh
0DD4 E5B0           2491                             mov             a,p3
0DD6 20E634         2492                             jb              acc.6,chanZ
0DD9 E53B           2493                             mov             a,movrig
0DDB B40713         2494                             cjne    a,#7,kon_B      
0DDE 78B2           2495                             mov             r0,#marker      ;A= 0000
0DE0 B60715         2496                             cjne    @r0,#7,mark0_8          ;курсор справа ?
0DE3 E53A           2497     rikn:           mov             a,movleft
0DE5 F6             2498                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2499     ;                               29.12.06
                    2500     ;;;;;;;;;;;;;;;;;;
                    2501     ;необходимо не портить цифру в следуюем справа знакоместе
                    2502     ;т е сохранить ее в ячейке для мигания в противном случае
                    2503     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2504     ;       знакоместа
0DE6 78B2           2505                                     mov             r0,#marker
0DE8 7440           2506                                     mov             a,#bufind
0DEA 26             2507                                             add             a,@r0                   ;a=bufind+m
                             arker
0DEB F9             2508                                             mov             r1,a
0DEC 09             2509                                             inc             r1
0DED 873C           2510                                             mov             savba,@r1
0DEF 8097           2511                                     jmp             outF
                    2512     
0DF1 78B2           2513     kon_B:          mov             r0,#marker      ;B= +00000
0DF3 B60802         2514                                             cjne    @r0,#8,mark0_8          ;курсор справа ?
0DF6 80EB           2515                                             jmp             rikn
0DF8                2516     mark0_8:
                    2517     ;                               29.12.06
                    2518     ;;;;;;;;;;;;;;;;;;
                    2519     ;необходимо не портить цифру в следуюем справа знакоместе
                    2520     ;т е сохранить ее в ячейке для мигания в противном случае
                    2521     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2522     ;       знакоместа ->B=+00000
0DF8 78B2           2523                                             mov             r0,#marker
0DFA 7440           2524                                     mov             a,#bufind
0DFC 26             2525                                             add             a,@r0                   ;a=bufind+m
                             arker
0DFD F9             2526                                             mov             r1,a
0DFE 09             2527                                             inc             r1
0DFF 873C           2528                                             mov             savba,@r1
0E01 78B2           2529                             mov             r0,#marker
0E03 06             2530                             inc             @r0             ;       сдвинуть курсор вправо на 1
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    40

0E04 C219           2531                             clr             bitmig
0E06 B60901         2532                             cjne    @r0,#9,outma
0E09 18             2533                             dec             r0;ppp
0E0A 020000   F     2534     outma:          jmp             outF
                    2535     
0E0D 75B0FE         2536     chanZ:          mov             p3,#0feh
0E10 E5B0           2537                             mov             a,p3
0E12 20E611         2538                             jb              acc.6,chanma
                    2539                             ;изм знак в старшем разряде на противоположн
0E15 E543           2540                             mov             a,bufind+3
0E17 B42B06         2541                             cjne            a,#2bh,noplus
0E1A 75432D         2542                             mov                     bufind+3,#2dh           ;+->-   
0E1D 020000   F     2543                             jmp             outF
0E20                2544     noplus:
0E20 75432B         2545                             mov                     bufind+3,#2bh           ;-/+-
0E23 020000   F     2546                             jmp             outF
0E26 75B0FD         2547     chanma:         mov             p3,#0fdh
0E29 E5B0           2548                             mov             a,p3
0E2B 20E603         2549                             jb              acc.6,outFl;labelL1
                    2550                             ;clr            bitmig
0E2E 120000   F     2551     labelL1:        call    vvchif  ;увеличить цифру 
                    2552     
0E31 020000   F     2553     outFl:                  jmp             outF
                    2554                     
0E34                2555     nor11:          ;       выход
0E34 7613           2556                     mov             @r0,#13h  ;12->13
0E36 900000   F     2557                     mov             dptr,#teOUT
                    2558     ;               jmp             vi1113
                    2559     
                    2560     
                    2561     
0E39 C206           2562     yesviR:         clr             bitvi11;????????/
0E3B 200C77         2563                             jb              bmem11,labelL
0E3E 020000   F     2564                             jmp             out6;???????//
0E41 30112A         2565     noviR:          jnb             bitmenu,nbimenu
0E44 75B0FB         2566                             mov             p3,#0fbh; реж кн меню ->
0E47 20B610         2567                             jb              p3.6,rnorim6
0E4A 79B0           2568                             mov             r1,#level
0E4C B7000E         2569                             cjne    @r1,#0,rimen6
0E4F 900000   F     2570                             mov             dptr,#teKALIB
0E52 120000   F     2571                             call    lotext
0E55 7701           2572                             mov             @r1,#1
0E57 020000   F     2573                             jmp             out6
                    2574     
0E5A 020000   F     2575     rnorim6:                jmp             norim6
                    2576     
0E5D 900000   F     2577     rimen6:         mov             dptr,#teTEsT
0E60 120000   F     2578                             call    lotext
0E63 7700           2579                             mov             @r1,#0
0E65 020000   F     2580                             jmp             out6
                    2581     
0E68 020000   F     2582     moutF:          jmp             outF
                    2583     
0E6B 020000   F     2584     rnnmemb:        jmp             nnmemb
0E6E 300BFA         2585     nbimenu:        jnb             bitmem,rnnmemb
0E71 79B0           2586                             mov             r1,#level
0E73 B71113         2587                        cjne         @r1,#11h,nomem11
                    2588                        
0E76 75B0FB         2589                        mov          p3,#0fbh
0E79 E5B0           2590                        mov          a,p3
0E7B 20E6EA         2591                        jb           acc.6,moutF
0E7E 7712           2592                        mov          @r1,#12h
0E80 900000   F     2593                        mov          dptr,#teWR
0E83 120000   F     2594                        call         lotext
0E86 020000   F     2595                        jmp          outF
                    2596     
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    41

0E89 B71213         2597     nomem11:   cjne         @r1,#12h,nomem12
0E8C 75B0FB         2598                             mov             p3,#0fbh
0E8F E5B0           2599                        mov          a,p3
0E91 20E6D4         2600                        jb           acc.6,moutF
0E94 7713           2601                        mov          @r1,#13h
0E96 900000   F     2602                        mov          dptr,#teLIST
0E99 120000   F     2603                        call         lotext
0E9C 020000   F     2604                        jmp          outF
0E9F B71313         2605     nomem12:         cjne           @r1,#13h,labelL
0EA2 75B0FB         2606                             mov             p3,#0fbh
0EA5 E5B0           2607                        mov          a,p3
0EA7 20E6BE         2608                        jb           acc.6,moutF
0EAA 7711           2609                        mov          @r1,#11h
0EAC 900000   F     2610                        mov          dptr,#teCLE
0EAF 120000   F     2611                        call         lotext
0EB2 020000   F     2612                          jmp                outF
                    2613     
0EB5 78B0           2614     labelL:         mov             r0,#level
0EB7 B6211B         2615                             cjne    @r0,#21h,labl21
0EBA 75B0FB         2616                             mov             p3,#0fbh
0EBD E5B0           2617                             mov             a,p3
0EBF 20E610         2618                             jb              acc.6,loutF
0EC2 B62108         2619                             cjne    @r0,#21h,lal22
0EC5 7622           2620                             mov             @r0,#22h
                    2621                             ;БЛОК
0EC7 120000   F     2622                             call    lotext
0ECA 020000   F     2623                             jmp             outF
0ECD 7621           2624     lal22:          mov             @r0,#21h
                    2625                             ;ПОЛНАЯ
0ECF 120000   F     2626                             call    lotext
0ED2 020000   F     2627     loutf:          jmp             outF
                    2628     
0ED5 B6211B         2629     labl21:    cjne @r0,#21h,nolev1
0ED8 75B0FB         2630                             mov             p3,#0fbh
0EDB E5B0           2631                             mov             a,p3
0EDD 20E6F2         2632                             jb              acc.6,loutF
0EE0 B62108         2633                             cjne    @r0,#21h,labl22
0EE3 7622           2634                             mov             @r0,#22h
                    2635                             ;БЛОК
0EE5 120000   F     2636                             call    lotext
0EE8 020000   F     2637                             jmp             outF
0EEB 7621           2638     labl22:         mov             @r0,#21h
                    2639                             ;ПОЛНАЯ
0EED 120000   F     2640                             call    lotext
0EF0 020000   F     2641                             jmp             outF
                    2642                      
0EF3 B62323         2643     nolev1:         cjne    @r0,#23h,go31l
0EF6 75B0FB         2644     rigblo:         mov             p3,#0fbh
0EF9 20B627         2645                             jb              p3.6,llev2
0EFC                2646     labL2:    ;  уст курсор в правую позицию 
                    2647                                     ;                               29.12.06
                    2648     ;;;;;;;;;;;;;;;;;;
                    2649     ;необходимо не портить цифру в следуюем справа знакоместе
                    2650     ;т е сохранить ее в ячейке для мигания в противном случае
                    2651     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2652     ;       знакоместа
0EFC 78B2           2653                                             mov             r0,#marker
0EFE 7440           2654                                     mov             a,#bufind
0F00 26             2655                                             add             a,@r0                   ;a=bufind+m
                             arker
0F01 F9             2656                                             mov             r1,a
0F02 09             2657                                             inc             r1
0F03 873C           2658                                             mov             savba,@r1
                    2659     ;;;;;;;;;;;;;;;;
0F05 78B2           2660                       mov           r0,#marker      ;курсор справа  ?
0F07 E53B           2661                             mov             a,movrig
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    42

0F09 C3             2662                             clr             c
0F0A 96             2663                             subb    a,@r0
0F0B 6006           2664                             jz         equ1l
0F0D E53B           2665                             mov             a,movrig;уст в правую позицию
0F0F F6             2666                             mov             @r0,a
0F10 020000   F     2667                             jmp             outF;goto7                                         
                                   
0F13 E53A           2668     equ1l:          mov             a,movleft;уст в левую позицию
0F15 F6             2669                             mov             @r0,a   
0F16 020000   F     2670                             jmp             outF;goto7
                    2671                     
                    2672     
0F19 B63102         2673     go31l:          cjne    @r0,#31h,go41l
0F1C 80D8           2674                             jmp             rigblo
0F1E B6410B         2675     go41l:          cjne    @r0,#41h,norig2
0F21 80D3           2676                             jmp             rigblo
                    2677     
0F23 75B0FD         2678     llev2:          mov             p3,#0fdh
0F26 20B6A9         2679                             jb              p3.6,loutF
0F29 020000   F     2680                             jmp             labelL1
                    2681     
                    2682     ;->
0F2C C3             2683     norig2:    clr          c               ;32,33,34,42
0F2D 7431           2684                             mov             a,#31h
0F2F 96             2685                             subb    a,@r0
0F30 50A0           2686                             jnc             loutF
0F32 75B0FB         2687     rigblok:        mov             p3,#0fbh  ;32,33,34,42
0F35 20B626         2688                             jb              p3.6,lev2go
0F38                2689     labelN: 
                    2690                             ;                               29.12.06
                    2691     ;;;;;;;;;;;;;;;;;;
                    2692     ;необходимо не портить цифру в следуюем справа знакоместе
                    2693     ;т е сохранить ее в ячейке для мигания в противном случае
                    2694     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2695     ;       знакоместа
0F38 78B2           2696                                             mov             r0,#marker
0F3A 7440           2697                                     mov             a,#bufind
0F3C 26             2698                                             add             a,@r0                   ;a=bufind+m
                             arker
0F3D F9             2699                                             mov             r1,a
0F3E 09             2700                                             inc             r1
0F3F 873C           2701                                             mov             savba,@r1
                    2702     ;;;;;;;;;;;;;;;;;;;
0F41 78B2           2703                             mov             r0,#marker      ;курсор справа  ?
0F43 E53B           2704                             mov             a,movrig
0F45 C3             2705                             clr             c
0F46 96             2706                             subb    a,@r0
0F47 7006           2707                             jnz        noequ1
0F49 E53A           2708                             mov             a,movleft;уст в крайнюю левую позицию
0F4B F6             2709                             mov             @r0,a
0F4C 020000   F     2710                             jmp             outF
0F4F                2711     noequ1: ;29.12.06
                    2712     ;;;;;;;;;;;;;;;;;;
                    2713                             ;восстан знакоместо при мигании
                    2714                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0F4F 78B2           2715                                     mov             r0,#marker
0F51 7440           2716                                     mov             a,#bufind
0F53 26             2717                                     add             a,@r0                   ;a=bufind+marker
0F54 F9             2718                                     mov             r1,a
                    2719                                     ;mov            @r1,savba
0F55 09             2720                                     inc             r1
0F56 873C           2721                                     mov             savba,@r1
                    2722     ;;;;;;;;;;;;;;;;        
0F58 120000   F     2723                             call    marri;уст сдвиг в правую        позицию
0F5B 020000   F     2724                             jmp             outF
0F5E 75B0FD         2725     lev2go:         mov             p3,#0fdh
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    43

0F61 30B603         2726                             jnb             p3.6,rlabelL1
0F64 020000   F     2727                             jmp             outF
                    2728     
0F67 020000   F     2729     rlabelL1:       jmp             labelL1
0F6A                2730     nnmemb:
0F6A                2731     norim6:    ;kn menu
0F6A                2732     out6:           
0F6A D007           2733                                     pop             rr7     
0F6C D006           2734                                     pop             rr6
0F6E D005           2735                                     pop             rr5
0F70 D004           2736                                     pop             rr4
0F72 D003           2737                                     pop             rr3
0F74 D002           2738                                     pop             rr2
0F76 D001           2739                                     pop             rr1                             
0F78 D000           2740                                     pop             rr0
0F7A D0D0           2741                                     pop             psw
0F7C D0E0           2742                                     pop             acc
                    2743     ;clr            bitmig
0F7E 75E730         2744                                mov          EIE2,#30H
0F81 E5AD           2745                                mov          a,P3IF
0F83 54BF           2746                                     anl             a,#0bfh
0F85 F5AD           2747                                     mov             P3IF,a
0F87 75B0C0         2748                                     mov             P3,#0c0h
0F8A C219           2749     clr             bitmig
0F8C 32             2750                             reti
                    2751     
0F8D 020000   F     2752     rknMEM:                 jmp             knMEM
0F90 020000   F     2753     knKMP:             jmp          out7
0F93 020000   F     2754     rout7:                  jmp             out7    
0F96 020000   F     2755     rlabelH:                jmp             labelH
0F99 020000   F     2756     rknNUL:         jmp             knNUL
0F9C 020000   F     2757     rknleft:                jmp             knleft
0F9F                2758     keyb2:  ;IE7
0F9F 75E700         2759                                     mov             EIE2,#00H
0FA2 C0E0           2760                                     push    acc
0FA4 C0D0           2761                                     push    psw
0FA6 C000           2762                                     push    rr0
0FA8 C001           2763                                     push    rr1
0FAA C002           2764                                     push    rr2
0FAC C003           2765                                     push    rr3
0FAE C004           2766                                     push    rr4
0FB0 C005           2767                                     push    rr5
0FB2 C006           2768                                     push    rr6
0FB4 C007           2769                                     push    rr7
0FB6 C082           2770                                     push    dpl
0FB8 C083           2771                                     push    dph
                    2772                                     ;clr            bitmig
                    2773                       ;;;;;;;;;;;;;;
0FBA 120000   F     2774                               call  z_01s   ;0,1s
                    2775                               ;восстан знакоместо при мигании
                    2776                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0FBD 78B2           2777                                     mov             r0,#marker
0FBF 7440           2778                                     mov             a,#bufind
0FC1 26             2779                                     add             a,@r0                   ;a=bufind+marker
0FC2 F9             2780                                     mov             r1,a
0FC3 A73C           2781                                     mov             @r1,savba
                    2782                                     ;;;;;;;;;;;
                    2783     
0FC5 E5B0           2784                             mov             a,p3
0FC7 20E7C9         2785                                     jb              acc.7,rout7
0FCA E5B0           2786                                     mov             a,p3
0FCC 74FF           2787                                     mov             a,#0ffh         ; p3.(5-0)<-3f
0FCE F5B0           2788                                     mov             p3,a
0FD0 E5B0           2789                                     mov             a,p3
0FD2 30E7BE         2790                                     jnb             acc.7,rout7             ;error
0FD5 3004BE         2791                                     jnb             bitizm,rlabelH
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    44

0FD8 75B0FE         2792                                     mov             p3,#0feh                ;реж IZM
0FDB E5B0           2793                                     mov             a,p3
0FDD 30E7B9         2794                                     jnb             acc.7,rknNUL
0FE0 75B0FD         2795                                     mov             p3,#0fdh
0FE3 E5B0           2796                                     mov             a,p3
0FE5 30E7A8         2797                                     jnb             acc.7,knKMP
0FE8 75B0FB         2798                                     mov             p3,#0fbh
0FEB E5B0           2799                                     mov             a,p3
0FED 30E7AC         2800                                     jnb             acc.7,rknleft
0FF0 75B0F7         2801                                     mov             p3,#0f7h
0FF3 E5B0           2802                                     mov             a,p3
0FF5 30E74E         2803                                     jnb             acc.7,knAVP
0FF8 75B0EF         2804                                 mov         p3,#0efh
0FFB E5B0           2805                                     mov             a,p3
0FFD 30E78D         2806                                     jnb             acc.7,rknMEM
1000 75B0DF         2807                                     mov             p3,#0dfh
1003 E5B0           2808                                     mov             a,p3    
1005 30E72E         2809                                     jnb             acc.7,knmenu
1008                2810     an_t7:             ;;;;;;;;;;;;
                    2811                     
1008 C3             2812                             clr             c
1009 79AF           2813                             mov             r1,#parN
                    2814     
100B 78AE           2815                             mov             r0,#diap
100D 7406           2816                             mov             a,#6            
100F 96             2817                             subb    a,@r0
1010 5002           2818                             jnc             goto7           ;         ;10-2..10-8
                    2819                               
1012 7702           2820                             mov             @r1,#2          ;10-9..10-11            
                    2821                             
                    2822                             ;;;;;;;;;;;;
1014 799A           2823     goto7:                  mov             r1,#parT
1016 783D           2824                                     mov             r0,#chkl
1018 B70108         2825                                     cjne    @r1,#1,not1_7
101B 7600           2826                                     mov             @r0,#00
101D 08             2827                                     inc             r0
101E 7602           2828                                     mov             @r0,#2
1020 020000   F     2829                                     jmp             out7
                    2830                             
                    2831     
1023 B70208         2832     not1_7:                 cjne    @r1,#2,not2_7
1026 760E           2833                                     mov             @r0,#0eh;00
1028 08             2834                                     inc             r0
1029 7638           2835                                     mov             @r0,#38h;20
102B 020000   F     2836                                     jmp             out7
102E 7600           2837     not2_7:                 mov             @r0,#00
1030 08             2838                                     inc             r0
1031 76C8           2839                                     mov             @r0,#200
1033 020000   F     2840                                     jmp             out7
                    2841     
                    2842     
1036 C204           2843     knmenu:                  clr            bitizm          ;off IZM
1038 D211           2844                                     setb            bitmenu
103A 900000   F     2845                                     mov             dptr,#teMENU    ;в буф2 записать ТЕСТ-ИЗМЕР
103D 120000   F     2846                                     call    lotext
1040 120000   F     2847                                     call    ind;???????/
1043 020000   F     2848                                     jmp             onmem11
                    2849     
1046 200505         2850     knAVP:                  jb              bitavp,meavp
1049 D205           2851                                     setb    bitavp
104B 020000   F     2852                                     jmp             onmem11
104E C205           2853     meavp:                  clr             bitavp
1050 020000   F     2854                                     jmp             onmem11
                    2855     
1053 79AE           2856     knleft:            mov          r1,#diap
1055 07             2857                                     inc             @r1             ;перекл диапазон 1 поз в сб
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    45

                             р массив
1056 B70A03         2858                                     cjne    @r1,#0ah,nodi6
1059 17             2859                                     dec             @r1
105A 80AC           2860                                     jmp             an_t7
                    2861     
105C                2862     nodi6:             ;    cjne    @r1,#0,an_t7
105C 120000   F     2863                                      call    clmassix
105F 78B3           2864                                     mov             r0,#summa
1061 120000   F     2865                                     call    clear4  
1064 786A           2866                                     mov             r0,#rez_A0
1066 120000   F     2867                                     call    clear4  
1069 120000   F     2868                                     call    loadUS
106C 809A           2869                                jmp          an_t7
                    2870     
106E 200F0E         2871     knNUL:                  jb              bitnul,ybnul
1071 D20F           2872                                     setb    bitnul
1073 789C           2873                                     mov             r0,#rez_A3      ;A3
1075 120000   F     2874                                     call    resar2
1078 786A           2875                                     mov             r0,#rez_A0      
107A 120000   F     2876                                     call    saver2;A0<-A3
107D 8095           2877                                     jmp             goto7;an_t7
                    2878     
107F C20F           2879     ybnul:                  clr             bitnul
1081 900000   F     2880                                      mov    DPTR,#ch0 
1084 120000   F     2881                                     CALL   ldc_long          ; r2..r5 <-- 0
1087 786A           2882                                     mov             r0,#rez_A0      ;A0=0
1089 120000   F     2883                                     call    saver2
108C 8086           2884                                     jmp             goto7;an_t7
                    2885     
108E 30101E         2886     labelH:                 jnb             bitt2,nolah
1091 75B0FB         2887                                     mov             p3,#0fbh   ;вход в режим изм Т
1094 79B7           2888                                     mov             r1,#load;parT
1096 20B70D         2889                                     jb              p3.7,rhnot1
1099 B70003         2890                                     cjne    @r1,#0,inct;
109C 020000   F     2891                                     jmp             out7;hyest6
109F 17             2892     inct:                   dec             @r1                     ;Tизм+1
                    2893                             
10A0 120000   F     2894                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
10A3                2895     hnot2:          ;       call    ind
10A3 020000   F     2896                                     jmp             out7
                    2897     
10A6 020000   F     2898      rhnot1:                jmp             hnot1
                    2899      ;rnoviR:       jmp             noviR
10A9 020000   F     2900      rlabelK:       jmp             labelK
10AC 020000   F     2901      rlabelI:       jmp             labelI          
                    2902      ;;;;;;;;;;;;;;;;;;;
10AF 3014F7         2903     nolah:          jnb             bitvich,rlabelK 
                    2904                             ;;;;;;
                    2905                             ;увеличить счетчик задержки клавиатуры
                    2906                     ;;              mov             r0,#chkl
                    2907                     ;;              mov             @r0,#27h
                    2908                     ;;              inc             r0
                    2909                     ;;              mov             @r0,#10h
                    2910                             ;;;;;;
                    2911     
10B2 78B1           2912                             mov             r0,#vichR
10B4 B61128         2913                             cjne    @r0,#11h,rhnor11;rlabelI;;
10B7 75B0FB         2914                             mov             p3,#0fbh   ;<-
10BA 20B728         2915                             jb              p3.7,noh37;routF
10BD B6110B         2916                     cjne    @r0,#11h,hr12
10C0 7613           2917                             mov             @r0,#13h        ;11= вычислить
10C2 900000   F     2918                             mov             dptr,#teOUT;teVICH
10C5 120000   F     2919     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
10C8 020000   F     2920                             jmp             goto7;outF
10CB B61207         2921     hr12:           cjne    @r0,#12h,hnor12
10CE 7611           2922     lovich:         mov             @r0,#11h
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    46

10D0 900000   F     2923                             mov             dptr,#teVICH
10D3 80F0           2924                             jmp             hvi1113         
10D5 B61307         2925     hnor12:         cjne    @r0,#13h,rhnor11
10D8 7612           2926     loizmk:         mov             @r0,#12h
10DA 900000   F     2927                             mov             dptr,#teIZMK    ;       изм конст
                    2928                                        
10DD 80E6           2929                             jmp             hvi1113
                    2930     
10DF 803E           2931     rhnor11:                jmp             hnor11
                    2932     
10E1 8049           2933     rvvizko:                jmp             vvizko
10E3 80FE           2934     toutF:                  jmp     toutF
                    2935     
10E5 75B0F7         2936     noh37:          mov             p3,#0f7h
10E8 20B7F8         2937                             jb              p3.7,toutF
10EB B611F3         2938                             cjne    @r0,#11h,rvvizko
10EE D206           2939                             setb    bitvi11    ;нажат ввод ВЫЧИСЛИТЬ
10F0 D204           2940              setb   bitizm
10F2 020000   F     2941     routF:          jmp             goto7;outF
                    2942     
                    2943     
                    2944     
10F5 80EE           2945     rnoh37:         jmp             noh37
                    2946     
10F7 B6120D         2947     norr11:         cjne    @r0,#12h,norr12
10FA 75B0FB         2948                             mov             p3,#0fbh   ;<-
10FD 20B7F5         2949                             jb              p3.7,rnoh37;routF
1100 760B           2950                             mov             @r0,#11;12->11
1102 80CA           2951                             jmp             lovich
                    2952     
1104 020000   F     2953     labelI2:                jmp             labelI
1107 B613FA         2954     norr12:         cjne    @r0,#13h,labelI2
110A 75B0FB         2955                             mov             p3,#0fbh   ;<-
110D 20B7E5         2956                             jb              p3.7,rnoh37
1110 7612           2957                             mov             @r0,#12h
1112 80C4           2958                             jmp             loizmk
                    2959                             ;;;;
1114 C214           2960     clrvich:                clr             bitvich
1116 D204           2961                             setb    bitizm
1118 A8B2           2962                             mov             r0,marker
111A 76FF           2963                             mov             @r0,#0ffh
111C 020000   F     2964                              jmp    goto7;  routF
                    2965     
                    2966     ;rnoh37:                jmp             noh37
                    2967      ;ввод изм конст
111F B612E5         2968     hnor11:         cjne    @r0,#12h,norr12;clrvich
1122 75B0FB         2969                              mov            p3,#0fbh   
1125 20B7CD         2970                             jb              p3.7,rnoh37;lovich;;изм конст <-  выч
1128 7611           2971                             mov             @r0,#11h
112A 80A2           2972                             jmp             lovich
                    2973     
112C 78B1           2974     vvizko:         mov             r0,#vichR
112E E6             2975                             mov             a,@r0
                    2976                     ;       cjne    @r0,#12h,clrvich
112F B412E2         2977                             cjne    a,#12h,clrvich
1132 7621           2978                             mov             @r0,#21h                ;изм конст->a=+0000     (vv
                             od)
1134 78B2           2979                             mov             r0,#marker
1136 7604           2980                             mov             @r0,#4;9
1138 753A04         2981                             mov             movleft,#4
113B 753B07         2982                             mov             movrig,#7
113E 900000   F     2983                             mov             dptr,#teAequ0
1141 120000   F     2984                             call    lotext
                    2985                             
1144 120000   F     2986                             call    outA
                    2987                             
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    47

1147 020000   F     2988                             jmp             goto7;routF
                    2989     ;hnor13:                jmp             hnor12          
114A B6210C         2990     izchi:          cjne    @r0,#21h,tlabelI
                    2991     ;<- при вводе цифр А                            
                    2992                     ;        mov            p3,#0fbh   
                    2993                     ;       jnb             p3.7,li21
                    2994             ;clr            bitmig
114D 78B2           2995                             mov             r0,#marker
114F 16             2996                             dec             @r0
1150 B60201         2997                             cjne    @r0,#2,li21
1153 06             2998                             inc             @r0;marker=3 +/-
1154 C219           2999     li21:           clr             bitmig
1156 020000   F     3000                             jmp             goto7;outF
                    3001     
1159 020000   F     3002     tlabelI:        jmp             labelI
                    3003     
                    3004     ;                       load    0 1 2 3 4 5             
115C 06050403       3005     sootv:          db              6,5,4,3,2,1;parT
1160 0201                    
                    3006     ;
                    3007     
                    3008     ;нажата кн ввод при наборе Т
1162 75B0F7         3009     hnot1:                  mov             p3,#0f7h
1165 20B78A         3010                                     jb              p3.7,routF;out7
1168 B70541         3011                                     cjne    @r1,#5,nohnot1  ;r1=load
116B 794A           3012                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
116D E7             3013                                     mov             a,@r1
116E 4440           3014                                     orl             a,#40h;.6
1170 F7             3015                                     mov             @r1,a
1171 8000           3016                                     jmp             loadb
                    3017                                     
                    3018                                     
1173 789A           3019     loadB:                  mov             r0,#parT
1175 900000   F     3020                                     mov             dptr,#sootv
1178 79B7           3021                                     mov             r1,#load                
117A E7             3022                                     mov             a,@r1;load
117B 93             3023                                     movc    a,@a+dptr
117C F6             3024                                     mov             @r0,a
117D 120000   F     3025                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    3026                                      ;r4=b1 r5=b2
1180 120000   F     3027                                     call    iniacp;инициализация АЦП
1183 120000   F     3028                                     call    loadUS
1186 120000   F     3029                                     call    clmassix        
1189 D204           3030                                     setb    bitizm
118B C210           3031                                     clr             bitt2
118D C3             3032                                      clr            c
118E 789A           3033                                  mov                r0,#parT
1190 79AF           3034                                      mov            r1,#parN
1192 7402           3035                                  mov                a,#2
1194 96             3036                                 subb                a,@r0
1195 5005           3037                                 jnc                 loadB2
1197 7701           3038                                     mov             @r1,#1;N=1         ;T>=2
1199 020000   F     3039     bout7:                  jmp             goto7;out7
                    3040     
119C B702FA         3041     loadB2:                 cjne    @r1,#2,bout7
119F 7702           3042                                     mov             @r1,#2;N=2
11A1 020000   F     3043                                     jmp             goto7;out7
11A4                3044     nohnot2:                ;в буфере 1 зажечь <=0,1s
11A4 794A           3045                                     mov             r1,#bufind+10
11A6 E7             3046                                     mov             a,@r1
11A7 4410           3047                                     orl             a,#10h;.4
11A9 F7             3048                                     mov             @r1,a
11AA 80C7           3049                                     jmp             loadB
11AC B704F5         3050     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
11AF 794A           3051                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    48

11B1 E7             3052                                     mov             a,@r1
11B2 4420           3053                                     orl             a,#20h;.5
11B4 F7             3054                                     mov             @r1,a
11B5 80BC           3055                                     jmp             loadB
                    3056     
                    3057     ;кнопка ПАМЯТЬ
11B7 C204           3058     knMEM:                  clr             bitizm          ;off IZM
11B9 900000   F     3059                                     mov             dptr,#teCLE
11BC 120000   F     3060                                     call    lotext    ;в буф2 записать ОЧИСТКА
11BF D20B           3061                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
11C1 78B0           3062                                     mov             r0,#level
11C3 7611           3063                                     mov             @r0,#11h
11C5 783D           3064     onmem11:                mov             r0,#chkl
11C7 7603           3065                                     mov             @r0,#03
11C9 08             3066                                     inc             r0
11CA 76E8           3067                                     mov             @r0,#0e8h               ;1000
11CC 020000   F     3068                                     jmp             goto7;out7
                    3069     
11CF 020000   F     3070     rnomemk:                jmp             nomemk          ;
11D2                3071     labelK:
                    3072     ;;;;;;;;;;;;
                    3073     ;                               jnb             bitmenu,nomenu
                    3074     ;                               mov             p3,#0fbh
                    3075     ;                               mov             r1,#level
                    3076     ;                               jb              p3.7,vvmenu
                    3077                     
                    3078     
                    3079     ;nomenu:                        mov             p3,#0f7h;0efh;0f7h;vvod
                    3080     ;                               jb              p3.7,novvmn
                    3081     ;vvmenu:;ввод меню  (тест-калибровка)
                    3082     ;                               mov             dptr,#teTEST;тест
                    3083     ;                               call    lotext
                    3084     ;                               mov             @r1,#2
                    3085     ;                               jmp             out7
                    3086     ;novvmn:                        mov             p3,#0efh
                    3087     ;                               jb              p3.7,rimenu
                    3088                             
                    3089     ;                               jmp             out7
                    3090     
                    3091      ;rimenu:
                    3092     ;;;;;;;;;;;;
11D2 300BFA         3093                               jnb           bitmem,rnomemk
11D5 78B0           3094                               mov           r0,#level
11D7 B61132         3095                               cjne          @r0,#11h,klev1;nome11
11DA 75B0FB         3096     lefmem11:         mov           p3,#0fbh
11DD E5B0           3097                               mov           a,p3
11DF 20E70E         3098                               jb            acc.7,rkvvod0
11E2 B6110E         3099                               cjne          @r0,#11h,locle          ;<-memory
11E5 7613           3100                               mov           @r0,#13h
11E7 900000   F     3101     lolist:           mov           dptr,#teLIST
11EA 120000   F     3102                               call          lotext           ;ПРОСМОТР
11ED 020000   F     3103                               jmp   goto7;  outF
                    3104     
11F0 020000   F     3105     rkvvod0:        jmp             kvvod0
                    3106     
                    3107     
11F3 B6120B         3108     locle:          cjne            @r0,#12h,lowr           ;<-memory
11F6 7611           3109                               mov           @r0,#11h                   ;ОЧИСТКА
11F8 900000   F     3110     loadcle:          mov           dptr,#teCLE
11FB 120000   F     3111                               call          lotext
11FE 020000   F     3112                               jmp           goto7;outF
1201 7612           3113      lowr:          mov             @r0,#12h
1203 900000   F     3114      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
1206 120000   F     3115                             call    lotext
1209 020000   F     3116                             jmp             goto7;outF
120C B61202         3117      klev1:          cjne   @r0,#12h,klev2
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    49

120F 80C9           3118                             jmp             lefmem11
1211 B61302         3119     klev2:           cjne   @r0,#13h,klev22   ;11-13 нет
1214 80C4           3120                             jmp             lefmem11
                    3121     
                    3122     ;<- vvod на более низких уровнях
1216 B62114         3123     klev22:         cjne    @r0,#21h,klev21
1219 75B0FB         3124     lev220:         mov             p3,#0fbh
121C 20B72F         3125                             jb              p3.7,kgo23
121F B62146         3126                             cjne    @r0,#21h,kfull
1222 7622           3127                             mov             @r0,#22h
1224 900000   F     3128                             mov             dptr,#teBL
1227 120000   F     3129                             call    lotext
122A 020000   F     3130                             jmp             goto7;outF
                    3131                                     
122D B62208         3132     klev21:         cjne    @r0,#22h,klev23
1230 80E7           3133                             jmp             lev220
                    3134     
1232 020000   F     3135     rlabL2:         jmp             labL2
1235 020000   F     3136     rlabM:          jmp             labM
                    3137     
1238 B623FA         3138     klev23:          cjne   @r0,#23h,rlabM
123B 75B0FB         3139                              mov    p3,#0fbh
123E 20B7F1         3140                              jb             p3.7,rlabL2
1241 75B0F7         3141                              mov    p3,#0f7h
1244 20B74F         3142                              jb             p3.7,ddoutf
                    3143                              ;очистить блок памяти с набранным номером
1247 C20B           3144                              clr    bitmem  ;сбр признак памяти 
1249 D204           3145                              setb   bitizm
124B 020000   F     3146                              jmp    goto7;outF
                    3147                             
124E 75B0F7         3148     kgo23:           mov    p3,#0f7h
1251 20B742         3149                             jb              p3.7,ddoutf
1254 B62107         3150                             cjne    @r0,#21h,go23no
                    3151                             ;очистить память
1257 C20B           3152                             clr             bitmem
1259 D204           3153                             setb    bitizm
125B 020000   F     3154                             jmp             goto7;outF
                    3155     
125E 7623           3156     go23no:    mov          @r0,#23h
1260 753B08         3157                                             mov                     movrig,#8
1263 753A07         3158                                             mov             movleft,#7
1266 8038           3159                             jmp             loblok;БЛОК 00
                    3160     
1268 7621           3161     kfull:          mov             @r0,#21h
126A 8024           3162                             jmp             gofull          
126C                3163     nomemk:
126C 020000   F     3164                                     jmp             goto7;outF
                    3165                                     ;;;;;;;;;;
126F 75B0FB         3166     nome11:           mov           p3,#0fbh
1272 E5B0           3167                               mov           a,p3
1274 20E70C         3168                               jb            acc.7,kvvod0
1277 B61205         3169                               cjne          @r0,#12h,mem12no        
127A 7611           3170                               mov           @r0,#11h                ;ОЧИСТКА
127C 020000   F     3171                               jmp            loadcle
                    3172     
127F                3173     mem12no:        ;cjne           @r0,#13h,lowr           
127F 7612           3174                               mov           @r0,#12h                   ;
1281 8080           3175                               jmp           lowr1                     ;ЗАПИСЬ
                    3176     
1283 75B0F7         3177     kvvod0:           mov           p3,#0f7h
1286 20B70D         3178                               jb            p3.7,ddoutf
1289 78B0           3179                               mov           r0,#level
128B B6110D         3180                               cjne          @r0,#11h,mvv11
128E 7621           3181                               mov           @r0,#21h                ;ПОЛНАЯ
1290 900000   F     3182     gofull:           mov           dptr,#teFULL
1293 120000   F     3183                               call          lotext
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    50

1296 801F           3184     ddoutf:         jmp             mlabL2  ;<-
                    3185     
1298 020000   F     3186     jmp             goto7
                    3187     
129B B61215         3188     mvv11:            cjne          @r0,#12h,mvv12
129E 7631           3189                                     mov             @r0,#31h
12A0 900000   F     3190     loblok:                 mov             dptr,#teBLOK;БЛОК 00
12A3 120000   F     3191                                     call    lotext
12A6 78B2           3192                                     mov             r0,#marker
12A8 7607           3193                                     mov             @r0,#7
12AA 753B08         3194                                     mov             movrig,#8
12AD 753A07         3195                                     mov             movleft,#7
12B0 020000   F     3196                                     jmp             goto7;outF
12B3 7641           3197     mvv12:                  mov             @r0,#41h                ; БЛОК 00
12B5 80E9           3198                                     jmp             loblok
                    3199     
                    3200     
                    3201     
12B7                3202     mlabL2:         ;jmp            labL2
                    3203                                             ;  уст курсор в правую позицию 
                    3204                                     ;                               29.12.06
                    3205     ;;;;;;;;;;;;;;;;;;
                    3206     ;необходимо не портить цифру в следуюем справа знакоместе
                    3207     ;т е сохранить ее в ячейке для мигания в противном случае
                    3208     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3209     ;       знакоместа
12B7 78B2           3210                                             mov             r0,#marker
12B9 7440           3211                                     mov             a,#bufind
12BB 26             3212                                             add             a,@r0                   ;a=bufind+m
                             arker
12BC F9             3213                                             mov             r1,a
12BD 09             3214                                             inc             r1
12BE 873C           3215                                             mov             savba,@r1
                    3216     ;;;;;;;;;;;;;;;;
12C0 78B2           3217                       mov           r0,#marker      ;курсор справа  ?
12C2 E53B           3218                             mov             a,movrig
12C4 C3             3219                             clr             c
12C5 96             3220                             subb    a,@r0
12C6 6006           3221                             jz         equ2l
12C8 E53B           3222                             mov             a,movrig;уст в правую позицию
12CA F6             3223                             mov             @r0,a
                    3224     ;                       lool
12CB 020000   F     3225                             jmp             goto7                                            
12CE E53A           3226     equ2l:          mov             a,movleft;уст в левую позицию
12D0 F6             3227                             mov             @r0,a   
12D1 020000   F     3228                             jmp             goto7
                    3229                     
                    3230     
12D4 B63137         3231     labM:                   cjne    @r0,#31h,nom31
12D7 75B0FB         3232                                     mov             p3,#0fbh
12DA 30B7DA         3233                                     jnb             p3.7,mlabL2
12DD 75B0F7         3234                                mov          p3,#0f7h
12E0 20B7B3         3235                                jb           p3.7,ddoutf
                    3236                                
12E3 7632           3237                                mov          @r0,#32h
                    3238                                     ;       считать с индикатора  
12E5 7F0A           3239                                     mov             r7,#10
12E7 7853           3240                                     mov             r0,#adec
12E9 120000   F     3241                                     call    clearN
12EC 120000   F     3242                                     call    upak2                   
12EF 784F           3243                                     mov             r0,#abin
12F1 7953           3244                                     mov             r1,#adec                        ;мл        
                              ст
12F3 120000   F     3245                                     call    decbin                  ;abin..abin+3 (hex)
                    3246                                     ;call   loadr2                  ;r2..r5
                    3247                                     ;call   altof                   ;r2..r5->int
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    51

12F6 78C4           3248                                mov          r0,#nblok       ;   сохранить
12F8 E54F           3249                                mov          a,abin          ;;мл
12FA F6             3250                                mov          @r0,a
12FB 900000   F     3251                                mov          dptr,#tebBL;НАЧ БЛОК 000
12FE 120000   F     3252                                call         lotext
1301 78B2           3253                                mov          r0,#marker
1303 7607           3254                                mov          @r0,#7
1305 753B09         3255                                mov          movrig,#9
1308 753A07         3256                                mov          movleft,#7
130B 020000   F     3257     rgoto7:            jmp     goto7;outF
                    3258     
130E B6324C         3259     nom31:             cjne         @r0,#32h,nom32
1311 75B0FB         3260                                     mov             p3,#0fbh
1314 20B714         3261                                     jb              p3.7,no31n
                    3262                                     
1317 78B2           3263     lefcur:         mov             r0,#marker      ;курсор слева?
1319 E53A           3264                             mov             a,movleft
131B C3             3265                             clr             c
131C 96             3266                             subb    a,@r0
131D 7006           3267                             jnz        noequ2
131F E53B           3268                             mov             a,movrig
1321 F6             3269                             mov             @r0,a;уст в крайнюю правую позицию
1322 020000   F     3270                             jmp             goto7
1325 120000   F     3271     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
1328 020000   F     3272                             jmp        goto7
                    3273                                     
132B 75B0F7         3274     no31n:             mov          p3,#0f7h
132E 20B7DA         3275                                     jb              p3.7,rgoto7
1331 7633           3276                                     mov             @r0,#33h
                    3277                                     ;запомнить номер ячейки блока
1333 7F0A           3278                                             mov             r7,#10
1335 7853           3279                                     mov             r0,#adec
1337 120000   F     3280                                     call    clearN
133A 120000   F     3281                                     call    upak3                   
133D 784F           3282                                     mov             r0,#abin
133F 7953           3283                                     mov             r1,#adec                        ;мл        
                              ст
1341 120000   F     3284                                     call    decbin                  ;abin..abin+3 (hex)
1344 120000   F     3285                                     call    loadr2                  ;r2..r5
1347 120402         3286                                     call    altof                   ;r2..r5->int
                    3287     
134A 900000   F     3288                                      mov            dptr,#teeBL;КОН БЛОК 000
134D 120000   F     3289                                call         lotext
1350 78B2           3290                                mov          r0,#marker
1352 7607           3291                                mov          @r0,#7
1354 753B09         3292                                mov          movrig,#9
1357 753A07         3293                                mov          movleft,#7
135A 020000   F     3294                                jmp     goto7;
                    3295     
                    3296     
135D B63328         3297     nom32:           cjne           @r0,#33h,nom33
1360 75B0FB         3298                              mov            p3,#0fbh
1363 30B7B1         3299                              jnb            p3.7,lefcur
1366 75B0F7         3300                              mov            p3,#0f7h
1369 20B79F         3301                              jb             p3.7,rgoto7
                    3302                              ;запомнить номер ячейки конца блока
136C 7634           3303                              mov    @r0,#34h
136E 7F0A           3304     INTn:                   mov             r7,#10
1370 7853           3305                                     mov             r0,#adec
1372 120000   F     3306                                     call    clearN
1375 120000   F     3307                                     call    upak3                   
1378 784F           3308                                     mov             r0,#abin
137A 7953           3309                                     mov             r1,#adec                        ;мл        
                              ст
137C 120000   F     3310                                     call    decbin                  ;abin..abin+3 (hex)
137F 120000   F     3311                                     call    loadr2                  ;r2..r5
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    52

1382 120402         3312                                     call    altof                   ;r2..r5->int
1385 020000   F     3313     dgoto7:                  jmp            goto7
                    3314     
1388 B63415         3315     nom33:          cjne            @r0,#34h,labelP
138B 75B0FB         3316                               mov           p3,#0fbh
138E 30B786         3317                              jnb            p3.7,lefcur
1391 75B0F7         3318                              mov            p3,#0f7h
1394 20B7EE         3319                              jb             p3.7,dgoto7
1397 76FF           3320                              mov            @r0,#0ffh
                    3321                              ;T1<-число на индикаторе
1399 C20B           3322                              clr            bitmem            ;vvod КОН БЛ 000
139B D204           3323                              setb           bitizm
                    3324                                     
139D 020000   F     3325                             jmp        goto7
13A0                3326     labelP:                                                         
                    3327     ;;;;;;;
13A0                3328     labelI:
13A0 75B0FE         3329                                     mov             p3,#0feh
13A3 E5B0           3330                                     mov             a,p3
13A5 20E703         3331                                     jb              acc.7,nopoint
                    3332                                     ;
13A8 020000   F     3333                                     jmp             goto7;out7
                    3334     
13AB 75B0FB         3335     nopoint:                mov             p3,#0fbh
13AE E5B0           3336                                     mov             a,p3
13B0 20E72C         3337                                     jb              acc.7,nopoin7
13B3 78B2           3338                                     mov             r0,#marker
13B5 E53A           3339                                     mov             a,movleft
13B7 B40309         3340                                     cjne    a,#3,poina1
13BA B6030B         3341                                     cjne    @r0,#3,nomarl;26
                    3342                                     ;mov            @r0,#9
13BD E53B           3343     poina2: mov                     a,movrig                ;кн <- B=+00000
13BF F6             3344                                     mov                     @r0,a
13C0 020000   F     3345                                     jmp             goto7;  out7
                    3346     
13C3 B60402         3347     poina1:         cjne    @r0,#4,nomarl;кн <- A= 0000
13C6 80F5           3348                                             jmp             poina2
                    3349     
                    3350     
13C8                3351     nomarl:                 ;                               29.12.06
                    3352     ;;;;;;;;;;;;;;;;;;
                    3353     ;необходимо не портить цифру в следуюем справа знакоместе
                    3354     ;т е сохранить ее в ячейке для мигания в противном случае
                    3355     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3356     ;       знакоместа
13C8 78B2           3357                                     mov             r0,#marker
13CA 7440           3358                                     mov             a,#bufind
13CC 26             3359                                             add             a,@r0                   ;a=bufind+m
                             arker
13CD F9             3360                                             mov             r1,a
13CE 09             3361                                             inc             r1
13CF 873C           3362                                             mov             savba,@r1
                    3363                                                     
13D1 78B2           3364                                                     mov             r0,#marker
13D3 16             3365                                                     dec             @r0                        
                                  
13D4 C219           3366                                     clr             bitmig
13D6 E53A           3367                                     mov                     a,movleft
13D8 B40346         3368                                     cjne            a,#3,poinA
13DB B60276         3369                                     cjne    @r0,#2,out7;;нажата кн <- при вводе цифр B=+00000
13DE 06             3370     poin3:  inc             @r0
                    3371     ;нажат ввод А =000000 запомнить константу А
13DF 75B0F7         3372     nopoin7:           mov          p3,#0f7h
13E2 E5B0           3373                                     mov             a,p3
13E4 20E76D         3374                                     jb              acc.7,out7
13E7 78B1           3375                                     mov             r0,#vichR
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    53

13E9 E6             3376                                     mov             a,@r0
13EA B62139         3377                                     cjne    @r0,#21h,no21p7
13ED 7631           3378                                     mov             @r0,#31h
                    3379                             ;       считать с индикатора  упаковать в плавающий формат
                    3380                             ;   сохранить
13EF 7F0E           3381                                     mov             r7,#14
13F1 784F           3382                                     mov             r0,#abin
13F3 120000   F     3383                                     call    clearN                  
13F6 120000   F     3384                                     call    upakA
                    3385                                     
13F9 784F           3386                                     mov             r0,#abin
13FB 7953           3387                                     mov             r1,#adec                        ;мл        
                              ст
13FD 120000   F     3388                                     call    decbin                  ;abin..abin+3 (hex)
1400 120000   F     3389                                     call    loadr2                  ;r2..r5
1403 120402         3390                                     call    altof                   ;r2..r5->int
1406 78BC           3391                                     mov             r0,#konstA
1408 120000   F     3392                                     call    saver2
                    3393     ;26
140B 78B2           3394                                     mov             r0,#marker
140D 7603           3395                                     mov             @r0,#3
140F 753B08         3396                                     mov             movrig,#8
1412 753A03         3397                                     mov             movleft,#3
1415 900000   F     3398                                     mov             dptr,#teBequ0
1418 120000   F     3399                                     call    lotext
141B 120000   F     3400                                     call            outB
141E 020000   F     3401                                     jmp             goto7;out7
                    3402     
1421 B60330         3403     poinA:          cjne    @r0,#3,out7;;нажата кн <- при вводе цифр A= 0000
1424 80B8           3404                                             jmp             poin3
                    3405     
1426                3406     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    3407                             ;   сохранить
1426 7F0E           3408                                     mov             r7,#14
1428 784F           3409                                     mov             r0,#abin
142A 120000   F     3410                                     call    clearN                  
142D 120000   F     3411                                     call    upakB                   
1430 784F           3412                                     mov             r0,#abin
1432 7953           3413                                     mov             r1,#adec                        ;мл        
                              ст
1434 120000   F     3414                                     call    decbin                  ;abin..abin+3 (hex)
1437 120000   F     3415                                     call    loadr2                  ;r2..r5
143A 120402         3416                                     call    altof                   ;r2..r5->int
143D 301B04         3417                                     jnb             bitznB,pozB
1440 EA             3418                                     mov             a,r2
1441 4480           3419                                     orl             a,#80h
1443 FA             3420                                     mov             r2,a                    ;знак-
1444 78C0           3421     pozB:           mov             r0,#konstB
1446 120000   F     3422                                     call    saver2
                    3423     
1449 79B2           3424                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
144B 77FF           3425                                     mov             @r1,#0ffh
144D 78B1           3426                                     mov             r0,#vichR
144F 7611           3427                                     mov             @r0,#11h
1451 020000   F     3428                               jmp           lovich     ;3.01.07ВЫЧИСЛИТЬ
                    3429                                     
                    3430     
1454                3431     out7:                   ;mov            IE,#80h
1454 D083           3432                                     pop             dph
1456 D082           3433                                     pop             dpl
1458 D007           3434                                     pop             rr7     
145A D006           3435                                     pop             rr6
145C D005           3436                                     pop             rr5
145E D004           3437                                     pop             rr4
1460 D003           3438                                     pop             rr3
1462 D002           3439                                     pop             rr2
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    54

1464 D001           3440                                     pop             rr1                             
1466 D000           3441                                     pop             rr0
1468 D0D0           3442                                     pop             psw
146A D0E0           3443                                     pop             acc
146C E5AD           3444                                     mov             a,P3IF
146E 547F           3445                                     anl             a,#7fh
1470 F5AD           3446                                     mov             P3IF,a
1472 75B0C0         3447                                     mov             P3,#0c0h
                    3448     ;clr            bitmig
1475 75E730         3449                                     mov             EIE2,#30H
1478 C219           3450     clr             bitmig
147A 32             3451                                     reti
                    3452     
                    3453     
                    3454                                     
147B                3455     textT:          
147B FD543D32       3456                             db              0fdh,"T","=",32h,"m","S",0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
147F 6D53FDFD                
1483 FDFD                    
1485 FD543D31       3457                             db              0fdh,"T","=",31h,30h,"m","S",0fdh,0fdh,0fdh
1489 306D53FD                
148D FDFD                    
148F FD543D35       3458                             db              0fdh,"T","=",35h,30h,"m","S",0fdh,0fdh,0fdh
1493 306D53FD                
1497 FDFD                    
1499 FD543D64       3459                             db              0fdh,"T","=",64h,31h,"S",0fdh,0fdh,0fdh,0fdh
149D 3153FDFD                
14A1 FDFD                    
14A3 20202054       3460                             db              " "," "," ","T","=",31h,"S"," "," "," "
14A7 3D315320                
14AB 2020                    
14AD 2020543D       3461                             db              " "," ","T","=",31h,30h,"S"," "," "," "  
14B1 31305320                
14B5 2020                    
                    3462     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                    3463     
14B7 42753474       3464      teVICH:        db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
14BB 79767454                
14BF 7720                    
14C1 20413D20       3465      teAequ0:       db              " ",'A','='," "," "," "," "," "," ",65h
14C5 20202020                
14C9 2065                    
14CB 20423D2B       3466      teBequ0:       db              " ",'B','=','+'," "," "," "," "," "," "
14CF 20202020                
14D3 2020                    
14D5 20207145       3467      teMENU:        db              " "," ",71h,"E","H",72h," "," "," "," "
14D9 48722020                
14DD 2020                    
                    3468     
14DF 20205445       3469      teTEST:        db      " "," ","T","E",79h,"T"," "," "," "," "
14E3 79542020                
14E7 2020                    
                    3470     
14E9 204B4176       3471      teKALIB:        db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР
14ED 74735020                
14F1 202020                  
14F4 74337120       3472      teIZMK:        db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
14F8 4B304879                
14FC 5420                    
14FE 20204275       3473      teOUT:         db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
1502 58307820                
1506 2020                    
1508 2020304C       3474      teOLL:         db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
150C 4C202020                
1510 2020                    
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    55

1512 20203034       3475      teCLE:         db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
1516 7479544B                
151A 4120                    
151C 20203041       3476      teMEM:         db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
1520 71795420                
1524 20203341       3477      teWR:          db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
1528 61747977                
152C 2020                    
152E 20206150       3478      teLIST:        db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
1532 30797130                
1536 545020                  
1539 20206130       3479      teFULL:        db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
153D 76484162                
1541 2020                    
1543 20207376       3480      teBLOK:        db      " "," ",73h,76h,30h,'K'," ",30h,30h," ";БЛОК 00
1547 304B2030                
154B 3020                    
154D 20207376       3481      teBL:          db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
1551 304B2020                
1555 2020                    
1557 48413420       3482      tebBL:         db      "H",'A',34h," ",73h,76h," ",30h,30h,30h; НАЧ БЛОК 000
155B 73762030                
155F 3030                    
1561 4B304820       3483      teeBL:         db      "K",30h,"H"," ",73h,76h," ",30h,30h,30h; КОН БЛОК 000
1565 73762030                
1569 3030                    
                    3484      ;;;;;;;;;;;;;;;;;;;         
156B 2020304C       3485     teOLI:  db              " "," ",30h,"L","L"," ","I"," "," "," "
156F 4C204920                
1573 2020                    
1575 2020304C       3486     teOLR:  db              " "," ",30h,"L","L"," ",66h," "," "
1579 4C206620                
157D 20                      
                    3487     
                    3488     ;пп мигания индикации
157E 78B2           3489     mign:           mov             r0,#marker
                    3490                                     
1580 B6FF03         3491                                     cjne    @r0,#0ffh,mignn
                    3492                                     ;реж изм мигает *
1583 C219           3493                                     clr             bitmig
1585 22             3494                                     ret
                    3495     
1586                3496     mignn:                  ;clr            c
1586 7440           3497                                     mov             a,#bufind
1588 26             3498                                     add             a,@r0                   ;a=bufind+marker
1589 F9             3499                                     mov             r1,a
158A 201907         3500                                     jb              bitmig,onmig
158D 873C           3501                                     mov             savba,@r1
                    3502                             ;       mov             a,@r1
                    3503                             ;       mov             savba,a
158F 7720           3504                                     mov             @r1,#" "
                    3505                                     
1591 D219           3506                                     setb    bitmig
1593 22             3507                                     ret
                    3508     
1594 A73C           3509     onmig:                  mov             @r1,savba
                    3510                                     ;mov            a,savba
                    3511                                     ; mov           @r1,a
1596 C219           3512                                     clr             bitmig
1598 120000   F     3513                                     call    z_01s
159B 22             3514                                     ret
                    3515     ;bufind=30h..39h                                                                           
                                           ;
159C C219           3516     vvchif:                 clr             bitmig
159E 79B2           3517                                     mov             r1,#marker
15A0 E7             3518                                     mov             a,@r1                   ;изм цифры
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    56

15A1 7840           3519                                     mov             r0,#bufind                      ;0000
15A3 28             3520                                     add             a,r0
15A4 F8             3521                                     mov             r0,a
15A5 06             3522                                     inc             @r0
15A6 B63A02         3523                                     cjne    @r0,#3ah,chif
15A9 7630           3524                                     mov             @r0,#30h
15AB                3525     chif:   
15AB 22             3526                             ret
                    3527     
                    3528       ;перевод маркера влево
15AC                3529     marle:  
15AC C219           3530                     clr             bitmig
                    3531                     ;mov            savba,#0   нельзя обнулять
15AE 78B2           3532             mov             r0,#marker
15B0 16             3533                     dec             @r0
15B1 E6             3534                     mov             a,@r0
15B2 C3             3535                     clr             c
15B3 953A           3536                     subb    a,movleft         ;крайне левое положение
15B5 5001           3537                     jnc             rler
15B7 06             3538                     inc             @r0
15B8 22             3539     rler:   ret
                    3540         
                    3541     ;перевод маркера вправо
15B9 C219           3542     marri:  clr             bitmig
15BB 78B2           3543                     mov             r0,#marker
15BD 06             3544                     inc         @r0
15BE E53B           3545                     mov             a,movrig           ;крайне правое положение
15C0 C3             3546                     clr             c
15C1 96             3547                     subb    a,@r0
15C2 5001           3548                     jnc             rrir
15C4 16             3549                     dec             @r0
15C5 22             3550     rrir:   ret
                    3551         
                    3552     ;konstA->bufind+4..bufind+7
15C6 78BC           3553     outA:           mov                     r0,#konstA
15C8 120000   F     3554                                     call            resar2
15CB 120343         3555                                     call            ftol                    ;->hex
15CE 784F           3556                                     mov             r0,#abin
15D0 120000   F     3557                                     call            saver2
15D3 7853           3558                                     mov                     r0,#adec
15D5 7952           3559                                     mov             r1,#abin+3
15D7 120000   F     3560                                     call            bindec
15DA 785C           3561                                     mov                     r0,#adec+9
15DC 7947           3562                                     mov                     r1,#bufind+7
15DE 7F04           3563                                     mov                     r7,#4
15E0 E6             3564     outa2:  mov             a,@r0
15E1 2430           3565                               add           a,#30h
15E3 F7             3566                                     mov             @r1,a
15E4 19             3567                                     dec             r1
15E5 18             3568                                     dec             r0
15E6 DFF8           3569                                     djnz    r7,outa2
15E8 22             3570                                     ret
                    3571                                             
                    3572     ;konstB->bufind+4..bufind+8
15E9 78C0           3573     outB:           mov                     r0,#konstB
15EB 120000   F     3574                                     call            resar2
15EE EA             3575                                     mov                     a,r2
15EF 5480           3576                                     anl                     a,#80h
15F1 6007           3577                                     jz                      outb3
15F3 EA             3578     mov                     a,r2
15F4 547F           3579                                     anl                     a,#7fh
15F6 FA             3580                                     mov                     r2,a
15F7 75432D         3581                                     mov                     bufind+3,#2dh
15FA 120343         3582     outb3:  call            ftol                    ;->hex
15FD 784F           3583                                     mov             r0,#abin
15FF 120000   F     3584                                     call            saver2
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    57

1602 7853           3585                                     mov                     r0,#adec
1604 7952           3586                                     mov             r1,#abin+3
1606 120000   F     3587                                     call            bindec
1609 785C           3588                                     mov                     r0,#adec+9
160B 7948           3589                                     mov                     r1,#bufind+8
160D 7F05           3590                                     mov                     r7,#5
160F E6             3591     outb2:  mov             a,@r0
1610 2430           3592                               add           a,#30h
1612 F7             3593                                     mov             @r1,a
1613 19             3594                                     dec             r1
1614 18             3595                                     dec             r0
1615 DFF8           3596                                     djnz    r7,outb2
1617 22             3597                                     ret
                    3598     
                    3599     ;$include (d:\amp\subr2.asm) 
1618            +1  3600     loadUS: ;если идет тест измерения ус восстановить для теста
                +1  3601                                     ;jb             biteizm,yestest
1618 79AE       +1  3602                                             mov             r1,#diap
161A E7         +1  3603                             mov             a,@r1
161B 23         +1  3604                             rl              a;*2
161C FC         +1  3605                             mov             r4,a                    ;save a
161D 900000   F +1  3606                             mov             dptr,#tabus
1620 93         +1  3607                             movc    a,@a+dptr
1621 FA         +1  3608                             mov             r2,a                    ;high byte
1622 E584       +1  3609                             mov             a,p4
1624 5401       +1  3610                             anl             a,#01
1626 4A         +1  3611                             orl             a,r2
1627 F584       +1  3612                             mov             p4,a
1629 0C         +1  3613                             inc             r4
162A EC         +1  3614                             mov             a,r4
162B 93         +1  3615                             movc    a,@a+dptr
162C FB         +1  3616                             mov             r3,a                    ;low byte
162D E585       +1  3617                             mov             a,p5
162F 5401       +1  3618                             anl             a,#01
1631 4B         +1  3619                             orl             a,r3
1632 F585       +1  3620                             mov             p5,a
1634 799A       +1  3621                             mov             r1,#parT
1636 B7010E     +1  3622                             cjne    @r1,#1,bret
1639 79AE       +1  3623                             mov             r1,#diap                  ;10s (parT=1)
163B 7405       +1  3624                             mov             a,#5                      ;10-8..10-11 p4.1=1
163D C3         +1  3625                             clr             c
163E 97         +1  3626                             subb    a,@r1
163F 5006       +1  3627                             jnc             bret
1641 E584       +1  3628                             mov             a,p4
1643 4402       +1  3629                             orl             a,#02
1645 F584       +1  3630                             mov             p4,a                     ;10-8..10-11 p4.1=1
1647 120000   F +1  3631     bret:      call          louizm         ;us если вкл кн ИЗМЕР
164A 22         +1  3632                             ret
164B            +1  3633     yestest:
164B 120000   F +1  3634                             call            lotpus          ;ус теста измерения
164E 22         +1  3635                             ret
                +1  3636                             
                +1  3637     ;загр ус для кор 0
                +1  3638     ;dptr-
164F E4         +1  3639     lospus:         clr             a
                +1  3640                             ;movc   a,@a+dptr
                +1  3641                             ;mov            r2,a                    ;high byte
                +1  3642                             ;mov            a,p4
                +1  3643                             ;anl            a,#01
                +1  3644                             ;orl            a,r2
                +1  3645                             ;mov            p4,a
                +1  3646                             ;inc            dptr
1650 E4         +1  3647                             clr             a
1651 93         +1  3648                             movc    a,@a+dptr
1652 FB         +1  3649                             mov             r3,a                    ;low byte
1653 E585       +1  3650                             mov             a,p5
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    58

1655 54BF       +1  3651                             anl             a,#0bfh;01
1657 4B         +1  3652                             orl             a,r3
1658 F585       +1  3653                             mov             p5,a
165A 22         +1  3654                             ret
                +1  3655     
165B 80         +1  3656     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                +1  3657     
                +1  3658     ;us кнопка измерения выкл
165C 88D6       +1  3659     tabus:     db           88h,0d6h         ;10-2
165E 88F6       +1  3660                             db      88h,0f6h         ;10-3
1660 88D6       +1  3661                             db              88h,0d6h         ;10-4
1662 88F6       +1  3662                             db              88h,0f6h         ;10-5
1664 9AD6       +1  3663                             db      9ah,0d6h         ;10-6
1666 9AF6       +1  3664                             db              9ah,0f6h         ;10-7
1668 ACD6       +1  3665                             db              0ach,0d6h        ;10-8
166A ACF6       +1  3666                             db      0ach,0f6h        ;10-9
166C C8D6       +1  3667                             db              0c8h,0d6h        ;10-10
166E C8F6       +1  3668                             db              0c8h,0f6h        ;10-11
                +1  3669     
1670            +1  3670     tabt11: 
1670 66E6       +1  3671                             db              66h,0e6h;10-11
1672            +1  3672     tabt9:  
1672 32E6       +1  3673                             db              32h,0e6h;10-9
1674            +1  3674     tabt7:  
1674 18EE       +1  3675                             db              18h,0eeh;10-7
                +1  3676     
                +1  3677      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  3678     ;в зав от parT (Tизм)
1676 79B7       +1  3679     loadT:          mov             r1,#load;parT
1678 7840       +1  3680     lolevT:         mov             r0,#bufind+0
167A 7B0A       +1  3681                             mov             r3,#10
167C 75F00A     +1  3682                             mov             b,#10
167F E7         +1  3683                             mov             a,@r1
1680 A4         +1  3684                             mul             ab
1681 FC         +1  3685                             mov             r4,a                    ;save a
1682 900000   F +1  3686                             mov             dptr,#textT
1685 93         +1  3687             lod1:   movc    a,@a+dptr
1686 F6         +1  3688                             mov             @r0,a
1687 08         +1  3689                             inc             r0
1688 0C         +1  3690                             inc             r4
1689 EC         +1  3691                             mov             a,r4
168A DBF9       +1  3692                             djnz    r3,lod1
168C 22         +1  3693                             ret     
                +1  3694     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  3695     ;dptr-адр строки текста         
168D            +1  3696     lotext:         
168D 7B0A       +1  3697                             mov             r3,#10
168F 7840       +1  3698                             mov             r0,#bufind+0
1691 E4         +1  3699     lodt:           clr             a
1692 93         +1  3700                             movc    a,@a+dptr
1693 F6         +1  3701                             mov             @r0,a
1694 08         +1  3702                             inc             r0
1695 A3         +1  3703                             inc             dptr
1696 DBF9       +1  3704                             djnz    r3,lodt
1698 22         +1  3705                             ret                                     
                +1  3706     
                +1  3707     
                +1  3708     
                +1  3709     
                +1  3710      ;задержка 100 мкс
1699 7978       +1  3711     z_100:    mov R1,#78h     ;загрузка первого числа
169B 7A02       +1  3712     z100:     mov R2,#2h     ;загрузка второго числа
169D DAFE       +1  3713     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
169F D9FA       +1  3714               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
16A1 22         +1  3715               ret           
                +1  3716     
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    59

                +1  3717     ;задержка 34 мкс
16A2 7B8B       +1  3718     z_5:      mov R3,#8Bh      ;загрузка числа
16A4 DBFE       +1  3719     ct:       djnz R3,ct
16A6 22         +1  3720               ret
                +1  3721     
                +1  3722     ;задержка 15 мс
16A7 79FA       +1  3723     z_15:     mov R1,#0FAh    ;загрузка первого числа
16A9 7AED       +1  3724     z15:      mov R2,#0EDh   ;загрузка второго числа
16AB DAFE       +1  3725     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
16AD D9FA       +1  3726               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
16AF 22         +1  3727               ret   
                +1  3728                                               
                +1  3729      ;задержка 1 мс
16B0 7910       +1  3730     z_1ms:     mov R1,#10h     
16B2 7AED       +1  3731     ss1:       mov R2,#0EDh    
16B4 DAFE       +1  3732                djnz R2, $    
16B6 D9FA       +1  3733                djnz R1, ss1   
16B8 22         +1  3734                ret   
                +1  3735     
                +1  3736      ;????????
                +1  3737     ;задержка 1с
16B9 7D1F       +1  3738     z_1s:   mov             r5,#01fh 
16BB 7EFF       +1  3739     co2s:   mov     R6,#0ffh     
16BD 7FFF       +1  3740     z1s:     mov    R7,#0ffh     
16BF DFFE       +1  3741     co1s:   djnz    R7, co1s        
16C1 DEFA       +1  3742             djnz    R6, z1s 
16C3 DDF6       +1  3743                     djnz    r5,co2s
16C5 22         +1  3744               ret
                +1  3745     ;задержка 0,1с
16C6 7D03       +1  3746     z_01s:           mov            r5,#03h 
16C8 7EFF       +1  3747     co02s:          mov     R6,#0ffh     
16CA 7FFF       +1  3748     z01s:           mov     R7,#0ffh     
16CC DFFE       +1  3749                             djnz    R7, $   
16CE DEFA       +1  3750                     djnz    R6, z01s 
16D0 DDF6       +1  3751                             djnz    r5,co02s
16D2 22         +1  3752                      ret              
16D3 000007FF   +1  3753     chzap:  db      00,00,07h,0ffh             
16D7 00000000   +1  3754     ch0:    db      00,00,00,00
16DB 0000000A   +1  3755     ch10:   db      00,00,00,0ah                            ;10
16DF 00000005   +1  3756     ch5:    db      00,00,00,05                                             ;5
16E3 000003B9   +1  3757     ch954:  db 00,00,03,0b9h                                                ;954
16E7 000003E8   +1  3758     ch10000:        db 00,00,03h,0e8h                                               ;10000
16EB 00000064   +1  3759     ch100:  db 00,00,00,64h ;100
16EF 00000002   +1  3760     ch2:    db      00,00,00,02                                             
                +1  3761     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  3762     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  3763     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
16F3 00000001   +1  3764     ch1:    db  00,00,00,01
16F7 3F800000   +1  3765     ch_1:   db      3fh,80h,00,00                   
16FB 3F741EDF   +1  3766     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
16FF 47C35000   +1  3767     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
1703 3F800347   +1  3768     KD:             db      3fh,80h,03h,47h;1,0001
1707 48435000   +1  3769     CH2tho: db      48h,43h,50h,00;200000
170B 4856D800   +1  3770     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
170F 4856D800   +1  3771     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
1713 461C4000   +1  3772     ch_10th:db  46h,1ch,40h,00;10000-2710h
1717 41200000   +1  3773     ch_10:  db      41h,20h,00,00;10d
171B 48742400   +1  3774     ch_250: db      48h,74h,24h,00;250000
                +1  3775     ;r1- мл байт 2х байтного числа
171F            +1  3776     tenmin:         ;-10
171F C3         +1  3777                             clr             c
1720 E7         +1  3778                     mov             a,@r1
1721 9405       +1  3779                             subb    a,#5;10
1723 F7         +1  3780                             mov             @r1,a
1724 19         +1  3781                             dec             r1
1725 E7         +1  3782                             mov             a,@r1
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    60

1726 9400       +1  3783                             subb    a,#0
1728 F7         +1  3784                             mov             @r1,a
1729 22         +1  3785                             ret
                +1  3786       ;r0-обнуление ячеек памяти  
172A 7F04       +1  3787       clear4:        mov    r7,#4
172C E4         +1  3788                             clr             a
172D F6         +1  3789       cl4:          mov             @r0,a
172E 08         +1  3790                             inc             r0
172F DFFC       +1  3791                             djnz    r7,cl4
1731 22         +1  3792                             ret     
                +1  3793     
                +1  3794      ;r0-обнуление ячеек памяти 
                +1  3795      ;R7- 
1732            +1  3796       clearN:        
1732 E4         +1  3797                             clr             a
1733 F6         +1  3798       cl4N:         mov             @r0,a
1734 08         +1  3799                             inc             r0
1735 DFFC       +1  3800                             djnz    r7,cl4N
1737 22         +1  3801                             ret     
                +1  3802     
                +1  3803       ;чтение номера байта с индикатора(2байта)
                +1  3804     ;bufind+8..bufind+9
                +1  3805     ;-  - - -
                +1  3806     ;- - - - - - - - - -
                +1  3807     ;adec..adec+9
                +1  3808     ;ст            мл
1738 7848       +1  3809     upak2:  mov             r0,#bufind+8;
173A 795C       +1  3810                     mov             r1,#adec+9
173C 7F02       +1  3811                     mov             r7,#2;2bait
173E C3         +1  3812     upa2:   clr             c
173F E6         +1  3813                     mov             a,@r0
1740 9430       +1  3814                     subb    a,#30h
1742 F7         +1  3815                     mov             @r1,a
1743 18         +1  3816                     dec             r0
1744 19         +1  3817                     dec             r1
1745 DFF7       +1  3818                     djnz    r7,upa2
1747 22         +1  3819                     ret  
                +1  3820         
                +1  3821      ;bufind+4..bufind+9
                +1  3822     ;-  - - -
                +1  3823     ;- - - - - - - - - -
                +1  3824     ;adec..adec+9
                +1  3825     ;ст            мл
1748 7849       +1  3826     upak:   mov             r0,#bufind+9;
174A 795C       +1  3827                     mov             r1,#adec+9
174C 7F06       +1  3828                     mov             r7,#6
174E C3         +1  3829     upa:    clr             c
174F E6         +1  3830                     mov             a,@r0
1750 9430       +1  3831                     subb    a,#30h
1752 F7         +1  3832                     mov             @r1,a
1753 18         +1  3833                     dec             r0
1754 19         +1  3834                     dec             r1
1755 DFF7       +1  3835                     djnz    r7,upa
1757 22         +1  3836                     ret
                +1  3837     
                +1  3838      ;чтение номера байта с индикатора(3байта)
                +1  3839     ;bufind+3..bufind+9
                +1  3840     ;-  - - -
                +1  3841     ;- - - - - - - - - -
                +1  3842     ;adec..adec+9
                +1  3843     ;ст            мл
1758 7849       +1  3844     upak3:  mov             r0,#bufind+9;
175A 795C       +1  3845                     mov             r1,#adec+9
175C 7F03       +1  3846                     mov             r7,#3;3bait
175E C3         +1  3847     upa1:   clr             c
175F E6         +1  3848                     mov             a,@r0
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    61

1760 9430       +1  3849                     subb    a,#30h
1762 F7         +1  3850                     mov             @r1,a
1763 18         +1  3851                     dec             r0
1764 19         +1  3852                     dec             r1
1765 DFF7       +1  3853                     djnz    r7,upa1
1767 22         +1  3854                     ret
                +1  3855     
                +1  3856     ;вых-r2,r3-адрес ячее памяти прогр
1768            +1  3857     findkoef:
1768 79AE       +1  3858                                     mov             r1,#diap
176A E7         +1  3859                                     mov             a,@r1
176B 23         +1  3860                                     rl              a                                          
                                          ;diap*2(2bait )
176C FC         +1  3861                                     mov             r4,a                                    ;sa
                             ve
176D 900000   F +1  3862                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  3863                                     
1770 93         +1  3864                                     movc    a,@a+dptr                       ;ст байт
1771 FA         +1  3865                                     mov             r2,a
1772 A3         +1  3866                                     inc             dptr
1773 EC         +1  3867                                     mov             a,r4
1774 93         +1  3868                                     movc    a,@a+dptr
1775 FB         +1  3869                                     mov             r3,a                    ;мл байт
1776 22         +1  3870                                     ret
                +1  3871     
                +1  3872     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  3873     ;(5000h..5027h)
1777 5000       +1  3874     diKDw:  dw              5000h                   ;10-2
1779 5004       +1  3875                                     dw              5004h                   ;10-3
177B 5008       +1  3876                                     dw              5008h                   ;10-4
177D 500C       +1  3877                                     dw              500ch                   ;10-5
177F 5010       +1  3878                                     dw              5010h                   ;10-6
1781 5014       +1  3879                                     dw              5014h                   ;10-7
1783 5018       +1  3880                                     dw              5018h                   ;10-8
1785 501C       +1  3881                                     dw              501ch                   ;10-9
1787 5020       +1  3882                                     dw              5020h                   ;10-10
1789 5024       +1  3883                                     dw              5024h                   ;10-11
178B 5028       +1  3884     dipar:  dw              5028h                   ;parol
                +1  3885     
178D 000186A0   +1  3886     chthou: db      00,01,86h,0a0h  ;100.000
                +1  3887     
1791 AA08       +1  3888     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
1793 AB09       +1  3889                                             mov     r3,ltemp+1
1795 AC0A       +1  3890                                             mov     r4,ltemp+2
1797 AD0B       +1  3891                                             mov     r5,ltemp+3
1799 22         +1  3892                                             ret
                +1  3893     ;bufind+4..bufind+9
                +1  3894     ;-  - - -
                +1  3895     ;- - - - - - - - - -
                +1  3896     ;adec..adec+9
                +1  3897     ;ст            мл
179A 7847       +1  3898     upakA:  mov             r0,#bufind+7;
179C 795C       +1  3899                     mov             r1,#adec+9
179E 7F04       +1  3900                     mov             r7,#4
17A0 C3         +1  3901     upaa:   clr             c
17A1 E6         +1  3902                     mov             a,@r0
17A2 9430       +1  3903                     subb    a,#30h
17A4 F7         +1  3904                     mov             @r1,a
17A5 18         +1  3905                     dec             r0
17A6 19         +1  3906                     dec             r1
17A7 DFF7       +1  3907                     djnz    r7,upaa
17A9 22         +1  3908                     ret
                +1  3909     
                +1  3910     ;bufind+4..bufind+9
                +1  3911     ;-  - - -
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    62

                +1  3912     ;- - - - - - - - - -
                +1  3913     ;adec..adec+9
                +1  3914     ;ст            мл
17AA 7848       +1  3915     upakB:  mov             r0,#bufind+8;
17AC 795C       +1  3916                     mov             r1,#adec+9
17AE 7F05       +1  3917                     mov             r7,#5
17B0 C3         +1  3918     upab:   clr             c
17B1 E6         +1  3919                     mov             a,@r0
17B2 9430       +1  3920                     subb    a,#30h
17B4 F7         +1  3921                     mov             @r1,a
17B5 18         +1  3922                     dec             r0
17B6 19         +1  3923                     dec             r1
17B7 DFF7       +1  3924                     djnz    r7,upab
17B9 C21B       +1  3925                     clr                     bitznB
17BB E543       +1  3926                     mov             a,bufind+3
17BD B42D02     +1  3927                     cjne            a,#2dh,abret
17C0 D21B       +1  3928                     setb            bitznB
17C2            +1  3929     abret:
17C2 22         +1  3930                     ret
17C3            +1  3931     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
17C3 4E6E6AA8   +1  3932                                             db      4eh,6eh,6ah,0a8h;10**9
17C7 43FA0000   +1  3933     CH_500:         db              43h,0fah,00,00;1fah=500
17CB 4856D800   +1  3934     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
17CF 49742400   +1  3935     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  3936     
                +1  3937     
                +1  3938     
                +1  3939     ;управление AD7731
                +1  3940     ;r4=b1 r5=b2
17D3            +1  3941     iniacp: ;управление AD7731
17D3 7403       +1  3942                             mov             a,#03
                +1  3943     
17D5 120000   F +1  3944                             call    write
17D8 EC         +1  3945                             mov             a,r4;#80h
17D9 120000   F +1  3946                             call    write
17DC ED         +1  3947                             mov             a,r5;#04
17DD 120000   F +1  3948                             call    write
17E0 7402       +1  3949                             mov             a,#02
17E2 120000   F +1  3950                             call    write
17E5 74A1       +1  3951                             mov             a,#0a1h
17E7 120000   F +1  3952                             call    write
17EA 7474       +1  3953                             mov             a,#74h
17EC 120000   F +1  3954                             call    write
17EF 2095FD     +1  3955                             jb              p1.5,$;p1.3,$
17F2 7402       +1  3956                             mov             a,#02
17F4 120000   F +1  3957                             call    write
17F7 7481       +1  3958                             mov             a,#81h
17F9 120000   F +1  3959                             call    write
17FC 7474       +1  3960                             mov             a,#74h
17FE 120000   F +1  3961                             call    write
1801 2095FD     +1  3962                             jb              p1.5,$;p1.3,$
1804 7402       +1  3963                             mov             a,#02
1806 120000   F +1  3964                             call    write
1809 7421       +1  3965                             mov             a,#21h
180B 120000   F +1  3966                             call    write
180E 7474       +1  3967                             mov             a,#74h
1810 120000   F +1  3968                             call    write
1813 22         +1  3969                             ret
                +1  3970                             ;;;;;;;;;;;;;;;;
                +1  3971     ;;;;;;;;;;;;;;;;;
                +1  3972     ;;;;;;;;;;;;;;;;;
1814 0000       +1  3973     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
1816 6000       +1  3974                                     db              60h,00h;40h,04h         ;10s
1818 6000       +1  3975                                     db              60h,00;40h,04h          ;1s
181A 4004       +1  3976                                     db              40h,04h         ;0,1s
181C 2004       +1  3977                                     db              20h,04h         ;50ms
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    63

181E 2004       +1  3978                                     db              20h,04h          ;10ms
1820 1332       +1  3979                                     db              13h,32h         ;2ms
                +1  3980     
                +1  3981     ;загр В1,В2 в завис от Т                                
1822 799A       +1  3982     loab12:                 mov             r1,#parT
1824 900000   F +1  3983                                     mov             dptr,#tabB1_2
1827 E7         +1  3984                                     mov             a,@r1
1828 23         +1  3985                                     rl              a;*2
1829 FF         +1  3986                                     mov             r7,a                    ;save a
182A 93         +1  3987                                     movc    a,@a+dptr
182B FC         +1  3988                                     mov             r4,a   ;b1
182C 0F         +1  3989                                     inc             r7
182D EF         +1  3990                                     mov             a,r7
182E 93         +1  3991                                     movc    a,@a+dptr
182F FD         +1  3992                                     mov             r5,a
                +1  3993                                     ;после загр В1,2 загр упр слово для нового Т
                +1  3994                             
1830 22         +1  3995                                     ret
                +1  3996     
                +1  3997     
1831 7852       +1  3998     loadr2: mov             r0,#abin+3              ;r2..r5
1833 E6         +1  3999                     mov             a,@r0                   ; ст мл   
1834 FA         +1  4000                     mov             r2,a
1835 18         +1  4001                     dec             r0
1836 E6         +1  4002                     mov             a,@r0
1837 FB         +1  4003                     mov             r3,a
1838 18         +1  4004                     dec             r0
1839 E6         +1  4005                     mov             a,@r0
183A FC         +1  4006                     mov             r4,a
183B 18         +1  4007                     dec             r0
183C E6         +1  4008                     mov             a,@r0
183D FD         +1  4009                     mov             r5,a
183E 22         +1  4010                     ret
                +1  4011                                             
                +1  4012      ;;;;;;;;;;;;;;;;;;;      
                +1  4013      ;загрузка KD в зависимости от диап изм  
                +1  4014      ;koef->r8..r11
183F 78AE       +1  4015     loadKD:                 mov             r0,#diap
1841 E6         +1  4016                                     mov             a,@r0
1842 900000   F +1  4017                                     mov             dptr,#diKDn
1845 75F004     +1  4018                                     mov             b,#4
1848 A4         +1  4019                                     mul             ab
1849 FF         +1  4020                                     mov             r7,a;save
184A 93         +1  4021                                     movc    a,@a+dptr
184B F508       +1  4022                                     mov             r8,a
184D A3         +1  4023                                     inc             dptr
184E EF         +1  4024                                     mov             a,r7
184F 93         +1  4025                                     movc    a,@a+dptr
1850 F509       +1  4026                                     mov             r9,a
1852 A3         +1  4027                                     inc             dptr
1853 EF         +1  4028                                     mov             a,r7
1854 93         +1  4029                                     movc    a,@a+dptr
1855 F50A       +1  4030                                     mov             r10,a
1857 A3         +1  4031                                     inc             dptr
1858 EF         +1  4032                                     mov             a,r7
1859 93         +1  4033                                     movc    a,@a+dptr
185A F50B       +1  4034                                     mov             r11,a
185C 22         +1  4035                                     ret
                +1  4036     
185D 3F506B7B   +1  4037      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
1861 3F507FCC   +1  4038                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
1865 3F4F9D0B   +1  4039                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
1869 3F4FE869   +1  4040                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    64

186D 3F50294A   +1  4041                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
1871 3F50639E   +1  4042                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
1875 3F4BC9F0   +1  4043                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
1879 3F4C063B   +1  4044                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
187D 3F50EFDD   +1  4045                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
1881 3F512AD9   +1  4046                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  4047     
1885 00000039   +1  4048     ch57:   db      00,00,00,39h;57
1889 00000014   +1  4049     ch20:   db      00,00,00,14h;20
                +1  4050     
                +1  4051     ;загр ус для тестов ацп 
                +1  4052     ;dptr-
188D 78B1       +1  4053     lotpus: mov             r0,#vichR
188F B6210D     +1  4054                                     cjne    @r0,#21h,te22
1892 900000   F +1  4055                                     mov                     dptr,#tabt11;заслать ус 11А
1895 E4         +1  4056     lotp:           clr             a
1896 93         +1  4057                             movc    a,@a+dptr                               ;high byte
1897 F584       +1  4058                             mov             p4,a
1899 A3         +1  4059                             inc             dptr
189A E4         +1  4060                             clr             a
189B 93         +1  4061                             movc    a,@a+dptr                               ;low byte
189C F585       +1  4062                             mov             p5,a
189E 22         +1  4063                             ret
189F B62205     +1  4064     te22:                   cjne    @r0,#22h,te23
18A2 900000   F +1  4065                             mov                     dptr,#tabt9;заслать ус 9А       
18A5 80EE       +1  4066                             jmp                     lotp
                +1  4067     
18A7 900000   F +1  4068     te23:   mov                     dptr,#tabt7;заслать ус 7А       
18AA 80E9       +1  4069                             jmp                     lotp
                +1  4070     
                +1  4071     
                +1  4072     
                +1  4073     
                +1  4074     
18AC 02030405   +1  4075     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
18B0 06070809                
18B4 0A0B                    
                +1  4076     
18B6 78AE       +1  4077     findR:                  mov                     r0,#diap
18B8 E6         +1  4078                                                     mov                     a,@r0
18B9 900000   F +1  4079                                                     mov                     dptr,#Tabn
18BC 93         +1  4080                                                     movc            a,@a+dptr
18BD 22         +1  4081                                                     ret
                    4082     
                    4083     ;$include (d:\amp\sarifm3.asm) 
                +1  4084     ; ” ©« SARIFM.ASM 8.11.95
                +1  4085     ;файл арифметики
                +1  4086       
  0008          +1  4087     ltemp    equ       8           ;long temporary
  000C          +1  4088     xtemp    equ       12          ;other temporaries
  000A          +1  4089     DECSIZE  EQU       10
  0004          +1  4090     NUMSIZE  EQU       4
  0004          +1  4091     RR4  EQU       4
  0005          +1  4092     RR5  EQU       5
                +1  4093     
                +1  4094                                                     
                +1  4095     
                +1  4096                 ; rseg     ARIF          ; Switch to this code segment.
                +1  4097     ;             using    0              ; Specify register bank for the following
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    65

                +1  4098                                            ; program code.
                +1  4099     ;                                               cseg AT 400h
                +1  4100     ; Arithmetics:  CLEARING string
                +1  4101     ; Input:
                +1  4102     ; R0 - pointer to string,
                +1  4103     ; NUMSIZE - byte count if CLRNUM used,
                +1  4104     ; DECSIZE - byte count if CLRDEC used,
                +1  4105     ; R2 - byte count if CLEAR used;
                +1  4106     ; Output:  none.
                +1  4107     
18BE            +1  4108     CLRDEC:
18BE 7A0A       +1  4109         MOV R2, #DECSIZE
18C0 8002       +1  4110         SJMP    CLEAR
18C2            +1  4111     CLRNUM:
18C2 7A04       +1  4112         MOV R2, #NUMSIZE
                +1  4113         ;JMP    CLEAR
18C4            +1  4114     CLEAR:
18C4 E4         +1  4115         CLR A
18C5 F6         +1  4116     CLR11:  MOV @R0, A
18C6 08         +1  4117         INC R0
18C7 DAFC       +1  4118         DJNZ    R2, CLR11
18C9 22         +1  4119         RET
                +1  4120     
                +1  4121     ;**********************************
                +1  4122     ;mov    r1,#abin+3
                +1  4123     ;mov    r0,#adec
                +1  4124     ; _ _ _ _
                +1  4125     ;     03ff
                +1  4126     ;ст     мл   - вход
                +1  4127     ; _ _ _ _ _ _ _ _ _ _
                +1  4128     ;             1 0 2 3
                +1  4129     ;ст                мл 
                +1  4130     ;**********************************
                +1  4131     
18CA            +1  4132     BINDEC:
                +1  4133     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  4134     ; Input:
                +1  4135     ; R0 - pointer to destination (high digit is the first),
                +1  4136     ; R1 - pointer to source,
                +1  4137     ; NUMSIZE - byte count in binary number;
                +1  4138     ; DECSIZE - byte count in decimal number;
                +1  4139     ; Output:  none.
                +1  4140     ; Source saved
                +1  4141     
                +1  4142         ; 1. Clear result
18CA 7A05       +1  4143         MOV R2, #DECSIZE/2
18CC 120000   F +1  4144         CALL   CLEAR  ; incrementing R0
                +1  4145     
                +1  4146         ; 2. Prepare convertion
18CF 18         +1  4147         DEC R0
18D0 8804       +1  4148         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
18D2 8905       +1  4149         MOV RR5, R1 ; R5 - pointer to low byte of binary number
18D4 7B20       +1  4150         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  4151     
                +1  4152         ; 3. Convert cyrcle
18D6            +1  4153     BIN30:
                +1  4154     
                +1  4155         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
18D6 A905       +1  4156         MOV R1, RR5
18D8 7A04       +1  4157         MOV R2, #NUMSIZE
18DA E7         +1  4158     BIN31:  MOV A, @R1
18DB 33         +1  4159         RLC A
18DC F7         +1  4160         MOV @R1, A
18DD 19         +1  4161         DEC R1
18DE DAFA       +1  4162         DJNZ    R2, BIN31
18E0 A905       +1  4163         MOV R1, RR5
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    66

18E2 E7         +1  4164         MOV A, @R1
18E3 92E0       +1  4165         MOV ACC.0, C
18E5 F7         +1  4166         MOV @R1, A
                +1  4167     
                +1  4168         ; 3.2. Doubling decimal result with <Carry>
18E6 A804       +1  4169         MOV R0, RR4
18E8 7A05       +1  4170         MOV R2, #DECSIZE/2
18EA E6         +1  4171     BIN32:  MOV A, @R0
18EB 36         +1  4172         ADDC    A, @R0
18EC D4         +1  4173         DA  A
18ED F6         +1  4174         MOV @R0, A
18EE 18         +1  4175         DEC R0
18EF DAF9       +1  4176         DJNZ    R2, BIN32
                +1  4177     
                +1  4178         ; 3.3. End of convert cyrcle
18F1 DBE3       +1  4179         DJNZ    R3, BIN30
                +1  4180     
                +1  4181         ; 4. Make bytes from half-bytes
18F3 E8         +1  4182         MOV A, R0
18F4 240A       +1  4183         ADD A, #DECSIZE
18F6 F8         +1  4184         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
18F7 A904       +1  4185         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
18F9 7A05       +1  4186         MOV R2, #DECSIZE/2
18FB E7         +1  4187     BIN41:  MOV A, @R1
18FC 540F       +1  4188         ANL A, #00FH
18FE F6         +1  4189         MOV @R0, A
18FF 18         +1  4190         DEC R0
1900 E7         +1  4191         MOV A, @R1
1901 C4         +1  4192         SWAP    A
1902 540F       +1  4193         ANL A, #00FH
1904 F6         +1  4194         MOV @R0, A
1905 18         +1  4195         DEC R0
1906 19         +1  4196         DEC R1
1907 DAF2       +1  4197         DJNZ    R2, BIN41
1909 22         +1  4198         RET
                +1  4199     
                +1  4200     
                +1  4201     ;*********************************
                +1  4202     ;mov    r0,#abin
                +1  4203     ;mov    r1,#adec
                +1  4204     ; _ _ _ _       -выход
                +1  4205     ; ff0000
                +1  4206     ;0004
                +1  4207     ;мл      ст
                +1  4208     
                +1  4209     ;ст                       мл
                +1  4210     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  4211     ;                       2 5 5
                +1  4212     ;                   1 0 2 4
                +1  4213     
190A            +1  4214     DECBIN:
                +1  4215     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  4216     ; Input:
                +1  4217     ; R0 - pointer to destination,
                +1  4218     ; R1 - pointer to source (high digit is the first),
                +1  4219     ; NUMSIZE - byte count in binary number;
                +1  4220     ; DECSIZE - byte count in decimal number;
                +1  4221     ; Output:  none
                +1  4222     ; Source cleared
                +1  4223     
                +1  4224         ; 1. Clear result
190A 120000   F +1  4225         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  4226     
                +1  4227         ; 2. Prepare convertion
190D 18         +1  4228         DEC R0
190E 8804       +1  4229         MOV RR4, R0 ; R4 - pointer to high byte of binary result
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    67

1910 8905       +1  4230         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
1912 900000   F +1  4231         MOV DPTR, #DECT2
1915 7B20       +1  4232         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  4233     
                +1  4234         ; 3. Convert cyrcle
1917            +1  4235     DEC30:
                +1  4236     
                +1  4237         ; 3.1. Divide decimal number by 2 and prepare <Carry>
1917 C3         +1  4238         CLR C
1918 A905       +1  4239         MOV R1, RR5
191A 7A0A       +1  4240         MOV R2, #DECSIZE
191C E7         +1  4241     DEC31:  MOV A, @R1
191D 540F       +1  4242         ANL A, #00FH
191F 92E4       +1  4243         MOV ACC.4, C
1921 93         +1  4244         MOVC    A,@A+DPTR
1922 F7         +1  4245         MOV @R1, A
1923 A2E7       +1  4246         MOV C, ACC.7
1925 09         +1  4247         INC R1
1926 DAF4       +1  4248         DJNZ    R2, DEC31
                +1  4249     
                +1  4250         ; 3.2. Rotate binary result one bit to right with <Carry>
1928 A804       +1  4251         MOV R0, RR4
192A 7A04       +1  4252         MOV R2, #NUMSIZE
192C E6         +1  4253     DEC32:  MOV A, @R0
192D 13         +1  4254         RRC A
192E F6         +1  4255         MOV @R0, A
192F 18         +1  4256         DEC R0
1930 DAFA       +1  4257         DJNZ    R2, DEC32
                +1  4258     
                +1  4259         ; 3.3. End of convert cyrcle
1932 DBE3       +1  4260         DJNZ    R3, DEC30
1934 22         +1  4261         RET
                +1  4262     
1935 00800181   +1  4263     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
1939 02820383                
193D 0484                    
193F 00000000   +1  4264         DB  00,00,00,00,00,00
1943 0000                    
1945 05850686   +1  4265         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
1949 07870888                
194D 0989                    
                +1  4266     
                +1  4267     ;   Long comparison
                +1  4268     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  4269     ;   flags and acc set as though a long subtraction was done.
                +1  4270     ;*******************************
                +1  4271     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  4272     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  4273     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  4274     ;*******************************
194F            +1  4275     lcmp:
194F C3         +1  4276         clr c
1950 EA         +1  4277         mov a,r2
1951 9508       +1  4278         subb    a,8
1953 700F       +1  4279         jnz done
1955 EB         +1  4280         mov a,r3
1956 9509       +1  4281         subb    a,9
1958 7008       +1  4282         jnz done1
195A EC         +1  4283         mov a,r4
195B 950A       +1  4284         subb    a,10
195D 7003       +1  4285         jnz done1
195F ED         +1  4286         mov a,r5
1960 950B       +1  4287         subb    a,11
1962            +1  4288     done1:
1962 C2D2       +1  4289         clr ov      ;overflow is significant only for top byte
1964            +1  4290     done:
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    68

1964 22         +1  4291         ret
                +1  4292     
                +1  4293     ;   Load long into r2-5 from [dptr]
                +1  4294     
1965            +1  4295     ldc_long:
1965 E583       +1  4296         mov a,dph       ;is it in on board memory
1967 6010       +1  4297         jz  onboard     ;yes
1969 E4         +1  4298         clr a
196A 93         +1  4299         movc    a,@a+dptr
196B FA         +1  4300         mov r2,a
196C 7401       +1  4301         mov a,#1
196E 93         +1  4302         movc    a,@a+dptr
196F FB         +1  4303         mov r3,a
1970 7402       +1  4304         mov a,#2
1972 93         +1  4305         movc    a,@a+dptr
1973 FC         +1  4306         mov r4,a
1974 7403       +1  4307         mov a,#3
1976 93         +1  4308         movc    a,@a+dptr
1977 FD         +1  4309         mov r5,a
1978 22         +1  4310         ret
1979            +1  4311     onboard:
1979 A882       +1  4312         mov r0,dpl
197B E6         +1  4313         mov a,@r0
197C FA         +1  4314         mov r2,a
197D 08         +1  4315         inc r0
197E E6         +1  4316         mov a,@r0
197F FB         +1  4317         mov r3,a
1980 08         +1  4318         inc r0
1981 E6         +1  4319         mov a,@r0
1982 FC         +1  4320         mov r4,a
1983 08         +1  4321         inc r0
1984 E6         +1  4322         mov a,@r0
1985 FD         +1  4323         mov r5,a
1986 22         +1  4324         ret
                +1  4325     
                +1  4326     ;**************************************
                +1  4327     ;загрузить ltemp...+3 из памяти программ
                +1  4328     ;mov    dptr,#CH5
                +1  4329     ;call   ldc_ltemp        ltemp <--5
                +1  4330     ;**************************************
1987            +1  4331     ldc_ltemp:
1987 E583       +1  4332         mov a,dph       ;is it in on board memory
1989 6014       +1  4333         jz  oboard      ;yes
198B E4         +1  4334         clr a
198C 93         +1  4335         movc    a,@a+dptr
198D F508       +1  4336         mov 8,a
198F 7401       +1  4337         mov a,#1
1991 93         +1  4338         movc    a,@a+dptr
1992 F509       +1  4339         mov 9,a
1994 7402       +1  4340         mov a,#2
1996 93         +1  4341         movc    a,@a+dptr
1997 F50A       +1  4342         mov 10,a
1999 7403       +1  4343         mov a,#3
199B 93         +1  4344         movc    a,@a+dptr
199C F50B       +1  4345         mov 11,a
199E 22         +1  4346         ret
199F            +1  4347     oboard:
199F A882       +1  4348         mov r0,dpl
19A1 8608       +1  4349         mov 8,@r0
19A3 08         +1  4350         inc r0
19A4 8609       +1  4351         mov 9,@r0
19A6 08         +1  4352         inc r0
19A7 860A       +1  4353         mov 10,@r0
19A9 08         +1  4354         inc r0
19AA 860B       +1  4355         mov 11,@r0
19AC 22         +1  4356         ret
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    69

                +1  4357     
                +1  4358     ;*****************************
                +1  4359     ;mov    dptr,#k1
                +1  4360     ;call   ldx_long
                +1  4361     ;k1->r2..r5
                +1  4362     ;*****************************
                +1  4363     ;   Load long into r2-5 from [dptr]
                +1  4364     ;
                +1  4365     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
19AD            +1  4366     ldx_long:
19AD E583       +1  4367         mov a,dph       ;is it in on board memory
19AF 6014       +1  4368         jz  onboar1        ;yes
19B1 C082       +1  4369         push    dpl
19B3 C083       +1  4370         push    dph
19B5 E0         +1  4371         movx    a,@dptr
19B6 FA         +1  4372         mov r2,a
19B7 A3         +1  4373         inc dptr
19B8 E0         +1  4374         movx    a,@dptr
19B9 FB         +1  4375         mov r3,a
19BA A3         +1  4376         inc dptr
19BB E0         +1  4377         movx    a,@dptr
19BC FC         +1  4378         mov r4,a
19BD A3         +1  4379         inc dptr
19BE E0         +1  4380         movx    a,@dptr
19BF FD         +1  4381         mov r5,a
19C0 D083       +1  4382         pop dph
19C2 D082       +1  4383         pop dpl
19C4 22         +1  4384         ret
19C5            +1  4385     onboar1:
19C5 A882       +1  4386         mov r0,dpl
19C7 E6         +1  4387         mov a,@r0
19C8 FA         +1  4388         mov r2,a
19C9 08         +1  4389         inc r0
19CA E6         +1  4390         mov a,@r0
19CB FB         +1  4391         mov r3,a
19CC 08         +1  4392         inc r0
19CD E6         +1  4393         mov a,@r0
19CE FC         +1  4394         mov r4,a
19CF 08         +1  4395         inc r0
19D0 E6         +1  4396         mov a,@r0
19D1 FD         +1  4397         mov r5,a
19D2 22         +1  4398         ret
                +1  4399     
                +1  4400     ;*********************************
                +1  4401     ;mov    dptr,#k2
                +1  4402     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  4403     ;**********************************
19D3            +1  4404     ldx_ltemp:
19D3 E583       +1  4405         mov a,dph       ;is it in on board memory
19D5 6010       +1  4406         jz  oboard1     ;yes
19D7 E0         +1  4407         movx    a,@dptr
19D8 F508       +1  4408         mov 8,a
19DA A3         +1  4409         inc dptr
19DB E0         +1  4410         movx    a,@dptr
19DC F509       +1  4411         mov 9,a
19DE A3         +1  4412         inc dptr
19DF E0         +1  4413         movx    a,@dptr
19E0 F50A       +1  4414         mov 10,a
19E2 A3         +1  4415         inc dptr
19E3 E0         +1  4416         movx    a,@dptr
19E4 F50B       +1  4417         mov 11,a
19E6 22         +1  4418         ret
19E7            +1  4419     oboard1:
19E7 A882       +1  4420         mov r0,dpl
19E9 8608       +1  4421         mov 8,@r0
19EB 08         +1  4422         inc r0
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    70

19EC 8609       +1  4423         mov 9,@r0
19EE 08         +1  4424         inc r0
19EF 860A       +1  4425         mov 10,@r0
19F1 08         +1  4426         inc r0
19F2 860B       +1  4427         mov 11,@r0
19F4 22         +1  4428         ret
                +1  4429     ;   Long division routines for 8051
                +1  4430     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  4431     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  4432     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  4433     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  4434     ;   r1 must be saved by the caller.
                +1  4435     ;   This is long unsigned division.
                +1  4436     
                +1  4437     
                +1  4438     ;   Register usage:
                +1  4439     ;       r0 loop counter
                +1  4440     ;       xtemp (12-15) accumulates quotient
                +1  4441     ;       r5-r2 holds dividend
                +1  4442     ;       ltemp holds divisor
                +1  4443     
                +1  4444     ;************************************
                +1  4445     ;r2..r5-делимое
                +1  4446     ;ltemp..-делитель
                +1  4447     ;частное -r2..r5
                +1  4448     ;*************************************
19F5            +1  4449     divide:
19F5 E4         +1  4450         clr a
19F6 F8         +1  4451         mov r0,a        ;initialize count
19F7 F50C       +1  4452         mov xtemp,a     ;zero quotient
19F9 F50D       +1  4453         mov xtemp+1,a
19FB F50E       +1  4454         mov xtemp+2,a
19FD F50F       +1  4455         mov xtemp+3,a
19FF ED         +1  4456         mov a,r5        ;check for zero dividend
1A00 4C         +1  4457         orl a,r4
1A01 4B         +1  4458         orl a,r3
1A02 4A         +1  4459         orl a,r2
1A03 600B       +1  4460         jz  jfinis
1A05 E508       +1  4461         mov a,ltemp     ;check for zero divisor
1A07 4509       +1  4462         orl a,ltemp+1
1A09 450A       +1  4463         orl a,ltemp+2
1A0B 450B       +1  4464         orl a,ltemp+3
1A0D 7037       +1  4465         jnz midl
1A0F 22         +1  4466         ret
                +1  4467     
1A10 020000   F +1  4468     jfinis: jmp finis
                +1  4469     
1A13            +1  4470     loops:
1A13 EA         +1  4471         mov a,r2
1A14 C3         +1  4472         clr c
1A15 9508       +1  4473         subb    a,ltemp+0   ;is divisor greater than dividend yet
1A17 4033       +1  4474         jc  yes     ;yes, go no further
1A19 7013       +1  4475         jnz no
1A1B EB         +1  4476         mov a,r3
1A1C 9509       +1  4477         subb    a,ltemp+1
1A1E 402C       +1  4478         jc  yes
1A20 700C       +1  4479         jnz no
1A22 EC         +1  4480         mov a,r4
1A23 950A       +1  4481         subb    a,ltemp+2
1A25 4025       +1  4482         jc  yes
1A27 7005       +1  4483         jnz no
1A29 ED         +1  4484         mov a,r5
1A2A 950B       +1  4485         subb    a,ltemp+3
1A2C 401E       +1  4486         jc  yes
1A2E            +1  4487     no:
1A2E E50B       +1  4488         mov a,ltemp+3   ;shift divisor up one bit
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    71

1A30 250B       +1  4489         add a,ltemp+3
1A32 F50B       +1  4490         mov ltemp+3,a
1A34 E50A       +1  4491         mov a,ltemp+2
1A36 350A       +1  4492         addc    a,ltemp+2
1A38 F50A       +1  4493         mov ltemp+2,a
1A3A E509       +1  4494         mov a,ltemp+1
1A3C 3509       +1  4495         addc    a,ltemp+1
1A3E F509       +1  4496         mov ltemp+1,a
1A40 E508       +1  4497         mov a,ltemp+0
1A42 3508       +1  4498         addc    a,ltemp+0
1A44 F508       +1  4499         mov ltemp+0,a
1A46            +1  4500     midl:
1A46 08         +1  4501         inc r0      ;increment count
1A47 E508       +1  4502         mov a,ltemp+0   ;check for safe to shift some more
1A49 30E7C7     +1  4503         jnb acc.7,loops  ;loop if top bit clear
1A4C            +1  4504     yes:
1A4C E508       +1  4505         mov a,ltemp+0
1A4E C3         +1  4506         clr c
1A4F 9A         +1  4507         subb    a,r2        ;can we subtract now?
1A50 401A       +1  4508         jc  dosub       ;yes, go and do it
1A52 7015       +1  4509         jnz nosub
1A54 E509       +1  4510         mov a,ltemp+1
1A56 9B         +1  4511         subb    a,r3
1A57 4013       +1  4512         jc  dosub
1A59 700E       +1  4513         jnz nosub
1A5B E50A       +1  4514         mov a,ltemp+2
1A5D 9C         +1  4515         subb    a,r4
1A5E 400C       +1  4516         jc  dosub
1A60 7007       +1  4517         jnz nosub
1A62 E50B       +1  4518         mov a,ltemp+3
1A64 9D         +1  4519         subb    a,r5
1A65 4005       +1  4520         jc  dosub
1A67 6003       +1  4521         jz  dosub
1A69            +1  4522     nosub:
1A69 C3         +1  4523         clr c
1A6A 8012       +1  4524         sjmp    dosh
1A6C            +1  4525     dosub:
1A6C C3         +1  4526         clr c       ;subtract divisor from dividend
1A6D ED         +1  4527         mov a,r5
1A6E 950B       +1  4528         subb    a,ltemp+3
1A70 FD         +1  4529         mov r5,a
1A71 EC         +1  4530         mov a,r4
1A72 950A       +1  4531         subb    a,ltemp+2
1A74 FC         +1  4532         mov r4,a
1A75 EB         +1  4533         mov a,r3
1A76 9509       +1  4534         subb    a,ltemp+1
1A78 FB         +1  4535         mov r3,a
1A79 EA         +1  4536         mov a,r2
1A7A 9508       +1  4537         subb    a,ltemp+0
1A7C FA         +1  4538         mov r2,a
1A7D D3         +1  4539         setb    c       ;now set bit for quotient
1A7E            +1  4540     dosh:
1A7E E50F       +1  4541         mov a,xtemp+3
1A80 33         +1  4542         rlc a
1A81 F50F       +1  4543         mov xtemp+3,a
1A83 E50E       +1  4544         mov a,xtemp+2
1A85 33         +1  4545         rlc a
1A86 F50E       +1  4546         mov xtemp+2,a
1A88 E50D       +1  4547         mov a,xtemp+1
1A8A 33         +1  4548         rlc a
1A8B F50D       +1  4549         mov xtemp+1,a
1A8D E50C       +1  4550         mov a,xtemp+0
1A8F 33         +1  4551         rlc a
1A90 F50C       +1  4552         mov xtemp+0,a
1A92 E508       +1  4553         mov a,ltemp+0       ;shift divisor down
1A94 C3         +1  4554         clr c
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    72

1A95 13         +1  4555         rrc a
1A96 F508       +1  4556         mov ltemp+0,a
1A98 E509       +1  4557         mov a,ltemp+1
1A9A 13         +1  4558         rrc a
1A9B F509       +1  4559         mov ltemp+1,a
1A9D E50A       +1  4560         mov a,ltemp+2
1A9F 13         +1  4561         rrc a
1AA0 F50A       +1  4562         mov ltemp+2,a
1AA2 E50B       +1  4563         mov a,ltemp+3
1AA4 13         +1  4564         rrc a
1AA5 F50B       +1  4565         mov ltemp+3,a
                +1  4566     
1AA7 D8A3       +1  4567         djnz    r0,yes      ;and continue with the rest
                +1  4568     
1AA9            +1  4569     finis:
1AA9 8D0B       +1  4570         mov ltemp+3,r5
1AAB 8C0A       +1  4571         mov ltemp+2,r4
1AAD 8B09       +1  4572         mov ltemp+1,r3
1AAF 8A08       +1  4573         mov ltemp+0,r2
1AB1 AD0F       +1  4574         mov r5,xtemp+3
1AB3 AC0E       +1  4575         mov r4,xtemp+2
1AB5 AB0D       +1  4576         mov r3,xtemp+1
1AB7 AA0C       +1  4577         mov r2,xtemp+0
1AB9 22         +1  4578         ret         ;and return with the satisfaction of a job well done
                +1  4579     
                +1  4580     
                +1  4581     ;   Long multiplication
                +1  4582     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  4583     ;   other in ltemp. It really doesn't matter which one is where.
                +1  4584     
                +1  4585     ;**********************************
                +1  4586     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  4587     ;ст  мл
                +1  4588     ;**********************************
1ABA            +1  4589     llmul:
1ABA            +1  4590     almul:
1ABA            +1  4591     lmul:
1ABA ED         +1  4592         mov a,r5        ;low order byte
1ABB 850BF0     +1  4593         mov b,ltemp+3       ;times low order byte
1ABE A4         +1  4594         mul ab
1ABF F50F       +1  4595         mov xtemp+3,a       ;store low
1AC1 85F00E     +1  4596         mov xtemp+2,b   ;and high
1AC4 ED         +1  4597         mov a,r5        ;low order
1AC5 850AF0     +1  4598         mov b,ltemp+2   ;times next
1AC8 A4         +1  4599         mul ab
1AC9 250E       +1  4600         add a,xtemp+2   ;add in
1ACB F50E       +1  4601         mov xtemp+2,a
1ACD E5F0       +1  4602         mov a,b
1ACF 3400       +1  4603         addc    a,#0
1AD1 F50D       +1  4604         mov xtemp+1,a
1AD3 ED         +1  4605         mov a,r5
1AD4 8509F0     +1  4606         mov b,ltemp+1
1AD7 A4         +1  4607         mul ab
1AD8 250D       +1  4608         add a,xtemp+1
1ADA F50D       +1  4609         mov xtemp+1,a
1ADC E5F0       +1  4610         mov a,b
1ADE 3400       +1  4611         addc    a,#0
1AE0 F50C       +1  4612         mov xtemp+0,a
1AE2 ED         +1  4613         mov a,r5
1AE3 8508F0     +1  4614         mov b,ltemp+0
1AE6 A4         +1  4615         mul ab
1AE7 250C       +1  4616         add a,xtemp+0
1AE9 F50C       +1  4617         mov xtemp+0,a
1AEB EC         +1  4618         mov a,r4
1AEC 850BF0     +1  4619         mov b,ltemp+3
1AEF A4         +1  4620         mul ab
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    73

1AF0 250E       +1  4621         add a,xtemp+2
1AF2 F50E       +1  4622         mov xtemp+2,a
1AF4 E5F0       +1  4623         mov a,b
1AF6 350D       +1  4624         addc    a,xtemp+1
1AF8 F50D       +1  4625         mov xtemp+1,a
1AFA E50C       +1  4626         mov a,xtemp+0
1AFC 3400       +1  4627         addc    a,#0
1AFE F50C       +1  4628         mov xtemp+0,a
1B00 EC         +1  4629         mov a,r4
1B01 850AF0     +1  4630         mov b,ltemp+2
1B04 A4         +1  4631         mul ab
1B05 250D       +1  4632         add a,xtemp+1
1B07 F50D       +1  4633         mov xtemp+1,a
1B09 E5F0       +1  4634         mov a,b
1B0B 350C       +1  4635         addc    a,xtemp+0
1B0D F50C       +1  4636         mov xtemp+0,a
1B0F EC         +1  4637         mov a,r4
1B10 8509F0     +1  4638         mov b,ltemp+1
1B13 A4         +1  4639         mul ab
1B14 250C       +1  4640         add a,xtemp+0
1B16 F50C       +1  4641         mov xtemp+0,a
                +1  4642     
1B18 EB         +1  4643         mov a,r3
1B19 850BF0     +1  4644         mov b,ltemp+3
1B1C A4         +1  4645         mul ab
1B1D 250D       +1  4646         add a,xtemp+1
1B1F F50D       +1  4647         mov xtemp+1,a
1B21 E5F0       +1  4648         mov a,b
1B23 350C       +1  4649         addc    a,xtemp+0
1B25 F50C       +1  4650         mov xtemp+0,a
1B27 EB         +1  4651         mov a,r3
1B28 850AF0     +1  4652         mov b,ltemp+2
1B2B A4         +1  4653         mul ab
1B2C 250C       +1  4654         add a,xtemp+0
1B2E F50C       +1  4655         mov xtemp+0,a
                +1  4656     
1B30 EA         +1  4657         mov a,r2
1B31 850BF0     +1  4658         mov b,ltemp+3
1B34 A4         +1  4659         mul ab
1B35 250C       +1  4660         add a,xtemp+0
1B37 FA         +1  4661         mov r2,a
1B38 AB0D       +1  4662         mov r3,xtemp+1
1B3A AC0E       +1  4663         mov r4,xtemp+2
1B3C AD0F       +1  4664         mov r5,xtemp+3
                +1  4665     
1B3E 22         +1  4666         ret         ;all done
                +1  4667     ;******************************
                +1  4668     ;из содержимого  r2-r5  вычесть
                +1  4669     ;содержимое          ltemp..ltemp+3
                +1  4670     ;******************************
1B3F            +1  4671     llsub:
1B3F            +1  4672      lsub:
1B3F ED         +1  4673         mov a,r5
1B40 C3         +1  4674         clr c
1B41 950B       +1  4675         subb    a,11
1B43 FD         +1  4676         mov r5,a
1B44 EC         +1  4677         mov a,r4
1B45 950A       +1  4678         subb    a,10
1B47 FC         +1  4679         mov r4,a
1B48 EB         +1  4680         mov a,r3
1B49 9509       +1  4681         subb    a,9
1B4B FB         +1  4682         mov r3,a
1B4C EA         +1  4683         mov a,r2
1B4D 9508       +1  4684         subb    a,8
1B4F FA         +1  4685         mov r2,a
1B50 22         +1  4686         ret
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    74

                +1  4687     
                +1  4688     ;***********************************************
                +1  4689     ;                                                      ст мл
                +1  4690     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4691     ;  r0- адрес младшего байта !!!
                +1  4692     ;результат- r2..r5
                +1  4693     ;***********************************************
                +1  4694     
1B51 C3         +1  4695     ladd:    clr       c
1B52 ED         +1  4696          mov       a,r5
1B53 26         +1  4697          add       a,@r0
1B54 FD         +1  4698          mov       r5,a
1B55 18         +1  4699          dec       r0
1B56 EC         +1  4700          mov       a,r4
1B57 36         +1  4701          addc      a,@r0
1B58 FC         +1  4702          mov       r4,a
1B59 18         +1  4703          dec       r0
1B5A EB         +1  4704          mov       a,r3
1B5B 36         +1  4705          addc      a,@r0
1B5C FB         +1  4706          mov       r3,a
1B5D 18         +1  4707          dec       r0
1B5E EA         +1  4708          mov       a,r2
1B5F 36         +1  4709          addc      a,@r0
1B60 FA         +1  4710          mov       r2,a
1B61 22         +1  4711          ret
                +1  4712     ;***********************************************
                +1  4713     ;                                                      ст мл
                +1  4714     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4715     ;  r0- адрес младшего байта !!!
                +1  4716     ;результат- r2..r5
                +1  4717     ;***********************************************
                +1  4718     
1B62 C3         +1  4719     laddx:    clr       c
1B63 E2         +1  4720                                             movx            a,@r0
1B64 2D         +1  4721                                             add                     a,r5
1B65 FD         +1  4722               mov     r5,a
1B66 18         +1  4723                             dec     r0
1B67 E2         +1  4724                             movx    a,@r0
1B68 3C         +1  4725                             addc    a,r4
1B69 FC         +1  4726                             mov     r4,a
1B6A 18         +1  4727                             dec     r0
1B6B E2         +1  4728                             movx    a,@r0
1B6C 3B         +1  4729                             addc    a,r3
1B6D FB         +1  4730                             mov     r3,a
1B6E 18         +1  4731                             dec     r0
1B6F E2         +1  4732                             movx    a,@r0
1B70 3A         +1  4733                             addc    a,r2
1B71 FA         +1  4734                             mov       r2,a
1B72 22         +1  4735                             ret
                +1  4736     
                +1  4737     ;***********************************************
                +1  4738     ;                                                      ст мл
                +1  4739     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4740     ;  dptr- адрес младшего байта !!!
                +1  4741     ;результат- r2..r5
                +1  4742     ;***********************************************
                +1  4743     
1B73 C3         +1  4744     addx:    clr       c
1B74 E0         +1  4745                                             movx            a,@dptr
1B75 2D         +1  4746                                             add                     a,r5
1B76 FD         +1  4747               mov     r5,a
1B77 120000   F +1  4748                             call            dedptr;dec     dptr
1B7A E0         +1  4749                             movx    a,@dptr
1B7B 3C         +1  4750                             addc    a,r4
1B7C FC         +1  4751                             mov     r4,a
1B7D 120000   F +1  4752                             call            dedptr;dec     dptr
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    75

1B80 E0         +1  4753                             movx    a,@dptr
1B81 3B         +1  4754                             addc    a,r3
1B82 FB         +1  4755                             mov     r3,a
1B83 120000   F +1  4756                             call            dedptr;dec     dptr
1B86 E0         +1  4757                             movx    a,@dptr
1B87 3A         +1  4758                             addc    a,r2
1B88 FA         +1  4759                             mov       r2,a
1B89 22         +1  4760                             ret
                +1  4761     
1B8A C0D0       +1  4762     dedptr:         push    psw
1B8C C3         +1  4763                                             clr             c
1B8D E582       +1  4764                                             mov             a,dpl
1B8F 9401       +1  4765                                             subb    a,#1
1B91 F582       +1  4766                                             mov             dpl,a
1B93 E583       +1  4767                                             mov             a,dph
1B95 9400       +1  4768                                             subb    a,#0
1B97 F583       +1  4769                                             mov             dph,a
1B99 D0D0       +1  4770                                             pop             psw
1B9B 22         +1  4771                                             ret
                    4772     
                    4773     ;$include (d:\amp\floatm.asm)
                +1  4774     ;       Copyright (C) 1988 HI-TECH Software
                +1  4775     
                +1  4776     ;       Single Precision Floating point arithmetic routines for 8051
                +1  4777     
                +1  4778     ;       The format of floating point numbers is as follows:
                +1  4779     
                +1  4780     ;       -----------------
                +1  4781     ;       *     sign      *  1 bit
                +1  4782     ;       -----------------
                +1  4783     ;       *   exponent    *  8 bits
                +1  4784     ;       -----------------
                +1  4785     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  4786     ;       -----------------
                +1  4787     
                +1  4788     
                +1  4789     ;       As usual for the 8051 the memory layout has the most significant
                +1  4790     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  4791     ;       lowest address.
                +1  4792     
                +1  4793     ;       Calling conventions:
                +1  4794     
                +1  4795     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  4796     ;
                +1  4797     ;       Return value is in r2-r5
                +1  4798     
                +1  4799     ;       Naming conventions: A routine name is constructed by
                +1  4800     
                +1  4801     ;             ASOP
                +1  4802     
                +1  4803     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  4804     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  4805     ;       Conversion routines are named
                +1  4806     
                +1  4807     ;               AStof
                +1  4808     
                +1  4809     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  4810     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  4811     ;       Conversion from float to integer is ftol.
                +1  4812     
                +1  4813     ;               .ORG  5000h
                +1  4814     ;               .CODE
                +1  4815     ;       seg     c_text
                +1  4816     
                +1  4817     ;;      $MOD812
----            +1  4818             CSEG
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    76

                +1  4819             ;ORG 1000h
                +1  4820     
                +1  4821                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  4822             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  4823     
                +1  4824     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  4825     ;       macros
                +1  4826     
                +1  4827     saveregs        macro
                +1  4828             push    7
                +1  4829             push    6
                +1  4830             push    1
                +1  4831             push    0
                +1  4832             endm
                +1  4833     
                +1  4834     restregs        macro
                +1  4835             pop     0
                +1  4836             pop     1
                +1  4837             pop     6
                +1  4838             pop     7
                +1  4839             endm
                +1  4840     
                +1  4841     ;addr   
                +1  4842     dan     macro   pad
                +1  4843             mov     a,r5
                +1  4844             add     a,pad+3
                +1  4845             mov     pad+3,a
                +1  4846             mov     a,pad+2
                +1  4847             addc    a,r4
                +1  4848             mov     pad+2,a
                +1  4849             mov     a,pad+1
                +1  4850             addc    a,r3
                +1  4851             mov     pad+1,a
                +1  4852             mov     a,pad+0
                +1  4853             addc    a,r2
                +1  4854             mov     pad,a
                +1  4855             endm
                +1  4856     
                +1  4857     addl    macro  addr
                +1  4858             mov     a,r5
                +1  4859             add     a,addr+3
                +1  4860             mov     r5,a
                +1  4861             mov     a,addr+2
                +1  4862             addc    a,r4
                +1  4863             mov     r4,a
                +1  4864             mov     a,addr+1
                +1  4865             addc    a,r3
                +1  4866             mov     r3,a
                +1  4867             mov     a,addr+0
                +1  4868             addc    a,r2
                +1  4869             mov     r2,a
                +1  4870             endm
                +1  4871     
                +1  4872     
                +1  4873     add1    macro
                +1  4874             mov     a,r5
                +1  4875             add     a,#1
                +1  4876             mov     r5,a
                +1  4877             clr     a
                +1  4878             addc    a,r4
                +1  4879             mov     r4,a
                +1  4880             clr     a
                +1  4881             addc    a,r3
                +1  4882             mov     r3,a
                +1  4883             clr     a
                +1  4884             addc    a,r2
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    77

                +1  4885             mov     r2,a
                +1  4886             endm
                +1  4887     
                +1  4888     shfdn   macro  addr
                +1  4889             clr     c
                +1  4890             mov     a,addr
                +1  4891             rrc     a
                +1  4892             mov     addr,a
                +1  4893             mov     a,addr+1
                +1  4894             rrc     a
                +1  4895             mov     addr+1,a
                +1  4896             mov     a,addr+2
                +1  4897             rrc     a
                +1  4898             mov     addr+2,a
                +1  4899             mov     a,addr+3
                +1  4900             rrc     a
                +1  4901             mov     addr+3,a
                +1  4902             endm
                +1  4903     
                +1  4904     shfup   macro  addr
                +1  4905             clr     c
                +1  4906             mov     a,addr+3
                +1  4907             rlc     a
                +1  4908             mov     addr+3,a
                +1  4909             mov     a,addr+2
                +1  4910             rlc     a
                +1  4911             mov     addr+2,a
                +1  4912             mov     a,addr+1
                +1  4913             rlc     a
                +1  4914             mov     addr+1,a
                +1  4915             mov     a,addr
                +1  4916             rlc     a
                +1  4917             mov     addr,a
                +1  4918             endm
                +1  4919     
                +1  4920     rshift  macro
                +1  4921             clr     c
                +1  4922             mov     a,r2
                +1  4923             rrc     a
                +1  4924             mov     r2,a
                +1  4925             mov     a,r3
                +1  4926             rrc     a
                +1  4927             mov     r3,a
                +1  4928             mov     a,r4
                +1  4929             rrc     a
                +1  4930             mov     r4,a
                +1  4931             mov     a,r5
                +1  4932             rrc     a
                +1  4933             mov     r5,a
                +1  4934             endm
                +1  4935     rshift1 macro
                +1  4936             setb    c
                +1  4937             mov     a,r2
                +1  4938             rrc     a
                +1  4939             mov     r2,a
                +1  4940             mov     a,r3
                +1  4941             rrc     a
                +1  4942             mov     r3,a
                +1  4943             mov     a,r4
                +1  4944             rrc     a
                +1  4945             mov     r4,a
                +1  4946             mov     a,r5
                +1  4947             rrc     a
                +1  4948             mov     r5,a
                +1  4949             endm
                +1  4950     
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    78

                +1  4951     
                +1  4952     lshift  macro
                +1  4953             mov     a,r5
                +1  4954             rlc     a
                +1  4955             mov     r5,a
                +1  4956             mov     a,r4
                +1  4957             rlc     a
                +1  4958             mov     r4,a
                +1  4959             mov     a,r3
                +1  4960             rlc     a
                +1  4961             mov     r3,a
                +1  4962             mov     a,r2
                +1  4963             rlc     a
                +1  4964             mov     r2,a
                +1  4965             endm
                +1  4966     
                +1  4967     neg1    macro
                +1  4968             clr     c
                +1  4969             clr     a
                +1  4970             subb    a,r5
                +1  4971             mov     r5,a
                +1  4972             clr     a
                +1  4973             subb    a,r4
                +1  4974             mov     r4,a
                +1  4975             clr     a
                +1  4976             subb    a,r3
                +1  4977             mov     r3,a
                +1  4978             clr     a
                +1  4979             subb    a,r2
                +1  4980             mov     r2,a
                +1  4981             endm
                +1  4982     
                +1  4983     negm    macro  addr
                +1  4984             clr     c
                +1  4985             clr     a
                +1  4986             subb    a,addr+3
                +1  4987             mov     addr+3,a
                +1  4988             clr     a
                +1  4989             subb    a,addr+2
                +1  4990             mov     addr+2,a
                +1  4991             clr     a
                +1  4992             subb    a,addr+1
                +1  4993             mov     addr+1,a
                +1  4994             clr     a
                +1  4995             subb    a,addr
                +1  4996             mov     addr,a
                +1  4997             endm
                +1  4998     
                +1  4999     copytor macro  addr
                +1  5000             mov     r2,addr
                +1  5001             mov     r3,addr+1
                +1  5002             mov     r4,addr+2
                +1  5003             mov     r5,addr+3
                +1  5004             endm
                +1  5005     
                +1  5006     
                +1  5007     copyrto macro  addr
                +1  5008             mov     addr,r2
                +1  5009             mov     addr+1,r3
                +1  5010             mov     addr+2,r4
                +1  5011             mov     addr+3,r5
                +1  5012             endm
                +1  5013     
                +1  5014     
                +1  5015     ;       Internal representation: in this set of routines a floating number
                +1  5016     ;       is unpacked into seperate mantissa, exponent and sign parts.
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    79

                +1  5017     
                +1  5018     ;       Stack offset values
                +1  5019     ;ltemp   equ     28h
                +1  5020     
  0006          +1  5021     cntr    equ     6               ;r6 is the counter
  0007          +1  5022     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  5023     exp1    equ     0               ;exponent 1 in r0
  0002          +1  5024     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  5025     exp2    equ     1               ;exponent 1 in r1
  0008          +1  5026     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  5027     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  5028     
                +1  5029     
                +1  5030     
                +1  5031     
                +1  5032     
                +1  5033     ;DECSIZE EQU     10
                +1  5034     ;NUMSIZE EQU     4
                +1  5035     ;RR4     EQU     4
                +1  5036     ;RR5     EQU     5
                +1  5037     
                +1  5038     ;       unpack1 - unpacks the left operand
                +1  5039     
009E            +1  5040     unpack1:
009E EA         +1  5041             mov     a,r2            ;get sign
009F 5480       +1  5042             anl     a,#80h
00A1 530740     +1  5043             anl     sign,#40h       ;clear other bits
00A4 4207       +1  5044             orl     sign,a          ;store sign
00A6 EB         +1  5045             mov     a,r3            ;get lsb of exponent
00A7 33         +1  5046             rlc     a               ;rotate into carry
00A8 EA         +1  5047             mov     a,r2            ;get rest of exponent
00A9 33         +1  5048             rlc     a               ;and make it 8 bits
00AA F8         +1  5049             mov     r0,a            ;store it
00AB 6006       +1  5050             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  5051             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  5052             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  5053             ret
00B3            +1  5054     zer1:
00B3 E4         +1  5055             clr     a
00B4 FA         +1  5056             mov     r2,a
00B5 FB         +1  5057             mov     r3,a
00B6 FC         +1  5058             mov     r4,a
00B7 FD         +1  5059             mov     r5,a            ;zero mantissa
00B8 F8         +1  5060             mov     r0,a            ;zero exponent
00B9 22         +1  5061             ret
                +1  5062     
                +1  5063     ;       unpack2 - unpacks right operand
                +1  5064     
00BA            +1  5065     unpack2:
00BA E508       +1  5066             mov     a,ltemp         ;get sign
00BC 13         +1  5067             rrc     a               ;shift down
00BD 5440       +1  5068             anl     a,#40h          ;mask out sign
00BF 530780     +1  5069             anl     sign,#80h       ;clear old bit
00C2 4207       +1  5070             orl     sign,a
00C4 E509       +1  5071             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  5072             rlc     a               ;rotate into carry
00C7 E508       +1  5073             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  5074             rlc     a               ;and make it 8 bits
00CA F9         +1  5075             mov     r1,a            ;store it
00CB 6007       +1  5076             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  5077             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  5078             mov     mant2,#0        ;clear upper byte
00D3 22         +1  5079             ret
00D4            +1  5080     zer2:
00D4 E4         +1  5081             clr     a
00D5 F508       +1  5082             mov     ltemp,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    80

00D7 F509       +1  5083             mov     ltemp+1,a
00D9 F50A       +1  5084             mov     ltemp+2,a
00DB F50B       +1  5085             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  5086             ret
                +1  5087     
                +1  5088     ;       pack1 - put operand 1 back into float format
                +1  5089     
00DE            +1  5090     pack1:
00DE E8         +1  5091             mov     a,r0            ;get exponent
00DF C3         +1  5092             clr     c
00E0 13         +1  5093             rrc     a               ;shift down 1 bit
00E1 530780     +1  5094             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  5095             orl     a,r7            ;or in sign bit
00E5 FA         +1  5096             mov     r2,a            ;store
00E6 E8         +1  5097             mov     a,r0            ;get other bit
00E7 03         +1  5098             rr      a               ;rotate into hi bit
00E8 5480       +1  5099             anl     a,#80h          ;mask
00EA 53037F     +1  5100             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  5101             orl     mant1+1,a       ;put in
00EF 22         +1  5102             ret
                +1  5103     
                +1  5104     
                +1  5105     ;       norm1 - normalize the unpacked value in 1
                +1  5106     
00F0            +1  5107     norm1:
00F0 E8         +1  5108             mov     a,r0            ;get exponent
00F1 60C0       +1  5109             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  5110             mov     a,r2            ;get hi byte
00F4 6023       +1  5111             jz      norup           ;zero, so shift up if anything
00F6            +1  5112     nordn:
00F6 EA         +1  5113             mov     a,r2            ;get hi byte
00F7 B4010D     +1  5114             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  5115+3           add1                    ;add in a rounding bit
00FA ED         +1  5116+1           mov     a,r5
00FB 2401       +1  5117+1           add     a,#1
00FD FD         +1  5118+1           mov     r5,a
00FE E4         +1  5119+1           clr     a
00FF 3C         +1  5120+1           addc    a,r4
0100 FC         +1  5121+1           mov     r4,a
0101 E4         +1  5122+1           clr     a
0102 3B         +1  5123+1           addc    a,r3
0103 FB         +1  5124+1           mov     r3,a
0104 E4         +1  5125+1           clr     a
0105 3A         +1  5126+1           addc    a,r2
0106 FA         +1  5127+1           mov     r2,a
0107            +1  5128     nordn1:
                +1  5129+3           rshift                  ;shift down 1 bit
0107 C3         +1  5130+1           clr     c
0108 EA         +1  5131+1           mov     a,r2
0109 13         +1  5132+1           rrc     a
010A FA         +1  5133+1           mov     r2,a
010B EB         +1  5134+1           mov     a,r3
010C 13         +1  5135+1           rrc     a
010D FB         +1  5136+1           mov     r3,a
010E EC         +1  5137+1           mov     a,r4
010F 13         +1  5138+1           rrc     a
0110 FC         +1  5139+1           mov     r4,a
0111 ED         +1  5140+1           mov     a,r5
0112 13         +1  5141+1           rrc     a
0113 FD         +1  5142+1           mov     r5,a
0114 08         +1  5143             inc     r0              ;adjust exponent
0115 EA         +1  5144             mov     a,r2            ;test high byte
0116 70DE       +1  5145             jnz     nordn           ;loop
0118 22         +1  5146             ret                     ;done
                +1  5147     
0119            +1  5148     norup:
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    81

0119 4B         +1  5149             orl     a,r3
011A 4C         +1  5150             orl     a,r4
011B 4D         +1  5151             orl     a,r5            ;test for zero mantissa
011C 6095       +1  5152             jz      zer1            ;it is - make it true zero
011E            +1  5153     norup1:
011E EB         +1  5154             mov     a,r3            ;get mantissa byte
011F 20E710     +1  5155             jb      acc.7,norup2    ;jump if set
0122 C3         +1  5156             clr     c
                +1  5157+3           lshift                  ;shift mantissa up
0123 ED         +1  5158+1           mov     a,r5
0124 33         +1  5159+1           rlc     a
0125 FD         +1  5160+1           mov     r5,a
0126 EC         +1  5161+1           mov     a,r4
0127 33         +1  5162+1           rlc     a
0128 FC         +1  5163+1           mov     r4,a
0129 EB         +1  5164+1           mov     a,r3
012A 33         +1  5165+1           rlc     a
012B FB         +1  5166+1           mov     r3,a
012C EA         +1  5167+1           mov     a,r2
012D 33         +1  5168+1           rlc     a
012E FA         +1  5169+1           mov     r2,a
012F 18         +1  5170             dec     r0              ;adjust exponent
0130 80EC       +1  5171             jmp     norup1
0132            +1  5172     norup2:
0132 22         +1  5173             ret                     ;finito
                +1  5174     
                +1  5175     
                +1  5176     ;       fpdenorm - denormalize one of the two operands so that their
                +1  5177     ;       exponents are equal. This requires the smaller number to have
                +1  5178     ;       its exponent incremented and its mantissa shifted right.
                +1  5179     
0133            +1  5180     denorm:
0133 E8         +1  5181             mov     a,r0
0134 C3         +1  5182             clr     c
0135 99         +1  5183             subb    a,r1            ;compare exponents
0136 5029       +1  5184             jnc     up2a            ;shift operand 2
0138            +1  5185     up1:
0138 08         +1  5186             inc     r0              ;increment exponent
                +1  5187+3           rshift                  ;shift mantissa down
0139 C3         +1  5188+1           clr     c
013A EA         +1  5189+1           mov     a,r2
013B 13         +1  5190+1           rrc     a
013C FA         +1  5191+1           mov     r2,a
013D EB         +1  5192+1           mov     a,r3
013E 13         +1  5193+1           rrc     a
013F FB         +1  5194+1           mov     r3,a
0140 EC         +1  5195+1           mov     a,r4
0141 13         +1  5196+1           rrc     a
0142 FC         +1  5197+1           mov     r4,a
0143 ED         +1  5198+1           mov     a,r5
0144 13         +1  5199+1           rrc     a
0145 FD         +1  5200+1           mov     r5,a
0146 E8         +1  5201             mov     a,r0
0147 B501EE     +1  5202             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  5203             ret
                +1  5204     
014B            +1  5205     up2:
014B 09         +1  5206             inc     r1              ;increment exponent 2
                +1  5207+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  5208+1           clr     c
014D E508       +1  5209+1           mov     a,mant2
014F 13         +1  5210+1           rrc     a
0150 F508       +1  5211+1           mov     mant2,a
0152 E509       +1  5212+1           mov     a,mant2+1
0154 13         +1  5213+1           rrc     a
0155 F509       +1  5214+1           mov     mant2+1,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    82

0157 E50A       +1  5215+1           mov     a,mant2+2
0159 13         +1  5216+1           rrc     a
015A F50A       +1  5217+1           mov     mant2+2,a
015C E50B       +1  5218+1           mov     a,mant2+3
015E 13         +1  5219+1           rrc     a
015F F50B       +1  5220+1           mov     mant2+3,a
0161            +1  5221     up2a:
0161 E8         +1  5222             mov     a,r0            ;compare exponents
0162 B501E6     +1  5223             cjne    a,exp2,up2
0165 22         +1  5224             ret                     ;all done
                +1  5225     ;------------------------------------------------------------------
                +1  5226     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  5227     
0166            +1  5228     fladd:
                +1  5229+3           saveregs
0166 C007       +1  5230+1           push    7
0168 C006       +1  5231+1           push    6
016A C001       +1  5232+1           push    1
016C C000       +1  5233+1           push    0
016E 119E       +1  5234             call    unpack1
0170 11BA       +1  5235             call    unpack2
0172 3133       +1  5236             call    denorm
0174 E507       +1  5237             mov     a,sign
0176 30E70D     +1  5238             jnb     acc.7,ok1       ;test left sign
                +1  5239+3           neg1                    ;negate op1
0179 C3         +1  5240+1           clr     c
017A E4         +1  5241+1           clr     a
017B 9D         +1  5242+1           subb    a,r5
017C FD         +1  5243+1           mov     r5,a
017D E4         +1  5244+1           clr     a
017E 9C         +1  5245+1           subb    a,r4
017F FC         +1  5246+1           mov     r4,a
0180 E4         +1  5247+1           clr     a
0181 9B         +1  5248+1           subb    a,r3
0182 FB         +1  5249+1           mov     r3,a
0183 E4         +1  5250+1           clr     a
0184 9A         +1  5251+1           subb    a,r2
0185 FA         +1  5252+1           mov     r2,a
0186            +1  5253     ok1:
0186 E507       +1  5254             mov     a,sign
0188 30E615     +1  5255             jnb     acc.6,ok2       ;test right sign
                +1  5256+3           negm    mant2           ;negate op2
018B C3         +1  5257+1           clr     c
018C E4         +1  5258+1           clr     a
018D 950B       +1  5259+1           subb    a,mant2+3
018F F50B       +1  5260+1           mov     mant2+3,a
0191 E4         +1  5261+1           clr     a
0192 950A       +1  5262+1           subb    a,mant2+2
0194 F50A       +1  5263+1           mov     mant2+2,a
0196 E4         +1  5264+1           clr     a
0197 9509       +1  5265+1           subb    a,mant2+1
0199 F509       +1  5266+1           mov     mant2+1,a
019B E4         +1  5267+1           clr     a
019C 9508       +1  5268+1           subb    a,mant2
019E F508       +1  5269+1           mov     mant2,a
01A0            +1  5270     ok2:
                +1  5271+3           addl    mant2           ;add mantissas
01A0 ED         +1  5272+1           mov     a,r5
01A1 250B       +1  5273+1           add     a,mant2+3
01A3 FD         +1  5274+1           mov     r5,a
01A4 E50A       +1  5275+1           mov     a,mant2+2
01A6 3C         +1  5276+1           addc    a,r4
01A7 FC         +1  5277+1           mov     r4,a
01A8 E509       +1  5278+1           mov     a,mant2+1
01AA 3B         +1  5279+1           addc    a,r3
01AB FB         +1  5280+1           mov     r3,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    83

01AC E508       +1  5281+1           mov     a,mant2+0
01AE 3A         +1  5282+1           addc    a,r2
01AF FA         +1  5283+1           mov     r2,a
01B0 E4         +1  5284             clr     a
01B1 FF         +1  5285             mov     r7,a            ;clear sign
01B2 EA         +1  5286             mov     a,r2            ;get sign of result
01B3 30E70E     +1  5287             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  5288             mov     r7,a            ;store sign
                +1  5289+3           neg1                    ;negate mantissa
01B7 C3         +1  5290+1           clr     c
01B8 E4         +1  5291+1           clr     a
01B9 9D         +1  5292+1           subb    a,r5
01BA FD         +1  5293+1           mov     r5,a
01BB E4         +1  5294+1           clr     a
01BC 9C         +1  5295+1           subb    a,r4
01BD FC         +1  5296+1           mov     r4,a
01BE E4         +1  5297+1           clr     a
01BF 9B         +1  5298+1           subb    a,r3
01C0 FB         +1  5299+1           mov     r3,a
01C1 E4         +1  5300+1           clr     a
01C2 9A         +1  5301+1           subb    a,r2
01C3 FA         +1  5302+1           mov     r2,a
01C4            +1  5303     ok3:
01C4 11F0       +1  5304             call    norm1
01C6 11DE       +1  5305             call    pack1           ;pack normalized result
                +1  5306+3           restregs                ;and return
01C8 D000       +1  5307+1           pop     0
01CA D001       +1  5308+1           pop     1
01CC D006       +1  5309+1           pop     6
01CE D007       +1  5310+1           pop     7
01D0 22         +1  5311             ret
                +1  5312     ;-------------------------------------------------------------
                +1  5313     ;       Subtract the number ltemp from the number in r2-r5
                +1  5314     
01D1            +1  5315     flsub:
01D1 630880     +1  5316             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  5317             jmp     fladd           ;and add!
                +1  5318     
                +1  5319     ;================================================================
                +1  5320     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  5321     
01D6            +1  5322     flcmp:
01D6 EA         +1  5323            mov     a,r2            ;get sign of left
01D7 6508       +1  5324            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  5325            jnb     acc.7,cexp      ;same, go check exponent
                +1  5326     ;ifdef SMALL_MODEL
01DC EA         +1  5327             mov     a,r2            ;get sign of left again
01DD 33         +1  5328             rlc     a
01DE 5001       +1  5329             jnc     flout
                +1  5330     ;endif
01E0 D3         +1  5331             setb    c
01E1 22         +1  5332     flout:          ret                    ;return with acc < 0
                +1  5333     
01E2            +1  5334     cexp:
01E2 C3         +1  5335            clr     c
01E3 EA         +1  5336            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  5337            subb    a,ltemp
01E6 7010       +1  5338            jnz     fnd
01E8 EB         +1  5339            mov     a,r3
01E9 9509       +1  5340            subb    a,ltemp+1
01EB 700B       +1  5341            jnz     fnd
01ED EC         +1  5342            mov     a,r4
01EE 950A       +1  5343            subb    a,ltemp+2
01F0 7006       +1  5344            jnz     fnd
01F2 ED         +1  5345            mov     a,r5
01F3 950B       +1  5346            subb    a,ltemp+3
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    84

01F5 7001       +1  5347            jnz     fnd
01F7            +1  5348     cdone:
01F7 22         +1  5349            ret                     ;return with acc == 0
01F8            +1  5350     fnd:
01F8 8AF0       +1  5351           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  5352          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  5353            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  5354                         orl         a,#1                          ;make non-zero
0201 B3         +1  5355             cpl     c               ;c=0->1,c=1->0
0202 22         +1  5356             ret
                +1  5357     ;==============================================================
                +1  5358     
                +1  5359     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  5360     ;       the result in r2-r5
                +1  5361     
0203            +1  5362     flmul:
                +1  5363+3           saveregs
0203 C007       +1  5364+1           push    7
0205 C006       +1  5365+1           push    6
0207 C001       +1  5366+1           push    1
0209 C000       +1  5367+1           push    0
020B 119E       +1  5368             call    unpack1
020D 11BA       +1  5369             call    unpack2
020F E4         +1  5370             clr     a
0210 F50C       +1  5371             mov     prod,a
0212 F50D       +1  5372             mov     prod+1,a        ;clear product
0214 F50E       +1  5373             mov     prod+2,a
0216 F50F       +1  5374             mov     prod+3,a
0218 7E07       +1  5375             mov     r6,#7           ;initialize counter
021A            +1  5376     mup1:
                +1  5377+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  5378+1           clr     c
021B E508       +1  5379+1           mov     a,mant2
021D 13         +1  5380+1           rrc     a
021E F508       +1  5381+1           mov     mant2,a
0220 E509       +1  5382+1           mov     a,mant2+1
0222 13         +1  5383+1           rrc     a
0223 F509       +1  5384+1           mov     mant2+1,a
0225 E50A       +1  5385+1           mov     a,mant2+2
0227 13         +1  5386+1           rrc     a
0228 F50A       +1  5387+1           mov     mant2+2,a
022A E50B       +1  5388+1           mov     a,mant2+3
022C 13         +1  5389+1           rrc     a
022D F50B       +1  5390+1           mov     mant2+3,a
022F 5014       +1  5391             jnc     nobit           ;skip if lsb was zero
                +1  5392+3           dan     prod            ;add multiplicand to product
0231 ED         +1  5393+1           mov     a,r5
0232 250F       +1  5394+1           add     a,prod+3
0234 F50F       +1  5395+1           mov     prod+3,a
0236 E50E       +1  5396+1           mov     a,prod+2
0238 3C         +1  5397+1           addc    a,r4
0239 F50E       +1  5398+1           mov     prod+2,a
023B E50D       +1  5399+1           mov     a,prod+1
023D 3B         +1  5400+1           addc    a,r3
023E F50D       +1  5401+1           mov     prod+1,a
0240 E50C       +1  5402+1           mov     a,prod+0
0242 3A         +1  5403+1           addc    a,r2
0243 F50C       +1  5404+1           mov     prod,a
0245            +1  5405     nobit:
                +1  5406+3           lshift                  ;shift multiplicand up
0245 ED         +1  5407+1           mov     a,r5
0246 33         +1  5408+1           rlc     a
0247 FD         +1  5409+1           mov     r5,a
0248 EC         +1  5410+1           mov     a,r4
0249 33         +1  5411+1           rlc     a
024A FC         +1  5412+1           mov     r4,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    85

024B EB         +1  5413+1           mov     a,r3
024C 33         +1  5414+1           rlc     a
024D FB         +1  5415+1           mov     r3,a
024E EA         +1  5416+1           mov     a,r2
024F 33         +1  5417+1           rlc     a
0250 FA         +1  5418+1           mov     r2,a
0251 DEC7       +1  5419             djnz    r6,mup1         ;loop if more
                +1  5420     
0253 7E11       +1  5421             mov     r6,#17          ;re-initalize counter
0255 8015       +1  5422             sjmp    mup3
0257            +1  5423     mup11:
                +1  5424+3           shfdn   prod            ;shift product right
0257 C3         +1  5425+1           clr     c
0258 E50C       +1  5426+1           mov     a,prod
025A 13         +1  5427+1           rrc     a
025B F50C       +1  5428+1           mov     prod,a
025D E50D       +1  5429+1           mov     a,prod+1
025F 13         +1  5430+1           rrc     a
0260 F50D       +1  5431+1           mov     prod+1,a
0262 E50E       +1  5432+1           mov     a,prod+2
0264 13         +1  5433+1           rrc     a
0265 F50E       +1  5434+1           mov     prod+2,a
0267 E50F       +1  5435+1           mov     a,prod+3
0269 13         +1  5436+1           rrc     a
026A F50F       +1  5437+1           mov     prod+3,a
026C            +1  5438     mup3:
                +1  5439+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  5440+1           clr     c
026D E508       +1  5441+1           mov     a,mant2
026F 13         +1  5442+1           rrc     a
0270 F508       +1  5443+1           mov     mant2,a
0272 E509       +1  5444+1           mov     a,mant2+1
0274 13         +1  5445+1           rrc     a
0275 F509       +1  5446+1           mov     mant2+1,a
0277 E50A       +1  5447+1           mov     a,mant2+2
0279 13         +1  5448+1           rrc     a
027A F50A       +1  5449+1           mov     mant2+2,a
027C E50B       +1  5450+1           mov     a,mant2+3
027E 13         +1  5451+1           rrc     a
027F F50B       +1  5452+1           mov     mant2+3,a
0281 5014       +1  5453             jnc     mup2            ;skip if bit not set
                +1  5454+3           dan     prod            ;add to prod
0283 ED         +1  5455+1           mov     a,r5
0284 250F       +1  5456+1           add     a,prod+3
0286 F50F       +1  5457+1           mov     prod+3,a
0288 E50E       +1  5458+1           mov     a,prod+2
028A 3C         +1  5459+1           addc    a,r4
028B F50E       +1  5460+1           mov     prod+2,a
028D E50D       +1  5461+1           mov     a,prod+1
028F 3B         +1  5462+1           addc    a,r3
0290 F50D       +1  5463+1           mov     prod+1,a
0292 E50C       +1  5464+1           mov     a,prod+0
0294 3A         +1  5465+1           addc    a,r2
0295 F50C       +1  5466+1           mov     prod,a
0297            +1  5467     mup2:
0297 DEBE       +1  5468             djnz    r6,mup11        ;loop if more
0299 E8         +1  5469             mov     a,r0            ;get exp1
029A 29         +1  5470             add     a,r1            ;add exp2
029B 247A       +1  5471             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  5472             mov     r0,a            ;store
029E EF         +1  5473             mov     a,r7            ;get sign
029F 23         +1  5474             rl      a               ;rotate bit into msb
02A0 6207       +1  5475             xrl     sign,a          ;xor with other bit
                +1  5476+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  5477+1           mov     r2,prod
02A4 AB0D       +1  5478+1           mov     r3,prod+1
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    86

02A6 AC0E       +1  5479+1           mov     r4,prod+2
02A8 AD0F       +1  5480+1           mov     r5,prod+3
02AA 11F0       +1  5481             call    norm1           ;normalize
02AC 11DE       +1  5482             call    pack1
                +1  5483+3           restregs
02AE D000       +1  5484+1           pop     0
02B0 D001       +1  5485+1           pop     1
02B2 D006       +1  5486+1           pop     6
02B4 D007       +1  5487+1           pop     7
02B6 22         +1  5488             ret
                +1  5489     ;-----------------------------------------------------------
                +1  5490     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  5491     
02B7            +1  5492     fldiv:
                +1  5493+3           saveregs
02B7 C007       +1  5494+1           push    7
02B9 C006       +1  5495+1           push    6
02BB C001       +1  5496+1           push    1
02BD C000       +1  5497+1           push    0
02BF 119E       +1  5498             call    unpack1
02C1 11BA       +1  5499             call    unpack2
02C3 E4         +1  5500             clr     a
02C4 F50C       +1  5501             mov     prod,a
02C6 F50D       +1  5502             mov     prod+1,a
02C8 F50E       +1  5503             mov     prod+2,a
02CA F50F       +1  5504             mov     prod+3,a
02CC E9         +1  5505             mov     a,r1            ;check for zero divisor
02CD 6067       +1  5506             jz      div9
02CF E8         +1  5507             mov     a,r0            ;check for zero dividend
02D0 6064       +1  5508             jz      div9
02D2 C3         +1  5509             clr     c
02D3 99         +1  5510             subb    a,r1            ;compute new exponent
02D4 2478       +1  5511             add     a,#127-7        ;unbias
02D6 F8         +1  5512             mov     r0,a            ;store back
02D7 EF         +1  5513             mov     a,r7            ;get sign
02D8 23         +1  5514             rl      a
02D9 6207       +1  5515             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  5516             mov     r6,#24+7        ;initialize counter
02DD            +1  5517     div1:
                +1  5518+3           shfup   prod            ;shift quotient up
02DD C3         +1  5519+1           clr     c
02DE E50F       +1  5520+1           mov     a,prod+3
02E0 33         +1  5521+1           rlc     a
02E1 F50F       +1  5522+1           mov     prod+3,a
02E3 E50E       +1  5523+1           mov     a,prod+2
02E5 33         +1  5524+1           rlc     a
02E6 F50E       +1  5525+1           mov     prod+2,a
02E8 E50D       +1  5526+1           mov     a,prod+1
02EA 33         +1  5527+1           rlc     a
02EB F50D       +1  5528+1           mov     prod+1,a
02ED E50C       +1  5529+1           mov     a,prod
02EF 33         +1  5530+1           rlc     a
02F0 F50C       +1  5531+1           mov     prod,a
02F2 C3         +1  5532             clr     c
02F3 EA         +1  5533             mov     a,r2            ;compare values
02F4 9508       +1  5534             subb    a,mant2
02F6 4028       +1  5535             jc      div2            ;skip if bigger
02F8 7013       +1  5536             jnz     div3
02FA EB         +1  5537             mov     a,r3            ;compare values
02FB 9509       +1  5538             subb    a,mant2+1
02FD 4021       +1  5539             jc      div2            ;skip if bigger
02FF 700C       +1  5540             jnz     div3
0301 EC         +1  5541             mov     a,r4            ;compare values
0302 950A       +1  5542             subb    a,mant2+2
0304 401A       +1  5543             jc      div2            ;skip if bigger
0306 7005       +1  5544             jnz     div3
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    87

0308 ED         +1  5545             mov     a,r5            ;compare values
0309 950B       +1  5546             subb    a,mant2+3
030B 4013       +1  5547             jc      div2            ;skip if bigger
030D            +1  5548     div3:
030D ED         +1  5549             mov     a,r5
030E 950B       +1  5550             subb    a,mant2+3
0310 FD         +1  5551             mov     r5,a
0311 EC         +1  5552             mov     a,r4
0312 950A       +1  5553             subb    a,mant2+2               ;do subtraction
0314 FC         +1  5554             mov     r4,a
0315 EB         +1  5555             mov     a,r3
0316 9509       +1  5556             subb    a,mant2+1               ;do subtraction
0318 FB         +1  5557             mov     r3,a
0319 EA         +1  5558             mov     a,r2
031A 9508       +1  5559             subb    a,mant2         ;do subtraction
031C FA         +1  5560             mov     r2,a
031D 430F01     +1  5561             orl     prod+3,#1       ;set lsb in quotient
0320            +1  5562     div2:
                +1  5563+3           lshift                  ;shift dividend up
0320 ED         +1  5564+1           mov     a,r5
0321 33         +1  5565+1           rlc     a
0322 FD         +1  5566+1           mov     r5,a
0323 EC         +1  5567+1           mov     a,r4
0324 33         +1  5568+1           rlc     a
0325 FC         +1  5569+1           mov     r4,a
0326 EB         +1  5570+1           mov     a,r3
0327 33         +1  5571+1           rlc     a
0328 FB         +1  5572+1           mov     r3,a
0329 EA         +1  5573+1           mov     a,r2
032A 33         +1  5574+1           rlc     a
032B FA         +1  5575+1           mov     r2,a
032C DEAF       +1  5576             djnz    r6,div1         ;loop if more
                +1  5577+3           copytor prod            ;copy quotient
032E AA0C       +1  5578+1           mov     r2,prod
0330 AB0D       +1  5579+1           mov     r3,prod+1
0332 AC0E       +1  5580+1           mov     r4,prod+2
0334 AD0F       +1  5581+1           mov     r5,prod+3
0336            +1  5582     div9:
0336 11F0       +1  5583             call    norm1           ;now normalize result
0338 11DE       +1  5584             call    pack1           ;pack it up
                +1  5585+3           restregs                ;restore registers
033A D000       +1  5586+1           pop     0
033C D001       +1  5587+1           pop     1
033E D006       +1  5588+1           pop     6
0340 D007       +1  5589+1           pop     7
0342 22         +1  5590             ret
                +1  5591     ;------------------------------------------------------------------
                +1  5592     
                +1  5593     ;       Float to long conversion: if the exponent is less than the
                +1  5594     ;       excess value, the result is zero. If the exponent is so large
                +1  5595     ;       that the value would be shifted out, the result is overflow.
                +1  5596     ;       Otherwise shift the mantissa up or down as required.
                +1  5597     
0343            +1  5598     ftol:
                +1  5599+3           saveregs
0343 C007       +1  5600+1           push    7
0345 C006       +1  5601+1           push    6
0347 C001       +1  5602+1           push    1
0349 C000       +1  5603+1           push    0
034B EA         +1  5604             mov     a,r2
034C B4BF09     +1  5605             cjne    a,#0bfh,ne05
034F EB         +1  5606             mov     a,r3
0350 7006       +1  5607             jnz     ne05
0352 EC         +1  5608             mov     a,r4
0353 7003       +1  5609             jnz     ne05
0355 ED         +1  5610             mov     a,r5
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    88

0356 6024       +1  5611             jz      ftol1
0358 119E       +1  5612     ne05:   call    unpack1
035A E8         +1  5613             mov     a,r0            ;get exponent
035B 2482       +1  5614             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  5615             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  5616             mov     a,r7            ;get sign
0361 30E70D     +1  5617             jnb     acc.7,ftol4     ;skip if +ve
                +1  5618+3           neg1                    ;negate it
0364 C3         +1  5619+1           clr     c
0365 E4         +1  5620+1           clr     a
0366 9D         +1  5621+1           subb    a,r5
0367 FD         +1  5622+1           mov     r5,a
0368 E4         +1  5623+1           clr     a
0369 9C         +1  5624+1           subb    a,r4
036A FC         +1  5625+1           mov     r4,a
036B E4         +1  5626+1           clr     a
036C 9B         +1  5627+1           subb    a,r3
036D FB         +1  5628+1           mov     r3,a
036E E4         +1  5629+1           clr     a
036F 9A         +1  5630+1           subb    a,r2
0370 FA         +1  5631+1           mov     r2,a
0371            +1  5632     ftol4:
0371 E8         +1  5633             mov     a,r0            ;get exponent
0372 246A       +1  5634             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  5635             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  5636             mov     r0,a            ;save it
0378 24F8       +1  5637             add     a,#-8           ;if > 8, too big
037A 500E       +1  5638             jnc     ftol3
037C            +1  5639     ftol1:
037C E4         +1  5640             clr     a
037D FA         +1  5641             mov     r2,a
037E FB         +1  5642             mov     r3,a
037F FC         +1  5643             mov     r4,a
0380 FD         +1  5644             mov     r5,a
0381            +1  5645     ftol9:
                +1  5646+3           restregs
0381 D000       +1  5647+1           pop     0
0383 D001       +1  5648+1           pop     1
0385 D006       +1  5649+1           pop     6
0387 D007       +1  5650+1           pop     7
0389 22         +1  5651             ret
038A            +1  5652     ftol3:
038A E8         +1  5653             mov     a,r0
038B FE         +1  5654             mov     r6,a            ;store in counter
038C 60F3       +1  5655             jz      ftol9           ;if zero, do nothing
038E            +1  5656     ftol33:
                +1  5657+3           lshift                  ;shift up
038E ED         +1  5658+1           mov     a,r5
038F 33         +1  5659+1           rlc     a
0390 FD         +1  5660+1           mov     r5,a
0391 EC         +1  5661+1           mov     a,r4
0392 33         +1  5662+1           rlc     a
0393 FC         +1  5663+1           mov     r4,a
0394 EB         +1  5664+1           mov     a,r3
0395 33         +1  5665+1           rlc     a
0396 FB         +1  5666+1           mov     r3,a
0397 EA         +1  5667+1           mov     a,r2
0398 33         +1  5668+1           rlc     a
0399 FA         +1  5669+1           mov     r2,a
039A DEF2       +1  5670             djnz    r6,ftol33       ;and loop
039C 80E3       +1  5671             sjmp    ftol9
039E            +1  5672     ftol2:
039E F4         +1  5673             cpl     a               ;complement
039F FE         +1  5674             mov     r6,a
03A0 6022       +1  5675             jz      ftol22
03A2            +1  5676     ftol23:
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    89

03A2 EF         +1  5677             mov     a,r7
03A3 30E70F     +1  5678             jnb     acc.7,ftol24
                +1  5679+3           rshift1
03A6 D3         +1  5680+1           setb    c
03A7 EA         +1  5681+1           mov     a,r2
03A8 13         +1  5682+1           rrc     a
03A9 FA         +1  5683+1           mov     r2,a
03AA EB         +1  5684+1           mov     a,r3
03AB 13         +1  5685+1           rrc     a
03AC FB         +1  5686+1           mov     r3,a
03AD EC         +1  5687+1           mov     a,r4
03AE 13         +1  5688+1           rrc     a
03AF FC         +1  5689+1           mov     r4,a
03B0 ED         +1  5690+1           mov     a,r5
03B1 13         +1  5691+1           rrc     a
03B2 FD         +1  5692+1           mov     r5,a
03B3 800D       +1  5693             jmp     ftol25
03B5            +1  5694+3   ftol24: rshift                  ;shift down
03B5 C3         +1  5695+1           clr     c
03B6 EA         +1  5696+1           mov     a,r2
03B7 13         +1  5697+1           rrc     a
03B8 FA         +1  5698+1           mov     r2,a
03B9 EB         +1  5699+1           mov     a,r3
03BA 13         +1  5700+1           rrc     a
03BB FB         +1  5701+1           mov     r3,a
03BC EC         +1  5702+1           mov     a,r4
03BD 13         +1  5703+1           rrc     a
03BE FC         +1  5704+1           mov     r4,a
03BF ED         +1  5705+1           mov     a,r5
03C0 13         +1  5706+1           rrc     a
03C1 FD         +1  5707+1           mov     r5,a
03C2 DEDE       +1  5708     ftol25: djnz    r6,ftol23
03C4            +1  5709     ftol22:
                +1  5710+3           add1                    ;round
03C4 ED         +1  5711+1           mov     a,r5
03C5 2401       +1  5712+1           add     a,#1
03C7 FD         +1  5713+1           mov     r5,a
03C8 E4         +1  5714+1           clr     a
03C9 3C         +1  5715+1           addc    a,r4
03CA FC         +1  5716+1           mov     r4,a
03CB E4         +1  5717+1           clr     a
03CC 3B         +1  5718+1           addc    a,r3
03CD FB         +1  5719+1           mov     r3,a
03CE E4         +1  5720+1           clr     a
03CF 3A         +1  5721+1           addc    a,r2
03D0 FA         +1  5722+1           mov     r2,a
03D1 EF         +1  5723             mov     a,r7
03D2 30E70F     +1  5724             jnb     acc.7,ftol26
                +1  5725+3           rshift1
03D5 D3         +1  5726+1           setb    c
03D6 EA         +1  5727+1           mov     a,r2
03D7 13         +1  5728+1           rrc     a
03D8 FA         +1  5729+1           mov     r2,a
03D9 EB         +1  5730+1           mov     a,r3
03DA 13         +1  5731+1           rrc     a
03DB FB         +1  5732+1           mov     r3,a
03DC EC         +1  5733+1           mov     a,r4
03DD 13         +1  5734+1           rrc     a
03DE FC         +1  5735+1           mov     r4,a
03DF ED         +1  5736+1           mov     a,r5
03E0 13         +1  5737+1           rrc     a
03E1 FD         +1  5738+1           mov     r5,a
03E2 809D       +1  5739             jmp     ftol9
03E4            +1  5740+3   ftol26: rshift
03E4 C3         +1  5741+1           clr     c
03E5 EA         +1  5742+1           mov     a,r2
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    90

03E6 13         +1  5743+1           rrc     a
03E7 FA         +1  5744+1           mov     r2,a
03E8 EB         +1  5745+1           mov     a,r3
03E9 13         +1  5746+1           rrc     a
03EA FB         +1  5747+1           mov     r3,a
03EB EC         +1  5748+1           mov     a,r4
03EC 13         +1  5749+1           rrc     a
03ED FC         +1  5750+1           mov     r4,a
03EE ED         +1  5751+1           mov     a,r5
03EF 13         +1  5752+1           rrc     a
03F0 FD         +1  5753+1           mov     r5,a
03F1 808E       +1  5754             jmp     ftol9
                +1  5755     
                +1  5756     ;       arithmetic integer to floating conversions
                +1  5757     
03F3            +1  5758     abtof:
03F3 ED         +1  5759             mov     a,r5
03F4 23         +1  5760             rl      a
03F5 FC         +1  5761             mov     r4,a
03F6 9C         +1  5762             subb    a,r4
03F7 FC         +1  5763             mov     r4,a
03F8 FB         +1  5764             mov     r3,a
03F9 FA         +1  5765             mov     r2,a
03FA 8006       +1  5766             jmp     altof
03FC            +1  5767     awtof:
03FC EC         +1  5768             mov     a,r4
03FD 23         +1  5769             rl      a
03FE FB         +1  5770             mov     r3,a
03FF 9B         +1  5771             subb    a,r3
0400 FB         +1  5772             mov     r3,a
0401 FA         +1  5773             mov     r2,a
0402            +1  5774     altof:
                +1  5775+3           saveregs
0402 C007       +1  5776+1           push    7
0404 C006       +1  5777+1           push    6
0406 C001       +1  5778+1           push    1
0408 C000       +1  5779+1           push    0
040A EA         +1  5780             mov     a,r2            ;get sign
040B 5480       +1  5781             anl     a,#80h
040D FF         +1  5782             mov     r7,a            ;store it
040E 30E70D     +1  5783             jnb     acc.7,altof1    ;skip if +ve
                +1  5784+3           neg1
0411 C3         +1  5785+1           clr     c
0412 E4         +1  5786+1           clr     a
0413 9D         +1  5787+1           subb    a,r5
0414 FD         +1  5788+1           mov     r5,a
0415 E4         +1  5789+1           clr     a
0416 9C         +1  5790+1           subb    a,r4
0417 FC         +1  5791+1           mov     r4,a
0418 E4         +1  5792+1           clr     a
0419 9B         +1  5793+1           subb    a,r3
041A FB         +1  5794+1           mov     r3,a
041B E4         +1  5795+1           clr     a
041C 9A         +1  5796+1           subb    a,r2
041D FA         +1  5797+1           mov     r2,a
041E            +1  5798     altof1:
041E 7896       +1  5799             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  5800             call    norm1           ;normalize it
0422 11DE       +1  5801             call    pack1           ;and pack up
                +1  5802+3           restregs
0424 D000       +1  5803+1           pop     0
0426 D001       +1  5804+1           pop     1
0428 D006       +1  5805+1           pop     6
042A D007       +1  5806+1           pop     7
042C 22         +1  5807             ret
                +1  5808     
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    91

042D            +1  5809     lbtof:
042D 7C00       +1  5810             mov     r4,#0
042F            +1  5811     lwtof:
042F E4         +1  5812             clr     a
0430 FB         +1  5813             mov     r3,a
0431 FA         +1  5814             mov     r2,a
0432            +1  5815     lltof:
                +1  5816+3           saveregs
0432 C007       +1  5817+1           push    7
0434 C006       +1  5818+1           push    6
0436 C001       +1  5819+1           push    1
0438 C000       +1  5820+1           push    0
043A 7F00       +1  5821             mov     r7,#0           ;zero sign
043C 80E0       +1  5822             sjmp    altof1
                +1  5823     
                +1  5824     ;-------------------------------------------------------
                +1  5825     
                +1  5826     
                    5827     
                    5828     ;$include (d:\amp\wriread.asm)
                +1  5829     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  5830     cle256:          mov            IE,#00H
0441 75B601     +1  5831                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  5832                              MOV            PSCTL,#03
                +1  5833                                             
0447 7400       +1  5834                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  5835                                     movx    @dptr,a                         ;wr
044A 758F00     +1  5836                                     mov             PSCTL,#00
044D 75B600     +1  5837                                 mov         FLSCL,#00
0450 75A880     +1  5838                               mov           IE,#80H
0453 22         +1  5839                                     ret
                +1  5840     
                +1  5841     ;чтение памяти программ в r8..r11
                +1  5842     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  5843     re4byte:        mov                     dph,r2
0456 8B82       +1  5844                                             mov                     dpl,r3
0458 E4         +1  5845                                             clr                     a
0459 93         +1  5846                                             movc            a,@a+dptr
045A F508       +1  5847                                             mov                     r8,a
045C A3         +1  5848                                             inc                     dptr
045D E4         +1  5849                                             clr                     a
045E 93         +1  5850                                             movc            a,@a+dptr
045F F509       +1  5851                                             mov                     r9,a
0461 A3         +1  5852                                             inc                     dptr
0462 E4         +1  5853                                             clr                     a
0463 93         +1  5854                                             movc            a,@a+dptr
0464 F50A       +1  5855                                             mov                     r10,a
0466 A3         +1  5856                                             inc                     dptr
0467 E4         +1  5857                                             clr                     a
0468 93         +1  5858                                             movc            a,@a+dptr
0469 F50B       +1  5859                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  5860                                             ret
                +1  5861      ;чтение памяти программ в r2..r5
                +1  5862     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  5863     rebyte2:        mov                     dph,r2
046E 8B82       +1  5864                                             mov                     dpl,r3
0470 E4         +1  5865                                             clr                     a
0471 93         +1  5866                                             movc            a,@a+dptr
0472 FA         +1  5867                                             mov                     r2,a
0473 A3         +1  5868                                             inc                     dptr
0474 E4         +1  5869                                             clr                     a
0475 93         +1  5870                                             movc            a,@a+dptr
0476 FB         +1  5871                                             mov                     r3,a
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    92

0477 A3         +1  5872                                             inc                     dptr
0478 E4         +1  5873                                             clr                     a
0479 93         +1  5874                                             movc            a,@a+dptr
047A FC         +1  5875                                             mov                     r4,a
047B A3         +1  5876                                             inc                     dptr
047C E4         +1  5877                                             clr                     a
047D 93         +1  5878                                             movc            a,@a+dptr
047E FD         +1  5879                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  5880                                             ret
                +1  5881      
                +1  5882     
                +1  5883      ;r7-количество байт
                +1  5884     ;dptr-адр ячейки для записи
                +1  5885     ;r1-адр ячейки  внешнего озу
                +1  5886     
0480 75A800     +1  5887     wrpage:  mov            IE,#00H
0483 75B601     +1  5888     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  5889                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  5890                      movx           a,@r1
048A F0         +1  5891                      movx           @dptr,a                         ;wr
048B 758F00     +1  5892                      mov            PSCTL,#0
048E 75B600     +1  5893                      mov            FLSCL,#00
0491 A3         +1  5894                     inc                     dptr
0492 09         +1  5895                     inc                     r1
0493 DFEE       +1  5896                     djnz            r7,WW5
0495 75A880     +1  5897                     mov             IE,#80H
0498 22         +1  5898                     ret
                +1  5899                             
                +1  5900     
                +1  5901     
                +1  5902                                                             
                +1  5903     
                +1  5904     
                +1  5905     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  5906     ;чтение памяти программ во внешнее озу
                +1  5907     ;вх-r2,r3-адр яч памяти прогр
                +1  5908     ;r1- яч внешнее озу
0499 8A83       +1  5909     copyPP:         mov                     dph,r2
049B 8B82       +1  5910                                             mov                     dpl,r3
049D 7FFF       +1  5911                                             mov                     r7,#0ffh
049F E4         +1  5912     copy1:          clr                     a
04A0 93         +1  5913                                             movc            a,@a+dptr
04A1 F3         +1  5914                                             movx                    @r1,a
04A2 A3         +1  5915                                             inc                     dptr
04A3 09         +1  5916                                             inc                     r1
04A4 DFF9       +1  5917                                             djnz            r7,copy1
04A6 22         +1  5918                                             ret
                +1  5919     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  5920     
                +1  5921                                     
                +1  5922     
                +1  5923     ;r8..r11->@r0..@r0+3
                +1  5924     ;r0-адр ячейки
                +1  5925     ;сохранить в ячейке озу
04A7 E508       +1  5926     savelte:        mov     a,ltemp
04A9 F6         +1  5927                                             mov     @r0,a
04AA 08         +1  5928                                             inc     r0
04AB E509       +1  5929                                             mov     a,ltemp+1
04AD F6         +1  5930                                             mov     @r0,a
04AE 08         +1  5931                                             inc     r0
04AF E50A       +1  5932                                             mov     a,ltemp+2
04B1 F6         +1  5933                                             mov     @r0,a
04B2 08         +1  5934                                             inc     r0
04B3 E50B       +1  5935                                             mov     a,ltemp+3
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    93

04B5 F6         +1  5936                                             mov     @r0,a
04B6 22         +1  5937                                             ret
                +1  5938     
                +1  5939     ;
                +1  5940     
                +1  5941     
                +1  5942     
                +1  5943     
                +1  5944     
                +1  5945                     
                +1  5946     
                +1  5947     
                +1  5948     
                +1  5949     
                +1  5950      
                    5951     
                    5952                                                   
                    5953     END
                                                                             
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    94

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   0328H   R   SEG=MAIN   779 782#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1250 1307 1332 1353 1357 1360 1361 1363 1468 1473 3243 3249 3282
                                           3308 3382 3386 3409 3412 3556 3559 3583 3586 3998
ABRET. . . . . . .  C ADDR   17C2H   R   SEG=MAIN   3927 3929#
ABTOF. . . . . . .  C ADDR   03F3H   A      5758#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 618 672 680 688 696 698 718 1025 1033 1109 1419 1579 1588 1597 1606
                                           1627 1958 2222 2244 2249 2253 2256 2259 2262 2265 2268 2441 2492 2538 2549
                                           2591 2600 2608 2618 2632 2742 2760 2785 2790 2794 2797 2800 2803 2806 2809
                                           3098 3168 3331 3337 3374 3443 4165 4243 4246 4503 5155 5238 5255 5287 5325
                                           5353 5615 5617 5635 5678 5724 5783
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   1B73H   R   SEG=MAIN   809 845 847 849 851 853 855 857 859 861 924 926 928 930 932 934
                                           936 938 940 943 945 947 949 951 953 955 957 959 961 4744#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1306 1318 1322 1337 1362 1365 1366 1472 1476 3240 3244 3279 3283
                                           3305 3309 3387 3413 3558 3561 3585 3588 3810 3827 3845 3899 3916
AFTERK . . . . . .  C ADDR   05D0H   R   SEG=MAIN   1042 1121#
AGE2 . . . . . . .  C ADDR   01C2H   R   SEG=MAIN   548# 551
AGE9 . . . . . . .  C ADDR   06C9H   R   SEG=MAIN   1254# 1257
AGEON. . . . . . .  C ADDR   01D0H   R   SEG=MAIN   557# 559
ALESS0 . . . . . .  C ADDR   07FEH   R   SEG=MAIN   1419 1440#
ALLSUM . . . . . .  C ADDR   02E1H   R   SEG=MAIN   738# 774
ALMUL. . . . . . .  C ADDR   1ABAH   R   SEG=MAIN   4590#
ALTOF. . . . . . .  C ADDR   0402H   A      1017 1053 1102 1134 1147 1216 1735 1796 1834 3286 3312 3390 3416 5766
                                           5774#
ALTOF1 . . . . . .  C ADDR   041EH   A      5783 5798# 5822
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   0523H   R   SEG=MAIN   1015 1022#
AN_T7. . . . . . .  C ADDR   1008H   R   SEG=MAIN   2810# 2860 2869
AUTOKA . . . . . .  C ADDR   09AAH   R   SEG=MAIN   1040 1764#
AVPGO. . . . . . .  C ADDR   0652H   R   SEG=MAIN   1193 1195#
AVTDEC1. . . . . .  C ADDR   0595H   R   SEG=MAIN   1075 1082#
AWTOF. . . . . . .  C ADDR   03FCH   A      5767#
B. . . . . . . . .  D ADDR   00F0H   A      122# 3682 4018 4593 4596 4598 4602 4606 4610 4614 4619 4623 4630 4634
                                           4638 4644 4648 4652 4658 5351 5352
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 442#
BFORM. . . . . . .  C ADDR   0B44H   R   SEG=MAIN   2036 2041 2053# 2079
BIN30. . . . . . .  C ADDR   18D6H   R   SEG=MAIN   4153# 4179
BIN31. . . . . . .  C ADDR   18DAH   R   SEG=MAIN   4158# 4162
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    95

BIN32. . . . . . .  C ADDR   18EAH   R   SEG=MAIN   4171# 4176
BIN41. . . . . . .  C ADDR   18FBH   R   SEG=MAIN   4187# 4197
BINDEC . . . . . .  C ADDR   18CAH   R   SEG=MAIN   1308 1364 1474 3560 3587 4132#
BITAKT . . . . . .  B ADDR   0023H.2 A      348# 1553 1554 1557
BITAVP . . . . . .  B ADDR   0020H.5 A      319# 1153 1373 1545 2850 2851 2853
BITBON . . . . . .  B ADDR   0021H.2 A      326# 1657 2276 2277 2279
BITBUF . . . . . .  B ADDR   0021H.0 A      324# 1678 1680 2358
BITIZM . . . . . .  B ADDR   0020H.4 A      318# 528 639 2250 2312 2397 2791 2843 2940 2961 3030 3058 3145 3153 3323
BITMAS . . . . . .  B ADDR   0020H.1 A      315# 970 973 2018
BITMEM . . . . . .  B ADDR   0021H.3 A      327# 2585 3061 3093 3144 3152 3322
BITMENU. . . . . .  B ADDR   0022H.1 A      335# 2565 2844
BITMIG . . . . . .  B ADDR   0023H.1 A      347# 2531 2749 2999 3366 3450 3493 3500 3506 3512 3516 3530 3542
BITNUL . . . . . .  B ADDR   0021H.7 A      331# 1530 2871 2872 2879
BITOLL . . . . . .  B ADDR   0022H.7 A      341# 594 1380 1457
BITPRD . . . . . .  B ADDR   0021H.1 A      325# 1656
BITRS. . . . . . .  B ADDR   0020H.3 A      317#
BITT2. . . . . . .  B ADDR   0022H.0 A      334# 1456 2398 2438 2886 3031
BITVI11. . . . . .  B ADDR   0020H.6 A      320# 1154 2271 2273 2311 2562 2939
BITVI12. . . . . .  B ADDR   0022H.2 A      336#
BITVI13. . . . . .  B ADDR   0022H.3 A      337#
BITVI21. . . . . .  B ADDR   0022H.5 A      339#
BITVI31. . . . . .  B ADDR   0022H.6 A      340#
BITVICH. . . . . .  B ADDR   0022H.4 A      338# 1455 2272 2313 2323 2460 2903 2960
BITZNAK. . . . . .  B ADDR   0020H.0 A      314# 619 655
BITZNB . . . . . .  B ADDR   0023H.3 A      349# 3417 3925 3928
BITZUS . . . . . .  B ADDR   0020H.7 A      321# 1396
BMEM11 . . . . . .  B ADDR   0021H.4 A      328# 2563
BMEM12 . . . . . .  B ADDR   0021H.5 A      329#
BMEM13 . . . . . .  B ADDR   0021H.6 A      330#
BOUT7. . . . . . .  C ADDR   1199H   R   SEG=MAIN   3039# 3041
BRET . . . . . . .  C ADDR   1647H   R   SEG=MAIN   3622 3627 3631#
BUFDEC . . . . . .  C ADDR   0832H   R   SEG=MAIN   1479# 1484
BUFIND . . . . . .  D ADDR   0040H   A      298# 547 551 556 559 563 1253 1257 1323 1344 1365 1366 1367 1429 1434
                                           1477 1485 1487 1492 1528 1555 1558 1890 2238 2506 2524 2540 2542 2545 2654
                                           2697 2716 2778 3012 3045 3051 3211 3358 3497 3519 3562 3581 3589 3680 3698
                                           3809 3826 3844 3898 3915 3926
BUFON. . . . . . .  C ADDR   0C85H   R   SEG=MAIN   2276 2279#
BUFR . . . . . . .  C ADDR   076EH   R   SEG=MAIN   1346# 1351
BUFR2. . . . . . .  C ADDR   0750H   R   SEG=MAIN   1325# 1330
BUFR3. . . . . . .  C ADDR   0749H   R   SEG=MAIN   1316 1321#
BUFR30 . . . . . .  C ADDR   074CH   R   SEG=MAIN   1319 1323#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      5348# 5352
CELLBIT. . . . . .  D ADDR   0020H   A      313# 314 315 316 317 318 319 320 321
CELLBIT1 . . . . .  D ADDR   0021H   A      323# 324 325 326 327 328 329 330 331
CELLBIT2 . . . . .  D ADDR   0022H   A      333# 334 335 336 337 338 339 340 341
CELLBIT3 . . . . .  D ADDR   0023H   A      345# 346 347 348 349
CEXP . . . . . . .  C ADDR   01E2H   A      5325 5334#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   16D7H   R   SEG=MAIN   2880 3754#
CH1. . . . . . . .  C ADDR   16F3H   R   SEG=MAIN   1875 3764#
CH10 . . . . . . .  C ADDR   16DBH   R   SEG=MAIN   984 3755#
CH100. . . . . . .  C ADDR   16EBH   R   SEG=MAIN   737 1414 3759#
CH10000. . . . . .  C ADDR   16E7H   R   SEG=MAIN   3758#
CH2. . . . . . . .  C ADDR   16EFH   R   SEG=MAIN   979 3760#
CH20 . . . . . . .  C ADDR   1889H   R   SEG=MAIN   773 989 4049#
CH2THO . . . . . .  C ADDR   1707H   R   SEG=MAIN   1803 1841 3769#
CH5. . . . . . . .  C ADDR   16DFH   R   SEG=MAIN   3756#
CH57 . . . . . . .  C ADDR   1885H   R   SEG=MAIN   4048#
CH954. . . . . . .  C ADDR   16E3H   R   SEG=MAIN   3757#
CHANMA . . . . . .  C ADDR   0E26H   R   SEG=MAIN   2538 2547#
CHANZ. . . . . . .  C ADDR   0E0DH   R   SEG=MAIN   2492 2536#
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    96

CHAVT. . . . . . .  D ADDR   0081H   A      363# 508 1031 1076 1082 1857
CHBEFORE . . . . .  D ADDR   009BH   A      373# 530 734 749 768
CHBUF. . . . . . .  D ADDR   00ADH   A      380# 1654 1664
CHCMP. . . . . . .  C ADDR   0BE9H   R   SEG=MAIN   631 1037 2195#
CHDEC. . . . . . .  C ADDR   0A50H   R   SEG=MAIN   638 1083 1094 1867#
CHDEL. . . . . . .  D ADDR   0083H   A      364# 1704 1749 1771 1816 1851
CHDELMO. . . . . .  C ADDR   0992H   R   SEG=MAIN   1719 1749# 1754
CHIF . . . . . . .  C ADDR   15ABH   R   SEG=MAIN   3523 3525#
CHIND. . . . . . .  D ADDR   00ACH   A      379# 1168 1564
CHINKOR. . . . . .  D ADDR   0098H   A      362# 503 716 1023 1036 1078 1090 1093 1756
CHKL . . . . . . .  D ADDR   003DH   A      305# 630 637 2376 2404 2453 2824 3064
CHMAS. . . . . . .  D ADDR   006EH   A      302# 967 974 992 2017
CHMASN . . . . . .  D ADDR   003FH   A      306# 723 732 769 786 798 972 974 975
CHTADC . . . . . .  C ADDR   0A9AH   R   SEG=MAIN   1916#
CHTHO. . . . . . .  C ADDR   16FFH   R   SEG=MAIN   1054 1135 3767#
CHTHOU . . . . . .  C ADDR   178DH   R   SEG=MAIN   3886#
CHZAP. . . . . . .  C ADDR   16D3H   R   SEG=MAIN   1643 3753#
CH_1 . . . . . . .  C ADDR   16F7H   R   SEG=MAIN   533 1270 1293 3765#
CH_10. . . . . . .  C ADDR   1717H   R   SEG=MAIN   1276 1299 3773#
CH_10TH. . . . . .  C ADDR   1713H   R   SEG=MAIN   1188 3772#
CH_200 . . . . . .  C ADDR   170FH   R   SEG=MAIN   1148 3771#
CH_220 . . . . . .  C ADDR   170BH   R   SEG=MAIN   1127 3770#
CH_22T . . . . . .  C ADDR   17CBH   R   SEG=MAIN   1226 3934#
CH_250 . . . . . .  C ADDR   171BH   R   SEG=MAIN   3774#
CH_500 . . . . . .  C ADDR   17C7H   R   SEG=MAIN   1222 3933#
CH_953 . . . . . .  C ADDR   16FBH   R   SEG=MAIN   3766#
CH_B . . . . . . .  C ADDR   17C3H   R   SEG=MAIN   1238 3931#
CH_FL. . . . . . .  C ADDR   17CFH   R   SEG=MAIN   1262 3935#
CIKLWR . . . . . .  C ADDR   0B1AH   R   SEG=MAIN   2024#
CKCON. . . . . . .  D ADDR   008EH   A      30# 460
CL4. . . . . . . .  C ADDR   172DH   R   SEG=MAIN   3789# 3791
CL4N . . . . . . .  C ADDR   1733H   R   SEG=MAIN   3798# 3800
CLE256 . . . . . .  C ADDR   043EH   A      5830#
CLEAR. . . . . . .  C ADDR   18C4H   R   SEG=MAIN   4110 4114# 4144
CLEAR4 . . . . . .  C ADDR   172AH   R   SEG=MAIN   746 1204 1206 1333 1354 1393 1395 2305 2307 2865 2867 3787#
CLEARN . . . . . .  C ADDR   1732H   R   SEG=MAIN   3241 3280 3306 3383 3410 3796#
CLMASSIX . . . . .  C ADDR   0B0AH   R   SEG=MAIN   502 1202 1391 1760 1861 2011# 2303 2863 3029
CLMASV . . . . . .  C ADDR   0657H   R   SEG=MAIN   1197 1199#
CLMAX. . . . . . .  C ADDR   0B0FH   R   SEG=MAIN   2013# 2016
CLR11. . . . . . .  C ADDR   18C5H   R   SEG=MAIN   4116# 4118
CLRDEC . . . . . .  C ADDR   18BEH   R   SEG=MAIN   4108#
CLRNUM . . . . . .  C ADDR   18C2H   R   SEG=MAIN   4111# 4225
CLRVICH. . . . . .  C ADDR   1114H   R   SEG=MAIN   2960# 2977
CNTR . . . . . . .  N NUMB   0006H   A      5021#
CO02S. . . . . . .  C ADDR   16C8H   R   SEG=MAIN   3747# 3751
CO1S . . . . . . .  C ADDR   16BFH   R   SEG=MAIN   3741# 3741
CO2S . . . . . . .  C ADDR   16BBH   R   SEG=MAIN   3739# 3743
COMPA1 . . . . . .  C ADDR   06E5H   R   SEG=MAIN   1270# 1279
COMPA2 . . . . . .  C ADDR   071BH   R   SEG=MAIN   1293# 1302
COND . . . . . . .  C ADDR   0B7EH   R   SEG=MAIN   2108#
CONSTE . . . . . .  D ADDR   00A4H   A      377#
CONSTF . . . . . .  D ADDR   00A8H   A      378#
COPY1. . . . . . .  C ADDR   049FH   A      5912# 5917
COPYPP . . . . . .  C ADDR   0499H   A      5909#
COUNT. . . . . . .  C ADDR   169DH   R   SEG=MAIN   3713# 3713
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   16A4H   R   SEG=MAIN   3719# 3719
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 465
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1421 1442
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1424 1446
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 466
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    97

DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1651
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1648
DCOA . . . . . . .  C ADDR   0B83H   R   SEG=MAIN   2112# 2114
DCOB . . . . . . .  C ADDR   0B8AH   R   SEG=MAIN   2116# 2134
DCOC . . . . . . .  C ADDR   0B95H   R   SEG=MAIN   2126# 2131
DCOD . . . . . . .  C ADDR   0BA2H   R   SEG=MAIN   2133 2136#
DD . . . . . . . .  C ADDR   01FCH   R   SEG=MAIN   585#
DDOUTF . . . . . .  C ADDR   1296H   R   SEG=MAIN   3142 3149 3178 3184# 3235
DEC30. . . . . . .  C ADDR   1917H   R   SEG=MAIN   4235# 4260
DEC31. . . . . . .  C ADDR   191CH   R   SEG=MAIN   4241# 4248
DEC32. . . . . . .  C ADDR   192CH   R   SEG=MAIN   4253# 4257
DECBIN . . . . . .  C ADDR   190AH   R   SEG=MAIN   3245 3284 3310 3388 3414 4214#
DECSIZE. . . . . .  N NUMB   000AH   A      4089# 4109 4143 4170 4183 4186 4240
DECT2. . . . . . .  C ADDR   1935H   R   SEG=MAIN   4231 4263#
DEDPTR . . . . . .  C ADDR   1B8AH   R   SEG=MAIN   4748 4752 4756 4762#
DENORM . . . . . .  C ADDR   0133H   A      5180# 5236
DGOTO7 . . . . . .  C ADDR   1385H   R   SEG=MAIN   3313# 3319
DIAP . . . . . . .  D ADDR   00AEH   A      381# 522 1192 1375 1491 2297 2329 2366 2815 2856 3602 3623 3858 4015 4077
DIINC. . . . . . .  C ADDR   0CA3H   R   SEG=MAIN   2300 2303#
DIKDN. . . . . . .  C ADDR   185DH   R   SEG=MAIN   4017 4037#
DIKDW. . . . . . .  C ADDR   1777H   R   SEG=MAIN   3862 3874#
DIPAR. . . . . . .  C ADDR   178BH   R   SEG=MAIN   3884#
DIV1 . . . . . . .  C ADDR   02DDH   A      5517# 5576
DIV2 . . . . . . .  C ADDR   0320H   A      5535 5539 5543 5547 5562#
DIV3 . . . . . . .  C ADDR   030DH   A      5536 5540 5544 5548#
DIV9 . . . . . . .  C ADDR   0336H   A      5506 5508 5582#
DIVIDE . . . . . .  C ADDR   19F5H   R   SEG=MAIN   2040 4449#
DONE . . . . . . .  C ADDR   1964H   R   SEG=MAIN   4279 4290#
DONE1. . . . . . .  C ADDR   1962H   R   SEG=MAIN   4282 4285 4288#
DOSH . . . . . . .  C ADDR   1A7EH   R   SEG=MAIN   4524 4540#
DOSUB. . . . . . .  C ADDR   1A6CH   R   SEG=MAIN   4508 4512 4516 4520 4521 4525#
DPH. . . . . . . .  D ADDR   0083H   A      19# 1971 1979 2771 3432 4296 4332 4367 4370 4382 4405 4767 4769 5843 5863
                                           5909
DPL. . . . . . . .  D ADDR   0082H   A      18# 1972 1978 2770 3433 4312 4348 4369 4383 4386 4420 4764 4766 5844 5864
                                           5910
DVIG0. . . . . . .  C ADDR   08E5H   R   SEG=MAIN   1600# 1602
DVIG1. . . . . . .  C ADDR   08DAH   R   SEG=MAIN   1591# 1593
DVIG2. . . . . . .  C ADDR   08CFH   R   SEG=MAIN   1582# 1584
DVIG3. . . . . . .  C ADDR   08C3H   R   SEG=MAIN   1573# 1575
DVIG4. . . . . . .  C ADDR   08F1H   R   SEG=MAIN   1611# 1613
DVIG6. . . . . . .  C ADDR   0910H   R   SEG=MAIN   1636# 1638
DVM. . . . . . . .  C ADDR   090EH   R   SEG=MAIN   1627 1635#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 463
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 489 1888 1900 2220 2744 2759 3449
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDSDV . . . . . .  C ADDR   0914H   R   SEG=MAIN   1633 1639#
ENDSUM . . . . . .  C ADDR   04CFH   R   SEG=MAIN   810 862 966#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU0 . . . . . . .  C ADDR   0716H   R   SEG=MAIN   1273 1289#
EQU00. . . . . . .  C ADDR   0734H   R   SEG=MAIN   1291 1296 1305#
EQU1L. . . . . . .  C ADDR   0F13H   R   SEG=MAIN   2664 2668#
EQU2L. . . . . . .  C ADDR   12CEH   R   SEG=MAIN   3221 3226#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      5023#
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    98

EXP2 . . . . . . .  N NUMB   0001H   A      5025# 5202 5223
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDKOEF . . . . .  C ADDR   1768H   R   SEG=MAIN   1050 1131 3857#
FINDR. . . . . . .  C ADDR   18B6H   R   SEG=MAIN   1359 4077#
FINIS. . . . . . .  C ADDR   1AA9H   R   SEG=MAIN   4468 4569#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      1220 5228# 5317
FLCMP. . . . . . .  C ADDR   01D6H   A      1129 1150 1190 1224 1228 1272 1295 5322#
FLDIV. . . . . . .  C ADDR   02B7H   A      1056 1137 1245 1264 1278 1805 1843 5492#
FLMUL. . . . . . .  C ADDR   0203H   A      1061 1114 1142 1240 1301 5362#
FLOUT. . . . . . .  C ADDR   01E1H   A      5329 5332#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 5831 5837 5888 5893
FLSUB. . . . . . .  C ADDR   01D1H   A      1106 1801 1839 5315#
FND. . . . . . . .  C ADDR   01F8H   A      5338 5341 5344 5347 5350#
FO1M . . . . . . .  C ADDR   0B41H   R   SEG=MAIN   2046 2050#
FO2M . . . . . . .  C ADDR   0B4AH   R   SEG=MAIN   2053 2055#
FORM4. . . . . . .  C ADDR   0B4BH   R   SEG=MAIN   2048 2054 2058#
FT1IZM . . . . . .  C ADDR   0D82H   R   SEG=MAIN   2448#
FTOL . . . . . . .  C ADDR   0343H   A      1062 1144 1248 1462 3555 3582 5598#
FTOL1. . . . . . .  C ADDR   037CH   A      5611 5615 5639#
FTOL2. . . . . . .  C ADDR   039EH   A      5635 5672#
FTOL22 . . . . . .  C ADDR   03C4H   A      5675 5709#
FTOL23 . . . . . .  C ADDR   03A2H   A      5676# 5708
FTOL24 . . . . . .  C ADDR   03B5H   A      5678 5694#
FTOL25 . . . . . .  C ADDR   03C2H   A      5693 5708#
FTOL26 . . . . . .  C ADDR   03E4H   A      5724 5740#
FTOL3. . . . . . .  C ADDR   038AH   A      5638 5652#
FTOL33 . . . . . .  C ADDR   038EH   A      5656# 5670
FTOL4. . . . . . .  C ADDR   0371H   A      5617 5632#
FTOL9. . . . . . .  C ADDR   0381H   A      5645# 5655 5671 5739 5754
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   471# 472
GO23NO . . . . . .  C ADDR   125EH   R   SEG=MAIN   3150 3156#
GO31L. . . . . . .  C ADDR   0F19H   R   SEG=MAIN   2643 2673#
GO41L. . . . . . .  C ADDR   0F1EH   R   SEG=MAIN   2673 2675#
GOA2 . . . . . . .  C ADDR   0617H   R   SEG=MAIN   1152 1155#
GOA3A2 . . . . . .  C ADDR   0621H   R   SEG=MAIN   1160#
GOCIKLE. . . . . .  C ADDR   094DH   R   SEG=MAIN   1658 1667 1671 1678# 1684 1687
GOFULL . . . . . .  C ADDR   1290H   R   SEG=MAIN   3162 3182#
GOONIN . . . . . .  C ADDR   062EH   R   SEG=MAIN   1167# 1207 1381 1397
GOONIND. . . . . .  C ADDR   0807H   R   SEG=MAIN   1170 1447#
GOONT. . . . . . .  C ADDR   0937H   R   SEG=MAIN   1661 1663#
GOPART . . . . . .  C ADDR   02BFH   R   SEG=MAIN   718 721#
GOTO7. . . . . . .  C ADDR   1014H   R   SEG=MAIN   2818 2823# 2877 2884 2920 2941 2964 2988 3000 3039 3043 3068 3103
                                           3112 3116 3130 3146 3154 3164 3186 3196 3225 3228 3257 3270 3272 3294 3313
                                           3325 3333 3345 3401
GOTOKD . . . . . .  C ADDR   0545H   R   SEG=MAIN   1020 1044#
GOUT6. . . . . . .  C ADDR   0C32H   R   SEG=MAIN   2245# 2271
GOZNAK . . . . . .  C ADDR   0271H   R   SEG=MAIN   625 661#
HNOR11 . . . . . .  C ADDR   111FH   R   SEG=MAIN   2931 2968#
HNOR12 . . . . . .  C ADDR   10D5H   R   SEG=MAIN   2921 2925#
HNOT1. . . . . . .  C ADDR   1162H   R   SEG=MAIN   2898 3009#
HNOT2. . . . . . .  C ADDR   10A3H   R   SEG=MAIN   2895#
HR12 . . . . . . .  C ADDR   10CBH   R   SEG=MAIN   2916 2921#
HVI1113. . . . . .  C ADDR   10C5H   R   SEG=MAIN   2919# 2924 2929
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 490 5830 5838 5887 5897
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   109FH   R   SEG=MAIN   2890 2892#
IND. . . . . . . .  C ADDR   0A68H   R   SEG=MAIN   552 560 585 649 1283 1287 1561 1888# 2290 2847
INDA3. . . . . . .  C ADDR   07CEH   R   SEG=MAIN   1412#
INDOLL . . . . . .  C ADDR   07A5H   R   SEG=MAIN   1373 1374 1378#
INIACP . . . . . .  C ADDR   17D3H   R   SEG=MAIN   591 3027 3941#
INTN . . . . . . .  C ADDR   136EH   R   SEG=MAIN   3304#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE    99

IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   114AH   R   SEG=MAIN   2990#
IZMAN. . . . . . .  C ADDR   0CF4H   R   SEG=MAIN   2218 2350#
IZMFUN . . . . . .  C ADDR   0D03H   R   SEG=MAIN   2291 2302 2309 2354 2357#
IZMPAT . . . . . .  C ADDR   0D07H   R   SEG=MAIN   2269 2278 2280 2326 2361#
IZMT2. . . . . . .  C ADDR   0D24H   R   SEG=MAIN   2377 2382#
IZMT3. . . . . . .  C ADDR   0D2FH   R   SEG=MAIN   2382 2388#
JFINIS . . . . . .  C ADDR   1A10H   R   SEG=MAIN   4460 4468#
KD . . . . . . . .  C ADDR   1703H   R   SEG=MAIN   3768#
KEYB1. . . . . . .  C ADDR   0C0BH   R   SEG=MAIN   283 2219#
KEYB2. . . . . . .  C ADDR   0F9FH   R   SEG=MAIN   286 2758#
KFULL. . . . . . .  C ADDR   1268H   R   SEG=MAIN   3126 3161#
KGO23. . . . . . .  C ADDR   124EH   R   SEG=MAIN   3125 3148#
KLEV1. . . . . . .  C ADDR   120CH   R   SEG=MAIN   3095 3117#
KLEV2. . . . . . .  C ADDR   1211H   R   SEG=MAIN   3117 3119#
KLEV21 . . . . . .  C ADDR   122DH   R   SEG=MAIN   3123 3132#
KLEV22 . . . . . .  C ADDR   1216H   R   SEG=MAIN   3119 3123#
KLEV23 . . . . . .  C ADDR   1238H   R   SEG=MAIN   3132 3138#
KLMAS. . . . . . .  C ADDR   0344H   R   SEG=MAIN   751 789 797#
KNAVP. . . . . . .  C ADDR   1046H   R   SEG=MAIN   2803 2850#
KNIZM. . . . . . .  B ADDR   0023H.0 A      346# 1152 1374 1549 2328 2350 2351 2355
KNIZMON. . . . . .  C ADDR   0CFEH   R   SEG=MAIN   2350 2355#
KNKMP. . . . . . .  C ADDR   0F90H   R   SEG=MAIN   2753# 2797
KNLEFT . . . . . .  C ADDR   1053H   R   SEG=MAIN   2757 2856#
KNMEM. . . . . . .  C ADDR   11B7H   R   SEG=MAIN   2752 3058#
KNMENU . . . . . .  C ADDR   1036H   R   SEG=MAIN   2809 2843#
KNNUL. . . . . . .  C ADDR   106EH   R   SEG=MAIN   2756 2871#
KNOPT. . . . . . .  C ADDR   0D37H   R   SEG=MAIN   2217 2396#
KNRAZR . . . . . .  C ADDR   0D4CH   R   SEG=MAIN   2216 2410#
KNRIGHT. . . . . .  C ADDR   0C99H   R   SEG=MAIN   2259 2295#
KNVICH . . . . . .  C ADDR   0CB5H   R   SEG=MAIN   2268 2311#
KOEFKD . . . . . .  D ADDR   00A0H   A      376# 539
KOEFKM . . . . . .  D ADDR   0094H   A      370# 537 1112 1847
KOEFKP . . . . . .  D ADDR   0090H   A      369# 535 1107 1809
KONSTA . . . . . .  D ADDR   00BCH   A      389# 1236 3391 3553
KONSTB . . . . . .  D ADDR   00C0H   A      390# 1210 3421 3573
KON_B. . . . . . .  C ADDR   0DF1H   R   SEG=MAIN   2494 2513#
KOR0US . . . . . .  C ADDR   165BH   R   SEG=MAIN   1717 3656#
KOR0_AN. . . . . .  D ADDR   0084H   A      366# 1103 1736 1799 1837
KORDEC1. . . . . .  C ADDR   05A8H   R   SEG=MAIN   1088 1093#
KORDEC10 . . . . .  C ADDR   058EH   R   SEG=MAIN   1078#
KORNUL . . . . . .  C ADDR   0972H   R   SEG=MAIN   1027 1704#
KVVOD0 . . . . . .  C ADDR   1283H   R   SEG=MAIN   3105 3168 3177#
LABELA . . . . . .  C ADDR   0246H   R   SEG=MAIN   628# 653 1681
LABELB . . . . . .  C ADDR   08BCH   R   SEG=MAIN   1070 1400 1566# 1692 1696 1698
LABELC . . . . . .  C ADDR   0D4CH   R   SEG=MAIN   2411#
LABELE . . . . . .  C ADDR   0D15H   R   SEG=MAIN   2359 2369 2372 2375# 2416 2419 2431 2434
LABELF . . . . . .  C ADDR   0D6EH   R   SEG=MAIN   2215 2437#
LABELH . . . . . .  C ADDR   108EH   R   SEG=MAIN   2755 2886#
LABELI . . . . . .  C ADDR   13A0H   R   SEG=MAIN   2901 2953 3002 3328#
LABELI2. . . . . .  C ADDR   1104H   R   SEG=MAIN   2953# 2954
LABELK . . . . . .  C ADDR   11D2H   R   SEG=MAIN   2900 3071#
LABELL . . . . . .  C ADDR   0EB5H   R   SEG=MAIN   2563 2605 2614#
LABELL1. . . . . .  C ADDR   0E2EH   R   SEG=MAIN   2551# 2680 2729
LABELN . . . . . .  C ADDR   0F38H   R   SEG=MAIN   2689#
LABELP . . . . . .  C ADDR   13A0H   R   SEG=MAIN   3315 3326#
LABL2. . . . . . .  C ADDR   0EFCH   R   SEG=MAIN   2646# 3135
LABL21 . . . . . .  C ADDR   0ED5H   R   SEG=MAIN   2615 2629#
LABL22 . . . . . .  C ADDR   0EEBH   R   SEG=MAIN   2633 2638#
LABM . . . . . . .  C ADDR   12D4H   R   SEG=MAIN   3136 3231#
LADD . . . . . . .  C ADDR   1B51H   R   SEG=MAIN   729 765 1646 4695#
LADDX. . . . . . .  C ADDR   1B62H   R   SEG=MAIN   4719#
LAL22. . . . . . .  C ADDR   0ECDH   R   SEG=MAIN   2619 2624#
LBTOF. . . . . . .  C ADDR   042DH   A      5809#
LCMP . . . . . . .  C ADDR   194FH   R   SEG=MAIN   2077 2205 4275#
LDC_LONG . . . . .  C ADDR   1965H   R   SEG=MAIN   534 1644 1804 1842 2881 4295#
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   100

LDC_LTEMP. . . . .  C ADDR   1987H   R   SEG=MAIN   738 980 985 990 1055 1128 1136 1149 1189 1223 1227 1239 1263 1271
                                           1277 1294 1300 1415 1876 4331#
LDX_LONG . . . . .  C ADDR   19ADH   R   SEG=MAIN   4366#
LDX_LTEMP. . . . .  C ADDR   19D3H   R   SEG=MAIN   4404#
LEFCUR . . . . . .  C ADDR   1317H   R   SEG=MAIN   3263# 3299 3317
LEFMEM11 . . . . .  C ADDR   11DAH   R   SEG=MAIN   3096# 3118 3120
LEV220 . . . . . .  C ADDR   1219H   R   SEG=MAIN   3124# 3133
LEV2GO . . . . . .  C ADDR   0F5EH   R   SEG=MAIN   2688 2725#
LEVEL. . . . . . .  D ADDR   00B0H   A      383# 2282 2568 2586 2614 3062 3094 3179
LI21 . . . . . . .  C ADDR   1154H   R   SEG=MAIN   2997 2999#
LLDI2. . . . . . .  C ADDR   0CEDH   R   SEG=MAIN   2341 2345#
LLDI23 . . . . . .  C ADDR   0CE1H   R   SEG=MAIN   2333 2338#
LLDI3. . . . . . .  C ADDR   0CE8H   R   SEG=MAIN   2340 2342#
LLEV2. . . . . . .  C ADDR   0F23H   R   SEG=MAIN   2645 2678#
LLMUL. . . . . . .  C ADDR   1ABAH   R   SEG=MAIN   4589#
LLSUB. . . . . . .  C ADDR   1B3FH   R   SEG=MAIN   4671#
LLTOF. . . . . . .  C ADDR   0432H   A      5815#
LMUL . . . . . . .  C ADDR   1ABAH   R   SEG=MAIN   2035 4591#
LOAB12 . . . . . .  C ADDR   1822H   R   SEG=MAIN   3025 3982#
LOAD . . . . . . .  D ADDR   00B7H   A      387# 2399 2442 2888 3021 3679
LOADB. . . . . . .  C ADDR   1173H   R   SEG=MAIN   3016 3019# 3049 3055
LOADB2 . . . . . .  C ADDR   119CH   R   SEG=MAIN   3037 3041#
LOADCLE. . . . . .  C ADDR   11F8H   R   SEG=MAIN   3110# 3171
LOADKD . . . . . .  C ADDR   183FH   R   SEG=MAIN   4015#
LOADR2 . . . . . .  C ADDR   1831H   R   SEG=MAIN   3285 3311 3389 3415 3998#
LOADT. . . . . . .  C ADDR   1676H   R   SEG=MAIN   2401 2448 2894 3679#
LOADUS . . . . . .  C ADDR   1618H   R   SEG=MAIN   592 1200 1388 1748 1850 2308 2356 2868 3028 3600#
LOBLOK . . . . . .  C ADDR   12A0H   R   SEG=MAIN   3159 3190# 3198
LOCLE. . . . . . .  C ADDR   11F3H   R   SEG=MAIN   3099 3108#
LOD1 . . . . . . .  C ADDR   1685H   R   SEG=MAIN   3687# 3692
LODT . . . . . . .  C ADDR   1691H   R   SEG=MAIN   3699# 3704
LOIZMK . . . . . .  C ADDR   10D8H   R   SEG=MAIN   2926# 2958
LOLEVT . . . . . .  C ADDR   1678H   R   SEG=MAIN   2288 3680#
LOLIST . . . . . .  C ADDR   11E7H   R   SEG=MAIN   3101#
LOOP . . . . . . .  C ADDR   0AD7H   R   SEG=MAIN   1957# 1958
LOOPS. . . . . . .  C ADDR   1A13H   R   SEG=MAIN   4470# 4503
LOSPUS . . . . . .  C ADDR   164FH   R   SEG=MAIN   1718 3639#
LOTEXT . . . . . .  C ADDR   168DH   R   SEG=MAIN   1282 1286 1379 2319 2465 2473 2479 2485 2571 2578 2594 2603 2611
                                           2622 2626 2636 2640 2846 2919 2984 3060 3102 3111 3115 3129 3183 3191 3252
                                           3289 3399 3696#
LOTP . . . . . . .  C ADDR   1895H   R   SEG=MAIN   4056# 4066 4069
LOTPUS . . . . . .  C ADDR   188DH   R   SEG=MAIN   3634 4053#
LOU. . . . . . . .  C ADDR   0CF3H   R   SEG=MAIN   2328 2344 2348#
LOUIZM . . . . . .  C ADDR   0CD0H   R   SEG=MAIN   2328# 2353 3631
LOUTF. . . . . . .  C ADDR   0ED2H   R   SEG=MAIN   2618 2627# 2632 2679 2686
LOVICH . . . . . .  C ADDR   10CEH   R   SEG=MAIN   2922# 2951 2972 3428
LOWR . . . . . . .  C ADDR   1201H   R   SEG=MAIN   3108 3113#
LOWR1. . . . . . .  C ADDR   1203H   R   SEG=MAIN   3114# 3175
LSUB . . . . . . .  C ADDR   1B3FH   R   SEG=MAIN   1067 1163 1877 4672#
LTEMP. . . . . . .  N NUMB   0008H   A      992 994 995 996 2087 2090 2093 2096 2139 2140 2141 2142 3888 3889 3890
                                           3891 4087# 4461 4462 4463 4464 4473 4477 4481 4485 4488 4489 4490 4491
                                           4492 4493 4494 4495 4496 4497 4498 4499 4502 4505 4510 4514 4518 4528 4531
                                           4534 4537 4553 4556 4557 4559 4560 4562 4563 4565 4570 4571 4572 4573 4593
                                           4598 4606 4614 4619 4630 4638 4644 4652 4658 5026 5027 5066 5071 5073 5082
                                           5083 5084 5085 5316 5324 5337 5340 5343 5346 5926 5929 5932 5935
LWR. . . . . . . .  C ADDR   0B1CH   R   SEG=MAIN   2026# 2030
LWRX . . . . . . .  C ADDR   0AE0H   R   SEG=MAIN   1970# 1982
LWTOF. . . . . . .  C ADDR   042FH   A      5811#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   0B37H   R   SEG=MAIN   1467 2034 2039 2044# 2076
MAIN . . . . . . .  C SEG    1B9CH       REL=UNIT   237 294# 435
MANT1. . . . . . .  N NUMB   0002H   A      5024# 5051 5100 5101
MANT2. . . . . . .  N NUMB   0008H   A      5026# 5077 5078 5209 5211 5212 5214 5215 5217 5218 5220 5259 5260 5262
                                           5263 5265 5266 5268 5269 5273 5275 5278 5281 5379 5381 5382 5384 5385 5387
                                           5388 5390 5441 5443 5444 5446 5447 5449 5450 5452 5534 5538 5542 5546 5550
                                           5553 5556 5559
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   101

MARK0_8. . . . . .  C ADDR   0DF8H   R   SEG=MAIN   2496 2514 2516#
MARKER . . . . . .  D ADDR   00B2H   A      385# 513 2237 2495 2505 2513 2523 2529 2653 2660 2696 2703 2715 2777 2962
                                           2979 2995 3192 3210 3217 3253 3263 3290 3338 3357 3364 3394 3424 3489 3517
                                           3532 3543
MARLE. . . . . . .  C ADDR   15ACH   R   SEG=MAIN   3271 3529#
MARRI. . . . . . .  C ADDR   15B9H   R   SEG=MAIN   2723 3542#
MAS10. . . . . . .  C ADDR   0363H   R   SEG=MAIN   799 811#
MAS20. . . . . . .  C ADDR   03E0H   R   SEG=MAIN   811 864#
MAS5DIV. . . . . .  C ADDR   0509H   R   SEG=MAIN   981 986 991 998#
MASFULL. . . . . .  C ADDR   04DBH   R   SEG=MAIN   970 974#
MASS0. . . . . . .  X ADDR   0080H   A      398 399# 800 805 833 841 912 920 2012
MASS1. . . . . . .  X ADDR   0084H   A      400# 808 830 844 909 923
MASS10 . . . . . .  X ADDR   00A8H   A      409# 885 942
MASS11 . . . . . .  X ADDR   00ACH   A      410# 882 944
MASS12 . . . . . .  X ADDR   00B0H   A      411# 879 946
MASS13 . . . . . .  X ADDR   00B4H   A      412# 876 948
MASS14 . . . . . .  X ADDR   00B8H   A      413# 873 950
MASS15 . . . . . .  X ADDR   00BCH   A      414# 870 952
MASS16 . . . . . .  X ADDR   00C0H   A      415# 868 954
MASS17 . . . . . .  X ADDR   00C4H   A      416# 866 956
MASS18 . . . . . .  X ADDR   00C8H   A      417# 864 958
MASS19 . . . . . .  X ADDR   00CCH   A      418# 960
MASS2. . . . . . .  X ADDR   0088H   A      401# 827 846 906 925
MASS3. . . . . . .  X ADDR   008CH   A      402# 824 848 903 927
MASS4. . . . . . .  X ADDR   0090H   A      403# 821 850 900 929
MASS5. . . . . . .  X ADDR   0094H   A      404# 818 852 897 931
MASS6. . . . . . .  X ADDR   0098H   A      405# 816 854 895 933
MASS7. . . . . . .  X ADDR   009CH   A      406# 814 856 893 935
MASS8. . . . . . .  X ADDR   00A0H   A      407# 812 858 891 937
MASS9. . . . . . .  X ADDR   00A4H   A      408# 860 888 939
MASX5. . . . . . .  C ADDR   04FFH   R   SEG=MAIN   972 992#
MEAVP. . . . . . .  C ADDR   104EH   R   SEG=MAIN   2850 2853#
MECLE. . . . . . .  C ADDR   016FH   R   SEG=MAIN   494# 496
MEFF . . . . . . .  C ADDR   0176H   R   SEG=MAIN   498# 501
MEM12NO. . . . . .  C ADDR   127FH   R   SEG=MAIN   3169 3173#
MIDL . . . . . . .  C ADDR   1A46H   R   SEG=MAIN   4465 4500#
MIGN . . . . . . .  C ADDR   157EH   R   SEG=MAIN   1889 3489#
MIGNN. . . . . . .  C ADDR   1586H   R   SEG=MAIN   3491 3496#
MLABL2 . . . . . .  C ADDR   12B7H   R   SEG=MAIN   3184 3202# 3233
MMM. . . . . . . .  C ADDR   0241H   R   SEG=MAIN   623#
MO220. . . . . . .  C ADDR   079AH   R   SEG=MAIN   1181 1373#
MO500I . . . . . .  C ADDR   070AH   R   SEG=MAIN   1229 1285#
MO500R . . . . . .  C ADDR   06FEH   R   SEG=MAIN   1225 1281#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   0E68H   R   SEG=MAIN   2582# 2591 2600 2608
MOVE28 . . . . . .  C ADDR   0BA4H   R   SEG=MAIN   1057 1138 1212 1231 1802 1840 2139#
MOVE82 . . . . . .  C ADDR   1791H   R   SEG=MAIN   3888#
MOVEA3 . . . . . .  C ADDR   0807H   R   SEG=MAIN   1425 1450#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2497 2668 2708 2981 3158 3195 3226 3256 3264 3293 3339 3367 3397
                                           3536
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2493 2661 2665 2704 2982 3157 3194 3218 3222 3255 3268 3292 3343
                                           3396 3545
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      5376# 5419
MUP11. . . . . . .  C ADDR   0257H   A      5423# 5468
MUP2 . . . . . . .  C ADDR   0297H   A      5453 5467#
MUP3 . . . . . . .  C ADDR   026CH   A      5422 5438#
MVV11. . . . . . .  C ADDR   129BH   R   SEG=MAIN   3180 3188#
MVV12. . . . . . .  C ADDR   12B3H   R   SEG=MAIN   3188 3197#
N12DELCH . . . . .  C ADDR   0A4CH   R   SEG=MAIN   1855 1863#
N4DELCH. . . . . .  C ADDR   09FDH   R   SEG=MAIN   1782 1820#
N8DELCH. . . . . .  C ADDR   0A3AH   R   SEG=MAIN   1820 1855#
NBIMENU. . . . . .  C ADDR   0E6EH   R   SEG=MAIN   2565 2585#
NBLOK. . . . . . .  D ADDR   00C4H   A      391# 3248
NE05 . . . . . . .  C ADDR   0358H   A      5605 5607 5609 5612#
NEXIN. . . . . . .  C ADDR   0A72H   R   SEG=MAIN   1892# 1899
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   102

NMINUS . . . . . .  C ADDR   05C5H   R   SEG=MAIN   1109 1113#
NNDELCH. . . . . .  C ADDR   09BDH   R   SEG=MAIN   1772 1782#
NNMEMB . . . . . .  C ADDR   0F6AH   R   SEG=MAIN   2584 2730#
NNNUL. . . . . . .  C ADDR   0880H   R   SEG=MAIN   1530 1533#
NO . . . . . . . .  C ADDR   1A2EH   R   SEG=MAIN   4475 4479 4483 4487#
NO0KEY . . . . . .  C ADDR   0253H   R   SEG=MAIN   632 637#
NO11V6 . . . . . .  C ADDR   0DB7H   R   SEG=MAIN   2462 2476#
NO12V6 . . . . . .  C ADDR   0DC4H   R   SEG=MAIN   2476 2482#
NO13V6 . . . . . .  C ADDR   0DD1H   R   SEG=MAIN   2482 2490#
NO21P7 . . . . . .  C ADDR   1426H   R   SEG=MAIN   3377 3406#
NO2PARN. . . . . .  C ADDR   07F3H   R   SEG=MAIN   1427 1433#
NO31N. . . . . . .  C ADDR   132BH   R   SEG=MAIN   3261 3274#
NO3PARN. . . . . .  C ADDR   07E9H   R   SEG=MAIN   1427# 1510
NO4DEL . . . . . .  C ADDR   0998H   R   SEG=MAIN   1722 1753#
NOAVK. . . . . . .  C ADDR   059AH   R   SEG=MAIN   1038 1085#
NOAVP. . . . . . .  C ADDR   0614H   R   SEG=MAIN   1154# 1191 1194
NOBAVP . . . . . .  C ADDR   089DH   R   SEG=MAIN   1545 1549#
NOBEF99. . . . . .  C ADDR   02FCH   R   SEG=MAIN   735 752# 771
NOBIT. . . . . . .  C ADDR   0245H   A      5391 5405#
NOBITIZM . . . . .  C ADDR   08A3H   R   SEG=MAIN   1284 1288 1368 1549 1552#
NOBUF0 . . . . . .  C ADDR   095AH   R   SEG=MAIN   1655 1686#
NOCHI0 . . . . . .  C ADDR   07CAH   R   SEG=MAIN   1182 1399#
NOCHN10. . . . . .  C ADDR   04F7H   R   SEG=MAIN   983 988#
NOCHN2 . . . . . .  C ADDR   04ECH   R   SEG=MAIN   978 983#
NODI2. . . . . . .  C ADDR   07B0H   R   SEG=MAIN   1376 1383#
NODI6. . . . . . .  C ADDR   105CH   R   SEG=MAIN   2858 2862#
NODI8. . . . . . .  C ADDR   0857H   R   SEG=MAIN   1494 1500#
NODI9. . . . . . .  C ADDR   07B5H   R   SEG=MAIN   1385 1388#
NODIS9 . . . . . .  C ADDR   0866H   R   SEG=MAIN   1500 1512#
NOEQU1 . . . . . .  C ADDR   0F4FH   R   SEG=MAIN   2707 2711#
NOEQU2 . . . . . .  C ADDR   1325H   R   SEG=MAIN   3267 3271#
NOFIZM . . . . . .  C ADDR   0D95H   R   SEG=MAIN   2438 2460#
NOFT1. . . . . . .  C ADDR   0D81H   R   SEG=MAIN   2443 2447#
NOFZ . . . . . . .  C ADDR   0955H   R   SEG=MAIN   1678 1681#
NOH37. . . . . . .  C ADDR   10E5H   R   SEG=MAIN   2915 2936# 2945
NOHNOT1. . . . . .  C ADDR   11ACH   R   SEG=MAIN   3011 3050#
NOHNOT2. . . . . .  C ADDR   11A4H   R   SEG=MAIN   3044# 3050
NOKORR . . . . . .  C ADDR   052CH   R   SEG=MAIN   1025 1028#
NOLAH. . . . . . .  C ADDR   10AFH   R   SEG=MAIN   2886 2903#
NOLEV1 . . . . . .  C ADDR   0EF3H   R   SEG=MAIN   2629 2643#
NOM31. . . . . . .  C ADDR   130EH   R   SEG=MAIN   3231 3259#
NOM32. . . . . . .  C ADDR   135DH   R   SEG=MAIN   3259 3297#
NOM33. . . . . . .  C ADDR   1388H   R   SEG=MAIN   3297 3315#
NOMARL . . . . . .  C ADDR   13C8H   R   SEG=MAIN   3341 3347 3351#
NOME11 . . . . . .  C ADDR   126FH   R   SEG=MAIN   3166#
NOMEM11. . . . . .  C ADDR   0E89H   R   SEG=MAIN   2587 2597#
NOMEM12. . . . . .  C ADDR   0E9FH   R   SEG=MAIN   2597 2605#
NOMEMK . . . . . .  C ADDR   126CH   R   SEG=MAIN   3070 3163#
NON1C. . . . . . .  C ADDR   0D5DH   R   SEG=MAIN   2417 2421#
NONULAVT . . . . .  C ADDR   0582H   R   SEG=MAIN   1033 1072#
NONULDEL . . . . .  C ADDR   097FH   R   SEG=MAIN   1705 1721#
NOP3_0 . . . . . .  C ADDR   07CEH   R   SEG=MAIN   1405#
NOPART1. . . . . .  C ADDR   0300H   R   SEG=MAIN   724 759#
NOPART2. . . . . .  C ADDR   0320H   R   SEG=MAIN   759 778#
NOPART3. . . . . .  C ADDR   0325H   R   SEG=MAIN   778 781#
NOPART4. . . . . .  C ADDR   0338H   R   SEG=MAIN   781 790#
NOPLUS . . . . . .  C ADDR   0E20H   R   SEG=MAIN   2541 2544#
NOPOIN7. . . . . .  C ADDR   13DFH   R   SEG=MAIN   3337 3372#
NOPOINT. . . . . .  C ADDR   13ABH   R   SEG=MAIN   3331 3335#
NOR11. . . . . . .  C ADDR   0E34H   R   SEG=MAIN   2468 2555#
NOR13. . . . . . .  C ADDR   0DAAH   R   SEG=MAIN   2470#
NORDN. . . . . . .  C ADDR   00F6H   A      5112# 5145
NORDN1 . . . . . .  C ADDR   0107H   A      5114 5128#
NORIG2 . . . . . .  C ADDR   0F2CH   R   SEG=MAIN   2675 2683#
NORIM6 . . . . . .  C ADDR   0F6AH   R   SEG=MAIN   2575 2731#
NORM1. . . . . . .  C ADDR   00F0H   A      5107# 5304 5481 5583 5800
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   103

NORR11 . . . . . .  C ADDR   10F7H   R   SEG=MAIN   2947#
NORR12 . . . . . .  C ADDR   1107H   R   SEG=MAIN   2947 2954# 2968
NORUP. . . . . . .  C ADDR   0119H   A      5111 5148#
NORUP1 . . . . . .  C ADDR   011EH   A      5153# 5171
NORUP2 . . . . . .  C ADDR   0132H   A      5155 5172#
NORVICH. . . . . .  C ADDR   08B5H   R   SEG=MAIN   1509 1562#
NOSUB. . . . . . .  C ADDR   1A69H   R   SEG=MAIN   4509 4513 4517 4522#
NOT1IN . . . . . .  C ADDR   095DH   R   SEG=MAIN   1659 1690#
NOT1_7 . . . . . .  C ADDR   1023H   R   SEG=MAIN   2825 2832#
NOT2IN . . . . . .  C ADDR   0965H   R   SEG=MAIN   1690 1694#
NOT2_7 . . . . . .  C ADDR   102EH   R   SEG=MAIN   2832 2837#
NOT3IN . . . . . .  C ADDR   096DH   R   SEG=MAIN   1694 1697#
NOTAKT . . . . . .  C ADDR   08ADH   R   SEG=MAIN   1553 1557#
NOTT1. . . . . . .  C ADDR   0940H   R   SEG=MAIN   1665 1669#
NOTT5. . . . . . .  C ADDR   0945H   R   SEG=MAIN   1669 1673#
NOT_1. . . . . . .  C ADDR   0D67H   R   SEG=MAIN   2421 2422 2433#
NOT_10 . . . . . .  C ADDR   0D67H   R   SEG=MAIN   2432#
NOVIR. . . . . . .  C ADDR   0E41H   R   SEG=MAIN   2459 2565#
NOVIR1 . . . . . .  C ADDR   0D92H   R   SEG=MAIN   2459# 2460
NOZZMI . . . . . .  C ADDR   0847H   R   SEG=MAIN   1489 1491#
NSEC01 . . . . . .  C ADDR   0889H   R   SEG=MAIN   1534 1537#
NSEC1. . . . . . .  C ADDR   0890H   R   SEG=MAIN   1537 1540#
NSEC10 . . . . . .  C ADDR   0895H   R   SEG=MAIN   1536 1539 1540 1544#
NULAVT . . . . . .  C ADDR   09AAH   R   SEG=MAIN   1770#
NUMSIZE. . . . . .  N NUMB   0004H   A      4090# 4112 4150 4157 4232 4252
OBOARD . . . . . .  C ADDR   199FH   R   SEG=MAIN   4333 4347#
OBOARD1. . . . . .  C ADDR   19E7H   R   SEG=MAIN   4406 4419#
OK1. . . . . . . .  C ADDR   0186H   A      5238 5253#
OK2. . . . . . . .  C ADDR   01A0H   A      5255 5270#
OK3. . . . . . . .  C ADDR   01C4H   A      5287 5303#
ONBOAR1. . . . . .  C ADDR   19C5H   R   SEG=MAIN   4368 4385#
ONBOARD. . . . . .  C ADDR   1979H   R   SEG=MAIN   4297 4311#
ONMEM11. . . . . .  C ADDR   11C5H   R   SEG=MAIN   2848 2852 2854 3064#
ONMIG. . . . . . .  C ADDR   1594H   R   SEG=MAIN   3500 3509#
ONVICH . . . . . .  C ADDR   0CC8H   R   SEG=MAIN   2311 2323#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 474
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 467 471
OUT6 . . . . . . .  C ADDR   0F6AH   R   SEG=MAIN   2214 2274 2381 2386 2391 2408 2445 2450 2457 2564 2573 2580 2732#
OUT7 . . . . . . .  C ADDR   1454H   R   SEG=MAIN   2753 2754 2829 2836 2840 2891 2896 3369 3374 3403 3431#
OUTA . . . . . . .  C ADDR   15C6H   R   SEG=MAIN   2986 3553#
OUTA2. . . . . . .  C ADDR   15E0H   R   SEG=MAIN   3564# 3569
OUTB . . . . . . .  C ADDR   15E9H   R   SEG=MAIN   3400 3573#
OUTB2. . . . . . .  C ADDR   160FH   R   SEG=MAIN   3591# 3596
OUTB3. . . . . . .  C ADDR   15FAH   R   SEG=MAIN   3577 3582#
OUTF . . . . . . .  C ADDR   0D88H   R   SEG=MAIN   2441 2453# 2466 2474 2480 2486 2511 2534 2543 2546 2553 2582 2595
                                           2604 2612 2623 2627 2637 2641 2667 2670 2710 2724 2727
OUTFL. . . . . . .  C ADDR   0E31H   R   SEG=MAIN   2549 2553#
OUTMA. . . . . . .  C ADDR   0E0AH   R   SEG=MAIN   2532 2534#
OUTR . . . . . . .  C ADDR   0761H   R   SEG=MAIN   1314 1337#
OUTR5. . . . . . .  C ADDR   077DH   R   SEG=MAIN   1335 1356#
OUTVIR . . . . . .  C ADDR   0C73H   R   SEG=MAIN   2244 2271#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 4289
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 1892 1896
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 445
P1 . . . . . . . .  D ADDR   0090H   A      32# 595 596 1905 1907 1910 1913 1917 1919 1920 2169 2172 2174 2177 2183
                                           2185 2187 3955 3962
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 446
P2 . . . . . . . .  D ADDR   00A0H   A      47# 1938 1942 1951
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 447
P3 . . . . . . . .  D ADDR   00B0H   A      62# 456 1937 1939 1941 1947 1948 1949 1952 1953 2243 2245 2247 2248 2251
                                           2252 2254 2255 2257 2258 2260 2261 2263 2264 2266 2267 2439 2440 2490 2491
                                           2536 2537 2547 2548 2566 2567 2589 2590 2598 2599 2606 2607 2616 2617 2630
                                           2631 2644 2645 2678 2679 2687 2688 2725 2726 2748 2784 2786 2788 2789 2792
                                           2793 2795 2796 2798 2799 2801 2802 2804 2805 2807 2808 2887 2889 2914 2915
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   104

                                           2936 2937 2948 2949 2955 2956 2969 2970 3009 3010 3096 3097 3124 3125 3139
                                           3140 3141 3142 3148 3149 3166 3167 3177 3178 3232 3233 3234 3235 3260 3261
                                           3274 3275 3298 3299 3300 3301 3316 3317 3318 3319 3329 3330 3335 3336 3372
                                           3373 3447
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2745 2747 3444 3446
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 449
P4 . . . . . . . .  D ADDR   0084H   A      20# 2335 2337 3609 3612 3628 3630 4058
P5 . . . . . . . .  D ADDR   0085H   A      21# 519 527 1773 1778 1813 1815 2345 2347 3617 3620 3650 3653 4062
P6 . . . . . . . .  D ADDR   0086H   A      22# 597 599 603 605
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 450
PACK1. . . . . . .  C ADDR   00DEH   A      5090# 5305 5482 5584 5801
PARN . . . . . . .  D ADDR   00AFH   A      382# 524 1523 2364 2412 2813 3034
PART . . . . . . .  D ADDR   009AH   A      372# 520 722 1012 1045 1072 1085 1533 1563 1663 1674 2375 2413 2823 3019
                                           3033 3621 3982
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 443
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 444
PCON . . . . . . .  D ADDR   0087H   A      23#
POIN3. . . . . . .  C ADDR   13DEH   R   SEG=MAIN   3370# 3404
POINA. . . . . . .  C ADDR   1421H   R   SEG=MAIN   3368 3403#
POINA1 . . . . . .  C ADDR   13C3H   R   SEG=MAIN   3340 3347#
POINA2 . . . . . .  C ADDR   13BDH   R   SEG=MAIN   3343# 3348
POZB . . . . . . .  C ADDR   1444H   R   SEG=MAIN   3417 3421#
PROD . . . . . . .  N NUMB   000CH   A      5027# 5371 5372 5373 5374 5394 5395 5396 5398 5399 5401 5402 5404 5426
                                           5428 5429 5431 5432 5434 5435 5437 5456 5457 5458 5460 5461 5463 5464 5466
                                           5477 5478 5479 5480 5501 5502 5503 5504 5520 5522 5523 5525 5526 5528 5529
                                           5531 5561 5578 5579 5580 5581
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 5832 5836 5889 5892
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 2078 2080 2223 2741 2761 3442 4762
                                           4770
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0C7DH   R   SEG=MAIN   2265 2276#
R10. . . . . . . .  N NUMB   000AH   A      430# 628 1034 1234 1242 4030 5855
R11. . . . . . . .  N NUMB   000BH   A      431# 629 1035 1235 1241 4034 5859
R8 . . . . . . . .  N NUMB   0008H   A      428# 1232 1244 2203 4022 5847
R9 . . . . . . . .  N NUMB   0009H   A      429# 1233 1243 2204 4026 5851
RAFTERK. . . . . .  C ADDR   0542H   R   SEG=MAIN   1042# 1048
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RE1. . . . . . . .  C ADDR   0BD9H   R   SEG=MAIN   2183# 2189
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   105

RE4BYTE. . . . . .  C ADDR   0454H   A      5843#
REACP. . . . . . .  D ADDR   0077H   A      304# 610 612 614 616 663 679 687 695 704 711 726 762 782 791 1787 1789
                                           1791 1793 1825 1827 1829 1831
READ . . . . . . .  C ADDR   0BD7H   R   SEG=MAIN   609 611 613 2182#
READYACP . . . . .  C ADDR   02B7H   R   SEG=MAIN   705 715#
READ_X2. . . . . .  C ADDR   0AC6H   R   SEG=MAIN   1946# 1957
REBYTE . . . . . .  C ADDR   020CH   R   SEG=MAIN   594# 639 753 1751 1761 1780 1818 1853 1862 1864
REBYTE2. . . . . .  C ADDR   046CH   A      1051 1132 5863#
REF0CN . . . . . .  D ADDR   00D1H   A      92# 451
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RESAR2 . . . . . .  C ADDR   0BB0H   R   SEG=MAIN   727 763 783 792 804 839 918 1060 1101 1140 1157 1211 1214 1237
                                           1260 1413 1461 1465 1725 2147# 2874 3554 3574
RESAR8 . . . . . .  C ADDR   0B6EH   R   SEG=MAIN   1066 1104 1113 1162 1800 1838 2086#
REZAM. . . . . . .  D ADDR   008CH   A      368# 1835
REZAP. . . . . . .  D ADDR   0088H   A      367# 1797
REZMUL . . . . . .  C ADDR   05ADH   R   SEG=MAIN   1080 1092 1099#
REZ_A. . . . . . .  D ADDR   0062H   A      357# 740 784 793 803 838 917 1724
REZ_A0 . . . . . .  D ADDR   006AH   A      359# 1065 1161 1205 1394 2306 2866 2875 2882
REZ_A1 . . . . . .  D ADDR   0066H   A      358# 1006 1063 1100 1145 1156 1213
REZ_A2 . . . . . .  D ADDR   007BH   A      360# 1158
REZ_A3 . . . . . .  D ADDR   009CH   A      374# 1068 1164 1412 1460 1464 1568 2873
REZ_AME. . . . . .  D ADDR   005EH   A      355# 1018 1059 1117 1139
REZ_DEL. . . . . .  D ADDR   00C5H   A      392# 742
REZ_R. . . . . . .  D ADDR   00C9H   A      393# 1246 1259
RGOTO7 . . . . . .  C ADDR   130BH   R   SEG=MAIN   3257# 3275 3301
RHNOR11. . . . . .  C ADDR   10DFH   R   SEG=MAIN   2913 2925 2931#
RHNOT1 . . . . . .  C ADDR   10A6H   R   SEG=MAIN   2889 2898#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RIGBLO . . . . . .  C ADDR   0EF6H   R   SEG=MAIN   2644# 2674 2676
RIGBLOK. . . . . .  C ADDR   0F32H   R   SEG=MAIN   2687#
RIGHT2 . . . . . .  C ADDR   0C90H   R   SEG=MAIN   2283 2287#
RIGHT3 . . . . . .  C ADDR   0C94H   R   SEG=MAIN   2285 2290#
RIKN . . . . . . .  C ADDR   0DE3H   R   SEG=MAIN   2497# 2515
RIMEN6 . . . . . .  C ADDR   0E5DH   R   SEG=MAIN   2569 2577#
RIZMAN . . . . . .  C ADDR   0C08H   R   SEG=MAIN   2218# 2253
RKNLEFT. . . . . .  C ADDR   0F9CH   R   SEG=MAIN   2757# 2800
RKNMEM . . . . . .  C ADDR   0F8DH   R   SEG=MAIN   2752# 2806
RKNNUL . . . . . .  C ADDR   0F99H   R   SEG=MAIN   2756# 2794
RKNOPT . . . . . .  C ADDR   0C05H   R   SEG=MAIN   2217# 2262
RKNRAZR. . . . . .  C ADDR   0C02H   R   SEG=MAIN   2216# 2256
RKVVOD0. . . . . .  C ADDR   11F0H   R   SEG=MAIN   3098 3105#
RLABELF. . . . . .  C ADDR   0BFFH   R   SEG=MAIN   2215# 2250
RLABELH. . . . . .  C ADDR   0F96H   R   SEG=MAIN   2755# 2791
RLABELI. . . . . .  C ADDR   10ACH   R   SEG=MAIN   2901#
RLABELK. . . . . .  C ADDR   10A9H   R   SEG=MAIN   2900# 2903
RLABELL1 . . . . .  C ADDR   0F67H   R   SEG=MAIN   2726 2729#
RLABL2 . . . . . .  C ADDR   1232H   R   SEG=MAIN   3135# 3140
RLABM. . . . . . .  C ADDR   1235H   R   SEG=MAIN   3136# 3138
RLER . . . . . . .  C ADDR   15B8H   R   SEG=MAIN   3537 3539#
RMO220 . . . . . .  C ADDR   0636H   R   SEG=MAIN   1181#
RNNMEMB. . . . . .  C ADDR   0E6BH   R   SEG=MAIN   2584# 2585
RNO3PARN . . . . .  C ADDR   0864H   R   SEG=MAIN   1510# 1524
RNOCHI0. . . . . .  C ADDR   0639H   R   SEG=MAIN   1169 1182#
RNOH37 . . . . . .  C ADDR   10F5H   R   SEG=MAIN   2945# 2949 2956 2970
RNOMEMK. . . . . .  C ADDR   11CFH   R   SEG=MAIN   3070# 3093
RNOR11 . . . . . .  C ADDR   0DA7H   R   SEG=MAIN   2468# 2470
RNORIM6. . . . . .  C ADDR   0E5AH   R   SEG=MAIN   2567 2575#
RNORVICH . . . . .  C ADDR   0862H   R   SEG=MAIN   1455 1456 1509#
RNOT1IN. . . . . .  C ADDR   0933H   R   SEG=MAIN   1565 1659#
ROUT6. . . . . . .  C ADDR   0BFCH   R   SEG=MAIN   2214# 2249
ROUT7. . . . . . .  C ADDR   0F93H   R   SEG=MAIN   2754# 2785 2790
ROUTF. . . . . . .  C ADDR   10F2H   R   SEG=MAIN   2941# 3010
RR0. . . . . . . .  N NUMB   0000H   A      421# 2224 2740 2762 3441
RR1. . . . . . . .  N NUMB   0001H   A      422# 2225 2739 2763 3440
RR2. . . . . . . .  N NUMB   0002H   A      424# 1873 2226 2738 2764 3439
RR3. . . . . . . .  N NUMB   0003H   A      425# 1874 2227 2737 2765 3438
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   106

RR4. . . . . . . .  N NUMB   0004H   A      2228 2736 2766 3437 4091# 4148 4169 4185 4229 4251
RR5. . . . . . . .  N NUMB   0005H   A      2229 2735 2767 3436 4092# 4149 4156 4163 4230 4239
RR6. . . . . . . .  N NUMB   0006H   A      423# 2230 2734 2768 3435
RR7. . . . . . . .  N NUMB   0007H   A      426# 2231 2733 2769 3434
RRIR . . . . . . .  C ADDR   15C5H   R   SEG=MAIN   3548 3550#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   07FCH   R   SEG=MAIN   1439# 1457
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 481
RTIZMRI. . . . . .  C ADDR   0D6BH   R   SEG=MAIN   2436#
RVVIZKO. . . . . .  C ADDR   10E1H   R   SEG=MAIN   2933# 2938
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2241 2510 2528 2658 2701 2721 2781 3215 3362 3501 3509
SAVEIR2. . . . . .  C ADDR   0AF2H   R   SEG=MAIN   806 842 921 1985#
SAVELTE. . . . . .  C ADDR   04A7H   A      5926#
SAVER2 . . . . . .  C ADDR   0AFEH   R   SEG=MAIN   536 538 540 731 741 743 767 785 794 1007 1019 1064 1069 1118 1146
                                           1159 1165 1247 1251 1469 1737 1798 1810 1836 1848 1999# 2876 2883 3392
                                           3422 3557 3584
SBUF0. . . . . . .  D ADDR   0099H   A      40#
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   0A88H   R   SEG=MAIN   1905# 1912
SDV1 . . . . . . .  C ADDR   0A9CH   R   SEG=MAIN   1917# 1923
SDVIG0 . . . . . .  C ADDR   0298H   R   SEG=MAIN   691# 693
SDVIG1 . . . . . .  C ADDR   028DH   R   SEG=MAIN   683# 685
SDVIG2 . . . . . .  C ADDR   0282H   R   SEG=MAIN   675# 677
SDVIG3 . . . . . .  C ADDR   0276H   R   SEG=MAIN   666# 668
SDVIG4 . . . . . .  C ADDR   02A7H   R   SEG=MAIN   701# 703
SDVIG6 . . . . . .  C ADDR   02B1H   R   SEG=MAIN   708# 710
SDVM . . . . . . .  C ADDR   02AFH   R   SEG=MAIN   698 707#
SEEGOON. . . . . .  C ADDR   0869H   R   SEG=MAIN   1499 1507 1514#
SEEIND . . . . . .  C ADDR   0877H   R   SEG=MAIN   1431 1438 1439 1527#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      5022# 5043 5044 5069 5070 5094 5237 5254 5475 5515
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   115CH   R   SEG=MAIN   3005# 3020
SP . . . . . . . .  D ADDR   0081H   A      17# 442
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 487
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 486
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 1894
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SS1. . . . . . . .  C ADDR   16B2H   R   SEG=MAIN   3731# 3733
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      386# 728 730 745 764 766 1203 1392 2304 2864
SUMT2. . . . . . .  C ADDR   0303H   R   SEG=MAIN   719 761#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   1814H   R   SEG=MAIN   3973# 3983
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   107

TABN . . . . . . .  C ADDR   18ACH   R   SEG=MAIN   4075# 4079
TABT11 . . . . . .  C ADDR   1670H   R   SEG=MAIN   3670# 4055
TABT7. . . . . . .  C ADDR   1674H   R   SEG=MAIN   3674# 4068
TABT9. . . . . . .  C ADDR   1672H   R   SEG=MAIN   3672# 4065
TABUS. . . . . . .  C ADDR   165CH   R   SEG=MAIN   3606 3659#
TAKTIND. . . . . .  C ADDR   08B2H   R   SEG=MAIN   1556 1559#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 478 479
TE22 . . . . . . .  C ADDR   189FH   R   SEG=MAIN   4054 4064#
TE23 . . . . . . .  C ADDR   18A7H   R   SEG=MAIN   4064 4068#
TEAEQU0. . . . . .  C ADDR   14C1H   R   SEG=MAIN   2983 3465#
TEBBL. . . . . . .  C ADDR   1557H   R   SEG=MAIN   3251 3482#
TEBEQU0. . . . . .  C ADDR   14CBH   R   SEG=MAIN   3398 3466#
TEBL . . . . . . .  C ADDR   154DH   R   SEG=MAIN   3128 3481#
TEBLOK . . . . . .  C ADDR   1543H   R   SEG=MAIN   3190 3480#
TECLE. . . . . . .  C ADDR   1512H   R   SEG=MAIN   2610 3059 3110 3475#
TEEBL. . . . . . .  C ADDR   1561H   R   SEG=MAIN   3288 3483#
TEFULL . . . . . .  C ADDR   1539H   R   SEG=MAIN   3182 3479#
TEIZMK . . . . . .  C ADDR   14F4H   R   SEG=MAIN   2464 2472 2927 3472#
TEKALIB. . . . . .  C ADDR   14E9H   R   SEG=MAIN   2570 3471#
TELIST . . . . . .  C ADDR   152EH   R   SEG=MAIN   2602 3101 3478#
TEMEM. . . . . . .  C ADDR   151CH   R   SEG=MAIN   3476#
TEMENU . . . . . .  C ADDR   14D5H   R   SEG=MAIN   2845 3467#
TENMIN . . . . . .  C ADDR   171FH   R   SEG=MAIN   1077 1079 1091 3776#
TEOLI. . . . . . .  C ADDR   156BH   R   SEG=MAIN   1285 3485#
TEOLL. . . . . . .  C ADDR   1508H   R   SEG=MAIN   1378 3474#
TEOLR. . . . . . .  C ADDR   1575H   R   SEG=MAIN   1281 3486#
TEOUT. . . . . . .  C ADDR   14FEH   R   SEG=MAIN   2478 2557 2918 3473#
TETEST . . . . . .  C ADDR   14DFH   R   SEG=MAIN   2577 3469#
TEVICH . . . . . .  C ADDR   14B7H   R   SEG=MAIN   2318 2484 2923 3464#
TEWR . . . . . . .  C ADDR   1524H   R   SEG=MAIN   2593 3114 3477#
TEXTT. . . . . . .  C ADDR   147BH   R   SEG=MAIN   3455# 3686
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 461
TH1. . . . . . . .  D ADDR   008DH   A      29#
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   0AACH   R   SEG=MAIN   1926#
TIM1 . . . . . . .  C ADDR   0AAEH   R   SEG=MAIN   1927# 1927
TIM2 . . . . . . .  C ADDR   0AB1H   R   SEG=MAIN   1908 1911 1918 1922 1930# 2173 2175 2184 2188
TIM3 . . . . . . .  C ADDR   0AB3H   R   SEG=MAIN   1931# 1931
TIZMRI . . . . . .  C ADDR   0C89H   R   SEG=MAIN   2282# 2436
TL0. . . . . . . .  D ADDR   008AH   A      26# 462
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   1159H   R   SEG=MAIN   2990 3002#
TMOD . . . . . . .  D ADDR   0089H   A      25# 459
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 476
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 475
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TOUTF. . . . . . .  C ADDR   10E3H   R   SEG=MAIN   2934# 2934 2937
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 1895
UNPACK1. . . . . .  C ADDR   009EH   A      5040# 5234 5368 5498 5612
UNPACK2. . . . . .  C ADDR   00BAH   A      5065# 5235 5369 5499
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   108

UP1. . . . . . . .  C ADDR   0138H   A      5185# 5202
UP2. . . . . . . .  C ADDR   014BH   A      5205# 5223
UP2A . . . . . . .  C ADDR   0161H   A      5184 5221#
UPA. . . . . . . .  C ADDR   174EH   R   SEG=MAIN   3829# 3835
UPA1 . . . . . . .  C ADDR   175EH   R   SEG=MAIN   3847# 3853
UPA2 . . . . . . .  C ADDR   173EH   R   SEG=MAIN   3812# 3818
UPAA . . . . . . .  C ADDR   17A0H   R   SEG=MAIN   3901# 3907
UPAB . . . . . . .  C ADDR   17B0H   R   SEG=MAIN   3918# 3924
UPAK . . . . . . .  C ADDR   1748H   R   SEG=MAIN   3826#
UPAK2. . . . . . .  C ADDR   1738H   R   SEG=MAIN   3242 3809#
UPAK3. . . . . . .  C ADDR   1758H   R   SEG=MAIN   3281 3307 3844#
UPAKA. . . . . . .  C ADDR   179AH   R   SEG=MAIN   3384 3898#
UPAKB. . . . . . .  C ADDR   17AAH   R   SEG=MAIN   3411 3915#
VICHR. . . . . . .  D ADDR   00B1H   A      384# 2315 2324 2461 2912 2974 3375 3426 4053
VIG0 . . . . . . .  C ADDR   08FAH   R   SEG=MAIN   1619# 1621
VIG4 . . . . . . .  C ADDR   0908H   R   SEG=MAIN   1630# 1632
VIOUT. . . . . . .  C ADDR   0D42H   R   SEG=MAIN   2321 2404#
VVCHIF . . . . . .  C ADDR   159CH   R   SEG=MAIN   2551 3516#
VVIZKO . . . . . .  C ADDR   112CH   R   SEG=MAIN   2933 2974#
VVRR6. . . . . . .  C ADDR   0D9FH   R   SEG=MAIN   2464#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 457 458
WORK . . . . . . .  D ADDR   00B8H   A      388# 1266 1268 1274 1290 1297 1313 1334 1339 1355 1570 1645
WR1. . . . . . . .  C ADDR   0BC4H   R   SEG=MAIN   2169# 2176
WRITE. . . . . . .  C ADDR   0BC1H   R   SEG=MAIN   607 2167# 3944 3946 3948 3950 3952 3954 3957 3959 3961 3964 3966
                                           3968
WRITED_X1. . . . .  C ADDR   0AB7H   R   SEG=MAIN   1936#
WRITE_X1 . . . . .  C ADDR   0AB6H   R   SEG=MAIN   1935#
WRPAGE . . . . . .  C ADDR   0480H   A      5887#
WW5. . . . . . . .  C ADDR   0483H   A      5888# 5896
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 453 485
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 454
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 455 484
XCIKLWR. . . . . .  C ADDR   0ADEH   R   SEG=MAIN   801 813 815 817 820 823 826 829 832 835 865 867 869 872 875 878
                                           881 884 887 889 892 894 896 899 902 905 908 911 914 1968#
XTEMP. . . . . . .  N NUMB   000CH   A      4088# 4452 4453 4454 4455 4541 4543 4544 4546 4547 4549 4550 4552 4574
                                           4575 4576 4577 4595 4596 4600 4601 4604 4608 4609 4612 4616 4617 4621 4622
                                           4624 4625 4626 4628 4632 4633 4635 4636 4640 4641 4646 4647 4649 4650 4654
                                           4655 4660 4662 4663 4664
YBNUL. . . . . . .  C ADDR   107FH   R   SEG=MAIN   2871 2879#
YES. . . . . . . .  C ADDR   1A4CH   R   SEG=MAIN   4474 4478 4482 4486 4504# 4567
YESAVP . . . . . .  C ADDR   063CH   R   SEG=MAIN   1153 1185#
YESBUF . . . . . .  C ADDR   0937H   R   SEG=MAIN   1657 1662#
YESPRD . . . . . .  C ADDR   0935H   R   SEG=MAIN   1656 1660#
YESTEST. . . . . .  C ADDR   164BH   R   SEG=MAIN   3633#
YESTT5 . . . . . .  C ADDR   0958H   R   SEG=MAIN   1677 1684#
YESVICH. . . . . .  C ADDR   0669H   R   SEG=MAIN   1154 1209#
YESVIR . . . . . .  C ADDR   0E39H   R   SEG=MAIN   2562#
Z01S . . . . . . .  C ADDR   16CAH   R   SEG=MAIN   3748# 3750
Z100 . . . . . . .  C ADDR   169BH   R   SEG=MAIN   3712# 3714
Z15. . . . . . . .  C ADDR   16A9H   R   SEG=MAIN   3724# 3726
Z1S. . . . . . . .  C ADDR   16BDH   R   SEG=MAIN   3740# 3742
ZAPADC . . . . . .  C ADDR   0A86H   R   SEG=MAIN   1904#
ZCMP . . . . . . .  C ADDR   0B60H   R   SEG=MAIN   2076#
ZDIV . . . . . . .  C ADDR   0B2DH   R   SEG=MAIN   739 999 1416 2039#
ZER1 . . . . . . .  C ADDR   00B3H   A      5050 5054# 5109 5152
ZER2 . . . . . . .  C ADDR   00D4H   A      5076 5080#
ZMUL . . . . . . .  C ADDR   0B23H   R   SEG=MAIN   2034#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      316# 1489 2047 2050 2053
ZNPLUS . . . . . .  C ADDR   0269H   R   SEG=MAIN   618 655#
ZZ . . . . . . . .  C ADDR   16ABH   R   SEG=MAIN   3725# 3725
Z_01S. . . . . . .  C ADDR   16C6H   R   SEG=MAIN   650 651 652 1679 2234 2774 3513 3746#
Z_100. . . . . . .  C ADDR   1699H   R   SEG=MAIN   3711#
Z_15 . . . . . . .  C ADDR   16A7H   R   SEG=MAIN   586 3723#
Z_1MS. . . . . . .  C ADDR   16B0H   R   SEG=MAIN   3730#
Z_1S . . . . . . .  C ADDR   16B9H   R   SEG=MAIN   553 561 3738#
A51 MACRO ASSEMBLER  AMP22                                                                01/25/2007 16:42:21 PAGE   109

Z_5. . . . . . . .  C ADDR   16A2H   R   SEG=MAIN   1940 1950 3718#
Z_9. . . . . . . .  C ADDR   0BBCH   R   SEG=MAIN   1897 2161#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
