A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp33.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp33.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236              
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                          jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti   
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 020000   F      262                                                     jmp             inter2  ;IE.5,IP.5(ET2,PT2)
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti 
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;53h..5dh 10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
  0039               310     nuerr                           DATA    39h;номер ошибки (для интерфейса)       
  0038               311     nblok                           DATA    38h;номер введенного блока
  0037               312     nelem                           DATA    37h;номер лемента в блоке 0..200
  0036               313     saus                            DATA    36h;сохр упр слово
  0034               314     sadiap                  DATA    34H;сохр диапазон на кот проходила запись блока1
  0033               315     chind2                          DATA    33h;счетчик индикации
  0032               316     sadiap2                 DATA    32h;сохр диапазон на кот проходила запись блока2
  0031               317     sadiap3                 DATA    31h;сохр диапазон на кот проходила запись блока3
  0030               318     sadiap4                 DATA    30h;сохр диапазон на кот проходила запись блока4
                     319     ;DATA           2fh
                     320     ;;;;;
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     6

  0020               321      cellbit                DATA    20h
  0000               322     bitznak         BIT     cellbit.0       ;20.0           
  0001               323     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               324     znmat           BIT             cellbit.2       ;20.2
  0003               325     bitrs           BIT             cellbit.3       ;20.3
  0004               326     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               327     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               328     bitvi11         BIT             cellbit.6       ;20.6   бит нажатия ввод режима вычислить R
                             !!!
  0007               329     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us 
                                  
                     330     
  0021               331     cellbit1                DATA    21h
  0008               332     bitbuf          BIT     cellbit1.0      ;21.0   
  0009               333     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               334     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               335     bitmem          BIT             cellbit1.3      ;21.3 нажата кн память
                     336     ;bmem11         BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               337     bifl_kt         BIT             cellbit1.5      ;21.5  бит для выч Км теста измерения  
                     338     ;bmem13         BIT             cellbit1.6      ;21.6            
  000F               339     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     340     
  0022               341     cellbit2                DATA    22h
  0010               342     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               343     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               344     bitklb          BIT             cellbit2.2      ;22.2  признак калибровки
  0013               345     bitv19          BIT             cellbit2.3      ;22.3           бит установки скор итерфейс
                             а 19.6
  0014               346     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               347     biteizm         BIT             cellbit2.5      ;22.5   признак теста измерения 
  0016               348     bitpar          BIT             cellbit2.6      ;22.6   бит проведенного 1раз пароля 
  0017               349     bitoll          BIT             cellbit2.7      ;22.7 бит перегрузки
                     350     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     351     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     352     ;и выдает т.н. буфер индикации  
  0023               353     cellbit3                DATA    23h
  0018               354     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               355     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               356     bitakt          BIT             cellbit3.2      ;22.2  бит такта
  001B               357     bitznB          BIT             cellbit3.3      ;22.3 БИТ ЗНАКА ПРИ ВВОДЕ константы В
                     358     ;bit            BIT             cellbit3.4      ;22.4    
                     359     ;bit            BIT             cellbit3.5      ;22.5    
                     360     ;bit            BIT             cellbit3.6      ;22.6            
                     361     ;bit            BIT             cellbit3.7      ;22.7
                     362             
  005E               363     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     364     ;hex
  0062               365     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               366     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               367     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               368     rez_A2   data 7bh; A2
                     369     
  0098               370     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               371     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               372     chdel    data  83h              ; счетчик задержки
                     373     ;float
  0084               374     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               375     rezAp    data  88h              ;4byte  A+
  008C               376     rezAm    data  8ch              ;4byte  A-
  0090               377     koefKp   data  90h              ;4byte  K+
  0094               378     koefKm   data  94h              ;4byte  K-
                     379     ;hex 
  009A               380     parT     data  9ah              ;параметр времени измерения
  009B               381     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               382     rez_A3   data  9ch              ;A3
                     383     ;FLOAT
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     7

  00A0               384     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               385     rez_Ak  data  0a4h         ;Ak
  00A8               386     parol           data  0a8h         ;храним в памяти пароль
  00AC               387     chind   data  0ach         ;счетчик индикации
                     388     ;chbuf  data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               389     diap    data  0aeh         ;номер диапазона
  00AF               390     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               391     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               392     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               393     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               394     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               395     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               396     work    data  0b8h        ;рабочая ячейка
  00BC               397     konstA  data  0bch        ;     введенная с крана константа A
                     398     ;konstB data  0c0h         ;    введенная с крана константа B
  00C0               399     saven_bl2       data    0c0h;;копия адреса последней записанной ячейки блока2
  00C2               400     saven_bl3       data  0c2h;копия адреса последней записанной ячейки блока3 
                     401                ;c4 1bait
  00C5               402     Rez_del data  0c5h      ;сумма n-значений /n
  00C9               403     rez_R           data    0c9h            ;рез вычисления R 4baita
  00CD               404     interva data  0cdh;значение интервала (запись)2baita
  00CF               405     chbuf   data  0cfh         ;счетчик периода загрузки в буфер и интерфейс
  00D3               406     saven_bl        data  0d3h;номер ячейки в блоке 2 baita
  00D5               407     volume          data    0d5h;объем блока 2 baita
  00D6               408     chblok          data    0d6h;volume;кол измерений блока
  00D7               409     copy_hl         data  0d7h;адрес ячейки блока для просмотра 
  00D9               410     saven_bl4       data  0d9h;копия адреса последней записанной ячейки блока4
                     411     ;data           0dbh e0h-граница стека
                     412     
                     413     ;внешнее ОЗУ 64K 
                     414     ;в обл внешнего озу 0..ffh читается страница рпзу и при записи в любую
                     415     ;ячейку  стирается целая страница 0..ffh рпзу
                     416     ;               XSEG AT 100h
                     417             PUBLIC    MASS0
  0100               418     MASS0  xdata 0100h;     скользящий массив измерения
  0104               419     MASS1  xdata 0104h;
  0108               420     MASS2  xdata 0108h;
  010C               421     MASS3  xdata 010ch;
  0110               422     MASS4  xdata 0110h;
  0114               423     MASS5  xdata 0114h;
  0118               424     MASS6  xdata 0118h;
  011C               425     MASS7  xdata 011ch;
  0120               426     MASS8  xdata 0120h;
  0124               427     MASS9  xdata 0124h;
  0128               428     MASS10  xdata 0128h;
  012C               429     MASS11  xdata 012ch;
  0130               430     MASS12  xdata 0130h;
  0134               431     MASS13  xdata 0134h;
  0138               432     MASS14  xdata 0138h;
  013C               433     MASS15  xdata 013ch;
  0140               434     MASS16  xdata 0140h;
  0144               435     MASS17  xdata 0144h;
  0148               436     MASS18  xdata 0148h;
  014C               437     MASS19  xdata 014ch;
  0E00               438     chbuf1  xdata 0e00h;счетчик буфера 1
                     439     ;xdata  0e04
                     440     
  0000               441                             rr0             EQU 00
  0001               442                     rr1       equ   01
  0006               443                     rr6   equ 06
  0002               444                     rr2       equ   02
  0003               445                     rr3       equ   03
  0007               446                     rr7   equ 07
                     447     
  0008               448                     r8   equ 08
  0009               449                     r9        equ   09
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     8

  000A               450                     r10       equ   10
  000B               451                     r11   equ 11
                     452     
                     453                     
                     454        
----                 455                  rseg     Main          ; Switch to this code segment.
                     456     
                     457                  using    0              ; Specify register bank for the following
                     458     
0100                 459     org 100h
                     460     ;$EJECT
                     461     
0100 7581E0          462     begin:     mov  sp, #0e0h
0103 75E900          463                                             mov             PCA0L,#00;=0x00;
0106 75D900          464                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          465                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          466                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          467                                             mov     P2MDOUT,#00;=0x00;
                     468             
0112 75A73F          469             mov     P3MDOUT,#3fh;
0115 75B5FF          470             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          471             mov     REF0CN,#03h;=0x03;
                     472             
011B 75E114          473             mov     XBR0,#14h;= 0x14;
011E 75E200          474             mov     XBR1,#00; =0x00;
0121 75E300          475             mov XBR2,#00;=0x00;
0124 75B0C0          476             mov     P3,#0c0h
0127 75FFDE          477             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          478             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          479             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          480             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          481             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          482             mov     TL0,#0f9h;=0xf9; 
0139 75E680          483             mov     EIE1,#80h;=0x80;
                     484     
013C 75D480          485             mov     DAC0CN,#80h;=0x80;
013F 75D780          486             mov     DAC1CN,#80h;=0x80;
0142 75B167          487             mov     OSCXCN,#67h;=0x67;
                     488     
                     489      
                     490     
0145 E5B1            491     gener:     mov a, oscxcn
0147 B4E7FB          492                cjne a,#11100111b,gener
                     493                            
014A 75B288          494             mov     OSCICN,#88h;=0x84;
014D 75CA00          495         mov TMR2RLL,#0;=0;
0150 75CBD1          496         mov TMR2RLH,#0d1h;=0xd1;
                     497       
0153 D28E            498                     setb  TCON.6                    ;регистр управления
0155 D28C            499                      setb tcon.4
                     500     
0157 75EF00          501             mov     RSTSRC,#0;=00   ;//источники сброса 
                     502     
                     503             
015A 75E340          504          mov        XBR2,#40h
015D 75E10E          505              mov    XBR0,#0eh;06h;16h
0160 75F803          506             mov             SPI0CN,#03
0163 759D31          507             mov             spi0ckr,#31H;;;;;;;;#04
                     508     ;установка скорости
0166 759850          509                                             mov             SCON0,#50h;01010000;скорость обмена
                              определяется таймером1
0169 758780          510                                             mov             PCON,#10000000b;удвоенная скорость 
                             передачи SMOD0=1
016C 758E10          511                                             mov             CKCON,#00010000b;TIM=1
016F 758920          512                                             mov             TMOD,#00100000b;реж2 внутр ист синх
                             р
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE     9

0172 758840          513                                             mov             TCON,#01000000b;счетчик запущен
                     514     ;;;;;
0175 75D900          515                                             mov             PCA0MD,#00              ;PCA 
0178 75DA00          516                                             mov             PCA0CPM0,#00000000b;00000110b;01000
                             010b;
017B 75EA00          517                                             mov             PCA0CPL0,#00
017E 75FA80          518                                             mov             PCA0CPH0,#80h
0181 75D840          519                                             mov             PCA0CN,#40h
0184 75C800          520                                             mov             T2CON,#00
                     521     ;;;;;;
0187 7A50            522                                             mov                     r2,#50h                    
                                  ;57.6->19.2
0189 7B2C            523                                             mov                     r3,#2ch
018B 120454          524                                             call            re4byte                 ;502ch 1 ba
                             it skor
018E E508            525                                             mov                     a,r8
0190 B40007          526                                             cjne            a,#00,yst19
0193 C213            527                                             clr                     bitv19                  ;57
                             .6
0195 758DF4          528                                             mov                     TH1,#244
0198 8008            529                                             jmp               yst1
019A 900000   F      530     yst19:          mov                     dptr,#teS19_2
019D D213            531                                             setb            bitv19                  ;19,2
019F 758DDC          532                                             mov                     TH1,#220
01A2                 533     yst1:
01A2 75E730          534                                             mov             EIE2,#30H;00110000
                     535                                     ;       mov             EIP2,#30H
01A5 75A880          536                                             mov     IE,#80h;//10000000      ;//Снятие блокировк
                             и всех прерываний
                     537     ;ozu
01A8 E4              538                                             clr     a
01A9 7800            539                                             mov     r0,#00h 
01AB F6              540     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
01AC 08              541                                             inc     r0
01AD B87FFB          542                                             cjne    r0,#7fh,mecle
01B0 7880            543                                             mov     r0,#80h
01B2 F6              544     meff:                   mov     @r0,a 
01B3 F2              545                                             movx @r0,a
01B4 08              546                                             inc     r0
01B5 B8DFFA          547                             cjne    r0,#0dfh,meff
01B8 120000   F      548                             call    clmassix
                     549     ;обнулить внешнее озу 4кбайта
01BB 900000          550                                     mov                     dptr,#0
01BE E4              551     extcle: clr                     a
01BF F0              552                                     movx            @dptr,a
01C0 A3              553                                     inc                     dptr
01C1 E583            554                                     mov                     a,dph
01C3 B410F8          555                                     cjne            a,#10h,extcle
                     556     
01C6 7898            557                             mov             r0,#chinkor
01C8 7600            558                             mov             @r0,#0;1;
01CA 08              559                             inc             r0
01CB 7619            560                             mov             @r0,#19h;64h;0c8h;90h;
                     561                             ;;;;
01CD 7881            562                             mov             r0,#chavt
01CF 7601            563                             mov             @r0,#1
01D1 08              564                             inc             r0
01D2 7690            565                             mov             @r0,#90h
                     566     
01D4 78B2            567                                     mov             r0,#marker
01D6 76FF            568                                     mov             @r0,#0ffh
                     569                             ;mov            r0,#chind
                     570                             ;mov            @r0,#1
                     571                     
01D8 74FF            572                             mov             a,#0ffh
01DA F585            573                        mov          p5,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    10

01DC 799A            574                             mov             r1,#parT
01DE 7702            575                             mov             @r1,#2                  ;Tizm=1s
01E0 79AE            576                             mov             r1,#diap
01E2 7705            577                             mov             @r1,#5                  ;10-7a
01E4 753405          578                             mov             sadiap,#5
01E7 79AF            579                             mov             r1,#parN
01E9 7702            580                             mov             @r1,#2
01EB 7400            581                             mov             a,#00h
01ED F585            582                             mov             p5,a
01EF D204            583                             setb    bitizm
                     584     
01F1 799B            585                             mov             r1,#chbefore
01F3 7700            586                             mov             @r1,#0
                     587                             ;;;;;;
01F5 900000   F      588                             mov             dptr,#ch_1              ;1->r2..r5 float
01F8 120000   F      589                             call    ldc_long
01FB 7890            590                             mov             r0,#koefKp         ;1(float)->koefKp
01FD 120000   F      591                             call    saver2
0200 7894            592                             mov             r0,#koefKm              ;1(float)->koefKm
0202 120000   F      593                             call    saver2
0205 78A0            594                             mov             r0,#koefKD
0207 120000   F      595                             call    saver2
020A 78CF            596                             mov                     r0,#chbuf
020C 120000   F      597                             call    saver2
020F 900158          598                             mov                     dptr,#158h;1 блок(2е с конца измерение) 
0212 79D3            599                             mov             r1,#saven_bl
0214 E583            600                             mov             a,dph
0216 F7              601                                               mov           @r1,a
0217 09              602                                                     inc             r1
0218 E582            603                                                     mov             a,dpl
021A F7              604                                                     mov             @r1,a
                     605     
021B 900478          606                             mov                     dptr,#478h;2 блок(2е с конца измерение) 
021E 79C0            607                             mov             r1,#saven_bl2
0220 E583            608                             mov             a,dph
0222 F7              609                                               mov           @r1,a
0223 09              610                                                     inc             r1
0224 E582            611                                                     mov             a,dpl
0226 F7              612                                                     mov             @r1,a
0227 900798          613                                     mov                     dptr,#798h;3 блок(2е с конца измере
                             ние) 
022A 79C2            614                             mov             r1,#saven_bl3
022C E583            615                             mov             a,dph
022E F7              616                                               mov           @r1,a
022F 09              617                                                     inc             r1
0230 E582            618                                                     mov             a,dpl
0232 F7              619                                                     mov             @r1,a
0233 900AB8          620                             mov                     dptr,#0ab8h;4 блок(2е с конца измерение)   
                                  
0236 79D9            621                             mov             r1,#saven_bl4
0238 E583            622                             mov             a,dph
023A F7              623                                               mov           @r1,a
023B 09              624                                                     inc             r1
023C E582            625                                                     mov             a,dpl
023E F7              626                                                     mov             @r1,a
023F 753801          627                             mov             nblok,#1                        ;номер введенного б
                             лока
0242 753701          628                             mov             nelem,#1
0245 78CD            629                             mov             r0,#interva
0247 7600            630                             mov             @r0,#0
0249 08              631                             inc             r0
024A 7601            632                             mov             @r0,#1
024C 7840            633                             mov             r0,#bufind
024E                 634     age2:
024E 76FD            635                             mov             @r0,#0fdh         ;погасить индикатор
0250 08              636                             inc             r0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    11

0251 B84CFA          637                             cjne    r0,#bufind+12,age2              
0254 120000   F      638                             call    ind
0257 120000   F      639                             call    z_1s
                     640     
                     641                                     ;зажечь все лементы индикации
025A 7840            642                             mov             r0,#bufind
025C 7669            643     ageon:          mov             @r0,#69h;0feh;?
025E 08              644                             inc             r0
025F B84CFA          645                             cjne    r0,#bufind+12,ageon             
0262 120000   F      646                             call    ind
0265 120000   F      647                             call    z_1s            ;1sec
                     648     ;;;;;;;;;;;;;;;;
                     649                     
0268 120000   F      650                             call    z_15;z_1ms
026B 434B10          651                             orl             bufind+11,#10h;бит точки после 1 знакоместа
                     652     ;;;;;;;;;;;;;;;;;;;
026E 7C60            653                             mov             r4,#60h
0270 7D00            654                             mov             r5,#00         
0272 120000   F      655                             call    iniacp;инициализация acp
0275 120000   F      656                             call    loadUS          ;us 10-7 A
                     657                             
0278 C217            658     rebyte:         clr             bitoll
027A 3095FD          659                             jnb             p1.5,$
027D 2095FD          660                             jb              p1.5,$
                     661                             ;mov            a,P6            ;p6.4=0
                     662                             ;anl            a,#0efh
                     663                             ;mov            P6,a
                     664                             ;nop
                     665                             ;nop
                     666                                     
                     667                             ;mov            a,P6                    ;p6.4=1 
                     668                             ;orl            a,#10h
                     669                             ;mov            P6,a                        
0280 7411            670                             mov             a,#11h
0282 120000   F      671                             call    write
                     672                             ;чтение acp
0285 120000   F      673                             call    read    
0288 F578            674                             mov     reacp+1,A       ;старший байт 
028A 120000   F      675                             call    read    
028D F579            676                             mov     reacp+2,A       ;средний байт 
028F 120000   F      677                             call    read
0292 F57A            678                             mov     reacp+3,A               ;мл байт
                     679                        ;;;;;;;;;;;
0294 7878            680                        mov          r0,#reacp+1
0296 E6              681                        mov          a,@r0
0297 20E740          682                             jb              acc.7,znplus;
029A D200            683                             setb    bitznak
029C 4480            684                             orl             a,#80h  ;ост содерж яч 
029E F6              685                             mov             @r0,a
                     686                                     
029F 18              687     mmm:            dec             r0;,#reacp
02A0 76FF            688                             mov             @r0,#0ffh
02A2 803E            689                             jmp             goznak
                     690     
02A4 120000   F      691     mem10ms:        call            ind
02A7 80CF            692                                             jmp                     rebyte                     
                                  ;10ms
                     693     
02A9                 694     labelA: 
                     695                             ;разрешить ie6,ie7
02A9 E53E            696                             mov                     a,chkl+1                ;low
02AB 7009            697                             jnz                     no0key
02AD E53D            698                             mov                     a,chkl
02AF 7005            699                             jnz                     no0key
02B1 75E730          700                             mov                     EIE2,#30h ;EIE2.5,EIE2.4
02B4 800D            701                             jmp                     yes0key
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    12

                     702                        
02B6                 703     no0key: ;       mov             r1,#chkl 
                     704                                     ;       call    chdec
02B6 C3              705                                     clr                     c
02B7 E53E            706                                     mov                     a,chkl+1;chkl-1
02B9 9401            707                                     subb            a,#1
02BB F53E            708                                     mov                     chkl+1,a
02BD E53D            709                                     mov                     a,chkl
02BF 9400            710                                     subb            a,#0
02C1 F53D            711                                     mov                     chkl,a
                     712                             ;;;;;;;;;;;;
02C3                 713     yes0key:
02C3 2004B2          714                                             jb              bitizm,rebyte
                     715                              ;буфер 2 выдать на индикацию
02C6 E533            716                             mov             a,chind2                        ;реже выдавать на и
                             ндикацию
02C8 700B            717                             jnz             nochind
02CA 753364          718                             mov             chind2,#100
02CD 120000   F      719                             call    ind
02D0 120000   F      720     yes0key1:       call    z_1ms;z_01s
                     721                             ;call   z_01s
                     722                             ;call   z_01s
02D3 80D4            723                             jmp             labelA
                     724     
02D5 14              725     nochind:        dec             a
02D6 F533            726                                             mov             chind2,a
02D8 80F6            727                                     jmp             yes0key1;labelA
                     728             
02DA C200            729     znplus:         clr     bitznak
02DC 547F            730                             anl             a,#7fh;fdh                      ;+
02DE F6              731                             mov             @r0,a
02DF 18              732                             dec             r0;,#reacp
02E0 7600            733                             mov             @r0,#00h
                     734                             
02E2                 735     goznak: 
                     736     ;;;;;;;;;;;;;
02E2 787A            737                             mov     r0,#reacp+3
02E4 E6              738                             mov             a,@r0
02E5 7F05            739                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
02E7 C3              740     sdvig3:         clr             c
02E8 13              741                             rrc             a
02E9 DFFC            742                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
02EB FA              743                             mov             r2,a    ;сохр байт
02EC 18              744                             dec             r0              ;       reacp+2
02ED E6              745                             mov             a,@r0
02EE C0E0            746                             push    acc
02F0 C3              747                             clr             c
02F1 7F03            748                             mov             r7,#3;2
02F3 C3              749     sdvig2:         clr             c
02F4 33              750                             rlc             a
02F5 DFFC            751                             djnz    r7,sdvig2 ;d12..d11      средний байт
02F7 4A              752                             orl             a,r2
02F8 F57A            753                             mov             reacp+3,a;сформ мл байт
02FA D0E0            754                             pop             acc
                     755                             
02FC 7F05            756                             mov             r7,#5;6
02FE C3              757     sdvig1:         clr             c
02FF 13              758                             rrc             a
0300 DFFC            759                             djnz    r7,sdvig1 ;d15,d14        ср байт
0302 FA              760                             mov             r2,a   ;сохр
0303 E578            761                             mov             a,reacp+1
0305 C0E0            762                             push    acc
                     763                     ;;      push    acc
0307 7F03            764                             mov             r7,#3;2
0309 C3              765     sdvig0:         clr             c
030A 33              766                             rlc             a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    13

030B DFFC            767                             djnz    r7,sdvig0 ;       d21..d16
030D 4A              768                             orl             a,r2
030E F579            769                             mov             reacp+2,a       ; сформ средний  байт
0310 D0E0            770                             pop             acc       ;reacp+1
                     771                             ;;;;;;;;;;;;;;
0312 20E70B          772                             jb              acc.7,sdvm
0315 C3              773                             clr             c
0316 7F05            774                             mov             r7,#5;6
0318 C3              775     sdvig4:         clr             c
0319 13              776                             rrc             a
031A DFFC            777                             djnz    r7,sdvig4 ;       d23,d22
031C F578            778                             mov             reacp+1,a
031E 8008            779                             jmp             readyacp;ankor;klmas
                     780     ;;;;;;;;;;;;                                    
0320 7F05            781     sdvm:           mov             r7,#5;6
0322 D3              782     sdvig6:         setb            c
0323 13              783                             rrc             a
0324 DFFC            784                             djnz    r7,sdvig6 ;       d23,d22
0326 F578            785                             mov             reacp+1,a
                     786                                                             
                     787     ; reacp..reacp+3-результат чтения асп(hex) 
                     788     ;;;;;;;;;
0328                 789     readyacp:
0328 7898            790                                             mov             r0,#chinkor
032A E6              791                             mov             a,@r0
032B 30E702          792                             jnb             acc.7,gopart
032E 8044            793                                     jmp             sumt2
                     794                     
0330                 795     gopart:
0330 789A            796                             mov             r0,#parT        ;параметр времени
0332 793F            797                             mov             r1,#chmasN
0334 B6013A          798                             cjne    @r0,#1,noparT1
                     799                             ;РЕЗ+РЕЗ
0337 7877            800                             mov             r0,#reacp
0339 120000   F      801                             call    resar2          ;reacp->r2..r5
033C 78B6            802                             mov             r0,#summa+3;rez_A+3
033E 120000   F      803                             call    ladd
0341 78B3            804                             mov             r0,#summa;rez_A
0343 120000   F      805                             call    saver2
0346 793F            806                              mov            r1,#chmasN
0348 7714            807                             mov             @r1,#20;10
034A 789B            808                             mov             r0,#chbefore
034C B6631E          809                             cjne    @r0,#99,nobef99
                     810                             ;РЕЗ/100
034F 900000   F      811                             MOV        DPTR,#ch100 
0352 120000   F      812     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
0355 120000   F      813                             call    zdiv;divide
0358 7862            814                             mov             r0,#rez_A
035A 120000   F      815                             call    saver2          ;сумма 100 отсчетов /100
035D 78C5            816                             mov             r0,#Rez_del
035F 120000   F      817                             call    saver2  
                     818                        ;;;;;
0362 78B3            819                        mov          r0,#summa
0364 120000   F      820                        call         clear4
                     821     
0367 799B            822                             mov             r1,#chbefore
0369 7700            823                             mov             @r1,#0
036B 8070            824                             jmp             klmas           ;загр в массив скользящее ср
036D 06              825     nobef99:        inc             @r0                     ;chbefore
036E 020000   F      826                             jmp             rebyte;labelA;метка A
                     827     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     828     ;а потом уже располагаем  в скользящий массив  из n
                     829     
                     830     
                     831     
0371 B6021D          832     noparT1:        cjne    @r0,#2,noparT2
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    14

                     833                             ;РЕЗ+РЕЗ
0374                 834     sumt2:
0374 7877            835                              mov            r0,#reacp
0376 120000   F      836                             call    resar2          ;reacp->r2..r5
0379 78B6            837                             mov             r0,#summa+3;rez_A+3
037B 120000   F      838                             call    ladd
037E 78B3            839                             mov             r0,#summa;rez_A
0380 120000   F      840                             call    saver2
0383 789B            841                             mov             r0,#chbefore
0385 793F            842                             mov             r1,#chmasN
0387 770A            843                             mov             @r1,#10
0389 B613E1          844                             cjne    @r0,#19,nobef99;9,nobef99
                     845                             ;РЕЗ/20
038C 900000   F      846                             MOV        DPTR,#ch20;ch10 
038F 80C1            847                             jmp             allsum
                     848                             ;;;;;;;
                     849                             
                     850     
0391 B6031D          851     noparT2:        cjne    @r0,#3,noparT3
                     852     
0394 7877            853                                                              mov            r0,#reacp
0396 120000   F      854                             call    resar2          ;reacp->r2..r5
0399 78B6            855                             mov             r0,#summa+3;rez_A+3
039B 120000   F      856                             call    ladd
039E 78B3            857                             mov             r0,#summa;rez_A
03A0 120000   F      858                             call    saver2
03A3 789B            859                             mov             r0,#chbefore
03A5 793F            860                             mov             r1,#chmasN
03A7 7704            861                             mov             @r1,#4                                  ;n=4
03A9 B609C1          862                             cjne    @r0,#9,nobef99;9,nobef99
                     863                             ;РЕЗ/10
03AC 900000   F      864                             MOV        DPTR,#ch10 
03AF 80A1            865                             jmp             allsum
                     866                             
03B1 B6041D          867     noparT3:        cjne    @r0,#4,noparT4
03B4                 868     aapar:          
03B4 7877            869              mov            r0,#reacp
03B6 120000   F      870                             call    resar2          ;reacp->r2..r5
03B9 78B6            871                             mov             r0,#summa+3;rez_A+3
03BB 120000   F      872                             call    ladd
03BE 78B3            873                             mov             r0,#summa;rez_A
03C0 120000   F      874                             call    saver2
03C3 789B            875                             mov             r0,#chbefore
03C5 793F            876                             mov             r1,#chmasN
03C7 7704            877                             mov             @r1,#4
03C9 B604A1          878                             cjne    @r0,#4,nobef99;9,nobef99
                     879                             ;РЕЗ/10
03CC 900000   F      880                             MOV        DPTR,#ch5
03CF 8081            881                             jmp             allsum
                     882     
                     883                     
03D1 7702            884     noparT4:   mov          @r1,#2          ;chmasN n=2
03D3 7877            885                             mov             r0,#reacp
03D5 120000   F      886                             call    resar2          ;reacp->r2..r5
03D8 7862            887                             mov             r0,#rez_A
03DA 120000   F      888                             call    saver2
                     889     ;загрузить А в массив из 2/10 значений
                     890     ;;;;;;;;;;;;;;;
03DD                 891     klmas:           
03DD 793F            892                             mov             r1,#chmasN
03DF B7021A          893                             cjne    @r1,#2,mas10
03E2 900100          894                             MOV        dptr,#MASS0
03E5 120000   F      895                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     896     
03E8 7862            897                             mov             r0,#rez_A
03EA 120000   F      898                             call    resar2          ;->r2..r5
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    15

03ED 900100          899                             mov                     dptr,#MASS0
03F0 120000   F      900                   call              saveIr2                 ; R2-R5 --> MAS0
                     901                     
03F3 900107          902                   MOV          dptr,#MASS1+3
03F6 120000   F      903                   CALL       addx
03F9 020000   F      904                       jmp           endsum
                     905     ;массив из 10-ти измерений
03FC B70A7D          906     mas10:                  cjne    @r1,#10,mas20
03FF 900120          907                                             mov                     dptr,#MASS8
0402 120000   F      908                     CALL            xCIKLWR         ;MASS8->MASS9
0405 90011C          909                                             mov                     dptr,#MASS7
0408 120000   F      910                     CALL            xCIKLWR         ;MASS7->MASS8
040B 900118          911                     MOV       dptr,#MASS6
040E 120000   F      912                     CALL       xCIKLWR         ; MASS6 --> MASS7
0411 900114          913                     MOV        dptr,#MASS5
                     914                    
0414 120000   F      915                    CALL        xCIKLWR        ; MASS5 --> MASS6
0417 900110          916                    MOV         dptr,#MASS4
                     917                    
041A 120000   F      918                    CALL        xCIKLWR        ; MASS4 --> MASS5
041D 90010C          919                             mov                     dptr,#MASS3
                     920     
0420 120000   F      921                    CALL             xCIKLWR         ;MASS3->MASS4
0423 900108          922                     MOV        dptr,#MASS2
                     923                    
0426 120000   F      924                    CALL        xCIKLWR         ; MASS2 --> MASS3
0429 900104          925                    MOV         dptr,#MASS1
                     926                     
042C 120000   F      927                   CALL         xCIKLWR        ; MASS1 --> MASS2
042F 900100          928                    MOV         dptr,#MASS0
                     929                   
0432 120000   F      930                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     931     
                     932                             
0435 7862            933                             mov             r0,#rez_A
0437 120000   F      934                             call    resar2          ;->r2..r5
                     935                                     ;call   aform
043A 900100          936                                     mov                     dptr,#MASS0
043D 120000   F      937                   call              saveIr2                 ; R2-R5 --> MAS0
                     938              
0440 900107          939                   MOV          dptr,#MASS1+3
0443 120000   F      940                   CALL       addx
0446 90010B          941                   MOV          dptr,#MASS2+3
0449 120000   F      942                   CALL       addx
044C 90010F          943                   MOV          dptr,#MASS3+3
044F 120000   F      944                  CALL        addx
0452 900113          945                   MOV       dptr,#MASS4+3
0455 120000   F      946                   call       addx
0458 900117          947                     MOV        dptr,#MASS5+3
045B 120000   F      948                  CALL        addx
045E 90011B          949                   MOV          dptr,#MASS6+3
0461 120000   F      950                   CALL       addx
0464 90011F          951                   MOV          dptr,#MASS7+3
0467 120000   F      952                  CALL        addx
046A 900123          953                  MOV        dptr,#MASS8+3
046D 120000   F      954                   call       addx
0470 900127          955                     MOV                     dptr,#MASS9+3
0473 120000   F      956                  call        addx
0476 020000   F      957                              jmp            endsum
                     958     
0479 020000   F      959     rmas4:          jmp                     mas4
                     960     ;массив из 20-ти измерений
047C B714FA          961     mas20:          cjne    @r1,#20,rmas4
047F 900148          962                                             mov                     dptr,#MASS18
0482 120000   F      963                     CALL            xCIKLWR         ;MASS18->MASS19
0485 900144          964                                             mov                     dptr,#MASS17
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    16

0488 120000   F      965                     CALL            xCIKLWR         ;MASS17->MASS18
048B 900140          966                     MOV       dptr,#MASS16
048E 120000   F      967                     CALL       xCIKLWR         ; MASS16 --> MASS17
0491 90013C          968                     MOV        dptr,#MASS15
                     969                    
0494 120000   F      970                    CALL        xCIKLWR        ; MASS15 --> MASS16
0497 900138          971                    MOV         dptr,#MASS14
                     972                    
049A 120000   F      973                    CALL        xCIKLWR        ; MASS14 --> MASS15
049D 900134          974                             mov                     dptr,#MASS13
                     975     
04A0 120000   F      976                    CALL             xCIKLWR         ;MASS13->MASS14
04A3 900130          977                     MOV        dptr,#MASS12
                     978                    
04A6 120000   F      979                    CALL        xCIKLWR         ; MASS12 --> MASS13
04A9 90012C          980                    MOV         dptr,#MASS11
                     981                     
04AC 120000   F      982                   CALL         xCIKLWR        ; MASS11 --> MASS12
04AF 900128          983                    MOV         dptr,#MASS10
                     984                   
04B2 120000   F      985                    CALL        xCIKLWR        ; MASS10 --> MASS11
04B5 900124          986                                      MOV       dptr,#MASS9
04B8 120000   F      987                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     988     
04BB 900120          989                                             mov                     dptr,#MASS8
04BE 120000   F      990                     CALL            xCIKLWR         ;MASS8->MASS9
04C1 90011C          991                                             mov                     dptr,#MASS7
04C4 120000   F      992                     CALL            xCIKLWR         ;MASS7->MASS8
04C7 900118          993                     MOV       dptr,#MASS6
04CA 120000   F      994                     CALL       xCIKLWR         ; MASS6 --> MASS7
04CD 900114          995                     MOV        dptr,#MASS5
                     996                    
04D0 120000   F      997                    CALL        xCIKLWR        ; MASS5 --> MASS6
04D3 900110          998                    MOV         dptr,#MASS4
                     999                    
04D6 120000   F     1000                    CALL        xCIKLWR        ; MASS4 --> MASS5
04D9 90010C         1001                             mov                     dptr,#MASS3
                    1002     
04DC 120000   F     1003                    CALL             xCIKLWR         ;MASS3->MASS4
04DF 900108         1004                     MOV        dptr,#MASS2
                    1005                    
04E2 120000   F     1006                    CALL        xCIKLWR         ; MASS2 --> MASS3
04E5 900104         1007                    MOV         dptr,#MASS1
                    1008                     
04E8 120000   F     1009                   CALL         xCIKLWR        ; MASS1 --> MASS2
04EB 900100         1010                    MOV         dptr,#MASS0
                    1011                   
04EE 120000   F     1012                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1013     
                    1014                             
04F1 7862           1015                             mov             r0,#rez_A
04F3 120000   F     1016                             call    resar2          ;->r2..r5
                    1017                                     ;call   aform
04F6 900100         1018                                     mov                     dptr,#MASS0
04F9 120000   F     1019                   call              saveIr2                 ; R2-R5 --> MAS0
                    1020              
04FC 900107         1021                   MOV          dptr,#MASS1+3
04FF 120000   F     1022                   CALL       addx
0502 90010B         1023                   MOV          dptr,#MASS2+3
0505 120000   F     1024                   CALL       addx
0508 90010F         1025                   MOV          dptr,#MASS3+3
050B 120000   F     1026                  CALL        addx
050E 900113         1027                   MOV       dptr,#MASS4+3
0511 120000   F     1028                   call       addx
0514 900117         1029                     MOV        dptr,#MASS5+3
0517 120000   F     1030                  CALL        addx
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    17

051A 90011B         1031                   MOV          dptr,#MASS6+3
051D 120000   F     1032                   CALL       addx
0520 90011F         1033                   MOV          dptr,#MASS7+3
0523 120000   F     1034                  CALL        addx
0526 900123         1035                  MOV        dptr,#MASS8+3
0529 120000   F     1036                   call       addx
052C 900127         1037                     MOV                     dptr,#MASS9+3
052F 120000   F     1038                  call        addx
                    1039     ;27
0532 90012B         1040                                     MOV        dptr,#MASS10+3
0535 120000   F     1041                   CALL       addx
0538 90012F         1042                                     MOV        dptr,#MASS11+3
053B 120000   F     1043                   CALL       addx
053E 900133         1044                   MOV          dptr,#MASS12+3
0541 120000   F     1045                   CALL       addx
0544 900137         1046                   MOV          dptr,#MASS13+3
0547 120000   F     1047                  CALL        addx
054A 90013B         1048                   MOV       dptr,#MASS14+3
054D 120000   F     1049                   call       addx
0550 90013F         1050                                     MOV        dptr,#MASS15+3
0553 120000   F     1051                     CALL     addx
0556 900143         1052                   MOV          dptr,#MASS16+3
0559 120000   F     1053                   CALL       addx
055C 900147         1054                   MOV          dptr,#MASS17+3
055F 120000   F     1055                  CALL        addx
0562 90014B         1056                  MOV        dptr,#MASS18+3
0565 120000   F     1057                   call       addx
0568 90014F         1058                                     MOV                     dptr,#MASS19+3
056B 120000   F     1059                  call        addx
056E 802F           1060                                     jmp             endsum
                    1061     ;массив из 4х измерений
0570                1062     mas4:                   
0570 900108         1063                                             MOV        dptr,#MASS2
0573 120000   F     1064                    CALL        xCIKLWR         ; MASS2 --> MASS3
0576 900104         1065                    MOV         dptr,#MASS1
0579 120000   F     1066                    CALL        xCIKLWR        ; MASS1 --> MASS2
057C 900100         1067                    MOV         dptr,#MASS0
057F 120000   F     1068                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1069     
                    1070                             
0582 7862           1071                             mov             r0,#rez_A
0584 120000   F     1072                             call    resar2          ;->r2..r5
                    1073                                     ;call   aform
0587 900100         1074                                     mov                     dptr,#MASS0
058A 120000   F     1075                   call              saveIr2                 ; R2-R5 --> MAS0
                    1076              
058D 900107         1077                   MOV          dptr,#MASS1+3
0590 120000   F     1078                   CALL       addx
0593 90010B         1079                   MOV          dptr,#MASS2+3
0596 120000   F     1080                   CALL       addx
0599 90010F         1081                   MOV          dptr,#MASS3+3
059C 120000   F     1082                  CALL        addx
                    1083                  
                    1084             ;23.03          
059F                1085     endsum:
059F 786E           1086                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
05A1 06             1087                                     inc             @r0
05A2 E6             1088                                     mov             a,@r0   
05A3 200105         1089                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                    1090                                     
05A6 B53F31         1091                                     cjne    a,chmasN,masx5
05A9 D201           1092                                     setb    bitmas                  ;массив заполнен
05AB 853F6E         1093     masfull:                mov             chmas,chmasN
05AE 783F           1094                                     mov             r0,#chmasN
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    18

05B0 E6             1095                                     mov             a,@r0
                    1096     ;masfull:
05B1 B40208         1097                                     cjne    a,#2,nochn2
05B4 900000   F     1098                                     MOV        DPTR,#ch2;10 
05B7 120000   F     1099                                     CALL   ldc_ltemp                 ; ltemp <-- 2
05BA 8028           1100                                     jmp             mas5div
                    1101     
05BC B40A08         1102     nochn2:         cjne    a,#10,nochn10
05BF 900000   F     1103                                                     MOV        DPTR,#ch10 
05C2 120000   F     1104                                     CALL   ldc_ltemp                 ; ltemp <-- 10
05C5 801D           1105                                     jmp             mas5div
                    1106     
05C7 B41408         1107     nochn10:        cjne    a,#20,nochn20
05CA 900000   F     1108                                                     MOV        DPTR,#ch20 
05CD 120000   F     1109                                     CALL   ldc_ltemp                 ; ltemp <-- 20
05D0 8012           1110                                     jmp             mas5div
                    1111     
05D2 900000   F     1112     nochn20:        MOV        DPTR,#ch4 
05D5 120000   F     1113                                     CALL   ldc_ltemp                 ; ltemp <-- 4
05D8 800A           1114                                     jmp             mas5div
                    1115     
05DA 856E0B         1116     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
05DD E4             1117                                     clr     a
05DE F50A           1118                                     mov     ltemp+2,a
05E0 F509           1119                                     mov     ltemp+1,a
05E2 F508           1120                                     mov     ltemp,a
                    1121     
05E4                1122     mas5div:
05E4 120000   F     1123                                     CALL       zdiv;divide                           ; R2-R5 =
                    1124                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                    1125     
                    1126                             
                    1127      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1128     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1129     ;получен результат 3 байта и знак
05E7 7866           1130                             mov             r0,#rez_A1
05E9 120000   F     1131                             call    saver2           ;сохр среднее по массиву
                    1132     ;;8.11.06                       mov             chmasN,#0
                    1133      ;;;;;;;;;;;;
                    1134      ;;;;;;;;;;;;
05EC C3             1135                             clr             c
05ED 799A           1136                             mov             r1,#parT
05EF 7402           1137                             mov             a,#2
05F1 97             1138                             subb    a,@r1
05F2 501D           1139                             jnc             ankor           ;T<3
                    1140                             ;A-=РЕЗ1                                ;T>3
05F4 120402         1141                             call    altof                   ;r2..r5->float
05F7 785E           1142                             mov             r0,#rez_Ame
05F9 120000   F     1143                             call    saver2
                    1144                             ;;;;
05FC 7890           1145                             mov             r0,#koefKp;->r8..r11
05FE EA             1146                             mov             a,r2
05FF 30E702         1147                             jnb             acc.7,nminus3
0602 7894           1148                             mov             r0,#koefKm;->r8..r11
0604 120000   F     1149     nminus3:                call    resar8
0607 120203         1150                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
060A 785E           1151                             mov             r0,#rez_Ame
060C 120000   F     1152                             call    saver2
060F 8021           1153                             jmp             gotoKD
                    1154     
0611                1155     ankor:  
0611 7898           1156                             mov             r0,#chinkor
0613 E6             1157                             mov             a,@r0
0614 30E703         1158                             jnb             acc.7,nokorr
                    1159                             ;коррекция 0
0617 020000   F     1160                             jmp             kornul
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    19

061A                1161     nokorr: 
                    1162                             ;mov            r10,#00         ;       chavt
                    1163                             ;mov            r11,#00h
061A 7881           1164                             mov              r0,#chavt      
061C E6             1165                             mov                     a,@r0;call      chcmp           ;сравн счет
                             чик авто калибровки с 0h
061D 30E737         1166                             jnb             acc.7,nonulavt;jnz              nonulavt        
0620 750A00         1167                             mov             r10,#0;1;00;02          
0623 750BC8         1168                             mov             r11,#0c8h;90h;0c8h;58h
0626 7898           1169                             mov             r0,#chinkor
0628 120000   F     1170                             call    chcmp
062B 7045           1171                             jnz             noavk
                    1172                             ;автокалибровка
062D 020000   F     1173                             jmp             autoka;noavk;
                    1174     
0630 8079           1175     rafterK:                jmp             afterK
                    1176     ;;;;;;;;;;
0632 C3             1177      gotoKD:                clr             c
0633 799A           1178                             mov             r1,#parT
0635 7404           1179                             mov             a,#4
0637 97             1180                             subb    a,@r1
0638 50F6           1181                             jnc             rafterK         ;T<5
                    1182                             ;A1-=A- *KD                     ;T>5
                    1183                             ;call           findkoef                                ;r2,r3-hex
                    1184                             ;       call            rebyte2                         ;r2..r5- he
                             x
                    1185                                     
                    1186                             ;       call    altof                   ;r2..r5->float
                    1187                             ;       mov     dptr,#CHtho;100000
                    1188                             ;       call    ldc_ltemp                       ;r8..r11
                    1189                             ;       call    fldiv
                    1190                             ;       call    move28
                    1191                             
063A 785E           1192                             mov             r0,#rez_Ame;->r2..r5   ???????????/
063C 120000   F     1193                             call    resar2
                    1194                                     ;call   flmul
063F 120343         1195                             call    ftol                    ;float->int
0642 7866           1196                             mov             r0,#rez_A1
0644 120000   F     1197                             call    saver2
0647 786A           1198                             mov             r0,#rez_A0;->r8..r11 hex
0649 120000   F     1199                             call    resar8
064C 120000   F     1200                             call    lsub            ;A3=A-1-A0
064F 789C           1201                             mov             r0,#rez_A3
0651 120000   F     1202                             call    saver2
0654 020000   F     1203                             jmp             labelB  
                    1204      ;;;;;;;;;;; 9.11.06
0657 789A           1205     nonulavt:        mov            r0,#parT
0659 E6             1206                             mov             a,@r0
065A 6401           1207                             xrl             a,#01
065C 700F           1208                             jnz             avtdec1
065E 7982           1209                             mov             r1,#chavt+1     ;T=1 chavt-10
0660 120000   F     1210                             call    tenmin
0663 7999           1211     kordec10:       mov             r1,#chinkor+1
0665 120000   F     1212                             call    tenmin
0668 801E           1213                             jmp             rezmul
                    1214     
066A 020000   F     1215     rmo220:         jmp             mo220
                    1216     
066D 7981           1217     avtdec1:        mov             r1,#chavt       
066F 120000   F     1218                             call    chdec           ;chavt-1
                    1219     ;                       jmp             kordec1;rezmul
0672 789A           1220     noavk:          mov             r0,#parT
0674 E6             1221                             mov             a,@r0
0675 6401           1222                             xrl             a,#01
0677 700A           1223                             jnz             kordec1
                    1224                             ;T=1 chinkor-10
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    20

0679 7999           1225                     mov             r1,#chinkor+1
067B 120000   F     1226                             call    tenmin
067E 8008           1227                             jmp             rezmul
                    1228     
0680 020000   F     1229     rnotestizm:             jmp                     notestizm
0683 7998           1230     kordec1:        mov             r1,#chinkor
0685 120000   F     1231                             call    chdec           ; chinkor-1
                    1232                        ;9.11.06
                    1233                             ;;;;;;;;;;;;;;
                    1234                             ;;;;;;;;;;;;;
                    1235     ;(РЕЗ1-АN)*K
0688                1236     rezmul:
0688 7866           1237                             mov             r0,#rez_A1;->r2..r5
068A 120000   F     1238                             call    resar2
068D 120402         1239                             call    altof   ;r2..r5->float  6.06    
0690 7884           1240                             mov             r0,#kor0_AN;->r8..r11
0692 120000   F     1241                             call    resar8
0695 1201D1         1242                             call    flsub
0698 7890           1243                             mov             r0,#koefKp;->r8..r11
069A EA             1244                             mov             a,r2
069B 30E702         1245                             jnb             acc.7,nminus
                    1246                             ;jnb            bitznak,nminus
                    1247                     
069E 7894           1248                             mov             r0,#koefKm;->r8..r11
06A0 120000   F     1249     nminus:         call    resar8
06A3 120203         1250                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
06A6 785E           1251                             mov             r0,#rez_Ame
06A8 120000   F     1252                             call    saver2
                    1253      
06AB                1254     afterK:                 
                    1255     ;;;;;;;;;;;;;;
06AB EA             1256                                     mov             a,r2
06AC 547F           1257                                     anl             a,#7fh
06AE FA             1258                                     mov             r2,a
06AF 900000   F     1259                                     mov     dptr,#ch_250;220;220000
06B2 120000   F     1260                                     call    ldc_ltemp                       ;r8..r11=8
06B5 1201D6         1261                                     call    flcmp
06B8 50B0           1262                                     jnc             rmo220          ;A>220000
                    1263                                     ;;;;;;;;;
06BA 3015C3         1264                                     jnb                     biteizm,rnotestizm
06BD 78B1           1265                                     mov                     r0,#vichR
06BF B62155         1266                                     cjne            @r0,#21h,note21
06C2 7A50           1267                                     mov                     r2,#50h                 ;-11a
06C4 7B18           1268                                     mov                     r3,#18h                 ;k8
06C6 12046C         1269                                     call            rebyte2                         ;r2..r5- he
                             x
06C9 120402         1270                                     call            altof                   ;r2..r5->float
06CC C002           1271                                     push            rr2
06CE C003           1272                                     push            rr3
06D0 C004           1273                                     push            rr4
06D2 C005           1274                                     push            rr5
06D4 7A50           1275                                     mov                     r2,#50h                 ;k10
06D6 7B20           1276                                     mov                     r3,#20h
06D8 12046C         1277     re11_7: call            rebyte2                 ;r2..r5
06DB 120402         1278                                     call            altof                   ;r2..r5->float
06DE 120000   F     1279                                     call            move28
06E1 D005           1280                                     pop                     rr5
06E3 D004           1281                                     pop                     rr4
06E5 D003           1282                                     pop                     rr3
06E7 D002           1283                                     pop                     rr2
06E9 1202B7         1284                                     call            fldiv
                    1285                             ;       mov                     dptr,#ch_10
                    1286                             ;       call            ldc_ltemp                       ;r8..r11
                    1287                             ;       call            flmul
                    1288                                     ;;;;;2.02.07
06EC C002           1289                                     push            rr2
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    21

06EE C003           1290                                     push            rr3
06F0 C004           1291                                     push            rr4
06F2 C005           1292                                     push            rr5
06F4 7A50           1293                                     mov                     r2,#50h                 ;-11a
06F6 7B2C           1294                                     mov                     r3,#2ch                 ;Km
06F8 12046C         1295                                     call            rebyte2                         ;r2..r5- he
                             x
06FB 120402         1296                                     call            altof                   ;r2..r5->float
06FE 120000   F     1297                                     call            move28
0701 D005           1298                                     pop                     rr5
0703 D004           1299                                     pop                     rr4
0705 D003           1300                                     pop                     rr3
0707 D002           1301                                     pop                     rr2
0709 120203         1302                                     call            flmul                           ;*Km
070C 900000   F     1303                                     mov     dptr,#CHtho;100000
070F 120000   F     1304                                     call    ldc_ltemp                       ;r8..r11=8
0712 1202B7         1305                                     call    fldiv
                    1306                                     ;;;;;
0715 8050           1307                                     jmp                     temul   
0717 B62218         1308     note21: cjne            @r0,#22h,note22
071A 7A50           1309                                     mov                     r2,#50h                 ;-09a
071C 7B10           1310                                     mov                     r3,#10h                 ;k6
071E 12046C         1311                                     call            rebyte2                         ;r2..r5- he
                             x
0721 120402         1312                                     call            altof                   ;r2..r5->float
0724 C002           1313                                     push            rr2
0726 C003           1314                                     push            rr3
0728 C004           1315                                     push            rr4
072A C005           1316                                     push            rr5
072C 7A50           1317                                     mov                     r2,#50h                 ;k8
072E 7B18           1318                                     mov                     r3,#18h
0730 80A6           1319                                     jmp                     re11_7
0732 7A50           1320     note22: mov                     r2,#50h                 ;-7a
0734 7B08           1321                                     mov                     r3,#08h                 ;k4
0736 12046C         1322                                     call            rebyte2                         ;r2..r5- he
                             x
0739 120402         1323                                     call            altof                   ;r2..r5->float
073C C002           1324                                     push            rr2
073E C003           1325                                     push            rr3
0740 C004           1326                                     push            rr4
0742 C005           1327                                     push            rr5
0744 7A50           1328                                     mov                     r2,#50h                 ;k6
0746 7B10           1329                                     mov                     r3,#10h
0748 808E           1330                                     jmp                     re11_7  
                    1331                                     ;;;;;;;;;
074A                1332     notestizm:
074A 301208         1333                                     jnb             bitklb,komulpz
074D 900000   F     1334                                     mov     dptr,#chk;100000
0750 120000   F     1335                                     call    ldc_long                        ;r2..r5
0753 8006           1336                                     jmp             komul
0755 120000   F     1337     komulpz:call            findkoef                                ;r2,r3-hex
0758 12046C         1338                                     call            rebyte2                         ;r2..r5- he
                             x
                    1339                                     
075B 120402         1340     komul:  call    altof                   ;r2..r5->float
075E 900000   F     1341                                     mov     dptr,#CHtho;100000
0761 120000   F     1342                             call    ldc_ltemp                       ;r8..r11=8
0764 1202B7         1343                                     call    fldiv
0767 120000   F     1344     temul:                          call    move28
076A 785E           1345                                     mov             r0,#rez_Ame
076C 120000   F     1346                                     call    resar2
                    1347                     
076F 120203         1348                                     call    flmul     ;A1-=A-*KD  fl
                    1349                                     
0772 120343         1350                                     call    ftol                    ;float->int
0775 7866           1351                                     mov             r0,#rez_A1
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    22

0777 120000   F     1352                                     call    saver2
077A 120402         1353                                     call    altof                   ;r2..r5->float
077D EA             1354                                     mov             a,r2
077E 547F           1355                                     anl             a,#7fh
0780 FA             1356                                     mov             r2,a
0781 900000   F     1357                                     mov     dptr,#ch_220;200;200000
0784 120000   F     1358                                     call    ldc_ltemp                       ;r8..r11=8
0787 1201D6         1359                                     call    flcmp
078A 502D           1360                                     jnc             rrmo220         ;A>200000
                    1361                             ;       jnb             knizm,noavp;goA2;               bitizm,goA2
                                  
                    1362                             ;       jb              bitavp,yesavp
078C 301808         1363                                     jnb             knizm,goA2
078F 300602         1364                                     jnb             bitvi11,qu_avp
0792 8003           1365                                     jmp             goA2
0794 20052F         1366     qu_avp:                 jb              bitavp,yesavp
0797                1367     noavp:  ;               jb              bitvi11,yesvich  ;уст после ввода A B (ввод ВЫЧИСЛИ
                             ТЬ)
0797                1368     goA2:                    ;A2=A1-
0797 7866           1369                                      mov            r0,#rez_A1
0799 120000   F     1370                                     call    resar2
079C 787B           1371                                     mov             r0,#rez_A2
079E 120000   F     1372                                     call    saver2
07A1                1373     goA3A2:                  ;A3=A2-A0
07A1 786A           1374                                       mov           r0,#rez_A0
07A3 120000   F     1375                                     call    resar8
07A6 120000   F     1376                                     call    lsub
07A9 789C           1377                                     mov             r0,#rez_A3
07AB 120000   F     1378                                     call    saver2
                    1379                                     ;;;;;;
07AE 200660         1380                                     jb              bitvi11,yesvich
07B1                1381     goonin:            ;jmp         goonind;indA3;8.11.06
07B1 78AC           1382                                     mov             r0,#chind
07B3 B60006         1383                                     cjne    @r0,#0,rnochi0
07B6 020000   F     1384                                     jmp             goonind;indA3
                    1385     
07B9 020000   F     1386     rrmo220:                jmp             mo220
07BC 020000   F     1387     rnochi0:                jmp             nochi0
07BF 7866           1388     gokaA2:                 mov             r0,#rez_A1                      ;(float)
07C1 120000   F     1389                                                     call    saver2                          ;то
                              необх для калибровки ,goA2 работает с тим знач
07C4 80D1           1390                                             jmp             goA2
                    1391     ;;;;;;;;;;;;;;;;
07C6 EA             1392     yesavp:                 mov             a,r2
07C7 547F           1393                                     anl             a,#7fh
07C9 FA             1394                                     mov             r2,a
07CA 900000   F     1395                                     mov     dptr,#ch_10th;10000
07CD 120000   F     1396                                     call    ldc_ltemp                       ;r8..r11=8
07D0 1201D6         1397                                     call    flcmp
07D3 50C2           1398                                     jnc             noavp           ;A>10000        
07D5 78AE           1399                                     mov             r0,#diap                ;10-11
07D7 B60902         1400                                     cjne    @r0,#9,avpgo
07DA 80BB           1401                                     jmp             noavp
07DC                1402     avpgo:                  
07DC 06             1403                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
07DD B60A01         1404                                     cjne    @r0,#0ah,clmasv
07E0 16             1405                                     dec             @r0
07E1                1406     clmasv:         ;сбросить массив
07E1 120000   F     1407                             call    loadUS
                    1408                             ;call   louizm
07E4 120000   F     1409                             call     clmassix
07E7 78B3           1410                                     mov             r0,#summa
07E9 120000   F     1411                                     call    clear4
07EC 786A           1412                                     mov             r0,#rez_A0
07EE 120000   F     1413                                     call    clear4
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    23

07F1 C20F           1414                                     clr             bitnul
07F3 D207           1415                                     setb            bitzus;bitbuf;;;;;;;;;;;;                  
                                                                                   
07F5 80BA           1416                                jmp     goonin
                    1417     
07F7 D00B           1418     erra01:         pop                     r11
07F9 D00A           1419                                     pop                     r10
07FB D009           1420                                     pop                     r9
07FD D008           1421                                     pop                     r8
07FF C214           1422                                     clr             bitvich
0801 C206           1423                                     clr             bitvi11
0803 753934         1424                                             mov                     nuerr,#34h;константа не дол
                             жна быть равна0
0806 120000   F     1425                                             call            error
0809 120000   F     1426                                             call            ind
080C 120000   F     1427                                             call            z_1s
080F 80A0           1428                                             jmp             goonin
                    1429     
                    1430     
0811                1431     yesvich:        
                    1432                     ;                       mov             r0,#konstB
                    1433                     ;               call    resar2
                    1434                     ;               call    move28
0811 789C           1435                                     mov             r0,#rez_A3;A1
0813 120000   F     1436                                     call    resar2                          ;HEX
                    1437                                     
0816 120402         1438                                     call            altof                   ;r2..r5->float
0819 EA             1439                                     mov             a,r2                    ;модуль
081A 547F           1440                                     anl             a,#7fh
081C FA             1441                                     mov             r2,a
                    1442                     ;               call            fladd                           ;A1+B
                    1443                                     
081D 900000   F     1444                                     mov     dptr,#CH_500;
0820 120000   F     1445                                     call    ldc_ltemp                       ;r8..r11
0823 1201D6         1446                                     call    flcmp
0826 407E           1447                                     jc                      mo500R;error <500 >22000
0828 900000   F     1448                                     mov     dptr,#CH_22T;
082B 120000   F     1449                                     call    ldc_ltemp                       ;r8..r11
082E 1201D6         1450                                     call    flcmp
0831 507F           1451                                     jnc             mo500I          ;error
                    1452                                     ;;;;;;;;;;;;
0833 120000   F     1453                                     call            move28
0836 C008           1454                                     push            r8
0838 C009           1455                                     push            r9
083A C00A           1456                                     push            r10
083C C00B           1457                                     push            r11
083E 78BC           1458                                     mov             r0,#konstA
0840 120000   F     1459                                     call    resar2
0843 900000   F     1460                                     mov                     dptr,#ch0
0846 120000   F     1461                                     call            ldc_ltemp
0849 1201D6         1462                                     call            flcmp
084C 60A9           1463                                     jz              erra01
084E 900000   F     1464                                     mov             dptr,#CH_B
0851 120000   F     1465                                     CALL   ldc_ltemp                 ; ltemp <-- 10-7
0854 120203         1466                                     call            flmul                           ;A*10-7
0857 D00B           1467                                     pop                     r11
0859 D00A           1468                                     pop                     r10
085B D009           1469                                     pop                     r9
085D D008           1470                                     pop                     r8
085F 1202B7         1471                                     call            fldiv                   ;результат R
0862 78C9           1472                                     mov                     r0,#rez_R
0864 120000   F     1473                                     call            saver2
0867 120343         1474                                     call            ftol                    ;float->hex
                    1475                                     ;;;;;;;;;;
086A 784F           1476                                             mov             r0,#abin
086C 120000   F     1477                                             call    saver2
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    24

                    1478     ;;;;;;;;
086F 7840           1479                                                     mov             r0,#bufind
0871                1480     age9:
0871 7620           1481                             mov             @r0,#" "          ;погасить индикатор
0873 08             1482                             inc             r0
0874 B84BFA         1483                             cjne    r0,#bufind+11,age9
                    1484                                             
0877 78C9           1485                                             mov             r0,#rez_R
0879 120000   F     1486                                             call            resar2
                    1487     ;;;;;;;;;;
087C 900000   F     1488                                     mov             dptr,#CH_fl
087F 120000   F     1489                                     CALL   ldc_ltemp
0882 1202B7         1490                                     call            fldiv
                    1491     
0885 78B8           1492                                     mov             r0,#work                ;степень +
0887 7600           1493                                     mov             @r0,#0
0889 78B9           1494                                     mov             r0,#work+1;степень -
088B 7600           1495                                     mov             @r0,#0
088D 900000   F     1496     compa1: mov     dptr,#ch_1;
0890 120000   F     1497                                     call    ldc_ltemp                       ;r8..r11
0893 1201D6         1498                                     call    flcmp
0896 4026           1499                                     jc              equ0            ;<1
0898 78B8           1500                                     mov             r0,#work                        ;степень +
089A 06             1501                                     inc             @r0
089B 900000   F     1502                                     mov             dptr,#ch_10;
089E 120000   F     1503                                     call    ldc_ltemp                       ;r8..r11
08A1 1202B7         1504                                     call            fldiv
08A4 80E7           1505                                     jmp             compa1                          ;work значе
                             ние степени n(hex)  
                    1506                                     ;;;;;;;;;;;;;;;;;;;
08A6 900000   F     1507     mo500R: mov             dptr,#teOLR
08A9 120000   F     1508                               call          lotext           
08AC 120000   F     1509                                     call            ind
08AF 020000   F     1510                                     jmp                     nobavp;nobitizm
08B2 900000   F     1511     mo500I: mov             dptr,#teOLI
08B5 120000   F     1512                               call          lotext           
08B8 120000   F     1513                                     call            ind
08BB 020000   F     1514                                     jmp                     nobavp;nobitizm
08BE                1515     equ0:           ;;;;;   call            ftol                    ;float->int
08BE 78B8           1516                                     mov             r0,#work                ;степень +
08C0 B60019         1517                                     cjne    @r0,#0,equ00
                    1518                                     
08C3 900000   F     1519     compa2: mov     dptr,#ch_1;
08C6 120000   F     1520                                     call    ldc_ltemp                       ;r8..r11
08C9 1201D6         1521                                     call    flcmp
08CC 500E           1522                                     jnc             equ00           ;>1
08CE 78B9           1523                                     mov             r0,#work+1                      ;степень -
08D0 16             1524                                     dec             @r0                                        
                                          ;0,ff(-1),fe(-2)...
08D1 900000   F     1525                                     mov             dptr,#ch_10;
08D4 120000   F     1526                                     call    ldc_ltemp                       ;r8..r11
08D7 120203         1527                                     call            flmul
08DA 80E7           1528                                     jmp             compa2                          ;work значе
                             ние степени n(hex)  
                    1529     
                    1530     
08DC                1531     equ00:          
08DC 7853           1532                                                     mov             r0,#adec
08DE 7952           1533                                             mov             r1,#abin+3      ;hex->10
08E0 120000   F     1534                                             call    bindec
                    1535     
                    1536                                                     ;если степень полож убирать младший байт
                    1537                                                     ;чтобы уложиться в 5 разрядов, если отриц р
                             асполагать
                    1538                                                     ;число в bufind..bufind+5
08E3 78B8           1539                                             mov             r0,#work
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    25

08E5 B60021         1540                                             cjne    @r0,#0,outr
08E8 08             1541                                             inc             r0                      ;work+1
08E9 B6FF05         1542                                             cjne            @r0,#0ffh,bufr3         ;6разрядов 
                             нужно вывести 5
08EC 06             1543                                             inc                     @r0;!!!!!!!!!?
08ED 785B           1544                                             mov                     r0,#adec+8;разместить в буф
                             ер индикации R
08EF 8003           1545                                             jmp                     bufr30
                    1546                                             ;;;;;;;;;;;;;;
08F1 06             1547     bufr3:          inc             @r0                     ;?!!!!!!!!n+1
08F2 785C           1548                                                     mov             r0,#adec+9
08F4 7945           1549     bufr30:         mov             r1,#bufind+5;6
08F6 7F05           1550                                             mov             r7,#5;7
08F8 E6             1551     bufr2:                          mov             a,@r0
08F9 2430           1552                                             add             a,#30h
08FB F7             1553                                             mov             @r1,a
08FC 19             1554                                             dec             r1
08FD 18             1555                                             dec             r0
08FE DFF8           1556                                             djnz    r7,bufr2
                    1557     
0900 784F           1558                                             mov             r0,#abin
0902 120000   F     1559                                             call            clear4
0905 78B9           1560                                             mov             r0,#work+1
0907 801C           1561                                     jmp             outr5
                    1562     ;work!=0 значит после дел на 10**9 получили число > с чем 6 разрядов                       
                                          
0909 785C           1563     outr:                   mov             r0,#adec+9;разместить в буфер индикации R
090B C3             1564                                             clr             c
090C 79B8           1565                                             mov             r1,#work
090E E8             1566                                             mov             a,r0
090F 14             1567                                             dec             a                                  
                                  ;n-1
0910 97             1568                                             subb    a,@r1
0911 F8             1569                                             mov             r0,a                    ;adec+9-n !
                             !!!!!!!!!!!!!!
0912 7945           1570                                     mov             r1,#bufind+5;т к число разрядов > чем знако
                             мест
0914 7F05           1571                                             mov             r7,#5;7
0916 E6             1572     bufr:                           mov             a,@r0
0917 2430           1573                                             add             a,#30h
0919 F7             1574                                             mov             @r1,a
091A 19             1575                                             dec             r1
091B 18             1576                                             dec             r0
091C DFF8           1577                                             djnz    r7,bufr
                    1578     
091E 784F           1579                                             mov             r0,#abin
0920 120000   F     1580                                             call            clear4
0923 78B8           1581                                     mov             r0,#work
0925 E6             1582     outr5:                  mov             a,@r0
0926 F552           1583                                             mov             abin+3,a
                    1584                                                                     ;n(hex)->abin
0928 120000   F     1585                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
092B 2552           1586                                             add             a,abin+3
092D F552           1587                                             mov             abin+3,a
092F 7853           1588                                             mov             r0,#adec
0931 7952           1589                                             mov             r1,#abin+3      ;hex->10
0933 120000   F     1590                                             call    bindec
0936 855C48         1591                                             mov             bufind+8,adec+9
0939 855B47         1592                                             mov             bufind+7,adec+8
093C 754966         1593                                             mov             bufind+9,#66h
093F 020000   F     1594                                             jmp             nobavp;nobitizm;        goonin;call
                                  ind
                    1595                                             
                    1596                                     ;;;;;;;;;;;;;;;;;;;;;
                    1597     ;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    26

                    1598     
0942 300508         1599     mo220:             jnb          bitavp,indoll
0945 301805         1600                                jnb          knizm,indoll;bitizm,indoll
0948 78AE           1601                                     mov             r0,#diap
094A B6000E         1602                                     cjne    @r0,#0,nodi2
                    1603                                ;10-2
094D 300408         1604     indoll:         jnb             bitizm,goonin1;чтобы не OLL было при нажатии кнопок меню,па
                             м,вычR
0950 900000   F     1605                                             mov             dptr,#teOLL;OLL
0953 120000   F     1606                                             call    lotext
0956 D217           1607                                             setb    bitoll
0958 020000   F     1608     goonin1:                jmp             goonin  
                    1609     
095B 16             1610     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1611     
095C B6FF01         1612                                     cjne    @r0,#0ffh,nodi9
095F 06             1613                                     inc             @r0
                    1614     
0960 120000   F     1615     nodi9:          call    loadUS
                    1616                                     ;call   louizm
                    1617                                     ;сбросить массив
0963 120000   F     1618                                     call     clmassix
0966 78B3           1619                                     mov             r0,#summa
0968 120000   F     1620                                     call    clear4
096B 786A           1621                                     mov             r0,#rez_A0
096D 120000   F     1622                                     call    clear4
0970 C20F           1623                                     clr             bitnul  
0972 D207           1624                                     setb    bitzus;bitbuf   ;флаг задержки  после установки us 
                                                                           
0974 020000   F     1625                                jmp     goonin
                    1626     
0977 16             1627     nochi0:                 dec             @r0                     ;СТИ-1
0978 020000   F     1628                                     jmp             labelB  
                    1629     
                    1630             
                    1631     ;;;;;;;;;;;;;;;
                    1632     
097B                1633     nop3_0: ;;      ;rez_A-rez_A0
                    1634                     ;;                      mov             r0,#rez_A0
                    1635                     ;;                      call    resar8
                    1636                     ;;                      call    lsub
                    1637                     ;;                      mov             r0,#rez_A
                    1638                     ;;;                     call    saver2
                    1639     
097B B70207         1640     no3parN:                        cjne    @r1,#2,no2parN
                    1641                                             ;в байт 0  записать пробел
097E 7946           1642                                             mov             r1,#bufind+6
0980 7720           1643                                             mov             @r1,#" ";0fdh;
0982 020000   F     1644                                             jmp             seeind;moveA3
                    1645     
0985                1646     no2parN:                        ;в байты 0 и 1 записать пробел
0985 7945           1647                                             mov             r1,#bufind+5
0987 7720           1648                                             mov             @r1,#" ";0fdh;" "
0989 09             1649                                             inc             r1
098A 7720           1650                                             mov             @r1,#" ";0fdh;" "
098C 8076           1651                                             jmp             seeind;moveA3
098E 8074           1652      rseeind:               jmp             seeind
                    1653     
0990                1654     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1655                                     
                    1656                                             
0990                1657     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1658                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1659                     ;до конца цикла измерения результат не размещать в буфере
                    1660                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1661                     ;и возврату в режим измерения
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    27

0990 20145C         1662                                             jb              bitvich,rnorvich
0993 201059         1663                                             jb              bitt2,rnorvich
0996 2017F5         1664                                             jb              bitoll,rseeind
                    1665                                             
0999 2011F2         1666                                             jb              bitmenu,rseeind
099C 200BEF         1667                                             jb              bitmem,rseeind
                    1668     ;;;;;;;;;;;;;;
                    1669                                             ; mov           r0,#rez_A3
                    1670                                             ;call   resar2
                    1671                                             ;call   ftol                    ;float->int r2..r5
                    1672     ;;;;;;;;
099F 789C           1673                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
09A1 120000   F     1674                                             call    resar2;????????????????17.01.07
                    1675                                     
09A4 120000   F     1676                                             call    maform
09A7 784F           1677                                             mov             r0,#abin
09A9 120000   F     1678                                             call    saver2
                    1679     ;;;;;;;;
                    1680                                             
09AC 7853           1681                                             mov             r0,#adec
09AE 7952           1682                                             mov             r1,#abin+3      ;hex->10
09B0 120000   F     1683                                             call    bindec
                    1684                                     
09B3 785C           1685                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
09B5 7946           1686                                             mov             r1,#bufind+6
09B7 7F07           1687                                             mov             r7,#7
09B9 E6             1688     bufdec:                         mov             a,@r0
09BA 2430           1689                                             add             a,#30h
09BC F7             1690                                             mov             @r1,a
09BD 19             1691                                             dec             r1
09BE 18             1692                                             dec             r0
09BF DFF8           1693                                             djnz    r7,bufdec
09C1 7847           1694                                             mov             r0,#bufind+7
09C3 762D           1695                                             mov             @r0,#2dh          ;-2..-9
09C5 7840           1696                                             mov             r0,#bufind
09C7 762B           1697                                             mov             @r0,#2bh
09C9 300202         1698                                             jnb             znmat,nozzmi;bitznak,nozzmi
09CC 762D           1699                                             mov             @r0,#2dh
09CE 79AE           1700     nozzmi:                         mov             r1,#diap
09D0 7848           1701                                             mov             r0,#bufind+8
09D2 E7             1702                                             mov             a,@r1
09D3 B4080B         1703                                             cjne    a,#8,nodi8
09D6 20151D         1704                                             jb              biteizm,seegoon
09D9 7630           1705                                             mov             @r0,#30h                 ;10-10
09DB 18             1706                                             dec             r0
09DC 7663           1707                                             mov             @r0,#63h;31h
09DE 08             1708                                             inc             r0
09DF 8015           1709                                             jmp             seegoon
09E1 B4090F         1710     nodi8:                          cjne    a,#9,nodis9
09E4 20150F         1711                                     jb              biteizm,seegoon
09E7 7631           1712                                             mov             @r0,#31h           ;10-11
09E9 18             1713                                             dec             r0
09EA 7663           1714                                             mov             @r0,#63h;31h
                    1715                                     
09EC 08             1716                                             inc             r0
09ED 8007           1717                                             jmp             seegoon
                    1718     
09EF 8079           1719     rnorvich:               jmp             norvich
09F1 8088           1720     rno3parN:               jmp             no3parN
                    1721     
09F3 2432           1722     nodis9:                         add             a,#32h
09F5 F6             1723                                             mov             @r0,a;#37h;"T";
09F6 08             1724     seegoon:                        inc             r0
09F7 7641           1725                                             mov             @r0,#"A";"E";
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    28

09F9 08             1726                                             inc             r0
09FA 7600           1727                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
09FC 08             1728                                             inc             r0;             mov             buf
                             ind+11
09FD 7610           1729                                             mov             @r0,#010h               ;bufind+11.
                             4 точка после первой цифры
                    1730                                             
                    1731     ;;;;;;;;;;;;;;;
                    1732     ;;;;;;goonind:
09FF 79AF           1733                                             mov             r1,#parN        ; ??????
0A01 B703ED         1734                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1735             
0A04                1736     seeind:                         ;;;;;;;;;;;;;
0A04 784A           1737                                             mov             r0,#bufind+10
0A06 E6             1738                                             mov             a,@r0
0A07 300F03         1739                                             jnb             bitnul,nnnul
0A0A 4408           1740                                             orl             a,#08h
0A0C F6             1741                                             mov             @r0,a
0A0D 799A           1742      nnnul:         mov             r1,#parT
0A0F B70204         1743                                             cjne    @r1,#2,nsec1
0A12 4420           1744                                             orl             a,#20h    ;1s
0A14 8009           1745                                             jmp             nsec10
0A16 B70104         1746     nsec1:          cjne    @r1,#1,nsec11
0A19 4440           1747                                             orl             a,#40h                  ;10s
0A1B 8002           1748                                             jmp             nsec10
                    1749                                     
0A1D 4410           1750     nsec11:         orl             a,#10h
                    1751                                                      ;0,1s
                    1752     ;;;;;;;;;;;;;;;;
0A1F                1753     nsec10:         
                    1754     
                    1755     
0A1F 784A           1756                                             mov             r0,#bufind+10   
0A21 F6             1757                                             mov             @r0,a
0A22 300504         1758                                             jnb             bitavp,nobavp
0A25 4404           1759                                             orl             a,#04           ;bufind+10.2
0A27 F6             1760                                             mov             @r0,a
0A28 F6             1761                                             mov             @r0,a   
0A29 784A           1762     nobavp:         mov             r0,#bufind+10   
0A2B F6             1763                                             mov             @r0,a   
0A2C 301803         1764                                        jnb          knizm,nobitizm
0A2F 4402           1765                                             orl             a,#02
0A31 F6             1766                                              mov            @r0,a
0A32                1767     nobitizm:                       
0A32 301A07         1768                                             jnb             bitakt,notakt
0A35 C21A           1769                                             clr             bitakt
0A37 534AFE         1770                                             anl             bufind+10,#0feh
0A3A 8005           1771                                             jmp             taktind
0A3C D21A           1772     notakt:                         setb    bitakt
0A3E 434A01         1773                                             orl             bufind+10,#01                      
                                          
0A41                1774     taktind:                
                    1775     ;;;;;;;;;
0A41 301517         1776                                             jnb             biteizm,yesind
0A44 79B1           1777                                             mov             r1,#vichR
0A46 7848           1778                                             mov             r0,#bufind+8
0A48 7654           1779                                             mov             @r0,#'T'
0A4A 08             1780                                             inc             r0
0A4B B72104         1781                                             cjne    @r1,#21h,test9i
0A4E 7631           1782                                             mov             @r0,#31h;11A
                    1783                                     ;       dec             r0
                    1784                                     ;       mov             @r0,#63h
0A50 8009           1785                                             jmp             yesind
0A52 B72204         1786     test9i:         cjne    @r1,#22h,test7i
0A55 7632           1787                                             mov             @r0,#32h;39h;09A
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    29

0A57 8002           1788                                             jmp             yesind
0A59 7633           1789     test7i:         mov             @r0,#33h;37h;07A
                    1790     ;;;;;;;;;
0A5B                1791     yesind:         
0A5B 301203         1792                                             jnb             bitklb,noklb
0A5E 434A80         1793                                             orl             bufind+10,#80h; on kmp
0A61 300A03         1794     noklb:          jnb             bitbon,nobuf
0A64 434B02         1795                                             orl             bufind+11,#02h; on pysk
0A67 120000   F     1796     nobuf:          call    ind        ;пп выдачи на индикатор
0A6A                1797     norvich: 
0A6A 789A           1798                                     mov             r0,# parT
0A6C 79AC           1799                                             mov             r1,#chind
0A6E B60152         1800                                             cjne    @r0,#1,rnot1in
0A71                1801     labelB:                    ;;;;;;;;;;;
                    1802                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
0A71 789F           1803                                                     mov     r0,#rez_A3+3
                    1804                             ;;;;;;;;
0A73 79BB           1805                             mov             r1,#work+3
0A75 E6             1806                             mov             a,@r0
0A76 7F07           1807                             mov             r7,#7;кол сдв вправо
0A78 C3             1808     dvig3:          clr             c
0A79 13             1809                             rrc             a
0A7A DFFC           1810                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
0A7C FA             1811                             mov             r2,a    ;сохр байт
0A7D 18             1812                             dec             r0              ;rez_A3+2
0A7E E6             1813                             mov             a,@r0
0A7F C0E0           1814                             push    acc
0A81 C3             1815                             clr             c
0A82 7F01           1816                             mov             r7,#1
0A84 C3             1817     dvig2:          clr             c
0A85 33             1818                             rlc             a
0A86 DFFC           1819                             djnz    r7,dvig2 ;d12..d11       средний байт
0A88 4A             1820                             orl             a,r2
0A89 F7             1821                             mov             @r1,a;сформ мл байт
0A8A 19             1822                             dec             r1
0A8B D0E0           1823                             pop             acc
                    1824                             
0A8D 7F07           1825                             mov             r7,#7
0A8F C3             1826     dvig1:          clr             c
0A90 13             1827                             rrc             a
0A91 DFFC           1828                             djnz    r7,dvig1 ;d18     ср байт
0A93 FA             1829                             mov             r2,a   ;сохр
0A94 18             1830                             dec             r0
0A95 E6             1831                             mov             a,@r0 ;rez_A3+1
0A96 C0E0           1832                             push    acc
                    1833                     
0A98 7F01           1834                             mov             r7,#1
0A9A C3             1835     dvig0:          clr             c
0A9B 33             1836                             rlc             a
0A9C DFFC           1837                             djnz    r7,dvig0 ;        d21..d16
0A9E 4A             1838                             orl             a,r2
0A9F F7             1839                             mov             @r1,a   ; сформ средний  байт
0AA0 19             1840                             dec             r1
0AA1 D0E0           1841                             pop             acc       ;rez_A3+1
                    1842                             ;;;;;;;;;;;;;;
                    1843     ;                       jb              acc.7,dvm
0AA3 C3             1844                             clr             c
0AA4 7F07           1845                             mov             r7,#7
0AA6 C3             1846     dvig4:          clr             c
0AA7 13             1847                             rrc             a
0AA8 DFFC           1848                             djnz    r7,dvig4 ;        d22
0AAA FA             1849                             mov             r2,a   ;сохр
0AAB 18             1850                             dec             r0;     rez_A3
0AAC E6             1851                             mov             a,@r0
                    1852                             ;;;;;
0AAD 7F01           1853                             mov             r7,#1
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    30

0AAF C3             1854     vig0:           clr             c
0AB0 33             1855                             rlc             a
0AB1 DFFC           1856                             djnz    r7,vig0 ;         d24..d30
0AB3 4A             1857                             orl             a,r2
0AB4 F7             1858                             mov             @r1,a   ; сформ   байт
0AB5 19             1859                             dec             r1
0AB6 E6             1860                             mov             a,@r0
                    1861                             ;;;;;
0AB7 20E70C         1862                             jb              acc.7,dvm
0ABA C3             1863                             clr             c
0ABB 7F07           1864                             mov             r7,#7
0ABD C3             1865     vig4:           clr             c
0ABE 13             1866                             rrc             a
0ABF DFFC           1867                             djnz    r7,vig4 ;         d
0AC1 8009           1868                             jmp             endsdv
                    1869     
0AC3 020000   F     1870     rnot1in:                jmp             not1in
                    1871     
                    1872     ;;;;;;;;;;;;                                    
0AC6 7F07           1873     dvm:            mov             r7,#7
0AC8 D3             1874     dvig6:          setb            c
0AC9 13             1875                             rrc             a
0ACA DFFC           1876                             djnz    r7,dvig6 ;        d31
0ACC F7             1877     endsdv:         mov             @r1,a
                    1878                                                             
                    1879      ;->work   
                    1880                             
0ACD 900000   F     1881                             mov             dptr,#chzap
0AD0 120000   F     1882                             call     ldc_long
0AD3 78BB           1883                              mov            r0,#work+3
0AD5 120000   F     1884                             call    ladd
0AD8 ED             1885                             mov             a,r5
0AD9 F5D2           1886                             mov             DAC0L,a
                    1887                             
0ADB EC             1888                             mov             a,r4
0ADC F5D3           1889                             mov             DAC0H,a
                    1890     
                    1891                                             ;;;;;;;;;;
0ADE 78CF           1892                                             mov                     r0,#chbuf               ;fl
                             oat
0AE0 120000   F     1893                                             call            resar2
0AE3 900000   F     1894                                             mov                     dptr,#ch_2;ch0;ch_1
0AE6 120000   F     1895                                             call            ldc_ltemp
0AE9 1201D6         1896                                             call            flcmp
0AEC 5020           1897                                             jnc                     rnobuf0
                    1898                                             
0AEE 900000   F     1899                                             mov                     dptr,#ch_1
0AF1 120000   F     1900                                             call            ldc_ltemp
0AF4 1201D1         1901                                             call            flsub
0AF7 900E00         1902                                             mov                     dptr,#chbuf1               
                                  ;СБ1 внешн озу
0AFA EA             1903                                             mov                     a,r2
0AFB F0             1904                                             movx            @dptr,a
0AFC A3             1905                                             inc                     dptr
0AFD EB             1906                                             mov                     a,r3
0AFE F0             1907                                             movx            @dptr,a
0AFF A3             1908                                             inc                     dptr
0B00 EC             1909                                             mov                     a,r4
0B01 F0             1910                                             movx            @dptr,a
0B02 A3             1911                                             inc                     dptr
0B03 ED             1912                                             mov                     a,r5
0B04 F0             1913                                             movx            @dptr,a
                    1914                                             
                    1915                                             
                    1916                                             ;jnc                    rnobuf0
0B05 200909         1917                                             jb              bitprd,yesprd   ;передать   A3 в бу
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    31

                             фер
0B08 200A08         1918                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0B0B 020000   F     1919                                             jmp             gocikle
0B0E 020000   F     1920     rnobuf0:        jmp             nobuf0
0B11                1921     yesprd: ;передать   A3 в буфер
0B11 8045           1922                                             jmp             goonT
0B13                1923     yesbuf:         ;записать   A3 в буфер
0B13 120000   F     1924                                             call            resa_hl;dptr-
0B16 120000   F     1925                                             call            loA3_X  ;адрес след ячейки внешн оз
                             у храним
                    1926                                                                             ;в ячейке saven_bl
0B19 120000   F     1927                                             call            save_hl
0B1C 78AE           1928                                             mov                     r0,#diap
0B1E E6             1929                                             mov                     a,@r0
0B1F 7938           1930                                             mov                     r1,#nblok
0B21 B70104         1931                                             cjne            @r1,#1,nosav1
0B24 F534           1932                                             mov                     sadiap,a
0B26 8012           1933                                             jmp                     gotostrob
0B28 B70204         1934     nosav1:         cjne            @r1,#2,nosav2
0B2B F532           1935                                             mov                     sadiap2,a
0B2D 800B           1936                                     jmp                     gotostrob
0B2F B70304         1937     nosav2:         cjne            @r1,#3,nosav3
0B32 F531           1938                                             mov                     sadiap3,a
0B34 8004           1939                                     jmp                     gotostrob
0B36                1940     nosav3:         
0B36 F530           1941                                             mov                     sadiap4,a
0B38 8000           1942                                     jmp                     gotostrob
                    1943     
                    1944                                             ;строб
0B3A                1945     gotostrob:
0B3A E586           1946                                     mov             a,P6            ;p6.4=0
0B3C 54EF           1947                             anl             a,#0efh
0B3E F586           1948                             mov             P6,a
0B40 00             1949                             nop
0B41 00             1950                             nop
                    1951                                     
0B42 E586           1952                             mov             a,P6                    ;p6.4=1 
0B44 4410           1953                             orl             a,#10h
0B46 F586           1954                             mov             P6,a
                    1955                                     ;;;;;;;;;
0B48 E5DA           1956                             mov             a,PCA0CPM0;     
0B4A 4446           1957                             orl             a,#46h;anl              a,#0fbh
0B4C F5DA           1958                             mov             PCA0CPM0,a
                    1959     
0B4E 75CDD0         1960                             mov             TH2,#0d0h
0B51 75CC00         1961                             mov             TL2,#00
                    1962     
0B54 D2CA           1963                             setb            T2CON.2
0B56 D2AD           1964                             setb            ET2;IE.5                            
0B58 78CD           1965     goonT:                          mov             r0,#interva;high  byte loadr2
0B5A E6             1966                                             mov             a,@r0
0B5B FC             1967                                             mov             r4,a
0B5C 08             1968                                             inc             r0
0B5D E6             1969                                             mov             a,@r0
0B5E FD             1970                                             mov             r5,a
0B5F E4             1971                                             clr             a
0B60 FB             1972                                             mov             r3,a
0B61 FA             1973                                             mov             r2,a                            ;r2
                             ..r5-interval(hex)
0B62 120402         1974                                             call            altof                   ;r2..r5->in
                             terval (float)
                    1975     
0B65 789A           1976                                             mov             r0,#parT
0B67 B60108         1977                                             cjne    @r0,#1,nott1
0B6A 900000   F     1978                                             mov                     dptr,#ch_2       
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    32

0B6D 120000   F     1979                                             call            ldc_ltemp
0B70 8009           1980                                             jmp                     intmul
                    1981     
0B72 B60225         1982     nott1:                  cjne    @r0,#2,nott2
0B75 900000   F     1983                                                     mov                     dptr,#ch_10      
0B78 120000   F     1984                                                     call            ldc_ltemp
                    1985                                                                             
0B7B 120203         1986     intmul: call            flmul                                   ;*10
0B7E 900E00         1987     intmul1:        mov             dptr,#chbuf1    ;СБ1
0B81 E0             1988                                             movx    a,@dptr
0B82 F508           1989                                             mov             r8,a
0B84 A3             1990                                             inc             dptr
0B85 E0             1991                                     movx    a,@dptr
0B86 F509           1992                                             mov             r9,a
0B88 A3             1993                                             inc             dptr
0B89 E0             1994                                     movx    a,@dptr
0B8A F50A           1995                                             mov             r10,a
0B8C A3             1996                                             inc             dptr
0B8D E0             1997                                             movx    a,@dptr
0B8E F50B           1998                                             mov             r11,a
0B90 120166         1999                                             call            fladd           ;СБ+СБ1
0B93 78CF           2000     intmul2:        mov                     r0,#chbuf
0B95 120000   F     2001                                     call            saver2          ;*2
                    2002                                     
0B98 803E           2003                                     jmp             gocikle
                    2004     
0B9A B6030B         2005     nott2:                  cjne    @r0,#3,nott3
0B9D 900000   F     2006                                                     mov                     dptr,#ch_2       
0BA0 120000   F     2007                                                     call            ldc_ltemp
0BA3 120203         2008                                                     call            flmul
0BA6 80EB           2009                                                     jmp                     intmul2            
                                                  ;*2
                    2010     
                    2011     
0BA8 B60414         2012     nott3:          cjne    @r0,#4,nott4
0BAB 900000   F     2013                                             mov                     dptr,#ch_10      
0BAE 120000   F     2014                                             call            ldc_ltemp       ;/10*4
0BB1 1202B7         2015                                             call            fldiv
0BB4 900000   F     2016                                             mov                     dptr,#ch_4       
0BB7 120000   F     2017                                             call            ldc_ltemp
0BBA 120203         2018                                             call            flmul
0BBD 80D4           2019                                             jmp             intmul2
                    2020     
0BBF B6050B         2021     nott4:          cjne    @r0,#5,nott5
0BC2 900000   F     2022                                                     mov                     dptr,#ch_2       
0BC5 120000   F     2023                                             call            ldc_ltemp;*2
0BC8 120203         2024                                             call            flmul
0BCB 80C6           2025                                             jmp             intmul2;T=5
0BCD 900000   F     2026     nott5:                  mov                     dptr,#ch_1       
0BD0 120000   F     2027                                             call            ldc_ltemp
0BD3 120203         2028                                             call            flmul
0BD6 80BB           2029                                     jmp                     intmul2                            
                                  ;*1
                    2030     
                    2031     
0BD8 300708         2032     gocikle:        jnb             bitzus,nofz                     
0BDB 120000   F     2033                             call    z_05s    ;0,5c
0BDE 120000   F     2034                             call    z_05s    ;0,5c
0BE1 C207           2035                             clr     bitzus;bitbuf бит задержки засылки us
0BE3 020000   F     2036     nofz:           jmp     labelA;rebyte
                    2037     
                    2038     
0BE6 80F0           2039     yestt5:         jmp             gocikle
                    2040     
0BE8 78CF           2041     nobuf0:                 mov             r0,#chbuf
0BEA 120000   F     2042                                                     call            resar2
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    33

0BED 900000   F     2043                                                     mov                     dptr,#ch_1       
0BF0 120000   F     2044                                             call            ldc_ltemp
0BF3 1201D1         2045                                             call            flsub
0BF6 78CF           2046                                             mov                     r0,#chbuf       
0BF8 120000   F     2047                                             call            saver2  
0BFB 80DB           2048                                             jmp             gocikle
                    2049     
                    2050     
0BFD B60205         2051     not1in:                         cjne    @r0,#2,not2in
0C00 7701           2052                                             mov             @r1,#1           ;T=2
0C02 020000   F     2053                                             jmp     labelB
                    2054     
0C05 B60305         2055     not2in:                         cjne    @r0,#3,not3in
0C08 7701           2056                                             mov             @r1,#1;9                ;T=3
0C0A 020000   F     2057                                             jmp     labelB
0C0D 7703           2058     not3in:                         mov             @r1,#3;19
0C0F 020000   F     2059                                             jmp     labelB
                    2060     
                    2061     
                    2062     ;;;;;;;;;;;3.11.06
                    2063     
                    2064     ;;коррекция 0
0C12 7883           2065     KORnul:         mov             r0,#chdel
0C14 B60010         2066                             cjne    @r0,#0,nonuldel
                    2067                                     
0C17 E584           2068                             mov             a,p4                    ;сохр  us
0C19 F536           2069                             mov             saus,a
0C1B E585           2070                             mov             a,p5
0C1D F537           2071                             mov             saus+1,a
                    2072     
0C1F 900000   F     2073                             mov             dptr,#kor0us
0C22 120000   F     2074                             call    lospus          ;упр слово коррекции 0
0C25 8018           2075                             jmp             chdelmo
                    2076     
0C27                2077     nonuldel:       ;cjne   @r0,#7,no4del
0C27 B6031B         2078                                                     cjne    @r0,#3,no4del
                    2079                             ;рез ->AN
0C2A 7862           2080                             mov             r0,#rez_A;->r2..r5
0C2C 120000   F     2081                             call    resar2
                    2082             
                    2083                                     ;;;;;;;;;;
0C2F 120402         2084                             call    altof           ;r2..r5->float
0C32 7884           2085                             mov             r0,#kor0_AN;->kor0_AN
0C34 120000   F     2086                             call    saver2
                    2087                                     
0C37 E536           2088                             mov             a,saus                  ;восстан исходное упр слово
0C39 F584           2089                             mov             p4,a
0C3B E537           2090                             mov             a,saus+1
0C3D F585           2091                             mov             p5,a            
0C3F 7883           2092     chdelmo:        mov             r0,#chdel
0C41 06             2093                             inc             @r0             ;chdel+1
0C42 020000   F     2094                             jmp              rebyte
                    2095     
0C45                2096     no4del:         ;cjne   @r0,#14,chdelmo
0C45 B606F7         2097                                             cjne    @r0,#6,chdelmo
0C48 7600           2098                             mov             @r0,#0          ;chdel
0C4A 7898           2099                             mov             r0,#chinkor
0C4C 7600           2100                             mov             @r0,#00;1;00;02;600;
0C4E 08             2101                             inc             r0
0C4F 76C8           2102                             mov             @r0,#0c8h;90h;0c8h;58h;258h
0C51 120000   F     2103                             call    clmassix;сбросить массив скольз среднего
0C54                2104     bonpart:
0C54 300A20         2105                             jnb                     bitbon,rebyter
0C57 78CF           2106                             mov                     r0,#chbuf
0C59 120000   F     2107                             call            resar2
0C5C 799A           2108                             mov                     r1,#parT
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    34

0C5E B70211         2109                             cjne            @r1,#2,no6del
0C61 900000   F     2110                             mov                     dptr,#ch_7;5
0C64                2111     no5del:
0C64 120000   F     2112                             call            ldc_ltemp
0C67 1201D1         2113                             call            flsub   
0C6A 78CF           2114                             mov                     r0,#chbuf
0C6C 120000   F     2115                             call            saver2
0C6F 020000   F     2116                             jmp              rebyte
0C72                2117     no6del:
0C72 900000   F     2118                             mov                     dptr,#ch_1
0C75 80ED           2119                             jmp                     no5del
                    2120     
0C77 7981           2121     rebyter:        mov             r1,#chavt
0C79 770C           2122                                             mov             @r1,#0ch;6;1;
0C7B 09             2123                                             inc             r1
0C7C 7780           2124                                             mov             @r1,#80h;40h;   
0C7E 020000   F     2125                                             jmp             rebyte
                    2126     
                    2127     
                    2128     ;автокалибровка
0C81 200AF3         2129     autoka:  jb             bitbon,rebyter
0C84                2130     nulavt:  ;;;;;
0C84 7883           2131                             mov             r0,#chdel
0C86 B60016         2132                             cjne    @r0,#0,nndelch
0C89 E584           2133                             mov             a,p4                    ;сохр  us
0C8B F536           2134                             mov             saus,a
0C8D E585           2135                             mov             a,p5
0C8F F537           2136                             mov             saus+1,a
                    2137     
0C91 E585           2138                             mov   a,p5
0C93 4404           2139                             orl             a,#04              ;p5.2=1
0C95 00             2140                             nop
0C96 00             2141                             nop
0C97 543F           2142                             anl             a,#3fh          ;p5.6,p5.7=0
0C99 F585           2143                             mov   p5,a
0C9B 06             2144                             inc             @r0
0C9C 020000   F     2145                             jmp              rebyte
                    2146     
0C9F B6033D         2147     nndelch:        cjne    @r0,#3,n4delch
                    2148                             ;pez->A+
                    2149                             ;K+=000/(A+-AN)
                    2150                             ;mov            r0,#rez_A;->r2..r5
                    2151                             ;call   resar2
0CA2 E577           2152                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0CA4 FA             2153                                     mov             r2,a
0CA5 E578           2154                                     mov             a,reacp+1
0CA7 FB             2155                                     mov             r3,a
0CA8 E579           2156                                     mov             a,reacp+2
0CAA FC             2157                                     mov             r4,a
0CAB E57A           2158                                     mov             a,reacp+3
0CAD FD             2159                                     mov             r5,a
                    2160                                     ;;;;;;;;;;;;;;;
0CAE 120402         2161                             call    altof                   ;r2..r5->float
0CB1 7888           2162                             mov             r0,#rezAp;->rezAp
0CB3 120000   F     2163                             call    saver2                          
0CB6 7884           2164                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0CB8 120000   F     2165                             call    resar8                          
0CBB 1201D1         2166                             call    flsub           ; r2..r5(A+-AN)
0CBE 120000   F     2167                             call    move28     ;r2..r5->r8..r11
0CC1 900000   F     2168                             mov             dptr,#CH2tho;000->r2..r5 float
0CC4 120000   F     2169                             call    ldc_long                
0CC7 1202B7         2170                             call    fldiv
0CCA EA             2171                             mov             a,r2
0CCB 547F           2172                             anl             a,#7fh
0CCD FA             2173                             mov             r2,a
0CCE 7890           2174                             mov             r0,#koefKp;->koefKp
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    35

0CD0 120000   F     2175                             call    saver2
                    2176                       
                    2177                     ;       anl             P5,#0feh                ;p5.0=0 
0CD3 E585           2178                     mov             a,P5
0CD5 543B           2179                             anl             a,#3bh;acp-
0CD7 F585           2180                             mov             P5,a
0CD9 7883           2181                             mov             r0,#chdel
0CDB 06             2182                             inc             @r0                       ;ch+1
0CDC 020000   F     2183                             jmp             rebyte
                    2184     
0CDF B6063F         2185     n4delch:        cjne    @r0,#6,n8delch
                    2186                             ; pez->A-
                    2187                             ;K-=000/(A--AN)
                    2188                     ;       mov     r0,#rez_A;->r2..r5
                    2189                     ;       call    resar2
0CE2 E577           2190                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0CE4 FA             2191                                     mov             r2,a
0CE5 E578           2192                                     mov             a,reacp+1
0CE7 FB             2193                                     mov             r3,a
0CE8 E579           2194                                     mov             a,reacp+2
0CEA FC             2195                                     mov             r4,a
0CEB E57A           2196                                     mov             a,reacp+3
0CED FD             2197                                     mov             r5,a
                    2198                                     ;;;;;;;;;;;;;;;
0CEE 120402         2199                             call    altof                   ;r2..r5->float
0CF1 788C           2200                             mov             r0,#rezAm;->rezAm
0CF3 120000   F     2201                             call    saver2                          
0CF6 7884           2202                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0CF8 120000   F     2203                             call    resar8                          
0CFB 1201D1         2204                             call    flsub                   ; r2..r5(A--AN)
0CFE 120000   F     2205                             call    move28                  ;r2..r5->r8..r11
0D01 900000   F     2206                             mov             dptr,#CH2tho    ;000->r2..r5 float
0D04 120000   F     2207                             call    ldc_long                
0D07 1202B7         2208                             call    fldiv
0D0A EA             2209                             mov             a,r2
0D0B 547F           2210                             anl             a,#7fh
0D0D FA             2211                             mov             r2,a
0D0E 7894           2212                             mov             r0,#koefKm;->koefKm
0D10 120000   F     2213                             call    saver2
                    2214                        
0D13 E536           2215                             mov             a,saus                  ;восстан исходное упр слово
0D15 F584           2216                             mov             p4,a
0D17 E537           2217                             mov             a,saus+1
0D19 F585           2218                             mov             p5,a            
0D1B 7883           2219                             mov             r0,#chdel
0D1D 06             2220                             inc             @r0                       ;ch+1
0D1E 020000   F     2221                        jmp    rebyte
                    2222     
0D21 B6090F         2223     n8delch:        cjne    @r0,#9,n12delch
0D24 7600           2224                             mov             @r0,#0
0D26 7981           2225                             mov             r1,#chavt
0D28 770C           2226                             mov             @r1,#0ch;6;1;
0D2A 09             2227                             inc             r1
0D2B 7780           2228                             mov             @r1,#80h;40h;
0D2D 120000   F     2229                             call   clmassix     ;сбросить массив среднего
0D30 020000   F     2230                             jmp             rebyte; bonpart;
0D33 06             2231     n12delch:       inc             @r0
0D34 020000   F     2232                             jmp             rebyte
                    2233     
                    2234     
                    2235     
                    2236                                 
0D37 020000   F     2237     rout6:          jmp             out6
0D3A 020000   F     2238     rlabelF:        jmp             labelF  
0D3D 020000   F     2239     rknrazr:        jmp             knrazr  
0D40 020000   F     2240     rknopt:         jmp             knopt
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    36

0D43 020000   F     2241     rizman:         jmp             izman   
0D46                2242     keyb1:  ;IE6 
0D46 75E700         2243                                     mov             EIE2,#00H
0D49 75AD00         2244                                     mov             P3IF,#00
                    2245                                     
0D4C C0E0           2246                                     push    acc
0D4E C0D0           2247                                     push    psw
0D50 C000           2248                                     push    rr0
0D52 C001           2249                                     push    rr1
0D54 C002           2250                                     push    rr2
0D56 C003           2251                                     push    rr3
0D58 C004           2252                                     push    rr4
0D5A C005           2253                                     push    rr5
0D5C C006           2254                                     push    rr6
0D5E C007           2255                                     push    rr7
0D60 C082           2256                                     push    dpl
0D62 C083           2257                                     push    dph
                    2258                                     ;clr            bitmig
                    2259                       ;;;;;;;;;;;;;;
0D64 120000   F     2260                                     call    z_01s;0,1s
0D67 120000   F     2261                                             call    z_01s
                    2262                                     ;восстан знакоместо при мигании
                    2263                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0D6A 78B2           2264                                     mov             r0,#marker
0D6C 7440           2265                                     mov             a,#bufind
0D6E 26             2266                                     add             a,@r0                   ;a=bufind+marker
0D6F F9             2267                                     mov             r1,a
0D70 A73C           2268                                     mov             @r1,savba
                    2269                                     ;;;;;;;;;;;
0D72 E5B0           2270                             mov             a,p3
0D74 20E644         2271                                     jb              acc.6,outviR;выход из режима выч R
0D77 E5B0           2272     gout6:                          mov             a,p3
0D79 44FF           2273                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0D7B F5B0           2274                                     mov             p3,a
0D7D E5B0           2275                                     mov             a,p3
0D7F 30E6B5         2276                                     jnb             acc.6,rout6             ;error
0D82 3004B5         2277                                     jnb             bitizm,rlabelF
0D85 75B0FE         2278                                     mov             p3,#0feh                ;реж IZM
0D88 E5B0           2279                                     mov             a,p3
0D8A 30E6B6         2280                                     jnb             acc.6,rizman
                    2281                                     ;;;;;;
0D8D 201232         2282                                     jb              bitklb,goklb
0D90 75B0FD         2283                                     mov             p3,#0fdh
0D93 E5B0           2284                                     mov             a,p3
0D95 30E6A5         2285                                     jnb             acc.6,rknrazr             ;labelC
0D98 75B0FB         2286                                     mov             p3,#0fbh
0D9B E5B0           2287                                     mov             a,p3
0D9D 30E655         2288                                     jnb             acc.6,knright           ;->
0DA0 75B0F7         2289                                     mov             p3,#0f7h
0DA3 E5B0           2290                                     mov             a,p3
0DA5 30E698         2291                                     jnb             acc.6,rknopt                    ;T
0DA8 75B0EF         2292                                     mov             p3,#0efh
0DAB E5B0           2293                                mov          a,p3
0DAD 30E615         2294                                     jnb             acc.6,pyskst                    ;pysk/stop
0DB0 75B0DF         2295                                     mov             p3,#0dfh
0DB3 E5B0           2296                                     mov             a,p3
0DB5 30E65E         2297                                jnb          acc.6,knvich
0DB8 020000   F     2298                                     jmp             izmpaT
                    2299     
0DBB 3006B9         2300     outviR: jnb             bitvi11,gout6   
0DBE C214           2301                                     clr             bitvich                         ;выход из р
                             ежима выч R  
0DC0 C206           2302                                     clr             bitvi11
                    2303                                     
0DC2 020000   F     2304     goklb:          jmp             out6
                    2305     
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    37

0DC5 200A12         2306     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0DC8 D20A           2307                                     setb    bitbon  ;уст реж буфер вкл
0DCA 79D5           2308                                     mov                     r1,#volume;work         ;обьем блок
                             а
0DCC 7700           2309                                     mov                     @r1,#00
0DCE 09             2310                                     inc                     r1
0DCF 77C7           2311                                     mov                     @r1,#0c7h                       ;32
                             0h/4
0DD1 434B02         2312                                     orl             bufind+11,#02h; on pysk
0DD4 120000   F     2313                                     call            ind
0DD7 020000   F     2314                                     jmp             izmpaT
0DDA C20A           2315     bufon:                  clr             bitbon  ;уст реж буфер выкл
0DDC 534BFD         2316                                             anl             bufind+11,#0fdh; off pysk
0DDF 120000   F     2317                                             call    ind
0DE2 020000   F     2318                                     jmp             izmpaT
                    2319     
0DE5 79B0           2320     tizmri:                 mov             r1,#level
0DE7 B70102         2321                                     cjne    @r1,#1,right2
                    2322                                     ;10s->HET
0DEA 8004           2323                                     jmp             right3
                    2324     
0DEC 07             2325     right2:                 inc             @r1
0DED 120000   F     2326                                     call    lolevT
                    2327                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0DF0 120000   F     2328     right3:                 call    ind
0DF3 807A           2329                                     jmp             izmfun
                    2330     
                    2331                             
                    2332                             
0DF5                2333     knright:        
                    2334     
0DF5 79AE           2335                                     mov             r1,#diap
                    2336                             ;перекл диапазон 1 поз вверх сбр массив
0DF7 17             2337                                     dec             @r1
0DF8 B7FF04         2338                                     cjne    @r1,#0ffh,diinc
0DFB 7700           2339                                     mov             @r1,#0
0DFD 8070           2340                                     jmp  izmfun
0DFF 120000   F     2341     diinc:                  call     clmassix
0E02 78B3           2342                                     mov             r0,#summa
0E04 120000   F     2343                                     call    clear4
0E07 786A           2344                                     mov             r0,#rez_A0
0E09 120000   F     2345                                     call    clear4
0E0C C20F           2346                                     clr             bitnul          ;гасить светодиод НУЛЬ  
0E0E 120000   F     2347                                     call    loadUS
0E11 805C           2348                                      jmp  izmfun
                    2349     
0E13 020000   F     2350     vit2_10:                jmp             out6
0E16                2351     knvich:                 ;12.02.07
0E16 789A           2352                                             mov                     r0,#parT
0E18 C3             2353                                             clr                     c
0E19 7404           2354                                             mov                     a,#4 
0E1B 96             2355                                             subb            a,@r0
0E1C 40F5           2356                                             jc                      vit2_10;не нажимать кнопку 
                             ВЫЧ R T=10ms,2ms
0E1E 200613         2357                               jb            bitvi11,onvich
0E21 C204           2358                                     clr             bitizm
0E23 D214           2359                                     setb    bitvich
                    2360                                     
0E25 78B1           2361                                     mov             r0,#vichR
0E27 7611           2362                                     mov             @r0,#11h;;????????or 0
                    2363                                     ;ВЫЧИСЛИТЬ
0E29 900000   F     2364                                     mov     dptr,#teVICH
0E2C 120000   F     2365                                     call    lotext
0E2F 120000   F     2366                                call         z_1s;;;;;;;
0E32 806C           2367                                     jmp              viout;izmpaT
                    2368     
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    38

0E34 C214           2369     onvich:                 clr             bitvich
0E36 78B1           2370                                     mov             r0,#vichR
0E38 7600           2371                                     mov             @r0,#0
0E3A 8037           2372                                     jmp              izmpaT
                    2373     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0E3C 301820         2374     louizm:            jnb          knizm,lou
0E3F 79AE           2375                                     mov             r1,#diap
0E41 C3             2376                                     clr             c
0E42 7403           2377                                     mov             a,#3
0E44 97             2378                                     subb    a,@r1
0E45 5006           2379                                     jnc             lldi23    ;10-2..10-5
                    2380                                     ;10-6..10-11
0E47 E584           2381                                     mov             a,p4
0E49 54F7           2382                                     anl             a,#0f7h   ;d3
0E4B F584           2383                                     mov             p4,a
0E4D E7             2384     lldi23:                 mov             a,@r1
0E4E 6403           2385                                     xrl             a,#3
0E50 7002           2386                                     jnz             lldi3
0E52 8005           2387                                     jmp             lldi2   ;10-5
0E54 E7             2388     lldi3:                  mov             a,@r1
0E55 6402           2389                                     xrl             a,#2            ;
0E57 7006           2390                                     jnz             lou             
0E59 E585           2391     lldi2:                  mov             a,p5            ;10-4
0E5B 4408           2392                                     orl             a,#08
0E5D F585           2393                                     mov             p5,a
0E5F 22             2394     lou:                    ret
                    2395                               ;;;;;;
0E60 201807         2396     izman:                  jb              knizm,knizmon
0E63 D218           2397                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2398                             ;       d3(k5 p4),d3(u5 p5)заслать us
0E65 120000   F     2399                                     call    louizm 
0E68 8005           2400                                     jmp             izmfun
0E6A C218           2401     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0E6C 120000   F     2402                                     call    loadUS;восстановить us
0E6F                2403     izmfun:                 
0E6F D207           2404                                     setb    bitzus;bitbuf
0E71 8000           2405                                     jmp             labelE;;;;;;;;;;;;
                    2406                                     ;;;;;;;;;;;;;;
0E73                2407     izmpaT:
                    2408     ;;;;;;;;;;;;;;;;;
                    2409                     ;       clr             c 
                    2410                     ;       mov             r1,#parN
                    2411     
                    2412                     ;       mov             r0,#diap
                    2413                     ;       mov             a,#6            
                    2414                     ;       subb    a,@r0
                    2415                     ;       jnc             labelE          ;         ;10-2..10-8
                    2416                               
                    2417                     ;       mov             @r1,#2          ;10-9..10-11            
                    2418                     ;       jmp             labelE
                    2419     
                    2420     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0E73 789A           2421     labelE:                 mov             r0,#parT
0E75 793D           2422                                     mov             r1,#chkl
0E77 B60108         2423                                     cjne    @r0,#1,izmt2
0E7A 7700           2424                                     mov             @r1,#0
0E7C 09             2425                                     inc             r1
0E7D 7702           2426                                     mov             @r1,#2
0E7F 020000   F     2427                                     jmp             out6
0E82 B60208         2428     izmt2:                  cjne    @r0,#2,izmt3
0E85 7700           2429                                     mov             @r1,#0
0E87 09             2430                                     inc             r1
0E88 7714           2431                                     mov             @r1,#20
0E8A 020000   F     2432                                     jmp             out6
                    2433     
0E8D 7700           2434     izmt3:                  mov             @r1,#0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    39

0E8F 09             2435                                     inc             r1
0E90 77C8           2436                                     mov             @r1,#200
0E92 020000   F     2437                                     jmp             out6
                    2438     
                    2439     
                    2440     
                    2441     
0E95                2442     knopt: ;кнопка T
0E95 C204           2443                                clr          bitizm
0E97 D210           2444                                setb         bitt2
0E99 79B7           2445                                mov          r1,#load
0E9B 7704           2446                                mov          @r1,#4;1s
0E9D 120000   F     2447                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2448                     
0EA0 793D           2449     viout:          mov             r1,#chkl
0EA2 7703           2450                             mov             @r1,#03
0EA4 09             2451                             inc             r1
0EA5 77E8           2452                             mov             @r1,#0e8h               ;1000
0EA7 020000   F     2453                             jmp             out6
                    2454     
0EAA                2455     knrazr:          
0EAA C3             2456     labelC:          clr            c
0EAB 78AF           2457                             mov             r0,#parN
0EAD 799A           2458                             mov             r1,#parT
0EAF 7402           2459                             mov             a,#2
0EB1 97             2460                             subb    a,@r1
0EB2 40BF           2461                             jc              labelE          ;T>2
0EB4 B60104         2462                             cjne    @r0,#1,noN1c
0EB7 7602           2463                             mov             @r0,#2          ;N=2
0EB9 80B8           2464                             jmp             labelE
                    2465     
0EBB B60204         2466     noN1c:          cjne    @r0,#2,not_1
0EBE 7603           2467                             mov             @r0,#3          ;N=3      ;10-2..10-8
0EC0 80B1           2468                             jmp             labelE
                    2469     
0EC2                2470     not_10: 
0EC2 7601           2471     not_1:          mov             @r0,#1                          ;N=1
0EC4 80AD           2472                             jmp     labelE
                    2473     
0EC6 020000   F     2474     rtizmri:        jmp             tizmri
                    2475     
0EC9 75B0F7         2476     ttout:          mov             p3,#0f7h
0ECC 20B6D1         2477                                             jb              p3.6,viout
0ECF D204           2478                                             setb    bitizm;отжатие кнопки t
0ED1 C210           2479                                             clr             bitt2
0ED3 809E           2480                                             jmp             labelE
0ED5                2481     labelf:                 
0ED5 301037         2482                             jnb             bitt2,nofizm
0ED8 75B0FB         2483                        mov          p3,#0fbh
0EDB E5B0           2484                        mov          a,p3
0EDD 20E6E9         2485                        jb           acc.6,ttout;outF
0EE0 79B7           2486                        mov          r1,#load;parT
0EE2 B70503         2487                        cjne         @r1,#5,noft1
                    2488                        ;t=10s
0EE5 020000   F     2489                        jmp          out6;ft1izm
                    2490     
0EE8 07             2491     noft1:     inc          @r1;dec         @r1
0EE9 120000   F     2492     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2493                             ;call   ind
0EEC 020000   F     2494                     jmp             out6;??????????????/
                    2495     
                    2496                             ;увеличить счетчик задержки клавиатуры
0EEF 783D           2497     outF:           mov             r0,#chkl
0EF1 7627           2498                             mov             @r0,#27h
0EF3 08             2499                             inc             r0
0EF4 7610           2500                             mov             @r0,#10h
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    40

0EF6 020000   F     2501                             jmp             out6;out7
                    2502     
0EF9 020000   F     2503     noviR1:         jmp             noviR
0EFC 78B1           2504     outvich:        mov                     r0,#vichR
0EFE 7600           2505                                             mov                     @r0,#0
0F00 C214           2506                                             clr                     bitvich
0F02 C206           2507                                             clr                     bitvi11
0F04 C211           2508                                             clr                     bitmenu
0F06 D204           2509                                             setb            bitizm
0F08 78B2           2510                                             mov                     r0,#marker
0F0A 76FF           2511                                             mov                     @r0,#0ffh
0F0C 020000   F     2512                                             jmp                     out6    
                    2513     
0F0F 3014E7         2514     nofizm:         jnb             bitvich,noviR1
0F12 75B0DF         2515                                                     mov             p3,#0dfh
0F15 30B6E4         2516                                                     jnb             p3.6,outvich;отжатие кнопки
                              вычR
0F18 78B1           2517                             mov             r0,#vichR
0F1A B61110         2518                             cjne    @r0,#11h,no11v6
0F1D 75B0FB         2519                             mov                     p3,#0fbh;->
0F20 20B6CC         2520                             jb                      p3.6,outF
0F23 7612           2521                             mov             @r0,#12h                ;11= вычислить
0F25 900000   F     2522     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0F28 120000   F     2523                             call    lotext
0F2B 80C2           2524                             jmp             outF
                    2525             
0F2D B61210         2526     no11v6:         cjne    @r0,#12h,no12v6
0F30 75B0FB         2527                             mov             p3,#0fbh;->
0F33 20B6B9         2528                             jb              p3.6,outF
0F36 7613           2529                             mov             @r0,#13h
0F38 900000   F     2530                             mov             dptr,#teOUT
0F3B 120000   F     2531                             call    lotext
0F3E 80AF           2532                             jmp             outF
                    2533                     
0F40 B61310         2534     no12v6:         cjne    @r0,#13h,no13v6
0F43 75B0FB         2535                                                     mov             p3,#0fbh;->
0F46 20B6A6         2536                             jb              p3.6,outF
0F49 7611           2537                             mov             @r0,#11h
0F4B 900000   F     2538                             mov             dptr,#teVICH
0F4E 120000   F     2539                             call    lotext
0F51 809C           2540                             jmp             outF
                    2541     
                    2542     ;кн -> A= 0000
                    2543     ;кн -> B= +00000
0F53 75B0FB         2544     no13v6:         mov             p3,#0fbh
0F56 E5B0           2545                             mov             a,p3
0F58 20E635         2546                             jb              acc.6,chanZ
0F5B E53B           2547                             mov             a,movrig
0F5D B40714         2548                             cjne    a,#7,kon_B      
0F60 78B2           2549                             mov             r0,#marker      ;A= 0000
0F62 B60716         2550                             cjne    @r0,#7,mark0_8          ;курсор справа ?
0F65 E53A           2551     rikn:           mov             a,movleft
0F67 F6             2552                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2553     ;                               29.12.06
                    2554     ;;;;;;;;;;;;;;;;;;
                    2555     ;необходимо не портить цифру в следуюем справа знакоместе
                    2556     ;т е сохранить ее в ячейке для мигания в противном случае
                    2557     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2558     ;       знакоместа
0F68 78B2           2559                                     mov             r0,#marker
0F6A 7440           2560                                     mov             a,#bufind
0F6C 26             2561                                             add             a,@r0                   ;a=bufind+m
                             arker
0F6D F9             2562                                             mov             r1,a
0F6E 09             2563                                             inc             r1
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    41

0F6F 873C           2564                                             mov             savba,@r1
0F71 020000   F     2565                                     jmp             outF
                    2566     
0F74 78B2           2567     kon_B:          mov             r0,#marker      ;B= +00000
0F76 B60802         2568                                             cjne    @r0,#8,mark0_8          ;курсор справа ?
0F79 80EA           2569                                             jmp             rikn
0F7B                2570     mark0_8:
                    2571     ;                               29.12.06
                    2572     ;;;;;;;;;;;;;;;;;;
                    2573     ;необходимо не портить цифру в следуюем справа знакоместе
                    2574     ;т е сохранить ее в ячейке для мигания в противном случае
                    2575     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2576     ;       знакоместа ->B=+00000
0F7B 78B2           2577                                             mov             r0,#marker
0F7D 7440           2578                                     mov             a,#bufind
0F7F 26             2579                                             add             a,@r0                   ;a=bufind+m
                             arker
0F80 F9             2580                                             mov             r1,a
0F81 09             2581                                             inc             r1
0F82 873C           2582                                             mov             savba,@r1
0F84 78B2           2583                             mov             r0,#marker
0F86 06             2584                             inc             @r0             ;       сдвинуть курсор вправо на 1
0F87 C219           2585                             clr             bitmig
0F89 B60901         2586                             cjne    @r0,#9,outma
0F8C 18             2587                             dec             r0;ppp
0F8D 020000   F     2588     outma:          jmp             outF
                    2589     
0F90 75B0FE         2590     chanZ:          mov             p3,#0feh
0F93 E5B0           2591                             mov             a,p3
0F95 20E611         2592                             jb              acc.6,chanma
                    2593                             ;изм знак в старшем разряде на противоположн
0F98 E543           2594                             mov             a,bufind+3
0F9A B42B06         2595                             cjne            a,#2bh,noplus
0F9D 75432D         2596                             mov                     bufind+3,#2dh           ;+->-   
0FA0 020000   F     2597                             jmp             outF
0FA3                2598     noplus:
0FA3 75432B         2599                             mov                     bufind+3,#2bh           ;-/+-
0FA6 020000   F     2600                             jmp             outF
0FA9 75B0FD         2601     chanma:         mov             p3,#0fdh
0FAC E5B0           2602                             mov             a,p3
0FAE 20E603         2603                             jb              acc.6,outFl;labelL1
                    2604                             ;clr            bitmig
0FB1 120000   F     2605     labelL1:        call    vvchibl;f       ;увеличить цифру 
                    2606     
0FB4 020000   F     2607     outFl:                  jmp             outF
                    2608                     
0FB7                2609     nor11:          ;       выход
0FB7 7613           2610                     mov             @r0,#13h  ;12->13
0FB9 900000   F     2611                     mov             dptr,#teOUT
                    2612     ;               jmp             vi1113
                    2613     
                    2614     ;;;;;;;;;кнопка -> в режиме кнопки меню
                    2615     
                    2616     
                    2617     
0FBC 020000   F     2618     rlabelL:        jmp                     labelL
0FBF 020000   F     2619     rfindmem:               jmp             findmem
0FC2 3011FA         2620     noviR:          jnb                     bitmenu,rfindmem;17.01.07
                    2621     ;;;;;;;;;;;;;
0FC5 78B1           2622                                             mov                     r0,#vichR
0FC7 7415           2623                                             mov                     a,#15h
0FC9 C3             2624                                             clr                     c
0FCA 96             2625                                             subb            a,@r0
0FCB 4016           2626                                             jc                      ri21_23
                    2627     
0FCD 75B0FB         2628                                             mov             p3,#0fbh; реж кн меню ->
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    42

0FD0 20B60A         2629                                             jb              p3.6,ri6
0FD3 78B1           2630                                             mov             r0,#vichR
0FD5 B61508         2631                                             cjne    @r0,#15h,norime
0FD8 7611           2632                                             mov             @r0,#11h
0FDA 120000   F     2633     norime1:        call            lomenu
0FDD 020000   F     2634     ri6:                    jmp             out6
0FE0 06             2635     norime:         inc             @r0
0FE1 80F7           2636                                             jmp             norime1
                    2637             
0FE3 7423           2638     ri21_23:        mov                     a,#23h          ;->
0FE5 C3             2639                                             clr                     c
0FE6 96             2640                                             subb            a,@r0
0FE7 4014           2641                                             jc                      ri_31
0FE9 75B0FB         2642                                             mov                     p3,#0fbh
0FEC 20B6EE         2643                                             jb                      p3.6,ri6
0FEF B62308         2644                                             cjne            @r0,#23h,no23ri
0FF2 7621           2645                                             mov                     @r0,#21h
0FF4 120000   F     2646                                             call            lomenu
0FF7 020000   F     2647                                             jmp                     out6
0FFA 06             2648     no23ri:         inc                     @r0
0FFB 80DD           2649                                             jmp                     norime1
0FFD B6312B         2650     ri_31:          cjne            @r0,#31h,no31ri;->19.2->57.6->19.2
                    2651     
                    2652     ;;
1000 75B0FB         2653                                             mov                     p3,#0fbh
1003 20B6D7         2654                                             jb                      p3.6,ri6
                    2655     ;;
1006 301311         2656                                             jnb                     bitv19,gosk19
1009 900000   F     2657                                             mov                     dptr,#teS57_6;57,6
100C 120000   F     2658                                             call            lotext
100F 534B03         2659                                             anl                     bufind+11,#03h
1012 434B80         2660                                             orl                     bufind+11,#80h
1015 C213           2661                                             clr                     bitv19
1017 020000   F     2662                                             jmp                     out6
101A 900000   F     2663     gosk19:         mov                     dptr,#teS19_2
101D 120000   F     2664                                             call            lotext
1020 534B03         2665                                             anl                     bufind+11,#03h
1023 434B80         2666                                             orl                     bufind+11,#80h
1026 D213           2667                                             setb            bitv19
1028 020000   F     2668                                             jmp                     out6
                    2669     
                    2670     
                    2671     
                    2672     ;labelS2:       jmp                     out6
                    2673     
102B 7452           2674     no31ri:         mov                     a,#52h;42h              ;->
102D C3             2675                                             clr                     c
102E 96             2676                                             subb            a,@r0
102F 40AC           2677                                             jc                      ri6
1031 75B0FB         2678                                             mov                     p3,#0fbh                   
                                  ;41,42
1034 30B609         2679                                             jnb                     p3.6,rlabelN    ;кнопка ->(
                             пароль 000)
1037 75B0FD         2680                                             mov                     p3,#0fdh
103A 20B6A0         2681                                             jb                      p3.6,ri6
103D 020000   F     2682                                             jmp             labelL1                            
                                  ;кнопка 0..9  (пароль 000)
1040 020000   F     2683     rlabelN:                jmp             labelN
1043 020000   F     2684     moutF:          jmp             outF
                    2685     ;;;;;;;;;;;;;;;;;;;;;;;;;
1046 020000   F     2686     rnnmemb:        jmp             nnmemb
                    2687     
1049                2688     nbimenu:
1049 300BFA         2689     findmem:        jnb             bitmem,rnnmemb
104C 79B0           2690                             mov             r1,#level                                          
                                          ;-> кн ПАМЯТЬ (ОЧИСТКА ->ЗАПИСЬ-> ПРОСМОТР)
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    43

104E B71113         2691                        cjne         @r1,#11h,nomem11
                    2692                        
1051 75B0FB         2693                        mov          p3,#0fbh
1054 E5B0           2694                        mov          a,p3
1056 20E6EA         2695                        jb           acc.6,moutF
1059 7712           2696                        mov          @r1,#12h
105B 900000   F     2697                        mov          dptr,#teWR      ;                       ЗАПИСЬ
105E 120000   F     2698                        call         lotext
1061 020000   F     2699                        jmp          outF
                    2700     
1064 B71213         2701     nomem11:   cjne         @r1,#12h,nomem12
1067 75B0FB         2702                             mov             p3,#0fbh
106A E5B0           2703                        mov          a,p3
106C 20E6D4         2704                        jb           acc.6,moutF
106F 7713           2705                        mov          @r1,#13h
1071 900000   F     2706                        mov          dptr,#teLIST            ;ПРОСМОТР
1074 120000   F     2707                        call         lotext
1077 020000   F     2708                        jmp          outF
107A B71313         2709     nomem12:         cjne           @r1,#13h,nomem13
107D 75B0FB         2710                                             mov             p3,#0fbh
1080 E5B0           2711                        mov          a,p3
1082 20E6BE         2712                        jb           acc.6,moutF
1085 7714           2713                        mov          @r1,#14h
1087 900000   F     2714                        mov          dptr,#teSTAT                    ;СТАТИСТИКА
108A 120000   F     2715                        call         lotext
108D 020000   F     2716                          jmp                outF
                    2717                             
1090 B71413         2718     nomem13:cjne            @r1,#14h,labelL
1093 75B0FB         2719                             mov             p3,#0fbh
1096 E5B0           2720                        mov          a,p3
1098 20E6A8         2721                        jb           acc.6,moutF
109B 7711           2722                        mov          @r1,#11h
109D 900000   F     2723                        mov          dptr,#teCLE                     ;ОЧИСТКА
10A0 120000   F     2724                        call         lotext
10A3 020000   F     2725                          jmp                outF
10A6                2726     labelL: 
                    2727                             ;ПОЛНАЯ->БЛОК 00(level 21->22) 
10A6 78B0           2728                                     mov                     r0,#level
10A8 B6210E         2729                                     cjne            @r0,#21h,nobl21
10AB 7622           2730                                     mov                     @r0,#22h                ;->БЛОК 
10AD 900000   F     2731                                     mov                     dptr,#teBL
10B0 120000   F     2732     me21_22:call            lotext
                    2733                             
10B3 120000   F     2734                                     call            z_05s;задержка чтобы не проскакивала пргр н
                             а следующий уровень
10B6 020000   F     2735                                     jmp                     outF
                    2736     
10B9 B62207         2737     nobl21: cjne            @r0,#22h,nobl22
10BC 900000   F     2738                                     mov                     dptr,#teFULL
10BF 7621           2739                                     mov                     @r0,#21h                ;->ПОЛНАЯ
                    2740     
10C1 80ED           2741                                     jmp                     me21_22
                    2742     
                    2743     ;labl21:           cjne @r0,#21h,nolev1
                    2744     ;                       mov             p3,#0fbh
                    2745     ;                       mov             a,p3
                    2746     ;                       jb              acc.6,loutF
                    2747     ;                       cjne    @r0,#21h,labl22
                    2748     ;                       mov             @r0,#22h
                    2749                             ;БЛОК
                    2750     ;                       call    lotext
                    2751     ;                       jmp             outF
                    2752     ;labl22:                mov             @r0,#21h
                    2753                             ;ПОЛНАЯ
                    2754     ;                       call    lotext
                    2755     ;                       jmp             outF
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    44

                    2756                      
10C3 B62325         2757     nobl22:         cjne    @r0,#23h,go31l
10C6 75B0FB         2758     rigblo:         mov             p3,#0fbh
10C9 20B629         2759                                             jb              p3.6,llev2
10CC                2760     labL2:    ;  уст курсор в правую позицию 
                    2761                                     ;       кнопка                  ->
                    2762     ;;;;;;;;;;;;;;;;;;
                    2763     ;необходимо не портить цифру в следуюем справа знакоместе
                    2764     ;т е сохранить ее в ячейке для мигания в противном случае
                    2765     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2766     ;       знакоместа
10CC 78B2           2767                                             mov             r0,#marker
10CE 7440           2768                                     mov             a,#bufind
10D0 26             2769                                             add             a,@r0                   ;a=bufind+m
                             arker
10D1 F9             2770                                             mov             r1,a
10D2 09             2771                                             inc             r1
10D3 873C           2772                                             mov             savba,@r1
10D5 C219           2773                                             clr             bitmig
                    2774     ;;;;;;;;;;;;;;;;
10D7 78B2           2775                       mov           r0,#marker      ;курсор справа  ?
10D9 E53B           2776                             mov             a,movrig
10DB C3             2777                             clr             c
10DC 96             2778                             subb    a,@r0
10DD 6006           2779                             jz         equ1l
10DF E53B           2780                             mov             a,movrig;уст в правую позицию
10E1 F6             2781                             mov             @r0,a
10E2 020000   F     2782                             jmp             outF                                     
10E5 E53A           2783     equ1l:          mov             a,movleft;уст в левую позицию
10E7 F6             2784                             mov             @r0,a   
10E8 020000   F     2785     loutF:  jmp             outF
                    2786                     
                    2787     
10EB B63102         2788     go31l:          cjne    @r0,#31h,go41l
10EE 80D6           2789                             jmp             rigblo
10F0 B6410B         2790     go41l:          cjne    @r0,#41h,norig2
10F3 80D1           2791                             jmp             rigblo
                    2792     
10F5 75B0FD         2793     llev2:          mov             p3,#0fdh
10F8 20B6ED         2794                             jb              p3.6,loutF
10FB 020000   F     2795                             jmp             labelL1
                    2796     
                    2797     ;->
10FE C3             2798     norig2:    clr          c               ;32,33,34,42
10FF 7431           2799                             mov             a,#31h
1101 96             2800                             subb    a,@r0
1102 50E4           2801                             jnc             loutF
1104 75B0FB         2802     rigblok:        mov             p3,#0fbh  ;32,33,34,42
1107 20B626         2803                             jb              p3.6,lev2go
110A                2804     labelN: 
                    2805                             ;                               29.12.06
                    2806     ;;;;;;;;;;;;;;;;;;
                    2807     ;необходимо не портить цифру в следуюем справа знакоместе
                    2808     ;т е сохранить ее в ячейке для мигания в противном случае
                    2809     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2810     ;       знакоместа
110A 78B2           2811                                             mov             r0,#marker
110C 7440           2812                                     mov             a,#bufind
110E 26             2813                                             add             a,@r0                   ;a=bufind+m
                             arker
110F F9             2814                                             mov             r1,a
1110 09             2815                                             inc             r1
1111 873C           2816                                             mov             savba,@r1
                    2817     ;;;;;;;;;;;;;;;;;;;
1113 78B2           2818                             mov             r0,#marker      ;курсор справа  ?
1115 E53B           2819                             mov             a,movrig
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    45

1117 C3             2820                             clr             c
1118 96             2821                             subb    a,@r0
1119 7006           2822                             jnz        noequ1
111B E53A           2823                             mov             a,movleft;уст в крайнюю левую позицию
111D F6             2824                             mov             @r0,a
111E 020000   F     2825                             jmp             outF
1121                2826     noequ1: ;29.12.06
                    2827     ;;;;;;;;;;;;;;;;;;
                    2828                             ;восстан знакоместо при мигании
                    2829                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
1121 78B2           2830                                     mov             r0,#marker
1123 7440           2831                                     mov             a,#bufind
1125 26             2832                                     add             a,@r0                   ;a=bufind+marker
1126 F9             2833                                     mov             r1,a
                    2834                                     ;mov            @r1,savba
1127 09             2835                                     inc             r1
1128 873C           2836                                     mov             savba,@r1
                    2837     ;;;;;;;;;;;;;;;;        
112A 120000   F     2838                             call    marri;уст сдвиг в правую        позицию
112D 020000   F     2839                             jmp             outF
1130 75B0FD         2840     lev2go:         mov             p3,#0fdh
1133 30B603         2841                             jnb             p3.6,rlabelL1
1136 020000   F     2842                             jmp             outF
                    2843     
1139 020000   F     2844     rlabelL1:       jmp             labelL1
                    2845     
113C                2846     nnmemb:
                    2847                                     
                    2848     
                    2849     
113C                2850     norim6:    ;kn menu
113C D083           2851     out6:           pop             dph
113E D082           2852                                     pop             dpl
1140 D007           2853                                     pop             rr7     
1142 D006           2854                                     pop             rr6
1144 D005           2855                                     pop             rr5
1146 D004           2856                                     pop             rr4
1148 D003           2857                                     pop             rr3
114A D002           2858                                     pop             rr2
114C D001           2859                                     pop             rr1                             
114E D000           2860                                     pop             rr0
1150 D0D0           2861                                     pop             psw
1152 D0E0           2862                                     pop             acc
                    2863     ;clr            bitmig
                    2864                               ; mov         EIE2,#30H
                    2865                              ;  mov         a,P3IF
                    2866                             ;       anl             a,#0bfh
                    2867                             ;       mov             P3IF,a
                    2868                             ;       mov             P3,#0c0h
                    2869                             ;;;;;;
1154 75AD00         2870                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1157 75B0C0         2871                             mov             P3,#0c0h
115A C219           2872                             clr             bitmig
115C E586           2873                                             mov             a,P6            ;p6.4=0
115E 54EF           2874                             anl             a,#0efh
1160 F586           2875                             mov             P6,a
1162 00             2876                             nop
1163 00             2877                             nop
                    2878                                     
1164 E586           2879                             mov             a,P6                    ;p6.4=1 
1166 4410           2880                             orl             a,#10h
1168 F586           2881                             mov             P6,a    
                    2882                             ;;;;;;;;;
116A E5DA           2883                             mov             a,PCA0CPM0;     
116C 4446           2884                             orl             a,#46h;anl              a,#0fbh
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    46

116E F5DA           2885                             mov             PCA0CPM0,a
                    2886     
1170 75CDD0         2887                             mov             TH2,#0d0h
1173 75CC00         2888                             mov             TL2,#00
                    2889     
1176 D2CA           2890                             setb            T2CON.2
1178 D2AD           2891                             setb            ET2;IE.5
                    2892                             ;;;;;;;;                    
117A 32             2893                             reti
                    2894     
117B 020000   F     2895     rknMEM:                 jmp             knMEM
117E 020000   F     2896     knKMP:             jmp          out7
1181 020000   F     2897     rout7:                  jmp             out7    
1184 020000   F     2898     rlabelH:                jmp             labelH
1187 020000   F     2899     rknNUL:         jmp             knNUL
118A 020000   F     2900     rknleft:                jmp             knleft
118D                2901     keyb2:  ;IE7
118D 75E700         2902                                     mov             EIE2,#00H
1190 75AD00         2903                                     mov             P3IF,#00
                    2904     
1193 C0E0           2905                                     push    acc
1195 C0D0           2906                                     push    psw
1197 C000           2907                                     push    rr0
1199 C001           2908                                     push    rr1
119B C002           2909                                     push    rr2
119D C003           2910                                     push    rr3
119F C004           2911                                     push    rr4
11A1 C005           2912                                     push    rr5
11A3 C006           2913                                     push    rr6
11A5 C007           2914                                     push    rr7
11A7 C082           2915                                     push    dpl
11A9 C083           2916                                     push    dph
                    2917                                     ;clr            bitmig
                    2918                       ;;;;;;;;;;;;;;
11AB 120000   F     2919                               call  z_01s   ;0,1s
                    2920                               ;восстан знакоместо при мигании
                    2921                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
11AE 78B2           2922                                     mov             r0,#marker
11B0 7440           2923                                     mov             a,#bufind
11B2 26             2924                                     add             a,@r0                   ;a=bufind+marker
11B3 F9             2925                                     mov             r1,a
11B4 A73C           2926                                     mov             @r1,savba
                    2927                                     ;;;;;;;;;;;
                    2928     
11B6 E5B0           2929                             mov             a,p3
11B8 20E7C6         2930                                     jb              acc.7,rout7
11BB E5B0           2931                                     mov             a,p3
11BD 74FF           2932                                     mov             a,#0ffh         ; p3.(5-0)<-3f
11BF F5B0           2933                                     mov             p3,a
11C1 E5B0           2934                                     mov             a,p3
11C3 30E7BB         2935                                     jnb             acc.7,rout7             ;error
11C6 3004BB         2936                                     jnb             bitizm,rlabelH
11C9 75B0FE         2937                                     mov             p3,#0feh                ;реж IZM
11CC E5B0           2938                                     mov             a,p3
11CE 30E7B6         2939                                     jnb             acc.7,rknNUL
11D1 75B0FD         2940                                     mov             p3,#0fdh
11D4 E5B0           2941                                     mov             a,p3
11D6 30E7A5         2942                                     jnb             acc.7,knKMP
11D9 75B0FB         2943                                     mov             p3,#0fbh
11DC E5B0           2944                                     mov             a,p3
11DE 30E7A9         2945                                     jnb             acc.7,rknleft
11E1 75B0F7         2946                                     mov             p3,#0f7h
11E4 E5B0           2947                                     mov             a,p3
11E6 30E76F         2948                                     jnb             acc.7,knAVP
11E9 75B0EF         2949                                 mov         p3,#0efh
11EC E5B0           2950                                     mov             a,p3
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    47

11EE 30E78A         2951                                     jnb             acc.7,rknMEM
11F1 75B0DF         2952                                     mov             p3,#0dfh
11F4 E5B0           2953                                     mov             a,p3    
11F6 30E722         2954                                     jnb             acc.7,knmenu
11F9                2955     an_t7:             ;;;;;;;;;;;;
                    2956                     
                    2957     ;       clr             c
                    2958     ;       mov             r1,#parN
                    2959     ;
                    2960     ;                       mov             r0,#diap
                    2961     ;                       mov             a,#6            
                    2962     ;                       subb    a,@r0
                    2963     ;                       jnc             goto7           ;         ;10-2..10-8
                    2964                               
                    2965     ;                       mov             @r1,#2          ;10-9..10-11            
                    2966                             
                    2967                             ;;;;;;;;;;;;
11F9 799A           2968     goto7:                  mov             r1,#parT
11FB 783D           2969                                     mov             r0,#chkl
11FD B70108         2970                                     cjne    @r1,#1,not1_7
1200 7600           2971                                     mov             @r0,#00
1202 08             2972                                     inc             r0
1203 7602           2973                                     mov             @r0,#2
1205 020000   F     2974                                     jmp             out7
                    2975                             
                    2976     
1208 B70208         2977     not1_7:                 cjne    @r1,#2,not2_7
120B 760E           2978                                             mov             @r0,#0eh;00
120D 08             2979                                     inc             r0
120E 7638           2980                                     mov             @r0,#38h;20
1210 020000   F     2981                                     jmp             out7
1213 7600           2982     not2_7:                 mov             @r0,#00
1215 08             2983                                     inc             r0
1216 76C8           2984                                     mov             @r0,#200
1218 020000   F     2985     merr:           jmp             out7
                    2986     
                    2987     
121B 2006FA         2988     knmenu: jb              bitvi11,merr
121E 20151C         2989                                     jb              biteizm,menuoff
                    2990                                     ;;;;;
1221 201225         2991                                     jb              bitklb,klboff
1224 C204           2992                              clr            bitizm          ;off IZM
1226 D211           2993                                     setb            bitmenu
1228 C217           2994                                     clr             bitoll
122A 900000   F     2995                                     mov             dptr,#teTESI    ;в буф2 записать ТЕСТ-ИЗМЕР
122D 120000   F     2996                                     call    lotext
1230 534B03         2997                                     anl                     bufind+11,#03h ;погасить запятые
1233 120000   F     2998                                     call            ind
1236 78B1           2999                                     mov             r0,#vichR
1238 7611           3000                                     mov             @r0,#11h
123A 020000   F     3001                                     jmp             onmem11
123D                3002     menuoff:
123D 78B1           3003                                     mov             r0,#vichR
123F 7600           3004                                     mov             @r0,#00
1241 C215           3005                                     clr             biteizm
1243 120000   F     3006                                     call    loadus
1246 020000   F     3007                                     jmp             out7
                    3008     
1249 C212           3009     klboff:                 clr             bitklb
124B 120000   F     3010                                                     call            loadUS
124E 78B1           3011                                                     mov             r0,#vichR
1250 7600           3012                                                     mov             @r0,#00
1252 020000   F     3013                                                     jmp             out7
                    3014     
1255 020000   F     3015     rendkalib:              jmp             endkalib
                    3016     
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    48

1258 2012FA         3017     knAVP:  jb              bitklb,rendkalib        
125B 200505         3018                                     jb              bitavp,meavp
125E D205           3019                                     setb    bitavp
1260 020000   F     3020                                     jmp             onmem11
1263 C205           3021     meavp:                  clr             bitavp
1265 020000   F     3022                                     jmp             onmem11
                    3023     
1268 201207         3024     knleft: jb              bitklb,lefkl
                    3025                                     ;;;;;;;;
126B 79AE           3026                                mov          r1,#diap
126D 07             3027                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
126E B70A03         3028                                     cjne    @r1,#0ah,nodi6
1271 17             3029                                     dec             @r1
1272 8085           3030     lefkl:  jmp             an_t7
                    3031     
1274                3032     nodi6:             ;    cjne    @r1,#0,an_t7
1274 120000   F     3033                                      call    clmassix
1277 78B3           3034                                     mov             r0,#summa
1279 120000   F     3035                                     call    clear4  
127C 786A           3036                                     mov             r0,#rez_A0
127E 120000   F     3037                                     call    clear4
1281 C20F           3038                                     clr             bitnul          ;гасить светодиод НУЛЬ  
1283 120000   F     3039                                     call    loadUS
1286 020000   F     3040                                jmp          an_t7
                    3041     
1289 200F0F         3042     knNUL:                  jb              bitnul,ybnul
128C D20F           3043                                     setb    bitnul
128E 789C           3044                                     mov             r0,#rez_A3      ;A3
1290 120000   F     3045                                     call    resar2
1293 786A           3046                                     mov             r0,#rez_A0      
1295 120000   F     3047                                     call    saver2;A0<-A3
1298 020000   F     3048                                     jmp             goto7;an_t7
                    3049     
129B C20F           3050     ybnul:                  clr             bitnul
129D 900000   F     3051                                      mov    DPTR,#ch0 
12A0 120000   F     3052                                     CALL   ldc_long          ; r2..r5 <-- 0
12A3 786A           3053                                     mov             r0,#rez_A0      ;A0=0
12A5 120000   F     3054                                     call    saver2
12A8 020000   F     3055                                     jmp             goto7;an_t7
                    3056     
12AB 301021         3057     labelH:                 jnb             bitt2,nolah
12AE 75B0FB         3058                                     mov             p3,#0fbh   ;вход в режим изм Т
12B1 534A8F         3059                                     anl             bufind+10,#8fh
12B4 79B7           3060                                     mov             r1,#load;parT
12B6 20B70D         3061                                     jb              p3.7,rhnot1
12B9 B70003         3062                                     cjne    @r1,#0,inct;
12BC 020000   F     3063                                     jmp             out7;hyest6
12BF 17             3064     inct:                   dec             @r1                     ;Tизм+1
                    3065                             
12C0 120000   F     3066                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
12C3                3067     hnot2:          ;       call    ind
12C3 020000   F     3068                                     jmp             out7
                    3069     
12C6 020000   F     3070      rhnot1:                jmp             hnot1
                    3071      ;rnoviR:       jmp             noviR
12C9 020000   F     3072      rlabelK:       jmp             labelK
12CC 020000   F     3073      rlabelI:       jmp             labelI          
                    3074      ;;;;;;;;;;;;;;;;;;;
12CF 3014F7         3075     nolah:          jnb             bitvich,rlabelK 
                    3076                                     
                    3077                             ;;;;;;
                    3078                             ;увеличить счетчик задержки клавиатуры
                    3079                     ;;              mov             r0,#chkl
                    3080                     ;;              mov             @r0,#27h
                    3081                     ;;              inc             r0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    49

                    3082                     ;;              mov             @r0,#10h
                    3083                             ;;;;;;
                    3084     
12D2 78B1           3085                             mov             r0,#vichR
12D4 B61128         3086                             cjne    @r0,#11h,rhnor11;rlabelI;;
12D7 75B0FB         3087                             mov             p3,#0fbh   ;<-
12DA 20B730         3088                             jb              p3.7,noh37;routF
12DD B6110B         3089                     cjne    @r0,#11h,hr12
12E0 7613           3090                             mov             @r0,#13h        ;11= вычислить
12E2 900000   F     3091                             mov             dptr,#teOUT;teVICH
12E5 120000   F     3092     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
12E8 020000   F     3093                             jmp             goto7;outF
12EB B61207         3094     hr12:           cjne    @r0,#12h,hnor12
12EE 7611           3095     lovich:         mov             @r0,#11h
12F0 900000   F     3096                             mov             dptr,#teVICH
12F3 80F0           3097                             jmp             hvi1113         
12F5 B61307         3098     hnor12:         cjne    @r0,#13h,rhnor11
12F8 7612           3099     loizmk:         mov             @r0,#12h
12FA 900000   F     3100                             mov             dptr,#teIZMK    ;       изм конст
                    3101                                        
12FD 80E6           3102                             jmp             hvi1113
                    3103     
12FF 804C           3104     rhnor11:                jmp             hnor11
                    3105     
1301 8057           3106     rvvizko:                jmp             vvizko
1303 C214           3107     vioutF:                 clr             bitvich
1305 C206           3108                                                     clr             bitvi11
1307 020000   F     3109                                                     jmp             outF
130A 020000   F     3110     toutF:                  jmp     outF
                    3111     
130D 75B0F7         3112     noh37:          mov             p3,#0f7h
1310 20B7F7         3113                             jb              p3.7,toutF;vioutF
1313 B611EB         3114                             cjne    @r0,#11h,rvvizko
1316 D206           3115                             setb    bitvi11    ;нажат ввод ВЫЧИСЛИТЬ
1318 D204           3116              setb   bitizm
131A 534B07         3117                              anl            bufind+11,#07h
131D 434B10         3118                              orl            bufind+11,#10h;точка после 1 знакоместа
1320 020000   F     3119     routF:          jmp             out7;goto7;outF
                    3120     
                    3121     
                    3122     
1323 80E8           3123     rnoh37:         jmp             noh37
                    3124     
1325 B6120D         3125     norr11:         cjne    @r0,#12h,norr12
1328 75B0FB         3126                             mov             p3,#0fbh   ;<-
132B 20B7F5         3127                             jb              p3.7,rnoh37;routF
132E 760B           3128                             mov             @r0,#11;12->11
1330 80BC           3129                             jmp             lovich
                    3130     
1332 020000   F     3131     labelI2:                jmp             labelI
1335 B613FA         3132     norr12:         cjne    @r0,#13h,labelI2
1338 75B0FB         3133                             mov             p3,#0fbh   ;<-
133B 20B7E5         3134                             jb              p3.7,rnoh37
133E 7612           3135                             mov             @r0,#12h
1340 80B6           3136                             jmp             loizmk
                    3137                             ;;;;
1342 C214           3138     clrvich:                clr             bitvich
1344 D204           3139                             setb    bitizm
1346 A8B2           3140                             mov             r0,marker
1348 76FF           3141                             mov             @r0,#0ffh
134A 020000   F     3142                              jmp    goto7;  routF
                    3143     
                    3144     ;rnoh37:                jmp             noh37
                    3145      ;ввод изм конст
134D B612E5         3146     hnor11:         cjne    @r0,#12h,norr12;clrvich
1350 75B0FB         3147                              mov            p3,#0fbh   
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    50

1353 20B7CD         3148                             jb              p3.7,rnoh37;lovich;;изм конст <-  выч
1356 7611           3149                             mov             @r0,#11h
1358 8094           3150                             jmp             lovich
                    3151     
135A 78B1           3152     vvizko:         mov             r0,#vichR
135C E6             3153                             mov             a,@r0
                    3154                     ;       cjne    @r0,#12h,clrvich
135D B412E2         3155                             cjne    a,#12h,clrvich
1360 7621           3156                             mov             @r0,#21h                ;изм конст->U=+0000     (vv
                             od)
1362 78B2           3157                             mov             r0,#marker
1364 7604           3158                             mov             @r0,#4;9
1366 753A04         3159                             mov             movleft,#4
1369 753B07         3160                             mov             movrig,#7
136C 900000   F     3161                             mov             dptr,#teAequ0
136F 120000   F     3162                             call    lotext
                    3163                             
1372 120000   F     3164                             call    outA
1375 534B0F         3165                             anl                     bufind+11,#0fh
                    3166             ;       mov             a,bufind+11
                    3167             ;       anl             a,#0f0h
                    3168             ;       mov             bufind+11,a
1378 434B40         3169                             orl             bufind+11,#40h;бит точки после 7 знакоместа(a=000.0
                              v)
                    3170                             
137B 020000   F     3171                             jmp             goto7;routF
                    3172     ;hnor13:                jmp             hnor12          
137E B6210C         3173     izchi:          cjne    @r0,#21h,tlabelI
                    3174     ;<- при вводе цифр А                            
                    3175                     ;        mov            p3,#0fbh   
                    3176                     ;       jnb             p3.7,li21
                    3177             ;clr            bitmig
1381 78B2           3178                             mov             r0,#marker
1383 16             3179                             dec             @r0
1384 B60201         3180                             cjne    @r0,#2,li21
1387 06             3181                             inc             @r0;marker=3 +/-
1388 C219           3182     li21:           clr             bitmig
138A 020000   F     3183                             jmp             goto7;outF
                    3184     
138D 020000   F     3185     tlabelI:        jmp             labelI
                    3186     
                    3187     ;                       load    0 1 2 3 4 5             
1390 06050403       3188     sootv:          db              6,5,4,3,2,1;parT
1394 0201                    
                    3189     ;
                    3190     
                    3191     ;нажата кн ввод при наборе Т
1396 75B0F7         3192     hnot1:                  mov             p3,#0f7h
1399 20B784         3193                                     jb              p3.7,routF;out7
139C B70549         3194                                     cjne    @r1,#5,nohnot1  ;r1=load
139F 794A           3195                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
13A1 E7             3196                                     mov             a,@r1
13A2 548F           3197                                     anl             a,#8fh
13A4 4440           3198                                     orl             a,#40h;.6
13A6 F7             3199                                     mov             @r1,a
13A7 8000           3200                                     jmp             loadb
                    3201                                     
                    3202                                     
13A9 789A           3203     loadB:                  mov             r0,#parT
13AB 900000   F     3204                                     mov             dptr,#sootv
13AE 79B7           3205                                     mov             r1,#load                
13B0 E7             3206                                     mov             a,@r1;load
13B1 93             3207                                     movc    a,@a+dptr
13B2 F6             3208                                     mov             @r0,a
13B3 120000   F     3209                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    51

                    3210                                      ;r4=b1 r5=b2
13B6 120000   F     3211                                     call    iniacp;инициализация АЦП
13B9 120000   F     3212                                     call    loadUS
13BC 120000   F     3213                                     call    clmassix        
13BF D204           3214                                     setb    bitizm
13C1 C210           3215                                     clr             bitt2
                    3216     
13C3 534A8F         3217                                     anl             bufind+10,#8fh
13C6 C3             3218                                      clr            c
13C7 789A           3219                                  mov                r0,#parT
13C9 79AF           3220                                      mov            r1,#parN
13CB 7402           3221                                  mov                a,#2
13CD 96             3222                                 subb                a,@r0
13CE 5005           3223                                 jnc                 loadB2
13D0 7701           3224                                     mov             @r1,#1;N=1         ;T>=2
13D2 020000   F     3225     bout7:                  jmp             goto7;out7
                    3226     
13D5 B702FA         3227     loadB2:                 cjne    @r1,#2,bout7
13D8 7702           3228                                     mov             @r1,#2;N=2
13DA 020000   F     3229                                     jmp             goto7;out7
13DD                3230     nohnot2:                ;в буфере 1 зажечь <=0,1s
13DD 794A           3231                                     mov             r1,#bufind+10
13DF E7             3232                                     mov             a,@r1
13E0 4410           3233                                     orl             a,#10h;.4
13E2 F7             3234                                     mov             @r1,a
13E3 120000   F     3235                                     call            ind
13E6 80C1           3236                                     jmp             loadB
13E8 B704F2         3237     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
13EB 794A           3238                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
13ED E7             3239                                     mov             a,@r1
13EE 4420           3240                                     orl             a,#20h;.5
13F0 F7             3241                                     mov             @r1,a
13F1 80B6           3242                                     jmp             loadB
                    3243     
                    3244     ;кнопка ПАМЯТЬ
13F3 C204           3245     knMEM:                  clr             bitizm          ;off IZM
13F5 900000   F     3246                                     mov             dptr,#teLIST;CLE
13F8 120000   F     3247                                     call    lotext    ;в буф2 записать ОЧИСТКА
13FB D20B           3248                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
13FD 534BEF         3249                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
1400 434B01         3250                                     orl             bufind+11,#01;зажечь светодиод память
1403 120000   F     3251                                     call            ind
1406 78B0           3252                                     mov             r0,#level
1408 7613           3253                                     mov             @r0,#13h;11h
140A 783D           3254     onmem11:                mov             r0,#chkl
140C 7603           3255                                     mov             @r0,#03
140E 08             3256                                     inc             r0
140F 76E8           3257                                     mov             @r0,#0e8h               ;1000
1411 020000   F     3258                                     jmp             out7;goto7;out7
                    3259     
1414 020000   F     3260     rnomemk:                jmp             nomemk          ;
                    3261     
1417 78B0           3262     outkmem:        mov                     r0,#level
1419 7600           3263                                             mov                     @r0,#0
141B 78B1           3264                                             mov                     r0,#vichR
141D 7600           3265                                             mov                     @r0,#0
141F C20B           3266                                             clr                     bitmem
1421 C214           3267                                             clr                     bitvich
1423 C206           3268                                             clr                     bitvi11
1425 C211           3269                                             clr                     bitmenu
1427 D204           3270                                             setb            bitizm
1429 78B2           3271                                             mov                     r0,#marker
142B 76FF           3272                                             mov                     @r0,#0ffh
142D 020000   F     3273                                             jmp                     vvod2_10
1430 020000   F     3274                                             jmp                     goto7   
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    52

1433                3275     labelK:
                    3276     
                    3277     ;;;;;;;;;;;;
1433 300BDE         3278                               jnb           bitmem,rnomemk          ;кн память (ввод и <-)
1436 75B0EF         3279                                     mov                     p3,#0efh
1439 30B7DB         3280                                     jnb                     p3.7,outkmem            ;отжатие кн
                              память на любом уровне обработки памяти
143C 78B0           3281                                      mov            r0,#level
143E B6114E         3282                               cjne          @r0,#11h,klev1;nome11
1441 75B0FB         3283     lefmem11:         mov           p3,#0fbh
1444 E5B0           3284                               mov           a,p3
1446 20E70E         3285                               jb            acc.7,rkvvod0
1449 B6110E         3286                               cjne          @r0,#11h,locle          ;<-memory
144C 7614           3287                               mov           @r0,#14h
144E 900000   F     3288     lolist:           mov           dptr,#teSTAT
1451 120000   F     3289                               call          lotext           ;СТАТИСТИКА
1454 020000   F     3290                               jmp   goto7;  outF
                    3291     
1457 020000   F     3292     rkvvod0:        jmp             kvvod0
                    3293     
                    3294     
145A B6120B         3295     locle:          cjne            @r0,#12h,lowr           ;<-memory
145D 7611           3296                               mov           @r0,#11h                   ;ОЧИСТКА
145F 900000   F     3297     loadcle:          mov           dptr,#teCLE
1462 120000   F     3298                               call          lotext
1465 020000   F     3299                               jmp           goto7;outF
                    3300     
1468 B6130B         3301     lowr:                   cjne    @r0,#13h,lostat
146B 7612           3302                                             mov             @r0,#12h
146D 900000   F     3303      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
1470 120000   F     3304                             call    lotext
1473 020000   F     3305                             jmp             goto7;outF
                    3306     
1476 7613           3307     lostat:         mov             @r0,#13h
1478 900000   F     3308                                     mov             dptr,#teLIST              ;ПРОСМОТР
147B 120000   F     3309                             call    lotext
147E 020000   F     3310                             jmp             goto7;outF
                    3311     
1481 B6141A         3312     me_14:cjne              @r0,#14h,klev22
1484 7613           3313                                             mov             @r0,#13h
1486 900000   F     3314                             mov             dptr,#teLIST              ;;ПРОСМОТР
1489 120000   F     3315                             call    lotext
148C 020000   F     3316                             jmp             goto7
148F B61202         3317      klev1:          cjne   @r0,#12h,klev2
1492 80AD           3318                             jmp             lefmem11
1494 B61302         3319     klev2:           cjne   @r0,#13h,klev3;11-14   klev22     ;11-13 нет
1497 80A8           3320                             jmp             lefmem11
1499 B61402         3321     klev3:           cjne   @r0,#14h,klev22;
149C 80A3           3322                             jmp             lefmem11
                    3323     ;<- vvod на более низких уровнях
149E B62117         3324     klev22:         cjne    @r0,#21h,klev21
14A1 75B0FB         3325     lev220:         mov             p3,#0fbh
14A4 20B77B         3326                             jb              p3.7,kgo23
14A7 B6210B         3327                             cjne    @r0,#21h,kfullr
14AA 7622           3328                             mov             @r0,#22h
14AC 900000   F     3329                             mov             dptr,#teBL
14AF 120000   F     3330                             call    lotext
14B2 020000   F     3331                             jmp             goto7;outF
14B5 020000   F     3332     kfullr:         jmp             kfull                           
14B8 B6220E         3333     klev21:         cjne    @r0,#22h,klev23
14BB 80E4           3334                             jmp             lev220
                    3335     
14BD 020000   F     3336     rlabL2:         jmp             labL2
14C0 020000   F     3337     rlabM:          jmp             labM
14C3 020000   F     3338     ques:                   jmp             out7
14C6 020000   F     3339     ddoutfr:        jmp             ddoutf
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    53

                    3340     
14C9 B623F4         3341     klev23:          cjne   @r0,#23h,rlabM
14CC 75B0FB         3342                              mov    p3,#0fbh
14CF 30B7F1         3343                              jnb            p3.7,ques;errr labL2
14D2 75B0F7         3344                              mov    p3,#0f7h
14D5 20B7EE         3345                              jb             p3.7,ddoutfr
                    3346                                             ;       считать с индикатора  
14D8 C3             3347                                     clr                     c
14D9 E547           3348                                mov          a,bufind+7      
14DB 9430           3349                                      subb           a,#30h
14DD B40002         3350                                      cjne           a,#0,chaibl
14E0 7401           3351                                      mov            a,#1                    ;номера блоков 1..4
14E2                3352     chaibl:         
14E2 F538           3353                                             mov             nblok,a
                    3354                                
                    3355                              ;очистить блок памяти с набранным номером
                    3356                              ;150h..1000h( 150h+nblok*320h)
14E4 120000   F     3357                                     call            adrblok         ;dptr-
                    3358     
14E7 79B8           3359                                     mov                     r1,#work                ;обьем блок
                             а
14E9 7703           3360                                     mov                     @r1,#03
14EB 09             3361                                     inc                     r1
14EC 7720           3362                                     mov                     @r1,#20h                        ;32
                             0h
                    3363     
14EE                3364     goonoff:
14EE E4             3365                                     clr                     a
14EF F0             3366                                     movx            @dptr,a
14F0 A3             3367                                     inc                     dptr
                    3368     
14F1 79B9           3369                                     mov                     r1,#work+1
14F3 120000   F     3370                                     call            chminus
14F6 78B8           3371                                     mov             r0,#work
14F8 E6             3372                             mov             a,@r0
14F9 30E7F2         3373                             jnb             acc.7,goonoff
                    3374     
14FC C20B           3375                              clr    bitmem  ;сбр признак памяти 
14FE D204           3376                              setb   bitizm
                    3377                             ;после очистки блока сохраняем в saven_bl 
                    3378                             ;адрес второго с конца измерения потому
                    3379                             ;добавляем 8;;
1500 120000   F     3380                             call            adrblok;dptr-начало блока
1503 E582           3381                             mov                     a,dpl
1505 2408           3382                             add                     a,#8
1507 F582           3383                             mov                     dpl,a
1509 E583           3384                             mov                     a,dph
150B 3400           3385                             addc            a,#0
150D F583           3386                             mov                     dph,a
150F 120000   F     3387                             call            save_hl;подготовка записи в начало блока
                    3388                             ;;;;;
                    3389     
1512 78B2           3390                              mov            r0,#marker
1514 76FF           3391                              mov            @r0,#0ffh
1516 020000   F     3392                                     jmp                     vvod2_10
1519 020000   F     3393                              jmp    goto7
                    3394     
151C 020000   F     3395     rddoutf:        jmp             ddoutf
151F 020000   F     3396     rgo23no:        jmp             go23no
                    3397     
                    3398     ;vvod   БЛОК->БЛОК 00           
1522 75B0F7         3399     kgo23:           mov    p3,#0f7h
1525 20B7F4         3400                             jb              p3.7,rddoutf
1528 B621F4         3401                             cjne    @r0,#21h,rgo23no
                    3402                             ;очистить память 150..dd0h
                    3403                             ;1й блок
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    54

152B 900150         3404                              mov                    dptr,#150h
152E 79B8           3405                                     mov                     r1,#work                ;обьем блок
                             а
1530 7703           3406                                     mov                     @r1,#03
1532 09             3407                                     inc                     r1
1533 7720           3408                                     mov                     @r1,#20h                        ;32
                             0h
                    3409     
1535                3410     gooff1:
1535 E4             3411                                     clr                     a
1536 F0             3412                                     movx            @dptr,a
1537 A3             3413                                     inc                     dptr
                    3414     
1538 79B9           3415                                     mov                     r1,#work+1
153A 120000   F     3416                                     call            chminus
153D 78B8           3417                                     mov             r0,#work
153F E6             3418                             mov             a,@r0
1540 30E7F2         3419                             jnb             acc.7,gooff1
1543 900158         3420                             mov                     dptr,#158h;начало 1 го блока
                    3421                             ;после очистки блока сохраняем в saven_bl 
                    3422                             ;адрес второго с конца измерения потому
                    3423                             ;добавляем 8;;
1546 120000   F     3424                             call            save_hl;подготовка записи в начало блока
                    3425     ;2й блок
1549 900470         3426                             mov                     dptr,#470h
154C 79B8           3427                                     mov                     r1,#work                ;обьем блок
                             а
154E 7703           3428                                     mov                     @r1,#03
1550 09             3429                                     inc                     r1
1551 7720           3430                                     mov                     @r1,#20h                        ;32
                             0h
                    3431     
1553                3432     gooff2:
1553 E4             3433                                     clr                     a
1554 F0             3434                                     movx            @dptr,a
1555 A3             3435                                     inc                     dptr
                    3436     
1556 79B9           3437                                     mov                     r1,#work+1
1558 120000   F     3438                                     call            chminus
155B 78B8           3439                                     mov             r0,#work
155D E6             3440                             mov             a,@r0
155E 30E7F2         3441                             jnb             acc.7,gooff2
1561 900478         3442                             mov                     dptr,#478h;начало 2 го блока
1564 120000   F     3443                             call            save_hl;подготовка записи в начало блока
                    3444     ;3й блок
1567 900790         3445                             mov                     dptr,#790h
156A 79B8           3446                                     mov                     r1,#work                ;обьем блок
                             а
156C 7703           3447                                     mov                     @r1,#03
156E 09             3448                                     inc                     r1
156F 7720           3449                                     mov                     @r1,#20h                        ;32
                             0h
                    3450     
1571                3451     gooff3:
1571 E4             3452                                     clr                     a
1572 F0             3453                                     movx            @dptr,a
1573 A3             3454                                     inc                     dptr
                    3455     
1574 79B9           3456                                     mov                     r1,#work+1
1576 120000   F     3457                                     call            chminus
1579 78B8           3458                                     mov             r0,#work
157B E6             3459                             mov             a,@r0
157C 30E7F2         3460                             jnb             acc.7,gooff3
157F 900798         3461                             mov                     dptr,#798h;начало 3 го блока
                    3462                                     ;после очистки блока сохраняем в saven_bl 
                    3463                             ;адрес второго с конца измерения потому
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    55

                    3464                             ;добавляем 8;;
1582 120000   F     3465                             call            save_hl;подготовка записи в начало блока
                    3466     ;4й блок
1585 900AB0         3467     mov                     dptr,#0ab0h
1588 79B8           3468                                     mov                     r1,#work                ;обьем блок
                             а
158A 7703           3469                                     mov                     @r1,#03h
158C 09             3470                                     inc                     r1
158D 7720           3471                                     mov                     @r1,#20h                        ;32
                             0h
                    3472     
158F                3473     gooff4:
158F E4             3474                                     clr                     a
1590 F0             3475                                     movx            @dptr,a
1591 A3             3476                                     inc                     dptr
                    3477     
1592 79B9           3478                                     mov                     r1,#work+1
1594 120000   F     3479                                     call            chminus
1597 78B8           3480                                     mov             r0,#work
1599 E6             3481                             mov             a,@r0
159A 30E7F2         3482                             jnb             acc.7,gooff4
159D 900AB8         3483                             mov                     dptr,#0ab8h;начало 4 го блока
                    3484                             ;после очистки блока сохраняем в saven_bl 
                    3485                             ;адрес второго с конца измерения потому
                    3486                             ;добавляем 8;;
15A0 120000   F     3487                             call            save_hl;подготовка записи в начало блока
15A3 C20B           3488                             clr             bitmem
15A5 D204           3489                             setb    bitizm
15A7 78B2           3490                                     mov             r0,#marker
15A9 76FF           3491                              mov            @r0,#0ffh
15AB 020000   F     3492                             jmp                     vvod2_10;jmp            goto7
                    3493     
15AE 7623           3494     go23no:    mov          @r0,#23h
15B0 753B08         3495                                             mov                     movrig,#8
15B3 753A07         3496                                             mov             movleft,#7
15B6 8055           3497                             jmp             loblok;БЛОК 00
                    3498     
15B8 7621           3499     kfull:          mov             @r0,#21h
15BA 8025           3500                             jmp             gofull
                    3501                             
                    3502                                             
15BC                3503     nomemk:                         
15BC 020000   F     3504                                     jmp             labelS                  ;нажат ввод меню
                    3505                             
15BF 75B0FB         3506     nome11:           mov           p3,#0fbh
15C2 E5B0           3507                               mov           a,p3
15C4 20E70D         3508                               jb            acc.7,kvvod0
15C7 B61205         3509                               cjne          @r0,#12h,mem12no        
15CA 7611           3510                               mov           @r0,#11h                ;ОЧИСТКА
15CC 020000   F     3511                               jmp            loadcle
                    3512     
15CF                3513     mem12no:        ;cjne           @r0,#13h,lowr           
15CF 7612           3514                               mov           @r0,#12h                   ;
15D1 020000   F     3515                               jmp           lowr1                     ;ЗАПИСЬ
                    3516     
15D4 75B0F7         3517     kvvod0:           mov           p3,#0f7h                        ;knopka vvod
15D7 20B70F         3518                               jb            p3.7,ddoutf
15DA 78B0           3519                               mov           r0,#level
15DC B61129         3520                               cjne          @r0,#11h,mvv11
15DF 7621           3521                               mov           @r0,#21h                ;ПОЛНАЯ
15E1 900000   F     3522     gofull:           mov           dptr,#teFULL
15E4 120000   F     3523                               call          lotext
15E7 804F           3524                                     jmp             mlabL2  ;<-????????/
                    3525     
15E9                3526     ddoutf:         ;<- БЛОК 00(ОЧИСТКА)
                    3527     ;необходимо не портить цифру в следуюем сслева знакоместе
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    56

                    3528     ;т е сохранить ее в ячейке для мигания в противном случае
                    3529     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3530     ;       знакоместа
15E9 78B2           3531                                                     mov             r0,#marker
15EB 7440           3532                                     mov             a,#bufind
15ED 26             3533                                             add             a,@r0                   ;a=bufind+m
                             arker
15EE F9             3534                                             mov             r1,a
15EF 19             3535                                             dec             r1      ;       inc             r1
15F0 873C           3536                                             mov             savba,@r1
15F2 C219           3537                                             clr             bitmig
                    3538     ;;;;;;;;;;;;;;;;
15F4 78B2           3539                       mov           r0,#marker      ;курсор слева   ?
15F6 E53A           3540                             mov             a,movleft
15F8 C3             3541                             clr             c
15F9 96             3542                             subb    a,@r0
15FA 7006           3543                             jnz        left21
15FC E53B           3544                             mov             a,movrig;уст в правую позицию
15FE F6             3545                             mov             @r0,a
                    3546     
15FF 020000   F     3547                             jmp             goto7                                            
1602 E53A           3548     left21:         mov             a,movleft;уст в левую позицию
1604 F6             3549                             mov             @r0,a   
1605 020000   F     3550                             jmp             goto7
                    3551     
                    3552     
1608 B61215         3553     mvv11:            cjne          @r0,#12h,mvv12
160B 7631           3554                                     mov             @r0,#31h
160D 900000   F     3555     loblok:                 mov             dptr,#teBL0;БЛОК 0
1610 120000   F     3556                                     call    lotext
1613 E538           3557                                     mov                     a,nblok
1615 2430           3558                                     add                     a,#30h
1617 F547           3559                                     mov                     bufind+7,a
1619 78B2           3560                                     mov             r0,#marker
161B 7607           3561                                     mov             @r0,#7
                    3562                                     ;mov            movrig,#9
                    3563                                     ;mov            movleft,#6
161D 020000   F     3564                                     jmp             goto7;outF
1620 B61411         3565     mvv12:  cjne            @r0,#14h,bl_li
1623 7661           3566                                     mov                     @r0,#61h
1625 900000   F     3567                                     mov             dptr,#teMIN;
1628 120000   F     3568                                     call    lotext
162B 120000   F     3569                                     call    vichmin
162E 120000   F     3570                                     call    z_1s
1631 020000   F     3571                                     jmp             out7;goto7;outF
                    3572     
1634 7641           3573     bl_li:          mov             @r0,#41h                ; БЛОК 00(ЗАПИСЬ И ПРОСМОТР)
1636 80D5           3574                                     jmp             loblok
                    3575     
                    3576     
                    3577     
1638                3578     mlabL2:         ;jmp            labL2
                    3579                                             ;  уст курсор в правую позицию 
                    3580                                     ;                               29.12.06
                    3581     ;;;;;;;;;;;;;;;;;;
                    3582     ;необходимо не портить цифру в следуюем справа знакоместе
                    3583     ;т е сохранить ее в ячейке для мигания в противном случае
                    3584     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3585     ;       знакоместа
1638 78B2           3586                                             mov             r0,#marker
163A 7440           3587                                     mov             a,#bufind
163C 26             3588                                             add             a,@r0                   ;a=bufind+m
                             arker
163D F9             3589                                             mov             r1,a
163E 09             3590                                             inc             r1
163F 873C           3591                                             mov             savba,@r1
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    57

                    3592     ;;;;;;;;;;;;;;;;
1641 78B2           3593                       mov           r0,#marker      ;курсор справа  ?
1643 E53B           3594                             mov             a,movrig
1645 C3             3595                             clr             c
1646 96             3596                             subb    a,@r0
1647 6006           3597                             jz         equ2l
1649 E53B           3598                             mov             a,movrig;уст в правую позицию
164B F6             3599                             mov             @r0,a
                    3600     ;                       lool
164C 020000   F     3601                             jmp             goto7                                            
164F E53A           3602     equ2l:          mov             a,movleft;уст в левую позицию
1651 F6             3603                             mov             @r0,a   
1652 020000   F     3604                             jmp             goto7
                    3605                     
1655 020000   F     3606     rnom31:         jmp                     nom31
1658 B631FA         3607     labM:                   cjne    @r0,#31h,rnom31
165B 75B0FB         3608                                     mov             p3,#0fbh
165E 30B7D7         3609                                     jnb             p3.7,mlabL2
1661 75B0F7         3610                                mov          p3,#0f7h
1664 20B782         3611                                jb           p3.7,ddoutf
                    3612                                
1667 7632           3613                                mov          @r0,#32h                        ;ИНТ 0000
                    3614                                     ;       считать с индикатора  
1669 C3             3615     blokvv:         clr                     c
166A E547           3616                                mov          a,bufind+7      
166C 9430           3617                                      subb           a,#30h
166E B40002         3618                                      cjne           a,#0,blokvvc
1671 7401           3619                                      mov            a,#1                    ;номера блоков 1..4
                    3620     
1673 F538           3621     blokvvc: mov            nblok,a
1675 900000   F     3622                                mov          dptr,#teINT;ИНТ 0000c
1678 120000   F     3623                                call         lotext
167B 78CE           3624                                      mov            r0,#interva+1
167D 7952           3625                                      mov            r1,#abin+3
167F E6             3626                                      mov            a,@r0
1680 F7             3627                                      mov            @r1,a
1681 18             3628                                             dec                     r0
1682 19             3629                                             dec                     r1
1683 E6             3630                                             mov             a,@r0
1684 F7             3631                                             mov             @r1,a
1685 19             3632                                             dec             r1
1686 E4             3633                                             clr             a
1687 F7             3634                                             mov             @r1,a
1688 19             3635                                             dec             r1
1689 F7             3636                                             mov             @r1,a
                    3637                                                                             
168A 7853           3638                                             mov             r0,#adec
168C 7952           3639                                             mov             r1,#abin+3      ;hex->10
168E 120000   F     3640                                             call    bindec
                    3641                                     
1691 785C           3642                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1693 7948           3643                                             mov             r1,#bufind+8
1695 7F04           3644                                             mov             r7,#4
1697 E6             3645     bloin:                          mov             a,@r0
1698 2430           3646                                             add             a,#30h
169A F7             3647                                             mov             @r1,a
169B 19             3648                                             dec             r1
169C 18             3649                                             dec             r0
169D DFF8           3650                                             djnz    r7,bloin
169F 78B2           3651                                mov          r0,#marker
16A1 7605           3652                                mov          @r0,#5
16A3 753B08         3653                                mov          movrig,#8
16A6 753A05         3654                                mov          movleft,#5
16A9 789A           3655                                      mov            r0,#parT
16AB B60609         3656                                     cjne            @r0,#6,innot6
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    58

16AE 534BF0         3657                                     anl                     bufind+11,#0f0h;after 5- 0.000c
16B1 434B04         3658                                     orl                     bufind+11,#04h
                    3659                             
16B4 020000   F     3660                                     jmp                     goto7
16B7 B60309         3661     innot6: cjne            @r0,#3,innot3
16BA 534BF0         3662                                     anl                     bufind+11,#0f0h;after 7- 000.0c
16BD 434B20         3663                                     orl                     bufind+11,#20h
                    3664                                     ;call           ind
16C0 020000   F     3665                                     jmp                     out7;goto7
16C3 C3             3666     innot3: clr                     c
16C4 7403           3667                                     mov                     a,#3
16C6 96             3668                                     subb            a,@r0
16C7 5009           3669                                     jnc                     innot1_2
16C9 534BF0         3670                                     anl                     bufind+11,#0f0h;after 6- 00.00c
16CC 434B40         3671                                     orl                     bufind+11,#40h
                    3672                                     
16CF 020000   F     3673                                     jmp                     goto7
                    3674     
16D2                3675     innot1_2:
16D2 534B0F         3676                                     anl                     bufind+11,#0fh;0h;0000c
16D5 C219           3677                                     clr                     bitmig
                    3678                                     ;call           ind             нет необходимости пришет пр
                             обел         
16D7 020000   F     3679     rgoto7: jmp        goto7;outF
                    3680     
16DA B63276         3681     nom31:             cjne         @r0,#32h,nom32
16DD 75B0FB         3682                                     mov             p3,#0fbh
16E0 20B71F         3683                                     jb              p3.7,vvinte             ;ввод интервал;no31
                             n
                    3684                                     
16E3                3685     lefcur:         ;;кн <- 32 нач блок 000
                    3686     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3687     ;т е сохранить ее в ячейке для мигания в противном случае
                    3688     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3689     ;       знакоместа
16E3 C219           3690                                                     clr             bitmig
16E5 78B2           3691                                                     mov             r0,#marker;нажата кн <- при
                              вводе цифр нач блок 000
16E7 7440           3692                                     mov             a,#bufind
16E9 26             3693                                             add             a,@r0                   ;a=bufind+m
                             arker
16EA F9             3694                                             mov             r1,a
16EB 19             3695                                             dec             r1;;;;;;;;;;;
16EC 873C           3696                                             mov             savba,@r1
                    3697                                             
16EE 78B2           3698                                                     mov             r0,#marker      ;курсор сле
                             ва?
16F0 E53A           3699                             mov             a,movleft
16F2 C3             3700                             clr             c
16F3 96             3701                             subb    a,@r0
16F4 7006           3702                             jnz        noequ2
16F6 E53B           3703                             mov             a,movrig
16F8 F6             3704                             mov             @r0,a;уст в крайнюю правую позицию
16F9 020000   F     3705                             jmp             goto7
16FC 120000   F     3706     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
16FF 020000   F     3707                             jmp        goto7        
                    3708                                                                       
                    3709     
                    3710     ;;;;;;;;;;;;;;;;;;
1702                3711     vvinte:         ;ввод интервал                          
1702 75B0F7         3712     no31n:             mov          p3,#0f7h
1705 20B7CF         3713                                     jb              p3.7,rgoto7
1708 7633           3714                                     mov             @r0,#33h
                    3715                                     ;считать с индикатора введенный интервал
170A 7F0A           3716                                             mov             r7,#10
170C 7853           3717                                     mov             r0,#adec
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    59

170E 120000   F     3718                                     call    clearN
1711 120000   F     3719                                     call    upak4                   
1714 784F           3720                                     mov             r0,#abin
1716 7953           3721                                     mov             r1,#adec                        ;мл        
                              ст
1718 120000   F     3722                                     call    decbin                  ;abin..abin+3 (hex)
171B 794F           3723                                     mov             r1,#abin
171D 78CE           3724                                     mov             r0,#interva+1
171F E7             3725                                     mov             a,@r1
1720 F6             3726                                     mov             @r0,a
1721 18             3727                                     dec             r0
1722 09             3728                                     inc             r1
1723 E7             3729                                     mov             a,@r1
1724 F6             3730                                     mov             @r0,a
                    3731                                     
1725 78D5           3732                                     mov             r0,#volume                      ;объем блок
                             а
1727 7600           3733                                     mov             @r0,#0
1729 08             3734                                     inc             r0
172A 76C7           3735                                     mov             @r0,#0c7h
172C 120000   F     3736                                     call            adrblok;dptr
172F 120000   F     3737                                     call            save_hl;1я ячейка блока
1732 78B2           3738                                mov          r0,#marker
1734 76FF           3739                                mov          @r0,#0ffh
1736 D204           3740                                      setb           bitizm
1738 C20B           3741                                      clr            bitmem
173A 789A           3742     vvod2_10: mov           r0,#parT
173C B6050C         3743                                      cjne           @r0,#5,no10msv
173F 900000   F     3744                                             mov                     dptr,#te10ms
1742 120000   F     3745     t2msme:         call            lotext
                    3746                                             
1745 120000   F     3747                                             call            ind
1748 020000   F     3748     no2msv:   jmp      goto7;
174B B606FA         3749     no10msv:        cjne            @r0,#6,no2msv   
174E 900000   F     3750                                             mov                     dptr,#te2ms
1751 80EF           3751                                     jmp                     t2msme
                    3752     
                    3753     
                    3754     
1753 B6332B         3755     nom32:           cjne           @r0,#33h,nom33
1756 75B0FB         3756                              mov            p3,#0fbh
1759 30B787         3757                              jnb            p3.7,lefcur
175C 75B0F7         3758                              mov            p3,#0f7h
175F 20B7E6         3759                              jb             p3.7,no2msv;rgoto7
                    3760                              ;запомнить номер ячейки конца блока
1762 7634           3761                              mov    @r0,#34h
1764 7F0A           3762     INTn:                   mov             r7,#10
1766 7853           3763                                     mov             r0,#adec
1768 120000   F     3764                                     call    clearN
176B 120000   F     3765                                     call    upak3                   
176E 784F           3766                                     mov             r0,#abin
1770 7953           3767                                     mov             r1,#adec                        ;мл        
                              ст
1772 120000   F     3768                                     call    decbin                  ;abin..abin+3 (hex)
1775 120000   F     3769                                     call    loadr2                  ;r2..r5
1778 120402         3770                                     call    altof                   ;r2..r5->int
177B 020000   F     3771     dgoto7:                  jmp            goto7
                    3772     
177E 020000   F     3773     rlefcur:                jmp             lefcur
                    3774     
1781 B63464         3775     nom33:          cjne            @r0,#34h,labelP
1784 75B0FB         3776                               mov           p3,#0fbh
1787 30B7F4         3777                              jnb            p3.7,rlefcur
178A 75B0F7         3778                              mov            p3,#0f7h
178D 20B7EB         3779                              jb             p3.7,dgoto7
1790 7635           3780                              mov            @r0,#35h
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    60

1792 78B2           3781                              mov            r0,#marker
1794 76FF           3782                              mov            @r0,#0ffh
                    3783                              ;T1<-число на индикаторе
                    3784                                               ;vvod КОН БЛ 000
1796 78CF           3785                              mov            r0,#chbuf               ;счетчик периода загрузки в
                              буфер и интерфейс
1798 7630           3786                              mov            @r0,#30h  
179A C20B           3787                              clr            bitmem
179C D204           3788                              setb           bitizm;;;;      
179E 020000   F     3789                             jmp        goto7
17A1 020000   F     3790     vodm11_15:                      jmp             vvodm11_15
17A4 020000   F     3791     me11_15de:                      jmp             me11_15dec
17A7 020000   F     3792     moutkmem:                               jmp             outkmem
                    3793     
17AA 020000   F     3794     nmem_menu:              jmp             out7                    ;нажата память в режиме мен
                             ю
                    3795     ;обработка кнопки меню ввод
17AD 301138         3796     labelS:         jnb                     bitmenu,labelP
17B0 75B0EF         3797                                             mov                     p3,#0efh
17B3 30B7F4         3798                                             jnb                     p3.7,nmem_menu
17B6 75B0DF         3799                                             mov                     p3,#0dfh
17B9 30B7EB         3800                                             jnb                     p3.7,moutkmem
17BC 78B1           3801                                             mov                     r0,#vichR
17BE 7415           3802                                             mov                     a,#15h
17C0 C3             3803                                             clr                     c
17C1 96             3804                                             subb            a,@r0
17C2 4021           3805                                             jc                      rme21_23
                    3806                             
17C4 75B0FB         3807                                             mov                     p3,#0fbh
17C7 20B7D7         3808                                             jb                      p3.7,vodm11_15
17CA 78B1           3809                                             mov                     r0,#vichR
17CC B611D5         3810                                             cjne                    @r0,#11h,me11_15de;<-
17CF 7615           3811                                             mov                     @r0,#15h
17D1 900000   F     3812                                             mov                     dptr,#teKALIB
17D4 120000   F     3813                                             call            lotext
17D7 020000   F     3814                                             jmp                     onmem11
17DA C211           3815     menuon:         clr             bitmenu                 ;off menu
17DC D204           3816                                             setb    bitizm
                    3817     
17DE 78B1           3818                                     mov             r0,#vichR
17E0 7600           3819                                     mov             @r0,#0
17E2 020000   F     3820                                     jmp             onmem11
                    3821     
                    3822                                             ;;;;;
                    3823             
17E5 020000   F     3824     rme21_23:               jmp             me21_23 
                    3825                             
                    3826     ;режим просмотра
17E8 B64130         3827     labelP:                 cjne            @r0,#41h,govvlist
17EB 7642           3828                                                     mov                     @r0,#42h
                    3829                                                     ;       считать с индикатора  
17ED C3             3830                                             clr                     c
17EE E547           3831                                mov          a,bufind+7      
17F0 9430           3832                                      subb           a,#30h
17F2 B40002         3833                                      cjne           a,#0,chaipr
17F5 7401           3834                                      mov            a,#1
17F7 F538           3835     chaipr:                          mov            nblok,a
17F9 900000   F     3836                                mov          dptr,#teCH;ОТСЧЕТ 000
17FC 120000   F     3837                                call         lotext
17FF 534BEF         3838                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
1802 78B2           3839                                mov          r0,#marker
1804 7607           3840                                mov          @r0,#7
1806 753B09         3841                                mov          movrig,#9
1809 753A07         3842                                mov          movleft,#7
180C 120000   F     3843                                             call            z_1s
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    61

180F 020000   F     3844                        jmp     goto7;outF
1812 020000   F     3845     label43:                jmp             label7
                    3846     
1815 020000   F     3847     rlist_43:                       jmp                     list_43                            
                                  
1818 020000   F     3848     mlabL2r:                        jmp                     mlabL2
181B B642F7         3849     govvlist:                       cjne            @r0,#42h,rlist_43
181E 75B0FB         3850                                                                     mov                     p3,
                             #0fbh
1821 30B7F4         3851                                                             jnb                     p3.7,mlabL2
                             r;кн <- ОТСЧЕТ 000
1824 75B0F7         3852                                                             mov                     p3,#0f7h
1827 20B7E8         3853                                                             jb                      p3.7,label4
                             3
182A 7643           3854                                                             mov                     @r0,#43h;vv
                             od 
182C 78B2           3855                                                             mov                     r0,#marker
182E 76FF           3856                                                             mov                     @r0,#0ffh
1830 7F0A           3857                                                                     mov             r7,#10
1832 7853           3858                                     mov             r0,#adec
1834 120000   F     3859                                     call    clearN
1837 120000   F     3860                                     call    upak3                   
183A 784F           3861                                     mov             r0,#abin
183C 7953           3862                                     mov             r1,#adec                        ;мл        
                              ст
183E 120000   F     3863                                     call    decbin                  ;abin..abin+3 (hex)
1841 120000   F     3864                                     call    loadr2                  ;r2..r5
1844 ED             3865                                     mov             a,r5                            ;сохр номер
                              лемента
1845 F537           3866                                     mov             nelem,a
1847 120402         3867                                     call    altof                   ;r2..r5->int
184A 900000   F     3868                                     mov             dptr,#ch_1;
184D 120000   F     3869                                     call    ldc_ltemp                       ;r8..r11
1850 1201D1         3870                                     call    flsub
1853 900000   F     3871                                     mov             dptr,#ch_4;
1856 120000   F     3872                                     call    ldc_ltemp                       ;r8..r11
1859 120203         3873                                     call    flmul                           ;(n(номер отсчета)-
                             1)*4+адр нач блока
185C 120343         3874                                     call            ftol                    ;r2..r5->hex
185F C002           3875                                     push            rr2
1861 C003           3876                                     push            rr3
1863 C004           3877                                     push            rr4
1865 C005           3878                                     push            rr5
1867 120000   F     3879                                     call            adrblok;dptr-
186A D005           3880                                     pop                     rr5
186C D004           3881                                     pop                     rr4
186E D003           3882                                     pop                     rr3
1870 D002           3883                                     pop                     rr2
1872 79D8           3884                                     mov                     r1,#copy_hl+1;saven_bl+1;сохр адрес
                              внешн озу введенного лемента
1874 E582           3885                                     mov                     a,dpl
1876 2D             3886                                     add                     a,r5
1877 F582           3887                                     mov                     dpl,a
1879 F7             3888                                     mov                     @r1,a           ;low
187A E583           3889                                     mov                     a,dph
187C 3C             3890                                     addc            a,r4
187D F583           3891                                     mov                     dph,a
187F 19             3892                                     dec                     r1
1880 F7             3893                                     mov                     @r1,a                   ;high
                    3894                             
1881                3895     li42_43:
1881 120000   F     3896                                     call            reA3_X          ;r2..r5/выдать рез из внешн
                              пам на индикатор
1884 900000   F     3897                                     mov             dptr,#ch10;
1887 120000   F     3898                                     call    ldc_ltemp
188A 120000   F     3899                                     call    zdiv    
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    62

                    3900                                     ;;;;;;;;;;;
188D 120000   F     3901                                     call    maform
                    3902                                     ;;;;
                    3903     
                    3904                                     ;;;;;;;
1890 784F           3905                                             mov             r0,#abin
1892 120000   F     3906                                             call    saver2
1895 7853           3907                                             mov             r0,#adec
1897 7952           3908                                             mov             r1,#abin+3      ;hex->10
1899 120000   F     3909                                             call    bindec
                    3910                                     
189C 785C           3911                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
189E 7945           3912                                             mov             r1,#bufind+5
18A0 7F07           3913                                             mov             r7,#7
18A2 E6             3914     ch43:                           mov             a,@r0
18A3 2430           3915                                             add             a,#30h
18A5 F7             3916                                             mov             @r1,a
18A6 19             3917                                             dec             r1
18A7 18             3918                                             dec             r0
18A8 DFF8           3919                                             djnz    r7,ch43
18AA 7847           3920                                             mov             r0,#bufind+7
18AC 762D           3921                                             mov             @r0,#2dh          ;-2..-9
18AE 7840           3922                                             mov             r0,#bufind
18B0 762B           3923                                             mov             @r0,#2bh
18B2 300202         3924                                             jnb             znmat,nozzmi43;bitznak,nozzmi
18B5 762D           3925                                             mov             @r0,#2dh
18B7 E538           3926     nozzmi43:       mov             a,nblok
18B9 B40104         3927                                             cjne    a,#1,nozzmi1            
18BC 7934           3928                                             mov             r1,#sadiap;diap
18BE 8010           3929                                             jmp             nozzbl
18C0 B40204         3930     nozzmi1:        cjne    a,#2,nozzmi2            
18C3 7932           3931                                             mov             r1,#sadiap2;diap
18C5 8009           3932                                             jmp             nozzbl
18C7 B40304         3933     nozzmi2:        cjne    a,#3,nozzmi3            
18CA 7931           3934                                             mov             r1,#sadiap3;diap
18CC 8002           3935                                             jmp             nozzbl
18CE 7930           3936     nozzmi3:        mov             r1,#sadiap4;diap
                    3937                                     
18D0 7848           3938     nozzbl:         mov             r0,#bufind+8
18D2 E7             3939                                             mov             a,@r1
18D3 B40808         3940                                             cjne    a,#8,nodi8_43
18D6 7630           3941                                             mov             @r0,#30h                 ;10-10
18D8 18             3942                                             dec             r0
18D9 7663           3943                                             mov             @r0,#63h;31h
18DB 08             3944                                             inc             r0
18DC 800E           3945                                             jmp             see_l43
18DE B40908         3946     nodi8_43:       cjne    a,#9,nodi9_43
                    3947                                     
18E1 7631           3948                                             mov             @r0,#31h           ;10-11
18E3 18             3949                                             dec             r0
18E4 7663           3950                                             mov             @r0,#63h;31h
                    3951                                     
18E6 08             3952                                             inc             r0
18E7 8003           3953                                             jmp             see_l43
18E9 2432           3954     nodi9_43:               add             a,#32h
18EB F6             3955                                             mov             @r0,a;
18EC 08             3956     see_l43:                        inc             r0
18ED 7641           3957                                             mov             @r0,#"A";"E";
                    3958                             ;       inc             r0
                    3959                             ;       mov             @r0,#00h ;=feh в нач установе для поджига в
                             сех сегм
                    3960                             ;       inc             r0;             mov             bufind+11
                    3961                             ;       mov             @r0,#0d0h               ;bufind+11.4 точка 
                             после первой цифры
18EF 434B10         3962                             orl                     bufind+11,#10h
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    63

18F2 120000   F     3963     out43:          call            ind
18F5 120000   F     3964                                             call            z_1s
18F8 020000   F     3965                                             jmp             out7                               
                                  
                    3966     
                    3967                                     ;;;;;;;;        
18FB 783D           3968     label7: mov             r0,#chkl
18FD 7604           3969                                     mov             @r0,#04;3
18FF 08             3970                                     inc             r0
1900 76E8           3971                                     mov             @r0,#0e8h               ;1000
1902 020000   F     3972                                     jmp             out7;
1905 B64351         3973     list_43:                cjne    @r0,#43h,noli_43
1908 75B0FB         3974                                                     mov             p3,#0fbh                ;43
                             h <-
190B 20B70A         3975                                                     jb              p3.7,vvod43             ;vv
                             od
190E C20B           3976                                                     clr             bitmem
1910 D204           3977                                                     setb    bitizm
1912 78B2           3978                                                     mov             r0,#marker
1914 76FF           3979                                                     mov             @r0,#0ffh
1916 80E3           3980                                                     jmp             label7;по кн <- выход из пр
                             осмотра
                    3981     
1918 7644           3982     vvod43:                 mov             @r0,#44h
191A E537           3983                                                     mov             a,nelem;вывод порядкового н
                             омера в блоке 
191C 04             3984                                                     inc             a
191D F552           3985                                                     mov             abin+3,a
                    3986                                                     
191F F537           3987                                                     mov             nelem,a
1921 E4             3988                                                     clr             a
1922 F551           3989                                                     mov             abin+2,a
1924 F550           3990                                                     mov             abin+1,a
1926 F54F           3991                                                     mov             abin,a
                    3992                                             
1928 7853           3993                                             mov             r0,#adec
192A 7952           3994                                             mov             r1,#abin+3      ;hex->10
192C 120000   F     3995                                             call    bindec
192F 7840           3996                                             mov             r0,#bufind;почистить индикатор
1931 7F0A           3997                                             mov             r7,#10
1933 7420           3998                                             mov             a,#20h
1935 F6             3999     cle20:          mov             @r0,a
1936 08             4000                                             inc             r0
1937 DFFC           4001                                             djnz    r7,cle20
                    4002                                             ;;;;;;
1939 900000   F     4003                                             mov             dptr,#teCH;ОТСЧЕТ 000
193C 120000   F     4004                                call         lotext
193F 534BEF         4005                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
1942 785C           4006                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1944 7949           4007                                             mov             r1,#bufind+9
1946 7F03           4008                                             mov             r7,#3
1948 E6             4009     ch43_42:                                mov             a,@r0
1949 2430           4010                                             add             a,#30h
194B F7             4011                                             mov             @r1,a
194C 19             4012                                             dec             r1
194D 18             4013                                             dec             r0
194E DFF8           4014                                             djnz    r7,ch43_42
1950 120000   F     4015                                             call            ind
1953 120000   F     4016                                             call            z_1s
1956 020000   F     4017                                             jmp             out7
1959 B64419         4018     noli_43:        cjne            @r0,#44h,vvosta
195C 7643           4019                                             mov                     @r0,#43h
195E 79D8           4020                                                     mov                     r1,#copy_hl+1;saven
                             _bl+1
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    64

1960 E7             4021                                                     mov                     a,@r1
1961 F582           4022                                                     mov                     dpl,a
1963 19             4023                                                     dec                     r1
1964 E7             4024                                                     mov                     a,@r1;high
1965 F583           4025                                                     mov                     dph,a
1967 A3             4026                                                     inc                     dptr
1968 A3             4027                                                     inc                     dptr
1969 A3             4028                                                     inc                     dptr
196A A3             4029                                                     inc                     dptr
196B E583           4030                                                     mov                     a,dph
196D F7             4031                                                     mov                     @r1,a
196E 09             4032                                                     inc                     r1
196F E582           4033                                                     mov                     a,dpl
1971 F7             4034                                                     mov                     @r1,a              
                                          ;сохр адр внешн озу
1972 020000   F     4035                                             jmp                     li42_43;вывод значения след
                             ующего в блоке
                    4036     
1975 B66111         4037     vvosta:                 cjne            @r0,#61h,vvostad
1978 7662           4038                                                     mov                     @r0,#62h
197A 900000   F     4039                                                     mov                     dptr,#teMAX;
197D 120000   F     4040                                                     call            lotext
1980 120000   F     4041                                                     call            vichmax
1983 120000   F     4042                                                     call            z_05s;z_1s
1986 020000   F     4043                                                     jmp             goto7
                    4044     
1989 B66211         4045     vvostad:                cjne            @r0,#62h,rousta
198C 7663           4046                                                     mov                     @r0,#63h
198E 900000   F     4047                                                     mov             dptr,#teMid;
1991 120000   F     4048                                                     call    lotext
1994 120000   F     4049                                                     call            vichmean
1997 120000   F     4050                                                     call            z_05s
199A 020000   F     4051                                                     jmp             goto7
                    4052     
199D B6630E         4053     rousta:                 cjne            @r0,#63h,rousta1
19A0 7661           4054                                                     mov                     @r0,#61h
19A2 900000   F     4055                                                     mov             dptr,#teMin;
19A5 120000   F     4056                                                     call    lotext
19A8 120000   F     4057                                                     call            vichmin
19AB 120000   F     4058                                                     call            z_05s
19AE 020000   F     4059     rousta1:                jmp             goto7
                    4060     
19B1 020000   F     4061     rLABELP:                jmp                     LABELP
19B4 78B1           4062     vvodm11_15:     mov                     r0,#vichR;vvod
19B6 75B0F7         4063                                                     mov                     p3,#0f7h
19B9 20B7F5         4064                                             jb                      p3.7,rLABELP;????
                    4065                                     
                    4066     
19BC B61115         4067                                             cjne                    @r0,#11h,tome21
19BF 7621           4068                                             mov                     @r0,#21h;vvod
19C1 900000   F     4069                                             mov                     dptr,#teTE11
19C4 120000   F     4070                                             call            lotext
19C7 534B03         4071                                             anl                     bufind+11,#03h ;погасить за
                             пятые
19CA 020000   F     4072                                             jmp                     onmem11
                    4073     
19CD 16             4074     me11_15dec:             dec             @r0                             ;<-
19CE 120000   F     4075     lokame1:        call            lomenu
19D1 020000   F     4076                                             jmp                     onmem11
                    4077     
19D4 B61206         4078     tome21:         cjne                    @r0,#12h,tome13
                    4079                                             ;вкл тест интерфейса
19D7 020000   F     4080                                             jmp             testrs;??????????
19DA 020000   F     4081                                             jmp                     onmem11
                    4082     
19DD B6132A         4083     tome13:         cjne                    @r0,#13h,tome14
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    65

19E0 7631           4084                                             mov                     @r0,#31h
                    4085                                             
19E2 7A50           4086                                             mov                     r2,#50h                    
                                  ;57.6->19.2
19E4 7B2C           4087                                             mov                     r3,#2ch
19E6 120454         4088                                             call            re4byte                 ;28..2bh 3b
                             ait-parol,1 bait skor
19E9 E508           4089                                             mov                     a,r8
19EB B4000E         4090                                             cjne            a,#00,skor19
19EE 900000   F     4091                                             mov                     dptr,#teS57_6;57,6
19F1 120000   F     4092                                             call            lotext
19F4 434B80         4093                                     orl                     bufind+11,#80h
19F7 C213           4094                                             clr                     bitv19
                    4095     
19F9 020000   F     4096                                             jmp             onmem11
19FC 900000   F     4097     skor19:         mov                     dptr,#teS19_2
19FF 120000   F     4098                                             call            lotext
1A02 D213           4099                                             setb            bitv19
1A04 434B80         4100                                             orl                     bufind+11,#80h
1A07 020000   F     4101                                             jmp                     onmem11
                    4102                                             
                    4103     
1A0A B61415         4104     tome14:         cjne                    @r0,#14h,tome15
1A0D D204           4105                                             setb            bitizm
1A0F 7881           4106                                             mov                     r0,#chavt
1A11 7600           4107                                             mov                     @r0,#0
1A13 08             4108                                             inc                     r0
1A14 7600           4109                                             mov                     @r0,#0
1A16 C211           4110     outmenu:        clr                     bitmenu
1A18 020000   F     4111                                             jmp                     out7
                    4112     
1A1B 78B1           4113     goparom:        mov             r0,#vichR               ;режим меню 52
1A1D 7652           4114                                             mov                     @r0,#52h                   
                                  ;пароль уже ввели
1A1F 020000   F     4115                                             jmp                     goparol
1A22 2016F6         4116     tome15:         jb              bitpar,goparom  
1A25 7651           4117                                             mov                     @r0,#51h;ПАРОЛЬ 000
1A27 120000   F     4118                                             call            lomenu
1A2A 78B2           4119                                             mov                     r0,#marker
1A2C 7607           4120                                             mov                     @r0,#7
1A2E 753B09         4121                                             mov                     movrig,#9
1A31 753A07         4122                                             mov                     movleft,#7
                    4123                                             ;setb           bitizm
1A34 020000   F     4124                                             jmp                     onmem11
                    4125     
                    4126     
1A37 78B1           4127     me21_23:        mov                     r0,#vichR               ;<-
1A39 7423           4128                                             mov                     a,#23h
1A3B C3             4129                                             clr                     c
1A3C 96             4130                                             subb            a,@r0
1A3D 403D           4131                                             jc                      labelS1
1A3F 75B0FB         4132                                             mov                     p3,#0fbh
1A42 20B718         4133                                             jb                      p3.7,vv21_23
1A45 B6210B         4134                                             cjne            @r0,#21h,me21_23dec;-<
1A48 7623           4135                                             mov                     @r0,#23h
1A4A 900000   F     4136                                             mov                     dptr,#teTE7
1A4D 120000   F     4137                                             call            lotext
1A50 020000   F     4138                                             jmp                     onmem11
1A53                4139     me21_23dec:     
1A53 16             4140                                             dec                     @r0
1A54 120000   F     4141                                             call            lomenu
1A57 020000   F     4142                                             jmp                     onmem11
1A5A 020000   F     4143     onmem12:        jmp             outF    ;(ie7)                          
                    4144                                                     
1A5D 75B0F7         4145     vv21_23:        mov             p3,#0f7h                ;vvod
1A60 20B7F7         4146                                             jb              p3.7,onmem12
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    66

1A63 B6210C         4147                                             cjne            @r0,#21h,test22
                    4148                                             ;mov                    dptr,#tabt11;заслать ус 11А
1A66 120000   F     4149     tests:          call            lotpus
1A69 D215           4150                                             setb            biteizm;запомнить режим ТИ
1A6B D204           4151                                             setb            bitizm
1A6D C211           4152                                             clr                     bitmenu;обнулить т к не буд
                             ет индикации измерения       
1A6F 020000   F     4153                                             jmp                     onmem11
1A72 B62202         4154     test22:         cjne            @r0,#22h,test23
                    4155                                     ;       mov                     dptr,#tabt9;заслать ус 9А
1A75 80EF           4156                                             jmp             tests   
1A77                4157     test23:
                    4158                                     ;       mov                     dptr,#tabt7;заслать ус 7А
1A77 80ED           4159                                             jmp             tests   
1A79 020000   F     4160     left_s:         jmp                     left_sk
1A7C B63175         4161     labelS1:        cjne            @r0,#31h,me_41
1A7F 75B0FB         4162                                             mov                     p3,#0fbh                   
                                  ;<-
1A82 30B7F4         4163                                             jnb                     p3.7,left_s
1A85 75B0F7         4164                                             mov                     p3,#0f7h
1A88 20B7CF         4165                                             jb                      p3.7,onmem12
                    4166                                             ;запомнить признак установленной скорости в рпзу
                    4167     
                    4168     ;чтение пам прогр(5000h) 1 страница(ffh)
                    4169     ;и запись во внешнее озу(0000h)
1A8B 7900           4170                                             mov             r1,#0                   ;
1A8D 7A50           4171                                     mov             r2,#50h
1A8F 7B00           4172                                     mov             r3,#00
1A91 120499         4173                                     call    copyPP
                    4174                                     ;внести изменения во внешн озу
                    4175                                     ;KD=00 01 86 A0 (KD=1)
                    4176                                     ;кофф *100000 и переведенный в hex формат
                    4177                                     ;согласно адресов диапазонов и адресов яч вн озу 
1A94 792C           4178                                     mov             r1,#2ch
1A96 7400           4179                                     mov             a,#0;57,6
1A98 301302         4180                                     jnb             bitv19,spwri
1A9B 7401           4181                                     mov             a,#1;19.6
1A9D F3             4182     spwri:  movx    @r1,a
                    4183     ;стереть страницу пап прогр 
1A9E 905000         4184                                     mov             dptr,#5000h
1AA1 7FFF           4185                                     mov             r7,#0ffh
1AA3 12043E         4186                                     call    cle256
                    4187     ;и запись в ячейки кофф памяти прогр (3000h) 
1AA6 7FFF           4188                                     mov             r7,#0ffh
1AA8 7900           4189                                     mov             r1,#0                           ;external r
                             am
1AAA 905000         4190                                     mov             dptr,#5000h
1AAD 120480         4191                                     call    wrpage
                    4192             
1AB0 201305         4193                                     jb              bitv19,outsko1  ;загр Т1 в соотв с установл
                             енной скоростью
1AB3 758DF4         4194                                             mov                     TH1,#244                ;57
                             .6
1AB6 8003           4195                                             jmp                     outsko
1AB8 758DDC         4196     outsko1:                                        mov                     TH1,#220           
                                  ;19.6
1ABB C211           4197     outsko:         clr             bitmenu
1ABD D204           4198                                             setb            bitizm
1ABF 020000   F     4199                                             jmp                     out7
                    4200     
1AC2 020000   F     4201     rlabels4:               jmp             labels4
1AC5 020000   F     4202     rlabelS13:      jmp             labelS13
                    4203     
1AC8 B652F7         4204     me_52:          cjne            @r0,#52h,rlabels4
1ACB 75B0FB         4205                                             mov                     p3,#0fbh;<-
1ACE 20B717         4206                                             jb                      p3.7,vv_52v     ;ввод в кал
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    67

                             ибровке
1AD1 78B2           4207                                                     mov             r0,#marker              ;сд
                             виг маркера влево при калибр
1AD3 7440           4208                                     mov             a,#bufind
1AD5 26             4209                                             add             a,@r0                   ;a=bufind+m
                             arker
1AD6 F9             4210                                             mov             r1,a
1AD7 19             4211                                             dec             r1;inc          r1
1AD8 873C           4212                                             mov             savba,@r1
                    4213                                                     
1ADA 78B2           4214                                             mov             r0,#marker
1ADC 16             4215                                             dec             @r0                             
1ADD C219           4216                                             clr             bitmig
1ADF E53A           4217                                             mov                     a,movleft
1AE1 B60001         4218                                             cjne    @r0,#0,me_52v;ажата кн <- при вводе цифр ка
                             либровки
1AE4 06             4219                                             inc                     @r0
1AE5 020000   F     4220     me_52v:         jmp                     goto7
                    4221     
1AE8 75B0F7         4222     vv_52v:         mov             p3,#0f7h
1AEB 30B703         4223                                             jnb             p3.7,rvvkali52
1AEE 020000   F     4224                                             jmp                     goto7
1AF1 020000   F     4225     rvvkali52:      jmp             vvkali52
                    4226     
                    4227     
1AF4 B651D1         4228     me_41:          cjne            @r0,#51h,me_52;rlabels4
1AF7 75B0FB         4229                                             mov             p3,#0fbh;<-
1AFA 30B7C8         4230                                             jnb             p3.7,rlabelS13
1AFD 75B0F7         4231                                             mov             p3,#0f7h
1B00 20B773         4232                                             jb              p3.7,vvmenu
                    4233                                             ;ввод пароля
                    4234                                     
                    4235     ;       считать с индикатора 
1B03 7F0E           4236                                     mov             r7,#14
1B05 784F           4237                                     mov             r0,#abin
1B07 120000   F     4238                                     call    clearN                  
                    4239                                     
                    4240     ;чтение номера байта с индикатора(3байта)
                    4241     ;bufind+3..bufind+9
                    4242     ;-  - - -
                    4243     ;- - - - - - - - - -
                    4244     ;adec..adec+9
                    4245     ;ст            мл
1B0A 7849           4246                                     mov             r0,#bufind+9;
1B0C 795C           4247                                     mov             r1,#adec+9
1B0E 7F03           4248                                     mov             r7,#3;3bait
1B10 C3             4249     upav1:          clr             c
1B11 E6             4250                                     mov             a,@r0
1B12 9430           4251                                     subb    a,#30h
1B14 F7             4252                                     mov             @r1,a
1B15 18             4253                                     dec             r0
1B16 19             4254                                     dec             r1
1B17 DFF7           4255                                     djnz    r7,upav1;adec+7..adec+9
1B19 7A50           4256                                             mov                     r2,#50h                    
                                  ;parol 000x    (5028h )
1B1B 7B28           4257                                             mov                     r3,#28h
1B1D 120454         4258                                             call            re4byte                 ;r8..r11(3 
                             bait parol)
1B20 800F           4259     jmp                     goparol
1B22 E508           4260                                     mov                     a,r8                    ;сравнить п
                             ароль с индикатором
1B24 B55A52         4261                                     cjne            a,adec+7,parerr
1B27 E509           4262                                     mov                     a,r9    
1B29 B55B4D         4263                                     cjne            a,adec+8,parerr
1B2C E50A           4264                                     mov                     a,r10
1B2E B55C48         4265                                     cjne            a,adec+9,parerr
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    68

                    4266                                     ;равны
1B31 78B1           4267     goparol:        mov             r0,#vichR               ;режим меню 52
1B33 7652           4268                                             mov             @r0,#52h                ;0000-n
1B35 900000   F     4269                                             mov             dptr,#teKD;00000-nA
1B38 120000   F     4270                                             call            lotext
                    4271                                             ;;;;;;;;;
                    4272                                                     ;n(hex)->abin
1B3B 120000   F     4273                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
1B3E 2552           4274                                             add             a,abin+3
1B40 F552           4275                                             mov             abin+3,a
1B42 7853           4276                                             mov             r0,#adec
1B44 7952           4277                                             mov             r1,#abin+3      ;hex->10
1B46 120000   F     4278                                             call    bindec
1B49 855C48         4279                                             mov             bufind+8,adec+9
1B4C 75472D         4280                                             mov             bufind+7,#2dh
1B4F 434A80         4281                                             orl                     bufind+10,#80h;зажечь KMП
1B52 434B10         4282                                             orl                     bufind+11,#10h;точка после 
                             1 знакоместа
1B55 79AE           4283                                             mov             r1,#diap
1B57 7848           4284                                             mov             r0,#bufind+8
1B59 E7             4285                                             mov             a,@r1
1B5A B40807         4286                                             cjne    a,#8,nodi8k
1B5D 7630           4287                                             mov             @r0,#30h                 ;10-10
1B5F 18             4288                                             dec             r0
1B60 7663           4289                                             mov             @r0,#63h;31h
1B62 8008           4290                                             jmp             nodisk9
1B64 B40905         4291     nodi8k:                         cjne    a,#9,nodisk9
                    4292                                     
1B67 7631           4293                                             mov             @r0,#31h           ;10-11
1B69 18             4294                                             dec             r0
1B6A 7663           4295                                             mov             @r0,#63h;31h
                    4296                                     
                    4297     
1B6C 78B2           4298     nodisk9:        mov                     r0,#marker
1B6E 7601           4299                                             mov                     @r0,#1
1B70 753A01         4300                                             mov                     movleft,#1
1B73 753B05         4301                                             mov                     movrig,#5
                    4302                                             
1B76 020000   F     4303     vvmenu:         jmp             goto7
                    4304     
1B79 753932         4305     parerr:         mov                     nuerr,#32h
1B7C 120000   F     4306                                             call            error
1B7F 120000   F     4307                                             call            ind
1B82 120000   F     4308                                             call            z_1s
1B85 C211           4309                                             clr                     bitmenu
1B87 D204           4310                                             setb            bitizm
1B89 78B2           4311                                             mov                     r0,#marker
1B8B 76FF           4312                                             mov                     @r0,#0ffh
1B8D 020000   F     4313                                             jmp             goto7
                    4314     
1B90 30130E         4315     left_sk:                jnb                     bitv19,tosk19;<-
1B93 900000   F     4316                                             mov                     dptr,#teS57_6;57,6
1B96 120000   F     4317                                             call            lotext
1B99 434B80         4318                                             orl                     bufind+11,#80h
1B9C C213           4319                                             clr                     bitv19
1B9E 020000   F     4320                                             jmp             out7
1BA1 900000   F     4321     tosk19:         mov                     dptr,#teS19_2
1BA4 120000   F     4322                                             call            lotext
1BA7 434B80         4323                                             orl                     bufind+11,#80h
1BAA D213           4324                                             setb            bitv19
1BAC 020000   F     4325                                             jmp             out7
                    4326     
1BAF                4327     labelS13:;<- MENU(ПАРОЛЬ 000)
                    4328             
                    4329     ;;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    69

                    4330     ;необходимо не портить цифру в следуюем слева знакоместе
                    4331     ;т е сохранить ее в ячейке для мигания в противном случае
                    4332     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4333     ;       знакоместа
1BAF 78B2           4334                                     mov             r0,#marker
1BB1 7440           4335                                     mov             a,#bufind
1BB3 26             4336                                             add             a,@r0                   ;a=bufind+m
                             arker
1BB4 F9             4337                                             mov             r1,a
1BB5 19             4338                                             dec             r1;inc          r1
1BB6 873C           4339                                             mov             savba,@r1
                    4340                                                     
1BB8 78B2           4341                                                     mov             r0,#marker
1BBA 16             4342                                                     dec             @r0                        
                                  
1BBB C219           4343                                     clr             bitmig
1BBD E53A           4344                                     mov                     a,movleft
1BBF B60652         4345                                     cjne    @r0,#6,onmem13;;нажата кн <- при вводе цифр ПАРОЛЬ 
                             000
1BC2 06             4346                                     inc             @r0
1BC3 020000   F     4347                                             jmp             goto7
                    4348     ;;;;;;;
                    4349     
1BC6                4350     vvkali52:       ;введено значение для калибровки
                    4351                                             ;число на индикаторе ->Ak  (52h)
                    4352                                             ;       считать с индикатора 
1BC6 7F0E           4353                                     mov             r7,#14
1BC8 784F           4354                                     mov             r0,#abin
1BCA 120000   F     4355                                     call    clearN                  
                    4356                                     
                    4357     ;чтение номера байта с индикатора(3байта)
                    4358     ;bufind+1..bufind+5
                    4359     ;-  - - -
                    4360     ;- - - - - - - - - -
                    4361     ;adec..adec+9
                    4362     ;ст            мл
1BCD 7845           4363                                     mov             r0,#bufind+5;
1BCF 795C           4364                                     mov             r1,#adec+9
1BD1 7F05           4365                                     mov             r7,#5;5bait
1BD3 C3             4366     upav2:          clr             c
1BD4 E6             4367                                     mov             a,@r0
1BD5 9430           4368                                     subb    a,#30h
1BD7 F7             4369                                     mov             @r1,a
1BD8 18             4370                                     dec             r0
1BD9 19             4371                                     dec             r1
1BDA DFF7           4372                                     djnz    r7,upav2;adec+7..adec+9
                    4373     
1BDC 784F           4374                                     mov             r0,#abin
1BDE 7953           4375                                     mov             r1,#adec                        ;мл        
                              ст
1BE0 120000   F     4376                                     call    decbin                  ;abin..abin+3 (hex)
1BE3 120000   F     4377                                     call    loadr2                  ;r2..r5
1BE6 120402         4378                                     call    altof   ;r2..r5->float
1BE9 900000   F     4379                                     mov     dptr,#ch_10;10
1BEC 120000   F     4380                                     call    ldc_ltemp                       ;r8..r11=8
1BEF 120203         4381                                     call    flmul
1BF2 78A4           4382                                     mov             r0,#rez_Ak
1BF4 120000   F     4383                                     call    saver2
1BF7 C211           4384                                             clr                     bitmenu
1BF9 D212           4385                                             setb            bitklb
1BFB 434A80         4386                                             orl                     bufind+10,#80h;зажечь KMП
1BFE D204           4387                                             setb            bitizm;бит калибровки уже установле
                             н
1C00 78B2           4388                                             mov                     r0,#marker
1C02 76FF           4389                                             mov                     @r0,#0ffh
1C04 783D           4390                                     mov             r0,#chkl
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    70

1C06 76FF           4391                                     mov             @r0,#0ffh
1C08 08             4392                                     inc             r0
1C09 76FF           4393                                     mov             @r0,#0ffh;38h
1C0B 120000   F     4394                                     call            z_1s
1C0E 020000   F     4395                                     jmp             out7
                    4396     
                    4397     
1C11 020000   F     4398                                             jmp             goto7
                    4399                                              
1C14 020000   F     4400     onmem13:        jmp             goto7   ;(ie7)
                    4401     
1C17 B642AC         4402     labels4:        cjne            @r0,#42h,vvkali52
1C1A 75B0FB         4403                                             mov                     p3,#0fbh;<-
1C1D 30B7F4         4404                                             jnb             p3.7,onmem13
1C20 75B0F7         4405                                             mov             p3,#0f7h;vvod
1C23 20B7EE         4406                                             jb              p3.7,onmem13
                    4407                                             
                    4408             
1C26 020000   F     4409     jmp             out7                                                    
                    4410     ;;;;;;;
1C29                4411     labelI:
1C29 75B0FE         4412                                     mov             p3,#0feh
1C2C E5B0           4413                                     mov             a,p3
1C2E 20E703         4414                                     jb              acc.7,nopoint
                    4415                                     ;
1C31 020000   F     4416                                     jmp             goto7;out7
                    4417     
1C34 75B0FB         4418     nopoint:                mov             p3,#0fbh
1C37 E5B0           4419                                     mov             a,p3
1C39 20E72C         4420                                     jb              acc.7,nopoin7
1C3C 78B2           4421     labelS3:mov             r0,#marker
1C3E E53A           4422                                     mov             a,movleft
1C40 B40309         4423                                     cjne    a,#3,poina1
1C43 B6030B         4424                                     cjne    @r0,#3,nomarl;26
                    4425                                     ;mov            @r0,#9
1C46 E53B           4426     poina2: mov                     a,movrig                ;кн <- B=+00000
1C48 F6             4427                                     mov                     @r0,a
1C49 020000   F     4428                                     jmp             goto7;  out7
                    4429     
1C4C B60402         4430     poina1:         cjne    @r0,#4,nomarl;кн <- A= 0000
1C4F 80F5           4431                                             jmp             poina2
                    4432     
                    4433     
1C51                4434     nomarl:                 ;                               29.12.06
                    4435     ;;;;;;;;;;;;;;;;;;
                    4436     ;необходимо не портить цифру в следуюем справа знакоместе
                    4437     ;т е сохранить ее в ячейке для мигания в противном случае
                    4438     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4439     ;       знакоместа
1C51 78B2           4440                                     mov             r0,#marker
1C53 7440           4441                                     mov             a,#bufind
1C55 26             4442                                             add             a,@r0                   ;a=bufind+m
                             arker
1C56 F9             4443                                             mov             r1,a
1C57 09             4444                                             inc             r1
1C58 873C           4445                                             mov             savba,@r1
                    4446                                                     
1C5A 78B2           4447                                                     mov             r0,#marker
1C5C 16             4448                                                     dec             @r0                        
                                  
1C5D C219           4449                                     clr             bitmig
1C5F E53A           4450                                     mov                     a,movleft
1C61 B4036B         4451                                     cjne            a,#3,poinA
1C64 B60266         4452                                     cjne    @r0,#2,gogo7;out7;;нажата кн <- при вводе цифр B=+0
                             0000
1C67 06             4453     poin3:  inc             @r0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    71

                    4454     ;нажат ввод А =000000 запомнить константу А
1C68 75B0F7         4455     nopoin7:           mov          p3,#0f7h
1C6B E5B0           4456                                     mov             a,p3
1C6D 20E75D         4457                                     jb              acc.7,gogo7;out7
1C70 78B1           4458                                     mov             r0,#vichR
1C72 E6             4459                                     mov             a,@r0
1C73 B6215E         4460                                     cjne    @r0,#21h,no21p7
1C76 7611           4461                                     mov             @r0,#11h
                    4462                             ;       считать с индикатора  упаковать в плавающий формат
                    4463                             ;   сохранить
1C78 7F0E           4464                                     mov             r7,#14
1C7A 784F           4465                                     mov             r0,#abin
1C7C 120000   F     4466                                     call    clearN                  
1C7F 120000   F     4467                                     call    upakA
                    4468                                     
1C82 784F           4469                                     mov             r0,#abin
1C84 7953           4470                                     mov             r1,#adec                        ;мл        
                              ст
1C86 120000   F     4471                                     call    decbin                  ;abin..abin+3 (hex)
1C89 120000   F     4472                                     call    loadr2                  ;r2..r5
1C8C 120402         4473                                     call    altof                   ;r2..r5->float
1C8F 78BC           4474                                     mov                     r0,#konstA
1C91 120000   F     4475                                     call            saver2
1C94 900000   F     4476                                     mov                     dptr,#ch0
1C97 120000   F     4477                                     call            ldc_ltemp
1C9A 1201D6         4478                                     call            flcmp
1C9D 6010           4479                                     jz              erra0
                    4480     ;26
1C9F 78B2           4481                                     mov             r0,#marker
1CA1 76FF           4482                                     mov             @r0,#0ffh
                    4483                                     
1CA3 900000   F     4484                                     mov             dptr,#teVICH;teBequ0
1CA6 120000   F     4485                                     call    lotext
                    4486                             ;       call            outB
1CA9 534BBF         4487                                     anl             bufind+11,#0bfh         ;гашение точки bufi
                             nd+7
                    4488                             ;       orl             bufind+11,#80h
1CAC 020000   F     4489                                     jmp             goto7
                    4490     
1CAF 78B2           4491     erra0:          mov             r0,#marker
1CB1 76FF           4492                                             mov             @r0,#0ffh
1CB3 753934         4493                                             mov                     nuerr,#34h;константа не дол
                             жна быть равна0
1CB6 120000   F     4494                                             call            error
1CB9 120000   F     4495                                             call            ind
1CBC 120000   F     4496                                             call            z_1s
1CBF 78B1           4497                                             mov                     r0,#vichR
1CC1 7600           4498                                             mov                     @r0,#0
1CC3 C214           4499                                             clr                     bitvich
1CC5 C206           4500                                             clr                     bitvi11
1CC7 D204           4501                                             setb            bitizm
1CC9 78B2           4502                                             mov                     r0,#marker
1CCB 76FF           4503                                             mov                     @r0,#0ffh
1CCD 802E           4504     gogo7:          jmp                     out7;goto7
                    4505     
1CCF B6032B         4506     poinA:          cjne    @r0,#3,out7;;нажата кн <- при вводе цифр A= 0000
1CD2 8093           4507                                             jmp             poin3
                    4508     
1CD4                4509     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    4510                             ;   сохранить
1CD4 7F0E           4511                                     mov             r7,#14
1CD6 784F           4512                                     mov             r0,#abin
1CD8 120000   F     4513                                     call    clearN                  
1CDB 120000   F     4514                                     call    upakB                   
1CDE 784F           4515                                     mov             r0,#abin
1CE0 7953           4516                                     mov             r1,#adec                        ;мл        
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    72

                              ст
1CE2 120000   F     4517                                     call    decbin                  ;abin..abin+3 (hex)
1CE5 120000   F     4518                                     call    loadr2                  ;r2..r5
1CE8 120402         4519                                     call    altof                   ;r2..r5->int
1CEB 301B04         4520                                     jnb             bitznB,pozB
1CEE EA             4521                                     mov             a,r2
1CEF 4480           4522                                     orl             a,#80h
1CF1 FA             4523                                     mov             r2,a                    ;знак-
1CF2                4524     pozB:           ;mov            r0,#konstB
                    4525                                     ;call   saver2
                    4526     
1CF2 79B2           4527                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
1CF4 77FF           4528                                     mov             @r1,#0ffh
1CF6 78B1           4529                                     mov             r0,#vichR
1CF8 7611           4530                                     mov             @r0,#11h
1CFA 020000   F     4531                               jmp           lovich     ;3.01.07ВЫЧИСЛИТЬ
                    4532                                     
                    4533     
1CFD                4534     out7:                   ;mov            IE,#80h
1CFD D083           4535                                     pop             dph
1CFF D082           4536                                     pop             dpl
1D01 D007           4537                                     pop             rr7     
1D03 D006           4538                                     pop             rr6
1D05 D005           4539                                     pop             rr5
1D07 D004           4540                                     pop             rr4
1D09 D003           4541                                     pop             rr3
1D0B D002           4542                                     pop             rr2
1D0D D001           4543                                     pop             rr1                             
1D0F D000           4544                                     pop             rr0
1D11 D0D0           4545                                     pop             psw
1D13 D0E0           4546                                     pop             acc
1D15 75AD00         4547                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1D18 75B0C0         4548                             mov             P3,#0c0h
                    4549                             ;       mov             EIE2,#30H
1D1B C219           4550     clr             bitmig
1D1D E586           4551                                             mov             a,P6            ;p6.4=0
1D1F 54EF           4552                             anl             a,#0efh
1D21 F586           4553                             mov             P6,a
1D23 00             4554                             nop
1D24 00             4555                             nop
                    4556                                     
1D25 E586           4557                             mov             a,P6                    ;p6.4=1 
1D27 4410           4558                             orl             a,#10h
1D29 F586           4559                             mov             P6,a
                    4560                             ;;;;;;;;;
1D2B E5DA           4561                             mov             a,PCA0CPM0;             TOG0
1D2D 4446           4562                             orl             a,#46h;anl              a,#0fbh
1D2F F5DA           4563                             mov             PCA0CPM0,a
                    4564     
1D31 75CDD0         4565                             mov             TH2,#0d0h
1D34 75CC00         4566                             mov             TL2,#00
                    4567     
1D37 D2CA           4568                             setb            T2CON.2
1D39 D2AD           4569                             setb            ET2;IE.5
                    4570                                                         
1D3B 32             4571                                     reti
                    4572     
                    4573     
                    4574                                     
                    4575     
                    4576     
1D3C 78B1           4577     lomenu:         mov             r0,#vichR
1D3E B61107         4578                                             cjne    @r0,#11h,menu12
1D41 900000   F     4579                                             mov             dptr,#teTESI
1D44 120000   F     4580     lome1:                  call    lotexT
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    73

1D47 22             4581                                             ret
1D48 B61205         4582     menu12:         cjne    @r0,#12h,menu13
1D4B 900000   F     4583                                             mov             dptr,#teTESR
1D4E 80F4           4584                                             jmp             lome1
1D50 B61305         4585     menu13:         cjne    @r0,#13h,menu14
1D53 900000   F     4586                                             mov             dptr,#teSKOR
1D56 80EC           4587                                             jmp             lome1
1D58 B61405         4588     menu14:         cjne    @r0,#14h,menu15
1D5B 900000   F     4589                                             mov             dptr,#teAVK
1D5E 80E4           4590                                             jmp             lome1
1D60 B61505         4591     menu15:                 cjne    @r0,#15h,menu21
1D63 900000   F     4592                                             mov             dptr,#teKALIB
1D66 80DC           4593                                             jmp             lome1
                    4594     
1D68 B62105         4595     menu21: cjne    @r0,#21h,menu22
1D6B 900000   F     4596                                             mov             dptr,#teTE11
1D6E 80D4           4597                                             jmp             lome1
1D70 B62205         4598     menu22:         cjne    @r0,#22h,menu23
1D73 900000   F     4599                                             mov             dptr,#teTE9
1D76 80CC           4600                                             jmp             lome1
1D78 B62305         4601     menu23:         cjne    @r0,#23h,menu31
1D7B 900000   F     4602                                             mov             dptr,#teTE7
1D7E 80C4           4603                                             jmp             lome1
1D80 B63105         4604     menu31:         cjne    @r0,#31h,menu41
1D83 900000   F     4605                                             mov             dptr,#teS57_6
1D86 80BC           4606                                             jmp             lome1
                    4607     
1D88                4608     menu41:         
1D88 900000   F     4609                                             mov             dptr,#tePAR
1D8B 80B7           4610                                             jmp             lome1
                    4611     
1D8D 020000   F     4612     yesvi_kr:               jmp                     yesvi_km
1D90                4613     endkalib:;KD=Ak/A3
1D90 200DFA         4614                                             jb                      bifl_kt,yesvi_kr;выч кофф К
                             м
1D93 789C           4615                                             mov                     r0,#rez_A3
1D95 120000   F     4616                                             call            resar2
                    4617                                     
1D98 120402         4618                                     call    altof                   ;->float
1D9B EA             4619                                             mov                     a,r2
1D9C 547F           4620                                             anl                     a,#7fh
1D9E FA             4621                                             mov                     r2,a
1D9F 120000   F     4622                                     call            move28
1DA2 78A4           4623                                             mov                     r0,#rez_Ak
1DA4 120000   F     4624                                             call            resar2
1DA7 1202B7         4625                                             call            fldiv
                    4626                                                     
1DAA 900000   F     4627                                     mov     dptr,#CHtho;100000
1DAD 120000   F     4628                                     call    ldc_ltemp                       ;r8..r11=8
1DB0 120203         4629                                     call    flmul
1DB3 120343         4630                                     call    ftol            ;r2..r5->hex кофф KD (РЕЗ ИЗМ ЧИСЛО
                              6разрядное)
                    4631     
1DB6 78A0           4632                                             mov                     r0,#koefKD
1DB8 120000   F     4633                                             call            saver2
                    4634                                             ;запись в рпзу в соотв ячейку
                    4635                             
1DBB 7900           4636                                             mov             r1,#0                   ;счит рпзу 
                             во внешн озу
1DBD 7A50           4637                                     mov             r2,#50h
1DBF 7B00           4638                                     mov             r3,#00
1DC1 120499         4639                                     call    copyPP
                    4640                                     ;внести изменения во внешн озу
1DC4 120000   F     4641                                     call            findext                 ;r1-внешн озу
1DC7 78A0           4642                                     mov                     r0,#koefKD
1DC9 120000   F     4643                                             call            resar2
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    74

1DCC EA             4644                                             mov                     a,r2
1DCD F3             4645                                             movx            @r1,a
1DCE 09             4646                                             inc                     r1
1DCF EB             4647                                             mov                     a,r3
1DD0 F3             4648                                             movx            @r1,a
1DD1 09             4649                                             inc                     r1
1DD2 EC             4650                                             mov                     a,r4
1DD3 F3             4651                                             movx            @r1,a
1DD4 09             4652                                             inc                     r1
1DD5 ED             4653                                             mov                     a,r5
1DD6 F3             4654                                             movx            @r1,a
                    4655                                     ;кофф *100000 и переведенный в hex формат
                    4656                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4657     ;стереть страницу пап прогр 
1DD7 905000         4658                                     mov             dptr,#5000h
1DDA 7FFF           4659                                     mov             r7,#0ffh
1DDC 12043E         4660                                     call    cle256
                    4661     ;и запись в ячейки кофф памяти прогр (3000h) 
1DDF 7FFF           4662                                     mov             r7,#0ffh
1DE1 7900           4663                                     mov             r1,#0                           ;external r
                             am
1DE3 905000         4664                                     mov             dptr,#5000h
1DE6 120480         4665                                     call    wrpage
                    4666     ;2.2.07
1DE9 79AE           4667                                     mov                     r1,#diap
1DEB B70511         4668                                     cjne            @r1,#5,fulkalib
                    4669                                     ;jb                     bifl_kt,yesvi_km;выч кофф Км
1DEE D20D           4670                                     setb            bifl_kt
                    4671                                     ;call           loadus
1DF0 900000   F     4672                                     mov                     dptr,#tabt7;заслать ус 7А       
1DF3 E4             4673                             clr             a
1DF4 93             4674                             movc    a,@a+dptr                               ;high byte
1DF5 F584           4675                             mov             p4,a
1DF7 A3             4676                             inc             dptr
1DF8 E4             4677                             clr             a
1DF9 93             4678                             movc    a,@a+dptr                               ;low byte
1DFA F585           4679                             mov             p5,a
1DFC 020000   F     4680                                     jmp             goto7;  out_kali
                    4681     
                    4682     ;;;
1DFF                4683     fulkalib:
1DFF C212           4684                                             clr             bitklb
1E01 D216           4685                                             setb    bitpar                  ;пароль провели 1 р
                             аз успешно
1E03 900000   F     4686                                             mov             dptr,#teEND
1E06 120000   F     4687                                             call    lotext
1E09 120000   F     4688                                             call    ind
1E0C 120000   F     4689     out_kali:       call    z_1s
1E0F 120000   F     4690                                             call    z_1s
1E12 020000   F     4691                                             jmp             goto7
1E15                4692     yesvi_km:               ;выч кофф Км=(10**5/A2)*K7/K5
1E15 7A50           4693                                     mov                     r2,#50h                 ;-11a
1E17 7B14           4694                                     mov                     r3,#14h                 ;k7
1E19 12046C         4695                                     call            rebyte2                         ;r2..r5- he
                             x
1E1C 120402         4696                                     call            altof                   ;r2..r5->float
1E1F C002           4697                                     push            rr2
1E21 C003           4698                                     push            rr3
1E23 C004           4699                                     push            rr4
1E25 C005           4700                                     push            rr5
1E27 7A50           4701                                     mov                     r2,#50h                 ;k5
1E29 7B0C           4702                                     mov                     r3,#0ch
1E2B 12046C         4703                             call            rebyte2                 ;r2..r5
1E2E 120402         4704                                     call            altof                   ;r2..r5->float
1E31 120000   F     4705                                     call            move28
1E34 D005           4706                                     pop                     rr5
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    75

1E36 D004           4707                                     pop                     rr4
1E38 D003           4708                                     pop                     rr3
1E3A D002           4709                                     pop                     rr2
1E3C 1202B7         4710                                     call            fldiv                   ;K7/K5
                    4711     
1E3F 900000   F     4712                                     mov     dptr,#CHtho;100000
1E42 120000   F     4713                                     call    ldc_ltemp                       ;r8..r11=8
1E45 120203         4714                                     call    flmul                           ;r2..r5 ;K7/K5*10**
                             5
1E48 C002           4715                                     push            rr2
1E4A C003           4716                                     push            rr3
1E4C C004           4717                                     push            rr4
1E4E C005           4718                                     push            rr5
                    4719                                     
1E50 789C           4720                                     mov                     r0,#rez_A3
1E52 120000   F     4721                                     call            resar2
1E55 120402         4722                                     call            altof                           ;r2..r5->fl
                             oat
1E58 120000   F     4723                                     call            move28
1E5B D005           4724                                     pop                     rr5
1E5D D004           4725                                     pop                     rr4
1E5F D003           4726                                     pop                     rr3
1E61 D002           4727                                     pop                     rr2
1E63 1202B7         4728                               call          fldiv           ;Km     
                    4729     
1E66 900000   F     4730                                     mov     dptr,#CHtho;100000
1E69 120000   F     4731                                     call    ldc_ltemp                       ;r8..r11=8
1E6C 120203         4732                                     call    flmul                           ;r2..r5
1E6F 120343         4733                                     call    ftol                    ;r2..r5->hex кофф Km(РЕЗ ИЗ
                             М ЧИСЛО 6разрядное)
1E72 78A0           4734                                     mov                     r0,#koefKD;2ое исп ячейки koefKD
1E74 120000   F     4735                                     call            saver2
                    4736                                     ;запись в рпзу в соотв ячейку
1E77 7900           4737                                     mov             r1,#0                   ;счит рпзу во внешн
                              озу
1E79 7A50           4738                                     mov             r2,#50h
1E7B 7B00           4739                                     mov             r3,#00
1E7D 120499         4740                                     call    copyPP
                    4741                                     ;внести изменения во внешн озу
1E80 78A0           4742                                     mov                     r0,#koefKD
1E82 120000   F     4743                                     call            resar2
1E85 792C           4744                                     mov                     r1,#2ch                 ;r1-внешн о
                             зу кофф Km
                    4745                             
1E87 EA             4746                                     mov                     a,r2
1E88 F3             4747                                             movx            @r1,a
1E89 09             4748                                             inc                     r1
1E8A EB             4749                                             mov                     a,r3
1E8B F3             4750                                             movx            @r1,a
1E8C 09             4751                                             inc                     r1
1E8D EC             4752                                             mov                     a,r4
1E8E F3             4753                                             movx            @r1,a
1E8F 09             4754                                             inc                     r1
1E90 ED             4755                                             mov                     a,r5
1E91 F3             4756                                             movx            @r1,a
                    4757                                     ;кофф *100000 и переведенный в hex формат
                    4758                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4759     ;стереть страницу пап прогр 
1E92 905000         4760                                     mov             dptr,#5000h
1E95 7FFF           4761                                     mov             r7,#0ffh
1E97 12043E         4762                                     call    cle256
                    4763     ;и запись в ячейки кофф памяти прогр (3000h) 
1E9A 7FFF           4764                                     mov             r7,#0ffh
1E9C 7900           4765                                     mov             r1,#0                           ;external r
                             am
1E9E 905000         4766                                     mov             dptr,#5000h
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    76

1EA1 120480         4767                                     call    wrpage
                    4768     
1EA4 C20D           4769                                             clr             bifl_kt
1EA6 120000   F     4770                                             call    loadus
1EA9 020000   F     4771                                             jmp             fulkalib
                    4772     
                    4773     ;выч среднего по блоку
                    4774     ;вых r2..r5
1EAC                4775     vichmean:       
1EAC 120000   F     4776                                             call            resa_hl;save_bl->dptr
1EAF 78D7           4777                                             mov                     r0,#copy_hl
1EB1 E583           4778                                             mov                     a,dph
1EB3 F6             4779                                             mov                     @r0,a
1EB4 08             4780                                             inc                     r0
1EB5 E582           4781                                             mov                     a,dpl
1EB7 F6             4782                                             mov                     @r0,a
1EB8 78B8           4783                                             mov                     r0,#work
1EBA 120000   F     4784                                             call            clear4
1EBD 78D6           4785                                             mov                     r0,#chblok;volume
1EBF 7600           4786                                             mov                     @r0,#0
1EC1 120000   F     4787     meng:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1EC4 E582           4788                                             mov                     a,dpl
1EC6 FF             4789                                             mov                     r7,a
1EC7 E583           4790                                             mov                     a,dph
1EC9 FE             4791                                             mov                     r6,a
                    4792     
1ECA 78D7           4793                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1ECC E6             4794                                             mov                     a,@r0
1ECD F583           4795                                             mov                     dph,a
1ECF 08             4796                                             inc                     r0
1ED0 E6             4797                                             mov                     a,@r0
1ED1 F582           4798                                             mov                     dpl,a
                    4799                                             
1ED3 C3             4800                                             clr                     c;-4
1ED4 E582           4801                                             mov                     a,dpl
1ED6 9404           4802                                             subb            a,#4
1ED8 F582           4803                                             mov                     dpl,a
1EDA E583           4804                                             mov                     a,dph
1EDC 9400           4805                                             subb            a,#0
1EDE F583           4806                                             mov                     dph,a;dptr-4
                    4807                                             ;;;;;;;;
1EE0 79D7           4808                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1EE2 E583           4809                                                     mov             a,dph
1EE4 F7             4810                                               mov           @r1,a
1EE5 09             4811                                                     inc             r1
1EE6 E582           4812                                                     mov             a,dpl
1EE8 F7             4813                                                     mov             @r1,a
                    4814                                                     ;;;;;;;;;
1EE9 C3             4815                                                     clr             c;пришли в начало блока?
1EEA E582           4816                                                     mov                     a,dpl
1EEC 9F             4817                                                     subb            a,r7
1EED FF             4818                                                     mov                     r7,a
1EEE 7006           4819                                                     jnz                     nextmea
1EF0 E583           4820                                                     mov                     a,dph
1EF2 9E             4821                                                     subb            a,r6
1EF3 FE             4822                                                     mov                     r6,a
1EF4 601B           4823                                                     jz                      outmea;
                    4824                                                     
                    4825                                                     ;продолжаем сравнение
                    4826                                                     ;;;;;;;;;;;             
1EF6 120000   F     4827     nextmea:                call            loahl_r2        ;из яч внешн озу ->r2..r5
1EF9 120402         4828                                             call            altof;->float
1EFC 120000   F     4829                                             call            move28                  ;r8..r11
1EFF 78B8           4830                                             mov                     r0,#work
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    77

1F01 120000   F     4831                                             call            resar2
1F04 120166         4832                                             call            fladd
1F07 78B8           4833                                             mov                     r0,#work
1F09 120000   F     4834                                             call            saver2
1F0C 78D6           4835                                             mov                     r0,#chblok;volume;кол измер
                             ений блока
1F0E 06             4836                                             inc                     @r0
1F0F 80B0           4837                                             jmp                     meng
1F11                4838     outmea:         
1F11 120000   F     4839                                             call            loahl_r2        ;из яч внешн озу ->
                             r2..r5
1F14 120402         4840                                             call            altof;->float
1F17 120000   F     4841                                             call            move28                  ;r8..r11
1F1A 78B8           4842                                             mov                     r0,#work
1F1C 120000   F     4843                                             call            resar2
1F1F 120166         4844                                             call            fladd
1F22 78B8           4845                                             mov                     r0,#work
1F24 120000   F     4846                                             call            saver2
1F27 E4             4847                                             clr                     a
1F28 FA             4848                                             mov                     r2,a
1F29 FB             4849                                             mov                     r3,a
1F2A FC             4850                                             mov                     r4,a
1F2B 78D6           4851                                             mov                     r0,#chblok;volume;кол измер
                             ений блока...200d
1F2D E6             4852                                             mov                     a,@r0
1F2E 2401           4853                                             add                     a,#1
1F30 FD             4854                                             mov                     r5,a
1F31 120402         4855                                             call            altof;r2..r5 float
1F34 120000   F     4856                                             call            move28
1F37 78B8           4857                                             mov                     r0,#work
1F39 120000   F     4858                                             call            resar2
1F3C 1202B7         4859                                             call            fldiv
1F3F 900000   F     4860                                             mov                     dptr,#ch_10      
1F42 120000   F     4861                                     call            ldc_ltemp
1F45 1202B7         4862                                     call            fldiv
1F48 120343         4863                                             call            ftol                            ;->
                             hex
1F4B 120000   F     4864                                             call    maform
1F4E 784F           4865                                             mov             r0,#abin
1F50 120000   F     4866                                             call    saver2
                    4867     ;;;;;;;;
                    4868                                             
1F53 7853           4869                                             mov             r0,#adec
1F55 7952           4870                                             mov             r1,#abin+3      ;hex->10
1F57 120000   F     4871                                             call    bindec
                    4872                                     
1F5A 785C           4873                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1F5C 7949           4874                                             mov             r1,#bufind+9
1F5E 7F05           4875                                             mov             r7,#5
1F60 E6             4876     bufmea:                         mov             a,@r0
1F61 2430           4877                                             add             a,#30h
1F63 F7             4878                                             mov             @r1,a
1F64 19             4879                                             dec             r1
1F65 18             4880                                             dec             r0
1F66 DFF8           4881                                             djnz    r7,bufmea
1F68 7844           4882                                             mov             r0,#bufind+4
1F6A 762B           4883                                             mov             @r0,#2bh          
1F6C 300202         4884                                             jnb             znmat,nozmea
1F6F 762D           4885                                             mov             @r0,#2dh
1F71 434B05         4886     nozmea:         orl             bufind+11,#05h
1F74 22             4887                                             ret
                    4888     
                    4889     
1F75 E0             4890     loahl_r2:       movx            a,@dptr         ;из яч внешн озу ->r2..r5
1F76 FA             4891                                             mov                     r2,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    78

1F77 A3             4892                                             inc                     dptr
1F78 E0             4893                                             movx            a,@dptr
1F79 FB             4894                                             mov                     r3,a
1F7A A3             4895                                             inc                     dptr
1F7B E0             4896                                             movx            a,@dptr
1F7C FC             4897                                             mov                     r4,a
1F7D A3             4898                                             inc                     dptr
1F7E E0             4899                                             movx            a,@dptr
1F7F FD             4900                                             mov                     r5,a    
1F80 22             4901                                             ret
                    4902     
1F81 C3             4903     min4_hl:        clr                     c;-4
1F82 E582           4904                                             mov                     a,dpl
1F84 9404           4905                                             subb            a,#4
1F86 F582           4906                                             mov                     dpl,a
1F88 E583           4907                                             mov                     a,dph
1F8A 9400           4908                                             subb            a,#0
1F8C F583           4909                                             mov                     dph,a;dptr-4
1F8E 22             4910                                             ret
                    4911     
                    4912     ;мин значение по по блоку
1F8F                4913     vichmin:        
1F8F 120000   F     4914                                             call            resa_hl;save_bl->dptr
                    4915                                                                                     
                    4916     ;с конца блока адрес 2го измерение
1F92 120000   F     4917                                             call            min4_hl
                    4918                                             
1F95 78B8           4919                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4920                                             
1F97 E0             4921                                             movx            a,@dptr
1F98 F6             4922                                             mov                     @r0,a
1F99 08             4923                                             inc                     r0
1F9A A3             4924                                             inc                     dptr
1F9B E0             4925                                             movx            a,@dptr
1F9C F6             4926                                             mov                     @r0,a
1F9D 08             4927                                             inc                     r0
1F9E A3             4928                                             inc                     dptr
1F9F E0             4929                                             movx            a,@dptr
1FA0 F6             4930                                             mov                     @r0,a
1FA1 08             4931                                             inc                     r0
1FA2 A3             4932                                             inc                     dptr
1FA3 E0             4933                                             movx            a,@dptr
1FA4 F6             4934                                             mov                     @r0,a
1FA5 A3             4935                                             inc                     dptr
                    4936                                             
1FA6 78B8           4937                                             mov                     r0,#work
1FA8 120000   F     4938                                             call            resar2
1FAB 120402         4939                                             call            altof;->float;r2..r5
1FAE 78B8           4940                                             mov                     r0,#work
1FB0 120000   F     4941                                             call            saver2
                    4942     
1FB3 120000   F     4943                                             call            min4_hl
                    4944                                             ;call           min4_hl
                    4945     
1FB6 78D7           4946                                             mov                     r0,#copy_hl
1FB8 E583           4947                                             mov                     a,dph
1FBA F6             4948                                             mov                     @r0,a
1FBB 08             4949                                             inc                     r0
1FBC E582           4950                                             mov                     a,dpl
1FBE F6             4951                                             mov                     @r0,a
                    4952                                     
1FBF 78D6           4953                                             mov                     r0,#chblok;volume
1FC1 7600           4954                                             mov                     @r0,#0
1FC3 120000   F     4955     ming:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1FC6 E582           4956                                             mov                     a,dpl
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    79

1FC8 FF             4957                                             mov                     r7,a
1FC9 E583           4958                                             mov                     a,dph
1FCB FE             4959                                             mov                     r6,a
                    4960     
1FCC 78D7           4961                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1FCE E6             4962                                             mov                     a,@r0
1FCF F583           4963                                             mov                     dph,a
1FD1 08             4964                                             inc                     r0
1FD2 E6             4965                                             mov                     a,@r0
1FD3 F582           4966                                             mov                     dpl,a
                    4967                                             
1FD5 C3             4968                                             clr                     c;-4
1FD6 E582           4969                                             mov                     a,dpl
1FD8 9404           4970                                             subb            a,#4
1FDA F582           4971                                             mov                     dpl,a
1FDC E583           4972                                             mov                     a,dph
1FDE 9400           4973                                             subb            a,#0
1FE0 F583           4974                                             mov                     dph,a;dptr-4
                    4975                                             ;;;;;;;;
1FE2 79D7           4976                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1FE4 E583           4977                                                     mov             a,dph
1FE6 F7             4978                                               mov           @r1,a
1FE7 09             4979                                                     inc             r1
1FE8 E582           4980                                                     mov             a,dpl
1FEA F7             4981                                                     mov             @r1,a
                    4982                                                     ;;;;;;;;;
1FEB C3             4983                                                     clr             c;пришли в начало блока?
1FEC E582           4984                                                     mov                     a,dpl
1FEE 9F             4985                                                     subb            a,r7
1FEF FF             4986                                                     mov                     r7,a
1FF0 7006           4987                                                     jnz                     nextmin
1FF2 E583           4988                                                     mov                     a,dph
1FF4 9E             4989                                                     subb            a,r6
1FF5 FE             4990                                                     mov                     r6,a
1FF6 601D           4991                                                     jz                      outmin;
                    4992                                                     
                    4993                                                     ;продолжаем сравнение
                    4994                                                     ;;;;;;;;;;;             
1FF8 78B8           4995     nextmin:        mov                     r0,#work
1FFA 120000   F     4996                                             call            resar2
                    4997                                             ;call           altof;->float;r2..r5
1FFD 120000   F     4998                                             call            move28;->r8..r11
2000 120000   F     4999                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5000     
2003 120402         5001                                             call            altof;->float;r2..r5
                    5002                                             
2006 1201D6         5003                                             call            flcmp
2009 5005           5004                                             jnc                     nomini
200B 78B8           5005                                             mov                     r0,#work;<
200D 120000   F     5006                                             call            saver2;r2..r5
2010 78D6           5007     nomini:                 mov                     r0,#chblok;volume;кол измерений блока
2012 06             5008                                             inc                     @r0
2013 80AE           5009                                             jmp                     ming
                    5010     
2015 78B8           5011     outmin:         mov                     r0,#work;1ое измерение блока
2017 120000   F     5012                                             call            resar2
                    5013                                     ;       call            altof;->float;r2..r5
201A 120000   F     5014                                             call            move28;->r8..r11
201D 120000   F     5015                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5016     
2020 120402         5017                                             call            altof;->float;r2..r5
                    5018                                             
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    80

2023 1201D6         5019                                             call            flcmp
2026 5005           5020                                             jnc                     minivix
2028 78B8           5021                                             mov                     r0,#work;<
202A 120000   F     5022                                             call            saver2;r2..r5
                    5023                                             ;;;;;;;;;
                    5024     
202D 78B8           5025     minivix:        mov                     r0,#work
202F 120000   F     5026                                             call            resar2
                    5027     
                    5028                                             ;call           altof;->float
                    5029                                     
2032 900000   F     5030                                             mov                     dptr,#ch_10      
2035 120000   F     5031                                             call            ldc_ltemp
2038 1202B7         5032                                             call            fldiv
203B 120343         5033                                             call            ftol                            ;->
                             hex
                    5034                                             ;;;
203E 120000   F     5035                                             call            maform
2041 784F           5036                                             mov                     r0,#abin
2043 120000   F     5037                                             call            saver2
                    5038     ;;;;;;;;
                    5039                                             
2046 7853           5040                                             mov             r0,#adec
2048 7952           5041                                             mov             r1,#abin+3      ;hex->10
204A 120000   F     5042                                             call    bindec
                    5043                                     
204D 785C           5044                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
204F 7949           5045                                             mov             r1,#bufind+9
2051 7F05           5046                                             mov             r7,#5
2053 E6             5047     bufmin:                         mov             a,@r0
2054 2430           5048                                             add             a,#30h
2056 F7             5049                                             mov             @r1,a
2057 19             5050                                             dec             r1
2058 18             5051                                             dec             r0
2059 DFF8           5052                                             djnz    r7,bufmin
205B 7844           5053                                             mov             r0,#bufind+4
205D 762B           5054                                             mov             @r0,#2bh          
205F 300202         5055                                             jnb             znmat,nozmin
2062 762D           5056                                             mov             @r0,#2dh
2064 434B05         5057     nozmin:         orl             bufind+11,#05h
2067 22             5058                                             ret
                    5059     
                    5060     
                    5061     
                    5062     ;мин значение по по блоку
2068                5063     vichmax:        
2068 120000   F     5064                                             call            resa_hl;save_bl->dptr
                    5065                                             
                    5066                                             
                    5067     ;с конца блока адрес 2го измерение
206B 120000   F     5068                                             call            min4_hl
                    5069                                             
206E 78B8           5070                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    5071                                             
2070 E0             5072                                             movx            a,@dptr
2071 F6             5073                                             mov                     @r0,a
2072 08             5074                                             inc                     r0
2073 A3             5075                                             inc                     dptr
2074 E0             5076                                             movx            a,@dptr
2075 F6             5077                                             mov                     @r0,a
2076 08             5078                                             inc                     r0
2077 A3             5079                                             inc                     dptr
2078 E0             5080                                             movx            a,@dptr
2079 F6             5081                                             mov                     @r0,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    81

207A 08             5082                                             inc                     r0
207B A3             5083                                             inc                     dptr
207C E0             5084                                             movx            a,@dptr
207D F6             5085                                             mov                     @r0,a
207E A3             5086                                             inc                     dptr
                    5087                                             
207F 78B8           5088                                             mov                     r0,#work
2081 120000   F     5089                                             call            resar2
2084 120402         5090                                             call            altof;->float;r2..r5
2087 78B8           5091                                             mov                     r0,#work
2089 120000   F     5092                                             call            saver2
                    5093     
208C 120000   F     5094                                             call            min4_hl
                    5095                                     ;       call            min4_hl
                    5096     
208F 78D7           5097                                             mov                     r0,#copy_hl
2091 E583           5098                                             mov                     a,dph
2093 F6             5099                                             mov                     @r0,a
2094 08             5100                                             inc                     r0
2095 E582           5101                                             mov                     a,dpl
2097 F6             5102                                             mov                     @r0,a
                    5103                                     
2098 78D6           5104                                             mov                     r0,#chblok;volume
209A 7600           5105                                             mov                     @r0,#0
209C 120000   F     5106     maxg:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
209F E582           5107                                             mov                     a,dpl
20A1 FF             5108                                             mov                     r7,a
20A2 E583           5109                                             mov                     a,dph
20A4 FE             5110                                             mov                     r6,a
                    5111     
20A5 78D7           5112                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
20A7 E6             5113                                             mov                     a,@r0
20A8 F583           5114                                             mov                     dph,a
20AA 08             5115                                             inc                     r0
20AB E6             5116                                             mov                     a,@r0
20AC F582           5117                                             mov                     dpl,a
                    5118                                             
20AE C3             5119                                             clr                     c;-4
20AF E582           5120                                             mov                     a,dpl
20B1 9404           5121                                             subb            a,#4
20B3 F582           5122                                             mov                     dpl,a
20B5 E583           5123                                             mov                     a,dph
20B7 9400           5124                                             subb            a,#0
20B9 F583           5125                                             mov                     dph,a;dptr-4
                    5126                                             ;;;;;;;;
20BB 79D7           5127                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
20BD E583           5128                                                     mov             a,dph
20BF F7             5129                                               mov           @r1,a
20C0 09             5130                                                     inc             r1
20C1 E582           5131                                                     mov             a,dpl
20C3 F7             5132                                                     mov             @r1,a
                    5133                                                     ;;;;;;;;;
20C4 C3             5134                                                     clr             c;пришли в начало блока?
20C5 E582           5135                                                     mov                     a,dpl
20C7 9F             5136                                                     subb            a,r7
20C8 FF             5137                                                     mov                     r7,a
20C9 7006           5138                                                     jnz                     nextmax
20CB E583           5139                                                     mov                     a,dph
20CD 9E             5140                                                     subb            a,r6
20CE FE             5141                                                     mov                     r6,a
20CF 601D           5142                                                     jz                      outmax;
                    5143                                                     
                    5144                                                     ;продолжаем сравнение
                    5145                                                     ;;;;;;;;;;;             
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    82

20D1 78B8           5146     nextmax:        mov                     r0,#work
20D3 120000   F     5147                                             call            resar2
                    5148                                             ;call           altof;->float;r2..r5
20D6 120000   F     5149                                             call            move28;->r8..r11
20D9 120000   F     5150                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5151     
20DC 120402         5152                                             call            altof;->float;r2..r5
                    5153                                             
20DF 1201D6         5154                                             call            flcmp
20E2 4005           5155                                             jc                      nomaxi
20E4 78B8           5156                                             mov                     r0,#work;>
20E6 120000   F     5157                                             call            saver2;r2..r5
20E9 78D6           5158     nomaxi:                 mov                     r0,#chblok;volume;кол измерений блока
20EB 06             5159                                             inc                     @r0
20EC 80AE           5160                                             jmp                     maxg
20EE 78B8           5161     outmax:         mov                     r0,#work;1ое измерение блока
20F0 120000   F     5162                                             call            resar2
                    5163                                     ;       call            altof;->float;r2..r5
20F3 120000   F     5164                                             call            move28;->r8..r11
20F6 120000   F     5165                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5166     
20F9 120402         5167                                             call            altof;->float;r2..r5
                    5168                                             
20FC 1201D6         5169                                             call            flcmp
20FF 4005           5170                                             jc                      maxvix
2101 78B8           5171                                             mov                     r0,#work;>
2103 120000   F     5172                                             call            saver2;r2..r5
                    5173                                             ;;;;;;;;;
                    5174     
2106 020000   F     5175     maxvix:         jmp             minivix
                    5176     
                    5177     
2109 78CF           5178     bufl_dec:       mov                     r0,#chbuf       
210B 120000   F     5179                                             call            resar2  
210E 900000   F     5180                                             mov                     dptr,#ch_1       
2111 120000   F     5181                                             call            ldc_ltemp
2114 1201D1         5182                                             call            flsub
2117 78CF           5183                                             mov                     r0,#chbuf       
2119 120000   F     5184                                             call            saver2  
211C 22             5185                                             ret
                    5186     ;прерывание таймера Т2
211D                5187     inter2:         
211D E5DA           5188                                             mov             a,PCA0CPM0
211F 54BF           5189                                             anl             a,#0bfh                         
2121 F5DA           5190                                             mov             PCA0CPM0,a
                    5191                                             ;mov            a,T2CON         ;T2CON.2=0
                    5192                                             ;anl            a,#0fbh
2123 75C800         5193                                             mov             T2CON,#00;a
2126 C2AD           5194                                             clr             IE.5
2128 32             5195                                             reti
                    5196     ;$include (d:\amp\subr6.asm) 
                +1  5197     
                +1  5198     ;тест интерфейса
2129            +1  5199     testrs: ;jb     p0.3,goprogr
2129 C2AC       +1  5200                                     clr     IE.4
212B 759955     +1  5201     test1:  mov     SBUF0,#55h
212E 3099FD     +1  5202                                     jnb     SCON0.1,$
2131 78B8       +1  5203                                     mov     r0,#work;chtest
2133 76BE       +1  5204                                     mov     @r0,#190d;60
                +1  5205     
2135 309825     +1  5206     test01: jnb     SCON0.0,test2
2138 E599       +1  5207                                     mov     a,SBUF0
213A B45512     +1  5208                                     cjne    a,#55h,test3
213D C299       +1  5209     test4:  clr     SCON0.1
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    83

213F C298       +1  5210                                     clr     SCON0.0
2141 7D0A       +1  5211                                     mov     r5,#10
2143 7840       +1  5212                                     mov     r0,#bufind              ;- - - -
2145 762D       +1  5213     test04: mov     @r0,#2dh
2147 08         +1  5214                                     inc     r0
2148 DDFB       +1  5215                                     djnz    r5,test04
214A 120000   F +1  5216                                     call    ind
214D 80DC       +1  5217                                     jmp     test1
214F            +1  5218     test3:  
214F 753933     +1  5219                                     mov     nuerr,#33h
2152 120000   F +1  5220                                     call    error           ;на кран прибора ERR 3
                +1  5221                             
2155 120000   F +1  5222                                     call    ind;
2158 120000   F +1  5223                                     call    z_01s           ;100ms
215B 80E0       +1  5224                                     jmp     test4
215D 78B8       +1  5225     test2:  mov     r0,#work;chtest
215F B60002     +1  5226                                     cjne    @r0,#0,test02
2162 8003       +1  5227                                     jmp     test5
2164 16         +1  5228     test02: dec     @r0
2165 80CE       +1  5229                                     jmp     test01
2167 120000   F +1  5230     test5:  call    z_1ms           ;1ms
216A C299       +1  5231                                     clr     SCON0.1
                +1  5232             
216C 753933     +1  5233                                     mov     nuerr,#33h
216F 120000   F +1  5234                                     call    error           ;на кран прибора ERR 3
                +1  5235                                     
2172 120000   F +1  5236                                     call    ind
2175 120000   F +1  5237                                     call    z_01s           ;100ms
2178 80B1       +1  5238                                     jmp     test1   
                +1  5239     
                +1  5240     
                +1  5241     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
217A 75E700     +1  5242      ind:   mov             EIE2,#00H;mov   IE,#00h
217D 120000   F +1  5243                     call    mign
2180 7840       +1  5244                      mov            r0,#bufind;+11
2182 7F0C       +1  5245                      mov            r7,#12
2184 C287       +1  5246      nexin: clr             p0.7;6
2186 E6         +1  5247                     mov             a,@r0
2187 F59B       +1  5248                     mov             SPI0DAT,a
2189 20FBFD     +1  5249                     jb              TXBSY,$
218C D287       +1  5250                     setb    p0.7;6
218E 120000   F +1  5251                     call    z_9             ;25mks
2191 08         +1  5252                     inc             r0;dec          r0
2192 DFF0       +1  5253                     djnz    r7,nexin
2194 75E730     +1  5254                     mov             EIE2,#30H;mov   IE,#80h
2197 22         +1  5255                ret
                +1  5256     
                +1  5257     
2198 7A08       +1  5258     zapadc:   mov R2,#8
219A D297       +1  5259     sdv:      setb P1.7
219C 33         +1  5260               rlc A
219D 9296       +1  5261                     mov P1.6,C
219F 120000   F +1  5262                     call tim2
                +1  5263                                     
21A2 C297       +1  5264                     clr P1.7
21A4 120000   F +1  5265                     call tim2
21A7 DAF1       +1  5266                     djnz R2,sdv
21A9 D296       +1  5267                     setb P1.6
21AB 22         +1  5268                     ret
                +1  5269     
21AC 7A08       +1  5270     chtadc:   mov R2,#8
21AE D297       +1  5271     sdv1:     setb P1.7
21B0 120000   F +1  5272               call tim2
21B3 C297       +1  5273                     clr P1.7
21B5 A296       +1  5274                     mov C,P1.6
21B7 33         +1  5275                     rlc A
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    84

21B8 120000   F +1  5276                     call tim2
21BB DAF1       +1  5277                     djnz R2,sdv1
21BD 22         +1  5278                     ret
                +1  5279     
21BE 7E30       +1  5280     tim:      mov R6,#30h;38h
21C0 DEFE       +1  5281     tim1:     djnz R6,tim1
21C2 22         +1  5282               ret
                +1  5283               
21C3 7E10       +1  5284     tim2:     mov R6,#10h;14h
21C5 DEFE       +1  5285     tim3:     djnz R6,tim3
21C7 22         +1  5286               ret
                +1  5287     
                +1  5288     ;запись из acc
21C8 C3         +1  5289     write_x1: clr   c
21C9            +1  5290     writeD_x1:
21C9 92B1       +1  5291                       mov P3.1,c        ;запись
21CB F5A0       +1  5292               mov P2,A
21CD D2B3       +1  5293                       setb P3.3
21CF 120000   F +1  5294                       call z_5
21D2 C2B3       +1  5295                       clr P3.3
21D4 75A0FF     +1  5296                       mov P2,#0FFh
21D7 22         +1  5297                       ret
                +1  5298     
                +1  5299     ;чтение в acc
21D8 C3         +1  5300     read_x2:  clr   c  
21D9 92B1       +1  5301               mov P3.1,c        ;чтение
21DB D2B2       +1  5302               setb P3.2
21DD D2B3       +1  5303                       setb P3.3
21DF 120000   F +1  5304                     call z_5
21E2 E5A0       +1  5305                       mov A,P2
21E4 C2B3       +1  5306                       clr P3.3
21E6 C2B2       +1  5307                       clr P3.2
21E8 22         +1  5308                       ret
                +1  5309     
                +1  5310     
21E9 120000   F +1  5311     loop:     call read_x2;x2    ;ожидание флага готовности
21EC 20E7FA     +1  5312                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
21EF 22         +1  5313                        ret           ;возврат, если бит А(7)<>1
                +1  5314                                      
                +1  5315                                        
                +1  5316     
                +1  5317     
                +1  5318     
                +1  5319     
                +1  5320     
                +1  5321     
                +1  5322     
                +1  5323     ;принимаемый байт в acc
                +1  5324     ;прием байта последовательным кодом старшими разрядами вперед
21F0 7A08       +1  5325     read:    mov R2,#8
21F2 C297       +1  5326     re1:     clr P1.7;P1.2
21F4 120000   F +1  5327              call tim2        ;5mks
21F7 A294       +1  5328                     mov C,P1.4;P1.0
21F9 33         +1  5329                     rlc A           
21FA D297       +1  5330                     setb P1.7;P1.2
21FC 120000   F +1  5331                     call tim2
21FF DAF1       +1  5332                     djnz R2,re1
2201 22         +1  5333                     ret
                +1  5334     
                +1  5335      ;in r0-count   
                +1  5336     ;r10,r11-значение с котоым сравнивается счетчик
                +1  5337     ;r2..r5 -значение счетчика
2202            +1  5338     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
2202 E6         +1  5339                     mov                     a,@r0
2203 FC         +1  5340                     mov                     r4,a
2204 08         +1  5341                     inc                     r0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    85

2205 E6         +1  5342                     mov                     a,@r0
2206 FD         +1  5343                     mov                     r5,a
2207 7B00       +1  5344                     mov                     r3,#0
2209 7A00       +1  5345                     mov                     r2,#0
220B 750800     +1  5346                     mov                     r8,#0;clr                       r8
220E 750900     +1  5347                     mov                     r9,#0;clr                       r9
2211 120000   F +1  5348                     call            lcmp
2214 22         +1  5349                     ret
                +1  5350     
                +1  5351     
                +1  5352     ;in-r1-count
2215            +1  5353     chdec:          ;mov            r1,#chavt               ;chavt-1
2215 E7         +1  5354                             mov             a,@r1
2216 FC         +1  5355                             mov             r4,a
2217 09         +1  5356                             inc             r1
2218 E7         +1  5357                             mov             a,@r1
2219 FD         +1  5358                             mov             r5,a
221A C202       +1  5359                             clr             rr2
221C C203       +1  5360                             clr             rr3
221E 900000   F +1  5361                             mov             dptr,#ch1        
2221 120000   F +1  5362                             call    ldc_ltemp
2224 120000   F +1  5363                             call    lsub
2227 ED         +1  5364                             mov             a,r5
2228 F7         +1  5365                             mov             @r1,a
2229 19         +1  5366                             dec             r1
222A EC         +1  5367                             mov             a,r4
222B F7         +1  5368                             mov             @r1,a
                +1  5369                             
222C 22         +1  5370                             ret      
                +1  5371     
                +1  5372     
                +1  5373     
                +1  5374     
222D            +1  5375     loadUS: ;если идет тест измерения ус восстановить для теста
222D 201533     +1  5376                                     jb              biteizm,yestest
2230 79AE       +1  5377                                             mov             r1,#diap
2232 E7         +1  5378                             mov             a,@r1
2233 23         +1  5379                             rl              a;*2
2234 FC         +1  5380                             mov             r4,a                    ;save a
2235 900000   F +1  5381                             mov             dptr,#tabus
2238 93         +1  5382                             movc    a,@a+dptr
2239 FA         +1  5383                             mov             r2,a                    ;high byte
223A E584       +1  5384                             mov             a,p4
223C 5401       +1  5385                             anl             a,#01
223E 4A         +1  5386                             orl             a,r2
223F F584       +1  5387                             mov             p4,a
2241 0C         +1  5388                             inc             r4
2242 EC         +1  5389                             mov             a,r4
2243 93         +1  5390                             movc    a,@a+dptr
2244 FB         +1  5391                             mov             r3,a                    ;low byte
2245 E585       +1  5392                             mov             a,p5
2247 5401       +1  5393                             anl             a,#01
2249 4B         +1  5394                             orl             a,r3
224A F585       +1  5395                             mov             p5,a
224C 799A       +1  5396                             mov             r1,#parT
224E B7010E     +1  5397                             cjne    @r1,#1,bret
2251 79AE       +1  5398                             mov             r1,#diap                  ;10s (parT=1)
2253 7405       +1  5399                             mov             a,#5                      ;10-8..10-11 p4.1=1
2255 C3         +1  5400                             clr             c
2256 97         +1  5401                             subb    a,@r1
2257 5006       +1  5402                             jnc             bret
2259 E584       +1  5403                             mov             a,p4
225B 4402       +1  5404                             orl             a,#02
225D F584       +1  5405                             mov             p4,a                     ;10-8..10-11 p4.1=1
225F 120000   F +1  5406     bret:      call          louizm         ;us если вкл кн ИЗМЕР
2262 22         +1  5407                             ret
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    86

2263            +1  5408     yestest:
2263 120000   F +1  5409                             call            lotpus          ;ус теста измерения
2266 22         +1  5410                             ret
                +1  5411                             
                +1  5412     ;загр ус для кор 0
                +1  5413     ;dptr-
2267 E4         +1  5414     lospus:         clr             a
                +1  5415                             ;movc   a,@a+dptr
                +1  5416                             ;mov            r2,a                    ;high byte
                +1  5417                             ;mov            a,p4
                +1  5418                             ;anl            a,#01
                +1  5419                             ;orl            a,r2
                +1  5420                             ;mov            p4,a
                +1  5421                             ;inc            dptr
2268 E4         +1  5422                             clr             a
2269 93         +1  5423                             movc    a,@a+dptr
226A FB         +1  5424                             mov             r3,a                    ;low byte
226B E585       +1  5425                             mov             a,p5
226D 54BF       +1  5426                             anl             a,#0bfh;01
226F 4B         +1  5427                             orl             a,r3
2270 F585       +1  5428                             mov             p5,a
2272 22         +1  5429                             ret
                +1  5430     
2273 80         +1  5431     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                +1  5432     
                +1  5433     ;us кнопка измерения выкл
2274 88D6       +1  5434     tabus:     db           88h,0d6h         ;10-2
2276 88F6       +1  5435                             db      88h,0f6h         ;10-3
2278 88D6       +1  5436                             db              88h,0d6h         ;10-4
227A 88F6       +1  5437                             db              88h,0f6h         ;10-5
227C 9AD6       +1  5438                             db      9ah,0d6h         ;10-6
227E 9AF6       +1  5439                             db              9ah,0f6h         ;10-7
2280 ACD6       +1  5440                             db              0ach,0d6h        ;10-8
2282 ACF6       +1  5441                             db      0ach,0f6h        ;10-9
2284 C8D6       +1  5442                             db              0c8h,0d6h        ;10-10
2286 C8F6       +1  5443                             db              0c8h,0f6h        ;10-11
                +1  5444     
2288            +1  5445     tabt11: 
2288 66E6       +1  5446                             db              66h,0e6h;10-11
228A            +1  5447     tabt9:  
228A 32E6       +1  5448                             db              32h,0e6h;10-9
228C            +1  5449     tabt7:  
228C 18EE       +1  5450                             db              18h,0eeh;10-7
                +1  5451     
                +1  5452      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  5453     ;в зав от parT (Tизм)
228E 79B7       +1  5454     loadT:          mov             r1,#load;parT
2290 7840       +1  5455     lolevT:         mov             r0,#bufind+0
2292 7B0A       +1  5456                             mov             r3,#10
2294 75F00A     +1  5457                             mov             b,#10
2297 E7         +1  5458                             mov             a,@r1
2298 A4         +1  5459                             mul             ab
2299 FC         +1  5460                             mov             r4,a                    ;save a
229A 900000   F +1  5461                             mov             dptr,#textT
229D 93         +1  5462             lod1:   movc    a,@a+dptr
229E F6         +1  5463                             mov             @r0,a
229F 08         +1  5464                             inc             r0
22A0 0C         +1  5465                             inc             r4
22A1 EC         +1  5466                             mov             a,r4
22A2 DBF9       +1  5467                             djnz    r3,lod1
22A4 534B03     +1  5468                             anl                     bufind+11,#03h          ;гашение точек
22A7 22         +1  5469                             ret     
                +1  5470     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  5471     ;dptr-адр строки текста         
22A8            +1  5472     lotext:         
22A8 7B0A       +1  5473                             mov             r3,#10
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    87

22AA 7840       +1  5474                             mov             r0,#bufind+0
22AC E4         +1  5475     lodt:           clr             a
22AD 93         +1  5476                             movc    a,@a+dptr
22AE F6         +1  5477                             mov             @r0,a
22AF 08         +1  5478                             inc             r0
22B0 A3         +1  5479                             inc             dptr
22B1 DBF9       +1  5480                             djnz    r3,lodt
22B3 534B03     +1  5481                             anl                     bufind+11,#03h          ;гашение точек
22B6 22         +1  5482                             ret                                     
                +1  5483     
                +1  5484     
                +1  5485     
                +1  5486     
                +1  5487      ;задержка 100 мкс
22B7 7978       +1  5488     z_100:    mov R1,#78h     ;загрузка первого числа
22B9 7A02       +1  5489     z100:     mov R2,#2h     ;загрузка второго числа
22BB DAFE       +1  5490     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
22BD D9FA       +1  5491               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
22BF 22         +1  5492               ret           
                +1  5493     
                +1  5494     ;задержка 34 мкс
22C0 7B8B       +1  5495     z_5:      mov R3,#8Bh      ;загрузка числа
22C2 DBFE       +1  5496     ct:       djnz R3,ct
22C4 22         +1  5497               ret
                +1  5498     
                +1  5499     ;задержка 15 мс
22C5 79FA       +1  5500     z_15:     mov R1,#0FAh    ;загрузка первого числа
22C7 7AED       +1  5501     z15:      mov R2,#0EDh   ;загрузка второго числа
22C9 DAFE       +1  5502     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
22CB D9FA       +1  5503               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
22CD 22         +1  5504               ret   
                +1  5505                                               
                +1  5506      ;задержка 1 мс
22CE 7910       +1  5507     z_1ms:     mov R1,#10h     
22D0 7AED       +1  5508     ss1:       mov R2,#0EDh    
22D2 DAFE       +1  5509                djnz R2, $    
22D4 D9FA       +1  5510                djnz R1, ss1   
22D6 22         +1  5511                ret   
                +1  5512     
                +1  5513      ;????????
                +1  5514     ;задержка 1с
22D7 7D1F       +1  5515     z_1s:   mov             r5,#01fh 
22D9 7EFF       +1  5516     co2s:   mov     R6,#0ffh     
22DB 7FFF       +1  5517     z1s:     mov    R7,#0ffh     
22DD DFFE       +1  5518     co1s:   djnz    R7, co1s        
22DF DEFA       +1  5519             djnz    R6, z1s 
22E1 DDF6       +1  5520                     djnz    r5,co2s
22E3 22         +1  5521               ret
                +1  5522     ;задержка 0,1с
22E4 7D03       +1  5523     z_01s:           mov            r5,#03h 
22E6 7EFF       +1  5524     co02s:          mov     R6,#0ffh     
22E8 7FFF       +1  5525     z01s:           mov     R7,#0ffh     
22EA DFFE       +1  5526                             djnz    R7, $   
22EC DEFA       +1  5527                     djnz    R6, z01s 
22EE DDF6       +1  5528                             djnz    r5,co02s
22F0 22         +1  5529                      ret
                +1  5530                                               
                +1  5531     ;задержка 0,5с
22F1 7D0D       +1  5532     z_05s:           mov            r5,#0dh 
22F3 7EFF       +1  5533     co05s:                  mov     R6,#0ffh     
22F5 7FFF       +1  5534     z05s:           mov     R7,#0ffh     
22F7 DFFE       +1  5535                                     djnz    R7, $   
22F9 DEFA       +1  5536                     djnz    R6, z05s 
22FB DDF6       +1  5537                                             djnz    r5,co05s
22FD 22         +1  5538                      ret                                                     
                +1  5539                                                               
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    88

22FE 000007FF   +1  5540     chzap:  db      00,00,07h,0ffh             
2302 00000000   +1  5541     ch0:    db      00,00,00,00
2306 0000000A   +1  5542     ch10:   db      00,00,00,0ah                            ;10
230A 00000005   +1  5543     ch5:    db      00,00,00,05                                             ;5
230E 00000004   +1  5544     ch4:    db      00,00,00,04                                             ;4
2312 000003B9   +1  5545     ch954:  db 00,00,03,0b9h                                                ;954
2316 000003E8   +1  5546     ch10000:        db 00,00,03h,0e8h                                               ;10000
231A 00000064   +1  5547     ch100:  db 00,00,00,64h ;100
231E 00000002   +1  5548     ch2:    db      00,00,00,02                                             
                +1  5549     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  5550     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  5551     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
2322 00000001   +1  5552     ch1:    db  00,00,00,01
2326 49742400   +1  5553     ch_mln: db      49h,74h,24h,00;10*6
232A 3F800000   +1  5554     ch_1:   db      3fh,80h,00,00   
232E 40000000   +1  5555     ch_2:   db      40h,00,00,00;2
2332 40800000   +1  5556     ch_4:   db      40h,80h,00,00;4 
2336 40A00000   +1  5557     ch_5:   db      40h,0a0h,00,00;5
233A 40E00000   +1  5558     ch_7:   db      40h,0e0h,00,00;7
                +1  5559             
233E 3F741EDF   +1  5560     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
2342 47C35000   +1  5561     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
2346 3F800347   +1  5562     KD:             db      3fh,80h,03h,47h;1,0001
234A 48435000   +1  5563     CH2tho: db      48h,43h,50h,00;200000
234E 4856D800   +1  5564     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
2352 4856D800   +1  5565     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
2356 461C4000   +1  5566     ch_10th:db  46h,1ch,40h,00;10000-2710h
235A 41200000   +1  5567     ch_10:  db      41h,20h,00,00;10d
235E 48742400   +1  5568     ch_250: db      48h,74h,24h,00;250000
2362 000186A0   +1  5569     chk:            db      00,01,86h,0a0h;
2366 00000320   +1  5570     ch320h: db      00,00,03h,20h;320h=800d
236A 00000150   +1  5571     ch150h: db      00,00,01h,50h;150h
236E C0400000   +1  5572     ch_m3:  db      0c0h,40h,00,00;-3
                +1  5573     
                +1  5574     
                +1  5575     ;r1- мл байт 2х байтного числа
2372            +1  5576     tenmin:         ;-10
2372 C3         +1  5577                             clr             c
2373 E7         +1  5578                     mov             a,@r1
2374 9405       +1  5579                             subb    a,#5;10
2376 F7         +1  5580                             mov             @r1,a
2377 19         +1  5581                             dec             r1
2378 E7         +1  5582                             mov             a,@r1
2379 9400       +1  5583                             subb    a,#0
237B F7         +1  5584                             mov             @r1,a
237C 22         +1  5585                             ret
                +1  5586       ;r0-обнуление ячеек памяти  
237D 7F04       +1  5587       clear4:        mov    r7,#4
237F E4         +1  5588                             clr             a
2380 F6         +1  5589       cl4:          mov             @r0,a
2381 08         +1  5590                             inc             r0
2382 DFFC       +1  5591                             djnz    r7,cl4
2384 22         +1  5592                             ret     
                +1  5593     
                +1  5594      ;r0-обнуление ячеек памяти 
                +1  5595      ;R7- 
2385            +1  5596       clearN:        
2385 E4         +1  5597                             clr             a
2386 F6         +1  5598       cl4N:         mov             @r0,a
2387 08         +1  5599                             inc             r0
2388 DFFC       +1  5600                             djnz    r7,cl4N
238A 22         +1  5601                             ret     
                +1  5602     
                +1  5603       ;чтение номера байта с индикатора(2байта)
                +1  5604     ;bufind+8..bufind+9
                +1  5605     ;-  - - -
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    89

                +1  5606     ;- - - - - - - - - -
                +1  5607     ;adec..adec+9
                +1  5608     ;ст            мл
238B 7848       +1  5609     upak2:  mov             r0,#bufind+8;
238D 795C       +1  5610                     mov             r1,#adec+9
238F 7F02       +1  5611                     mov             r7,#2;2bait
2391 C3         +1  5612     upa2:   clr             c
2392 E6         +1  5613                     mov             a,@r0
2393 9430       +1  5614                     subb    a,#30h
2395 F7         +1  5615                     mov             @r1,a
2396 18         +1  5616                     dec             r0
2397 19         +1  5617                     dec             r1
2398 DFF7       +1  5618                     djnz    r7,upa2
239A 22         +1  5619                     ret  
                +1  5620     
                +1  5621     
                +1  5622         
                +1  5623      ;bufind+4..bufind+9
                +1  5624     ;-  - - -
                +1  5625     ;- - - - - - - - - -
                +1  5626     ;adec..adec+9
                +1  5627     ;ст            мл
239B 7849       +1  5628     upak:   mov             r0,#bufind+9;
239D 795C       +1  5629                     mov             r1,#adec+9
239F 7F06       +1  5630                     mov             r7,#6
23A1 C3         +1  5631     upa:    clr             c
23A2 E6         +1  5632                     mov             a,@r0
23A3 9430       +1  5633                     subb    a,#30h
23A5 F7         +1  5634                     mov             @r1,a
23A6 18         +1  5635                     dec             r0
23A7 19         +1  5636                     dec             r1
23A8 DFF7       +1  5637                     djnz    r7,upa
23AA 22         +1  5638                     ret
                +1  5639     
                +1  5640      ;чтение номера байта с индикатора(3байта)
                +1  5641     ;bufind+3..bufind+9
                +1  5642     ;-  - - -
                +1  5643     ;- - - - - - - - - -
                +1  5644     ;adec..adec+9
                +1  5645     ;ст            мл
23AB 7849       +1  5646     upak3:  mov             r0,#bufind+9;
23AD 795C       +1  5647                     mov             r1,#adec+9
23AF 7F03       +1  5648                     mov             r7,#3;3bait
23B1 C3         +1  5649     upa1:   clr             c
23B2 E6         +1  5650                     mov             a,@r0
23B3 9430       +1  5651                     subb    a,#30h
23B5 F7         +1  5652                     mov             @r1,a
23B6 18         +1  5653                     dec             r0
23B7 19         +1  5654                     dec             r1
23B8 DFF7       +1  5655                     djnz    r7,upa1
23BA 22         +1  5656                     ret
                +1  5657     
                +1  5658     ;вых-r2,r3-адрес ячее памяти прогр
23BB            +1  5659     findkoef:
23BB 79AE       +1  5660                                     mov             r1,#diap
23BD E7         +1  5661                                     mov             a,@r1
23BE 23         +1  5662                                     rl              a                                          
                                          ;diap*2(2bait )
23BF FC         +1  5663                                     mov             r4,a                                    ;sa
                             ve
23C0 900000   F +1  5664                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  5665                                     
23C3 93         +1  5666                                     movc    a,@a+dptr                       ;ст байт
23C4 FA         +1  5667                                     mov             r2,a
23C5 A3         +1  5668                                     inc             dptr
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    90

23C6 EC         +1  5669                                     mov             a,r4
23C7 93         +1  5670                                     movc    a,@a+dptr
23C8 FB         +1  5671                                     mov             r3,a                    ;мл байт
23C9 22         +1  5672                                     ret
                +1  5673     ;r2..r5 в опр яч внешн озу
23CA            +1  5674     findext:
23CA 79AE       +1  5675                                     mov             r1,#diap
23CC E7         +1  5676                                     mov             a,@r1
23CD 23         +1  5677                                     rl              a                                          
                                          ;diap*2(2bait )
23CE 23         +1  5678                                     rl              a                                          
                                          ;diap*2(2bait )
23CF F9         +1  5679                                     mov             r1,a                                    ;r1
                             -номер ячейки внешнего озу
                +1  5680                                     
23D0 22         +1  5681                                     ret
                +1  5682     
                +1  5683     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  5684     ;(5000h..5027h)
23D1 5000       +1  5685     diKDw:  dw              5000h                   ;10-2
23D3 5004       +1  5686                                     dw              5004h                   ;10-3
23D5 5008       +1  5687                                     dw              5008h                   ;10-4
23D7 500C       +1  5688                                     dw              500ch                   ;10-5
23D9 5010       +1  5689                                     dw              5010h                   ;10-6
23DB 5014       +1  5690                                     dw              5014h                   ;10-7
23DD 5018       +1  5691                                     dw              5018h                   ;10-8
23DF 501C       +1  5692                                     dw              501ch                   ;10-9
23E1 5020       +1  5693                                     dw              5020h                   ;10-10
23E3 5024       +1  5694                                     dw              5024h                   ;10-11
23E5 5028       +1  5695     dipar:  dw              5028h                   ;parol
23E7 502C       +1  5696     diKm:           dw              502ch                   ;Km для теста измерения
23E9 000186A0   +1  5697     chthou: db      00,01,86h,0a0h  ;100.000
                +1  5698     
23ED AA08       +1  5699     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
23EF AB09       +1  5700                                             mov     r3,ltemp+1
23F1 AC0A       +1  5701                                             mov     r4,ltemp+2
23F3 AD0B       +1  5702                                             mov     r5,ltemp+3
23F5 22         +1  5703                                             ret
                +1  5704     ;bufind+4..bufind+9
                +1  5705     ;-  - - -
                +1  5706     ;- - - - - - - - - -
                +1  5707     ;adec..adec+9
                +1  5708     ;ст            мл
23F6 7847       +1  5709     upakA:  mov             r0,#bufind+7;
23F8 795C       +1  5710                     mov             r1,#adec+9
23FA 7F04       +1  5711                     mov             r7,#4
23FC C3         +1  5712     upaa4:  clr             c
23FD E6         +1  5713                     mov             a,@r0
23FE 9430       +1  5714                     subb    a,#30h
2400 F7         +1  5715                     mov             @r1,a
2401 18         +1  5716                     dec             r0
2402 19         +1  5717                     dec             r1
2403 DFF7       +1  5718                     djnz    r7,upaa4
2405 22         +1  5719                     ret
                +1  5720     
                +1  5721     ;bufind+4..bufind+9
                +1  5722     ;-  - - -
                +1  5723     ;- - - - - - - - - -
                +1  5724     ;adec..adec+9
                +1  5725     ;ст            мл
2406 7848       +1  5726     upakB:  mov             r0,#bufind+8;
2408 795C       +1  5727                     mov             r1,#adec+9
240A 7F05       +1  5728                     mov             r7,#5
240C C3         +1  5729     upab:   clr             c
240D E6         +1  5730                     mov             a,@r0
240E 9430       +1  5731                     subb    a,#30h
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    91

2410 F7         +1  5732                     mov             @r1,a
2411 18         +1  5733                     dec             r0
2412 19         +1  5734                     dec             r1
2413 DFF7       +1  5735                     djnz    r7,upab
2415 C21B       +1  5736                     clr                     bitznB
2417 E543       +1  5737                     mov             a,bufind+3
2419 B42D02     +1  5738                     cjne            a,#2dh,abret
241C D21B       +1  5739                     setb            bitznB
241E            +1  5740     abret:
241E 22         +1  5741                     ret
241F            +1  5742     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
241F 4E6E6AA8   +1  5743                                             db      4eh,6eh,6ah,0a8h;10**9
2423 43FA0000   +1  5744     CH_500:         db              43h,0fah,00,00;1fah=500
2427 4856D800   +1  5745     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
242B 49742400   +1  5746     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  5747     
                +1  5748     
                +1  5749     
                +1  5750     ;управление AD7731
                +1  5751     ;r4=b1 r5=b2
242F            +1  5752     iniacp: ;управление AD7731
242F 7403       +1  5753                             mov             a,#03
                +1  5754     
2431 120000   F +1  5755                             call    write
2434 EC         +1  5756                             mov             a,r4;#80h
2435 120000   F +1  5757                             call    write
2438 ED         +1  5758                             mov             a,r5;#04
2439 120000   F +1  5759                             call    write
243C 7402       +1  5760                             mov             a,#02
243E 120000   F +1  5761                             call    write
2441 74A1       +1  5762                             mov             a,#0a1h
2443 120000   F +1  5763                             call    write
2446 7474       +1  5764                             mov             a,#74h
2448 120000   F +1  5765                             call    write
244B 2095FD     +1  5766                             jb              p1.5,$;p1.3,$
244E 7402       +1  5767                             mov             a,#02
2450 120000   F +1  5768                             call    write
2453 7481       +1  5769                             mov             a,#81h
2455 120000   F +1  5770                             call    write
2458 7474       +1  5771                             mov             a,#74h
245A 120000   F +1  5772                             call    write
245D 2095FD     +1  5773                             jb              p1.5,$;p1.3,$
2460 7402       +1  5774                             mov             a,#02
2462 120000   F +1  5775                             call    write
2465 7421       +1  5776                             mov             a,#21h
2467 120000   F +1  5777                             call    write
246A 7474       +1  5778                             mov             a,#74h
246C 120000   F +1  5779                             call    write
246F 22         +1  5780                             ret
                +1  5781                             ;;;;;;;;;;;;;;;;
                +1  5782     ;;;;;;;;;;;;;;;;;
                +1  5783     ;;;;;;;;;;;;;;;;;
2470 0000       +1  5784     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
2472 6000       +1  5785                                     db              60h,00h;40h,04h         ;10s
2474 6000       +1  5786                                     db              60h,00;40h,04h          ;1s
2476 6000       +1  5787                                     db              60h,00h;40h,04h         ;0,1s
2478 6000       +1  5788                                     db              60h,00h;20h,04h         ;50ms
247A 6000       +1  5789                                     db              60h,00h;20h,04h          ;10ms
247C 1332       +1  5790                                     db              13h,32h         ;2ms
                +1  5791     
                +1  5792     ;загр В1,В2 в завис от Т                                
247E 799A       +1  5793     loab12:                 mov             r1,#parT
2480 900000   F +1  5794                                     mov             dptr,#tabB1_2
2483 E7         +1  5795                                     mov             a,@r1
2484 23         +1  5796                                     rl              a;*2
2485 FF         +1  5797                                     mov             r7,a                    ;save a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    92

2486 93         +1  5798                                     movc    a,@a+dptr
2487 FC         +1  5799                                     mov             r4,a   ;b1
2488 0F         +1  5800                                     inc             r7
2489 EF         +1  5801                                     mov             a,r7
248A 93         +1  5802                                     movc    a,@a+dptr
248B FD         +1  5803                                     mov             r5,a
                +1  5804                                     ;после загр В1,2 загр упр слово для нового Т
                +1  5805                             
248C 22         +1  5806                                     ret
                +1  5807     
                +1  5808     
248D 7852       +1  5809     loadr2: mov             r0,#abin+3              ;r2..r5
248F E6         +1  5810                     mov             a,@r0                   ; ст мл   
2490 FA         +1  5811                     mov             r2,a
2491 18         +1  5812                     dec             r0
2492 E6         +1  5813                     mov             a,@r0
2493 FB         +1  5814                     mov             r3,a
2494 18         +1  5815                     dec             r0
2495 E6         +1  5816                     mov             a,@r0
2496 FC         +1  5817                     mov             r4,a
2497 18         +1  5818                     dec             r0
2498 E6         +1  5819                     mov             a,@r0
2499 FD         +1  5820                     mov             r5,a
249A 22         +1  5821                     ret
                +1  5822                                             
                +1  5823      ;;;;;;;;;;;;;;;;;;;      
                +1  5824      ;загрузка KD в зависимости от диап изм  
                +1  5825      ;koef->r8..r11
249B 78AE       +1  5826     loadKD:                 mov             r0,#diap
249D E6         +1  5827                                     mov             a,@r0
249E 900000   F +1  5828                                     mov             dptr,#diKDn
24A1 75F004     +1  5829                                     mov             b,#4
24A4 A4         +1  5830                                     mul             ab
24A5 FF         +1  5831                                     mov             r7,a;save
24A6 93         +1  5832                                     movc    a,@a+dptr
24A7 F508       +1  5833                                     mov             r8,a
24A9 A3         +1  5834                                     inc             dptr
24AA EF         +1  5835                                     mov             a,r7
24AB 93         +1  5836                                     movc    a,@a+dptr
24AC F509       +1  5837                                     mov             r9,a
24AE A3         +1  5838                                     inc             dptr
24AF EF         +1  5839                                     mov             a,r7
24B0 93         +1  5840                                     movc    a,@a+dptr
24B1 F50A       +1  5841                                     mov             r10,a
24B3 A3         +1  5842                                     inc             dptr
24B4 EF         +1  5843                                     mov             a,r7
24B5 93         +1  5844                                     movc    a,@a+dptr
24B6 F50B       +1  5845                                     mov             r11,a
24B8 22         +1  5846                                     ret
                +1  5847     
24B9 3F506B7B   +1  5848      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
24BD 3F507FCC   +1  5849                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
24C1 3F4F9D0B   +1  5850                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
24C5 3F4FE869   +1  5851                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
24C9 3F50294A   +1  5852                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
24CD 3F50639E   +1  5853                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
24D1 3F4BC9F0   +1  5854                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
24D5 3F4C063B   +1  5855                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
24D9 3F50EFDD   +1  5856                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    93

                             -10
24DD 3F512AD9   +1  5857                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  5858     
24E1 00000039   +1  5859     ch57:   db      00,00,00,39h;57
24E5 00000014   +1  5860     ch20:   db      00,00,00,14h;20
                +1  5861     
                +1  5862     ;загр ус для тестов ацп 
                +1  5863     ;dptr-
24E9 78B1       +1  5864     lotpus: mov             r0,#vichR
24EB B6210D     +1  5865                                     cjne    @r0,#21h,te22
24EE 900000   F +1  5866                                     mov                     dptr,#tabt11;заслать ус 11А
24F1 E4         +1  5867     lotp:           clr             a
24F2 93         +1  5868                             movc    a,@a+dptr                               ;high byte
24F3 F584       +1  5869                             mov             p4,a
24F5 A3         +1  5870                             inc             dptr
24F6 E4         +1  5871                             clr             a
24F7 93         +1  5872                             movc    a,@a+dptr                               ;low byte
24F8 F585       +1  5873                             mov             p5,a
24FA 22         +1  5874                             ret
24FB B62205     +1  5875     te22:                   cjne    @r0,#22h,te23
24FE 900000   F +1  5876                             mov                     dptr,#tabt9;заслать ус 9А       
2501 80EE       +1  5877                             jmp                     lotp
                +1  5878     
2503 900000   F +1  5879     te23:   mov                     dptr,#tabt7;заслать ус 7А       
2506 80E9       +1  5880                             jmp                     lotp
                +1  5881     
                +1  5882     
                +1  5883     
                +1  5884     
                +1  5885     
2508 02030405   +1  5886     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
250C 06070809                
2510 0A0B                    
                +1  5887     
2512 78AE       +1  5888     findR:                  mov                     r0,#diap
2514 E6         +1  5889                                                     mov                     a,@r0
2515 900000   F +1  5890                                                     mov                     dptr,#Tabn
2518 93         +1  5891                                                     movc            a,@a+dptr
2519 22         +1  5892                                                     ret
                +1  5893     ;bufind=30h..39h                                                                           
                                           ;
251A C219       +1  5894     vvchif:                 clr             bitmig
251C 79B2       +1  5895                                     mov             r1,#marker
251E E7         +1  5896                                     mov             a,@r1                   ;изм цифры
251F 7840       +1  5897                                     mov             r0,#bufind                      ;0000
2521 28         +1  5898                                     add             a,r0
2522 F8         +1  5899                                     mov             r0,a
2523 06         +1  5900                                     inc             @r0
2524 B63A03     +1  5901                                     cjne    @r0,#3ah,chif
2527 7630       +1  5902                                     mov             @r0,#30h
2529 22         +1  5903                                     ret
252A C3         +1  5904     chif:           clr                     c
252B 7430       +1  5905                                     mov                     a,#30h
252D 96         +1  5906                                     subb            a,@r0
252E 4002       +1  5907                                     jc                      chif5
2530 7630       +1  5908                                     mov             @r0,#30h
2532 22         +1  5909     chif5:  ret
                +1  5910     
2533 80E5       +1  5911     vvnol41:        jmp                     vvchif  ;при наборе цифр в интервале и константах
                +1  5912     
2535 B641FB     +1  5913     vvnol31:        cjne            @r0,#41h,vvnol41
2538 800A       +1  5914                                             jmp                     chifour
253A B631F8     +1  5915     vvnol23:        cjne            @r0,#31h,vvnol31
253D 8005       +1  5916                                             jmp                     chifour 
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    94

                +1  5917     
253F 78B0       +1  5918     vvchibl:        mov                     r0,#level
2541 B623F6     +1  5919                                             cjne            @r0,#23h,vvnol23;при наборе цифр в 
                             блоке
2544 C219       +1  5920     chifour:                clr             bitmig
2546 79B2       +1  5921                                     mov             r1,#marker
2548 E7         +1  5922                                     mov             a,@r1                   ;изм цифры
2549 7840       +1  5923                                     mov             r0,#bufind                      ;1..4
254B 28         +1  5924                                     add             a,r0
254C F8         +1  5925                                     mov             r0,a
254D 06         +1  5926                                     inc             @r0
254E B63504     +1  5927                                     cjne    @r0,#35h,chifb
2551 7631       +1  5928                                     mov             @r0,#31h
2553 8006       +1  5929                                     jmp             chifb1
2555 B63003     +1  5930     chifb:  cjne    @r0,#30h,chifb1
2558 7631       +1  5931                                     mov             @r0,#31h
255A 22         +1  5932                                     ret
255B            +1  5933     chifb1:;;;;;;;;;;
255B C3         +1  5934                                     clr                     c
255C 7430       +1  5935                                     mov                     a,#30h
255E 96         +1  5936                                     subb            a,@r0
255F 4002       +1  5937                                     jc                      chifl5
2561 7630       +1  5938                                     mov             @r0,#30h
                +1  5939                                     
2563 22         +1  5940     chifl5: ret
                +1  5941     ;;;;;;;;;;;;;
2564 22         +1  5942             ret
                +1  5943       ;перевод маркера влево
2565            +1  5944     marle:  
2565 C219       +1  5945                     clr             bitmig
                +1  5946                     ;mov            savba,#0   нельзя обнулять
2567 78B2       +1  5947             mov             r0,#marker
2569 16         +1  5948                     dec             @r0
256A E6         +1  5949                     mov             a,@r0
256B C3         +1  5950                     clr             c
256C 953A       +1  5951                     subb    a,movleft         ;крайне левое положение
256E 5001       +1  5952                     jnc             rler
2570 06         +1  5953                     inc             @r0
2571 22         +1  5954     rler:   ret
                +1  5955         
                +1  5956     ;перевод маркера вправо
2572 C219       +1  5957     marri:  clr             bitmig
2574 78B2       +1  5958                     mov             r0,#marker
2576 06         +1  5959                     inc         @r0
2577 E53B       +1  5960                     mov             a,movrig           ;крайне правое положение
2579 C3         +1  5961                     clr             c
257A 96         +1  5962                     subb    a,@r0
257B 5001       +1  5963                     jnc             rrir
257D 16         +1  5964                     dec             @r0
257E 22         +1  5965     rrir:   ret
                +1  5966         
                +1  5967     ;konstA->bufind+4..bufind+7
257F 78BC       +1  5968     outA:           mov                     r0,#konstA
2581 120000   F +1  5969                                     call            resar2
2584 120343     +1  5970                                     call            ftol                    ;->hex
2587 784F       +1  5971                                     mov             r0,#abin
2589 120000   F +1  5972                                     call            saver2
258C 7853       +1  5973                                     mov                     r0,#adec
258E 7952       +1  5974                                     mov             r1,#abin+3
2590 120000   F +1  5975                                     call            bindec
2593 785C       +1  5976                                     mov                     r0,#adec+9
2595 7947       +1  5977                                     mov                     r1,#bufind+7
2597 7F04       +1  5978                                     mov                     r7,#4
2599 E6         +1  5979     outa2:  mov             a,@r0
259A 2430       +1  5980                               add           a,#30h
259C F7         +1  5981                                     mov             @r1,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    95

259D 19         +1  5982                                     dec             r1
259E 18         +1  5983                                     dec             r0
259F DFF8       +1  5984                                     djnz    r7,outa2
25A1 22         +1  5985                                     ret
                +1  5986                                             
                +1  5987     ;konstB->bufind+4..bufind+8
                +1  5988     ;outB:          mov                     r0,#konstB
                +1  5989     ;                               call            resar2
                +1  5990     ;                               mov                     a,r2
                +1  5991     ;                               anl                     a,#80h
                +1  5992     ;                               jz                      outb3
                +1  5993     ;mov                    a,r2
                +1  5994     ;                               anl                     a,#7fh
                +1  5995     ;                               mov                     r2,a
                +1  5996     ;                               mov                     bufind+3,#2dh
                +1  5997     ;outb3: call            ftol                    ;->hex
                +1  5998     ;                               mov             r0,#abin
                +1  5999     ;                               call            saver2
                +1  6000     ;                               mov                     r0,#adec
                +1  6001     ;                               mov             r1,#abin+3
                +1  6002     ;                               call            bindec
                +1  6003     ;                               mov                     r0,#adec+9
                +1  6004     ;                               mov                     r1,#bufind+8
                +1  6005     ;                               mov                     r7,#5
                +1  6006     ;outb2: mov             a,@r0
                +1  6007     ;                         add           a,#30h
                +1  6008     ;                               mov             @r1,a
                +1  6009     ;                               dec             r1
                +1  6010     ;                               dec             r0
                +1  6011     ;                               djnz    r7,outb2
                +1  6012     ;                               ret
                +1  6013     
                +1  6014     
                +1  6015     ;пп мигания индикации
25A2 78B2       +1  6016     mign:           mov             r0,#marker
                +1  6017                                     
25A4 B6FF03     +1  6018                                     cjne    @r0,#0ffh,mignn
                +1  6019                                     ;реж изм мигает *
25A7 C219       +1  6020                                     clr             bitmig
25A9 22         +1  6021                                     ret
                +1  6022     
25AA            +1  6023     mignn:                  ;clr            c
25AA 7440       +1  6024                                     mov             a,#bufind
25AC 26         +1  6025                                     add             a,@r0                   ;a=bufind+marker
25AD F9         +1  6026                                     mov             r1,a
25AE 201907     +1  6027                                     jb              bitmig,onmig
25B1 873C       +1  6028                                     mov             savba,@r1
                +1  6029                             ;       mov             a,@r1
                +1  6030                             ;       mov             savba,a
25B3 7720       +1  6031                                     mov             @r1,#" "
                +1  6032                                     
25B5 D219       +1  6033                                     setb    bitmig
25B7 22         +1  6034                                     ret
                +1  6035     
25B8 A73C       +1  6036     onmig:                  mov             @r1,savba
                +1  6037                                     ;mov            a,savba
                +1  6038                                     ; mov           @r1,a
25BA C219       +1  6039                                     clr             bitmig
25BC 120000   F +1  6040                                     call    z_01s
25BF 22         +1  6041                                     ret
                +1  6042     ;номер ошибки bufind+6
25C0 900000   F +1  6043     error:          mov             dptr,#teERR
25C3 120000   F +1  6044                                             call    lotext
25C6 853946     +1  6045                                             mov             bufind+6,nuerr
25C9 22         +1  6046                                     ret
                +1  6047     
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    96

                +1  6048     
25CA            +1  6049     textT:          
25CA FD543D32   +1  6050     te2ms:                  db              0fdh,"T","=",32h,"m",67h,0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
25CE 6D67FDFD                
25D2 FDFD                    
25D4 FD543D31   +1  6051     te10ms:                 db              0fdh,"T","=",31h,30h,"m",67h,0fdh,0fdh,0fdh
25D8 306D67FD                
25DC FDFD                    
25DE FD543D35   +1  6052                             db              0fdh,"T","=",35h,30h,"m",67h,0fdh,0fdh,0fdh
25E2 306D67FD                
25E6 FDFD                    
25E8 FD543D64   +1  6053                             db              0fdh,"T","=",64h,31h,67h,0fdh,0fdh,0fdh,0fdh
25EC 3167FDFD                
25F0 FDFD                    
25F2 20202054   +1  6054                             db              " "," "," ","T","=",31h,67h," "," "," "
25F6 3D316720                
25FA 2020                    
25FC 2020543D   +1  6055                             db              " "," ","T","=",31h,30h,67h," "," "," "  
2600 31306720                
2604 2020                    
                +1  6056     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                +1  6057     
2606 42753474   +1  6058     teVICH: db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
260A 79767454                
260E 7720                    
2610 20553D20   +1  6059     teAequ0:        db              " ",'U','='," "," "," "," "," "," ",65h
2614 20202020                
2618 2065                    
261A 20423D2B   +1  6060     teBequ0:        db              " ",'B','=','+'," "," "," "," "," "," "
261E 20202020                
2622 2020                    
2624 20207145   +1  6061     teMENU: db              " "," ",71h,"E","H",72h," "," "," "," "
2628 48722020                
262C 2020                    
                +1  6062     
262E 20544579   +1  6063     teTESI: db      " ","T","E",79h,"T",2dh,74h,33h,71h," ";ТЕСТ -ИЗМ    11
2632 542D7433                
2636 7120                    
2638 54457954   +1  6064     teTESR: db      "T","E",79h,"T"," ","R",35h," "," "," ";ТЕСТ RS 12
263C 20523520                
2640 2020                    
2642 20794B30   +1  6065     teSKOR: db      " ",79h,'K',30h,"P"," ","R",35h," "," ";СКОР 232      13
2646 50205235                
264A 2020                    
264C 20204142   +1  6066     teAVK:  db      " "," ",'A','B','K'," "," "," "," "," "  ;AВK                              
                                  14
2650 4B202020                
2654 2020                    
2656 204B4176   +1  6067     teKALIB:         db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР    15
265A 74735020                
265E 202020                  
                +1  6068     
2661 20544579   +1  6069     teTE11:         db              " ",'T',"E",79h,'T'," "," "," ",'T',31h;          21
2665 54202020                
2669 5431                    
266B 20544579   +1  6070     teTE9:          db              " ",'T',"E",79h,'T'," "," "," ",'T',32h;                   
                                                  22
266F 54202020                
2673 5432                    
2675 20544579   +1  6071     teTE7:          db              " ",'T',"E",79h,'T'," "," "," ",'T',33h;                   
                                                  23
2679 54202020                
267D 5433                    
                +1  6072     
                +1  6073     
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    97

267F 20202035   +1  6074     teS57_6:                db              " "," "," ",35h,37h,36h," "," "," "," ";57.6
2683 37362020                
2687 2020                    
2689 20202031   +1  6075     teS19_2:                db              " "," "," ",31h,39h,32h," "," "," "," ";19,2
268D 39322020                
2691 2020                    
                +1  6076     
2693 61415030   +1  6077     tePAR:          db              61h,'A',"P",30h,76h,77h," ",30h,30h,30h;пароль
2697 76772030                
269B 3030                    
269D 20303030   +1  6078     teKD:                   db              " ",30h,30h,30h,30h,30h," "," "," ",'A';00000
26A1 30302020                
26A5 2041                    
26A7 74337120   +1  6079     teIZMK: db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
26AB 4B304879                
26AF 5420                    
26B1 20204275   +1  6080     teOUT:          db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
26B5 58307820                
26B9 2020                    
26BB 2020304C   +1  6081     teOLL:          db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
26BF 4C202020                
26C3 2020                    
26C5 20203034   +1  6082     teCLE:          db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
26C9 7479544B                
26CD 4120                    
26CF 20203041   +1  6083     teMEM:          db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
26D3 71795420                
26D7 20203341   +1  6084     teWR:           db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
26DB 61747977                
26DF 2020                    
26E1 20206150   +1  6085     teLIST: db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
26E5 30797130                
26E9 545020                  
26EC 20206130   +1  6086     teFULL: db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
26F0 76484162                
26F4 2020                    
26F6 20744854   +1  6087     teINT:  db      " ",74h,"H",'T'," ",30h,30h,30h,30h,67h;ИНТ 0000
26FA 20303030                
26FE 3067                    
2700 20207376   +1  6088     teBL:           db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
2704 304B2020                
2708 2020                    
270A 20207376   +1  6089     teBL0:  db      " "," ",73h,76h,30h,'K'," ",30h," "," ";БЛОК 0
270E 304B2030                
2712 2020                    
2714 30547934   +1  6090     teCH:           db      30h,'T',79h,34h,"E",'T'," ",30h,30h,31h;ОТСЧЕТ 001
2718 45542030                
271C 3031                    
271E 79544154   +1  6091     teSTAT:         db      79h,'T','A','T',74h,79h,'T',74h,'K','A';СТАТИСТИКА
2722 74795474                
2726 4B41                    
2728 71744820   +1  6092     teMIN:  db      71h,74h,"H"," "," "," "," "," "," "," ";МИН  00000
272C 20202020                
2730 2020                    
2732 71414B79   +1  6093     teMAX:  db      71h,'A','K',79h," "," "," "," "," "," ";МАКС 00000
2736 20202020                
273A 2020                    
273C 79504578   +1  6094     teMID:  db      79h,"P","E",78h," "," "," "," "," "," ";СРЕД 00000
2740 20202020                
2744 2020                    
                +1  6095      ;;;;;;;;;;;;;;;;;;;         
2746 2020304C   +1  6096     teOLI:  db              " "," ",30h,"L","L"," ","I"," "," "," "
274A 4C204920                
274E 2020                    
2750 2020304C   +1  6097     teOLR:  db              " "," ",30h,"L","L"," ",66h," "," "," "
2754 4C206620                
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    98

2758 2020                    
275A 20204552   +1  6098     teERR:  db              " "," ","E","R","R"," "," "," "," "," " ;ERR
275E 52202020                
2762 2020                    
2764 2020454E   +1  6099     teEND:  db              " "," ","E","N","D"," "," "," "," "," " ;END
2768 44202020                
276C 2020                    
                +1  6100     
                +1  6101     ;dptr+4-приемник
                +1  6102     ;dptr-источник
                +1  6103     ;r7-кол байт  
276E            +1  6104     xCIKLWR:
276E 7F04       +1  6105                             mov             r7,#4   
2770 E0         +1  6106     lwrx:   movx    a,@dptr
2771 C083       +1  6107                             push    dph
2773 C082       +1  6108                             push    dpl
2775 A3         +1  6109                             inc             dptr
2776 A3         +1  6110                             inc             dptr
2777 A3         +1  6111                             inc             dptr
2778 A3         +1  6112                             inc             dptr
2779 F0         +1  6113                             movx    @dptr,a
277A D082       +1  6114                             pop             dpl
277C D083       +1  6115                             pop             dph
                +1  6116                             
277E A3         +1  6117                             inc             dptr
277F DFEF       +1  6118                             djnz    r7,lwrx
2781 22         +1  6119                             ret
                +1  6120     ;r2..r5->@dptr..@dptr+3                         
2782 EA         +1  6121     saveIr2:                mov     a,r2
2783 F0         +1  6122                                             movx    @dptr,a
2784 A3         +1  6123                                             inc     dptr
2785 EB         +1  6124                                             mov     a,r3
2786 F0         +1  6125                                             movx    @dptr,a
2787 A3         +1  6126                                             inc     dptr
2788 EC         +1  6127                                             mov     a,r4
2789 F0         +1  6128                                             movx    @dptr,a
278A A3         +1  6129                                             inc     dptr
278B ED         +1  6130                                             mov     a,r5
278C F0         +1  6131                                             movx    @dptr,a
278D 22         +1  6132                                             ret
                +1  6133     ;r2..r5-> @r0..@r0+3
                +1  6134     
278E EA         +1  6135     saver2:         mov     a,r2
278F F6         +1  6136                                             mov     @r0,a
2790 08         +1  6137                                             inc     r0
2791 EB         +1  6138                                             mov     a,r3
2792 F6         +1  6139                                             mov     @r0,a
2793 08         +1  6140                                             inc     r0
2794 EC         +1  6141                                             mov     a,r4
2795 F6         +1  6142                                             mov     @r0,a
2796 08         +1  6143                                             inc     r0
2797 ED         +1  6144                                             mov     a,r5
2798 F6         +1  6145                                             mov     @r0,a
2799 22         +1  6146                                             ret 
279A 7F50       +1  6147     clmassix:       mov                     r7,#50h;28h
279C 900100     +1  6148                             mov     dptr,#MASS0        ;забить массив A нулями
279F 7400       +1  6149     clmax:          mov          a,#00h
27A1 F0         +1  6150                  movx    @dptr,a
27A2 A3         +1  6151                  inc     dptr
27A3 DFFA       +1  6152                 djnz                r7,clmax                
27A5 F56E       +1  6153                  mov     chmas,a
27A7 C201       +1  6154                  clr     bitmas
27A9 22         +1  6155                 ret
                +1  6156     ;r1-яЁшхьшъ
                +1  6157     ;r0-шёЄюўшъ
                +1  6158     ;r7-ъюы срщЄ  
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE    99

27AA            +1  6159     CIKLWR:
27AA 7F04       +1  6160                             mov             r7,#4   
27AC E6         +1  6161     lwr:    mov     a,@r0
27AD F7         +1  6162                             mov     @r1,a
27AE 09         +1  6163                             inc             r1
27AF 08         +1  6164                             inc             r0
27B0 DFFA       +1  6165                             djnz    r7,lwr
27B2 22         +1  6166                             ret     
                +1  6167     ;r2..r5-> @dptr..@dptr+3
                +1  6168     
27B3 120000   F +1  6169     zmul:   call    maform
27B6 120000   F +1  6170                     call    lmul
27B9 120000   F +1  6171                     call    bform
27BC 22         +1  6172                     ret
                +1  6173     
27BD 120000   F +1  6174     zdiv:   call    maform
27C0 120000   F +1  6175                     call    divide
27C3 120000   F +1  6176                     call    bform
27C6 22         +1  6177                     ret
                +1  6178     
27C7 EA         +1  6179     maform: mov a,r2
27C8 33         +1  6180             rlc a
27C9 5006       +1  6181             jnc             fo1m
27CB D202       +1  6182                     setb            znmat
27CD 120000   F +1  6183                     call   form4
27D0 22         +1  6184                     ret
27D1 C202       +1  6185     fo1m:   clr             znmat
27D3 22         +1  6186                     ret
                +1  6187     
27D4 300203     +1  6188     bform:  jnb             znmat,fo2m
27D7 120000   F +1  6189                     call    form4
27DA 22         +1  6190     fo2m:   ret
                +1  6191       
                +1  6192     ;r2..r5 яхЁхтхёЄш т фюя ъюф
27DB ED         +1  6193     form4:          mov a,r5
27DC F4         +1  6194             cpl a
27DD 2401       +1  6195             add a,#1
27DF FD         +1  6196             mov r5,a
27E0 EC         +1  6197             mov a,r4
27E1 F4         +1  6198             cpl a
27E2 3400       +1  6199             addc    a,#0
27E4 FC         +1  6200             mov r4,a
27E5 EB         +1  6201             mov a,r3
27E6 F4         +1  6202                 cpl a
27E7 3400       +1  6203             addc    a,#0
27E9 FB         +1  6204             mov r3,a
27EA EA         +1  6205             mov a,r2
27EB F4         +1  6206             cpl a
27EC 3400       +1  6207             addc    a,#0
27EE FA         +1  6208             mov r2,a
27EF 22         +1  6209             ret
                +1  6210     
27F0 120000   F +1  6211     zcmp:   call            maform
27F3 120000   F +1  6212                     call            lcmp
27F6 C0D0       +1  6213                     push            psw
27F8 120000   F +1  6214                     call    bform
27FB D0D0       +1  6215                     pop             psw
27FD 22         +1  6216                     ret
                +1  6217     
                +1  6218     
                +1  6219     ;@r0..@r0+3->r8..r11
                +1  6220     
27FE E6         +1  6221     resar8: mov     a,@r0
27FF F508       +1  6222                     mov     ltemp,a
2801 08         +1  6223                     inc     r0
2802 E6         +1  6224                     mov     a,@r0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   100

2803 F509       +1  6225                     mov     ltemp+1,a
2805 08         +1  6226                     inc     r0
2806 E6         +1  6227                     mov     a,@r0
2807 F50A       +1  6228                     mov     ltemp+2,a
2809 08         +1  6229                     inc     r0
280A E6         +1  6230                     mov     a,@r0
280B F50B       +1  6231                     mov     ltemp+3,a
280D 22         +1  6232                     ret
                +1  6233     
                +1  6234     ;
                +1  6235     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                +1  6236     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                +1  6237     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                +1  6238     ;r2 a    ўшёыю 180
                +1  6239     ;00 b4
                +1  6240     ;т_ї- mabin..mabin+2
                +1  6241     ;     80 01 00
                +1  6242      
280E C8         +1  6243     cond:   xch     a,r0    
280F F9         +1  6244                     mov     r1,a
2810 C8         +1  6245                     xch     a,r0
2811 7C03       +1  6246                     mov     r4,#03
2813 7700       +1  6247     dcoa:   mov     @r1,#00
2815 09         +1  6248                     inc     r1
2816 DCFB       +1  6249                     djnz    r4,dcoa
2818 7B10       +1  6250                     mov     r3,#10h
281A C3         +1  6251     dcob:   clr     c
281B 33         +1  6252                     rlc     a
281C CA         +1  6253                     xch     a,r2
281D 33         +1  6254                     rlc     a
281E CA         +1  6255                     xch     a,r2
281F C8         +1  6256                     xch     a,r0
2820 F9         +1  6257                     mov     r1,a
2821 C8         +1  6258                     xch     a,r0
2822 7C03       +1  6259                     mov     r4,#03
2824 FD         +1  6260                     mov     r5,a
2825 E7         +1  6261     dcoc:   mov     a,@r1 
2826 37         +1  6262                     addc    a,@r1
2827 D4         +1  6263                     da      a
2828 F7         +1  6264                     mov     @r1,a
2829 09         +1  6265                     inc     r1
282A DCF9       +1  6266                     djnz    r4,dcoc
282C ED         +1  6267                     mov     a,r5
282D 4003       +1  6268                     jc      dcod
282F DBE9       +1  6269                     djnz    r3,dcob
2831 C3         +1  6270                     clr     c
2832 00         +1  6271     dcod:   nop
2833 22         +1  6272                     ret
                +1  6273     
2834 8A08       +1  6274     move28: mov     ltemp,r2                        ;r2..r5->ltemp
2836 850309     +1  6275                     mov     ltemp+1,3
2839 85040A     +1  6276                     mov     ltemp+2,4
283C 85050B     +1  6277                     mov     ltemp+3,5
283F 22         +1  6278                     ret
                +1  6279     
                +1  6280     ;@r0..@r0+3->r2..r5
                +1  6281     
2840 E6         +1  6282     resar2: mov     a,@r0
2841 FA         +1  6283                     mov     r2,a
2842 08         +1  6284                     inc     r0
2843 E6         +1  6285                     mov     a,@r0
2844 FB         +1  6286                     mov     r3,a
2845 08         +1  6287                     inc     r0
2846 E6         +1  6288                     mov     a,@r0
2847 FC         +1  6289                     mov     r4,a
2848 08         +1  6290                     inc     r0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   101

2849 E6         +1  6291                     mov     a,@r0
284A FD         +1  6292                     mov     r5,a
284B 22         +1  6293                     ret
                +1  6294     
                +1  6295     ;25mkc !!!!!!!!!!!!!!!1
284C 7B4B       +1  6296     z_9:      mov R3,#4Bh      ;загрузка числа
284E DBFE       +1  6297                    djnz R3,$
2850 22         +1  6298               ret
                +1  6299     
                +1  6300     ;запись   передаваемый байт в acc
                +1  6301     ;передача байта послед кодом старшими разрядами  вперед
2851 7A08       +1  6302     write:     mov R2,#8
2853 C3         +1  6303                             clr  c  
2854 C297       +1  6304     wr1:            clr             p1.7;P1.2
2856 00         +1  6305                         nop 
2857 33         +1  6306                             rlc A
2858 9296       +1  6307                             mov P1.6,C;P1.1,C
285A 120000   F +1  6308                        call tim2
285D D297       +1  6309                        setb P1.7;P1.2
285F 120000   F +1  6310                call tim2
2862 DAF0       +1  6311                       djnz R2,wr1
2864 C296       +1  6312                       clr P1.6;P1.1
2866 22         +1  6313                                              ret
                +1  6314     
                +1  6315     ;чтение номера байта с индикатора(2байта)
                +1  6316     ;bufind+8..bufind+9
                +1  6317     ;-  - - -
                +1  6318     ;- - - - - - - - - -
                +1  6319     ;adec..adec+9
                +1  6320     ;ст            мл
2867 7847       +1  6321     upak1:  mov             r0,#bufind+7;
2869 795C       +1  6322                                     mov             r1,#adec+9
286B C3         +1  6323                                     clr             c
286C E6         +1  6324                                     mov             a,@r0
286D 9430       +1  6325                                     subb    a,#30h
286F FF         +1  6326                                     mov             r7,a
2870 C3         +1  6327                                     clr             c
2871 9405       +1  6328                                     subb    a,#5
2873 4004       +1  6329                                     jc              upk1
2875 7404       +1  6330                                     mov             a,#4
2877 8001       +1  6331                                     jmp             upk2
2879 EF         +1  6332     upk1:           mov             a,r7
287A F7         +1  6333     upk2:           mov             @r1,a
287B 22         +1  6334                                     ret  
                +1  6335     ;r1-мл байт счетчика ячеек
287C C3         +1  6336     chminus:        clr                     c
287D E7         +1  6337                                             mov                     a,@r1
287E 9401       +1  6338                                             subb            a,#01
2880 F7         +1  6339                                             mov                     @r1,a;low
2881 19         +1  6340                                             dec                     r1
2882 E7         +1  6341                                             mov                     a,@r1
2883 9400       +1  6342                                             subb            a,#00
2885 F7         +1  6343                                             mov                     @r1,a
2886 22         +1  6344                                             ret
                +1  6345     
                +1  6346     
                +1  6347     ;чтение номера байта с индикатора(4байта)
                +1  6348     ;bufind+6..bufind+9
                +1  6349     ;-  - - -
                +1  6350     ;- - - - - - - - - -
                +1  6351     ;adec..adec+9
                +1  6352     ;ст            мл
2887 7848       +1  6353     upak4:  mov             r0,#bufind+8;
2889 795C       +1  6354                     mov             r1,#adec+9
288B 7F04       +1  6355                     mov             r7,#4
288D C3         +1  6356     upaa:   clr             c
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   102

288E E6         +1  6357                     mov             a,@r0
288F 9430       +1  6358                     subb    a,#30h
2891 F7         +1  6359                     mov             @r1,a
2892 18         +1  6360                     dec             r0
2893 19         +1  6361                     dec             r1
2894 DFF7       +1  6362                     djnz    r7,upaa
2896 22         +1  6363                     ret
                +1  6364     
                +1  6365     ;dptr-адр ячейки 1й соотв блока 
2897 E538       +1  6366     adrblok:         mov            a,nblok
2899 C3         +1  6367                              clr            c
289A 9401       +1  6368                              subb           a,#1
289C FD         +1  6369                              mov            r5,a
289D E4         +1  6370                              clr            a
289E FC         +1  6371                              mov            r4,a
289F FB         +1  6372                              mov            r3,a
28A0 FA         +1  6373                              mov            r2,a
28A1 900000   F +1  6374                                     mov                     dptr,#ch320h
28A4 120000   F +1  6375                                     CALL   ldc_ltemp                 ; ltemp <-320
28A7 120000   F +1  6376                                     call            lmul;r2..r5
28AA ED         +1  6377                                     mov                     a,r5
28AB 2450       +1  6378                                     add                     a,#50h
28AD F582       +1  6379                                     mov                     dpl,a
28AF EC         +1  6380                                     mov                     a,r4
28B0 3401       +1  6381                                     addc            a,#01           
28B2 F583       +1  6382                                     mov                     dph,a                   ;dptr-
28B4 22         +1  6383                                     ret
                +1  6384     
                +1  6385     ;
                +1  6386     ;saven_bl<-dptr  адрес след ячейки внешн озу 
28B5 E538       +1  6387     save_hl:                mov             a,nblok
28B7 B4011D     +1  6388                                                     cjne    a,#1,sa_hl1
28BA 79D3       +1  6389                                                     mov             r1,#saven_bl
28BC E583       +1  6390     sa_hl:                  mov             a,dph
28BE F7         +1  6391                                               mov           @r1,a
28BF 09         +1  6392                                                     inc             r1
28C0 E582       +1  6393                                                     mov             a,dpl
28C2 F7         +1  6394                                                     mov             @r1,a
                +1  6395                                                     ;;;;;;;;;не конец ли блока
                +1  6396                             
28C3 79D6       +1  6397                                     mov                     r1,#volume+1;work+1
28C5 120000   F +1  6398                                     call            chminus
28C8 78D5       +1  6399                                     mov             r0,#volume
28CA E6         +1  6400                                     mov             a,@r0
28CB 30E708     +1  6401                                     jnb             acc.7,noendli
28CE C20A       +1  6402                                     clr                     bitbon                  ;блок закон
                             чился
28D0 534BFD     +1  6403                                     anl                     bufind+11,#0fdh
28D3 120000   F +1  6404                                     call            ind
28D6 22         +1  6405     noendli:ret
                +1  6406     
28D7 B40204     +1  6407     sa_hl1:         cjne    a,#2,sa_hl2
28DA 79C0       +1  6408                                                     mov             r1,#saven_bl2
28DC 80DE       +1  6409                                                     jmp             sa_hl
                +1  6410     
28DE B40304     +1  6411     sa_hl2:         cjne    a,#3,sa_hl3
28E1 79C2       +1  6412                                                     mov             r1,#saven_bl3
28E3 80D7       +1  6413                                                     jmp             sa_hl
28E5 79D9       +1  6414     sa_hl3:                 mov             r1,#saven_bl4
28E7 80D3       +1  6415                                                     jmp             sa_hl
                +1  6416     
                +1  6417     ;загрузка dptr сохр ранее значением адреса ячейки
28E9 E538       +1  6418     resa_hl:                mov             a,nblok
28EB B4010A     +1  6419                                                     cjne    a,#1,re_hl1
28EE 79D3       +1  6420                                                     mov             r1,#saven_bl;блок1 150h..46
                             fh
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   103

28F0 E7         +1  6421     re_hl:                  mov             a,@r1   
28F1 F583       +1  6422                                                     mov             dph,a
                +1  6423                                               
28F3 09         +1  6424                                                     inc             r1
28F4 E7         +1  6425                                                     mov             a,@r1
28F5 F582       +1  6426                                                     mov             dpl,a
28F7 22         +1  6427                                                     ret
                +1  6428     
28F8 B40204     +1  6429     re_hl1:                 cjne    a,#2,re_hl2
28FB 79C0       +1  6430                                                     mov             r1,#saven_bl2   ;блок2 470h
                             ..78fh
28FD 80F1       +1  6431                                                     jmp             re_hl
                +1  6432     
28FF B40304     +1  6433     re_hl2:                 cjne    a,#3,re_hl3
2902 79C2       +1  6434                                                     mov             r1,#saven_bl3   ;блок3 790h
                             ..aafh
2904 80EA       +1  6435                                                     jmp             re_hl
                +1  6436     
2906 79D9       +1  6437     re_hl3:                 mov             r1,#saven_bl4   ;блок4 ab0h..dcfh
2908 80E6       +1  6438                                                     jmp             re_hl
                +1  6439     ;загрузка rez_A3 в соотв яч внешн озу
290A 789C       +1  6440     loA3_X:                 mov             r0,#rez_A3
290C 120000   F +1  6441                                                     call    resar2
                +1  6442                                                     
290F EA         +1  6443                                                     mov             a,r2                    ;
2910 F0         +1  6444                                                     movx    @dptr,a
2911 A3         +1  6445                                                     inc             dptr
2912 EB         +1  6446                                                     mov             a,r3
2913 F0         +1  6447                                                     movx    @dptr,a
2914 A3         +1  6448                                                     inc             dptr
2915 EC         +1  6449                                                     mov             a,r4
2916 F0         +1  6450                                                     movx    @dptr,a
2917 A3         +1  6451                                                     inc             dptr
2918 ED         +1  6452                                                     mov             a,r5
2919 F0         +1  6453                                                     movx    @dptr,a
291A A3         +1  6454                                                     inc             dptr;адрес след ячейки внеш
                             н озу храним
291B 22         +1  6455                                                     ret             ;в ячейке saven_bl
                +1  6456     ;чтение в rez_A3 из соотв яч внешн озу
291C            +1  6457     reA3_X:         
                +1  6458                                                     
291C E0         +1  6459                                                     movx    a,@dptr
291D FA         +1  6460                                                     mov             r2,a
291E A3         +1  6461                                                     inc             dptr
291F E0         +1  6462                                                     movx    a,@dptr
2920 FB         +1  6463                                                     mov             r3,a
2921 A3         +1  6464                                                     inc             dptr
2922 E0         +1  6465                                                     movx    a,@dptr
2923 FC         +1  6466                                                     mov             r4,a
2924 A3         +1  6467                                                     inc             dptr
2925 E0         +1  6468                                                     movx    a,@dptr
2926 FD         +1  6469                                                     mov             r5,a
2927 A3         +1  6470                                                     inc             dptr
2928 789C       +1  6471                                                     mov             r0,#rez_A3
292A 120000   F +1  6472                                                     call    saver2
292D 22         +1  6473                                                     ret
                +1  6474     ;;;;;;;;;;;;;;;;;
                +1  6475     ;разбивка внешнего озу
                +1  6476     ;0..ffh считывается страница рпзу калибровочных коффициентов
                +1  6477     ;100h..150h обл внеш озу для скользящего массива измерения
                +1  6478     ;150h..46fh 1й блок
                +1  6479     ;470h..78fh     2й блок
                +1  6480     ;790h..aaf      3й блок
                +1  6481     ;ab0h..dcfh 4й блок
                +1  6482     ;dd0..fffh свободная область
                +1  6483     ;
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   104

                +1  6484     ;светодиоды и точки для индикатора
                +1  6485     ;bufind+10.0->makoi.7 такт
                +1  6486     ;bufind+10.1->makoi+1.7 измер
                +1  6487     ;bufind+10.2->makoi+2.7 avp
                +1  6488     ;bufind+10.3->makoi+3.7 нуль
                +1  6489     ;bufind+10.4->makoi+4.7 0,1s
                +1  6490     ;bufind+10.5->makoi+5.7 1s
                +1  6491     ;bufind+10.6->makoi+6.7 10s
                +1  6492     ;bufind+10.7->makoi+7.7 кмп
                +1  6493     ;bufind+11.0->makoi+8.7 память
                +1  6494     ;bufind+11.1->makoi+9.7 пуск
                +1  6495     ;знакоместа 0..9(10 знакомест)
                +1  6496     ;bufind+11.2->точка после 5 знакоместа
                +1  6497     ;bufind+11.3->точка после 8 знакоместа
                +1  6498     ;bufind+11.4->точка после 1 знакоместа(+0,0000  -7a)
                +1  6499     ;bufind+11.5->точка после 7 знакоместа
                +1  6500     ;bufind+11.6->точка после 6 знакоместа
                +1  6501     ;bufind+11.7->точка после 4 знакоместа
                +1  6502     
                +1  6503     ;ERR ошибки
                +1  6504     ;ERR 2-пароль в калибровке не соответствует
                +1  6505     ;ERR 3-не проходит тест RS
                +1  6506     ;ERR 4-в режиме R не введена константа U=0000(=0)
                    6507     
                    6508     ;$include (d:\amp\sarifm3.asm) 
                +1  6509     ; ” ©« SARIFM.ASM 8.11.95
                +1  6510     ;файл арифметики
                +1  6511       
  0008          +1  6512     ltemp    equ       8           ;long temporary
  000C          +1  6513     xtemp    equ       12          ;other temporaries
  000A          +1  6514     DECSIZE  EQU       10
  0004          +1  6515     NUMSIZE  EQU       4
  0004          +1  6516     RR4  EQU       4
  0005          +1  6517     RR5  EQU       5
                +1  6518     
                +1  6519                                                     
                +1  6520     
                +1  6521                 ; rseg     ARIF          ; Switch to this code segment.
                +1  6522     ;             using    0              ; Specify register bank for the following
                +1  6523                                            ; program code.
                +1  6524     ;                                               cseg AT 400h
                +1  6525     ; Arithmetics:  CLEARING string
                +1  6526     ; Input:
                +1  6527     ; R0 - pointer to string,
                +1  6528     ; NUMSIZE - byte count if CLRNUM used,
                +1  6529     ; DECSIZE - byte count if CLRDEC used,
                +1  6530     ; R2 - byte count if CLEAR used;
                +1  6531     ; Output:  none.
                +1  6532     
292E            +1  6533     CLRDEC:
292E 7A0A       +1  6534         MOV R2, #DECSIZE
2930 8002       +1  6535         SJMP    CLEAR
2932            +1  6536     CLRNUM:
2932 7A04       +1  6537         MOV R2, #NUMSIZE
                +1  6538         ;JMP    CLEAR
2934            +1  6539     CLEAR:
2934 E4         +1  6540         CLR A
2935 F6         +1  6541     CLR11:  MOV @R0, A
2936 08         +1  6542         INC R0
2937 DAFC       +1  6543         DJNZ    R2, CLR11
2939 22         +1  6544         RET
                +1  6545     
                +1  6546     ;**********************************
                +1  6547     ;mov    r1,#abin+3
                +1  6548     ;mov    r0,#adec
                +1  6549     ; _ _ _ _
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   105

                +1  6550     ;     03ff
                +1  6551     ;ст     мл   - вход
                +1  6552     ; _ _ _ _ _ _ _ _ _ _
                +1  6553     ;             1 0 2 3
                +1  6554     ;ст                мл 
                +1  6555     ;**********************************
                +1  6556     
293A            +1  6557     BINDEC:
                +1  6558     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  6559     ; Input:
                +1  6560     ; R0 - pointer to destination (high digit is the first),
                +1  6561     ; R1 - pointer to source,
                +1  6562     ; NUMSIZE - byte count in binary number;
                +1  6563     ; DECSIZE - byte count in decimal number;
                +1  6564     ; Output:  none.
                +1  6565     ; Source saved
                +1  6566     
                +1  6567         ; 1. Clear result
293A 7A05       +1  6568         MOV R2, #DECSIZE/2
293C 120000   F +1  6569         CALL   CLEAR  ; incrementing R0
                +1  6570     
                +1  6571         ; 2. Prepare convertion
293F 18         +1  6572         DEC R0
2940 8804       +1  6573         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
2942 8905       +1  6574         MOV RR5, R1 ; R5 - pointer to low byte of binary number
2944 7B20       +1  6575         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6576     
                +1  6577         ; 3. Convert cyrcle
2946            +1  6578     BIN30:
                +1  6579     
                +1  6580         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
2946 A905       +1  6581         MOV R1, RR5
2948 7A04       +1  6582         MOV R2, #NUMSIZE
294A E7         +1  6583     BIN31:  MOV A, @R1
294B 33         +1  6584         RLC A
294C F7         +1  6585         MOV @R1, A
294D 19         +1  6586         DEC R1
294E DAFA       +1  6587         DJNZ    R2, BIN31
2950 A905       +1  6588         MOV R1, RR5
2952 E7         +1  6589         MOV A, @R1
2953 92E0       +1  6590         MOV ACC.0, C
2955 F7         +1  6591         MOV @R1, A
                +1  6592     
                +1  6593         ; 3.2. Doubling decimal result with <Carry>
2956 A804       +1  6594         MOV R0, RR4
2958 7A05       +1  6595         MOV R2, #DECSIZE/2
295A E6         +1  6596     BIN32:  MOV A, @R0
295B 36         +1  6597         ADDC    A, @R0
295C D4         +1  6598         DA  A
295D F6         +1  6599         MOV @R0, A
295E 18         +1  6600         DEC R0
295F DAF9       +1  6601         DJNZ    R2, BIN32
                +1  6602     
                +1  6603         ; 3.3. End of convert cyrcle
2961 DBE3       +1  6604         DJNZ    R3, BIN30
                +1  6605     
                +1  6606         ; 4. Make bytes from half-bytes
2963 E8         +1  6607         MOV A, R0
2964 240A       +1  6608         ADD A, #DECSIZE
2966 F8         +1  6609         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
2967 A904       +1  6610         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
2969 7A05       +1  6611         MOV R2, #DECSIZE/2
296B E7         +1  6612     BIN41:  MOV A, @R1
296C 540F       +1  6613         ANL A, #00FH
296E F6         +1  6614         MOV @R0, A
296F 18         +1  6615         DEC R0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   106

2970 E7         +1  6616         MOV A, @R1
2971 C4         +1  6617         SWAP    A
2972 540F       +1  6618         ANL A, #00FH
2974 F6         +1  6619         MOV @R0, A
2975 18         +1  6620         DEC R0
2976 19         +1  6621         DEC R1
2977 DAF2       +1  6622         DJNZ    R2, BIN41
2979 22         +1  6623         RET
                +1  6624     
                +1  6625     
                +1  6626     ;*********************************
                +1  6627     ;mov    r0,#abin
                +1  6628     ;mov    r1,#adec
                +1  6629     ; _ _ _ _       -выход
                +1  6630     ; ff0000
                +1  6631     ;0004
                +1  6632     ;мл      ст
                +1  6633     
                +1  6634     ;ст                       мл
                +1  6635     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  6636     ;                       2 5 5
                +1  6637     ;                   1 0 2 4
                +1  6638     
297A            +1  6639     DECBIN:
                +1  6640     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  6641     ; Input:
                +1  6642     ; R0 - pointer to destination,
                +1  6643     ; R1 - pointer to source (high digit is the first),
                +1  6644     ; NUMSIZE - byte count in binary number;
                +1  6645     ; DECSIZE - byte count in decimal number;
                +1  6646     ; Output:  none
                +1  6647     ; Source cleared
                +1  6648     
                +1  6649         ; 1. Clear result
297A 120000   F +1  6650         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  6651     
                +1  6652         ; 2. Prepare convertion
297D 18         +1  6653         DEC R0
297E 8804       +1  6654         MOV RR4, R0 ; R4 - pointer to high byte of binary result
2980 8905       +1  6655         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
2982 900000   F +1  6656         MOV DPTR, #DECT2
2985 7B20       +1  6657         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6658     
                +1  6659         ; 3. Convert cyrcle
2987            +1  6660     DEC30:
                +1  6661     
                +1  6662         ; 3.1. Divide decimal number by 2 and prepare <Carry>
2987 C3         +1  6663         CLR C
2988 A905       +1  6664         MOV R1, RR5
298A 7A0A       +1  6665         MOV R2, #DECSIZE
298C E7         +1  6666     DEC31:  MOV A, @R1
298D 540F       +1  6667         ANL A, #00FH
298F 92E4       +1  6668         MOV ACC.4, C
2991 93         +1  6669         MOVC    A,@A+DPTR
2992 F7         +1  6670         MOV @R1, A
2993 A2E7       +1  6671         MOV C, ACC.7
2995 09         +1  6672         INC R1
2996 DAF4       +1  6673         DJNZ    R2, DEC31
                +1  6674     
                +1  6675         ; 3.2. Rotate binary result one bit to right with <Carry>
2998 A804       +1  6676         MOV R0, RR4
299A 7A04       +1  6677         MOV R2, #NUMSIZE
299C E6         +1  6678     DEC32:  MOV A, @R0
299D 13         +1  6679         RRC A
299E F6         +1  6680         MOV @R0, A
299F 18         +1  6681         DEC R0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   107

29A0 DAFA       +1  6682         DJNZ    R2, DEC32
                +1  6683     
                +1  6684         ; 3.3. End of convert cyrcle
29A2 DBE3       +1  6685         DJNZ    R3, DEC30
29A4 22         +1  6686         RET
                +1  6687     
29A5 00800181   +1  6688     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
29A9 02820383                
29AD 0484                    
29AF 00000000   +1  6689         DB  00,00,00,00,00,00
29B3 0000                    
29B5 05850686   +1  6690         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
29B9 07870888                
29BD 0989                    
                +1  6691     
                +1  6692     ;   Long comparison
                +1  6693     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  6694     ;   flags and acc set as though a long subtraction was done.
                +1  6695     ;*******************************
                +1  6696     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  6697     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  6698     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  6699     ;*******************************
29BF            +1  6700     lcmp:
29BF C3         +1  6701         clr c
29C0 EA         +1  6702         mov a,r2
29C1 9508       +1  6703         subb    a,8
29C3 700F       +1  6704         jnz done
29C5 EB         +1  6705         mov a,r3
29C6 9509       +1  6706         subb    a,9
29C8 7008       +1  6707         jnz done1
29CA EC         +1  6708         mov a,r4
29CB 950A       +1  6709         subb    a,10
29CD 7003       +1  6710         jnz done1
29CF ED         +1  6711         mov a,r5
29D0 950B       +1  6712         subb    a,11
29D2            +1  6713     done1:
29D2 C2D2       +1  6714         clr ov      ;overflow is significant only for top byte
29D4            +1  6715     done:
29D4 22         +1  6716         ret
                +1  6717     
                +1  6718     ;   Load long into r2-5 from [dptr]
                +1  6719     
29D5            +1  6720     ldc_long:
29D5 E583       +1  6721         mov a,dph       ;is it in on board memory
29D7 6010       +1  6722         jz  onboard     ;yes
29D9 E4         +1  6723         clr a
29DA 93         +1  6724         movc    a,@a+dptr
29DB FA         +1  6725         mov r2,a
29DC 7401       +1  6726         mov a,#1
29DE 93         +1  6727         movc    a,@a+dptr
29DF FB         +1  6728         mov r3,a
29E0 7402       +1  6729         mov a,#2
29E2 93         +1  6730         movc    a,@a+dptr
29E3 FC         +1  6731         mov r4,a
29E4 7403       +1  6732         mov a,#3
29E6 93         +1  6733         movc    a,@a+dptr
29E7 FD         +1  6734         mov r5,a
29E8 22         +1  6735         ret
29E9            +1  6736     onboard:
29E9 A882       +1  6737         mov r0,dpl
29EB E6         +1  6738         mov a,@r0
29EC FA         +1  6739         mov r2,a
29ED 08         +1  6740         inc r0
29EE E6         +1  6741         mov a,@r0
29EF FB         +1  6742         mov r3,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   108

29F0 08         +1  6743         inc r0
29F1 E6         +1  6744         mov a,@r0
29F2 FC         +1  6745         mov r4,a
29F3 08         +1  6746         inc r0
29F4 E6         +1  6747         mov a,@r0
29F5 FD         +1  6748         mov r5,a
29F6 22         +1  6749         ret
                +1  6750     
                +1  6751     ;**************************************
                +1  6752     ;загрузить ltemp...+3 из памяти программ
                +1  6753     ;mov    dptr,#CH5
                +1  6754     ;call   ldc_ltemp        ltemp <--5
                +1  6755     ;**************************************
29F7            +1  6756     ldc_ltemp:
29F7 E583       +1  6757         mov a,dph       ;is it in on board memory
29F9 6014       +1  6758         jz  oboard      ;yes
29FB E4         +1  6759         clr a
29FC 93         +1  6760         movc    a,@a+dptr
29FD F508       +1  6761         mov 8,a
29FF 7401       +1  6762         mov a,#1
2A01 93         +1  6763         movc    a,@a+dptr
2A02 F509       +1  6764         mov 9,a
2A04 7402       +1  6765         mov a,#2
2A06 93         +1  6766         movc    a,@a+dptr
2A07 F50A       +1  6767         mov 10,a
2A09 7403       +1  6768         mov a,#3
2A0B 93         +1  6769         movc    a,@a+dptr
2A0C F50B       +1  6770         mov 11,a
2A0E 22         +1  6771         ret
2A0F            +1  6772     oboard:
2A0F A882       +1  6773         mov r0,dpl
2A11 8608       +1  6774         mov 8,@r0
2A13 08         +1  6775         inc r0
2A14 8609       +1  6776         mov 9,@r0
2A16 08         +1  6777         inc r0
2A17 860A       +1  6778         mov 10,@r0
2A19 08         +1  6779         inc r0
2A1A 860B       +1  6780         mov 11,@r0
2A1C 22         +1  6781         ret
                +1  6782     
                +1  6783     ;*****************************
                +1  6784     ;mov    dptr,#k1
                +1  6785     ;call   ldx_long
                +1  6786     ;k1->r2..r5
                +1  6787     ;*****************************
                +1  6788     ;   Load long into r2-5 from [dptr]
                +1  6789     ;
                +1  6790     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
2A1D            +1  6791     ldx_long:
2A1D E583       +1  6792         mov a,dph       ;is it in on board memory
2A1F 6014       +1  6793         jz  onboar1        ;yes
2A21 C082       +1  6794         push    dpl
2A23 C083       +1  6795         push    dph
2A25 E0         +1  6796         movx    a,@dptr
2A26 FA         +1  6797         mov r2,a
2A27 A3         +1  6798         inc dptr
2A28 E0         +1  6799         movx    a,@dptr
2A29 FB         +1  6800         mov r3,a
2A2A A3         +1  6801         inc dptr
2A2B E0         +1  6802         movx    a,@dptr
2A2C FC         +1  6803         mov r4,a
2A2D A3         +1  6804         inc dptr
2A2E E0         +1  6805         movx    a,@dptr
2A2F FD         +1  6806         mov r5,a
2A30 D083       +1  6807         pop dph
2A32 D082       +1  6808         pop dpl
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   109

2A34 22         +1  6809         ret
2A35            +1  6810     onboar1:
2A35 A882       +1  6811         mov r0,dpl
2A37 E6         +1  6812         mov a,@r0
2A38 FA         +1  6813         mov r2,a
2A39 08         +1  6814         inc r0
2A3A E6         +1  6815         mov a,@r0
2A3B FB         +1  6816         mov r3,a
2A3C 08         +1  6817         inc r0
2A3D E6         +1  6818         mov a,@r0
2A3E FC         +1  6819         mov r4,a
2A3F 08         +1  6820         inc r0
2A40 E6         +1  6821         mov a,@r0
2A41 FD         +1  6822         mov r5,a
2A42 22         +1  6823         ret
                +1  6824     
                +1  6825     ;*********************************
                +1  6826     ;mov    dptr,#k2
                +1  6827     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  6828     ;**********************************
2A43            +1  6829     ldx_ltemp:
2A43 E583       +1  6830         mov a,dph       ;is it in on board memory
2A45 6010       +1  6831         jz  oboard1     ;yes
2A47 E0         +1  6832         movx    a,@dptr
2A48 F508       +1  6833         mov 8,a
2A4A A3         +1  6834         inc dptr
2A4B E0         +1  6835         movx    a,@dptr
2A4C F509       +1  6836         mov 9,a
2A4E A3         +1  6837         inc dptr
2A4F E0         +1  6838         movx    a,@dptr
2A50 F50A       +1  6839         mov 10,a
2A52 A3         +1  6840         inc dptr
2A53 E0         +1  6841         movx    a,@dptr
2A54 F50B       +1  6842         mov 11,a
2A56 22         +1  6843         ret
2A57            +1  6844     oboard1:
2A57 A882       +1  6845         mov r0,dpl
2A59 8608       +1  6846         mov 8,@r0
2A5B 08         +1  6847         inc r0
2A5C 8609       +1  6848         mov 9,@r0
2A5E 08         +1  6849         inc r0
2A5F 860A       +1  6850         mov 10,@r0
2A61 08         +1  6851         inc r0
2A62 860B       +1  6852         mov 11,@r0
2A64 22         +1  6853         ret
                +1  6854     ;   Long division routines for 8051
                +1  6855     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  6856     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  6857     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  6858     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  6859     ;   r1 must be saved by the caller.
                +1  6860     ;   This is long unsigned division.
                +1  6861     
                +1  6862     
                +1  6863     ;   Register usage:
                +1  6864     ;       r0 loop counter
                +1  6865     ;       xtemp (12-15) accumulates quotient
                +1  6866     ;       r5-r2 holds dividend
                +1  6867     ;       ltemp holds divisor
                +1  6868     
                +1  6869     ;************************************
                +1  6870     ;r2..r5-делимое
                +1  6871     ;ltemp..-делитель
                +1  6872     ;частное -r2..r5
                +1  6873     ;*************************************
2A65            +1  6874     divide:
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   110

2A65 E4         +1  6875         clr a
2A66 F8         +1  6876         mov r0,a        ;initialize count
2A67 F50C       +1  6877         mov xtemp,a     ;zero quotient
2A69 F50D       +1  6878         mov xtemp+1,a
2A6B F50E       +1  6879         mov xtemp+2,a
2A6D F50F       +1  6880         mov xtemp+3,a
2A6F ED         +1  6881         mov a,r5        ;check for zero dividend
2A70 4C         +1  6882         orl a,r4
2A71 4B         +1  6883         orl a,r3
2A72 4A         +1  6884         orl a,r2
2A73 600B       +1  6885         jz  jfinis
2A75 E508       +1  6886         mov a,ltemp     ;check for zero divisor
2A77 4509       +1  6887         orl a,ltemp+1
2A79 450A       +1  6888         orl a,ltemp+2
2A7B 450B       +1  6889         orl a,ltemp+3
2A7D 7037       +1  6890         jnz midl
2A7F 22         +1  6891         ret
                +1  6892     
2A80 020000   F +1  6893     jfinis: jmp finis
                +1  6894     
2A83            +1  6895     loops:
2A83 EA         +1  6896         mov a,r2
2A84 C3         +1  6897         clr c
2A85 9508       +1  6898         subb    a,ltemp+0   ;is divisor greater than dividend yet
2A87 4033       +1  6899         jc  yes     ;yes, go no further
2A89 7013       +1  6900         jnz no
2A8B EB         +1  6901         mov a,r3
2A8C 9509       +1  6902         subb    a,ltemp+1
2A8E 402C       +1  6903         jc  yes
2A90 700C       +1  6904         jnz no
2A92 EC         +1  6905         mov a,r4
2A93 950A       +1  6906         subb    a,ltemp+2
2A95 4025       +1  6907         jc  yes
2A97 7005       +1  6908         jnz no
2A99 ED         +1  6909         mov a,r5
2A9A 950B       +1  6910         subb    a,ltemp+3
2A9C 401E       +1  6911         jc  yes
2A9E            +1  6912     no:
2A9E E50B       +1  6913         mov a,ltemp+3   ;shift divisor up one bit
2AA0 250B       +1  6914         add a,ltemp+3
2AA2 F50B       +1  6915         mov ltemp+3,a
2AA4 E50A       +1  6916         mov a,ltemp+2
2AA6 350A       +1  6917         addc    a,ltemp+2
2AA8 F50A       +1  6918         mov ltemp+2,a
2AAA E509       +1  6919         mov a,ltemp+1
2AAC 3509       +1  6920         addc    a,ltemp+1
2AAE F509       +1  6921         mov ltemp+1,a
2AB0 E508       +1  6922         mov a,ltemp+0
2AB2 3508       +1  6923         addc    a,ltemp+0
2AB4 F508       +1  6924         mov ltemp+0,a
2AB6            +1  6925     midl:
2AB6 08         +1  6926         inc r0      ;increment count
2AB7 E508       +1  6927         mov a,ltemp+0   ;check for safe to shift some more
2AB9 30E7C7     +1  6928         jnb acc.7,loops  ;loop if top bit clear
2ABC            +1  6929     yes:
2ABC E508       +1  6930         mov a,ltemp+0
2ABE C3         +1  6931         clr c
2ABF 9A         +1  6932         subb    a,r2        ;can we subtract now?
2AC0 401A       +1  6933         jc  dosub       ;yes, go and do it
2AC2 7015       +1  6934         jnz nosub
2AC4 E509       +1  6935         mov a,ltemp+1
2AC6 9B         +1  6936         subb    a,r3
2AC7 4013       +1  6937         jc  dosub
2AC9 700E       +1  6938         jnz nosub
2ACB E50A       +1  6939         mov a,ltemp+2
2ACD 9C         +1  6940         subb    a,r4
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   111

2ACE 400C       +1  6941         jc  dosub
2AD0 7007       +1  6942         jnz nosub
2AD2 E50B       +1  6943         mov a,ltemp+3
2AD4 9D         +1  6944         subb    a,r5
2AD5 4005       +1  6945         jc  dosub
2AD7 6003       +1  6946         jz  dosub
2AD9            +1  6947     nosub:
2AD9 C3         +1  6948         clr c
2ADA 8012       +1  6949         sjmp    dosh
2ADC            +1  6950     dosub:
2ADC C3         +1  6951         clr c       ;subtract divisor from dividend
2ADD ED         +1  6952         mov a,r5
2ADE 950B       +1  6953         subb    a,ltemp+3
2AE0 FD         +1  6954         mov r5,a
2AE1 EC         +1  6955         mov a,r4
2AE2 950A       +1  6956         subb    a,ltemp+2
2AE4 FC         +1  6957         mov r4,a
2AE5 EB         +1  6958         mov a,r3
2AE6 9509       +1  6959         subb    a,ltemp+1
2AE8 FB         +1  6960         mov r3,a
2AE9 EA         +1  6961         mov a,r2
2AEA 9508       +1  6962         subb    a,ltemp+0
2AEC FA         +1  6963         mov r2,a
2AED D3         +1  6964         setb    c       ;now set bit for quotient
2AEE            +1  6965     dosh:
2AEE E50F       +1  6966         mov a,xtemp+3
2AF0 33         +1  6967         rlc a
2AF1 F50F       +1  6968         mov xtemp+3,a
2AF3 E50E       +1  6969         mov a,xtemp+2
2AF5 33         +1  6970         rlc a
2AF6 F50E       +1  6971         mov xtemp+2,a
2AF8 E50D       +1  6972         mov a,xtemp+1
2AFA 33         +1  6973         rlc a
2AFB F50D       +1  6974         mov xtemp+1,a
2AFD E50C       +1  6975         mov a,xtemp+0
2AFF 33         +1  6976         rlc a
2B00 F50C       +1  6977         mov xtemp+0,a
2B02 E508       +1  6978         mov a,ltemp+0       ;shift divisor down
2B04 C3         +1  6979         clr c
2B05 13         +1  6980         rrc a
2B06 F508       +1  6981         mov ltemp+0,a
2B08 E509       +1  6982         mov a,ltemp+1
2B0A 13         +1  6983         rrc a
2B0B F509       +1  6984         mov ltemp+1,a
2B0D E50A       +1  6985         mov a,ltemp+2
2B0F 13         +1  6986         rrc a
2B10 F50A       +1  6987         mov ltemp+2,a
2B12 E50B       +1  6988         mov a,ltemp+3
2B14 13         +1  6989         rrc a
2B15 F50B       +1  6990         mov ltemp+3,a
                +1  6991     
2B17 D8A3       +1  6992         djnz    r0,yes      ;and continue with the rest
                +1  6993     
2B19            +1  6994     finis:
2B19 8D0B       +1  6995         mov ltemp+3,r5
2B1B 8C0A       +1  6996         mov ltemp+2,r4
2B1D 8B09       +1  6997         mov ltemp+1,r3
2B1F 8A08       +1  6998         mov ltemp+0,r2
2B21 AD0F       +1  6999         mov r5,xtemp+3
2B23 AC0E       +1  7000         mov r4,xtemp+2
2B25 AB0D       +1  7001         mov r3,xtemp+1
2B27 AA0C       +1  7002         mov r2,xtemp+0
2B29 22         +1  7003         ret         ;and return with the satisfaction of a job well done
                +1  7004     
                +1  7005     
                +1  7006     ;   Long multiplication
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   112

                +1  7007     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  7008     ;   other in ltemp. It really doesn't matter which one is where.
                +1  7009     
                +1  7010     ;**********************************
                +1  7011     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  7012     ;ст  мл
                +1  7013     ;**********************************
2B2A            +1  7014     llmul:
2B2A            +1  7015     almul:
2B2A            +1  7016     lmul:
2B2A ED         +1  7017         mov a,r5        ;low order byte
2B2B 850BF0     +1  7018         mov b,ltemp+3       ;times low order byte
2B2E A4         +1  7019         mul ab
2B2F F50F       +1  7020         mov xtemp+3,a       ;store low
2B31 85F00E     +1  7021         mov xtemp+2,b   ;and high
2B34 ED         +1  7022         mov a,r5        ;low order
2B35 850AF0     +1  7023         mov b,ltemp+2   ;times next
2B38 A4         +1  7024         mul ab
2B39 250E       +1  7025         add a,xtemp+2   ;add in
2B3B F50E       +1  7026         mov xtemp+2,a
2B3D E5F0       +1  7027         mov a,b
2B3F 3400       +1  7028         addc    a,#0
2B41 F50D       +1  7029         mov xtemp+1,a
2B43 ED         +1  7030         mov a,r5
2B44 8509F0     +1  7031         mov b,ltemp+1
2B47 A4         +1  7032         mul ab
2B48 250D       +1  7033         add a,xtemp+1
2B4A F50D       +1  7034         mov xtemp+1,a
2B4C E5F0       +1  7035         mov a,b
2B4E 3400       +1  7036         addc    a,#0
2B50 F50C       +1  7037         mov xtemp+0,a
2B52 ED         +1  7038         mov a,r5
2B53 8508F0     +1  7039         mov b,ltemp+0
2B56 A4         +1  7040         mul ab
2B57 250C       +1  7041         add a,xtemp+0
2B59 F50C       +1  7042         mov xtemp+0,a
2B5B EC         +1  7043         mov a,r4
2B5C 850BF0     +1  7044         mov b,ltemp+3
2B5F A4         +1  7045         mul ab
2B60 250E       +1  7046         add a,xtemp+2
2B62 F50E       +1  7047         mov xtemp+2,a
2B64 E5F0       +1  7048         mov a,b
2B66 350D       +1  7049         addc    a,xtemp+1
2B68 F50D       +1  7050         mov xtemp+1,a
2B6A E50C       +1  7051         mov a,xtemp+0
2B6C 3400       +1  7052         addc    a,#0
2B6E F50C       +1  7053         mov xtemp+0,a
2B70 EC         +1  7054         mov a,r4
2B71 850AF0     +1  7055         mov b,ltemp+2
2B74 A4         +1  7056         mul ab
2B75 250D       +1  7057         add a,xtemp+1
2B77 F50D       +1  7058         mov xtemp+1,a
2B79 E5F0       +1  7059         mov a,b
2B7B 350C       +1  7060         addc    a,xtemp+0
2B7D F50C       +1  7061         mov xtemp+0,a
2B7F EC         +1  7062         mov a,r4
2B80 8509F0     +1  7063         mov b,ltemp+1
2B83 A4         +1  7064         mul ab
2B84 250C       +1  7065         add a,xtemp+0
2B86 F50C       +1  7066         mov xtemp+0,a
                +1  7067     
2B88 EB         +1  7068         mov a,r3
2B89 850BF0     +1  7069         mov b,ltemp+3
2B8C A4         +1  7070         mul ab
2B8D 250D       +1  7071         add a,xtemp+1
2B8F F50D       +1  7072         mov xtemp+1,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   113

2B91 E5F0       +1  7073         mov a,b
2B93 350C       +1  7074         addc    a,xtemp+0
2B95 F50C       +1  7075         mov xtemp+0,a
2B97 EB         +1  7076         mov a,r3
2B98 850AF0     +1  7077         mov b,ltemp+2
2B9B A4         +1  7078         mul ab
2B9C 250C       +1  7079         add a,xtemp+0
2B9E F50C       +1  7080         mov xtemp+0,a
                +1  7081     
2BA0 EA         +1  7082         mov a,r2
2BA1 850BF0     +1  7083         mov b,ltemp+3
2BA4 A4         +1  7084         mul ab
2BA5 250C       +1  7085         add a,xtemp+0
2BA7 FA         +1  7086         mov r2,a
2BA8 AB0D       +1  7087         mov r3,xtemp+1
2BAA AC0E       +1  7088         mov r4,xtemp+2
2BAC AD0F       +1  7089         mov r5,xtemp+3
                +1  7090     
2BAE 22         +1  7091         ret         ;all done
                +1  7092     ;******************************
                +1  7093     ;из содержимого  r2-r5  вычесть
                +1  7094     ;содержимое          ltemp..ltemp+3
                +1  7095     ;******************************
2BAF            +1  7096     llsub:
2BAF            +1  7097      lsub:
2BAF ED         +1  7098         mov a,r5
2BB0 C3         +1  7099         clr c
2BB1 950B       +1  7100         subb    a,11
2BB3 FD         +1  7101         mov r5,a
2BB4 EC         +1  7102         mov a,r4
2BB5 950A       +1  7103         subb    a,10
2BB7 FC         +1  7104         mov r4,a
2BB8 EB         +1  7105         mov a,r3
2BB9 9509       +1  7106         subb    a,9
2BBB FB         +1  7107         mov r3,a
2BBC EA         +1  7108         mov a,r2
2BBD 9508       +1  7109         subb    a,8
2BBF FA         +1  7110         mov r2,a
2BC0 22         +1  7111         ret
                +1  7112     
                +1  7113     ;***********************************************
                +1  7114     ;                                                      ст мл
                +1  7115     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7116     ;  r0- адрес младшего байта !!!
                +1  7117     ;результат- r2..r5
                +1  7118     ;***********************************************
                +1  7119     
2BC1 C3         +1  7120     ladd:    clr       c
2BC2 ED         +1  7121          mov       a,r5
2BC3 26         +1  7122          add       a,@r0
2BC4 FD         +1  7123          mov       r5,a
2BC5 18         +1  7124          dec       r0
2BC6 EC         +1  7125          mov       a,r4
2BC7 36         +1  7126          addc      a,@r0
2BC8 FC         +1  7127          mov       r4,a
2BC9 18         +1  7128          dec       r0
2BCA EB         +1  7129          mov       a,r3
2BCB 36         +1  7130          addc      a,@r0
2BCC FB         +1  7131          mov       r3,a
2BCD 18         +1  7132          dec       r0
2BCE EA         +1  7133          mov       a,r2
2BCF 36         +1  7134          addc      a,@r0
2BD0 FA         +1  7135          mov       r2,a
2BD1 22         +1  7136          ret
                +1  7137     ;***********************************************
                +1  7138     ;                                                      ст мл
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   114

                +1  7139     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7140     ;  r0- адрес младшего байта !!!
                +1  7141     ;результат- r2..r5
                +1  7142     ;***********************************************
                +1  7143     
2BD2 C3         +1  7144     laddx:    clr       c
2BD3 E2         +1  7145                                             movx            a,@r0
2BD4 2D         +1  7146                                             add                     a,r5
2BD5 FD         +1  7147               mov     r5,a
2BD6 18         +1  7148                             dec     r0
2BD7 E2         +1  7149                             movx    a,@r0
2BD8 3C         +1  7150                             addc    a,r4
2BD9 FC         +1  7151                             mov     r4,a
2BDA 18         +1  7152                             dec     r0
2BDB E2         +1  7153                             movx    a,@r0
2BDC 3B         +1  7154                             addc    a,r3
2BDD FB         +1  7155                             mov     r3,a
2BDE 18         +1  7156                             dec     r0
2BDF E2         +1  7157                             movx    a,@r0
2BE0 3A         +1  7158                             addc    a,r2
2BE1 FA         +1  7159                             mov       r2,a
2BE2 22         +1  7160                             ret
                +1  7161     
                +1  7162     ;***********************************************
                +1  7163     ;                                                      ст мл
                +1  7164     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7165     ;  dptr- адрес младшего байта !!!
                +1  7166     ;результат- r2..r5
                +1  7167     ;***********************************************
                +1  7168     
2BE3 C3         +1  7169     addx:    clr       c
2BE4 E0         +1  7170                                             movx            a,@dptr
2BE5 2D         +1  7171                                             add                     a,r5
2BE6 FD         +1  7172               mov     r5,a
2BE7 120000   F +1  7173                             call            dedptr;dec     dptr
2BEA E0         +1  7174                             movx    a,@dptr
2BEB 3C         +1  7175                             addc    a,r4
2BEC FC         +1  7176                             mov     r4,a
2BED 120000   F +1  7177                             call            dedptr;dec     dptr
2BF0 E0         +1  7178                             movx    a,@dptr
2BF1 3B         +1  7179                             addc    a,r3
2BF2 FB         +1  7180                             mov     r3,a
2BF3 120000   F +1  7181                             call            dedptr;dec     dptr
2BF6 E0         +1  7182                             movx    a,@dptr
2BF7 3A         +1  7183                             addc    a,r2
2BF8 FA         +1  7184                             mov       r2,a
2BF9 22         +1  7185                             ret
                +1  7186     
2BFA C0D0       +1  7187     dedptr:         push    psw
2BFC C3         +1  7188                                             clr             c
2BFD E582       +1  7189                                             mov             a,dpl
2BFF 9401       +1  7190                                             subb    a,#1
2C01 F582       +1  7191                                             mov             dpl,a
2C03 E583       +1  7192                                             mov             a,dph
2C05 9400       +1  7193                                             subb    a,#0
2C07 F583       +1  7194                                             mov             dph,a
2C09 D0D0       +1  7195                                             pop             psw
2C0B 22         +1  7196                                             ret
                    7197     
                    7198     ;$include (d:\amp\floatm.asm)
                +1  7199     ;       Copyright (C) 1988 HI-TECH Software
                +1  7200     
                +1  7201     ;       Single Precision Floating point arithmetic routines for 8051
                +1  7202     
                +1  7203     ;       The format of floating point numbers is as follows:
                +1  7204     
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   115

                +1  7205     ;       -----------------
                +1  7206     ;       *     sign      *  1 bit
                +1  7207     ;       -----------------
                +1  7208     ;       *   exponent    *  8 bits
                +1  7209     ;       -----------------
                +1  7210     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  7211     ;       -----------------
                +1  7212     
                +1  7213     
                +1  7214     ;       As usual for the 8051 the memory layout has the most significant
                +1  7215     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  7216     ;       lowest address.
                +1  7217     
                +1  7218     ;       Calling conventions:
                +1  7219     
                +1  7220     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  7221     ;
                +1  7222     ;       Return value is in r2-r5
                +1  7223     
                +1  7224     ;       Naming conventions: A routine name is constructed by
                +1  7225     
                +1  7226     ;             ASOP
                +1  7227     
                +1  7228     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  7229     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  7230     ;       Conversion routines are named
                +1  7231     
                +1  7232     ;               AStof
                +1  7233     
                +1  7234     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  7235     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  7236     ;       Conversion from float to integer is ftol.
                +1  7237     
                +1  7238     ;               .ORG  5000h
                +1  7239     ;               .CODE
                +1  7240     ;       seg     c_text
                +1  7241     
                +1  7242     ;;      $MOD812
----            +1  7243             CSEG
                +1  7244             ;ORG 1000h
                +1  7245     
                +1  7246                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  7247             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  7248     
                +1  7249     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  7250     ;       macros
                +1  7251     
                +1  7252     saveregs        macro
                +1  7253             push    7
                +1  7254             push    6
                +1  7255             push    1
                +1  7256             push    0
                +1  7257             endm
                +1  7258     
                +1  7259     restregs        macro
                +1  7260             pop     0
                +1  7261             pop     1
                +1  7262             pop     6
                +1  7263             pop     7
                +1  7264             endm
                +1  7265     
                +1  7266     ;addr   
                +1  7267     dan     macro   pad
                +1  7268             mov     a,r5
                +1  7269             add     a,pad+3
                +1  7270             mov     pad+3,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   116

                +1  7271             mov     a,pad+2
                +1  7272             addc    a,r4
                +1  7273             mov     pad+2,a
                +1  7274             mov     a,pad+1
                +1  7275             addc    a,r3
                +1  7276             mov     pad+1,a
                +1  7277             mov     a,pad+0
                +1  7278             addc    a,r2
                +1  7279             mov     pad,a
                +1  7280             endm
                +1  7281     
                +1  7282     addl    macro  addr
                +1  7283             mov     a,r5
                +1  7284             add     a,addr+3
                +1  7285             mov     r5,a
                +1  7286             mov     a,addr+2
                +1  7287             addc    a,r4
                +1  7288             mov     r4,a
                +1  7289             mov     a,addr+1
                +1  7290             addc    a,r3
                +1  7291             mov     r3,a
                +1  7292             mov     a,addr+0
                +1  7293             addc    a,r2
                +1  7294             mov     r2,a
                +1  7295             endm
                +1  7296     
                +1  7297     
                +1  7298     add1    macro
                +1  7299             mov     a,r5
                +1  7300             add     a,#1
                +1  7301             mov     r5,a
                +1  7302             clr     a
                +1  7303             addc    a,r4
                +1  7304             mov     r4,a
                +1  7305             clr     a
                +1  7306             addc    a,r3
                +1  7307             mov     r3,a
                +1  7308             clr     a
                +1  7309             addc    a,r2
                +1  7310             mov     r2,a
                +1  7311             endm
                +1  7312     
                +1  7313     shfdn   macro  addr
                +1  7314             clr     c
                +1  7315             mov     a,addr
                +1  7316             rrc     a
                +1  7317             mov     addr,a
                +1  7318             mov     a,addr+1
                +1  7319             rrc     a
                +1  7320             mov     addr+1,a
                +1  7321             mov     a,addr+2
                +1  7322             rrc     a
                +1  7323             mov     addr+2,a
                +1  7324             mov     a,addr+3
                +1  7325             rrc     a
                +1  7326             mov     addr+3,a
                +1  7327             endm
                +1  7328     
                +1  7329     shfup   macro  addr
                +1  7330             clr     c
                +1  7331             mov     a,addr+3
                +1  7332             rlc     a
                +1  7333             mov     addr+3,a
                +1  7334             mov     a,addr+2
                +1  7335             rlc     a
                +1  7336             mov     addr+2,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   117

                +1  7337             mov     a,addr+1
                +1  7338             rlc     a
                +1  7339             mov     addr+1,a
                +1  7340             mov     a,addr
                +1  7341             rlc     a
                +1  7342             mov     addr,a
                +1  7343             endm
                +1  7344     
                +1  7345     rshift  macro
                +1  7346             clr     c
                +1  7347             mov     a,r2
                +1  7348             rrc     a
                +1  7349             mov     r2,a
                +1  7350             mov     a,r3
                +1  7351             rrc     a
                +1  7352             mov     r3,a
                +1  7353             mov     a,r4
                +1  7354             rrc     a
                +1  7355             mov     r4,a
                +1  7356             mov     a,r5
                +1  7357             rrc     a
                +1  7358             mov     r5,a
                +1  7359             endm
                +1  7360     rshift1 macro
                +1  7361             setb    c
                +1  7362             mov     a,r2
                +1  7363             rrc     a
                +1  7364             mov     r2,a
                +1  7365             mov     a,r3
                +1  7366             rrc     a
                +1  7367             mov     r3,a
                +1  7368             mov     a,r4
                +1  7369             rrc     a
                +1  7370             mov     r4,a
                +1  7371             mov     a,r5
                +1  7372             rrc     a
                +1  7373             mov     r5,a
                +1  7374             endm
                +1  7375     
                +1  7376     
                +1  7377     lshift  macro
                +1  7378             mov     a,r5
                +1  7379             rlc     a
                +1  7380             mov     r5,a
                +1  7381             mov     a,r4
                +1  7382             rlc     a
                +1  7383             mov     r4,a
                +1  7384             mov     a,r3
                +1  7385             rlc     a
                +1  7386             mov     r3,a
                +1  7387             mov     a,r2
                +1  7388             rlc     a
                +1  7389             mov     r2,a
                +1  7390             endm
                +1  7391     
                +1  7392     neg1    macro
                +1  7393             clr     c
                +1  7394             clr     a
                +1  7395             subb    a,r5
                +1  7396             mov     r5,a
                +1  7397             clr     a
                +1  7398             subb    a,r4
                +1  7399             mov     r4,a
                +1  7400             clr     a
                +1  7401             subb    a,r3
                +1  7402             mov     r3,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   118

                +1  7403             clr     a
                +1  7404             subb    a,r2
                +1  7405             mov     r2,a
                +1  7406             endm
                +1  7407     
                +1  7408     negm    macro  addr
                +1  7409             clr     c
                +1  7410             clr     a
                +1  7411             subb    a,addr+3
                +1  7412             mov     addr+3,a
                +1  7413             clr     a
                +1  7414             subb    a,addr+2
                +1  7415             mov     addr+2,a
                +1  7416             clr     a
                +1  7417             subb    a,addr+1
                +1  7418             mov     addr+1,a
                +1  7419             clr     a
                +1  7420             subb    a,addr
                +1  7421             mov     addr,a
                +1  7422             endm
                +1  7423     
                +1  7424     copytor macro  addr
                +1  7425             mov     r2,addr
                +1  7426             mov     r3,addr+1
                +1  7427             mov     r4,addr+2
                +1  7428             mov     r5,addr+3
                +1  7429             endm
                +1  7430     
                +1  7431     
                +1  7432     copyrto macro  addr
                +1  7433             mov     addr,r2
                +1  7434             mov     addr+1,r3
                +1  7435             mov     addr+2,r4
                +1  7436             mov     addr+3,r5
                +1  7437             endm
                +1  7438     
                +1  7439     
                +1  7440     ;       Internal representation: in this set of routines a floating number
                +1  7441     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  7442     
                +1  7443     ;       Stack offset values
                +1  7444     ;ltemp   equ     28h
                +1  7445     
  0006          +1  7446     cntr    equ     6               ;r6 is the counter
  0007          +1  7447     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  7448     exp1    equ     0               ;exponent 1 in r0
  0002          +1  7449     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  7450     exp2    equ     1               ;exponent 1 in r1
  0008          +1  7451     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  7452     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  7453     
                +1  7454     
                +1  7455     
                +1  7456     
                +1  7457     
                +1  7458     ;DECSIZE EQU     10
                +1  7459     ;NUMSIZE EQU     4
                +1  7460     ;RR4     EQU     4
                +1  7461     ;RR5     EQU     5
                +1  7462     
                +1  7463     ;       unpack1 - unpacks the left operand
                +1  7464     
009E            +1  7465     unpack1:
009E EA         +1  7466             mov     a,r2            ;get sign
009F 5480       +1  7467             anl     a,#80h
00A1 530740     +1  7468             anl     sign,#40h       ;clear other bits
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   119

00A4 4207       +1  7469             orl     sign,a          ;store sign
00A6 EB         +1  7470             mov     a,r3            ;get lsb of exponent
00A7 33         +1  7471             rlc     a               ;rotate into carry
00A8 EA         +1  7472             mov     a,r2            ;get rest of exponent
00A9 33         +1  7473             rlc     a               ;and make it 8 bits
00AA F8         +1  7474             mov     r0,a            ;store it
00AB 6006       +1  7475             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  7476             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  7477             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  7478             ret
00B3            +1  7479     zer1:
00B3 E4         +1  7480             clr     a
00B4 FA         +1  7481             mov     r2,a
00B5 FB         +1  7482             mov     r3,a
00B6 FC         +1  7483             mov     r4,a
00B7 FD         +1  7484             mov     r5,a            ;zero mantissa
00B8 F8         +1  7485             mov     r0,a            ;zero exponent
00B9 22         +1  7486             ret
                +1  7487     
                +1  7488     ;       unpack2 - unpacks right operand
                +1  7489     
00BA            +1  7490     unpack2:
00BA E508       +1  7491             mov     a,ltemp         ;get sign
00BC 13         +1  7492             rrc     a               ;shift down
00BD 5440       +1  7493             anl     a,#40h          ;mask out sign
00BF 530780     +1  7494             anl     sign,#80h       ;clear old bit
00C2 4207       +1  7495             orl     sign,a
00C4 E509       +1  7496             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  7497             rlc     a               ;rotate into carry
00C7 E508       +1  7498             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  7499             rlc     a               ;and make it 8 bits
00CA F9         +1  7500             mov     r1,a            ;store it
00CB 6007       +1  7501             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  7502             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  7503             mov     mant2,#0        ;clear upper byte
00D3 22         +1  7504             ret
00D4            +1  7505     zer2:
00D4 E4         +1  7506             clr     a
00D5 F508       +1  7507             mov     ltemp,a
00D7 F509       +1  7508             mov     ltemp+1,a
00D9 F50A       +1  7509             mov     ltemp+2,a
00DB F50B       +1  7510             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  7511             ret
                +1  7512     
                +1  7513     ;       pack1 - put operand 1 back into float format
                +1  7514     
00DE            +1  7515     pack1:
00DE E8         +1  7516             mov     a,r0            ;get exponent
00DF C3         +1  7517             clr     c
00E0 13         +1  7518             rrc     a               ;shift down 1 bit
00E1 530780     +1  7519             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  7520             orl     a,r7            ;or in sign bit
00E5 FA         +1  7521             mov     r2,a            ;store
00E6 E8         +1  7522             mov     a,r0            ;get other bit
00E7 03         +1  7523             rr      a               ;rotate into hi bit
00E8 5480       +1  7524             anl     a,#80h          ;mask
00EA 53037F     +1  7525             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  7526             orl     mant1+1,a       ;put in
00EF 22         +1  7527             ret
                +1  7528     
                +1  7529     
                +1  7530     ;       norm1 - normalize the unpacked value in 1
                +1  7531     
00F0            +1  7532     norm1:
00F0 E8         +1  7533             mov     a,r0            ;get exponent
00F1 60C0       +1  7534             jz      zer1            ;zero the mantissa if so
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   120

00F3 EA         +1  7535             mov     a,r2            ;get hi byte
00F4 6023       +1  7536             jz      norup           ;zero, so shift up if anything
00F6            +1  7537     nordn:
00F6 EA         +1  7538             mov     a,r2            ;get hi byte
00F7 B4010D     +1  7539             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  7540+3           add1                    ;add in a rounding bit
00FA ED         +1  7541+1           mov     a,r5
00FB 2401       +1  7542+1           add     a,#1
00FD FD         +1  7543+1           mov     r5,a
00FE E4         +1  7544+1           clr     a
00FF 3C         +1  7545+1           addc    a,r4
0100 FC         +1  7546+1           mov     r4,a
0101 E4         +1  7547+1           clr     a
0102 3B         +1  7548+1           addc    a,r3
0103 FB         +1  7549+1           mov     r3,a
0104 E4         +1  7550+1           clr     a
0105 3A         +1  7551+1           addc    a,r2
0106 FA         +1  7552+1           mov     r2,a
0107            +1  7553     nordn1:
                +1  7554+3           rshift                  ;shift down 1 bit
0107 C3         +1  7555+1           clr     c
0108 EA         +1  7556+1           mov     a,r2
0109 13         +1  7557+1           rrc     a
010A FA         +1  7558+1           mov     r2,a
010B EB         +1  7559+1           mov     a,r3
010C 13         +1  7560+1           rrc     a
010D FB         +1  7561+1           mov     r3,a
010E EC         +1  7562+1           mov     a,r4
010F 13         +1  7563+1           rrc     a
0110 FC         +1  7564+1           mov     r4,a
0111 ED         +1  7565+1           mov     a,r5
0112 13         +1  7566+1           rrc     a
0113 FD         +1  7567+1           mov     r5,a
0114 08         +1  7568             inc     r0              ;adjust exponent
0115 EA         +1  7569             mov     a,r2            ;test high byte
0116 70DE       +1  7570             jnz     nordn           ;loop
0118 22         +1  7571             ret                     ;done
                +1  7572     
0119            +1  7573     norup:
0119 4B         +1  7574             orl     a,r3
011A 4C         +1  7575             orl     a,r4
011B 4D         +1  7576             orl     a,r5            ;test for zero mantissa
011C 6095       +1  7577             jz      zer1            ;it is - make it true zero
011E            +1  7578     norup1:
011E EB         +1  7579             mov     a,r3            ;get mantissa byte
011F 20E710     +1  7580             jb      acc.7,norup2    ;jump if set
0122 C3         +1  7581             clr     c
                +1  7582+3           lshift                  ;shift mantissa up
0123 ED         +1  7583+1           mov     a,r5
0124 33         +1  7584+1           rlc     a
0125 FD         +1  7585+1           mov     r5,a
0126 EC         +1  7586+1           mov     a,r4
0127 33         +1  7587+1           rlc     a
0128 FC         +1  7588+1           mov     r4,a
0129 EB         +1  7589+1           mov     a,r3
012A 33         +1  7590+1           rlc     a
012B FB         +1  7591+1           mov     r3,a
012C EA         +1  7592+1           mov     a,r2
012D 33         +1  7593+1           rlc     a
012E FA         +1  7594+1           mov     r2,a
012F 18         +1  7595             dec     r0              ;adjust exponent
0130 80EC       +1  7596             jmp     norup1
0132            +1  7597     norup2:
0132 22         +1  7598             ret                     ;finito
                +1  7599     
                +1  7600     
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   121

                +1  7601     ;       fpdenorm - denormalize one of the two operands so that their
                +1  7602     ;       exponents are equal. This requires the smaller number to have
                +1  7603     ;       its exponent incremented and its mantissa shifted right.
                +1  7604     
0133            +1  7605     denorm:
0133 E8         +1  7606             mov     a,r0
0134 C3         +1  7607             clr     c
0135 99         +1  7608             subb    a,r1            ;compare exponents
0136 5029       +1  7609             jnc     up2a            ;shift operand 2
0138            +1  7610     up1:
0138 08         +1  7611             inc     r0              ;increment exponent
                +1  7612+3           rshift                  ;shift mantissa down
0139 C3         +1  7613+1           clr     c
013A EA         +1  7614+1           mov     a,r2
013B 13         +1  7615+1           rrc     a
013C FA         +1  7616+1           mov     r2,a
013D EB         +1  7617+1           mov     a,r3
013E 13         +1  7618+1           rrc     a
013F FB         +1  7619+1           mov     r3,a
0140 EC         +1  7620+1           mov     a,r4
0141 13         +1  7621+1           rrc     a
0142 FC         +1  7622+1           mov     r4,a
0143 ED         +1  7623+1           mov     a,r5
0144 13         +1  7624+1           rrc     a
0145 FD         +1  7625+1           mov     r5,a
0146 E8         +1  7626             mov     a,r0
0147 B501EE     +1  7627             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  7628             ret
                +1  7629     
014B            +1  7630     up2:
014B 09         +1  7631             inc     r1              ;increment exponent 2
                +1  7632+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  7633+1           clr     c
014D E508       +1  7634+1           mov     a,mant2
014F 13         +1  7635+1           rrc     a
0150 F508       +1  7636+1           mov     mant2,a
0152 E509       +1  7637+1           mov     a,mant2+1
0154 13         +1  7638+1           rrc     a
0155 F509       +1  7639+1           mov     mant2+1,a
0157 E50A       +1  7640+1           mov     a,mant2+2
0159 13         +1  7641+1           rrc     a
015A F50A       +1  7642+1           mov     mant2+2,a
015C E50B       +1  7643+1           mov     a,mant2+3
015E 13         +1  7644+1           rrc     a
015F F50B       +1  7645+1           mov     mant2+3,a
0161            +1  7646     up2a:
0161 E8         +1  7647             mov     a,r0            ;compare exponents
0162 B501E6     +1  7648             cjne    a,exp2,up2
0165 22         +1  7649             ret                     ;all done
                +1  7650     ;------------------------------------------------------------------
                +1  7651     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  7652     
0166            +1  7653     fladd:
                +1  7654+3           saveregs
0166 C007       +1  7655+1           push    7
0168 C006       +1  7656+1           push    6
016A C001       +1  7657+1           push    1
016C C000       +1  7658+1           push    0
016E 119E       +1  7659             call    unpack1
0170 11BA       +1  7660             call    unpack2
0172 3133       +1  7661             call    denorm
0174 E507       +1  7662             mov     a,sign
0176 30E70D     +1  7663             jnb     acc.7,ok1       ;test left sign
                +1  7664+3           neg1                    ;negate op1
0179 C3         +1  7665+1           clr     c
017A E4         +1  7666+1           clr     a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   122

017B 9D         +1  7667+1           subb    a,r5
017C FD         +1  7668+1           mov     r5,a
017D E4         +1  7669+1           clr     a
017E 9C         +1  7670+1           subb    a,r4
017F FC         +1  7671+1           mov     r4,a
0180 E4         +1  7672+1           clr     a
0181 9B         +1  7673+1           subb    a,r3
0182 FB         +1  7674+1           mov     r3,a
0183 E4         +1  7675+1           clr     a
0184 9A         +1  7676+1           subb    a,r2
0185 FA         +1  7677+1           mov     r2,a
0186            +1  7678     ok1:
0186 E507       +1  7679             mov     a,sign
0188 30E615     +1  7680             jnb     acc.6,ok2       ;test right sign
                +1  7681+3           negm    mant2           ;negate op2
018B C3         +1  7682+1           clr     c
018C E4         +1  7683+1           clr     a
018D 950B       +1  7684+1           subb    a,mant2+3
018F F50B       +1  7685+1           mov     mant2+3,a
0191 E4         +1  7686+1           clr     a
0192 950A       +1  7687+1           subb    a,mant2+2
0194 F50A       +1  7688+1           mov     mant2+2,a
0196 E4         +1  7689+1           clr     a
0197 9509       +1  7690+1           subb    a,mant2+1
0199 F509       +1  7691+1           mov     mant2+1,a
019B E4         +1  7692+1           clr     a
019C 9508       +1  7693+1           subb    a,mant2
019E F508       +1  7694+1           mov     mant2,a
01A0            +1  7695     ok2:
                +1  7696+3           addl    mant2           ;add mantissas
01A0 ED         +1  7697+1           mov     a,r5
01A1 250B       +1  7698+1           add     a,mant2+3
01A3 FD         +1  7699+1           mov     r5,a
01A4 E50A       +1  7700+1           mov     a,mant2+2
01A6 3C         +1  7701+1           addc    a,r4
01A7 FC         +1  7702+1           mov     r4,a
01A8 E509       +1  7703+1           mov     a,mant2+1
01AA 3B         +1  7704+1           addc    a,r3
01AB FB         +1  7705+1           mov     r3,a
01AC E508       +1  7706+1           mov     a,mant2+0
01AE 3A         +1  7707+1           addc    a,r2
01AF FA         +1  7708+1           mov     r2,a
01B0 E4         +1  7709             clr     a
01B1 FF         +1  7710             mov     r7,a            ;clear sign
01B2 EA         +1  7711             mov     a,r2            ;get sign of result
01B3 30E70E     +1  7712             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  7713             mov     r7,a            ;store sign
                +1  7714+3           neg1                    ;negate mantissa
01B7 C3         +1  7715+1           clr     c
01B8 E4         +1  7716+1           clr     a
01B9 9D         +1  7717+1           subb    a,r5
01BA FD         +1  7718+1           mov     r5,a
01BB E4         +1  7719+1           clr     a
01BC 9C         +1  7720+1           subb    a,r4
01BD FC         +1  7721+1           mov     r4,a
01BE E4         +1  7722+1           clr     a
01BF 9B         +1  7723+1           subb    a,r3
01C0 FB         +1  7724+1           mov     r3,a
01C1 E4         +1  7725+1           clr     a
01C2 9A         +1  7726+1           subb    a,r2
01C3 FA         +1  7727+1           mov     r2,a
01C4            +1  7728     ok3:
01C4 11F0       +1  7729             call    norm1
01C6 11DE       +1  7730             call    pack1           ;pack normalized result
                +1  7731+3           restregs                ;and return
01C8 D000       +1  7732+1           pop     0
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   123

01CA D001       +1  7733+1           pop     1
01CC D006       +1  7734+1           pop     6
01CE D007       +1  7735+1           pop     7
01D0 22         +1  7736             ret
                +1  7737     ;-------------------------------------------------------------
                +1  7738     ;       Subtract the number ltemp from the number in r2-r5
                +1  7739     
01D1            +1  7740     flsub:
01D1 630880     +1  7741             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  7742             jmp     fladd           ;and add!
                +1  7743     
                +1  7744     ;================================================================
                +1  7745     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  7746     
01D6            +1  7747     flcmp:
01D6 EA         +1  7748            mov     a,r2            ;get sign of left
01D7 6508       +1  7749            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  7750            jnb     acc.7,cexp      ;same, go check exponent
                +1  7751     ;ifdef SMALL_MODEL
01DC EA         +1  7752             mov     a,r2            ;get sign of left again
01DD 33         +1  7753             rlc     a
01DE 5001       +1  7754             jnc     flout
                +1  7755     ;endif
01E0 D3         +1  7756             setb    c
01E1 22         +1  7757     flout:          ret                    ;return with acc < 0
                +1  7758     
01E2            +1  7759     cexp:
01E2 C3         +1  7760            clr     c
01E3 EA         +1  7761            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  7762            subb    a,ltemp
01E6 7010       +1  7763            jnz     fnd
01E8 EB         +1  7764            mov     a,r3
01E9 9509       +1  7765            subb    a,ltemp+1
01EB 700B       +1  7766            jnz     fnd
01ED EC         +1  7767            mov     a,r4
01EE 950A       +1  7768            subb    a,ltemp+2
01F0 7006       +1  7769            jnz     fnd
01F2 ED         +1  7770            mov     a,r5
01F3 950B       +1  7771            subb    a,ltemp+3
01F5 7001       +1  7772            jnz     fnd
01F7            +1  7773     cdone:
01F7 22         +1  7774            ret                     ;return with acc == 0
01F8            +1  7775     fnd:
01F8 8AF0       +1  7776           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  7777          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  7778            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  7779                         orl         a,#1                          ;make non-zero
0201 B3         +1  7780             cpl     c               ;c=0->1,c=1->0
0202 22         +1  7781             ret
                +1  7782     ;==============================================================
                +1  7783     
                +1  7784     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  7785     ;       the result in r2-r5
                +1  7786     
0203            +1  7787     flmul:
                +1  7788+3           saveregs
0203 C007       +1  7789+1           push    7
0205 C006       +1  7790+1           push    6
0207 C001       +1  7791+1           push    1
0209 C000       +1  7792+1           push    0
020B 119E       +1  7793             call    unpack1
020D 11BA       +1  7794             call    unpack2
020F E4         +1  7795             clr     a
0210 F50C       +1  7796             mov     prod,a
0212 F50D       +1  7797             mov     prod+1,a        ;clear product
0214 F50E       +1  7798             mov     prod+2,a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   124

0216 F50F       +1  7799             mov     prod+3,a
0218 7E07       +1  7800             mov     r6,#7           ;initialize counter
021A            +1  7801     mup1:
                +1  7802+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  7803+1           clr     c
021B E508       +1  7804+1           mov     a,mant2
021D 13         +1  7805+1           rrc     a
021E F508       +1  7806+1           mov     mant2,a
0220 E509       +1  7807+1           mov     a,mant2+1
0222 13         +1  7808+1           rrc     a
0223 F509       +1  7809+1           mov     mant2+1,a
0225 E50A       +1  7810+1           mov     a,mant2+2
0227 13         +1  7811+1           rrc     a
0228 F50A       +1  7812+1           mov     mant2+2,a
022A E50B       +1  7813+1           mov     a,mant2+3
022C 13         +1  7814+1           rrc     a
022D F50B       +1  7815+1           mov     mant2+3,a
022F 5014       +1  7816             jnc     nobit           ;skip if lsb was zero
                +1  7817+3           dan     prod            ;add multiplicand to product
0231 ED         +1  7818+1           mov     a,r5
0232 250F       +1  7819+1           add     a,prod+3
0234 F50F       +1  7820+1           mov     prod+3,a
0236 E50E       +1  7821+1           mov     a,prod+2
0238 3C         +1  7822+1           addc    a,r4
0239 F50E       +1  7823+1           mov     prod+2,a
023B E50D       +1  7824+1           mov     a,prod+1
023D 3B         +1  7825+1           addc    a,r3
023E F50D       +1  7826+1           mov     prod+1,a
0240 E50C       +1  7827+1           mov     a,prod+0
0242 3A         +1  7828+1           addc    a,r2
0243 F50C       +1  7829+1           mov     prod,a
0245            +1  7830     nobit:
                +1  7831+3           lshift                  ;shift multiplicand up
0245 ED         +1  7832+1           mov     a,r5
0246 33         +1  7833+1           rlc     a
0247 FD         +1  7834+1           mov     r5,a
0248 EC         +1  7835+1           mov     a,r4
0249 33         +1  7836+1           rlc     a
024A FC         +1  7837+1           mov     r4,a
024B EB         +1  7838+1           mov     a,r3
024C 33         +1  7839+1           rlc     a
024D FB         +1  7840+1           mov     r3,a
024E EA         +1  7841+1           mov     a,r2
024F 33         +1  7842+1           rlc     a
0250 FA         +1  7843+1           mov     r2,a
0251 DEC7       +1  7844             djnz    r6,mup1         ;loop if more
                +1  7845     
0253 7E11       +1  7846             mov     r6,#17          ;re-initalize counter
0255 8015       +1  7847             sjmp    mup3
0257            +1  7848     mup11:
                +1  7849+3           shfdn   prod            ;shift product right
0257 C3         +1  7850+1           clr     c
0258 E50C       +1  7851+1           mov     a,prod
025A 13         +1  7852+1           rrc     a
025B F50C       +1  7853+1           mov     prod,a
025D E50D       +1  7854+1           mov     a,prod+1
025F 13         +1  7855+1           rrc     a
0260 F50D       +1  7856+1           mov     prod+1,a
0262 E50E       +1  7857+1           mov     a,prod+2
0264 13         +1  7858+1           rrc     a
0265 F50E       +1  7859+1           mov     prod+2,a
0267 E50F       +1  7860+1           mov     a,prod+3
0269 13         +1  7861+1           rrc     a
026A F50F       +1  7862+1           mov     prod+3,a
026C            +1  7863     mup3:
                +1  7864+3           shfdn   mant2           ;shift multiplier down
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   125

026C C3         +1  7865+1           clr     c
026D E508       +1  7866+1           mov     a,mant2
026F 13         +1  7867+1           rrc     a
0270 F508       +1  7868+1           mov     mant2,a
0272 E509       +1  7869+1           mov     a,mant2+1
0274 13         +1  7870+1           rrc     a
0275 F509       +1  7871+1           mov     mant2+1,a
0277 E50A       +1  7872+1           mov     a,mant2+2
0279 13         +1  7873+1           rrc     a
027A F50A       +1  7874+1           mov     mant2+2,a
027C E50B       +1  7875+1           mov     a,mant2+3
027E 13         +1  7876+1           rrc     a
027F F50B       +1  7877+1           mov     mant2+3,a
0281 5014       +1  7878             jnc     mup2            ;skip if bit not set
                +1  7879+3           dan     prod            ;add to prod
0283 ED         +1  7880+1           mov     a,r5
0284 250F       +1  7881+1           add     a,prod+3
0286 F50F       +1  7882+1           mov     prod+3,a
0288 E50E       +1  7883+1           mov     a,prod+2
028A 3C         +1  7884+1           addc    a,r4
028B F50E       +1  7885+1           mov     prod+2,a
028D E50D       +1  7886+1           mov     a,prod+1
028F 3B         +1  7887+1           addc    a,r3
0290 F50D       +1  7888+1           mov     prod+1,a
0292 E50C       +1  7889+1           mov     a,prod+0
0294 3A         +1  7890+1           addc    a,r2
0295 F50C       +1  7891+1           mov     prod,a
0297            +1  7892     mup2:
0297 DEBE       +1  7893             djnz    r6,mup11        ;loop if more
0299 E8         +1  7894             mov     a,r0            ;get exp1
029A 29         +1  7895             add     a,r1            ;add exp2
029B 247A       +1  7896             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  7897             mov     r0,a            ;store
029E EF         +1  7898             mov     a,r7            ;get sign
029F 23         +1  7899             rl      a               ;rotate bit into msb
02A0 6207       +1  7900             xrl     sign,a          ;xor with other bit
                +1  7901+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  7902+1           mov     r2,prod
02A4 AB0D       +1  7903+1           mov     r3,prod+1
02A6 AC0E       +1  7904+1           mov     r4,prod+2
02A8 AD0F       +1  7905+1           mov     r5,prod+3
02AA 11F0       +1  7906             call    norm1           ;normalize
02AC 11DE       +1  7907             call    pack1
                +1  7908+3           restregs
02AE D000       +1  7909+1           pop     0
02B0 D001       +1  7910+1           pop     1
02B2 D006       +1  7911+1           pop     6
02B4 D007       +1  7912+1           pop     7
02B6 22         +1  7913             ret
                +1  7914     ;-----------------------------------------------------------
                +1  7915     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  7916     
02B7            +1  7917     fldiv:
                +1  7918+3           saveregs
02B7 C007       +1  7919+1           push    7
02B9 C006       +1  7920+1           push    6
02BB C001       +1  7921+1           push    1
02BD C000       +1  7922+1           push    0
02BF 119E       +1  7923             call    unpack1
02C1 11BA       +1  7924             call    unpack2
02C3 E4         +1  7925             clr     a
02C4 F50C       +1  7926             mov     prod,a
02C6 F50D       +1  7927             mov     prod+1,a
02C8 F50E       +1  7928             mov     prod+2,a
02CA F50F       +1  7929             mov     prod+3,a
02CC E9         +1  7930             mov     a,r1            ;check for zero divisor
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   126

02CD 6067       +1  7931             jz      div9
02CF E8         +1  7932             mov     a,r0            ;check for zero dividend
02D0 6064       +1  7933             jz      div9
02D2 C3         +1  7934             clr     c
02D3 99         +1  7935             subb    a,r1            ;compute new exponent
02D4 2478       +1  7936             add     a,#127-7        ;unbias
02D6 F8         +1  7937             mov     r0,a            ;store back
02D7 EF         +1  7938             mov     a,r7            ;get sign
02D8 23         +1  7939             rl      a
02D9 6207       +1  7940             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  7941             mov     r6,#24+7        ;initialize counter
02DD            +1  7942     div1:
                +1  7943+3           shfup   prod            ;shift quotient up
02DD C3         +1  7944+1           clr     c
02DE E50F       +1  7945+1           mov     a,prod+3
02E0 33         +1  7946+1           rlc     a
02E1 F50F       +1  7947+1           mov     prod+3,a
02E3 E50E       +1  7948+1           mov     a,prod+2
02E5 33         +1  7949+1           rlc     a
02E6 F50E       +1  7950+1           mov     prod+2,a
02E8 E50D       +1  7951+1           mov     a,prod+1
02EA 33         +1  7952+1           rlc     a
02EB F50D       +1  7953+1           mov     prod+1,a
02ED E50C       +1  7954+1           mov     a,prod
02EF 33         +1  7955+1           rlc     a
02F0 F50C       +1  7956+1           mov     prod,a
02F2 C3         +1  7957             clr     c
02F3 EA         +1  7958             mov     a,r2            ;compare values
02F4 9508       +1  7959             subb    a,mant2
02F6 4028       +1  7960             jc      div2            ;skip if bigger
02F8 7013       +1  7961             jnz     div3
02FA EB         +1  7962             mov     a,r3            ;compare values
02FB 9509       +1  7963             subb    a,mant2+1
02FD 4021       +1  7964             jc      div2            ;skip if bigger
02FF 700C       +1  7965             jnz     div3
0301 EC         +1  7966             mov     a,r4            ;compare values
0302 950A       +1  7967             subb    a,mant2+2
0304 401A       +1  7968             jc      div2            ;skip if bigger
0306 7005       +1  7969             jnz     div3
0308 ED         +1  7970             mov     a,r5            ;compare values
0309 950B       +1  7971             subb    a,mant2+3
030B 4013       +1  7972             jc      div2            ;skip if bigger
030D            +1  7973     div3:
030D ED         +1  7974             mov     a,r5
030E 950B       +1  7975             subb    a,mant2+3
0310 FD         +1  7976             mov     r5,a
0311 EC         +1  7977             mov     a,r4
0312 950A       +1  7978             subb    a,mant2+2               ;do subtraction
0314 FC         +1  7979             mov     r4,a
0315 EB         +1  7980             mov     a,r3
0316 9509       +1  7981             subb    a,mant2+1               ;do subtraction
0318 FB         +1  7982             mov     r3,a
0319 EA         +1  7983             mov     a,r2
031A 9508       +1  7984             subb    a,mant2         ;do subtraction
031C FA         +1  7985             mov     r2,a
031D 430F01     +1  7986             orl     prod+3,#1       ;set lsb in quotient
0320            +1  7987     div2:
                +1  7988+3           lshift                  ;shift dividend up
0320 ED         +1  7989+1           mov     a,r5
0321 33         +1  7990+1           rlc     a
0322 FD         +1  7991+1           mov     r5,a
0323 EC         +1  7992+1           mov     a,r4
0324 33         +1  7993+1           rlc     a
0325 FC         +1  7994+1           mov     r4,a
0326 EB         +1  7995+1           mov     a,r3
0327 33         +1  7996+1           rlc     a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   127

0328 FB         +1  7997+1           mov     r3,a
0329 EA         +1  7998+1           mov     a,r2
032A 33         +1  7999+1           rlc     a
032B FA         +1  8000+1           mov     r2,a
032C DEAF       +1  8001             djnz    r6,div1         ;loop if more
                +1  8002+3           copytor prod            ;copy quotient
032E AA0C       +1  8003+1           mov     r2,prod
0330 AB0D       +1  8004+1           mov     r3,prod+1
0332 AC0E       +1  8005+1           mov     r4,prod+2
0334 AD0F       +1  8006+1           mov     r5,prod+3
0336            +1  8007     div9:
0336 11F0       +1  8008             call    norm1           ;now normalize result
0338 11DE       +1  8009             call    pack1           ;pack it up
                +1  8010+3           restregs                ;restore registers
033A D000       +1  8011+1           pop     0
033C D001       +1  8012+1           pop     1
033E D006       +1  8013+1           pop     6
0340 D007       +1  8014+1           pop     7
0342 22         +1  8015             ret
                +1  8016     ;------------------------------------------------------------------
                +1  8017     
                +1  8018     ;       Float to long conversion: if the exponent is less than the
                +1  8019     ;       excess value, the result is zero. If the exponent is so large
                +1  8020     ;       that the value would be shifted out, the result is overflow.
                +1  8021     ;       Otherwise shift the mantissa up or down as required.
                +1  8022     
0343            +1  8023     ftol:
                +1  8024+3           saveregs
0343 C007       +1  8025+1           push    7
0345 C006       +1  8026+1           push    6
0347 C001       +1  8027+1           push    1
0349 C000       +1  8028+1           push    0
034B EA         +1  8029             mov     a,r2
034C B4BF09     +1  8030             cjne    a,#0bfh,ne05
034F EB         +1  8031             mov     a,r3
0350 7006       +1  8032             jnz     ne05
0352 EC         +1  8033             mov     a,r4
0353 7003       +1  8034             jnz     ne05
0355 ED         +1  8035             mov     a,r5
0356 6024       +1  8036             jz      ftol1
0358 119E       +1  8037     ne05:   call    unpack1
035A E8         +1  8038             mov     a,r0            ;get exponent
035B 2482       +1  8039             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  8040             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  8041             mov     a,r7            ;get sign
0361 30E70D     +1  8042             jnb     acc.7,ftol4     ;skip if +ve
                +1  8043+3           neg1                    ;negate it
0364 C3         +1  8044+1           clr     c
0365 E4         +1  8045+1           clr     a
0366 9D         +1  8046+1           subb    a,r5
0367 FD         +1  8047+1           mov     r5,a
0368 E4         +1  8048+1           clr     a
0369 9C         +1  8049+1           subb    a,r4
036A FC         +1  8050+1           mov     r4,a
036B E4         +1  8051+1           clr     a
036C 9B         +1  8052+1           subb    a,r3
036D FB         +1  8053+1           mov     r3,a
036E E4         +1  8054+1           clr     a
036F 9A         +1  8055+1           subb    a,r2
0370 FA         +1  8056+1           mov     r2,a
0371            +1  8057     ftol4:
0371 E8         +1  8058             mov     a,r0            ;get exponent
0372 246A       +1  8059             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  8060             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  8061             mov     r0,a            ;save it
0378 24F8       +1  8062             add     a,#-8           ;if > 8, too big
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   128

037A 500E       +1  8063             jnc     ftol3
037C            +1  8064     ftol1:
037C E4         +1  8065             clr     a
037D FA         +1  8066             mov     r2,a
037E FB         +1  8067             mov     r3,a
037F FC         +1  8068             mov     r4,a
0380 FD         +1  8069             mov     r5,a
0381            +1  8070     ftol9:
                +1  8071+3           restregs
0381 D000       +1  8072+1           pop     0
0383 D001       +1  8073+1           pop     1
0385 D006       +1  8074+1           pop     6
0387 D007       +1  8075+1           pop     7
0389 22         +1  8076             ret
038A            +1  8077     ftol3:
038A E8         +1  8078             mov     a,r0
038B FE         +1  8079             mov     r6,a            ;store in counter
038C 60F3       +1  8080             jz      ftol9           ;if zero, do nothing
038E            +1  8081     ftol33:
                +1  8082+3           lshift                  ;shift up
038E ED         +1  8083+1           mov     a,r5
038F 33         +1  8084+1           rlc     a
0390 FD         +1  8085+1           mov     r5,a
0391 EC         +1  8086+1           mov     a,r4
0392 33         +1  8087+1           rlc     a
0393 FC         +1  8088+1           mov     r4,a
0394 EB         +1  8089+1           mov     a,r3
0395 33         +1  8090+1           rlc     a
0396 FB         +1  8091+1           mov     r3,a
0397 EA         +1  8092+1           mov     a,r2
0398 33         +1  8093+1           rlc     a
0399 FA         +1  8094+1           mov     r2,a
039A DEF2       +1  8095             djnz    r6,ftol33       ;and loop
039C 80E3       +1  8096             sjmp    ftol9
039E            +1  8097     ftol2:
039E F4         +1  8098             cpl     a               ;complement
039F FE         +1  8099             mov     r6,a
03A0 6022       +1  8100             jz      ftol22
03A2            +1  8101     ftol23:
03A2 EF         +1  8102             mov     a,r7
03A3 30E70F     +1  8103             jnb     acc.7,ftol24
                +1  8104+3           rshift1
03A6 D3         +1  8105+1           setb    c
03A7 EA         +1  8106+1           mov     a,r2
03A8 13         +1  8107+1           rrc     a
03A9 FA         +1  8108+1           mov     r2,a
03AA EB         +1  8109+1           mov     a,r3
03AB 13         +1  8110+1           rrc     a
03AC FB         +1  8111+1           mov     r3,a
03AD EC         +1  8112+1           mov     a,r4
03AE 13         +1  8113+1           rrc     a
03AF FC         +1  8114+1           mov     r4,a
03B0 ED         +1  8115+1           mov     a,r5
03B1 13         +1  8116+1           rrc     a
03B2 FD         +1  8117+1           mov     r5,a
03B3 800D       +1  8118             jmp     ftol25
03B5            +1  8119+3   ftol24: rshift                  ;shift down
03B5 C3         +1  8120+1           clr     c
03B6 EA         +1  8121+1           mov     a,r2
03B7 13         +1  8122+1           rrc     a
03B8 FA         +1  8123+1           mov     r2,a
03B9 EB         +1  8124+1           mov     a,r3
03BA 13         +1  8125+1           rrc     a
03BB FB         +1  8126+1           mov     r3,a
03BC EC         +1  8127+1           mov     a,r4
03BD 13         +1  8128+1           rrc     a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   129

03BE FC         +1  8129+1           mov     r4,a
03BF ED         +1  8130+1           mov     a,r5
03C0 13         +1  8131+1           rrc     a
03C1 FD         +1  8132+1           mov     r5,a
03C2 DEDE       +1  8133     ftol25: djnz    r6,ftol23
03C4            +1  8134     ftol22:
                +1  8135+3           add1                    ;round
03C4 ED         +1  8136+1           mov     a,r5
03C5 2401       +1  8137+1           add     a,#1
03C7 FD         +1  8138+1           mov     r5,a
03C8 E4         +1  8139+1           clr     a
03C9 3C         +1  8140+1           addc    a,r4
03CA FC         +1  8141+1           mov     r4,a
03CB E4         +1  8142+1           clr     a
03CC 3B         +1  8143+1           addc    a,r3
03CD FB         +1  8144+1           mov     r3,a
03CE E4         +1  8145+1           clr     a
03CF 3A         +1  8146+1           addc    a,r2
03D0 FA         +1  8147+1           mov     r2,a
03D1 EF         +1  8148             mov     a,r7
03D2 30E70F     +1  8149             jnb     acc.7,ftol26
                +1  8150+3           rshift1
03D5 D3         +1  8151+1           setb    c
03D6 EA         +1  8152+1           mov     a,r2
03D7 13         +1  8153+1           rrc     a
03D8 FA         +1  8154+1           mov     r2,a
03D9 EB         +1  8155+1           mov     a,r3
03DA 13         +1  8156+1           rrc     a
03DB FB         +1  8157+1           mov     r3,a
03DC EC         +1  8158+1           mov     a,r4
03DD 13         +1  8159+1           rrc     a
03DE FC         +1  8160+1           mov     r4,a
03DF ED         +1  8161+1           mov     a,r5
03E0 13         +1  8162+1           rrc     a
03E1 FD         +1  8163+1           mov     r5,a
03E2 809D       +1  8164             jmp     ftol9
03E4            +1  8165+3   ftol26: rshift
03E4 C3         +1  8166+1           clr     c
03E5 EA         +1  8167+1           mov     a,r2
03E6 13         +1  8168+1           rrc     a
03E7 FA         +1  8169+1           mov     r2,a
03E8 EB         +1  8170+1           mov     a,r3
03E9 13         +1  8171+1           rrc     a
03EA FB         +1  8172+1           mov     r3,a
03EB EC         +1  8173+1           mov     a,r4
03EC 13         +1  8174+1           rrc     a
03ED FC         +1  8175+1           mov     r4,a
03EE ED         +1  8176+1           mov     a,r5
03EF 13         +1  8177+1           rrc     a
03F0 FD         +1  8178+1           mov     r5,a
03F1 808E       +1  8179             jmp     ftol9
                +1  8180     
                +1  8181     ;       arithmetic integer to floating conversions
                +1  8182     
03F3            +1  8183     abtof:
03F3 ED         +1  8184             mov     a,r5
03F4 23         +1  8185             rl      a
03F5 FC         +1  8186             mov     r4,a
03F6 9C         +1  8187             subb    a,r4
03F7 FC         +1  8188             mov     r4,a
03F8 FB         +1  8189             mov     r3,a
03F9 FA         +1  8190             mov     r2,a
03FA 8006       +1  8191             jmp     altof
03FC            +1  8192     awtof:
03FC EC         +1  8193             mov     a,r4
03FD 23         +1  8194             rl      a
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   130

03FE FB         +1  8195             mov     r3,a
03FF 9B         +1  8196             subb    a,r3
0400 FB         +1  8197             mov     r3,a
0401 FA         +1  8198             mov     r2,a
0402            +1  8199     altof:
                +1  8200+3           saveregs
0402 C007       +1  8201+1           push    7
0404 C006       +1  8202+1           push    6
0406 C001       +1  8203+1           push    1
0408 C000       +1  8204+1           push    0
040A EA         +1  8205             mov     a,r2            ;get sign
040B 5480       +1  8206             anl     a,#80h
040D FF         +1  8207             mov     r7,a            ;store it
040E 30E70D     +1  8208             jnb     acc.7,altof1    ;skip if +ve
                +1  8209+3           neg1
0411 C3         +1  8210+1           clr     c
0412 E4         +1  8211+1           clr     a
0413 9D         +1  8212+1           subb    a,r5
0414 FD         +1  8213+1           mov     r5,a
0415 E4         +1  8214+1           clr     a
0416 9C         +1  8215+1           subb    a,r4
0417 FC         +1  8216+1           mov     r4,a
0418 E4         +1  8217+1           clr     a
0419 9B         +1  8218+1           subb    a,r3
041A FB         +1  8219+1           mov     r3,a
041B E4         +1  8220+1           clr     a
041C 9A         +1  8221+1           subb    a,r2
041D FA         +1  8222+1           mov     r2,a
041E            +1  8223     altof1:
041E 7896       +1  8224             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  8225             call    norm1           ;normalize it
0422 11DE       +1  8226             call    pack1           ;and pack up
                +1  8227+3           restregs
0424 D000       +1  8228+1           pop     0
0426 D001       +1  8229+1           pop     1
0428 D006       +1  8230+1           pop     6
042A D007       +1  8231+1           pop     7
042C 22         +1  8232             ret
                +1  8233     
042D            +1  8234     lbtof:
042D 7C00       +1  8235             mov     r4,#0
042F            +1  8236     lwtof:
042F E4         +1  8237             clr     a
0430 FB         +1  8238             mov     r3,a
0431 FA         +1  8239             mov     r2,a
0432            +1  8240     lltof:
                +1  8241+3           saveregs
0432 C007       +1  8242+1           push    7
0434 C006       +1  8243+1           push    6
0436 C001       +1  8244+1           push    1
0438 C000       +1  8245+1           push    0
043A 7F00       +1  8246             mov     r7,#0           ;zero sign
043C 80E0       +1  8247             sjmp    altof1
                +1  8248     
                +1  8249     ;-------------------------------------------------------
                +1  8250     
                +1  8251     
                    8252     
                    8253     ;$include (d:\amp\wriread.asm)
                +1  8254     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  8255     cle256:          mov            IE,#00H
0441 75B601     +1  8256                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  8257                              MOV            PSCTL,#03
                +1  8258                                             
0447 7400       +1  8259                                     mov             a,#00h  ;запись любого значения стирает стр
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   131

                             аницу
0449 F0         +1  8260                                     movx    @dptr,a                         ;wr
044A 758F00     +1  8261                                     mov             PSCTL,#00
044D 75B600     +1  8262                                 mov         FLSCL,#00
0450 75A880     +1  8263                               mov           IE,#80H
0453 22         +1  8264                                     ret
                +1  8265     
                +1  8266     ;чтение памяти программ в r8..r11
                +1  8267     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  8268     re4byte:        mov                     dph,r2
0456 8B82       +1  8269                                             mov                     dpl,r3
0458 E4         +1  8270                                             clr                     a
0459 93         +1  8271                                             movc            a,@a+dptr
045A F508       +1  8272                                             mov                     r8,a
045C A3         +1  8273                                             inc                     dptr
045D E4         +1  8274                                             clr                     a
045E 93         +1  8275                                             movc            a,@a+dptr
045F F509       +1  8276                                             mov                     r9,a
0461 A3         +1  8277                                             inc                     dptr
0462 E4         +1  8278                                             clr                     a
0463 93         +1  8279                                             movc            a,@a+dptr
0464 F50A       +1  8280                                             mov                     r10,a
0466 A3         +1  8281                                             inc                     dptr
0467 E4         +1  8282                                             clr                     a
0468 93         +1  8283                                             movc            a,@a+dptr
0469 F50B       +1  8284                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  8285                                             ret
                +1  8286      ;чтение памяти программ в r2..r5
                +1  8287     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  8288     rebyte2:        mov                     dph,r2
046E 8B82       +1  8289                                             mov                     dpl,r3
0470 E4         +1  8290                                             clr                     a
0471 93         +1  8291                                             movc            a,@a+dptr
0472 FA         +1  8292                                             mov                     r2,a
0473 A3         +1  8293                                             inc                     dptr
0474 E4         +1  8294                                             clr                     a
0475 93         +1  8295                                             movc            a,@a+dptr
0476 FB         +1  8296                                             mov                     r3,a
0477 A3         +1  8297                                             inc                     dptr
0478 E4         +1  8298                                             clr                     a
0479 93         +1  8299                                             movc            a,@a+dptr
047A FC         +1  8300                                             mov                     r4,a
047B A3         +1  8301                                             inc                     dptr
047C E4         +1  8302                                             clr                     a
047D 93         +1  8303                                             movc            a,@a+dptr
047E FD         +1  8304                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  8305                                             ret
                +1  8306      
                +1  8307     
                +1  8308      ;r7-количество байт
                +1  8309     ;dptr-адр ячейки для записи
                +1  8310     ;r1-адр ячейки  внешнего озу
                +1  8311     
0480 75A800     +1  8312     wrpage:  mov            IE,#00H
0483 75B601     +1  8313     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  8314                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  8315                      movx           a,@r1
048A F0         +1  8316                      movx           @dptr,a                         ;wr
048B 758F00     +1  8317                      mov            PSCTL,#0
048E 75B600     +1  8318                      mov            FLSCL,#00
0491 A3         +1  8319                     inc                     dptr
0492 09         +1  8320                     inc                     r1
0493 DFEE       +1  8321                     djnz            r7,WW5
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   132

0495 75A880     +1  8322                     mov             IE,#80H
0498 22         +1  8323                     ret
                +1  8324                             
                +1  8325     
                +1  8326     
                +1  8327                                                             
                +1  8328     
                +1  8329     
                +1  8330     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8331     ;чтение памяти программ во внешнее озу
                +1  8332     ;вх-r2,r3-адр яч памяти прогр
                +1  8333     ;r1- яч внешнее озу
0499 8A83       +1  8334     copyPP:         mov                     dph,r2
049B 8B82       +1  8335                                             mov                     dpl,r3
049D 7FFF       +1  8336                                             mov                     r7,#0ffh
049F E4         +1  8337     copy1:          clr                     a
04A0 93         +1  8338                                             movc            a,@a+dptr
04A1 F3         +1  8339                                             movx                    @r1,a
04A2 A3         +1  8340                                             inc                     dptr
04A3 09         +1  8341                                             inc                     r1
04A4 DFF9       +1  8342                                             djnz            r7,copy1
04A6 22         +1  8343                                             ret
                +1  8344     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8345     
                +1  8346                                     
                +1  8347     
                +1  8348     ;r8..r11->@r0..@r0+3
                +1  8349     ;r0-адр ячейки
                +1  8350     ;сохранить в ячейке озу
04A7 E508       +1  8351     savelte:        mov     a,ltemp
04A9 F6         +1  8352                                             mov     @r0,a
04AA 08         +1  8353                                             inc     r0
04AB E509       +1  8354                                             mov     a,ltemp+1
04AD F6         +1  8355                                             mov     @r0,a
04AE 08         +1  8356                                             inc     r0
04AF E50A       +1  8357                                             mov     a,ltemp+2
04B1 F6         +1  8358                                             mov     @r0,a
04B2 08         +1  8359                                             inc     r0
04B3 E50B       +1  8360                                             mov     a,ltemp+3
04B5 F6         +1  8361                                             mov     @r0,a
04B6 22         +1  8362                                             ret
                +1  8363     
                +1  8364     ;
                +1  8365     
                +1  8366     
                +1  8367     
                +1  8368     
                +1  8369     
                +1  8370                     
                +1  8371     
                +1  8372     
                +1  8373     
                +1  8374     
                +1  8375      
                    8376     
                    8377                                                   
                    8378     END
                                                                             
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   133

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   03B4H   R   SEG=MAIN   868#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1476 1533 1558 1579 1583 1586 1587 1589 1677 1682 3625 3639 3720
                                           3723 3766 3861 3905 3908 3985 3989 3990 3991 3994 4237 4274 4275 4277 4354
                                           4374 4465 4469 4512 4515 4865 4870 5036 5041 5809 5971 5974
ABRET. . . . . . .  C ADDR   241EH   R   SEG=MAIN   5738 5740#
ABTOF. . . . . . .  C ADDR   03F3H   A      8183#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 682 746 754 762 770 772 792 1147 1158 1166 1245 1814 1823 1832 1841
                                           1862 2246 2271 2276 2280 2285 2288 2291 2294 2297 2485 2546 2592 2603 2695
                                           2704 2712 2721 2862 2905 2930 2935 2939 2942 2945 2948 2951 2954 3285 3373
                                           3419 3441 3460 3482 3508 4414 4420 4457 4546 5312 6401 6590 6668 6671 6928
                                           7580 7663 7680 7712 7750 7778 8040 8042 8060 8103 8149 8208
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   2BE3H   R   SEG=MAIN   903 940 942 944 946 948 950 952 954 956 1022 1024 1026 1028 1030
                                           1032 1034 1036 1038 1041 1043 1045 1047 1049 1051 1053 1055 1057 1059 1078
                                           1080 1082 7169#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1532 1544 1548 1563 1588 1591 1592 1681 1685 3638 3642 3717 3721
                                           3763 3767 3858 3862 3907 3911 3993 4006 4247 4261 4263 4265 4276 4279 4364
                                           4375 4470 4516 4869 4873 5040 5044 5610 5629 5647 5710 5727 5973 5976 6322
                                           6354
ADRBLOK. . . . . .  C ADDR   2897H   R   SEG=MAIN   3357 3380 3736 3879 4787 4955 5106 6366#
AFTERK . . . . . .  C ADDR   06ABH   R   SEG=MAIN   1175 1254#
AGE2 . . . . . . .  C ADDR   024EH   R   SEG=MAIN   634# 637
AGE9 . . . . . . .  C ADDR   0871H   R   SEG=MAIN   1480# 1483
AGEON. . . . . . .  C ADDR   025CH   R   SEG=MAIN   643# 645
ALLSUM . . . . . .  C ADDR   0352H   R   SEG=MAIN   812# 847 865 881
ALMUL. . . . . . .  C ADDR   2B2AH   R   SEG=MAIN   7015#
ALTOF. . . . . . .  C ADDR   0402H   A      1141 1239 1270 1278 1296 1312 1323 1340 1353 1438 1974 2084 2161 2199
                                           3770 3867 4378 4473 4519 4618 4696 4704 4722 4828 4840 4855 4939 5001 5017
                                           5090 5152 5167 8191 8199#
ALTOF1 . . . . . .  C ADDR   041EH   A      8208 8223# 8247
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   0611H   R   SEG=MAIN   1139 1155#
AN_T7. . . . . . .  C ADDR   11F9H   R   SEG=MAIN   2955# 3030 3040
AUTOKA . . . . . .  C ADDR   0C81H   R   SEG=MAIN   1173 2129#
AVPGO. . . . . . .  C ADDR   07DCH   R   SEG=MAIN   1400 1402#
AVTDEC1. . . . . .  C ADDR   066DH   R   SEG=MAIN   1208 1217#
AWTOF. . . . . . .  C ADDR   03FCH   A      8192#
B. . . . . . . . .  D ADDR   00F0H   A      122# 5457 5829 7018 7021 7023 7027 7031 7035 7039 7044 7048 7055 7059
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   134

                                           7063 7069 7073 7077 7083 7776 7777
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 462#
BFORM. . . . . . .  C ADDR   27D4H   R   SEG=MAIN   6171 6176 6188# 6214
BIFL_KT. . . . . .  B ADDR   0021H.5 A      337# 4614 4670 4769
BIN30. . . . . . .  C ADDR   2946H   R   SEG=MAIN   6578# 6604
BIN31. . . . . . .  C ADDR   294AH   R   SEG=MAIN   6583# 6587
BIN32. . . . . . .  C ADDR   295AH   R   SEG=MAIN   6596# 6601
BIN41. . . . . . .  C ADDR   296BH   R   SEG=MAIN   6612# 6622
BINDEC . . . . . .  C ADDR   293AH   R   SEG=MAIN   1534 1590 1683 3640 3909 3995 4278 4871 5042 5975 6557#
BITAKT . . . . . .  B ADDR   0023H.2 A      356# 1768 1769 1772
BITAVP . . . . . .  B ADDR   0020H.5 A      327# 1366 1599 1758 3018 3019 3021
BITBON . . . . . .  B ADDR   0021H.2 A      334# 1794 1918 2105 2129 2306 2307 2315 6402
BITBUF . . . . . .  B ADDR   0021H.0 A      332#
BITEIZM. . . . . .  B ADDR   0022H.5 A      347# 1264 1704 1711 1776 2989 3005 4150 5376
BITIZM . . . . . .  B ADDR   0020H.4 A      326# 583 714 1604 2277 2358 2443 2478 2509 2936 2992 3116 3139 3214 3245
                                           3270 3376 3489 3740 3788 3816 3977 4105 4151 4198 4310 4387 4501
BITKLB . . . . . .  B ADDR   0022H.2 A      344# 1333 1792 2282 2991 3009 3017 3024 4385 4684
BITMAS . . . . . .  B ADDR   0020H.1 A      323# 1089 1092 6154
BITMEM . . . . . .  B ADDR   0021H.3 A      335# 1667 2689 3248 3266 3278 3375 3488 3741 3787 3976
BITMENU. . . . . .  B ADDR   0022H.1 A      343# 1666 2508 2620 2993 3269 3796 3815 4110 4152 4197 4309 4384
BITMIG . . . . . .  B ADDR   0023H.1 A      355# 2585 2773 2872 3182 3537 3677 3690 4216 4343 4449 4550 5894 5920
                                           5945 5957 6020 6027 6033 6039
BITNUL . . . . . .  B ADDR   0021H.7 A      339# 1414 1623 1739 2346 3038 3042 3043 3050
BITOLL . . . . . .  B ADDR   0022H.7 A      349# 658 1607 1664 2994
BITPAR . . . . . .  B ADDR   0022H.6 A      348# 4116 4685
BITPRD . . . . . .  B ADDR   0021H.1 A      333# 1917
BITRS. . . . . . .  B ADDR   0020H.3 A      325#
BITT2. . . . . . .  B ADDR   0022H.0 A      342# 1663 2444 2479 2482 3057 3215
BITV19 . . . . . .  B ADDR   0022H.3 A      345# 527 531 2656 2661 2667 4094 4099 4180 4193 4315 4319 4324
BITVI11. . . . . .  B ADDR   0020H.6 A      328# 1364 1380 1423 2300 2302 2357 2507 2988 3108 3115 3268 4500
BITVICH. . . . . .  B ADDR   0022H.4 A      346# 1422 1662 2301 2359 2369 2506 2514 3075 3107 3138 3267 4499
BITZNAK. . . . . .  B ADDR   0020H.0 A      322# 683 729
BITZNB . . . . . .  B ADDR   0023H.3 A      357# 4520 5736 5739
BITZUS . . . . . .  B ADDR   0020H.7 A      329# 1415 1624 2032 2035 2404
BLOIN. . . . . . .  C ADDR   1697H   R   SEG=MAIN   3645# 3650
BLOKVV . . . . . .  C ADDR   1669H   R   SEG=MAIN   3615#
BLOKVVC. . . . . .  C ADDR   1673H   R   SEG=MAIN   3618 3621#
BL_LI. . . . . . .  C ADDR   1634H   R   SEG=MAIN   3565 3573#
BONPART. . . . . .  C ADDR   0C54H   R   SEG=MAIN   2104#
BOUT7. . . . . . .  C ADDR   13D2H   R   SEG=MAIN   3225# 3227
BRET . . . . . . .  C ADDR   225FH   R   SEG=MAIN   5397 5402 5406#
BUFDEC . . . . . .  C ADDR   09B9H   R   SEG=MAIN   1688# 1693
BUFIND . . . . . .  D ADDR   0040H   A      298# 633 637 642 645 651 1479 1483 1549 1570 1591 1592 1593 1642 1647
                                           1686 1694 1696 1701 1737 1756 1762 1770 1773 1778 1793 1795 2265 2312 2316
                                           2560 2578 2594 2596 2599 2659 2660 2665 2666 2768 2812 2831 2923 2997 3059
                                           3117 3118 3165 3169 3195 3217 3231 3238 3249 3250 3348 3532 3559 3587 3616
                                           3643 3657 3658 3662 3663 3670 3671 3676 3692 3831 3838 3912 3920 3922 3938
                                           3962 3996 4005 4007 4071 4093 4100 4208 4246 4279 4280 4281 4282 4284 4318
                                           4323 4335 4363 4386 4441 4487 4874 4882 4886 5045 5053 5057 5212 5244 5455
                                           5468 5474 5481 5609 5628 5646 5709 5726 5737 5897 5923 5977 6024 6045 6321
                                           6353 6403
BUFL_DEC . . . . .  C ADDR   2109H   R   SEG=MAIN   5178#
BUFMEA . . . . . .  C ADDR   1F60H   R   SEG=MAIN   4876# 4881
BUFMIN . . . . . .  C ADDR   2053H   R   SEG=MAIN   5047# 5052
BUFON. . . . . . .  C ADDR   0DDAH   R   SEG=MAIN   2306 2315#
BUFR . . . . . . .  C ADDR   0916H   R   SEG=MAIN   1572# 1577
BUFR2. . . . . . .  C ADDR   08F8H   R   SEG=MAIN   1551# 1556
BUFR3. . . . . . .  C ADDR   08F1H   R   SEG=MAIN   1542 1547#
BUFR30 . . . . . .  C ADDR   08F4H   R   SEG=MAIN   1545 1549#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      7773# 7777
CELLBIT. . . . . .  D ADDR   0020H   A      321# 322 323 324 325 326 327 328 329
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   135

CELLBIT1 . . . . .  D ADDR   0021H   A      331# 332 333 334 335 337 339
CELLBIT2 . . . . .  D ADDR   0022H   A      341# 342 343 344 345 346 347 348 349
CELLBIT3 . . . . .  D ADDR   0023H   A      353# 354 355 356 357
CEXP . . . . . . .  C ADDR   01E2H   A      7750 7759#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   2302H   R   SEG=MAIN   1460 3051 4476 5541#
CH1. . . . . . . .  C ADDR   2322H   R   SEG=MAIN   5361 5552#
CH10 . . . . . . .  C ADDR   2306H   R   SEG=MAIN   864 1103 3897 5542#
CH100. . . . . . .  C ADDR   231AH   R   SEG=MAIN   811 5547#
CH10000. . . . . .  C ADDR   2316H   R   SEG=MAIN   5546#
CH150H . . . . . .  C ADDR   236AH   R   SEG=MAIN   5571#
CH2. . . . . . . .  C ADDR   231EH   R   SEG=MAIN   1098 5548#
CH20 . . . . . . .  C ADDR   24E5H   R   SEG=MAIN   846 1108 5860#
CH2THO . . . . . .  C ADDR   234AH   R   SEG=MAIN   2168 2206 5563#
CH320H . . . . . .  C ADDR   2366H   R   SEG=MAIN   5570# 6374
CH4. . . . . . . .  C ADDR   230EH   R   SEG=MAIN   1112 5544#
CH43 . . . . . . .  C ADDR   18A2H   R   SEG=MAIN   3914# 3919
CH43_42. . . . . .  C ADDR   1948H   R   SEG=MAIN   4009# 4014
CH5. . . . . . . .  C ADDR   230AH   R   SEG=MAIN   880 5543#
CH57 . . . . . . .  C ADDR   24E1H   R   SEG=MAIN   5859#
CH954. . . . . . .  C ADDR   2312H   R   SEG=MAIN   5545#
CHAIBL . . . . . .  C ADDR   14E2H   R   SEG=MAIN   3350 3352#
CHAIPR . . . . . .  C ADDR   17F7H   R   SEG=MAIN   3833 3835#
CHANMA . . . . . .  C ADDR   0FA9H   R   SEG=MAIN   2592 2601#
CHANZ. . . . . . .  C ADDR   0F90H   R   SEG=MAIN   2546 2590#
CHAVT. . . . . . .  D ADDR   0081H   A      371# 562 1164 1209 1217 2121 2225 4106
CHBEFORE . . . . .  D ADDR   009BH   A      381# 585 808 822 841 859 875
CHBLOK . . . . . .  D ADDR   00D6H   A      408# 4785 4835 4851 4953 5007 5104 5158
CHBUF. . . . . . .  D ADDR   00CFH   A      405# 596 1892 2000 2041 2046 2106 2114 3785 5178 5183
CHBUF1 . . . . . .  X ADDR   0E00H   A      438# 1902 1987
CHCMP. . . . . . .  C ADDR   2202H   R   SEG=MAIN   1170 5338#
CHDEC. . . . . . .  C ADDR   2215H   R   SEG=MAIN   1218 1231 5353#
CHDEL. . . . . . .  D ADDR   0083H   A      372# 2065 2092 2131 2181 2219
CHDELMO. . . . . .  C ADDR   0C3FH   R   SEG=MAIN   2075 2092# 2097
CHIF . . . . . . .  C ADDR   252AH   R   SEG=MAIN   5901 5904#
CHIF5. . . . . . .  C ADDR   2532H   R   SEG=MAIN   5907 5909#
CHIFB. . . . . . .  C ADDR   2555H   R   SEG=MAIN   5927 5930#
CHIFB1 . . . . . .  C ADDR   255BH   R   SEG=MAIN   5929 5930 5933#
CHIFL5 . . . . . .  C ADDR   2563H   R   SEG=MAIN   5937 5940#
CHIFOUR. . . . . .  C ADDR   2544H   R   SEG=MAIN   5914 5916 5920#
CHIND. . . . . . .  D ADDR   00ACH   A      387# 1382 1799
CHIND2 . . . . . .  D ADDR   0033H   A      315# 716 718 726
CHINKOR. . . . . .  D ADDR   0098H   A      370# 557 790 1156 1169 1211 1225 1230 2099
CHK. . . . . . . .  C ADDR   2362H   R   SEG=MAIN   1334 5569#
CHKL . . . . . . .  D ADDR   003DH   A      305# 696 698 706 708 709 711 2422 2449 2497 2969 3254 3968 4390
CHMAS. . . . . . .  D ADDR   006EH   A      302# 1086 1093 1116 6153
CHMASN . . . . . .  D ADDR   003FH   A      306# 797 806 842 860 876 892 1091 1093 1094
CHMINUS. . . . . .  C ADDR   287CH   R   SEG=MAIN   3370 3416 3438 3457 3479 6336# 6398
CHTADC . . . . . .  C ADDR   21ACH   R   SEG=MAIN   5270#
CHTHO. . . . . . .  C ADDR   2342H   R   SEG=MAIN   1303 1341 4627 4712 4730 5561#
CHTHOU . . . . . .  C ADDR   23E9H   R   SEG=MAIN   5697#
CHZAP. . . . . . .  C ADDR   22FEH   R   SEG=MAIN   1881 5540#
CH_1 . . . . . . .  C ADDR   232AH   R   SEG=MAIN   588 1496 1519 1899 2026 2043 2118 3868 5180 5554#
CH_10. . . . . . .  C ADDR   235AH   R   SEG=MAIN   1502 1525 1983 2013 4379 4860 5030 5567#
CH_10TH. . . . . .  C ADDR   2356H   R   SEG=MAIN   1395 5566#
CH_2 . . . . . . .  C ADDR   232EH   R   SEG=MAIN   1894 1978 2006 2022 5555#
CH_200 . . . . . .  C ADDR   2352H   R   SEG=MAIN   5565#
CH_220 . . . . . .  C ADDR   234EH   R   SEG=MAIN   1357 5564#
CH_22T . . . . . .  C ADDR   2427H   R   SEG=MAIN   1448 5745#
CH_250 . . . . . .  C ADDR   235EH   R   SEG=MAIN   1259 5568#
CH_4 . . . . . . .  C ADDR   2332H   R   SEG=MAIN   2016 3871 5556#
CH_5 . . . . . . .  C ADDR   2336H   R   SEG=MAIN   5557#
CH_500 . . . . . .  C ADDR   2423H   R   SEG=MAIN   1444 5744#
CH_7 . . . . . . .  C ADDR   233AH   R   SEG=MAIN   2110 5558#
CH_953 . . . . . .  C ADDR   233EH   R   SEG=MAIN   5560#
CH_B . . . . . . .  C ADDR   241FH   R   SEG=MAIN   1464 5742#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   136

CH_FL. . . . . . .  C ADDR   242BH   R   SEG=MAIN   1488 5746#
CH_M3. . . . . . .  C ADDR   236EH   R   SEG=MAIN   5572#
CH_MLN . . . . . .  C ADDR   2326H   R   SEG=MAIN   5553#
CIKLWR . . . . . .  C ADDR   27AAH   R   SEG=MAIN   6159#
CKCON. . . . . . .  D ADDR   008EH   A      30# 480 511
CL4. . . . . . . .  C ADDR   2380H   R   SEG=MAIN   5589# 5591
CL4N . . . . . . .  C ADDR   2386H   R   SEG=MAIN   5598# 5600
CLE20. . . . . . .  C ADDR   1935H   R   SEG=MAIN   3999# 4001
CLE256 . . . . . .  C ADDR   043EH   A      4186 4660 4762 8255#
CLEAR. . . . . . .  C ADDR   2934H   R   SEG=MAIN   6535 6539# 6569
CLEAR4 . . . . . .  C ADDR   237DH   R   SEG=MAIN   820 1411 1413 1559 1580 1620 1622 2343 2345 3035 3037 4784 5587#
CLEARN . . . . . .  C ADDR   2385H   R   SEG=MAIN   3718 3764 3859 4238 4355 4466 4513 5596#
CLMASSIX . . . . .  C ADDR   279AH   R   SEG=MAIN   548 1409 1618 2103 2229 2341 3033 3213 6147#
CLMASV . . . . . .  C ADDR   07E1H   R   SEG=MAIN   1404 1406#
CLMAX. . . . . . .  C ADDR   279FH   R   SEG=MAIN   6149# 6152
CLR11. . . . . . .  C ADDR   2935H   R   SEG=MAIN   6541# 6543
CLRDEC . . . . . .  C ADDR   292EH   R   SEG=MAIN   6533#
CLRNUM . . . . . .  C ADDR   2932H   R   SEG=MAIN   6536# 6650
CLRVICH. . . . . .  C ADDR   1342H   R   SEG=MAIN   3138# 3155
CNTR . . . . . . .  N NUMB   0006H   A      7446#
CO02S. . . . . . .  C ADDR   22E6H   R   SEG=MAIN   5524# 5528
CO05S. . . . . . .  C ADDR   22F3H   R   SEG=MAIN   5533# 5537
CO1S . . . . . . .  C ADDR   22DDH   R   SEG=MAIN   5518# 5518
CO2S . . . . . . .  C ADDR   22D9H   R   SEG=MAIN   5516# 5520
COMPA1 . . . . . .  C ADDR   088DH   R   SEG=MAIN   1496# 1505
COMPA2 . . . . . .  C ADDR   08C3H   R   SEG=MAIN   1519# 1528
COND . . . . . . .  C ADDR   280EH   R   SEG=MAIN   6243#
COPY1. . . . . . .  C ADDR   049FH   A      8337# 8342
COPYPP . . . . . .  C ADDR   0499H   A      4173 4639 4740 8334#
COPY_HL. . . . . .  D ADDR   00D7H   A      409# 3884 4020 4777 4793 4808 4946 4961 4976 5097 5112 5127
COUNT. . . . . . .  C ADDR   22BBH   R   SEG=MAIN   5490# 5490
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   22C2H   R   SEG=MAIN   5496# 5496
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 485
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1889
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1886
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 486
DAC1H. . . . . . .  D ADDR   00D6H   A      97#
DAC1L. . . . . . .  D ADDR   00D5H   A      96#
DCOA . . . . . . .  C ADDR   2813H   R   SEG=MAIN   6247# 6249
DCOB . . . . . . .  C ADDR   281AH   R   SEG=MAIN   6251# 6269
DCOC . . . . . . .  C ADDR   2825H   R   SEG=MAIN   6261# 6266
DCOD . . . . . . .  C ADDR   2832H   R   SEG=MAIN   6268 6271#
DDOUTF . . . . . .  C ADDR   15E9H   R   SEG=MAIN   3339 3395 3518 3526# 3611
DDOUTFR. . . . . .  C ADDR   14C6H   R   SEG=MAIN   3339# 3345
DEC30. . . . . . .  C ADDR   2987H   R   SEG=MAIN   6660# 6685
DEC31. . . . . . .  C ADDR   298CH   R   SEG=MAIN   6666# 6673
DEC32. . . . . . .  C ADDR   299CH   R   SEG=MAIN   6678# 6682
DECBIN . . . . . .  C ADDR   297AH   R   SEG=MAIN   3722 3768 3863 4376 4471 4517 6639#
DECSIZE. . . . . .  N NUMB   000AH   A      6514# 6534 6568 6595 6608 6611 6665
DECT2. . . . . . .  C ADDR   29A5H   R   SEG=MAIN   6656 6688#
DEDPTR . . . . . .  C ADDR   2BFAH   R   SEG=MAIN   7173 7177 7181 7187#
DENORM . . . . . .  C ADDR   0133H   A      7605# 7661
DGOTO7 . . . . . .  C ADDR   177BH   R   SEG=MAIN   3771# 3779
DIAP . . . . . . .  D ADDR   00AEH   A      389# 576 1399 1601 1700 1928 2335 2375 3026 4283 4667 5377 5398 5660 5675
                                           5826 5888
DIINC. . . . . . .  C ADDR   0DFFH   R   SEG=MAIN   2338 2341#
DIKDN. . . . . . .  C ADDR   24B9H   R   SEG=MAIN   5828 5848#
DIKDW. . . . . . .  C ADDR   23D1H   R   SEG=MAIN   5664 5685#
DIKM . . . . . . .  C ADDR   23E7H   R   SEG=MAIN   5696#
DIPAR. . . . . . .  C ADDR   23E5H   R   SEG=MAIN   5695#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   137

DIV1 . . . . . . .  C ADDR   02DDH   A      7942# 8001
DIV2 . . . . . . .  C ADDR   0320H   A      7960 7964 7968 7972 7987#
DIV3 . . . . . . .  C ADDR   030DH   A      7961 7965 7969 7973#
DIV9 . . . . . . .  C ADDR   0336H   A      7931 7933 8007#
DIVIDE . . . . . .  C ADDR   2A65H   R   SEG=MAIN   6175 6874#
DONE . . . . . . .  C ADDR   29D4H   R   SEG=MAIN   6704 6715#
DONE1. . . . . . .  C ADDR   29D2H   R   SEG=MAIN   6707 6710 6713#
DOSH . . . . . . .  C ADDR   2AEEH   R   SEG=MAIN   6949 6965#
DOSUB. . . . . . .  C ADDR   2ADCH   R   SEG=MAIN   6933 6937 6941 6945 6946 6950#
DPH. . . . . . . .  D ADDR   0083H   A      19# 554 600 608 615 622 2257 2851 2916 3384 3386 3889 3891 4025 4030 4535
                                           4778 4790 4795 4804 4806 4809 4820 4907 4909 4947 4958 4963 4972 4974 4977
                                           4988 5098 5109 5114 5123 5125 5128 5139 6107 6115 6382 6390 6422 6721 6757
                                           6792 6795 6807 6830 7192 7194 8268 8288 8334
DPL. . . . . . . .  D ADDR   0082H   A      18# 603 611 618 625 2256 2852 2915 3381 3383 3885 3887 4022 4033 4536
                                           4781 4788 4798 4801 4803 4812 4816 4904 4906 4950 4956 4966 4969 4971 4980
                                           4984 5101 5107 5117 5120 5122 5131 5135 6108 6114 6379 6393 6426 6737 6773
                                           6794 6808 6811 6845 7189 7191 8269 8289 8335
DVIG0. . . . . . .  C ADDR   0A9AH   R   SEG=MAIN   1835# 1837
DVIG1. . . . . . .  C ADDR   0A8FH   R   SEG=MAIN   1826# 1828
DVIG2. . . . . . .  C ADDR   0A84H   R   SEG=MAIN   1817# 1819
DVIG3. . . . . . .  C ADDR   0A78H   R   SEG=MAIN   1808# 1810
DVIG4. . . . . . .  C ADDR   0AA6H   R   SEG=MAIN   1846# 1848
DVIG6. . . . . . .  C ADDR   0AC8H   R   SEG=MAIN   1874# 1876
DVM. . . . . . . .  C ADDR   0AC6H   R   SEG=MAIN   1862 1873#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 483
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 534 700 2243 2902 5242 5254
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDKALIB . . . . .  C ADDR   1D90H   R   SEG=MAIN   3015 4613#
ENDSDV . . . . . .  C ADDR   0ACCH   R   SEG=MAIN   1868 1877#
ENDSUM . . . . . .  C ADDR   059FH   R   SEG=MAIN   904 957 1060 1085#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU0 . . . . . . .  C ADDR   08BEH   R   SEG=MAIN   1499 1515#
EQU00. . . . . . .  C ADDR   08DCH   R   SEG=MAIN   1517 1522 1531#
EQU1L. . . . . . .  C ADDR   10E5H   R   SEG=MAIN   2779 2783#
EQU2L. . . . . . .  C ADDR   164FH   R   SEG=MAIN   3597 3602#
ERRA0. . . . . . .  C ADDR   1CAFH   R   SEG=MAIN   4479 4491#
ERRA01 . . . . . .  C ADDR   07F7H   R   SEG=MAIN   1418# 1463
ERROR. . . . . . .  C ADDR   25C0H   R   SEG=MAIN   1425 4306 4494 5220 5234 6043#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168# 1964 2891 4569
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      7448#
EXP2 . . . . . . .  N NUMB   0001H   A      7450# 7627 7648
EXTCLE . . . . . .  C ADDR   01BEH   R   SEG=MAIN   551# 555
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDEXT. . . . . .  C ADDR   23CAH   R   SEG=MAIN   4641 5674#
FINDKOEF . . . . .  C ADDR   23BBH   R   SEG=MAIN   1337 5659#
FINDMEM. . . . . .  C ADDR   1049H   R   SEG=MAIN   2619 2689#
FINDR. . . . . . .  C ADDR   2512H   R   SEG=MAIN   1585 4273 5888#
FINIS. . . . . . .  C ADDR   2B19H   R   SEG=MAIN   6893 6994#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      1999 4832 4844 7653# 7742
FLCMP. . . . . . .  C ADDR   01D6H   A      1261 1359 1397 1446 1450 1462 1498 1521 1896 4478 5003 5019 5154 5169
                                           7747#
FLDIV. . . . . . .  C ADDR   02B7H   A      1284 1305 1343 1471 1490 1504 2015 2170 2208 4625 4710 4728 4859 4862
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   138

                                           5032 7917#
FLMUL. . . . . . .  C ADDR   0203H   A      1150 1250 1302 1348 1466 1527 1986 2008 2018 2024 2028 3873 4381 4629
                                           4714 4732 7787#
FLOUT. . . . . . .  C ADDR   01E1H   A      7754 7757#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 8256 8262 8313 8318
FLSUB. . . . . . .  C ADDR   01D1H   A      1242 1901 2045 2113 2166 2204 3870 5182 7740#
FND. . . . . . . .  C ADDR   01F8H   A      7763 7766 7769 7772 7775#
FO1M . . . . . . .  C ADDR   27D1H   R   SEG=MAIN   6181 6185#
FO2M . . . . . . .  C ADDR   27DAH   R   SEG=MAIN   6188 6190#
FORM4. . . . . . .  C ADDR   27DBH   R   SEG=MAIN   6183 6189 6193#
FT1IZM . . . . . .  C ADDR   0EE9H   R   SEG=MAIN   2492#
FTOL . . . . . . .  C ADDR   0343H   A      1195 1350 1474 3874 4630 4733 4863 5033 5970 8023#
FTOL1. . . . . . .  C ADDR   037CH   A      8036 8040 8064#
FTOL2. . . . . . .  C ADDR   039EH   A      8060 8097#
FTOL22 . . . . . .  C ADDR   03C4H   A      8100 8134#
FTOL23 . . . . . .  C ADDR   03A2H   A      8101# 8133
FTOL24 . . . . . .  C ADDR   03B5H   A      8103 8119#
FTOL25 . . . . . .  C ADDR   03C2H   A      8118 8133#
FTOL26 . . . . . .  C ADDR   03E4H   A      8149 8165#
FTOL3. . . . . . .  C ADDR   038AH   A      8063 8077#
FTOL33 . . . . . .  C ADDR   038EH   A      8081# 8095
FTOL4. . . . . . .  C ADDR   0371H   A      8042 8057#
FTOL9. . . . . . .  C ADDR   0381H   A      8070# 8080 8096 8164 8179
FULKALIB . . . . .  C ADDR   1DFFH   R   SEG=MAIN   4668 4683# 4771
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   491# 492
GO23NO . . . . . .  C ADDR   15AEH   R   SEG=MAIN   3396 3494#
GO31L. . . . . . .  C ADDR   10EBH   R   SEG=MAIN   2757 2788#
GO41L. . . . . . .  C ADDR   10F0H   R   SEG=MAIN   2788 2790#
GOA2 . . . . . . .  C ADDR   0797H   R   SEG=MAIN   1363 1365 1368# 1390
GOA3A2 . . . . . .  C ADDR   07A1H   R   SEG=MAIN   1373#
GOCIKLE. . . . . .  C ADDR   0BD8H   R   SEG=MAIN   1919 2003 2032# 2039 2048
GOFULL . . . . . .  C ADDR   15E1H   R   SEG=MAIN   3500 3522#
GOGO7. . . . . . .  C ADDR   1CCDH   R   SEG=MAIN   4452 4457 4504#
GOKAA2 . . . . . .  C ADDR   07BFH   R   SEG=MAIN   1388#
GOKLB. . . . . . .  C ADDR   0DC2H   R   SEG=MAIN   2282 2304#
GOOFF1 . . . . . .  C ADDR   1535H   R   SEG=MAIN   3410# 3419
GOOFF2 . . . . . .  C ADDR   1553H   R   SEG=MAIN   3432# 3441
GOOFF3 . . . . . .  C ADDR   1571H   R   SEG=MAIN   3451# 3460
GOOFF4 . . . . . .  C ADDR   158FH   R   SEG=MAIN   3473# 3482
GOONIN . . . . . .  C ADDR   07B1H   R   SEG=MAIN   1381# 1416 1428 1608 1625
GOONIN1. . . . . .  C ADDR   0958H   R   SEG=MAIN   1604 1608#
GOONIND. . . . . .  C ADDR   0990H   R   SEG=MAIN   1384 1654#
GOONOFF. . . . . .  C ADDR   14EEH   R   SEG=MAIN   3364# 3373
GOONT. . . . . . .  C ADDR   0B58H   R   SEG=MAIN   1922 1965#
GOPAROL. . . . . .  C ADDR   1B31H   R   SEG=MAIN   4115 4259 4267#
GOPAROM. . . . . .  C ADDR   1A1BH   R   SEG=MAIN   4113# 4116
GOPART . . . . . .  C ADDR   0330H   R   SEG=MAIN   792 795#
GOSK19 . . . . . .  C ADDR   101AH   R   SEG=MAIN   2656 2663#
GOTO7. . . . . . .  C ADDR   11F9H   R   SEG=MAIN   2968# 3048 3055 3093 3142 3171 3183 3225 3229 3274 3290 3299 3305
                                           3310 3316 3331 3393 3547 3550 3564 3601 3604 3660 3673 3679 3705 3707 3748
                                           3771 3789 3844 4043 4051 4059 4220 4224 4303 4313 4347 4398 4400 4416 4428
                                           4489 4680 4691
GOTOKD . . . . . .  C ADDR   0632H   R   SEG=MAIN   1153 1177#
GOTOSTROB. . . . .  C ADDR   0B3AH   R   SEG=MAIN   1933 1936 1939 1942 1945#
GOUT6. . . . . . .  C ADDR   0D77H   R   SEG=MAIN   2272# 2300
GOVVLIST . . . . .  C ADDR   181BH   R   SEG=MAIN   3827 3849#
GOZNAK . . . . . .  C ADDR   02E2H   R   SEG=MAIN   689 735#
HNOR11 . . . . . .  C ADDR   134DH   R   SEG=MAIN   3104 3146#
HNOR12 . . . . . .  C ADDR   12F5H   R   SEG=MAIN   3094 3098#
HNOT1. . . . . . .  C ADDR   1396H   R   SEG=MAIN   3070 3192#
HNOT2. . . . . . .  C ADDR   12C3H   R   SEG=MAIN   3067#
HR12 . . . . . . .  C ADDR   12EBH   R   SEG=MAIN   3089 3094#
HVI1113. . . . . .  C ADDR   12E5H   R   SEG=MAIN   3092# 3097 3102
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 536 5194 5200 8255 8263 8312 8322
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   139

INCT . . . . . . .  C ADDR   12BFH   R   SEG=MAIN   3062 3064#
IND. . . . . . . .  C ADDR   217AH   R   SEG=MAIN   638 646 691 719 1426 1509 1513 1796 2313 2317 2328 2998 3235 3251
                                           3747 3963 4015 4307 4495 4688 5216 5222 5236 5242# 6404
INDOLL . . . . . .  C ADDR   094DH   R   SEG=MAIN   1599 1600 1604#
INIACP . . . . . .  C ADDR   242FH   R   SEG=MAIN   655 3211 5752#
INNOT1_2 . . . . .  C ADDR   16D2H   R   SEG=MAIN   3669 3675#
INNOT3 . . . . . .  C ADDR   16C3H   R   SEG=MAIN   3661 3666#
INNOT6 . . . . . .  C ADDR   16B7H   R   SEG=MAIN   3656 3661#
INTER2 . . . . . .  C ADDR   211DH   R   SEG=MAIN   262 5187#
INTERVA. . . . . .  D ADDR   00CDH   A      404# 629 1965 3624 3724
INTMUL . . . . . .  C ADDR   0B7BH   R   SEG=MAIN   1980 1986#
INTMUL1. . . . . .  C ADDR   0B7EH   R   SEG=MAIN   1987#
INTMUL2. . . . . .  C ADDR   0B93H   R   SEG=MAIN   2000# 2009 2019 2025 2029
INTN . . . . . . .  C ADDR   1764H   R   SEG=MAIN   3762#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   137EH   R   SEG=MAIN   3173#
IZMAN. . . . . . .  C ADDR   0E60H   R   SEG=MAIN   2241 2396#
IZMFUN . . . . . .  C ADDR   0E6FH   R   SEG=MAIN   2329 2340 2348 2400 2403#
IZMPAT . . . . . .  C ADDR   0E73H   R   SEG=MAIN   2298 2314 2318 2372 2407#
IZMT2. . . . . . .  C ADDR   0E82H   R   SEG=MAIN   2423 2428#
IZMT3. . . . . . .  C ADDR   0E8DH   R   SEG=MAIN   2428 2434#
JFINIS . . . . . .  C ADDR   2A80H   R   SEG=MAIN   6885 6893#
KD . . . . . . . .  C ADDR   2346H   R   SEG=MAIN   5562#
KEYB1. . . . . . .  C ADDR   0D46H   R   SEG=MAIN   283 2242#
KEYB2. . . . . . .  C ADDR   118DH   R   SEG=MAIN   286 2901#
KFULL. . . . . . .  C ADDR   15B8H   R   SEG=MAIN   3332 3499#
KFULLR . . . . . .  C ADDR   14B5H   R   SEG=MAIN   3327 3332#
KGO23. . . . . . .  C ADDR   1522H   R   SEG=MAIN   3326 3399#
KLBOFF . . . . . .  C ADDR   1249H   R   SEG=MAIN   2991 3009#
KLEV1. . . . . . .  C ADDR   148FH   R   SEG=MAIN   3282 3317#
KLEV2. . . . . . .  C ADDR   1494H   R   SEG=MAIN   3317 3319#
KLEV21 . . . . . .  C ADDR   14B8H   R   SEG=MAIN   3324 3333#
KLEV22 . . . . . .  C ADDR   149EH   R   SEG=MAIN   3312 3321 3324#
KLEV23 . . . . . .  C ADDR   14C9H   R   SEG=MAIN   3333 3341#
KLEV3. . . . . . .  C ADDR   1499H   R   SEG=MAIN   3319 3321#
KLMAS. . . . . . .  C ADDR   03DDH   R   SEG=MAIN   824 891#
KNAVP. . . . . . .  C ADDR   1258H   R   SEG=MAIN   2948 3017#
KNIZM. . . . . . .  B ADDR   0023H.0 A      354# 1363 1600 1764 2374 2396 2397 2401
KNIZMON. . . . . .  C ADDR   0E6AH   R   SEG=MAIN   2396 2401#
KNKMP. . . . . . .  C ADDR   117EH   R   SEG=MAIN   2896# 2942
KNLEFT . . . . . .  C ADDR   1268H   R   SEG=MAIN   2900 3024#
KNMEM. . . . . . .  C ADDR   13F3H   R   SEG=MAIN   2895 3245#
KNMENU . . . . . .  C ADDR   121BH   R   SEG=MAIN   2954 2988#
KNNUL. . . . . . .  C ADDR   1289H   R   SEG=MAIN   2899 3042#
KNOPT. . . . . . .  C ADDR   0E95H   R   SEG=MAIN   2240 2442#
KNRAZR . . . . . .  C ADDR   0EAAH   R   SEG=MAIN   2239 2455#
KNRIGHT. . . . . .  C ADDR   0DF5H   R   SEG=MAIN   2288 2333#
KNVICH . . . . . .  C ADDR   0E16H   R   SEG=MAIN   2297 2351#
KOEFKD . . . . . .  D ADDR   00A0H   A      384# 594 4632 4642 4734 4742
KOEFKM . . . . . .  D ADDR   0094H   A      378# 592 1148 1248 2212
KOEFKP . . . . . .  D ADDR   0090H   A      377# 590 1145 1243 2174
KOMUL. . . . . . .  C ADDR   075BH   R   SEG=MAIN   1336 1340#
KOMULPZ. . . . . .  C ADDR   0755H   R   SEG=MAIN   1333 1337#
KONSTA . . . . . .  D ADDR   00BCH   A      397# 1458 4474 5968
KON_B. . . . . . .  C ADDR   0F74H   R   SEG=MAIN   2548 2567#
KOR0US . . . . . .  C ADDR   2273H   R   SEG=MAIN   2073 5431#
KOR0_AN. . . . . .  D ADDR   0084H   A      374# 1240 2085 2164 2202
KORDEC1. . . . . .  C ADDR   0683H   R   SEG=MAIN   1223 1230#
KORDEC10 . . . . .  C ADDR   0663H   R   SEG=MAIN   1211#
KORNUL . . . . . .  C ADDR   0C12H   R   SEG=MAIN   1160 2065#
KVVOD0 . . . . . .  C ADDR   15D4H   R   SEG=MAIN   3292 3508 3517#
LABEL43. . . . . .  C ADDR   1812H   R   SEG=MAIN   3845# 3853
LABEL7 . . . . . .  C ADDR   18FBH   R   SEG=MAIN   3845 3968# 3980
LABELA . . . . . .  C ADDR   02A9H   R   SEG=MAIN   694# 723 2036
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   140

LABELB . . . . . .  C ADDR   0A71H   R   SEG=MAIN   1203 1628 1801# 2053 2057 2059
LABELC . . . . . .  C ADDR   0EAAH   R   SEG=MAIN   2456#
LABELE . . . . . .  C ADDR   0E73H   R   SEG=MAIN   2405 2421# 2461 2464 2468 2472 2480
LABELF . . . . . .  C ADDR   0ED5H   R   SEG=MAIN   2238 2481#
LABELH . . . . . .  C ADDR   12ABH   R   SEG=MAIN   2898 3057#
LABELI . . . . . .  C ADDR   1C29H   R   SEG=MAIN   3073 3131 3185 4411#
LABELI2. . . . . .  C ADDR   1332H   R   SEG=MAIN   3131# 3132
LABELK . . . . . .  C ADDR   1433H   R   SEG=MAIN   3072 3275#
LABELL . . . . . .  C ADDR   10A6H   R   SEG=MAIN   2618 2718 2726#
LABELL1. . . . . .  C ADDR   0FB1H   R   SEG=MAIN   2605# 2682 2795 2844
LABELN . . . . . .  C ADDR   110AH   R   SEG=MAIN   2683 2804#
LABELP . . . . . .  C ADDR   17E8H   R   SEG=MAIN   3775 3796 3827# 4061
LABELS . . . . . .  C ADDR   17ADH   R   SEG=MAIN   3504 3796#
LABELS1. . . . . .  C ADDR   1A7CH   R   SEG=MAIN   4131 4161#
LABELS13 . . . . .  C ADDR   1BAFH   R   SEG=MAIN   4202 4327#
LABELS3. . . . . .  C ADDR   1C3CH   R   SEG=MAIN   4421#
LABELS4. . . . . .  C ADDR   1C17H   R   SEG=MAIN   4201 4402#
LABL2. . . . . . .  C ADDR   10CCH   R   SEG=MAIN   2760# 3336
LABM . . . . . . .  C ADDR   1658H   R   SEG=MAIN   3337 3607#
LADD . . . . . . .  C ADDR   2BC1H   R   SEG=MAIN   803 838 856 872 1884 7120#
LADDX. . . . . . .  C ADDR   2BD2H   R   SEG=MAIN   7144#
LBTOF. . . . . . .  C ADDR   042DH   A      8234#
LCMP . . . . . . .  C ADDR   29BFH   R   SEG=MAIN   5348 6212 6700#
LDC_LONG . . . . .  C ADDR   29D5H   R   SEG=MAIN   589 1335 1882 2169 2207 3052 6720#
LDC_LTEMP. . . . .  C ADDR   29F7H   R   SEG=MAIN   812 1099 1104 1109 1113 1260 1304 1342 1358 1396 1445 1449 1461
                                           1465 1489 1497 1503 1520 1526 1895 1900 1979 1984 2007 2014 2017 2023 2027
                                           2044 2112 3869 3872 3898 4380 4477 4628 4713 4731 4861 5031 5181 5362 6375
                                           6756#
LDX_LONG . . . . .  C ADDR   2A1DH   R   SEG=MAIN   6791#
LDX_LTEMP. . . . .  C ADDR   2A43H   R   SEG=MAIN   6829#
LEFCUR . . . . . .  C ADDR   16E3H   R   SEG=MAIN   3685# 3757 3773
LEFKL. . . . . . .  C ADDR   1272H   R   SEG=MAIN   3024 3030#
LEFMEM11 . . . . .  C ADDR   1441H   R   SEG=MAIN   3283# 3318 3320 3322
LEFT21 . . . . . .  C ADDR   1602H   R   SEG=MAIN   3543 3548#
LEFT_S . . . . . .  C ADDR   1A79H   R   SEG=MAIN   4160# 4163
LEFT_SK. . . . . .  C ADDR   1B90H   R   SEG=MAIN   4160 4315#
LEV220 . . . . . .  C ADDR   14A1H   R   SEG=MAIN   3325# 3334
LEV2GO . . . . . .  C ADDR   1130H   R   SEG=MAIN   2803 2840#
LEVEL. . . . . . .  D ADDR   00B0H   A      391# 2320 2690 2728 3252 3262 3281 3519 5918
LI21 . . . . . . .  C ADDR   1388H   R   SEG=MAIN   3180 3182#
LI42_43. . . . . .  C ADDR   1881H   R   SEG=MAIN   3895# 4035
LIST_43. . . . . .  C ADDR   1905H   R   SEG=MAIN   3847 3973#
LLDI2. . . . . . .  C ADDR   0E59H   R   SEG=MAIN   2387 2391#
LLDI23 . . . . . .  C ADDR   0E4DH   R   SEG=MAIN   2379 2384#
LLDI3. . . . . . .  C ADDR   0E54H   R   SEG=MAIN   2386 2388#
LLEV2. . . . . . .  C ADDR   10F5H   R   SEG=MAIN   2759 2793#
LLMUL. . . . . . .  C ADDR   2B2AH   R   SEG=MAIN   7014#
LLSUB. . . . . . .  C ADDR   2BAFH   R   SEG=MAIN   7096#
LLTOF. . . . . . .  C ADDR   0432H   A      8240#
LMUL . . . . . . .  C ADDR   2B2AH   R   SEG=MAIN   6170 6376 7016#
LOA3_X . . . . . .  C ADDR   290AH   R   SEG=MAIN   1925 6440#
LOAB12 . . . . . .  C ADDR   247EH   R   SEG=MAIN   3209 5793#
LOAD . . . . . . .  D ADDR   00B7H   A      395# 2445 2486 3060 3205 5454
LOADB. . . . . . .  C ADDR   13A9H   R   SEG=MAIN   3200 3203# 3236 3242
LOADB2 . . . . . .  C ADDR   13D5H   R   SEG=MAIN   3223 3227#
LOADCLE. . . . . .  C ADDR   145FH   R   SEG=MAIN   3297# 3511
LOADKD . . . . . .  C ADDR   249BH   R   SEG=MAIN   5826#
LOADR2 . . . . . .  C ADDR   248DH   R   SEG=MAIN   3769 3864 4377 4472 4518 5809#
LOADT. . . . . . .  C ADDR   228EH   R   SEG=MAIN   2447 2492 3066 5454#
LOADUS . . . . . .  C ADDR   222DH   R   SEG=MAIN   656 1407 1615 2347 2402 3006 3010 3039 3212 4770 5375#
LOAHL_R2 . . . . .  C ADDR   1F75H   R   SEG=MAIN   4827 4839 4890# 4999 5015 5150 5165
LOBLOK . . . . . .  C ADDR   160DH   R   SEG=MAIN   3497 3555# 3574
LOCLE. . . . . . .  C ADDR   145AH   R   SEG=MAIN   3286 3295#
LOD1 . . . . . . .  C ADDR   229DH   R   SEG=MAIN   5462# 5467
LODT . . . . . . .  C ADDR   22ACH   R   SEG=MAIN   5475# 5480
LOIZMK . . . . . .  C ADDR   12F8H   R   SEG=MAIN   3099# 3136
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   141

LOKAME1. . . . . .  C ADDR   19CEH   R   SEG=MAIN   4075#
LOLEVT . . . . . .  C ADDR   2290H   R   SEG=MAIN   2326 5455#
LOLIST . . . . . .  C ADDR   144EH   R   SEG=MAIN   3288#
LOME1. . . . . . .  C ADDR   1D44H   R   SEG=MAIN   4580# 4584 4587 4590 4593 4597 4600 4603 4606 4610
LOMENU . . . . . .  C ADDR   1D3CH   R   SEG=MAIN   2633 2646 4075 4118 4141 4577#
LOOP . . . . . . .  C ADDR   21E9H   R   SEG=MAIN   5311# 5312
LOOPS. . . . . . .  C ADDR   2A83H   R   SEG=MAIN   6895# 6928
LOSPUS . . . . . .  C ADDR   2267H   R   SEG=MAIN   2074 5414#
LOSTAT . . . . . .  C ADDR   1476H   R   SEG=MAIN   3301 3307#
LOTEXT . . . . . .  C ADDR   22A8H   R   SEG=MAIN   1508 1512 1606 2365 2523 2531 2539 2658 2664 2698 2707 2715 2724
                                           2732 2996 3092 3162 3247 3289 3298 3304 3309 3315 3330 3523 3556 3568 3623
                                           3745 3813 3837 4004 4040 4048 4056 4070 4092 4098 4137 4270 4317 4322 4485
                                           4580 4687 5472# 6044
LOTP . . . . . . .  C ADDR   24F1H   R   SEG=MAIN   5867# 5877 5880
LOTPUS . . . . . .  C ADDR   24E9H   R   SEG=MAIN   4149 5409 5864#
LOU. . . . . . . .  C ADDR   0E5FH   R   SEG=MAIN   2374 2390 2394#
LOUIZM . . . . . .  C ADDR   0E3CH   R   SEG=MAIN   2374# 2399 5406
LOUTF. . . . . . .  C ADDR   10E8H   R   SEG=MAIN   2785# 2794 2801
LOVICH . . . . . .  C ADDR   12EEH   R   SEG=MAIN   3095# 3129 3150 4531
LOWR . . . . . . .  C ADDR   1468H   R   SEG=MAIN   3295 3301#
LOWR1. . . . . . .  C ADDR   146DH   R   SEG=MAIN   3303# 3515
LSUB . . . . . . .  C ADDR   2BAFH   R   SEG=MAIN   1200 1376 5363 7097#
LTEMP. . . . . . .  N NUMB   0008H   A      1116 1118 1119 1120 5699 5700 5701 5702 6222 6225 6228 6231 6274 6275
                                           6276 6277 6512# 6886 6887 6888 6889 6898 6902 6906 6910 6913 6914 6915
                                           6916 6917 6918 6919 6920 6921 6922 6923 6924 6927 6930 6935 6939 6943 6953
                                           6956 6959 6962 6978 6981 6982 6984 6985 6987 6988 6990 6995 6996 6997 6998
                                           7018 7023 7031 7039 7044 7055 7063 7069 7077 7083 7451 7452 7491 7496 7498
                                           7507 7508 7509 7510 7741 7749 7762 7765 7768 7771 8351 8354 8357 8360
LWR. . . . . . . .  C ADDR   27ACH   R   SEG=MAIN   6161# 6165
LWRX . . . . . . .  C ADDR   2770H   R   SEG=MAIN   6106# 6118
LWTOF. . . . . . .  C ADDR   042FH   A      8236#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   27C7H   R   SEG=MAIN   1676 3901 4864 5035 6169 6174 6179# 6211
MAIN . . . . . . .  C SEG    2C0CH       REL=UNIT   237 294# 455
MANT1. . . . . . .  N NUMB   0002H   A      7449# 7476 7525 7526
MANT2. . . . . . .  N NUMB   0008H   A      7451# 7502 7503 7634 7636 7637 7639 7640 7642 7643 7645 7684 7685 7687
                                           7688 7690 7691 7693 7694 7698 7700 7703 7706 7804 7806 7807 7809 7810 7812
                                           7813 7815 7866 7868 7869 7871 7872 7874 7875 7877 7959 7963 7967 7971 7975
                                           7978 7981 7984
MARK0_8. . . . . .  C ADDR   0F7BH   R   SEG=MAIN   2550 2568 2570#
MARKER . . . . . .  D ADDR   00B2H   A      393# 567 2264 2510 2549 2559 2567 2577 2583 2767 2775 2811 2818 2830 2922
                                           3140 3157 3178 3271 3390 3490 3531 3539 3560 3586 3593 3651 3691 3698 3738
                                           3781 3839 3855 3978 4119 4207 4214 4298 4311 4334 4341 4388 4421 4440 4447
                                           4481 4491 4502 4527 5895 5921 5947 5958 6016
MARLE. . . . . . .  C ADDR   2565H   R   SEG=MAIN   3706 5944#
MARRI. . . . . . .  C ADDR   2572H   R   SEG=MAIN   2838 5957#
MAS10. . . . . . .  C ADDR   03FCH   R   SEG=MAIN   893 906#
MAS20. . . . . . .  C ADDR   047CH   R   SEG=MAIN   906 961#
MAS4 . . . . . . .  C ADDR   0570H   R   SEG=MAIN   959 1062#
MAS5DIV. . . . . .  C ADDR   05E4H   R   SEG=MAIN   1100 1105 1110 1114 1122#
MASFULL. . . . . .  C ADDR   05ABH   R   SEG=MAIN   1089 1093#
MASS0. . . . . . .  X ADDR   0100H   A      417 418# 894 899 928 936 1010 1018 1067 1074 6148
MASS1. . . . . . .  X ADDR   0104H   A      419# 902 925 939 1007 1021 1065 1077
MASS10 . . . . . .  X ADDR   0128H   A      428# 983 1040
MASS11 . . . . . .  X ADDR   012CH   A      429# 980 1042
MASS12 . . . . . .  X ADDR   0130H   A      430# 977 1044
MASS13 . . . . . .  X ADDR   0134H   A      431# 974 1046
MASS14 . . . . . .  X ADDR   0138H   A      432# 971 1048
MASS15 . . . . . .  X ADDR   013CH   A      433# 968 1050
MASS16 . . . . . .  X ADDR   0140H   A      434# 966 1052
MASS17 . . . . . .  X ADDR   0144H   A      435# 964 1054
MASS18 . . . . . .  X ADDR   0148H   A      436# 962 1056
MASS19 . . . . . .  X ADDR   014CH   A      437# 1058
MASS2. . . . . . .  X ADDR   0108H   A      420# 922 941 1004 1023 1063 1079
MASS3. . . . . . .  X ADDR   010CH   A      421# 919 943 1001 1025 1081
MASS4. . . . . . .  X ADDR   0110H   A      422# 916 945 998 1027
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   142

MASS5. . . . . . .  X ADDR   0114H   A      423# 913 947 995 1029
MASS6. . . . . . .  X ADDR   0118H   A      424# 911 949 993 1031
MASS7. . . . . . .  X ADDR   011CH   A      425# 909 951 991 1033
MASS8. . . . . . .  X ADDR   0120H   A      426# 907 953 989 1035
MASS9. . . . . . .  X ADDR   0124H   A      427# 955 986 1037
MASX5. . . . . . .  C ADDR   05DAH   R   SEG=MAIN   1091 1116#
MAXG . . . . . . .  C ADDR   209CH   R   SEG=MAIN   5106# 5160
MAXVIX . . . . . .  C ADDR   2106H   R   SEG=MAIN   5170 5175#
ME11_15DE. . . . .  C ADDR   17A4H   R   SEG=MAIN   3791# 3810
ME11_15DEC . . . .  C ADDR   19CDH   R   SEG=MAIN   3791 4074#
ME21_22. . . . . .  C ADDR   10B0H   R   SEG=MAIN   2732# 2741
ME21_23. . . . . .  C ADDR   1A37H   R   SEG=MAIN   3824 4127#
ME21_23DEC . . . .  C ADDR   1A53H   R   SEG=MAIN   4134 4139#
MEAVP. . . . . . .  C ADDR   1263H   R   SEG=MAIN   3018 3021#
MECLE. . . . . . .  C ADDR   01ABH   R   SEG=MAIN   540# 542
MEFF . . . . . . .  C ADDR   01B2H   R   SEG=MAIN   544# 547
MEM10MS. . . . . .  C ADDR   02A4H   R   SEG=MAIN   691#
MEM12NO. . . . . .  C ADDR   15CFH   R   SEG=MAIN   3509 3513#
MENG . . . . . . .  C ADDR   1EC1H   R   SEG=MAIN   4787# 4837
MENU12 . . . . . .  C ADDR   1D48H   R   SEG=MAIN   4578 4582#
MENU13 . . . . . .  C ADDR   1D50H   R   SEG=MAIN   4582 4585#
MENU14 . . . . . .  C ADDR   1D58H   R   SEG=MAIN   4585 4588#
MENU15 . . . . . .  C ADDR   1D60H   R   SEG=MAIN   4588 4591#
MENU21 . . . . . .  C ADDR   1D68H   R   SEG=MAIN   4591 4595#
MENU22 . . . . . .  C ADDR   1D70H   R   SEG=MAIN   4595 4598#
MENU23 . . . . . .  C ADDR   1D78H   R   SEG=MAIN   4598 4601#
MENU31 . . . . . .  C ADDR   1D80H   R   SEG=MAIN   4601 4604#
MENU41 . . . . . .  C ADDR   1D88H   R   SEG=MAIN   4604 4608#
MENUOFF. . . . . .  C ADDR   123DH   R   SEG=MAIN   2989 3002#
MENUON . . . . . .  C ADDR   17DAH   R   SEG=MAIN   3815#
MERR . . . . . . .  C ADDR   1218H   R   SEG=MAIN   2985# 2988
ME_14. . . . . . .  C ADDR   1481H   R   SEG=MAIN   3312#
ME_41. . . . . . .  C ADDR   1AF4H   R   SEG=MAIN   4161 4228#
ME_52. . . . . . .  C ADDR   1AC8H   R   SEG=MAIN   4204# 4228
ME_52V . . . . . .  C ADDR   1AE5H   R   SEG=MAIN   4218 4220#
MIDL . . . . . . .  C ADDR   2AB6H   R   SEG=MAIN   6890 6925#
MIGN . . . . . . .  C ADDR   25A2H   R   SEG=MAIN   5243 6016#
MIGNN. . . . . . .  C ADDR   25AAH   R   SEG=MAIN   6018 6023#
MIN4_HL. . . . . .  C ADDR   1F81H   R   SEG=MAIN   4903# 4917 4943 5068 5094
MING . . . . . . .  C ADDR   1FC3H   R   SEG=MAIN   4955# 5009
MINIVIX. . . . . .  C ADDR   202DH   R   SEG=MAIN   5020 5025# 5175
MLABL2 . . . . . .  C ADDR   1638H   R   SEG=MAIN   3524 3578# 3609 3848
MLABL2R. . . . . .  C ADDR   1818H   R   SEG=MAIN   3848# 3851
MMM. . . . . . . .  C ADDR   029FH   R   SEG=MAIN   687#
MO220. . . . . . .  C ADDR   0942H   R   SEG=MAIN   1215 1386 1599#
MO500I . . . . . .  C ADDR   08B2H   R   SEG=MAIN   1451 1511#
MO500R . . . . . .  C ADDR   08A6H   R   SEG=MAIN   1447 1507#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   1043H   R   SEG=MAIN   2684# 2695 2704 2712 2721
MOUTKMEM . . . . .  C ADDR   17A7H   R   SEG=MAIN   3792# 3800
MOVE28 . . . . . .  C ADDR   2834H   R   SEG=MAIN   1279 1297 1344 1453 2167 2205 4622 4705 4723 4829 4841 4856 4998
                                           5014 5149 5164 6274#
MOVE82 . . . . . .  C ADDR   23EDH   R   SEG=MAIN   5699#
MOVEA3 . . . . . .  C ADDR   0990H   R   SEG=MAIN   1657#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2551 2783 2823 3159 3496 3540 3548 3602 3654 3699 3842 4122 4217
                                           4300 4344 4422 4450 5951
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2547 2776 2780 2819 3160 3495 3544 3594 3598 3653 3703 3841 4121
                                           4301 4426 5960
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      7801# 7844
MUP11. . . . . . .  C ADDR   0257H   A      7848# 7893
MUP2 . . . . . . .  C ADDR   0297H   A      7878 7892#
MUP3 . . . . . . .  C ADDR   026CH   A      7847 7863#
MVV11. . . . . . .  C ADDR   1608H   R   SEG=MAIN   3520 3553#
MVV12. . . . . . .  C ADDR   1620H   R   SEG=MAIN   3553 3565#
N12DELCH . . . . .  C ADDR   0D33H   R   SEG=MAIN   2223 2231#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   143

N4DELCH. . . . . .  C ADDR   0CDFH   R   SEG=MAIN   2147 2185#
N8DELCH. . . . . .  C ADDR   0D21H   R   SEG=MAIN   2185 2223#
NBIMENU. . . . . .  C ADDR   1049H   R   SEG=MAIN   2688#
NBLOK. . . . . . .  D ADDR   0038H   A      311# 627 1930 3353 3557 3621 3835 3926 6366 6387 6418
NE05 . . . . . . .  C ADDR   0358H   A      8030 8032 8034 8037#
NELEM. . . . . . .  D ADDR   0037H   A      312# 628 3866 3983 3987
NEXIN. . . . . . .  C ADDR   2184H   R   SEG=MAIN   5246# 5253
NEXTMAX. . . . . .  C ADDR   20D1H   R   SEG=MAIN   5138 5146#
NEXTMEA. . . . . .  C ADDR   1EF6H   R   SEG=MAIN   4819 4827#
NEXTMIN. . . . . .  C ADDR   1FF8H   R   SEG=MAIN   4987 4995#
NMEM_MENU. . . . .  C ADDR   17AAH   R   SEG=MAIN   3794# 3798
NMINUS . . . . . .  C ADDR   06A0H   R   SEG=MAIN   1245 1249#
NMINUS3. . . . . .  C ADDR   0604H   R   SEG=MAIN   1147 1149#
NNDELCH. . . . . .  C ADDR   0C9FH   R   SEG=MAIN   2132 2147#
NNMEMB . . . . . .  C ADDR   113CH   R   SEG=MAIN   2686 2846#
NNNUL. . . . . . .  C ADDR   0A0DH   R   SEG=MAIN   1739 1742#
NO . . . . . . . .  C ADDR   2A9EH   R   SEG=MAIN   6900 6904 6908 6912#
NO0KEY . . . . . .  C ADDR   02B6H   R   SEG=MAIN   697 699 703#
NO10MSV. . . . . .  C ADDR   174BH   R   SEG=MAIN   3743 3749#
NO11V6 . . . . . .  C ADDR   0F2DH   R   SEG=MAIN   2518 2526#
NO12V6 . . . . . .  C ADDR   0F40H   R   SEG=MAIN   2526 2534#
NO13V6 . . . . . .  C ADDR   0F53H   R   SEG=MAIN   2534 2544#
NO21P7 . . . . . .  C ADDR   1CD4H   R   SEG=MAIN   4460 4509#
NO23RI . . . . . .  C ADDR   0FFAH   R   SEG=MAIN   2644 2648#
NO2MSV . . . . . .  C ADDR   1748H   R   SEG=MAIN   3748# 3749 3759
NO2PARN. . . . . .  C ADDR   0985H   R   SEG=MAIN   1640 1646#
NO31N. . . . . . .  C ADDR   1702H   R   SEG=MAIN   3712#
NO31RI . . . . . .  C ADDR   102BH   R   SEG=MAIN   2650 2674#
NO3PARN. . . . . .  C ADDR   097BH   R   SEG=MAIN   1640# 1720
NO4DEL . . . . . .  C ADDR   0C45H   R   SEG=MAIN   2078 2096#
NO5DEL . . . . . .  C ADDR   0C64H   R   SEG=MAIN   2111# 2119
NO6DEL . . . . . .  C ADDR   0C72H   R   SEG=MAIN   2109 2117#
NOAVK. . . . . . .  C ADDR   0672H   R   SEG=MAIN   1171 1220#
NOAVP. . . . . . .  C ADDR   0797H   R   SEG=MAIN   1367# 1398 1401
NOBAVP . . . . . .  C ADDR   0A29H   R   SEG=MAIN   1510 1514 1594 1758 1762#
NOBEF99. . . . . .  C ADDR   036DH   R   SEG=MAIN   809 825# 844 862 878
NOBIT. . . . . . .  C ADDR   0245H   A      7816 7830#
NOBITIZM . . . . .  C ADDR   0A32H   R   SEG=MAIN   1764 1767#
NOBL21 . . . . . .  C ADDR   10B9H   R   SEG=MAIN   2729 2737#
NOBL22 . . . . . .  C ADDR   10C3H   R   SEG=MAIN   2737 2757#
NOBUF. . . . . . .  C ADDR   0A67H   R   SEG=MAIN   1794 1796#
NOBUF0 . . . . . .  C ADDR   0BE8H   R   SEG=MAIN   1920 2041#
NOCHI0 . . . . . .  C ADDR   0977H   R   SEG=MAIN   1387 1627#
NOCHIND. . . . . .  C ADDR   02D5H   R   SEG=MAIN   717 725#
NOCHN10. . . . . .  C ADDR   05C7H   R   SEG=MAIN   1102 1107#
NOCHN2 . . . . . .  C ADDR   05BCH   R   SEG=MAIN   1097 1102#
NOCHN20. . . . . .  C ADDR   05D2H   R   SEG=MAIN   1107 1112#
NODI2. . . . . . .  C ADDR   095BH   R   SEG=MAIN   1602 1610#
NODI6. . . . . . .  C ADDR   1274H   R   SEG=MAIN   3028 3032#
NODI8. . . . . . .  C ADDR   09E1H   R   SEG=MAIN   1703 1710#
NODI8K . . . . . .  C ADDR   1B64H   R   SEG=MAIN   4286 4291#
NODI8_43 . . . . .  C ADDR   18DEH   R   SEG=MAIN   3940 3946#
NODI9. . . . . . .  C ADDR   0960H   R   SEG=MAIN   1612 1615#
NODI9_43 . . . . .  C ADDR   18E9H   R   SEG=MAIN   3946 3954#
NODIS9 . . . . . .  C ADDR   09F3H   R   SEG=MAIN   1710 1722#
NODISK9. . . . . .  C ADDR   1B6CH   R   SEG=MAIN   4290 4291 4298#
NOENDLI. . . . . .  C ADDR   28D6H   R   SEG=MAIN   6401 6405#
NOEQU1 . . . . . .  C ADDR   1121H   R   SEG=MAIN   2822 2826#
NOEQU2 . . . . . .  C ADDR   16FCH   R   SEG=MAIN   3702 3706#
NOFIZM . . . . . .  C ADDR   0F0FH   R   SEG=MAIN   2482 2514#
NOFT1. . . . . . .  C ADDR   0EE8H   R   SEG=MAIN   2487 2491#
NOFZ . . . . . . .  C ADDR   0BE3H   R   SEG=MAIN   2032 2036#
NOH37. . . . . . .  C ADDR   130DH   R   SEG=MAIN   3088 3112# 3123
NOHNOT1. . . . . .  C ADDR   13E8H   R   SEG=MAIN   3194 3237#
NOHNOT2. . . . . .  C ADDR   13DDH   R   SEG=MAIN   3230# 3237
NOKLB. . . . . . .  C ADDR   0A61H   R   SEG=MAIN   1792 1794#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   144

NOKORR . . . . . .  C ADDR   061AH   R   SEG=MAIN   1158 1161#
NOLAH. . . . . . .  C ADDR   12CFH   R   SEG=MAIN   3057 3075#
NOLI_43. . . . . .  C ADDR   1959H   R   SEG=MAIN   3973 4018#
NOM31. . . . . . .  C ADDR   16DAH   R   SEG=MAIN   3606 3681#
NOM32. . . . . . .  C ADDR   1753H   R   SEG=MAIN   3681 3755#
NOM33. . . . . . .  C ADDR   1781H   R   SEG=MAIN   3755 3775#
NOMARL . . . . . .  C ADDR   1C51H   R   SEG=MAIN   4424 4430 4434#
NOMAXI . . . . . .  C ADDR   20E9H   R   SEG=MAIN   5155 5158#
NOME11 . . . . . .  C ADDR   15BFH   R   SEG=MAIN   3506#
NOMEM11. . . . . .  C ADDR   1064H   R   SEG=MAIN   2691 2701#
NOMEM12. . . . . .  C ADDR   107AH   R   SEG=MAIN   2701 2709#
NOMEM13. . . . . .  C ADDR   1090H   R   SEG=MAIN   2709 2718#
NOMEMK . . . . . .  C ADDR   15BCH   R   SEG=MAIN   3260 3503#
NOMINI . . . . . .  C ADDR   2010H   R   SEG=MAIN   5004 5007#
NON1C. . . . . . .  C ADDR   0EBBH   R   SEG=MAIN   2462 2466#
NONULAVT . . . . .  C ADDR   0657H   R   SEG=MAIN   1166 1205#
NONULDEL . . . . .  C ADDR   0C27H   R   SEG=MAIN   2066 2077#
NOP3_0 . . . . . .  C ADDR   097BH   R   SEG=MAIN   1633#
NOPART1. . . . . .  C ADDR   0371H   R   SEG=MAIN   798 832#
NOPART2. . . . . .  C ADDR   0391H   R   SEG=MAIN   832 851#
NOPART3. . . . . .  C ADDR   03B1H   R   SEG=MAIN   851 867#
NOPART4. . . . . .  C ADDR   03D1H   R   SEG=MAIN   867 884#
NOPLUS . . . . . .  C ADDR   0FA3H   R   SEG=MAIN   2595 2598#
NOPOIN7. . . . . .  C ADDR   1C68H   R   SEG=MAIN   4420 4455#
NOPOINT. . . . . .  C ADDR   1C34H   R   SEG=MAIN   4414 4418#
NOR11. . . . . . .  C ADDR   0FB7H   R   SEG=MAIN   2609#
NORDN. . . . . . .  C ADDR   00F6H   A      7537# 7570
NORDN1 . . . . . .  C ADDR   0107H   A      7539 7553#
NORIG2 . . . . . .  C ADDR   10FEH   R   SEG=MAIN   2790 2798#
NORIM6 . . . . . .  C ADDR   113CH   R   SEG=MAIN   2850#
NORIME . . . . . .  C ADDR   0FE0H   R   SEG=MAIN   2631 2635#
NORIME1. . . . . .  C ADDR   0FDAH   R   SEG=MAIN   2633# 2636 2649
NORM1. . . . . . .  C ADDR   00F0H   A      7532# 7729 7906 8008 8225
NORR11 . . . . . .  C ADDR   1325H   R   SEG=MAIN   3125#
NORR12 . . . . . .  C ADDR   1335H   R   SEG=MAIN   3125 3132# 3146
NORUP. . . . . . .  C ADDR   0119H   A      7536 7573#
NORUP1 . . . . . .  C ADDR   011EH   A      7578# 7596
NORUP2 . . . . . .  C ADDR   0132H   A      7580 7597#
NORVICH. . . . . .  C ADDR   0A6AH   R   SEG=MAIN   1719 1797#
NOSAV1 . . . . . .  C ADDR   0B28H   R   SEG=MAIN   1931 1934#
NOSAV2 . . . . . .  C ADDR   0B2FH   R   SEG=MAIN   1934 1937#
NOSAV3 . . . . . .  C ADDR   0B36H   R   SEG=MAIN   1937 1940#
NOSUB. . . . . . .  C ADDR   2AD9H   R   SEG=MAIN   6934 6938 6942 6947#
NOT1IN . . . . . .  C ADDR   0BFDH   R   SEG=MAIN   1870 2051#
NOT1_7 . . . . . .  C ADDR   1208H   R   SEG=MAIN   2970 2977#
NOT2IN . . . . . .  C ADDR   0C05H   R   SEG=MAIN   2051 2055#
NOT2_7 . . . . . .  C ADDR   1213H   R   SEG=MAIN   2977 2982#
NOT3IN . . . . . .  C ADDR   0C0DH   R   SEG=MAIN   2055 2058#
NOTAKT . . . . . .  C ADDR   0A3CH   R   SEG=MAIN   1768 1772#
NOTE21 . . . . . .  C ADDR   0717H   R   SEG=MAIN   1266 1308#
NOTE22 . . . . . .  C ADDR   0732H   R   SEG=MAIN   1308 1320#
NOTESTIZM. . . . .  C ADDR   074AH   R   SEG=MAIN   1229 1332#
NOTT1. . . . . . .  C ADDR   0B72H   R   SEG=MAIN   1977 1982#
NOTT2. . . . . . .  C ADDR   0B9AH   R   SEG=MAIN   1982 2005#
NOTT3. . . . . . .  C ADDR   0BA8H   R   SEG=MAIN   2005 2012#
NOTT4. . . . . . .  C ADDR   0BBFH   R   SEG=MAIN   2012 2021#
NOTT5. . . . . . .  C ADDR   0BCDH   R   SEG=MAIN   2021 2026#
NOT_1. . . . . . .  C ADDR   0EC2H   R   SEG=MAIN   2466 2471#
NOT_10 . . . . . .  C ADDR   0EC2H   R   SEG=MAIN   2470#
NOVIR. . . . . . .  C ADDR   0FC2H   R   SEG=MAIN   2503 2620#
NOVIR1 . . . . . .  C ADDR   0EF9H   R   SEG=MAIN   2503# 2514
NOZMEA . . . . . .  C ADDR   1F71H   R   SEG=MAIN   4884 4886#
NOZMIN . . . . . .  C ADDR   2064H   R   SEG=MAIN   5055 5057#
NOZZBL . . . . . .  C ADDR   18D0H   R   SEG=MAIN   3929 3932 3935 3938#
NOZZMI . . . . . .  C ADDR   09CEH   R   SEG=MAIN   1698 1700#
NOZZMI1. . . . . .  C ADDR   18C0H   R   SEG=MAIN   3927 3930#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   145

NOZZMI2. . . . . .  C ADDR   18C7H   R   SEG=MAIN   3930 3933#
NOZZMI3. . . . . .  C ADDR   18CEH   R   SEG=MAIN   3933 3936#
NOZZMI43 . . . . .  C ADDR   18B7H   R   SEG=MAIN   3924 3926#
NSEC1. . . . . . .  C ADDR   0A16H   R   SEG=MAIN   1743 1746#
NSEC10 . . . . . .  C ADDR   0A1FH   R   SEG=MAIN   1745 1748 1753#
NSEC11 . . . . . .  C ADDR   0A1DH   R   SEG=MAIN   1746 1750#
NUERR. . . . . . .  D ADDR   0039H   A      310# 1424 4305 4493 5219 5233 6045
NULAVT . . . . . .  C ADDR   0C84H   R   SEG=MAIN   2130#
NUMSIZE. . . . . .  N NUMB   0004H   A      6515# 6537 6575 6582 6657 6677
OBOARD . . . . . .  C ADDR   2A0FH   R   SEG=MAIN   6758 6772#
OBOARD1. . . . . .  C ADDR   2A57H   R   SEG=MAIN   6831 6844#
OK1. . . . . . . .  C ADDR   0186H   A      7663 7678#
OK2. . . . . . . .  C ADDR   01A0H   A      7680 7695#
OK3. . . . . . . .  C ADDR   01C4H   A      7712 7728#
ONBOAR1. . . . . .  C ADDR   2A35H   R   SEG=MAIN   6793 6810#
ONBOARD. . . . . .  C ADDR   29E9H   R   SEG=MAIN   6722 6736#
ONMEM11. . . . . .  C ADDR   140AH   R   SEG=MAIN   3001 3020 3022 3254# 3814 3820 4072 4076 4081 4096 4101 4124 4138
                                           4142 4153
ONMEM12. . . . . .  C ADDR   1A5AH   R   SEG=MAIN   4143# 4146 4165
ONMEM13. . . . . .  C ADDR   1C14H   R   SEG=MAIN   4345 4400# 4404 4406
ONMIG. . . . . . .  C ADDR   25B8H   R   SEG=MAIN   6027 6036#
ONVICH . . . . . .  C ADDR   0E34H   R   SEG=MAIN   2357 2369#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 494
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 487 491
OUT43. . . . . . .  C ADDR   18F2H   R   SEG=MAIN   3963#
OUT6 . . . . . . .  C ADDR   113CH   R   SEG=MAIN   2237 2304 2350 2427 2432 2437 2453 2489 2494 2501 2512 2634 2647
                                           2662 2668 2851#
OUT7 . . . . . . .  C ADDR   1CFDH   R   SEG=MAIN   2896 2897 2974 2981 2985 3007 3013 3063 3068 3119 3258 3338 3571
                                           3665 3794 3965 3972 4017 4111 4199 4320 4325 4395 4409 4504 4506 4534#
OUTA . . . . . . .  C ADDR   257FH   R   SEG=MAIN   3164 5968#
OUTA2. . . . . . .  C ADDR   2599H   R   SEG=MAIN   5979# 5984
OUTF . . . . . . .  C ADDR   0EEFH   R   SEG=MAIN   2497# 2520 2524 2528 2532 2536 2540 2565 2588 2597 2600 2607 2684
                                           2699 2708 2716 2725 2735 2782 2785 2825 2839 2842 3109 3110 4143
OUTFL. . . . . . .  C ADDR   0FB4H   R   SEG=MAIN   2603 2607#
OUTKMEM. . . . . .  C ADDR   1417H   R   SEG=MAIN   3262# 3280 3792
OUTMA. . . . . . .  C ADDR   0F8DH   R   SEG=MAIN   2586 2588#
OUTMAX . . . . . .  C ADDR   20EEH   R   SEG=MAIN   5142 5161#
OUTMEA . . . . . .  C ADDR   1F11H   R   SEG=MAIN   4823 4838#
OUTMENU. . . . . .  C ADDR   1A16H   R   SEG=MAIN   4110#
OUTMIN . . . . . .  C ADDR   2015H   R   SEG=MAIN   4991 5011#
OUTR . . . . . . .  C ADDR   0909H   R   SEG=MAIN   1540 1563#
OUTR5. . . . . . .  C ADDR   0925H   R   SEG=MAIN   1561 1582#
OUTSKO . . . . . .  C ADDR   1ABBH   R   SEG=MAIN   4195 4197#
OUTSKO1. . . . . .  C ADDR   1AB8H   R   SEG=MAIN   4193 4196#
OUTVICH. . . . . .  C ADDR   0EFCH   R   SEG=MAIN   2504# 2516
OUTVIR . . . . . .  C ADDR   0DBBH   R   SEG=MAIN   2271 2300#
OUT_KALI . . . . .  C ADDR   1E0CH   R   SEG=MAIN   4689#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 6714
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 5246 5250
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 465
P1 . . . . . . . .  D ADDR   0090H   A      32# 659 660 5259 5261 5264 5267 5271 5273 5274 5326 5328 5330 5766 5773
                                           6304 6307 6309 6312
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 466
P2 . . . . . . . .  D ADDR   00A0H   A      47# 5292 5296 5305
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 467
P3 . . . . . . . .  D ADDR   00B0H   A      62# 476 2270 2272 2274 2275 2278 2279 2283 2284 2286 2287 2289 2290 2292
                                           2293 2295 2296 2476 2477 2483 2484 2515 2516 2519 2520 2527 2528 2535 2536
                                           2544 2545 2590 2591 2601 2602 2628 2629 2642 2643 2653 2654 2678 2679 2680
                                           2681 2693 2694 2702 2703 2710 2711 2719 2720 2758 2759 2793 2794 2802 2803
                                           2840 2841 2871 2929 2931 2933 2934 2937 2938 2940 2941 2943 2944 2946 2947
                                           2949 2950 2952 2953 3058 3061 3087 3088 3112 3113 3126 3127 3133 3134 3147
                                           3148 3192 3193 3279 3280 3283 3284 3325 3326 3342 3343 3344 3345 3399 3400
                                           3506 3507 3517 3518 3608 3609 3610 3611 3682 3683 3712 3713 3756 3757 3758
                                           3759 3776 3777 3778 3779 3797 3798 3799 3800 3807 3808 3850 3851 3852 3853
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   146

                                           3974 3975 4063 4064 4132 4133 4145 4146 4162 4163 4164 4165 4205 4206 4222
                                           4223 4229 4230 4231 4232 4403 4404 4405 4406 4412 4413 4418 4419 4455 4456
                                           4548 5291 5293 5295 5301 5302 5303 5306 5307
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2244 2870 2903 4547
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 469
P4 . . . . . . . .  D ADDR   0084H   A      20# 2068 2089 2133 2216 2381 2383 4675 5384 5387 5403 5405 5869
P5 . . . . . . . .  D ADDR   0085H   A      21# 573 582 2070 2091 2135 2138 2143 2178 2180 2218 2391 2393 4679 5392
                                           5395 5425 5428 5873
P6 . . . . . . . .  D ADDR   0086H   A      22# 1946 1948 1952 1954 2873 2875 2879 2881 4551 4553 4557 4559
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 470
PACK1. . . . . . .  C ADDR   00DEH   A      7515# 7730 7907 8009 8226
PARERR . . . . . .  C ADDR   1B79H   R   SEG=MAIN   4261 4263 4265 4305#
PARN . . . . . . .  D ADDR   00AFH   A      390# 579 1733 2457 3220
PAROL. . . . . . .  D ADDR   00A8H   A      386#
PART . . . . . . .  D ADDR   009AH   A      380# 574 796 1136 1178 1205 1220 1742 1798 1976 2108 2352 2421 2458 2968
                                           3203 3219 3655 3742 5396 5793
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215 519
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132# 518
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116# 517
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101# 516 1956 1958 2883 2885 4561 4563 5188 5190
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 463
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 464 515
PCON . . . . . . .  D ADDR   0087H   A      23# 510
POIN3. . . . . . .  C ADDR   1C67H   R   SEG=MAIN   4453# 4507
POINA. . . . . . .  C ADDR   1CCFH   R   SEG=MAIN   4451 4506#
POINA1 . . . . . .  C ADDR   1C4CH   R   SEG=MAIN   4423 4430#
POINA2 . . . . . .  C ADDR   1C46H   R   SEG=MAIN   4426# 4431
POZB . . . . . . .  C ADDR   1CF2H   R   SEG=MAIN   4520 4524#
PROD . . . . . . .  N NUMB   000CH   A      7452# 7796 7797 7798 7799 7819 7820 7821 7823 7824 7826 7827 7829 7851
                                           7853 7854 7856 7857 7859 7860 7862 7881 7882 7883 7885 7886 7888 7889 7891
                                           7902 7903 7904 7905 7926 7927 7928 7929 7945 7947 7948 7950 7951 7953 7954
                                           7956 7986 8003 8004 8005 8006
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 8257 8261 8314 8317
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 2247 2861 2906 4545 6213 6215 7187
                                           7195
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0DC5H   R   SEG=MAIN   2294 2306#
QUES . . . . . . .  C ADDR   14C3H   R   SEG=MAIN   3338# 3343
QU_AVP . . . . . .  C ADDR   0794H   R   SEG=MAIN   1364 1366#
R10. . . . . . . .  N NUMB   000AH   A      450# 1167 1419 1456 1468 1995 4264 5841 8280
R11. . . . . . . .  N NUMB   000BH   A      451# 1168 1418 1457 1467 1998 5845 8284
R8 . . . . . . . .  N NUMB   0008H   A      448# 525 1421 1454 1470 1989 4089 4260 5346 5833 8272
R9 . . . . . . . .  N NUMB   0009H   A      449# 1420 1455 1469 1992 4262 5347 5837 8276
RAFTERK. . . . . .  C ADDR   0630H   R   SEG=MAIN   1175# 1181
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   147

RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RDDOUTF. . . . . .  C ADDR   151CH   R   SEG=MAIN   3395# 3400
RE1. . . . . . . .  C ADDR   21F2H   R   SEG=MAIN   5326# 5332
RE11_7 . . . . . .  C ADDR   06D8H   R   SEG=MAIN   1277# 1319 1330
RE4BYTE. . . . . .  C ADDR   0454H   A      524 4088 4258 8268#
REA3_X . . . . . .  C ADDR   291CH   R   SEG=MAIN   3896 6457#
REACP. . . . . . .  D ADDR   0077H   A      304# 674 676 678 680 737 753 761 769 778 785 800 835 853 869 885 2152
                                           2154 2156 2158 2190 2192 2194 2196
READ . . . . . . .  C ADDR   21F0H   R   SEG=MAIN   673 675 677 5325#
READYACP . . . . .  C ADDR   0328H   R   SEG=MAIN   779 789#
READ_X2. . . . . .  C ADDR   21D8H   R   SEG=MAIN   5300# 5311
REBYTE . . . . . .  C ADDR   0278H   R   SEG=MAIN   658# 692 714 826 2094 2116 2125 2145 2183 2221 2230 2232
REBYTE2. . . . . .  C ADDR   046CH   A      1269 1277 1295 1311 1322 1338 4695 4703 8288#
REBYTER. . . . . .  C ADDR   0C77H   R   SEG=MAIN   2105 2121# 2129
REF0CN . . . . . .  D ADDR   00D1H   A      92# 471
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RENDKALIB. . . . .  C ADDR   1255H   R   SEG=MAIN   3015# 3017
RESAR2 . . . . . .  C ADDR   2840H   R   SEG=MAIN   801 836 854 870 886 898 934 1016 1072 1193 1238 1346 1370 1436
                                           1459 1486 1674 1893 2042 2081 2107 3045 4616 4624 4643 4721 4743 4831 4843
                                           4858 4938 4996 5012 5026 5089 5147 5162 5179 5969 6282# 6441
RESAR8 . . . . . .  C ADDR   27FEH   R   SEG=MAIN   1149 1199 1241 1249 1375 2165 2203 6221#
RESA_HL. . . . . .  C ADDR   28E9H   R   SEG=MAIN   1924 4776 4914 5064 6418#
REZAM. . . . . . .  D ADDR   008CH   A      376# 2200
REZAP. . . . . . .  D ADDR   0088H   A      375# 2162
REZMUL . . . . . .  C ADDR   0688H   R   SEG=MAIN   1213 1227 1236#
REZ_A. . . . . . .  D ADDR   0062H   A      365# 814 887 897 933 1015 1071 2080
REZ_A0 . . . . . .  D ADDR   006AH   A      367# 1198 1374 1412 1621 2344 3036 3046 3053
REZ_A1 . . . . . .  D ADDR   0066H   A      366# 1130 1196 1237 1351 1369 1388
REZ_A2 . . . . . .  D ADDR   007BH   A      368# 1371
REZ_A3 . . . . . .  D ADDR   009CH   A      382# 1201 1377 1435 1673 1803 3044 4615 4720 6440 6471
REZ_AK . . . . . .  D ADDR   00A4H   A      385# 4382 4623
REZ_AME. . . . . .  D ADDR   005EH   A      363# 1142 1151 1192 1251 1345
REZ_DEL. . . . . .  D ADDR   00C5H   A      402# 816
REZ_R. . . . . . .  D ADDR   00C9H   A      403# 1472 1485
RE_HL. . . . . . .  C ADDR   28F0H   R   SEG=MAIN   6421# 6431 6435 6438
RE_HL1 . . . . . .  C ADDR   28F8H   R   SEG=MAIN   6419 6429#
RE_HL2 . . . . . .  C ADDR   28FFH   R   SEG=MAIN   6429 6433#
RE_HL3 . . . . . .  C ADDR   2906H   R   SEG=MAIN   6433 6437#
RFINDMEM . . . . .  C ADDR   0FBFH   R   SEG=MAIN   2619# 2620
RGO23NO. . . . . .  C ADDR   151FH   R   SEG=MAIN   3396# 3401
RGOTO7 . . . . . .  C ADDR   16D7H   R   SEG=MAIN   3679# 3713
RHNOR11. . . . . .  C ADDR   12FFH   R   SEG=MAIN   3086 3098 3104#
RHNOT1 . . . . . .  C ADDR   12C6H   R   SEG=MAIN   3061 3070#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RI21_23. . . . . .  C ADDR   0FE3H   R   SEG=MAIN   2626 2638#
RI6. . . . . . . .  C ADDR   0FDDH   R   SEG=MAIN   2629 2634# 2643 2654 2677 2681
RIGBLO . . . . . .  C ADDR   10C6H   R   SEG=MAIN   2758# 2789 2791
RIGBLOK. . . . . .  C ADDR   1104H   R   SEG=MAIN   2802#
RIGHT2 . . . . . .  C ADDR   0DECH   R   SEG=MAIN   2321 2325#
RIGHT3 . . . . . .  C ADDR   0DF0H   R   SEG=MAIN   2323 2328#
RIKN . . . . . . .  C ADDR   0F65H   R   SEG=MAIN   2551# 2569
RIZMAN . . . . . .  C ADDR   0D43H   R   SEG=MAIN   2241# 2280
RI_31. . . . . . .  C ADDR   0FFDH   R   SEG=MAIN   2641 2650#
RKNLEFT. . . . . .  C ADDR   118AH   R   SEG=MAIN   2900# 2945
RKNMEM . . . . . .  C ADDR   117BH   R   SEG=MAIN   2895# 2951
RKNNUL . . . . . .  C ADDR   1187H   R   SEG=MAIN   2899# 2939
RKNOPT . . . . . .  C ADDR   0D40H   R   SEG=MAIN   2240# 2291
RKNRAZR. . . . . .  C ADDR   0D3DH   R   SEG=MAIN   2239# 2285
RKVVOD0. . . . . .  C ADDR   1457H   R   SEG=MAIN   3285 3292#
RLABELF. . . . . .  C ADDR   0D3AH   R   SEG=MAIN   2238# 2277
RLABELH. . . . . .  C ADDR   1184H   R   SEG=MAIN   2898# 2936
RLABELI. . . . . .  C ADDR   12CCH   R   SEG=MAIN   3073#
RLABELK. . . . . .  C ADDR   12C9H   R   SEG=MAIN   3072# 3075
RLABELL. . . . . .  C ADDR   0FBCH   R   SEG=MAIN   2618#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   148

RLABELL1 . . . . .  C ADDR   1139H   R   SEG=MAIN   2841 2844#
RLABELN. . . . . .  C ADDR   1040H   R   SEG=MAIN   2679 2683#
RLABELP. . . . . .  C ADDR   19B1H   R   SEG=MAIN   4061# 4064
RLABELS13. . . . .  C ADDR   1AC5H   R   SEG=MAIN   4202# 4230
RLABELS4 . . . . .  C ADDR   1AC2H   R   SEG=MAIN   4201# 4204
RLABL2 . . . . . .  C ADDR   14BDH   R   SEG=MAIN   3336#
RLABM. . . . . . .  C ADDR   14C0H   R   SEG=MAIN   3337# 3341
RLEFCUR. . . . . .  C ADDR   177EH   R   SEG=MAIN   3773# 3777
RLER . . . . . . .  C ADDR   2571H   R   SEG=MAIN   5952 5954#
RLIST_43 . . . . .  C ADDR   1815H   R   SEG=MAIN   3847# 3849
RMAS4. . . . . . .  C ADDR   0479H   R   SEG=MAIN   959# 961
RME21_23 . . . . .  C ADDR   17E5H   R   SEG=MAIN   3805 3824#
RMO220 . . . . . .  C ADDR   066AH   R   SEG=MAIN   1215# 1262
RNNMEMB. . . . . .  C ADDR   1046H   R   SEG=MAIN   2686# 2689
RNO3PARN . . . . .  C ADDR   09F1H   R   SEG=MAIN   1720# 1734
RNOBUF0. . . . . .  C ADDR   0B0EH   R   SEG=MAIN   1897 1920#
RNOCHI0. . . . . .  C ADDR   07BCH   R   SEG=MAIN   1383 1387#
RNOH37 . . . . . .  C ADDR   1323H   R   SEG=MAIN   3123# 3127 3134 3148
RNOM31 . . . . . .  C ADDR   1655H   R   SEG=MAIN   3606# 3607
RNOMEMK. . . . . .  C ADDR   1414H   R   SEG=MAIN   3260# 3278
RNORVICH . . . . .  C ADDR   09EFH   R   SEG=MAIN   1662 1663 1719#
RNOT1IN. . . . . .  C ADDR   0AC3H   R   SEG=MAIN   1800 1870#
RNOTESTIZM . . . .  C ADDR   0680H   R   SEG=MAIN   1229# 1264
ROUSTA . . . . . .  C ADDR   199DH   R   SEG=MAIN   4045 4053#
ROUSTA1. . . . . .  C ADDR   19AEH   R   SEG=MAIN   4053 4059#
ROUT6. . . . . . .  C ADDR   0D37H   R   SEG=MAIN   2237# 2276
ROUT7. . . . . . .  C ADDR   1181H   R   SEG=MAIN   2897# 2930 2935
ROUTF. . . . . . .  C ADDR   1320H   R   SEG=MAIN   3119# 3193
RR0. . . . . . . .  N NUMB   0000H   A      441# 2248 2860 2907 4544
RR1. . . . . . . .  N NUMB   0001H   A      442# 2249 2859 2908 4543
RR2. . . . . . . .  N NUMB   0002H   A      444# 1271 1283 1289 1301 1313 1324 2250 2858 2909 3875 3883 4542 4697
                                           4709 4715 4727 5359
RR3. . . . . . . .  N NUMB   0003H   A      445# 1272 1282 1290 1300 1314 1325 2251 2857 2910 3876 3882 4541 4698
                                           4708 4716 4726 5360
RR4. . . . . . . .  N NUMB   0004H   A      1273 1281 1291 1299 1315 1326 2252 2856 2911 3877 3881 4540 4699 4707
                                           4717 4725 6516# 6573 6594 6610 6654 6676
RR5. . . . . . . .  N NUMB   0005H   A      1274 1280 1292 1298 1316 1327 2253 2855 2912 3878 3880 4539 4700 4706
                                           4718 4724 6517# 6574 6581 6588 6655 6664
RR6. . . . . . . .  N NUMB   0006H   A      443# 2254 2854 2913 4538
RR7. . . . . . . .  N NUMB   0007H   A      446# 2255 2853 2914 4537
RRIR . . . . . . .  C ADDR   257EH   R   SEG=MAIN   5963 5965#
RRMO220. . . . . .  C ADDR   07B9H   R   SEG=MAIN   1360 1386#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   098EH   R   SEG=MAIN   1652# 1664 1666 1667
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 501
RTIZMRI. . . . . .  C ADDR   0EC6H   R   SEG=MAIN   2474#
RVVIZKO. . . . . .  C ADDR   1301H   R   SEG=MAIN   3106# 3114
RVVKALI52. . . . .  C ADDR   1AF1H   R   SEG=MAIN   4223 4225#
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SADIAP . . . . . .  D ADDR   0034H   A      314# 578 1932 3928
SADIAP2. . . . . .  D ADDR   0032H   A      316# 1935 3931
SADIAP3. . . . . .  D ADDR   0031H   A      317# 1938 3934
SADIAP4. . . . . .  D ADDR   0030H   A      318# 1941 3936
SAUS . . . . . . .  D ADDR   0036H   A      313# 2069 2071 2088 2090 2134 2136 2215 2217
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2268 2564 2582 2772 2816 2836 2926 3536 3591 3696 4212 4339 4445
                                           6028 6036
SAVEIR2. . . . . .  C ADDR   2782H   R   SEG=MAIN   900 937 1019 1075 6121#
SAVELTE. . . . . .  C ADDR   04A7H   A      8351#
SAVEN_BL . . . . .  D ADDR   00D3H   A      406# 599 6389 6420
SAVEN_BL2. . . . .  D ADDR   00C0H   A      399# 607 6408 6430
SAVEN_BL3. . . . .  D ADDR   00C2H   A      400# 614 6412 6434
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   149

SAVEN_BL4. . . . .  D ADDR   00D9H   A      410# 621 6414 6437
SAVER2 . . . . . .  C ADDR   278EH   R   SEG=MAIN   591 593 595 597 805 815 817 840 858 874 888 1131 1143 1152 1197
                                           1202 1252 1352 1372 1378 1389 1473 1477 1678 2001 2047 2086 2115 2163 2175
                                           2201 2213 3047 3054 3906 4383 4475 4633 4735 4834 4846 4866 4941 5006 5022
                                           5037 5092 5157 5172 5184 5972 6135# 6472
SAVE_HL. . . . . .  C ADDR   28B5H   R   SEG=MAIN   1927 3387 3424 3443 3465 3487 3737 6387#
SA_HL. . . . . . .  C ADDR   28BCH   R   SEG=MAIN   6390# 6409 6413 6415
SA_HL1 . . . . . .  C ADDR   28D7H   R   SEG=MAIN   6388 6407#
SA_HL2 . . . . . .  C ADDR   28DEH   R   SEG=MAIN   6407 6411#
SA_HL3 . . . . . .  C ADDR   28E5H   R   SEG=MAIN   6411 6414#
SBUF0. . . . . . .  D ADDR   0099H   A      40# 5201 5207
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160 509 5202 5206 5209 5210 5231
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   219AH   R   SEG=MAIN   5259# 5266
SDV1 . . . . . . .  C ADDR   21AEH   R   SEG=MAIN   5271# 5277
SDVIG0 . . . . . .  C ADDR   0309H   R   SEG=MAIN   765# 767
SDVIG1 . . . . . .  C ADDR   02FEH   R   SEG=MAIN   757# 759
SDVIG2 . . . . . .  C ADDR   02F3H   R   SEG=MAIN   749# 751
SDVIG3 . . . . . .  C ADDR   02E7H   R   SEG=MAIN   740# 742
SDVIG4 . . . . . .  C ADDR   0318H   R   SEG=MAIN   775# 777
SDVIG6 . . . . . .  C ADDR   0322H   R   SEG=MAIN   782# 784
SDVM . . . . . . .  C ADDR   0320H   R   SEG=MAIN   772 781#
SEEGOON. . . . . .  C ADDR   09F6H   R   SEG=MAIN   1704 1709 1711 1717 1724#
SEEIND . . . . . .  C ADDR   0A04H   R   SEG=MAIN   1644 1651 1652 1736#
SEE_L43. . . . . .  C ADDR   18ECH   R   SEG=MAIN   3945 3953 3956#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      7447# 7468 7469 7494 7495 7519 7662 7679 7900 7940
SKOR19 . . . . . .  C ADDR   19FCH   R   SEG=MAIN   4090 4097#
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   1390H   R   SEG=MAIN   3188# 3204
SP . . . . . . . .  D ADDR   0081H   A      17# 462
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 507
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 506
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 5248
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SPWRI. . . . . . .  C ADDR   1A9DH   R   SEG=MAIN   4180 4182#
SS1. . . . . . . .  C ADDR   22D0H   R   SEG=MAIN   5508# 5510
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      394# 802 804 819 837 839 855 857 871 873 1410 1619 2342 3034
SUMT2. . . . . . .  C ADDR   0374H   R   SEG=MAIN   793 834#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196 520 1963 2890 4568 5193
T2MSME . . . . . .  C ADDR   1742H   R   SEG=MAIN   3745# 3751
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   2470H   R   SEG=MAIN   5784# 5794
TABN . . . . . . .  C ADDR   2508H   R   SEG=MAIN   5886# 5890
TABT11 . . . . . .  C ADDR   2288H   R   SEG=MAIN   5445# 5866
TABT7. . . . . . .  C ADDR   228CH   R   SEG=MAIN   4672 5449# 5879
TABT9. . . . . . .  C ADDR   228AH   R   SEG=MAIN   5447# 5876
TABUS. . . . . . .  C ADDR   2274H   R   SEG=MAIN   5381 5434#
TAKTIND. . . . . .  C ADDR   0A41H   R   SEG=MAIN   1771 1774#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   150

TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 498 499 513
TE10MS . . . . . .  C ADDR   25D4H   R   SEG=MAIN   3744 6051#
TE22 . . . . . . .  C ADDR   24FBH   R   SEG=MAIN   5865 5875#
TE23 . . . . . . .  C ADDR   2503H   R   SEG=MAIN   5875 5879#
TE2MS. . . . . . .  C ADDR   25CAH   R   SEG=MAIN   3750 6050#
TEAEQU0. . . . . .  C ADDR   2610H   R   SEG=MAIN   3161 6059#
TEAVK. . . . . . .  C ADDR   264CH   R   SEG=MAIN   4589 6066#
TEBEQU0. . . . . .  C ADDR   261AH   R   SEG=MAIN   6060#
TEBL . . . . . . .  C ADDR   2700H   R   SEG=MAIN   2731 3329 6088#
TEBL0. . . . . . .  C ADDR   270AH   R   SEG=MAIN   3555 6089#
TECH . . . . . . .  C ADDR   2714H   R   SEG=MAIN   3836 4003 6090#
TECLE. . . . . . .  C ADDR   26C5H   R   SEG=MAIN   2723 3297 6082#
TEEND. . . . . . .  C ADDR   2764H   R   SEG=MAIN   4686 6099#
TEERR. . . . . . .  C ADDR   275AH   R   SEG=MAIN   6043 6098#
TEFULL . . . . . .  C ADDR   26ECH   R   SEG=MAIN   2738 3522 6086#
TEINT. . . . . . .  C ADDR   26F6H   R   SEG=MAIN   3622 6087#
TEIZMK . . . . . .  C ADDR   26A7H   R   SEG=MAIN   2522 3100 6079#
TEKALIB. . . . . .  C ADDR   2656H   R   SEG=MAIN   3812 4592 6067#
TEKD . . . . . . .  C ADDR   269DH   R   SEG=MAIN   4269 6078#
TELIST . . . . . .  C ADDR   26E1H   R   SEG=MAIN   2706 3246 3308 3314 6085#
TEMAX. . . . . . .  C ADDR   2732H   R   SEG=MAIN   4039 6093#
TEMEM. . . . . . .  C ADDR   26CFH   R   SEG=MAIN   6083#
TEMENU . . . . . .  C ADDR   2624H   R   SEG=MAIN   6061#
TEMID. . . . . . .  C ADDR   273CH   R   SEG=MAIN   4047 6094#
TEMIN. . . . . . .  C ADDR   2728H   R   SEG=MAIN   3567 4055 6092#
TEMUL. . . . . . .  C ADDR   0767H   R   SEG=MAIN   1307 1344#
TENMIN . . . . . .  C ADDR   2372H   R   SEG=MAIN   1210 1212 1226 5576#
TEOLI. . . . . . .  C ADDR   2746H   R   SEG=MAIN   1511 6096#
TEOLL. . . . . . .  C ADDR   26BBH   R   SEG=MAIN   1605 6081#
TEOLR. . . . . . .  C ADDR   2750H   R   SEG=MAIN   1507 6097#
TEOUT. . . . . . .  C ADDR   26B1H   R   SEG=MAIN   2530 2611 3091 6080#
TEPAR. . . . . . .  C ADDR   2693H   R   SEG=MAIN   4609 6077#
TES19_2. . . . . .  C ADDR   2689H   R   SEG=MAIN   530 2663 4097 4321 6075#
TES57_6. . . . . .  C ADDR   267FH   R   SEG=MAIN   2657 4091 4316 4605 6074#
TESKOR . . . . . .  C ADDR   2642H   R   SEG=MAIN   4586 6065#
TEST01 . . . . . .  C ADDR   2135H   R   SEG=MAIN   5206# 5229
TEST02 . . . . . .  C ADDR   2164H   R   SEG=MAIN   5226 5228#
TEST04 . . . . . .  C ADDR   2145H   R   SEG=MAIN   5213# 5215
TEST1. . . . . . .  C ADDR   212BH   R   SEG=MAIN   5201# 5217 5238
TEST2. . . . . . .  C ADDR   215DH   R   SEG=MAIN   5206 5225#
TEST22 . . . . . .  C ADDR   1A72H   R   SEG=MAIN   4147 4154#
TEST23 . . . . . .  C ADDR   1A77H   R   SEG=MAIN   4154 4157#
TEST3. . . . . . .  C ADDR   214FH   R   SEG=MAIN   5208 5218#
TEST4. . . . . . .  C ADDR   213DH   R   SEG=MAIN   5209# 5224
TEST5. . . . . . .  C ADDR   2167H   R   SEG=MAIN   5227 5230#
TEST7I . . . . . .  C ADDR   0A59H   R   SEG=MAIN   1786 1789#
TEST9I . . . . . .  C ADDR   0A52H   R   SEG=MAIN   1781 1786#
TESTAT . . . . . .  C ADDR   271EH   R   SEG=MAIN   2714 3288 6091#
TESTRS . . . . . .  C ADDR   2129H   R   SEG=MAIN   4080 5199#
TESTS. . . . . . .  C ADDR   1A66H   R   SEG=MAIN   4149# 4156 4159
TETE11 . . . . . .  C ADDR   2661H   R   SEG=MAIN   4069 4596 6069#
TETE7. . . . . . .  C ADDR   2675H   R   SEG=MAIN   4136 4602 6071#
TETE9. . . . . . .  C ADDR   266BH   R   SEG=MAIN   4599 6070#
TETESI . . . . . .  C ADDR   262EH   R   SEG=MAIN   2995 4579 6063#
TETESR . . . . . .  C ADDR   2638H   R   SEG=MAIN   4583 6064#
TEVICH . . . . . .  C ADDR   2606H   R   SEG=MAIN   2364 2538 3096 4484 6058#
TEWR . . . . . . .  C ADDR   26D7H   R   SEG=MAIN   2697 3303 6084#
TEXTT. . . . . . .  C ADDR   25CAH   R   SEG=MAIN   5461 6049#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 481
TH1. . . . . . . .  D ADDR   008DH   A      29# 528 532 4194 4196
TH2. . . . . . . .  D ADDR   00CDH   A      89# 1960 2887 4565
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   151

TIM. . . . . . . .  C ADDR   21BEH   R   SEG=MAIN   5280#
TIM1 . . . . . . .  C ADDR   21C0H   R   SEG=MAIN   5281# 5281
TIM2 . . . . . . .  C ADDR   21C3H   R   SEG=MAIN   5262 5265 5272 5276 5284# 5327 5331 6308 6310
TIM3 . . . . . . .  C ADDR   21C5H   R   SEG=MAIN   5285# 5285
TIZMRI . . . . . .  C ADDR   0DE5H   R   SEG=MAIN   2320# 2474
TL0. . . . . . . .  D ADDR   008AH   A      26# 482
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88# 1961 2888 4566
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   138DH   R   SEG=MAIN   3173 3185#
TMOD . . . . . . .  D ADDR   0089H   A      25# 479 512
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 496
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 495
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TOME13 . . . . . .  C ADDR   19DDH   R   SEG=MAIN   4078 4083#
TOME14 . . . . . .  C ADDR   1A0AH   R   SEG=MAIN   4083 4104#
TOME15 . . . . . .  C ADDR   1A22H   R   SEG=MAIN   4104 4116#
TOME21 . . . . . .  C ADDR   19D4H   R   SEG=MAIN   4067 4078#
TOSK19 . . . . . .  C ADDR   1BA1H   R   SEG=MAIN   4315 4321#
TOUTF. . . . . . .  C ADDR   130AH   R   SEG=MAIN   3110# 3113
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TTOUT. . . . . . .  C ADDR   0EC9H   R   SEG=MAIN   2476# 2485
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 5249
UNPACK1. . . . . .  C ADDR   009EH   A      7465# 7659 7793 7923 8037
UNPACK2. . . . . .  C ADDR   00BAH   A      7490# 7660 7794 7924
UP1. . . . . . . .  C ADDR   0138H   A      7610# 7627
UP2. . . . . . . .  C ADDR   014BH   A      7630# 7648
UP2A . . . . . . .  C ADDR   0161H   A      7609 7646#
UPA. . . . . . . .  C ADDR   23A1H   R   SEG=MAIN   5631# 5637
UPA1 . . . . . . .  C ADDR   23B1H   R   SEG=MAIN   5649# 5655
UPA2 . . . . . . .  C ADDR   2391H   R   SEG=MAIN   5612# 5618
UPAA . . . . . . .  C ADDR   288DH   R   SEG=MAIN   6356# 6362
UPAA4. . . . . . .  C ADDR   23FCH   R   SEG=MAIN   5712# 5718
UPAB . . . . . . .  C ADDR   240CH   R   SEG=MAIN   5729# 5735
UPAK . . . . . . .  C ADDR   239BH   R   SEG=MAIN   5628#
UPAK1. . . . . . .  C ADDR   2867H   R   SEG=MAIN   6321#
UPAK2. . . . . . .  C ADDR   238BH   R   SEG=MAIN   5609#
UPAK3. . . . . . .  C ADDR   23ABH   R   SEG=MAIN   3765 3860 5646#
UPAK4. . . . . . .  C ADDR   2887H   R   SEG=MAIN   3719 6353#
UPAKA. . . . . . .  C ADDR   23F6H   R   SEG=MAIN   4467 5709#
UPAKB. . . . . . .  C ADDR   2406H   R   SEG=MAIN   4514 5726#
UPAV1. . . . . . .  C ADDR   1B10H   R   SEG=MAIN   4249# 4255
UPAV2. . . . . . .  C ADDR   1BD3H   R   SEG=MAIN   4366# 4372
UPK1 . . . . . . .  C ADDR   2879H   R   SEG=MAIN   6329 6332#
UPK2 . . . . . . .  C ADDR   287AH   R   SEG=MAIN   6331 6333#
VICHMAX. . . . . .  C ADDR   2068H   R   SEG=MAIN   4041 5063#
VICHMEAN . . . . .  C ADDR   1EACH   R   SEG=MAIN   4049 4775#
VICHMIN. . . . . .  C ADDR   1F8FH   R   SEG=MAIN   3569 4057 4913#
VICHR. . . . . . .  D ADDR   00B1H   A      392# 1265 1777 2361 2370 2504 2517 2622 2630 2999 3003 3011 3085 3152
                                           3264 3801 3809 3818 4062 4113 4127 4267 4458 4497 4529 4577 5864
VIG0 . . . . . . .  C ADDR   0AAFH   R   SEG=MAIN   1854# 1856
VIG4 . . . . . . .  C ADDR   0ABDH   R   SEG=MAIN   1865# 1867
VIOUT. . . . . . .  C ADDR   0EA0H   R   SEG=MAIN   2367 2449# 2477
VIOUTF . . . . . .  C ADDR   1303H   R   SEG=MAIN   3107#
VIT2_10. . . . . .  C ADDR   0E13H   R   SEG=MAIN   2350# 2356
VODM11_15. . . . .  C ADDR   17A1H   R   SEG=MAIN   3790# 3808
VOLUME . . . . . .  D ADDR   00D5H   A      407# 2308 3732 6397 6399
VV21_23. . . . . .  C ADDR   1A5DH   R   SEG=MAIN   4133 4145#
VVCHIBL. . . . . .  C ADDR   253FH   R   SEG=MAIN   2605 5918#
VVCHIF . . . . . .  C ADDR   251AH   R   SEG=MAIN   5894# 5911
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   152

VVINTE . . . . . .  C ADDR   1702H   R   SEG=MAIN   3683 3711#
VVIZKO . . . . . .  C ADDR   135AH   R   SEG=MAIN   3106 3152#
VVKALI52 . . . . .  C ADDR   1BC6H   R   SEG=MAIN   4225 4350# 4402
VVMENU . . . . . .  C ADDR   1B76H   R   SEG=MAIN   4232 4303#
VVNOL23. . . . . .  C ADDR   253AH   R   SEG=MAIN   5915# 5919
VVNOL31. . . . . .  C ADDR   2535H   R   SEG=MAIN   5913# 5915
VVNOL41. . . . . .  C ADDR   2533H   R   SEG=MAIN   5911# 5913
VVOD2_10 . . . . .  C ADDR   173AH   R   SEG=MAIN   3273 3392 3492 3742#
VVOD43 . . . . . .  C ADDR   1918H   R   SEG=MAIN   3975 3982#
VVODM11_15 . . . .  C ADDR   19B4H   R   SEG=MAIN   3790 4062#
VVOSTA . . . . . .  C ADDR   1975H   R   SEG=MAIN   4018 4037#
VVOSTAD. . . . . .  C ADDR   1989H   R   SEG=MAIN   4037 4045#
VVRR6. . . . . . .  C ADDR   0F25H   R   SEG=MAIN   2522#
VV_52V . . . . . .  C ADDR   1AE8H   R   SEG=MAIN   4206 4222#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 477 478
WORK . . . . . . .  D ADDR   00B8H   A      396# 1492 1494 1500 1516 1523 1539 1560 1565 1581 1805 1883 3359 3369
                                           3371 3405 3415 3417 3427 3437 3439 3446 3456 3458 3468 3478 3480 4783 4830
                                           4833 4842 4845 4857 4919 4937 4940 4995 5005 5011 5021 5025 5070 5088 5091
                                           5146 5156 5161 5171 5203 5225
WR1. . . . . . . .  C ADDR   2854H   R   SEG=MAIN   6304# 6311
WRITE. . . . . . .  C ADDR   2851H   R   SEG=MAIN   671 5755 5757 5759 5761 5763 5765 5768 5770 5772 5775 5777 5779
                                           6302#
WRITED_X1. . . . .  C ADDR   21C9H   R   SEG=MAIN   5290#
WRITE_X1 . . . . .  C ADDR   21C8H   R   SEG=MAIN   5289#
WRPAGE . . . . . .  C ADDR   0480H   A      4191 4665 4767 8312#
WW5. . . . . . . .  C ADDR   0483H   A      8313# 8321
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 473 505
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 474
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 475 504
XCIKLWR. . . . . .  C ADDR   276EH   R   SEG=MAIN   895 908 910 912 915 918 921 924 927 930 963 965 967 970 973 976
                                           979 982 985 987 990 992 994 997 1000 1003 1006 1009 1012 1064 1066 1068
                                           6104#
XTEMP. . . . . . .  N NUMB   000CH   A      6513# 6877 6878 6879 6880 6966 6968 6969 6971 6972 6974 6975 6977 6999
                                           7000 7001 7002 7020 7021 7025 7026 7029 7033 7034 7037 7041 7042 7046 7047
                                           7049 7050 7051 7053 7057 7058 7060 7061 7065 7066 7071 7072 7074 7075 7079
                                           7080 7085 7087 7088 7089
YBNUL. . . . . . .  C ADDR   129BH   R   SEG=MAIN   3042 3050#
YES. . . . . . . .  C ADDR   2ABCH   R   SEG=MAIN   6899 6903 6907 6911 6929# 6992
YES0KEY. . . . . .  C ADDR   02C3H   R   SEG=MAIN   701 713#
YES0KEY1 . . . . .  C ADDR   02D0H   R   SEG=MAIN   720# 727
YESAVP . . . . . .  C ADDR   07C6H   R   SEG=MAIN   1366 1392#
YESBUF . . . . . .  C ADDR   0B13H   R   SEG=MAIN   1918 1923#
YESIND . . . . . .  C ADDR   0A5BH   R   SEG=MAIN   1776 1785 1788 1791#
YESPRD . . . . . .  C ADDR   0B11H   R   SEG=MAIN   1917 1921#
YESTEST. . . . . .  C ADDR   2263H   R   SEG=MAIN   5376 5408#
YESTT5 . . . . . .  C ADDR   0BE6H   R   SEG=MAIN   2039#
YESVICH. . . . . .  C ADDR   0811H   R   SEG=MAIN   1380 1431#
YESVI_KM . . . . .  C ADDR   1E15H   R   SEG=MAIN   4612 4692#
YESVI_KR . . . . .  C ADDR   1D8DH   R   SEG=MAIN   4612# 4614
YST1 . . . . . . .  C ADDR   01A2H   R   SEG=MAIN   529 533#
YST19. . . . . . .  C ADDR   019AH   R   SEG=MAIN   526 530#
Z01S . . . . . . .  C ADDR   22E8H   R   SEG=MAIN   5525# 5527
Z05S . . . . . . .  C ADDR   22F5H   R   SEG=MAIN   5534# 5536
Z100 . . . . . . .  C ADDR   22B9H   R   SEG=MAIN   5489# 5491
Z15. . . . . . . .  C ADDR   22C7H   R   SEG=MAIN   5501# 5503
Z1S. . . . . . . .  C ADDR   22DBH   R   SEG=MAIN   5517# 5519
ZAPADC . . . . . .  C ADDR   2198H   R   SEG=MAIN   5258#
ZCMP . . . . . . .  C ADDR   27F0H   R   SEG=MAIN   6211#
ZDIV . . . . . . .  C ADDR   27BDH   R   SEG=MAIN   813 1123 3899 6174#
ZER1 . . . . . . .  C ADDR   00B3H   A      7475 7479# 7534 7577
ZER2 . . . . . . .  C ADDR   00D4H   A      7501 7505#
ZMUL . . . . . . .  C ADDR   27B3H   R   SEG=MAIN   6169#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      324# 1698 3924 4884 5055 6182 6185 6188
ZNPLUS . . . . . .  C ADDR   02DAH   R   SEG=MAIN   682 729#
ZZ . . . . . . . .  C ADDR   22C9H   R   SEG=MAIN   5502# 5502
A51 MACRO ASSEMBLER  AMP33                                                                12/21/2007 13:06:25 PAGE   153

Z_01S. . . . . . .  C ADDR   22E4H   R   SEG=MAIN   2260 2261 2919 5223 5237 5523# 6040
Z_05S. . . . . . .  C ADDR   22F1H   R   SEG=MAIN   2033 2034 2734 4042 4050 4058 5532#
Z_100. . . . . . .  C ADDR   22B7H   R   SEG=MAIN   5488#
Z_15 . . . . . . .  C ADDR   22C5H   R   SEG=MAIN   650 5500#
Z_1MS. . . . . . .  C ADDR   22CEH   R   SEG=MAIN   720 5230 5507#
Z_1S . . . . . . .  C ADDR   22D7H   R   SEG=MAIN   639 647 1427 2366 3570 3843 3964 4016 4308 4394 4496 4689 4690
                                           5515#
Z_5. . . . . . . .  C ADDR   22C0H   R   SEG=MAIN   5294 5304 5495#
Z_9. . . . . . . .  C ADDR   284CH   R   SEG=MAIN   5251 6296#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
