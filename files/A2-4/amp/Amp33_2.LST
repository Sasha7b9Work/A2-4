A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp33_2.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp33_2.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236              
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                          jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti   
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 020000   F      262                                                     jmp             inter2  ;IE.5,IP.5(ET2,PT2)
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti 
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;53h..5dh 10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
  0039               310     nuerr                           DATA    39h;номер ошибки (для интерфейса)       
  0038               311     nblok                           DATA    38h;номер введенного блока
  0037               312     nelem                           DATA    37h;номер лемента в блоке 0..200
  0036               313     saus                            DATA    36h;сохр упр слово
  0034               314     sadiap                  DATA    34H;сохр диапазон на кот проходила запись блока1
  0033               315     chind2                          DATA    33h;счетчик индикации
  0032               316     sadiap2                 DATA    32h;сохр диапазон на кот проходила запись блока2
  0031               317     sadiap3                 DATA    31h;сохр диапазон на кот проходила запись блока3
  0030               318     sadiap4                 DATA    30h;сохр диапазон на кот проходила запись блока4
                     319     ;DATA           2fh
                     320     ;;;;;
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     6

  0020               321      cellbit                DATA    20h
  0000               322     bitznak         BIT     cellbit.0       ;20.0           
  0001               323     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               324     znmat           BIT             cellbit.2       ;20.2
  0003               325     bitrs           BIT             cellbit.3       ;20.3
  0004               326     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               327     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               328     bitvi11         BIT             cellbit.6       ;20.6   бит нажатия ввод режима вычислить R
                             !!!
  0007               329     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us 
                                  
                     330     
  0021               331     cellbit1                DATA    21h
  0008               332     bitbuf          BIT     cellbit1.0      ;21.0   
  0009               333     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               334     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               335     bitmem          BIT             cellbit1.3      ;21.3 нажата кн память
                     336     ;bmem11         BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               337     bifl_kt         BIT             cellbit1.5      ;21.5  бит для выч Км теста измерения  
                     338     ;bmem13         BIT             cellbit1.6      ;21.6            
  000F               339     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     340     
  0022               341     cellbit2                DATA    22h
  0010               342     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               343     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               344     bitklb          BIT             cellbit2.2      ;22.2  признак калибровки
  0013               345     bitv19          BIT             cellbit2.3      ;22.3           бит установки скор итерфейс
                             а 19.6
  0014               346     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               347     biteizm         BIT             cellbit2.5      ;22.5   признак теста измерения 
  0016               348     bitpar          BIT             cellbit2.6      ;22.6   бит проведенного 1раз пароля 
  0017               349     bitoll          BIT             cellbit2.7      ;22.7 бит перегрузки
                     350     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     351     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     352     ;и выдает т.н. буфер индикации  
  0023               353     cellbit3                DATA    23h
  0018               354     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               355     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               356     bitakt          BIT             cellbit3.2      ;22.2  бит такта
  001B               357     bitznB          BIT             cellbit3.3      ;22.3 БИТ ЗНАКА ПРИ ВВОДЕ константы В
                     358     ;bit            BIT             cellbit3.4      ;22.4    
                     359     ;bit            BIT             cellbit3.5      ;22.5    
                     360     ;bit            BIT             cellbit3.6      ;22.6            
                     361     ;bit            BIT             cellbit3.7      ;22.7
                     362             
  005E               363     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     364     ;hex
  0062               365     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               366     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               367     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               368     rez_A2   data 7bh; A2
                     369     
  0098               370     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               371     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               372     chdel    data  83h              ; счетчик задержки
                     373     ;float
  0084               374     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               375     rezAp    data  88h              ;4byte  A+
  008C               376     rezAm    data  8ch              ;4byte  A-
  0090               377     koefKp   data  90h              ;4byte  K+
  0094               378     koefKm   data  94h              ;4byte  K-
                     379     ;hex 
  009A               380     parT     data  9ah              ;параметр времени измерения
  009B               381     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               382     rez_A3   data  9ch              ;A3
                     383     ;FLOAT
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     7

  00A0               384     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               385     rez_Ak  data  0a4h         ;Ak
  00A8               386     parol           data  0a8h         ;храним в памяти пароль
  00AC               387     chind   data  0ach         ;счетчик индикации
                     388     ;chbuf  data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               389     diap    data  0aeh         ;номер диапазона
  00AF               390     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               391     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               392     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               393     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               394     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               395     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               396     work    data  0b8h        ;рабочая ячейка
  00BC               397     konstA  data  0bch        ;     введенная с крана константа A
                     398     ;konstB data  0c0h         ;    введенная с крана константа B
  00C0               399     saven_bl2       data    0c0h;;копия адреса последней записанной ячейки блока2
  00C2               400     saven_bl3       data  0c2h;копия адреса последней записанной ячейки блока3 
                     401                ;c4 1bait
  00C5               402     Rez_del data  0c5h      ;сумма n-значений /n
  00C9               403     rez_R           data    0c9h            ;рез вычисления R 4baita
  00CD               404     interva data  0cdh;значение интервала (запись)2baita
  00CF               405     chbuf   data  0cfh         ;счетчик периода загрузки в буфер и интерфейс
  00D3               406     saven_bl        data  0d3h;номер ячейки в блоке 2 baita
  00D5               407     volume          data    0d5h;объем блока 2 baita
  00D6               408     chblok          data    0d6h;volume;кол измерений блока
  00D7               409     copy_hl         data  0d7h;адрес ячейки блока для просмотра 
  00D9               410     saven_bl4       data  0d9h;копия адреса последней записанной ячейки блока4
                     411     ;data           0dbh e0h-граница стека
                     412     
                     413     ;внешнее ОЗУ 64K 
                     414     ;в обл внешнего озу 0..ffh читается страница рпзу и при записи в любую
                     415     ;ячейку  стирается целая страница 0..ffh рпзу
                     416     ;               XSEG AT 100h
                     417             PUBLIC    MASS0
  0100               418     MASS0  xdata 0100h;     скользящий массив измерения
  0104               419     MASS1  xdata 0104h;
  0108               420     MASS2  xdata 0108h;
  010C               421     MASS3  xdata 010ch;
  0110               422     MASS4  xdata 0110h;
  0114               423     MASS5  xdata 0114h;
  0118               424     MASS6  xdata 0118h;
  011C               425     MASS7  xdata 011ch;
  0120               426     MASS8  xdata 0120h;
  0124               427     MASS9  xdata 0124h;
  0128               428     MASS10  xdata 0128h;
  012C               429     MASS11  xdata 012ch;
  0130               430     MASS12  xdata 0130h;
  0134               431     MASS13  xdata 0134h;
  0138               432     MASS14  xdata 0138h;
  013C               433     MASS15  xdata 013ch;
  0140               434     MASS16  xdata 0140h;
  0144               435     MASS17  xdata 0144h;
  0148               436     MASS18  xdata 0148h;
  014C               437     MASS19  xdata 014ch;
  0E00               438     chbuf1  xdata 0e00h;счетчик буфера 1
                     439     ;xdata  0e04
                     440     
  0000               441                             rr0             EQU 00
  0001               442                     rr1       equ   01
  0006               443                     rr6   equ 06
  0002               444                     rr2       equ   02
  0003               445                     rr3       equ   03
  0007               446                     rr7   equ 07
                     447     
  0008               448                     r8   equ 08
  0009               449                     r9        equ   09
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     8

  000A               450                     r10       equ   10
  000B               451                     r11   equ 11
                     452     
                     453                     
                     454        
----                 455                  rseg     Main          ; Switch to this code segment.
                     456     
                     457                  using    0              ; Specify register bank for the following
                     458     
0100                 459     org 100h
                     460     ;$EJECT
                     461     
0100 7581E0          462     begin:     mov  sp, #0e0h
0103 75E900          463                                             mov             PCA0L,#00;=0x00;
0106 75D900          464                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          465                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          466                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          467                                             mov     P2MDOUT,#00;=0x00;
                     468             
0112 75A73F          469             mov     P3MDOUT,#3fh;
0115 75B5FF          470             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          471             mov     REF0CN,#03h;=0x03;
                     472             
011B 75E114          473             mov     XBR0,#14h;= 0x14;
011E 75E200          474             mov     XBR1,#00; =0x00;
0121 75E300          475             mov XBR2,#00;=0x00;
0124 75B0C0          476             mov     P3,#0c0h
0127 75FFDE          477             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          478             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          479             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          480             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          481             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          482             mov     TL0,#0f9h;=0xf9; 
0139 75E680          483             mov     EIE1,#80h;=0x80;
                     484     
013C 75D480          485             mov     DAC0CN,#80h;=0x80;
013F 75D780          486             mov     DAC1CN,#80h;=0x80;
0142 75B167          487             mov     OSCXCN,#67h;=0x67;
                     488     
                     489      
                     490     
0145 E5B1            491     gener:     mov a, oscxcn
0147 B4E7FB          492                cjne a,#11100111b,gener
                     493                            
014A 75B288          494             mov     OSCICN,#88h;=0x84;
014D 75CA00          495         mov TMR2RLL,#0;=0;
0150 75CBD1          496         mov TMR2RLH,#0d1h;=0xd1;
                     497       
0153 D28E            498                     setb  TCON.6                    ;регистр управления
0155 D28C            499                      setb tcon.4
                     500     
0157 75EF00          501             mov     RSTSRC,#0;=00   ;//источники сброса 
                     502     
                     503             
015A 75E340          504          mov        XBR2,#40h
015D 75E10E          505              mov    XBR0,#0eh;06h;16h
0160 75F803          506             mov             SPI0CN,#03
0163 759D31          507             mov             spi0ckr,#31H;;;;;;;;#04
                     508     ;установка скорости
0166 759850          509                                             mov             SCON0,#50h;01010000;скорость обмена
                              определяется таймером1
0169 758780          510                                             mov             PCON,#10000000b;удвоенная скорость 
                             передачи SMOD0=1
016C 758E10          511                                             mov             CKCON,#00010000b;TIM=1
016F 758920          512                                             mov             TMOD,#00100000b;реж2 внутр ист синх
                             р
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE     9

0172 758840          513                                             mov             TCON,#01000000b;счетчик запущен
                     514                                             ;;;;;
0175 75D900          515                                             mov             PCA0MD,#00              ;PCA 
0178 75DA00          516                                             mov             PCA0CPM0,#00000000b;00000110b;01000
                             010b;
017B 75EA00          517                                             mov             PCA0CPL0,#00
017E 75FA80          518                                             mov             PCA0CPH0,#80h
0181 75D840          519                                             mov             PCA0CN,#40h
0184 75C800          520                                             mov             T2CON,#00
                     521                                             ;;;;;
0187 7A50            522                                             mov                     r2,#50h                    
                                  ;57.6->19.2
0189 7B2C            523                                             mov                     r3,#2ch
018B 120454          524                                             call            re4byte                 ;502ch 1 ba
                             it skor
018E E508            525                                             mov                     a,r8
0190 B40007          526                                             cjne            a,#00,yst19
0193 C213            527                                             clr                     bitv19                  ;57
                             .6
0195 758DF4          528                                             mov                     TH1,#244
0198 8008            529                                             jmp               yst1
019A 900000   F      530     yst19:          mov                     dptr,#teS19_2
019D D213            531                                             setb            bitv19                  ;19,2
019F 758DDC          532                                             mov                     TH1,#220
01A2                 533     yst1:
01A2 75E730          534                                             mov             EIE2,#30H;00110000
                     535                                     ;       mov             EIP2,#30H
01A5 75A880          536                                             mov     IE,#80h;//10000000      ;//Снятие блокировк
                             и всех прерываний
                     537     ;ozu
01A8 E4              538                                             clr     a
01A9 7800            539                                             mov     r0,#00h 
01AB F6              540     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
01AC 08              541                                             inc     r0
01AD B87FFB          542                                             cjne    r0,#7fh,mecle
01B0 7880            543                                             mov     r0,#80h
01B2 F6              544     meff:                   mov     @r0,a 
01B3 F2              545                                             movx @r0,a
01B4 08              546                                             inc     r0
01B5 B8DFFA          547                             cjne    r0,#0dfh,meff
01B8 120000   F      548                             call    clmassix
                     549     ;обнулить внешнее озу 4кбайта
01BB 900000          550                                     mov                     dptr,#0
01BE E4              551     extcle: clr                     a
01BF F0              552                                     movx            @dptr,a
01C0 A3              553                                     inc                     dptr
01C1 E583            554                                     mov                     a,dph
01C3 B410F8          555                                     cjne            a,#10h,extcle
                     556     
01C6 7898            557                             mov             r0,#chinkor
01C8 7600            558                             mov             @r0,#0;1;
01CA 08              559                             inc             r0
01CB 7619            560                             mov             @r0,#19h;64h;0c8h;90h;
                     561                             ;;;;
01CD 7881            562                             mov             r0,#chavt
01CF 7601            563                             mov             @r0,#1
01D1 08              564                             inc             r0
01D2 7690            565                             mov             @r0,#90h
                     566     
01D4 78B2            567                                     mov             r0,#marker
01D6 76FF            568                                     mov             @r0,#0ffh
                     569                             ;mov            r0,#chind
                     570                             ;mov            @r0,#1
                     571                     
01D8 74FF            572                             mov             a,#0ffh
01DA F585            573                        mov          p5,a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    10

01DC 799A            574                             mov             r1,#parT
01DE 7702            575                             mov             @r1,#2                  ;Tizm=1s
01E0 79AE            576                             mov             r1,#diap
01E2 7705            577                             mov             @r1,#5                  ;10-7a
01E4 753405          578                             mov             sadiap,#5
01E7 79AF            579                             mov             r1,#parN
01E9 7702            580                             mov             @r1,#2
01EB 7400            581                             mov             a,#00h
01ED F585            582                             mov             p5,a
01EF D204            583                             setb    bitizm
                     584     
01F1 799B            585                             mov             r1,#chbefore
01F3 7700            586                             mov             @r1,#0
                     587                             ;;;;;;
01F5 900000   F      588                             mov             dptr,#ch_1              ;1->r2..r5 float
01F8 120000   F      589                             call    ldc_long
01FB 7890            590                             mov             r0,#koefKp         ;1(float)->koefKp
01FD 120000   F      591                             call    saver2
0200 7894            592                             mov             r0,#koefKm              ;1(float)->koefKm
0202 120000   F      593                             call    saver2
0205 78A0            594                             mov             r0,#koefKD
0207 120000   F      595                             call    saver2
020A 78CF            596                             mov                     r0,#chbuf
020C 120000   F      597                             call    saver2
020F 900158          598                             mov                     dptr,#158h;1 блок(2е с конца измерение) 
0212 79D3            599                             mov             r1,#saven_bl
0214 E583            600                             mov             a,dph
0216 F7              601                                               mov           @r1,a
0217 09              602                                                     inc             r1
0218 E582            603                                                     mov             a,dpl
021A F7              604                                                     mov             @r1,a
                     605     
021B 900478          606                             mov                     dptr,#478h;2 блок(2е с конца измерение) 
021E 79C0            607                             mov             r1,#saven_bl2
0220 E583            608                             mov             a,dph
0222 F7              609                                               mov           @r1,a
0223 09              610                                                     inc             r1
0224 E582            611                                                     mov             a,dpl
0226 F7              612                                                     mov             @r1,a
0227 900798          613                                     mov                     dptr,#798h;3 блок(2е с конца измере
                             ние) 
022A 79C2            614                             mov             r1,#saven_bl3
022C E583            615                             mov             a,dph
022E F7              616                                               mov           @r1,a
022F 09              617                                                     inc             r1
0230 E582            618                                                     mov             a,dpl
0232 F7              619                                                     mov             @r1,a
0233 900AB8          620                             mov                     dptr,#0ab8h;4 блок(2е с конца измерение)   
                                  
0236 79D9            621                             mov             r1,#saven_bl4
0238 E583            622                             mov             a,dph
023A F7              623                                               mov           @r1,a
023B 09              624                                                     inc             r1
023C E582            625                                                     mov             a,dpl
023E F7              626                                                     mov             @r1,a
023F 753801          627                             mov             nblok,#1                        ;номер введенного б
                             лока
0242 753701          628                             mov             nelem,#1
0245 78CD            629                             mov             r0,#interva
0247 7600            630                             mov             @r0,#0
0249 08              631                             inc             r0
024A 7601            632                             mov             @r0,#1
024C 7840            633                             mov             r0,#bufind
024E                 634     age2:
024E 76FD            635                             mov             @r0,#0fdh         ;погасить индикатор
0250 08              636                             inc             r0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    11

0251 B84CFA          637                             cjne    r0,#bufind+12,age2              
0254 120000   F      638                             call    ind
0257 120000   F      639                             call    z_1s
                     640     
                     641                                     ;зажечь все лементы индикации
025A 7840            642                             mov             r0,#bufind
025C 7669            643     ageon:          mov             @r0,#69h;0feh;?
025E 08              644                             inc             r0
025F B84CFA          645                             cjne    r0,#bufind+12,ageon             
0262 120000   F      646                             call    ind
0265 120000   F      647                             call    z_1s            ;1sec
                     648     ;;;;;;;;;;;;;;;;
                     649                     
0268 120000   F      650                             call    z_15;z_1ms
026B 434B10          651                             orl             bufind+11,#10h;бит точки после 1 знакоместа
                     652     ;;;;;;;;;;;;;;;;;;;
026E 7C60            653                             mov             r4,#60h
0270 7D00            654                             mov             r5,#00         
0272 120000   F      655                             call    iniacp;инициализация acp
0275 120000   F      656                             call    loadUS          ;us 10-7 A
                     657                             
0278 C217            658     rebyte:         clr             bitoll
027A 3095FD          659                             jnb             p1.5,$
027D 2095FD          660                             jb              p1.5,$
                     661                             ;mov            a,P6            ;p6.4=0
                     662                             ;anl            a,#0efh
                     663                             ;mov            P6,a
                     664                             ;nop
                     665                             ;nop
                     666                                     
                     667                             ;mov            a,P6                    ;p6.4=1 
                     668                             ;orl            a,#10h
                     669                             ;mov            P6,a                        
0280 7411            670                             mov             a,#11h
0282 120000   F      671                             call    write
                     672                             ;чтение acp
0285 120000   F      673                             call    read    
0288 F578            674                             mov     reacp+1,A       ;старший байт 
028A 120000   F      675                             call    read    
028D F579            676                             mov     reacp+2,A       ;средний байт 
028F 120000   F      677                             call    read
0292 F57A            678                             mov     reacp+3,A               ;мл байт
                     679                        ;;;;;;;;;;;
0294 7878            680                        mov          r0,#reacp+1
0296 E6              681                        mov          a,@r0
0297 20E740          682                             jb              acc.7,znplus;
029A D200            683                             setb    bitznak
029C 4480            684                             orl             a,#80h  ;ост содерж яч 
029E F6              685                             mov             @r0,a
                     686                                     
029F 18              687     mmm:            dec             r0;,#reacp
02A0 76FF            688                             mov             @r0,#0ffh
02A2 803E            689                             jmp             goznak
                     690     
02A4 120000   F      691     mem10ms:        call            ind
02A7 80CF            692                                             jmp                     rebyte                     
                                  ;10ms
                     693     
02A9                 694     labelA: 
                     695                             ;разрешить ie6,ie7
02A9 E53E            696                             mov                     a,chkl+1                ;low
02AB 7009            697                             jnz                     no0key
02AD E53D            698                             mov                     a,chkl
02AF 7005            699                             jnz                     no0key
02B1 75E730          700                             mov                     EIE2,#30h ;EIE2.5,EIE2.4
02B4 800D            701                             jmp                     yes0key
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    12

                     702                        
02B6                 703     no0key: ;       mov             r1,#chkl 
                     704                                     ;       call    chdec
02B6 C3              705                                     clr                     c
02B7 E53E            706                                     mov                     a,chkl+1;chkl-1
02B9 9401            707                                     subb            a,#1
02BB F53E            708                                     mov                     chkl+1,a
02BD E53D            709                                     mov                     a,chkl
02BF 9400            710                                     subb            a,#0
02C1 F53D            711                                     mov                     chkl,a
                     712                             ;;;;;;;;;;;;
02C3                 713     yes0key:
02C3 2004B2          714                                             jb              bitizm,rebyte
                     715                              ;буфер 2 выдать на индикацию
02C6 E533            716                             mov             a,chind2                        ;реже выдавать на и
                             ндикацию
02C8 700B            717                             jnz             nochind
02CA 753364          718                             mov             chind2,#100
02CD 120000   F      719                             call    ind
02D0 120000   F      720     yes0key1:       call    z_1ms;z_01s
                     721                             ;call   z_01s
                     722                             ;call   z_01s
02D3 80D4            723                             jmp             labelA
                     724     
02D5 14              725     nochind:        dec             a
02D6 F533            726                                             mov             chind2,a
02D8 80F6            727                                     jmp             yes0key1;labelA
                     728             
02DA C200            729     znplus:         clr     bitznak
02DC 547F            730                             anl             a,#7fh;fdh                      ;+
02DE F6              731                             mov             @r0,a
02DF 18              732                             dec             r0;,#reacp
02E0 7600            733                             mov             @r0,#00h
                     734                             
02E2                 735     goznak: 
                     736     ;;;;;;;;;;;;;
02E2 787A            737                             mov     r0,#reacp+3
02E4 E6              738                             mov             a,@r0
02E5 7F05            739                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
02E7 C3              740     sdvig3:         clr             c
02E8 13              741                             rrc             a
02E9 DFFC            742                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
02EB FA              743                             mov             r2,a    ;сохр байт
02EC 18              744                             dec             r0              ;       reacp+2
02ED E6              745                             mov             a,@r0
02EE C0E0            746                             push    acc
02F0 C3              747                             clr             c
02F1 7F03            748                             mov             r7,#3;2
02F3 C3              749     sdvig2:         clr             c
02F4 33              750                             rlc             a
02F5 DFFC            751                             djnz    r7,sdvig2 ;d12..d11      средний байт
02F7 4A              752                             orl             a,r2
02F8 F57A            753                             mov             reacp+3,a;сформ мл байт
02FA D0E0            754                             pop             acc
                     755                             
02FC 7F05            756                             mov             r7,#5;6
02FE C3              757     sdvig1:         clr             c
02FF 13              758                             rrc             a
0300 DFFC            759                             djnz    r7,sdvig1 ;d15,d14        ср байт
0302 FA              760                             mov             r2,a   ;сохр
0303 E578            761                             mov             a,reacp+1
0305 C0E0            762                             push    acc
                     763                     ;;      push    acc
0307 7F03            764                             mov             r7,#3;2
0309 C3              765     sdvig0:         clr             c
030A 33              766                             rlc             a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    13

030B DFFC            767                             djnz    r7,sdvig0 ;       d21..d16
030D 4A              768                             orl             a,r2
030E F579            769                             mov             reacp+2,a       ; сформ средний  байт
0310 D0E0            770                             pop             acc       ;reacp+1
                     771                             ;;;;;;;;;;;;;;
0312 20E70B          772                             jb              acc.7,sdvm
0315 C3              773                             clr             c
0316 7F05            774                             mov             r7,#5;6
0318 C3              775     sdvig4:         clr             c
0319 13              776                             rrc             a
031A DFFC            777                             djnz    r7,sdvig4 ;       d23,d22
031C F578            778                             mov             reacp+1,a
031E 8008            779                             jmp             readyacp;ankor;klmas
                     780     ;;;;;;;;;;;;                                    
0320 7F05            781     sdvm:           mov             r7,#5;6
0322 D3              782     sdvig6:         setb            c
0323 13              783                             rrc             a
0324 DFFC            784                             djnz    r7,sdvig6 ;       d23,d22
0326 F578            785                             mov             reacp+1,a
                     786                                                             
                     787     ; reacp..reacp+3-результат чтения асп(hex) 
                     788     ;;;;;;;;;
0328                 789     readyacp:
0328 7898            790                                             mov             r0,#chinkor
032A E6              791                             mov             a,@r0
032B 30E702          792                             jnb             acc.7,gopart
032E 8044            793                                     jmp             sumt2
                     794                     
0330                 795     gopart:
0330 789A            796                             mov             r0,#parT        ;параметр времени
0332 793F            797                             mov             r1,#chmasN
0334 B6013A          798                             cjne    @r0,#1,noparT1
                     799                             ;РЕЗ+РЕЗ
0337 7877            800                             mov             r0,#reacp
0339 120000   F      801                             call    resar2          ;reacp->r2..r5
033C 78B6            802                             mov             r0,#summa+3;rez_A+3
033E 120000   F      803                             call    ladd
0341 78B3            804                             mov             r0,#summa;rez_A
0343 120000   F      805                             call    saver2
0346 793F            806                              mov            r1,#chmasN
0348 7714            807                             mov             @r1,#20;10
034A 789B            808                             mov             r0,#chbefore
034C B6631E          809                             cjne    @r0,#99,nobef99
                     810                             ;РЕЗ/100
034F 900000   F      811                             MOV        DPTR,#ch100 
0352 120000   F      812     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
0355 120000   F      813                             call    zdiv;divide
0358 7862            814                             mov             r0,#rez_A
035A 120000   F      815                             call    saver2          ;сумма 100 отсчетов /100
035D 78C5            816                             mov             r0,#Rez_del
035F 120000   F      817                             call    saver2  
                     818                        ;;;;;
0362 78B3            819                        mov          r0,#summa
0364 120000   F      820                        call         clear4
                     821     
0367 799B            822                             mov             r1,#chbefore
0369 7700            823                             mov             @r1,#0
036B 8070            824                             jmp             klmas           ;загр в массив скользящее ср
036D 06              825     nobef99:        inc             @r0                     ;chbefore
036E 020000   F      826                             jmp             rebyte;labelA;метка A
                     827     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     828     ;а потом уже располагаем  в скользящий массив  из n
                     829     
                     830     
                     831     
0371 B6021D          832     noparT1:        cjne    @r0,#2,noparT2
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    14

                     833                             ;РЕЗ+РЕЗ
0374                 834     sumt2:
0374 7877            835                              mov            r0,#reacp
0376 120000   F      836                             call    resar2          ;reacp->r2..r5
0379 78B6            837                             mov             r0,#summa+3;rez_A+3
037B 120000   F      838                             call    ladd
037E 78B3            839                             mov             r0,#summa;rez_A
0380 120000   F      840                             call    saver2
0383 789B            841                             mov             r0,#chbefore
0385 793F            842                             mov             r1,#chmasN
0387 770A            843                             mov             @r1,#10
0389 B613E1          844                             cjne    @r0,#19,nobef99;9,nobef99
                     845                             ;РЕЗ/20
038C 900000   F      846                             MOV        DPTR,#ch20;ch10 
038F 80C1            847                             jmp             allsum
                     848                             ;;;;;;;
                     849                             
                     850     
0391 B6031D          851     noparT2:        cjne    @r0,#3,noparT3
                     852     
0394 7877            853                                                              mov            r0,#reacp
0396 120000   F      854                             call    resar2          ;reacp->r2..r5
0399 78B6            855                             mov             r0,#summa+3;rez_A+3
039B 120000   F      856                             call    ladd
039E 78B3            857                             mov             r0,#summa;rez_A
03A0 120000   F      858                             call    saver2
03A3 789B            859                             mov             r0,#chbefore
03A5 793F            860                             mov             r1,#chmasN
03A7 7702            861                             mov             @r1,#2;4                                        ;n=
                             4
03A9 B609C1          862                             cjne    @r0,#9,nobef99;9,nobef99
                     863                             ;РЕЗ/10
03AC 900000   F      864                             MOV        DPTR,#ch10 
03AF 80A1            865                             jmp             allsum
                     866                             
03B1 B6041D          867     noparT3:        cjne    @r0,#4,noparT4
03B4                 868     aapar:          
03B4 7877            869              mov            r0,#reacp
03B6 120000   F      870                             call    resar2          ;reacp->r2..r5
03B9 78B6            871                             mov             r0,#summa+3;rez_A+3
03BB 120000   F      872                             call    ladd
03BE 78B3            873                             mov             r0,#summa;rez_A
03C0 120000   F      874                             call    saver2
03C3 789B            875                             mov             r0,#chbefore
03C5 793F            876                             mov             r1,#chmasN
03C7 7702            877                             mov             @r1,#2;4
03C9 B604A1          878                             cjne    @r0,#4,nobef99;9,nobef99
                     879                             ;РЕЗ/10
03CC 900000   F      880                             MOV        DPTR,#ch5
03CF 8081            881                             jmp             allsum
                     882     
                     883                     
03D1 7702            884     noparT4:   mov          @r1,#2          ;chmasN n=2
03D3 7877            885                             mov             r0,#reacp
03D5 120000   F      886                             call    resar2          ;reacp->r2..r5
03D8 7862            887                             mov             r0,#rez_A
03DA 120000   F      888                             call    saver2
                     889     ;загрузить А в массив из 2/10 значений
                     890     ;;;;;;;;;;;;;;;
03DD                 891     klmas:           
03DD 793F            892                             mov             r1,#chmasN
03DF B7021A          893                             cjne    @r1,#2,mas10
03E2 900100          894                             MOV        dptr,#MASS0
03E5 120000   F      895                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     896     
03E8 7862            897                             mov             r0,#rez_A
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    15

03EA 120000   F      898                             call    resar2          ;->r2..r5
03ED 900100          899                             mov                     dptr,#MASS0
03F0 120000   F      900                   call              saveIr2                 ; R2-R5 --> MAS0
                     901                     
03F3 900107          902                   MOV          dptr,#MASS1+3
03F6 120000   F      903                   CALL       addx
03F9 020000   F      904                       jmp           endsum
                     905     ;массив из 10-ти измерений
03FC B70A7D          906     mas10:                  cjne    @r1,#10,mas20
03FF 900120          907                                             mov                     dptr,#MASS8
0402 120000   F      908                     CALL            xCIKLWR         ;MASS8->MASS9
0405 90011C          909                                             mov                     dptr,#MASS7
0408 120000   F      910                     CALL            xCIKLWR         ;MASS7->MASS8
040B 900118          911                     MOV       dptr,#MASS6
040E 120000   F      912                     CALL       xCIKLWR         ; MASS6 --> MASS7
0411 900114          913                     MOV        dptr,#MASS5
                     914                    
0414 120000   F      915                    CALL        xCIKLWR        ; MASS5 --> MASS6
0417 900110          916                    MOV         dptr,#MASS4
                     917                    
041A 120000   F      918                    CALL        xCIKLWR        ; MASS4 --> MASS5
041D 90010C          919                             mov                     dptr,#MASS3
                     920     
0420 120000   F      921                    CALL             xCIKLWR         ;MASS3->MASS4
0423 900108          922                     MOV        dptr,#MASS2
                     923                    
0426 120000   F      924                    CALL        xCIKLWR         ; MASS2 --> MASS3
0429 900104          925                    MOV         dptr,#MASS1
                     926                     
042C 120000   F      927                   CALL         xCIKLWR        ; MASS1 --> MASS2
042F 900100          928                    MOV         dptr,#MASS0
                     929                   
0432 120000   F      930                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     931     
                     932                             
0435 7862            933                             mov             r0,#rez_A
0437 120000   F      934                             call    resar2          ;->r2..r5
                     935                                     ;call   aform
043A 900100          936                                     mov                     dptr,#MASS0
043D 120000   F      937                   call              saveIr2                 ; R2-R5 --> MAS0
                     938              
0440 900107          939                   MOV          dptr,#MASS1+3
0443 120000   F      940                   CALL       addx
0446 90010B          941                   MOV          dptr,#MASS2+3
0449 120000   F      942                   CALL       addx
044C 90010F          943                   MOV          dptr,#MASS3+3
044F 120000   F      944                  CALL        addx
0452 900113          945                   MOV       dptr,#MASS4+3
0455 120000   F      946                   call       addx
0458 900117          947                     MOV        dptr,#MASS5+3
045B 120000   F      948                  CALL        addx
045E 90011B          949                   MOV          dptr,#MASS6+3
0461 120000   F      950                   CALL       addx
0464 90011F          951                   MOV          dptr,#MASS7+3
0467 120000   F      952                  CALL        addx
046A 900123          953                  MOV        dptr,#MASS8+3
046D 120000   F      954                   call       addx
0470 900127          955                     MOV                     dptr,#MASS9+3
0473 120000   F      956                  call        addx
0476 020000   F      957                              jmp            endsum
                     958     
0479 020000   F      959     rmas4:          jmp                     mas4
                     960     ;массив из 20-ти измерений
047C B714FA          961     mas20:          cjne    @r1,#20,rmas4
047F 900148          962                                             mov                     dptr,#MASS18
0482 120000   F      963                     CALL            xCIKLWR         ;MASS18->MASS19
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    16

0485 900144          964                                             mov                     dptr,#MASS17
0488 120000   F      965                     CALL            xCIKLWR         ;MASS17->MASS18
048B 900140          966                     MOV       dptr,#MASS16
048E 120000   F      967                     CALL       xCIKLWR         ; MASS16 --> MASS17
0491 90013C          968                     MOV        dptr,#MASS15
                     969                    
0494 120000   F      970                    CALL        xCIKLWR        ; MASS15 --> MASS16
0497 900138          971                    MOV         dptr,#MASS14
                     972                    
049A 120000   F      973                    CALL        xCIKLWR        ; MASS14 --> MASS15
049D 900134          974                             mov                     dptr,#MASS13
                     975     
04A0 120000   F      976                    CALL             xCIKLWR         ;MASS13->MASS14
04A3 900130          977                     MOV        dptr,#MASS12
                     978                    
04A6 120000   F      979                    CALL        xCIKLWR         ; MASS12 --> MASS13
04A9 90012C          980                    MOV         dptr,#MASS11
                     981                     
04AC 120000   F      982                   CALL         xCIKLWR        ; MASS11 --> MASS12
04AF 900128          983                    MOV         dptr,#MASS10
                     984                   
04B2 120000   F      985                    CALL        xCIKLWR        ; MASS10 --> MASS11
04B5 900124          986                                      MOV       dptr,#MASS9
04B8 120000   F      987                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     988     
04BB 900120          989                                             mov                     dptr,#MASS8
04BE 120000   F      990                     CALL            xCIKLWR         ;MASS8->MASS9
04C1 90011C          991                                             mov                     dptr,#MASS7
04C4 120000   F      992                     CALL            xCIKLWR         ;MASS7->MASS8
04C7 900118          993                     MOV       dptr,#MASS6
04CA 120000   F      994                     CALL       xCIKLWR         ; MASS6 --> MASS7
04CD 900114          995                     MOV        dptr,#MASS5
                     996                    
04D0 120000   F      997                    CALL        xCIKLWR        ; MASS5 --> MASS6
04D3 900110          998                    MOV         dptr,#MASS4
                     999                    
04D6 120000   F     1000                    CALL        xCIKLWR        ; MASS4 --> MASS5
04D9 90010C         1001                             mov                     dptr,#MASS3
                    1002     
04DC 120000   F     1003                    CALL             xCIKLWR         ;MASS3->MASS4
04DF 900108         1004                     MOV        dptr,#MASS2
                    1005                    
04E2 120000   F     1006                    CALL        xCIKLWR         ; MASS2 --> MASS3
04E5 900104         1007                    MOV         dptr,#MASS1
                    1008                     
04E8 120000   F     1009                   CALL         xCIKLWR        ; MASS1 --> MASS2
04EB 900100         1010                    MOV         dptr,#MASS0
                    1011                   
04EE 120000   F     1012                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1013     
                    1014                             
04F1 7862           1015                             mov             r0,#rez_A
04F3 120000   F     1016                             call    resar2          ;->r2..r5
                    1017                                     ;call   aform
04F6 900100         1018                                     mov                     dptr,#MASS0
04F9 120000   F     1019                   call              saveIr2                 ; R2-R5 --> MAS0
                    1020              
04FC 900107         1021                   MOV          dptr,#MASS1+3
04FF 120000   F     1022                   CALL       addx
0502 90010B         1023                   MOV          dptr,#MASS2+3
0505 120000   F     1024                   CALL       addx
0508 90010F         1025                   MOV          dptr,#MASS3+3
050B 120000   F     1026                  CALL        addx
050E 900113         1027                   MOV       dptr,#MASS4+3
0511 120000   F     1028                   call       addx
0514 900117         1029                     MOV        dptr,#MASS5+3
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    17

0517 120000   F     1030                  CALL        addx
051A 90011B         1031                   MOV          dptr,#MASS6+3
051D 120000   F     1032                   CALL       addx
0520 90011F         1033                   MOV          dptr,#MASS7+3
0523 120000   F     1034                  CALL        addx
0526 900123         1035                  MOV        dptr,#MASS8+3
0529 120000   F     1036                   call       addx
052C 900127         1037                     MOV                     dptr,#MASS9+3
052F 120000   F     1038                  call        addx
                    1039     ;27
0532 90012B         1040                                     MOV        dptr,#MASS10+3
0535 120000   F     1041                   CALL       addx
0538 90012F         1042                                     MOV        dptr,#MASS11+3
053B 120000   F     1043                   CALL       addx
053E 900133         1044                   MOV          dptr,#MASS12+3
0541 120000   F     1045                   CALL       addx
0544 900137         1046                   MOV          dptr,#MASS13+3
0547 120000   F     1047                  CALL        addx
054A 90013B         1048                   MOV       dptr,#MASS14+3
054D 120000   F     1049                   call       addx
0550 90013F         1050                                     MOV        dptr,#MASS15+3
0553 120000   F     1051                     CALL     addx
0556 900143         1052                   MOV          dptr,#MASS16+3
0559 120000   F     1053                   CALL       addx
055C 900147         1054                   MOV          dptr,#MASS17+3
055F 120000   F     1055                  CALL        addx
0562 90014B         1056                  MOV        dptr,#MASS18+3
0565 120000   F     1057                   call       addx
0568 90014F         1058                                     MOV                     dptr,#MASS19+3
056B 120000   F     1059                  call        addx
056E 802F           1060                                     jmp             endsum
                    1061     ;массив из 4х измерений
0570                1062     mas4:                   
0570 900108         1063                                             MOV        dptr,#MASS2
0573 120000   F     1064                    CALL        xCIKLWR         ; MASS2 --> MASS3
0576 900104         1065                    MOV         dptr,#MASS1
0579 120000   F     1066                    CALL        xCIKLWR        ; MASS1 --> MASS2
057C 900100         1067                    MOV         dptr,#MASS0
057F 120000   F     1068                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1069     
                    1070                             
0582 7862           1071                             mov             r0,#rez_A
0584 120000   F     1072                             call    resar2          ;->r2..r5
                    1073                                     ;call   aform
0587 900100         1074                                     mov                     dptr,#MASS0
058A 120000   F     1075                   call              saveIr2                 ; R2-R5 --> MAS0
                    1076              
058D 900107         1077                   MOV          dptr,#MASS1+3
0590 120000   F     1078                   CALL       addx
0593 90010B         1079                   MOV          dptr,#MASS2+3
0596 120000   F     1080                   CALL       addx
0599 90010F         1081                   MOV          dptr,#MASS3+3
059C 120000   F     1082                  CALL        addx
                    1083                  
                    1084             ;23.03          
059F                1085     endsum:
059F 786E           1086                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
05A1 06             1087                                     inc             @r0
05A2 E6             1088                                     mov             a,@r0   
05A3 200105         1089                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                    1090                                     
05A6 B53F31         1091                                     cjne    a,chmasN,masx5
05A9 D201           1092                                     setb    bitmas                  ;массив заполнен
05AB 853F6E         1093     masfull:                mov             chmas,chmasN
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    18

05AE 783F           1094                                     mov             r0,#chmasN
05B0 E6             1095                                     mov             a,@r0
                    1096     ;masfull:
05B1 B40208         1097                                     cjne    a,#2,nochn2
05B4 900000   F     1098                                     MOV        DPTR,#ch2;10 
05B7 120000   F     1099                                     CALL   ldc_ltemp                 ; ltemp <-- 2
05BA 8028           1100                                     jmp             mas5div
                    1101     
05BC B40A08         1102     nochn2:         cjne    a,#10,nochn10
05BF 900000   F     1103                                                     MOV        DPTR,#ch10 
05C2 120000   F     1104                                     CALL   ldc_ltemp                 ; ltemp <-- 10
05C5 801D           1105                                     jmp             mas5div
                    1106     
05C7 B41408         1107     nochn10:        cjne    a,#20,nochn20
05CA 900000   F     1108                                                     MOV        DPTR,#ch20 
05CD 120000   F     1109                                     CALL   ldc_ltemp                 ; ltemp <-- 20
05D0 8012           1110                                     jmp             mas5div
                    1111     
05D2 900000   F     1112     nochn20:        MOV        DPTR,#ch4 
05D5 120000   F     1113                                     CALL   ldc_ltemp                 ; ltemp <-- 4
05D8 800A           1114                                     jmp             mas5div
                    1115     
05DA 856E0B         1116     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
05DD E4             1117                                     clr     a
05DE F50A           1118                                     mov     ltemp+2,a
05E0 F509           1119                                     mov     ltemp+1,a
05E2 F508           1120                                     mov     ltemp,a
                    1121     
05E4                1122     mas5div:
05E4 120000   F     1123                                     CALL       zdiv;divide                           ; R2-R5 =
                    1124                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                    1125     
                    1126                             
                    1127      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1128     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1129     ;получен результат 3 байта и знак
05E7 7866           1130                             mov             r0,#rez_A1
05E9 120000   F     1131                             call    saver2           ;сохр среднее по массиву
                    1132     ;;8.11.06                       mov             chmasN,#0
                    1133      ;;;;;;;;;;;;
                    1134      ;;;;;;;;;;;;
05EC C3             1135                             clr             c
05ED 799A           1136                             mov             r1,#parT
05EF 7402           1137                             mov             a,#2
05F1 97             1138                             subb    a,@r1
05F2 501D           1139                             jnc             ankor           ;T<3
                    1140                             ;A-=РЕЗ1                                ;T>3
05F4 120402         1141                             call    altof                   ;r2..r5->float
05F7 785E           1142                             mov             r0,#rez_Ame
05F9 120000   F     1143                             call    saver2
                    1144                             ;;;;
05FC 7890           1145                             mov             r0,#koefKp;->r8..r11
05FE EA             1146                             mov             a,r2
05FF 30E702         1147                             jnb             acc.7,nminus3
0602 7894           1148                             mov             r0,#koefKm;->r8..r11
0604 120000   F     1149     nminus3:                call    resar8
0607 120203         1150                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
060A 785E           1151                             mov             r0,#rez_Ame
060C 120000   F     1152                             call    saver2
060F 8021           1153                             jmp             gotoKD
                    1154     
0611                1155     ankor:  
0611 7898           1156                             mov             r0,#chinkor
0613 E6             1157                             mov             a,@r0
0614 30E703         1158                             jnb             acc.7,nokorr
                    1159                             ;коррекция 0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    19

0617 020000   F     1160                             jmp             kornul
061A                1161     nokorr: 
                    1162                             ;mov            r10,#00         ;       chavt
                    1163                             ;mov            r11,#00h
061A 7881           1164                             mov              r0,#chavt      
061C E6             1165                             mov                     a,@r0;call      chcmp           ;сравн счет
                             чик авто калибровки с 0h
061D 30E737         1166                             jnb             acc.7,nonulavt;jnz              nonulavt        
0620 750A00         1167                             mov             r10,#0;1;00;02          
0623 750BC8         1168                             mov             r11,#0c8h;90h;0c8h;58h
0626 7898           1169                             mov             r0,#chinkor
0628 120000   F     1170                             call    chcmp
062B 7045           1171                             jnz             noavk
                    1172                             ;автокалибровка
062D 020000   F     1173                             jmp             autoka;noavk;
                    1174     
0630 8079           1175     rafterK:                jmp             afterK
                    1176     ;;;;;;;;;;
0632 C3             1177      gotoKD:                clr             c
0633 799A           1178                             mov             r1,#parT
0635 7404           1179                             mov             a,#4
0637 97             1180                             subb    a,@r1
0638 50F6           1181                             jnc             rafterK         ;T<5
                    1182                             ;A1-=A- *KD                     ;T>5
                    1183                             ;call           findkoef                                ;r2,r3-hex
                    1184                             ;       call            rebyte2                         ;r2..r5- he
                             x
                    1185                                     
                    1186                             ;       call    altof                   ;r2..r5->float
                    1187                             ;       mov     dptr,#CHtho;100000
                    1188                             ;       call    ldc_ltemp                       ;r8..r11
                    1189                             ;       call    fldiv
                    1190                             ;       call    move28
                    1191                             
063A 785E           1192                             mov             r0,#rez_Ame;->r2..r5   ???????????/
063C 120000   F     1193                             call    resar2
                    1194                                     ;call   flmul
063F 120343         1195                             call    ftol                    ;float->int
0642 7866           1196                             mov             r0,#rez_A1
0644 120000   F     1197                             call    saver2
0647 786A           1198                             mov             r0,#rez_A0;->r8..r11 hex
0649 120000   F     1199                             call    resar8
064C 120000   F     1200                             call    lsub            ;A3=A-1-A0
064F 789C           1201                             mov             r0,#rez_A3
0651 120000   F     1202                             call    saver2
0654 020000   F     1203                             jmp             labelB  
                    1204      ;;;;;;;;;;; 9.11.06
0657 789A           1205     nonulavt:        mov            r0,#parT
0659 E6             1206                             mov             a,@r0
065A 6401           1207                             xrl             a,#01
065C 700F           1208                             jnz             avtdec1
065E 7982           1209                             mov             r1,#chavt+1     ;T=1 chavt-10
0660 120000   F     1210                             call    tenmin
0663 7999           1211     kordec10:       mov             r1,#chinkor+1
0665 120000   F     1212                             call    tenmin
0668 801E           1213                             jmp             rezmul
                    1214     
066A 020000   F     1215     rmo220:         jmp             mo220
                    1216     
066D 7981           1217     avtdec1:        mov             r1,#chavt       
066F 120000   F     1218                             call    chdec           ;chavt-1
                    1219     ;                       jmp             kordec1;rezmul
0672 789A           1220     noavk:          mov             r0,#parT
0674 E6             1221                             mov             a,@r0
0675 6401           1222                             xrl             a,#01
0677 700A           1223                             jnz             kordec1
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    20

                    1224                             ;T=1 chinkor-10
0679 7999           1225                     mov             r1,#chinkor+1
067B 120000   F     1226                             call    tenmin
067E 8008           1227                             jmp             rezmul
                    1228     
0680 020000   F     1229     rnotestizm:             jmp                     notestizm
0683 7998           1230     kordec1:        mov             r1,#chinkor
0685 120000   F     1231                             call    chdec           ; chinkor-1
                    1232                        ;9.11.06
                    1233                             ;;;;;;;;;;;;;;
                    1234                             ;;;;;;;;;;;;;
                    1235     ;(РЕЗ1-АN)*K
0688                1236     rezmul:
0688 7866           1237                             mov             r0,#rez_A1;->r2..r5
068A 120000   F     1238                             call    resar2
068D 120402         1239                             call    altof   ;r2..r5->float  6.06    
0690 7884           1240                             mov             r0,#kor0_AN;->r8..r11
0692 120000   F     1241                             call    resar8
0695 1201D1         1242                             call    flsub
0698 7890           1243                             mov             r0,#koefKp;->r8..r11
069A EA             1244                             mov             a,r2
069B 30E702         1245                             jnb             acc.7,nminus
                    1246                             ;jnb            bitznak,nminus
                    1247                     
069E 7894           1248                             mov             r0,#koefKm;->r8..r11
06A0 120000   F     1249     nminus:         call    resar8
06A3 120203         1250                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
06A6 785E           1251                             mov             r0,#rez_Ame
06A8 120000   F     1252                             call    saver2
                    1253      
06AB                1254     afterK:                 
                    1255     ;;;;;;;;;;;;;;
06AB EA             1256                                     mov             a,r2
06AC 547F           1257                                     anl             a,#7fh
06AE FA             1258                                     mov             r2,a
06AF 900000   F     1259                                     mov     dptr,#ch_250;220;220000
06B2 120000   F     1260                                     call    ldc_ltemp                       ;r8..r11=8
06B5 1201D6         1261                                     call    flcmp
06B8 50B0           1262                                     jnc             rmo220          ;A>220000
                    1263                                     ;;;;;;;;;
06BA 3015C3         1264                                     jnb                     biteizm,rnotestizm
06BD 78B1           1265                                     mov                     r0,#vichR
06BF B62155         1266                                     cjne            @r0,#21h,note21
06C2 7A50           1267                                     mov                     r2,#50h                 ;-11a
06C4 7B18           1268                                     mov                     r3,#18h                 ;k8
06C6 12046C         1269                                     call            rebyte2                         ;r2..r5- he
                             x
06C9 120402         1270                                     call            altof                   ;r2..r5->float
06CC C002           1271                                     push            rr2
06CE C003           1272                                     push            rr3
06D0 C004           1273                                     push            rr4
06D2 C005           1274                                     push            rr5
06D4 7A50           1275                                     mov                     r2,#50h                 ;k10
06D6 7B20           1276                                     mov                     r3,#20h
06D8 12046C         1277     re11_7: call            rebyte2                 ;r2..r5
06DB 120402         1278                                     call            altof                   ;r2..r5->float
06DE 120000   F     1279                                     call            move28
06E1 D005           1280                                     pop                     rr5
06E3 D004           1281                                     pop                     rr4
06E5 D003           1282                                     pop                     rr3
06E7 D002           1283                                     pop                     rr2
06E9 1202B7         1284                                     call            fldiv
                    1285                             ;       mov                     dptr,#ch_10
                    1286                             ;       call            ldc_ltemp                       ;r8..r11
                    1287                             ;       call            flmul
                    1288                                     ;;;;;2.02.07
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    21

06EC C002           1289                                     push            rr2
06EE C003           1290                                     push            rr3
06F0 C004           1291                                     push            rr4
06F2 C005           1292                                     push            rr5
06F4 7A50           1293                                     mov                     r2,#50h                 ;-11a
06F6 7B2C           1294                                     mov                     r3,#2ch                 ;Km
06F8 12046C         1295                                     call            rebyte2                         ;r2..r5- he
                             x
06FB 120402         1296                                     call            altof                   ;r2..r5->float
06FE 120000   F     1297                                     call            move28
0701 D005           1298                                     pop                     rr5
0703 D004           1299                                     pop                     rr4
0705 D003           1300                                     pop                     rr3
0707 D002           1301                                     pop                     rr2
0709 120203         1302                                     call            flmul                           ;*Km
070C 900000   F     1303                                     mov     dptr,#CHtho;100000
070F 120000   F     1304                                     call    ldc_ltemp                       ;r8..r11=8
0712 1202B7         1305                                     call    fldiv
                    1306                                     ;;;;;
0715 8050           1307                                     jmp                     temul   
0717 B62218         1308     note21: cjne            @r0,#22h,note22
071A 7A50           1309                                     mov                     r2,#50h                 ;-09a
071C 7B10           1310                                     mov                     r3,#10h                 ;k6
071E 12046C         1311                                     call            rebyte2                         ;r2..r5- he
                             x
0721 120402         1312                                     call            altof                   ;r2..r5->float
0724 C002           1313                                     push            rr2
0726 C003           1314                                     push            rr3
0728 C004           1315                                     push            rr4
072A C005           1316                                     push            rr5
072C 7A50           1317                                     mov                     r2,#50h                 ;k8
072E 7B18           1318                                     mov                     r3,#18h
0730 80A6           1319                                     jmp                     re11_7
0732 7A50           1320     note22: mov                     r2,#50h                 ;-7a
0734 7B08           1321                                     mov                     r3,#08h                 ;k4
0736 12046C         1322                                     call            rebyte2                         ;r2..r5- he
                             x
0739 120402         1323                                     call            altof                   ;r2..r5->float
073C C002           1324                                     push            rr2
073E C003           1325                                     push            rr3
0740 C004           1326                                     push            rr4
0742 C005           1327                                     push            rr5
0744 7A50           1328                                     mov                     r2,#50h                 ;k6
0746 7B10           1329                                     mov                     r3,#10h
0748 808E           1330                                     jmp                     re11_7  
                    1331                                     ;;;;;;;;;
074A                1332     notestizm:
074A 301208         1333                                     jnb             bitklb,komulpz
074D 900000   F     1334                                     mov     dptr,#chk;100000
0750 120000   F     1335                                     call    ldc_long                        ;r2..r5
0753 8006           1336                                     jmp             komul
0755 120000   F     1337     komulpz:call            findkoef                                ;r2,r3-hex
0758 12046C         1338                                     call            rebyte2                         ;r2..r5- he
                             x
                    1339                                     
075B 120402         1340     komul:  call    altof                   ;r2..r5->float
075E 900000   F     1341                                     mov     dptr,#CHtho;100000
0761 120000   F     1342                             call    ldc_ltemp                       ;r8..r11=8
0764 1202B7         1343                                     call    fldiv
0767 120000   F     1344     temul:                          call    move28
076A 785E           1345                                     mov             r0,#rez_Ame
076C 120000   F     1346                                     call    resar2
                    1347                     
076F 120203         1348                                     call    flmul     ;A1-=A-*KD  fl
                    1349                                     
0772 120343         1350                                     call    ftol                    ;float->int
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    22

0775 7866           1351                                     mov             r0,#rez_A1
0777 120000   F     1352                                     call    saver2
077A 120402         1353                                     call    altof                   ;r2..r5->float
077D EA             1354                                     mov             a,r2
077E 547F           1355                                     anl             a,#7fh
0780 FA             1356                                     mov             r2,a
0781 900000   F     1357                                     mov     dptr,#ch_220;200;200000
0784 120000   F     1358                                     call    ldc_ltemp                       ;r8..r11=8
0787 1201D6         1359                                     call    flcmp
078A 502D           1360                                     jnc             rrmo220         ;A>200000
                    1361                             ;       jnb             knizm,noavp;goA2;               bitizm,goA2
                                  
                    1362                             ;       jb              bitavp,yesavp
078C 301808         1363                                     jnb             knizm,goA2
078F 300602         1364                                     jnb             bitvi11,qu_avp
0792 8003           1365                                     jmp             goA2
0794 20052F         1366     qu_avp:                 jb              bitavp,yesavp
0797                1367     noavp:  ;               jb              bitvi11,yesvich  ;уст после ввода A B (ввод ВЫЧИСЛИ
                             ТЬ)
0797                1368     goA2:                    ;A2=A1-
0797 7866           1369                                      mov            r0,#rez_A1
0799 120000   F     1370                                     call    resar2
079C 787B           1371                                     mov             r0,#rez_A2
079E 120000   F     1372                                     call    saver2
07A1                1373     goA3A2:                  ;A3=A2-A0
07A1 786A           1374                                       mov           r0,#rez_A0
07A3 120000   F     1375                                     call    resar8
07A6 120000   F     1376                                     call    lsub
07A9 789C           1377                                     mov             r0,#rez_A3
07AB 120000   F     1378                                     call    saver2
                    1379                                     ;;;;;;
07AE 200660         1380                                     jb              bitvi11,yesvich
07B1                1381     goonin:            ;jmp         goonind;indA3;8.11.06
07B1 78AC           1382                                     mov             r0,#chind
07B3 B60006         1383                                     cjne    @r0,#0,rnochi0
07B6 020000   F     1384                                     jmp             goonind;indA3
                    1385     
07B9 020000   F     1386     rrmo220:                jmp             mo220
07BC 020000   F     1387     rnochi0:                jmp             nochi0
07BF 7866           1388     gokaA2:                 mov             r0,#rez_A1                      ;(float)
07C1 120000   F     1389                                                     call    saver2                          ;то
                              необх для калибровки ,goA2 работает с тим знач
07C4 80D1           1390                                             jmp             goA2
                    1391     ;;;;;;;;;;;;;;;;
07C6 EA             1392     yesavp:                 mov             a,r2
07C7 547F           1393                                     anl             a,#7fh
07C9 FA             1394                                     mov             r2,a
07CA 900000   F     1395                                     mov     dptr,#ch_10th;10000
07CD 120000   F     1396                                     call    ldc_ltemp                       ;r8..r11=8
07D0 1201D6         1397                                     call    flcmp
07D3 50C2           1398                                     jnc             noavp           ;A>10000        
07D5 78AE           1399                                     mov             r0,#diap                ;10-11
07D7 B60902         1400                                     cjne    @r0,#9,avpgo
07DA 80BB           1401                                     jmp             noavp
07DC                1402     avpgo:                  
07DC 06             1403                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
07DD B60A01         1404                                     cjne    @r0,#0ah,clmasv
07E0 16             1405                                     dec             @r0
07E1                1406     clmasv:         ;сбросить массив
07E1 120000   F     1407                             call    loadUS
                    1408                             ;call   louizm
07E4 120000   F     1409                             call     clmassix
07E7 78B3           1410                                     mov             r0,#summa
07E9 120000   F     1411                                     call    clear4
07EC 786A           1412                                     mov             r0,#rez_A0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    23

07EE 120000   F     1413                                     call    clear4
07F1 C20F           1414                                     clr             bitnul
07F3 D207           1415                                     setb            bitzus;bitbuf;;;;;;;;;;;;                  
                                                                                   
07F5 80BA           1416                                jmp     goonin
                    1417     
07F7 D00B           1418     erra01:         pop                     r11
07F9 D00A           1419                                     pop                     r10
07FB D009           1420                                     pop                     r9
07FD D008           1421                                     pop                     r8
07FF C214           1422                                     clr             bitvich
0801 C206           1423                                     clr             bitvi11
0803 753934         1424                                             mov                     nuerr,#34h;константа не дол
                             жна быть равна0
0806 120000   F     1425                                             call            error
0809 120000   F     1426                                             call            ind
080C 120000   F     1427                                             call            z_1s
080F 80A0           1428                                             jmp             goonin
                    1429     
                    1430     
0811                1431     yesvich:        
                    1432                     ;                       mov             r0,#konstB
                    1433                     ;               call    resar2
                    1434                     ;               call    move28
0811 789C           1435                                     mov             r0,#rez_A3;A1
0813 120000   F     1436                                     call    resar2                          ;HEX
                    1437                                     
0816 120402         1438                                     call            altof                   ;r2..r5->float
0819 EA             1439                                     mov             a,r2                    ;модуль
081A 547F           1440                                     anl             a,#7fh
081C FA             1441                                     mov             r2,a
                    1442                     ;               call            fladd                           ;A1+B
                    1443                                     
081D 900000   F     1444                                     mov     dptr,#CH_500;
0820 120000   F     1445                                     call    ldc_ltemp                       ;r8..r11
0823 1201D6         1446                                     call    flcmp
0826 407E           1447                                     jc                      mo500R;error <500 >22000
0828 900000   F     1448                                     mov     dptr,#CH_22T;
082B 120000   F     1449                                     call    ldc_ltemp                       ;r8..r11
082E 1201D6         1450                                     call    flcmp
0831 507F           1451                                     jnc             mo500I          ;error
                    1452                                     ;;;;;;;;;;;;
0833 120000   F     1453                                     call            move28
0836 C008           1454                                     push            r8
0838 C009           1455                                     push            r9
083A C00A           1456                                     push            r10
083C C00B           1457                                     push            r11
083E 78BC           1458                                     mov             r0,#konstA
0840 120000   F     1459                                     call    resar2
0843 900000   F     1460                                     mov                     dptr,#ch0
0846 120000   F     1461                                     call            ldc_ltemp
0849 1201D6         1462                                     call            flcmp
084C 60A9           1463                                     jz              erra01
084E 900000   F     1464                                     mov             dptr,#CH_B
0851 120000   F     1465                                     CALL   ldc_ltemp                 ; ltemp <-- 10-7
0854 120203         1466                                     call            flmul                           ;A*10-7
0857 D00B           1467                                     pop                     r11
0859 D00A           1468                                     pop                     r10
085B D009           1469                                     pop                     r9
085D D008           1470                                     pop                     r8
085F 1202B7         1471                                     call            fldiv                   ;результат R
0862 78C9           1472                                     mov                     r0,#rez_R
0864 120000   F     1473                                     call            saver2
0867 120343         1474                                     call            ftol                    ;float->hex
                    1475                                     ;;;;;;;;;;
086A 784F           1476                                             mov             r0,#abin
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    24

086C 120000   F     1477                                             call    saver2
                    1478     ;;;;;;;;
086F 7840           1479                                                     mov             r0,#bufind
0871                1480     age9:
0871 7620           1481                             mov             @r0,#" "          ;погасить индикатор
0873 08             1482                             inc             r0
0874 B84BFA         1483                             cjne    r0,#bufind+11,age9
                    1484                                             
0877 78C9           1485                                             mov             r0,#rez_R
0879 120000   F     1486                                             call            resar2
                    1487     ;;;;;;;;;;
087C 900000   F     1488                                     mov             dptr,#CH_fl
087F 120000   F     1489                                     CALL   ldc_ltemp
0882 1202B7         1490                                     call            fldiv
                    1491     
0885 78B8           1492                                     mov             r0,#work                ;степень +
0887 7600           1493                                     mov             @r0,#0
0889 78B9           1494                                     mov             r0,#work+1;степень -
088B 7600           1495                                     mov             @r0,#0
088D 900000   F     1496     compa1: mov     dptr,#ch_1;
0890 120000   F     1497                                     call    ldc_ltemp                       ;r8..r11
0893 1201D6         1498                                     call    flcmp
0896 4026           1499                                     jc              equ0            ;<1
0898 78B8           1500                                     mov             r0,#work                        ;степень +
089A 06             1501                                     inc             @r0
089B 900000   F     1502                                     mov             dptr,#ch_10;
089E 120000   F     1503                                     call    ldc_ltemp                       ;r8..r11
08A1 1202B7         1504                                     call            fldiv
08A4 80E7           1505                                     jmp             compa1                          ;work значе
                             ние степени n(hex)  
                    1506                                     ;;;;;;;;;;;;;;;;;;;
08A6 900000   F     1507     mo500R: mov             dptr,#teOLR
08A9 120000   F     1508                               call          lotext           
08AC 120000   F     1509                                     call            ind
08AF 020000   F     1510                                     jmp                     nobavp;nobitizm
08B2 900000   F     1511     mo500I: mov             dptr,#teOLI
08B5 120000   F     1512                               call          lotext           
08B8 120000   F     1513                                     call            ind
08BB 020000   F     1514                                     jmp                     nobavp;nobitizm
08BE                1515     equ0:           ;;;;;   call            ftol                    ;float->int
08BE 78B8           1516                                     mov             r0,#work                ;степень +
08C0 B60019         1517                                     cjne    @r0,#0,equ00
                    1518                                     
08C3 900000   F     1519     compa2: mov     dptr,#ch_1;
08C6 120000   F     1520                                     call    ldc_ltemp                       ;r8..r11
08C9 1201D6         1521                                     call    flcmp
08CC 500E           1522                                     jnc             equ00           ;>1
08CE 78B9           1523                                     mov             r0,#work+1                      ;степень -
08D0 16             1524                                     dec             @r0                                        
                                          ;0,ff(-1),fe(-2)...
08D1 900000   F     1525                                     mov             dptr,#ch_10;
08D4 120000   F     1526                                     call    ldc_ltemp                       ;r8..r11
08D7 120203         1527                                     call            flmul
08DA 80E7           1528                                     jmp             compa2                          ;work значе
                             ние степени n(hex)  
                    1529     
                    1530     
08DC                1531     equ00:          
08DC 7853           1532                                                     mov             r0,#adec
08DE 7952           1533                                             mov             r1,#abin+3      ;hex->10
08E0 120000   F     1534                                             call    bindec
                    1535     
                    1536                                                     ;если степень полож убирать младший байт
                    1537                                                     ;чтобы уложиться в 5 разрядов, если отриц р
                             асполагать
                    1538                                                     ;число в bufind..bufind+5
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    25

08E3 78B8           1539                                             mov             r0,#work
08E5 B60021         1540                                             cjne    @r0,#0,outr
08E8 08             1541                                             inc             r0                      ;work+1
08E9 B6FF05         1542                                             cjne            @r0,#0ffh,bufr3         ;6разрядов 
                             нужно вывести 5
08EC 06             1543                                             inc                     @r0;!!!!!!!!!?
08ED 785B           1544                                             mov                     r0,#adec+8;разместить в буф
                             ер индикации R
08EF 8003           1545                                             jmp                     bufr30
                    1546                                             ;;;;;;;;;;;;;;
08F1 06             1547     bufr3:          inc             @r0                     ;?!!!!!!!!n+1
08F2 785C           1548                                                     mov             r0,#adec+9
08F4 7945           1549     bufr30:         mov             r1,#bufind+5;6
08F6 7F05           1550                                             mov             r7,#5;7
08F8 E6             1551     bufr2:                          mov             a,@r0
08F9 2430           1552                                             add             a,#30h
08FB F7             1553                                             mov             @r1,a
08FC 19             1554                                             dec             r1
08FD 18             1555                                             dec             r0
08FE DFF8           1556                                             djnz    r7,bufr2
                    1557     
0900 784F           1558                                             mov             r0,#abin
0902 120000   F     1559                                             call            clear4
0905 78B9           1560                                             mov             r0,#work+1
0907 801C           1561                                     jmp             outr5
                    1562     ;work!=0 значит после дел на 10**9 получили число > с чем 6 разрядов                       
                                          
0909 785C           1563     outr:                   mov             r0,#adec+9;разместить в буфер индикации R
090B C3             1564                                             clr             c
090C 79B8           1565                                             mov             r1,#work
090E E8             1566                                             mov             a,r0
090F 14             1567                                             dec             a                                  
                                  ;n-1
0910 97             1568                                             subb    a,@r1
0911 F8             1569                                             mov             r0,a                    ;adec+9-n !
                             !!!!!!!!!!!!!!
0912 7945           1570                                     mov             r1,#bufind+5;т к число разрядов > чем знако
                             мест
0914 7F05           1571                                             mov             r7,#5;7
0916 E6             1572     bufr:                           mov             a,@r0
0917 2430           1573                                             add             a,#30h
0919 F7             1574                                             mov             @r1,a
091A 19             1575                                             dec             r1
091B 18             1576                                             dec             r0
091C DFF8           1577                                             djnz    r7,bufr
                    1578     
091E 784F           1579                                             mov             r0,#abin
0920 120000   F     1580                                             call            clear4
0923 78B8           1581                                     mov             r0,#work
0925 E6             1582     outr5:                  mov             a,@r0
0926 F552           1583                                             mov             abin+3,a
                    1584                                                                     ;n(hex)->abin
0928 120000   F     1585                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
092B 2552           1586                                             add             a,abin+3
092D F552           1587                                             mov             abin+3,a
092F 7853           1588                                             mov             r0,#adec
0931 7952           1589                                             mov             r1,#abin+3      ;hex->10
0933 120000   F     1590                                             call    bindec
0936 855C48         1591                                             mov             bufind+8,adec+9
0939 855B47         1592                                             mov             bufind+7,adec+8
093C 754966         1593                                             mov             bufind+9,#66h
093F 020000   F     1594                                             jmp             nobavp;nobitizm;        goonin;call
                                  ind
                    1595                                             
                    1596                                     ;;;;;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    26

                    1597     ;;;;;;;;;;;;;
                    1598     
0942 300508         1599     mo220:             jnb          bitavp,indoll
0945 301805         1600                                jnb          knizm,indoll;bitizm,indoll
0948 78AE           1601                                     mov             r0,#diap
094A B6000E         1602                                     cjne    @r0,#0,nodi2
                    1603                                ;10-2
094D 300408         1604     indoll:         jnb             bitizm,goonin1;чтобы не OLL было при нажатии кнопок меню,па
                             м,вычR
0950 900000   F     1605                                             mov             dptr,#teOLL;OLL
0953 120000   F     1606                                             call    lotext
0956 D217           1607                                             setb    bitoll
0958 020000   F     1608     goonin1:                jmp             goonin  
                    1609     
095B 16             1610     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1611     
095C B6FF01         1612                                     cjne    @r0,#0ffh,nodi9
095F 06             1613                                     inc             @r0
                    1614     
0960 120000   F     1615     nodi9:          call    loadUS
                    1616                                     ;call   louizm
                    1617                                     ;сбросить массив
0963 120000   F     1618                                     call     clmassix
0966 78B3           1619                                     mov             r0,#summa
0968 120000   F     1620                                     call    clear4
096B 786A           1621                                     mov             r0,#rez_A0
096D 120000   F     1622                                     call    clear4
0970 C20F           1623                                     clr             bitnul  
0972 D207           1624                                     setb    bitzus;bitbuf   ;флаг задержки  после установки us 
                                                                           
0974 020000   F     1625                                jmp     goonin
                    1626     
0977 16             1627     nochi0:                 dec             @r0                     ;СТИ-1
0978 020000   F     1628                                     jmp             labelB  
                    1629     
                    1630             
                    1631     ;;;;;;;;;;;;;;;
                    1632     
097B                1633     nop3_0: ;;      ;rez_A-rez_A0
                    1634                     ;;                      mov             r0,#rez_A0
                    1635                     ;;                      call    resar8
                    1636                     ;;                      call    lsub
                    1637                     ;;                      mov             r0,#rez_A
                    1638                     ;;;                     call    saver2
                    1639      
                    1640     
097B B70207         1641     no3parN:                        cjne    @r1,#2,no2parN
                    1642                                             ;в байт 0  записать пробел
097E 7946           1643                                             mov             r1,#bufind+6
0980 7720           1644                                             mov             @r1,#" ";0fdh;
0982 020000   F     1645                                             jmp             seeind;moveA3
                    1646     
0985                1647     no2parN:                        ;в байты 0 и 1 записать пробел
0985 7945           1648                                             mov             r1,#bufind+5
0987 7720           1649                                             mov             @r1,#" ";0fdh;" "
0989 09             1650                                             inc             r1
098A 7720           1651                                             mov             @r1,#" ";0fdh;" "
098C 8076           1652                                             jmp             seeind;moveA3
098E 8074           1653     rseeind:                jmp             seeind
                    1654     
0990                1655     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1656                                     
                    1657                                             
0990                1658     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1659                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1660                     ;до конца цикла измерения результат не размещать в буфере
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    27

                    1661                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1662                     ;и возврату в режим измерения
0990 20145C         1663                                             jb              bitvich,rnorvich
0993 201059         1664                                             jb              bitt2,rnorvich
0996 2017F5         1665                                             jb              bitoll,rseeind
                    1666                                             
0999 2011F2         1667                                             jb              bitmenu,rseeind
099C 200BEF         1668                                             jb              bitmem,rseeind
                    1669     ;;;;;;;;;;;;;;
                    1670                                             ; mov           r0,#rez_A3
                    1671                                             ;call   resar2
                    1672                                             ;call   ftol                    ;float->int r2..r5
                    1673     ;;;;;;;;
099F 789C           1674                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
09A1 120000   F     1675                                             call    resar2;????????????????17.01.07
                    1676                                     
09A4 120000   F     1677                                             call    maform
09A7 784F           1678                                             mov             r0,#abin
09A9 120000   F     1679                                             call    saver2
                    1680     ;;;;;;;;
                    1681                                             
09AC 7853           1682                                             mov             r0,#adec
09AE 7952           1683                                             mov             r1,#abin+3      ;hex->10
09B0 120000   F     1684                                             call    bindec
                    1685                                     
09B3 785C           1686                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
09B5 7946           1687                                             mov             r1,#bufind+6
09B7 7F07           1688                                             mov             r7,#7
09B9 E6             1689     bufdec:                         mov             a,@r0
09BA 2430           1690                                             add             a,#30h
09BC F7             1691                                             mov             @r1,a
09BD 19             1692                                             dec             r1
09BE 18             1693                                             dec             r0
09BF DFF8           1694                                             djnz    r7,bufdec
09C1 7847           1695                                             mov             r0,#bufind+7
09C3 762D           1696                                             mov             @r0,#2dh          ;-2..-9
09C5 7840           1697                                             mov             r0,#bufind
09C7 762B           1698                                             mov             @r0,#2bh
09C9 300202         1699                                             jnb             znmat,nozzmi;bitznak,nozzmi
09CC 762D           1700                                             mov             @r0,#2dh
09CE 79AE           1701     nozzmi:                         mov             r1,#diap
09D0 7848           1702                                             mov             r0,#bufind+8
09D2 E7             1703                                             mov             a,@r1
09D3 B4080B         1704                                             cjne    a,#8,nodi8
09D6 20151D         1705                                             jb              biteizm,seegoon
09D9 7630           1706                                             mov             @r0,#30h                 ;10-10
09DB 18             1707                                             dec             r0
09DC 7663           1708                                             mov             @r0,#63h;31h
09DE 08             1709                                             inc             r0
09DF 8015           1710                                             jmp             seegoon
09E1 B4090F         1711     nodi8:                          cjne    a,#9,nodis9
09E4 20150F         1712                                     jb              biteizm,seegoon
09E7 7631           1713                                             mov             @r0,#31h           ;10-11
09E9 18             1714                                             dec             r0
09EA 7663           1715                                             mov             @r0,#63h;31h
                    1716                                     
09EC 08             1717                                             inc             r0
09ED 8007           1718                                             jmp             seegoon
                    1719     
09EF 8079           1720     rnorvich:               jmp             norvich
09F1 8088           1721     rno3parN:               jmp             no3parN
                    1722     
09F3 2432           1723     nodis9:                         add             a,#32h
09F5 F6             1724                                             mov             @r0,a;#37h;"T";
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    28

09F6 08             1725     seegoon:                        inc             r0
09F7 7641           1726                                             mov             @r0,#"A";"E";
09F9 08             1727                                             inc             r0
09FA 7600           1728                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
09FC 08             1729                                             inc             r0;             mov             buf
                             ind+11
09FD 7610           1730                                             mov             @r0,#010h               ;bufind+11.
                             4 точка после первой цифры
                    1731                                             
                    1732     ;;;;;;;;;;;;;;;
                    1733     ;;;;;;goonind:
09FF 79AF           1734                                             mov             r1,#parN        ; ??????
0A01 B703ED         1735                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1736             
0A04                1737     seeind:                         ;;;;;;;;;;;;;
0A04 784A           1738                                             mov             r0,#bufind+10
0A06 E6             1739                                             mov             a,@r0
0A07 300F03         1740                                             jnb             bitnul,nnnul
0A0A 4408           1741                                             orl             a,#08h
0A0C F6             1742                                             mov             @r0,a
0A0D 799A           1743      nnnul:         mov             r1,#parT
0A0F B70204         1744                                             cjne    @r1,#2,nsec1
0A12 4420           1745                                             orl             a,#20h    ;1s
0A14 8009           1746                                             jmp             nsec10
0A16 B70104         1747     nsec1:          cjne    @r1,#1,nsec11
0A19 4440           1748                                             orl             a,#40h                  ;10s
0A1B 8002           1749                                             jmp             nsec10
                    1750                                     
0A1D 4410           1751     nsec11:         orl             a,#10h
                    1752                                                      ;0,1s
                    1753     ;;;;;;;;;;;;;;;;
0A1F                1754     nsec10:         
                    1755     
                    1756     
0A1F 784A           1757                                             mov             r0,#bufind+10   
0A21 F6             1758                                             mov             @r0,a
0A22 300504         1759                                             jnb             bitavp,nobavp
0A25 4404           1760                                             orl             a,#04           ;bufind+10.2
0A27 F6             1761                                             mov             @r0,a
0A28 F6             1762                                             mov             @r0,a   
0A29 784A           1763     nobavp:         mov             r0,#bufind+10   
0A2B F6             1764                                             mov             @r0,a   
0A2C 301803         1765                                        jnb          knizm,nobitizm
0A2F 4402           1766                                             orl             a,#02
0A31 F6             1767                                              mov            @r0,a
0A32                1768     nobitizm:                       
0A32 301A07         1769                                             jnb             bitakt,notakt
0A35 C21A           1770                                             clr             bitakt
0A37 534AFE         1771                                             anl             bufind+10,#0feh
0A3A 8005           1772                                             jmp             taktind
0A3C D21A           1773     notakt:                         setb    bitakt
0A3E 434A01         1774                                             orl             bufind+10,#01                      
                                          
0A41                1775     taktind:                
                    1776     ;;;;;;;;;
0A41 301517         1777                                             jnb             biteizm,yesind
0A44 79B1           1778                                             mov             r1,#vichR
0A46 7848           1779                                             mov             r0,#bufind+8
0A48 7654           1780                                             mov             @r0,#'T'
0A4A 08             1781                                             inc             r0
0A4B B72104         1782                                             cjne    @r1,#21h,test9i
0A4E 7631           1783                                             mov             @r0,#31h;11A
                    1784                                     ;       dec             r0
                    1785                                     ;       mov             @r0,#63h
0A50 8009           1786                                             jmp             yesind
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    29

0A52 B72204         1787     test9i:         cjne    @r1,#22h,test7i
0A55 7632           1788                                             mov             @r0,#32h;39h;09A
0A57 8002           1789                                             jmp             yesind
0A59 7633           1790     test7i:         mov             @r0,#33h;37h;07A
                    1791     ;;;;;;;;;
0A5B                1792     yesind:         
0A5B 301203         1793                                             jnb             bitklb,noklb
0A5E 434A80         1794                                             orl             bufind+10,#80h; on kmp
0A61 300A03         1795     noklb:          jnb             bitbon,nobuf
0A64 434B02         1796                                             orl             bufind+11,#02h; on pysk
0A67 120000   F     1797     nobuf:          call    ind        ;пп выдачи на индикатор
0A6A                1798     norvich: 
0A6A 789A           1799                                     mov             r0,# parT
0A6C 79AC           1800                                             mov             r1,#chind
0A6E B60152         1801                                             cjne    @r0,#1,rnot1in
0A71                1802     labelB:                    ;;;;;;;;;;;
                    1803                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
0A71 789F           1804                                                     mov     r0,#rez_A3+3
                    1805                             ;;;;;;;;
0A73 79BB           1806                             mov             r1,#work+3
0A75 E6             1807                             mov             a,@r0
0A76 7F07           1808                             mov             r7,#7;кол сдв вправо
0A78 C3             1809     dvig3:          clr             c
0A79 13             1810                             rrc             a
0A7A DFFC           1811                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
0A7C FA             1812                             mov             r2,a    ;сохр байт
0A7D 18             1813                             dec             r0              ;rez_A3+2
0A7E E6             1814                             mov             a,@r0
0A7F C0E0           1815                             push    acc
0A81 C3             1816                             clr             c
0A82 7F01           1817                             mov             r7,#1
0A84 C3             1818     dvig2:          clr             c
0A85 33             1819                             rlc             a
0A86 DFFC           1820                             djnz    r7,dvig2 ;d12..d11       средний байт
0A88 4A             1821                             orl             a,r2
0A89 F7             1822                             mov             @r1,a;сформ мл байт
0A8A 19             1823                             dec             r1
0A8B D0E0           1824                             pop             acc
                    1825                             
0A8D 7F07           1826                             mov             r7,#7
0A8F C3             1827     dvig1:          clr             c
0A90 13             1828                             rrc             a
0A91 DFFC           1829                             djnz    r7,dvig1 ;d18     ср байт
0A93 FA             1830                             mov             r2,a   ;сохр
0A94 18             1831                             dec             r0
0A95 E6             1832                             mov             a,@r0 ;rez_A3+1
0A96 C0E0           1833                             push    acc
                    1834                     
0A98 7F01           1835                             mov             r7,#1
0A9A C3             1836     dvig0:          clr             c
0A9B 33             1837                             rlc             a
0A9C DFFC           1838                             djnz    r7,dvig0 ;        d21..d16
0A9E 4A             1839                             orl             a,r2
0A9F F7             1840                             mov             @r1,a   ; сформ средний  байт
0AA0 19             1841                             dec             r1
0AA1 D0E0           1842                             pop             acc       ;rez_A3+1
                    1843                             ;;;;;;;;;;;;;;
                    1844     ;                       jb              acc.7,dvm
0AA3 C3             1845                             clr             c
0AA4 7F07           1846                             mov             r7,#7
0AA6 C3             1847     dvig4:          clr             c
0AA7 13             1848                             rrc             a
0AA8 DFFC           1849                             djnz    r7,dvig4 ;        d22
0AAA FA             1850                             mov             r2,a   ;сохр
0AAB 18             1851                             dec             r0;     rez_A3
0AAC E6             1852                             mov             a,@r0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    30

                    1853                             ;;;;;
0AAD 7F01           1854                             mov             r7,#1
0AAF C3             1855     vig0:           clr             c
0AB0 33             1856                             rlc             a
0AB1 DFFC           1857                             djnz    r7,vig0 ;         d24..d30
0AB3 4A             1858                             orl             a,r2
0AB4 F7             1859                             mov             @r1,a   ; сформ   байт
0AB5 19             1860                             dec             r1
0AB6 E6             1861                             mov             a,@r0
                    1862                             ;;;;;
0AB7 20E70C         1863                             jb              acc.7,dvm
0ABA C3             1864                             clr             c
0ABB 7F07           1865                             mov             r7,#7
0ABD C3             1866     vig4:           clr             c
0ABE 13             1867                             rrc             a
0ABF DFFC           1868                             djnz    r7,vig4 ;         d
0AC1 8009           1869                             jmp             endsdv
                    1870     
0AC3 020000   F     1871     rnot1in:                jmp             not1in
                    1872     
                    1873     ;;;;;;;;;;;;                                    
0AC6 7F07           1874     dvm:            mov             r7,#7
0AC8 D3             1875     dvig6:          setb            c
0AC9 13             1876                             rrc             a
0ACA DFFC           1877                             djnz    r7,dvig6 ;        d31
0ACC F7             1878     endsdv:         mov             @r1,a
                    1879                                                             
                    1880      ;->work   
                    1881                             
0ACD 900000   F     1882                             mov             dptr,#chzap
0AD0 120000   F     1883                             call     ldc_long
0AD3 78BB           1884                              mov            r0,#work+3
0AD5 120000   F     1885                             call    ladd
0AD8 ED             1886                             mov             a,r5
0AD9 F5D2           1887                             mov             DAC0L,a
                    1888                             
0ADB EC             1889                             mov             a,r4
0ADC F5D3           1890                             mov             DAC0H,a
                    1891     
                    1892                                             ;;;;;;;;;;
0ADE 78CF           1893                                             mov                     r0,#chbuf               ;fl
                             oat
0AE0 120000   F     1894                                             call            resar2
0AE3 900000   F     1895                                             mov                     dptr,#ch_2;ch0;ch_1
0AE6 120000   F     1896                                             call            ldc_ltemp
0AE9 1201D6         1897                                             call            flcmp
0AEC 5020           1898                                             jnc                     rnobuf0
                    1899                                             
0AEE 900000   F     1900                                             mov                     dptr,#ch_1
0AF1 120000   F     1901                                             call            ldc_ltemp
0AF4 1201D1         1902                                             call            flsub
0AF7 900E00         1903                                             mov                     dptr,#chbuf1               
                                  ;СБ1 внешн озу
0AFA EA             1904                                             mov                     a,r2
0AFB F0             1905                                             movx            @dptr,a
0AFC A3             1906                                             inc                     dptr
0AFD EB             1907                                             mov                     a,r3
0AFE F0             1908                                             movx            @dptr,a
0AFF A3             1909                                             inc                     dptr
0B00 EC             1910                                             mov                     a,r4
0B01 F0             1911                                             movx            @dptr,a
0B02 A3             1912                                             inc                     dptr
0B03 ED             1913                                             mov                     a,r5
0B04 F0             1914                                             movx            @dptr,a
                    1915                                             
                    1916                                             
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    31

                    1917                                             ;jnc                    rnobuf0
0B05 200909         1918                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
0B08 200A08         1919                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0B0B 020000   F     1920                                             jmp             gocikle
0B0E 020000   F     1921     rnobuf0:        jmp             nobuf0
0B11                1922     yesprd: ;передать   A3 в буфер
0B11 8045           1923                                             jmp             goonT
0B13                1924     yesbuf:         ;записать   A3 в буфер
0B13 120000   F     1925                                             call            resa_hl;dptr-
0B16 120000   F     1926                                             call            loA3_X  ;адрес след ячейки внешн оз
                             у храним
                    1927                                                                             ;в ячейке saven_bl
0B19 120000   F     1928                                             call            save_hl
0B1C 78AE           1929                                             mov                     r0,#diap
0B1E E6             1930                                             mov                     a,@r0
0B1F 7938           1931                                             mov                     r1,#nblok
0B21 B70104         1932                                             cjne            @r1,#1,nosav1
0B24 F534           1933                                             mov                     sadiap,a
0B26 8012           1934                                             jmp                     gotostrob
0B28 B70204         1935     nosav1:         cjne            @r1,#2,nosav2
0B2B F532           1936                                             mov                     sadiap2,a
0B2D 800B           1937                                     jmp                     gotostrob
0B2F B70304         1938     nosav2:         cjne            @r1,#3,nosav3
0B32 F531           1939                                             mov                     sadiap3,a
0B34 8004           1940                                     jmp                     gotostrob
0B36                1941     nosav3:         
0B36 F530           1942                                             mov                     sadiap4,a
0B38 8000           1943                                     jmp                     gotostrob
                    1944     
                    1945                                             ;строб
0B3A                1946     gotostrob:
0B3A E586           1947                                     mov             a,P6            ;p6.4=0
0B3C 54EF           1948                             anl             a,#0efh
0B3E F586           1949                             mov             P6,a
0B40 00             1950                             nop
0B41 00             1951                             nop
                    1952                                     
0B42 E586           1953                             mov             a,P6                    ;p6.4=1 
0B44 4410           1954                             orl             a,#10h
0B46 F586           1955                             mov             P6,a            
                    1956                                             ;;;;;;;;;
0B48 E5DA           1957                             mov             a,PCA0CPM0;     
0B4A 4446           1958                             orl             a,#46h;anl              a,#0fbh
0B4C F5DA           1959                             mov             PCA0CPM0,a
                    1960     
0B4E 75CDD0         1961                             mov             TH2,#0d0h
0B51 75CC00         1962                             mov             TL2,#00
                    1963     
0B54 D2CA           1964                             setb            T2CON.2
0B56 D2AD           1965                             setb            ET2;IE.5                                    
0B58 78CD           1966     goonT:                          mov             r0,#interva;high  byte loadr2
0B5A E6             1967                                             mov             a,@r0
0B5B FC             1968                                             mov             r4,a
0B5C 08             1969                                             inc             r0
0B5D E6             1970                                             mov             a,@r0
0B5E FD             1971                                             mov             r5,a
0B5F E4             1972                                             clr             a
0B60 FB             1973                                             mov             r3,a
0B61 FA             1974                                             mov             r2,a                            ;r2
                             ..r5-interval(hex)
0B62 120402         1975                                             call            altof                   ;r2..r5->in
                             terval (float)
                    1976     
0B65 789A           1977                                             mov             r0,#parT
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    32

0B67 B60108         1978                                             cjne    @r0,#1,nott1
0B6A 900000   F     1979                                             mov                     dptr,#ch_2       
0B6D 120000   F     1980                                             call            ldc_ltemp
0B70 8009           1981                                             jmp                     intmul
                    1982     
0B72 B60225         1983     nott1:                  cjne    @r0,#2,nott2
0B75 900000   F     1984                                                     mov                     dptr,#ch_10      
0B78 120000   F     1985                                                     call            ldc_ltemp
                    1986                                                                             
0B7B 120203         1987     intmul: call            flmul                                   ;*10
0B7E 900E00         1988     intmul1:        mov             dptr,#chbuf1    ;СБ1
0B81 E0             1989                                             movx    a,@dptr
0B82 F508           1990                                             mov             r8,a
0B84 A3             1991                                             inc             dptr
0B85 E0             1992                                     movx    a,@dptr
0B86 F509           1993                                             mov             r9,a
0B88 A3             1994                                             inc             dptr
0B89 E0             1995                                     movx    a,@dptr
0B8A F50A           1996                                             mov             r10,a
0B8C A3             1997                                             inc             dptr
0B8D E0             1998                                             movx    a,@dptr
0B8E F50B           1999                                             mov             r11,a
0B90 120166         2000                                             call            fladd           ;СБ+СБ1
0B93 78CF           2001     intmul2:        mov                     r0,#chbuf
0B95 120000   F     2002                                     call            saver2          ;*2
                    2003                                     
0B98 803E           2004                                     jmp             gocikle
                    2005     
0B9A B6030B         2006     nott2:                  cjne    @r0,#3,nott3
0B9D 900000   F     2007                                                     mov                     dptr,#ch_2       
0BA0 120000   F     2008                                                     call            ldc_ltemp
0BA3 120203         2009                                                     call            flmul
0BA6 80EB           2010                                                     jmp                     intmul2            
                                                  ;*2
                    2011     
                    2012     
0BA8 B60414         2013     nott3:          cjne    @r0,#4,nott4
0BAB 900000   F     2014                                             mov                     dptr,#ch_10      
0BAE 120000   F     2015                                             call            ldc_ltemp       ;/10*4
0BB1 1202B7         2016                                             call            fldiv
0BB4 900000   F     2017                                             mov                     dptr,#ch_4       
0BB7 120000   F     2018                                             call            ldc_ltemp
0BBA 120203         2019                                             call            flmul
0BBD 80D4           2020                                             jmp             intmul2
                    2021     
0BBF B6050B         2022     nott4:          cjne    @r0,#5,nott5
0BC2 900000   F     2023                                                     mov                     dptr,#ch_2       
0BC5 120000   F     2024                                             call            ldc_ltemp;*2
0BC8 120203         2025                                             call            flmul
0BCB 80C6           2026                                             jmp             intmul2;T=5
0BCD 900000   F     2027     nott5:                  mov                     dptr,#ch_1       
0BD0 120000   F     2028                                             call            ldc_ltemp
0BD3 120203         2029                                             call            flmul
0BD6 80BB           2030                                     jmp                     intmul2                            
                                  ;*1
                    2031     
                    2032     
0BD8 300708         2033     gocikle:        jnb             bitzus,nofz                     
0BDB 120000   F     2034                             call    z_05s    ;0,5c
0BDE 120000   F     2035                             call    z_05s    ;0,5c
0BE1 C207           2036                             clr     bitzus;bitbuf бит задержки засылки us
0BE3 020000   F     2037     nofz:           jmp     labelA;rebyte
                    2038     
                    2039     
0BE6 80F0           2040     yestt5:         jmp             gocikle
                    2041     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    33

0BE8 78CF           2042     nobuf0:                 mov             r0,#chbuf
0BEA 120000   F     2043                                                     call            resar2
0BED 900000   F     2044                                                     mov                     dptr,#ch_1       
0BF0 120000   F     2045                                             call            ldc_ltemp
0BF3 1201D1         2046                                             call            flsub
0BF6 78CF           2047                                             mov                     r0,#chbuf       
0BF8 120000   F     2048                                             call            saver2  
0BFB 80DB           2049                                             jmp             gocikle
                    2050     
                    2051     
0BFD B60205         2052     not1in:                         cjne    @r0,#2,not2in
0C00 7701           2053                                             mov             @r1,#1           ;T=2
0C02 020000   F     2054                                             jmp     labelB
                    2055     
0C05 B60305         2056     not2in:                         cjne    @r0,#3,not3in
0C08 7701           2057                                             mov             @r1,#1;9                ;T=3
0C0A 020000   F     2058                                             jmp     labelB
0C0D 7703           2059     not3in:                         mov             @r1,#3;19
0C0F 020000   F     2060                                             jmp     labelB
                    2061     
                    2062     
                    2063     ;;;;;;;;;;;3.11.06
                    2064     
                    2065     ;;коррекция 0
0C12 7883           2066     KORnul:         mov             r0,#chdel
0C14 B60010         2067                             cjne    @r0,#0,nonuldel
                    2068                                     
0C17 E584           2069                             mov             a,p4                    ;сохр  us
0C19 F536           2070                             mov             saus,a
0C1B E585           2071                             mov             a,p5
0C1D F537           2072                             mov             saus+1,a
                    2073     
0C1F 900000   F     2074                             mov             dptr,#kor0us
0C22 120000   F     2075                             call    lospus          ;упр слово коррекции 0
0C25 8018           2076                             jmp             chdelmo
                    2077     
0C27                2078     nonuldel:       ;cjne   @r0,#7,no4del
0C27 B6031B         2079                                                     cjne    @r0,#3,no4del
                    2080                             ;рез ->AN
0C2A 7862           2081                             mov             r0,#rez_A;->r2..r5
0C2C 120000   F     2082                             call    resar2
                    2083             
                    2084                                     ;;;;;;;;;;
0C2F 120402         2085                             call    altof           ;r2..r5->float
0C32 7884           2086                             mov             r0,#kor0_AN;->kor0_AN
0C34 120000   F     2087                             call    saver2
                    2088                                     
0C37 E536           2089                             mov             a,saus                  ;восстан исходное упр слово
0C39 F584           2090                             mov             p4,a
0C3B E537           2091                             mov             a,saus+1
0C3D F585           2092                             mov             p5,a            
0C3F 7883           2093     chdelmo:        mov             r0,#chdel
0C41 06             2094                             inc             @r0             ;chdel+1
0C42 020000   F     2095                             jmp              rebyte
                    2096     
0C45                2097     no4del:         ;cjne   @r0,#14,chdelmo
0C45 B606F7         2098                                             cjne    @r0,#6,chdelmo
0C48 7600           2099                             mov             @r0,#0          ;chdel
0C4A 7898           2100                             mov             r0,#chinkor
0C4C 7600           2101                             mov             @r0,#00;1;00;02;600;
0C4E 08             2102                             inc             r0
0C4F 76C8           2103                             mov             @r0,#0c8h;90h;0c8h;58h;258h
0C51 120000   F     2104                             call    clmassix;сбросить массив скольз среднего
0C54                2105     bonpart:
0C54 300A20         2106                             jnb                     bitbon,rebyter
0C57 78CF           2107                             mov                     r0,#chbuf
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    34

0C59 120000   F     2108                             call            resar2
0C5C 799A           2109                             mov                     r1,#parT
0C5E B70211         2110                             cjne            @r1,#2,no6del
0C61 900000   F     2111                             mov                     dptr,#ch_7;5
0C64                2112     no5del:
0C64 120000   F     2113                             call            ldc_ltemp
0C67 1201D1         2114                             call            flsub   
0C6A 78CF           2115                             mov                     r0,#chbuf
0C6C 120000   F     2116                             call            saver2
0C6F 020000   F     2117                             jmp              rebyte
0C72                2118     no6del:
0C72 900000   F     2119                             mov                     dptr,#ch_1
0C75 80ED           2120                             jmp                     no5del
                    2121     
0C77 7981           2122     rebyter:        mov             r1,#chavt
0C79 770C           2123                             mov             @r1,#0ch;6;1;
0C7B 09             2124                             inc             r1
0C7C 7780           2125                             mov             @r1,#80h;40h;
0C7E 020000   F     2126                                     jmp             noavk
                    2127     
                    2128     
                    2129     ;автокалибровка
0C81 200AF3         2130     autoka:  jb             bitbon,rebyter
0C84                2131     nulavt:  ;;;;;
0C84 7883           2132                             mov             r0,#chdel
0C86 B60016         2133                             cjne    @r0,#0,nndelch
0C89 E584           2134                             mov             a,p4                    ;сохр  us
0C8B F536           2135                             mov             saus,a
0C8D E585           2136                             mov             a,p5
0C8F F537           2137                             mov             saus+1,a
                    2138     
0C91 E585           2139                             mov   a,p5
0C93 4404           2140                             orl             a,#04              ;p5.2=1
0C95 00             2141                             nop
0C96 00             2142                             nop
0C97 543F           2143                             anl             a,#3fh          ;p5.6,p5.7=0
0C99 F585           2144                             mov   p5,a
0C9B 06             2145                             inc             @r0
0C9C 020000   F     2146                             jmp              rebyte
                    2147     
0C9F B6033D         2148     nndelch:        cjne    @r0,#3,n4delch
                    2149                             ;pez->A+
                    2150                             ;K+=000/(A+-AN)
                    2151                             ;mov            r0,#rez_A;->r2..r5
                    2152                             ;call   resar2
0CA2 E577           2153                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0CA4 FA             2154                                     mov             r2,a
0CA5 E578           2155                                     mov             a,reacp+1
0CA7 FB             2156                                     mov             r3,a
0CA8 E579           2157                                     mov             a,reacp+2
0CAA FC             2158                                     mov             r4,a
0CAB E57A           2159                                     mov             a,reacp+3
0CAD FD             2160                                     mov             r5,a
                    2161                                     ;;;;;;;;;;;;;;;
0CAE 120402         2162                             call    altof                   ;r2..r5->float
0CB1 7888           2163                             mov             r0,#rezAp;->rezAp
0CB3 120000   F     2164                             call    saver2                          
0CB6 7884           2165                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0CB8 120000   F     2166                             call    resar8                          
0CBB 1201D1         2167                             call    flsub           ; r2..r5(A+-AN)
0CBE 120000   F     2168                             call    move28     ;r2..r5->r8..r11
0CC1 900000   F     2169                             mov             dptr,#CH2tho;000->r2..r5 float
0CC4 120000   F     2170                             call    ldc_long                
0CC7 1202B7         2171                             call    fldiv
0CCA EA             2172                             mov             a,r2
0CCB 547F           2173                             anl             a,#7fh
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    35

0CCD FA             2174                             mov             r2,a
0CCE 7890           2175                             mov             r0,#koefKp;->koefKp
0CD0 120000   F     2176                             call    saver2
                    2177                       
                    2178                     ;       anl             P5,#0feh                ;p5.0=0 
0CD3 E585           2179                     mov             a,P5
0CD5 543B           2180                             anl             a,#3bh;acp-
0CD7 F585           2181                             mov             P5,a
0CD9 7883           2182                             mov             r0,#chdel
0CDB 06             2183                             inc             @r0                       ;ch+1
0CDC 020000   F     2184                             jmp             rebyte
                    2185     
0CDF B6063F         2186     n4delch:        cjne    @r0,#6,n8delch
                    2187                             ; pez->A-
                    2188                             ;K-=000/(A--AN)
                    2189                     ;       mov     r0,#rez_A;->r2..r5
                    2190                     ;       call    resar2
0CE2 E577           2191                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0CE4 FA             2192                                     mov             r2,a
0CE5 E578           2193                                     mov             a,reacp+1
0CE7 FB             2194                                     mov             r3,a
0CE8 E579           2195                                     mov             a,reacp+2
0CEA FC             2196                                     mov             r4,a
0CEB E57A           2197                                     mov             a,reacp+3
0CED FD             2198                                     mov             r5,a
                    2199                                     ;;;;;;;;;;;;;;;
0CEE 120402         2200                             call    altof                   ;r2..r5->float
0CF1 788C           2201                             mov             r0,#rezAm;->rezAm
0CF3 120000   F     2202                             call    saver2                          
0CF6 7884           2203                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0CF8 120000   F     2204                             call    resar8                          
0CFB 1201D1         2205                             call    flsub                   ; r2..r5(A--AN)
0CFE 120000   F     2206                             call    move28                  ;r2..r5->r8..r11
0D01 900000   F     2207                             mov             dptr,#CH2tho    ;000->r2..r5 float
0D04 120000   F     2208                             call    ldc_long                
0D07 1202B7         2209                             call    fldiv
0D0A EA             2210                             mov             a,r2
0D0B 547F           2211                             anl             a,#7fh
0D0D FA             2212                             mov             r2,a
0D0E 7894           2213                             mov             r0,#koefKm;->koefKm
0D10 120000   F     2214                             call    saver2
                    2215                        
0D13 E536           2216                             mov             a,saus                  ;восстан исходное упр слово
0D15 F584           2217                             mov             p4,a
0D17 E537           2218                             mov             a,saus+1
0D19 F585           2219                             mov             p5,a            
0D1B 7883           2220                             mov             r0,#chdel
0D1D 06             2221                             inc             @r0                       ;ch+1
0D1E 020000   F     2222                        jmp    rebyte
                    2223     
0D21 B6090F         2224     n8delch:        cjne    @r0,#9,n12delch
0D24 7600           2225                             mov             @r0,#0
0D26 7981           2226                             mov             r1,#chavt
0D28 770C           2227                             mov             @r1,#0ch;6;1;
0D2A 09             2228                             inc             r1
0D2B 7780           2229                             mov             @r1,#80h;40h;
0D2D 120000   F     2230                             call   clmassix     ;сбросить массив среднего
0D30 020000   F     2231                             jmp             rebyte; bonpart;
0D33 06             2232     n12delch:       inc             @r0
0D34 020000   F     2233                             jmp             rebyte
                    2234     
                    2235     
                    2236     
                    2237                                 
0D37 020000   F     2238     rout6:          jmp             out6
0D3A 020000   F     2239     rlabelF:        jmp             labelF  
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    36

0D3D 020000   F     2240     rknrazr:        jmp             knrazr  
0D40 020000   F     2241     rknopt:         jmp             knopt
0D43 020000   F     2242     rizman:         jmp             izman   
0D46                2243     keyb1:  ;IE6 
0D46 75E700         2244                                     mov             EIE2,#00H
0D49 75AD00         2245                                     mov             P3IF,#00
                    2246                                     
0D4C C0E0           2247                                     push    acc
0D4E C0D0           2248                                     push    psw
0D50 C000           2249                                     push    rr0
0D52 C001           2250                                     push    rr1
0D54 C002           2251                                     push    rr2
0D56 C003           2252                                     push    rr3
0D58 C004           2253                                     push    rr4
0D5A C005           2254                                     push    rr5
0D5C C006           2255                                     push    rr6
0D5E C007           2256                                     push    rr7
0D60 C082           2257                                     push    dpl
0D62 C083           2258                                     push    dph
                    2259                                     ;clr            bitmig
                    2260                       ;;;;;;;;;;;;;;
0D64 120000   F     2261                                     call    z_01s;0,1s
0D67 120000   F     2262                                             call    z_01s
                    2263                                     ;восстан знакоместо при мигании
                    2264                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0D6A 78B2           2265                                     mov             r0,#marker
0D6C 7440           2266                                     mov             a,#bufind
0D6E 26             2267                                     add             a,@r0                   ;a=bufind+marker
0D6F F9             2268                                     mov             r1,a
0D70 A73C           2269                                     mov             @r1,savba
                    2270                                     ;;;;;;;;;;;
0D72 E5B0           2271                             mov             a,p3
0D74 20E644         2272                                     jb              acc.6,outviR;выход из режима выч R
0D77 E5B0           2273     gout6:                          mov             a,p3
0D79 44FF           2274                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0D7B F5B0           2275                                     mov             p3,a
0D7D E5B0           2276                                     mov             a,p3
0D7F 30E6B5         2277                                     jnb             acc.6,rout6             ;error
0D82 3004B5         2278                                     jnb             bitizm,rlabelF
0D85 75B0FE         2279                                     mov             p3,#0feh                ;реж IZM
0D88 E5B0           2280                                     mov             a,p3
0D8A 30E6B6         2281                                     jnb             acc.6,rizman
                    2282                                     ;;;;;;
0D8D 201232         2283                                     jb              bitklb,goklb
0D90 75B0FD         2284                                     mov             p3,#0fdh
0D93 E5B0           2285                                     mov             a,p3
0D95 30E6A5         2286                                     jnb             acc.6,rknrazr             ;labelC
0D98 75B0FB         2287                                     mov             p3,#0fbh
0D9B E5B0           2288                                     mov             a,p3
0D9D 30E655         2289                                     jnb             acc.6,knright           ;->
0DA0 75B0F7         2290                                     mov             p3,#0f7h
0DA3 E5B0           2291                                     mov             a,p3
0DA5 30E698         2292                                     jnb             acc.6,rknopt                    ;T
0DA8 75B0EF         2293                                     mov             p3,#0efh
0DAB E5B0           2294                                mov          a,p3
0DAD 30E615         2295                                     jnb             acc.6,pyskst                    ;pysk/stop
0DB0 75B0DF         2296                                     mov             p3,#0dfh
0DB3 E5B0           2297                                     mov             a,p3
0DB5 30E65E         2298                                jnb          acc.6,knvich
0DB8 020000   F     2299                                     jmp             izmpaT
                    2300     
0DBB 3006B9         2301     outviR: jnb             bitvi11,gout6   
0DBE C214           2302                                     clr             bitvich                         ;выход из р
                             ежима выч R  
0DC0 C206           2303                                     clr             bitvi11
                    2304                                     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    37

0DC2 020000   F     2305     goklb:          jmp             out6
                    2306     
0DC5 200A12         2307     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0DC8 D20A           2308                                     setb    bitbon  ;уст реж буфер вкл
0DCA 79D5           2309                                     mov                     r1,#volume;work         ;обьем блок
                             а
0DCC 7700           2310                                     mov                     @r1,#00
0DCE 09             2311                                     inc                     r1
0DCF 77C7           2312                                     mov                     @r1,#0c7h                       ;32
                             0h/4
0DD1 434B02         2313                                     orl             bufind+11,#02h; on pysk
0DD4 120000   F     2314                                     call            ind
0DD7 020000   F     2315                                     jmp             izmpaT
0DDA C20A           2316     bufon:                  clr             bitbon  ;уст реж буфер выкл
0DDC 534BFD         2317                                             anl             bufind+11,#0fdh; off pysk
0DDF 120000   F     2318                                             call    ind
0DE2 020000   F     2319                                     jmp             izmpaT
                    2320     
0DE5 79B0           2321     tizmri:                 mov             r1,#level
0DE7 B70102         2322                                     cjne    @r1,#1,right2
                    2323                                     ;10s->HET
0DEA 8004           2324                                     jmp             right3
                    2325     
0DEC 07             2326     right2:                 inc             @r1
0DED 120000   F     2327                                     call    lolevT
                    2328                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0DF0 120000   F     2329     right3:                 call    ind
0DF3 807A           2330                                     jmp             izmfun
                    2331     
                    2332                             
                    2333                             
0DF5                2334     knright:        
                    2335     
0DF5 79AE           2336                                     mov             r1,#diap
                    2337                             ;перекл диапазон 1 поз вверх сбр массив
0DF7 17             2338                                     dec             @r1
0DF8 B7FF04         2339                                     cjne    @r1,#0ffh,diinc
0DFB 7700           2340                                     mov             @r1,#0
0DFD 8070           2341                                     jmp  izmfun
0DFF 120000   F     2342     diinc:                  call     clmassix
0E02 78B3           2343                                     mov             r0,#summa
0E04 120000   F     2344                                     call    clear4
0E07 786A           2345                                     mov             r0,#rez_A0
0E09 120000   F     2346                                     call    clear4
0E0C C20F           2347                                     clr             bitnul          ;гасить светодиод НУЛЬ  
0E0E 120000   F     2348                                     call    loadUS
0E11 805C           2349                                      jmp  izmfun
                    2350     
0E13 020000   F     2351     vit2_10:                jmp             out6
0E16                2352     knvich:                 ;12.02.07
0E16 789A           2353                                             mov                     r0,#parT
0E18 C3             2354                                             clr                     c
0E19 7404           2355                                             mov                     a,#4 
0E1B 96             2356                                             subb            a,@r0
0E1C 40F5           2357                                             jc                      vit2_10;не нажимать кнопку 
                             ВЫЧ R T=10ms,2ms
0E1E 200613         2358                               jb            bitvi11,onvich
0E21 C204           2359                                     clr             bitizm
0E23 D214           2360                                     setb    bitvich
                    2361                                     
0E25 78B1           2362                                     mov             r0,#vichR
0E27 7611           2363                                     mov             @r0,#11h;;????????or 0
                    2364                                     ;ВЫЧИСЛИТЬ
0E29 900000   F     2365                                     mov     dptr,#teVICH
0E2C 120000   F     2366                                     call    lotext
0E2F 120000   F     2367                                call         z_1s;;;;;;;
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    38

0E32 806C           2368                                     jmp              viout;izmpaT
                    2369     
0E34 C214           2370     onvich:                 clr             bitvich
0E36 78B1           2371                                     mov             r0,#vichR
0E38 7600           2372                                     mov             @r0,#0
0E3A 8037           2373                                     jmp              izmpaT
                    2374     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0E3C 301820         2375     louizm:            jnb          knizm,lou
0E3F 79AE           2376                                     mov             r1,#diap
0E41 C3             2377                                     clr             c
0E42 7403           2378                                     mov             a,#3
0E44 97             2379                                     subb    a,@r1
0E45 5006           2380                                     jnc             lldi23    ;10-2..10-5
                    2381                                     ;10-6..10-11
0E47 E584           2382                                     mov             a,p4
0E49 54F7           2383                                     anl             a,#0f7h   ;d3
0E4B F584           2384                                     mov             p4,a
0E4D E7             2385     lldi23:                 mov             a,@r1
0E4E 6403           2386                                     xrl             a,#3
0E50 7002           2387                                     jnz             lldi3
0E52 8005           2388                                     jmp             lldi2   ;10-5
0E54 E7             2389     lldi3:                  mov             a,@r1
0E55 6402           2390                                     xrl             a,#2            ;
0E57 7006           2391                                     jnz             lou             
0E59 E585           2392     lldi2:                  mov             a,p5            ;10-4
0E5B 4408           2393                                     orl             a,#08
0E5D F585           2394                                     mov             p5,a
0E5F 22             2395     lou:                    ret
                    2396                               ;;;;;;
0E60 201807         2397     izman:                  jb              knizm,knizmon
0E63 D218           2398                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2399                             ;       d3(k5 p4),d3(u5 p5)заслать us
0E65 120000   F     2400                                     call    louizm 
0E68 8005           2401                                     jmp             izmfun
0E6A C218           2402     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0E6C 120000   F     2403                                     call    loadUS;восстановить us
0E6F                2404     izmfun:                 
0E6F D207           2405                                     setb    bitzus;bitbuf
0E71 8000           2406                                     jmp             labelE;;;;;;;;;;;;
                    2407                                     ;;;;;;;;;;;;;;
0E73                2408     izmpaT:
                    2409     ;;;;;;;;;;;;;;;;;
                    2410                     ;       clr             c 
                    2411                     ;       mov             r1,#parN
                    2412     
                    2413                     ;       mov             r0,#diap
                    2414                     ;       mov             a,#6            
                    2415                     ;       subb    a,@r0
                    2416                     ;       jnc             labelE          ;         ;10-2..10-8
                    2417                               
                    2418                     ;       mov             @r1,#2          ;10-9..10-11            
                    2419                     ;       jmp             labelE
                    2420     
                    2421     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0E73 789A           2422     labelE:                 mov             r0,#parT
0E75 793D           2423                                     mov             r1,#chkl
0E77 B60108         2424                                     cjne    @r0,#1,izmt2
0E7A 7700           2425                                     mov             @r1,#0
0E7C 09             2426                                     inc             r1
0E7D 7702           2427                                     mov             @r1,#2
0E7F 020000   F     2428                                     jmp             out6
0E82 B60208         2429     izmt2:                  cjne    @r0,#2,izmt3
0E85 7700           2430                                     mov             @r1,#0
0E87 09             2431                                     inc             r1
0E88 7714           2432                                     mov             @r1,#20
0E8A 020000   F     2433                                     jmp             out6
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    39

                    2434     
0E8D 7700           2435     izmt3:                  mov             @r1,#0
0E8F 09             2436                                     inc             r1
0E90 77C8           2437                                     mov             @r1,#200
0E92 020000   F     2438                                     jmp             out6
                    2439     
                    2440     
                    2441     
                    2442     
0E95                2443     knopt: ;кнопка T
0E95 C204           2444                                clr          bitizm
0E97 D210           2445                                setb         bitt2
0E99 79B7           2446                                mov          r1,#load
0E9B 7704           2447                                mov          @r1,#4;1s
0E9D 120000   F     2448                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2449                     
0EA0 793D           2450     viout:          mov             r1,#chkl
0EA2 7703           2451                             mov             @r1,#03
0EA4 09             2452                             inc             r1
0EA5 77E8           2453                             mov             @r1,#0e8h               ;1000
0EA7 020000   F     2454                             jmp             out6
                    2455     
0EAA                2456     knrazr:          
0EAA C3             2457     labelC:          clr            c
0EAB 78AF           2458                             mov             r0,#parN
0EAD 799A           2459                             mov             r1,#parT
0EAF 7402           2460                             mov             a,#2
0EB1 97             2461                             subb    a,@r1
0EB2 40BF           2462                             jc              labelE          ;T>2
0EB4 B60104         2463                             cjne    @r0,#1,noN1c
0EB7 7602           2464                             mov             @r0,#2          ;N=2
0EB9 80B8           2465                             jmp             labelE
                    2466     
0EBB B60204         2467     noN1c:          cjne    @r0,#2,not_1
0EBE 7603           2468                             mov             @r0,#3          ;N=3      ;10-2..10-8
0EC0 80B1           2469                             jmp             labelE
                    2470     
0EC2                2471     not_10: 
0EC2 7601           2472     not_1:          mov             @r0,#1                          ;N=1
0EC4 80AD           2473                             jmp     labelE
                    2474     
0EC6 020000   F     2475     rtizmri:        jmp             tizmri
                    2476     
0EC9 75B0F7         2477     ttout:          mov             p3,#0f7h
0ECC 20B6D1         2478                                             jb              p3.6,viout
0ECF D204           2479                                             setb    bitizm;отжатие кнопки t
0ED1 C210           2480                                             clr             bitt2
0ED3 809E           2481                                             jmp             labelE
0ED5                2482     labelf:                 
0ED5 301037         2483                             jnb             bitt2,nofizm
0ED8 75B0FB         2484                        mov          p3,#0fbh
0EDB E5B0           2485                        mov          a,p3
0EDD 20E6E9         2486                        jb           acc.6,ttout;outF
0EE0 79B7           2487                        mov          r1,#load;parT
0EE2 B70503         2488                        cjne         @r1,#5,noft1
                    2489                        ;t=10s
0EE5 020000   F     2490                        jmp          out6;ft1izm
                    2491     
0EE8 07             2492     noft1:     inc          @r1;dec         @r1
0EE9 120000   F     2493     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2494                             ;call   ind
0EEC 020000   F     2495                     jmp             out6;??????????????/
                    2496     
                    2497                             ;увеличить счетчик задержки клавиатуры
0EEF 783D           2498     outF:           mov             r0,#chkl
0EF1 7627           2499                             mov             @r0,#27h
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    40

0EF3 08             2500                             inc             r0
0EF4 7610           2501                             mov             @r0,#10h
0EF6 020000   F     2502                             jmp             out6;out7
                    2503     
0EF9 020000   F     2504     noviR1:         jmp             noviR
0EFC 78B1           2505     outvich:        mov                     r0,#vichR
0EFE 7600           2506                                             mov                     @r0,#0
0F00 C214           2507                                             clr                     bitvich
0F02 C206           2508                                             clr                     bitvi11
0F04 C211           2509                                             clr                     bitmenu
0F06 D204           2510                                             setb            bitizm
0F08 78B2           2511                                             mov                     r0,#marker
0F0A 76FF           2512                                             mov                     @r0,#0ffh
0F0C 020000   F     2513                                             jmp                     out6    
                    2514     
0F0F 3014E7         2515     nofizm:         jnb             bitvich,noviR1
0F12 75B0DF         2516                                                     mov             p3,#0dfh
0F15 30B6E4         2517                                                     jnb             p3.6,outvich;отжатие кнопки
                              вычR
0F18 78B1           2518                             mov             r0,#vichR
0F1A B61110         2519                             cjne    @r0,#11h,no11v6
0F1D 75B0FB         2520                             mov                     p3,#0fbh;->
0F20 20B6CC         2521                             jb                      p3.6,outF
0F23 7612           2522                             mov             @r0,#12h                ;11= вычислить
0F25 900000   F     2523     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0F28 120000   F     2524                             call    lotext
0F2B 80C2           2525                             jmp             outF
                    2526             
0F2D B61210         2527     no11v6:         cjne    @r0,#12h,no12v6
0F30 75B0FB         2528                             mov             p3,#0fbh;->
0F33 20B6B9         2529                             jb              p3.6,outF
0F36 7613           2530                             mov             @r0,#13h
0F38 900000   F     2531                             mov             dptr,#teOUT
0F3B 120000   F     2532                             call    lotext
0F3E 80AF           2533                             jmp             outF
                    2534                     
0F40 B61310         2535     no12v6:         cjne    @r0,#13h,no13v6
0F43 75B0FB         2536                                                     mov             p3,#0fbh;->
0F46 20B6A6         2537                             jb              p3.6,outF
0F49 7611           2538                             mov             @r0,#11h
0F4B 900000   F     2539                             mov             dptr,#teVICH
0F4E 120000   F     2540                             call    lotext
0F51 809C           2541                             jmp             outF
                    2542     
                    2543     ;кн -> A= 0000
                    2544     ;кн -> B= +00000
0F53 75B0FB         2545     no13v6:         mov             p3,#0fbh
0F56 E5B0           2546                             mov             a,p3
0F58 20E635         2547                             jb              acc.6,chanZ
0F5B E53B           2548                             mov             a,movrig
0F5D B40714         2549                             cjne    a,#7,kon_B      
0F60 78B2           2550                             mov             r0,#marker      ;A= 0000
0F62 B60716         2551                             cjne    @r0,#7,mark0_8          ;курсор справа ?
0F65 E53A           2552     rikn:           mov             a,movleft
0F67 F6             2553                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2554     ;                               29.12.06
                    2555     ;;;;;;;;;;;;;;;;;;
                    2556     ;необходимо не портить цифру в следуюем справа знакоместе
                    2557     ;т е сохранить ее в ячейке для мигания в противном случае
                    2558     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2559     ;       знакоместа
0F68 78B2           2560                                     mov             r0,#marker
0F6A 7440           2561                                     mov             a,#bufind
0F6C 26             2562                                             add             a,@r0                   ;a=bufind+m
                             arker
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    41

0F6D F9             2563                                             mov             r1,a
0F6E 09             2564                                             inc             r1
0F6F 873C           2565                                             mov             savba,@r1
0F71 020000   F     2566                                     jmp             outF
                    2567     
0F74 78B2           2568     kon_B:          mov             r0,#marker      ;B= +00000
0F76 B60802         2569                                             cjne    @r0,#8,mark0_8          ;курсор справа ?
0F79 80EA           2570                                             jmp             rikn
0F7B                2571     mark0_8:
                    2572     ;                               29.12.06
                    2573     ;;;;;;;;;;;;;;;;;;
                    2574     ;необходимо не портить цифру в следуюем справа знакоместе
                    2575     ;т е сохранить ее в ячейке для мигания в противном случае
                    2576     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2577     ;       знакоместа ->B=+00000
0F7B 78B2           2578                                             mov             r0,#marker
0F7D 7440           2579                                     mov             a,#bufind
0F7F 26             2580                                             add             a,@r0                   ;a=bufind+m
                             arker
0F80 F9             2581                                             mov             r1,a
0F81 09             2582                                             inc             r1
0F82 873C           2583                                             mov             savba,@r1
0F84 78B2           2584                             mov             r0,#marker
0F86 06             2585                             inc             @r0             ;       сдвинуть курсор вправо на 1
0F87 C219           2586                             clr             bitmig
0F89 B60901         2587                             cjne    @r0,#9,outma
0F8C 18             2588                             dec             r0;ppp
0F8D 020000   F     2589     outma:          jmp             outF
                    2590     
0F90 75B0FE         2591     chanZ:          mov             p3,#0feh
0F93 E5B0           2592                             mov             a,p3
0F95 20E611         2593                             jb              acc.6,chanma
                    2594                             ;изм знак в старшем разряде на противоположн
0F98 E543           2595                             mov             a,bufind+3
0F9A B42B06         2596                             cjne            a,#2bh,noplus
0F9D 75432D         2597                             mov                     bufind+3,#2dh           ;+->-   
0FA0 020000   F     2598                             jmp             outF
0FA3                2599     noplus:
0FA3 75432B         2600                             mov                     bufind+3,#2bh           ;-/+-
0FA6 020000   F     2601                             jmp             outF
0FA9 75B0FD         2602     chanma:         mov             p3,#0fdh
0FAC E5B0           2603                             mov             a,p3
0FAE 20E603         2604                             jb              acc.6,outFl;labelL1
                    2605                             ;clr            bitmig
0FB1 120000   F     2606     labelL1:        call    vvchibl;f       ;увеличить цифру 
                    2607     
0FB4 020000   F     2608     outFl:                  jmp             outF
                    2609                     
0FB7                2610     nor11:          ;       выход
0FB7 7613           2611                     mov             @r0,#13h  ;12->13
0FB9 900000   F     2612                     mov             dptr,#teOUT
                    2613     ;               jmp             vi1113
                    2614     
                    2615     ;;;;;;;;;кнопка -> в режиме кнопки меню
                    2616     
                    2617     
                    2618     
0FBC 020000   F     2619     rlabelL:        jmp                     labelL
0FBF 020000   F     2620     rfindmem:               jmp             findmem
0FC2 3011FA         2621     noviR:          jnb                     bitmenu,rfindmem;17.01.07
                    2622     ;;;;;;;;;;;;;
0FC5 78B1           2623                                             mov                     r0,#vichR
0FC7 7415           2624                                             mov                     a,#15h
0FC9 C3             2625                                             clr                     c
0FCA 96             2626                                             subb            a,@r0
0FCB 4016           2627                                             jc                      ri21_23
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    42

                    2628     
0FCD 75B0FB         2629                                             mov             p3,#0fbh; реж кн меню ->
0FD0 20B60A         2630                                             jb              p3.6,ri6
0FD3 78B1           2631                                             mov             r0,#vichR
0FD5 B61508         2632                                             cjne    @r0,#15h,norime
0FD8 7611           2633                                             mov             @r0,#11h
0FDA 120000   F     2634     norime1:        call            lomenu
0FDD 020000   F     2635     ri6:                    jmp             out6
0FE0 06             2636     norime:         inc             @r0
0FE1 80F7           2637                                             jmp             norime1
                    2638             
0FE3 7423           2639     ri21_23:        mov                     a,#23h          ;->
0FE5 C3             2640                                             clr                     c
0FE6 96             2641                                             subb            a,@r0
0FE7 4014           2642                                             jc                      ri_31
0FE9 75B0FB         2643                                             mov                     p3,#0fbh
0FEC 20B6EE         2644                                             jb                      p3.6,ri6
0FEF B62308         2645                                             cjne            @r0,#23h,no23ri
0FF2 7621           2646                                             mov                     @r0,#21h
0FF4 120000   F     2647                                             call            lomenu
0FF7 020000   F     2648                                             jmp                     out6
0FFA 06             2649     no23ri:         inc                     @r0
0FFB 80DD           2650                                             jmp                     norime1
0FFD B6312B         2651     ri_31:          cjne            @r0,#31h,no31ri;->19.2->57.6->19.2
                    2652     
                    2653     ;;
1000 75B0FB         2654                                             mov                     p3,#0fbh
1003 20B6D7         2655                                             jb                      p3.6,ri6
                    2656     ;;
1006 301311         2657                                             jnb                     bitv19,gosk19
1009 900000   F     2658                                             mov                     dptr,#teS57_6;57,6
100C 120000   F     2659                                             call            lotext
100F 534B03         2660                                             anl                     bufind+11,#03h
1012 434B80         2661                                             orl                     bufind+11,#80h
1015 C213           2662                                             clr                     bitv19
1017 020000   F     2663                                             jmp                     out6
101A 900000   F     2664     gosk19:         mov                     dptr,#teS19_2
101D 120000   F     2665                                             call            lotext
1020 534B03         2666                                             anl                     bufind+11,#03h
1023 434B80         2667                                             orl                     bufind+11,#80h
1026 D213           2668                                             setb            bitv19
1028 020000   F     2669                                             jmp                     out6
                    2670     
                    2671     
                    2672     
                    2673     ;labelS2:       jmp                     out6
                    2674     
102B 7452           2675     no31ri:         mov                     a,#52h;42h              ;->
102D C3             2676                                             clr                     c
102E 96             2677                                             subb            a,@r0
102F 40AC           2678                                             jc                      ri6
1031 75B0FB         2679                                             mov                     p3,#0fbh                   
                                  ;41,42
1034 30B609         2680                                             jnb                     p3.6,rlabelN    ;кнопка ->(
                             пароль 000)
1037 75B0FD         2681                                             mov                     p3,#0fdh
103A 20B6A0         2682                                             jb                      p3.6,ri6
103D 020000   F     2683                                             jmp             labelL1                            
                                  ;кнопка 0..9  (пароль 000)
1040 020000   F     2684     rlabelN:                jmp             labelN
1043 020000   F     2685     moutF:          jmp             outF
                    2686     ;;;;;;;;;;;;;;;;;;;;;;;;;
1046 020000   F     2687     rnnmemb:        jmp             nnmemb
                    2688     
1049                2689     nbimenu:
1049 300BFA         2690     findmem:        jnb             bitmem,rnnmemb
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    43

104C 79B0           2691                             mov             r1,#level                                          
                                          ;-> кн ПАМЯТЬ (ОЧИСТКА ->ЗАПИСЬ-> ПРОСМОТР)
104E B71113         2692                        cjne         @r1,#11h,nomem11
                    2693                        
1051 75B0FB         2694                        mov          p3,#0fbh
1054 E5B0           2695                        mov          a,p3
1056 20E6EA         2696                        jb           acc.6,moutF
1059 7712           2697                        mov          @r1,#12h
105B 900000   F     2698                        mov          dptr,#teWR      ;                       ЗАПИСЬ
105E 120000   F     2699                        call         lotext
1061 020000   F     2700                        jmp          outF
                    2701     
1064 B71213         2702     nomem11:   cjne         @r1,#12h,nomem12
1067 75B0FB         2703                             mov             p3,#0fbh
106A E5B0           2704                        mov          a,p3
106C 20E6D4         2705                        jb           acc.6,moutF
106F 7713           2706                        mov          @r1,#13h
1071 900000   F     2707                        mov          dptr,#teLIST            ;ПРОСМОТР
1074 120000   F     2708                        call         lotext
1077 020000   F     2709                        jmp          outF
107A B71313         2710     nomem12:         cjne           @r1,#13h,nomem13
107D 75B0FB         2711                                             mov             p3,#0fbh
1080 E5B0           2712                        mov          a,p3
1082 20E6BE         2713                        jb           acc.6,moutF
1085 7714           2714                        mov          @r1,#14h
1087 900000   F     2715                        mov          dptr,#teSTAT                    ;СТАТИСТИКА
108A 120000   F     2716                        call         lotext
108D 020000   F     2717                          jmp                outF
                    2718                             
1090 B71413         2719     nomem13:cjne            @r1,#14h,labelL
1093 75B0FB         2720                             mov             p3,#0fbh
1096 E5B0           2721                        mov          a,p3
1098 20E6A8         2722                        jb           acc.6,moutF
109B 7711           2723                        mov          @r1,#11h
109D 900000   F     2724                        mov          dptr,#teCLE                     ;ОЧИСТКА
10A0 120000   F     2725                        call         lotext
10A3 020000   F     2726                          jmp                outF
10A6                2727     labelL: 
                    2728                             ;ПОЛНАЯ->БЛОК 00(level 21->22) 
10A6 78B0           2729                                     mov                     r0,#level
10A8 B6210E         2730                                     cjne            @r0,#21h,nobl21
10AB 7622           2731                                     mov                     @r0,#22h                ;->БЛОК 
10AD 900000   F     2732                                     mov                     dptr,#teBL
10B0 120000   F     2733     me21_22:call            lotext
                    2734                             
10B3 120000   F     2735                                     call            z_05s;задержка чтобы не проскакивала пргр н
                             а следующий уровень
10B6 020000   F     2736                                     jmp                     outF
                    2737     
10B9 B62207         2738     nobl21: cjne            @r0,#22h,nobl22
10BC 900000   F     2739                                     mov                     dptr,#teFULL
10BF 7621           2740                                     mov                     @r0,#21h                ;->ПОЛНАЯ
                    2741     
10C1 80ED           2742                                     jmp                     me21_22
                    2743     
                    2744     ;labl21:           cjne @r0,#21h,nolev1
                    2745     ;                       mov             p3,#0fbh
                    2746     ;                       mov             a,p3
                    2747     ;                       jb              acc.6,loutF
                    2748     ;                       cjne    @r0,#21h,labl22
                    2749     ;                       mov             @r0,#22h
                    2750                             ;БЛОК
                    2751     ;                       call    lotext
                    2752     ;                       jmp             outF
                    2753     ;labl22:                mov             @r0,#21h
                    2754                             ;ПОЛНАЯ
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    44

                    2755     ;                       call    lotext
                    2756     ;                       jmp             outF
                    2757                      
10C3 B62325         2758     nobl22:         cjne    @r0,#23h,go31l
10C6 75B0FB         2759     rigblo:         mov             p3,#0fbh
10C9 20B629         2760                                             jb              p3.6,llev2
10CC                2761     labL2:    ;  уст курсор в правую позицию 
                    2762                                     ;       кнопка                  ->
                    2763     ;;;;;;;;;;;;;;;;;;
                    2764     ;необходимо не портить цифру в следуюем справа знакоместе
                    2765     ;т е сохранить ее в ячейке для мигания в противном случае
                    2766     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2767     ;       знакоместа
10CC 78B2           2768                                             mov             r0,#marker
10CE 7440           2769                                     mov             a,#bufind
10D0 26             2770                                             add             a,@r0                   ;a=bufind+m
                             arker
10D1 F9             2771                                             mov             r1,a
10D2 09             2772                                             inc             r1
10D3 873C           2773                                             mov             savba,@r1
10D5 C219           2774                                             clr             bitmig
                    2775     ;;;;;;;;;;;;;;;;
10D7 78B2           2776                       mov           r0,#marker      ;курсор справа  ?
10D9 E53B           2777                             mov             a,movrig
10DB C3             2778                             clr             c
10DC 96             2779                             subb    a,@r0
10DD 6006           2780                             jz         equ1l
10DF E53B           2781                             mov             a,movrig;уст в правую позицию
10E1 F6             2782                             mov             @r0,a
10E2 020000   F     2783                             jmp             outF                                     
10E5 E53A           2784     equ1l:          mov             a,movleft;уст в левую позицию
10E7 F6             2785                             mov             @r0,a   
10E8 020000   F     2786     loutF:  jmp             outF
                    2787                     
                    2788     
10EB B63102         2789     go31l:          cjne    @r0,#31h,go41l
10EE 80D6           2790                             jmp             rigblo
10F0 B6410B         2791     go41l:          cjne    @r0,#41h,norig2
10F3 80D1           2792                             jmp             rigblo
                    2793     
10F5 75B0FD         2794     llev2:          mov             p3,#0fdh
10F8 20B6ED         2795                             jb              p3.6,loutF
10FB 020000   F     2796                             jmp             labelL1
                    2797     
                    2798     ;->
10FE C3             2799     norig2:    clr          c               ;32,33,34,42
10FF 7431           2800                             mov             a,#31h
1101 96             2801                             subb    a,@r0
1102 50E4           2802                             jnc             loutF
1104 75B0FB         2803     rigblok:        mov             p3,#0fbh  ;32,33,34,42
1107 20B626         2804                             jb              p3.6,lev2go
110A                2805     labelN: 
                    2806                             ;                               29.12.06
                    2807     ;;;;;;;;;;;;;;;;;;
                    2808     ;необходимо не портить цифру в следуюем справа знакоместе
                    2809     ;т е сохранить ее в ячейке для мигания в противном случае
                    2810     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2811     ;       знакоместа
110A 78B2           2812                                             mov             r0,#marker
110C 7440           2813                                     mov             a,#bufind
110E 26             2814                                             add             a,@r0                   ;a=bufind+m
                             arker
110F F9             2815                                             mov             r1,a
1110 09             2816                                             inc             r1
1111 873C           2817                                             mov             savba,@r1
                    2818     ;;;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    45

1113 78B2           2819                             mov             r0,#marker      ;курсор справа  ?
1115 E53B           2820                             mov             a,movrig
1117 C3             2821                             clr             c
1118 96             2822                             subb    a,@r0
1119 7006           2823                             jnz        noequ1
111B E53A           2824                             mov             a,movleft;уст в крайнюю левую позицию
111D F6             2825                             mov             @r0,a
111E 020000   F     2826                             jmp             outF
1121                2827     noequ1: ;29.12.06
                    2828     ;;;;;;;;;;;;;;;;;;
                    2829                             ;восстан знакоместо при мигании
                    2830                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
1121 78B2           2831                                     mov             r0,#marker
1123 7440           2832                                     mov             a,#bufind
1125 26             2833                                     add             a,@r0                   ;a=bufind+marker
1126 F9             2834                                     mov             r1,a
                    2835                                     ;mov            @r1,savba
1127 09             2836                                     inc             r1
1128 873C           2837                                     mov             savba,@r1
                    2838     ;;;;;;;;;;;;;;;;        
112A 120000   F     2839                             call    marri;уст сдвиг в правую        позицию
112D 020000   F     2840                             jmp             outF
1130 75B0FD         2841     lev2go:         mov             p3,#0fdh
1133 30B603         2842                             jnb             p3.6,rlabelL1
1136 020000   F     2843                             jmp             outF
                    2844     
1139 020000   F     2845     rlabelL1:       jmp             labelL1
                    2846     
113C                2847     nnmemb:
                    2848                                     
                    2849     
                    2850     
113C                2851     norim6:    ;kn menu
113C D083           2852     out6:           pop             dph
113E D082           2853                                     pop             dpl
1140 D007           2854                                     pop             rr7     
1142 D006           2855                                     pop             rr6
1144 D005           2856                                     pop             rr5
1146 D004           2857                                     pop             rr4
1148 D003           2858                                     pop             rr3
114A D002           2859                                     pop             rr2
114C D001           2860                                     pop             rr1                             
114E D000           2861                                     pop             rr0
1150 D0D0           2862                                     pop             psw
1152 D0E0           2863                                     pop             acc
                    2864     ;clr            bitmig
                    2865                               ; mov         EIE2,#30H
                    2866                              ;  mov         a,P3IF
                    2867                             ;       anl             a,#0bfh
                    2868                             ;       mov             P3IF,a
                    2869                             ;       mov             P3,#0c0h
                    2870                             ;;;;;;
1154 75AD00         2871                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1157 75B0C0         2872                             mov             P3,#0c0h
115A C219           2873                             clr             bitmig
115C E586           2874                                             mov             a,P6            ;p6.4=0
115E 54EF           2875                             anl             a,#0efh
1160 F586           2876                             mov             P6,a
1162 00             2877                             nop
1163 00             2878                             nop
                    2879                                     
1164 E586           2880                             mov             a,P6                    ;p6.4=1 
1166 4410           2881                             orl             a,#10h
1168 F586           2882                             mov             P6,a
                    2883                                     ;;;;;;;;;
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    46

116A E5DA           2884                             mov             a,PCA0CPM0;     
116C 4446           2885                             orl             a,#46h;anl              a,#0fbh
116E F5DA           2886                             mov             PCA0CPM0,a
                    2887     
1170 75CDD0         2888                             mov             TH2,#0d0h
1173 75CC00         2889                             mov             TL2,#00
                    2890     
1176 D2CA           2891                             setb            T2CON.2
1178 D2AD           2892                             setb            ET2;IE.5
                    2893                             ;;;;;;;;                                            
117A 32             2894                             reti
                    2895     
117B 020000   F     2896     rknMEM:                 jmp             knMEM
117E 020000   F     2897     knKMP:             jmp          out7
1181 020000   F     2898     rout7:                  jmp             out7    
1184 020000   F     2899     rlabelH:                jmp             labelH
1187 020000   F     2900     rknNUL:         jmp             knNUL
118A 020000   F     2901     rknleft:                jmp             knleft
118D                2902     keyb2:  ;IE7
118D 75E700         2903                                     mov             EIE2,#00H
1190 75AD00         2904                                     mov             P3IF,#00
                    2905     
1193 C0E0           2906                                     push    acc
1195 C0D0           2907                                     push    psw
1197 C000           2908                                     push    rr0
1199 C001           2909                                     push    rr1
119B C002           2910                                     push    rr2
119D C003           2911                                     push    rr3
119F C004           2912                                     push    rr4
11A1 C005           2913                                     push    rr5
11A3 C006           2914                                     push    rr6
11A5 C007           2915                                     push    rr7
11A7 C082           2916                                     push    dpl
11A9 C083           2917                                     push    dph
                    2918                                     ;clr            bitmig
                    2919                       ;;;;;;;;;;;;;;
11AB 120000   F     2920                               call  z_01s   ;0,1s
                    2921                               ;восстан знакоместо при мигании
                    2922                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
11AE 78B2           2923                                     mov             r0,#marker
11B0 7440           2924                                     mov             a,#bufind
11B2 26             2925                                     add             a,@r0                   ;a=bufind+marker
11B3 F9             2926                                     mov             r1,a
11B4 A73C           2927                                     mov             @r1,savba
                    2928                                     ;;;;;;;;;;;
                    2929     
11B6 E5B0           2930                             mov             a,p3
11B8 20E7C6         2931                                     jb              acc.7,rout7
11BB E5B0           2932                                     mov             a,p3
11BD 74FF           2933                                     mov             a,#0ffh         ; p3.(5-0)<-3f
11BF F5B0           2934                                     mov             p3,a
11C1 E5B0           2935                                     mov             a,p3
11C3 30E7BB         2936                                     jnb             acc.7,rout7             ;error
11C6 3004BB         2937                                     jnb             bitizm,rlabelH
11C9 75B0FE         2938                                     mov             p3,#0feh                ;реж IZM
11CC E5B0           2939                                     mov             a,p3
11CE 30E7B6         2940                                     jnb             acc.7,rknNUL
11D1 75B0FD         2941                                     mov             p3,#0fdh
11D4 E5B0           2942                                     mov             a,p3
11D6 30E7A5         2943                                     jnb             acc.7,knKMP
11D9 75B0FB         2944                                     mov             p3,#0fbh
11DC E5B0           2945                                     mov             a,p3
11DE 30E7A9         2946                                     jnb             acc.7,rknleft
11E1 75B0F7         2947                                     mov             p3,#0f7h
11E4 E5B0           2948                                     mov             a,p3
11E6 30E76F         2949                                     jnb             acc.7,knAVP
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    47

11E9 75B0EF         2950                                 mov         p3,#0efh
11EC E5B0           2951                                     mov             a,p3
11EE 30E78A         2952                                     jnb             acc.7,rknMEM
11F1 75B0DF         2953                                     mov             p3,#0dfh
11F4 E5B0           2954                                     mov             a,p3    
11F6 30E722         2955                                     jnb             acc.7,knmenu
11F9                2956     an_t7:             ;;;;;;;;;;;;
                    2957                     
                    2958     ;       clr             c
                    2959     ;       mov             r1,#parN
                    2960     ;
                    2961     ;                       mov             r0,#diap
                    2962     ;                       mov             a,#6            
                    2963     ;                       subb    a,@r0
                    2964     ;                       jnc             goto7           ;         ;10-2..10-8
                    2965                               
                    2966     ;                       mov             @r1,#2          ;10-9..10-11            
                    2967                             
                    2968                             ;;;;;;;;;;;;
11F9 799A           2969     goto7:                  mov             r1,#parT
11FB 783D           2970                                     mov             r0,#chkl
11FD B70108         2971                                     cjne    @r1,#1,not1_7
1200 7600           2972                                     mov             @r0,#00
1202 08             2973                                     inc             r0
1203 7602           2974                                     mov             @r0,#2
1205 020000   F     2975                                     jmp             out7
                    2976                             
                    2977     
1208 B70208         2978     not1_7:                 cjne    @r1,#2,not2_7
120B 760E           2979                                             mov             @r0,#0eh;00
120D 08             2980                                     inc             r0
120E 7638           2981                                     mov             @r0,#38h;20
1210 020000   F     2982                                     jmp             out7
1213 7600           2983     not2_7:                 mov             @r0,#00
1215 08             2984                                     inc             r0
1216 76C8           2985                                     mov             @r0,#200
1218 020000   F     2986     merr:           jmp             out7
                    2987     
                    2988     
121B 2006FA         2989     knmenu: jb              bitvi11,merr
121E 20151C         2990                                     jb              biteizm,menuoff
                    2991                                     ;;;;;
1221 201225         2992                                     jb              bitklb,klboff
1224 C204           2993                              clr            bitizm          ;off IZM
1226 D211           2994                                     setb            bitmenu
1228 C217           2995                                     clr             bitoll
122A 900000   F     2996                                     mov             dptr,#teTESI    ;в буф2 записать ТЕСТ-ИЗМЕР
122D 120000   F     2997                                     call    lotext
1230 534B03         2998                                     anl                     bufind+11,#03h ;погасить запятые
1233 120000   F     2999                                     call            ind
1236 78B1           3000                                     mov             r0,#vichR
1238 7611           3001                                     mov             @r0,#11h
123A 020000   F     3002                                     jmp             onmem11
123D                3003     menuoff:
123D 78B1           3004                                     mov             r0,#vichR
123F 7600           3005                                     mov             @r0,#00
1241 C215           3006                                     clr             biteizm
1243 120000   F     3007                                     call    loadus
1246 020000   F     3008                                     jmp             out7
                    3009     
1249 C212           3010     klboff:                 clr             bitklb
124B 120000   F     3011                                                     call            loadUS
124E 78B1           3012                                                     mov             r0,#vichR
1250 7600           3013                                                     mov             @r0,#00
1252 020000   F     3014                                                     jmp             out7
                    3015     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    48

1255 020000   F     3016     rendkalib:              jmp             endkalib
                    3017     
1258 2012FA         3018     knAVP:  jb              bitklb,rendkalib        
125B 200505         3019                                     jb              bitavp,meavp
125E D205           3020                                     setb    bitavp
1260 020000   F     3021                                     jmp             onmem11
1263 C205           3022     meavp:                  clr             bitavp
1265 020000   F     3023                                     jmp             onmem11
                    3024     
1268 201207         3025     knleft: jb              bitklb,lefkl
                    3026                                     ;;;;;;;;
126B 79AE           3027                                mov          r1,#diap
126D 07             3028                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
126E B70A03         3029                                     cjne    @r1,#0ah,nodi6
1271 17             3030                                     dec             @r1
1272 8085           3031     lefkl:  jmp             an_t7
                    3032     
1274                3033     nodi6:             ;    cjne    @r1,#0,an_t7
1274 120000   F     3034                                      call    clmassix
1277 78B3           3035                                     mov             r0,#summa
1279 120000   F     3036                                     call    clear4  
127C 786A           3037                                     mov             r0,#rez_A0
127E 120000   F     3038                                     call    clear4
1281 C20F           3039                                     clr             bitnul          ;гасить светодиод НУЛЬ  
1283 120000   F     3040                                     call    loadUS
1286 020000   F     3041                                jmp          an_t7
                    3042     
1289 200F0F         3043     knNUL:                  jb              bitnul,ybnul
128C D20F           3044                                     setb    bitnul
128E 789C           3045                                     mov             r0,#rez_A3      ;A3
1290 120000   F     3046                                     call    resar2
1293 786A           3047                                     mov             r0,#rez_A0      
1295 120000   F     3048                                     call    saver2;A0<-A3
1298 020000   F     3049                                     jmp             goto7;an_t7
                    3050     
129B C20F           3051     ybnul:                  clr             bitnul
129D 900000   F     3052                                      mov    DPTR,#ch0 
12A0 120000   F     3053                                     CALL   ldc_long          ; r2..r5 <-- 0
12A3 786A           3054                                     mov             r0,#rez_A0      ;A0=0
12A5 120000   F     3055                                     call    saver2
12A8 020000   F     3056                                     jmp             goto7;an_t7
                    3057     
12AB 301021         3058     labelH:                 jnb             bitt2,nolah
12AE 75B0FB         3059                                     mov             p3,#0fbh   ;вход в режим изм Т
12B1 534A8F         3060                                     anl             bufind+10,#8fh
12B4 79B7           3061                                     mov             r1,#load;parT
12B6 20B70D         3062                                     jb              p3.7,rhnot1
12B9 B70003         3063                                     cjne    @r1,#0,inct;
12BC 020000   F     3064                                     jmp             out7;hyest6
12BF 17             3065     inct:                   dec             @r1                     ;Tизм+1
                    3066                             
12C0 120000   F     3067                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
12C3                3068     hnot2:          ;       call    ind
12C3 020000   F     3069                                     jmp             out7
                    3070     
12C6 020000   F     3071      rhnot1:                jmp             hnot1
                    3072      ;rnoviR:       jmp             noviR
12C9 020000   F     3073      rlabelK:       jmp             labelK
12CC 020000   F     3074      rlabelI:       jmp             labelI          
                    3075      ;;;;;;;;;;;;;;;;;;;
12CF 3014F7         3076     nolah:          jnb             bitvich,rlabelK 
                    3077                                     
                    3078                             ;;;;;;
                    3079                             ;увеличить счетчик задержки клавиатуры
                    3080                     ;;              mov             r0,#chkl
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    49

                    3081                     ;;              mov             @r0,#27h
                    3082                     ;;              inc             r0
                    3083                     ;;              mov             @r0,#10h
                    3084                             ;;;;;;
                    3085     
12D2 78B1           3086                             mov             r0,#vichR
12D4 B61128         3087                             cjne    @r0,#11h,rhnor11;rlabelI;;
12D7 75B0FB         3088                             mov             p3,#0fbh   ;<-
12DA 20B730         3089                             jb              p3.7,noh37;routF
12DD B6110B         3090                     cjne    @r0,#11h,hr12
12E0 7613           3091                             mov             @r0,#13h        ;11= вычислить
12E2 900000   F     3092                             mov             dptr,#teOUT;teVICH
12E5 120000   F     3093     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
12E8 020000   F     3094                             jmp             goto7;outF
12EB B61207         3095     hr12:           cjne    @r0,#12h,hnor12
12EE 7611           3096     lovich:         mov             @r0,#11h
12F0 900000   F     3097                             mov             dptr,#teVICH
12F3 80F0           3098                             jmp             hvi1113         
12F5 B61307         3099     hnor12:         cjne    @r0,#13h,rhnor11
12F8 7612           3100     loizmk:         mov             @r0,#12h
12FA 900000   F     3101                             mov             dptr,#teIZMK    ;       изм конст
                    3102                                        
12FD 80E6           3103                             jmp             hvi1113
                    3104     
12FF 804C           3105     rhnor11:                jmp             hnor11
                    3106     
1301 8057           3107     rvvizko:                jmp             vvizko
1303 C214           3108     vioutF:                 clr             bitvich
1305 C206           3109                                                     clr             bitvi11
1307 020000   F     3110                                                     jmp             outF
130A 020000   F     3111     toutF:                  jmp     outF
                    3112     
130D 75B0F7         3113     noh37:          mov             p3,#0f7h
1310 20B7F7         3114                             jb              p3.7,toutF;vioutF
1313 B611EB         3115                             cjne    @r0,#11h,rvvizko
1316 D206           3116                             setb    bitvi11    ;нажат ввод ВЫЧИСЛИТЬ
1318 D204           3117              setb   bitizm
131A 534B07         3118                              anl            bufind+11,#07h
131D 434B10         3119                              orl            bufind+11,#10h;точка после 1 знакоместа
1320 020000   F     3120     routF:          jmp             out7;goto7;outF
                    3121     
                    3122     
                    3123     
1323 80E8           3124     rnoh37:         jmp             noh37
                    3125     
1325 B6120D         3126     norr11:         cjne    @r0,#12h,norr12
1328 75B0FB         3127                             mov             p3,#0fbh   ;<-
132B 20B7F5         3128                             jb              p3.7,rnoh37;routF
132E 760B           3129                             mov             @r0,#11;12->11
1330 80BC           3130                             jmp             lovich
                    3131     
1332 020000   F     3132     labelI2:                jmp             labelI
1335 B613FA         3133     norr12:         cjne    @r0,#13h,labelI2
1338 75B0FB         3134                             mov             p3,#0fbh   ;<-
133B 20B7E5         3135                             jb              p3.7,rnoh37
133E 7612           3136                             mov             @r0,#12h
1340 80B6           3137                             jmp             loizmk
                    3138                             ;;;;
1342 C214           3139     clrvich:                clr             bitvich
1344 D204           3140                             setb    bitizm
1346 A8B2           3141                             mov             r0,marker
1348 76FF           3142                             mov             @r0,#0ffh
134A 020000   F     3143                              jmp    goto7;  routF
                    3144     
                    3145     ;rnoh37:                jmp             noh37
                    3146      ;ввод изм конст
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    50

134D B612E5         3147     hnor11:         cjne    @r0,#12h,norr12;clrvich
1350 75B0FB         3148                              mov            p3,#0fbh   
1353 20B7CD         3149                             jb              p3.7,rnoh37;lovich;;изм конст <-  выч
1356 7611           3150                             mov             @r0,#11h
1358 8094           3151                             jmp             lovich
                    3152     
135A 78B1           3153     vvizko:         mov             r0,#vichR
135C E6             3154                             mov             a,@r0
                    3155                     ;       cjne    @r0,#12h,clrvich
135D B412E2         3156                             cjne    a,#12h,clrvich
1360 7621           3157                             mov             @r0,#21h                ;изм конст->U=+0000     (vv
                             od)
1362 78B2           3158                             mov             r0,#marker
1364 7604           3159                             mov             @r0,#4;9
1366 753A04         3160                             mov             movleft,#4
1369 753B07         3161                             mov             movrig,#7
136C 900000   F     3162                             mov             dptr,#teAequ0
136F 120000   F     3163                             call    lotext
                    3164                             
1372 120000   F     3165                             call    outA
1375 534B0F         3166                             anl                     bufind+11,#0fh
                    3167             ;       mov             a,bufind+11
                    3168             ;       anl             a,#0f0h
                    3169             ;       mov             bufind+11,a
1378 434B40         3170                             orl             bufind+11,#40h;бит точки после 7 знакоместа(a=000.0
                              v)
                    3171                             
137B 020000   F     3172                             jmp             goto7;routF
                    3173     ;hnor13:                jmp             hnor12          
137E B6210C         3174     izchi:          cjne    @r0,#21h,tlabelI
                    3175     ;<- при вводе цифр А                            
                    3176                     ;        mov            p3,#0fbh   
                    3177                     ;       jnb             p3.7,li21
                    3178             ;clr            bitmig
1381 78B2           3179                             mov             r0,#marker
1383 16             3180                             dec             @r0
1384 B60201         3181                             cjne    @r0,#2,li21
1387 06             3182                             inc             @r0;marker=3 +/-
1388 C219           3183     li21:           clr             bitmig
138A 020000   F     3184                             jmp             goto7;outF
                    3185     
138D 020000   F     3186     tlabelI:        jmp             labelI
                    3187     
                    3188     ;                       load    0 1 2 3 4 5             
1390 06050403       3189     sootv:          db              6,5,4,3,2,1;parT
1394 0201                    
                    3190     ;
                    3191     
                    3192     ;нажата кн ввод при наборе Т
1396 75B0F7         3193     hnot1:                  mov             p3,#0f7h
1399 20B784         3194                                     jb              p3.7,routF;out7
139C B70549         3195                                     cjne    @r1,#5,nohnot1  ;r1=load
139F 794A           3196                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
13A1 E7             3197                                     mov             a,@r1
13A2 548F           3198                                     anl             a,#8fh
13A4 4440           3199                                     orl             a,#40h;.6
13A6 F7             3200                                     mov             @r1,a
13A7 8000           3201                                     jmp             loadb
                    3202                                     
                    3203                                     
13A9 789A           3204     loadB:                  mov             r0,#parT
13AB 900000   F     3205                                     mov             dptr,#sootv
13AE 79B7           3206                                     mov             r1,#load                
13B0 E7             3207                                     mov             a,@r1;load
13B1 93             3208                                     movc    a,@a+dptr
13B2 F6             3209                                     mov             @r0,a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    51

13B3 120000   F     3210                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    3211                                      ;r4=b1 r5=b2
13B6 120000   F     3212                                     call    iniacp;инициализация АЦП
13B9 120000   F     3213                                     call    loadUS
13BC 120000   F     3214                                     call    clmassix        
13BF D204           3215                                     setb    bitizm
13C1 C210           3216                                     clr             bitt2
                    3217     
13C3 534A8F         3218                                     anl             bufind+10,#8fh
13C6 C3             3219                                      clr            c
13C7 789A           3220                                  mov                r0,#parT
13C9 79AF           3221                                      mov            r1,#parN
13CB 7402           3222                                  mov                a,#2
13CD 96             3223                                 subb                a,@r0
13CE 5005           3224                                 jnc                 loadB2
13D0 7701           3225                                     mov             @r1,#1;N=1         ;T>=2
13D2 020000   F     3226     bout7:                  jmp             goto7;out7
                    3227     
13D5 B702FA         3228     loadB2:                 cjne    @r1,#2,bout7
13D8 7702           3229                                     mov             @r1,#2;N=2
13DA 020000   F     3230                                     jmp             goto7;out7
13DD                3231     nohnot2:                ;в буфере 1 зажечь <=0,1s
13DD 794A           3232                                     mov             r1,#bufind+10
13DF E7             3233                                     mov             a,@r1
13E0 4410           3234                                     orl             a,#10h;.4
13E2 F7             3235                                     mov             @r1,a
13E3 120000   F     3236                                     call            ind
13E6 80C1           3237                                     jmp             loadB
13E8 B704F2         3238     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
13EB 794A           3239                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
13ED E7             3240                                     mov             a,@r1
13EE 4420           3241                                     orl             a,#20h;.5
13F0 F7             3242                                     mov             @r1,a
13F1 80B6           3243                                     jmp             loadB
                    3244     
                    3245     ;кнопка ПАМЯТЬ
13F3 C204           3246     knMEM:                  clr             bitizm          ;off IZM
13F5 900000   F     3247                                     mov             dptr,#teLIST;CLE
13F8 120000   F     3248                                     call    lotext    ;в буф2 записать ОЧИСТКА
13FB D20B           3249                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
13FD 534BEF         3250                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
1400 434B01         3251                                     orl             bufind+11,#01;зажечь светодиод память
1403 120000   F     3252                                     call            ind
1406 78B0           3253                                     mov             r0,#level
1408 7613           3254                                     mov             @r0,#13h;11h
140A 783D           3255     onmem11:                mov             r0,#chkl
140C 7603           3256                                     mov             @r0,#03
140E 08             3257                                     inc             r0
140F 76E8           3258                                     mov             @r0,#0e8h               ;1000
1411 020000   F     3259                                     jmp             out7;goto7;out7
                    3260     
1414 020000   F     3261     rnomemk:                jmp             nomemk          ;
                    3262     
1417 78B0           3263     outkmem:        mov                     r0,#level
1419 7600           3264                                             mov                     @r0,#0
141B 78B1           3265                                             mov                     r0,#vichR
141D 7600           3266                                             mov                     @r0,#0
141F C20B           3267                                             clr                     bitmem
1421 C214           3268                                             clr                     bitvich
1423 C206           3269                                             clr                     bitvi11
1425 C211           3270                                             clr                     bitmenu
1427 D204           3271                                             setb            bitizm
1429 78B2           3272                                             mov                     r0,#marker
142B 76FF           3273                                             mov                     @r0,#0ffh
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    52

142D 020000   F     3274                                             jmp                     vvod2_10
1430 020000   F     3275                                             jmp                     goto7   
1433                3276     labelK:
                    3277     
                    3278     ;;;;;;;;;;;;
1433 300BDE         3279                               jnb           bitmem,rnomemk          ;кн память (ввод и <-)
1436 75B0EF         3280                                     mov                     p3,#0efh
1439 30B7DB         3281                                     jnb                     p3.7,outkmem            ;отжатие кн
                              память на любом уровне обработки памяти
143C 78B0           3282                                      mov            r0,#level
143E B6114E         3283                               cjne          @r0,#11h,klev1;nome11
1441 75B0FB         3284     lefmem11:         mov           p3,#0fbh
1444 E5B0           3285                               mov           a,p3
1446 20E70E         3286                               jb            acc.7,rkvvod0
1449 B6110E         3287                               cjne          @r0,#11h,locle          ;<-memory
144C 7614           3288                               mov           @r0,#14h
144E 900000   F     3289     lolist:           mov           dptr,#teSTAT
1451 120000   F     3290                               call          lotext           ;СТАТИСТИКА
1454 020000   F     3291                               jmp   goto7;  outF
                    3292     
1457 020000   F     3293     rkvvod0:        jmp             kvvod0
                    3294     
                    3295     
145A B6120B         3296     locle:          cjne            @r0,#12h,lowr           ;<-memory
145D 7611           3297                               mov           @r0,#11h                   ;ОЧИСТКА
145F 900000   F     3298     loadcle:          mov           dptr,#teCLE
1462 120000   F     3299                               call          lotext
1465 020000   F     3300                               jmp           goto7;outF
                    3301     
1468 B6130B         3302     lowr:                   cjne    @r0,#13h,lostat
146B 7612           3303                                             mov             @r0,#12h
146D 900000   F     3304      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
1470 120000   F     3305                             call    lotext
1473 020000   F     3306                             jmp             goto7;outF
                    3307     
1476 7613           3308     lostat:         mov             @r0,#13h
1478 900000   F     3309                                     mov             dptr,#teLIST              ;ПРОСМОТР
147B 120000   F     3310                             call    lotext
147E 020000   F     3311                             jmp             goto7;outF
                    3312     
1481 B6141A         3313     me_14:cjne              @r0,#14h,klev22
1484 7613           3314                                             mov             @r0,#13h
1486 900000   F     3315                             mov             dptr,#teLIST              ;;ПРОСМОТР
1489 120000   F     3316                             call    lotext
148C 020000   F     3317                             jmp             goto7
148F B61202         3318      klev1:          cjne   @r0,#12h,klev2
1492 80AD           3319                             jmp             lefmem11
1494 B61302         3320     klev2:           cjne   @r0,#13h,klev3;11-14   klev22     ;11-13 нет
1497 80A8           3321                             jmp             lefmem11
1499 B61402         3322     klev3:           cjne   @r0,#14h,klev22;
149C 80A3           3323                             jmp             lefmem11
                    3324     ;<- vvod на более низких уровнях
149E B62117         3325     klev22:         cjne    @r0,#21h,klev21
14A1 75B0FB         3326     lev220:         mov             p3,#0fbh
14A4 20B77B         3327                             jb              p3.7,kgo23
14A7 B6210B         3328                             cjne    @r0,#21h,kfullr
14AA 7622           3329                             mov             @r0,#22h
14AC 900000   F     3330                             mov             dptr,#teBL
14AF 120000   F     3331                             call    lotext
14B2 020000   F     3332                             jmp             goto7;outF
14B5 020000   F     3333     kfullr:         jmp             kfull                           
14B8 B6220E         3334     klev21:         cjne    @r0,#22h,klev23
14BB 80E4           3335                             jmp             lev220
                    3336     
14BD 020000   F     3337     rlabL2:         jmp             labL2
14C0 020000   F     3338     rlabM:          jmp             labM
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    53

14C3 020000   F     3339     ques:                   jmp             out7
14C6 020000   F     3340     ddoutfr:        jmp             ddoutf
                    3341     
14C9 B623F4         3342     klev23:          cjne   @r0,#23h,rlabM
14CC 75B0FB         3343                              mov    p3,#0fbh
14CF 30B7F1         3344                              jnb            p3.7,ques;errr labL2
14D2 75B0F7         3345                              mov    p3,#0f7h
14D5 20B7EE         3346                              jb             p3.7,ddoutfr
                    3347                                             ;       считать с индикатора  
14D8 C3             3348                                     clr                     c
14D9 E547           3349                                mov          a,bufind+7      
14DB 9430           3350                                      subb           a,#30h
14DD B40002         3351                                      cjne           a,#0,chaibl
14E0 7401           3352                                      mov            a,#1                    ;номера блоков 1..4
14E2                3353     chaibl:         
14E2 F538           3354                                             mov             nblok,a
                    3355                                
                    3356                              ;очистить блок памяти с набранным номером
                    3357                              ;150h..1000h( 150h+nblok*320h)
14E4 120000   F     3358                                     call            adrblok         ;dptr-
                    3359     
14E7 79B8           3360                                     mov                     r1,#work                ;обьем блок
                             а
14E9 7703           3361                                     mov                     @r1,#03
14EB 09             3362                                     inc                     r1
14EC 7720           3363                                     mov                     @r1,#20h                        ;32
                             0h
                    3364     
14EE                3365     goonoff:
14EE E4             3366                                     clr                     a
14EF F0             3367                                     movx            @dptr,a
14F0 A3             3368                                     inc                     dptr
                    3369     
14F1 79B9           3370                                     mov                     r1,#work+1
14F3 120000   F     3371                                     call            chminus
14F6 78B8           3372                                     mov             r0,#work
14F8 E6             3373                             mov             a,@r0
14F9 30E7F2         3374                             jnb             acc.7,goonoff
                    3375     
14FC C20B           3376                              clr    bitmem  ;сбр признак памяти 
14FE D204           3377                              setb   bitizm
                    3378                             ;после очистки блока сохраняем в saven_bl 
                    3379                             ;адрес второго с конца измерения потому
                    3380                             ;добавляем 8;;
1500 120000   F     3381                             call            adrblok;dptr-начало блока
1503 E582           3382                             mov                     a,dpl
1505 2408           3383                             add                     a,#8
1507 F582           3384                             mov                     dpl,a
1509 E583           3385                             mov                     a,dph
150B 3400           3386                             addc            a,#0
150D F583           3387                             mov                     dph,a
150F 120000   F     3388                             call            save_hl;подготовка записи в начало блока
                    3389                             ;;;;;
                    3390     
1512 78B2           3391                              mov            r0,#marker
1514 76FF           3392                              mov            @r0,#0ffh
1516 020000   F     3393                                     jmp                     vvod2_10
1519 020000   F     3394                              jmp    goto7
                    3395     
151C 020000   F     3396     rddoutf:        jmp             ddoutf
151F 020000   F     3397     rgo23no:        jmp             go23no
                    3398     
                    3399     ;vvod   БЛОК->БЛОК 00           
1522 75B0F7         3400     kgo23:           mov    p3,#0f7h
1525 20B7F4         3401                             jb              p3.7,rddoutf
1528 B621F4         3402                             cjne    @r0,#21h,rgo23no
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    54

                    3403                             ;очистить память 150..dd0h
                    3404                             ;1й блок
152B 900150         3405                              mov                    dptr,#150h
152E 79B8           3406                                     mov                     r1,#work                ;обьем блок
                             а
1530 7703           3407                                     mov                     @r1,#03
1532 09             3408                                     inc                     r1
1533 7720           3409                                     mov                     @r1,#20h                        ;32
                             0h
                    3410     
1535                3411     gooff1:
1535 E4             3412                                     clr                     a
1536 F0             3413                                     movx            @dptr,a
1537 A3             3414                                     inc                     dptr
                    3415     
1538 79B9           3416                                     mov                     r1,#work+1
153A 120000   F     3417                                     call            chminus
153D 78B8           3418                                     mov             r0,#work
153F E6             3419                             mov             a,@r0
1540 30E7F2         3420                             jnb             acc.7,gooff1
1543 900158         3421                             mov                     dptr,#158h;начало 1 го блока
                    3422                             ;после очистки блока сохраняем в saven_bl 
                    3423                             ;адрес второго с конца измерения потому
                    3424                             ;добавляем 8;;
1546 120000   F     3425                             call            save_hl;подготовка записи в начало блока
                    3426     ;2й блок
1549 900470         3427                             mov                     dptr,#470h
154C 79B8           3428                                     mov                     r1,#work                ;обьем блок
                             а
154E 7703           3429                                     mov                     @r1,#03
1550 09             3430                                     inc                     r1
1551 7720           3431                                     mov                     @r1,#20h                        ;32
                             0h
                    3432     
1553                3433     gooff2:
1553 E4             3434                                     clr                     a
1554 F0             3435                                     movx            @dptr,a
1555 A3             3436                                     inc                     dptr
                    3437     
1556 79B9           3438                                     mov                     r1,#work+1
1558 120000   F     3439                                     call            chminus
155B 78B8           3440                                     mov             r0,#work
155D E6             3441                             mov             a,@r0
155E 30E7F2         3442                             jnb             acc.7,gooff2
1561 900478         3443                             mov                     dptr,#478h;начало 2 го блока
1564 120000   F     3444                             call            save_hl;подготовка записи в начало блока
                    3445     ;3й блок
1567 900790         3446                             mov                     dptr,#790h
156A 79B8           3447                                     mov                     r1,#work                ;обьем блок
                             а
156C 7703           3448                                     mov                     @r1,#03
156E 09             3449                                     inc                     r1
156F 7720           3450                                     mov                     @r1,#20h                        ;32
                             0h
                    3451     
1571                3452     gooff3:
1571 E4             3453                                     clr                     a
1572 F0             3454                                     movx            @dptr,a
1573 A3             3455                                     inc                     dptr
                    3456     
1574 79B9           3457                                     mov                     r1,#work+1
1576 120000   F     3458                                     call            chminus
1579 78B8           3459                                     mov             r0,#work
157B E6             3460                             mov             a,@r0
157C 30E7F2         3461                             jnb             acc.7,gooff3
157F 900798         3462                             mov                     dptr,#798h;начало 3 го блока
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    55

                    3463                                     ;после очистки блока сохраняем в saven_bl 
                    3464                             ;адрес второго с конца измерения потому
                    3465                             ;добавляем 8;;
1582 120000   F     3466                             call            save_hl;подготовка записи в начало блока
                    3467     ;4й блок
1585 900AB0         3468     mov                     dptr,#0ab0h
1588 79B8           3469                                     mov                     r1,#work                ;обьем блок
                             а
158A 7703           3470                                     mov                     @r1,#03h
158C 09             3471                                     inc                     r1
158D 7720           3472                                     mov                     @r1,#20h                        ;32
                             0h
                    3473     
158F                3474     gooff4:
158F E4             3475                                     clr                     a
1590 F0             3476                                     movx            @dptr,a
1591 A3             3477                                     inc                     dptr
                    3478     
1592 79B9           3479                                     mov                     r1,#work+1
1594 120000   F     3480                                     call            chminus
1597 78B8           3481                                     mov             r0,#work
1599 E6             3482                             mov             a,@r0
159A 30E7F2         3483                             jnb             acc.7,gooff4
159D 900AB8         3484                             mov                     dptr,#0ab8h;начало 4 го блока
                    3485                             ;после очистки блока сохраняем в saven_bl 
                    3486                             ;адрес второго с конца измерения потому
                    3487                             ;добавляем 8;;
15A0 120000   F     3488                             call            save_hl;подготовка записи в начало блока
15A3 C20B           3489                             clr             bitmem
15A5 D204           3490                             setb    bitizm
15A7 78B2           3491                                     mov             r0,#marker
15A9 76FF           3492                              mov            @r0,#0ffh
15AB 020000   F     3493                             jmp                     vvod2_10;jmp            goto7
                    3494     
15AE 7623           3495     go23no:    mov          @r0,#23h
15B0 753B08         3496                                             mov                     movrig,#8
15B3 753A07         3497                                             mov             movleft,#7
15B6 8055           3498                             jmp             loblok;БЛОК 00
                    3499     
15B8 7621           3500     kfull:          mov             @r0,#21h
15BA 8025           3501                             jmp             gofull
                    3502                             
                    3503                                             
15BC                3504     nomemk:                         
15BC 020000   F     3505                                     jmp             labelS                  ;нажат ввод меню
                    3506                             
15BF 75B0FB         3507     nome11:           mov           p3,#0fbh
15C2 E5B0           3508                               mov           a,p3
15C4 20E70D         3509                               jb            acc.7,kvvod0
15C7 B61205         3510                               cjne          @r0,#12h,mem12no        
15CA 7611           3511                               mov           @r0,#11h                ;ОЧИСТКА
15CC 020000   F     3512                               jmp            loadcle
                    3513     
15CF                3514     mem12no:        ;cjne           @r0,#13h,lowr           
15CF 7612           3515                               mov           @r0,#12h                   ;
15D1 020000   F     3516                               jmp           lowr1                     ;ЗАПИСЬ
                    3517     
15D4 75B0F7         3518     kvvod0:           mov           p3,#0f7h                        ;knopka vvod
15D7 20B70F         3519                               jb            p3.7,ddoutf
15DA 78B0           3520                               mov           r0,#level
15DC B61129         3521                               cjne          @r0,#11h,mvv11
15DF 7621           3522                               mov           @r0,#21h                ;ПОЛНАЯ
15E1 900000   F     3523     gofull:           mov           dptr,#teFULL
15E4 120000   F     3524                               call          lotext
15E7 804F           3525                                     jmp             mlabL2  ;<-????????/
                    3526     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    56

15E9                3527     ddoutf:         ;<- БЛОК 00(ОЧИСТКА)
                    3528     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3529     ;т е сохранить ее в ячейке для мигания в противном случае
                    3530     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3531     ;       знакоместа
15E9 78B2           3532                                                     mov             r0,#marker
15EB 7440           3533                                     mov             a,#bufind
15ED 26             3534                                             add             a,@r0                   ;a=bufind+m
                             arker
15EE F9             3535                                             mov             r1,a
15EF 19             3536                                             dec             r1      ;       inc             r1
15F0 873C           3537                                             mov             savba,@r1
15F2 C219           3538                                             clr             bitmig
                    3539     ;;;;;;;;;;;;;;;;
15F4 78B2           3540                       mov           r0,#marker      ;курсор слева   ?
15F6 E53A           3541                             mov             a,movleft
15F8 C3             3542                             clr             c
15F9 96             3543                             subb    a,@r0
15FA 7006           3544                             jnz        left21
15FC E53B           3545                             mov             a,movrig;уст в правую позицию
15FE F6             3546                             mov             @r0,a
                    3547     
15FF 020000   F     3548                             jmp             goto7                                            
1602 E53A           3549     left21:         mov             a,movleft;уст в левую позицию
1604 F6             3550                             mov             @r0,a   
1605 020000   F     3551                             jmp             goto7
                    3552     
                    3553     
1608 B61215         3554     mvv11:            cjne          @r0,#12h,mvv12
160B 7631           3555                                     mov             @r0,#31h
160D 900000   F     3556     loblok:                 mov             dptr,#teBL0;БЛОК 0
1610 120000   F     3557                                     call    lotext
1613 E538           3558                                     mov                     a,nblok
1615 2430           3559                                     add                     a,#30h
1617 F547           3560                                     mov                     bufind+7,a
1619 78B2           3561                                     mov             r0,#marker
161B 7607           3562                                     mov             @r0,#7
                    3563                                     ;mov            movrig,#9
                    3564                                     ;mov            movleft,#6
161D 020000   F     3565                                     jmp             goto7;outF
1620 B61411         3566     mvv12:  cjne            @r0,#14h,bl_li
1623 7661           3567                                     mov                     @r0,#61h
1625 900000   F     3568                                     mov             dptr,#teMIN;
1628 120000   F     3569                                     call    lotext
162B 120000   F     3570                                     call    vichmin
162E 120000   F     3571                                     call    z_1s
1631 020000   F     3572                                     jmp             out7;goto7;outF
                    3573     
1634 7641           3574     bl_li:          mov             @r0,#41h                ; БЛОК 00(ЗАПИСЬ И ПРОСМОТР)
1636 80D5           3575                                     jmp             loblok
                    3576     
                    3577     
                    3578     
1638                3579     mlabL2:         ;jmp            labL2
                    3580                                             ;  уст курсор в правую позицию 
                    3581                                     ;                               29.12.06
                    3582     ;;;;;;;;;;;;;;;;;;
                    3583     ;необходимо не портить цифру в следуюем справа знакоместе
                    3584     ;т е сохранить ее в ячейке для мигания в противном случае
                    3585     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3586     ;       знакоместа
1638 78B2           3587                                             mov             r0,#marker
163A 7440           3588                                     mov             a,#bufind
163C 26             3589                                             add             a,@r0                   ;a=bufind+m
                             arker
163D F9             3590                                             mov             r1,a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    57

163E 09             3591                                             inc             r1
163F 873C           3592                                             mov             savba,@r1
                    3593     ;;;;;;;;;;;;;;;;
1641 78B2           3594                       mov           r0,#marker      ;курсор справа  ?
1643 E53B           3595                             mov             a,movrig
1645 C3             3596                             clr             c
1646 96             3597                             subb    a,@r0
1647 6006           3598                             jz         equ2l
1649 E53B           3599                             mov             a,movrig;уст в правую позицию
164B F6             3600                             mov             @r0,a
                    3601     ;                       lool
164C 020000   F     3602                             jmp             goto7                                            
164F E53A           3603     equ2l:          mov             a,movleft;уст в левую позицию
1651 F6             3604                             mov             @r0,a   
1652 020000   F     3605                             jmp             goto7
                    3606                     
1655 020000   F     3607     rnom31:         jmp                     nom31
1658 B631FA         3608     labM:                   cjne    @r0,#31h,rnom31
165B 75B0FB         3609                                     mov             p3,#0fbh
165E 30B7D7         3610                                     jnb             p3.7,mlabL2
1661 75B0F7         3611                                mov          p3,#0f7h
1664 20B782         3612                                jb           p3.7,ddoutf
                    3613                                
1667 7632           3614                                mov          @r0,#32h                        ;ИНТ 0000
                    3615                                     ;       считать с индикатора  
1669 C3             3616     blokvv:         clr                     c
166A E547           3617                                mov          a,bufind+7      
166C 9430           3618                                      subb           a,#30h
166E B40002         3619                                      cjne           a,#0,blokvvc
1671 7401           3620                                      mov            a,#1                    ;номера блоков 1..4
                    3621     
1673 F538           3622     blokvvc: mov            nblok,a
1675 900000   F     3623                                mov          dptr,#teINT;ИНТ 0000c
1678 120000   F     3624                                call         lotext
167B 78CE           3625                                      mov            r0,#interva+1
167D 7952           3626                                      mov            r1,#abin+3
167F E6             3627                                      mov            a,@r0
1680 F7             3628                                      mov            @r1,a
1681 18             3629                                             dec                     r0
1682 19             3630                                             dec                     r1
1683 E6             3631                                             mov             a,@r0
1684 F7             3632                                             mov             @r1,a
1685 19             3633                                             dec             r1
1686 E4             3634                                             clr             a
1687 F7             3635                                             mov             @r1,a
1688 19             3636                                             dec             r1
1689 F7             3637                                             mov             @r1,a
                    3638                                                                             
168A 7853           3639                                             mov             r0,#adec
168C 7952           3640                                             mov             r1,#abin+3      ;hex->10
168E 120000   F     3641                                             call    bindec
                    3642                                     
1691 785C           3643                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1693 7948           3644                                             mov             r1,#bufind+8
1695 7F04           3645                                             mov             r7,#4
1697 E6             3646     bloin:                          mov             a,@r0
1698 2430           3647                                             add             a,#30h
169A F7             3648                                             mov             @r1,a
169B 19             3649                                             dec             r1
169C 18             3650                                             dec             r0
169D DFF8           3651                                             djnz    r7,bloin
169F 78B2           3652                                mov          r0,#marker
16A1 7605           3653                                mov          @r0,#5
16A3 753B08         3654                                mov          movrig,#8
16A6 753A05         3655                                mov          movleft,#5
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    58

16A9 789A           3656                                      mov            r0,#parT
16AB B60609         3657                                     cjne            @r0,#6,innot6
16AE 534BF0         3658                                     anl                     bufind+11,#0f0h;after 5- 0.000c
16B1 434B04         3659                                     orl                     bufind+11,#04h
                    3660                             
16B4 020000   F     3661                                     jmp                     goto7
16B7 B60309         3662     innot6: cjne            @r0,#3,innot3
16BA 534BF0         3663                                     anl                     bufind+11,#0f0h;after 7- 000.0c
16BD 434B20         3664                                     orl                     bufind+11,#20h
                    3665                                     ;call           ind
16C0 020000   F     3666                                     jmp                     out7;goto7
16C3 C3             3667     innot3: clr                     c
16C4 7403           3668                                     mov                     a,#3
16C6 96             3669                                     subb            a,@r0
16C7 5009           3670                                     jnc                     innot1_2
16C9 534BF0         3671                                     anl                     bufind+11,#0f0h;after 6- 00.00c
16CC 434B40         3672                                     orl                     bufind+11,#40h
                    3673                                     
16CF 020000   F     3674                                     jmp                     goto7
                    3675     
16D2                3676     innot1_2:
16D2 534B0F         3677                                     anl                     bufind+11,#0fh;0h;0000c
16D5 C219           3678                                     clr                     bitmig
                    3679                                     ;call           ind             нет необходимости пришет пр
                             обел         
16D7 020000   F     3680     rgoto7: jmp        goto7;outF
                    3681     
16DA B63276         3682     nom31:             cjne         @r0,#32h,nom32
16DD 75B0FB         3683                                     mov             p3,#0fbh
16E0 20B71F         3684                                     jb              p3.7,vvinte             ;ввод интервал;no31
                             n
                    3685                                     
16E3                3686     lefcur:         ;;кн <- 32 нач блок 000
                    3687     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3688     ;т е сохранить ее в ячейке для мигания в противном случае
                    3689     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3690     ;       знакоместа
16E3 C219           3691                                                     clr             bitmig
16E5 78B2           3692                                                     mov             r0,#marker;нажата кн <- при
                              вводе цифр нач блок 000
16E7 7440           3693                                     mov             a,#bufind
16E9 26             3694                                             add             a,@r0                   ;a=bufind+m
                             arker
16EA F9             3695                                             mov             r1,a
16EB 19             3696                                             dec             r1;;;;;;;;;;;
16EC 873C           3697                                             mov             savba,@r1
                    3698                                             
16EE 78B2           3699                                                     mov             r0,#marker      ;курсор сле
                             ва?
16F0 E53A           3700                             mov             a,movleft
16F2 C3             3701                             clr             c
16F3 96             3702                             subb    a,@r0
16F4 7006           3703                             jnz        noequ2
16F6 E53B           3704                             mov             a,movrig
16F8 F6             3705                             mov             @r0,a;уст в крайнюю правую позицию
16F9 020000   F     3706                             jmp             goto7
16FC 120000   F     3707     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
16FF 020000   F     3708                             jmp        goto7        
                    3709                                                                       
                    3710     
                    3711     ;;;;;;;;;;;;;;;;;;
1702                3712     vvinte:         ;ввод интервал                          
1702 75B0F7         3713     no31n:             mov          p3,#0f7h
1705 20B7CF         3714                                     jb              p3.7,rgoto7
1708 7633           3715                                     mov             @r0,#33h
                    3716                                     ;считать с индикатора введенный интервал
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    59

170A 7F0A           3717                                             mov             r7,#10
170C 7853           3718                                     mov             r0,#adec
170E 120000   F     3719                                     call    clearN
1711 120000   F     3720                                     call    upak4                   
1714 784F           3721                                     mov             r0,#abin
1716 7953           3722                                     mov             r1,#adec                        ;мл        
                              ст
1718 120000   F     3723                                     call    decbin                  ;abin..abin+3 (hex)
171B 794F           3724                                     mov             r1,#abin
171D 78CE           3725                                     mov             r0,#interva+1
171F E7             3726                                     mov             a,@r1
1720 F6             3727                                     mov             @r0,a
1721 18             3728                                     dec             r0
1722 09             3729                                     inc             r1
1723 E7             3730                                     mov             a,@r1
1724 F6             3731                                     mov             @r0,a
                    3732                                     
1725 78D5           3733                                     mov             r0,#volume                      ;объем блок
                             а
1727 7600           3734                                     mov             @r0,#0
1729 08             3735                                     inc             r0
172A 76C7           3736                                     mov             @r0,#0c7h
172C 120000   F     3737                                     call            adrblok;dptr
172F 120000   F     3738                                     call            save_hl;1я ячейка блока
1732 78B2           3739                                mov          r0,#marker
1734 76FF           3740                                mov          @r0,#0ffh
1736 D204           3741                                      setb           bitizm
1738 C20B           3742                                      clr            bitmem
173A 789A           3743     vvod2_10: mov           r0,#parT
173C B6050C         3744                                      cjne           @r0,#5,no10msv
173F 900000   F     3745                                             mov                     dptr,#te10ms
1742 120000   F     3746     t2msme:         call            lotext
                    3747                                             
1745 120000   F     3748                                             call            ind
1748 020000   F     3749     no2msv:   jmp      goto7;
174B B606FA         3750     no10msv:        cjne            @r0,#6,no2msv   
174E 900000   F     3751                                             mov                     dptr,#te2ms
1751 80EF           3752                                     jmp                     t2msme
                    3753     
                    3754     
                    3755     
1753 B6332B         3756     nom32:           cjne           @r0,#33h,nom33
1756 75B0FB         3757                              mov            p3,#0fbh
1759 30B787         3758                              jnb            p3.7,lefcur
175C 75B0F7         3759                              mov            p3,#0f7h
175F 20B7E6         3760                              jb             p3.7,no2msv;rgoto7
                    3761                              ;запомнить номер ячейки конца блока
1762 7634           3762                              mov    @r0,#34h
1764 7F0A           3763     INTn:                   mov             r7,#10
1766 7853           3764                                     mov             r0,#adec
1768 120000   F     3765                                     call    clearN
176B 120000   F     3766                                     call    upak3                   
176E 784F           3767                                     mov             r0,#abin
1770 7953           3768                                     mov             r1,#adec                        ;мл        
                              ст
1772 120000   F     3769                                     call    decbin                  ;abin..abin+3 (hex)
1775 120000   F     3770                                     call    loadr2                  ;r2..r5
1778 120402         3771                                     call    altof                   ;r2..r5->int
177B 020000   F     3772     dgoto7:                  jmp            goto7
                    3773     
177E 020000   F     3774     rlefcur:                jmp             lefcur
                    3775     
1781 B63464         3776     nom33:          cjne            @r0,#34h,labelP
1784 75B0FB         3777                               mov           p3,#0fbh
1787 30B7F4         3778                              jnb            p3.7,rlefcur
178A 75B0F7         3779                              mov            p3,#0f7h
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    60

178D 20B7EB         3780                              jb             p3.7,dgoto7
1790 7635           3781                              mov            @r0,#35h
1792 78B2           3782                              mov            r0,#marker
1794 76FF           3783                              mov            @r0,#0ffh
                    3784                              ;T1<-число на индикаторе
                    3785                                               ;vvod КОН БЛ 000
1796 78CF           3786                              mov            r0,#chbuf               ;счетчик периода загрузки в
                              буфер и интерфейс
1798 7630           3787                              mov            @r0,#30h  
179A C20B           3788                              clr            bitmem
179C D204           3789                              setb           bitizm;;;;      
179E 020000   F     3790                             jmp        goto7
17A1 020000   F     3791     vodm11_15:                      jmp             vvodm11_15
17A4 020000   F     3792     me11_15de:                      jmp             me11_15dec
17A7 020000   F     3793     moutkmem:                               jmp             outkmem
                    3794     
17AA 020000   F     3795     nmem_menu:              jmp             out7                    ;нажата память в режиме мен
                             ю
                    3796     ;обработка кнопки меню ввод
17AD 301138         3797     labelS:         jnb                     bitmenu,labelP
17B0 75B0EF         3798                                             mov                     p3,#0efh
17B3 30B7F4         3799                                             jnb                     p3.7,nmem_menu
17B6 75B0DF         3800                                             mov                     p3,#0dfh
17B9 30B7EB         3801                                             jnb                     p3.7,moutkmem
17BC 78B1           3802                                             mov                     r0,#vichR
17BE 7415           3803                                             mov                     a,#15h
17C0 C3             3804                                             clr                     c
17C1 96             3805                                             subb            a,@r0
17C2 4021           3806                                             jc                      rme21_23
                    3807                             
17C4 75B0FB         3808                                             mov                     p3,#0fbh
17C7 20B7D7         3809                                             jb                      p3.7,vodm11_15
17CA 78B1           3810                                             mov                     r0,#vichR
17CC B611D5         3811                                             cjne                    @r0,#11h,me11_15de;<-
17CF 7615           3812                                             mov                     @r0,#15h
17D1 900000   F     3813                                             mov                     dptr,#teKALIB
17D4 120000   F     3814                                             call            lotext
17D7 020000   F     3815                                             jmp                     onmem11
17DA C211           3816     menuon:         clr             bitmenu                 ;off menu
17DC D204           3817                                             setb    bitizm
                    3818     
17DE 78B1           3819                                     mov             r0,#vichR
17E0 7600           3820                                     mov             @r0,#0
17E2 020000   F     3821                                     jmp             onmem11
                    3822     
                    3823                                             ;;;;;
                    3824             
17E5 020000   F     3825     rme21_23:               jmp             me21_23 
                    3826                             
                    3827     ;режим просмотра
17E8 B64130         3828     labelP:                 cjne            @r0,#41h,govvlist
17EB 7642           3829                                                     mov                     @r0,#42h
                    3830                                                     ;       считать с индикатора  
17ED C3             3831                                             clr                     c
17EE E547           3832                                mov          a,bufind+7      
17F0 9430           3833                                      subb           a,#30h
17F2 B40002         3834                                      cjne           a,#0,chaipr
17F5 7401           3835                                      mov            a,#1
17F7 F538           3836     chaipr:                          mov            nblok,a
17F9 900000   F     3837                                mov          dptr,#teCH;ОТСЧЕТ 000
17FC 120000   F     3838                                call         lotext
17FF 534BEF         3839                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
1802 78B2           3840                                mov          r0,#marker
1804 7607           3841                                mov          @r0,#7
1806 753B09         3842                                mov          movrig,#9
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    61

1809 753A07         3843                                mov          movleft,#7
180C 120000   F     3844                                             call            z_1s
180F 020000   F     3845                        jmp     goto7;outF
1812 020000   F     3846     label43:                jmp             label7
                    3847     
1815 020000   F     3848     rlist_43:                       jmp                     list_43                            
                                  
1818 020000   F     3849     mlabL2r:                        jmp                     mlabL2
181B B642F7         3850     govvlist:                       cjne            @r0,#42h,rlist_43
181E 75B0FB         3851                                                                     mov                     p3,
                             #0fbh
1821 30B7F4         3852                                                             jnb                     p3.7,mlabL2
                             r;кн <- ОТСЧЕТ 000
1824 75B0F7         3853                                                             mov                     p3,#0f7h
1827 20B7E8         3854                                                             jb                      p3.7,label4
                             3
182A 7643           3855                                                             mov                     @r0,#43h;vv
                             od 
182C 78B2           3856                                                             mov                     r0,#marker
182E 76FF           3857                                                             mov                     @r0,#0ffh
1830 7F0A           3858                                                                     mov             r7,#10
1832 7853           3859                                     mov             r0,#adec
1834 120000   F     3860                                     call    clearN
1837 120000   F     3861                                     call    upak3                   
183A 784F           3862                                     mov             r0,#abin
183C 7953           3863                                     mov             r1,#adec                        ;мл        
                              ст
183E 120000   F     3864                                     call    decbin                  ;abin..abin+3 (hex)
1841 120000   F     3865                                     call    loadr2                  ;r2..r5
1844 ED             3866                                     mov             a,r5                            ;сохр номер
                              лемента
1845 F537           3867                                     mov             nelem,a
1847 120402         3868                                     call    altof                   ;r2..r5->int
184A 900000   F     3869                                     mov             dptr,#ch_1;
184D 120000   F     3870                                     call    ldc_ltemp                       ;r8..r11
1850 1201D1         3871                                     call    flsub
1853 900000   F     3872                                     mov             dptr,#ch_4;
1856 120000   F     3873                                     call    ldc_ltemp                       ;r8..r11
1859 120203         3874                                     call    flmul                           ;(n(номер отсчета)-
                             1)*4+адр нач блока
185C 120343         3875                                     call            ftol                    ;r2..r5->hex
185F C002           3876                                     push            rr2
1861 C003           3877                                     push            rr3
1863 C004           3878                                     push            rr4
1865 C005           3879                                     push            rr5
1867 120000   F     3880                                     call            adrblok;dptr-
186A D005           3881                                     pop                     rr5
186C D004           3882                                     pop                     rr4
186E D003           3883                                     pop                     rr3
1870 D002           3884                                     pop                     rr2
1872 79D8           3885                                     mov                     r1,#copy_hl+1;saven_bl+1;сохр адрес
                              внешн озу введенного лемента
1874 E582           3886                                     mov                     a,dpl
1876 2D             3887                                     add                     a,r5
1877 F582           3888                                     mov                     dpl,a
1879 F7             3889                                     mov                     @r1,a           ;low
187A E583           3890                                     mov                     a,dph
187C 3C             3891                                     addc            a,r4
187D F583           3892                                     mov                     dph,a
187F 19             3893                                     dec                     r1
1880 F7             3894                                     mov                     @r1,a                   ;high
                    3895                             
1881                3896     li42_43:
1881 120000   F     3897                                     call            reA3_X          ;r2..r5/выдать рез из внешн
                              пам на индикатор
1884 900000   F     3898                                     mov             dptr,#ch10;
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    62

1887 120000   F     3899                                     call    ldc_ltemp
188A 120000   F     3900                                     call    zdiv    
                    3901                                     ;;;;;;;;;;;
188D 120000   F     3902                                     call    maform
                    3903                                     ;;;;
                    3904     
                    3905                                     ;;;;;;;
1890 784F           3906                                             mov             r0,#abin
1892 120000   F     3907                                             call    saver2
1895 7853           3908                                             mov             r0,#adec
1897 7952           3909                                             mov             r1,#abin+3      ;hex->10
1899 120000   F     3910                                             call    bindec
                    3911                                     
189C 785C           3912                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
189E 7945           3913                                             mov             r1,#bufind+5
18A0 7F07           3914                                             mov             r7,#7
18A2 E6             3915     ch43:                           mov             a,@r0
18A3 2430           3916                                             add             a,#30h
18A5 F7             3917                                             mov             @r1,a
18A6 19             3918                                             dec             r1
18A7 18             3919                                             dec             r0
18A8 DFF8           3920                                             djnz    r7,ch43
18AA 7847           3921                                             mov             r0,#bufind+7
18AC 762D           3922                                             mov             @r0,#2dh          ;-2..-9
18AE 7840           3923                                             mov             r0,#bufind
18B0 762B           3924                                             mov             @r0,#2bh
18B2 300202         3925                                             jnb             znmat,nozzmi43;bitznak,nozzmi
18B5 762D           3926                                             mov             @r0,#2dh
18B7 E538           3927     nozzmi43:       mov             a,nblok
18B9 B40104         3928                                             cjne    a,#1,nozzmi1            
18BC 7934           3929                                             mov             r1,#sadiap;diap
18BE 8010           3930                                             jmp             nozzbl
18C0 B40204         3931     nozzmi1:        cjne    a,#2,nozzmi2            
18C3 7932           3932                                             mov             r1,#sadiap2;diap
18C5 8009           3933                                             jmp             nozzbl
18C7 B40304         3934     nozzmi2:        cjne    a,#3,nozzmi3            
18CA 7931           3935                                             mov             r1,#sadiap3;diap
18CC 8002           3936                                             jmp             nozzbl
18CE 7930           3937     nozzmi3:        mov             r1,#sadiap4;diap
                    3938                                     
18D0 7848           3939     nozzbl:         mov             r0,#bufind+8
18D2 E7             3940                                             mov             a,@r1
18D3 B40808         3941                                             cjne    a,#8,nodi8_43
18D6 7630           3942                                             mov             @r0,#30h                 ;10-10
18D8 18             3943                                             dec             r0
18D9 7663           3944                                             mov             @r0,#63h;31h
18DB 08             3945                                             inc             r0
18DC 800E           3946                                             jmp             see_l43
18DE B40908         3947     nodi8_43:       cjne    a,#9,nodi9_43
                    3948                                     
18E1 7631           3949                                             mov             @r0,#31h           ;10-11
18E3 18             3950                                             dec             r0
18E4 7663           3951                                             mov             @r0,#63h;31h
                    3952                                     
18E6 08             3953                                             inc             r0
18E7 8003           3954                                             jmp             see_l43
18E9 2432           3955     nodi9_43:               add             a,#32h
18EB F6             3956                                             mov             @r0,a;
18EC 08             3957     see_l43:                        inc             r0
18ED 7641           3958                                             mov             @r0,#"A";"E";
                    3959                             ;       inc             r0
                    3960                             ;       mov             @r0,#00h ;=feh в нач установе для поджига в
                             сех сегм
                    3961                             ;       inc             r0;             mov             bufind+11
                    3962                             ;       mov             @r0,#0d0h               ;bufind+11.4 точка 
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    63

                             после первой цифры
18EF 434B10         3963                             orl                     bufind+11,#10h
18F2 120000   F     3964     out43:          call            ind
18F5 120000   F     3965                                             call            z_1s
18F8 020000   F     3966                                             jmp             out7                               
                                  
                    3967     
                    3968                                     ;;;;;;;;        
18FB 783D           3969     label7: mov             r0,#chkl
18FD 7604           3970                                     mov             @r0,#04;3
18FF 08             3971                                     inc             r0
1900 76E8           3972                                     mov             @r0,#0e8h               ;1000
1902 020000   F     3973                                     jmp             out7;
1905 B64351         3974     list_43:                cjne    @r0,#43h,noli_43
1908 75B0FB         3975                                                     mov             p3,#0fbh                ;43
                             h <-
190B 20B70A         3976                                                     jb              p3.7,vvod43             ;vv
                             od
190E C20B           3977                                                     clr             bitmem
1910 D204           3978                                                     setb    bitizm
1912 78B2           3979                                                     mov             r0,#marker
1914 76FF           3980                                                     mov             @r0,#0ffh
1916 80E3           3981                                                     jmp             label7;по кн <- выход из пр
                             осмотра
                    3982     
1918 7644           3983     vvod43:                 mov             @r0,#44h
191A E537           3984                                                     mov             a,nelem;вывод порядкового н
                             омера в блоке 
191C 04             3985                                                     inc             a
191D F552           3986                                                     mov             abin+3,a
                    3987                                                     
191F F537           3988                                                     mov             nelem,a
1921 E4             3989                                                     clr             a
1922 F551           3990                                                     mov             abin+2,a
1924 F550           3991                                                     mov             abin+1,a
1926 F54F           3992                                                     mov             abin,a
                    3993                                             
1928 7853           3994                                             mov             r0,#adec
192A 7952           3995                                             mov             r1,#abin+3      ;hex->10
192C 120000   F     3996                                             call    bindec
192F 7840           3997                                             mov             r0,#bufind;почистить индикатор
1931 7F0A           3998                                             mov             r7,#10
1933 7420           3999                                             mov             a,#20h
1935 F6             4000     cle20:          mov             @r0,a
1936 08             4001                                             inc             r0
1937 DFFC           4002                                             djnz    r7,cle20
                    4003                                             ;;;;;;
1939 900000   F     4004                                             mov             dptr,#teCH;ОТСЧЕТ 000
193C 120000   F     4005                                call         lotext
193F 534BEF         4006                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
1942 785C           4007                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1944 7949           4008                                             mov             r1,#bufind+9
1946 7F03           4009                                             mov             r7,#3
1948 E6             4010     ch43_42:                                mov             a,@r0
1949 2430           4011                                             add             a,#30h
194B F7             4012                                             mov             @r1,a
194C 19             4013                                             dec             r1
194D 18             4014                                             dec             r0
194E DFF8           4015                                             djnz    r7,ch43_42
1950 120000   F     4016                                             call            ind
1953 120000   F     4017                                             call            z_1s
1956 020000   F     4018                                             jmp             out7
1959 B64419         4019     noli_43:        cjne            @r0,#44h,vvosta
195C 7643           4020                                             mov                     @r0,#43h
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    64

195E 79D8           4021                                                     mov                     r1,#copy_hl+1;saven
                             _bl+1
1960 E7             4022                                                     mov                     a,@r1
1961 F582           4023                                                     mov                     dpl,a
1963 19             4024                                                     dec                     r1
1964 E7             4025                                                     mov                     a,@r1;high
1965 F583           4026                                                     mov                     dph,a
1967 A3             4027                                                     inc                     dptr
1968 A3             4028                                                     inc                     dptr
1969 A3             4029                                                     inc                     dptr
196A A3             4030                                                     inc                     dptr
196B E583           4031                                                     mov                     a,dph
196D F7             4032                                                     mov                     @r1,a
196E 09             4033                                                     inc                     r1
196F E582           4034                                                     mov                     a,dpl
1971 F7             4035                                                     mov                     @r1,a              
                                          ;сохр адр внешн озу
1972 020000   F     4036                                             jmp                     li42_43;вывод значения след
                             ующего в блоке
                    4037     
1975 B66111         4038     vvosta:                 cjne            @r0,#61h,vvostad
1978 7662           4039                                                     mov                     @r0,#62h
197A 900000   F     4040                                                     mov                     dptr,#teMAX;
197D 120000   F     4041                                                     call            lotext
1980 120000   F     4042                                                     call            vichmax
1983 120000   F     4043                                                     call            z_05s;z_1s
1986 020000   F     4044                                                     jmp             goto7
                    4045     
1989 B66211         4046     vvostad:                cjne            @r0,#62h,rousta
198C 7663           4047                                                     mov                     @r0,#63h
198E 900000   F     4048                                                     mov             dptr,#teMid;
1991 120000   F     4049                                                     call    lotext
1994 120000   F     4050                                                     call            vichmean
1997 120000   F     4051                                                     call            z_05s
199A 020000   F     4052                                                     jmp             goto7
                    4053     
199D B6630E         4054     rousta:                 cjne            @r0,#63h,rousta1
19A0 7661           4055                                                     mov                     @r0,#61h
19A2 900000   F     4056                                                     mov             dptr,#teMin;
19A5 120000   F     4057                                                     call    lotext
19A8 120000   F     4058                                                     call            vichmin
19AB 120000   F     4059                                                     call            z_05s
19AE 020000   F     4060     rousta1:                jmp             goto7
                    4061     
19B1 020000   F     4062     rLABELP:                jmp                     LABELP
19B4 78B1           4063     vvodm11_15:     mov                     r0,#vichR;vvod
19B6 75B0F7         4064                                                     mov                     p3,#0f7h
19B9 20B7F5         4065                                             jb                      p3.7,rLABELP;????
                    4066                                     
                    4067     
19BC B61115         4068                                             cjne                    @r0,#11h,tome21
19BF 7621           4069                                             mov                     @r0,#21h;vvod
19C1 900000   F     4070                                             mov                     dptr,#teTE11
19C4 120000   F     4071                                             call            lotext
19C7 534B03         4072                                             anl                     bufind+11,#03h ;погасить за
                             пятые
19CA 020000   F     4073                                             jmp                     onmem11
                    4074     
19CD 16             4075     me11_15dec:             dec             @r0                             ;<-
19CE 120000   F     4076     lokame1:        call            lomenu
19D1 020000   F     4077                                             jmp                     onmem11
                    4078     
19D4 B61206         4079     tome21:         cjne                    @r0,#12h,tome13
                    4080                                             ;вкл тест интерфейса
19D7 020000   F     4081                                             jmp             testrs;??????????
19DA 020000   F     4082                                             jmp                     onmem11
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    65

                    4083     
19DD B6132A         4084     tome13:         cjne                    @r0,#13h,tome14
19E0 7631           4085                                             mov                     @r0,#31h
                    4086                                             
19E2 7A50           4087                                             mov                     r2,#50h                    
                                  ;57.6->19.2
19E4 7B2C           4088                                             mov                     r3,#2ch
19E6 120454         4089                                             call            re4byte                 ;28..2bh 3b
                             ait-parol,1 bait skor
19E9 E508           4090                                             mov                     a,r8
19EB B4000E         4091                                             cjne            a,#00,skor19
19EE 900000   F     4092                                             mov                     dptr,#teS57_6;57,6
19F1 120000   F     4093                                             call            lotext
19F4 434B80         4094                                     orl                     bufind+11,#80h
19F7 C213           4095                                             clr                     bitv19
                    4096     
19F9 020000   F     4097                                             jmp             onmem11
19FC 900000   F     4098     skor19:         mov                     dptr,#teS19_2
19FF 120000   F     4099                                             call            lotext
1A02 D213           4100                                             setb            bitv19
1A04 434B80         4101                                             orl                     bufind+11,#80h
1A07 020000   F     4102                                             jmp                     onmem11
                    4103                                             
                    4104     
1A0A B61415         4105     tome14:         cjne                    @r0,#14h,tome15
1A0D D204           4106                                             setb            bitizm
1A0F 7881           4107                                             mov                     r0,#chavt
1A11 7600           4108                                             mov                     @r0,#0
1A13 08             4109                                             inc                     r0
1A14 7600           4110                                             mov                     @r0,#0
1A16 C211           4111     outmenu:        clr                     bitmenu
1A18 020000   F     4112                                             jmp                     out7
                    4113     
1A1B 78B1           4114     goparom:        mov             r0,#vichR               ;режим меню 52
1A1D 7652           4115                                             mov                     @r0,#52h                   
                                  ;пароль уже ввели
1A1F 020000   F     4116                                             jmp                     goparol
1A22 2016F6         4117     tome15:         jb              bitpar,goparom  
1A25 7651           4118                                             mov                     @r0,#51h;ПАРОЛЬ 000
1A27 120000   F     4119                                             call            lomenu
1A2A 78B2           4120                                             mov                     r0,#marker
1A2C 7607           4121                                             mov                     @r0,#7
1A2E 753B09         4122                                             mov                     movrig,#9
1A31 753A07         4123                                             mov                     movleft,#7
                    4124                                             ;setb           bitizm
1A34 020000   F     4125                                             jmp                     onmem11
                    4126     
                    4127     
1A37 78B1           4128     me21_23:        mov                     r0,#vichR               ;<-
1A39 7423           4129                                             mov                     a,#23h
1A3B C3             4130                                             clr                     c
1A3C 96             4131                                             subb            a,@r0
1A3D 403D           4132                                             jc                      labelS1
1A3F 75B0FB         4133                                             mov                     p3,#0fbh
1A42 20B718         4134                                             jb                      p3.7,vv21_23
1A45 B6210B         4135                                             cjne            @r0,#21h,me21_23dec;-<
1A48 7623           4136                                             mov                     @r0,#23h
1A4A 900000   F     4137                                             mov                     dptr,#teTE7
1A4D 120000   F     4138                                             call            lotext
1A50 020000   F     4139                                             jmp                     onmem11
1A53                4140     me21_23dec:     
1A53 16             4141                                             dec                     @r0
1A54 120000   F     4142                                             call            lomenu
1A57 020000   F     4143                                             jmp                     onmem11
1A5A 020000   F     4144     onmem12:        jmp             outF    ;(ie7)                          
                    4145                                                     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    66

1A5D 75B0F7         4146     vv21_23:        mov             p3,#0f7h                ;vvod
1A60 20B7F7         4147                                             jb              p3.7,onmem12
1A63 B6210C         4148                                             cjne            @r0,#21h,test22
                    4149                                             ;mov                    dptr,#tabt11;заслать ус 11А
1A66 120000   F     4150     tests:          call            lotpus
1A69 D215           4151                                             setb            biteizm;запомнить режим ТИ
1A6B D204           4152                                             setb            bitizm
1A6D C211           4153                                             clr                     bitmenu;обнулить т к не буд
                             ет индикации измерения       
1A6F 020000   F     4154                                             jmp                     onmem11
1A72 B62202         4155     test22:         cjne            @r0,#22h,test23
                    4156                                     ;       mov                     dptr,#tabt9;заслать ус 9А
1A75 80EF           4157                                             jmp             tests   
1A77                4158     test23:
                    4159                                     ;       mov                     dptr,#tabt7;заслать ус 7А
1A77 80ED           4160                                             jmp             tests   
1A79 020000   F     4161     left_s:         jmp                     left_sk
1A7C B63175         4162     labelS1:        cjne            @r0,#31h,me_41
1A7F 75B0FB         4163                                             mov                     p3,#0fbh                   
                                  ;<-
1A82 30B7F4         4164                                             jnb                     p3.7,left_s
1A85 75B0F7         4165                                             mov                     p3,#0f7h
1A88 20B7CF         4166                                             jb                      p3.7,onmem12
                    4167                                             ;запомнить признак установленной скорости в рпзу
                    4168     
                    4169     ;чтение пам прогр(5000h) 1 страница(ffh)
                    4170     ;и запись во внешнее озу(0000h)
1A8B 7900           4171                                             mov             r1,#0                   ;
1A8D 7A50           4172                                     mov             r2,#50h
1A8F 7B00           4173                                     mov             r3,#00
1A91 120499         4174                                     call    copyPP
                    4175                                     ;внести изменения во внешн озу
                    4176                                     ;KD=00 01 86 A0 (KD=1)
                    4177                                     ;кофф *100000 и переведенный в hex формат
                    4178                                     ;согласно адресов диапазонов и адресов яч вн озу 
1A94 792C           4179                                     mov             r1,#2ch
1A96 7400           4180                                     mov             a,#0;57,6
1A98 301302         4181                                     jnb             bitv19,spwri
1A9B 7401           4182                                     mov             a,#1;19.6
1A9D F3             4183     spwri:  movx    @r1,a
                    4184     ;стереть страницу пап прогр 
1A9E 905000         4185                                     mov             dptr,#5000h
1AA1 7FFF           4186                                     mov             r7,#0ffh
1AA3 12043E         4187                                     call    cle256
                    4188     ;и запись в ячейки кофф памяти прогр (3000h) 
1AA6 7FFF           4189                                     mov             r7,#0ffh
1AA8 7900           4190                                     mov             r1,#0                           ;external r
                             am
1AAA 905000         4191                                     mov             dptr,#5000h
1AAD 120480         4192                                     call    wrpage
                    4193             
1AB0 201305         4194                                     jb              bitv19,outsko1  ;загр Т1 в соотв с установл
                             енной скоростью
1AB3 758DF4         4195                                             mov                     TH1,#244                ;57
                             .6
1AB6 8003           4196                                             jmp                     outsko
1AB8 758DDC         4197     outsko1:                                        mov                     TH1,#220           
                                  ;19.6
1ABB C211           4198     outsko:         clr             bitmenu
1ABD D204           4199                                             setb            bitizm
1ABF 020000   F     4200                                             jmp                     out7
                    4201     
1AC2 020000   F     4202     rlabels4:               jmp             labels4
1AC5 020000   F     4203     rlabelS13:      jmp             labelS13
                    4204     
1AC8 B652F7         4205     me_52:          cjne            @r0,#52h,rlabels4
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    67

1ACB 75B0FB         4206                                             mov                     p3,#0fbh;<-
1ACE 20B717         4207                                             jb                      p3.7,vv_52v     ;ввод в кал
                             ибровке
1AD1 78B2           4208                                                     mov             r0,#marker              ;сд
                             виг маркера влево при калибр
1AD3 7440           4209                                     mov             a,#bufind
1AD5 26             4210                                             add             a,@r0                   ;a=bufind+m
                             arker
1AD6 F9             4211                                             mov             r1,a
1AD7 19             4212                                             dec             r1;inc          r1
1AD8 873C           4213                                             mov             savba,@r1
                    4214                                                     
1ADA 78B2           4215                                             mov             r0,#marker
1ADC 16             4216                                             dec             @r0                             
1ADD C219           4217                                             clr             bitmig
1ADF E53A           4218                                             mov                     a,movleft
1AE1 B60001         4219                                             cjne    @r0,#0,me_52v;ажата кн <- при вводе цифр ка
                             либровки
1AE4 06             4220                                             inc                     @r0
1AE5 020000   F     4221     me_52v:         jmp                     goto7
                    4222     
1AE8 75B0F7         4223     vv_52v:         mov             p3,#0f7h
1AEB 30B703         4224                                             jnb             p3.7,rvvkali52
1AEE 020000   F     4225                                             jmp                     goto7
1AF1 020000   F     4226     rvvkali52:      jmp             vvkali52
                    4227     
                    4228     
1AF4 B651D1         4229     me_41:          cjne            @r0,#51h,me_52;rlabels4
1AF7 75B0FB         4230                                             mov             p3,#0fbh;<-
1AFA 30B7C8         4231                                             jnb             p3.7,rlabelS13
1AFD 75B0F7         4232                                             mov             p3,#0f7h
1B00 20B773         4233                                             jb              p3.7,vvmenu
                    4234                                             ;ввод пароля
                    4235                                     
                    4236     ;       считать с индикатора 
1B03 7F0E           4237                                     mov             r7,#14
1B05 784F           4238                                     mov             r0,#abin
1B07 120000   F     4239                                     call    clearN                  
                    4240                                     
                    4241     ;чтение номера байта с индикатора(3байта)
                    4242     ;bufind+3..bufind+9
                    4243     ;-  - - -
                    4244     ;- - - - - - - - - -
                    4245     ;adec..adec+9
                    4246     ;ст            мл
1B0A 7849           4247                                     mov             r0,#bufind+9;
1B0C 795C           4248                                     mov             r1,#adec+9
1B0E 7F03           4249                                     mov             r7,#3;3bait
1B10 C3             4250     upav1:          clr             c
1B11 E6             4251                                     mov             a,@r0
1B12 9430           4252                                     subb    a,#30h
1B14 F7             4253                                     mov             @r1,a
1B15 18             4254                                     dec             r0
1B16 19             4255                                     dec             r1
1B17 DFF7           4256                                     djnz    r7,upav1;adec+7..adec+9
1B19 7A50           4257                                             mov                     r2,#50h                    
                                  ;parol 000x    (5028h )
1B1B 7B28           4258                                             mov                     r3,#28h
1B1D 120454         4259                                             call            re4byte                 ;r8..r11(3 
                             bait parol)
1B20 800F           4260     jmp                     goparol
1B22 E508           4261                                     mov                     a,r8                    ;сравнить п
                             ароль с индикатором
1B24 B55A52         4262                                     cjne            a,adec+7,parerr
1B27 E509           4263                                     mov                     a,r9    
1B29 B55B4D         4264                                     cjne            a,adec+8,parerr
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    68

1B2C E50A           4265                                     mov                     a,r10
1B2E B55C48         4266                                     cjne            a,adec+9,parerr
                    4267                                     ;равны
1B31 78B1           4268     goparol:        mov             r0,#vichR               ;режим меню 52
1B33 7652           4269                                             mov             @r0,#52h                ;0000-n
1B35 900000   F     4270                                             mov             dptr,#teKD;00000-nA
1B38 120000   F     4271                                             call            lotext
                    4272                                             ;;;;;;;;;
                    4273                                                     ;n(hex)->abin
1B3B 120000   F     4274                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
1B3E 2552           4275                                             add             a,abin+3
1B40 F552           4276                                             mov             abin+3,a
1B42 7853           4277                                             mov             r0,#adec
1B44 7952           4278                                             mov             r1,#abin+3      ;hex->10
1B46 120000   F     4279                                             call    bindec
1B49 855C48         4280                                             mov             bufind+8,adec+9
1B4C 75472D         4281                                             mov             bufind+7,#2dh
1B4F 434A80         4282                                             orl                     bufind+10,#80h;зажечь KMП
1B52 434B10         4283                                             orl                     bufind+11,#10h;точка после 
                             1 знакоместа
1B55 79AE           4284                                             mov             r1,#diap
1B57 7848           4285                                             mov             r0,#bufind+8
1B59 E7             4286                                             mov             a,@r1
1B5A B40807         4287                                             cjne    a,#8,nodi8k
1B5D 7630           4288                                             mov             @r0,#30h                 ;10-10
1B5F 18             4289                                             dec             r0
1B60 7663           4290                                             mov             @r0,#63h;31h
1B62 8008           4291                                             jmp             nodisk9
1B64 B40905         4292     nodi8k:                         cjne    a,#9,nodisk9
                    4293                                     
1B67 7631           4294                                             mov             @r0,#31h           ;10-11
1B69 18             4295                                             dec             r0
1B6A 7663           4296                                             mov             @r0,#63h;31h
                    4297                                     
                    4298     
1B6C 78B2           4299     nodisk9:        mov                     r0,#marker
1B6E 7601           4300                                             mov                     @r0,#1
1B70 753A01         4301                                             mov                     movleft,#1
1B73 753B05         4302                                             mov                     movrig,#5
                    4303                                             
1B76 020000   F     4304     vvmenu:         jmp             goto7
                    4305     
1B79 753932         4306     parerr:         mov                     nuerr,#32h
1B7C 120000   F     4307                                             call            error
1B7F 120000   F     4308                                             call            ind
1B82 120000   F     4309                                             call            z_1s
1B85 C211           4310                                             clr                     bitmenu
1B87 D204           4311                                             setb            bitizm
1B89 78B2           4312                                             mov                     r0,#marker
1B8B 76FF           4313                                             mov                     @r0,#0ffh
1B8D 020000   F     4314                                             jmp             goto7
                    4315     
1B90 30130E         4316     left_sk:                jnb                     bitv19,tosk19;<-
1B93 900000   F     4317                                             mov                     dptr,#teS57_6;57,6
1B96 120000   F     4318                                             call            lotext
1B99 434B80         4319                                             orl                     bufind+11,#80h
1B9C C213           4320                                             clr                     bitv19
1B9E 020000   F     4321                                             jmp             out7
1BA1 900000   F     4322     tosk19:         mov                     dptr,#teS19_2
1BA4 120000   F     4323                                             call            lotext
1BA7 434B80         4324                                             orl                     bufind+11,#80h
1BAA D213           4325                                             setb            bitv19
1BAC 020000   F     4326                                             jmp             out7
                    4327     
1BAF                4328     labelS13:;<- MENU(ПАРОЛЬ 000)
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    69

                    4329             
                    4330     ;;;;;;;;;;;;;;;;;;
                    4331     ;необходимо не портить цифру в следуюем слева знакоместе
                    4332     ;т е сохранить ее в ячейке для мигания в противном случае
                    4333     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4334     ;       знакоместа
1BAF 78B2           4335                                     mov             r0,#marker
1BB1 7440           4336                                     mov             a,#bufind
1BB3 26             4337                                             add             a,@r0                   ;a=bufind+m
                             arker
1BB4 F9             4338                                             mov             r1,a
1BB5 19             4339                                             dec             r1;inc          r1
1BB6 873C           4340                                             mov             savba,@r1
                    4341                                                     
1BB8 78B2           4342                                                     mov             r0,#marker
1BBA 16             4343                                                     dec             @r0                        
                                  
1BBB C219           4344                                     clr             bitmig
1BBD E53A           4345                                     mov                     a,movleft
1BBF B60652         4346                                     cjne    @r0,#6,onmem13;;нажата кн <- при вводе цифр ПАРОЛЬ 
                             000
1BC2 06             4347                                     inc             @r0
1BC3 020000   F     4348                                             jmp             goto7
                    4349     ;;;;;;;
                    4350     
1BC6                4351     vvkali52:       ;введено значение для калибровки
                    4352                                             ;число на индикаторе ->Ak  (52h)
                    4353                                             ;       считать с индикатора 
1BC6 7F0E           4354                                     mov             r7,#14
1BC8 784F           4355                                     mov             r0,#abin
1BCA 120000   F     4356                                     call    clearN                  
                    4357                                     
                    4358     ;чтение номера байта с индикатора(3байта)
                    4359     ;bufind+1..bufind+5
                    4360     ;-  - - -
                    4361     ;- - - - - - - - - -
                    4362     ;adec..adec+9
                    4363     ;ст            мл
1BCD 7845           4364                                     mov             r0,#bufind+5;
1BCF 795C           4365                                     mov             r1,#adec+9
1BD1 7F05           4366                                     mov             r7,#5;5bait
1BD3 C3             4367     upav2:          clr             c
1BD4 E6             4368                                     mov             a,@r0
1BD5 9430           4369                                     subb    a,#30h
1BD7 F7             4370                                     mov             @r1,a
1BD8 18             4371                                     dec             r0
1BD9 19             4372                                     dec             r1
1BDA DFF7           4373                                     djnz    r7,upav2;adec+7..adec+9
                    4374     
1BDC 784F           4375                                     mov             r0,#abin
1BDE 7953           4376                                     mov             r1,#adec                        ;мл        
                              ст
1BE0 120000   F     4377                                     call    decbin                  ;abin..abin+3 (hex)
1BE3 120000   F     4378                                     call    loadr2                  ;r2..r5
1BE6 120402         4379                                     call    altof   ;r2..r5->float
1BE9 900000   F     4380                                     mov     dptr,#ch_10;10
1BEC 120000   F     4381                                     call    ldc_ltemp                       ;r8..r11=8
1BEF 120203         4382                                     call    flmul
1BF2 78A4           4383                                     mov             r0,#rez_Ak
1BF4 120000   F     4384                                     call    saver2
1BF7 C211           4385                                             clr                     bitmenu
1BF9 D212           4386                                             setb            bitklb
1BFB 434A80         4387                                             orl                     bufind+10,#80h;зажечь KMП
1BFE D204           4388                                             setb            bitizm;бит калибровки уже установле
                             н
1C00 78B2           4389                                             mov                     r0,#marker
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    70

1C02 76FF           4390                                             mov                     @r0,#0ffh
1C04 783D           4391                                     mov             r0,#chkl
1C06 76FF           4392                                     mov             @r0,#0ffh
1C08 08             4393                                     inc             r0
1C09 76FF           4394                                     mov             @r0,#0ffh;38h
1C0B 120000   F     4395                                     call            z_1s
1C0E 020000   F     4396                                     jmp             out7
                    4397     
                    4398     
1C11 020000   F     4399                                             jmp             goto7
                    4400                                              
1C14 020000   F     4401     onmem13:        jmp             goto7   ;(ie7)
                    4402     
1C17 B642AC         4403     labels4:        cjne            @r0,#42h,vvkali52
1C1A 75B0FB         4404                                             mov                     p3,#0fbh;<-
1C1D 30B7F4         4405                                             jnb             p3.7,onmem13
1C20 75B0F7         4406                                             mov             p3,#0f7h;vvod
1C23 20B7EE         4407                                             jb              p3.7,onmem13
                    4408                                             
                    4409             
1C26 020000   F     4410     jmp             out7                                                    
                    4411     ;;;;;;;
1C29                4412     labelI:
1C29 75B0FE         4413                                     mov             p3,#0feh
1C2C E5B0           4414                                     mov             a,p3
1C2E 20E703         4415                                     jb              acc.7,nopoint
                    4416                                     ;
1C31 020000   F     4417                                     jmp             goto7;out7
                    4418     
1C34 75B0FB         4419     nopoint:                mov             p3,#0fbh
1C37 E5B0           4420                                     mov             a,p3
1C39 20E72C         4421                                     jb              acc.7,nopoin7
1C3C 78B2           4422     labelS3:mov             r0,#marker
1C3E E53A           4423                                     mov             a,movleft
1C40 B40309         4424                                     cjne    a,#3,poina1
1C43 B6030B         4425                                     cjne    @r0,#3,nomarl;26
                    4426                                     ;mov            @r0,#9
1C46 E53B           4427     poina2: mov                     a,movrig                ;кн <- B=+00000
1C48 F6             4428                                     mov                     @r0,a
1C49 020000   F     4429                                     jmp             goto7;  out7
                    4430     
1C4C B60402         4431     poina1:         cjne    @r0,#4,nomarl;кн <- A= 0000
1C4F 80F5           4432                                             jmp             poina2
                    4433     
                    4434     
1C51                4435     nomarl:                 ;                               29.12.06
                    4436     ;;;;;;;;;;;;;;;;;;
                    4437     ;необходимо не портить цифру в следуюем справа знакоместе
                    4438     ;т е сохранить ее в ячейке для мигания в противном случае
                    4439     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4440     ;       знакоместа
1C51 78B2           4441                                     mov             r0,#marker
1C53 7440           4442                                     mov             a,#bufind
1C55 26             4443                                             add             a,@r0                   ;a=bufind+m
                             arker
1C56 F9             4444                                             mov             r1,a
1C57 09             4445                                             inc             r1
1C58 873C           4446                                             mov             savba,@r1
                    4447                                                     
1C5A 78B2           4448                                                     mov             r0,#marker
1C5C 16             4449                                                     dec             @r0                        
                                  
1C5D C219           4450                                     clr             bitmig
1C5F E53A           4451                                     mov                     a,movleft
1C61 B4036B         4452                                     cjne            a,#3,poinA
1C64 B60266         4453                                     cjne    @r0,#2,gogo7;out7;;нажата кн <- при вводе цифр B=+0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    71

                             0000
1C67 06             4454     poin3:  inc             @r0
                    4455     ;нажат ввод А =000000 запомнить константу А
1C68 75B0F7         4456     nopoin7:           mov          p3,#0f7h
1C6B E5B0           4457                                     mov             a,p3
1C6D 20E75D         4458                                     jb              acc.7,gogo7;out7
1C70 78B1           4459                                     mov             r0,#vichR
1C72 E6             4460                                     mov             a,@r0
1C73 B6215E         4461                                     cjne    @r0,#21h,no21p7
1C76 7611           4462                                     mov             @r0,#11h
                    4463                             ;       считать с индикатора  упаковать в плавающий формат
                    4464                             ;   сохранить
1C78 7F0E           4465                                     mov             r7,#14
1C7A 784F           4466                                     mov             r0,#abin
1C7C 120000   F     4467                                     call    clearN                  
1C7F 120000   F     4468                                     call    upakA
                    4469                                     
1C82 784F           4470                                     mov             r0,#abin
1C84 7953           4471                                     mov             r1,#adec                        ;мл        
                              ст
1C86 120000   F     4472                                     call    decbin                  ;abin..abin+3 (hex)
1C89 120000   F     4473                                     call    loadr2                  ;r2..r5
1C8C 120402         4474                                     call    altof                   ;r2..r5->float
1C8F 78BC           4475                                     mov                     r0,#konstA
1C91 120000   F     4476                                     call            saver2
1C94 900000   F     4477                                     mov                     dptr,#ch0
1C97 120000   F     4478                                     call            ldc_ltemp
1C9A 1201D6         4479                                     call            flcmp
1C9D 6010           4480                                     jz              erra0
                    4481     ;26
1C9F 78B2           4482                                     mov             r0,#marker
1CA1 76FF           4483                                     mov             @r0,#0ffh
                    4484                                     
1CA3 900000   F     4485                                     mov             dptr,#teVICH;teBequ0
1CA6 120000   F     4486                                     call    lotext
                    4487                             ;       call            outB
1CA9 534BBF         4488                                     anl             bufind+11,#0bfh         ;гашение точки bufi
                             nd+7
                    4489                             ;       orl             bufind+11,#80h
1CAC 020000   F     4490                                     jmp             goto7
                    4491     
1CAF 78B2           4492     erra0:          mov             r0,#marker
1CB1 76FF           4493                                             mov             @r0,#0ffh
1CB3 753934         4494                                             mov                     nuerr,#34h;константа не дол
                             жна быть равна0
1CB6 120000   F     4495                                             call            error
1CB9 120000   F     4496                                             call            ind
1CBC 120000   F     4497                                             call            z_1s
1CBF 78B1           4498                                             mov                     r0,#vichR
1CC1 7600           4499                                             mov                     @r0,#0
1CC3 C214           4500                                             clr                     bitvich
1CC5 C206           4501                                             clr                     bitvi11
1CC7 D204           4502                                             setb            bitizm
1CC9 78B2           4503                                             mov                     r0,#marker
1CCB 76FF           4504                                             mov                     @r0,#0ffh
1CCD 802E           4505     gogo7:          jmp                     out7;goto7
                    4506     
1CCF B6032B         4507     poinA:          cjne    @r0,#3,out7;;нажата кн <- при вводе цифр A= 0000
1CD2 8093           4508                                             jmp             poin3
                    4509     
1CD4                4510     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    4511                             ;   сохранить
1CD4 7F0E           4512                                     mov             r7,#14
1CD6 784F           4513                                     mov             r0,#abin
1CD8 120000   F     4514                                     call    clearN                  
1CDB 120000   F     4515                                     call    upakB                   
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    72

1CDE 784F           4516                                     mov             r0,#abin
1CE0 7953           4517                                     mov             r1,#adec                        ;мл        
                              ст
1CE2 120000   F     4518                                     call    decbin                  ;abin..abin+3 (hex)
1CE5 120000   F     4519                                     call    loadr2                  ;r2..r5
1CE8 120402         4520                                     call    altof                   ;r2..r5->int
1CEB 301B04         4521                                     jnb             bitznB,pozB
1CEE EA             4522                                     mov             a,r2
1CEF 4480           4523                                     orl             a,#80h
1CF1 FA             4524                                     mov             r2,a                    ;знак-
1CF2                4525     pozB:           ;mov            r0,#konstB
                    4526                                     ;call   saver2
                    4527     
1CF2 79B2           4528                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
1CF4 77FF           4529                                     mov             @r1,#0ffh
1CF6 78B1           4530                                     mov             r0,#vichR
1CF8 7611           4531                                     mov             @r0,#11h
1CFA 020000   F     4532                               jmp           lovich     ;3.01.07ВЫЧИСЛИТЬ
                    4533                                     
                    4534     
1CFD                4535     out7:                   ;mov            IE,#80h
1CFD D083           4536                                     pop             dph
1CFF D082           4537                                     pop             dpl
1D01 D007           4538                                     pop             rr7     
1D03 D006           4539                                     pop             rr6
1D05 D005           4540                                     pop             rr5
1D07 D004           4541                                     pop             rr4
1D09 D003           4542                                     pop             rr3
1D0B D002           4543                                     pop             rr2
1D0D D001           4544                                     pop             rr1                             
1D0F D000           4545                                     pop             rr0
1D11 D0D0           4546                                     pop             psw
1D13 D0E0           4547                                     pop             acc
1D15 75AD00         4548                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1D18 75B0C0         4549                             mov             P3,#0c0h
                    4550                             ;       mov             EIE2,#30H
1D1B C219           4551     clr             bitmig
1D1D E586           4552                                             mov             a,P6            ;p6.4=0
1D1F 54EF           4553                             anl             a,#0efh
1D21 F586           4554                             mov             P6,a
1D23 00             4555                             nop
1D24 00             4556                             nop
                    4557                                     
1D25 E586           4558                             mov             a,P6                    ;p6.4=1 
1D27 4410           4559                             orl             a,#10h
1D29 F586           4560                             mov             P6,a
                    4561                             ;;;;;;;;;
1D2B E5DA           4562                             mov             a,PCA0CPM0;             TOG0
1D2D 4446           4563                             orl             a,#46h;anl              a,#0fbh
1D2F F5DA           4564                             mov             PCA0CPM0,a
                    4565     
1D31 75CDD0         4566                             mov             TH2,#0d0h
1D34 75CC00         4567                             mov             TL2,#00
                    4568     
1D37 D2CA           4569                             setb            T2CON.2
1D39 D2AD           4570                             setb            ET2;IE.5                            
1D3B 32             4571                                     reti
                    4572     
                    4573     
                    4574                                     
                    4575     
                    4576     
1D3C 78B1           4577     lomenu:         mov             r0,#vichR
1D3E B61107         4578                                             cjne    @r0,#11h,menu12
1D41 900000   F     4579                                             mov             dptr,#teTESI
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    73

1D44 120000   F     4580     lome1:                  call    lotexT
1D47 22             4581                                             ret
1D48 B61205         4582     menu12:         cjne    @r0,#12h,menu13
1D4B 900000   F     4583                                             mov             dptr,#teTESR
1D4E 80F4           4584                                             jmp             lome1
1D50 B61305         4585     menu13:         cjne    @r0,#13h,menu14
1D53 900000   F     4586                                             mov             dptr,#teSKOR
1D56 80EC           4587                                             jmp             lome1
1D58 B61405         4588     menu14:         cjne    @r0,#14h,menu15
1D5B 900000   F     4589                                             mov             dptr,#teAVK
1D5E 80E4           4590                                             jmp             lome1
1D60 B61505         4591     menu15:                 cjne    @r0,#15h,menu21
1D63 900000   F     4592                                             mov             dptr,#teKALIB
1D66 80DC           4593                                             jmp             lome1
                    4594     
1D68 B62105         4595     menu21: cjne    @r0,#21h,menu22
1D6B 900000   F     4596                                             mov             dptr,#teTE11
1D6E 80D4           4597                                             jmp             lome1
1D70 B62205         4598     menu22:         cjne    @r0,#22h,menu23
1D73 900000   F     4599                                             mov             dptr,#teTE9
1D76 80CC           4600                                             jmp             lome1
1D78 B62305         4601     menu23:         cjne    @r0,#23h,menu31
1D7B 900000   F     4602                                             mov             dptr,#teTE7
1D7E 80C4           4603                                             jmp             lome1
1D80 B63105         4604     menu31:         cjne    @r0,#31h,menu41
1D83 900000   F     4605                                             mov             dptr,#teS57_6
1D86 80BC           4606                                             jmp             lome1
                    4607     
1D88                4608     menu41:         
1D88 900000   F     4609                                             mov             dptr,#tePAR
1D8B 80B7           4610                                             jmp             lome1
                    4611     
1D8D 020000   F     4612     yesvi_kr:               jmp                     yesvi_km
1D90                4613     endkalib:;KD=Ak/A3
1D90 200DFA         4614                                             jb                      bifl_kt,yesvi_kr;выч кофф К
                             м
1D93 789C           4615                                             mov                     r0,#rez_A3
1D95 120000   F     4616                                             call            resar2
                    4617                                     
1D98 120402         4618                                     call    altof                   ;->float
1D9B EA             4619                                             mov                     a,r2
1D9C 547F           4620                                             anl                     a,#7fh
1D9E FA             4621                                             mov                     r2,a
1D9F 120000   F     4622                                     call            move28
1DA2 78A4           4623                                             mov                     r0,#rez_Ak
1DA4 120000   F     4624                                             call            resar2
1DA7 1202B7         4625                                             call            fldiv
                    4626                                                     
1DAA 900000   F     4627                                     mov     dptr,#CHtho;100000
1DAD 120000   F     4628                                     call    ldc_ltemp                       ;r8..r11=8
1DB0 120203         4629                                     call    flmul
1DB3 120343         4630                                     call    ftol            ;r2..r5->hex кофф KD (РЕЗ ИЗМ ЧИСЛО
                              6разрядное)
                    4631     
1DB6 78A0           4632                                             mov                     r0,#koefKD
1DB8 120000   F     4633                                             call            saver2
                    4634                                             ;запись в рпзу в соотв ячейку
                    4635                             
1DBB 7900           4636                                             mov             r1,#0                   ;счит рпзу 
                             во внешн озу
1DBD 7A50           4637                                     mov             r2,#50h
1DBF 7B00           4638                                     mov             r3,#00
1DC1 120499         4639                                     call    copyPP
                    4640                                     ;внести изменения во внешн озу
1DC4 120000   F     4641                                     call            findext                 ;r1-внешн озу
1DC7 78A0           4642                                     mov                     r0,#koefKD
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    74

1DC9 120000   F     4643                                             call            resar2
1DCC EA             4644                                             mov                     a,r2
1DCD F3             4645                                             movx            @r1,a
1DCE 09             4646                                             inc                     r1
1DCF EB             4647                                             mov                     a,r3
1DD0 F3             4648                                             movx            @r1,a
1DD1 09             4649                                             inc                     r1
1DD2 EC             4650                                             mov                     a,r4
1DD3 F3             4651                                             movx            @r1,a
1DD4 09             4652                                             inc                     r1
1DD5 ED             4653                                             mov                     a,r5
1DD6 F3             4654                                             movx            @r1,a
                    4655                                     ;кофф *100000 и переведенный в hex формат
                    4656                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4657     ;стереть страницу пап прогр 
1DD7 905000         4658                                     mov             dptr,#5000h
1DDA 7FFF           4659                                     mov             r7,#0ffh
1DDC 12043E         4660                                     call    cle256
                    4661     ;и запись в ячейки кофф памяти прогр (3000h) 
1DDF 7FFF           4662                                     mov             r7,#0ffh
1DE1 7900           4663                                     mov             r1,#0                           ;external r
                             am
1DE3 905000         4664                                     mov             dptr,#5000h
1DE6 120480         4665                                     call    wrpage
                    4666     ;2.2.07
1DE9 79AE           4667                                     mov                     r1,#diap
1DEB B70511         4668                                     cjne            @r1,#5,fulkalib
                    4669                                     ;jb                     bifl_kt,yesvi_km;выч кофф Км
1DEE D20D           4670                                     setb            bifl_kt
                    4671                                     ;call           loadus
1DF0 900000   F     4672                                     mov                     dptr,#tabt7;заслать ус 7А       
1DF3 E4             4673                             clr             a
1DF4 93             4674                             movc    a,@a+dptr                               ;high byte
1DF5 F584           4675                             mov             p4,a
1DF7 A3             4676                             inc             dptr
1DF8 E4             4677                             clr             a
1DF9 93             4678                             movc    a,@a+dptr                               ;low byte
1DFA F585           4679                             mov             p5,a
1DFC 020000   F     4680                                     jmp             goto7;  out_kali
                    4681     
                    4682     ;;;
1DFF                4683     fulkalib:
1DFF C212           4684                                             clr             bitklb
1E01 D216           4685                                             setb    bitpar                  ;пароль провели 1 р
                             аз успешно
1E03 900000   F     4686                                             mov             dptr,#teEND
1E06 120000   F     4687                                             call    lotext
1E09 120000   F     4688                                             call    ind
1E0C 120000   F     4689     out_kali:       call    z_1s
1E0F 120000   F     4690                                             call    z_1s
1E12 020000   F     4691                                             jmp             goto7
1E15                4692     yesvi_km:               ;выч кофф Км=(10**5/A2)*K7/K5
1E15 7A50           4693                                     mov                     r2,#50h                 ;-11a
1E17 7B14           4694                                     mov                     r3,#14h                 ;k7
1E19 12046C         4695                                     call            rebyte2                         ;r2..r5- he
                             x
1E1C 120402         4696                                     call            altof                   ;r2..r5->float
1E1F C002           4697                                     push            rr2
1E21 C003           4698                                     push            rr3
1E23 C004           4699                                     push            rr4
1E25 C005           4700                                     push            rr5
1E27 7A50           4701                                     mov                     r2,#50h                 ;k5
1E29 7B0C           4702                                     mov                     r3,#0ch
1E2B 12046C         4703                             call            rebyte2                 ;r2..r5
1E2E 120402         4704                                     call            altof                   ;r2..r5->float
1E31 120000   F     4705                                     call            move28
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    75

1E34 D005           4706                                     pop                     rr5
1E36 D004           4707                                     pop                     rr4
1E38 D003           4708                                     pop                     rr3
1E3A D002           4709                                     pop                     rr2
1E3C 1202B7         4710                                     call            fldiv                   ;K7/K5
                    4711     
1E3F 900000   F     4712                                     mov     dptr,#CHtho;100000
1E42 120000   F     4713                                     call    ldc_ltemp                       ;r8..r11=8
1E45 120203         4714                                     call    flmul                           ;r2..r5 ;K7/K5*10**
                             5
1E48 C002           4715                                     push            rr2
1E4A C003           4716                                     push            rr3
1E4C C004           4717                                     push            rr4
1E4E C005           4718                                     push            rr5
                    4719                                     
1E50 789C           4720                                     mov                     r0,#rez_A3
1E52 120000   F     4721                                     call            resar2
1E55 120402         4722                                     call            altof                           ;r2..r5->fl
                             oat
1E58 120000   F     4723                                     call            move28
1E5B D005           4724                                     pop                     rr5
1E5D D004           4725                                     pop                     rr4
1E5F D003           4726                                     pop                     rr3
1E61 D002           4727                                     pop                     rr2
1E63 1202B7         4728                               call          fldiv           ;Km     
                    4729     
1E66 900000   F     4730                                     mov     dptr,#CHtho;100000
1E69 120000   F     4731                                     call    ldc_ltemp                       ;r8..r11=8
1E6C 120203         4732                                     call    flmul                           ;r2..r5
1E6F 120343         4733                                     call    ftol                    ;r2..r5->hex кофф Km(РЕЗ ИЗ
                             М ЧИСЛО 6разрядное)
1E72 78A0           4734                                     mov                     r0,#koefKD;2ое исп ячейки koefKD
1E74 120000   F     4735                                     call            saver2
                    4736                                     ;запись в рпзу в соотв ячейку
1E77 7900           4737                                     mov             r1,#0                   ;счит рпзу во внешн
                              озу
1E79 7A50           4738                                     mov             r2,#50h
1E7B 7B00           4739                                     mov             r3,#00
1E7D 120499         4740                                     call    copyPP
                    4741                                     ;внести изменения во внешн озу
1E80 78A0           4742                                     mov                     r0,#koefKD
1E82 120000   F     4743                                     call            resar2
1E85 792C           4744                                     mov                     r1,#2ch                 ;r1-внешн о
                             зу кофф Km
                    4745                             
1E87 EA             4746                                     mov                     a,r2
1E88 F3             4747                                             movx            @r1,a
1E89 09             4748                                             inc                     r1
1E8A EB             4749                                             mov                     a,r3
1E8B F3             4750                                             movx            @r1,a
1E8C 09             4751                                             inc                     r1
1E8D EC             4752                                             mov                     a,r4
1E8E F3             4753                                             movx            @r1,a
1E8F 09             4754                                             inc                     r1
1E90 ED             4755                                             mov                     a,r5
1E91 F3             4756                                             movx            @r1,a
                    4757                                     ;кофф *100000 и переведенный в hex формат
                    4758                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4759     ;стереть страницу пап прогр 
1E92 905000         4760                                     mov             dptr,#5000h
1E95 7FFF           4761                                     mov             r7,#0ffh
1E97 12043E         4762                                     call    cle256
                    4763     ;и запись в ячейки кофф памяти прогр (3000h) 
1E9A 7FFF           4764                                     mov             r7,#0ffh
1E9C 7900           4765                                     mov             r1,#0                           ;external r
                             am
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    76

1E9E 905000         4766                                     mov             dptr,#5000h
1EA1 120480         4767                                     call    wrpage
                    4768     
1EA4 C20D           4769                                             clr             bifl_kt
1EA6 120000   F     4770                                             call    loadus
1EA9 020000   F     4771                                             jmp             fulkalib
                    4772     
                    4773     ;выч среднего по блоку
                    4774     ;вых r2..r5
1EAC                4775     vichmean:       
1EAC 120000   F     4776                                             call            resa_hl;save_bl->dptr
1EAF 78D7           4777                                             mov                     r0,#copy_hl
1EB1 E583           4778                                             mov                     a,dph
1EB3 F6             4779                                             mov                     @r0,a
1EB4 08             4780                                             inc                     r0
1EB5 E582           4781                                             mov                     a,dpl
1EB7 F6             4782                                             mov                     @r0,a
1EB8 78B8           4783                                             mov                     r0,#work
1EBA 120000   F     4784                                             call            clear4
1EBD 78D6           4785                                             mov                     r0,#chblok;volume
1EBF 7600           4786                                             mov                     @r0,#0
1EC1 120000   F     4787     meng:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1EC4 E582           4788                                             mov                     a,dpl
1EC6 FF             4789                                             mov                     r7,a
1EC7 E583           4790                                             mov                     a,dph
1EC9 FE             4791                                             mov                     r6,a
                    4792     
1ECA 78D7           4793                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1ECC E6             4794                                             mov                     a,@r0
1ECD F583           4795                                             mov                     dph,a
1ECF 08             4796                                             inc                     r0
1ED0 E6             4797                                             mov                     a,@r0
1ED1 F582           4798                                             mov                     dpl,a
                    4799                                             
1ED3 C3             4800                                             clr                     c;-4
1ED4 E582           4801                                             mov                     a,dpl
1ED6 9404           4802                                             subb            a,#4
1ED8 F582           4803                                             mov                     dpl,a
1EDA E583           4804                                             mov                     a,dph
1EDC 9400           4805                                             subb            a,#0
1EDE F583           4806                                             mov                     dph,a;dptr-4
                    4807                                             ;;;;;;;;
1EE0 79D7           4808                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1EE2 E583           4809                                                     mov             a,dph
1EE4 F7             4810                                               mov           @r1,a
1EE5 09             4811                                                     inc             r1
1EE6 E582           4812                                                     mov             a,dpl
1EE8 F7             4813                                                     mov             @r1,a
                    4814                                                     ;;;;;;;;;
1EE9 C3             4815                                                     clr             c;пришли в начало блока?
1EEA E582           4816                                                     mov                     a,dpl
1EEC 9F             4817                                                     subb            a,r7
1EED FF             4818                                                     mov                     r7,a
1EEE 7006           4819                                                     jnz                     nextmea
1EF0 E583           4820                                                     mov                     a,dph
1EF2 9E             4821                                                     subb            a,r6
1EF3 FE             4822                                                     mov                     r6,a
1EF4 601B           4823                                                     jz                      outmea;
                    4824                                                     
                    4825                                                     ;продолжаем сравнение
                    4826                                                     ;;;;;;;;;;;             
1EF6 120000   F     4827     nextmea:                call            loahl_r2        ;из яч внешн озу ->r2..r5
1EF9 120402         4828                                             call            altof;->float
1EFC 120000   F     4829                                             call            move28                  ;r8..r11
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    77

1EFF 78B8           4830                                             mov                     r0,#work
1F01 120000   F     4831                                             call            resar2
1F04 120166         4832                                             call            fladd
1F07 78B8           4833                                             mov                     r0,#work
1F09 120000   F     4834                                             call            saver2
1F0C 78D6           4835                                             mov                     r0,#chblok;volume;кол измер
                             ений блока
1F0E 06             4836                                             inc                     @r0
1F0F 80B0           4837                                             jmp                     meng
1F11                4838     outmea:         
1F11 120000   F     4839                                             call            loahl_r2        ;из яч внешн озу ->
                             r2..r5
1F14 120402         4840                                             call            altof;->float
1F17 120000   F     4841                                             call            move28                  ;r8..r11
1F1A 78B8           4842                                             mov                     r0,#work
1F1C 120000   F     4843                                             call            resar2
1F1F 120166         4844                                             call            fladd
1F22 78B8           4845                                             mov                     r0,#work
1F24 120000   F     4846                                             call            saver2
1F27 E4             4847                                             clr                     a
1F28 FA             4848                                             mov                     r2,a
1F29 FB             4849                                             mov                     r3,a
1F2A FC             4850                                             mov                     r4,a
1F2B 78D6           4851                                             mov                     r0,#chblok;volume;кол измер
                             ений блока...200d
1F2D E6             4852                                             mov                     a,@r0
1F2E 2401           4853                                             add                     a,#1
1F30 FD             4854                                             mov                     r5,a
1F31 120402         4855                                             call            altof;r2..r5 float
1F34 120000   F     4856                                             call            move28
1F37 78B8           4857                                             mov                     r0,#work
1F39 120000   F     4858                                             call            resar2
1F3C 1202B7         4859                                             call            fldiv
1F3F 900000   F     4860                                             mov                     dptr,#ch_10      
1F42 120000   F     4861                                     call            ldc_ltemp
1F45 1202B7         4862                                     call            fldiv
1F48 120343         4863                                             call            ftol                            ;->
                             hex
1F4B 120000   F     4864                                             call    maform
1F4E 784F           4865                                             mov             r0,#abin
1F50 120000   F     4866                                             call    saver2
                    4867     ;;;;;;;;
                    4868                                             
1F53 7853           4869                                             mov             r0,#adec
1F55 7952           4870                                             mov             r1,#abin+3      ;hex->10
1F57 120000   F     4871                                             call    bindec
                    4872                                     
1F5A 785C           4873                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1F5C 7949           4874                                             mov             r1,#bufind+9
1F5E 7F05           4875                                             mov             r7,#5
1F60 E6             4876     bufmea:                         mov             a,@r0
1F61 2430           4877                                             add             a,#30h
1F63 F7             4878                                             mov             @r1,a
1F64 19             4879                                             dec             r1
1F65 18             4880                                             dec             r0
1F66 DFF8           4881                                             djnz    r7,bufmea
1F68 7844           4882                                             mov             r0,#bufind+4
1F6A 762B           4883                                             mov             @r0,#2bh          
1F6C 300202         4884                                             jnb             znmat,nozmea
1F6F 762D           4885                                             mov             @r0,#2dh
1F71 434B05         4886     nozmea:         orl             bufind+11,#05h
1F74 22             4887                                             ret
                    4888     
                    4889     
1F75 E0             4890     loahl_r2:       movx            a,@dptr         ;из яч внешн озу ->r2..r5
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    78

1F76 FA             4891                                             mov                     r2,a
1F77 A3             4892                                             inc                     dptr
1F78 E0             4893                                             movx            a,@dptr
1F79 FB             4894                                             mov                     r3,a
1F7A A3             4895                                             inc                     dptr
1F7B E0             4896                                             movx            a,@dptr
1F7C FC             4897                                             mov                     r4,a
1F7D A3             4898                                             inc                     dptr
1F7E E0             4899                                             movx            a,@dptr
1F7F FD             4900                                             mov                     r5,a    
1F80 22             4901                                             ret
                    4902     
1F81 C3             4903     min4_hl:        clr                     c;-4
1F82 E582           4904                                             mov                     a,dpl
1F84 9404           4905                                             subb            a,#4
1F86 F582           4906                                             mov                     dpl,a
1F88 E583           4907                                             mov                     a,dph
1F8A 9400           4908                                             subb            a,#0
1F8C F583           4909                                             mov                     dph,a;dptr-4
1F8E 22             4910                                             ret
                    4911     
                    4912     ;мин значение по по блоку
1F8F                4913     vichmin:        
1F8F 120000   F     4914                                             call            resa_hl;save_bl->dptr
                    4915                                                                                     
                    4916     ;с конца блока адрес 2го измерение
1F92 120000   F     4917                                             call            min4_hl
                    4918                                             
1F95 78B8           4919                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4920                                             
1F97 E0             4921                                             movx            a,@dptr
1F98 F6             4922                                             mov                     @r0,a
1F99 08             4923                                             inc                     r0
1F9A A3             4924                                             inc                     dptr
1F9B E0             4925                                             movx            a,@dptr
1F9C F6             4926                                             mov                     @r0,a
1F9D 08             4927                                             inc                     r0
1F9E A3             4928                                             inc                     dptr
1F9F E0             4929                                             movx            a,@dptr
1FA0 F6             4930                                             mov                     @r0,a
1FA1 08             4931                                             inc                     r0
1FA2 A3             4932                                             inc                     dptr
1FA3 E0             4933                                             movx            a,@dptr
1FA4 F6             4934                                             mov                     @r0,a
1FA5 A3             4935                                             inc                     dptr
                    4936                                             
1FA6 78B8           4937                                             mov                     r0,#work
1FA8 120000   F     4938                                             call            resar2
1FAB 120402         4939                                             call            altof;->float;r2..r5
1FAE 78B8           4940                                             mov                     r0,#work
1FB0 120000   F     4941                                             call            saver2
                    4942     
1FB3 120000   F     4943                                             call            min4_hl
                    4944                                             ;call           min4_hl
                    4945     
1FB6 78D7           4946                                             mov                     r0,#copy_hl
1FB8 E583           4947                                             mov                     a,dph
1FBA F6             4948                                             mov                     @r0,a
1FBB 08             4949                                             inc                     r0
1FBC E582           4950                                             mov                     a,dpl
1FBE F6             4951                                             mov                     @r0,a
                    4952                                     
1FBF 78D6           4953                                             mov                     r0,#chblok;volume
1FC1 7600           4954                                             mov                     @r0,#0
1FC3 120000   F     4955     ming:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    79

1FC6 E582           4956                                             mov                     a,dpl
1FC8 FF             4957                                             mov                     r7,a
1FC9 E583           4958                                             mov                     a,dph
1FCB FE             4959                                             mov                     r6,a
                    4960     
1FCC 78D7           4961                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1FCE E6             4962                                             mov                     a,@r0
1FCF F583           4963                                             mov                     dph,a
1FD1 08             4964                                             inc                     r0
1FD2 E6             4965                                             mov                     a,@r0
1FD3 F582           4966                                             mov                     dpl,a
                    4967                                             
1FD5 C3             4968                                             clr                     c;-4
1FD6 E582           4969                                             mov                     a,dpl
1FD8 9404           4970                                             subb            a,#4
1FDA F582           4971                                             mov                     dpl,a
1FDC E583           4972                                             mov                     a,dph
1FDE 9400           4973                                             subb            a,#0
1FE0 F583           4974                                             mov                     dph,a;dptr-4
                    4975                                             ;;;;;;;;
1FE2 79D7           4976                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1FE4 E583           4977                                                     mov             a,dph
1FE6 F7             4978                                               mov           @r1,a
1FE7 09             4979                                                     inc             r1
1FE8 E582           4980                                                     mov             a,dpl
1FEA F7             4981                                                     mov             @r1,a
                    4982                                                     ;;;;;;;;;
1FEB C3             4983                                                     clr             c;пришли в начало блока?
1FEC E582           4984                                                     mov                     a,dpl
1FEE 9F             4985                                                     subb            a,r7
1FEF FF             4986                                                     mov                     r7,a
1FF0 7006           4987                                                     jnz                     nextmin
1FF2 E583           4988                                                     mov                     a,dph
1FF4 9E             4989                                                     subb            a,r6
1FF5 FE             4990                                                     mov                     r6,a
1FF6 601D           4991                                                     jz                      outmin;
                    4992                                                     
                    4993                                                     ;продолжаем сравнение
                    4994                                                     ;;;;;;;;;;;             
1FF8 78B8           4995     nextmin:        mov                     r0,#work
1FFA 120000   F     4996                                             call            resar2
                    4997                                             ;call           altof;->float;r2..r5
1FFD 120000   F     4998                                             call            move28;->r8..r11
2000 120000   F     4999                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5000     
2003 120402         5001                                             call            altof;->float;r2..r5
                    5002                                             
2006 1201D6         5003                                             call            flcmp
2009 5005           5004                                             jnc                     nomini
200B 78B8           5005                                             mov                     r0,#work;<
200D 120000   F     5006                                             call            saver2;r2..r5
2010 78D6           5007     nomini:                 mov                     r0,#chblok;volume;кол измерений блока
2012 06             5008                                             inc                     @r0
2013 80AE           5009                                             jmp                     ming
                    5010     
2015 78B8           5011     outmin:         mov                     r0,#work;1ое измерение блока
2017 120000   F     5012                                             call            resar2
                    5013                                     ;       call            altof;->float;r2..r5
201A 120000   F     5014                                             call            move28;->r8..r11
201D 120000   F     5015                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5016     
2020 120402         5017                                             call            altof;->float;r2..r5
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    80

                    5018                                             
2023 1201D6         5019                                             call            flcmp
2026 5005           5020                                             jnc                     minivix
2028 78B8           5021                                             mov                     r0,#work;<
202A 120000   F     5022                                             call            saver2;r2..r5
                    5023                                             ;;;;;;;;;
                    5024     
202D 78B8           5025     minivix:        mov                     r0,#work
202F 120000   F     5026                                             call            resar2
                    5027     
                    5028                                             ;call           altof;->float
                    5029                                     
2032 900000   F     5030                                             mov                     dptr,#ch_10      
2035 120000   F     5031                                             call            ldc_ltemp
2038 1202B7         5032                                             call            fldiv
203B 120343         5033                                             call            ftol                            ;->
                             hex
                    5034                                             ;;;
203E 120000   F     5035                                             call            maform
2041 784F           5036                                             mov                     r0,#abin
2043 120000   F     5037                                             call            saver2
                    5038     ;;;;;;;;
                    5039                                             
2046 7853           5040                                             mov             r0,#adec
2048 7952           5041                                             mov             r1,#abin+3      ;hex->10
204A 120000   F     5042                                             call    bindec
                    5043                                     
204D 785C           5044                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
204F 7949           5045                                             mov             r1,#bufind+9
2051 7F05           5046                                             mov             r7,#5
2053 E6             5047     bufmin:                         mov             a,@r0
2054 2430           5048                                             add             a,#30h
2056 F7             5049                                             mov             @r1,a
2057 19             5050                                             dec             r1
2058 18             5051                                             dec             r0
2059 DFF8           5052                                             djnz    r7,bufmin
205B 7844           5053                                             mov             r0,#bufind+4
205D 762B           5054                                             mov             @r0,#2bh          
205F 300202         5055                                             jnb             znmat,nozmin
2062 762D           5056                                             mov             @r0,#2dh
2064 434B05         5057     nozmin:         orl             bufind+11,#05h
2067 22             5058                                             ret
                    5059     
                    5060     
                    5061     
                    5062     ;мин значение по по блоку
2068                5063     vichmax:        
2068 120000   F     5064                                             call            resa_hl;save_bl->dptr
                    5065                                             
                    5066                                             
                    5067     ;с конца блока адрес 2го измерение
206B 120000   F     5068                                             call            min4_hl
                    5069                                             
206E 78B8           5070                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    5071                                             
2070 E0             5072                                             movx            a,@dptr
2071 F6             5073                                             mov                     @r0,a
2072 08             5074                                             inc                     r0
2073 A3             5075                                             inc                     dptr
2074 E0             5076                                             movx            a,@dptr
2075 F6             5077                                             mov                     @r0,a
2076 08             5078                                             inc                     r0
2077 A3             5079                                             inc                     dptr
2078 E0             5080                                             movx            a,@dptr
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    81

2079 F6             5081                                             mov                     @r0,a
207A 08             5082                                             inc                     r0
207B A3             5083                                             inc                     dptr
207C E0             5084                                             movx            a,@dptr
207D F6             5085                                             mov                     @r0,a
207E A3             5086                                             inc                     dptr
                    5087                                             
207F 78B8           5088                                             mov                     r0,#work
2081 120000   F     5089                                             call            resar2
2084 120402         5090                                             call            altof;->float;r2..r5
2087 78B8           5091                                             mov                     r0,#work
2089 120000   F     5092                                             call            saver2
                    5093     
208C 120000   F     5094                                             call            min4_hl
                    5095                                     ;       call            min4_hl
                    5096     
208F 78D7           5097                                             mov                     r0,#copy_hl
2091 E583           5098                                             mov                     a,dph
2093 F6             5099                                             mov                     @r0,a
2094 08             5100                                             inc                     r0
2095 E582           5101                                             mov                     a,dpl
2097 F6             5102                                             mov                     @r0,a
                    5103                                     
2098 78D6           5104                                             mov                     r0,#chblok;volume
209A 7600           5105                                             mov                     @r0,#0
209C 120000   F     5106     maxg:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
209F E582           5107                                             mov                     a,dpl
20A1 FF             5108                                             mov                     r7,a
20A2 E583           5109                                             mov                     a,dph
20A4 FE             5110                                             mov                     r6,a
                    5111     
20A5 78D7           5112                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
20A7 E6             5113                                             mov                     a,@r0
20A8 F583           5114                                             mov                     dph,a
20AA 08             5115                                             inc                     r0
20AB E6             5116                                             mov                     a,@r0
20AC F582           5117                                             mov                     dpl,a
                    5118                                             
20AE C3             5119                                             clr                     c;-4
20AF E582           5120                                             mov                     a,dpl
20B1 9404           5121                                             subb            a,#4
20B3 F582           5122                                             mov                     dpl,a
20B5 E583           5123                                             mov                     a,dph
20B7 9400           5124                                             subb            a,#0
20B9 F583           5125                                             mov                     dph,a;dptr-4
                    5126                                             ;;;;;;;;
20BB 79D7           5127                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
20BD E583           5128                                                     mov             a,dph
20BF F7             5129                                               mov           @r1,a
20C0 09             5130                                                     inc             r1
20C1 E582           5131                                                     mov             a,dpl
20C3 F7             5132                                                     mov             @r1,a
                    5133                                                     ;;;;;;;;;
20C4 C3             5134                                                     clr             c;пришли в начало блока?
20C5 E582           5135                                                     mov                     a,dpl
20C7 9F             5136                                                     subb            a,r7
20C8 FF             5137                                                     mov                     r7,a
20C9 7006           5138                                                     jnz                     nextmax
20CB E583           5139                                                     mov                     a,dph
20CD 9E             5140                                                     subb            a,r6
20CE FE             5141                                                     mov                     r6,a
20CF 601D           5142                                                     jz                      outmax;
                    5143                                                     
                    5144                                                     ;продолжаем сравнение
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    82

                    5145                                                     ;;;;;;;;;;;             
20D1 78B8           5146     nextmax:        mov                     r0,#work
20D3 120000   F     5147                                             call            resar2
                    5148                                             ;call           altof;->float;r2..r5
20D6 120000   F     5149                                             call            move28;->r8..r11
20D9 120000   F     5150                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5151     
20DC 120402         5152                                             call            altof;->float;r2..r5
                    5153                                             
20DF 1201D6         5154                                             call            flcmp
20E2 4005           5155                                             jc                      nomaxi
20E4 78B8           5156                                             mov                     r0,#work;>
20E6 120000   F     5157                                             call            saver2;r2..r5
20E9 78D6           5158     nomaxi:                 mov                     r0,#chblok;volume;кол измерений блока
20EB 06             5159                                             inc                     @r0
20EC 80AE           5160                                             jmp                     maxg
20EE 78B8           5161     outmax:         mov                     r0,#work;1ое измерение блока
20F0 120000   F     5162                                             call            resar2
                    5163                                     ;       call            altof;->float;r2..r5
20F3 120000   F     5164                                             call            move28;->r8..r11
20F6 120000   F     5165                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5166     
20F9 120402         5167                                             call            altof;->float;r2..r5
                    5168                                             
20FC 1201D6         5169                                             call            flcmp
20FF 4005           5170                                             jc                      maxvix
2101 78B8           5171                                             mov                     r0,#work;>
2103 120000   F     5172                                             call            saver2;r2..r5
                    5173                                             ;;;;;;;;;
                    5174     
2106 020000   F     5175     maxvix:         jmp             minivix
                    5176     
                    5177     
2109 78CF           5178     bufl_dec:       mov                     r0,#chbuf       
210B 120000   F     5179                                             call            resar2  
210E 900000   F     5180                                             mov                     dptr,#ch_1       
2111 120000   F     5181                                             call            ldc_ltemp
2114 1201D1         5182                                             call            flsub
2117 78CF           5183                                             mov                     r0,#chbuf       
2119 120000   F     5184                                             call            saver2  
211C 22             5185                                             ret
                    5186     
                    5187     ;прерывание таймера Т2
211D                5188     inter2:         
211D E5DA           5189                                             mov             a,PCA0CPM0
211F 54BF           5190                                             anl             a,#0bfh                         
2121 F5DA           5191                                             mov             PCA0CPM0,a
                    5192                                             ;mov            a,T2CON         ;T2CON.2=0
                    5193                                             ;anl            a,#0fbh
2123 75C800         5194                                             mov             T2CON,#00;a
2126 C2AD           5195                                             clr             IE.5
2128 32             5196                                             reti
                    5197     ;$include (d:\amp\subr7.asm) 
                +1  5198     
                +1  5199     ;тест интерфейса
2129            +1  5200     testrs: ;jb     p0.3,goprogr
2129 C2AC       +1  5201                                     clr     IE.4
212B 759955     +1  5202     test1:  mov     SBUF0,#55h
212E 3099FD     +1  5203                                     jnb     SCON0.1,$
2131 78B8       +1  5204                                     mov     r0,#work;chtest
2133 76BE       +1  5205                                     mov     @r0,#190d;60
                +1  5206     
2135 309825     +1  5207     test01: jnb     SCON0.0,test2
2138 E599       +1  5208                                     mov     a,SBUF0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    83

213A B45512     +1  5209                                     cjne    a,#55h,test3
213D C299       +1  5210     test4:  clr     SCON0.1
213F C298       +1  5211                                     clr     SCON0.0
2141 7D0A       +1  5212                                     mov     r5,#10
2143 7840       +1  5213                                     mov     r0,#bufind              ;- - - -
2145 762D       +1  5214     test04: mov     @r0,#2dh
2147 08         +1  5215                                     inc     r0
2148 DDFB       +1  5216                                     djnz    r5,test04
214A 120000   F +1  5217                                     call    ind
214D 80DC       +1  5218                                     jmp     test1
214F            +1  5219     test3:  
214F 753933     +1  5220                                     mov     nuerr,#33h
2152 120000   F +1  5221                                     call    error           ;на кран прибора ERR 3
                +1  5222                             
2155 120000   F +1  5223                                     call    ind;
2158 120000   F +1  5224                                     call    z_01s           ;100ms
215B 80E0       +1  5225                                     jmp     test4
215D 78B8       +1  5226     test2:  mov     r0,#work;chtest
215F B60002     +1  5227                                     cjne    @r0,#0,test02
2162 8003       +1  5228                                     jmp     test5
2164 16         +1  5229     test02: dec     @r0
2165 80CE       +1  5230                                     jmp     test01
2167 120000   F +1  5231     test5:  call    z_1ms           ;1ms
216A C299       +1  5232                                     clr     SCON0.1
                +1  5233             
216C 753933     +1  5234                                     mov     nuerr,#33h
216F 120000   F +1  5235                                     call    error           ;на кран прибора ERR 3
                +1  5236                                     
2172 120000   F +1  5237                                     call    ind
2175 120000   F +1  5238                                     call    z_01s           ;100ms
2178 80B1       +1  5239                                     jmp     test1   
                +1  5240     
                +1  5241     
                +1  5242     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
217A 75E700     +1  5243      ind:   mov             EIE2,#00H;mov   IE,#00h
217D 120000   F +1  5244                     call    mign
2180 7840       +1  5245                      mov            r0,#bufind;+11
2182 7F0C       +1  5246                      mov            r7,#12
2184 C287       +1  5247      nexin: clr             p0.7;6
2186 E6         +1  5248                     mov             a,@r0
2187 F59B       +1  5249                     mov             SPI0DAT,a
2189 20FBFD     +1  5250                     jb              TXBSY,$
218C D287       +1  5251                     setb    p0.7;6
218E 120000   F +1  5252                     call    z_9             ;25mks
2191 08         +1  5253                     inc             r0;dec          r0
2192 DFF0       +1  5254                     djnz    r7,nexin
2194 75E730     +1  5255                     mov             EIE2,#30H;mov   IE,#80h
2197 22         +1  5256                ret
                +1  5257     
                +1  5258     
2198 7A08       +1  5259     zapadc:   mov R2,#8
219A D297       +1  5260     sdv:      setb P1.7
219C 33         +1  5261               rlc A
219D 9296       +1  5262                     mov P1.6,C
219F 120000   F +1  5263                     call tim2
                +1  5264                                     
21A2 C297       +1  5265                     clr P1.7
21A4 120000   F +1  5266                     call tim2
21A7 DAF1       +1  5267                     djnz R2,sdv
21A9 D296       +1  5268                     setb P1.6
21AB 22         +1  5269                     ret
                +1  5270     
21AC 7A08       +1  5271     chtadc:   mov R2,#8
21AE D297       +1  5272     sdv1:     setb P1.7
21B0 120000   F +1  5273               call tim2
21B3 C297       +1  5274                     clr P1.7
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    84

21B5 A296       +1  5275                     mov C,P1.6
21B7 33         +1  5276                     rlc A
21B8 120000   F +1  5277                     call tim2
21BB DAF1       +1  5278                     djnz R2,sdv1
21BD 22         +1  5279                     ret
                +1  5280     
21BE 7E30       +1  5281     tim:      mov R6,#30h;38h
21C0 DEFE       +1  5282     tim1:     djnz R6,tim1
21C2 22         +1  5283               ret
                +1  5284               
21C3 7E10       +1  5285     tim2:     mov R6,#10h;14h
21C5 DEFE       +1  5286     tim3:     djnz R6,tim3
21C7 22         +1  5287               ret
                +1  5288     
                +1  5289     ;запись из acc
21C8 C3         +1  5290     write_x1: clr   c
21C9            +1  5291     writeD_x1:
21C9 92B1       +1  5292                       mov P3.1,c        ;запись
21CB F5A0       +1  5293               mov P2,A
21CD D2B3       +1  5294                       setb P3.3
21CF 120000   F +1  5295                       call z_5
21D2 C2B3       +1  5296                       clr P3.3
21D4 75A0FF     +1  5297                       mov P2,#0FFh
21D7 22         +1  5298                       ret
                +1  5299     
                +1  5300     ;чтение в acc
21D8 C3         +1  5301     read_x2:  clr   c  
21D9 92B1       +1  5302               mov P3.1,c        ;чтение
21DB D2B2       +1  5303               setb P3.2
21DD D2B3       +1  5304                       setb P3.3
21DF 120000   F +1  5305                     call z_5
21E2 E5A0       +1  5306                       mov A,P2
21E4 C2B3       +1  5307                       clr P3.3
21E6 C2B2       +1  5308                       clr P3.2
21E8 22         +1  5309                       ret
                +1  5310     
                +1  5311     
21E9 120000   F +1  5312     loop:     call read_x2;x2    ;ожидание флага готовности
21EC 20E7FA     +1  5313                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
21EF 22         +1  5314                        ret           ;возврат, если бит А(7)<>1
                +1  5315                                      
                +1  5316                                        
                +1  5317     
                +1  5318     
                +1  5319     
                +1  5320     
                +1  5321     
                +1  5322     
                +1  5323     
                +1  5324     ;принимаемый байт в acc
                +1  5325     ;прием байта последовательным кодом старшими разрядами вперед
21F0 7A08       +1  5326     read:    mov R2,#8
21F2 C297       +1  5327     re1:     clr P1.7;P1.2
21F4 120000   F +1  5328              call tim2        ;5mks
21F7 A294       +1  5329                     mov C,P1.4;P1.0
21F9 33         +1  5330                     rlc A           
21FA D297       +1  5331                     setb P1.7;P1.2
21FC 120000   F +1  5332                     call tim2
21FF DAF1       +1  5333                     djnz R2,re1
2201 22         +1  5334                     ret
                +1  5335     
                +1  5336      ;in r0-count   
                +1  5337     ;r10,r11-значение с котоым сравнивается счетчик
                +1  5338     ;r2..r5 -значение счетчика
2202            +1  5339     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
2202 E6         +1  5340                     mov                     a,@r0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    85

2203 FC         +1  5341                     mov                     r4,a
2204 08         +1  5342                     inc                     r0
2205 E6         +1  5343                     mov                     a,@r0
2206 FD         +1  5344                     mov                     r5,a
2207 7B00       +1  5345                     mov                     r3,#0
2209 7A00       +1  5346                     mov                     r2,#0
220B 750800     +1  5347                     mov                     r8,#0;clr                       r8
220E 750900     +1  5348                     mov                     r9,#0;clr                       r9
2211 120000   F +1  5349                     call            lcmp
2214 22         +1  5350                     ret
                +1  5351     
                +1  5352     
                +1  5353     ;in-r1-count
2215            +1  5354     chdec:          ;mov            r1,#chavt               ;chavt-1
2215 E7         +1  5355                             mov             a,@r1
2216 FC         +1  5356                             mov             r4,a
2217 09         +1  5357                             inc             r1
2218 E7         +1  5358                             mov             a,@r1
2219 FD         +1  5359                             mov             r5,a
221A C202       +1  5360                             clr             rr2
221C C203       +1  5361                             clr             rr3
221E 900000   F +1  5362                             mov             dptr,#ch1        
2221 120000   F +1  5363                             call    ldc_ltemp
2224 120000   F +1  5364                             call    lsub
2227 ED         +1  5365                             mov             a,r5
2228 F7         +1  5366                             mov             @r1,a
2229 19         +1  5367                             dec             r1
222A EC         +1  5368                             mov             a,r4
222B F7         +1  5369                             mov             @r1,a
                +1  5370                             
222C 22         +1  5371                             ret      
                +1  5372     
                +1  5373     
                +1  5374     
                +1  5375     
222D            +1  5376     loadUS: ;если идет тест измерения ус восстановить для теста
222D 201533     +1  5377                                     jb              biteizm,yestest
2230 79AE       +1  5378                                             mov             r1,#diap
2232 E7         +1  5379                             mov             a,@r1
2233 23         +1  5380                             rl              a;*2
2234 FC         +1  5381                             mov             r4,a                    ;save a
2235 900000   F +1  5382                             mov             dptr,#tabus
2238 93         +1  5383                             movc    a,@a+dptr
2239 FA         +1  5384                             mov             r2,a                    ;high byte
223A E584       +1  5385                             mov             a,p4
223C 5401       +1  5386                             anl             a,#01
223E 4A         +1  5387                             orl             a,r2
223F F584       +1  5388                             mov             p4,a
2241 0C         +1  5389                             inc             r4
2242 EC         +1  5390                             mov             a,r4
2243 93         +1  5391                             movc    a,@a+dptr
2244 FB         +1  5392                             mov             r3,a                    ;low byte
2245 E585       +1  5393                             mov             a,p5
2247 5401       +1  5394                             anl             a,#01
2249 4B         +1  5395                             orl             a,r3
224A F585       +1  5396                             mov             p5,a
224C 799A       +1  5397                             mov             r1,#parT
224E B7010E     +1  5398                             cjne    @r1,#1,bret
2251 79AE       +1  5399                             mov             r1,#diap                  ;10s (parT=1)
2253 7405       +1  5400                             mov             a,#5                      ;10-8..10-11 p4.1=1
2255 C3         +1  5401                             clr             c
2256 97         +1  5402                             subb    a,@r1
2257 5006       +1  5403                             jnc             bret
2259 E584       +1  5404                             mov             a,p4
225B 4402       +1  5405                             orl             a,#02
225D F584       +1  5406                             mov             p4,a                     ;10-8..10-11 p4.1=1
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    86

225F 120000   F +1  5407     bret:      call          louizm         ;us если вкл кн ИЗМЕР
2262 22         +1  5408                             ret
2263            +1  5409     yestest:
2263 120000   F +1  5410                             call            lotpus          ;ус теста измерения
2266 22         +1  5411                             ret
                +1  5412                             
                +1  5413     ;загр ус для кор 0
                +1  5414     ;dptr-
2267 E4         +1  5415     lospus:         clr             a
                +1  5416                             ;movc   a,@a+dptr
                +1  5417                             ;mov            r2,a                    ;high byte
                +1  5418                             ;mov            a,p4
                +1  5419                             ;anl            a,#01
                +1  5420                             ;orl            a,r2
                +1  5421                             ;mov            p4,a
                +1  5422                             ;inc            dptr
2268 E4         +1  5423                             clr             a
2269 93         +1  5424                             movc    a,@a+dptr
226A FB         +1  5425                             mov             r3,a                    ;low byte
226B E585       +1  5426                             mov             a,p5
226D 54BF       +1  5427                             anl             a,#0bfh;01
226F 4B         +1  5428                             orl             a,r3
2270 F585       +1  5429                             mov             p5,a
2272 22         +1  5430                             ret
                +1  5431     
2273 80         +1  5432     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                +1  5433     
                +1  5434     ;us кнопка измерения выкл
2274 88D6       +1  5435     tabus:     db           88h,0d6h         ;10-2
2276 88F6       +1  5436                             db      88h,0f6h         ;10-3
2278 88D6       +1  5437                             db              88h,0d6h         ;10-4
227A 88F6       +1  5438                             db              88h,0f6h         ;10-5
227C 9AD6       +1  5439                             db      9ah,0d6h         ;10-6
227E 9AF6       +1  5440                             db              9ah,0f6h         ;10-7
2280 ACD6       +1  5441                             db              0ach,0d6h        ;10-8
2282 ACF6       +1  5442                             db      0ach,0f6h        ;10-9
2284 C8D6       +1  5443                             db              0c8h,0d6h        ;10-10
2286 C8F6       +1  5444                             db              0c8h,0f6h        ;10-11
                +1  5445     
2288            +1  5446     tabt11: 
2288 66E6       +1  5447                             db              66h,0e6h;10-11
228A            +1  5448     tabt9:  
228A 32E6       +1  5449                             db              32h,0e6h;10-9
228C            +1  5450     tabt7:  
228C 18EE       +1  5451                             db              18h,0eeh;10-7
                +1  5452     
                +1  5453      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  5454     ;в зав от parT (Tизм)
228E 79B7       +1  5455     loadT:          mov             r1,#load;parT
2290 7840       +1  5456     lolevT:         mov             r0,#bufind+0
2292 7B0A       +1  5457                             mov             r3,#10
2294 75F00A     +1  5458                             mov             b,#10
2297 E7         +1  5459                             mov             a,@r1
2298 A4         +1  5460                             mul             ab
2299 FC         +1  5461                             mov             r4,a                    ;save a
229A 900000   F +1  5462                             mov             dptr,#textT
229D 93         +1  5463             lod1:   movc    a,@a+dptr
229E F6         +1  5464                             mov             @r0,a
229F 08         +1  5465                             inc             r0
22A0 0C         +1  5466                             inc             r4
22A1 EC         +1  5467                             mov             a,r4
22A2 DBF9       +1  5468                             djnz    r3,lod1
22A4 534B03     +1  5469                             anl                     bufind+11,#03h          ;гашение точек
22A7 22         +1  5470                             ret     
                +1  5471     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  5472     ;dptr-адр строки текста         
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    87

22A8            +1  5473     lotext:         
22A8 7B0A       +1  5474                             mov             r3,#10
22AA 7840       +1  5475                             mov             r0,#bufind+0
22AC E4         +1  5476     lodt:           clr             a
22AD 93         +1  5477                             movc    a,@a+dptr
22AE F6         +1  5478                             mov             @r0,a
22AF 08         +1  5479                             inc             r0
22B0 A3         +1  5480                             inc             dptr
22B1 DBF9       +1  5481                             djnz    r3,lodt
22B3 534B03     +1  5482                             anl                     bufind+11,#03h          ;гашение точек
22B6 22         +1  5483                             ret                                     
                +1  5484     
                +1  5485     
                +1  5486     
                +1  5487     
                +1  5488      ;задержка 100 мкс
22B7 7978       +1  5489     z_100:    mov R1,#78h     ;загрузка первого числа
22B9 7A02       +1  5490     z100:     mov R2,#2h     ;загрузка второго числа
22BB DAFE       +1  5491     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
22BD D9FA       +1  5492               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
22BF 22         +1  5493               ret           
                +1  5494     
                +1  5495     ;задержка 34 мкс
22C0 7B8B       +1  5496     z_5:      mov R3,#8Bh      ;загрузка числа
22C2 DBFE       +1  5497     ct:       djnz R3,ct
22C4 22         +1  5498               ret
                +1  5499     
                +1  5500     ;задержка 15 мс
22C5 79FA       +1  5501     z_15:     mov R1,#0FAh    ;загрузка первого числа
22C7 7AED       +1  5502     z15:      mov R2,#0EDh   ;загрузка второго числа
22C9 DAFE       +1  5503     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
22CB D9FA       +1  5504               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
22CD 22         +1  5505               ret   
                +1  5506                                               
                +1  5507      ;задержка 1 мс
22CE 7910       +1  5508     z_1ms:     mov R1,#10h     
22D0 7AED       +1  5509     ss1:       mov R2,#0EDh    
22D2 DAFE       +1  5510                djnz R2, $    
22D4 D9FA       +1  5511                djnz R1, ss1   
22D6 22         +1  5512                ret   
                +1  5513     
                +1  5514      ;????????
                +1  5515     ;задержка 1с
22D7 7D1F       +1  5516     z_1s:   mov             r5,#01fh 
22D9 7EFF       +1  5517     co2s:   mov     R6,#0ffh     
22DB 7FFF       +1  5518     z1s:     mov    R7,#0ffh     
22DD DFFE       +1  5519     co1s:   djnz    R7, co1s        
22DF DEFA       +1  5520             djnz    R6, z1s 
22E1 DDF6       +1  5521                     djnz    r5,co2s
22E3 22         +1  5522               ret
                +1  5523     ;задержка 0,1с
22E4 7D03       +1  5524     z_01s:           mov            r5,#03h 
22E6 7EFF       +1  5525     co02s:          mov     R6,#0ffh     
22E8 7FFF       +1  5526     z01s:           mov     R7,#0ffh     
22EA DFFE       +1  5527                             djnz    R7, $   
22EC DEFA       +1  5528                     djnz    R6, z01s 
22EE DDF6       +1  5529                             djnz    r5,co02s
22F0 22         +1  5530                      ret
                +1  5531                                               
                +1  5532     ;задержка 0,5с
22F1 7D0D       +1  5533     z_05s:           mov            r5,#0dh 
22F3 7EFF       +1  5534     co05s:                  mov     R6,#0ffh     
22F5 7FFF       +1  5535     z05s:           mov     R7,#0ffh     
22F7 DFFE       +1  5536                                     djnz    R7, $   
22F9 DEFA       +1  5537                     djnz    R6, z05s 
22FB DDF6       +1  5538                                             djnz    r5,co05s
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    88

22FD 22         +1  5539                      ret                                                     
                +1  5540                                                               
22FE 000007FF   +1  5541     chzap:  db      00,00,07h,0ffh             
2302 00000000   +1  5542     ch0:    db      00,00,00,00
2306 0000000A   +1  5543     ch10:   db      00,00,00,0ah                            ;10
230A 00000005   +1  5544     ch5:    db      00,00,00,05                                             ;5
230E 00000004   +1  5545     ch4:    db      00,00,00,04                                             ;4
2312 000003B9   +1  5546     ch954:  db 00,00,03,0b9h                                                ;954
2316 000003E8   +1  5547     ch10000:        db 00,00,03h,0e8h                                               ;10000
231A 00000064   +1  5548     ch100:  db 00,00,00,64h ;100
231E 00000002   +1  5549     ch2:    db      00,00,00,02                                             
                +1  5550     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  5551     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  5552     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
2322 00000001   +1  5553     ch1:    db  00,00,00,01
2326 49742400   +1  5554     ch_mln: db      49h,74h,24h,00;10*6
232A 3F800000   +1  5555     ch_1:   db      3fh,80h,00,00   
232E 40000000   +1  5556     ch_2:   db      40h,00,00,00;2
2332 40800000   +1  5557     ch_4:   db      40h,80h,00,00;4 
2336 40A00000   +1  5558     ch_5:   db      40h,0a0h,00,00;5
233A 40E00000   +1  5559     ch_7:   db      40h,0e0h,00,00;7
                +1  5560             
233E 3F741EDF   +1  5561     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
2342 47C35000   +1  5562     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
2346 3F800347   +1  5563     KD:             db      3fh,80h,03h,47h;1,0001
234A 48435000   +1  5564     CH2tho: db      48h,43h,50h,00;200000
234E 4856D800   +1  5565     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
2352 4856D800   +1  5566     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
2356 461C4000   +1  5567     ch_10th:db  46h,1ch,40h,00;10000-2710h
235A 41200000   +1  5568     ch_10:  db      41h,20h,00,00;10d
235E 48742400   +1  5569     ch_250: db      48h,74h,24h,00;250000
2362 000186A0   +1  5570     chk:            db      00,01,86h,0a0h;
2366 00000320   +1  5571     ch320h: db      00,00,03h,20h;320h=800d
236A 00000150   +1  5572     ch150h: db      00,00,01h,50h;150h
236E C0400000   +1  5573     ch_m3:  db      0c0h,40h,00,00;-3
                +1  5574     
                +1  5575     
                +1  5576     ;r1- мл байт 2х байтного числа
2372            +1  5577     tenmin:         ;-10
2372 C3         +1  5578                             clr             c
2373 E7         +1  5579                     mov             a,@r1
2374 9405       +1  5580                             subb    a,#5;10
2376 F7         +1  5581                             mov             @r1,a
2377 19         +1  5582                             dec             r1
2378 E7         +1  5583                             mov             a,@r1
2379 9400       +1  5584                             subb    a,#0
237B F7         +1  5585                             mov             @r1,a
237C 22         +1  5586                             ret
                +1  5587       ;r0-обнуление ячеек памяти  
237D 7F04       +1  5588       clear4:        mov    r7,#4
237F E4         +1  5589                             clr             a
2380 F6         +1  5590       cl4:          mov             @r0,a
2381 08         +1  5591                             inc             r0
2382 DFFC       +1  5592                             djnz    r7,cl4
2384 22         +1  5593                             ret     
                +1  5594     
                +1  5595      ;r0-обнуление ячеек памяти 
                +1  5596      ;R7- 
2385            +1  5597       clearN:        
2385 E4         +1  5598                             clr             a
2386 F6         +1  5599       cl4N:         mov             @r0,a
2387 08         +1  5600                             inc             r0
2388 DFFC       +1  5601                             djnz    r7,cl4N
238A 22         +1  5602                             ret     
                +1  5603     
                +1  5604       ;чтение номера байта с индикатора(2байта)
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    89

                +1  5605     ;bufind+8..bufind+9
                +1  5606     ;-  - - -
                +1  5607     ;- - - - - - - - - -
                +1  5608     ;adec..adec+9
                +1  5609     ;ст            мл
238B 7848       +1  5610     upak2:  mov             r0,#bufind+8;
238D 795C       +1  5611                     mov             r1,#adec+9
238F 7F02       +1  5612                     mov             r7,#2;2bait
2391 C3         +1  5613     upa2:   clr             c
2392 E6         +1  5614                     mov             a,@r0
2393 9430       +1  5615                     subb    a,#30h
2395 F7         +1  5616                     mov             @r1,a
2396 18         +1  5617                     dec             r0
2397 19         +1  5618                     dec             r1
2398 DFF7       +1  5619                     djnz    r7,upa2
239A 22         +1  5620                     ret  
                +1  5621     
                +1  5622     
                +1  5623         
                +1  5624      ;bufind+4..bufind+9
                +1  5625     ;-  - - -
                +1  5626     ;- - - - - - - - - -
                +1  5627     ;adec..adec+9
                +1  5628     ;ст            мл
239B 7849       +1  5629     upak:   mov             r0,#bufind+9;
239D 795C       +1  5630                     mov             r1,#adec+9
239F 7F06       +1  5631                     mov             r7,#6
23A1 C3         +1  5632     upa:    clr             c
23A2 E6         +1  5633                     mov             a,@r0
23A3 9430       +1  5634                     subb    a,#30h
23A5 F7         +1  5635                     mov             @r1,a
23A6 18         +1  5636                     dec             r0
23A7 19         +1  5637                     dec             r1
23A8 DFF7       +1  5638                     djnz    r7,upa
23AA 22         +1  5639                     ret
                +1  5640     
                +1  5641      ;чтение номера байта с индикатора(3байта)
                +1  5642     ;bufind+3..bufind+9
                +1  5643     ;-  - - -
                +1  5644     ;- - - - - - - - - -
                +1  5645     ;adec..adec+9
                +1  5646     ;ст            мл
23AB 7849       +1  5647     upak3:  mov             r0,#bufind+9;
23AD 795C       +1  5648                     mov             r1,#adec+9
23AF 7F03       +1  5649                     mov             r7,#3;3bait
23B1 C3         +1  5650     upa1:   clr             c
23B2 E6         +1  5651                     mov             a,@r0
23B3 9430       +1  5652                     subb    a,#30h
23B5 F7         +1  5653                     mov             @r1,a
23B6 18         +1  5654                     dec             r0
23B7 19         +1  5655                     dec             r1
23B8 DFF7       +1  5656                     djnz    r7,upa1
23BA 22         +1  5657                     ret
                +1  5658     
                +1  5659     ;вых-r2,r3-адрес ячее памяти прогр
23BB            +1  5660     findkoef:
23BB 79AE       +1  5661                                     mov             r1,#diap
23BD E7         +1  5662                                     mov             a,@r1
23BE 23         +1  5663                                     rl              a                                          
                                          ;diap*2(2bait )
23BF FC         +1  5664                                     mov             r4,a                                    ;sa
                             ve
23C0 900000   F +1  5665                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  5666                                     
23C3 93         +1  5667                                     movc    a,@a+dptr                       ;ст байт
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    90

23C4 FA         +1  5668                                     mov             r2,a
23C5 A3         +1  5669                                     inc             dptr
23C6 EC         +1  5670                                     mov             a,r4
23C7 93         +1  5671                                     movc    a,@a+dptr
23C8 FB         +1  5672                                     mov             r3,a                    ;мл байт
23C9 22         +1  5673                                     ret
                +1  5674     ;r2..r5 в опр яч внешн озу
23CA            +1  5675     findext:
23CA 79AE       +1  5676                                     mov             r1,#diap
23CC E7         +1  5677                                     mov             a,@r1
23CD 23         +1  5678                                     rl              a                                          
                                          ;diap*2(2bait )
23CE 23         +1  5679                                     rl              a                                          
                                          ;diap*2(2bait )
23CF F9         +1  5680                                     mov             r1,a                                    ;r1
                             -номер ячейки внешнего озу
                +1  5681                                     
23D0 22         +1  5682                                     ret
                +1  5683     
                +1  5684     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  5685     ;(5000h..5027h)
23D1 5000       +1  5686     diKDw:  dw              5000h                   ;10-2
23D3 5004       +1  5687                                     dw              5004h                   ;10-3
23D5 5008       +1  5688                                     dw              5008h                   ;10-4
23D7 500C       +1  5689                                     dw              500ch                   ;10-5
23D9 5010       +1  5690                                     dw              5010h                   ;10-6
23DB 5014       +1  5691                                     dw              5014h                   ;10-7
23DD 5018       +1  5692                                     dw              5018h                   ;10-8
23DF 501C       +1  5693                                     dw              501ch                   ;10-9
23E1 5020       +1  5694                                     dw              5020h                   ;10-10
23E3 5024       +1  5695                                     dw              5024h                   ;10-11
23E5 5028       +1  5696     dipar:  dw              5028h                   ;parol
23E7 502C       +1  5697     diKm:           dw              502ch                   ;Km для теста измерения
23E9 000186A0   +1  5698     chthou: db      00,01,86h,0a0h  ;100.000
                +1  5699     
23ED AA08       +1  5700     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
23EF AB09       +1  5701                                             mov     r3,ltemp+1
23F1 AC0A       +1  5702                                             mov     r4,ltemp+2
23F3 AD0B       +1  5703                                             mov     r5,ltemp+3
23F5 22         +1  5704                                             ret
                +1  5705     ;bufind+4..bufind+9
                +1  5706     ;-  - - -
                +1  5707     ;- - - - - - - - - -
                +1  5708     ;adec..adec+9
                +1  5709     ;ст            мл
23F6 7847       +1  5710     upakA:  mov             r0,#bufind+7;
23F8 795C       +1  5711                     mov             r1,#adec+9
23FA 7F04       +1  5712                     mov             r7,#4
23FC C3         +1  5713     upaa4:  clr             c
23FD E6         +1  5714                     mov             a,@r0
23FE 9430       +1  5715                     subb    a,#30h
2400 F7         +1  5716                     mov             @r1,a
2401 18         +1  5717                     dec             r0
2402 19         +1  5718                     dec             r1
2403 DFF7       +1  5719                     djnz    r7,upaa4
2405 22         +1  5720                     ret
                +1  5721     
                +1  5722     ;bufind+4..bufind+9
                +1  5723     ;-  - - -
                +1  5724     ;- - - - - - - - - -
                +1  5725     ;adec..adec+9
                +1  5726     ;ст            мл
2406 7848       +1  5727     upakB:  mov             r0,#bufind+8;
2408 795C       +1  5728                     mov             r1,#adec+9
240A 7F05       +1  5729                     mov             r7,#5
240C C3         +1  5730     upab:   clr             c
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    91

240D E6         +1  5731                     mov             a,@r0
240E 9430       +1  5732                     subb    a,#30h
2410 F7         +1  5733                     mov             @r1,a
2411 18         +1  5734                     dec             r0
2412 19         +1  5735                     dec             r1
2413 DFF7       +1  5736                     djnz    r7,upab
2415 C21B       +1  5737                     clr                     bitznB
2417 E543       +1  5738                     mov             a,bufind+3
2419 B42D02     +1  5739                     cjne            a,#2dh,abret
241C D21B       +1  5740                     setb            bitznB
241E            +1  5741     abret:
241E 22         +1  5742                     ret
241F            +1  5743     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
241F 4E6E6AA8   +1  5744                                             db      4eh,6eh,6ah,0a8h;10**9
2423 43FA0000   +1  5745     CH_500:         db              43h,0fah,00,00;1fah=500
2427 4856D800   +1  5746     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
242B 49742400   +1  5747     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  5748     
                +1  5749     
                +1  5750     
                +1  5751     ;управление AD7731
                +1  5752     ;r4=b1 r5=b2
242F            +1  5753     iniacp: ;управление AD7731
242F 7403       +1  5754                             mov             a,#03
                +1  5755     
2431 120000   F +1  5756                             call    write
2434 EC         +1  5757                             mov             a,r4;#80h
2435 120000   F +1  5758                             call    write
2438 ED         +1  5759                             mov             a,r5;#04
2439 120000   F +1  5760                             call    write
243C 7402       +1  5761                             mov             a,#02
243E 120000   F +1  5762                             call    write
2441 74A1       +1  5763                             mov             a,#0a1h
2443 120000   F +1  5764                             call    write
2446 7474       +1  5765                             mov             a,#74h
2448 120000   F +1  5766                             call    write
244B 2095FD     +1  5767                             jb              p1.5,$;p1.3,$
244E 7402       +1  5768                             mov             a,#02
2450 120000   F +1  5769                             call    write
2453 7481       +1  5770                             mov             a,#81h
2455 120000   F +1  5771                             call    write
2458 7474       +1  5772                             mov             a,#74h
245A 120000   F +1  5773                             call    write
245D 2095FD     +1  5774                             jb              p1.5,$;p1.3,$
2460 7402       +1  5775                             mov             a,#02
2462 120000   F +1  5776                             call    write
2465 7421       +1  5777                             mov             a,#21h
2467 120000   F +1  5778                             call    write
246A 7474       +1  5779                             mov             a,#74h
246C 120000   F +1  5780                             call    write
246F 22         +1  5781                             ret
                +1  5782                             ;;;;;;;;;;;;;;;;
                +1  5783     ;;;;;;;;;;;;;;;;;
                +1  5784     ;;;;;;;;;;;;;;;;;
2470 0000       +1  5785     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
2472 6000       +1  5786                                     db              60h,00h;40h,04h         ;10s
2474 6000       +1  5787                                     db              60h,00;40h,04h          ;1s
2476 6001       +1  5788                                     db              60h,01h;40h,04h         ;0,1s
2478 6001       +1  5789                                     db              60h,01;00h;20h,04h              ;50ms
247A 6001       +1  5790                                     db              60h,01;00h;20h,04h               ;10ms
247C 1333       +1  5791                                     db              13h,33h;32h             ;2ms
                +1  5792     
                +1  5793     ;загр В1,В2 в завис от Т                                
247E 799A       +1  5794     loab12:                 mov             r1,#parT
2480 900000   F +1  5795                                     mov             dptr,#tabB1_2
2483 E7         +1  5796                                     mov             a,@r1
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    92

2484 23         +1  5797                                     rl              a;*2
2485 FF         +1  5798                                     mov             r7,a                    ;save a
2486 93         +1  5799                                     movc    a,@a+dptr
2487 FC         +1  5800                                     mov             r4,a   ;b1
2488 0F         +1  5801                                     inc             r7
2489 EF         +1  5802                                     mov             a,r7
248A 93         +1  5803                                     movc    a,@a+dptr
248B FD         +1  5804                                     mov             r5,a
                +1  5805                                     ;после загр В1,2 загр упр слово для нового Т
                +1  5806                             
248C 22         +1  5807                                     ret
                +1  5808     
                +1  5809     
248D 7852       +1  5810     loadr2: mov             r0,#abin+3              ;r2..r5
248F E6         +1  5811                     mov             a,@r0                   ; ст мл   
2490 FA         +1  5812                     mov             r2,a
2491 18         +1  5813                     dec             r0
2492 E6         +1  5814                     mov             a,@r0
2493 FB         +1  5815                     mov             r3,a
2494 18         +1  5816                     dec             r0
2495 E6         +1  5817                     mov             a,@r0
2496 FC         +1  5818                     mov             r4,a
2497 18         +1  5819                     dec             r0
2498 E6         +1  5820                     mov             a,@r0
2499 FD         +1  5821                     mov             r5,a
249A 22         +1  5822                     ret
                +1  5823                                             
                +1  5824      ;;;;;;;;;;;;;;;;;;;      
                +1  5825      ;загрузка KD в зависимости от диап изм  
                +1  5826      ;koef->r8..r11
249B 78AE       +1  5827     loadKD:                 mov             r0,#diap
249D E6         +1  5828                                     mov             a,@r0
249E 900000   F +1  5829                                     mov             dptr,#diKDn
24A1 75F004     +1  5830                                     mov             b,#4
24A4 A4         +1  5831                                     mul             ab
24A5 FF         +1  5832                                     mov             r7,a;save
24A6 93         +1  5833                                     movc    a,@a+dptr
24A7 F508       +1  5834                                     mov             r8,a
24A9 A3         +1  5835                                     inc             dptr
24AA EF         +1  5836                                     mov             a,r7
24AB 93         +1  5837                                     movc    a,@a+dptr
24AC F509       +1  5838                                     mov             r9,a
24AE A3         +1  5839                                     inc             dptr
24AF EF         +1  5840                                     mov             a,r7
24B0 93         +1  5841                                     movc    a,@a+dptr
24B1 F50A       +1  5842                                     mov             r10,a
24B3 A3         +1  5843                                     inc             dptr
24B4 EF         +1  5844                                     mov             a,r7
24B5 93         +1  5845                                     movc    a,@a+dptr
24B6 F50B       +1  5846                                     mov             r11,a
24B8 22         +1  5847                                     ret
                +1  5848     
24B9 3F506B7B   +1  5849      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
24BD 3F507FCC   +1  5850                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
24C1 3F4F9D0B   +1  5851                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
24C5 3F4FE869   +1  5852                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
24C9 3F50294A   +1  5853                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
24CD 3F50639E   +1  5854                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
24D1 3F4BC9F0   +1  5855                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
24D5 3F4C063B   +1  5856                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    93

                             -9
24D9 3F50EFDD   +1  5857                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
24DD 3F512AD9   +1  5858                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  5859     
24E1 00000039   +1  5860     ch57:   db      00,00,00,39h;57
24E5 00000014   +1  5861     ch20:   db      00,00,00,14h;20
                +1  5862     
                +1  5863     ;загр ус для тестов ацп 
                +1  5864     ;dptr-
24E9 78B1       +1  5865     lotpus: mov             r0,#vichR
24EB B6210D     +1  5866                                     cjne    @r0,#21h,te22
24EE 900000   F +1  5867                                     mov                     dptr,#tabt11;заслать ус 11А
24F1 E4         +1  5868     lotp:           clr             a
24F2 93         +1  5869                             movc    a,@a+dptr                               ;high byte
24F3 F584       +1  5870                             mov             p4,a
24F5 A3         +1  5871                             inc             dptr
24F6 E4         +1  5872                             clr             a
24F7 93         +1  5873                             movc    a,@a+dptr                               ;low byte
24F8 F585       +1  5874                             mov             p5,a
24FA 22         +1  5875                             ret
24FB B62205     +1  5876     te22:                   cjne    @r0,#22h,te23
24FE 900000   F +1  5877                             mov                     dptr,#tabt9;заслать ус 9А       
2501 80EE       +1  5878                             jmp                     lotp
                +1  5879     
2503 900000   F +1  5880     te23:   mov                     dptr,#tabt7;заслать ус 7А       
2506 80E9       +1  5881                             jmp                     lotp
                +1  5882     
                +1  5883     
                +1  5884     
                +1  5885     
                +1  5886     
2508 02030405   +1  5887     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
250C 06070809                
2510 0A0B                    
                +1  5888     
2512 78AE       +1  5889     findR:                  mov                     r0,#diap
2514 E6         +1  5890                                                     mov                     a,@r0
2515 900000   F +1  5891                                                     mov                     dptr,#Tabn
2518 93         +1  5892                                                     movc            a,@a+dptr
2519 22         +1  5893                                                     ret
                +1  5894     ;bufind=30h..39h                                                                           
                                           ;
251A C219       +1  5895     vvchif:                 clr             bitmig
251C 79B2       +1  5896                                     mov             r1,#marker
251E E7         +1  5897                                     mov             a,@r1                   ;изм цифры
251F 7840       +1  5898                                     mov             r0,#bufind                      ;0000
2521 28         +1  5899                                     add             a,r0
2522 F8         +1  5900                                     mov             r0,a
2523 06         +1  5901                                     inc             @r0
2524 B63A03     +1  5902                                     cjne    @r0,#3ah,chif
2527 7630       +1  5903                                     mov             @r0,#30h
2529 22         +1  5904                                     ret
252A C3         +1  5905     chif:           clr                     c
252B 7430       +1  5906                                     mov                     a,#30h
252D 96         +1  5907                                     subb            a,@r0
252E 4002       +1  5908                                     jc                      chif5
2530 7630       +1  5909                                     mov             @r0,#30h
2532 22         +1  5910     chif5:  ret
                +1  5911     
2533 80E5       +1  5912     vvnol41:        jmp                     vvchif  ;при наборе цифр в интервале и константах
                +1  5913     
2535 B641FB     +1  5914     vvnol31:        cjne            @r0,#41h,vvnol41
2538 800A       +1  5915                                             jmp                     chifour
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    94

253A B631F8     +1  5916     vvnol23:        cjne            @r0,#31h,vvnol31
253D 8005       +1  5917                                             jmp                     chifour 
                +1  5918     
253F 78B0       +1  5919     vvchibl:        mov                     r0,#level
2541 B623F6     +1  5920                                             cjne            @r0,#23h,vvnol23;при наборе цифр в 
                             блоке
2544 C219       +1  5921     chifour:                clr             bitmig
2546 79B2       +1  5922                                     mov             r1,#marker
2548 E7         +1  5923                                     mov             a,@r1                   ;изм цифры
2549 7840       +1  5924                                     mov             r0,#bufind                      ;1..4
254B 28         +1  5925                                     add             a,r0
254C F8         +1  5926                                     mov             r0,a
254D 06         +1  5927                                     inc             @r0
254E B63504     +1  5928                                     cjne    @r0,#35h,chifb
2551 7631       +1  5929                                     mov             @r0,#31h
2553 8006       +1  5930                                     jmp             chifb1
2555 B63003     +1  5931     chifb:  cjne    @r0,#30h,chifb1
2558 7631       +1  5932                                     mov             @r0,#31h
255A 22         +1  5933                                     ret
255B            +1  5934     chifb1:;;;;;;;;;;
255B C3         +1  5935                                     clr                     c
255C 7430       +1  5936                                     mov                     a,#30h
255E 96         +1  5937                                     subb            a,@r0
255F 4002       +1  5938                                     jc                      chifl5
2561 7630       +1  5939                                     mov             @r0,#30h
                +1  5940                                     
2563 22         +1  5941     chifl5: ret
                +1  5942     ;;;;;;;;;;;;;
2564 22         +1  5943             ret
                +1  5944       ;перевод маркера влево
2565            +1  5945     marle:  
2565 C219       +1  5946                     clr             bitmig
                +1  5947                     ;mov            savba,#0   нельзя обнулять
2567 78B2       +1  5948             mov             r0,#marker
2569 16         +1  5949                     dec             @r0
256A E6         +1  5950                     mov             a,@r0
256B C3         +1  5951                     clr             c
256C 953A       +1  5952                     subb    a,movleft         ;крайне левое положение
256E 5001       +1  5953                     jnc             rler
2570 06         +1  5954                     inc             @r0
2571 22         +1  5955     rler:   ret
                +1  5956         
                +1  5957     ;перевод маркера вправо
2572 C219       +1  5958     marri:  clr             bitmig
2574 78B2       +1  5959                     mov             r0,#marker
2576 06         +1  5960                     inc         @r0
2577 E53B       +1  5961                     mov             a,movrig           ;крайне правое положение
2579 C3         +1  5962                     clr             c
257A 96         +1  5963                     subb    a,@r0
257B 5001       +1  5964                     jnc             rrir
257D 16         +1  5965                     dec             @r0
257E 22         +1  5966     rrir:   ret
                +1  5967         
                +1  5968     ;konstA->bufind+4..bufind+7
257F 78BC       +1  5969     outA:           mov                     r0,#konstA
2581 120000   F +1  5970                                     call            resar2
2584 120343     +1  5971                                     call            ftol                    ;->hex
2587 784F       +1  5972                                     mov             r0,#abin
2589 120000   F +1  5973                                     call            saver2
258C 7853       +1  5974                                     mov                     r0,#adec
258E 7952       +1  5975                                     mov             r1,#abin+3
2590 120000   F +1  5976                                     call            bindec
2593 785C       +1  5977                                     mov                     r0,#adec+9
2595 7947       +1  5978                                     mov                     r1,#bufind+7
2597 7F04       +1  5979                                     mov                     r7,#4
2599 E6         +1  5980     outa2:  mov             a,@r0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    95

259A 2430       +1  5981                               add           a,#30h
259C F7         +1  5982                                     mov             @r1,a
259D 19         +1  5983                                     dec             r1
259E 18         +1  5984                                     dec             r0
259F DFF8       +1  5985                                     djnz    r7,outa2
25A1 22         +1  5986                                     ret
                +1  5987                                             
                +1  5988     ;konstB->bufind+4..bufind+8
                +1  5989     ;outB:          mov                     r0,#konstB
                +1  5990     ;                               call            resar2
                +1  5991     ;                               mov                     a,r2
                +1  5992     ;                               anl                     a,#80h
                +1  5993     ;                               jz                      outb3
                +1  5994     ;mov                    a,r2
                +1  5995     ;                               anl                     a,#7fh
                +1  5996     ;                               mov                     r2,a
                +1  5997     ;                               mov                     bufind+3,#2dh
                +1  5998     ;outb3: call            ftol                    ;->hex
                +1  5999     ;                               mov             r0,#abin
                +1  6000     ;                               call            saver2
                +1  6001     ;                               mov                     r0,#adec
                +1  6002     ;                               mov             r1,#abin+3
                +1  6003     ;                               call            bindec
                +1  6004     ;                               mov                     r0,#adec+9
                +1  6005     ;                               mov                     r1,#bufind+8
                +1  6006     ;                               mov                     r7,#5
                +1  6007     ;outb2: mov             a,@r0
                +1  6008     ;                         add           a,#30h
                +1  6009     ;                               mov             @r1,a
                +1  6010     ;                               dec             r1
                +1  6011     ;                               dec             r0
                +1  6012     ;                               djnz    r7,outb2
                +1  6013     ;                               ret
                +1  6014     
                +1  6015     
                +1  6016     ;пп мигания индикации
25A2 78B2       +1  6017     mign:           mov             r0,#marker
                +1  6018                                     
25A4 B6FF03     +1  6019                                     cjne    @r0,#0ffh,mignn
                +1  6020                                     ;реж изм мигает *
25A7 C219       +1  6021                                     clr             bitmig
25A9 22         +1  6022                                     ret
                +1  6023     
25AA            +1  6024     mignn:                  ;clr            c
25AA 7440       +1  6025                                     mov             a,#bufind
25AC 26         +1  6026                                     add             a,@r0                   ;a=bufind+marker
25AD F9         +1  6027                                     mov             r1,a
25AE 201907     +1  6028                                     jb              bitmig,onmig
25B1 873C       +1  6029                                     mov             savba,@r1
                +1  6030                             ;       mov             a,@r1
                +1  6031                             ;       mov             savba,a
25B3 7720       +1  6032                                     mov             @r1,#" "
                +1  6033                                     
25B5 D219       +1  6034                                     setb    bitmig
25B7 22         +1  6035                                     ret
                +1  6036     
25B8 A73C       +1  6037     onmig:                  mov             @r1,savba
                +1  6038                                     ;mov            a,savba
                +1  6039                                     ; mov           @r1,a
25BA C219       +1  6040                                     clr             bitmig
25BC 120000   F +1  6041                                     call    z_01s
25BF 22         +1  6042                                     ret
                +1  6043     ;номер ошибки bufind+6
25C0 900000   F +1  6044     error:          mov             dptr,#teERR
25C3 120000   F +1  6045                                             call    lotext
25C6 853946     +1  6046                                             mov             bufind+6,nuerr
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    96

25C9 22         +1  6047                                     ret
                +1  6048     
                +1  6049     
25CA            +1  6050     textT:          
25CA FD543D32   +1  6051     te2ms:                  db              0fdh,"T","=",32h,"m",67h,0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
25CE 6D67FDFD                
25D2 FDFD                    
25D4 FD543D31   +1  6052     te10ms:                 db              0fdh,"T","=",31h,30h,"m",67h,0fdh,0fdh,0fdh
25D8 306D67FD                
25DC FDFD                    
25DE FD543D35   +1  6053                             db              0fdh,"T","=",35h,30h,"m",67h,0fdh,0fdh,0fdh
25E2 306D67FD                
25E6 FDFD                    
25E8 FD543D64   +1  6054                             db              0fdh,"T","=",64h,31h,67h,0fdh,0fdh,0fdh,0fdh
25EC 3167FDFD                
25F0 FDFD                    
25F2 20202054   +1  6055                             db              " "," "," ","T","=",31h,67h," "," "," "
25F6 3D316720                
25FA 2020                    
25FC 2020543D   +1  6056                             db              " "," ","T","=",31h,30h,67h," "," "," "  
2600 31306720                
2604 2020                    
                +1  6057     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                +1  6058     
2606 42753474   +1  6059     teVICH: db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
260A 79767454                
260E 7720                    
2610 20553D20   +1  6060     teAequ0:        db              " ",'U','='," "," "," "," "," "," ",65h
2614 20202020                
2618 2065                    
261A 20423D2B   +1  6061     teBequ0:        db              " ",'B','=','+'," "," "," "," "," "," "
261E 20202020                
2622 2020                    
2624 20207145   +1  6062     teMENU: db              " "," ",71h,"E","H",72h," "," "," "," "
2628 48722020                
262C 2020                    
                +1  6063     
262E 20544579   +1  6064     teTESI: db      " ","T","E",79h,"T",2dh,74h,33h,71h," ";ТЕСТ -ИЗМ    11
2632 542D7433                
2636 7120                    
2638 54457954   +1  6065     teTESR: db      "T","E",79h,"T"," ","R",35h," "," "," ";ТЕСТ RS 12
263C 20523520                
2640 2020                    
2642 20794B30   +1  6066     teSKOR: db      " ",79h,'K',30h,"P"," ","R",35h," "," ";СКОР 232      13
2646 50205235                
264A 2020                    
264C 20204142   +1  6067     teAVK:  db      " "," ",'A','B','K'," "," "," "," "," "  ;AВK                              
                                  14
2650 4B202020                
2654 2020                    
2656 204B4176   +1  6068     teKALIB:         db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР    15
265A 74735020                
265E 202020                  
                +1  6069     
2661 20544579   +1  6070     teTE11:         db              " ",'T',"E",79h,'T'," "," "," ",'T',31h;          21
2665 54202020                
2669 5431                    
266B 20544579   +1  6071     teTE9:          db              " ",'T',"E",79h,'T'," "," "," ",'T',32h;                   
                                                  22
266F 54202020                
2673 5432                    
2675 20544579   +1  6072     teTE7:          db              " ",'T',"E",79h,'T'," "," "," ",'T',33h;                   
                                                  23
2679 54202020                
267D 5433                    
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    97

                +1  6073     
                +1  6074     
267F 20202035   +1  6075     teS57_6:                db              " "," "," ",35h,37h,36h," "," "," "," ";57.6
2683 37362020                
2687 2020                    
2689 20202031   +1  6076     teS19_2:                db              " "," "," ",31h,39h,32h," "," "," "," ";19,2
268D 39322020                
2691 2020                    
                +1  6077     
2693 61415030   +1  6078     tePAR:          db              61h,'A',"P",30h,76h,77h," ",30h,30h,30h;пароль
2697 76772030                
269B 3030                    
269D 20303030   +1  6079     teKD:                   db              " ",30h,30h,30h,30h,30h," "," "," ",'A';00000
26A1 30302020                
26A5 2041                    
26A7 74337120   +1  6080     teIZMK: db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
26AB 4B304879                
26AF 5420                    
26B1 20204275   +1  6081     teOUT:          db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
26B5 58307820                
26B9 2020                    
26BB 2020304C   +1  6082     teOLL:          db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
26BF 4C202020                
26C3 2020                    
26C5 20203034   +1  6083     teCLE:          db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
26C9 7479544B                
26CD 4120                    
26CF 20203041   +1  6084     teMEM:          db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
26D3 71795420                
26D7 20203341   +1  6085     teWR:           db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
26DB 61747977                
26DF 2020                    
26E1 20206150   +1  6086     teLIST: db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
26E5 30797130                
26E9 545020                  
26EC 20206130   +1  6087     teFULL: db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
26F0 76484162                
26F4 2020                    
26F6 20744854   +1  6088     teINT:  db      " ",74h,"H",'T'," ",30h,30h,30h,30h,67h;ИНТ 0000
26FA 20303030                
26FE 3067                    
2700 20207376   +1  6089     teBL:           db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
2704 304B2020                
2708 2020                    
270A 20207376   +1  6090     teBL0:  db      " "," ",73h,76h,30h,'K'," ",30h," "," ";БЛОК 0
270E 304B2030                
2712 2020                    
2714 30547934   +1  6091     teCH:           db      30h,'T',79h,34h,"E",'T'," ",30h,30h,31h;ОТСЧЕТ 001
2718 45542030                
271C 3031                    
271E 79544154   +1  6092     teSTAT:         db      79h,'T','A','T',74h,79h,'T',74h,'K','A';СТАТИСТИКА
2722 74795474                
2726 4B41                    
2728 71744820   +1  6093     teMIN:  db      71h,74h,"H"," "," "," "," "," "," "," ";МИН  00000
272C 20202020                
2730 2020                    
2732 71414B79   +1  6094     teMAX:  db      71h,'A','K',79h," "," "," "," "," "," ";МАКС 00000
2736 20202020                
273A 2020                    
273C 79504578   +1  6095     teMID:  db      79h,"P","E",78h," "," "," "," "," "," ";СРЕД 00000
2740 20202020                
2744 2020                    
                +1  6096      ;;;;;;;;;;;;;;;;;;;         
2746 2020304C   +1  6097     teOLI:  db              " "," ",30h,"L","L"," ","I"," "," "," "
274A 4C204920                
274E 2020                    
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    98

2750 2020304C   +1  6098     teOLR:  db              " "," ",30h,"L","L"," ",66h," "," "," "
2754 4C206620                
2758 2020                    
275A 20204552   +1  6099     teERR:  db              " "," ","E","R","R"," "," "," "," "," " ;ERR
275E 52202020                
2762 2020                    
2764 2020454E   +1  6100     teEND:  db              " "," ","E","N","D"," "," "," "," "," " ;END
2768 44202020                
276C 2020                    
                +1  6101     
                +1  6102     ;dptr+4-приемник
                +1  6103     ;dptr-источник
                +1  6104     ;r7-кол байт  
276E            +1  6105     xCIKLWR:
276E 7F04       +1  6106                             mov             r7,#4   
2770 E0         +1  6107     lwrx:   movx    a,@dptr
2771 C083       +1  6108                             push    dph
2773 C082       +1  6109                             push    dpl
2775 A3         +1  6110                             inc             dptr
2776 A3         +1  6111                             inc             dptr
2777 A3         +1  6112                             inc             dptr
2778 A3         +1  6113                             inc             dptr
2779 F0         +1  6114                             movx    @dptr,a
277A D082       +1  6115                             pop             dpl
277C D083       +1  6116                             pop             dph
                +1  6117                             
277E A3         +1  6118                             inc             dptr
277F DFEF       +1  6119                             djnz    r7,lwrx
2781 22         +1  6120                             ret
                +1  6121     ;r2..r5->@dptr..@dptr+3                         
2782 EA         +1  6122     saveIr2:                mov     a,r2
2783 F0         +1  6123                                             movx    @dptr,a
2784 A3         +1  6124                                             inc     dptr
2785 EB         +1  6125                                             mov     a,r3
2786 F0         +1  6126                                             movx    @dptr,a
2787 A3         +1  6127                                             inc     dptr
2788 EC         +1  6128                                             mov     a,r4
2789 F0         +1  6129                                             movx    @dptr,a
278A A3         +1  6130                                             inc     dptr
278B ED         +1  6131                                             mov     a,r5
278C F0         +1  6132                                             movx    @dptr,a
278D 22         +1  6133                                             ret
                +1  6134     ;r2..r5-> @r0..@r0+3
                +1  6135     
278E EA         +1  6136     saver2:         mov     a,r2
278F F6         +1  6137                                             mov     @r0,a
2790 08         +1  6138                                             inc     r0
2791 EB         +1  6139                                             mov     a,r3
2792 F6         +1  6140                                             mov     @r0,a
2793 08         +1  6141                                             inc     r0
2794 EC         +1  6142                                             mov     a,r4
2795 F6         +1  6143                                             mov     @r0,a
2796 08         +1  6144                                             inc     r0
2797 ED         +1  6145                                             mov     a,r5
2798 F6         +1  6146                                             mov     @r0,a
2799 22         +1  6147                                             ret 
279A 7F50       +1  6148     clmassix:       mov                     r7,#50h;28h
279C 900100     +1  6149                             mov     dptr,#MASS0        ;забить массив A нулями
279F 7400       +1  6150     clmax:          mov          a,#00h
27A1 F0         +1  6151                  movx    @dptr,a
27A2 A3         +1  6152                  inc     dptr
27A3 DFFA       +1  6153                 djnz                r7,clmax                
27A5 F56E       +1  6154                  mov     chmas,a
27A7 C201       +1  6155                  clr     bitmas
27A9 22         +1  6156                 ret
                +1  6157     ;r1-яЁшхьшъ
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE    99

                +1  6158     ;r0-шёЄюўшъ
                +1  6159     ;r7-ъюы срщЄ  
27AA            +1  6160     CIKLWR:
27AA 7F04       +1  6161                             mov             r7,#4   
27AC E6         +1  6162     lwr:    mov     a,@r0
27AD F7         +1  6163                             mov     @r1,a
27AE 09         +1  6164                             inc             r1
27AF 08         +1  6165                             inc             r0
27B0 DFFA       +1  6166                             djnz    r7,lwr
27B2 22         +1  6167                             ret     
                +1  6168     ;r2..r5-> @dptr..@dptr+3
                +1  6169     
27B3 120000   F +1  6170     zmul:   call    maform
27B6 120000   F +1  6171                     call    lmul
27B9 120000   F +1  6172                     call    bform
27BC 22         +1  6173                     ret
                +1  6174     
27BD 120000   F +1  6175     zdiv:   call    maform
27C0 120000   F +1  6176                     call    divide
27C3 120000   F +1  6177                     call    bform
27C6 22         +1  6178                     ret
                +1  6179     
27C7 EA         +1  6180     maform: mov a,r2
27C8 33         +1  6181             rlc a
27C9 5006       +1  6182             jnc             fo1m
27CB D202       +1  6183                     setb            znmat
27CD 120000   F +1  6184                     call   form4
27D0 22         +1  6185                     ret
27D1 C202       +1  6186     fo1m:   clr             znmat
27D3 22         +1  6187                     ret
                +1  6188     
27D4 300203     +1  6189     bform:  jnb             znmat,fo2m
27D7 120000   F +1  6190                     call    form4
27DA 22         +1  6191     fo2m:   ret
                +1  6192       
                +1  6193     ;r2..r5 яхЁхтхёЄш т фюя ъюф
27DB ED         +1  6194     form4:          mov a,r5
27DC F4         +1  6195             cpl a
27DD 2401       +1  6196             add a,#1
27DF FD         +1  6197             mov r5,a
27E0 EC         +1  6198             mov a,r4
27E1 F4         +1  6199             cpl a
27E2 3400       +1  6200             addc    a,#0
27E4 FC         +1  6201             mov r4,a
27E5 EB         +1  6202             mov a,r3
27E6 F4         +1  6203                 cpl a
27E7 3400       +1  6204             addc    a,#0
27E9 FB         +1  6205             mov r3,a
27EA EA         +1  6206             mov a,r2
27EB F4         +1  6207             cpl a
27EC 3400       +1  6208             addc    a,#0
27EE FA         +1  6209             mov r2,a
27EF 22         +1  6210             ret
                +1  6211     
27F0 120000   F +1  6212     zcmp:   call            maform
27F3 120000   F +1  6213                     call            lcmp
27F6 C0D0       +1  6214                     push            psw
27F8 120000   F +1  6215                     call    bform
27FB D0D0       +1  6216                     pop             psw
27FD 22         +1  6217                     ret
                +1  6218     
                +1  6219     
                +1  6220     ;@r0..@r0+3->r8..r11
                +1  6221     
27FE E6         +1  6222     resar8: mov     a,@r0
27FF F508       +1  6223                     mov     ltemp,a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   100

2801 08         +1  6224                     inc     r0
2802 E6         +1  6225                     mov     a,@r0
2803 F509       +1  6226                     mov     ltemp+1,a
2805 08         +1  6227                     inc     r0
2806 E6         +1  6228                     mov     a,@r0
2807 F50A       +1  6229                     mov     ltemp+2,a
2809 08         +1  6230                     inc     r0
280A E6         +1  6231                     mov     a,@r0
280B F50B       +1  6232                     mov     ltemp+3,a
280D 22         +1  6233                     ret
                +1  6234     
                +1  6235     ;
                +1  6236     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                +1  6237     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                +1  6238     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                +1  6239     ;r2 a    ўшёыю 180
                +1  6240     ;00 b4
                +1  6241     ;т_ї- mabin..mabin+2
                +1  6242     ;     80 01 00
                +1  6243      
280E C8         +1  6244     cond:   xch     a,r0    
280F F9         +1  6245                     mov     r1,a
2810 C8         +1  6246                     xch     a,r0
2811 7C03       +1  6247                     mov     r4,#03
2813 7700       +1  6248     dcoa:   mov     @r1,#00
2815 09         +1  6249                     inc     r1
2816 DCFB       +1  6250                     djnz    r4,dcoa
2818 7B10       +1  6251                     mov     r3,#10h
281A C3         +1  6252     dcob:   clr     c
281B 33         +1  6253                     rlc     a
281C CA         +1  6254                     xch     a,r2
281D 33         +1  6255                     rlc     a
281E CA         +1  6256                     xch     a,r2
281F C8         +1  6257                     xch     a,r0
2820 F9         +1  6258                     mov     r1,a
2821 C8         +1  6259                     xch     a,r0
2822 7C03       +1  6260                     mov     r4,#03
2824 FD         +1  6261                     mov     r5,a
2825 E7         +1  6262     dcoc:   mov     a,@r1 
2826 37         +1  6263                     addc    a,@r1
2827 D4         +1  6264                     da      a
2828 F7         +1  6265                     mov     @r1,a
2829 09         +1  6266                     inc     r1
282A DCF9       +1  6267                     djnz    r4,dcoc
282C ED         +1  6268                     mov     a,r5
282D 4003       +1  6269                     jc      dcod
282F DBE9       +1  6270                     djnz    r3,dcob
2831 C3         +1  6271                     clr     c
2832 00         +1  6272     dcod:   nop
2833 22         +1  6273                     ret
                +1  6274     
2834 8A08       +1  6275     move28: mov     ltemp,r2                        ;r2..r5->ltemp
2836 850309     +1  6276                     mov     ltemp+1,3
2839 85040A     +1  6277                     mov     ltemp+2,4
283C 85050B     +1  6278                     mov     ltemp+3,5
283F 22         +1  6279                     ret
                +1  6280     
                +1  6281     ;@r0..@r0+3->r2..r5
                +1  6282     
2840 E6         +1  6283     resar2: mov     a,@r0
2841 FA         +1  6284                     mov     r2,a
2842 08         +1  6285                     inc     r0
2843 E6         +1  6286                     mov     a,@r0
2844 FB         +1  6287                     mov     r3,a
2845 08         +1  6288                     inc     r0
2846 E6         +1  6289                     mov     a,@r0
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   101

2847 FC         +1  6290                     mov     r4,a
2848 08         +1  6291                     inc     r0
2849 E6         +1  6292                     mov     a,@r0
284A FD         +1  6293                     mov     r5,a
284B 22         +1  6294                     ret
                +1  6295     
                +1  6296     ;25mkc !!!!!!!!!!!!!!!1
284C 7B4B       +1  6297     z_9:      mov R3,#4Bh      ;загрузка числа
284E DBFE       +1  6298                    djnz R3,$
2850 22         +1  6299               ret
                +1  6300     
                +1  6301     ;запись   передаваемый байт в acc
                +1  6302     ;передача байта послед кодом старшими разрядами  вперед
2851 7A08       +1  6303     write:     mov R2,#8
2853 C3         +1  6304                             clr  c  
2854 C297       +1  6305     wr1:            clr             p1.7;P1.2
2856 00         +1  6306                         nop 
2857 33         +1  6307                             rlc A
2858 9296       +1  6308                             mov P1.6,C;P1.1,C
285A 120000   F +1  6309                        call tim2
285D D297       +1  6310                        setb P1.7;P1.2
285F 120000   F +1  6311                call tim2
2862 DAF0       +1  6312                       djnz R2,wr1
2864 C296       +1  6313                       clr P1.6;P1.1
2866 22         +1  6314                                              ret
                +1  6315     
                +1  6316     ;чтение номера байта с индикатора(2байта)
                +1  6317     ;bufind+8..bufind+9
                +1  6318     ;-  - - -
                +1  6319     ;- - - - - - - - - -
                +1  6320     ;adec..adec+9
                +1  6321     ;ст            мл
2867 7847       +1  6322     upak1:  mov             r0,#bufind+7;
2869 795C       +1  6323                                     mov             r1,#adec+9
286B C3         +1  6324                                     clr             c
286C E6         +1  6325                                     mov             a,@r0
286D 9430       +1  6326                                     subb    a,#30h
286F FF         +1  6327                                     mov             r7,a
2870 C3         +1  6328                                     clr             c
2871 9405       +1  6329                                     subb    a,#5
2873 4004       +1  6330                                     jc              upk1
2875 7404       +1  6331                                     mov             a,#4
2877 8001       +1  6332                                     jmp             upk2
2879 EF         +1  6333     upk1:           mov             a,r7
287A F7         +1  6334     upk2:           mov             @r1,a
287B 22         +1  6335                                     ret  
                +1  6336     ;r1-мл байт счетчика ячеек
287C C3         +1  6337     chminus:        clr                     c
287D E7         +1  6338                                             mov                     a,@r1
287E 9401       +1  6339                                             subb            a,#01
2880 F7         +1  6340                                             mov                     @r1,a;low
2881 19         +1  6341                                             dec                     r1
2882 E7         +1  6342                                             mov                     a,@r1
2883 9400       +1  6343                                             subb            a,#00
2885 F7         +1  6344                                             mov                     @r1,a
2886 22         +1  6345                                             ret
                +1  6346     
                +1  6347     
                +1  6348     ;чтение номера байта с индикатора(4байта)
                +1  6349     ;bufind+6..bufind+9
                +1  6350     ;-  - - -
                +1  6351     ;- - - - - - - - - -
                +1  6352     ;adec..adec+9
                +1  6353     ;ст            мл
2887 7848       +1  6354     upak4:  mov             r0,#bufind+8;
2889 795C       +1  6355                     mov             r1,#adec+9
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   102

288B 7F04       +1  6356                     mov             r7,#4
288D C3         +1  6357     upaa:   clr             c
288E E6         +1  6358                     mov             a,@r0
288F 9430       +1  6359                     subb    a,#30h
2891 F7         +1  6360                     mov             @r1,a
2892 18         +1  6361                     dec             r0
2893 19         +1  6362                     dec             r1
2894 DFF7       +1  6363                     djnz    r7,upaa
2896 22         +1  6364                     ret
                +1  6365     
                +1  6366     ;dptr-адр ячейки 1й соотв блока 
2897 E538       +1  6367     adrblok:         mov            a,nblok
2899 C3         +1  6368                              clr            c
289A 9401       +1  6369                              subb           a,#1
289C FD         +1  6370                              mov            r5,a
289D E4         +1  6371                              clr            a
289E FC         +1  6372                              mov            r4,a
289F FB         +1  6373                              mov            r3,a
28A0 FA         +1  6374                              mov            r2,a
28A1 900000   F +1  6375                                     mov                     dptr,#ch320h
28A4 120000   F +1  6376                                     CALL   ldc_ltemp                 ; ltemp <-320
28A7 120000   F +1  6377                                     call            lmul;r2..r5
28AA ED         +1  6378                                     mov                     a,r5
28AB 2450       +1  6379                                     add                     a,#50h
28AD F582       +1  6380                                     mov                     dpl,a
28AF EC         +1  6381                                     mov                     a,r4
28B0 3401       +1  6382                                     addc            a,#01           
28B2 F583       +1  6383                                     mov                     dph,a                   ;dptr-
28B4 22         +1  6384                                     ret
                +1  6385     
                +1  6386     ;
                +1  6387     ;saven_bl<-dptr  адрес след ячейки внешн озу 
28B5 E538       +1  6388     save_hl:                mov             a,nblok
28B7 B4011D     +1  6389                                                     cjne    a,#1,sa_hl1
28BA 79D3       +1  6390                                                     mov             r1,#saven_bl
28BC E583       +1  6391     sa_hl:                  mov             a,dph
28BE F7         +1  6392                                               mov           @r1,a
28BF 09         +1  6393                                                     inc             r1
28C0 E582       +1  6394                                                     mov             a,dpl
28C2 F7         +1  6395                                                     mov             @r1,a
                +1  6396                                                     ;;;;;;;;;не конец ли блока
                +1  6397                             
28C3 79D6       +1  6398                                     mov                     r1,#volume+1;work+1
28C5 120000   F +1  6399                                     call            chminus
28C8 78D5       +1  6400                                     mov             r0,#volume
28CA E6         +1  6401                                     mov             a,@r0
28CB 30E708     +1  6402                                     jnb             acc.7,noendli
28CE C20A       +1  6403                                     clr                     bitbon                  ;блок закон
                             чился
28D0 534BFD     +1  6404                                     anl                     bufind+11,#0fdh
28D3 120000   F +1  6405                                     call            ind
28D6 22         +1  6406     noendli:ret
                +1  6407     
28D7 B40204     +1  6408     sa_hl1:         cjne    a,#2,sa_hl2
28DA 79C0       +1  6409                                                     mov             r1,#saven_bl2
28DC 80DE       +1  6410                                                     jmp             sa_hl
                +1  6411     
28DE B40304     +1  6412     sa_hl2:         cjne    a,#3,sa_hl3
28E1 79C2       +1  6413                                                     mov             r1,#saven_bl3
28E3 80D7       +1  6414                                                     jmp             sa_hl
28E5 79D9       +1  6415     sa_hl3:                 mov             r1,#saven_bl4
28E7 80D3       +1  6416                                                     jmp             sa_hl
                +1  6417     
                +1  6418     ;загрузка dptr сохр ранее значением адреса ячейки
28E9 E538       +1  6419     resa_hl:                mov             a,nblok
28EB B4010A     +1  6420                                                     cjne    a,#1,re_hl1
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   103

28EE 79D3       +1  6421                                                     mov             r1,#saven_bl;блок1 150h..46
                             fh
28F0 E7         +1  6422     re_hl:                  mov             a,@r1   
28F1 F583       +1  6423                                                     mov             dph,a
                +1  6424                                               
28F3 09         +1  6425                                                     inc             r1
28F4 E7         +1  6426                                                     mov             a,@r1
28F5 F582       +1  6427                                                     mov             dpl,a
28F7 22         +1  6428                                                     ret
                +1  6429     
28F8 B40204     +1  6430     re_hl1:                 cjne    a,#2,re_hl2
28FB 79C0       +1  6431                                                     mov             r1,#saven_bl2   ;блок2 470h
                             ..78fh
28FD 80F1       +1  6432                                                     jmp             re_hl
                +1  6433     
28FF B40304     +1  6434     re_hl2:                 cjne    a,#3,re_hl3
2902 79C2       +1  6435                                                     mov             r1,#saven_bl3   ;блок3 790h
                             ..aafh
2904 80EA       +1  6436                                                     jmp             re_hl
                +1  6437     
2906 79D9       +1  6438     re_hl3:                 mov             r1,#saven_bl4   ;блок4 ab0h..dcfh
2908 80E6       +1  6439                                                     jmp             re_hl
                +1  6440     ;загрузка rez_A3 в соотв яч внешн озу
290A 789C       +1  6441     loA3_X:                 mov             r0,#rez_A3
290C 120000   F +1  6442                                                     call    resar2
                +1  6443                                                     
290F EA         +1  6444                                                     mov             a,r2                    ;
2910 F0         +1  6445                                                     movx    @dptr,a
2911 A3         +1  6446                                                     inc             dptr
2912 EB         +1  6447                                                     mov             a,r3
2913 F0         +1  6448                                                     movx    @dptr,a
2914 A3         +1  6449                                                     inc             dptr
2915 EC         +1  6450                                                     mov             a,r4
2916 F0         +1  6451                                                     movx    @dptr,a
2917 A3         +1  6452                                                     inc             dptr
2918 ED         +1  6453                                                     mov             a,r5
2919 F0         +1  6454                                                     movx    @dptr,a
291A A3         +1  6455                                                     inc             dptr;адрес след ячейки внеш
                             н озу храним
291B 22         +1  6456                                                     ret             ;в ячейке saven_bl
                +1  6457     ;чтение в rez_A3 из соотв яч внешн озу
291C            +1  6458     reA3_X:         
                +1  6459                                                     
291C E0         +1  6460                                                     movx    a,@dptr
291D FA         +1  6461                                                     mov             r2,a
291E A3         +1  6462                                                     inc             dptr
291F E0         +1  6463                                                     movx    a,@dptr
2920 FB         +1  6464                                                     mov             r3,a
2921 A3         +1  6465                                                     inc             dptr
2922 E0         +1  6466                                                     movx    a,@dptr
2923 FC         +1  6467                                                     mov             r4,a
2924 A3         +1  6468                                                     inc             dptr
2925 E0         +1  6469                                                     movx    a,@dptr
2926 FD         +1  6470                                                     mov             r5,a
2927 A3         +1  6471                                                     inc             dptr
2928 789C       +1  6472                                                     mov             r0,#rez_A3
292A 120000   F +1  6473                                                     call    saver2
292D 22         +1  6474                                                     ret
                +1  6475     ;;;;;;;;;;;;;;;;;
                +1  6476     ;разбивка внешнего озу
                +1  6477     ;0..ffh считывается страница рпзу калибровочных коффициентов
                +1  6478     ;100h..150h обл внеш озу для скользящего массива измерения
                +1  6479     ;150h..46fh 1й блок
                +1  6480     ;470h..78fh     2й блок
                +1  6481     ;790h..aaf      3й блок
                +1  6482     ;ab0h..dcfh 4й блок
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   104

                +1  6483     ;dd0..fffh свободная область
                +1  6484     ;
                +1  6485     ;светодиоды и точки для индикатора
                +1  6486     ;такт
                +1  6487     ;измер
                +1  6488     ;avp
                +1  6489     ;нуль
                +1  6490     ;0,1s
                +1  6491     ;1s
                +1  6492     ;10s
                +1  6493     ;кмп
                +1  6494     ;память
                +1  6495     ;пуск
                +1  6496     ;
                +1  6497     ;
                    6498     
                    6499     ;$include (d:\amp\sarifm3.asm) 
                +1  6500     ; ” ©« SARIFM.ASM 8.11.95
                +1  6501     ;файл арифметики
                +1  6502       
  0008          +1  6503     ltemp    equ       8           ;long temporary
  000C          +1  6504     xtemp    equ       12          ;other temporaries
  000A          +1  6505     DECSIZE  EQU       10
  0004          +1  6506     NUMSIZE  EQU       4
  0004          +1  6507     RR4  EQU       4
  0005          +1  6508     RR5  EQU       5
                +1  6509     
                +1  6510                                                     
                +1  6511     
                +1  6512                 ; rseg     ARIF          ; Switch to this code segment.
                +1  6513     ;             using    0              ; Specify register bank for the following
                +1  6514                                            ; program code.
                +1  6515     ;                                               cseg AT 400h
                +1  6516     ; Arithmetics:  CLEARING string
                +1  6517     ; Input:
                +1  6518     ; R0 - pointer to string,
                +1  6519     ; NUMSIZE - byte count if CLRNUM used,
                +1  6520     ; DECSIZE - byte count if CLRDEC used,
                +1  6521     ; R2 - byte count if CLEAR used;
                +1  6522     ; Output:  none.
                +1  6523     
292E            +1  6524     CLRDEC:
292E 7A0A       +1  6525         MOV R2, #DECSIZE
2930 8002       +1  6526         SJMP    CLEAR
2932            +1  6527     CLRNUM:
2932 7A04       +1  6528         MOV R2, #NUMSIZE
                +1  6529         ;JMP    CLEAR
2934            +1  6530     CLEAR:
2934 E4         +1  6531         CLR A
2935 F6         +1  6532     CLR11:  MOV @R0, A
2936 08         +1  6533         INC R0
2937 DAFC       +1  6534         DJNZ    R2, CLR11
2939 22         +1  6535         RET
                +1  6536     
                +1  6537     ;**********************************
                +1  6538     ;mov    r1,#abin+3
                +1  6539     ;mov    r0,#adec
                +1  6540     ; _ _ _ _
                +1  6541     ;     03ff
                +1  6542     ;ст     мл   - вход
                +1  6543     ; _ _ _ _ _ _ _ _ _ _
                +1  6544     ;             1 0 2 3
                +1  6545     ;ст                мл 
                +1  6546     ;**********************************
                +1  6547     
293A            +1  6548     BINDEC:
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   105

                +1  6549     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  6550     ; Input:
                +1  6551     ; R0 - pointer to destination (high digit is the first),
                +1  6552     ; R1 - pointer to source,
                +1  6553     ; NUMSIZE - byte count in binary number;
                +1  6554     ; DECSIZE - byte count in decimal number;
                +1  6555     ; Output:  none.
                +1  6556     ; Source saved
                +1  6557     
                +1  6558         ; 1. Clear result
293A 7A05       +1  6559         MOV R2, #DECSIZE/2
293C 120000   F +1  6560         CALL   CLEAR  ; incrementing R0
                +1  6561     
                +1  6562         ; 2. Prepare convertion
293F 18         +1  6563         DEC R0
2940 8804       +1  6564         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
2942 8905       +1  6565         MOV RR5, R1 ; R5 - pointer to low byte of binary number
2944 7B20       +1  6566         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6567     
                +1  6568         ; 3. Convert cyrcle
2946            +1  6569     BIN30:
                +1  6570     
                +1  6571         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
2946 A905       +1  6572         MOV R1, RR5
2948 7A04       +1  6573         MOV R2, #NUMSIZE
294A E7         +1  6574     BIN31:  MOV A, @R1
294B 33         +1  6575         RLC A
294C F7         +1  6576         MOV @R1, A
294D 19         +1  6577         DEC R1
294E DAFA       +1  6578         DJNZ    R2, BIN31
2950 A905       +1  6579         MOV R1, RR5
2952 E7         +1  6580         MOV A, @R1
2953 92E0       +1  6581         MOV ACC.0, C
2955 F7         +1  6582         MOV @R1, A
                +1  6583     
                +1  6584         ; 3.2. Doubling decimal result with <Carry>
2956 A804       +1  6585         MOV R0, RR4
2958 7A05       +1  6586         MOV R2, #DECSIZE/2
295A E6         +1  6587     BIN32:  MOV A, @R0
295B 36         +1  6588         ADDC    A, @R0
295C D4         +1  6589         DA  A
295D F6         +1  6590         MOV @R0, A
295E 18         +1  6591         DEC R0
295F DAF9       +1  6592         DJNZ    R2, BIN32
                +1  6593     
                +1  6594         ; 3.3. End of convert cyrcle
2961 DBE3       +1  6595         DJNZ    R3, BIN30
                +1  6596     
                +1  6597         ; 4. Make bytes from half-bytes
2963 E8         +1  6598         MOV A, R0
2964 240A       +1  6599         ADD A, #DECSIZE
2966 F8         +1  6600         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
2967 A904       +1  6601         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
2969 7A05       +1  6602         MOV R2, #DECSIZE/2
296B E7         +1  6603     BIN41:  MOV A, @R1
296C 540F       +1  6604         ANL A, #00FH
296E F6         +1  6605         MOV @R0, A
296F 18         +1  6606         DEC R0
2970 E7         +1  6607         MOV A, @R1
2971 C4         +1  6608         SWAP    A
2972 540F       +1  6609         ANL A, #00FH
2974 F6         +1  6610         MOV @R0, A
2975 18         +1  6611         DEC R0
2976 19         +1  6612         DEC R1
2977 DAF2       +1  6613         DJNZ    R2, BIN41
2979 22         +1  6614         RET
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   106

                +1  6615     
                +1  6616     
                +1  6617     ;*********************************
                +1  6618     ;mov    r0,#abin
                +1  6619     ;mov    r1,#adec
                +1  6620     ; _ _ _ _       -выход
                +1  6621     ; ff0000
                +1  6622     ;0004
                +1  6623     ;мл      ст
                +1  6624     
                +1  6625     ;ст                       мл
                +1  6626     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  6627     ;                       2 5 5
                +1  6628     ;                   1 0 2 4
                +1  6629     
297A            +1  6630     DECBIN:
                +1  6631     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  6632     ; Input:
                +1  6633     ; R0 - pointer to destination,
                +1  6634     ; R1 - pointer to source (high digit is the first),
                +1  6635     ; NUMSIZE - byte count in binary number;
                +1  6636     ; DECSIZE - byte count in decimal number;
                +1  6637     ; Output:  none
                +1  6638     ; Source cleared
                +1  6639     
                +1  6640         ; 1. Clear result
297A 120000   F +1  6641         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  6642     
                +1  6643         ; 2. Prepare convertion
297D 18         +1  6644         DEC R0
297E 8804       +1  6645         MOV RR4, R0 ; R4 - pointer to high byte of binary result
2980 8905       +1  6646         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
2982 900000   F +1  6647         MOV DPTR, #DECT2
2985 7B20       +1  6648         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6649     
                +1  6650         ; 3. Convert cyrcle
2987            +1  6651     DEC30:
                +1  6652     
                +1  6653         ; 3.1. Divide decimal number by 2 and prepare <Carry>
2987 C3         +1  6654         CLR C
2988 A905       +1  6655         MOV R1, RR5
298A 7A0A       +1  6656         MOV R2, #DECSIZE
298C E7         +1  6657     DEC31:  MOV A, @R1
298D 540F       +1  6658         ANL A, #00FH
298F 92E4       +1  6659         MOV ACC.4, C
2991 93         +1  6660         MOVC    A,@A+DPTR
2992 F7         +1  6661         MOV @R1, A
2993 A2E7       +1  6662         MOV C, ACC.7
2995 09         +1  6663         INC R1
2996 DAF4       +1  6664         DJNZ    R2, DEC31
                +1  6665     
                +1  6666         ; 3.2. Rotate binary result one bit to right with <Carry>
2998 A804       +1  6667         MOV R0, RR4
299A 7A04       +1  6668         MOV R2, #NUMSIZE
299C E6         +1  6669     DEC32:  MOV A, @R0
299D 13         +1  6670         RRC A
299E F6         +1  6671         MOV @R0, A
299F 18         +1  6672         DEC R0
29A0 DAFA       +1  6673         DJNZ    R2, DEC32
                +1  6674     
                +1  6675         ; 3.3. End of convert cyrcle
29A2 DBE3       +1  6676         DJNZ    R3, DEC30
29A4 22         +1  6677         RET
                +1  6678     
29A5 00800181   +1  6679     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
29A9 02820383                
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   107

29AD 0484                    
29AF 00000000   +1  6680         DB  00,00,00,00,00,00
29B3 0000                    
29B5 05850686   +1  6681         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
29B9 07870888                
29BD 0989                    
                +1  6682     
                +1  6683     ;   Long comparison
                +1  6684     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  6685     ;   flags and acc set as though a long subtraction was done.
                +1  6686     ;*******************************
                +1  6687     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  6688     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  6689     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  6690     ;*******************************
29BF            +1  6691     lcmp:
29BF C3         +1  6692         clr c
29C0 EA         +1  6693         mov a,r2
29C1 9508       +1  6694         subb    a,8
29C3 700F       +1  6695         jnz done
29C5 EB         +1  6696         mov a,r3
29C6 9509       +1  6697         subb    a,9
29C8 7008       +1  6698         jnz done1
29CA EC         +1  6699         mov a,r4
29CB 950A       +1  6700         subb    a,10
29CD 7003       +1  6701         jnz done1
29CF ED         +1  6702         mov a,r5
29D0 950B       +1  6703         subb    a,11
29D2            +1  6704     done1:
29D2 C2D2       +1  6705         clr ov      ;overflow is significant only for top byte
29D4            +1  6706     done:
29D4 22         +1  6707         ret
                +1  6708     
                +1  6709     ;   Load long into r2-5 from [dptr]
                +1  6710     
29D5            +1  6711     ldc_long:
29D5 E583       +1  6712         mov a,dph       ;is it in on board memory
29D7 6010       +1  6713         jz  onboard     ;yes
29D9 E4         +1  6714         clr a
29DA 93         +1  6715         movc    a,@a+dptr
29DB FA         +1  6716         mov r2,a
29DC 7401       +1  6717         mov a,#1
29DE 93         +1  6718         movc    a,@a+dptr
29DF FB         +1  6719         mov r3,a
29E0 7402       +1  6720         mov a,#2
29E2 93         +1  6721         movc    a,@a+dptr
29E3 FC         +1  6722         mov r4,a
29E4 7403       +1  6723         mov a,#3
29E6 93         +1  6724         movc    a,@a+dptr
29E7 FD         +1  6725         mov r5,a
29E8 22         +1  6726         ret
29E9            +1  6727     onboard:
29E9 A882       +1  6728         mov r0,dpl
29EB E6         +1  6729         mov a,@r0
29EC FA         +1  6730         mov r2,a
29ED 08         +1  6731         inc r0
29EE E6         +1  6732         mov a,@r0
29EF FB         +1  6733         mov r3,a
29F0 08         +1  6734         inc r0
29F1 E6         +1  6735         mov a,@r0
29F2 FC         +1  6736         mov r4,a
29F3 08         +1  6737         inc r0
29F4 E6         +1  6738         mov a,@r0
29F5 FD         +1  6739         mov r5,a
29F6 22         +1  6740         ret
                +1  6741     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   108

                +1  6742     ;**************************************
                +1  6743     ;загрузить ltemp...+3 из памяти программ
                +1  6744     ;mov    dptr,#CH5
                +1  6745     ;call   ldc_ltemp        ltemp <--5
                +1  6746     ;**************************************
29F7            +1  6747     ldc_ltemp:
29F7 E583       +1  6748         mov a,dph       ;is it in on board memory
29F9 6014       +1  6749         jz  oboard      ;yes
29FB E4         +1  6750         clr a
29FC 93         +1  6751         movc    a,@a+dptr
29FD F508       +1  6752         mov 8,a
29FF 7401       +1  6753         mov a,#1
2A01 93         +1  6754         movc    a,@a+dptr
2A02 F509       +1  6755         mov 9,a
2A04 7402       +1  6756         mov a,#2
2A06 93         +1  6757         movc    a,@a+dptr
2A07 F50A       +1  6758         mov 10,a
2A09 7403       +1  6759         mov a,#3
2A0B 93         +1  6760         movc    a,@a+dptr
2A0C F50B       +1  6761         mov 11,a
2A0E 22         +1  6762         ret
2A0F            +1  6763     oboard:
2A0F A882       +1  6764         mov r0,dpl
2A11 8608       +1  6765         mov 8,@r0
2A13 08         +1  6766         inc r0
2A14 8609       +1  6767         mov 9,@r0
2A16 08         +1  6768         inc r0
2A17 860A       +1  6769         mov 10,@r0
2A19 08         +1  6770         inc r0
2A1A 860B       +1  6771         mov 11,@r0
2A1C 22         +1  6772         ret
                +1  6773     
                +1  6774     ;*****************************
                +1  6775     ;mov    dptr,#k1
                +1  6776     ;call   ldx_long
                +1  6777     ;k1->r2..r5
                +1  6778     ;*****************************
                +1  6779     ;   Load long into r2-5 from [dptr]
                +1  6780     ;
                +1  6781     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
2A1D            +1  6782     ldx_long:
2A1D E583       +1  6783         mov a,dph       ;is it in on board memory
2A1F 6014       +1  6784         jz  onboar1        ;yes
2A21 C082       +1  6785         push    dpl
2A23 C083       +1  6786         push    dph
2A25 E0         +1  6787         movx    a,@dptr
2A26 FA         +1  6788         mov r2,a
2A27 A3         +1  6789         inc dptr
2A28 E0         +1  6790         movx    a,@dptr
2A29 FB         +1  6791         mov r3,a
2A2A A3         +1  6792         inc dptr
2A2B E0         +1  6793         movx    a,@dptr
2A2C FC         +1  6794         mov r4,a
2A2D A3         +1  6795         inc dptr
2A2E E0         +1  6796         movx    a,@dptr
2A2F FD         +1  6797         mov r5,a
2A30 D083       +1  6798         pop dph
2A32 D082       +1  6799         pop dpl
2A34 22         +1  6800         ret
2A35            +1  6801     onboar1:
2A35 A882       +1  6802         mov r0,dpl
2A37 E6         +1  6803         mov a,@r0
2A38 FA         +1  6804         mov r2,a
2A39 08         +1  6805         inc r0
2A3A E6         +1  6806         mov a,@r0
2A3B FB         +1  6807         mov r3,a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   109

2A3C 08         +1  6808         inc r0
2A3D E6         +1  6809         mov a,@r0
2A3E FC         +1  6810         mov r4,a
2A3F 08         +1  6811         inc r0
2A40 E6         +1  6812         mov a,@r0
2A41 FD         +1  6813         mov r5,a
2A42 22         +1  6814         ret
                +1  6815     
                +1  6816     ;*********************************
                +1  6817     ;mov    dptr,#k2
                +1  6818     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  6819     ;**********************************
2A43            +1  6820     ldx_ltemp:
2A43 E583       +1  6821         mov a,dph       ;is it in on board memory
2A45 6010       +1  6822         jz  oboard1     ;yes
2A47 E0         +1  6823         movx    a,@dptr
2A48 F508       +1  6824         mov 8,a
2A4A A3         +1  6825         inc dptr
2A4B E0         +1  6826         movx    a,@dptr
2A4C F509       +1  6827         mov 9,a
2A4E A3         +1  6828         inc dptr
2A4F E0         +1  6829         movx    a,@dptr
2A50 F50A       +1  6830         mov 10,a
2A52 A3         +1  6831         inc dptr
2A53 E0         +1  6832         movx    a,@dptr
2A54 F50B       +1  6833         mov 11,a
2A56 22         +1  6834         ret
2A57            +1  6835     oboard1:
2A57 A882       +1  6836         mov r0,dpl
2A59 8608       +1  6837         mov 8,@r0
2A5B 08         +1  6838         inc r0
2A5C 8609       +1  6839         mov 9,@r0
2A5E 08         +1  6840         inc r0
2A5F 860A       +1  6841         mov 10,@r0
2A61 08         +1  6842         inc r0
2A62 860B       +1  6843         mov 11,@r0
2A64 22         +1  6844         ret
                +1  6845     ;   Long division routines for 8051
                +1  6846     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  6847     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  6848     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  6849     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  6850     ;   r1 must be saved by the caller.
                +1  6851     ;   This is long unsigned division.
                +1  6852     
                +1  6853     
                +1  6854     ;   Register usage:
                +1  6855     ;       r0 loop counter
                +1  6856     ;       xtemp (12-15) accumulates quotient
                +1  6857     ;       r5-r2 holds dividend
                +1  6858     ;       ltemp holds divisor
                +1  6859     
                +1  6860     ;************************************
                +1  6861     ;r2..r5-делимое
                +1  6862     ;ltemp..-делитель
                +1  6863     ;частное -r2..r5
                +1  6864     ;*************************************
2A65            +1  6865     divide:
2A65 E4         +1  6866         clr a
2A66 F8         +1  6867         mov r0,a        ;initialize count
2A67 F50C       +1  6868         mov xtemp,a     ;zero quotient
2A69 F50D       +1  6869         mov xtemp+1,a
2A6B F50E       +1  6870         mov xtemp+2,a
2A6D F50F       +1  6871         mov xtemp+3,a
2A6F ED         +1  6872         mov a,r5        ;check for zero dividend
2A70 4C         +1  6873         orl a,r4
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   110

2A71 4B         +1  6874         orl a,r3
2A72 4A         +1  6875         orl a,r2
2A73 600B       +1  6876         jz  jfinis
2A75 E508       +1  6877         mov a,ltemp     ;check for zero divisor
2A77 4509       +1  6878         orl a,ltemp+1
2A79 450A       +1  6879         orl a,ltemp+2
2A7B 450B       +1  6880         orl a,ltemp+3
2A7D 7037       +1  6881         jnz midl
2A7F 22         +1  6882         ret
                +1  6883     
2A80 020000   F +1  6884     jfinis: jmp finis
                +1  6885     
2A83            +1  6886     loops:
2A83 EA         +1  6887         mov a,r2
2A84 C3         +1  6888         clr c
2A85 9508       +1  6889         subb    a,ltemp+0   ;is divisor greater than dividend yet
2A87 4033       +1  6890         jc  yes     ;yes, go no further
2A89 7013       +1  6891         jnz no
2A8B EB         +1  6892         mov a,r3
2A8C 9509       +1  6893         subb    a,ltemp+1
2A8E 402C       +1  6894         jc  yes
2A90 700C       +1  6895         jnz no
2A92 EC         +1  6896         mov a,r4
2A93 950A       +1  6897         subb    a,ltemp+2
2A95 4025       +1  6898         jc  yes
2A97 7005       +1  6899         jnz no
2A99 ED         +1  6900         mov a,r5
2A9A 950B       +1  6901         subb    a,ltemp+3
2A9C 401E       +1  6902         jc  yes
2A9E            +1  6903     no:
2A9E E50B       +1  6904         mov a,ltemp+3   ;shift divisor up one bit
2AA0 250B       +1  6905         add a,ltemp+3
2AA2 F50B       +1  6906         mov ltemp+3,a
2AA4 E50A       +1  6907         mov a,ltemp+2
2AA6 350A       +1  6908         addc    a,ltemp+2
2AA8 F50A       +1  6909         mov ltemp+2,a
2AAA E509       +1  6910         mov a,ltemp+1
2AAC 3509       +1  6911         addc    a,ltemp+1
2AAE F509       +1  6912         mov ltemp+1,a
2AB0 E508       +1  6913         mov a,ltemp+0
2AB2 3508       +1  6914         addc    a,ltemp+0
2AB4 F508       +1  6915         mov ltemp+0,a
2AB6            +1  6916     midl:
2AB6 08         +1  6917         inc r0      ;increment count
2AB7 E508       +1  6918         mov a,ltemp+0   ;check for safe to shift some more
2AB9 30E7C7     +1  6919         jnb acc.7,loops  ;loop if top bit clear
2ABC            +1  6920     yes:
2ABC E508       +1  6921         mov a,ltemp+0
2ABE C3         +1  6922         clr c
2ABF 9A         +1  6923         subb    a,r2        ;can we subtract now?
2AC0 401A       +1  6924         jc  dosub       ;yes, go and do it
2AC2 7015       +1  6925         jnz nosub
2AC4 E509       +1  6926         mov a,ltemp+1
2AC6 9B         +1  6927         subb    a,r3
2AC7 4013       +1  6928         jc  dosub
2AC9 700E       +1  6929         jnz nosub
2ACB E50A       +1  6930         mov a,ltemp+2
2ACD 9C         +1  6931         subb    a,r4
2ACE 400C       +1  6932         jc  dosub
2AD0 7007       +1  6933         jnz nosub
2AD2 E50B       +1  6934         mov a,ltemp+3
2AD4 9D         +1  6935         subb    a,r5
2AD5 4005       +1  6936         jc  dosub
2AD7 6003       +1  6937         jz  dosub
2AD9            +1  6938     nosub:
2AD9 C3         +1  6939         clr c
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   111

2ADA 8012       +1  6940         sjmp    dosh
2ADC            +1  6941     dosub:
2ADC C3         +1  6942         clr c       ;subtract divisor from dividend
2ADD ED         +1  6943         mov a,r5
2ADE 950B       +1  6944         subb    a,ltemp+3
2AE0 FD         +1  6945         mov r5,a
2AE1 EC         +1  6946         mov a,r4
2AE2 950A       +1  6947         subb    a,ltemp+2
2AE4 FC         +1  6948         mov r4,a
2AE5 EB         +1  6949         mov a,r3
2AE6 9509       +1  6950         subb    a,ltemp+1
2AE8 FB         +1  6951         mov r3,a
2AE9 EA         +1  6952         mov a,r2
2AEA 9508       +1  6953         subb    a,ltemp+0
2AEC FA         +1  6954         mov r2,a
2AED D3         +1  6955         setb    c       ;now set bit for quotient
2AEE            +1  6956     dosh:
2AEE E50F       +1  6957         mov a,xtemp+3
2AF0 33         +1  6958         rlc a
2AF1 F50F       +1  6959         mov xtemp+3,a
2AF3 E50E       +1  6960         mov a,xtemp+2
2AF5 33         +1  6961         rlc a
2AF6 F50E       +1  6962         mov xtemp+2,a
2AF8 E50D       +1  6963         mov a,xtemp+1
2AFA 33         +1  6964         rlc a
2AFB F50D       +1  6965         mov xtemp+1,a
2AFD E50C       +1  6966         mov a,xtemp+0
2AFF 33         +1  6967         rlc a
2B00 F50C       +1  6968         mov xtemp+0,a
2B02 E508       +1  6969         mov a,ltemp+0       ;shift divisor down
2B04 C3         +1  6970         clr c
2B05 13         +1  6971         rrc a
2B06 F508       +1  6972         mov ltemp+0,a
2B08 E509       +1  6973         mov a,ltemp+1
2B0A 13         +1  6974         rrc a
2B0B F509       +1  6975         mov ltemp+1,a
2B0D E50A       +1  6976         mov a,ltemp+2
2B0F 13         +1  6977         rrc a
2B10 F50A       +1  6978         mov ltemp+2,a
2B12 E50B       +1  6979         mov a,ltemp+3
2B14 13         +1  6980         rrc a
2B15 F50B       +1  6981         mov ltemp+3,a
                +1  6982     
2B17 D8A3       +1  6983         djnz    r0,yes      ;and continue with the rest
                +1  6984     
2B19            +1  6985     finis:
2B19 8D0B       +1  6986         mov ltemp+3,r5
2B1B 8C0A       +1  6987         mov ltemp+2,r4
2B1D 8B09       +1  6988         mov ltemp+1,r3
2B1F 8A08       +1  6989         mov ltemp+0,r2
2B21 AD0F       +1  6990         mov r5,xtemp+3
2B23 AC0E       +1  6991         mov r4,xtemp+2
2B25 AB0D       +1  6992         mov r3,xtemp+1
2B27 AA0C       +1  6993         mov r2,xtemp+0
2B29 22         +1  6994         ret         ;and return with the satisfaction of a job well done
                +1  6995     
                +1  6996     
                +1  6997     ;   Long multiplication
                +1  6998     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  6999     ;   other in ltemp. It really doesn't matter which one is where.
                +1  7000     
                +1  7001     ;**********************************
                +1  7002     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  7003     ;ст  мл
                +1  7004     ;**********************************
2B2A            +1  7005     llmul:
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   112

2B2A            +1  7006     almul:
2B2A            +1  7007     lmul:
2B2A ED         +1  7008         mov a,r5        ;low order byte
2B2B 850BF0     +1  7009         mov b,ltemp+3       ;times low order byte
2B2E A4         +1  7010         mul ab
2B2F F50F       +1  7011         mov xtemp+3,a       ;store low
2B31 85F00E     +1  7012         mov xtemp+2,b   ;and high
2B34 ED         +1  7013         mov a,r5        ;low order
2B35 850AF0     +1  7014         mov b,ltemp+2   ;times next
2B38 A4         +1  7015         mul ab
2B39 250E       +1  7016         add a,xtemp+2   ;add in
2B3B F50E       +1  7017         mov xtemp+2,a
2B3D E5F0       +1  7018         mov a,b
2B3F 3400       +1  7019         addc    a,#0
2B41 F50D       +1  7020         mov xtemp+1,a
2B43 ED         +1  7021         mov a,r5
2B44 8509F0     +1  7022         mov b,ltemp+1
2B47 A4         +1  7023         mul ab
2B48 250D       +1  7024         add a,xtemp+1
2B4A F50D       +1  7025         mov xtemp+1,a
2B4C E5F0       +1  7026         mov a,b
2B4E 3400       +1  7027         addc    a,#0
2B50 F50C       +1  7028         mov xtemp+0,a
2B52 ED         +1  7029         mov a,r5
2B53 8508F0     +1  7030         mov b,ltemp+0
2B56 A4         +1  7031         mul ab
2B57 250C       +1  7032         add a,xtemp+0
2B59 F50C       +1  7033         mov xtemp+0,a
2B5B EC         +1  7034         mov a,r4
2B5C 850BF0     +1  7035         mov b,ltemp+3
2B5F A4         +1  7036         mul ab
2B60 250E       +1  7037         add a,xtemp+2
2B62 F50E       +1  7038         mov xtemp+2,a
2B64 E5F0       +1  7039         mov a,b
2B66 350D       +1  7040         addc    a,xtemp+1
2B68 F50D       +1  7041         mov xtemp+1,a
2B6A E50C       +1  7042         mov a,xtemp+0
2B6C 3400       +1  7043         addc    a,#0
2B6E F50C       +1  7044         mov xtemp+0,a
2B70 EC         +1  7045         mov a,r4
2B71 850AF0     +1  7046         mov b,ltemp+2
2B74 A4         +1  7047         mul ab
2B75 250D       +1  7048         add a,xtemp+1
2B77 F50D       +1  7049         mov xtemp+1,a
2B79 E5F0       +1  7050         mov a,b
2B7B 350C       +1  7051         addc    a,xtemp+0
2B7D F50C       +1  7052         mov xtemp+0,a
2B7F EC         +1  7053         mov a,r4
2B80 8509F0     +1  7054         mov b,ltemp+1
2B83 A4         +1  7055         mul ab
2B84 250C       +1  7056         add a,xtemp+0
2B86 F50C       +1  7057         mov xtemp+0,a
                +1  7058     
2B88 EB         +1  7059         mov a,r3
2B89 850BF0     +1  7060         mov b,ltemp+3
2B8C A4         +1  7061         mul ab
2B8D 250D       +1  7062         add a,xtemp+1
2B8F F50D       +1  7063         mov xtemp+1,a
2B91 E5F0       +1  7064         mov a,b
2B93 350C       +1  7065         addc    a,xtemp+0
2B95 F50C       +1  7066         mov xtemp+0,a
2B97 EB         +1  7067         mov a,r3
2B98 850AF0     +1  7068         mov b,ltemp+2
2B9B A4         +1  7069         mul ab
2B9C 250C       +1  7070         add a,xtemp+0
2B9E F50C       +1  7071         mov xtemp+0,a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   113

                +1  7072     
2BA0 EA         +1  7073         mov a,r2
2BA1 850BF0     +1  7074         mov b,ltemp+3
2BA4 A4         +1  7075         mul ab
2BA5 250C       +1  7076         add a,xtemp+0
2BA7 FA         +1  7077         mov r2,a
2BA8 AB0D       +1  7078         mov r3,xtemp+1
2BAA AC0E       +1  7079         mov r4,xtemp+2
2BAC AD0F       +1  7080         mov r5,xtemp+3
                +1  7081     
2BAE 22         +1  7082         ret         ;all done
                +1  7083     ;******************************
                +1  7084     ;из содержимого  r2-r5  вычесть
                +1  7085     ;содержимое          ltemp..ltemp+3
                +1  7086     ;******************************
2BAF            +1  7087     llsub:
2BAF            +1  7088      lsub:
2BAF ED         +1  7089         mov a,r5
2BB0 C3         +1  7090         clr c
2BB1 950B       +1  7091         subb    a,11
2BB3 FD         +1  7092         mov r5,a
2BB4 EC         +1  7093         mov a,r4
2BB5 950A       +1  7094         subb    a,10
2BB7 FC         +1  7095         mov r4,a
2BB8 EB         +1  7096         mov a,r3
2BB9 9509       +1  7097         subb    a,9
2BBB FB         +1  7098         mov r3,a
2BBC EA         +1  7099         mov a,r2
2BBD 9508       +1  7100         subb    a,8
2BBF FA         +1  7101         mov r2,a
2BC0 22         +1  7102         ret
                +1  7103     
                +1  7104     ;***********************************************
                +1  7105     ;                                                      ст мл
                +1  7106     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7107     ;  r0- адрес младшего байта !!!
                +1  7108     ;результат- r2..r5
                +1  7109     ;***********************************************
                +1  7110     
2BC1 C3         +1  7111     ladd:    clr       c
2BC2 ED         +1  7112          mov       a,r5
2BC3 26         +1  7113          add       a,@r0
2BC4 FD         +1  7114          mov       r5,a
2BC5 18         +1  7115          dec       r0
2BC6 EC         +1  7116          mov       a,r4
2BC7 36         +1  7117          addc      a,@r0
2BC8 FC         +1  7118          mov       r4,a
2BC9 18         +1  7119          dec       r0
2BCA EB         +1  7120          mov       a,r3
2BCB 36         +1  7121          addc      a,@r0
2BCC FB         +1  7122          mov       r3,a
2BCD 18         +1  7123          dec       r0
2BCE EA         +1  7124          mov       a,r2
2BCF 36         +1  7125          addc      a,@r0
2BD0 FA         +1  7126          mov       r2,a
2BD1 22         +1  7127          ret
                +1  7128     ;***********************************************
                +1  7129     ;                                                      ст мл
                +1  7130     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7131     ;  r0- адрес младшего байта !!!
                +1  7132     ;результат- r2..r5
                +1  7133     ;***********************************************
                +1  7134     
2BD2 C3         +1  7135     laddx:    clr       c
2BD3 E2         +1  7136                                             movx            a,@r0
2BD4 2D         +1  7137                                             add                     a,r5
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   114

2BD5 FD         +1  7138               mov     r5,a
2BD6 18         +1  7139                             dec     r0
2BD7 E2         +1  7140                             movx    a,@r0
2BD8 3C         +1  7141                             addc    a,r4
2BD9 FC         +1  7142                             mov     r4,a
2BDA 18         +1  7143                             dec     r0
2BDB E2         +1  7144                             movx    a,@r0
2BDC 3B         +1  7145                             addc    a,r3
2BDD FB         +1  7146                             mov     r3,a
2BDE 18         +1  7147                             dec     r0
2BDF E2         +1  7148                             movx    a,@r0
2BE0 3A         +1  7149                             addc    a,r2
2BE1 FA         +1  7150                             mov       r2,a
2BE2 22         +1  7151                             ret
                +1  7152     
                +1  7153     ;***********************************************
                +1  7154     ;                                                      ст мл
                +1  7155     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7156     ;  dptr- адрес младшего байта !!!
                +1  7157     ;результат- r2..r5
                +1  7158     ;***********************************************
                +1  7159     
2BE3 C3         +1  7160     addx:    clr       c
2BE4 E0         +1  7161                                             movx            a,@dptr
2BE5 2D         +1  7162                                             add                     a,r5
2BE6 FD         +1  7163               mov     r5,a
2BE7 120000   F +1  7164                             call            dedptr;dec     dptr
2BEA E0         +1  7165                             movx    a,@dptr
2BEB 3C         +1  7166                             addc    a,r4
2BEC FC         +1  7167                             mov     r4,a
2BED 120000   F +1  7168                             call            dedptr;dec     dptr
2BF0 E0         +1  7169                             movx    a,@dptr
2BF1 3B         +1  7170                             addc    a,r3
2BF2 FB         +1  7171                             mov     r3,a
2BF3 120000   F +1  7172                             call            dedptr;dec     dptr
2BF6 E0         +1  7173                             movx    a,@dptr
2BF7 3A         +1  7174                             addc    a,r2
2BF8 FA         +1  7175                             mov       r2,a
2BF9 22         +1  7176                             ret
                +1  7177     
2BFA C0D0       +1  7178     dedptr:         push    psw
2BFC C3         +1  7179                                             clr             c
2BFD E582       +1  7180                                             mov             a,dpl
2BFF 9401       +1  7181                                             subb    a,#1
2C01 F582       +1  7182                                             mov             dpl,a
2C03 E583       +1  7183                                             mov             a,dph
2C05 9400       +1  7184                                             subb    a,#0
2C07 F583       +1  7185                                             mov             dph,a
2C09 D0D0       +1  7186                                             pop             psw
2C0B 22         +1  7187                                             ret
                    7188     
                    7189     ;$include (d:\amp\floatm.asm)
                +1  7190     ;       Copyright (C) 1988 HI-TECH Software
                +1  7191     
                +1  7192     ;       Single Precision Floating point arithmetic routines for 8051
                +1  7193     
                +1  7194     ;       The format of floating point numbers is as follows:
                +1  7195     
                +1  7196     ;       -----------------
                +1  7197     ;       *     sign      *  1 bit
                +1  7198     ;       -----------------
                +1  7199     ;       *   exponent    *  8 bits
                +1  7200     ;       -----------------
                +1  7201     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  7202     ;       -----------------
                +1  7203     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   115

                +1  7204     
                +1  7205     ;       As usual for the 8051 the memory layout has the most significant
                +1  7206     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  7207     ;       lowest address.
                +1  7208     
                +1  7209     ;       Calling conventions:
                +1  7210     
                +1  7211     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  7212     ;
                +1  7213     ;       Return value is in r2-r5
                +1  7214     
                +1  7215     ;       Naming conventions: A routine name is constructed by
                +1  7216     
                +1  7217     ;             ASOP
                +1  7218     
                +1  7219     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  7220     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  7221     ;       Conversion routines are named
                +1  7222     
                +1  7223     ;               AStof
                +1  7224     
                +1  7225     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  7226     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  7227     ;       Conversion from float to integer is ftol.
                +1  7228     
                +1  7229     ;               .ORG  5000h
                +1  7230     ;               .CODE
                +1  7231     ;       seg     c_text
                +1  7232     
                +1  7233     ;;      $MOD812
----            +1  7234             CSEG
                +1  7235             ;ORG 1000h
                +1  7236     
                +1  7237                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  7238             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  7239     
                +1  7240     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  7241     ;       macros
                +1  7242     
                +1  7243     saveregs        macro
                +1  7244             push    7
                +1  7245             push    6
                +1  7246             push    1
                +1  7247             push    0
                +1  7248             endm
                +1  7249     
                +1  7250     restregs        macro
                +1  7251             pop     0
                +1  7252             pop     1
                +1  7253             pop     6
                +1  7254             pop     7
                +1  7255             endm
                +1  7256     
                +1  7257     ;addr   
                +1  7258     dan     macro   pad
                +1  7259             mov     a,r5
                +1  7260             add     a,pad+3
                +1  7261             mov     pad+3,a
                +1  7262             mov     a,pad+2
                +1  7263             addc    a,r4
                +1  7264             mov     pad+2,a
                +1  7265             mov     a,pad+1
                +1  7266             addc    a,r3
                +1  7267             mov     pad+1,a
                +1  7268             mov     a,pad+0
                +1  7269             addc    a,r2
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   116

                +1  7270             mov     pad,a
                +1  7271             endm
                +1  7272     
                +1  7273     addl    macro  addr
                +1  7274             mov     a,r5
                +1  7275             add     a,addr+3
                +1  7276             mov     r5,a
                +1  7277             mov     a,addr+2
                +1  7278             addc    a,r4
                +1  7279             mov     r4,a
                +1  7280             mov     a,addr+1
                +1  7281             addc    a,r3
                +1  7282             mov     r3,a
                +1  7283             mov     a,addr+0
                +1  7284             addc    a,r2
                +1  7285             mov     r2,a
                +1  7286             endm
                +1  7287     
                +1  7288     
                +1  7289     add1    macro
                +1  7290             mov     a,r5
                +1  7291             add     a,#1
                +1  7292             mov     r5,a
                +1  7293             clr     a
                +1  7294             addc    a,r4
                +1  7295             mov     r4,a
                +1  7296             clr     a
                +1  7297             addc    a,r3
                +1  7298             mov     r3,a
                +1  7299             clr     a
                +1  7300             addc    a,r2
                +1  7301             mov     r2,a
                +1  7302             endm
                +1  7303     
                +1  7304     shfdn   macro  addr
                +1  7305             clr     c
                +1  7306             mov     a,addr
                +1  7307             rrc     a
                +1  7308             mov     addr,a
                +1  7309             mov     a,addr+1
                +1  7310             rrc     a
                +1  7311             mov     addr+1,a
                +1  7312             mov     a,addr+2
                +1  7313             rrc     a
                +1  7314             mov     addr+2,a
                +1  7315             mov     a,addr+3
                +1  7316             rrc     a
                +1  7317             mov     addr+3,a
                +1  7318             endm
                +1  7319     
                +1  7320     shfup   macro  addr
                +1  7321             clr     c
                +1  7322             mov     a,addr+3
                +1  7323             rlc     a
                +1  7324             mov     addr+3,a
                +1  7325             mov     a,addr+2
                +1  7326             rlc     a
                +1  7327             mov     addr+2,a
                +1  7328             mov     a,addr+1
                +1  7329             rlc     a
                +1  7330             mov     addr+1,a
                +1  7331             mov     a,addr
                +1  7332             rlc     a
                +1  7333             mov     addr,a
                +1  7334             endm
                +1  7335     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   117

                +1  7336     rshift  macro
                +1  7337             clr     c
                +1  7338             mov     a,r2
                +1  7339             rrc     a
                +1  7340             mov     r2,a
                +1  7341             mov     a,r3
                +1  7342             rrc     a
                +1  7343             mov     r3,a
                +1  7344             mov     a,r4
                +1  7345             rrc     a
                +1  7346             mov     r4,a
                +1  7347             mov     a,r5
                +1  7348             rrc     a
                +1  7349             mov     r5,a
                +1  7350             endm
                +1  7351     rshift1 macro
                +1  7352             setb    c
                +1  7353             mov     a,r2
                +1  7354             rrc     a
                +1  7355             mov     r2,a
                +1  7356             mov     a,r3
                +1  7357             rrc     a
                +1  7358             mov     r3,a
                +1  7359             mov     a,r4
                +1  7360             rrc     a
                +1  7361             mov     r4,a
                +1  7362             mov     a,r5
                +1  7363             rrc     a
                +1  7364             mov     r5,a
                +1  7365             endm
                +1  7366     
                +1  7367     
                +1  7368     lshift  macro
                +1  7369             mov     a,r5
                +1  7370             rlc     a
                +1  7371             mov     r5,a
                +1  7372             mov     a,r4
                +1  7373             rlc     a
                +1  7374             mov     r4,a
                +1  7375             mov     a,r3
                +1  7376             rlc     a
                +1  7377             mov     r3,a
                +1  7378             mov     a,r2
                +1  7379             rlc     a
                +1  7380             mov     r2,a
                +1  7381             endm
                +1  7382     
                +1  7383     neg1    macro
                +1  7384             clr     c
                +1  7385             clr     a
                +1  7386             subb    a,r5
                +1  7387             mov     r5,a
                +1  7388             clr     a
                +1  7389             subb    a,r4
                +1  7390             mov     r4,a
                +1  7391             clr     a
                +1  7392             subb    a,r3
                +1  7393             mov     r3,a
                +1  7394             clr     a
                +1  7395             subb    a,r2
                +1  7396             mov     r2,a
                +1  7397             endm
                +1  7398     
                +1  7399     negm    macro  addr
                +1  7400             clr     c
                +1  7401             clr     a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   118

                +1  7402             subb    a,addr+3
                +1  7403             mov     addr+3,a
                +1  7404             clr     a
                +1  7405             subb    a,addr+2
                +1  7406             mov     addr+2,a
                +1  7407             clr     a
                +1  7408             subb    a,addr+1
                +1  7409             mov     addr+1,a
                +1  7410             clr     a
                +1  7411             subb    a,addr
                +1  7412             mov     addr,a
                +1  7413             endm
                +1  7414     
                +1  7415     copytor macro  addr
                +1  7416             mov     r2,addr
                +1  7417             mov     r3,addr+1
                +1  7418             mov     r4,addr+2
                +1  7419             mov     r5,addr+3
                +1  7420             endm
                +1  7421     
                +1  7422     
                +1  7423     copyrto macro  addr
                +1  7424             mov     addr,r2
                +1  7425             mov     addr+1,r3
                +1  7426             mov     addr+2,r4
                +1  7427             mov     addr+3,r5
                +1  7428             endm
                +1  7429     
                +1  7430     
                +1  7431     ;       Internal representation: in this set of routines a floating number
                +1  7432     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  7433     
                +1  7434     ;       Stack offset values
                +1  7435     ;ltemp   equ     28h
                +1  7436     
  0006          +1  7437     cntr    equ     6               ;r6 is the counter
  0007          +1  7438     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  7439     exp1    equ     0               ;exponent 1 in r0
  0002          +1  7440     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  7441     exp2    equ     1               ;exponent 1 in r1
  0008          +1  7442     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  7443     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  7444     
                +1  7445     
                +1  7446     
                +1  7447     
                +1  7448     
                +1  7449     ;DECSIZE EQU     10
                +1  7450     ;NUMSIZE EQU     4
                +1  7451     ;RR4     EQU     4
                +1  7452     ;RR5     EQU     5
                +1  7453     
                +1  7454     ;       unpack1 - unpacks the left operand
                +1  7455     
009E            +1  7456     unpack1:
009E EA         +1  7457             mov     a,r2            ;get sign
009F 5480       +1  7458             anl     a,#80h
00A1 530740     +1  7459             anl     sign,#40h       ;clear other bits
00A4 4207       +1  7460             orl     sign,a          ;store sign
00A6 EB         +1  7461             mov     a,r3            ;get lsb of exponent
00A7 33         +1  7462             rlc     a               ;rotate into carry
00A8 EA         +1  7463             mov     a,r2            ;get rest of exponent
00A9 33         +1  7464             rlc     a               ;and make it 8 bits
00AA F8         +1  7465             mov     r0,a            ;store it
00AB 6006       +1  7466             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  7467             orl     mant1+1,#80h    ;set hidden bit
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   119

00B0 7A00       +1  7468             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  7469             ret
00B3            +1  7470     zer1:
00B3 E4         +1  7471             clr     a
00B4 FA         +1  7472             mov     r2,a
00B5 FB         +1  7473             mov     r3,a
00B6 FC         +1  7474             mov     r4,a
00B7 FD         +1  7475             mov     r5,a            ;zero mantissa
00B8 F8         +1  7476             mov     r0,a            ;zero exponent
00B9 22         +1  7477             ret
                +1  7478     
                +1  7479     ;       unpack2 - unpacks right operand
                +1  7480     
00BA            +1  7481     unpack2:
00BA E508       +1  7482             mov     a,ltemp         ;get sign
00BC 13         +1  7483             rrc     a               ;shift down
00BD 5440       +1  7484             anl     a,#40h          ;mask out sign
00BF 530780     +1  7485             anl     sign,#80h       ;clear old bit
00C2 4207       +1  7486             orl     sign,a
00C4 E509       +1  7487             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  7488             rlc     a               ;rotate into carry
00C7 E508       +1  7489             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  7490             rlc     a               ;and make it 8 bits
00CA F9         +1  7491             mov     r1,a            ;store it
00CB 6007       +1  7492             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  7493             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  7494             mov     mant2,#0        ;clear upper byte
00D3 22         +1  7495             ret
00D4            +1  7496     zer2:
00D4 E4         +1  7497             clr     a
00D5 F508       +1  7498             mov     ltemp,a
00D7 F509       +1  7499             mov     ltemp+1,a
00D9 F50A       +1  7500             mov     ltemp+2,a
00DB F50B       +1  7501             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  7502             ret
                +1  7503     
                +1  7504     ;       pack1 - put operand 1 back into float format
                +1  7505     
00DE            +1  7506     pack1:
00DE E8         +1  7507             mov     a,r0            ;get exponent
00DF C3         +1  7508             clr     c
00E0 13         +1  7509             rrc     a               ;shift down 1 bit
00E1 530780     +1  7510             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  7511             orl     a,r7            ;or in sign bit
00E5 FA         +1  7512             mov     r2,a            ;store
00E6 E8         +1  7513             mov     a,r0            ;get other bit
00E7 03         +1  7514             rr      a               ;rotate into hi bit
00E8 5480       +1  7515             anl     a,#80h          ;mask
00EA 53037F     +1  7516             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  7517             orl     mant1+1,a       ;put in
00EF 22         +1  7518             ret
                +1  7519     
                +1  7520     
                +1  7521     ;       norm1 - normalize the unpacked value in 1
                +1  7522     
00F0            +1  7523     norm1:
00F0 E8         +1  7524             mov     a,r0            ;get exponent
00F1 60C0       +1  7525             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  7526             mov     a,r2            ;get hi byte
00F4 6023       +1  7527             jz      norup           ;zero, so shift up if anything
00F6            +1  7528     nordn:
00F6 EA         +1  7529             mov     a,r2            ;get hi byte
00F7 B4010D     +1  7530             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  7531+3           add1                    ;add in a rounding bit
00FA ED         +1  7532+1           mov     a,r5
00FB 2401       +1  7533+1           add     a,#1
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   120

00FD FD         +1  7534+1           mov     r5,a
00FE E4         +1  7535+1           clr     a
00FF 3C         +1  7536+1           addc    a,r4
0100 FC         +1  7537+1           mov     r4,a
0101 E4         +1  7538+1           clr     a
0102 3B         +1  7539+1           addc    a,r3
0103 FB         +1  7540+1           mov     r3,a
0104 E4         +1  7541+1           clr     a
0105 3A         +1  7542+1           addc    a,r2
0106 FA         +1  7543+1           mov     r2,a
0107            +1  7544     nordn1:
                +1  7545+3           rshift                  ;shift down 1 bit
0107 C3         +1  7546+1           clr     c
0108 EA         +1  7547+1           mov     a,r2
0109 13         +1  7548+1           rrc     a
010A FA         +1  7549+1           mov     r2,a
010B EB         +1  7550+1           mov     a,r3
010C 13         +1  7551+1           rrc     a
010D FB         +1  7552+1           mov     r3,a
010E EC         +1  7553+1           mov     a,r4
010F 13         +1  7554+1           rrc     a
0110 FC         +1  7555+1           mov     r4,a
0111 ED         +1  7556+1           mov     a,r5
0112 13         +1  7557+1           rrc     a
0113 FD         +1  7558+1           mov     r5,a
0114 08         +1  7559             inc     r0              ;adjust exponent
0115 EA         +1  7560             mov     a,r2            ;test high byte
0116 70DE       +1  7561             jnz     nordn           ;loop
0118 22         +1  7562             ret                     ;done
                +1  7563     
0119            +1  7564     norup:
0119 4B         +1  7565             orl     a,r3
011A 4C         +1  7566             orl     a,r4
011B 4D         +1  7567             orl     a,r5            ;test for zero mantissa
011C 6095       +1  7568             jz      zer1            ;it is - make it true zero
011E            +1  7569     norup1:
011E EB         +1  7570             mov     a,r3            ;get mantissa byte
011F 20E710     +1  7571             jb      acc.7,norup2    ;jump if set
0122 C3         +1  7572             clr     c
                +1  7573+3           lshift                  ;shift mantissa up
0123 ED         +1  7574+1           mov     a,r5
0124 33         +1  7575+1           rlc     a
0125 FD         +1  7576+1           mov     r5,a
0126 EC         +1  7577+1           mov     a,r4
0127 33         +1  7578+1           rlc     a
0128 FC         +1  7579+1           mov     r4,a
0129 EB         +1  7580+1           mov     a,r3
012A 33         +1  7581+1           rlc     a
012B FB         +1  7582+1           mov     r3,a
012C EA         +1  7583+1           mov     a,r2
012D 33         +1  7584+1           rlc     a
012E FA         +1  7585+1           mov     r2,a
012F 18         +1  7586             dec     r0              ;adjust exponent
0130 80EC       +1  7587             jmp     norup1
0132            +1  7588     norup2:
0132 22         +1  7589             ret                     ;finito
                +1  7590     
                +1  7591     
                +1  7592     ;       fpdenorm - denormalize one of the two operands so that their
                +1  7593     ;       exponents are equal. This requires the smaller number to have
                +1  7594     ;       its exponent incremented and its mantissa shifted right.
                +1  7595     
0133            +1  7596     denorm:
0133 E8         +1  7597             mov     a,r0
0134 C3         +1  7598             clr     c
0135 99         +1  7599             subb    a,r1            ;compare exponents
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   121

0136 5029       +1  7600             jnc     up2a            ;shift operand 2
0138            +1  7601     up1:
0138 08         +1  7602             inc     r0              ;increment exponent
                +1  7603+3           rshift                  ;shift mantissa down
0139 C3         +1  7604+1           clr     c
013A EA         +1  7605+1           mov     a,r2
013B 13         +1  7606+1           rrc     a
013C FA         +1  7607+1           mov     r2,a
013D EB         +1  7608+1           mov     a,r3
013E 13         +1  7609+1           rrc     a
013F FB         +1  7610+1           mov     r3,a
0140 EC         +1  7611+1           mov     a,r4
0141 13         +1  7612+1           rrc     a
0142 FC         +1  7613+1           mov     r4,a
0143 ED         +1  7614+1           mov     a,r5
0144 13         +1  7615+1           rrc     a
0145 FD         +1  7616+1           mov     r5,a
0146 E8         +1  7617             mov     a,r0
0147 B501EE     +1  7618             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  7619             ret
                +1  7620     
014B            +1  7621     up2:
014B 09         +1  7622             inc     r1              ;increment exponent 2
                +1  7623+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  7624+1           clr     c
014D E508       +1  7625+1           mov     a,mant2
014F 13         +1  7626+1           rrc     a
0150 F508       +1  7627+1           mov     mant2,a
0152 E509       +1  7628+1           mov     a,mant2+1
0154 13         +1  7629+1           rrc     a
0155 F509       +1  7630+1           mov     mant2+1,a
0157 E50A       +1  7631+1           mov     a,mant2+2
0159 13         +1  7632+1           rrc     a
015A F50A       +1  7633+1           mov     mant2+2,a
015C E50B       +1  7634+1           mov     a,mant2+3
015E 13         +1  7635+1           rrc     a
015F F50B       +1  7636+1           mov     mant2+3,a
0161            +1  7637     up2a:
0161 E8         +1  7638             mov     a,r0            ;compare exponents
0162 B501E6     +1  7639             cjne    a,exp2,up2
0165 22         +1  7640             ret                     ;all done
                +1  7641     ;------------------------------------------------------------------
                +1  7642     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  7643     
0166            +1  7644     fladd:
                +1  7645+3           saveregs
0166 C007       +1  7646+1           push    7
0168 C006       +1  7647+1           push    6
016A C001       +1  7648+1           push    1
016C C000       +1  7649+1           push    0
016E 119E       +1  7650             call    unpack1
0170 11BA       +1  7651             call    unpack2
0172 3133       +1  7652             call    denorm
0174 E507       +1  7653             mov     a,sign
0176 30E70D     +1  7654             jnb     acc.7,ok1       ;test left sign
                +1  7655+3           neg1                    ;negate op1
0179 C3         +1  7656+1           clr     c
017A E4         +1  7657+1           clr     a
017B 9D         +1  7658+1           subb    a,r5
017C FD         +1  7659+1           mov     r5,a
017D E4         +1  7660+1           clr     a
017E 9C         +1  7661+1           subb    a,r4
017F FC         +1  7662+1           mov     r4,a
0180 E4         +1  7663+1           clr     a
0181 9B         +1  7664+1           subb    a,r3
0182 FB         +1  7665+1           mov     r3,a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   122

0183 E4         +1  7666+1           clr     a
0184 9A         +1  7667+1           subb    a,r2
0185 FA         +1  7668+1           mov     r2,a
0186            +1  7669     ok1:
0186 E507       +1  7670             mov     a,sign
0188 30E615     +1  7671             jnb     acc.6,ok2       ;test right sign
                +1  7672+3           negm    mant2           ;negate op2
018B C3         +1  7673+1           clr     c
018C E4         +1  7674+1           clr     a
018D 950B       +1  7675+1           subb    a,mant2+3
018F F50B       +1  7676+1           mov     mant2+3,a
0191 E4         +1  7677+1           clr     a
0192 950A       +1  7678+1           subb    a,mant2+2
0194 F50A       +1  7679+1           mov     mant2+2,a
0196 E4         +1  7680+1           clr     a
0197 9509       +1  7681+1           subb    a,mant2+1
0199 F509       +1  7682+1           mov     mant2+1,a
019B E4         +1  7683+1           clr     a
019C 9508       +1  7684+1           subb    a,mant2
019E F508       +1  7685+1           mov     mant2,a
01A0            +1  7686     ok2:
                +1  7687+3           addl    mant2           ;add mantissas
01A0 ED         +1  7688+1           mov     a,r5
01A1 250B       +1  7689+1           add     a,mant2+3
01A3 FD         +1  7690+1           mov     r5,a
01A4 E50A       +1  7691+1           mov     a,mant2+2
01A6 3C         +1  7692+1           addc    a,r4
01A7 FC         +1  7693+1           mov     r4,a
01A8 E509       +1  7694+1           mov     a,mant2+1
01AA 3B         +1  7695+1           addc    a,r3
01AB FB         +1  7696+1           mov     r3,a
01AC E508       +1  7697+1           mov     a,mant2+0
01AE 3A         +1  7698+1           addc    a,r2
01AF FA         +1  7699+1           mov     r2,a
01B0 E4         +1  7700             clr     a
01B1 FF         +1  7701             mov     r7,a            ;clear sign
01B2 EA         +1  7702             mov     a,r2            ;get sign of result
01B3 30E70E     +1  7703             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  7704             mov     r7,a            ;store sign
                +1  7705+3           neg1                    ;negate mantissa
01B7 C3         +1  7706+1           clr     c
01B8 E4         +1  7707+1           clr     a
01B9 9D         +1  7708+1           subb    a,r5
01BA FD         +1  7709+1           mov     r5,a
01BB E4         +1  7710+1           clr     a
01BC 9C         +1  7711+1           subb    a,r4
01BD FC         +1  7712+1           mov     r4,a
01BE E4         +1  7713+1           clr     a
01BF 9B         +1  7714+1           subb    a,r3
01C0 FB         +1  7715+1           mov     r3,a
01C1 E4         +1  7716+1           clr     a
01C2 9A         +1  7717+1           subb    a,r2
01C3 FA         +1  7718+1           mov     r2,a
01C4            +1  7719     ok3:
01C4 11F0       +1  7720             call    norm1
01C6 11DE       +1  7721             call    pack1           ;pack normalized result
                +1  7722+3           restregs                ;and return
01C8 D000       +1  7723+1           pop     0
01CA D001       +1  7724+1           pop     1
01CC D006       +1  7725+1           pop     6
01CE D007       +1  7726+1           pop     7
01D0 22         +1  7727             ret
                +1  7728     ;-------------------------------------------------------------
                +1  7729     ;       Subtract the number ltemp from the number in r2-r5
                +1  7730     
01D1            +1  7731     flsub:
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   123

01D1 630880     +1  7732             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  7733             jmp     fladd           ;and add!
                +1  7734     
                +1  7735     ;================================================================
                +1  7736     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  7737     
01D6            +1  7738     flcmp:
01D6 EA         +1  7739            mov     a,r2            ;get sign of left
01D7 6508       +1  7740            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  7741            jnb     acc.7,cexp      ;same, go check exponent
                +1  7742     ;ifdef SMALL_MODEL
01DC EA         +1  7743             mov     a,r2            ;get sign of left again
01DD 33         +1  7744             rlc     a
01DE 5001       +1  7745             jnc     flout
                +1  7746     ;endif
01E0 D3         +1  7747             setb    c
01E1 22         +1  7748     flout:          ret                    ;return with acc < 0
                +1  7749     
01E2            +1  7750     cexp:
01E2 C3         +1  7751            clr     c
01E3 EA         +1  7752            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  7753            subb    a,ltemp
01E6 7010       +1  7754            jnz     fnd
01E8 EB         +1  7755            mov     a,r3
01E9 9509       +1  7756            subb    a,ltemp+1
01EB 700B       +1  7757            jnz     fnd
01ED EC         +1  7758            mov     a,r4
01EE 950A       +1  7759            subb    a,ltemp+2
01F0 7006       +1  7760            jnz     fnd
01F2 ED         +1  7761            mov     a,r5
01F3 950B       +1  7762            subb    a,ltemp+3
01F5 7001       +1  7763            jnz     fnd
01F7            +1  7764     cdone:
01F7 22         +1  7765            ret                     ;return with acc == 0
01F8            +1  7766     fnd:
01F8 8AF0       +1  7767           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  7768          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  7769            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  7770                         orl         a,#1                          ;make non-zero
0201 B3         +1  7771             cpl     c               ;c=0->1,c=1->0
0202 22         +1  7772             ret
                +1  7773     ;==============================================================
                +1  7774     
                +1  7775     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  7776     ;       the result in r2-r5
                +1  7777     
0203            +1  7778     flmul:
                +1  7779+3           saveregs
0203 C007       +1  7780+1           push    7
0205 C006       +1  7781+1           push    6
0207 C001       +1  7782+1           push    1
0209 C000       +1  7783+1           push    0
020B 119E       +1  7784             call    unpack1
020D 11BA       +1  7785             call    unpack2
020F E4         +1  7786             clr     a
0210 F50C       +1  7787             mov     prod,a
0212 F50D       +1  7788             mov     prod+1,a        ;clear product
0214 F50E       +1  7789             mov     prod+2,a
0216 F50F       +1  7790             mov     prod+3,a
0218 7E07       +1  7791             mov     r6,#7           ;initialize counter
021A            +1  7792     mup1:
                +1  7793+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  7794+1           clr     c
021B E508       +1  7795+1           mov     a,mant2
021D 13         +1  7796+1           rrc     a
021E F508       +1  7797+1           mov     mant2,a
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   124

0220 E509       +1  7798+1           mov     a,mant2+1
0222 13         +1  7799+1           rrc     a
0223 F509       +1  7800+1           mov     mant2+1,a
0225 E50A       +1  7801+1           mov     a,mant2+2
0227 13         +1  7802+1           rrc     a
0228 F50A       +1  7803+1           mov     mant2+2,a
022A E50B       +1  7804+1           mov     a,mant2+3
022C 13         +1  7805+1           rrc     a
022D F50B       +1  7806+1           mov     mant2+3,a
022F 5014       +1  7807             jnc     nobit           ;skip if lsb was zero
                +1  7808+3           dan     prod            ;add multiplicand to product
0231 ED         +1  7809+1           mov     a,r5
0232 250F       +1  7810+1           add     a,prod+3
0234 F50F       +1  7811+1           mov     prod+3,a
0236 E50E       +1  7812+1           mov     a,prod+2
0238 3C         +1  7813+1           addc    a,r4
0239 F50E       +1  7814+1           mov     prod+2,a
023B E50D       +1  7815+1           mov     a,prod+1
023D 3B         +1  7816+1           addc    a,r3
023E F50D       +1  7817+1           mov     prod+1,a
0240 E50C       +1  7818+1           mov     a,prod+0
0242 3A         +1  7819+1           addc    a,r2
0243 F50C       +1  7820+1           mov     prod,a
0245            +1  7821     nobit:
                +1  7822+3           lshift                  ;shift multiplicand up
0245 ED         +1  7823+1           mov     a,r5
0246 33         +1  7824+1           rlc     a
0247 FD         +1  7825+1           mov     r5,a
0248 EC         +1  7826+1           mov     a,r4
0249 33         +1  7827+1           rlc     a
024A FC         +1  7828+1           mov     r4,a
024B EB         +1  7829+1           mov     a,r3
024C 33         +1  7830+1           rlc     a
024D FB         +1  7831+1           mov     r3,a
024E EA         +1  7832+1           mov     a,r2
024F 33         +1  7833+1           rlc     a
0250 FA         +1  7834+1           mov     r2,a
0251 DEC7       +1  7835             djnz    r6,mup1         ;loop if more
                +1  7836     
0253 7E11       +1  7837             mov     r6,#17          ;re-initalize counter
0255 8015       +1  7838             sjmp    mup3
0257            +1  7839     mup11:
                +1  7840+3           shfdn   prod            ;shift product right
0257 C3         +1  7841+1           clr     c
0258 E50C       +1  7842+1           mov     a,prod
025A 13         +1  7843+1           rrc     a
025B F50C       +1  7844+1           mov     prod,a
025D E50D       +1  7845+1           mov     a,prod+1
025F 13         +1  7846+1           rrc     a
0260 F50D       +1  7847+1           mov     prod+1,a
0262 E50E       +1  7848+1           mov     a,prod+2
0264 13         +1  7849+1           rrc     a
0265 F50E       +1  7850+1           mov     prod+2,a
0267 E50F       +1  7851+1           mov     a,prod+3
0269 13         +1  7852+1           rrc     a
026A F50F       +1  7853+1           mov     prod+3,a
026C            +1  7854     mup3:
                +1  7855+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  7856+1           clr     c
026D E508       +1  7857+1           mov     a,mant2
026F 13         +1  7858+1           rrc     a
0270 F508       +1  7859+1           mov     mant2,a
0272 E509       +1  7860+1           mov     a,mant2+1
0274 13         +1  7861+1           rrc     a
0275 F509       +1  7862+1           mov     mant2+1,a
0277 E50A       +1  7863+1           mov     a,mant2+2
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   125

0279 13         +1  7864+1           rrc     a
027A F50A       +1  7865+1           mov     mant2+2,a
027C E50B       +1  7866+1           mov     a,mant2+3
027E 13         +1  7867+1           rrc     a
027F F50B       +1  7868+1           mov     mant2+3,a
0281 5014       +1  7869             jnc     mup2            ;skip if bit not set
                +1  7870+3           dan     prod            ;add to prod
0283 ED         +1  7871+1           mov     a,r5
0284 250F       +1  7872+1           add     a,prod+3
0286 F50F       +1  7873+1           mov     prod+3,a
0288 E50E       +1  7874+1           mov     a,prod+2
028A 3C         +1  7875+1           addc    a,r4
028B F50E       +1  7876+1           mov     prod+2,a
028D E50D       +1  7877+1           mov     a,prod+1
028F 3B         +1  7878+1           addc    a,r3
0290 F50D       +1  7879+1           mov     prod+1,a
0292 E50C       +1  7880+1           mov     a,prod+0
0294 3A         +1  7881+1           addc    a,r2
0295 F50C       +1  7882+1           mov     prod,a
0297            +1  7883     mup2:
0297 DEBE       +1  7884             djnz    r6,mup11        ;loop if more
0299 E8         +1  7885             mov     a,r0            ;get exp1
029A 29         +1  7886             add     a,r1            ;add exp2
029B 247A       +1  7887             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  7888             mov     r0,a            ;store
029E EF         +1  7889             mov     a,r7            ;get sign
029F 23         +1  7890             rl      a               ;rotate bit into msb
02A0 6207       +1  7891             xrl     sign,a          ;xor with other bit
                +1  7892+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  7893+1           mov     r2,prod
02A4 AB0D       +1  7894+1           mov     r3,prod+1
02A6 AC0E       +1  7895+1           mov     r4,prod+2
02A8 AD0F       +1  7896+1           mov     r5,prod+3
02AA 11F0       +1  7897             call    norm1           ;normalize
02AC 11DE       +1  7898             call    pack1
                +1  7899+3           restregs
02AE D000       +1  7900+1           pop     0
02B0 D001       +1  7901+1           pop     1
02B2 D006       +1  7902+1           pop     6
02B4 D007       +1  7903+1           pop     7
02B6 22         +1  7904             ret
                +1  7905     ;-----------------------------------------------------------
                +1  7906     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  7907     
02B7            +1  7908     fldiv:
                +1  7909+3           saveregs
02B7 C007       +1  7910+1           push    7
02B9 C006       +1  7911+1           push    6
02BB C001       +1  7912+1           push    1
02BD C000       +1  7913+1           push    0
02BF 119E       +1  7914             call    unpack1
02C1 11BA       +1  7915             call    unpack2
02C3 E4         +1  7916             clr     a
02C4 F50C       +1  7917             mov     prod,a
02C6 F50D       +1  7918             mov     prod+1,a
02C8 F50E       +1  7919             mov     prod+2,a
02CA F50F       +1  7920             mov     prod+3,a
02CC E9         +1  7921             mov     a,r1            ;check for zero divisor
02CD 6067       +1  7922             jz      div9
02CF E8         +1  7923             mov     a,r0            ;check for zero dividend
02D0 6064       +1  7924             jz      div9
02D2 C3         +1  7925             clr     c
02D3 99         +1  7926             subb    a,r1            ;compute new exponent
02D4 2478       +1  7927             add     a,#127-7        ;unbias
02D6 F8         +1  7928             mov     r0,a            ;store back
02D7 EF         +1  7929             mov     a,r7            ;get sign
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   126

02D8 23         +1  7930             rl      a
02D9 6207       +1  7931             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  7932             mov     r6,#24+7        ;initialize counter
02DD            +1  7933     div1:
                +1  7934+3           shfup   prod            ;shift quotient up
02DD C3         +1  7935+1           clr     c
02DE E50F       +1  7936+1           mov     a,prod+3
02E0 33         +1  7937+1           rlc     a
02E1 F50F       +1  7938+1           mov     prod+3,a
02E3 E50E       +1  7939+1           mov     a,prod+2
02E5 33         +1  7940+1           rlc     a
02E6 F50E       +1  7941+1           mov     prod+2,a
02E8 E50D       +1  7942+1           mov     a,prod+1
02EA 33         +1  7943+1           rlc     a
02EB F50D       +1  7944+1           mov     prod+1,a
02ED E50C       +1  7945+1           mov     a,prod
02EF 33         +1  7946+1           rlc     a
02F0 F50C       +1  7947+1           mov     prod,a
02F2 C3         +1  7948             clr     c
02F3 EA         +1  7949             mov     a,r2            ;compare values
02F4 9508       +1  7950             subb    a,mant2
02F6 4028       +1  7951             jc      div2            ;skip if bigger
02F8 7013       +1  7952             jnz     div3
02FA EB         +1  7953             mov     a,r3            ;compare values
02FB 9509       +1  7954             subb    a,mant2+1
02FD 4021       +1  7955             jc      div2            ;skip if bigger
02FF 700C       +1  7956             jnz     div3
0301 EC         +1  7957             mov     a,r4            ;compare values
0302 950A       +1  7958             subb    a,mant2+2
0304 401A       +1  7959             jc      div2            ;skip if bigger
0306 7005       +1  7960             jnz     div3
0308 ED         +1  7961             mov     a,r5            ;compare values
0309 950B       +1  7962             subb    a,mant2+3
030B 4013       +1  7963             jc      div2            ;skip if bigger
030D            +1  7964     div3:
030D ED         +1  7965             mov     a,r5
030E 950B       +1  7966             subb    a,mant2+3
0310 FD         +1  7967             mov     r5,a
0311 EC         +1  7968             mov     a,r4
0312 950A       +1  7969             subb    a,mant2+2               ;do subtraction
0314 FC         +1  7970             mov     r4,a
0315 EB         +1  7971             mov     a,r3
0316 9509       +1  7972             subb    a,mant2+1               ;do subtraction
0318 FB         +1  7973             mov     r3,a
0319 EA         +1  7974             mov     a,r2
031A 9508       +1  7975             subb    a,mant2         ;do subtraction
031C FA         +1  7976             mov     r2,a
031D 430F01     +1  7977             orl     prod+3,#1       ;set lsb in quotient
0320            +1  7978     div2:
                +1  7979+3           lshift                  ;shift dividend up
0320 ED         +1  7980+1           mov     a,r5
0321 33         +1  7981+1           rlc     a
0322 FD         +1  7982+1           mov     r5,a
0323 EC         +1  7983+1           mov     a,r4
0324 33         +1  7984+1           rlc     a
0325 FC         +1  7985+1           mov     r4,a
0326 EB         +1  7986+1           mov     a,r3
0327 33         +1  7987+1           rlc     a
0328 FB         +1  7988+1           mov     r3,a
0329 EA         +1  7989+1           mov     a,r2
032A 33         +1  7990+1           rlc     a
032B FA         +1  7991+1           mov     r2,a
032C DEAF       +1  7992             djnz    r6,div1         ;loop if more
                +1  7993+3           copytor prod            ;copy quotient
032E AA0C       +1  7994+1           mov     r2,prod
0330 AB0D       +1  7995+1           mov     r3,prod+1
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   127

0332 AC0E       +1  7996+1           mov     r4,prod+2
0334 AD0F       +1  7997+1           mov     r5,prod+3
0336            +1  7998     div9:
0336 11F0       +1  7999             call    norm1           ;now normalize result
0338 11DE       +1  8000             call    pack1           ;pack it up
                +1  8001+3           restregs                ;restore registers
033A D000       +1  8002+1           pop     0
033C D001       +1  8003+1           pop     1
033E D006       +1  8004+1           pop     6
0340 D007       +1  8005+1           pop     7
0342 22         +1  8006             ret
                +1  8007     ;------------------------------------------------------------------
                +1  8008     
                +1  8009     ;       Float to long conversion: if the exponent is less than the
                +1  8010     ;       excess value, the result is zero. If the exponent is so large
                +1  8011     ;       that the value would be shifted out, the result is overflow.
                +1  8012     ;       Otherwise shift the mantissa up or down as required.
                +1  8013     
0343            +1  8014     ftol:
                +1  8015+3           saveregs
0343 C007       +1  8016+1           push    7
0345 C006       +1  8017+1           push    6
0347 C001       +1  8018+1           push    1
0349 C000       +1  8019+1           push    0
034B EA         +1  8020             mov     a,r2
034C B4BF09     +1  8021             cjne    a,#0bfh,ne05
034F EB         +1  8022             mov     a,r3
0350 7006       +1  8023             jnz     ne05
0352 EC         +1  8024             mov     a,r4
0353 7003       +1  8025             jnz     ne05
0355 ED         +1  8026             mov     a,r5
0356 6024       +1  8027             jz      ftol1
0358 119E       +1  8028     ne05:   call    unpack1
035A E8         +1  8029             mov     a,r0            ;get exponent
035B 2482       +1  8030             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  8031             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  8032             mov     a,r7            ;get sign
0361 30E70D     +1  8033             jnb     acc.7,ftol4     ;skip if +ve
                +1  8034+3           neg1                    ;negate it
0364 C3         +1  8035+1           clr     c
0365 E4         +1  8036+1           clr     a
0366 9D         +1  8037+1           subb    a,r5
0367 FD         +1  8038+1           mov     r5,a
0368 E4         +1  8039+1           clr     a
0369 9C         +1  8040+1           subb    a,r4
036A FC         +1  8041+1           mov     r4,a
036B E4         +1  8042+1           clr     a
036C 9B         +1  8043+1           subb    a,r3
036D FB         +1  8044+1           mov     r3,a
036E E4         +1  8045+1           clr     a
036F 9A         +1  8046+1           subb    a,r2
0370 FA         +1  8047+1           mov     r2,a
0371            +1  8048     ftol4:
0371 E8         +1  8049             mov     a,r0            ;get exponent
0372 246A       +1  8050             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  8051             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  8052             mov     r0,a            ;save it
0378 24F8       +1  8053             add     a,#-8           ;if > 8, too big
037A 500E       +1  8054             jnc     ftol3
037C            +1  8055     ftol1:
037C E4         +1  8056             clr     a
037D FA         +1  8057             mov     r2,a
037E FB         +1  8058             mov     r3,a
037F FC         +1  8059             mov     r4,a
0380 FD         +1  8060             mov     r5,a
0381            +1  8061     ftol9:
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   128

                +1  8062+3           restregs
0381 D000       +1  8063+1           pop     0
0383 D001       +1  8064+1           pop     1
0385 D006       +1  8065+1           pop     6
0387 D007       +1  8066+1           pop     7
0389 22         +1  8067             ret
038A            +1  8068     ftol3:
038A E8         +1  8069             mov     a,r0
038B FE         +1  8070             mov     r6,a            ;store in counter
038C 60F3       +1  8071             jz      ftol9           ;if zero, do nothing
038E            +1  8072     ftol33:
                +1  8073+3           lshift                  ;shift up
038E ED         +1  8074+1           mov     a,r5
038F 33         +1  8075+1           rlc     a
0390 FD         +1  8076+1           mov     r5,a
0391 EC         +1  8077+1           mov     a,r4
0392 33         +1  8078+1           rlc     a
0393 FC         +1  8079+1           mov     r4,a
0394 EB         +1  8080+1           mov     a,r3
0395 33         +1  8081+1           rlc     a
0396 FB         +1  8082+1           mov     r3,a
0397 EA         +1  8083+1           mov     a,r2
0398 33         +1  8084+1           rlc     a
0399 FA         +1  8085+1           mov     r2,a
039A DEF2       +1  8086             djnz    r6,ftol33       ;and loop
039C 80E3       +1  8087             sjmp    ftol9
039E            +1  8088     ftol2:
039E F4         +1  8089             cpl     a               ;complement
039F FE         +1  8090             mov     r6,a
03A0 6022       +1  8091             jz      ftol22
03A2            +1  8092     ftol23:
03A2 EF         +1  8093             mov     a,r7
03A3 30E70F     +1  8094             jnb     acc.7,ftol24
                +1  8095+3           rshift1
03A6 D3         +1  8096+1           setb    c
03A7 EA         +1  8097+1           mov     a,r2
03A8 13         +1  8098+1           rrc     a
03A9 FA         +1  8099+1           mov     r2,a
03AA EB         +1  8100+1           mov     a,r3
03AB 13         +1  8101+1           rrc     a
03AC FB         +1  8102+1           mov     r3,a
03AD EC         +1  8103+1           mov     a,r4
03AE 13         +1  8104+1           rrc     a
03AF FC         +1  8105+1           mov     r4,a
03B0 ED         +1  8106+1           mov     a,r5
03B1 13         +1  8107+1           rrc     a
03B2 FD         +1  8108+1           mov     r5,a
03B3 800D       +1  8109             jmp     ftol25
03B5            +1  8110+3   ftol24: rshift                  ;shift down
03B5 C3         +1  8111+1           clr     c
03B6 EA         +1  8112+1           mov     a,r2
03B7 13         +1  8113+1           rrc     a
03B8 FA         +1  8114+1           mov     r2,a
03B9 EB         +1  8115+1           mov     a,r3
03BA 13         +1  8116+1           rrc     a
03BB FB         +1  8117+1           mov     r3,a
03BC EC         +1  8118+1           mov     a,r4
03BD 13         +1  8119+1           rrc     a
03BE FC         +1  8120+1           mov     r4,a
03BF ED         +1  8121+1           mov     a,r5
03C0 13         +1  8122+1           rrc     a
03C1 FD         +1  8123+1           mov     r5,a
03C2 DEDE       +1  8124     ftol25: djnz    r6,ftol23
03C4            +1  8125     ftol22:
                +1  8126+3           add1                    ;round
03C4 ED         +1  8127+1           mov     a,r5
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   129

03C5 2401       +1  8128+1           add     a,#1
03C7 FD         +1  8129+1           mov     r5,a
03C8 E4         +1  8130+1           clr     a
03C9 3C         +1  8131+1           addc    a,r4
03CA FC         +1  8132+1           mov     r4,a
03CB E4         +1  8133+1           clr     a
03CC 3B         +1  8134+1           addc    a,r3
03CD FB         +1  8135+1           mov     r3,a
03CE E4         +1  8136+1           clr     a
03CF 3A         +1  8137+1           addc    a,r2
03D0 FA         +1  8138+1           mov     r2,a
03D1 EF         +1  8139             mov     a,r7
03D2 30E70F     +1  8140             jnb     acc.7,ftol26
                +1  8141+3           rshift1
03D5 D3         +1  8142+1           setb    c
03D6 EA         +1  8143+1           mov     a,r2
03D7 13         +1  8144+1           rrc     a
03D8 FA         +1  8145+1           mov     r2,a
03D9 EB         +1  8146+1           mov     a,r3
03DA 13         +1  8147+1           rrc     a
03DB FB         +1  8148+1           mov     r3,a
03DC EC         +1  8149+1           mov     a,r4
03DD 13         +1  8150+1           rrc     a
03DE FC         +1  8151+1           mov     r4,a
03DF ED         +1  8152+1           mov     a,r5
03E0 13         +1  8153+1           rrc     a
03E1 FD         +1  8154+1           mov     r5,a
03E2 809D       +1  8155             jmp     ftol9
03E4            +1  8156+3   ftol26: rshift
03E4 C3         +1  8157+1           clr     c
03E5 EA         +1  8158+1           mov     a,r2
03E6 13         +1  8159+1           rrc     a
03E7 FA         +1  8160+1           mov     r2,a
03E8 EB         +1  8161+1           mov     a,r3
03E9 13         +1  8162+1           rrc     a
03EA FB         +1  8163+1           mov     r3,a
03EB EC         +1  8164+1           mov     a,r4
03EC 13         +1  8165+1           rrc     a
03ED FC         +1  8166+1           mov     r4,a
03EE ED         +1  8167+1           mov     a,r5
03EF 13         +1  8168+1           rrc     a
03F0 FD         +1  8169+1           mov     r5,a
03F1 808E       +1  8170             jmp     ftol9
                +1  8171     
                +1  8172     ;       arithmetic integer to floating conversions
                +1  8173     
03F3            +1  8174     abtof:
03F3 ED         +1  8175             mov     a,r5
03F4 23         +1  8176             rl      a
03F5 FC         +1  8177             mov     r4,a
03F6 9C         +1  8178             subb    a,r4
03F7 FC         +1  8179             mov     r4,a
03F8 FB         +1  8180             mov     r3,a
03F9 FA         +1  8181             mov     r2,a
03FA 8006       +1  8182             jmp     altof
03FC            +1  8183     awtof:
03FC EC         +1  8184             mov     a,r4
03FD 23         +1  8185             rl      a
03FE FB         +1  8186             mov     r3,a
03FF 9B         +1  8187             subb    a,r3
0400 FB         +1  8188             mov     r3,a
0401 FA         +1  8189             mov     r2,a
0402            +1  8190     altof:
                +1  8191+3           saveregs
0402 C007       +1  8192+1           push    7
0404 C006       +1  8193+1           push    6
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   130

0406 C001       +1  8194+1           push    1
0408 C000       +1  8195+1           push    0
040A EA         +1  8196             mov     a,r2            ;get sign
040B 5480       +1  8197             anl     a,#80h
040D FF         +1  8198             mov     r7,a            ;store it
040E 30E70D     +1  8199             jnb     acc.7,altof1    ;skip if +ve
                +1  8200+3           neg1
0411 C3         +1  8201+1           clr     c
0412 E4         +1  8202+1           clr     a
0413 9D         +1  8203+1           subb    a,r5
0414 FD         +1  8204+1           mov     r5,a
0415 E4         +1  8205+1           clr     a
0416 9C         +1  8206+1           subb    a,r4
0417 FC         +1  8207+1           mov     r4,a
0418 E4         +1  8208+1           clr     a
0419 9B         +1  8209+1           subb    a,r3
041A FB         +1  8210+1           mov     r3,a
041B E4         +1  8211+1           clr     a
041C 9A         +1  8212+1           subb    a,r2
041D FA         +1  8213+1           mov     r2,a
041E            +1  8214     altof1:
041E 7896       +1  8215             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  8216             call    norm1           ;normalize it
0422 11DE       +1  8217             call    pack1           ;and pack up
                +1  8218+3           restregs
0424 D000       +1  8219+1           pop     0
0426 D001       +1  8220+1           pop     1
0428 D006       +1  8221+1           pop     6
042A D007       +1  8222+1           pop     7
042C 22         +1  8223             ret
                +1  8224     
042D            +1  8225     lbtof:
042D 7C00       +1  8226             mov     r4,#0
042F            +1  8227     lwtof:
042F E4         +1  8228             clr     a
0430 FB         +1  8229             mov     r3,a
0431 FA         +1  8230             mov     r2,a
0432            +1  8231     lltof:
                +1  8232+3           saveregs
0432 C007       +1  8233+1           push    7
0434 C006       +1  8234+1           push    6
0436 C001       +1  8235+1           push    1
0438 C000       +1  8236+1           push    0
043A 7F00       +1  8237             mov     r7,#0           ;zero sign
043C 80E0       +1  8238             sjmp    altof1
                +1  8239     
                +1  8240     ;-------------------------------------------------------
                +1  8241     
                +1  8242     
                    8243     
                    8244     ;$include (d:\amp\wriread.asm)
                +1  8245     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  8246     cle256:          mov            IE,#00H
0441 75B601     +1  8247                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  8248                              MOV            PSCTL,#03
                +1  8249                                             
0447 7400       +1  8250                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  8251                                     movx    @dptr,a                         ;wr
044A 758F00     +1  8252                                     mov             PSCTL,#00
044D 75B600     +1  8253                                 mov         FLSCL,#00
0450 75A880     +1  8254                               mov           IE,#80H
0453 22         +1  8255                                     ret
                +1  8256     
                +1  8257     ;чтение памяти программ в r8..r11
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   131

                +1  8258     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  8259     re4byte:        mov                     dph,r2
0456 8B82       +1  8260                                             mov                     dpl,r3
0458 E4         +1  8261                                             clr                     a
0459 93         +1  8262                                             movc            a,@a+dptr
045A F508       +1  8263                                             mov                     r8,a
045C A3         +1  8264                                             inc                     dptr
045D E4         +1  8265                                             clr                     a
045E 93         +1  8266                                             movc            a,@a+dptr
045F F509       +1  8267                                             mov                     r9,a
0461 A3         +1  8268                                             inc                     dptr
0462 E4         +1  8269                                             clr                     a
0463 93         +1  8270                                             movc            a,@a+dptr
0464 F50A       +1  8271                                             mov                     r10,a
0466 A3         +1  8272                                             inc                     dptr
0467 E4         +1  8273                                             clr                     a
0468 93         +1  8274                                             movc            a,@a+dptr
0469 F50B       +1  8275                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  8276                                             ret
                +1  8277      ;чтение памяти программ в r2..r5
                +1  8278     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  8279     rebyte2:        mov                     dph,r2
046E 8B82       +1  8280                                             mov                     dpl,r3
0470 E4         +1  8281                                             clr                     a
0471 93         +1  8282                                             movc            a,@a+dptr
0472 FA         +1  8283                                             mov                     r2,a
0473 A3         +1  8284                                             inc                     dptr
0474 E4         +1  8285                                             clr                     a
0475 93         +1  8286                                             movc            a,@a+dptr
0476 FB         +1  8287                                             mov                     r3,a
0477 A3         +1  8288                                             inc                     dptr
0478 E4         +1  8289                                             clr                     a
0479 93         +1  8290                                             movc            a,@a+dptr
047A FC         +1  8291                                             mov                     r4,a
047B A3         +1  8292                                             inc                     dptr
047C E4         +1  8293                                             clr                     a
047D 93         +1  8294                                             movc            a,@a+dptr
047E FD         +1  8295                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  8296                                             ret
                +1  8297      
                +1  8298     
                +1  8299      ;r7-количество байт
                +1  8300     ;dptr-адр ячейки для записи
                +1  8301     ;r1-адр ячейки  внешнего озу
                +1  8302     
0480 75A800     +1  8303     wrpage:  mov            IE,#00H
0483 75B601     +1  8304     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  8305                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  8306                      movx           a,@r1
048A F0         +1  8307                      movx           @dptr,a                         ;wr
048B 758F00     +1  8308                      mov            PSCTL,#0
048E 75B600     +1  8309                      mov            FLSCL,#00
0491 A3         +1  8310                     inc                     dptr
0492 09         +1  8311                     inc                     r1
0493 DFEE       +1  8312                     djnz            r7,WW5
0495 75A880     +1  8313                     mov             IE,#80H
0498 22         +1  8314                     ret
                +1  8315                             
                +1  8316     
                +1  8317     
                +1  8318                                                             
                +1  8319     
                +1  8320     
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   132

                +1  8321     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8322     ;чтение памяти программ во внешнее озу
                +1  8323     ;вх-r2,r3-адр яч памяти прогр
                +1  8324     ;r1- яч внешнее озу
0499 8A83       +1  8325     copyPP:         mov                     dph,r2
049B 8B82       +1  8326                                             mov                     dpl,r3
049D 7FFF       +1  8327                                             mov                     r7,#0ffh
049F E4         +1  8328     copy1:          clr                     a
04A0 93         +1  8329                                             movc            a,@a+dptr
04A1 F3         +1  8330                                             movx                    @r1,a
04A2 A3         +1  8331                                             inc                     dptr
04A3 09         +1  8332                                             inc                     r1
04A4 DFF9       +1  8333                                             djnz            r7,copy1
04A6 22         +1  8334                                             ret
                +1  8335     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8336     
                +1  8337                                     
                +1  8338     
                +1  8339     ;r8..r11->@r0..@r0+3
                +1  8340     ;r0-адр ячейки
                +1  8341     ;сохранить в ячейке озу
04A7 E508       +1  8342     savelte:        mov     a,ltemp
04A9 F6         +1  8343                                             mov     @r0,a
04AA 08         +1  8344                                             inc     r0
04AB E509       +1  8345                                             mov     a,ltemp+1
04AD F6         +1  8346                                             mov     @r0,a
04AE 08         +1  8347                                             inc     r0
04AF E50A       +1  8348                                             mov     a,ltemp+2
04B1 F6         +1  8349                                             mov     @r0,a
04B2 08         +1  8350                                             inc     r0
04B3 E50B       +1  8351                                             mov     a,ltemp+3
04B5 F6         +1  8352                                             mov     @r0,a
04B6 22         +1  8353                                             ret
                +1  8354     
                +1  8355     ;
                +1  8356     
                +1  8357     
                +1  8358     
                +1  8359     
                +1  8360     
                +1  8361                     
                +1  8362     
                +1  8363     
                +1  8364     
                +1  8365     
                +1  8366      
                    8367     
                    8368                                                   
                    8369     END
                                                                             
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   133

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   03B4H   R   SEG=MAIN   868#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1476 1533 1558 1579 1583 1586 1587 1589 1678 1683 3626 3640 3721
                                           3724 3767 3862 3906 3909 3986 3990 3991 3992 3995 4238 4275 4276 4278 4355
                                           4375 4466 4470 4513 4516 4865 4870 5036 5041 5810 5972 5975
ABRET. . . . . . .  C ADDR   241EH   R   SEG=MAIN   5739 5741#
ABTOF. . . . . . .  C ADDR   03F3H   A      8174#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 682 746 754 762 770 772 792 1147 1158 1166 1245 1815 1824 1833 1842
                                           1863 2247 2272 2277 2281 2286 2289 2292 2295 2298 2486 2547 2593 2604 2696
                                           2705 2713 2722 2863 2906 2931 2936 2940 2943 2946 2949 2952 2955 3286 3374
                                           3420 3442 3461 3483 3509 4415 4421 4458 4547 5313 6402 6581 6659 6662 6919
                                           7571 7654 7671 7703 7741 7769 8031 8033 8051 8094 8140 8199
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   2BE3H   R   SEG=MAIN   903 940 942 944 946 948 950 952 954 956 1022 1024 1026 1028 1030
                                           1032 1034 1036 1038 1041 1043 1045 1047 1049 1051 1053 1055 1057 1059 1078
                                           1080 1082 7160#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1532 1544 1548 1563 1588 1591 1592 1682 1686 3639 3643 3718 3722
                                           3764 3768 3859 3863 3908 3912 3994 4007 4248 4262 4264 4266 4277 4280 4365
                                           4376 4471 4517 4869 4873 5040 5044 5611 5630 5648 5711 5728 5974 5977 6323
                                           6355
ADRBLOK. . . . . .  C ADDR   2897H   R   SEG=MAIN   3358 3381 3737 3880 4787 4955 5106 6367#
AFTERK . . . . . .  C ADDR   06ABH   R   SEG=MAIN   1175 1254#
AGE2 . . . . . . .  C ADDR   024EH   R   SEG=MAIN   634# 637
AGE9 . . . . . . .  C ADDR   0871H   R   SEG=MAIN   1480# 1483
AGEON. . . . . . .  C ADDR   025CH   R   SEG=MAIN   643# 645
ALLSUM . . . . . .  C ADDR   0352H   R   SEG=MAIN   812# 847 865 881
ALMUL. . . . . . .  C ADDR   2B2AH   R   SEG=MAIN   7006#
ALTOF. . . . . . .  C ADDR   0402H   A      1141 1239 1270 1278 1296 1312 1323 1340 1353 1438 1975 2085 2162 2200
                                           3771 3868 4379 4474 4520 4618 4696 4704 4722 4828 4840 4855 4939 5001 5017
                                           5090 5152 5167 8182 8190#
ALTOF1 . . . . . .  C ADDR   041EH   A      8199 8214# 8238
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   0611H   R   SEG=MAIN   1139 1155#
AN_T7. . . . . . .  C ADDR   11F9H   R   SEG=MAIN   2956# 3031 3041
AUTOKA . . . . . .  C ADDR   0C81H   R   SEG=MAIN   1173 2130#
AVPGO. . . . . . .  C ADDR   07DCH   R   SEG=MAIN   1400 1402#
AVTDEC1. . . . . .  C ADDR   066DH   R   SEG=MAIN   1208 1217#
AWTOF. . . . . . .  C ADDR   03FCH   A      8183#
B. . . . . . . . .  D ADDR   00F0H   A      122# 5458 5830 7009 7012 7014 7018 7022 7026 7030 7035 7039 7046 7050
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   134

                                           7054 7060 7064 7068 7074 7767 7768
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 462#
BFORM. . . . . . .  C ADDR   27D4H   R   SEG=MAIN   6172 6177 6189# 6215
BIFL_KT. . . . . .  B ADDR   0021H.5 A      337# 4614 4670 4769
BIN30. . . . . . .  C ADDR   2946H   R   SEG=MAIN   6569# 6595
BIN31. . . . . . .  C ADDR   294AH   R   SEG=MAIN   6574# 6578
BIN32. . . . . . .  C ADDR   295AH   R   SEG=MAIN   6587# 6592
BIN41. . . . . . .  C ADDR   296BH   R   SEG=MAIN   6603# 6613
BINDEC . . . . . .  C ADDR   293AH   R   SEG=MAIN   1534 1590 1684 3641 3910 3996 4279 4871 5042 5976 6548#
BITAKT . . . . . .  B ADDR   0023H.2 A      356# 1769 1770 1773
BITAVP . . . . . .  B ADDR   0020H.5 A      327# 1366 1599 1759 3019 3020 3022
BITBON . . . . . .  B ADDR   0021H.2 A      334# 1795 1919 2106 2130 2307 2308 2316 6403
BITBUF . . . . . .  B ADDR   0021H.0 A      332#
BITEIZM. . . . . .  B ADDR   0022H.5 A      347# 1264 1705 1712 1777 2990 3006 4151 5377
BITIZM . . . . . .  B ADDR   0020H.4 A      326# 583 714 1604 2278 2359 2444 2479 2510 2937 2993 3117 3140 3215 3246
                                           3271 3377 3490 3741 3789 3817 3978 4106 4152 4199 4311 4388 4502
BITKLB . . . . . .  B ADDR   0022H.2 A      344# 1333 1793 2283 2992 3010 3018 3025 4386 4684
BITMAS . . . . . .  B ADDR   0020H.1 A      323# 1089 1092 6155
BITMEM . . . . . .  B ADDR   0021H.3 A      335# 1668 2690 3249 3267 3279 3376 3489 3742 3788 3977
BITMENU. . . . . .  B ADDR   0022H.1 A      343# 1667 2509 2621 2994 3270 3797 3816 4111 4153 4198 4310 4385
BITMIG . . . . . .  B ADDR   0023H.1 A      355# 2586 2774 2873 3183 3538 3678 3691 4217 4344 4450 4551 5895 5921
                                           5946 5958 6021 6028 6034 6040
BITNUL . . . . . .  B ADDR   0021H.7 A      339# 1414 1623 1740 2347 3039 3043 3044 3051
BITOLL . . . . . .  B ADDR   0022H.7 A      349# 658 1607 1665 2995
BITPAR . . . . . .  B ADDR   0022H.6 A      348# 4117 4685
BITPRD . . . . . .  B ADDR   0021H.1 A      333# 1918
BITRS. . . . . . .  B ADDR   0020H.3 A      325#
BITT2. . . . . . .  B ADDR   0022H.0 A      342# 1664 2445 2480 2483 3058 3216
BITV19 . . . . . .  B ADDR   0022H.3 A      345# 527 531 2657 2662 2668 4095 4100 4181 4194 4316 4320 4325
BITVI11. . . . . .  B ADDR   0020H.6 A      328# 1364 1380 1423 2301 2303 2358 2508 2989 3109 3116 3269 4501
BITVICH. . . . . .  B ADDR   0022H.4 A      346# 1422 1663 2302 2360 2370 2507 2515 3076 3108 3139 3268 4500
BITZNAK. . . . . .  B ADDR   0020H.0 A      322# 683 729
BITZNB . . . . . .  B ADDR   0023H.3 A      357# 4521 5737 5740
BITZUS . . . . . .  B ADDR   0020H.7 A      329# 1415 1624 2033 2036 2405
BLOIN. . . . . . .  C ADDR   1697H   R   SEG=MAIN   3646# 3651
BLOKVV . . . . . .  C ADDR   1669H   R   SEG=MAIN   3616#
BLOKVVC. . . . . .  C ADDR   1673H   R   SEG=MAIN   3619 3622#
BL_LI. . . . . . .  C ADDR   1634H   R   SEG=MAIN   3566 3574#
BONPART. . . . . .  C ADDR   0C54H   R   SEG=MAIN   2105#
BOUT7. . . . . . .  C ADDR   13D2H   R   SEG=MAIN   3226# 3228
BRET . . . . . . .  C ADDR   225FH   R   SEG=MAIN   5398 5403 5407#
BUFDEC . . . . . .  C ADDR   09B9H   R   SEG=MAIN   1689# 1694
BUFIND . . . . . .  D ADDR   0040H   A      298# 633 637 642 645 651 1479 1483 1549 1570 1591 1592 1593 1643 1648
                                           1687 1695 1697 1702 1738 1757 1763 1771 1774 1779 1794 1796 2266 2313 2317
                                           2561 2579 2595 2597 2600 2660 2661 2666 2667 2769 2813 2832 2924 2998 3060
                                           3118 3119 3166 3170 3196 3218 3232 3239 3250 3251 3349 3533 3560 3588 3617
                                           3644 3658 3659 3663 3664 3671 3672 3677 3693 3832 3839 3913 3921 3923 3939
                                           3963 3997 4006 4008 4072 4094 4101 4209 4247 4280 4281 4282 4283 4285 4319
                                           4324 4336 4364 4387 4442 4488 4874 4882 4886 5045 5053 5057 5213 5245 5456
                                           5469 5475 5482 5610 5629 5647 5710 5727 5738 5898 5924 5978 6025 6046 6322
                                           6354 6404
BUFL_DEC . . . . .  C ADDR   2109H   R   SEG=MAIN   5178#
BUFMEA . . . . . .  C ADDR   1F60H   R   SEG=MAIN   4876# 4881
BUFMIN . . . . . .  C ADDR   2053H   R   SEG=MAIN   5047# 5052
BUFON. . . . . . .  C ADDR   0DDAH   R   SEG=MAIN   2307 2316#
BUFR . . . . . . .  C ADDR   0916H   R   SEG=MAIN   1572# 1577
BUFR2. . . . . . .  C ADDR   08F8H   R   SEG=MAIN   1551# 1556
BUFR3. . . . . . .  C ADDR   08F1H   R   SEG=MAIN   1542 1547#
BUFR30 . . . . . .  C ADDR   08F4H   R   SEG=MAIN   1545 1549#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      7764# 7768
CELLBIT. . . . . .  D ADDR   0020H   A      321# 322 323 324 325 326 327 328 329
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   135

CELLBIT1 . . . . .  D ADDR   0021H   A      331# 332 333 334 335 337 339
CELLBIT2 . . . . .  D ADDR   0022H   A      341# 342 343 344 345 346 347 348 349
CELLBIT3 . . . . .  D ADDR   0023H   A      353# 354 355 356 357
CEXP . . . . . . .  C ADDR   01E2H   A      7741 7750#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   2302H   R   SEG=MAIN   1460 3052 4477 5542#
CH1. . . . . . . .  C ADDR   2322H   R   SEG=MAIN   5362 5553#
CH10 . . . . . . .  C ADDR   2306H   R   SEG=MAIN   864 1103 3898 5543#
CH100. . . . . . .  C ADDR   231AH   R   SEG=MAIN   811 5548#
CH10000. . . . . .  C ADDR   2316H   R   SEG=MAIN   5547#
CH150H . . . . . .  C ADDR   236AH   R   SEG=MAIN   5572#
CH2. . . . . . . .  C ADDR   231EH   R   SEG=MAIN   1098 5549#
CH20 . . . . . . .  C ADDR   24E5H   R   SEG=MAIN   846 1108 5861#
CH2THO . . . . . .  C ADDR   234AH   R   SEG=MAIN   2169 2207 5564#
CH320H . . . . . .  C ADDR   2366H   R   SEG=MAIN   5571# 6375
CH4. . . . . . . .  C ADDR   230EH   R   SEG=MAIN   1112 5545#
CH43 . . . . . . .  C ADDR   18A2H   R   SEG=MAIN   3915# 3920
CH43_42. . . . . .  C ADDR   1948H   R   SEG=MAIN   4010# 4015
CH5. . . . . . . .  C ADDR   230AH   R   SEG=MAIN   880 5544#
CH57 . . . . . . .  C ADDR   24E1H   R   SEG=MAIN   5860#
CH954. . . . . . .  C ADDR   2312H   R   SEG=MAIN   5546#
CHAIBL . . . . . .  C ADDR   14E2H   R   SEG=MAIN   3351 3353#
CHAIPR . . . . . .  C ADDR   17F7H   R   SEG=MAIN   3834 3836#
CHANMA . . . . . .  C ADDR   0FA9H   R   SEG=MAIN   2593 2602#
CHANZ. . . . . . .  C ADDR   0F90H   R   SEG=MAIN   2547 2591#
CHAVT. . . . . . .  D ADDR   0081H   A      371# 562 1164 1209 1217 2122 2226 4107
CHBEFORE . . . . .  D ADDR   009BH   A      381# 585 808 822 841 859 875
CHBLOK . . . . . .  D ADDR   00D6H   A      408# 4785 4835 4851 4953 5007 5104 5158
CHBUF. . . . . . .  D ADDR   00CFH   A      405# 596 1893 2001 2042 2047 2107 2115 3786 5178 5183
CHBUF1 . . . . . .  X ADDR   0E00H   A      438# 1903 1988
CHCMP. . . . . . .  C ADDR   2202H   R   SEG=MAIN   1170 5339#
CHDEC. . . . . . .  C ADDR   2215H   R   SEG=MAIN   1218 1231 5354#
CHDEL. . . . . . .  D ADDR   0083H   A      372# 2066 2093 2132 2182 2220
CHDELMO. . . . . .  C ADDR   0C3FH   R   SEG=MAIN   2076 2093# 2098
CHIF . . . . . . .  C ADDR   252AH   R   SEG=MAIN   5902 5905#
CHIF5. . . . . . .  C ADDR   2532H   R   SEG=MAIN   5908 5910#
CHIFB. . . . . . .  C ADDR   2555H   R   SEG=MAIN   5928 5931#
CHIFB1 . . . . . .  C ADDR   255BH   R   SEG=MAIN   5930 5931 5934#
CHIFL5 . . . . . .  C ADDR   2563H   R   SEG=MAIN   5938 5941#
CHIFOUR. . . . . .  C ADDR   2544H   R   SEG=MAIN   5915 5917 5921#
CHIND. . . . . . .  D ADDR   00ACH   A      387# 1382 1800
CHIND2 . . . . . .  D ADDR   0033H   A      315# 716 718 726
CHINKOR. . . . . .  D ADDR   0098H   A      370# 557 790 1156 1169 1211 1225 1230 2100
CHK. . . . . . . .  C ADDR   2362H   R   SEG=MAIN   1334 5570#
CHKL . . . . . . .  D ADDR   003DH   A      305# 696 698 706 708 709 711 2423 2450 2498 2970 3255 3969 4391
CHMAS. . . . . . .  D ADDR   006EH   A      302# 1086 1093 1116 6154
CHMASN . . . . . .  D ADDR   003FH   A      306# 797 806 842 860 876 892 1091 1093 1094
CHMINUS. . . . . .  C ADDR   287CH   R   SEG=MAIN   3371 3417 3439 3458 3480 6337# 6399
CHTADC . . . . . .  C ADDR   21ACH   R   SEG=MAIN   5271#
CHTHO. . . . . . .  C ADDR   2342H   R   SEG=MAIN   1303 1341 4627 4712 4730 5562#
CHTHOU . . . . . .  C ADDR   23E9H   R   SEG=MAIN   5698#
CHZAP. . . . . . .  C ADDR   22FEH   R   SEG=MAIN   1882 5541#
CH_1 . . . . . . .  C ADDR   232AH   R   SEG=MAIN   588 1496 1519 1900 2027 2044 2119 3869 5180 5555#
CH_10. . . . . . .  C ADDR   235AH   R   SEG=MAIN   1502 1525 1984 2014 4380 4860 5030 5568#
CH_10TH. . . . . .  C ADDR   2356H   R   SEG=MAIN   1395 5567#
CH_2 . . . . . . .  C ADDR   232EH   R   SEG=MAIN   1895 1979 2007 2023 5556#
CH_200 . . . . . .  C ADDR   2352H   R   SEG=MAIN   5566#
CH_220 . . . . . .  C ADDR   234EH   R   SEG=MAIN   1357 5565#
CH_22T . . . . . .  C ADDR   2427H   R   SEG=MAIN   1448 5746#
CH_250 . . . . . .  C ADDR   235EH   R   SEG=MAIN   1259 5569#
CH_4 . . . . . . .  C ADDR   2332H   R   SEG=MAIN   2017 3872 5557#
CH_5 . . . . . . .  C ADDR   2336H   R   SEG=MAIN   5558#
CH_500 . . . . . .  C ADDR   2423H   R   SEG=MAIN   1444 5745#
CH_7 . . . . . . .  C ADDR   233AH   R   SEG=MAIN   2111 5559#
CH_953 . . . . . .  C ADDR   233EH   R   SEG=MAIN   5561#
CH_B . . . . . . .  C ADDR   241FH   R   SEG=MAIN   1464 5743#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   136

CH_FL. . . . . . .  C ADDR   242BH   R   SEG=MAIN   1488 5747#
CH_M3. . . . . . .  C ADDR   236EH   R   SEG=MAIN   5573#
CH_MLN . . . . . .  C ADDR   2326H   R   SEG=MAIN   5554#
CIKLWR . . . . . .  C ADDR   27AAH   R   SEG=MAIN   6160#
CKCON. . . . . . .  D ADDR   008EH   A      30# 480 511
CL4. . . . . . . .  C ADDR   2380H   R   SEG=MAIN   5590# 5592
CL4N . . . . . . .  C ADDR   2386H   R   SEG=MAIN   5599# 5601
CLE20. . . . . . .  C ADDR   1935H   R   SEG=MAIN   4000# 4002
CLE256 . . . . . .  C ADDR   043EH   A      4187 4660 4762 8246#
CLEAR. . . . . . .  C ADDR   2934H   R   SEG=MAIN   6526 6530# 6560
CLEAR4 . . . . . .  C ADDR   237DH   R   SEG=MAIN   820 1411 1413 1559 1580 1620 1622 2344 2346 3036 3038 4784 5588#
CLEARN . . . . . .  C ADDR   2385H   R   SEG=MAIN   3719 3765 3860 4239 4356 4467 4514 5597#
CLMASSIX . . . . .  C ADDR   279AH   R   SEG=MAIN   548 1409 1618 2104 2230 2342 3034 3214 6148#
CLMASV . . . . . .  C ADDR   07E1H   R   SEG=MAIN   1404 1406#
CLMAX. . . . . . .  C ADDR   279FH   R   SEG=MAIN   6150# 6153
CLR11. . . . . . .  C ADDR   2935H   R   SEG=MAIN   6532# 6534
CLRDEC . . . . . .  C ADDR   292EH   R   SEG=MAIN   6524#
CLRNUM . . . . . .  C ADDR   2932H   R   SEG=MAIN   6527# 6641
CLRVICH. . . . . .  C ADDR   1342H   R   SEG=MAIN   3139# 3156
CNTR . . . . . . .  N NUMB   0006H   A      7437#
CO02S. . . . . . .  C ADDR   22E6H   R   SEG=MAIN   5525# 5529
CO05S. . . . . . .  C ADDR   22F3H   R   SEG=MAIN   5534# 5538
CO1S . . . . . . .  C ADDR   22DDH   R   SEG=MAIN   5519# 5519
CO2S . . . . . . .  C ADDR   22D9H   R   SEG=MAIN   5517# 5521
COMPA1 . . . . . .  C ADDR   088DH   R   SEG=MAIN   1496# 1505
COMPA2 . . . . . .  C ADDR   08C3H   R   SEG=MAIN   1519# 1528
COND . . . . . . .  C ADDR   280EH   R   SEG=MAIN   6244#
COPY1. . . . . . .  C ADDR   049FH   A      8328# 8333
COPYPP . . . . . .  C ADDR   0499H   A      4174 4639 4740 8325#
COPY_HL. . . . . .  D ADDR   00D7H   A      409# 3885 4021 4777 4793 4808 4946 4961 4976 5097 5112 5127
COUNT. . . . . . .  C ADDR   22BBH   R   SEG=MAIN   5491# 5491
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   22C2H   R   SEG=MAIN   5497# 5497
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 485
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1890
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1887
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 486
DAC1H. . . . . . .  D ADDR   00D6H   A      97#
DAC1L. . . . . . .  D ADDR   00D5H   A      96#
DCOA . . . . . . .  C ADDR   2813H   R   SEG=MAIN   6248# 6250
DCOB . . . . . . .  C ADDR   281AH   R   SEG=MAIN   6252# 6270
DCOC . . . . . . .  C ADDR   2825H   R   SEG=MAIN   6262# 6267
DCOD . . . . . . .  C ADDR   2832H   R   SEG=MAIN   6269 6272#
DDOUTF . . . . . .  C ADDR   15E9H   R   SEG=MAIN   3340 3396 3519 3527# 3612
DDOUTFR. . . . . .  C ADDR   14C6H   R   SEG=MAIN   3340# 3346
DEC30. . . . . . .  C ADDR   2987H   R   SEG=MAIN   6651# 6676
DEC31. . . . . . .  C ADDR   298CH   R   SEG=MAIN   6657# 6664
DEC32. . . . . . .  C ADDR   299CH   R   SEG=MAIN   6669# 6673
DECBIN . . . . . .  C ADDR   297AH   R   SEG=MAIN   3723 3769 3864 4377 4472 4518 6630#
DECSIZE. . . . . .  N NUMB   000AH   A      6505# 6525 6559 6586 6599 6602 6656
DECT2. . . . . . .  C ADDR   29A5H   R   SEG=MAIN   6647 6679#
DEDPTR . . . . . .  C ADDR   2BFAH   R   SEG=MAIN   7164 7168 7172 7178#
DENORM . . . . . .  C ADDR   0133H   A      7596# 7652
DGOTO7 . . . . . .  C ADDR   177BH   R   SEG=MAIN   3772# 3780
DIAP . . . . . . .  D ADDR   00AEH   A      389# 576 1399 1601 1701 1929 2336 2376 3027 4284 4667 5378 5399 5661 5676
                                           5827 5889
DIINC. . . . . . .  C ADDR   0DFFH   R   SEG=MAIN   2339 2342#
DIKDN. . . . . . .  C ADDR   24B9H   R   SEG=MAIN   5829 5849#
DIKDW. . . . . . .  C ADDR   23D1H   R   SEG=MAIN   5665 5686#
DIKM . . . . . . .  C ADDR   23E7H   R   SEG=MAIN   5697#
DIPAR. . . . . . .  C ADDR   23E5H   R   SEG=MAIN   5696#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   137

DIV1 . . . . . . .  C ADDR   02DDH   A      7933# 7992
DIV2 . . . . . . .  C ADDR   0320H   A      7951 7955 7959 7963 7978#
DIV3 . . . . . . .  C ADDR   030DH   A      7952 7956 7960 7964#
DIV9 . . . . . . .  C ADDR   0336H   A      7922 7924 7998#
DIVIDE . . . . . .  C ADDR   2A65H   R   SEG=MAIN   6176 6865#
DONE . . . . . . .  C ADDR   29D4H   R   SEG=MAIN   6695 6706#
DONE1. . . . . . .  C ADDR   29D2H   R   SEG=MAIN   6698 6701 6704#
DOSH . . . . . . .  C ADDR   2AEEH   R   SEG=MAIN   6940 6956#
DOSUB. . . . . . .  C ADDR   2ADCH   R   SEG=MAIN   6924 6928 6932 6936 6937 6941#
DPH. . . . . . . .  D ADDR   0083H   A      19# 554 600 608 615 622 2258 2852 2917 3385 3387 3890 3892 4026 4031 4536
                                           4778 4790 4795 4804 4806 4809 4820 4907 4909 4947 4958 4963 4972 4974 4977
                                           4988 5098 5109 5114 5123 5125 5128 5139 6108 6116 6383 6391 6423 6712 6748
                                           6783 6786 6798 6821 7183 7185 8259 8279 8325
DPL. . . . . . . .  D ADDR   0082H   A      18# 603 611 618 625 2257 2853 2916 3382 3384 3886 3888 4023 4034 4537
                                           4781 4788 4798 4801 4803 4812 4816 4904 4906 4950 4956 4966 4969 4971 4980
                                           4984 5101 5107 5117 5120 5122 5131 5135 6109 6115 6380 6394 6427 6728 6764
                                           6785 6799 6802 6836 7180 7182 8260 8280 8326
DVIG0. . . . . . .  C ADDR   0A9AH   R   SEG=MAIN   1836# 1838
DVIG1. . . . . . .  C ADDR   0A8FH   R   SEG=MAIN   1827# 1829
DVIG2. . . . . . .  C ADDR   0A84H   R   SEG=MAIN   1818# 1820
DVIG3. . . . . . .  C ADDR   0A78H   R   SEG=MAIN   1809# 1811
DVIG4. . . . . . .  C ADDR   0AA6H   R   SEG=MAIN   1847# 1849
DVIG6. . . . . . .  C ADDR   0AC8H   R   SEG=MAIN   1875# 1877
DVM. . . . . . . .  C ADDR   0AC6H   R   SEG=MAIN   1863 1874#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 483
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 534 700 2244 2903 5243 5255
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDKALIB . . . . .  C ADDR   1D90H   R   SEG=MAIN   3016 4613#
ENDSDV . . . . . .  C ADDR   0ACCH   R   SEG=MAIN   1869 1878#
ENDSUM . . . . . .  C ADDR   059FH   R   SEG=MAIN   904 957 1060 1085#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU0 . . . . . . .  C ADDR   08BEH   R   SEG=MAIN   1499 1515#
EQU00. . . . . . .  C ADDR   08DCH   R   SEG=MAIN   1517 1522 1531#
EQU1L. . . . . . .  C ADDR   10E5H   R   SEG=MAIN   2780 2784#
EQU2L. . . . . . .  C ADDR   164FH   R   SEG=MAIN   3598 3603#
ERRA0. . . . . . .  C ADDR   1CAFH   R   SEG=MAIN   4480 4492#
ERRA01 . . . . . .  C ADDR   07F7H   R   SEG=MAIN   1418# 1463
ERROR. . . . . . .  C ADDR   25C0H   R   SEG=MAIN   1425 4307 4495 5221 5235 6044#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168# 1965 2892 4570
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      7439#
EXP2 . . . . . . .  N NUMB   0001H   A      7441# 7618 7639
EXTCLE . . . . . .  C ADDR   01BEH   R   SEG=MAIN   551# 555
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDEXT. . . . . .  C ADDR   23CAH   R   SEG=MAIN   4641 5675#
FINDKOEF . . . . .  C ADDR   23BBH   R   SEG=MAIN   1337 5660#
FINDMEM. . . . . .  C ADDR   1049H   R   SEG=MAIN   2620 2690#
FINDR. . . . . . .  C ADDR   2512H   R   SEG=MAIN   1585 4274 5889#
FINIS. . . . . . .  C ADDR   2B19H   R   SEG=MAIN   6884 6985#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      2000 4832 4844 7644# 7733
FLCMP. . . . . . .  C ADDR   01D6H   A      1261 1359 1397 1446 1450 1462 1498 1521 1897 4479 5003 5019 5154 5169
                                           7738#
FLDIV. . . . . . .  C ADDR   02B7H   A      1284 1305 1343 1471 1490 1504 2016 2171 2209 4625 4710 4728 4859 4862
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   138

                                           5032 7908#
FLMUL. . . . . . .  C ADDR   0203H   A      1150 1250 1302 1348 1466 1527 1987 2009 2019 2025 2029 3874 4382 4629
                                           4714 4732 7778#
FLOUT. . . . . . .  C ADDR   01E1H   A      7745 7748#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 8247 8253 8304 8309
FLSUB. . . . . . .  C ADDR   01D1H   A      1242 1902 2046 2114 2167 2205 3871 5182 7731#
FND. . . . . . . .  C ADDR   01F8H   A      7754 7757 7760 7763 7766#
FO1M . . . . . . .  C ADDR   27D1H   R   SEG=MAIN   6182 6186#
FO2M . . . . . . .  C ADDR   27DAH   R   SEG=MAIN   6189 6191#
FORM4. . . . . . .  C ADDR   27DBH   R   SEG=MAIN   6184 6190 6194#
FT1IZM . . . . . .  C ADDR   0EE9H   R   SEG=MAIN   2493#
FTOL . . . . . . .  C ADDR   0343H   A      1195 1350 1474 3875 4630 4733 4863 5033 5971 8014#
FTOL1. . . . . . .  C ADDR   037CH   A      8027 8031 8055#
FTOL2. . . . . . .  C ADDR   039EH   A      8051 8088#
FTOL22 . . . . . .  C ADDR   03C4H   A      8091 8125#
FTOL23 . . . . . .  C ADDR   03A2H   A      8092# 8124
FTOL24 . . . . . .  C ADDR   03B5H   A      8094 8110#
FTOL25 . . . . . .  C ADDR   03C2H   A      8109 8124#
FTOL26 . . . . . .  C ADDR   03E4H   A      8140 8156#
FTOL3. . . . . . .  C ADDR   038AH   A      8054 8068#
FTOL33 . . . . . .  C ADDR   038EH   A      8072# 8086
FTOL4. . . . . . .  C ADDR   0371H   A      8033 8048#
FTOL9. . . . . . .  C ADDR   0381H   A      8061# 8071 8087 8155 8170
FULKALIB . . . . .  C ADDR   1DFFH   R   SEG=MAIN   4668 4683# 4771
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   491# 492
GO23NO . . . . . .  C ADDR   15AEH   R   SEG=MAIN   3397 3495#
GO31L. . . . . . .  C ADDR   10EBH   R   SEG=MAIN   2758 2789#
GO41L. . . . . . .  C ADDR   10F0H   R   SEG=MAIN   2789 2791#
GOA2 . . . . . . .  C ADDR   0797H   R   SEG=MAIN   1363 1365 1368# 1390
GOA3A2 . . . . . .  C ADDR   07A1H   R   SEG=MAIN   1373#
GOCIKLE. . . . . .  C ADDR   0BD8H   R   SEG=MAIN   1920 2004 2033# 2040 2049
GOFULL . . . . . .  C ADDR   15E1H   R   SEG=MAIN   3501 3523#
GOGO7. . . . . . .  C ADDR   1CCDH   R   SEG=MAIN   4453 4458 4505#
GOKAA2 . . . . . .  C ADDR   07BFH   R   SEG=MAIN   1388#
GOKLB. . . . . . .  C ADDR   0DC2H   R   SEG=MAIN   2283 2305#
GOOFF1 . . . . . .  C ADDR   1535H   R   SEG=MAIN   3411# 3420
GOOFF2 . . . . . .  C ADDR   1553H   R   SEG=MAIN   3433# 3442
GOOFF3 . . . . . .  C ADDR   1571H   R   SEG=MAIN   3452# 3461
GOOFF4 . . . . . .  C ADDR   158FH   R   SEG=MAIN   3474# 3483
GOONIN . . . . . .  C ADDR   07B1H   R   SEG=MAIN   1381# 1416 1428 1608 1625
GOONIN1. . . . . .  C ADDR   0958H   R   SEG=MAIN   1604 1608#
GOONIND. . . . . .  C ADDR   0990H   R   SEG=MAIN   1384 1655#
GOONOFF. . . . . .  C ADDR   14EEH   R   SEG=MAIN   3365# 3374
GOONT. . . . . . .  C ADDR   0B58H   R   SEG=MAIN   1923 1966#
GOPAROL. . . . . .  C ADDR   1B31H   R   SEG=MAIN   4116 4260 4268#
GOPAROM. . . . . .  C ADDR   1A1BH   R   SEG=MAIN   4114# 4117
GOPART . . . . . .  C ADDR   0330H   R   SEG=MAIN   792 795#
GOSK19 . . . . . .  C ADDR   101AH   R   SEG=MAIN   2657 2664#
GOTO7. . . . . . .  C ADDR   11F9H   R   SEG=MAIN   2969# 3049 3056 3094 3143 3172 3184 3226 3230 3275 3291 3300 3306
                                           3311 3317 3332 3394 3548 3551 3565 3602 3605 3661 3674 3680 3706 3708 3749
                                           3772 3790 3845 4044 4052 4060 4221 4225 4304 4314 4348 4399 4401 4417 4429
                                           4490 4680 4691
GOTOKD . . . . . .  C ADDR   0632H   R   SEG=MAIN   1153 1177#
GOTOSTROB. . . . .  C ADDR   0B3AH   R   SEG=MAIN   1934 1937 1940 1943 1946#
GOUT6. . . . . . .  C ADDR   0D77H   R   SEG=MAIN   2273# 2301
GOVVLIST . . . . .  C ADDR   181BH   R   SEG=MAIN   3828 3850#
GOZNAK . . . . . .  C ADDR   02E2H   R   SEG=MAIN   689 735#
HNOR11 . . . . . .  C ADDR   134DH   R   SEG=MAIN   3105 3147#
HNOR12 . . . . . .  C ADDR   12F5H   R   SEG=MAIN   3095 3099#
HNOT1. . . . . . .  C ADDR   1396H   R   SEG=MAIN   3071 3193#
HNOT2. . . . . . .  C ADDR   12C3H   R   SEG=MAIN   3068#
HR12 . . . . . . .  C ADDR   12EBH   R   SEG=MAIN   3090 3095#
HVI1113. . . . . .  C ADDR   12E5H   R   SEG=MAIN   3093# 3098 3103
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 536 5195 5201 8246 8254 8303 8313
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   139

INCT . . . . . . .  C ADDR   12BFH   R   SEG=MAIN   3063 3065#
IND. . . . . . . .  C ADDR   217AH   R   SEG=MAIN   638 646 691 719 1426 1509 1513 1797 2314 2318 2329 2999 3236 3252
                                           3748 3964 4016 4308 4496 4688 5217 5223 5237 5243# 6405
INDOLL . . . . . .  C ADDR   094DH   R   SEG=MAIN   1599 1600 1604#
INIACP . . . . . .  C ADDR   242FH   R   SEG=MAIN   655 3212 5753#
INNOT1_2 . . . . .  C ADDR   16D2H   R   SEG=MAIN   3670 3676#
INNOT3 . . . . . .  C ADDR   16C3H   R   SEG=MAIN   3662 3667#
INNOT6 . . . . . .  C ADDR   16B7H   R   SEG=MAIN   3657 3662#
INTER2 . . . . . .  C ADDR   211DH   R   SEG=MAIN   262 5188#
INTERVA. . . . . .  D ADDR   00CDH   A      404# 629 1966 3625 3725
INTMUL . . . . . .  C ADDR   0B7BH   R   SEG=MAIN   1981 1987#
INTMUL1. . . . . .  C ADDR   0B7EH   R   SEG=MAIN   1988#
INTMUL2. . . . . .  C ADDR   0B93H   R   SEG=MAIN   2001# 2010 2020 2026 2030
INTN . . . . . . .  C ADDR   1764H   R   SEG=MAIN   3763#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   137EH   R   SEG=MAIN   3174#
IZMAN. . . . . . .  C ADDR   0E60H   R   SEG=MAIN   2242 2397#
IZMFUN . . . . . .  C ADDR   0E6FH   R   SEG=MAIN   2330 2341 2349 2401 2404#
IZMPAT . . . . . .  C ADDR   0E73H   R   SEG=MAIN   2299 2315 2319 2373 2408#
IZMT2. . . . . . .  C ADDR   0E82H   R   SEG=MAIN   2424 2429#
IZMT3. . . . . . .  C ADDR   0E8DH   R   SEG=MAIN   2429 2435#
JFINIS . . . . . .  C ADDR   2A80H   R   SEG=MAIN   6876 6884#
KD . . . . . . . .  C ADDR   2346H   R   SEG=MAIN   5563#
KEYB1. . . . . . .  C ADDR   0D46H   R   SEG=MAIN   283 2243#
KEYB2. . . . . . .  C ADDR   118DH   R   SEG=MAIN   286 2902#
KFULL. . . . . . .  C ADDR   15B8H   R   SEG=MAIN   3333 3500#
KFULLR . . . . . .  C ADDR   14B5H   R   SEG=MAIN   3328 3333#
KGO23. . . . . . .  C ADDR   1522H   R   SEG=MAIN   3327 3400#
KLBOFF . . . . . .  C ADDR   1249H   R   SEG=MAIN   2992 3010#
KLEV1. . . . . . .  C ADDR   148FH   R   SEG=MAIN   3283 3318#
KLEV2. . . . . . .  C ADDR   1494H   R   SEG=MAIN   3318 3320#
KLEV21 . . . . . .  C ADDR   14B8H   R   SEG=MAIN   3325 3334#
KLEV22 . . . . . .  C ADDR   149EH   R   SEG=MAIN   3313 3322 3325#
KLEV23 . . . . . .  C ADDR   14C9H   R   SEG=MAIN   3334 3342#
KLEV3. . . . . . .  C ADDR   1499H   R   SEG=MAIN   3320 3322#
KLMAS. . . . . . .  C ADDR   03DDH   R   SEG=MAIN   824 891#
KNAVP. . . . . . .  C ADDR   1258H   R   SEG=MAIN   2949 3018#
KNIZM. . . . . . .  B ADDR   0023H.0 A      354# 1363 1600 1765 2375 2397 2398 2402
KNIZMON. . . . . .  C ADDR   0E6AH   R   SEG=MAIN   2397 2402#
KNKMP. . . . . . .  C ADDR   117EH   R   SEG=MAIN   2897# 2943
KNLEFT . . . . . .  C ADDR   1268H   R   SEG=MAIN   2901 3025#
KNMEM. . . . . . .  C ADDR   13F3H   R   SEG=MAIN   2896 3246#
KNMENU . . . . . .  C ADDR   121BH   R   SEG=MAIN   2955 2989#
KNNUL. . . . . . .  C ADDR   1289H   R   SEG=MAIN   2900 3043#
KNOPT. . . . . . .  C ADDR   0E95H   R   SEG=MAIN   2241 2443#
KNRAZR . . . . . .  C ADDR   0EAAH   R   SEG=MAIN   2240 2456#
KNRIGHT. . . . . .  C ADDR   0DF5H   R   SEG=MAIN   2289 2334#
KNVICH . . . . . .  C ADDR   0E16H   R   SEG=MAIN   2298 2352#
KOEFKD . . . . . .  D ADDR   00A0H   A      384# 594 4632 4642 4734 4742
KOEFKM . . . . . .  D ADDR   0094H   A      378# 592 1148 1248 2213
KOEFKP . . . . . .  D ADDR   0090H   A      377# 590 1145 1243 2175
KOMUL. . . . . . .  C ADDR   075BH   R   SEG=MAIN   1336 1340#
KOMULPZ. . . . . .  C ADDR   0755H   R   SEG=MAIN   1333 1337#
KONSTA . . . . . .  D ADDR   00BCH   A      397# 1458 4475 5969
KON_B. . . . . . .  C ADDR   0F74H   R   SEG=MAIN   2549 2568#
KOR0US . . . . . .  C ADDR   2273H   R   SEG=MAIN   2074 5432#
KOR0_AN. . . . . .  D ADDR   0084H   A      374# 1240 2086 2165 2203
KORDEC1. . . . . .  C ADDR   0683H   R   SEG=MAIN   1223 1230#
KORDEC10 . . . . .  C ADDR   0663H   R   SEG=MAIN   1211#
KORNUL . . . . . .  C ADDR   0C12H   R   SEG=MAIN   1160 2066#
KVVOD0 . . . . . .  C ADDR   15D4H   R   SEG=MAIN   3293 3509 3518#
LABEL43. . . . . .  C ADDR   1812H   R   SEG=MAIN   3846# 3854
LABEL7 . . . . . .  C ADDR   18FBH   R   SEG=MAIN   3846 3969# 3981
LABELA . . . . . .  C ADDR   02A9H   R   SEG=MAIN   694# 723 2037
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   140

LABELB . . . . . .  C ADDR   0A71H   R   SEG=MAIN   1203 1628 1802# 2054 2058 2060
LABELC . . . . . .  C ADDR   0EAAH   R   SEG=MAIN   2457#
LABELE . . . . . .  C ADDR   0E73H   R   SEG=MAIN   2406 2422# 2462 2465 2469 2473 2481
LABELF . . . . . .  C ADDR   0ED5H   R   SEG=MAIN   2239 2482#
LABELH . . . . . .  C ADDR   12ABH   R   SEG=MAIN   2899 3058#
LABELI . . . . . .  C ADDR   1C29H   R   SEG=MAIN   3074 3132 3186 4412#
LABELI2. . . . . .  C ADDR   1332H   R   SEG=MAIN   3132# 3133
LABELK . . . . . .  C ADDR   1433H   R   SEG=MAIN   3073 3276#
LABELL . . . . . .  C ADDR   10A6H   R   SEG=MAIN   2619 2719 2727#
LABELL1. . . . . .  C ADDR   0FB1H   R   SEG=MAIN   2606# 2683 2796 2845
LABELN . . . . . .  C ADDR   110AH   R   SEG=MAIN   2684 2805#
LABELP . . . . . .  C ADDR   17E8H   R   SEG=MAIN   3776 3797 3828# 4062
LABELS . . . . . .  C ADDR   17ADH   R   SEG=MAIN   3505 3797#
LABELS1. . . . . .  C ADDR   1A7CH   R   SEG=MAIN   4132 4162#
LABELS13 . . . . .  C ADDR   1BAFH   R   SEG=MAIN   4203 4328#
LABELS3. . . . . .  C ADDR   1C3CH   R   SEG=MAIN   4422#
LABELS4. . . . . .  C ADDR   1C17H   R   SEG=MAIN   4202 4403#
LABL2. . . . . . .  C ADDR   10CCH   R   SEG=MAIN   2761# 3337
LABM . . . . . . .  C ADDR   1658H   R   SEG=MAIN   3338 3608#
LADD . . . . . . .  C ADDR   2BC1H   R   SEG=MAIN   803 838 856 872 1885 7111#
LADDX. . . . . . .  C ADDR   2BD2H   R   SEG=MAIN   7135#
LBTOF. . . . . . .  C ADDR   042DH   A      8225#
LCMP . . . . . . .  C ADDR   29BFH   R   SEG=MAIN   5349 6213 6691#
LDC_LONG . . . . .  C ADDR   29D5H   R   SEG=MAIN   589 1335 1883 2170 2208 3053 6711#
LDC_LTEMP. . . . .  C ADDR   29F7H   R   SEG=MAIN   812 1099 1104 1109 1113 1260 1304 1342 1358 1396 1445 1449 1461
                                           1465 1489 1497 1503 1520 1526 1896 1901 1980 1985 2008 2015 2018 2024 2028
                                           2045 2113 3870 3873 3899 4381 4478 4628 4713 4731 4861 5031 5181 5363 6376
                                           6747#
LDX_LONG . . . . .  C ADDR   2A1DH   R   SEG=MAIN   6782#
LDX_LTEMP. . . . .  C ADDR   2A43H   R   SEG=MAIN   6820#
LEFCUR . . . . . .  C ADDR   16E3H   R   SEG=MAIN   3686# 3758 3774
LEFKL. . . . . . .  C ADDR   1272H   R   SEG=MAIN   3025 3031#
LEFMEM11 . . . . .  C ADDR   1441H   R   SEG=MAIN   3284# 3319 3321 3323
LEFT21 . . . . . .  C ADDR   1602H   R   SEG=MAIN   3544 3549#
LEFT_S . . . . . .  C ADDR   1A79H   R   SEG=MAIN   4161# 4164
LEFT_SK. . . . . .  C ADDR   1B90H   R   SEG=MAIN   4161 4316#
LEV220 . . . . . .  C ADDR   14A1H   R   SEG=MAIN   3326# 3335
LEV2GO . . . . . .  C ADDR   1130H   R   SEG=MAIN   2804 2841#
LEVEL. . . . . . .  D ADDR   00B0H   A      391# 2321 2691 2729 3253 3263 3282 3520 5919
LI21 . . . . . . .  C ADDR   1388H   R   SEG=MAIN   3181 3183#
LI42_43. . . . . .  C ADDR   1881H   R   SEG=MAIN   3896# 4036
LIST_43. . . . . .  C ADDR   1905H   R   SEG=MAIN   3848 3974#
LLDI2. . . . . . .  C ADDR   0E59H   R   SEG=MAIN   2388 2392#
LLDI23 . . . . . .  C ADDR   0E4DH   R   SEG=MAIN   2380 2385#
LLDI3. . . . . . .  C ADDR   0E54H   R   SEG=MAIN   2387 2389#
LLEV2. . . . . . .  C ADDR   10F5H   R   SEG=MAIN   2760 2794#
LLMUL. . . . . . .  C ADDR   2B2AH   R   SEG=MAIN   7005#
LLSUB. . . . . . .  C ADDR   2BAFH   R   SEG=MAIN   7087#
LLTOF. . . . . . .  C ADDR   0432H   A      8231#
LMUL . . . . . . .  C ADDR   2B2AH   R   SEG=MAIN   6171 6377 7007#
LOA3_X . . . . . .  C ADDR   290AH   R   SEG=MAIN   1926 6441#
LOAB12 . . . . . .  C ADDR   247EH   R   SEG=MAIN   3210 5794#
LOAD . . . . . . .  D ADDR   00B7H   A      395# 2446 2487 3061 3206 5455
LOADB. . . . . . .  C ADDR   13A9H   R   SEG=MAIN   3201 3204# 3237 3243
LOADB2 . . . . . .  C ADDR   13D5H   R   SEG=MAIN   3224 3228#
LOADCLE. . . . . .  C ADDR   145FH   R   SEG=MAIN   3298# 3512
LOADKD . . . . . .  C ADDR   249BH   R   SEG=MAIN   5827#
LOADR2 . . . . . .  C ADDR   248DH   R   SEG=MAIN   3770 3865 4378 4473 4519 5810#
LOADT. . . . . . .  C ADDR   228EH   R   SEG=MAIN   2448 2493 3067 5455#
LOADUS . . . . . .  C ADDR   222DH   R   SEG=MAIN   656 1407 1615 2348 2403 3007 3011 3040 3213 4770 5376#
LOAHL_R2 . . . . .  C ADDR   1F75H   R   SEG=MAIN   4827 4839 4890# 4999 5015 5150 5165
LOBLOK . . . . . .  C ADDR   160DH   R   SEG=MAIN   3498 3556# 3575
LOCLE. . . . . . .  C ADDR   145AH   R   SEG=MAIN   3287 3296#
LOD1 . . . . . . .  C ADDR   229DH   R   SEG=MAIN   5463# 5468
LODT . . . . . . .  C ADDR   22ACH   R   SEG=MAIN   5476# 5481
LOIZMK . . . . . .  C ADDR   12F8H   R   SEG=MAIN   3100# 3137
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   141

LOKAME1. . . . . .  C ADDR   19CEH   R   SEG=MAIN   4076#
LOLEVT . . . . . .  C ADDR   2290H   R   SEG=MAIN   2327 5456#
LOLIST . . . . . .  C ADDR   144EH   R   SEG=MAIN   3289#
LOME1. . . . . . .  C ADDR   1D44H   R   SEG=MAIN   4580# 4584 4587 4590 4593 4597 4600 4603 4606 4610
LOMENU . . . . . .  C ADDR   1D3CH   R   SEG=MAIN   2634 2647 4076 4119 4142 4577#
LOOP . . . . . . .  C ADDR   21E9H   R   SEG=MAIN   5312# 5313
LOOPS. . . . . . .  C ADDR   2A83H   R   SEG=MAIN   6886# 6919
LOSPUS . . . . . .  C ADDR   2267H   R   SEG=MAIN   2075 5415#
LOSTAT . . . . . .  C ADDR   1476H   R   SEG=MAIN   3302 3308#
LOTEXT . . . . . .  C ADDR   22A8H   R   SEG=MAIN   1508 1512 1606 2366 2524 2532 2540 2659 2665 2699 2708 2716 2725
                                           2733 2997 3093 3163 3248 3290 3299 3305 3310 3316 3331 3524 3557 3569 3624
                                           3746 3814 3838 4005 4041 4049 4057 4071 4093 4099 4138 4271 4318 4323 4486
                                           4580 4687 5473# 6045
LOTP . . . . . . .  C ADDR   24F1H   R   SEG=MAIN   5868# 5878 5881
LOTPUS . . . . . .  C ADDR   24E9H   R   SEG=MAIN   4150 5410 5865#
LOU. . . . . . . .  C ADDR   0E5FH   R   SEG=MAIN   2375 2391 2395#
LOUIZM . . . . . .  C ADDR   0E3CH   R   SEG=MAIN   2375# 2400 5407
LOUTF. . . . . . .  C ADDR   10E8H   R   SEG=MAIN   2786# 2795 2802
LOVICH . . . . . .  C ADDR   12EEH   R   SEG=MAIN   3096# 3130 3151 4532
LOWR . . . . . . .  C ADDR   1468H   R   SEG=MAIN   3296 3302#
LOWR1. . . . . . .  C ADDR   146DH   R   SEG=MAIN   3304# 3516
LSUB . . . . . . .  C ADDR   2BAFH   R   SEG=MAIN   1200 1376 5364 7088#
LTEMP. . . . . . .  N NUMB   0008H   A      1116 1118 1119 1120 5700 5701 5702 5703 6223 6226 6229 6232 6275 6276
                                           6277 6278 6503# 6877 6878 6879 6880 6889 6893 6897 6901 6904 6905 6906
                                           6907 6908 6909 6910 6911 6912 6913 6914 6915 6918 6921 6926 6930 6934 6944
                                           6947 6950 6953 6969 6972 6973 6975 6976 6978 6979 6981 6986 6987 6988 6989
                                           7009 7014 7022 7030 7035 7046 7054 7060 7068 7074 7442 7443 7482 7487 7489
                                           7498 7499 7500 7501 7732 7740 7753 7756 7759 7762 8342 8345 8348 8351
LWR. . . . . . . .  C ADDR   27ACH   R   SEG=MAIN   6162# 6166
LWRX . . . . . . .  C ADDR   2770H   R   SEG=MAIN   6107# 6119
LWTOF. . . . . . .  C ADDR   042FH   A      8227#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   27C7H   R   SEG=MAIN   1677 3902 4864 5035 6170 6175 6180# 6212
MAIN . . . . . . .  C SEG    2C0CH       REL=UNIT   237 294# 455
MANT1. . . . . . .  N NUMB   0002H   A      7440# 7467 7516 7517
MANT2. . . . . . .  N NUMB   0008H   A      7442# 7493 7494 7625 7627 7628 7630 7631 7633 7634 7636 7675 7676 7678
                                           7679 7681 7682 7684 7685 7689 7691 7694 7697 7795 7797 7798 7800 7801 7803
                                           7804 7806 7857 7859 7860 7862 7863 7865 7866 7868 7950 7954 7958 7962 7966
                                           7969 7972 7975
MARK0_8. . . . . .  C ADDR   0F7BH   R   SEG=MAIN   2551 2569 2571#
MARKER . . . . . .  D ADDR   00B2H   A      393# 567 2265 2511 2550 2560 2568 2578 2584 2768 2776 2812 2819 2831 2923
                                           3141 3158 3179 3272 3391 3491 3532 3540 3561 3587 3594 3652 3692 3699 3739
                                           3782 3840 3856 3979 4120 4208 4215 4299 4312 4335 4342 4389 4422 4441 4448
                                           4482 4492 4503 4528 5896 5922 5948 5959 6017
MARLE. . . . . . .  C ADDR   2565H   R   SEG=MAIN   3707 5945#
MARRI. . . . . . .  C ADDR   2572H   R   SEG=MAIN   2839 5958#
MAS10. . . . . . .  C ADDR   03FCH   R   SEG=MAIN   893 906#
MAS20. . . . . . .  C ADDR   047CH   R   SEG=MAIN   906 961#
MAS4 . . . . . . .  C ADDR   0570H   R   SEG=MAIN   959 1062#
MAS5DIV. . . . . .  C ADDR   05E4H   R   SEG=MAIN   1100 1105 1110 1114 1122#
MASFULL. . . . . .  C ADDR   05ABH   R   SEG=MAIN   1089 1093#
MASS0. . . . . . .  X ADDR   0100H   A      417 418# 894 899 928 936 1010 1018 1067 1074 6149
MASS1. . . . . . .  X ADDR   0104H   A      419# 902 925 939 1007 1021 1065 1077
MASS10 . . . . . .  X ADDR   0128H   A      428# 983 1040
MASS11 . . . . . .  X ADDR   012CH   A      429# 980 1042
MASS12 . . . . . .  X ADDR   0130H   A      430# 977 1044
MASS13 . . . . . .  X ADDR   0134H   A      431# 974 1046
MASS14 . . . . . .  X ADDR   0138H   A      432# 971 1048
MASS15 . . . . . .  X ADDR   013CH   A      433# 968 1050
MASS16 . . . . . .  X ADDR   0140H   A      434# 966 1052
MASS17 . . . . . .  X ADDR   0144H   A      435# 964 1054
MASS18 . . . . . .  X ADDR   0148H   A      436# 962 1056
MASS19 . . . . . .  X ADDR   014CH   A      437# 1058
MASS2. . . . . . .  X ADDR   0108H   A      420# 922 941 1004 1023 1063 1079
MASS3. . . . . . .  X ADDR   010CH   A      421# 919 943 1001 1025 1081
MASS4. . . . . . .  X ADDR   0110H   A      422# 916 945 998 1027
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   142

MASS5. . . . . . .  X ADDR   0114H   A      423# 913 947 995 1029
MASS6. . . . . . .  X ADDR   0118H   A      424# 911 949 993 1031
MASS7. . . . . . .  X ADDR   011CH   A      425# 909 951 991 1033
MASS8. . . . . . .  X ADDR   0120H   A      426# 907 953 989 1035
MASS9. . . . . . .  X ADDR   0124H   A      427# 955 986 1037
MASX5. . . . . . .  C ADDR   05DAH   R   SEG=MAIN   1091 1116#
MAXG . . . . . . .  C ADDR   209CH   R   SEG=MAIN   5106# 5160
MAXVIX . . . . . .  C ADDR   2106H   R   SEG=MAIN   5170 5175#
ME11_15DE. . . . .  C ADDR   17A4H   R   SEG=MAIN   3792# 3811
ME11_15DEC . . . .  C ADDR   19CDH   R   SEG=MAIN   3792 4075#
ME21_22. . . . . .  C ADDR   10B0H   R   SEG=MAIN   2733# 2742
ME21_23. . . . . .  C ADDR   1A37H   R   SEG=MAIN   3825 4128#
ME21_23DEC . . . .  C ADDR   1A53H   R   SEG=MAIN   4135 4140#
MEAVP. . . . . . .  C ADDR   1263H   R   SEG=MAIN   3019 3022#
MECLE. . . . . . .  C ADDR   01ABH   R   SEG=MAIN   540# 542
MEFF . . . . . . .  C ADDR   01B2H   R   SEG=MAIN   544# 547
MEM10MS. . . . . .  C ADDR   02A4H   R   SEG=MAIN   691#
MEM12NO. . . . . .  C ADDR   15CFH   R   SEG=MAIN   3510 3514#
MENG . . . . . . .  C ADDR   1EC1H   R   SEG=MAIN   4787# 4837
MENU12 . . . . . .  C ADDR   1D48H   R   SEG=MAIN   4578 4582#
MENU13 . . . . . .  C ADDR   1D50H   R   SEG=MAIN   4582 4585#
MENU14 . . . . . .  C ADDR   1D58H   R   SEG=MAIN   4585 4588#
MENU15 . . . . . .  C ADDR   1D60H   R   SEG=MAIN   4588 4591#
MENU21 . . . . . .  C ADDR   1D68H   R   SEG=MAIN   4591 4595#
MENU22 . . . . . .  C ADDR   1D70H   R   SEG=MAIN   4595 4598#
MENU23 . . . . . .  C ADDR   1D78H   R   SEG=MAIN   4598 4601#
MENU31 . . . . . .  C ADDR   1D80H   R   SEG=MAIN   4601 4604#
MENU41 . . . . . .  C ADDR   1D88H   R   SEG=MAIN   4604 4608#
MENUOFF. . . . . .  C ADDR   123DH   R   SEG=MAIN   2990 3003#
MENUON . . . . . .  C ADDR   17DAH   R   SEG=MAIN   3816#
MERR . . . . . . .  C ADDR   1218H   R   SEG=MAIN   2986# 2989
ME_14. . . . . . .  C ADDR   1481H   R   SEG=MAIN   3313#
ME_41. . . . . . .  C ADDR   1AF4H   R   SEG=MAIN   4162 4229#
ME_52. . . . . . .  C ADDR   1AC8H   R   SEG=MAIN   4205# 4229
ME_52V . . . . . .  C ADDR   1AE5H   R   SEG=MAIN   4219 4221#
MIDL . . . . . . .  C ADDR   2AB6H   R   SEG=MAIN   6881 6916#
MIGN . . . . . . .  C ADDR   25A2H   R   SEG=MAIN   5244 6017#
MIGNN. . . . . . .  C ADDR   25AAH   R   SEG=MAIN   6019 6024#
MIN4_HL. . . . . .  C ADDR   1F81H   R   SEG=MAIN   4903# 4917 4943 5068 5094
MING . . . . . . .  C ADDR   1FC3H   R   SEG=MAIN   4955# 5009
MINIVIX. . . . . .  C ADDR   202DH   R   SEG=MAIN   5020 5025# 5175
MLABL2 . . . . . .  C ADDR   1638H   R   SEG=MAIN   3525 3579# 3610 3849
MLABL2R. . . . . .  C ADDR   1818H   R   SEG=MAIN   3849# 3852
MMM. . . . . . . .  C ADDR   029FH   R   SEG=MAIN   687#
MO220. . . . . . .  C ADDR   0942H   R   SEG=MAIN   1215 1386 1599#
MO500I . . . . . .  C ADDR   08B2H   R   SEG=MAIN   1451 1511#
MO500R . . . . . .  C ADDR   08A6H   R   SEG=MAIN   1447 1507#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   1043H   R   SEG=MAIN   2685# 2696 2705 2713 2722
MOUTKMEM . . . . .  C ADDR   17A7H   R   SEG=MAIN   3793# 3801
MOVE28 . . . . . .  C ADDR   2834H   R   SEG=MAIN   1279 1297 1344 1453 2168 2206 4622 4705 4723 4829 4841 4856 4998
                                           5014 5149 5164 6275#
MOVE82 . . . . . .  C ADDR   23EDH   R   SEG=MAIN   5700#
MOVEA3 . . . . . .  C ADDR   0990H   R   SEG=MAIN   1658#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2552 2784 2824 3160 3497 3541 3549 3603 3655 3700 3843 4123 4218
                                           4301 4345 4423 4451 5952
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2548 2777 2781 2820 3161 3496 3545 3595 3599 3654 3704 3842 4122
                                           4302 4427 5961
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      7792# 7835
MUP11. . . . . . .  C ADDR   0257H   A      7839# 7884
MUP2 . . . . . . .  C ADDR   0297H   A      7869 7883#
MUP3 . . . . . . .  C ADDR   026CH   A      7838 7854#
MVV11. . . . . . .  C ADDR   1608H   R   SEG=MAIN   3521 3554#
MVV12. . . . . . .  C ADDR   1620H   R   SEG=MAIN   3554 3566#
N12DELCH . . . . .  C ADDR   0D33H   R   SEG=MAIN   2224 2232#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   143

N4DELCH. . . . . .  C ADDR   0CDFH   R   SEG=MAIN   2148 2186#
N8DELCH. . . . . .  C ADDR   0D21H   R   SEG=MAIN   2186 2224#
NBIMENU. . . . . .  C ADDR   1049H   R   SEG=MAIN   2689#
NBLOK. . . . . . .  D ADDR   0038H   A      311# 627 1931 3354 3558 3622 3836 3927 6367 6388 6419
NE05 . . . . . . .  C ADDR   0358H   A      8021 8023 8025 8028#
NELEM. . . . . . .  D ADDR   0037H   A      312# 628 3867 3984 3988
NEXIN. . . . . . .  C ADDR   2184H   R   SEG=MAIN   5247# 5254
NEXTMAX. . . . . .  C ADDR   20D1H   R   SEG=MAIN   5138 5146#
NEXTMEA. . . . . .  C ADDR   1EF6H   R   SEG=MAIN   4819 4827#
NEXTMIN. . . . . .  C ADDR   1FF8H   R   SEG=MAIN   4987 4995#
NMEM_MENU. . . . .  C ADDR   17AAH   R   SEG=MAIN   3795# 3799
NMINUS . . . . . .  C ADDR   06A0H   R   SEG=MAIN   1245 1249#
NMINUS3. . . . . .  C ADDR   0604H   R   SEG=MAIN   1147 1149#
NNDELCH. . . . . .  C ADDR   0C9FH   R   SEG=MAIN   2133 2148#
NNMEMB . . . . . .  C ADDR   113CH   R   SEG=MAIN   2687 2847#
NNNUL. . . . . . .  C ADDR   0A0DH   R   SEG=MAIN   1740 1743#
NO . . . . . . . .  C ADDR   2A9EH   R   SEG=MAIN   6891 6895 6899 6903#
NO0KEY . . . . . .  C ADDR   02B6H   R   SEG=MAIN   697 699 703#
NO10MSV. . . . . .  C ADDR   174BH   R   SEG=MAIN   3744 3750#
NO11V6 . . . . . .  C ADDR   0F2DH   R   SEG=MAIN   2519 2527#
NO12V6 . . . . . .  C ADDR   0F40H   R   SEG=MAIN   2527 2535#
NO13V6 . . . . . .  C ADDR   0F53H   R   SEG=MAIN   2535 2545#
NO21P7 . . . . . .  C ADDR   1CD4H   R   SEG=MAIN   4461 4510#
NO23RI . . . . . .  C ADDR   0FFAH   R   SEG=MAIN   2645 2649#
NO2MSV . . . . . .  C ADDR   1748H   R   SEG=MAIN   3749# 3750 3760
NO2PARN. . . . . .  C ADDR   0985H   R   SEG=MAIN   1641 1647#
NO31N. . . . . . .  C ADDR   1702H   R   SEG=MAIN   3713#
NO31RI . . . . . .  C ADDR   102BH   R   SEG=MAIN   2651 2675#
NO3PARN. . . . . .  C ADDR   097BH   R   SEG=MAIN   1641# 1721
NO4DEL . . . . . .  C ADDR   0C45H   R   SEG=MAIN   2079 2097#
NO5DEL . . . . . .  C ADDR   0C64H   R   SEG=MAIN   2112# 2120
NO6DEL . . . . . .  C ADDR   0C72H   R   SEG=MAIN   2110 2118#
NOAVK. . . . . . .  C ADDR   0672H   R   SEG=MAIN   1171 1220# 2126
NOAVP. . . . . . .  C ADDR   0797H   R   SEG=MAIN   1367# 1398 1401
NOBAVP . . . . . .  C ADDR   0A29H   R   SEG=MAIN   1510 1514 1594 1759 1763#
NOBEF99. . . . . .  C ADDR   036DH   R   SEG=MAIN   809 825# 844 862 878
NOBIT. . . . . . .  C ADDR   0245H   A      7807 7821#
NOBITIZM . . . . .  C ADDR   0A32H   R   SEG=MAIN   1765 1768#
NOBL21 . . . . . .  C ADDR   10B9H   R   SEG=MAIN   2730 2738#
NOBL22 . . . . . .  C ADDR   10C3H   R   SEG=MAIN   2738 2758#
NOBUF. . . . . . .  C ADDR   0A67H   R   SEG=MAIN   1795 1797#
NOBUF0 . . . . . .  C ADDR   0BE8H   R   SEG=MAIN   1921 2042#
NOCHI0 . . . . . .  C ADDR   0977H   R   SEG=MAIN   1387 1627#
NOCHIND. . . . . .  C ADDR   02D5H   R   SEG=MAIN   717 725#
NOCHN10. . . . . .  C ADDR   05C7H   R   SEG=MAIN   1102 1107#
NOCHN2 . . . . . .  C ADDR   05BCH   R   SEG=MAIN   1097 1102#
NOCHN20. . . . . .  C ADDR   05D2H   R   SEG=MAIN   1107 1112#
NODI2. . . . . . .  C ADDR   095BH   R   SEG=MAIN   1602 1610#
NODI6. . . . . . .  C ADDR   1274H   R   SEG=MAIN   3029 3033#
NODI8. . . . . . .  C ADDR   09E1H   R   SEG=MAIN   1704 1711#
NODI8K . . . . . .  C ADDR   1B64H   R   SEG=MAIN   4287 4292#
NODI8_43 . . . . .  C ADDR   18DEH   R   SEG=MAIN   3941 3947#
NODI9. . . . . . .  C ADDR   0960H   R   SEG=MAIN   1612 1615#
NODI9_43 . . . . .  C ADDR   18E9H   R   SEG=MAIN   3947 3955#
NODIS9 . . . . . .  C ADDR   09F3H   R   SEG=MAIN   1711 1723#
NODISK9. . . . . .  C ADDR   1B6CH   R   SEG=MAIN   4291 4292 4299#
NOENDLI. . . . . .  C ADDR   28D6H   R   SEG=MAIN   6402 6406#
NOEQU1 . . . . . .  C ADDR   1121H   R   SEG=MAIN   2823 2827#
NOEQU2 . . . . . .  C ADDR   16FCH   R   SEG=MAIN   3703 3707#
NOFIZM . . . . . .  C ADDR   0F0FH   R   SEG=MAIN   2483 2515#
NOFT1. . . . . . .  C ADDR   0EE8H   R   SEG=MAIN   2488 2492#
NOFZ . . . . . . .  C ADDR   0BE3H   R   SEG=MAIN   2033 2037#
NOH37. . . . . . .  C ADDR   130DH   R   SEG=MAIN   3089 3113# 3124
NOHNOT1. . . . . .  C ADDR   13E8H   R   SEG=MAIN   3195 3238#
NOHNOT2. . . . . .  C ADDR   13DDH   R   SEG=MAIN   3231# 3238
NOKLB. . . . . . .  C ADDR   0A61H   R   SEG=MAIN   1793 1795#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   144

NOKORR . . . . . .  C ADDR   061AH   R   SEG=MAIN   1158 1161#
NOLAH. . . . . . .  C ADDR   12CFH   R   SEG=MAIN   3058 3076#
NOLI_43. . . . . .  C ADDR   1959H   R   SEG=MAIN   3974 4019#
NOM31. . . . . . .  C ADDR   16DAH   R   SEG=MAIN   3607 3682#
NOM32. . . . . . .  C ADDR   1753H   R   SEG=MAIN   3682 3756#
NOM33. . . . . . .  C ADDR   1781H   R   SEG=MAIN   3756 3776#
NOMARL . . . . . .  C ADDR   1C51H   R   SEG=MAIN   4425 4431 4435#
NOMAXI . . . . . .  C ADDR   20E9H   R   SEG=MAIN   5155 5158#
NOME11 . . . . . .  C ADDR   15BFH   R   SEG=MAIN   3507#
NOMEM11. . . . . .  C ADDR   1064H   R   SEG=MAIN   2692 2702#
NOMEM12. . . . . .  C ADDR   107AH   R   SEG=MAIN   2702 2710#
NOMEM13. . . . . .  C ADDR   1090H   R   SEG=MAIN   2710 2719#
NOMEMK . . . . . .  C ADDR   15BCH   R   SEG=MAIN   3261 3504#
NOMINI . . . . . .  C ADDR   2010H   R   SEG=MAIN   5004 5007#
NON1C. . . . . . .  C ADDR   0EBBH   R   SEG=MAIN   2463 2467#
NONULAVT . . . . .  C ADDR   0657H   R   SEG=MAIN   1166 1205#
NONULDEL . . . . .  C ADDR   0C27H   R   SEG=MAIN   2067 2078#
NOP3_0 . . . . . .  C ADDR   097BH   R   SEG=MAIN   1633#
NOPART1. . . . . .  C ADDR   0371H   R   SEG=MAIN   798 832#
NOPART2. . . . . .  C ADDR   0391H   R   SEG=MAIN   832 851#
NOPART3. . . . . .  C ADDR   03B1H   R   SEG=MAIN   851 867#
NOPART4. . . . . .  C ADDR   03D1H   R   SEG=MAIN   867 884#
NOPLUS . . . . . .  C ADDR   0FA3H   R   SEG=MAIN   2596 2599#
NOPOIN7. . . . . .  C ADDR   1C68H   R   SEG=MAIN   4421 4456#
NOPOINT. . . . . .  C ADDR   1C34H   R   SEG=MAIN   4415 4419#
NOR11. . . . . . .  C ADDR   0FB7H   R   SEG=MAIN   2610#
NORDN. . . . . . .  C ADDR   00F6H   A      7528# 7561
NORDN1 . . . . . .  C ADDR   0107H   A      7530 7544#
NORIG2 . . . . . .  C ADDR   10FEH   R   SEG=MAIN   2791 2799#
NORIM6 . . . . . .  C ADDR   113CH   R   SEG=MAIN   2851#
NORIME . . . . . .  C ADDR   0FE0H   R   SEG=MAIN   2632 2636#
NORIME1. . . . . .  C ADDR   0FDAH   R   SEG=MAIN   2634# 2637 2650
NORM1. . . . . . .  C ADDR   00F0H   A      7523# 7720 7897 7999 8216
NORR11 . . . . . .  C ADDR   1325H   R   SEG=MAIN   3126#
NORR12 . . . . . .  C ADDR   1335H   R   SEG=MAIN   3126 3133# 3147
NORUP. . . . . . .  C ADDR   0119H   A      7527 7564#
NORUP1 . . . . . .  C ADDR   011EH   A      7569# 7587
NORUP2 . . . . . .  C ADDR   0132H   A      7571 7588#
NORVICH. . . . . .  C ADDR   0A6AH   R   SEG=MAIN   1720 1798#
NOSAV1 . . . . . .  C ADDR   0B28H   R   SEG=MAIN   1932 1935#
NOSAV2 . . . . . .  C ADDR   0B2FH   R   SEG=MAIN   1935 1938#
NOSAV3 . . . . . .  C ADDR   0B36H   R   SEG=MAIN   1938 1941#
NOSUB. . . . . . .  C ADDR   2AD9H   R   SEG=MAIN   6925 6929 6933 6938#
NOT1IN . . . . . .  C ADDR   0BFDH   R   SEG=MAIN   1871 2052#
NOT1_7 . . . . . .  C ADDR   1208H   R   SEG=MAIN   2971 2978#
NOT2IN . . . . . .  C ADDR   0C05H   R   SEG=MAIN   2052 2056#
NOT2_7 . . . . . .  C ADDR   1213H   R   SEG=MAIN   2978 2983#
NOT3IN . . . . . .  C ADDR   0C0DH   R   SEG=MAIN   2056 2059#
NOTAKT . . . . . .  C ADDR   0A3CH   R   SEG=MAIN   1769 1773#
NOTE21 . . . . . .  C ADDR   0717H   R   SEG=MAIN   1266 1308#
NOTE22 . . . . . .  C ADDR   0732H   R   SEG=MAIN   1308 1320#
NOTESTIZM. . . . .  C ADDR   074AH   R   SEG=MAIN   1229 1332#
NOTT1. . . . . . .  C ADDR   0B72H   R   SEG=MAIN   1978 1983#
NOTT2. . . . . . .  C ADDR   0B9AH   R   SEG=MAIN   1983 2006#
NOTT3. . . . . . .  C ADDR   0BA8H   R   SEG=MAIN   2006 2013#
NOTT4. . . . . . .  C ADDR   0BBFH   R   SEG=MAIN   2013 2022#
NOTT5. . . . . . .  C ADDR   0BCDH   R   SEG=MAIN   2022 2027#
NOT_1. . . . . . .  C ADDR   0EC2H   R   SEG=MAIN   2467 2472#
NOT_10 . . . . . .  C ADDR   0EC2H   R   SEG=MAIN   2471#
NOVIR. . . . . . .  C ADDR   0FC2H   R   SEG=MAIN   2504 2621#
NOVIR1 . . . . . .  C ADDR   0EF9H   R   SEG=MAIN   2504# 2515
NOZMEA . . . . . .  C ADDR   1F71H   R   SEG=MAIN   4884 4886#
NOZMIN . . . . . .  C ADDR   2064H   R   SEG=MAIN   5055 5057#
NOZZBL . . . . . .  C ADDR   18D0H   R   SEG=MAIN   3930 3933 3936 3939#
NOZZMI . . . . . .  C ADDR   09CEH   R   SEG=MAIN   1699 1701#
NOZZMI1. . . . . .  C ADDR   18C0H   R   SEG=MAIN   3928 3931#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   145

NOZZMI2. . . . . .  C ADDR   18C7H   R   SEG=MAIN   3931 3934#
NOZZMI3. . . . . .  C ADDR   18CEH   R   SEG=MAIN   3934 3937#
NOZZMI43 . . . . .  C ADDR   18B7H   R   SEG=MAIN   3925 3927#
NSEC1. . . . . . .  C ADDR   0A16H   R   SEG=MAIN   1744 1747#
NSEC10 . . . . . .  C ADDR   0A1FH   R   SEG=MAIN   1746 1749 1754#
NSEC11 . . . . . .  C ADDR   0A1DH   R   SEG=MAIN   1747 1751#
NUERR. . . . . . .  D ADDR   0039H   A      310# 1424 4306 4494 5220 5234 6046
NULAVT . . . . . .  C ADDR   0C84H   R   SEG=MAIN   2131#
NUMSIZE. . . . . .  N NUMB   0004H   A      6506# 6528 6566 6573 6648 6668
OBOARD . . . . . .  C ADDR   2A0FH   R   SEG=MAIN   6749 6763#
OBOARD1. . . . . .  C ADDR   2A57H   R   SEG=MAIN   6822 6835#
OK1. . . . . . . .  C ADDR   0186H   A      7654 7669#
OK2. . . . . . . .  C ADDR   01A0H   A      7671 7686#
OK3. . . . . . . .  C ADDR   01C4H   A      7703 7719#
ONBOAR1. . . . . .  C ADDR   2A35H   R   SEG=MAIN   6784 6801#
ONBOARD. . . . . .  C ADDR   29E9H   R   SEG=MAIN   6713 6727#
ONMEM11. . . . . .  C ADDR   140AH   R   SEG=MAIN   3002 3021 3023 3255# 3815 3821 4073 4077 4082 4097 4102 4125 4139
                                           4143 4154
ONMEM12. . . . . .  C ADDR   1A5AH   R   SEG=MAIN   4144# 4147 4166
ONMEM13. . . . . .  C ADDR   1C14H   R   SEG=MAIN   4346 4401# 4405 4407
ONMIG. . . . . . .  C ADDR   25B8H   R   SEG=MAIN   6028 6037#
ONVICH . . . . . .  C ADDR   0E34H   R   SEG=MAIN   2358 2370#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 494
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 487 491
OUT43. . . . . . .  C ADDR   18F2H   R   SEG=MAIN   3964#
OUT6 . . . . . . .  C ADDR   113CH   R   SEG=MAIN   2238 2305 2351 2428 2433 2438 2454 2490 2495 2502 2513 2635 2648
                                           2663 2669 2852#
OUT7 . . . . . . .  C ADDR   1CFDH   R   SEG=MAIN   2897 2898 2975 2982 2986 3008 3014 3064 3069 3120 3259 3339 3572
                                           3666 3795 3966 3973 4018 4112 4200 4321 4326 4396 4410 4505 4507 4535#
OUTA . . . . . . .  C ADDR   257FH   R   SEG=MAIN   3165 5969#
OUTA2. . . . . . .  C ADDR   2599H   R   SEG=MAIN   5980# 5985
OUTF . . . . . . .  C ADDR   0EEFH   R   SEG=MAIN   2498# 2521 2525 2529 2533 2537 2541 2566 2589 2598 2601 2608 2685
                                           2700 2709 2717 2726 2736 2783 2786 2826 2840 2843 3110 3111 4144
OUTFL. . . . . . .  C ADDR   0FB4H   R   SEG=MAIN   2604 2608#
OUTKMEM. . . . . .  C ADDR   1417H   R   SEG=MAIN   3263# 3281 3793
OUTMA. . . . . . .  C ADDR   0F8DH   R   SEG=MAIN   2587 2589#
OUTMAX . . . . . .  C ADDR   20EEH   R   SEG=MAIN   5142 5161#
OUTMEA . . . . . .  C ADDR   1F11H   R   SEG=MAIN   4823 4838#
OUTMENU. . . . . .  C ADDR   1A16H   R   SEG=MAIN   4111#
OUTMIN . . . . . .  C ADDR   2015H   R   SEG=MAIN   4991 5011#
OUTR . . . . . . .  C ADDR   0909H   R   SEG=MAIN   1540 1563#
OUTR5. . . . . . .  C ADDR   0925H   R   SEG=MAIN   1561 1582#
OUTSKO . . . . . .  C ADDR   1ABBH   R   SEG=MAIN   4196 4198#
OUTSKO1. . . . . .  C ADDR   1AB8H   R   SEG=MAIN   4194 4197#
OUTVICH. . . . . .  C ADDR   0EFCH   R   SEG=MAIN   2505# 2517
OUTVIR . . . . . .  C ADDR   0DBBH   R   SEG=MAIN   2272 2301#
OUT_KALI . . . . .  C ADDR   1E0CH   R   SEG=MAIN   4689#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 6705
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 5247 5251
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 465
P1 . . . . . . . .  D ADDR   0090H   A      32# 659 660 5260 5262 5265 5268 5272 5274 5275 5327 5329 5331 5767 5774
                                           6305 6308 6310 6313
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 466
P2 . . . . . . . .  D ADDR   00A0H   A      47# 5293 5297 5306
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 467
P3 . . . . . . . .  D ADDR   00B0H   A      62# 476 2271 2273 2275 2276 2279 2280 2284 2285 2287 2288 2290 2291 2293
                                           2294 2296 2297 2477 2478 2484 2485 2516 2517 2520 2521 2528 2529 2536 2537
                                           2545 2546 2591 2592 2602 2603 2629 2630 2643 2644 2654 2655 2679 2680 2681
                                           2682 2694 2695 2703 2704 2711 2712 2720 2721 2759 2760 2794 2795 2803 2804
                                           2841 2842 2872 2930 2932 2934 2935 2938 2939 2941 2942 2944 2945 2947 2948
                                           2950 2951 2953 2954 3059 3062 3088 3089 3113 3114 3127 3128 3134 3135 3148
                                           3149 3193 3194 3280 3281 3284 3285 3326 3327 3343 3344 3345 3346 3400 3401
                                           3507 3508 3518 3519 3609 3610 3611 3612 3683 3684 3713 3714 3757 3758 3759
                                           3760 3777 3778 3779 3780 3798 3799 3800 3801 3808 3809 3851 3852 3853 3854
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   146

                                           3975 3976 4064 4065 4133 4134 4146 4147 4163 4164 4165 4166 4206 4207 4223
                                           4224 4230 4231 4232 4233 4404 4405 4406 4407 4413 4414 4419 4420 4456 4457
                                           4549 5292 5294 5296 5302 5303 5304 5307 5308
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2245 2871 2904 4548
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 469
P4 . . . . . . . .  D ADDR   0084H   A      20# 2069 2090 2134 2217 2382 2384 4675 5385 5388 5404 5406 5870
P5 . . . . . . . .  D ADDR   0085H   A      21# 573 582 2071 2092 2136 2139 2144 2179 2181 2219 2392 2394 4679 5393
                                           5396 5426 5429 5874
P6 . . . . . . . .  D ADDR   0086H   A      22# 1947 1949 1953 1955 2874 2876 2880 2882 4552 4554 4558 4560
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 470
PACK1. . . . . . .  C ADDR   00DEH   A      7506# 7721 7898 8000 8217
PARERR . . . . . .  C ADDR   1B79H   R   SEG=MAIN   4262 4264 4266 4306#
PARN . . . . . . .  D ADDR   00AFH   A      390# 579 1734 2458 3221
PAROL. . . . . . .  D ADDR   00A8H   A      386#
PART . . . . . . .  D ADDR   009AH   A      380# 574 796 1136 1178 1205 1220 1743 1799 1977 2109 2353 2422 2459 2969
                                           3204 3220 3656 3743 5397 5794
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215 519
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132# 518
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116# 517
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101# 516 1957 1959 2884 2886 4562 4564 5189 5191
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 463
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 464 515
PCON . . . . . . .  D ADDR   0087H   A      23# 510
POIN3. . . . . . .  C ADDR   1C67H   R   SEG=MAIN   4454# 4508
POINA. . . . . . .  C ADDR   1CCFH   R   SEG=MAIN   4452 4507#
POINA1 . . . . . .  C ADDR   1C4CH   R   SEG=MAIN   4424 4431#
POINA2 . . . . . .  C ADDR   1C46H   R   SEG=MAIN   4427# 4432
POZB . . . . . . .  C ADDR   1CF2H   R   SEG=MAIN   4521 4525#
PROD . . . . . . .  N NUMB   000CH   A      7443# 7787 7788 7789 7790 7810 7811 7812 7814 7815 7817 7818 7820 7842
                                           7844 7845 7847 7848 7850 7851 7853 7872 7873 7874 7876 7877 7879 7880 7882
                                           7893 7894 7895 7896 7917 7918 7919 7920 7936 7938 7939 7941 7942 7944 7945
                                           7947 7977 7994 7995 7996 7997
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 8248 8252 8305 8308
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 2248 2862 2907 4546 6214 6216 7178
                                           7186
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0DC5H   R   SEG=MAIN   2295 2307#
QUES . . . . . . .  C ADDR   14C3H   R   SEG=MAIN   3339# 3344
QU_AVP . . . . . .  C ADDR   0794H   R   SEG=MAIN   1364 1366#
R10. . . . . . . .  N NUMB   000AH   A      450# 1167 1419 1456 1468 1996 4265 5842 8271
R11. . . . . . . .  N NUMB   000BH   A      451# 1168 1418 1457 1467 1999 5846 8275
R8 . . . . . . . .  N NUMB   0008H   A      448# 525 1421 1454 1470 1990 4090 4261 5347 5834 8263
R9 . . . . . . . .  N NUMB   0009H   A      449# 1420 1455 1469 1993 4263 5348 5838 8267
RAFTERK. . . . . .  C ADDR   0630H   R   SEG=MAIN   1175# 1181
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   147

RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RDDOUTF. . . . . .  C ADDR   151CH   R   SEG=MAIN   3396# 3401
RE1. . . . . . . .  C ADDR   21F2H   R   SEG=MAIN   5327# 5333
RE11_7 . . . . . .  C ADDR   06D8H   R   SEG=MAIN   1277# 1319 1330
RE4BYTE. . . . . .  C ADDR   0454H   A      524 4089 4259 8259#
REA3_X . . . . . .  C ADDR   291CH   R   SEG=MAIN   3897 6458#
REACP. . . . . . .  D ADDR   0077H   A      304# 674 676 678 680 737 753 761 769 778 785 800 835 853 869 885 2153
                                           2155 2157 2159 2191 2193 2195 2197
READ . . . . . . .  C ADDR   21F0H   R   SEG=MAIN   673 675 677 5326#
READYACP . . . . .  C ADDR   0328H   R   SEG=MAIN   779 789#
READ_X2. . . . . .  C ADDR   21D8H   R   SEG=MAIN   5301# 5312
REBYTE . . . . . .  C ADDR   0278H   R   SEG=MAIN   658# 692 714 826 2095 2117 2146 2184 2222 2231 2233
REBYTE2. . . . . .  C ADDR   046CH   A      1269 1277 1295 1311 1322 1338 4695 4703 8279#
REBYTER. . . . . .  C ADDR   0C77H   R   SEG=MAIN   2106 2122# 2130
REF0CN . . . . . .  D ADDR   00D1H   A      92# 471
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RENDKALIB. . . . .  C ADDR   1255H   R   SEG=MAIN   3016# 3018
RESAR2 . . . . . .  C ADDR   2840H   R   SEG=MAIN   801 836 854 870 886 898 934 1016 1072 1193 1238 1346 1370 1436
                                           1459 1486 1675 1894 2043 2082 2108 3046 4616 4624 4643 4721 4743 4831 4843
                                           4858 4938 4996 5012 5026 5089 5147 5162 5179 5970 6283# 6442
RESAR8 . . . . . .  C ADDR   27FEH   R   SEG=MAIN   1149 1199 1241 1249 1375 2166 2204 6222#
RESA_HL. . . . . .  C ADDR   28E9H   R   SEG=MAIN   1925 4776 4914 5064 6419#
REZAM. . . . . . .  D ADDR   008CH   A      376# 2201
REZAP. . . . . . .  D ADDR   0088H   A      375# 2163
REZMUL . . . . . .  C ADDR   0688H   R   SEG=MAIN   1213 1227 1236#
REZ_A. . . . . . .  D ADDR   0062H   A      365# 814 887 897 933 1015 1071 2081
REZ_A0 . . . . . .  D ADDR   006AH   A      367# 1198 1374 1412 1621 2345 3037 3047 3054
REZ_A1 . . . . . .  D ADDR   0066H   A      366# 1130 1196 1237 1351 1369 1388
REZ_A2 . . . . . .  D ADDR   007BH   A      368# 1371
REZ_A3 . . . . . .  D ADDR   009CH   A      382# 1201 1377 1435 1674 1804 3045 4615 4720 6441 6472
REZ_AK . . . . . .  D ADDR   00A4H   A      385# 4383 4623
REZ_AME. . . . . .  D ADDR   005EH   A      363# 1142 1151 1192 1251 1345
REZ_DEL. . . . . .  D ADDR   00C5H   A      402# 816
REZ_R. . . . . . .  D ADDR   00C9H   A      403# 1472 1485
RE_HL. . . . . . .  C ADDR   28F0H   R   SEG=MAIN   6422# 6432 6436 6439
RE_HL1 . . . . . .  C ADDR   28F8H   R   SEG=MAIN   6420 6430#
RE_HL2 . . . . . .  C ADDR   28FFH   R   SEG=MAIN   6430 6434#
RE_HL3 . . . . . .  C ADDR   2906H   R   SEG=MAIN   6434 6438#
RFINDMEM . . . . .  C ADDR   0FBFH   R   SEG=MAIN   2620# 2621
RGO23NO. . . . . .  C ADDR   151FH   R   SEG=MAIN   3397# 3402
RGOTO7 . . . . . .  C ADDR   16D7H   R   SEG=MAIN   3680# 3714
RHNOR11. . . . . .  C ADDR   12FFH   R   SEG=MAIN   3087 3099 3105#
RHNOT1 . . . . . .  C ADDR   12C6H   R   SEG=MAIN   3062 3071#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RI21_23. . . . . .  C ADDR   0FE3H   R   SEG=MAIN   2627 2639#
RI6. . . . . . . .  C ADDR   0FDDH   R   SEG=MAIN   2630 2635# 2644 2655 2678 2682
RIGBLO . . . . . .  C ADDR   10C6H   R   SEG=MAIN   2759# 2790 2792
RIGBLOK. . . . . .  C ADDR   1104H   R   SEG=MAIN   2803#
RIGHT2 . . . . . .  C ADDR   0DECH   R   SEG=MAIN   2322 2326#
RIGHT3 . . . . . .  C ADDR   0DF0H   R   SEG=MAIN   2324 2329#
RIKN . . . . . . .  C ADDR   0F65H   R   SEG=MAIN   2552# 2570
RIZMAN . . . . . .  C ADDR   0D43H   R   SEG=MAIN   2242# 2281
RI_31. . . . . . .  C ADDR   0FFDH   R   SEG=MAIN   2642 2651#
RKNLEFT. . . . . .  C ADDR   118AH   R   SEG=MAIN   2901# 2946
RKNMEM . . . . . .  C ADDR   117BH   R   SEG=MAIN   2896# 2952
RKNNUL . . . . . .  C ADDR   1187H   R   SEG=MAIN   2900# 2940
RKNOPT . . . . . .  C ADDR   0D40H   R   SEG=MAIN   2241# 2292
RKNRAZR. . . . . .  C ADDR   0D3DH   R   SEG=MAIN   2240# 2286
RKVVOD0. . . . . .  C ADDR   1457H   R   SEG=MAIN   3286 3293#
RLABELF. . . . . .  C ADDR   0D3AH   R   SEG=MAIN   2239# 2278
RLABELH. . . . . .  C ADDR   1184H   R   SEG=MAIN   2899# 2937
RLABELI. . . . . .  C ADDR   12CCH   R   SEG=MAIN   3074#
RLABELK. . . . . .  C ADDR   12C9H   R   SEG=MAIN   3073# 3076
RLABELL. . . . . .  C ADDR   0FBCH   R   SEG=MAIN   2619#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   148

RLABELL1 . . . . .  C ADDR   1139H   R   SEG=MAIN   2842 2845#
RLABELN. . . . . .  C ADDR   1040H   R   SEG=MAIN   2680 2684#
RLABELP. . . . . .  C ADDR   19B1H   R   SEG=MAIN   4062# 4065
RLABELS13. . . . .  C ADDR   1AC5H   R   SEG=MAIN   4203# 4231
RLABELS4 . . . . .  C ADDR   1AC2H   R   SEG=MAIN   4202# 4205
RLABL2 . . . . . .  C ADDR   14BDH   R   SEG=MAIN   3337#
RLABM. . . . . . .  C ADDR   14C0H   R   SEG=MAIN   3338# 3342
RLEFCUR. . . . . .  C ADDR   177EH   R   SEG=MAIN   3774# 3778
RLER . . . . . . .  C ADDR   2571H   R   SEG=MAIN   5953 5955#
RLIST_43 . . . . .  C ADDR   1815H   R   SEG=MAIN   3848# 3850
RMAS4. . . . . . .  C ADDR   0479H   R   SEG=MAIN   959# 961
RME21_23 . . . . .  C ADDR   17E5H   R   SEG=MAIN   3806 3825#
RMO220 . . . . . .  C ADDR   066AH   R   SEG=MAIN   1215# 1262
RNNMEMB. . . . . .  C ADDR   1046H   R   SEG=MAIN   2687# 2690
RNO3PARN . . . . .  C ADDR   09F1H   R   SEG=MAIN   1721# 1735
RNOBUF0. . . . . .  C ADDR   0B0EH   R   SEG=MAIN   1898 1921#
RNOCHI0. . . . . .  C ADDR   07BCH   R   SEG=MAIN   1383 1387#
RNOH37 . . . . . .  C ADDR   1323H   R   SEG=MAIN   3124# 3128 3135 3149
RNOM31 . . . . . .  C ADDR   1655H   R   SEG=MAIN   3607# 3608
RNOMEMK. . . . . .  C ADDR   1414H   R   SEG=MAIN   3261# 3279
RNORVICH . . . . .  C ADDR   09EFH   R   SEG=MAIN   1663 1664 1720#
RNOT1IN. . . . . .  C ADDR   0AC3H   R   SEG=MAIN   1801 1871#
RNOTESTIZM . . . .  C ADDR   0680H   R   SEG=MAIN   1229# 1264
ROUSTA . . . . . .  C ADDR   199DH   R   SEG=MAIN   4046 4054#
ROUSTA1. . . . . .  C ADDR   19AEH   R   SEG=MAIN   4054 4060#
ROUT6. . . . . . .  C ADDR   0D37H   R   SEG=MAIN   2238# 2277
ROUT7. . . . . . .  C ADDR   1181H   R   SEG=MAIN   2898# 2931 2936
ROUTF. . . . . . .  C ADDR   1320H   R   SEG=MAIN   3120# 3194
RR0. . . . . . . .  N NUMB   0000H   A      441# 2249 2861 2908 4545
RR1. . . . . . . .  N NUMB   0001H   A      442# 2250 2860 2909 4544
RR2. . . . . . . .  N NUMB   0002H   A      444# 1271 1283 1289 1301 1313 1324 2251 2859 2910 3876 3884 4543 4697
                                           4709 4715 4727 5360
RR3. . . . . . . .  N NUMB   0003H   A      445# 1272 1282 1290 1300 1314 1325 2252 2858 2911 3877 3883 4542 4698
                                           4708 4716 4726 5361
RR4. . . . . . . .  N NUMB   0004H   A      1273 1281 1291 1299 1315 1326 2253 2857 2912 3878 3882 4541 4699 4707
                                           4717 4725 6507# 6564 6585 6601 6645 6667
RR5. . . . . . . .  N NUMB   0005H   A      1274 1280 1292 1298 1316 1327 2254 2856 2913 3879 3881 4540 4700 4706
                                           4718 4724 6508# 6565 6572 6579 6646 6655
RR6. . . . . . . .  N NUMB   0006H   A      443# 2255 2855 2914 4539
RR7. . . . . . . .  N NUMB   0007H   A      446# 2256 2854 2915 4538
RRIR . . . . . . .  C ADDR   257EH   R   SEG=MAIN   5964 5966#
RRMO220. . . . . .  C ADDR   07B9H   R   SEG=MAIN   1360 1386#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   098EH   R   SEG=MAIN   1653# 1665 1667 1668
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 501
RTIZMRI. . . . . .  C ADDR   0EC6H   R   SEG=MAIN   2475#
RVVIZKO. . . . . .  C ADDR   1301H   R   SEG=MAIN   3107# 3115
RVVKALI52. . . . .  C ADDR   1AF1H   R   SEG=MAIN   4224 4226#
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SADIAP . . . . . .  D ADDR   0034H   A      314# 578 1933 3929
SADIAP2. . . . . .  D ADDR   0032H   A      316# 1936 3932
SADIAP3. . . . . .  D ADDR   0031H   A      317# 1939 3935
SADIAP4. . . . . .  D ADDR   0030H   A      318# 1942 3937
SAUS . . . . . . .  D ADDR   0036H   A      313# 2070 2072 2089 2091 2135 2137 2216 2218
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2269 2565 2583 2773 2817 2837 2927 3537 3592 3697 4213 4340 4446
                                           6029 6037
SAVEIR2. . . . . .  C ADDR   2782H   R   SEG=MAIN   900 937 1019 1075 6122#
SAVELTE. . . . . .  C ADDR   04A7H   A      8342#
SAVEN_BL . . . . .  D ADDR   00D3H   A      406# 599 6390 6421
SAVEN_BL2. . . . .  D ADDR   00C0H   A      399# 607 6409 6431
SAVEN_BL3. . . . .  D ADDR   00C2H   A      400# 614 6413 6435
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   149

SAVEN_BL4. . . . .  D ADDR   00D9H   A      410# 621 6415 6438
SAVER2 . . . . . .  C ADDR   278EH   R   SEG=MAIN   591 593 595 597 805 815 817 840 858 874 888 1131 1143 1152 1197
                                           1202 1252 1352 1372 1378 1389 1473 1477 1679 2002 2048 2087 2116 2164 2176
                                           2202 2214 3048 3055 3907 4384 4476 4633 4735 4834 4846 4866 4941 5006 5022
                                           5037 5092 5157 5172 5184 5973 6136# 6473
SAVE_HL. . . . . .  C ADDR   28B5H   R   SEG=MAIN   1928 3388 3425 3444 3466 3488 3738 6388#
SA_HL. . . . . . .  C ADDR   28BCH   R   SEG=MAIN   6391# 6410 6414 6416
SA_HL1 . . . . . .  C ADDR   28D7H   R   SEG=MAIN   6389 6408#
SA_HL2 . . . . . .  C ADDR   28DEH   R   SEG=MAIN   6408 6412#
SA_HL3 . . . . . .  C ADDR   28E5H   R   SEG=MAIN   6412 6415#
SBUF0. . . . . . .  D ADDR   0099H   A      40# 5202 5208
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160 509 5203 5207 5210 5211 5232
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   219AH   R   SEG=MAIN   5260# 5267
SDV1 . . . . . . .  C ADDR   21AEH   R   SEG=MAIN   5272# 5278
SDVIG0 . . . . . .  C ADDR   0309H   R   SEG=MAIN   765# 767
SDVIG1 . . . . . .  C ADDR   02FEH   R   SEG=MAIN   757# 759
SDVIG2 . . . . . .  C ADDR   02F3H   R   SEG=MAIN   749# 751
SDVIG3 . . . . . .  C ADDR   02E7H   R   SEG=MAIN   740# 742
SDVIG4 . . . . . .  C ADDR   0318H   R   SEG=MAIN   775# 777
SDVIG6 . . . . . .  C ADDR   0322H   R   SEG=MAIN   782# 784
SDVM . . . . . . .  C ADDR   0320H   R   SEG=MAIN   772 781#
SEEGOON. . . . . .  C ADDR   09F6H   R   SEG=MAIN   1705 1710 1712 1718 1725#
SEEIND . . . . . .  C ADDR   0A04H   R   SEG=MAIN   1645 1652 1653 1737#
SEE_L43. . . . . .  C ADDR   18ECH   R   SEG=MAIN   3946 3954 3957#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      7438# 7459 7460 7485 7486 7510 7653 7670 7891 7931
SKOR19 . . . . . .  C ADDR   19FCH   R   SEG=MAIN   4091 4098#
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   1390H   R   SEG=MAIN   3189# 3205
SP . . . . . . . .  D ADDR   0081H   A      17# 462
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 507
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 506
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 5249
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SPWRI. . . . . . .  C ADDR   1A9DH   R   SEG=MAIN   4181 4183#
SS1. . . . . . . .  C ADDR   22D0H   R   SEG=MAIN   5509# 5511
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      394# 802 804 819 837 839 855 857 871 873 1410 1619 2343 3035
SUMT2. . . . . . .  C ADDR   0374H   R   SEG=MAIN   793 834#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196 520 1964 2891 4569 5194
T2MSME . . . . . .  C ADDR   1742H   R   SEG=MAIN   3746# 3752
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   2470H   R   SEG=MAIN   5785# 5795
TABN . . . . . . .  C ADDR   2508H   R   SEG=MAIN   5887# 5891
TABT11 . . . . . .  C ADDR   2288H   R   SEG=MAIN   5446# 5867
TABT7. . . . . . .  C ADDR   228CH   R   SEG=MAIN   4672 5450# 5880
TABT9. . . . . . .  C ADDR   228AH   R   SEG=MAIN   5448# 5877
TABUS. . . . . . .  C ADDR   2274H   R   SEG=MAIN   5382 5435#
TAKTIND. . . . . .  C ADDR   0A41H   R   SEG=MAIN   1772 1775#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   150

TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 498 499 513
TE10MS . . . . . .  C ADDR   25D4H   R   SEG=MAIN   3745 6052#
TE22 . . . . . . .  C ADDR   24FBH   R   SEG=MAIN   5866 5876#
TE23 . . . . . . .  C ADDR   2503H   R   SEG=MAIN   5876 5880#
TE2MS. . . . . . .  C ADDR   25CAH   R   SEG=MAIN   3751 6051#
TEAEQU0. . . . . .  C ADDR   2610H   R   SEG=MAIN   3162 6060#
TEAVK. . . . . . .  C ADDR   264CH   R   SEG=MAIN   4589 6067#
TEBEQU0. . . . . .  C ADDR   261AH   R   SEG=MAIN   6061#
TEBL . . . . . . .  C ADDR   2700H   R   SEG=MAIN   2732 3330 6089#
TEBL0. . . . . . .  C ADDR   270AH   R   SEG=MAIN   3556 6090#
TECH . . . . . . .  C ADDR   2714H   R   SEG=MAIN   3837 4004 6091#
TECLE. . . . . . .  C ADDR   26C5H   R   SEG=MAIN   2724 3298 6083#
TEEND. . . . . . .  C ADDR   2764H   R   SEG=MAIN   4686 6100#
TEERR. . . . . . .  C ADDR   275AH   R   SEG=MAIN   6044 6099#
TEFULL . . . . . .  C ADDR   26ECH   R   SEG=MAIN   2739 3523 6087#
TEINT. . . . . . .  C ADDR   26F6H   R   SEG=MAIN   3623 6088#
TEIZMK . . . . . .  C ADDR   26A7H   R   SEG=MAIN   2523 3101 6080#
TEKALIB. . . . . .  C ADDR   2656H   R   SEG=MAIN   3813 4592 6068#
TEKD . . . . . . .  C ADDR   269DH   R   SEG=MAIN   4270 6079#
TELIST . . . . . .  C ADDR   26E1H   R   SEG=MAIN   2707 3247 3309 3315 6086#
TEMAX. . . . . . .  C ADDR   2732H   R   SEG=MAIN   4040 6094#
TEMEM. . . . . . .  C ADDR   26CFH   R   SEG=MAIN   6084#
TEMENU . . . . . .  C ADDR   2624H   R   SEG=MAIN   6062#
TEMID. . . . . . .  C ADDR   273CH   R   SEG=MAIN   4048 6095#
TEMIN. . . . . . .  C ADDR   2728H   R   SEG=MAIN   3568 4056 6093#
TEMUL. . . . . . .  C ADDR   0767H   R   SEG=MAIN   1307 1344#
TENMIN . . . . . .  C ADDR   2372H   R   SEG=MAIN   1210 1212 1226 5577#
TEOLI. . . . . . .  C ADDR   2746H   R   SEG=MAIN   1511 6097#
TEOLL. . . . . . .  C ADDR   26BBH   R   SEG=MAIN   1605 6082#
TEOLR. . . . . . .  C ADDR   2750H   R   SEG=MAIN   1507 6098#
TEOUT. . . . . . .  C ADDR   26B1H   R   SEG=MAIN   2531 2612 3092 6081#
TEPAR. . . . . . .  C ADDR   2693H   R   SEG=MAIN   4609 6078#
TES19_2. . . . . .  C ADDR   2689H   R   SEG=MAIN   530 2664 4098 4322 6076#
TES57_6. . . . . .  C ADDR   267FH   R   SEG=MAIN   2658 4092 4317 4605 6075#
TESKOR . . . . . .  C ADDR   2642H   R   SEG=MAIN   4586 6066#
TEST01 . . . . . .  C ADDR   2135H   R   SEG=MAIN   5207# 5230
TEST02 . . . . . .  C ADDR   2164H   R   SEG=MAIN   5227 5229#
TEST04 . . . . . .  C ADDR   2145H   R   SEG=MAIN   5214# 5216
TEST1. . . . . . .  C ADDR   212BH   R   SEG=MAIN   5202# 5218 5239
TEST2. . . . . . .  C ADDR   215DH   R   SEG=MAIN   5207 5226#
TEST22 . . . . . .  C ADDR   1A72H   R   SEG=MAIN   4148 4155#
TEST23 . . . . . .  C ADDR   1A77H   R   SEG=MAIN   4155 4158#
TEST3. . . . . . .  C ADDR   214FH   R   SEG=MAIN   5209 5219#
TEST4. . . . . . .  C ADDR   213DH   R   SEG=MAIN   5210# 5225
TEST5. . . . . . .  C ADDR   2167H   R   SEG=MAIN   5228 5231#
TEST7I . . . . . .  C ADDR   0A59H   R   SEG=MAIN   1787 1790#
TEST9I . . . . . .  C ADDR   0A52H   R   SEG=MAIN   1782 1787#
TESTAT . . . . . .  C ADDR   271EH   R   SEG=MAIN   2715 3289 6092#
TESTRS . . . . . .  C ADDR   2129H   R   SEG=MAIN   4081 5200#
TESTS. . . . . . .  C ADDR   1A66H   R   SEG=MAIN   4150# 4157 4160
TETE11 . . . . . .  C ADDR   2661H   R   SEG=MAIN   4070 4596 6070#
TETE7. . . . . . .  C ADDR   2675H   R   SEG=MAIN   4137 4602 6072#
TETE9. . . . . . .  C ADDR   266BH   R   SEG=MAIN   4599 6071#
TETESI . . . . . .  C ADDR   262EH   R   SEG=MAIN   2996 4579 6064#
TETESR . . . . . .  C ADDR   2638H   R   SEG=MAIN   4583 6065#
TEVICH . . . . . .  C ADDR   2606H   R   SEG=MAIN   2365 2539 3097 4485 6059#
TEWR . . . . . . .  C ADDR   26D7H   R   SEG=MAIN   2698 3304 6085#
TEXTT. . . . . . .  C ADDR   25CAH   R   SEG=MAIN   5462 6050#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 481
TH1. . . . . . . .  D ADDR   008DH   A      29# 528 532 4195 4197
TH2. . . . . . . .  D ADDR   00CDH   A      89# 1961 2888 4566
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   151

TIM. . . . . . . .  C ADDR   21BEH   R   SEG=MAIN   5281#
TIM1 . . . . . . .  C ADDR   21C0H   R   SEG=MAIN   5282# 5282
TIM2 . . . . . . .  C ADDR   21C3H   R   SEG=MAIN   5263 5266 5273 5277 5285# 5328 5332 6309 6311
TIM3 . . . . . . .  C ADDR   21C5H   R   SEG=MAIN   5286# 5286
TIZMRI . . . . . .  C ADDR   0DE5H   R   SEG=MAIN   2321# 2475
TL0. . . . . . . .  D ADDR   008AH   A      26# 482
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88# 1962 2889 4567
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   138DH   R   SEG=MAIN   3174 3186#
TMOD . . . . . . .  D ADDR   0089H   A      25# 479 512
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 496
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 495
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TOME13 . . . . . .  C ADDR   19DDH   R   SEG=MAIN   4079 4084#
TOME14 . . . . . .  C ADDR   1A0AH   R   SEG=MAIN   4084 4105#
TOME15 . . . . . .  C ADDR   1A22H   R   SEG=MAIN   4105 4117#
TOME21 . . . . . .  C ADDR   19D4H   R   SEG=MAIN   4068 4079#
TOSK19 . . . . . .  C ADDR   1BA1H   R   SEG=MAIN   4316 4322#
TOUTF. . . . . . .  C ADDR   130AH   R   SEG=MAIN   3111# 3114
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TTOUT. . . . . . .  C ADDR   0EC9H   R   SEG=MAIN   2477# 2486
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 5250
UNPACK1. . . . . .  C ADDR   009EH   A      7456# 7650 7784 7914 8028
UNPACK2. . . . . .  C ADDR   00BAH   A      7481# 7651 7785 7915
UP1. . . . . . . .  C ADDR   0138H   A      7601# 7618
UP2. . . . . . . .  C ADDR   014BH   A      7621# 7639
UP2A . . . . . . .  C ADDR   0161H   A      7600 7637#
UPA. . . . . . . .  C ADDR   23A1H   R   SEG=MAIN   5632# 5638
UPA1 . . . . . . .  C ADDR   23B1H   R   SEG=MAIN   5650# 5656
UPA2 . . . . . . .  C ADDR   2391H   R   SEG=MAIN   5613# 5619
UPAA . . . . . . .  C ADDR   288DH   R   SEG=MAIN   6357# 6363
UPAA4. . . . . . .  C ADDR   23FCH   R   SEG=MAIN   5713# 5719
UPAB . . . . . . .  C ADDR   240CH   R   SEG=MAIN   5730# 5736
UPAK . . . . . . .  C ADDR   239BH   R   SEG=MAIN   5629#
UPAK1. . . . . . .  C ADDR   2867H   R   SEG=MAIN   6322#
UPAK2. . . . . . .  C ADDR   238BH   R   SEG=MAIN   5610#
UPAK3. . . . . . .  C ADDR   23ABH   R   SEG=MAIN   3766 3861 5647#
UPAK4. . . . . . .  C ADDR   2887H   R   SEG=MAIN   3720 6354#
UPAKA. . . . . . .  C ADDR   23F6H   R   SEG=MAIN   4468 5710#
UPAKB. . . . . . .  C ADDR   2406H   R   SEG=MAIN   4515 5727#
UPAV1. . . . . . .  C ADDR   1B10H   R   SEG=MAIN   4250# 4256
UPAV2. . . . . . .  C ADDR   1BD3H   R   SEG=MAIN   4367# 4373
UPK1 . . . . . . .  C ADDR   2879H   R   SEG=MAIN   6330 6333#
UPK2 . . . . . . .  C ADDR   287AH   R   SEG=MAIN   6332 6334#
VICHMAX. . . . . .  C ADDR   2068H   R   SEG=MAIN   4042 5063#
VICHMEAN . . . . .  C ADDR   1EACH   R   SEG=MAIN   4050 4775#
VICHMIN. . . . . .  C ADDR   1F8FH   R   SEG=MAIN   3570 4058 4913#
VICHR. . . . . . .  D ADDR   00B1H   A      392# 1265 1778 2362 2371 2505 2518 2623 2631 3000 3004 3012 3086 3153
                                           3265 3802 3810 3819 4063 4114 4128 4268 4459 4498 4530 4577 5865
VIG0 . . . . . . .  C ADDR   0AAFH   R   SEG=MAIN   1855# 1857
VIG4 . . . . . . .  C ADDR   0ABDH   R   SEG=MAIN   1866# 1868
VIOUT. . . . . . .  C ADDR   0EA0H   R   SEG=MAIN   2368 2450# 2478
VIOUTF . . . . . .  C ADDR   1303H   R   SEG=MAIN   3108#
VIT2_10. . . . . .  C ADDR   0E13H   R   SEG=MAIN   2351# 2357
VODM11_15. . . . .  C ADDR   17A1H   R   SEG=MAIN   3791# 3809
VOLUME . . . . . .  D ADDR   00D5H   A      407# 2309 3733 6398 6400
VV21_23. . . . . .  C ADDR   1A5DH   R   SEG=MAIN   4134 4146#
VVCHIBL. . . . . .  C ADDR   253FH   R   SEG=MAIN   2606 5919#
VVCHIF . . . . . .  C ADDR   251AH   R   SEG=MAIN   5895# 5912
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   152

VVINTE . . . . . .  C ADDR   1702H   R   SEG=MAIN   3684 3712#
VVIZKO . . . . . .  C ADDR   135AH   R   SEG=MAIN   3107 3153#
VVKALI52 . . . . .  C ADDR   1BC6H   R   SEG=MAIN   4226 4351# 4403
VVMENU . . . . . .  C ADDR   1B76H   R   SEG=MAIN   4233 4304#
VVNOL23. . . . . .  C ADDR   253AH   R   SEG=MAIN   5916# 5920
VVNOL31. . . . . .  C ADDR   2535H   R   SEG=MAIN   5914# 5916
VVNOL41. . . . . .  C ADDR   2533H   R   SEG=MAIN   5912# 5914
VVOD2_10 . . . . .  C ADDR   173AH   R   SEG=MAIN   3274 3393 3493 3743#
VVOD43 . . . . . .  C ADDR   1918H   R   SEG=MAIN   3976 3983#
VVODM11_15 . . . .  C ADDR   19B4H   R   SEG=MAIN   3791 4063#
VVOSTA . . . . . .  C ADDR   1975H   R   SEG=MAIN   4019 4038#
VVOSTAD. . . . . .  C ADDR   1989H   R   SEG=MAIN   4038 4046#
VVRR6. . . . . . .  C ADDR   0F25H   R   SEG=MAIN   2523#
VV_52V . . . . . .  C ADDR   1AE8H   R   SEG=MAIN   4207 4223#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 477 478
WORK . . . . . . .  D ADDR   00B8H   A      396# 1492 1494 1500 1516 1523 1539 1560 1565 1581 1806 1884 3360 3370
                                           3372 3406 3416 3418 3428 3438 3440 3447 3457 3459 3469 3479 3481 4783 4830
                                           4833 4842 4845 4857 4919 4937 4940 4995 5005 5011 5021 5025 5070 5088 5091
                                           5146 5156 5161 5171 5204 5226
WR1. . . . . . . .  C ADDR   2854H   R   SEG=MAIN   6305# 6312
WRITE. . . . . . .  C ADDR   2851H   R   SEG=MAIN   671 5756 5758 5760 5762 5764 5766 5769 5771 5773 5776 5778 5780
                                           6303#
WRITED_X1. . . . .  C ADDR   21C9H   R   SEG=MAIN   5291#
WRITE_X1 . . . . .  C ADDR   21C8H   R   SEG=MAIN   5290#
WRPAGE . . . . . .  C ADDR   0480H   A      4192 4665 4767 8303#
WW5. . . . . . . .  C ADDR   0483H   A      8304# 8312
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 473 505
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 474
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 475 504
XCIKLWR. . . . . .  C ADDR   276EH   R   SEG=MAIN   895 908 910 912 915 918 921 924 927 930 963 965 967 970 973 976
                                           979 982 985 987 990 992 994 997 1000 1003 1006 1009 1012 1064 1066 1068
                                           6105#
XTEMP. . . . . . .  N NUMB   000CH   A      6504# 6868 6869 6870 6871 6957 6959 6960 6962 6963 6965 6966 6968 6990
                                           6991 6992 6993 7011 7012 7016 7017 7020 7024 7025 7028 7032 7033 7037 7038
                                           7040 7041 7042 7044 7048 7049 7051 7052 7056 7057 7062 7063 7065 7066 7070
                                           7071 7076 7078 7079 7080
YBNUL. . . . . . .  C ADDR   129BH   R   SEG=MAIN   3043 3051#
YES. . . . . . . .  C ADDR   2ABCH   R   SEG=MAIN   6890 6894 6898 6902 6920# 6983
YES0KEY. . . . . .  C ADDR   02C3H   R   SEG=MAIN   701 713#
YES0KEY1 . . . . .  C ADDR   02D0H   R   SEG=MAIN   720# 727
YESAVP . . . . . .  C ADDR   07C6H   R   SEG=MAIN   1366 1392#
YESBUF . . . . . .  C ADDR   0B13H   R   SEG=MAIN   1919 1924#
YESIND . . . . . .  C ADDR   0A5BH   R   SEG=MAIN   1777 1786 1789 1792#
YESPRD . . . . . .  C ADDR   0B11H   R   SEG=MAIN   1918 1922#
YESTEST. . . . . .  C ADDR   2263H   R   SEG=MAIN   5377 5409#
YESTT5 . . . . . .  C ADDR   0BE6H   R   SEG=MAIN   2040#
YESVICH. . . . . .  C ADDR   0811H   R   SEG=MAIN   1380 1431#
YESVI_KM . . . . .  C ADDR   1E15H   R   SEG=MAIN   4612 4692#
YESVI_KR . . . . .  C ADDR   1D8DH   R   SEG=MAIN   4612# 4614
YST1 . . . . . . .  C ADDR   01A2H   R   SEG=MAIN   529 533#
YST19. . . . . . .  C ADDR   019AH   R   SEG=MAIN   526 530#
Z01S . . . . . . .  C ADDR   22E8H   R   SEG=MAIN   5526# 5528
Z05S . . . . . . .  C ADDR   22F5H   R   SEG=MAIN   5535# 5537
Z100 . . . . . . .  C ADDR   22B9H   R   SEG=MAIN   5490# 5492
Z15. . . . . . . .  C ADDR   22C7H   R   SEG=MAIN   5502# 5504
Z1S. . . . . . . .  C ADDR   22DBH   R   SEG=MAIN   5518# 5520
ZAPADC . . . . . .  C ADDR   2198H   R   SEG=MAIN   5259#
ZCMP . . . . . . .  C ADDR   27F0H   R   SEG=MAIN   6212#
ZDIV . . . . . . .  C ADDR   27BDH   R   SEG=MAIN   813 1123 3900 6175#
ZER1 . . . . . . .  C ADDR   00B3H   A      7466 7470# 7525 7568
ZER2 . . . . . . .  C ADDR   00D4H   A      7492 7496#
ZMUL . . . . . . .  C ADDR   27B3H   R   SEG=MAIN   6170#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      324# 1699 3925 4884 5055 6183 6186 6189
ZNPLUS . . . . . .  C ADDR   02DAH   R   SEG=MAIN   682 729#
ZZ . . . . . . . .  C ADDR   22C9H   R   SEG=MAIN   5503# 5503
A51 MACRO ASSEMBLER  AMP33_2                                                              02/26/2007 12:28:42 PAGE   153

Z_01S. . . . . . .  C ADDR   22E4H   R   SEG=MAIN   2261 2262 2920 5224 5238 5524# 6041
Z_05S. . . . . . .  C ADDR   22F1H   R   SEG=MAIN   2034 2035 2735 4043 4051 4059 5533#
Z_100. . . . . . .  C ADDR   22B7H   R   SEG=MAIN   5489#
Z_15 . . . . . . .  C ADDR   22C5H   R   SEG=MAIN   650 5501#
Z_1MS. . . . . . .  C ADDR   22CEH   R   SEG=MAIN   720 5231 5508#
Z_1S . . . . . . .  C ADDR   22D7H   R   SEG=MAIN   639 647 1427 2367 3571 3844 3965 4017 4309 4395 4497 4689 4690
                                           5516#
Z_5. . . . . . . .  C ADDR   22C0H   R   SEG=MAIN   5295 5305 5496#
Z_9. . . . . . . .  C ADDR   284CH   R   SEG=MAIN   5252 6297#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
