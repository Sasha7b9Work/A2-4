A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp23.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp23.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236             
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                        jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti   
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
                     310                     
                     311     
                     312     ;;;;;
  0020               313      cellbit                DATA    20h
  0000               314     bitznak         BIT     cellbit.0       ;20.0           
  0001               315     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               316     znmat           BIT             cellbit.2       ;20.2
  0003               317     bitrs           BIT             cellbit.3       ;20.3
  0004               318     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               319     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               320     bitvi11         BIT             cellbit.6       ;20.6   бит нажатия ввод режима вычислить R
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     6

                             !!!
  0007               321     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us
                     322     
  0021               323     cellbit1                DATA    21h
  0008               324     bitbuf          BIT     cellbit1.0      ;21.0           
  0009               325     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               326     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               327     bitmem          BIT             cellbit1.3      ;21.3
  000C               328     bmem11          BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               329     bmem12          BIT             cellbit1.5      ;21.5    бит ПАМ12
  000E               330     bmem13          BIT             cellbit1.6      ;21.6   бит ПАМ13        
  000F               331     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     332     
  0022               333     cellbit2                DATA    22h
  0010               334     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               335     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               336     bitklb          BIT             cellbit2.2      ;22.2  признак калибровки
  0013               337     bitv19          BIT             cellbit2.3      ;22.3           бит установки скор итерфейс
                             а 19.6
  0014               338     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               339     biteizm         BIT             cellbit2.5      ;22.5   признак теста измерения 
  0016               340     bitvi31         BIT             cellbit2.6      ;22.6   бит ПАМ13        
  0017               341     bitoll          BIT             cellbit2.7      ;22.7
                     342     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     343     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     344     ;и выдает т.н. буфер индикации  
  0023               345     cellbit3                DATA    23h
  0018               346     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               347     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               348     bitakt          BIT             cellbit3.2      ;22.2  бит такта
  001B               349     bitznB          BIT             cellbit3.3      ;22.3 БИТ ЗНАКА ПРИ ВВОДЕ константы В
                     350     ;bit            BIT             cellbit3.4      ;22.4    
                     351     ;bit            BIT             cellbit3.5      ;22.5    
                     352     ;bit            BIT             cellbit3.6      ;22.6            
                     353     ;bit            BIT             cellbit3.7      ;22.7
                     354             
  005E               355     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     356     ;hex
  0062               357     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               358     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               359     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               360     rez_A2   data 7bh; A2
                     361     
  0098               362     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               363     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               364     chdel    data  83h              ; счетчик задержки
                     365     ;float
  0084               366     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               367     rezAp    data  88h              ;4byte  A+
  008C               368     rezAm    data  8ch              ;4byte  A-
  0090               369     koefKp   data  90h              ;4byte  K+
  0094               370     koefKm   data  94h              ;4byte  K-
                     371     ;hex 
  009A               372     parT     data  9ah              ;параметр времени измерения
  009B               373     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               374     rez_A3   data  9ch              ;A3
                     375     ;FLOAT
  00A0               376     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               377     constE  data  0a4h         ;констант E
  00A8               378     constF  data  0a8h         ;констант F
  00AC               379     chind   data  0ach         ;счетчик индикации
  00AD               380     chbuf   data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               381     diap    data  0aeh         ;номер диапазона
  00AF               382     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               383     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               384     vichR   data  0b1h              ;параметр =11,12,13,21
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     7

  00B2               385     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               386     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               387     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               388     work    data  0b8h        ;рабочая ячейка
  00BC               389     konstA  data  0bch        ;     введенная с крана константа A
  00C0               390     konstB  data  0c0h         ;    введенная с крана константа B
  00C4               391     nblok   data  0c4h         ;номер блока
  00C5               392     Rez_del data  0c5h      ;сумма n-значений /n
  00C9               393     rez_R           data    0c9h            ;рез вычисления R
                     394     ;data  0cfh;параметр =11,12,13,21
                     395     ;data  0d0h
                     396     
                     397     ;внешнее ОЗУ 64K 
                     398     ;               XSEG AT 100h
                     399             PUBLIC    MASS0
  0080               400     MASS0  xdata 0080h;     скользящий массив измерения
  0084               401     MASS1  xdata 0084h;
  0088               402     MASS2  xdata 0088h;
  008C               403     MASS3  xdata 008ch;
  0090               404     MASS4  xdata 0090h;
  0094               405     MASS5  xdata 0094h;
  0098               406     MASS6  xdata 0098h;
  009C               407     MASS7  xdata 009ch;
  00A0               408     MASS8  xdata 00a0h;
  00A4               409     MASS9  xdata 00a4h;
  00A8               410     MASS10  xdata 00a8h;
  00AC               411     MASS11  xdata 00ach;
  00B0               412     MASS12  xdata 00b0h;
  00B4               413     MASS13  xdata 00b4h;
  00B8               414     MASS14  xdata 00b8h;
  00BC               415     MASS15  xdata 00bch;
  00C0               416     MASS16  xdata 00c0h;
  00C4               417     MASS17  xdata 00c4h;
  00C8               418     MASS18  xdata 00c8h;
  00CC               419     MASS19  xdata 00cch;
                     420     ;xdata 0038h;
                     421     
  0000               422                             rr0             EQU 00
  0001               423                     rr1       equ   01
  0006               424                     rr6   equ 06
  0002               425                     rr2       equ   02
  0003               426                     rr3       equ   03
  0007               427                     rr7   equ 07
                     428     
  0008               429                     r8   equ 08
  0009               430                     r9        equ   09
  000A               431                     r10       equ   10
  000B               432                     r11   equ 11
                     433     
                     434                     
                     435        
----                 436                  rseg     Main          ; Switch to this code segment.
                     437     
                     438                  using    0              ; Specify register bank for the following
                     439     
0100                 440     org 100h
                     441     ;$EJECT
                     442     
0100 7581E0          443     begin:     mov  sp, #0e0h
0103 75E900          444                                             mov             PCA0L,#00;=0x00;
0106 75D900          445                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          446                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          447                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          448                                             mov     P2MDOUT,#00;=0x00;
                     449             
0112 75A73F          450             mov     P3MDOUT,#3fh;
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     8

0115 75B5FF          451             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          452             mov     REF0CN,#03h;=0x03;
                     453             
011B 75E114          454             mov     XBR0,#14h;= 0x14;
011E 75E200          455             mov     XBR1,#00; =0x00;
0121 75E300          456             mov XBR2,#00;=0x00;
0124 75B0C0          457             mov     P3,#0c0h
0127 75FFDE          458             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          459             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          460             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          461             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          462             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          463             mov     TL0,#0f9h;=0xf9; 
0139 75E680          464             mov     EIE1,#80h;=0x80;
                     465     
013C 75D480          466             mov     DAC0CN,#80h;=0x80;
013F 75D780          467             mov     DAC1CN,#80h;=0x80;
0142 75B167          468             mov     OSCXCN,#67h;=0x67;
                     469     
                     470      
                     471     
0145 E5B1            472     gener:     mov a, oscxcn
0147 B4E7FB          473                cjne a,#11100111b,gener
                     474                            
014A 75B288          475             mov     OSCICN,#88h;=0x84;
014D 75CA00          476         mov TMR2RLL,#0;=0;
0150 75CBD1          477         mov TMR2RLH,#0d1h;=0xd1;
                     478       
0153 D28E            479                     setb  TCON.6                    ;регистр управления
0155 D28C            480                      setb tcon.4
                     481     
0157 75EF00          482             mov     RSTSRC,#0;=00   ;//источники сброса 
                     483     
                     484             
015A 75E340          485          mov        XBR2,#40h
015D 75E106          486              mov    XBR0,#06h;16h
0160 75F803          487             mov             SPI0CN,#03
0163 759D31          488             mov             spi0ckr,#31H;;;;;;;;#04
                     489     ;       mov             EIE2,#20H
0166 75E730          490             mov             EIE2,#30H;00110000
0169 75A880          491             mov     IE,#80h;//10000000      ;//Снятие блокировки всех прерываний
                     492     ;ozu
016C E4              493                             clr     a
016D 7800            494                             mov     r0,#00h 
016F F6              495     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
0170 08              496                             inc     r0
0171 B87FFB          497                             cjne    r0,#7fh,mecle
0174 7880            498                             mov     r0,#80h
0176 F6              499     meff:           mov     @r0,a 
0177 F2              500                             movx @r0,a
0178 08              501                             inc     r0
0179 B8DFFA          502                             cjne    r0,#0dfh,meff
017C 120000   F      503                             call    clmassix
017F 7898            504                             mov             r0,#chinkor
0181 7600            505                             mov             @r0,#0;1;
0183 08              506                             inc             r0
0184 76C8            507                             mov             @r0,#0c8h;90h;
                     508                             ;;;;
0186 7881            509                             mov             r0,#chavt
0188 7603            510                             mov             @r0,#3;1
018A 08              511                             inc             r0
018B 7620            512                             mov             @r0,#20h;90h
                     513     
018D 78B2            514                                     mov             r0,#marker
018F 76FF            515                                     mov             @r0,#0ffh
                     516                             ;mov            r0,#chind
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE     9

                     517                             ;mov            @r0,#1
                     518                     
0191 74FF            519                             mov             a,#0ffh
0193 F585            520                        mov          p5,a
0195 799A            521                             mov             r1,#parT
0197 7702            522                             mov             @r1,#2                  ;Tizm=1s
0199 79AE            523                             mov             r1,#diap
019B 7705            524                             mov             @r1,#5                  ;10-7a
019D 79AF            525                             mov             r1,#parN
019F 7702            526                             mov             @r1,#2
01A1 7400            527                             mov             a,#00h
01A3 F585            528                             mov             p5,a
01A5 D204            529                             setb    bitizm
                     530     
01A7 799B            531                             mov             r1,#chbefore
01A9 7700            532                             mov             @r1,#0
                     533                             ;;;;;;
01AB 900000   F      534                             mov             dptr,#ch_1              ;1->r2..r5 float
01AE 120000   F      535                             call    ldc_long
01B1 7890            536                             mov             r0,#koefKp         ;1(float)->koefKp
01B3 120000   F      537                             call    saver2
01B6 7894            538                             mov             r0,#koefKm              ;1(float)->koefKm
01B8 120000   F      539                             call    saver2
01BB 78A0            540                             mov             r0,#koefKD
01BD 120000   F      541                             call    saver2  
                     542     ;START
                     543     ;                                       rez_A0=0;
                     544     ;        SUMM=0; //обнуление скользящего массива
                     545     ;        over_mas=0;
                     546     ;        count_mas=0;
                     547     
01C0 7840            548                             mov             r0,#bufind
01C2                 549     age2:
01C2 76FD            550                             mov             @r0,#0fdh         ;погасить индикатор
01C4 08              551                             inc             r0
01C5 B84CFA          552                             cjne    r0,#bufind+12,age2              
01C8 120000   F      553                             call    ind
01CB 120000   F      554                             call    z_1s
                     555     
                     556                                     ;зажечь все лементы индикации
01CE 7840            557                             mov             r0,#bufind
01D0 76FE            558     ageon:          mov             @r0,#0feh;?
01D2 08              559                             inc             r0
01D3 B84CFA          560                             cjne    r0,#bufind+12,ageon             
01D6 120000   F      561                             call    ind
01D9 120000   F      562                             call    z_1s            ;1sec
                     563     ;;;;;;;;;;;;;;;;
01DC 7840            564                             mov             r0,#bufind
01DE 7630            565                             mov             @r0,#30H;"A"
01E0 08              566                             inc             r0
01E1 7630            567                             mov             @r0,#30H;"В"
01E3 08              568                             inc             r0
01E4 7630            569                             mov             @r0,#30H;"Т"
01E6 08              570                             inc             r0
01E7 7634            571                             mov             @r0,#34H;2dh
01E9 08              572                             inc             r0
01EA 7635            573                             mov             @r0,#35H;"H"
01EC 08              574                             inc             r0
01ED 7636            575                             mov             @r0,#36h
01EF 08              576                             inc             r0
01F0 7637            577                             mov             @r0,#37h
01F2 08              578                             inc             r0
01F3 762D            579                             mov             @r0,#2dh
01F5 08              580                             inc             r0
01F6 7637            581                             mov             @r0,#37h
01F8 08              582                             inc             r0
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    10

01F9 7641            583                             mov             @r0,#"A";31h
01FB 08              584                             inc             r0
                     585                     
01FC 120000   F      586     dd:                     call    ind
01FF 120000   F      587                             call    z_15;z_1ms
0202 434B10          588                             orl             bufind+11,#10h;бит точки после 1 знакоместа
                     589     ;;;;;;;;;;;;;;;;;;;
0205 7C60            590                             mov             r4,#60h
0207 7D00            591                             mov             r5,#00         
0209 120000   F      592                             call    iniacp;инициализация acp
020C 120000   F      593                             call    loadUS          ;us 10-7 A
                     594                             
020F C217            595     rebyte:         clr             bitoll
0211 3095FD          596                             jnb             p1.5,$
0214 2095FD          597                             jb              p1.5,$
0217 E586            598                             mov             a,P6            ;p6.4=0
0219 54EF            599                             anl             a,#0efh
021B F586            600                             mov             P6,a
021D 00              601                             nop
021E 00              602                             nop
                     603                                     
021F E586            604                             mov             a,P6                    ;p6.4=1 
0221 4410            605                             orl             a,#10h
0223 F586            606                             mov             P6,a                        
0225 7411            607                             mov             a,#11h
0227 120000   F      608                             call    write
                     609                             ;чтение acp
022A 120000   F      610                             call    read    
022D F578            611                             mov     reacp+1,A       ;старший байт 
022F 120000   F      612                             call    read    
0232 F579            613                             mov     reacp+2,A       ;средний байт 
0234 120000   F      614                             call    read
0237 F57A            615                             mov     reacp+3,A               ;мл байт
                     616                        ;;;;;;;;;;;
0239 7878            617                        mov          r0,#reacp+1
023B E6              618                        mov          a,@r0
023C 20E72D          619                             jb              acc.7,znplus;
023F D200            620                             setb    bitznak
0241 4480            621                             orl             a,#80h  ;ост содерж яч 
0243 F6              622                             mov             @r0,a
                     623                                     
0244 18              624     mmm:            dec             r0;,#reacp
0245 76FF            625                             mov             @r0,#0ffh
0247 802B            626                             jmp             goznak
                     627     
                     628     
0249 750A00          629     labelA:         mov             r10,#0          
024C 750B00          630                             mov             r11,#0
024F 783D            631                             mov             r0,#chkl
0251 120000   F      632                             call    chcmp
0254 7000            633                             jnz             no0key
                     634                             ;разрешить ie6,ie7       
                     635                     ;       mov             EIE2,#30h ;EIE2.5,EIE2.4
                     636                     ;       mov             EIP2,#30h
                     637                        
0256 793D            638     no0key:         mov             r1,#chkl 
0258 120000   F      639                             call    chdec
025B 2004B1          640                             jb              bitizm,rebyte
                     641                              ;буфер 2 выдать на индикацию
                     642     ;3.11.06
                     643     ;                       mov             r0,#vichR
                     644     ;                                               mov             a,@r0
                     645     ;                                               cjne    @r0,#21h,poivich
                     646     ;                                               mov             a,bufind+7
                     647     ;                                               orl             a,#40h
                     648     ;                                               mov             bufind+7,a      
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    11

                     649     ;poivich:
025E 120000   F      650                             call    ind
0261 120000   F      651                             call    z_01s
0264 120000   F      652                             call    z_01s
0267 120000   F      653                             call    z_01s
026A 80DD            654                             jmp             labelA
                     655     
026C C200            656     znplus:         clr     bitznak
026E 547F            657                             anl             a,#7fh;fdh                      ;+
0270 F6              658                             mov             @r0,a
0271 18              659                             dec             r0;,#reacp
0272 7600            660                             mov             @r0,#00h
                     661                             
0274                 662     goznak: 
                     663     ;;;;;;;;;;;;;
0274 787A            664                             mov     r0,#reacp+3
0276 E6              665                             mov             a,@r0
0277 7F05            666                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
0279 C3              667     sdvig3:         clr             c
027A 13              668                             rrc             a
027B DFFC            669                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
027D FA              670                             mov             r2,a    ;сохр байт
027E 18              671                             dec             r0              ;       reacp+2
027F E6              672                             mov             a,@r0
0280 C0E0            673                             push    acc
0282 C3              674                             clr             c
0283 7F03            675                             mov             r7,#3;2
0285 C3              676     sdvig2:         clr             c
0286 33              677                             rlc             a
0287 DFFC            678                             djnz    r7,sdvig2 ;d12..d11      средний байт
0289 4A              679                             orl             a,r2
028A F57A            680                             mov             reacp+3,a;сформ мл байт
028C D0E0            681                             pop             acc
                     682                             
028E 7F05            683                             mov             r7,#5;6
0290 C3              684     sdvig1:         clr             c
0291 13              685                             rrc             a
0292 DFFC            686                             djnz    r7,sdvig1 ;d15,d14        ср байт
0294 FA              687                             mov             r2,a   ;сохр
0295 E578            688                             mov             a,reacp+1
0297 C0E0            689                             push    acc
                     690                     ;;      push    acc
0299 7F03            691                             mov             r7,#3;2
029B C3              692     sdvig0:         clr             c
029C 33              693                             rlc             a
029D DFFC            694                             djnz    r7,sdvig0 ;       d21..d16
029F 4A              695                             orl             a,r2
02A0 F579            696                             mov             reacp+2,a       ; сформ средний  байт
02A2 D0E0            697                             pop             acc       ;reacp+1
                     698                             ;;;;;;;;;;;;;;
02A4 20E70B          699                             jb              acc.7,sdvm
02A7 C3              700                             clr             c
02A8 7F05            701                             mov             r7,#5;6
02AA C3              702     sdvig4:         clr             c
02AB 13              703                             rrc             a
02AC DFFC            704                             djnz    r7,sdvig4 ;       d23,d22
02AE F578            705                             mov             reacp+1,a
02B0 8008            706                             jmp             readyacp;ankor;klmas
                     707     ;;;;;;;;;;;;                                    
02B2 7F05            708     sdvm:           mov             r7,#5;6
02B4 D3              709     sdvig6:         setb            c
02B5 13              710                             rrc             a
02B6 DFFC            711                             djnz    r7,sdvig6 ;       d23,d22
02B8 F578            712                             mov             reacp+1,a
                     713                                                             
                     714     ; reacp..reacp+3-результат чтения асп(hex) 
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    12

                     715     ;;;;;;;;;
02BA                 716     readyacp:
02BA 7898            717                                             mov             r0,#chinkor
02BC E6              718                             mov             a,@r0
02BD 30E702          719                             jnb             acc.7,gopart
02C0 8044            720                                     jmp             sumt2
                     721                     
02C2                 722     gopart:
02C2 789A            723                             mov             r0,#parT        ;параметр времени
02C4 793F            724                             mov             r1,#chmasN
02C6 B6013A          725                             cjne    @r0,#1,noparT1
                     726                             ;РЕЗ+РЕЗ
02C9 7877            727                             mov             r0,#reacp
02CB 120000   F      728                             call    resar2          ;reacp->r2..r5
02CE 78B6            729                             mov             r0,#summa+3;rez_A+3
02D0 120000   F      730                             call    ladd
02D3 78B3            731                             mov             r0,#summa;rez_A
02D5 120000   F      732                             call    saver2
02D8 793F            733                              mov            r1,#chmasN
02DA 7714            734                             mov             @r1,#20;10
02DC 789B            735                             mov             r0,#chbefore
02DE B6631E          736                             cjne    @r0,#99,nobef99
                     737                             ;РЕЗ/100
02E1 900000   F      738                             MOV        DPTR,#ch100 
02E4 120000   F      739     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
02E7 120000   F      740                             call    zdiv;divide
02EA 7862            741                             mov             r0,#rez_A
02EC 120000   F      742                             call    saver2          ;сумма 100 отсчетов /100
02EF 78C5            743                             mov             r0,#Rez_del
02F1 120000   F      744                             call    saver2  
                     745                        ;;;;;
02F4 78B3            746                        mov          r0,#summa
02F6 120000   F      747                        call         clear4
                     748     ;                       mov             a,chmas
                     749     ;                       mov             @r1,a   ;->chmasN
02F9 799B            750                             mov             r1,#chbefore
02FB 7700            751                             mov             @r1,#0
02FD 8048            752                             jmp             klmas           ;загр в массив скользящее ср
02FF 06              753     nobef99:        inc             @r0                     ;chbefore
0300 020000   F      754                             jmp             rebyte;labelA;метка A
                     755     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     756     ;а потом уже располагаем  в скользящий массив  из n
                     757     
                     758     
                     759     
0303 B6021D          760     noparT1:        cjne    @r0,#2,noparT2
                     761                             ;РЕЗ+РЕЗ
0306                 762     sumt2:
0306 7877            763                              mov            r0,#reacp
0308 120000   F      764                             call    resar2          ;reacp->r2..r5
030B 78B6            765                             mov             r0,#summa+3;rez_A+3
030D 120000   F      766                             call    ladd
0310 78B3            767                             mov             r0,#summa;rez_A
0312 120000   F      768                             call    saver2
0315 789B            769                             mov             r0,#chbefore
0317 793F            770                             mov             r1,#chmasN
0319 770A            771                             mov             @r1,#10
031B B613E1          772                             cjne    @r0,#19,nobef99;9,nobef99
                     773                             ;РЕЗ/10
031E 900000   F      774                             MOV        DPTR,#ch20;ch10 
0321 80C1            775                             jmp             allsum
                     776                             ;;;;;;;
                     777                             
                     778     
0323 B60302          779     noparT2:        cjne    @r0,#3,noparT3
0326 8003            780                             jmp             aapar
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    13

                     781     
0328 B60410          782     noparT3:        cjne    @r0,#4,noparT4
032B 7877            783     aapar:          mov             r0,#reacp
032D 120000   F      784                             call    resar2          ;reacp->r2..r5
0330 7862            785                             mov             r0,#rez_A
0332 120000   F      786                             call    saver2
0335 793F            787                              mov            r1,#chmasN
0337 770A            788                             mov             @r1,#10
                     789                     ;       mov             @r1,#10         ;n=10
0339 800C            790                             jmp             klmas
033B 7702            791     noparT4:   mov          @r1,#2          ;chmasN n=2
033D 7877            792                             mov             r0,#reacp
033F 120000   F      793                             call    resar2          ;reacp->r2..r5
0342 7862            794                             mov             r0,#rez_A
0344 120000   F      795                             call    saver2
                     796     ;загрузить А в массив из 2/10 значений
                     797     ;;;;;;;;;;;;;;;
0347                 798     klmas:           
0347 793F            799                             mov             r1,#chmasN
0349 B7021A          800                             cjne    @r1,#2,mas10
034C 900080          801                             MOV        dptr,#MASS0
034F 120000   F      802                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     803     
0352 7862            804                             mov             r0,#rez_A
0354 120000   F      805                             call    resar2          ;->r2..r5
0357 900080          806                             mov                     dptr,#MASS0
035A 120000   F      807                   call              saveIr2                 ; R2-R5 --> MAS0
                     808                     
035D 900087          809                   MOV          dptr,#MASS1+3
0360 120000   F      810                   CALL       addx
0363 020000   F      811                       jmp           endsum
0366 B70A7A          812     mas10:                  cjne    @r1,#10,mas20
0369 9000A0          813                                             mov                     dptr,#MASS8
036C 120000   F      814                     CALL            xCIKLWR         ;MASS8->MASS9
036F 90009C          815                                             mov                     dptr,#MASS7
0372 120000   F      816                     CALL            xCIKLWR         ;MASS7->MASS8
0375 900098          817                     MOV       dptr,#MASS6
0378 120000   F      818                     CALL       xCIKLWR         ; MASS6 --> MASS7
037B 900094          819                     MOV        dptr,#MASS5
                     820                    
037E 120000   F      821                    CALL        xCIKLWR        ; MASS5 --> MASS6
0381 900090          822                    MOV         dptr,#MASS4
                     823                    
0384 120000   F      824                    CALL        xCIKLWR        ; MASS4 --> MASS5
0387 90008C          825                             mov                     dptr,#MASS3
                     826     
038A 120000   F      827                    CALL             xCIKLWR         ;MASS3->MASS4
038D 900088          828                     MOV        dptr,#MASS2
                     829                    
0390 120000   F      830                    CALL        xCIKLWR         ; MASS2 --> MASS3
0393 900084          831                    MOV         dptr,#MASS1
                     832                     
0396 120000   F      833                   CALL         xCIKLWR        ; MASS1 --> MASS2
0399 900080          834                    MOV         dptr,#MASS0
                     835                   
039C 120000   F      836                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     837     
                     838                             
039F 7862            839                             mov             r0,#rez_A
03A1 120000   F      840                             call    resar2          ;->r2..r5
                     841                                     ;call   aform
03A4 900080          842                                     mov                     dptr,#MASS0
03A7 120000   F      843                   call              saveIr2                 ; R2-R5 --> MAS0
                     844              
03AA 900087          845                   MOV          dptr,#MASS1+3
03AD 120000   F      846                   CALL       addx
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    14

03B0 90008B          847                   MOV          dptr,#MASS2+3
03B3 120000   F      848                   CALL       addx
03B6 90008F          849                   MOV          dptr,#MASS3+3
03B9 120000   F      850                  CALL        addx
03BC 900093          851                   MOV       dptr,#MASS4+3
03BF 120000   F      852                   call       addx
03C2 900097          853                     MOV        dptr,#MASS5+3
03C5 120000   F      854                  CALL        addx
03C8 90009B          855                   MOV          dptr,#MASS6+3
03CB 120000   F      856                   CALL       addx
03CE 90009F          857                   MOV          dptr,#MASS7+3
03D1 120000   F      858                  CALL        addx
03D4 9000A3          859                  MOV        dptr,#MASS8+3
03D7 120000   F      860                   call       addx
03DA 9000A7          861                     MOV                     dptr,#MASS9+3
03DD 120000   F      862                  call        addx
03E0 020000   F      863                              jmp            endsum
                     864     
03E3 9000C8          865     mas20:          mov                     dptr,#MASS18
03E6 120000   F      866                     CALL            xCIKLWR         ;MASS18->MASS19
03E9 9000C4          867                                             mov                     dptr,#MASS17
03EC 120000   F      868                     CALL            xCIKLWR         ;MASS17->MASS18
03EF 9000C0          869                     MOV       dptr,#MASS16
03F2 120000   F      870                     CALL       xCIKLWR         ; MASS16 --> MASS17
03F5 9000BC          871                     MOV        dptr,#MASS15
                     872                    
03F8 120000   F      873                    CALL        xCIKLWR        ; MASS15 --> MASS16
03FB 9000B8          874                    MOV         dptr,#MASS14
                     875                    
03FE 120000   F      876                    CALL        xCIKLWR        ; MASS14 --> MASS15
0401 9000B4          877                             mov                     dptr,#MASS13
                     878     
0404 120000   F      879                    CALL             xCIKLWR         ;MASS13->MASS14
0407 9000B0          880                     MOV        dptr,#MASS12
                     881                    
040A 120000   F      882                    CALL        xCIKLWR         ; MASS12 --> MASS13
040D 9000AC          883                    MOV         dptr,#MASS11
                     884                     
0410 120000   F      885                   CALL         xCIKLWR        ; MASS11 --> MASS12
0413 9000A8          886                    MOV         dptr,#MASS10
                     887                   
0416 120000   F      888                    CALL        xCIKLWR        ; MASS10 --> MASS11
0419 9000A4          889                                      MOV       dptr,#MASS9
041C 120000   F      890                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     891     
041F 9000A0          892                                             mov                     dptr,#MASS8
0422 120000   F      893                     CALL            xCIKLWR         ;MASS8->MASS9
0425 90009C          894                                             mov                     dptr,#MASS7
0428 120000   F      895                     CALL            xCIKLWR         ;MASS7->MASS8
042B 900098          896                     MOV       dptr,#MASS6
042E 120000   F      897                     CALL       xCIKLWR         ; MASS6 --> MASS7
0431 900094          898                     MOV        dptr,#MASS5
                     899                    
0434 120000   F      900                    CALL        xCIKLWR        ; MASS5 --> MASS6
0437 900090          901                    MOV         dptr,#MASS4
                     902                    
043A 120000   F      903                    CALL        xCIKLWR        ; MASS4 --> MASS5
043D 90008C          904                             mov                     dptr,#MASS3
                     905     
0440 120000   F      906                    CALL             xCIKLWR         ;MASS3->MASS4
0443 900088          907                     MOV        dptr,#MASS2
                     908                    
0446 120000   F      909                    CALL        xCIKLWR         ; MASS2 --> MASS3
0449 900084          910                    MOV         dptr,#MASS1
                     911                     
044C 120000   F      912                   CALL         xCIKLWR        ; MASS1 --> MASS2
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    15

044F 900080          913                    MOV         dptr,#MASS0
                     914                   
0452 120000   F      915                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     916     
                     917                             
0455 7862            918                             mov             r0,#rez_A
0457 120000   F      919                             call    resar2          ;->r2..r5
                     920                                     ;call   aform
045A 900080          921                                     mov                     dptr,#MASS0
045D 120000   F      922                   call              saveIr2                 ; R2-R5 --> MAS0
                     923              
0460 900087          924                   MOV          dptr,#MASS1+3
0463 120000   F      925                   CALL       addx
0466 90008B          926                   MOV          dptr,#MASS2+3
0469 120000   F      927                   CALL       addx
046C 90008F          928                   MOV          dptr,#MASS3+3
046F 120000   F      929                  CALL        addx
0472 900093          930                   MOV       dptr,#MASS4+3
0475 120000   F      931                   call       addx
0478 900097          932                     MOV        dptr,#MASS5+3
047B 120000   F      933                  CALL        addx
047E 90009B          934                   MOV          dptr,#MASS6+3
0481 120000   F      935                   CALL       addx
0484 90009F          936                   MOV          dptr,#MASS7+3
0487 120000   F      937                  CALL        addx
048A 9000A3          938                  MOV        dptr,#MASS8+3
048D 120000   F      939                   call       addx
0490 9000A7          940                     MOV                     dptr,#MASS9+3
0493 120000   F      941                  call        addx
                     942     ;27
0496 9000AB          943                                     MOV        dptr,#MASS10+3
0499 120000   F      944                   CALL       addx
049C 9000AF          945                                     MOV        dptr,#MASS11+3
049F 120000   F      946                   CALL       addx
04A2 9000B3          947                   MOV          dptr,#MASS12+3
04A5 120000   F      948                   CALL       addx
04A8 9000B7          949                   MOV          dptr,#MASS13+3
04AB 120000   F      950                  CALL        addx
04AE 9000BB          951                   MOV       dptr,#MASS14+3
04B1 120000   F      952                   call       addx
04B4 9000BF          953                                     MOV        dptr,#MASS15+3
04B7 120000   F      954                     CALL     addx
04BA 9000C3          955                   MOV          dptr,#MASS16+3
04BD 120000   F      956                   CALL       addx
04C0 9000C7          957                   MOV          dptr,#MASS17+3
04C3 120000   F      958                  CALL        addx
04C6 9000CB          959                  MOV        dptr,#MASS18+3
04C9 120000   F      960                   call       addx
04CC 9000CF          961                                     MOV                     dptr,#MASS19+3
04CF 120000   F      962                  call        addx
                     963     
                     964     
                     965     
                     966             ;23.03          
04D2                 967     endsum:
04D2 786E            968                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
04D4 06              969                                     inc             @r0
04D5 E6              970                                     mov             a,@r0   
04D6 200105          971                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                     972                                     
04D9 B53F26          973                                     cjne    a,chmasN,masx5
04DC D201            974                                     setb    bitmas                  ;массив заполнен
04DE 853F6E          975     masfull:                mov             chmas,chmasN
04E1 783F            976                                     mov             r0,#chmasN
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    16

04E3 E6              977                                     mov             a,@r0
                     978     ;masfull:
04E4 B40208          979                                     cjne    a,#2,nochn2
04E7 900000   F      980                                     MOV        DPTR,#ch2;10 
04EA 120000   F      981                                     CALL   ldc_ltemp                 ; ltemp <-- 2
04ED 801D            982                                     jmp             mas5div
                     983     
04EF B40A08          984     nochn2:         cjne    a,#10,nochn10
04F2 900000   F      985                                                     MOV        DPTR,#ch10 
04F5 120000   F      986                                     CALL   ldc_ltemp                 ; ltemp <-- 10
04F8 8012            987                                     jmp             mas5div
                     988     
04FA                 989     nochn10:
04FA 900000   F      990                                                     MOV        DPTR,#ch20 
04FD 120000   F      991                                     CALL   ldc_ltemp                 ; ltemp <-- 20
0500 800A            992                                     jmp             mas5div
0502 856E0B          993     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
0505 E4              994                                     clr     a
0506 F50A            995                                     mov     ltemp+2,a
0508 F509            996                                     mov     ltemp+1,a
050A F508            997                                     mov     ltemp,a
                     998     
050C                 999     mas5div:
050C 120000   F     1000                                     CALL       zdiv;divide                           ; R2-R5 =
                    1001                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                    1002     
                    1003                             
                    1004      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1005     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1006     ;получен результат 3 байта и знак
050F 7866           1007                             mov             r0,#rez_A1
0511 120000   F     1008                             call    saver2           ;сохр среднее по массиву
                    1009     ;;8.11.06                       mov             chmasN,#0
                    1010      ;;;;;;;;;;;;
                    1011      ;;;;;;;;;;;;
0514 C3             1012                             clr             c
0515 799A           1013                             mov             r1,#parT
0517 7402           1014                             mov             a,#2
0519 97             1015                             subb    a,@r1
051A 501D           1016                             jnc             ankor           ;T<3
                    1017                             ;A-=РЕЗ1                                ;T>3
051C 120402         1018                             call    altof                   ;r2..r5->float
051F 785E           1019                             mov             r0,#rez_Ame
0521 120000   F     1020                             call    saver2
                    1021                             ;;;;
0524 7890           1022                             mov             r0,#koefKp;->r8..r11
0526 EA             1023                             mov             a,r2
0527 30E702         1024                             jnb             acc.7,nminus3
052A 7894           1025                             mov             r0,#koefKm;->r8..r11
052C 120000   F     1026     nminus3:                call    resar8
052F 120203         1027                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
0532 785E           1028                             mov             r0,#rez_Ame
0534 120000   F     1029                             call    saver2
0537 8022           1030                             jmp             gotoKD
                    1031     
0539                1032     ankor:  
0539 7898           1033                             mov             r0,#chinkor
053B E6             1034                             mov             a,@r0
053C 30E703         1035                             jnb             acc.7,nokorr
                    1036                             ;коррекция 0
053F 020000   F     1037                             jmp             kornul
0542                1038     nokorr: 
                    1039                             ;mov            r10,#00         ;       chavt
                    1040                             ;mov            r11,#00h
0542 7881           1041                             mov              r0,#chavt      
0544 E6             1042                             mov                     a,@r0;call      chcmp           ;сравн счет
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    17

                             чик авто калибровки с 0h
0545 30E750         1043                             jnb             acc.7,nonulavt;jnz              nonulavt        
0548 750A00         1044                             mov             r10,#0;1;00;02          
054B 750BC8         1045                             mov             r11,#0c8h;90h;0c8h;58h
054E 7898           1046                             mov             r0,#chinkor
0550 120000   F     1047                             call    chcmp
0553 705B           1048                             jnz             noavk
                    1049                             ;автокалибровка
0555 020000   F     1050                             jmp             autoka;noavk;
                    1051     
0558 020000   F     1052     rafterK:                jmp             afterK
                    1053     ;;;;;;;;;;
055B C3             1054      gotoKD:                clr             c
055C 799A           1055                             mov             r1,#parT
055E 7404           1056                             mov             a,#4
0560 97             1057                             subb    a,@r1
0561 50F5           1058                             jnc             rafterK         ;T<5
                    1059                             ;A1-=A- *KD                     ;T>5
0563 120000   F     1060                             call            findkoef                                ;r2,r3-hex
0566 12046C         1061                                     call            rebyte2                         ;r2..r5- he
                             x
                    1062                                     
0569 120402         1063                                     call    altof                   ;r2..r5->float
056C 900000   F     1064                                     mov     dptr,#CHtho;100000
056F 120000   F     1065                                     call    ldc_ltemp                       ;r8..r11
0572 1202B7         1066                                     call    fldiv
0575 120000   F     1067                                     call    move28
                    1068                             
0578 785E           1069                             mov             r0,#rez_Ame;->r2..r5   ???????????/
057A 120000   F     1070                             call    resar2
057D 120203         1071                                     call    flmul
0580 120343         1072                             call    ftol                    ;float->int
0583 7866           1073                             mov             r0,#rez_A1
0585 120000   F     1074                             call    saver2
0588 786A           1075                             mov             r0,#rez_A0;->r8..r11 hex
058A 120000   F     1076                             call    resar8
058D 120000   F     1077                             call    lsub            ;A3=A-1-A0
0590 789C           1078                             mov             r0,#rez_A3
0592 120000   F     1079                             call    saver2
0595 020000   F     1080                             jmp             labelB  
                    1081      ;;;;;;;;;;; 9.11.06
0598 789A           1082     nonulavt:        mov            r0,#parT
059A E6             1083                             mov             a,@r0
059B 6401           1084                             xrl             a,#01
059D 700C           1085                             jnz             avtdec1
059F 7982           1086                             mov             r1,#chavt+1     ;T=1 chavt-10
05A1 120000   F     1087                             call    tenmin
05A4 7999           1088     kordec10:       mov             r1,#chinkor+1
05A6 120000   F     1089                             call    tenmin
05A9 8018           1090                             jmp             rezmul
                    1091     
05AB 7981           1092     avtdec1:        mov             r1,#chavt       
05AD 120000   F     1093                             call    chdec           ;chavt-1
                    1094     ;                       jmp             kordec1;rezmul
05B0 789A           1095     noavk:          mov             r0,#parT
05B2 E6             1096                             mov             a,@r0
05B3 6401           1097                             xrl             a,#01
05B5 7007           1098                             jnz             kordec1
                    1099                             ;T=1 chinkor-10
05B7 7999           1100                     mov             r1,#chinkor+1
05B9 120000   F     1101                             call    tenmin
05BC 8005           1102                             jmp             rezmul
05BE 7998           1103     kordec1:        mov             r1,#chinkor
05C0 120000   F     1104                             call    chdec           ; chinkor-1
                    1105                        ;9.11.06
                    1106                             ;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    18

                    1107                             ;;;;;;;;;;;;;
                    1108     ;(РЕЗ1-АN)*K
05C3                1109     rezmul:
05C3 7866           1110                             mov             r0,#rez_A1;->r2..r5
05C5 120000   F     1111                             call    resar2
05C8 120402         1112                             call    altof   ;r2..r5->float  6.06    
05CB 7884           1113                             mov             r0,#kor0_AN;->r8..r11
05CD 120000   F     1114                             call    resar8
                    1115                             ;;call  altof   ;r2..r5->float
05D0 1201D1         1116                             call    flsub
05D3 7890           1117                             mov             r0,#koefKp;->r8..r11
05D5 EA             1118                             mov             a,r2
05D6 30E702         1119                             jnb             acc.7,nminus
                    1120                             ;jnb            bitznak,nminus
                    1121                     
05D9 7894           1122                             mov             r0,#koefKm;->r8..r11
05DB 120000   F     1123     nminus:         call    resar8
05DE 120203         1124                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
                    1125                     
                    1126                     ;;;;;;;;        call    ftol                    ;float->int
05E1 785E           1127                             mov             r0,#rez_Ame
05E3 120000   F     1128                             call    saver2
                    1129      ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1130      ;;;;;;;;;;;;;;;;;;;;;;;;;;
05E6                1131     afterK:                 
                    1132     ;;;;;;;;;;;;;;
                    1133                             ;;;;;;  call    altof                   ;r2..r5->float
05E6 EA             1134                                     mov             a,r2
05E7 547F           1135                                     anl             a,#7fh
05E9 FA             1136                                     mov             r2,a
05EA 900000   F     1137                                     mov     dptr,#ch_250;220;220000
05ED 120000   F     1138                                     call    ldc_ltemp                       ;r8..r11=8
05F0 1201D6         1139                                     call    flcmp
05F3 505B           1140                                     jnc             rmo220          ;A>220000
05F5 120000   F     1141                                     call            findkoef                                ;r2
                             ,r3-hex
05F8 12046C         1142                                     call            rebyte2                         ;r2..r5- he
                             x
                    1143                                     
05FB 120402         1144                                     call    altof                   ;r2..r5->float
05FE 900000   F     1145                                     mov     dptr,#CHtho;100000
0601 120000   F     1146                                     call    ldc_ltemp                       ;r8..r11=8
0604 1202B7         1147                                     call    fldiv
0607 120000   F     1148                                     call    move28
060A 785E           1149                                     mov             r0,#rez_Ame
060C 120000   F     1150                                     call    resar2
                    1151                     
060F 120203         1152                                     call    flmul     ;A1-=A-*KD  fl
                    1153                                     
0612 120343         1154                                     call    ftol                    ;float->int
0615 7866           1155                                     mov             r0,#rez_A1
0617 120000   F     1156                                     call    saver2
061A 120402         1157                                     call    altof                   ;r2..r5->float
061D 900000   F     1158                                     mov     dptr,#ch_220;200;200000
0620 120000   F     1159                                     call    ldc_ltemp                       ;r8..r11=8
0623 1201D6         1160                                     call    flcmp
0626 5028           1161                                     jnc             rmo220          ;A>200000
0628 301806         1162                                     jnb             knizm,goA2;             bitizm,goA2     
062B 200528         1163                                     jb              bitavp,yesavp   
062E 200652         1164     noavp:                  jb              bitvi11,yesvich  ;уст после ввода A B (ввод ВЫЧИСЛИ
                             ТЬ)
0631                1165     goA2:                    ;A2=A1-
0631 7866           1166                                      mov            r0,#rez_A1
0633 120000   F     1167                                     call    resar2
0636 787B           1168                                     mov             r0,#rez_A2
0638 120000   F     1169                                     call    saver2
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    19

063B                1170     goA3A2:                  ;A3=A2-A0
063B 786A           1171                                       mov           r0,#rez_A0
063D 120000   F     1172                                     call    resar8
0640 120000   F     1173                                     call    lsub
0643 789C           1174                                     mov             r0,#rez_A3
0645 120000   F     1175                                     call    saver2
                    1176                                     ;;;;;;
0648                1177     goonin:            ;jmp         goonind;indA3;8.11.06
0648 78AC           1178                                     mov             r0,#chind
064A B60006         1179                                     cjne    @r0,#0,rnochi0
064D 020000   F     1180                                     jmp             goonind;indA3
                    1181     ;                               clr             P3.4
                    1182     ;                               nop
                    1183     ;                               nop
                    1184     ;                               setb    P3.4      ;??????????????????????/
                    1185     ;                               jmp             nop3_0
                    1186     
                    1187     ;                               jb              P3.0,nop3_0     ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1188     ;                               mov             r0,#rez_A0              ;r2..r5->rez_A0
                    1189     ;                               call    saver2                  ;ЗАПОМНИТЬ СМЕЩЕНИЕ НУЛЯ
                    1190     ;                               jmp             rebyte          ;age2
0650 020000   F     1191      rmo220:                jmp             mo220
0653 020000   F     1192      rnochi0:               jmp             nochi0
                    1193     
                    1194     ;;;;;;;;;;;;;;;;
0656 EA             1195     yesavp:                 mov             a,r2
0657 547F           1196                                     anl             a,#7fh
0659 FA             1197                                     mov             r2,a
065A 900000   F     1198                                     mov     dptr,#ch_10th;10000
065D 120000   F     1199                                     call    ldc_ltemp                       ;r8..r11=8
0660 1201D6         1200                                     call    flcmp
0663 50C9           1201                                     jnc             noavp           ;A>10000        
0665 78AE           1202                                     mov             r0,#diap                ;10-11
0667 B60902         1203                                     cjne    @r0,#9,avpgo
066A 80C2           1204                                     jmp             noavp
066C                1205     avpgo:                  
066C 06             1206                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
066D B60A01         1207                                     cjne    @r0,#0ah,clmasv
0670 16             1208                                     dec             @r0
0671                1209     clmasv:         ;сбросить массив
0671 120000   F     1210                             call    loadUS
                    1211                             ;call   louizm
0674 120000   F     1212                             call     clmassix
0677 78B3           1213                                     mov             r0,#summa
0679 120000   F     1214                                     call    clear4
067C 786A           1215                                     mov             r0,#rez_A0
067E 120000   F     1216                                     call    clear4                                             
                                                   
0681 80C5           1217                                jmp     goonin
                    1218     
0683                1219     yesvich:        ;A2=E/A1-+F
0683 78C0           1220                                             mov             r0,#konstB
0685 120000   F     1221                                     call    resar2
0688 120000   F     1222                                     call    move28
068B 7866           1223                                     mov             r0,#rez_A1
068D 120000   F     1224                                     call    resar2                          ;HEX
                    1225                                     
0690 120402         1226                                     call            altof                   ;r2..r5->float
0693 EA             1227                                     mov             a,r2                    ;модуль
0694 547F           1228                                     anl             a,#7fh
0696 FA             1229                                     mov             r2,a
0697 120166         1230                                     call            fladd                           ;A1+B
                    1231                                     
069A 900000   F     1232                                     mov     dptr,#CH_500;
069D 120000   F     1233                                     call    ldc_ltemp                       ;r8..r11
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    20

06A0 1201D6         1234                                     call    flcmp
06A3 4073           1235                                     jc                      mo500R;error <500 >22000
06A5 900000   F     1236                                     mov     dptr,#CH_22T;
06A8 120000   F     1237                                     call    ldc_ltemp                       ;r8..r11
06AB 1201D6         1238                                     call    flcmp
06AE 5074           1239                                     jnc             mo500I          ;error
                    1240                                     ;;;;;;;;;;;;
06B0 120000   F     1241                                     call            move28
06B3 C008           1242                                     push            r8
06B5 C009           1243                                     push            r9
06B7 C00A           1244                                     push            r10
06B9 C00B           1245                                     push            r11
06BB 78BC           1246                                     mov             r0,#konstA
06BD 120000   F     1247                                     call    resar2
06C0 900000   F     1248                                     mov             dptr,#CH_B
06C3 120000   F     1249                                     CALL   ldc_ltemp                 ; ltemp <-- 10-7
06C6 120203         1250                                     call            flmul                           ;A*10-7
06C9 D00B           1251                                     pop                     r11
06CB D00A           1252                                     pop                     r10
06CD D009           1253                                     pop                     r9
06CF D008           1254                                     pop                     r8
06D1 1202B7         1255                                     call            fldiv                   ;результат R
06D4 78C9           1256                                     mov                     r0,#rez_R
06D6 120000   F     1257                                     call            saver2
06D9 120343         1258                                     call            ftol                    ;float->hex
                    1259                                     ;;;;;;;;;;
06DC 784F           1260                                             mov             r0,#abin
06DE 120000   F     1261                                             call    saver2
                    1262     ;;;;;;;;
06E1 7840           1263                                                     mov             r0,#bufind
06E3                1264     age9:
06E3 7620           1265                             mov             @r0,#" "          ;погасить индикатор
06E5 08             1266                             inc             r0
06E6 B84BFA         1267                             cjne    r0,#bufind+11,age9
                    1268                                             
06E9 78C9           1269                                             mov             r0,#rez_R
06EB 120000   F     1270                                             call            resar2
                    1271     ;;;;;;;;;;
06EE 900000   F     1272                                     mov             dptr,#CH_fl
06F1 120000   F     1273                                     CALL   ldc_ltemp
06F4 1202B7         1274                                     call            fldiv
                    1275     
06F7 78B8           1276                                     mov             r0,#work                ;степень +
06F9 7600           1277                                     mov             @r0,#0
06FB 78B9           1278                                     mov             r0,#work+1;степень -
06FD 7600           1279                                     mov             @r0,#0
06FF 900000   F     1280     compa1: mov     dptr,#ch_1;
0702 120000   F     1281                                     call    ldc_ltemp                       ;r8..r11
0705 1201D6         1282                                     call    flcmp
0708 4026           1283                                     jc              equ0            ;<1
070A 78B8           1284                                     mov             r0,#work                        ;степень +
070C 06             1285                                     inc             @r0
070D 900000   F     1286                                     mov             dptr,#ch_10;
0710 120000   F     1287                                     call    ldc_ltemp                       ;r8..r11
0713 1202B7         1288                                     call            fldiv
0716 80E7           1289                                     jmp             compa1                          ;work значе
                             ние степени n(hex)  
                    1290                                     ;;;;;;;;;;;;;;;;;;;
0718 900000   F     1291     mo500R: mov             dptr,#teOLR
071B 120000   F     1292                               call          lotext           ;ПРОСМОТР
071E 120000   F     1293                                     call            ind
0721 020000   F     1294                                     jmp                     nobitizm
0724 900000   F     1295     mo500I: mov             dptr,#teOLI
0727 120000   F     1296                               call          lotext           ;ПРОСМОТР
072A 120000   F     1297                                     call            ind
072D 020000   F     1298                                     jmp                     nobitizm
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    21

0730                1299     equ0:           ;;;;;   call            ftol                    ;float->int
0730 78B8           1300                                     mov             r0,#work                ;степень +
0732 B60019         1301                                     cjne    @r0,#0,equ00
                    1302                                     
0735 900000   F     1303     compa2: mov     dptr,#ch_1;
0738 120000   F     1304                                     call    ldc_ltemp                       ;r8..r11
073B 1201D6         1305                                     call    flcmp
073E 500E           1306                                     jnc             equ00           ;>1
0740 78B9           1307                                     mov             r0,#work+1                      ;степень -
0742 16             1308                                     dec             @r0                                        
                                          ;0,ff(-1),fe(-2)...
0743 900000   F     1309                                     mov             dptr,#ch_10;
0746 120000   F     1310                                     call    ldc_ltemp                       ;r8..r11
0749 120203         1311                                     call            flmul
074C 80E7           1312                                     jmp             compa2                          ;work значе
                             ние степени n(hex)  
                    1313     
                    1314     
074E                1315     equ00:          
074E 7853           1316                                                     mov             r0,#adec
0750 7952           1317                                             mov             r1,#abin+3      ;hex->10
0752 120000   F     1318                                             call    bindec
                    1319     
                    1320                                                     ;если степень полож убирать младший байт
                    1321                                                     ;чтобы уложиться в 5 разрядов, если отриц р
                             асполагать
                    1322                                                     ;число в bufind..bufind+5
0755 78B8           1323                                             mov             r0,#work
0757 B60021         1324                                             cjne    @r0,#0,outr
075A 08             1325                                             inc             r0                      ;work+1
075B B6FF05         1326                                             cjne            @r0,#0ffh,bufr3         ;6разрядов 
                             нужно вывести 5
075E 06             1327                                             inc                     @r0;!!!!!!!!!?
075F 785B           1328                                             mov                     r0,#adec+8;разместить в буф
                             ер индикации R
0761 8003           1329                                             jmp                     bufr30
                    1330                                             ;;;;;;;;;;;;;;
0763 06             1331     bufr3:          inc             @r0                     ;?!!!!!!!!n+1
0764 785C           1332                                                     mov             r0,#adec+9
0766 7945           1333     bufr30:         mov             r1,#bufind+5;6
0768 7F05           1334                                             mov             r7,#5;7
076A E6             1335     bufr2:                          mov             a,@r0
076B 2430           1336                                             add             a,#30h
076D F7             1337                                             mov             @r1,a
076E 19             1338                                             dec             r1
076F 18             1339                                             dec             r0
0770 DFF8           1340                                             djnz    r7,bufr2
                    1341     
0772 784F           1342                                             mov             r0,#abin
0774 120000   F     1343                                             call            clear4
0777 78B9           1344                                             mov             r0,#work+1
0779 801C           1345                                     jmp             outr5
                    1346     ;work!=0 значит после дел на 10**9 получили число > с чем 6 разрядов                       
                                          
077B 785C           1347     outr:                   mov             r0,#adec+9;разместить в буфер индикации R
077D C3             1348                                             clr             c
077E 79B8           1349                                             mov             r1,#work
0780 E8             1350                                             mov             a,r0
0781 14             1351                                             dec             a                                  
                                  ;n-1
0782 97             1352                                             subb    a,@r1
0783 F8             1353                                             mov             r0,a                    ;adec+9-n !
                             !!!!!!!!!!!!!!
0784 7945           1354                                     mov             r1,#bufind+5;т к число разрядов > чем знако
                             мест
0786 7F05           1355                                             mov             r7,#5;7
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    22

0788 E6             1356     bufr:                           mov             a,@r0
0789 2430           1357                                             add             a,#30h
078B F7             1358                                             mov             @r1,a
078C 19             1359                                             dec             r1
078D 18             1360                                             dec             r0
078E DFF8           1361                                             djnz    r7,bufr
                    1362     
0790 784F           1363                                             mov             r0,#abin
0792 120000   F     1364                                             call            clear4
0795 78B8           1365                                     mov             r0,#work
0797 E6             1366     outr5:                  mov             a,@r0
0798 F552           1367                                             mov             abin+3,a
                    1368                                                                     ;n(hex)->abin
079A 120000   F     1369                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
079D 2552           1370                                             add             a,abin+3
079F F552           1371                                             mov             abin+3,a
07A1 7853           1372                                             mov             r0,#adec
07A3 7952           1373                                             mov             r1,#abin+3      ;hex->10
07A5 120000   F     1374                                             call    bindec
07A8 855C48         1375                                             mov             bufind+8,adec+9
07AB 855B47         1376                                             mov             bufind+7,adec+8
07AE 754966         1377                                             mov             bufind+9,#66h
07B1 020000   F     1378                                             jmp             nobitizm;       goonin;call     ind
                    1379                                             
                    1380                                     ;;;;;;;;;;;;;;;;;;;;;
                    1381     ;;;;;;;;;;;;;
                    1382     
07B4 300508         1383     mo220:             jnb          bitavp,indoll
07B7 301805         1384                                jnb          knizm,indoll;bitizm,indoll
07BA 78AE           1385                                     mov             r0,#diap
07BC B6000B         1386                                     cjne    @r0,#0,nodi2
                    1387                                ;10-2
07BF 900000   F     1388     indoll:                 mov             dptr,#teOLL;OLL
07C2 120000   F     1389                                     call    lotext
07C5 D217           1390                                     setb    bitoll
07C7 020000   F     1391                                     jmp             goonin  
                    1392     
07CA 16             1393     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1394     
07CB B6FF01         1395                                     cjne    @r0,#0ffh,nodi9
07CE 06             1396                                     inc             @r0
                    1397     
07CF 120000   F     1398     nodi9:          call    loadUS
                    1399                                     ;call   louizm
                    1400                                     ;сбросить массив
07D2 120000   F     1401                                     call     clmassix
07D5 78B3           1402                                     mov             r0,#summa
07D7 120000   F     1403                                     call    clear4
07DA 786A           1404                                     mov             r0,#rez_A0
07DC 120000   F     1405                                     call    clear4  
07DF D207           1406                                     setb    bitzus  ;флаг задержки  после установки us         
                                                                   
07E1 020000   F     1407                                jmp     goonin
                    1408     
07E4 16             1409     nochi0:                 dec             @r0                     ;СТИ-1
07E5 020000   F     1410                                     jmp             labelB  
                    1411     
                    1412             
                    1413     ;;;;;;;;;;;;;;;
                    1414     
07E8                1415     nop3_0: ;;      ;rez_A-rez_A0
                    1416                     ;;                      mov             r0,#rez_A0
                    1417                     ;;                      call    resar8
                    1418                     ;;                      call    lsub
                    1419                     ;;                      mov             r0,#rez_A
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    23

                    1420                     ;;;                     call    saver2
                    1421      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
07E8 789C           1422      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
07EA 120000   F     1423                                             call    resar2
07ED 900000   F     1424                                             mov             dptr,#ch100              
07F0 120000   F     1425                                             call    ldc_ltemp        
07F3 120000   F     1426                                             call    zdiv            ;rez_A3/100=r2..r5
                    1427                                     
07F6 EC             1428                                             mov             a,r4
07F7 20E71F         1429                                             jb              acc.7,aless0
07FA 4408           1430                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
07FC F5D3           1431                                             mov             DAC0H,a
                    1432                                                                             ;мл байт
07FE ED             1433                                             mov             a,r5
07FF F5D2           1434                                             mov             DAC0L,a
0801 801F           1435                                             jmp             moveA3;
                    1436     
0803 B70207         1437     no3parN:                        cjne    @r1,#2,no2parN
                    1438                                             ;в байт 0  записать пробел
0806 7946           1439                                             mov             r1,#bufind+6
0808 7720           1440                                             mov             @r1,#" ";0fdh;
080A 020000   F     1441                                             jmp             seeind;moveA3
                    1442     
080D                1443     no2parN:                        ;в байты 0 и 1 записать пробел
080D 7945           1444                                             mov             r1,#bufind+5
080F 7720           1445                                             mov             @r1,#" ";0fdh;" "
0811 09             1446                                             inc             r1
0812 7720           1447                                             mov             @r1,#" ";0fdh;" "
0814 020000   F     1448                                             jmp             seeind;moveA3
0817 807D           1449      rseeind:               jmp             seeind
0819 F4             1450     aless0:                         cpl             a
081A 54F7           1451                                             anl             a,#0f7h         ;d11=0
081C F5D3           1452                                             mov             DAC0H,a
                    1453                                                                             ;мл байт
081E ED             1454                                             mov             a,r5
081F F4             1455                                             cpl             a
0820 F5D2           1456                                             mov             DAC0L,a
0822                1457     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1458                                     
                    1459                                             
0822                1460     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1461                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1462                     ;до конца цикла измерения результат не размещать в буфере
                    1463                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1464                     ;и возврату в режим измерения
0822 20145B         1465                                             jb              bitvich,rnorvich
0825 201058         1466                                             jb              bitt2,rnorvich
0828 2017EC         1467                                             jb              bitoll,rseeind
082B 2011E9         1468                                             jb              bitmenu,rseeind
                    1469             
                    1470     ;;;;;;;;;;;;;;
082E 789C           1471                                              mov            r0,#rez_A3
0830 120000   F     1472                                             call    resar2
0833 120343         1473                                             call    ftol                    ;float->int r2..r5
                    1474     ;;;;;;;;
0836 789C           1475                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
0838 120000   F     1476                                             call    resar2
                    1477                                     
083B 120000   F     1478                                             call    maform
083E 784F           1479                                             mov             r0,#abin
0840 120000   F     1480                                             call    saver2
                    1481     ;;;;;;;;
                    1482                                             
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    24

0843 7853           1483                                             mov             r0,#adec
0845 7952           1484                                             mov             r1,#abin+3      ;hex->10
0847 120000   F     1485                                             call    bindec
                    1486                                     
084A 785C           1487                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
084C 7946           1488                                             mov             r1,#bufind+6
084E 7F07           1489                                             mov             r7,#7
0850 E6             1490     bufdec:                         mov             a,@r0
0851 2430           1491                                             add             a,#30h
0853 F7             1492                                             mov             @r1,a
0854 19             1493                                             dec             r1
0855 18             1494                                             dec             r0
0856 DFF8           1495                                             djnz    r7,bufdec
0858 7847           1496                                             mov             r0,#bufind+7
085A 762D           1497                                             mov             @r0,#2dh          ;-2..-9
085C 7840           1498                                             mov             r0,#bufind
085E 762B           1499                                             mov             @r0,#2bh
0860 300202         1500                                             jnb             znmat,nozzmi;bitznak,nozzmi
0863 762D           1501                                             mov             @r0,#2dh
0865 79AE           1502     nozzmi:                         mov             r1,#diap
0867 7848           1503                                             mov             r0,#bufind+8
0869 E7             1504                                             mov             a,@r1
086A B40808         1505                                             cjne    a,#8,nodi8
086D 7630           1506                                             mov             @r0,#30h                 ;10-10
086F 18             1507                                             dec             r0
0870 7663           1508                                             mov             @r0,#63h;31h
0872 08             1509                                             inc             r0
0873 8013           1510                                             jmp             seegoon
0875 B4090D         1511     nodi8:                          cjne    a,#9,nodis9
                    1512                                     
0878 7631           1513                                             mov             @r0,#31h           ;10-11
087A 18             1514                                             dec             r0
087B 7663           1515                                             mov             @r0,#63h;31h
                    1516                                     
087D 08             1517                                             inc             r0
087E 8008           1518                                             jmp             seegoon
                    1519     
0880 8052           1520     rnorvich:               jmp             norvich
0882 020000   F     1521     rno3parN:               jmp             no3parN
                    1522     
0885 2432           1523     nodis9:                         add             a,#32h
0887 F6             1524                                             mov             @r0,a;#37h;"T";
0888 08             1525     seegoon:                        inc             r0
0889 7641           1526                                             mov             @r0,#"A";"E";
088B 08             1527                                             inc             r0
088C 7600           1528                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
088E 08             1529                                             inc             r0;             mov             buf
                             ind+11
088F 76D0           1530                                             mov             @r0,#0d0h               ;bufind+11.
                             4 точка после первой цифры
                    1531                                             
                    1532     ;;;;;;;;;;;;;;;
                    1533     ;;;;;;goonind:
0891 79AF           1534                                             mov             r1,#parN        ; ??????
0893 B703EC         1535                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1536                                     
                    1537             
0896                1538     seeind:                         ;;;;;;;;;;;;;
0896 784A           1539                                             mov             r0,#bufind+10
0898 E6             1540                                             mov             a,@r0
0899 300F03         1541                                             jnb             bitnul,nnnul
089C 4408           1542                                             orl             a,#08h
089E F6             1543                                             mov             @r0,a
089F 799A           1544      nnnul:                         mov             r1,#parT
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    25

08A1 B70304         1545                                             cjne    @r1,#3,nsec01
08A4 4410           1546                                             orl             a,#10h
08A6 800C           1547                                             jmp             nsec10   ;0,1s
08A8 B70204         1548      nsec01:                        cjne    @r1,#2,nsec1
08AB 4420           1549                                             orl             a,#20h    ;1s
08AD 8005           1550                                             jmp             nsec10
08AF B70102         1551     nsec1:                          cjne    @r1,#1,nsec10
08B2 4440           1552                                             orl             a,#40h
                    1553     
                    1554     ;;;;;;;;;;;;;;;;
08B4 F6             1555     nsec10:                         mov             @r0,a
08B5 300504         1556                                             jnb             bitavp,nobavp
08B8 4404           1557                                             orl             a,#04           ;bufind+10.2
08BA F6             1558                                             mov             @r0,a
08BB F6             1559                                             mov             @r0,a   
08BC 301803         1560     nobavp:                    jnb          knizm,nobitizm
08BF 4402           1561                                             orl             a,#02
08C1 F6             1562                                              mov            @r0,a
08C2                1563     nobitizm:                       
08C2 301A07         1564                                             jnb             bitakt,notakt
08C5 C21A           1565                                             clr             bitakt
08C7 534AFE         1566                                             anl             bufind+10,#0feh
08CA 8005           1567                                             jmp             taktind
08CC D21A           1568     notakt:                         setb    bitakt
08CE 434A01         1569                                             orl             bufind+10,#01                      
                                          
08D1                1570     taktind:                
                    1571     
08D1 120000   F     1572                                             call    ind        ;пп выдачи на индикатор
08D4                1573     norvich: 
08D4 789A           1574                                     mov             r0,# parT
08D6 79AC           1575                                             mov             r1,#chind
08D8 B60177         1576                                             cjne    @r0,#1,rnot1in
08DB                1577     labelB:                    ;;;;;;;;;;;
                    1578                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
08DB 789F           1579                                                     mov     r0,#rez_A3+3
                    1580                             ;;;;;;;;
08DD 79BB           1581                             mov             r1,#work+3
08DF E6             1582                             mov             a,@r0
08E0 7F07           1583                             mov             r7,#7;кол сдв вправо
08E2 C3             1584     dvig3:          clr             c
08E3 13             1585                             rrc             a
08E4 DFFC           1586                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
08E6 FA             1587                             mov             r2,a    ;сохр байт
08E7 18             1588                             dec             r0              ;rez_A3+2
08E8 E6             1589                             mov             a,@r0
08E9 C0E0           1590                             push    acc
08EB C3             1591                             clr             c
08EC 7F01           1592                             mov             r7,#1
08EE C3             1593     dvig2:          clr             c
08EF 33             1594                             rlc             a
08F0 DFFC           1595                             djnz    r7,dvig2 ;d12..d11       средний байт
08F2 4A             1596                             orl             a,r2
08F3 F7             1597                             mov             @r1,a;сформ мл байт
08F4 19             1598                             dec             r1
08F5 D0E0           1599                             pop             acc
                    1600                             
08F7 7F07           1601                             mov             r7,#7
08F9 C3             1602     dvig1:          clr             c
08FA 13             1603                             rrc             a
08FB DFFC           1604                             djnz    r7,dvig1 ;d18     ср байт
08FD FA             1605                             mov             r2,a   ;сохр
08FE 18             1606                             dec             r0
08FF E6             1607                             mov             a,@r0 ;rez_A3+1
0900 C0E0           1608                             push    acc
                    1609                     
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    26

0902 7F01           1610                             mov             r7,#1
0904 C3             1611     dvig0:          clr             c
0905 33             1612                             rlc             a
0906 DFFC           1613                             djnz    r7,dvig0 ;        d21..d16
0908 4A             1614                             orl             a,r2
0909 F7             1615                             mov             @r1,a   ; сформ средний  байт
090A 19             1616                             dec             r1
090B D0E0           1617                             pop             acc       ;rez_A3+1
                    1618                             ;;;;;;;;;;;;;;
                    1619     ;                       jb              acc.7,dvm
090D C3             1620                             clr             c
090E 7F07           1621                             mov             r7,#7
0910 C3             1622     dvig4:          clr             c
0911 13             1623                             rrc             a
0912 DFFC           1624                             djnz    r7,dvig4 ;        d22
0914 FA             1625                             mov             r2,a   ;сохр
0915 18             1626                             dec             r0;     rez_A3
0916 E6             1627                             mov             a,@r0
                    1628                             ;;;;;
0917 7F01           1629                             mov             r7,#1
0919 C3             1630     vig0:           clr             c
091A 33             1631                             rlc             a
091B DFFC           1632                             djnz    r7,vig0 ;         d24..d30
091D 4A             1633                             orl             a,r2
091E F7             1634                             mov             @r1,a   ; сформ   байт
091F 19             1635                             dec             r1
0920 E6             1636                             mov             a,@r0
                    1637                             ;;;;;
0921 20E709         1638                             jb              acc.7,dvm
0924 C3             1639                             clr             c
0925 7F07           1640                             mov             r7,#7
0927 C3             1641     vig4:           clr             c
0928 13             1642                             rrc             a
0929 DFFC           1643                             djnz    r7,vig4 ;         d
092B 8006           1644                             jmp             endsdv
                    1645     ;;;;;;;;;;;;                                    
092D 7F07           1646     dvm:            mov             r7,#7
092F D3             1647     dvig6:          setb            c
0930 13             1648                             rrc             a
0931 DFFC           1649                             djnz    r7,dvig6 ;        d31
0933 F7             1650     endsdv:         mov             @r1,a
                    1651                                                             
                    1652      ;->work   
                    1653                             
0934 900000   F     1654                             mov             dptr,#chzap
0937 120000   F     1655                             call     ldc_long
093A 78BB           1656                              mov            r0,#work+3
093C 120000   F     1657                             call    ladd
093F ED             1658                             mov             a,r5
0940 F5D5           1659                             mov             DAC1L,a
                    1660                             
0942 EC             1661                             mov             a,r4
0943 F5D6           1662                             mov             DAC1H,a
                    1663     
                    1664                                             ;;;;;;;;;;
0945 78AD           1665                                             mov             r0,#chbuf         ;T=1
0947 B6002F         1666                                             cjne    @r0,#0,nobuf0
094A 200907         1667                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
094D 200A06         1668                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0950 801A           1669                                             jmp             gocikle
0952 8028           1670     rnot1in:                jmp             not1in
0954                1671     yesprd: ;передать   A3 в буфер
0954 8000           1672                                             jmp             goonT
0956                1673     yesbuf: ;записать   A3 в буфер
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    27

0956 789A           1674     goonT:                          mov             r0,#parT
0958 79AD           1675                                             mov             r1,#chbuf
095A B60102         1676                                             cjne    @r0,#1,nott1
                    1677                                     ;       mov             @r1,#
095D 800D           1678                                             jmp             gocikle
                    1679     
095F B60502         1680     nott1:                          cjne    @r0,#5,nott5
                    1681     
0962 8008           1682                                             jmp             gocikle
                    1683     
0964 C3             1684     nott5:           clr            c
0965 799A           1685                             mov             r1,#parT
0967 7404           1686                             mov             a,#4
0969 97             1687                             subb    a,@r1
096A 500B           1688                             jnc             yestt5          ;T<5
096C 300805         1689     gocikle:        jnb             bitbuf,nofz                                     
096F 120000   F     1690                             call    z_01s    ;0,5c
0972 C208           1691                             clr     bitbuf
0974 020000   F     1692     nofz:           jmp     labelA;rebyte
                    1693     
                    1694     
0977 80F3           1695     yestt5:         jmp             gocikle
                    1696     
0979 16             1697     nobuf0:                         dec             @r0
097A 80F0           1698                                             jmp             gocikle
                    1699     
                    1700     
097C B60205         1701     not1in:                         cjne    @r0,#2,not2in
097F 7701           1702                                             mov             @r1,#1           ;T=2
0981 020000   F     1703                                             jmp     labelB
                    1704     
0984 B60305         1705     not2in:                         cjne    @r0,#3,not3in
0987 7709           1706                                             mov             @r1,#9          ;T=3
0989 020000   F     1707                                             jmp     labelB
098C 7713           1708     not3in:                         mov             @r1,#19
098E 020000   F     1709                                             jmp     labelB
                    1710     
                    1711     
                    1712     ;;;;;;;;;;;3.11.06
                    1713     
                    1714     ;;коррекция 0
0991 7883           1715     KORnul:         mov             r0,#chdel
0993 B60008         1716                             cjne    @r0,#0,nonuldel
                    1717                                     
                    1718                     ;       mov             a,P5       ;p5.3=1
                    1719                     ;       orl             a,#08
                    1720                     ;       mov             P5,a
                    1721                     ;       nop
                    1722                     ;       nop
                    1723                                     
                    1724                     ;       mov             a,P5              ;p5.0=0
                    1725                     ;       anl             a,#0feh
                    1726                     ;       mov             P5,a
                    1727             
0996 900000   F     1728                             mov             dptr,#kor0us
0999 120000   F     1729                             call    lospus          ;упр слово коррекции 0
099C 8013           1730                             jmp             chdelmo
                    1731     
099E                1732     nonuldel:       ;cjne   @r0,#7,no4del
099E B60316         1733                                                     cjne    @r0,#3,no4del
                    1734                             ;рез ->AN
09A1 7862           1735                             mov             r0,#rez_A;->r2..r5
09A3 120000   F     1736                             call    resar2
                    1737                     ;       mov             a,reacp         ;r2..r5 &&&&&&&&&&&
                    1738                     ;               mov             r2,a
                    1739                     ;               mov             a,reacp+1
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    28

                    1740                     ;               mov             r3,a
                    1741                     ;               mov             a,reacp+2
                    1742                     ;               mov             r4,a
                    1743                     ;               mov             a,reacp+3
                    1744                     ;               mov             r5,a
                    1745                                     ;;;;;;;;;;
09A6 120402         1746                             call    altof           ;r2..r5->float
09A9 7884           1747                             mov             r0,#kor0_AN;->kor0_AN
09AB 120000   F     1748                             call    saver2
                    1749                                     
                    1750                     ;       mov             a,P5            ;p5.0=1
                    1751                     ;       orl             a,#01
                    1752                     ;       mov             P5,a
                    1753                     ;       nop
                    1754                     ;       nop
                    1755                                     
                    1756                     ;       mov             a,P5                    ;p5.3=0 
                    1757                     ;       anl             a,#0f7h
                    1758                     ;       mov             P5,a                    
09AE 120000   F     1759                             call    loadUS          ;восстан исходное упр слово
09B1 7883           1760     chdelmo:        mov             r0,#chdel
09B3 06             1761                             inc             @r0             ;chdel+1
09B4 020000   F     1762                             jmp              rebyte
                    1763     
09B7                1764     no4del:         ;cjne   @r0,#14,chdelmo
09B7 B606F7         1765                                             cjne    @r0,#6,chdelmo
09BA 7600           1766                             mov             @r0,#0          ;chdel
09BC 7898           1767                             mov             r0,#chinkor
09BE 7600           1768                             mov             @r0,#00;1;00;02;600;
09C0 08             1769                             inc             r0
09C1 76C8           1770                             mov             @r0,#0c8h;90h;0c8h;58h;258h
09C3 120000   F     1771                             call    clmassix;сбросить массив скольз среднего
09C6 020000   F     1772                             jmp              rebyte
                    1773     
                    1774     ;автокалибровка
09C9                1775     autoka:  ;;  mov                r0,#chavt
                    1776                      ;;  call               chcmp
                    1777                      ;;  jz         nulavt
                    1778                     ;;   mov                r1,#chavt
                    1779                     ;;   call               chdec;chavt-1
                    1780                      ;; jmp         rebyte
09C9                1781     nulavt:  ;;;;;
09C9 7883           1782                             mov             r0,#chdel
09CB B6000E         1783                             cjne    @r0,#0,nndelch
09CE E585           1784                             mov   a,p5
09D0 4404           1785                             orl             a,#04              ;p5.2=1
09D2 00             1786                             nop
09D3 00             1787                             nop
09D4 543F           1788                             anl             a,#3fh          ;p5.6,p5.7=0
09D6 F585           1789                             mov   p5,a
09D8 06             1790                             inc             @r0
09D9 020000   F     1791                             jmp              rebyte
                    1792     
09DC B6033D         1793     nndelch:        cjne    @r0,#3,n4delch
                    1794                             ;pez->A+
                    1795                             ;K+=000/(A+-AN)
                    1796                             ;mov            r0,#rez_A;->r2..r5
                    1797                             ;call   resar2
09DF E577           1798                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
09E1 FA             1799                                     mov             r2,a
09E2 E578           1800                                     mov             a,reacp+1
09E4 FB             1801                                     mov             r3,a
09E5 E579           1802                                     mov             a,reacp+2
09E7 FC             1803                                     mov             r4,a
09E8 E57A           1804                                     mov             a,reacp+3
09EA FD             1805                                     mov             r5,a
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    29

                    1806                                     ;;;;;;;;;;;;;;;
09EB 120402         1807                             call    altof                   ;r2..r5->float
09EE 7888           1808                             mov             r0,#rezAp;->rezAp
09F0 120000   F     1809                             call    saver2                          
09F3 7884           1810                             mov             r0,#kor0_AN;kor0_AN->r8..r11
09F5 120000   F     1811                             call    resar8                          
09F8 1201D1         1812                             call    flsub           ; r2..r5(A+-AN)
09FB 120000   F     1813                             call    move28     ;r2..r5->r8..r11
09FE 900000   F     1814                             mov             dptr,#CH2tho;000->r2..r5 float
0A01 120000   F     1815                             call    ldc_long                
0A04 1202B7         1816                             call    fldiv
0A07 EA             1817                             mov             a,r2
0A08 547F           1818                             anl             a,#7fh
0A0A FA             1819                             mov             r2,a
0A0B 7890           1820                             mov             r0,#koefKp;->koefKp
0A0D 120000   F     1821                             call    saver2
                    1822                       
                    1823                     ;       anl             P5,#0feh                ;p5.0=0 
0A10 E585           1824                     mov             a,P5
0A12 543B           1825                             anl             a,#3bh;acp-
0A14 F585           1826                             mov             P5,a
0A16 7883           1827                             mov             r0,#chdel
0A18 06             1828                             inc             @r0                       ;ch+1
0A19 020000   F     1829                             jmp             rebyte
                    1830     
0A1C B6063A         1831     n4delch:        cjne    @r0,#6,n8delch
                    1832                             ; pez->A-
                    1833                             ;K-=000/(A--AN)
                    1834                     ;       mov     r0,#rez_A;->r2..r5
                    1835                     ;       call    resar2
0A1F E577           1836                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0A21 FA             1837                                     mov             r2,a
0A22 E578           1838                                     mov             a,reacp+1
0A24 FB             1839                                     mov             r3,a
0A25 E579           1840                                     mov             a,reacp+2
0A27 FC             1841                                     mov             r4,a
0A28 E57A           1842                                     mov             a,reacp+3
0A2A FD             1843                                     mov             r5,a
                    1844                                     ;;;;;;;;;;;;;;;
0A2B 120402         1845                             call    altof                   ;r2..r5->float
0A2E 788C           1846                             mov             r0,#rezAm;->rezAm
0A30 120000   F     1847                             call    saver2                          
0A33 7884           1848                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0A35 120000   F     1849                             call    resar8                          
0A38 1201D1         1850                             call    flsub                   ; r2..r5(A--AN)
0A3B 120000   F     1851                             call    move28                  ;r2..r5->r8..r11
0A3E 900000   F     1852                             mov             dptr,#CH2tho    ;000->r2..r5 float
0A41 120000   F     1853                             call    ldc_long                
0A44 1202B7         1854                             call    fldiv
0A47 EA             1855                             mov             a,r2
0A48 547F           1856                             anl             a,#7fh
0A4A FA             1857                             mov             r2,a
0A4B 7894           1858                             mov             r0,#koefKm;->koefKm
0A4D 120000   F     1859                             call    saver2
                    1860                        
0A50 120000   F     1861                             call    loadus
0A53 7883           1862                             mov             r0,#chdel
0A55 06             1863                             inc             @r0                       ;ch+1
0A56 020000   F     1864                        jmp    rebyte
                    1865     
0A59 B6090F         1866     n8delch:        cjne    @r0,#9,n12delch
0A5C 7600           1867                             mov             @r0,#0
0A5E 7981           1868                             mov             r1,#chavt
0A60 770C           1869                             mov             @r1,#0ch;6;1;
0A62 09             1870                             inc             r1
0A63 7780           1871                             mov             @r1,#80h;40h;
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    30

0A65 120000   F     1872                             call   clmassix     ;сбросить массив среднего
0A68 020000   F     1873                             jmp             rebyte
0A6B 06             1874     n12delch:       inc             @r0
0A6C 020000   F     1875                             jmp             rebyte
                    1876     
                    1877     ;in-r1-count
0A6F                1878     chdec:          ;mov            r1,#chavt               ;chavt-1
0A6F E7             1879                             mov             a,@r1
0A70 FC             1880                             mov             r4,a
0A71 09             1881                             inc             r1
0A72 E7             1882                             mov             a,@r1
0A73 FD             1883                             mov             r5,a
0A74 C202           1884                             clr             rr2
0A76 C203           1885                             clr             rr3
0A78 900000   F     1886                             mov             dptr,#ch1        
0A7B 120000   F     1887                             call    ldc_ltemp
0A7E 120000   F     1888                             call    lsub
0A81 ED             1889                             mov             a,r5
0A82 F7             1890                             mov             @r1,a
0A83 19             1891                             dec             r1
0A84 EC             1892                             mov             a,r4
0A85 F7             1893                             mov             @r1,a
0A86 22             1894                             ret      
                    1895     
                    1896     
                    1897     
                    1898     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
0A87 75E700         1899      ind:   mov             EIE2,#00H;mov   IE,#00h
0A8A 120000   F     1900                     call    mign
0A8D 7840           1901                      mov            r0,#bufind;+11
0A8F 7F0C           1902                      mov            r7,#12
0A91 C286           1903      nexin: clr             p0.6
0A93 E6             1904                     mov             a,@r0
0A94 F59B           1905                     mov             SPI0DAT,a
0A96 20FBFD         1906                     jb              TXBSY,$
0A99 D286           1907                     setb    p0.6
0A9B 120000   F     1908                     call    z_9             ;25mks
0A9E 08             1909                     inc             r0;dec          r0
0A9F DFF0           1910                     djnz    r7,nexin
0AA1 75E730         1911                     mov             EIE2,#30H;mov   IE,#80h
0AA4 22             1912                ret
                    1913     
                    1914     
0AA5 7A08           1915     zapadc:   mov R2,#8
0AA7 D297           1916     sdv:      setb P1.7
0AA9 33             1917               rlc A
0AAA 9296           1918                     mov P1.6,C
0AAC 120000   F     1919                     call tim2
                    1920                                     
0AAF C297           1921                     clr P1.7
0AB1 120000   F     1922                     call tim2
0AB4 DAF1           1923                     djnz R2,sdv
0AB6 D296           1924                     setb P1.6
0AB8 22             1925                     ret
                    1926     
0AB9 7A08           1927     chtadc:   mov R2,#8
0ABB D297           1928     sdv1:     setb P1.7
0ABD 120000   F     1929               call tim2
0AC0 C297           1930                     clr P1.7
0AC2 A296           1931                     mov C,P1.6
0AC4 33             1932                     rlc A
0AC5 120000   F     1933                     call tim2
0AC8 DAF1           1934                     djnz R2,sdv1
0ACA 22             1935                     ret
                    1936     
0ACB 7E30           1937     tim:      mov R6,#30h;38h
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    31

0ACD DEFE           1938     tim1:     djnz R6,tim1
0ACF 22             1939               ret
                    1940               
0AD0 7E10           1941     tim2:     mov R6,#10h;14h
0AD2 DEFE           1942     tim3:     djnz R6,tim3
0AD4 22             1943               ret
                    1944     
                    1945     ;запись из acc
0AD5 C3             1946     write_x1: clr   c
0AD6                1947     writeD_x1:
0AD6 92B1           1948                       mov P3.1,c        ;запись
0AD8 F5A0           1949               mov P2,A
0ADA D2B3           1950                       setb P3.3
0ADC 120000   F     1951                       call z_5
0ADF C2B3           1952                       clr P3.3
0AE1 75A0FF         1953                       mov P2,#0FFh
0AE4 22             1954                       ret
                    1955     
                    1956     ;чтение в acc
0AE5 C3             1957     read_x2:  clr   c  
0AE6 92B1           1958               mov P3.1,c        ;чтение
0AE8 D2B2           1959               setb P3.2
0AEA D2B3           1960                       setb P3.3
0AEC 120000   F     1961                     call z_5
0AEF E5A0           1962                       mov A,P2
0AF1 C2B3           1963                       clr P3.3
0AF3 C2B2           1964                       clr P3.2
0AF5 22             1965                       ret
                    1966     
                    1967     
0AF6 120000   F     1968     loop:     call read_x2;x2    ;ожидание флага готовности
0AF9 20E7FA         1969                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
0AFC 22             1970                        ret           ;возврат, если бит А(7)<>1
                    1971                                      
                    1972                                        
                    1973     
                    1974     
                    1975     
                    1976     ;dptr+4-приемник
                    1977     ;dptr-источник
                    1978     ;r7-кол байт  
0AFD                1979     xCIKLWR:
0AFD 7F04           1980                             mov             r7,#4   
0AFF E0             1981     lwrx:   movx    a,@dptr
0B00 C083           1982                             push    dph
0B02 C082           1983                             push    dpl
0B04 A3             1984                             inc             dptr
0B05 A3             1985                             inc             dptr
0B06 A3             1986                             inc             dptr
0B07 A3             1987                             inc             dptr
0B08 F0             1988                             movx    @dptr,a
0B09 D082           1989                             pop             dpl
0B0B D083           1990                             pop             dph
                    1991                             
0B0D A3             1992                             inc             dptr
0B0E DFEF           1993                             djnz    r7,lwrx
0B10 22             1994                             ret
                    1995     ;r2..r5->@dptr..@dptr+3                         
0B11 EA             1996     saveIr2:                mov     a,r2
0B12 F0             1997                                             movx    @dptr,a
0B13 A3             1998                                             inc     dptr
0B14 EB             1999                                             mov     a,r3
0B15 F0             2000                                             movx    @dptr,a
0B16 A3             2001                                             inc     dptr
0B17 EC             2002                                             mov     a,r4
0B18 F0             2003                                             movx    @dptr,a
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    32

0B19 A3             2004                                             inc     dptr
0B1A ED             2005                                             mov     a,r5
0B1B F0             2006                                             movx    @dptr,a
0B1C 22             2007                                             ret
                    2008     ;r2..r5-> @r0..@r0+3
                    2009     
0B1D EA             2010     saver2:         mov     a,r2
0B1E F6             2011                                             mov     @r0,a
0B1F 08             2012                                             inc     r0
0B20 EB             2013                                             mov     a,r3
0B21 F6             2014                                             mov     @r0,a
0B22 08             2015                                             inc     r0
0B23 EC             2016                                             mov     a,r4
0B24 F6             2017                                             mov     @r0,a
0B25 08             2018                                             inc     r0
0B26 ED             2019                                             mov     a,r5
0B27 F6             2020                                             mov     @r0,a
0B28 22             2021                                             ret 
0B29 7F50           2022     clmassix:       mov                     r7,#50h;28h
0B2B 900080         2023                             mov     dptr,#MASS0        ;забить массив A нулями
0B2E 7400           2024     clmax:          mov          a,#00h
0B30 F0             2025                  movx    @dptr,a
0B31 A3             2026                  inc     dptr
0B32 DFFA           2027                 djnz                r7,clmax                
0B34 F56E           2028                  mov     chmas,a
0B36 C201           2029                  clr     bitmas
0B38 22             2030                 ret
                    2031     
                    2032     ;r1-яЁшхьшъ
                    2033     ;r0-шёЄюўшъ
                    2034     ;r7-ъюы срщЄ  
0B39                2035     CIKLWR:
0B39 7F04           2036                             mov             r7,#4   
0B3B E6             2037     lwr:    mov     a,@r0
0B3C F7             2038                             mov     @r1,a
0B3D 09             2039                             inc             r1
0B3E 08             2040                             inc             r0
0B3F DFFA           2041                             djnz    r7,lwr
0B41 22             2042                             ret     
                    2043     ;r2..r5-> @dptr..@dptr+3
                    2044     
0B42 120000   F     2045     zmul:   call    maform
0B45 120000   F     2046                     call    lmul
0B48 120000   F     2047                     call    bform
0B4B 22             2048                     ret
                    2049     
0B4C 120000   F     2050     zdiv:   call    maform
0B4F 120000   F     2051                     call    divide
0B52 120000   F     2052                     call    bform
0B55 22             2053                     ret
                    2054     
0B56 EA             2055     maform: mov a,r2
0B57 33             2056             rlc a
0B58 5006           2057             jnc             fo1m
0B5A D202           2058                     setb            znmat
0B5C 120000   F     2059                     call   form4
0B5F 22             2060                     ret
0B60 C202           2061     fo1m:   clr             znmat
0B62 22             2062                     ret
                    2063     
0B63 300203         2064     bform:  jnb             znmat,fo2m
0B66 120000   F     2065                     call    form4
0B69 22             2066     fo2m:   ret
                    2067       
                    2068     ;r2..r5 яхЁхтхёЄш т фюя ъюф
0B6A ED             2069     form4:          mov a,r5
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    33

0B6B F4             2070             cpl a
0B6C 2401           2071             add a,#1
0B6E FD             2072             mov r5,a
0B6F EC             2073             mov a,r4
0B70 F4             2074             cpl a
0B71 3400           2075             addc    a,#0
0B73 FC             2076             mov r4,a
0B74 EB             2077             mov a,r3
0B75 F4             2078                 cpl a
0B76 3400           2079             addc    a,#0
0B78 FB             2080             mov r3,a
0B79 EA             2081             mov a,r2
0B7A F4             2082             cpl a
0B7B 3400           2083             addc    a,#0
0B7D FA             2084             mov r2,a
0B7E 22             2085             ret
                    2086     
0B7F 120000   F     2087     zcmp:   call            maform
0B82 120000   F     2088                     call            lcmp
0B85 C0D0           2089                     push            psw
0B87 120000   F     2090                     call    bform
0B8A D0D0           2091                     pop             psw
0B8C 22             2092                     ret
                    2093     
                    2094     
                    2095     ;@r0..@r0+3->r8..r11
                    2096     
0B8D E6             2097     resar8: mov     a,@r0
0B8E F508           2098                     mov     ltemp,a
0B90 08             2099                     inc     r0
0B91 E6             2100                     mov     a,@r0
0B92 F509           2101                     mov     ltemp+1,a
0B94 08             2102                     inc     r0
0B95 E6             2103                     mov     a,@r0
0B96 F50A           2104                     mov     ltemp+2,a
0B98 08             2105                     inc     r0
0B99 E6             2106                     mov     a,@r0
0B9A F50B           2107                     mov     ltemp+3,a
0B9C 22             2108                     ret
                    2109     
                    2110     ;
                    2111     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                    2112     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                    2113     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                    2114     ;r2 a    ўшёыю 180
                    2115     ;00 b4
                    2116     ;т_ї- mabin..mabin+2
                    2117     ;     80 01 00
                    2118      
0B9D C8             2119     cond:   xch     a,r0    
0B9E F9             2120                     mov     r1,a
0B9F C8             2121                     xch     a,r0
0BA0 7C03           2122                     mov     r4,#03
0BA2 7700           2123     dcoa:   mov     @r1,#00
0BA4 09             2124                     inc     r1
0BA5 DCFB           2125                     djnz    r4,dcoa
0BA7 7B10           2126                     mov     r3,#10h
0BA9 C3             2127     dcob:   clr     c
0BAA 33             2128                     rlc     a
0BAB CA             2129                     xch     a,r2
0BAC 33             2130                     rlc     a
0BAD CA             2131                     xch     a,r2
0BAE C8             2132                     xch     a,r0
0BAF F9             2133                     mov     r1,a
0BB0 C8             2134                     xch     a,r0
0BB1 7C03           2135                     mov     r4,#03
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    34

0BB3 FD             2136                     mov     r5,a
0BB4 E7             2137     dcoc:   mov     a,@r1 
0BB5 37             2138                     addc    a,@r1
0BB6 D4             2139                     da      a
0BB7 F7             2140                     mov     @r1,a
0BB8 09             2141                     inc     r1
0BB9 DCF9           2142                     djnz    r4,dcoc
0BBB ED             2143                     mov     a,r5
0BBC 4003           2144                     jc      dcod
0BBE DBE9           2145                     djnz    r3,dcob
0BC0 C3             2146                     clr     c
0BC1 00             2147     dcod:   nop
0BC2 22             2148                     ret
                    2149     
0BC3 8A08           2150     move28: mov     ltemp,r2                        ;r2..r5->ltemp
0BC5 850309         2151                     mov     ltemp+1,3
0BC8 85040A         2152                     mov     ltemp+2,4
0BCB 85050B         2153                     mov     ltemp+3,5
0BCE 22             2154                     ret
                    2155     
                    2156     ;@r0..@r0+3->r2..r5
                    2157     
0BCF E6             2158     resar2: mov     a,@r0
0BD0 FA             2159                     mov     r2,a
0BD1 08             2160                     inc     r0
0BD2 E6             2161                     mov     a,@r0
0BD3 FB             2162                     mov     r3,a
0BD4 08             2163                     inc     r0
0BD5 E6             2164                     mov     a,@r0
0BD6 FC             2165                     mov     r4,a
0BD7 08             2166                     inc     r0
0BD8 E6             2167                     mov     a,@r0
0BD9 FD             2168                     mov     r5,a
0BDA 22             2169                     ret
                    2170     
                    2171     ;25mkc !!!!!!!!!!!!!!!1
0BDB 7B4B           2172     z_9:      mov R3,#4Bh      ;загрузка числа
0BDD DBFE           2173                    djnz R3,$
0BDF 22             2174               ret
                    2175     
                    2176     ;запись   передаваемый байт в acc
                    2177     ;передача байта послед кодом старшими разрядами  вперед
0BE0 7A08           2178     write:     mov R2,#8
0BE2 C3             2179                             clr  c  
0BE3 C297           2180     wr1:            clr             p1.7;P1.2
0BE5 00             2181                         nop 
0BE6 33             2182                             rlc A
0BE7 9296           2183                             mov P1.6,C;P1.1,C
0BE9 120000   F     2184                        call tim2
0BEC D297           2185                        setb P1.7;P1.2
0BEE 120000   F     2186                call tim2
0BF1 DAF0           2187                       djnz R2,wr1
0BF3 C296           2188                       clr P1.6;P1.1
0BF5 22             2189                      ret
                    2190     
                    2191     ;принимаемый байт в acc
                    2192     ;прием байта последовательным кодом старшими разрядами вперед
0BF6 7A08           2193     read:    mov R2,#8
0BF8 C297           2194     re1:     clr P1.7;P1.2
0BFA 120000   F     2195              call tim2        ;5mks
0BFD A294           2196                     mov C,P1.4;P1.0
0BFF 33             2197                     rlc A           
0C00 D297           2198                     setb P1.7;P1.2
0C02 120000   F     2199                     call tim2
0C05 DAF1           2200                     djnz R2,re1
0C07 22             2201                     ret
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    35

                    2202     
                    2203      ;in r0-count   
                    2204     ;r10,r11-значение с котоым сравнивается счетчик
                    2205     ;r2..r5 -значение счетчика
0C08                2206     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
0C08 E6             2207                     mov                     a,@r0
0C09 FC             2208                     mov                     r4,a
0C0A 08             2209                     inc                     r0
0C0B E6             2210                     mov                     a,@r0
0C0C FD             2211                     mov                     r5,a
0C0D 7B00           2212                     mov                     r3,#0
0C0F 7A00           2213                     mov                     r2,#0
0C11 750800         2214                     mov                     r8,#0;clr                       r8
0C14 750900         2215                     mov                     r9,#0;clr                       r9
0C17 120000   F     2216                     call            lcmp
0C1A 22             2217                     ret
                    2218     
                    2219     
                    2220     
                    2221     
                    2222     
                    2223     
                    2224                                 
0C1B 020000   F     2225     rout6:          jmp             out6
0C1E 020000   F     2226     rlabelF:        jmp             labelF  
0C21 020000   F     2227     rknrazr:        jmp             knrazr  
0C24 020000   F     2228     rknopt:         jmp             knopt
0C27 020000   F     2229     rizman:         jmp             izman   
0C2A                2230     keyb1:  ;IE6 
0C2A 75E700         2231                                     mov             EIE2,#00H
                    2232                                     
0C2D C0E0           2233                                     push    acc
0C2F C0D0           2234                                     push    psw
0C31 C000           2235                                     push    rr0
0C33 C001           2236                                     push    rr1
0C35 C002           2237                                     push    rr2
0C37 C003           2238                                     push    rr3
0C39 C004           2239                                     push    rr4
0C3B C005           2240                                     push    rr5
0C3D C006           2241                                     push    rr6
0C3F C007           2242                                     push    rr7
                    2243                                     ;clr            bitmig
                    2244                       ;;;;;;;;;;;;;;
0C41 120000   F     2245                                     call    z_01s;0,1s
                    2246                                     ;восстан знакоместо при мигании
                    2247                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0C44 78B2           2248                                     mov             r0,#marker
0C46 7440           2249                                     mov             a,#bufind
0C48 26             2250                                     add             a,@r0                   ;a=bufind+marker
0C49 F9             2251                                     mov             r1,a
0C4A A73C           2252                                     mov             @r1,savba
                    2253                                     ;;;;;;;;;;;
0C4C E5B0           2254                             mov             a,p3
0C4E 20E641         2255                                     jb              acc.6,outviR;выход из режима выч R
0C51 E5B0           2256     gout6:                          mov             a,p3
0C53 44FF           2257                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0C55 F5B0           2258                                     mov             p3,a
0C57 E5B0           2259                                     mov             a,p3
0C59 30E6BF         2260                                     jnb             acc.6,rout6             ;error
0C5C 3004BF         2261                                     jnb             bitizm,rlabelF
0C5F 75B0FE         2262                                     mov             p3,#0feh                ;реж IZM
0C62 E5B0           2263                                     mov             a,p3
0C64 30E6C0         2264                                     jnb             acc.6,rizman
0C67 75B0FD         2265                                     mov             p3,#0fdh
0C6A E5B0           2266                                     mov             a,p3
0C6C 30E6B2         2267                                     jnb             acc.6,rknrazr             ;labelC
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    36

0C6F 75B0FB         2268                                     mov             p3,#0fbh
0C72 E5B0           2269                                     mov             a,p3
0C74 30E641         2270                                     jnb             acc.6,knright           ;->
0C77 75B0F7         2271                                     mov             p3,#0f7h
0C7A E5B0           2272                                     mov             a,p3
0C7C 30E6A5         2273                                     jnb             acc.6,rknopt                    ;T
0C7F 75B0EF         2274                                     mov             p3,#0efh
0C82 E5B0           2275                                mov          a,p3
0C84 30E615         2276                                     jnb             acc.6,pyskst                    ;pysk/stop
0C87 75B0DF         2277                                     mov             p3,#0dfh
0C8A E5B0           2278                                     mov             a,p3
0C8C 30E645         2279                                jnb          acc.6,knvich
0C8F 020000   F     2280                                     jmp             izmpaT
                    2281     
0C92 3006BC         2282     outviR: jnb             bitvi11,gout6   
0C95 C214           2283                                     clr             bitvich                         ;выход из р
                             ежима выч R  
0C97 C206           2284                                     clr             bitvi11
                    2285                                     
0C99 020000   F     2286                                     jmp             out6
                    2287     
0C9C 200A05         2288     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0C9F D20A           2289                                     setb    bitbon  ;уст реж буфер вкл
0CA1 020000   F     2290                                     jmp             izmpaT
0CA4 C20A           2291     bufon:                  clr             bitbon  ;уст реж буфер выкл
0CA6 807E           2292                                     jmp             izmpaT
                    2293     
0CA8 79B0           2294     tizmri:                 mov             r1,#level
0CAA B70102         2295                                     cjne    @r1,#1,right2
                    2296                                     ;10s->HET
0CAD 8004           2297                                     jmp             right3
                    2298     
0CAF 07             2299     right2:                 inc             @r1
0CB0 120000   F     2300                                     call    lolevT
                    2301                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0CB3 120000   F     2302     right3:                 call    ind
0CB6 806A           2303                                     jmp             izmfun
                    2304     
                    2305                             
                    2306                             
0CB8                2307     knright:        
                    2308     
0CB8 79AE           2309                                     mov             r1,#diap
                    2310                             ;перекл диапазон 1 поз вверх сбр массив
0CBA 17             2311                                     dec             @r1
0CBB B7FF04         2312                                     cjne    @r1,#0ffh,diinc
0CBE 7700           2313                                     mov             @r1,#0
0CC0 8060           2314                                     jmp  izmfun
0CC2 120000   F     2315     diinc:                  call     clmassix
0CC5 78B3           2316                                     mov             r0,#summa
0CC7 120000   F     2317                                     call    clear4
0CCA 786A           2318                                     mov             r0,#rez_A0
0CCC 120000   F     2319                                     call    clear4  
0CCF 120000   F     2320                                     call    loadUS
0CD2 804E           2321                                      jmp  izmfun
                    2322     
0CD4 200610         2323     knvich:            jb           bitvi11,onvich
0CD7 C204           2324                                     clr             bitizm
0CD9 D214           2325                                     setb    bitvich
                    2326                                     
0CDB 78B1           2327                                     mov             r0,#vichR
0CDD 7611           2328                                     mov             @r0,#11h;;????????or 0
                    2329                                     ;ВЫЧИСЛИТЬ
0CDF 900000   F     2330                                     mov     dptr,#teVICH
0CE2 120000   F     2331                                     call    lotext
                    2332                               ; call                ind
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    37

0CE5 806C           2333                                     jmp              viout;izmpaT
                    2334     
0CE7 C214           2335     onvich:                 clr             bitvich
0CE9 78B1           2336                                     mov             r0,#vichR
0CEB 7600           2337                                     mov             @r0,#0
0CED 8037           2338                                     jmp              izmpaT
                    2339     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0CEF 301820         2340     louizm:            jnb          knizm,lou
0CF2 79AE           2341                                     mov             r1,#diap
0CF4 C3             2342                                     clr             c
0CF5 7403           2343                                     mov             a,#3
0CF7 97             2344                                     subb    a,@r1
0CF8 5006           2345                                     jnc             lldi23    ;10-2..10-5
                    2346                                     ;10-6..10-11
0CFA E584           2347                                     mov             a,p4
0CFC 54F7           2348                                     anl             a,#0f7h   ;d3
0CFE F584           2349                                     mov             p4,a
0D00 E7             2350     lldi23:                 mov             a,@r1
0D01 6403           2351                                     xrl             a,#3
0D03 7002           2352                                     jnz             lldi3
0D05 8005           2353                                     jmp             lldi2   ;10-5
0D07 E7             2354     lldi3:                  mov             a,@r1
0D08 6402           2355                                     xrl             a,#2            ;
0D0A 7006           2356                                     jnz             lou             
0D0C E585           2357     lldi2:                  mov             a,p5            ;10-4
0D0E 4408           2358                                     orl             a,#08
0D10 F585           2359                                     mov             p5,a
0D12 22             2360     lou:                    ret
                    2361                               ;;;;;;
0D13 201807         2362     izman:                  jb              knizm,knizmon
0D16 D218           2363                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2364                             ;       d3(k5 p4),d3(u5 p5)заслать us
0D18 120000   F     2365                                     call    louizm 
0D1B 8005           2366                                     jmp             izmfun
0D1D C218           2367     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0D1F 120000   F     2368                                     call    loadUS;восстановить us
0D22                2369     izmfun:                 
0D22 D208           2370                                     setb    bitbuf
0D24 8000           2371                                     jmp             labelE;;;;;;;;;;;;
                    2372                                     ;;;;;;;;;;;;;;
0D26                2373     izmpaT:
                    2374     ;;;;;;;;;;;;;;;;;
                    2375                     ;       clr             c 
                    2376                     ;       mov             r1,#parN
                    2377     
                    2378                     ;       mov             r0,#diap
                    2379                     ;       mov             a,#6            
                    2380                     ;       subb    a,@r0
                    2381                     ;       jnc             labelE          ;         ;10-2..10-8
                    2382                               
                    2383                     ;       mov             @r1,#2          ;10-9..10-11            
                    2384                     ;       jmp             labelE
                    2385     
                    2386     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0D26 789A           2387     labelE:                 mov             r0,#parT
0D28 793D           2388                                     mov             r1,#chkl
0D2A B60108         2389                                     cjne    @r0,#1,izmt2
0D2D 7700           2390                                     mov             @r1,#0
0D2F 09             2391                                     inc             r1
0D30 7702           2392                                     mov             @r1,#2
0D32 020000   F     2393                                     jmp             out6
0D35 B60208         2394     izmt2:                  cjne    @r0,#2,izmt3
0D38 7700           2395                                     mov             @r1,#0
0D3A 09             2396                                     inc             r1
0D3B 7714           2397                                     mov             @r1,#20
0D3D 020000   F     2398                                     jmp             out6
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    38

                    2399     
0D40 7700           2400     izmt3:                  mov             @r1,#0
0D42 09             2401                                     inc             r1
0D43 77C8           2402                                     mov             @r1,#200
0D45 020000   F     2403                                     jmp             out6
                    2404     
                    2405     
                    2406     
                    2407     
0D48                2408     knopt: ;кнопка T
0D48 C204           2409                                clr          bitizm
0D4A D210           2410                                setb         bitt2
0D4C 79B7           2411                                mov          r1,#load
0D4E 7704           2412                                mov          @r1,#4;1s
0D50 120000   F     2413                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2414                                
                    2415     
0D53 793D           2416     viout:          mov             r1,#chkl
0D55 7703           2417                             mov             @r1,#03
0D57 09             2418                             inc             r1
0D58 77E8           2419                             mov             @r1,#0e8h               ;1000
0D5A 020000   F     2420                             jmp             out6
                    2421     
0D5D                2422     knrazr:          
0D5D C3             2423     labelC:          clr            c
0D5E 78AF           2424                             mov             r0,#parN
0D60 799A           2425                             mov             r1,#parT
0D62 7402           2426                             mov             a,#2
0D64 97             2427                             subb    a,@r1
0D65 40BF           2428                             jc              labelE          ;T>2
0D67 B60104         2429                             cjne    @r0,#1,noN1c
0D6A 7602           2430                             mov             @r0,#2          ;N=2
0D6C 80B8           2431                             jmp             labelE
                    2432     
0D6E B60204         2433     noN1c:          cjne    @r0,#2,not_1
0D71 7603           2434                             mov             @r0,#3          ;N=3      ;10-2..10-8
0D73 80B1           2435                             jmp             labelE
                    2436     
0D75                2437     not_10: 
0D75 7601           2438     not_1:          mov             @r0,#1                          ;N=1
0D77 80AD           2439                             jmp     labelE
                    2440     
0D79 020000   F     2441     rtizmri:        jmp             tizmri
0D7C                2442     labelf:                 
0D7C 301024         2443                             jnb             bitt2,nofizm
0D7F 75B0FB         2444                        mov          p3,#0fbh
0D82 E5B0           2445                        mov          a,p3
0D84 20E60F         2446                        jb           acc.6,outF
0D87 79B7           2447                        mov          r1,#load;parT
0D89 B70503         2448                        cjne         @r1,#5,noft1
                    2449                        ;t=10s
0D8C 020000   F     2450                        jmp          out6;ft1izm
                    2451     
0D8F 07             2452     noft1:     inc          @r1;dec         @r1
0D90 120000   F     2453     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2454                             ;call   ind
0D93 020000   F     2455                     jmp             out6;??????????????/
                    2456     
                    2457                             ;увеличить счетчик задержки клавиатуры
0D96 783D           2458     outF:           mov             r0,#chkl
0D98 7627           2459                             mov             @r0,#27h
0D9A 08             2460                             inc             r0
0D9B 7610           2461                             mov             @r0,#10h
0D9D 020000   F     2462                             jmp             out6;out7
                    2463     
0DA0 020000   F     2464     noviR1:         jmp             noviR
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    39

0DA3 3014FA         2465     nofizm:         jnb             bitvich,noviR1
0DA6 78B1           2466                             mov             r0,#vichR
0DA8 B6111A         2467                             cjne    @r0,#11h,no11v6
0DAB 7612           2468                             mov             @r0,#12h                ;11= вычислить
0DAD 900000   F     2469     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0DB0 120000   F     2470                             call    lotext
0DB3 80E1           2471                             jmp             outF
                    2472             
0DB5 020000   F     2473     rnor11:         jmp             nor11   
                    2474             
0DB8 B611FA         2475     nor13:          cjne    @r0,#11h,rnor11
0DBB 7612           2476                             mov             @r0,#12h
0DBD 900000   F     2477                             mov             dptr,#teIZMK    ;       изм конст
0DC0 120000   F     2478                         call        lotext             
0DC3 80D1           2479                             jmp             outF
                    2480     
0DC5 B6120A         2481     no11v6:         cjne    @r0,#12h,no12v6
0DC8 7613           2482                             mov             @r0,#13h
0DCA 900000   F     2483                             mov             dptr,#teOUT
0DCD 120000   F     2484                             call    lotext
0DD0 80C4           2485                             jmp             outF
                    2486                     
0DD2 B6130A         2487     no12v6:         cjne    @r0,#13h,no13v6
0DD5 7611           2488                             mov             @r0,#11h
0DD7 900000   F     2489                             mov             dptr,#teVICH
0DDA 120000   F     2490                             call    lotext
0DDD 80B7           2491                             jmp             outF
                    2492     
                    2493     ;кн -> A= 0000
                    2494     ;кн -> B= +00000
0DDF 75B0FB         2495     no13v6:         mov             p3,#0fbh
0DE2 E5B0           2496                             mov             a,p3
0DE4 20E634         2497                             jb              acc.6,chanZ
0DE7 E53B           2498                             mov             a,movrig
0DE9 B40713         2499                             cjne    a,#7,kon_B      
0DEC 78B2           2500                             mov             r0,#marker      ;A= 0000
0DEE B60715         2501                             cjne    @r0,#7,mark0_8          ;курсор справа ?
0DF1 E53A           2502     rikn:           mov             a,movleft
0DF3 F6             2503                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2504     ;                               29.12.06
                    2505     ;;;;;;;;;;;;;;;;;;
                    2506     ;необходимо не портить цифру в следуюем справа знакоместе
                    2507     ;т е сохранить ее в ячейке для мигания в противном случае
                    2508     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2509     ;       знакоместа
0DF4 78B2           2510                                     mov             r0,#marker
0DF6 7440           2511                                     mov             a,#bufind
0DF8 26             2512                                             add             a,@r0                   ;a=bufind+m
                             arker
0DF9 F9             2513                                             mov             r1,a
0DFA 09             2514                                             inc             r1
0DFB 873C           2515                                             mov             savba,@r1
0DFD 8097           2516                                     jmp             outF
                    2517     
0DFF 78B2           2518     kon_B:          mov             r0,#marker      ;B= +00000
0E01 B60802         2519                                             cjne    @r0,#8,mark0_8          ;курсор справа ?
0E04 80EB           2520                                             jmp             rikn
0E06                2521     mark0_8:
                    2522     ;                               29.12.06
                    2523     ;;;;;;;;;;;;;;;;;;
                    2524     ;необходимо не портить цифру в следуюем справа знакоместе
                    2525     ;т е сохранить ее в ячейке для мигания в противном случае
                    2526     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2527     ;       знакоместа ->B=+00000
0E06 78B2           2528                                             mov             r0,#marker
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    40

0E08 7440           2529                                     mov             a,#bufind
0E0A 26             2530                                             add             a,@r0                   ;a=bufind+m
                             arker
0E0B F9             2531                                             mov             r1,a
0E0C 09             2532                                             inc             r1
0E0D 873C           2533                                             mov             savba,@r1
0E0F 78B2           2534                             mov             r0,#marker
0E11 06             2535                             inc             @r0             ;       сдвинуть курсор вправо на 1
0E12 C219           2536                             clr             bitmig
0E14 B60901         2537                             cjne    @r0,#9,outma
0E17 18             2538                             dec             r0;ppp
0E18 020000   F     2539     outma:          jmp             outF
                    2540     
0E1B 75B0FE         2541     chanZ:          mov             p3,#0feh
0E1E E5B0           2542                             mov             a,p3
0E20 20E611         2543                             jb              acc.6,chanma
                    2544                             ;изм знак в старшем разряде на противоположн
0E23 E543           2545                             mov             a,bufind+3
0E25 B42B06         2546                             cjne            a,#2bh,noplus
0E28 75432D         2547                             mov                     bufind+3,#2dh           ;+->-   
0E2B 020000   F     2548                             jmp             outF
0E2E                2549     noplus:
0E2E 75432B         2550                             mov                     bufind+3,#2bh           ;-/+-
0E31 020000   F     2551                             jmp             outF
0E34 75B0FD         2552     chanma:         mov             p3,#0fdh
0E37 E5B0           2553                             mov             a,p3
0E39 20E603         2554                             jb              acc.6,outFl;labelL1
                    2555                             ;clr            bitmig
0E3C 120000   F     2556     labelL1:        call    vvchif  ;увеличить цифру 
                    2557     
0E3F 020000   F     2558     outFl:                  jmp             outF
                    2559                     
0E42                2560     nor11:          ;       выход
0E42 7613           2561                     mov             @r0,#13h  ;12->13
0E44 900000   F     2562                     mov             dptr,#teOUT
                    2563     ;               jmp             vi1113
                    2564     
                    2565     ;;;;;;;;;кнопка -> в режиме кнопки меню
                    2566     
0E47 C206           2567     yesviR:         clr             bitvi11;????????/
0E49 200C03         2568                             jb              bmem11,rlabelL
0E4C 020000   F     2569                             jmp             out6;???????//
                    2570     
0E4F 020000   F     2571     rlabelL:        jmp                     labelL
                    2572     
0E52 78B1           2573     noviR:          mov                     r0,#vichR
0E54 7415           2574                                             mov                     a,#15h
0E56 C3             2575                                             clr                     c
0E57 96             2576                                             subb            a,@r0
0E58 4016           2577                                             jc                      ri21_23
                    2578     
0E5A 75B0FB         2579                                             mov             p3,#0fbh; реж кн меню ->
0E5D 20B60A         2580                                             jb              p3.6,ri6
0E60 78B1           2581                                             mov             r0,#vichR
0E62 B61508         2582                                             cjne    @r0,#15h,norime
0E65 7611           2583                                             mov             @r0,#11h
0E67 120000   F     2584     norime1:        call            lomenu
0E6A 020000   F     2585     ri6:                    jmp             out6
0E6D 06             2586     norime:         inc             @r0
0E6E 80F7           2587                                             jmp             norime1
                    2588             
0E70 7423           2589     ri21_23:        mov                     a,#23h          ;->
0E72 C3             2590                                             clr                     c
0E73 96             2591                                             subb            a,@r0
0E74 4014           2592                                             jc                      ri_31
0E76 75B0FB         2593                                             mov                     p3,#0fbh
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    41

0E79 20B6EE         2594                                             jb                      p3.6,ri6
0E7C B62308         2595                                             cjne            @r0,#23h,no23ri
0E7F 7621           2596                                             mov                     @r0,#21h
0E81 120000   F     2597                                             call            lomenu
0E84 020000   F     2598                                             jmp                     out6
0E87 06             2599     no23ri:         inc                     @r0
0E88 80DD           2600                                             jmp                     norime1
0E8A B63119         2601     ri_31:          cjne            @r0,#31h,no31ri;->19.2->57.6->19.2
0E8D 30130B         2602                                             jnb                     bitv19,gosk19
0E90 900000   F     2603                                             mov                     dptr,#teS57_6;57,6
0E93 120000   F     2604                                             call            lotext
0E96 C213           2605                                             clr                     bitv19
0E98 020000   F     2606                                             jmp             out6
0E9B 900000   F     2607     gosk19:         mov                     dptr,#teS19_2
0E9E 120000   F     2608                                             call            lotext
0EA1 D213           2609                                             setb            bitv19
0EA3 020000   F     2610                                             jmp                     out6
                    2611     
                    2612     
                    2613     
                    2614     ;labelS2:       jmp                     out6
                    2615     
0EA6 7442           2616     no31ri:         mov                     a,#42h          ;->
0EA8 C3             2617                                             clr                     c
0EA9 96             2618                                             subb            a,@r0
0EAA 40BE           2619                                             jc                      ri6
0EAC 75B0FB         2620                                             mov                     p3,#0fbh                   
                                  ;41,42
0EAF 20B608         2621                                             jb                      p3.6,rlabelN
0EB2 75B0FD         2622                                             mov                     p3,#0fdh
0EB5 20B6B2         2623                                             jb                      p3.6,ri6
0EB8 8082           2624                                             jmp             labelL1
0EBA 020000   F     2625     rlabelN:                jmp             labelN
0EBD 020000   F     2626     moutF:          jmp             outF
                    2627     ;;;;;;;;;;;;;;;;;;;;;;;;;
0EC0 020000   F     2628     rnnmemb:        jmp             nnmemb
0EC3 300BFA         2629     nbimenu:        jnb             bitmem,rnnmemb
0EC6 79B0           2630                             mov             r1,#level
0EC8 B71113         2631                        cjne         @r1,#11h,nomem11
                    2632                        
0ECB 75B0FB         2633                        mov          p3,#0fbh
0ECE E5B0           2634                        mov          a,p3
0ED0 20E6EA         2635                        jb           acc.6,moutF
0ED3 7712           2636                        mov          @r1,#12h
0ED5 900000   F     2637                        mov          dptr,#teWR
0ED8 120000   F     2638                        call         lotext
0EDB 020000   F     2639                        jmp          outF
                    2640     
0EDE B71213         2641     nomem11:   cjne         @r1,#12h,nomem12
0EE1 75B0FB         2642                             mov             p3,#0fbh
0EE4 E5B0           2643                        mov          a,p3
0EE6 20E6D4         2644                        jb           acc.6,moutF
0EE9 7713           2645                        mov          @r1,#13h
0EEB 900000   F     2646                        mov          dptr,#teLIST
0EEE 120000   F     2647                        call         lotext
0EF1 020000   F     2648                        jmp          outF
0EF4 B71313         2649     nomem12:         cjne           @r1,#13h,labelL
0EF7 75B0FB         2650                             mov             p3,#0fbh
0EFA E5B0           2651                        mov          a,p3
0EFC 20E6BE         2652                        jb           acc.6,moutF
0EFF 7711           2653                        mov          @r1,#11h
0F01 900000   F     2654                        mov          dptr,#teCLE
0F04 120000   F     2655                        call         lotext
0F07 020000   F     2656                          jmp                outF
                    2657     
0F0A 78B0           2658     labelL:         mov             r0,#level
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    42

0F0C B6211B         2659                             cjne    @r0,#21h,labl21
0F0F 75B0FB         2660                             mov             p3,#0fbh
0F12 E5B0           2661                             mov             a,p3
0F14 20E610         2662                             jb              acc.6,loutF
0F17 B62108         2663                             cjne    @r0,#21h,lal22
0F1A 7622           2664                             mov             @r0,#22h
                    2665                             ;БЛОК
0F1C 120000   F     2666                             call    lotext
0F1F 020000   F     2667                             jmp             outF
0F22 7621           2668     lal22:          mov             @r0,#21h
                    2669                             ;ПОЛНАЯ
0F24 120000   F     2670                             call    lotext
0F27 020000   F     2671     loutf:          jmp             outF
                    2672     
0F2A B6211B         2673     labl21:    cjne @r0,#21h,nolev1
0F2D 75B0FB         2674                             mov             p3,#0fbh
0F30 E5B0           2675                             mov             a,p3
0F32 20E6F2         2676                             jb              acc.6,loutF
0F35 B62108         2677                             cjne    @r0,#21h,labl22
0F38 7622           2678                             mov             @r0,#22h
                    2679                             ;БЛОК
0F3A 120000   F     2680                             call    lotext
0F3D 020000   F     2681                             jmp             outF
0F40 7621           2682     labl22:         mov             @r0,#21h
                    2683                             ;ПОЛНАЯ
0F42 120000   F     2684                             call    lotext
0F45 020000   F     2685                             jmp             outF
                    2686                      
0F48 B62323         2687     nolev1:         cjne    @r0,#23h,go31l
0F4B 75B0FB         2688     rigblo:         mov             p3,#0fbh
0F4E 20B627         2689                             jb              p3.6,llev2
0F51                2690     labL2:    ;  уст курсор в правую позицию 
                    2691                                     ;                               29.12.06
                    2692     ;;;;;;;;;;;;;;;;;;
                    2693     ;необходимо не портить цифру в следуюем справа знакоместе
                    2694     ;т е сохранить ее в ячейке для мигания в противном случае
                    2695     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2696     ;       знакоместа
0F51 78B2           2697                                             mov             r0,#marker
0F53 7440           2698                                     mov             a,#bufind
0F55 26             2699                                             add             a,@r0                   ;a=bufind+m
                             arker
0F56 F9             2700                                             mov             r1,a
0F57 09             2701                                             inc             r1
0F58 873C           2702                                             mov             savba,@r1
                    2703     ;;;;;;;;;;;;;;;;
0F5A 78B2           2704                       mov           r0,#marker      ;курсор справа  ?
0F5C E53B           2705                             mov             a,movrig
0F5E C3             2706                             clr             c
0F5F 96             2707                             subb    a,@r0
0F60 6006           2708                             jz         equ1l
0F62 E53B           2709                             mov             a,movrig;уст в правую позицию
0F64 F6             2710                             mov             @r0,a
0F65 020000   F     2711                             jmp             outF;goto7                                         
                                   
0F68 E53A           2712     equ1l:          mov             a,movleft;уст в левую позицию
0F6A F6             2713                             mov             @r0,a   
0F6B 020000   F     2714                             jmp             outF;goto7
                    2715                     
                    2716     
0F6E B63102         2717     go31l:          cjne    @r0,#31h,go41l
0F71 80D8           2718                             jmp             rigblo
0F73 B6410B         2719     go41l:          cjne    @r0,#41h,norig2
0F76 80D3           2720                             jmp             rigblo
                    2721     
0F78 75B0FD         2722     llev2:          mov             p3,#0fdh
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    43

0F7B 20B6A9         2723                             jb              p3.6,loutF
0F7E 020000   F     2724                             jmp             labelL1
                    2725     
                    2726     ;->
0F81 C3             2727     norig2:    clr          c               ;32,33,34,42
0F82 7431           2728                             mov             a,#31h
0F84 96             2729                             subb    a,@r0
0F85 50A0           2730                             jnc             loutF
0F87 75B0FB         2731     rigblok:        mov             p3,#0fbh  ;32,33,34,42
0F8A 20B626         2732                             jb              p3.6,lev2go
0F8D                2733     labelN: 
                    2734                             ;                               29.12.06
                    2735     ;;;;;;;;;;;;;;;;;;
                    2736     ;необходимо не портить цифру в следуюем справа знакоместе
                    2737     ;т е сохранить ее в ячейке для мигания в противном случае
                    2738     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2739     ;       знакоместа
0F8D 78B2           2740                                             mov             r0,#marker
0F8F 7440           2741                                     mov             a,#bufind
0F91 26             2742                                             add             a,@r0                   ;a=bufind+m
                             arker
0F92 F9             2743                                             mov             r1,a
0F93 09             2744                                             inc             r1
0F94 873C           2745                                             mov             savba,@r1
                    2746     ;;;;;;;;;;;;;;;;;;;
0F96 78B2           2747                             mov             r0,#marker      ;курсор справа  ?
0F98 E53B           2748                             mov             a,movrig
0F9A C3             2749                             clr             c
0F9B 96             2750                             subb    a,@r0
0F9C 7006           2751                             jnz        noequ1
0F9E E53A           2752                             mov             a,movleft;уст в крайнюю левую позицию
0FA0 F6             2753                             mov             @r0,a
0FA1 020000   F     2754                             jmp             outF
0FA4                2755     noequ1: ;29.12.06
                    2756     ;;;;;;;;;;;;;;;;;;
                    2757                             ;восстан знакоместо при мигании
                    2758                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0FA4 78B2           2759                                     mov             r0,#marker
0FA6 7440           2760                                     mov             a,#bufind
0FA8 26             2761                                     add             a,@r0                   ;a=bufind+marker
0FA9 F9             2762                                     mov             r1,a
                    2763                                     ;mov            @r1,savba
0FAA 09             2764                                     inc             r1
0FAB 873C           2765                                     mov             savba,@r1
                    2766     ;;;;;;;;;;;;;;;;        
0FAD 120000   F     2767                             call    marri;уст сдвиг в правую        позицию
0FB0 020000   F     2768                             jmp             outF
0FB3 75B0FD         2769     lev2go:         mov             p3,#0fdh
0FB6 30B603         2770                             jnb             p3.6,rlabelL1
0FB9 020000   F     2771                             jmp             outF
                    2772     
0FBC 020000   F     2773     rlabelL1:       jmp             labelL1
0FBF                2774     nnmemb:
0FBF                2775     norim6:    ;kn menu
0FBF                2776     out6:           
0FBF D007           2777                                     pop             rr7     
0FC1 D006           2778                                     pop             rr6
0FC3 D005           2779                                     pop             rr5
0FC5 D004           2780                                     pop             rr4
0FC7 D003           2781                                     pop             rr3
0FC9 D002           2782                                     pop             rr2
0FCB D001           2783                                     pop             rr1                             
0FCD D000           2784                                     pop             rr0
0FCF D0D0           2785                                     pop             psw
0FD1 D0E0           2786                                     pop             acc
                    2787     ;clr            bitmig
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    44

0FD3 75E730         2788                                mov          EIE2,#30H
0FD6 E5AD           2789                                mov          a,P3IF
0FD8 54BF           2790                                     anl             a,#0bfh
0FDA F5AD           2791                                     mov             P3IF,a
0FDC 75B0C0         2792                                     mov             P3,#0c0h
0FDF C219           2793     clr             bitmig
0FE1 32             2794                             reti
                    2795     
0FE2 020000   F     2796     rknMEM:                 jmp             knMEM
0FE5 020000   F     2797     knKMP:             jmp          out7
0FE8 020000   F     2798     rout7:                  jmp             out7    
0FEB 020000   F     2799     rlabelH:                jmp             labelH
0FEE 020000   F     2800     rknNUL:         jmp             knNUL
0FF1 020000   F     2801     rknleft:                jmp             knleft
0FF4                2802     keyb2:  ;IE7
0FF4 75E700         2803                                     mov             EIE2,#00H
0FF7 C0E0           2804                                     push    acc
0FF9 C0D0           2805                                     push    psw
0FFB C000           2806                                     push    rr0
0FFD C001           2807                                     push    rr1
0FFF C002           2808                                     push    rr2
1001 C003           2809                                     push    rr3
1003 C004           2810                                     push    rr4
1005 C005           2811                                     push    rr5
1007 C006           2812                                     push    rr6
1009 C007           2813                                     push    rr7
100B C082           2814                                     push    dpl
100D C083           2815                                     push    dph
                    2816                                     ;clr            bitmig
                    2817                       ;;;;;;;;;;;;;;
100F 120000   F     2818                               call  z_01s   ;0,1s
                    2819                               ;восстан знакоместо при мигании
                    2820                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
1012 78B2           2821                                     mov             r0,#marker
1014 7440           2822                                     mov             a,#bufind
1016 26             2823                                     add             a,@r0                   ;a=bufind+marker
1017 F9             2824                                     mov             r1,a
1018 A73C           2825                                     mov             @r1,savba
                    2826                                     ;;;;;;;;;;;
                    2827     
101A E5B0           2828                             mov             a,p3
101C 20E7C9         2829                                     jb              acc.7,rout7
101F E5B0           2830                                     mov             a,p3
1021 74FF           2831                                     mov             a,#0ffh         ; p3.(5-0)<-3f
1023 F5B0           2832                                     mov             p3,a
1025 E5B0           2833                                     mov             a,p3
1027 30E7BE         2834                                     jnb             acc.7,rout7             ;error
102A 3004BE         2835                                     jnb             bitizm,rlabelH
102D 75B0FE         2836                                     mov             p3,#0feh                ;реж IZM
1030 E5B0           2837                                     mov             a,p3
1032 30E7B9         2838                                     jnb             acc.7,rknNUL
1035 75B0FD         2839                                     mov             p3,#0fdh
1038 E5B0           2840                                     mov             a,p3
103A 30E7A8         2841                                     jnb             acc.7,knKMP
103D 75B0FB         2842                                     mov             p3,#0fbh
1040 E5B0           2843                                     mov             a,p3
1042 30E7AC         2844                                     jnb             acc.7,rknleft
1045 75B0F7         2845                                     mov             p3,#0f7h
1048 E5B0           2846                                     mov             a,p3
104A 30E752         2847                                     jnb             acc.7,knAVP
104D 75B0EF         2848                                 mov         p3,#0efh
1050 E5B0           2849                                     mov             a,p3
1052 30E78D         2850                                     jnb             acc.7,rknMEM
1055 75B0DF         2851                                     mov             p3,#0dfh
1058 E5B0           2852                                     mov             a,p3    
105A 30E722         2853                                     jnb             acc.7,knmenu
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    45

105D                2854     an_t7:             ;;;;;;;;;;;;
                    2855                     
                    2856     ;       clr             c
                    2857     ;       mov             r1,#parN
                    2858     ;
                    2859     ;                       mov             r0,#diap
                    2860     ;                       mov             a,#6            
                    2861     ;                       subb    a,@r0
                    2862     ;                       jnc             goto7           ;         ;10-2..10-8
                    2863                               
                    2864     ;                       mov             @r1,#2          ;10-9..10-11            
                    2865                             
                    2866                             ;;;;;;;;;;;;
105D 799A           2867     goto7:                  mov             r1,#parT
105F 783D           2868                                     mov             r0,#chkl
1061 B70108         2869                                     cjne    @r1,#1,not1_7
1064 7600           2870                                     mov             @r0,#00
1066 08             2871                                     inc             r0
1067 7602           2872                                     mov             @r0,#2
1069 020000   F     2873                                     jmp             out7
                    2874                             
                    2875     
106C B70208         2876     not1_7:                 cjne    @r1,#2,not2_7
106F 760E           2877                                     mov             @r0,#0eh;00
1071 08             2878                                     inc             r0
1072 7638           2879                                     mov             @r0,#38h;20
1074 020000   F     2880                                     jmp             out7
1077 7600           2881     not2_7:                 mov             @r0,#00
1079 08             2882                                     inc             r0
107A 76C8           2883                                     mov             @r0,#200
107C 020000   F     2884                                     jmp             out7
                    2885     
                    2886     
107F 201511         2887     knmenu: jb              biteizm,menuoff
1082 C204           2888                              clr            bitizm          ;off IZM
1084 D211           2889                                     setb            bitmenu
1086 900000   F     2890                                     mov             dptr,#teTESI    ;в буф2 записать ТЕСТ-ИЗМЕР
1089 120000   F     2891                                     call    lotext
                    2892                                     
108C 78B1           2893                                     mov             r0,#vichR
108E 7611           2894                                     mov             @r0,#11h
1090 020000   F     2895                                     jmp             onmem11
1093                2896     menuoff:
1093 78B1           2897                                     mov             r0,#vichR
1095 7600           2898                                     mov             @r0,#00
1097 C215           2899                                     clr             biteizm
1099 120000   F     2900                                     call    loadus
109C 75EF10         2901                                     mov             RSTSRC,#10h
                    2902                                     ;jmp            begin;onmem11
                    2903     
109F 200505         2904     knAVP:                  jb              bitavp,meavp
10A2 D205           2905                                     setb    bitavp
10A4 020000   F     2906                                     jmp             onmem11
10A7 C205           2907     meavp:                  clr             bitavp
10A9 020000   F     2908                                     jmp             onmem11
                    2909     
10AC 79AE           2910     knleft:            mov          r1,#diap
10AE 07             2911                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
10AF B70A03         2912                                     cjne    @r1,#0ah,nodi6
10B2 17             2913                                     dec             @r1
10B3 80A8           2914                                     jmp             an_t7
                    2915     
10B5                2916     nodi6:             ;    cjne    @r1,#0,an_t7
10B5 120000   F     2917                                      call    clmassix
10B8 78B3           2918                                     mov             r0,#summa
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    46

10BA 120000   F     2919                                     call    clear4  
10BD 786A           2920                                     mov             r0,#rez_A0
10BF 120000   F     2921                                     call    clear4  
10C2 120000   F     2922                                     call    loadUS
10C5 8096           2923                                jmp          an_t7
                    2924     
10C7 200F0E         2925     knNUL:                  jb              bitnul,ybnul
10CA D20F           2926                                     setb    bitnul
10CC 789C           2927                                     mov             r0,#rez_A3      ;A3
10CE 120000   F     2928                                     call    resar2
10D1 786A           2929                                     mov             r0,#rez_A0      
10D3 120000   F     2930                                     call    saver2;A0<-A3
10D6 8085           2931                                     jmp             goto7;an_t7
                    2932     
10D8 C20F           2933     ybnul:                  clr             bitnul
10DA 900000   F     2934                                      mov    DPTR,#ch0 
10DD 120000   F     2935                                     CALL   ldc_long          ; r2..r5 <-- 0
10E0 786A           2936                                     mov             r0,#rez_A0      ;A0=0
10E2 120000   F     2937                                     call    saver2
10E5 020000   F     2938                                     jmp             goto7;an_t7
                    2939     
10E8 30101E         2940     labelH:                 jnb             bitt2,nolah
10EB 75B0FB         2941                                     mov             p3,#0fbh   ;вход в режим изм Т
10EE 79B7           2942                                     mov             r1,#load;parT
10F0 20B70D         2943                                     jb              p3.7,rhnot1
10F3 B70003         2944                                     cjne    @r1,#0,inct;
10F6 020000   F     2945                                     jmp             out7;hyest6
10F9 17             2946     inct:                   dec             @r1                     ;Tизм+1
                    2947                             
10FA 120000   F     2948                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
10FD                2949     hnot2:          ;       call    ind
10FD 020000   F     2950                                     jmp             out7
                    2951     
1100 020000   F     2952      rhnot1:                jmp             hnot1
                    2953      ;rnoviR:       jmp             noviR
1103 020000   F     2954      rlabelK:       jmp             labelK
1106 020000   F     2955      rlabelI:       jmp             labelI          
                    2956      ;;;;;;;;;;;;;;;;;;;
1109 3014F7         2957     nolah:          jnb             bitvich,rlabelK 
                    2958                             ;;;;;;
                    2959                             ;увеличить счетчик задержки клавиатуры
                    2960                     ;;              mov             r0,#chkl
                    2961                     ;;              mov             @r0,#27h
                    2962                     ;;              inc             r0
                    2963                     ;;              mov             @r0,#10h
                    2964                             ;;;;;;
                    2965     
110C 78B1           2966                             mov             r0,#vichR
110E B61128         2967                             cjne    @r0,#11h,rhnor11;rlabelI;;
1111 75B0FB         2968                             mov             p3,#0fbh   ;<-
1114 20B728         2969                             jb              p3.7,noh37;routF
1117 B6110B         2970                     cjne    @r0,#11h,hr12
111A 7613           2971                             mov             @r0,#13h        ;11= вычислить
111C 900000   F     2972                             mov             dptr,#teOUT;teVICH
111F 120000   F     2973     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
1122 020000   F     2974                             jmp             goto7;outF
1125 B61207         2975     hr12:           cjne    @r0,#12h,hnor12
1128 7611           2976     lovich:         mov             @r0,#11h
112A 900000   F     2977                             mov             dptr,#teVICH
112D 80F0           2978                             jmp             hvi1113         
112F B61307         2979     hnor12:         cjne    @r0,#13h,rhnor11
1132 7612           2980     loizmk:         mov             @r0,#12h
1134 900000   F     2981                             mov             dptr,#teIZMK    ;       изм конст
                    2982                                        
1137 80E6           2983                             jmp             hvi1113
                    2984     
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    47

1139 803E           2985     rhnor11:                jmp             hnor11
                    2986     
113B 8049           2987     rvvizko:                jmp             vvizko
113D 80FE           2988     toutF:                  jmp     toutF
                    2989     
113F 75B0F7         2990     noh37:          mov             p3,#0f7h
1142 20B7F8         2991                             jb              p3.7,toutF
1145 B611F3         2992                             cjne    @r0,#11h,rvvizko
1148 D206           2993                             setb    bitvi11    ;нажат ввод ВЫЧИСЛИТЬ
114A D204           2994              setb   bitizm
114C 020000   F     2995     routF:          jmp             goto7;outF
                    2996     
                    2997     
                    2998     
114F 80EE           2999     rnoh37:         jmp             noh37
                    3000     
1151 B6120D         3001     norr11:         cjne    @r0,#12h,norr12
1154 75B0FB         3002                             mov             p3,#0fbh   ;<-
1157 20B7F5         3003                             jb              p3.7,rnoh37;routF
115A 760B           3004                             mov             @r0,#11;12->11
115C 80CA           3005                             jmp             lovich
                    3006     
115E 020000   F     3007     labelI2:                jmp             labelI
1161 B613FA         3008     norr12:         cjne    @r0,#13h,labelI2
1164 75B0FB         3009                             mov             p3,#0fbh   ;<-
1167 20B7E5         3010                             jb              p3.7,rnoh37
116A 7612           3011                             mov             @r0,#12h
116C 80C4           3012                             jmp             loizmk
                    3013                             ;;;;
116E C214           3014     clrvich:                clr             bitvich
1170 D204           3015                             setb    bitizm
1172 A8B2           3016                             mov             r0,marker
1174 76FF           3017                             mov             @r0,#0ffh
1176 020000   F     3018                              jmp    goto7;  routF
                    3019     
                    3020     ;rnoh37:                jmp             noh37
                    3021      ;ввод изм конст
1179 B612E5         3022     hnor11:         cjne    @r0,#12h,norr12;clrvich
117C 75B0FB         3023                              mov            p3,#0fbh   
117F 20B7CD         3024                             jb              p3.7,rnoh37;lovich;;изм конст <-  выч
1182 7611           3025                             mov             @r0,#11h
1184 80A2           3026                             jmp             lovich
                    3027     
1186 78B1           3028     vvizko:         mov             r0,#vichR
1188 E6             3029                             mov             a,@r0
                    3030                     ;       cjne    @r0,#12h,clrvich
1189 B412E2         3031                             cjne    a,#12h,clrvich
118C 7621           3032                             mov             @r0,#21h                ;изм конст->a=+0000     (vv
                             od)
118E 78B2           3033                             mov             r0,#marker
1190 7604           3034                             mov             @r0,#4;9
1192 753A04         3035                             mov             movleft,#4
1195 753B07         3036                             mov             movrig,#7
1198 900000   F     3037                             mov             dptr,#teAequ0
119B 120000   F     3038                             call    lotext
                    3039                             
119E 120000   F     3040                             call    outA
11A1 434B08         3041                             orl             bufind+11,#08h;бит точки после 7 знакоместа(a=000.0
                              v)
                    3042                             
11A4 020000   F     3043                             jmp             goto7;routF
                    3044     ;hnor13:                jmp             hnor12          
11A7 B6210C         3045     izchi:          cjne    @r0,#21h,tlabelI
                    3046     ;<- при вводе цифр А                            
                    3047                     ;        mov            p3,#0fbh   
                    3048                     ;       jnb             p3.7,li21
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    48

                    3049             ;clr            bitmig
11AA 78B2           3050                             mov             r0,#marker
11AC 16             3051                             dec             @r0
11AD B60201         3052                             cjne    @r0,#2,li21
11B0 06             3053                             inc             @r0;marker=3 +/-
11B1 C219           3054     li21:           clr             bitmig
11B3 020000   F     3055                             jmp             goto7;outF
                    3056     
11B6 020000   F     3057     tlabelI:        jmp             labelI
                    3058     
                    3059     ;                       load    0 1 2 3 4 5             
11B9 06050403       3060     sootv:          db              6,5,4,3,2,1;parT
11BD 0201                    
                    3061     ;
                    3062     
                    3063     ;нажата кн ввод при наборе Т
11BF 75B0F7         3064     hnot1:                  mov             p3,#0f7h
11C2 20B787         3065                                     jb              p3.7,routF;out7
11C5 B70541         3066                                     cjne    @r1,#5,nohnot1  ;r1=load
11C8 794A           3067                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
11CA E7             3068                                     mov             a,@r1
11CB 4440           3069                                     orl             a,#40h;.6
11CD F7             3070                                     mov             @r1,a
11CE 8000           3071                                     jmp             loadb
                    3072                                     
                    3073                                     
11D0 789A           3074     loadB:                  mov             r0,#parT
11D2 900000   F     3075                                     mov             dptr,#sootv
11D5 79B7           3076                                     mov             r1,#load                
11D7 E7             3077                                     mov             a,@r1;load
11D8 93             3078                                     movc    a,@a+dptr
11D9 F6             3079                                     mov             @r0,a
11DA 120000   F     3080                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    3081                                      ;r4=b1 r5=b2
11DD 120000   F     3082                                     call    iniacp;инициализация АЦП
11E0 120000   F     3083                                     call    loadUS
11E3 120000   F     3084                                     call    clmassix        
11E6 D204           3085                                     setb    bitizm
11E8 C210           3086                                     clr             bitt2
11EA C3             3087                                      clr            c
11EB 789A           3088                                  mov                r0,#parT
11ED 79AF           3089                                      mov            r1,#parN
11EF 7402           3090                                  mov                a,#2
11F1 96             3091                                 subb                a,@r0
11F2 5005           3092                                 jnc                 loadB2
11F4 7701           3093                                     mov             @r1,#1;N=1         ;T>=2
11F6 020000   F     3094     bout7:                  jmp             goto7;out7
                    3095     
11F9 B702FA         3096     loadB2:                 cjne    @r1,#2,bout7
11FC 7702           3097                                     mov             @r1,#2;N=2
11FE 020000   F     3098                                     jmp             goto7;out7
1201                3099     nohnot2:                ;в буфере 1 зажечь <=0,1s
1201 794A           3100                                     mov             r1,#bufind+10
1203 E7             3101                                     mov             a,@r1
1204 4410           3102                                     orl             a,#10h;.4
1206 F7             3103                                     mov             @r1,a
1207 80C7           3104                                     jmp             loadB
1209 B704F5         3105     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
120C 794A           3106                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
120E E7             3107                                     mov             a,@r1
120F 4420           3108                                     orl             a,#20h;.5
1211 F7             3109                                     mov             @r1,a
1212 80BC           3110                                     jmp             loadB
                    3111     
                    3112     ;кнопка ПАМЯТЬ
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    49

1214 C204           3113     knMEM:                  clr             bitizm          ;off IZM
1216 900000   F     3114                                     mov             dptr,#teCLE
1219 120000   F     3115                                     call    lotext    ;в буф2 записать ОЧИСТКА
121C D20B           3116                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
121E 78B0           3117                                     mov             r0,#level
1220 7611           3118                                     mov             @r0,#11h
1222 783D           3119     onmem11:                mov             r0,#chkl
1224 7603           3120                                     mov             @r0,#03
1226 08             3121                                     inc             r0
1227 76E8           3122                                     mov             @r0,#0e8h               ;1000
1229 020000   F     3123                                     jmp             out7;goto7;out7
                    3124     
122C 020000   F     3125     rnomemk:                jmp             nomemk          ;
122F                3126     labelK:
                    3127     ;;;;;;;;;;;;
                    3128     ;                               jnb             bitmenu,nomenu
                    3129     ;                               mov             p3,#0fbh
                    3130     ;                               mov             r1,#level
                    3131     ;                               jb              p3.7,vvmenu
                    3132                     
                    3133     
                    3134     ;nomenu:                        mov             p3,#0f7h;0efh;0f7h;vvod
                    3135     ;                               jb              p3.7,novvmn
                    3136     ;vvmenu:;ввод меню  (тест-калибровка)
                    3137     ;                               mov             dptr,#teTEST;тест
                    3138     ;                               call    lotext
                    3139     ;                               mov             @r1,#2
                    3140     ;                               jmp             out7
                    3141     ;novvmn:                        mov             p3,#0efh
                    3142     ;                               jb              p3.7,rimenu
                    3143                             
                    3144     ;                               jmp             out7
                    3145     
                    3146      ;rimenu:
                    3147     ;;;;;;;;;;;;
122F 300BFA         3148                               jnb           bitmem,rnomemk
1232 78B0           3149                               mov           r0,#level
1234 B61132         3150                               cjne          @r0,#11h,klev1;nome11
1237 75B0FB         3151     lefmem11:         mov           p3,#0fbh
123A E5B0           3152                               mov           a,p3
123C 20E70E         3153                               jb            acc.7,rkvvod0
123F B6110E         3154                               cjne          @r0,#11h,locle          ;<-memory
1242 7613           3155                               mov           @r0,#13h
1244 900000   F     3156     lolist:           mov           dptr,#teLIST
1247 120000   F     3157                               call          lotext           ;ПРОСМОТР
124A 020000   F     3158                               jmp   goto7;  outF
                    3159     
124D 020000   F     3160     rkvvod0:        jmp             kvvod0
                    3161     
                    3162     
1250 B6120B         3163     locle:          cjne            @r0,#12h,lowr           ;<-memory
1253 7611           3164                               mov           @r0,#11h                   ;ОЧИСТКА
1255 900000   F     3165     loadcle:          mov           dptr,#teCLE
1258 120000   F     3166                               call          lotext
125B 020000   F     3167                               jmp           goto7;outF
125E 7612           3168      lowr:          mov             @r0,#12h
1260 900000   F     3169      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
1263 120000   F     3170                             call    lotext
1266 020000   F     3171                             jmp             goto7;outF
1269 B61202         3172      klev1:          cjne   @r0,#12h,klev2
126C 80C9           3173                             jmp             lefmem11
126E B61302         3174     klev2:           cjne   @r0,#13h,klev22   ;11-13 нет
1271 80C4           3175                             jmp             lefmem11
                    3176     
                    3177     ;<- vvod на более низких уровнях
1273 B62114         3178     klev22:         cjne    @r0,#21h,klev21
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    50

1276 75B0FB         3179     lev220:         mov             p3,#0fbh
1279 20B72F         3180                             jb              p3.7,kgo23
127C B62146         3181                             cjne    @r0,#21h,kfull
127F 7622           3182                             mov             @r0,#22h
1281 900000   F     3183                             mov             dptr,#teBL
1284 120000   F     3184                             call    lotext
1287 020000   F     3185                             jmp             goto7;outF
                    3186                                     
128A B62208         3187     klev21:         cjne    @r0,#22h,klev23
128D 80E7           3188                             jmp             lev220
                    3189     
128F 020000   F     3190     rlabL2:         jmp             labL2
1292 020000   F     3191     rlabM:          jmp             labM
                    3192     
1295 B623FA         3193     klev23:          cjne   @r0,#23h,rlabM
1298 75B0FB         3194                              mov    p3,#0fbh
129B 20B7F1         3195                              jb             p3.7,rlabL2
129E 75B0F7         3196                              mov    p3,#0f7h
12A1 20B74F         3197                              jb             p3.7,ddoutf
                    3198                              ;очистить блок памяти с набранным номером
12A4 C20B           3199                              clr    bitmem  ;сбр признак памяти 
12A6 D204           3200                              setb   bitizm
12A8 020000   F     3201                              jmp    goto7;outF
                    3202                             
12AB 75B0F7         3203     kgo23:           mov    p3,#0f7h
12AE 20B742         3204                             jb              p3.7,ddoutf
12B1 B62107         3205                             cjne    @r0,#21h,go23no
                    3206                             ;очистить память
12B4 C20B           3207                             clr             bitmem
12B6 D204           3208                             setb    bitizm
12B8 020000   F     3209                             jmp             goto7;outF
                    3210     
12BB 7623           3211     go23no:    mov          @r0,#23h
12BD 753B08         3212                                             mov                     movrig,#8
12C0 753A07         3213                                             mov             movleft,#7
12C3 8038           3214                             jmp             loblok;БЛОК 00
                    3215     
12C5 7621           3216     kfull:          mov             @r0,#21h
12C7 8024           3217                             jmp             gofull
                    3218                             
                    3219                                             
12C9 020000   F     3220     nomemk:         jmp             labelS                  ;нажат ввод меню
                    3221                             
12CC 75B0FB         3222     nome11:           mov           p3,#0fbh
12CF E5B0           3223                               mov           a,p3
12D1 20E70C         3224                               jb            acc.7,kvvod0
12D4 B61205         3225                               cjne          @r0,#12h,mem12no        
12D7 7611           3226                               mov           @r0,#11h                ;ОЧИСТКА
12D9 020000   F     3227                               jmp            loadcle
                    3228     
12DC                3229     mem12no:        ;cjne           @r0,#13h,lowr           
12DC 7612           3230                               mov           @r0,#12h                   ;
12DE 8080           3231                               jmp           lowr1                     ;ЗАПИСЬ
                    3232     
12E0 75B0F7         3233     kvvod0:           mov           p3,#0f7h
12E3 20B70D         3234                               jb            p3.7,ddoutf
12E6 78B0           3235                               mov           r0,#level
12E8 B6110D         3236                               cjne          @r0,#11h,mvv11
12EB 7621           3237                               mov           @r0,#21h                ;ПОЛНАЯ
12ED 900000   F     3238     gofull:           mov           dptr,#teFULL
12F0 120000   F     3239                               call          lotext
12F3 801F           3240     ddoutf:         jmp             mlabL2  ;<-
                    3241     
12F5 020000   F     3242     jmp             goto7
                    3243     
12F8 B61215         3244     mvv11:            cjne          @r0,#12h,mvv12
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    51

12FB 7631           3245                                     mov             @r0,#31h
12FD 900000   F     3246     loblok:                 mov             dptr,#teBLOK;БЛОК 00
1300 120000   F     3247                                     call    lotext
1303 78B2           3248                                     mov             r0,#marker
1305 7607           3249                                     mov             @r0,#7
1307 753B08         3250                                     mov             movrig,#8
130A 753A07         3251                                     mov             movleft,#7
130D 020000   F     3252                                     jmp             goto7;outF
1310 7641           3253     mvv12:                  mov             @r0,#41h                ; БЛОК 00
1312 80E9           3254                                     jmp             loblok
                    3255     
                    3256     
                    3257     
1314                3258     mlabL2:         ;jmp            labL2
                    3259                                             ;  уст курсор в правую позицию 
                    3260                                     ;                               29.12.06
                    3261     ;;;;;;;;;;;;;;;;;;
                    3262     ;необходимо не портить цифру в следуюем справа знакоместе
                    3263     ;т е сохранить ее в ячейке для мигания в противном случае
                    3264     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3265     ;       знакоместа
1314 78B2           3266                                             mov             r0,#marker
1316 7440           3267                                     mov             a,#bufind
1318 26             3268                                             add             a,@r0                   ;a=bufind+m
                             arker
1319 F9             3269                                             mov             r1,a
131A 09             3270                                             inc             r1
131B 873C           3271                                             mov             savba,@r1
                    3272     ;;;;;;;;;;;;;;;;
131D 78B2           3273                       mov           r0,#marker      ;курсор справа  ?
131F E53B           3274                             mov             a,movrig
1321 C3             3275                             clr             c
1322 96             3276                             subb    a,@r0
1323 6006           3277                             jz         equ2l
1325 E53B           3278                             mov             a,movrig;уст в правую позицию
1327 F6             3279                             mov             @r0,a
                    3280     ;                       lool
1328 020000   F     3281                             jmp             goto7                                            
132B E53A           3282     equ2l:          mov             a,movleft;уст в левую позицию
132D F6             3283                             mov             @r0,a   
132E 020000   F     3284                             jmp             goto7
                    3285                     
                    3286     
1331 B63137         3287     labM:                   cjne    @r0,#31h,nom31
1334 75B0FB         3288                                     mov             p3,#0fbh
1337 30B7DA         3289                                     jnb             p3.7,mlabL2
133A 75B0F7         3290                                mov          p3,#0f7h
133D 20B7B3         3291                                jb           p3.7,ddoutf
                    3292                                
1340 7632           3293                                mov          @r0,#32h
                    3294                                     ;       считать с индикатора  
1342 7F0A           3295                                     mov             r7,#10
1344 7853           3296                                     mov             r0,#adec
1346 120000   F     3297                                     call    clearN
1349 120000   F     3298                                     call    upak2                   
134C 784F           3299                                     mov             r0,#abin
134E 7953           3300                                     mov             r1,#adec                        ;мл        
                              ст
1350 120000   F     3301                                     call    decbin                  ;abin..abin+3 (hex)
                    3302                                     ;call   loadr2                  ;r2..r5
                    3303                                     ;call   altof                   ;r2..r5->int
1353 78C4           3304                                mov          r0,#nblok       ;   сохранить
1355 E54F           3305                                mov          a,abin          ;;мл
1357 F6             3306                                mov          @r0,a
1358 900000   F     3307                                mov          dptr,#tebBL;НАЧ БЛОК 000
135B 120000   F     3308                                call         lotext
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    52

135E 78B2           3309                                mov          r0,#marker
1360 7607           3310                                mov          @r0,#7
1362 753B09         3311                                mov          movrig,#9
1365 753A07         3312                                mov          movleft,#7
1368 020000   F     3313     rgoto7:            jmp     goto7;outF
                    3314     
136B B6324C         3315     nom31:             cjne         @r0,#32h,nom32
136E 75B0FB         3316                                     mov             p3,#0fbh
1371 20B714         3317                                     jb              p3.7,no31n
                    3318                                     
1374 78B2           3319     lefcur:         mov             r0,#marker      ;курсор слева?
1376 E53A           3320                             mov             a,movleft
1378 C3             3321                             clr             c
1379 96             3322                             subb    a,@r0
137A 7006           3323                             jnz        noequ2
137C E53B           3324                             mov             a,movrig
137E F6             3325                             mov             @r0,a;уст в крайнюю правую позицию
137F 020000   F     3326                             jmp             goto7
1382 120000   F     3327     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
1385 020000   F     3328                             jmp        goto7
                    3329                                     
1388 75B0F7         3330     no31n:             mov          p3,#0f7h
138B 20B7DA         3331                                     jb              p3.7,rgoto7
138E 7633           3332                                     mov             @r0,#33h
                    3333                                     ;запомнить номер ячейки блока
1390 7F0A           3334                                             mov             r7,#10
1392 7853           3335                                     mov             r0,#adec
1394 120000   F     3336                                     call    clearN
1397 120000   F     3337                                     call    upak3                   
139A 784F           3338                                     mov             r0,#abin
139C 7953           3339                                     mov             r1,#adec                        ;мл        
                              ст
139E 120000   F     3340                                     call    decbin                  ;abin..abin+3 (hex)
13A1 120000   F     3341                                     call    loadr2                  ;r2..r5
13A4 120402         3342                                     call    altof                   ;r2..r5->int
                    3343     
13A7 900000   F     3344                                      mov            dptr,#teeBL;КОН БЛОК 000
13AA 120000   F     3345                                call         lotext
13AD 78B2           3346                                mov          r0,#marker
13AF 7607           3347                                mov          @r0,#7
13B1 753B09         3348                                mov          movrig,#9
13B4 753A07         3349                                mov          movleft,#7
13B7 020000   F     3350                                jmp     goto7;
                    3351     
                    3352     
13BA B63328         3353     nom32:           cjne           @r0,#33h,nom33
13BD 75B0FB         3354                              mov            p3,#0fbh
13C0 30B7B1         3355                              jnb            p3.7,lefcur
13C3 75B0F7         3356                              mov            p3,#0f7h
13C6 20B79F         3357                              jb             p3.7,rgoto7
                    3358                              ;запомнить номер ячейки конца блока
13C9 7634           3359                              mov    @r0,#34h
13CB 7F0A           3360     INTn:                   mov             r7,#10
13CD 7853           3361                                     mov             r0,#adec
13CF 120000   F     3362                                     call    clearN
13D2 120000   F     3363                                     call    upak3                   
13D5 784F           3364                                     mov             r0,#abin
13D7 7953           3365                                     mov             r1,#adec                        ;мл        
                              ст
13D9 120000   F     3366                                     call    decbin                  ;abin..abin+3 (hex)
13DC 120000   F     3367                                     call    loadr2                  ;r2..r5
13DF 120402         3368                                     call    altof                   ;r2..r5->int
13E2 020000   F     3369     dgoto7:                  jmp            goto7
                    3370     
13E5 B63443         3371     nom33:          cjne            @r0,#34h,labelP
13E8 75B0FB         3372                               mov           p3,#0fbh
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    53

13EB 30B786         3373                              jnb            p3.7,lefcur
13EE 75B0F7         3374                              mov            p3,#0f7h
13F1 20B7EE         3375                              jb             p3.7,dgoto7
13F4 76FF           3376                              mov            @r0,#0ffh
                    3377                              ;T1<-число на индикаторе
13F6 C20B           3378                              clr            bitmem            ;vvod КОН БЛ 000
13F8 D204           3379                              setb           bitizm
                    3380                                     
13FA 020000   F     3381                             jmp        goto7
                    3382     
                    3383     ;обработка кнопки меню ввод
13FD 30112B         3384     labelS:         jnb                     bitmenu,labelP
1400 78B1           3385                                             mov                     r0,#vichR
1402 7415           3386                                             mov                     a,#15h
1404 C3             3387                                             clr                     c
1405 96             3388                                             subb            a,@r0
1406 4021           3389                                             jc                      rme21_23
                    3390                             
1408 75B0FB         3391                                             mov                     p3,#0fbh
140B 20B727         3392                                             jb                      p3.7,vvodm11_15
140E 78B1           3393                                             mov                     r0,#vichR
1410 B61138         3394                                             cjne                    @r0,#11h,me11_15dec;<-
1413 7615           3395                                             mov                     @r0,#15h
1415 900000   F     3396                                             mov                     dptr,#teKALIB
1418 120000   F     3397                                             call            lotext
141B 020000   F     3398                                             jmp                     onmem11
141E C211           3399     menuon:         clr             bitmenu                 ;off menu
1420 D204           3400                                             setb    bitizm
                    3401     
1422 78B1           3402                                     mov             r0,#vichR
1424 7600           3403                                     mov             @r0,#0
1426 020000   F     3404                                     jmp             onmem11
                    3405     
                    3406                                             ;;;;;
                    3407             
1429 8079           3408     rme21_23:               jmp             me21_23                         
                    3409     
142B                3410     labelP:
142B 783D           3411     label7: mov             r0,#chkl
142D 7604           3412                                     mov             @r0,#04;3
142F 08             3413                                     inc             r0
1430 76E8           3414                                     mov             @r0,#0e8h               ;1000
1432 020000   F     3415                                     jmp             out7;
                    3416     
1435 78B1           3417     vvodm11_15:     mov                     r0,#vichR;vvod
1437 75B0F7         3418                                                     mov                     p3,#0f7h
143A 20B7EE         3419                                             jb                      p3.7,LABELP;????
                    3420                                     
                    3421     
143D B61112         3422                                             cjne                    @r0,#11h,tome21
1440 7621           3423                                             mov                     @r0,#21h;vvod
1442 900000   F     3424                                             mov                     dptr,#teTE11
1445 120000   F     3425                                             call            lotext
1448 020000   F     3426                                             jmp                     onmem11
                    3427     
144B 16             3428     me11_15dec:             dec             @r0                             ;<-
144C 120000   F     3429     lokame1:        call            lomenu
144F 020000   F     3430                                             jmp                     onmem11
                    3431     
1452 B61203         3432     tome21:         cjne                    @r0,#12h,tome13
                    3433                                             ;вкл тест интерфейса
1455 020000   F     3434                                             jmp                     onmem11
                    3435     
1458 B61324         3436     tome13:         cjne                    @r0,#13h,tome14
145B 7631           3437                                             mov                     @r0,#31h
                    3438                                             
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    54

145D 7A50           3439                                             mov                     r2,#50h                    
                                  ;57.6->19.2
145F 7B2C           3440                                             mov                     r3,#2ch
1461 120454         3441                                             call            re4byte                 ;28..2bh 3b
                             ait-parol,1 bait skor
1464 E50B           3442                                             mov                     a,r11
1466 B4000B         3443                                             cjne            a,#00,skor19
1469 900000   F     3444                                             mov                     dptr,#teS57_6;57,6
146C 120000   F     3445                                             call            lotext
146F C213           3446                                             clr                     bitv19
1471 020000   F     3447                                             jmp             onmem11
1474 900000   F     3448     skor19:         mov                     dptr,#teS19_2
1477 120000   F     3449                                             call            lotext
147A D213           3450                                             setb            bitv19
147C 020000   F     3451                                             jmp                     onmem11
                    3452                                             
                    3453     
147F B6140E         3454     tome14:         cjne                    @r0,#14h,tome15
1482 D204           3455                                             setb            bitizm
1484 7881           3456                                             mov                     r0,#chavt
1486 7600           3457                                             mov                     @r0,#0
1488 08             3458                                             inc                     r0
1489 7600           3459                                             mov                     @r0,#0
148B C211           3460     outmenu:        clr                     bitmenu
148D 020000   F     3461                                             jmp                     out7
                    3462     
1490 7641           3463     tome15:         mov                     @r0,#41h
1492 120000   F     3464                                             call            lomenu
1495 78B2           3465                                             mov                     r0,#marker
1497 7607           3466                                             mov                     @r0,#7
1499 753B09         3467                                             mov                     movrig,#9
149C 753A07         3468                                             mov                     movleft,#7
149F D204           3469                                             setb            bitizm
14A1 020000   F     3470                                             jmp                     onmem11
                    3471     
                    3472     
14A4 78B1           3473     me21_23:        mov                     r0,#vichR               ;<-
14A6 7423           3474                                             mov                     a,#23h
14A8 C3             3475                                             clr                     c
14A9 96             3476                                             subb            a,@r0
14AA 403A           3477                                             jc                      labelS1
14AC 75B0FB         3478                                             mov                     p3,#0fbh
14AF 20B718         3479                                             jb                      p3.7,vv21_23
14B2 B6210B         3480                                             cjne            @r0,#21h,me21_23dec;-<
14B5 7623           3481                                             mov                     @r0,#23h
14B7 900000   F     3482                                             mov                     dptr,#teTE7
14BA 120000   F     3483                                             call            lotext
14BD 020000   F     3484                                             jmp                     onmem11
14C0                3485     me21_23dec:     
14C0 16             3486                                             dec                     @r0
14C1 120000   F     3487                                             call            lomenu
14C4 020000   F     3488                                             jmp                     onmem11
14C7 020000   F     3489     onmem12:        jmp             outF    ;(ie7)                          
                    3490                                                     
14CA 75B0F7         3491     vv21_23:        mov             p3,#0f7h                ;vvod
14CD 20B7F7         3492                                             jb              p3.7,onmem12
14D0 B6210C         3493                                             cjne            @r0,#21h,test22
                    3494                                             ;mov                    dptr,#tabt11;заслать ус 11А
14D3 120000   F     3495     tests:          call            lotpus
14D6 D215           3496                                             setb            biteizm;запомнить режим ТИ
14D8 D204           3497                                             setb            bitizm
14DA C211           3498                                             clr                     bitmenu;обнулить т к не буд
                             ет индикации измерения       
14DC 020000   F     3499                                             jmp                     onmem11
14DF B62202         3500     test22:         cjne            @r0,#22h,test23
                    3501                                     ;       mov                     dptr,#tabt9;заслать ус 9А
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    55

14E2 80EF           3502                                             jmp             tests   
14E4                3503     test23:
                    3504                                     ;       mov                     dptr,#tabt7;заслать ус 7А
14E4 80ED           3505                                             jmp             tests   
                    3506     
14E6 B63138         3507     labelS1:        cjne            @r0,#31h,me_41
14E9 75B0FB         3508                                             mov                     p3,#0fbh                   
                                  ;<-
14EC 30B744         3509                                             jnb                     p3.7,left_sk
14EF 75B0F7         3510                                             mov                     p3,#0f7h
14F2 20B7D2         3511                                             jb                      p3.7,onmem12
                    3512                                             ;запомнить признак установленной скорости в рпзу
                    3513     
                    3514     ;чтение пам прогр(5000h) 1 страница(ffh)
                    3515     ;и запись во внешнее озу(0000h)
14F5 7900           3516                                             mov             r1,#0                   ;
14F7 7A50           3517                                     mov             r2,#50h
14F9 7B00           3518                                     mov             r3,#00
14FB 120499         3519                                     call    copyPP
                    3520                                     ;внести изменения во внешн озу
                    3521                                     ;KD=00 01 86 A0 (KD=1)
                    3522                                     ;кофф *100000 и переведенный в hex формат
                    3523                                     ;согласно адресов диапазонов и адресов яч вн озу 
14FE 792C           3524                                     mov             r1,#2ch
1500 7400           3525                                     mov             a,#0;57,6
1502 301302         3526                                     jnb             bitv19,spwri
1505 7401           3527                                     mov             a,#1;19.6
1507 F3             3528     spwri:  movx    @r1,a
                    3529     ;стереть страницу пап прогр 
1508 905000         3530                                     mov             dptr,#5000h
150B 7FFF           3531                                     mov             r7,#0ffh
150D 12043E         3532                                     call    cle256
                    3533     ;и запись в ячейки кофф памяти прогр (3000h) 
1510 7FFF           3534                                     mov             r7,#0ffh
1512 7900           3535                                     mov             r1,#0                           ;external r
                             am
1514 905000         3536                                     mov             dptr,#5000h
1517 120480         3537                                     call    wrpage
                    3538     
                    3539                                             ;загр Т1 в соотв с установленной скоростью
151A C211           3540                                             clr             bitmenu
151C D204           3541                                             setb            bitizm
151E 020000   F     3542                                             jmp                     out7
                    3543     
1521 B6412D         3544     me_41:          cjne            @r0,#41h,labels4
1524 75B0FB         3545                                             mov             p3,#0fbh;<-
1527 30B722         3546                                             jnb             p3.7,rlabelS3
152A 75B0F7         3547                                             mov             p3,#0f7h
152D 20B797         3548                                             jb              p3.7,onmem12
                    3549                                             ;сравнить пароль с индикатором
                    3550                                             ;равны?
                    3551                                             ;режим меню 42
                    3552                                             ;0000-n
1530 020000   F     3553                                             jmp             outF
1533 30130B         3554     left_sk:                jnb                     bitv19,tosk19;<-
1536 900000   F     3555                                             mov                     dptr,#teS57_6;57,6
1539 120000   F     3556                                             call            lotext
153C C213           3557                                             clr                     bitv19
153E 020000   F     3558                                             jmp             out7
1541 900000   F     3559     tosk19:         mov                     dptr,#teS19_2
1544 120000   F     3560                                             call            lotext
1547 D213           3561                                             setb            bitv19
1549 020000   F     3562                                             jmp             out7
                    3563     
                    3564     
                    3565     
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    56

                    3566     
154C 802F           3567     rlabelS3:       jmp             labelS3
154E 020000   F     3568     onmem13:        jmp             outF    ;(ie7)
                    3569     
1551 B642FA         3570     labels4:        cjne            @r0,#42h,onmem13
1554 75B0FB         3571                                             mov                     p3,#0fbh;<-
1557 30B7F2         3572                                             jnb             p3.7,rlabelS3
155A 75B0F7         3573                                             mov             p3,#0f7h;vvod
155D 20B7EE         3574                                             jb              p3.7,onmem13
                    3575                                             ;число на индикаторе ->Ak
1560 D212           3576                                             setb            bitklb
                    3577                                             ;зажечь KMП
1562 D204           3578                                             setb            bitizm
1564 020000   F     3579                                             jmp                     outmenu
                    3580             
1567 020000   F     3581     jmp             out7                                                    
                    3582     ;;;;;;;
156A                3583     labelI:
156A 75B0FE         3584                                     mov             p3,#0feh
156D E5B0           3585                                     mov             a,p3
156F 20E703         3586                                     jb              acc.7,nopoint
                    3587                                     ;
1572 020000   F     3588                                     jmp             goto7;out7
                    3589     
1575 75B0FB         3590     nopoint:                mov             p3,#0fbh
1578 E5B0           3591                                     mov             a,p3
157A 20E72C         3592                                     jb              acc.7,nopoin7
157D 78B2           3593     labelS3:mov             r0,#marker
157F E53A           3594                                     mov             a,movleft
1581 B40309         3595                                     cjne    a,#3,poina1
1584 B6030B         3596                                     cjne    @r0,#3,nomarl;26
                    3597                                     ;mov            @r0,#9
1587 E53B           3598     poina2: mov                     a,movrig                ;кн <- B=+00000
1589 F6             3599                                     mov                     @r0,a
158A 020000   F     3600                                     jmp             goto7;  out7
                    3601     
158D B60402         3602     poina1:         cjne    @r0,#4,nomarl;кн <- A= 0000
1590 80F5           3603                                             jmp             poina2
                    3604     
                    3605     
1592                3606     nomarl:                 ;                               29.12.06
                    3607     ;;;;;;;;;;;;;;;;;;
                    3608     ;необходимо не портить цифру в следуюем справа знакоместе
                    3609     ;т е сохранить ее в ячейке для мигания в противном случае
                    3610     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3611     ;       знакоместа
1592 78B2           3612                                     mov             r0,#marker
1594 7440           3613                                     mov             a,#bufind
1596 26             3614                                             add             a,@r0                   ;a=bufind+m
                             arker
1597 F9             3615                                             mov             r1,a
1598 09             3616                                             inc             r1
1599 873C           3617                                             mov             savba,@r1
                    3618                                                     
159B 78B2           3619                                                     mov             r0,#marker
159D 16             3620                                                     dec             @r0                        
                                  
159E C219           3621                                     clr             bitmig
15A0 E53A           3622                                     mov                     a,movleft
15A2 B40349         3623                                     cjne            a,#3,poinA
15A5 B60279         3624                                     cjne    @r0,#2,out7;;нажата кн <- при вводе цифр B=+00000
15A8 06             3625     poin3:  inc             @r0
                    3626     ;нажат ввод А =000000 запомнить константу А
15A9 75B0F7         3627     nopoin7:           mov          p3,#0f7h
15AC E5B0           3628                                     mov             a,p3
15AE 20E770         3629                                     jb              acc.7,out7
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    57

15B1 78B1           3630                                     mov             r0,#vichR
15B3 E6             3631                                     mov             a,@r0
15B4 B6213C         3632                                     cjne    @r0,#21h,no21p7
15B7 7631           3633                                     mov             @r0,#31h
                    3634                             ;       считать с индикатора  упаковать в плавающий формат
                    3635                             ;   сохранить
15B9 7F0E           3636                                     mov             r7,#14
15BB 784F           3637                                     mov             r0,#abin
15BD 120000   F     3638                                     call    clearN                  
15C0 120000   F     3639                                     call    upakA
                    3640                                     
15C3 784F           3641                                     mov             r0,#abin
15C5 7953           3642                                     mov             r1,#adec                        ;мл        
                              ст
15C7 120000   F     3643                                     call    decbin                  ;abin..abin+3 (hex)
15CA 120000   F     3644                                     call    loadr2                  ;r2..r5
15CD 120402         3645                                     call    altof                   ;r2..r5->int
15D0 78BC           3646                                     mov             r0,#konstA
15D2 120000   F     3647                                     call    saver2
                    3648     ;26
15D5 78B2           3649                                     mov             r0,#marker
15D7 7603           3650                                     mov             @r0,#3
15D9 753B08         3651                                     mov             movrig,#8
15DC 753A03         3652                                     mov             movleft,#3
15DF 900000   F     3653                                     mov             dptr,#teBequ0
15E2 120000   F     3654                                     call    lotext
15E5 120000   F     3655                                     call            outB
15E8 534BF7         3656                                     anl             bufind+11,#0f7h         ;гашение точки bufi
                             nd+7
15EB 020000   F     3657                                     jmp             goto7;out7
                    3658     
15EE B60330         3659     poinA:          cjne    @r0,#3,out7;;нажата кн <- при вводе цифр A= 0000
15F1 80B5           3660                                             jmp             poin3
                    3661     
15F3                3662     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    3663                             ;   сохранить
15F3 7F0E           3664                                     mov             r7,#14
15F5 784F           3665                                     mov             r0,#abin
15F7 120000   F     3666                                     call    clearN                  
15FA 120000   F     3667                                     call    upakB                   
15FD 784F           3668                                     mov             r0,#abin
15FF 7953           3669                                     mov             r1,#adec                        ;мл        
                              ст
1601 120000   F     3670                                     call    decbin                  ;abin..abin+3 (hex)
1604 120000   F     3671                                     call    loadr2                  ;r2..r5
1607 120402         3672                                     call    altof                   ;r2..r5->int
160A 301B04         3673                                     jnb             bitznB,pozB
160D EA             3674                                     mov             a,r2
160E 4480           3675                                     orl             a,#80h
1610 FA             3676                                     mov             r2,a                    ;знак-
1611 78C0           3677     pozB:           mov             r0,#konstB
1613 120000   F     3678                                     call    saver2
                    3679     
1616 79B2           3680                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
1618 77FF           3681                                     mov             @r1,#0ffh
161A 78B1           3682                                     mov             r0,#vichR
161C 7611           3683                                     mov             @r0,#11h
161E 020000   F     3684                               jmp           lovich     ;3.01.07ВЫЧИСЛИТЬ
                    3685                                     
                    3686     
1621                3687     out7:                   ;mov            IE,#80h
1621 D083           3688                                     pop             dph
1623 D082           3689                                     pop             dpl
1625 D007           3690                                     pop             rr7     
1627 D006           3691                                     pop             rr6
1629 D005           3692                                     pop             rr5
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    58

162B D004           3693                                     pop             rr4
162D D003           3694                                     pop             rr3
162F D002           3695                                     pop             rr2
1631 D001           3696                                     pop             rr1                             
1633 D000           3697                                     pop             rr0
1635 D0D0           3698                                     pop             psw
1637 D0E0           3699                                     pop             acc
1639 E5AD           3700                                     mov             a,P3IF
163B 547F           3701                                     anl             a,#7fh
163D F5AD           3702                                     mov             P3IF,a
163F 75B0C0         3703                                     mov             P3,#0c0h
                    3704     ;clr            bitmig
1642 75E730         3705                                     mov             EIE2,#30H
1645 C219           3706     clr             bitmig
1647 32             3707                                     reti
                    3708     
                    3709     
                    3710                                     
1648                3711     textT:          
1648 FD543D32       3712                             db              0fdh,"T","=",32h,"m","S",0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
164C 6D53FDFD                
1650 FDFD                    
1652 FD543D31       3713                             db              0fdh,"T","=",31h,30h,"m","S",0fdh,0fdh,0fdh
1656 306D53FD                
165A FDFD                    
165C FD543D35       3714                             db              0fdh,"T","=",35h,30h,"m","S",0fdh,0fdh,0fdh
1660 306D53FD                
1664 FDFD                    
1666 FD543D64       3715                             db              0fdh,"T","=",64h,31h,"S",0fdh,0fdh,0fdh,0fdh
166A 3153FDFD                
166E FDFD                    
1670 20202054       3716                             db              " "," "," ","T","=",31h,"S"," "," "," "
1674 3D315320                
1678 2020                    
167A 2020543D       3717                             db              " "," ","T","=",31h,30h,"S"," "," "," "  
167E 31305320                
1682 2020                    
                    3718     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                    3719     
1684 42753474       3720     teVICH: db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
1688 79767454                
168C 7720                    
168E 20413D20       3721     teAequ0:        db              " ",'A','='," "," "," "," "," "," ",65h
1692 20202020                
1696 2065                    
1698 20423D2B       3722     teBequ0:        db              " ",'B','=','+'," "," "," "," "," "," "
169C 20202020                
16A0 2020                    
16A2 20207145       3723     teMENU: db              " "," ",71h,"E","H",72h," "," "," "," "
16A6 48722020                
16AA 2020                    
                    3724     
16AC 20544579       3725     teTESI: db      " ","T","E",79h,"T",2dh,74h,33h,71h," ";ТЕСТ -ИЗМ    11
16B0 542D7433                
16B4 7120                    
16B6 20544579       3726     teTESR: db      " ","T","E",79h,"T",2d,"R","S",32h,33h,32h;ТЕСТ RS232 12
16BA 54025253                
16BE 323332                  
16C1 20794B30       3727     teSKOR: db      " ",79h,'K',30h,"P"," ",32h,33h,32h," ";СКОР 232      13
16C5 50203233                
16C9 3220                    
16CB 20204142       3728     teAVK:  db      " "," ",'A','B','K'," "," "," "," "," "  ;AВK                              
                                  14
16CF 4B202020                
16D3 2020                    
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    59

16D5 204B4176       3729     teKALIB:         db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР    15
16D9 74735020                
16DD 202020                  
                    3730     
16E0 20544579       3731     teTE11:         db              " ",'T',"E",79h,'T'," ",2dh,31h,31h,'A';          21
16E4 54202D31                
16E8 3141                    
16EA 20544579       3732     teTE9:          db              " ",'T',"E",79h,'T'," ",2dh,30h,39h,'A';                   
                                                  22
16EE 54202D30                
16F2 3941                    
16F4 20544579       3733     teTE7:          db              " ",'T',"E",79h,'T'," ",2dh,30h,37h,'A';                   
                                                  23
16F8 54202D30                
16FC 3741                    
                    3734     
                    3735     
16FE 20203537       3736     teS57_6:                db              " "," ",35h,37h,36h," "," "," "," "," ";57.6
1702 36202020                
1706 2020                    
1708 20203139       3737     teS19_2:                db              " "," ",31h,39h,32h," "," "," "," "," ";19,2
170C 32202020                
1710 2020                    
                    3738     
1712 61415030       3739     tePAR:          db              61h,'A',"P",30h,76h,77h," ",30h,30h,30h;пароль
1716 76772030                
171A 3030                    
                    3740     
171C 74337120       3741     teIZMK: db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
1720 4B304879                
1724 5420                    
1726 20204275       3742     teOUT:          db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
172A 58307820                
172E 2020                    
1730 2020304C       3743     teOLL:          db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
1734 4C202020                
1738 2020                    
173A 20203034       3744     teCLE:          db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
173E 7479544B                
1742 4120                    
1744 20203041       3745     teMEM:          db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
1748 71795420                
174C 20203341       3746     teWR:           db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
1750 61747977                
1754 2020                    
1756 20206150       3747     teLIST: db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
175A 30797130                
175E 545020                  
1761 20206130       3748     teFULL: db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
1765 76484162                
1769 2020                    
176B 20207376       3749     teBLOK: db      " "," ",73h,76h,30h,'K'," ",30h,30h," ";БЛОК 00
176F 304B2030                
1773 3020                    
1775 20207376       3750     teBL:           db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
1779 304B2020                
177D 2020                    
177F 48413420       3751     tebBL:          db      "H",'A',34h," ",73h,76h," ",30h,30h,30h; НАЧ БЛОК 000
1783 73762030                
1787 3030                    
1789 4B304820       3752     teeBL:          db      "K",30h,"H"," ",73h,76h," ",30h,30h,30h; КОН БЛОК 000
178D 73762030                
1791 3030                    
                    3753      ;;;;;;;;;;;;;;;;;;;         
1793 2020304C       3754     teOLI:  db              " "," ",30h,"L","L"," ","I"," "," "," "
1797 4C204920                
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    60

179B 2020                    
179D 2020304C       3755     teOLR:  db              " "," ",30h,"L","L"," ",66h," "," "," "
17A1 4C206620                
17A5 2020                    
                    3756     
                    3757     
17A7 78B1           3758     lomenu:         mov             r0,#vichR
17A9 B61107         3759                                             cjne    @r0,#11h,menu12
17AC 900000   F     3760                                             mov             dptr,#teTESI
17AF 120000   F     3761     lome1:                  call    lotexT
17B2 22             3762                                             ret
17B3 B61205         3763     menu12:         cjne    @r0,#12h,menu13
17B6 900000   F     3764                                             mov             dptr,#teTESR
17B9 80F4           3765                                             jmp             lome1
17BB B61305         3766     menu13:         cjne    @r0,#13h,menu14
17BE 900000   F     3767                                             mov             dptr,#teSKOR
17C1 80EC           3768                                             jmp             lome1
17C3 B61405         3769     menu14:         cjne    @r0,#14h,menu15
17C6 900000   F     3770                                             mov             dptr,#teAVK
17C9 80E4           3771                                             jmp             lome1
17CB B61505         3772     menu15:                 cjne    @r0,#15h,menu21
17CE 900000   F     3773                                             mov             dptr,#teKALIB
17D1 80DC           3774                                             jmp             lome1
                    3775     
17D3 B62105         3776     menu21: cjne    @r0,#21h,menu22
17D6 900000   F     3777                                             mov             dptr,#teTE11
17D9 80D4           3778                                             jmp             lome1
17DB B62205         3779     menu22:         cjne    @r0,#22h,menu23
17DE 900000   F     3780                                             mov             dptr,#teTE9
17E1 80CC           3781                                             jmp             lome1
17E3 B62305         3782     menu23:         cjne    @r0,#23h,menu31
17E6 900000   F     3783                                             mov             dptr,#teTE7
17E9 80C4           3784                                             jmp             lome1
17EB B63105         3785     menu31:         cjne    @r0,#31h,menu41
17EE 900000   F     3786                                             mov             dptr,#teS57_6
17F1 80BC           3787                                             jmp             lome1
                    3788     
17F3                3789     menu41:         
17F3 900000   F     3790                                             mov             dptr,#tePAR
17F6 80B7           3791                                             jmp             lome1
                    3792     ;пп мигания индикации
17F8 78B2           3793     mign:           mov             r0,#marker
                    3794                                     
17FA B6FF03         3795                                     cjne    @r0,#0ffh,mignn
                    3796                                     ;реж изм мигает *
17FD C219           3797                                     clr             bitmig
17FF 22             3798                                     ret
                    3799     
1800                3800     mignn:                  ;clr            c
1800 7440           3801                                     mov             a,#bufind
1802 26             3802                                     add             a,@r0                   ;a=bufind+marker
1803 F9             3803                                     mov             r1,a
1804 201907         3804                                     jb              bitmig,onmig
1807 873C           3805                                     mov             savba,@r1
                    3806                             ;       mov             a,@r1
                    3807                             ;       mov             savba,a
1809 7720           3808                                     mov             @r1,#" "
                    3809                                     
180B D219           3810                                     setb    bitmig
180D 22             3811                                     ret
                    3812     
180E A73C           3813     onmig:                  mov             @r1,savba
                    3814                                     ;mov            a,savba
                    3815                                     ; mov           @r1,a
1810 C219           3816                                     clr             bitmig
1812 120000   F     3817                                     call    z_01s
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    61

1815 22             3818                                     ret
                    3819     ;bufind=30h..39h                                                                           
                                           ;
1816 C219           3820     vvchif:                 clr             bitmig
1818 79B2           3821                                     mov             r1,#marker
181A E7             3822                                     mov             a,@r1                   ;изм цифры
181B 7840           3823                                     mov             r0,#bufind                      ;0000
181D 28             3824                                     add             a,r0
181E F8             3825                                     mov             r0,a
181F 06             3826                                     inc             @r0
1820 B63A02         3827                                     cjne    @r0,#3ah,chif
1823 7630           3828                                     mov             @r0,#30h
1825                3829     chif:   
1825 22             3830                             ret
                    3831     
                    3832       ;перевод маркера влево
1826                3833     marle:  
1826 C219           3834                     clr             bitmig
                    3835                     ;mov            savba,#0   нельзя обнулять
1828 78B2           3836             mov             r0,#marker
182A 16             3837                     dec             @r0
182B E6             3838                     mov             a,@r0
182C C3             3839                     clr             c
182D 953A           3840                     subb    a,movleft         ;крайне левое положение
182F 5001           3841                     jnc             rler
1831 06             3842                     inc             @r0
1832 22             3843     rler:   ret
                    3844         
                    3845     ;перевод маркера вправо
1833 C219           3846     marri:  clr             bitmig
1835 78B2           3847                     mov             r0,#marker
1837 06             3848                     inc         @r0
1838 E53B           3849                     mov             a,movrig           ;крайне правое положение
183A C3             3850                     clr             c
183B 96             3851                     subb    a,@r0
183C 5001           3852                     jnc             rrir
183E 16             3853                     dec             @r0
183F 22             3854     rrir:   ret
                    3855         
                    3856     ;konstA->bufind+4..bufind+7
1840 78BC           3857     outA:           mov                     r0,#konstA
1842 120000   F     3858                                     call            resar2
1845 120343         3859                                     call            ftol                    ;->hex
1848 784F           3860                                     mov             r0,#abin
184A 120000   F     3861                                     call            saver2
184D 7853           3862                                     mov                     r0,#adec
184F 7952           3863                                     mov             r1,#abin+3
1851 120000   F     3864                                     call            bindec
1854 785C           3865                                     mov                     r0,#adec+9
1856 7947           3866                                     mov                     r1,#bufind+7
1858 7F04           3867                                     mov                     r7,#4
185A E6             3868     outa2:  mov             a,@r0
185B 2430           3869                               add           a,#30h
185D F7             3870                                     mov             @r1,a
185E 19             3871                                     dec             r1
185F 18             3872                                     dec             r0
1860 DFF8           3873                                     djnz    r7,outa2
1862 22             3874                                     ret
                    3875                                             
                    3876     ;konstB->bufind+4..bufind+8
1863 78C0           3877     outB:           mov                     r0,#konstB
1865 120000   F     3878                                     call            resar2
1868 EA             3879                                     mov                     a,r2
1869 5480           3880                                     anl                     a,#80h
186B 6007           3881                                     jz                      outb3
186D EA             3882     mov                     a,r2
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    62

186E 547F           3883                                     anl                     a,#7fh
1870 FA             3884                                     mov                     r2,a
1871 75432D         3885                                     mov                     bufind+3,#2dh
1874 120343         3886     outb3:  call            ftol                    ;->hex
1877 784F           3887                                     mov             r0,#abin
1879 120000   F     3888                                     call            saver2
187C 7853           3889                                     mov                     r0,#adec
187E 7952           3890                                     mov             r1,#abin+3
1880 120000   F     3891                                     call            bindec
1883 785C           3892                                     mov                     r0,#adec+9
1885 7948           3893                                     mov                     r1,#bufind+8
1887 7F05           3894                                     mov                     r7,#5
1889 E6             3895     outb2:  mov             a,@r0
188A 2430           3896                               add           a,#30h
188C F7             3897                                     mov             @r1,a
188D 19             3898                                     dec             r1
188E 18             3899                                     dec             r0
188F DFF8           3900                                     djnz    r7,outb2
1891 22             3901                                     ret
                    3902     
                    3903     ;$include (d:\amp\subr2.asm) 
1892            +1  3904     loadUS: ;если идет тест измерения ус восстановить для теста
                +1  3905                                     ;jb             biteizm,yestest
1892 79AE       +1  3906                                             mov             r1,#diap
1894 E7         +1  3907                             mov             a,@r1
1895 23         +1  3908                             rl              a;*2
1896 FC         +1  3909                             mov             r4,a                    ;save a
1897 900000   F +1  3910                             mov             dptr,#tabus
189A 93         +1  3911                             movc    a,@a+dptr
189B FA         +1  3912                             mov             r2,a                    ;high byte
189C E584       +1  3913                             mov             a,p4
189E 5401       +1  3914                             anl             a,#01
18A0 4A         +1  3915                             orl             a,r2
18A1 F584       +1  3916                             mov             p4,a
18A3 0C         +1  3917                             inc             r4
18A4 EC         +1  3918                             mov             a,r4
18A5 93         +1  3919                             movc    a,@a+dptr
18A6 FB         +1  3920                             mov             r3,a                    ;low byte
18A7 E585       +1  3921                             mov             a,p5
18A9 5401       +1  3922                             anl             a,#01
18AB 4B         +1  3923                             orl             a,r3
18AC F585       +1  3924                             mov             p5,a
18AE 799A       +1  3925                             mov             r1,#parT
18B0 B7010E     +1  3926                             cjne    @r1,#1,bret
18B3 79AE       +1  3927                             mov             r1,#diap                  ;10s (parT=1)
18B5 7405       +1  3928                             mov             a,#5                      ;10-8..10-11 p4.1=1
18B7 C3         +1  3929                             clr             c
18B8 97         +1  3930                             subb    a,@r1
18B9 5006       +1  3931                             jnc             bret
18BB E584       +1  3932                             mov             a,p4
18BD 4402       +1  3933                             orl             a,#02
18BF F584       +1  3934                             mov             p4,a                     ;10-8..10-11 p4.1=1
18C1 120000   F +1  3935     bret:      call          louizm         ;us если вкл кн ИЗМЕР
18C4 22         +1  3936                             ret
18C5            +1  3937     yestest:
18C5 120000   F +1  3938                             call            lotpus          ;ус теста измерения
18C8 22         +1  3939                             ret
                +1  3940                             
                +1  3941     ;загр ус для кор 0
                +1  3942     ;dptr-
18C9 E4         +1  3943     lospus:         clr             a
                +1  3944                             ;movc   a,@a+dptr
                +1  3945                             ;mov            r2,a                    ;high byte
                +1  3946                             ;mov            a,p4
                +1  3947                             ;anl            a,#01
                +1  3948                             ;orl            a,r2
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    63

                +1  3949                             ;mov            p4,a
                +1  3950                             ;inc            dptr
18CA E4         +1  3951                             clr             a
18CB 93         +1  3952                             movc    a,@a+dptr
18CC FB         +1  3953                             mov             r3,a                    ;low byte
18CD E585       +1  3954                             mov             a,p5
18CF 54BF       +1  3955                             anl             a,#0bfh;01
18D1 4B         +1  3956                             orl             a,r3
18D2 F585       +1  3957                             mov             p5,a
18D4 22         +1  3958                             ret
                +1  3959     
18D5 80         +1  3960     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                +1  3961     
                +1  3962     ;us кнопка измерения выкл
18D6 88D6       +1  3963     tabus:     db           88h,0d6h         ;10-2
18D8 88F6       +1  3964                             db      88h,0f6h         ;10-3
18DA 88D6       +1  3965                             db              88h,0d6h         ;10-4
18DC 88F6       +1  3966                             db              88h,0f6h         ;10-5
18DE 9AD6       +1  3967                             db      9ah,0d6h         ;10-6
18E0 9AF6       +1  3968                             db              9ah,0f6h         ;10-7
18E2 ACD6       +1  3969                             db              0ach,0d6h        ;10-8
18E4 ACF6       +1  3970                             db      0ach,0f6h        ;10-9
18E6 C8D6       +1  3971                             db              0c8h,0d6h        ;10-10
18E8 C8F6       +1  3972                             db              0c8h,0f6h        ;10-11
                +1  3973     
18EA            +1  3974     tabt11: 
18EA 66E6       +1  3975                             db              66h,0e6h;10-11
18EC            +1  3976     tabt9:  
18EC 32E6       +1  3977                             db              32h,0e6h;10-9
18EE            +1  3978     tabt7:  
18EE 18EE       +1  3979                             db              18h,0eeh;10-7
                +1  3980     
                +1  3981      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  3982     ;в зав от parT (Tизм)
18F0 79B7       +1  3983     loadT:          mov             r1,#load;parT
18F2 7840       +1  3984     lolevT:         mov             r0,#bufind+0
18F4 7B0A       +1  3985                             mov             r3,#10
18F6 75F00A     +1  3986                             mov             b,#10
18F9 E7         +1  3987                             mov             a,@r1
18FA A4         +1  3988                             mul             ab
18FB FC         +1  3989                             mov             r4,a                    ;save a
18FC 900000   F +1  3990                             mov             dptr,#textT
18FF 93         +1  3991             lod1:   movc    a,@a+dptr
1900 F6         +1  3992                             mov             @r0,a
1901 08         +1  3993                             inc             r0
1902 0C         +1  3994                             inc             r4
1903 EC         +1  3995                             mov             a,r4
1904 DBF9       +1  3996                             djnz    r3,lod1
1906 22         +1  3997                             ret     
                +1  3998     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  3999     ;dptr-адр строки текста         
1907            +1  4000     lotext:         
1907 7B0A       +1  4001                             mov             r3,#10
1909 7840       +1  4002                             mov             r0,#bufind+0
190B E4         +1  4003     lodt:           clr             a
190C 93         +1  4004                             movc    a,@a+dptr
190D F6         +1  4005                             mov             @r0,a
190E 08         +1  4006                             inc             r0
190F A3         +1  4007                             inc             dptr
1910 DBF9       +1  4008                             djnz    r3,lodt
1912 22         +1  4009                             ret                                     
                +1  4010     
                +1  4011     
                +1  4012     
                +1  4013     
                +1  4014      ;задержка 100 мкс
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    64

1913 7978       +1  4015     z_100:    mov R1,#78h     ;загрузка первого числа
1915 7A02       +1  4016     z100:     mov R2,#2h     ;загрузка второго числа
1917 DAFE       +1  4017     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
1919 D9FA       +1  4018               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
191B 22         +1  4019               ret           
                +1  4020     
                +1  4021     ;задержка 34 мкс
191C 7B8B       +1  4022     z_5:      mov R3,#8Bh      ;загрузка числа
191E DBFE       +1  4023     ct:       djnz R3,ct
1920 22         +1  4024               ret
                +1  4025     
                +1  4026     ;задержка 15 мс
1921 79FA       +1  4027     z_15:     mov R1,#0FAh    ;загрузка первого числа
1923 7AED       +1  4028     z15:      mov R2,#0EDh   ;загрузка второго числа
1925 DAFE       +1  4029     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
1927 D9FA       +1  4030               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
1929 22         +1  4031               ret   
                +1  4032                                               
                +1  4033      ;задержка 1 мс
192A 7910       +1  4034     z_1ms:     mov R1,#10h     
192C 7AED       +1  4035     ss1:       mov R2,#0EDh    
192E DAFE       +1  4036                djnz R2, $    
1930 D9FA       +1  4037                djnz R1, ss1   
1932 22         +1  4038                ret   
                +1  4039     
                +1  4040      ;????????
                +1  4041     ;задержка 1с
1933 7D1F       +1  4042     z_1s:   mov             r5,#01fh 
1935 7EFF       +1  4043     co2s:   mov     R6,#0ffh     
1937 7FFF       +1  4044     z1s:     mov    R7,#0ffh     
1939 DFFE       +1  4045     co1s:   djnz    R7, co1s        
193B DEFA       +1  4046             djnz    R6, z1s 
193D DDF6       +1  4047                     djnz    r5,co2s
193F 22         +1  4048               ret
                +1  4049     ;задержка 0,1с
1940 7D03       +1  4050     z_01s:           mov            r5,#03h 
1942 7EFF       +1  4051     co02s:          mov     R6,#0ffh     
1944 7FFF       +1  4052     z01s:           mov     R7,#0ffh     
1946 DFFE       +1  4053                             djnz    R7, $   
1948 DEFA       +1  4054                     djnz    R6, z01s 
194A DDF6       +1  4055                             djnz    r5,co02s
194C 22         +1  4056                      ret              
194D 000007FF   +1  4057     chzap:  db      00,00,07h,0ffh             
1951 00000000   +1  4058     ch0:    db      00,00,00,00
1955 0000000A   +1  4059     ch10:   db      00,00,00,0ah                            ;10
1959 00000005   +1  4060     ch5:    db      00,00,00,05                                             ;5
195D 000003B9   +1  4061     ch954:  db 00,00,03,0b9h                                                ;954
1961 000003E8   +1  4062     ch10000:        db 00,00,03h,0e8h                                               ;10000
1965 00000064   +1  4063     ch100:  db 00,00,00,64h ;100
1969 00000002   +1  4064     ch2:    db      00,00,00,02                                             
                +1  4065     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  4066     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  4067     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
196D 00000001   +1  4068     ch1:    db  00,00,00,01
1971 3F800000   +1  4069     ch_1:   db      3fh,80h,00,00                   
1975 3F741EDF   +1  4070     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
1979 47C35000   +1  4071     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
197D 3F800347   +1  4072     KD:             db      3fh,80h,03h,47h;1,0001
1981 48435000   +1  4073     CH2tho: db      48h,43h,50h,00;200000
1985 4856D800   +1  4074     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
1989 4856D800   +1  4075     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
198D 461C4000   +1  4076     ch_10th:db  46h,1ch,40h,00;10000-2710h
1991 41200000   +1  4077     ch_10:  db      41h,20h,00,00;10d
1995 48742400   +1  4078     ch_250: db      48h,74h,24h,00;250000
                +1  4079     ;r1- мл байт 2х байтного числа
1999            +1  4080     tenmin:         ;-10
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    65

1999 C3         +1  4081                             clr             c
199A E7         +1  4082                     mov             a,@r1
199B 9405       +1  4083                             subb    a,#5;10
199D F7         +1  4084                             mov             @r1,a
199E 19         +1  4085                             dec             r1
199F E7         +1  4086                             mov             a,@r1
19A0 9400       +1  4087                             subb    a,#0
19A2 F7         +1  4088                             mov             @r1,a
19A3 22         +1  4089                             ret
                +1  4090       ;r0-обнуление ячеек памяти  
19A4 7F04       +1  4091       clear4:        mov    r7,#4
19A6 E4         +1  4092                             clr             a
19A7 F6         +1  4093       cl4:          mov             @r0,a
19A8 08         +1  4094                             inc             r0
19A9 DFFC       +1  4095                             djnz    r7,cl4
19AB 22         +1  4096                             ret     
                +1  4097     
                +1  4098      ;r0-обнуление ячеек памяти 
                +1  4099      ;R7- 
19AC            +1  4100       clearN:        
19AC E4         +1  4101                             clr             a
19AD F6         +1  4102       cl4N:         mov             @r0,a
19AE 08         +1  4103                             inc             r0
19AF DFFC       +1  4104                             djnz    r7,cl4N
19B1 22         +1  4105                             ret     
                +1  4106     
                +1  4107       ;чтение номера байта с индикатора(2байта)
                +1  4108     ;bufind+8..bufind+9
                +1  4109     ;-  - - -
                +1  4110     ;- - - - - - - - - -
                +1  4111     ;adec..adec+9
                +1  4112     ;ст            мл
19B2 7848       +1  4113     upak2:  mov             r0,#bufind+8;
19B4 795C       +1  4114                     mov             r1,#adec+9
19B6 7F02       +1  4115                     mov             r7,#2;2bait
19B8 C3         +1  4116     upa2:   clr             c
19B9 E6         +1  4117                     mov             a,@r0
19BA 9430       +1  4118                     subb    a,#30h
19BC F7         +1  4119                     mov             @r1,a
19BD 18         +1  4120                     dec             r0
19BE 19         +1  4121                     dec             r1
19BF DFF7       +1  4122                     djnz    r7,upa2
19C1 22         +1  4123                     ret  
                +1  4124         
                +1  4125      ;bufind+4..bufind+9
                +1  4126     ;-  - - -
                +1  4127     ;- - - - - - - - - -
                +1  4128     ;adec..adec+9
                +1  4129     ;ст            мл
19C2 7849       +1  4130     upak:   mov             r0,#bufind+9;
19C4 795C       +1  4131                     mov             r1,#adec+9
19C6 7F06       +1  4132                     mov             r7,#6
19C8 C3         +1  4133     upa:    clr             c
19C9 E6         +1  4134                     mov             a,@r0
19CA 9430       +1  4135                     subb    a,#30h
19CC F7         +1  4136                     mov             @r1,a
19CD 18         +1  4137                     dec             r0
19CE 19         +1  4138                     dec             r1
19CF DFF7       +1  4139                     djnz    r7,upa
19D1 22         +1  4140                     ret
                +1  4141     
                +1  4142      ;чтение номера байта с индикатора(3байта)
                +1  4143     ;bufind+3..bufind+9
                +1  4144     ;-  - - -
                +1  4145     ;- - - - - - - - - -
                +1  4146     ;adec..adec+9
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    66

                +1  4147     ;ст            мл
19D2 7849       +1  4148     upak3:  mov             r0,#bufind+9;
19D4 795C       +1  4149                     mov             r1,#adec+9
19D6 7F03       +1  4150                     mov             r7,#3;3bait
19D8 C3         +1  4151     upa1:   clr             c
19D9 E6         +1  4152                     mov             a,@r0
19DA 9430       +1  4153                     subb    a,#30h
19DC F7         +1  4154                     mov             @r1,a
19DD 18         +1  4155                     dec             r0
19DE 19         +1  4156                     dec             r1
19DF DFF7       +1  4157                     djnz    r7,upa1
19E1 22         +1  4158                     ret
                +1  4159     
                +1  4160     ;вых-r2,r3-адрес ячее памяти прогр
19E2            +1  4161     findkoef:
19E2 79AE       +1  4162                                     mov             r1,#diap
19E4 E7         +1  4163                                     mov             a,@r1
19E5 23         +1  4164                                     rl              a                                          
                                          ;diap*2(2bait )
19E6 FC         +1  4165                                     mov             r4,a                                    ;sa
                             ve
19E7 900000   F +1  4166                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  4167                                     
19EA 93         +1  4168                                     movc    a,@a+dptr                       ;ст байт
19EB FA         +1  4169                                     mov             r2,a
19EC A3         +1  4170                                     inc             dptr
19ED EC         +1  4171                                     mov             a,r4
19EE 93         +1  4172                                     movc    a,@a+dptr
19EF FB         +1  4173                                     mov             r3,a                    ;мл байт
19F0 22         +1  4174                                     ret
                +1  4175     
                +1  4176     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  4177     ;(5000h..5027h)
19F1 5000       +1  4178     diKDw:  dw              5000h                   ;10-2
19F3 5004       +1  4179                                     dw              5004h                   ;10-3
19F5 5008       +1  4180                                     dw              5008h                   ;10-4
19F7 500C       +1  4181                                     dw              500ch                   ;10-5
19F9 5010       +1  4182                                     dw              5010h                   ;10-6
19FB 5014       +1  4183                                     dw              5014h                   ;10-7
19FD 5018       +1  4184                                     dw              5018h                   ;10-8
19FF 501C       +1  4185                                     dw              501ch                   ;10-9
1A01 5020       +1  4186                                     dw              5020h                   ;10-10
1A03 5024       +1  4187                                     dw              5024h                   ;10-11
1A05 5028       +1  4188     dipar:  dw              5028h                   ;parol
                +1  4189     
1A07 000186A0   +1  4190     chthou: db      00,01,86h,0a0h  ;100.000
                +1  4191     
1A0B AA08       +1  4192     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
1A0D AB09       +1  4193                                             mov     r3,ltemp+1
1A0F AC0A       +1  4194                                             mov     r4,ltemp+2
1A11 AD0B       +1  4195                                             mov     r5,ltemp+3
1A13 22         +1  4196                                             ret
                +1  4197     ;bufind+4..bufind+9
                +1  4198     ;-  - - -
                +1  4199     ;- - - - - - - - - -
                +1  4200     ;adec..adec+9
                +1  4201     ;ст            мл
1A14 7847       +1  4202     upakA:  mov             r0,#bufind+7;
1A16 795C       +1  4203                     mov             r1,#adec+9
1A18 7F04       +1  4204                     mov             r7,#4
1A1A C3         +1  4205     upaa:   clr             c
1A1B E6         +1  4206                     mov             a,@r0
1A1C 9430       +1  4207                     subb    a,#30h
1A1E F7         +1  4208                     mov             @r1,a
1A1F 18         +1  4209                     dec             r0
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    67

1A20 19         +1  4210                     dec             r1
1A21 DFF7       +1  4211                     djnz    r7,upaa
1A23 22         +1  4212                     ret
                +1  4213     
                +1  4214     ;bufind+4..bufind+9
                +1  4215     ;-  - - -
                +1  4216     ;- - - - - - - - - -
                +1  4217     ;adec..adec+9
                +1  4218     ;ст            мл
1A24 7848       +1  4219     upakB:  mov             r0,#bufind+8;
1A26 795C       +1  4220                     mov             r1,#adec+9
1A28 7F05       +1  4221                     mov             r7,#5
1A2A C3         +1  4222     upab:   clr             c
1A2B E6         +1  4223                     mov             a,@r0
1A2C 9430       +1  4224                     subb    a,#30h
1A2E F7         +1  4225                     mov             @r1,a
1A2F 18         +1  4226                     dec             r0
1A30 19         +1  4227                     dec             r1
1A31 DFF7       +1  4228                     djnz    r7,upab
1A33 C21B       +1  4229                     clr                     bitznB
1A35 E543       +1  4230                     mov             a,bufind+3
1A37 B42D02     +1  4231                     cjne            a,#2dh,abret
1A3A D21B       +1  4232                     setb            bitznB
1A3C            +1  4233     abret:
1A3C 22         +1  4234                     ret
1A3D            +1  4235     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
1A3D 4E6E6AA8   +1  4236                                             db      4eh,6eh,6ah,0a8h;10**9
1A41 43FA0000   +1  4237     CH_500:         db              43h,0fah,00,00;1fah=500
1A45 4856D800   +1  4238     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
1A49 49742400   +1  4239     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  4240     
                +1  4241     
                +1  4242     
                +1  4243     ;управление AD7731
                +1  4244     ;r4=b1 r5=b2
1A4D            +1  4245     iniacp: ;управление AD7731
1A4D 7403       +1  4246                             mov             a,#03
                +1  4247     
1A4F 120000   F +1  4248                             call    write
1A52 EC         +1  4249                             mov             a,r4;#80h
1A53 120000   F +1  4250                             call    write
1A56 ED         +1  4251                             mov             a,r5;#04
1A57 120000   F +1  4252                             call    write
1A5A 7402       +1  4253                             mov             a,#02
1A5C 120000   F +1  4254                             call    write
1A5F 74A1       +1  4255                             mov             a,#0a1h
1A61 120000   F +1  4256                             call    write
1A64 7474       +1  4257                             mov             a,#74h
1A66 120000   F +1  4258                             call    write
1A69 2095FD     +1  4259                             jb              p1.5,$;p1.3,$
1A6C 7402       +1  4260                             mov             a,#02
1A6E 120000   F +1  4261                             call    write
1A71 7481       +1  4262                             mov             a,#81h
1A73 120000   F +1  4263                             call    write
1A76 7474       +1  4264                             mov             a,#74h
1A78 120000   F +1  4265                             call    write
1A7B 2095FD     +1  4266                             jb              p1.5,$;p1.3,$
1A7E 7402       +1  4267                             mov             a,#02
1A80 120000   F +1  4268                             call    write
1A83 7421       +1  4269                             mov             a,#21h
1A85 120000   F +1  4270                             call    write
1A88 7474       +1  4271                             mov             a,#74h
1A8A 120000   F +1  4272                             call    write
1A8D 22         +1  4273                             ret
                +1  4274                             ;;;;;;;;;;;;;;;;
                +1  4275     ;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    68

                +1  4276     ;;;;;;;;;;;;;;;;;
1A8E 0000       +1  4277     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
1A90 6000       +1  4278                                     db              60h,00h;40h,04h         ;10s
1A92 6000       +1  4279                                     db              60h,00;40h,04h          ;1s
1A94 4004       +1  4280                                     db              40h,04h         ;0,1s
1A96 2004       +1  4281                                     db              20h,04h         ;50ms
1A98 2004       +1  4282                                     db              20h,04h          ;10ms
1A9A 1332       +1  4283                                     db              13h,32h         ;2ms
                +1  4284     
                +1  4285     ;загр В1,В2 в завис от Т                                
1A9C 799A       +1  4286     loab12:                 mov             r1,#parT
1A9E 900000   F +1  4287                                     mov             dptr,#tabB1_2
1AA1 E7         +1  4288                                     mov             a,@r1
1AA2 23         +1  4289                                     rl              a;*2
1AA3 FF         +1  4290                                     mov             r7,a                    ;save a
1AA4 93         +1  4291                                     movc    a,@a+dptr
1AA5 FC         +1  4292                                     mov             r4,a   ;b1
1AA6 0F         +1  4293                                     inc             r7
1AA7 EF         +1  4294                                     mov             a,r7
1AA8 93         +1  4295                                     movc    a,@a+dptr
1AA9 FD         +1  4296                                     mov             r5,a
                +1  4297                                     ;после загр В1,2 загр упр слово для нового Т
                +1  4298                             
1AAA 22         +1  4299                                     ret
                +1  4300     
                +1  4301     
1AAB 7852       +1  4302     loadr2: mov             r0,#abin+3              ;r2..r5
1AAD E6         +1  4303                     mov             a,@r0                   ; ст мл   
1AAE FA         +1  4304                     mov             r2,a
1AAF 18         +1  4305                     dec             r0
1AB0 E6         +1  4306                     mov             a,@r0
1AB1 FB         +1  4307                     mov             r3,a
1AB2 18         +1  4308                     dec             r0
1AB3 E6         +1  4309                     mov             a,@r0
1AB4 FC         +1  4310                     mov             r4,a
1AB5 18         +1  4311                     dec             r0
1AB6 E6         +1  4312                     mov             a,@r0
1AB7 FD         +1  4313                     mov             r5,a
1AB8 22         +1  4314                     ret
                +1  4315                                             
                +1  4316      ;;;;;;;;;;;;;;;;;;;      
                +1  4317      ;загрузка KD в зависимости от диап изм  
                +1  4318      ;koef->r8..r11
1AB9 78AE       +1  4319     loadKD:                 mov             r0,#diap
1ABB E6         +1  4320                                     mov             a,@r0
1ABC 900000   F +1  4321                                     mov             dptr,#diKDn
1ABF 75F004     +1  4322                                     mov             b,#4
1AC2 A4         +1  4323                                     mul             ab
1AC3 FF         +1  4324                                     mov             r7,a;save
1AC4 93         +1  4325                                     movc    a,@a+dptr
1AC5 F508       +1  4326                                     mov             r8,a
1AC7 A3         +1  4327                                     inc             dptr
1AC8 EF         +1  4328                                     mov             a,r7
1AC9 93         +1  4329                                     movc    a,@a+dptr
1ACA F509       +1  4330                                     mov             r9,a
1ACC A3         +1  4331                                     inc             dptr
1ACD EF         +1  4332                                     mov             a,r7
1ACE 93         +1  4333                                     movc    a,@a+dptr
1ACF F50A       +1  4334                                     mov             r10,a
1AD1 A3         +1  4335                                     inc             dptr
1AD2 EF         +1  4336                                     mov             a,r7
1AD3 93         +1  4337                                     movc    a,@a+dptr
1AD4 F50B       +1  4338                                     mov             r11,a
1AD6 22         +1  4339                                     ret
                +1  4340     
1AD7 3F506B7B   +1  4341      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    69

1ADB 3F507FCC   +1  4342                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
1ADF 3F4F9D0B   +1  4343                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
1AE3 3F4FE869   +1  4344                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
1AE7 3F50294A   +1  4345                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
1AEB 3F50639E   +1  4346                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
1AEF 3F4BC9F0   +1  4347                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
1AF3 3F4C063B   +1  4348                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
1AF7 3F50EFDD   +1  4349                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
1AFB 3F512AD9   +1  4350                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  4351     
1AFF 00000039   +1  4352     ch57:   db      00,00,00,39h;57
1B03 00000014   +1  4353     ch20:   db      00,00,00,14h;20
                +1  4354     
                +1  4355     ;загр ус для тестов ацп 
                +1  4356     ;dptr-
1B07 78B1       +1  4357     lotpus: mov             r0,#vichR
1B09 B6210D     +1  4358                                     cjne    @r0,#21h,te22
1B0C 900000   F +1  4359                                     mov                     dptr,#tabt11;заслать ус 11А
1B0F E4         +1  4360     lotp:           clr             a
1B10 93         +1  4361                             movc    a,@a+dptr                               ;high byte
1B11 F584       +1  4362                             mov             p4,a
1B13 A3         +1  4363                             inc             dptr
1B14 E4         +1  4364                             clr             a
1B15 93         +1  4365                             movc    a,@a+dptr                               ;low byte
1B16 F585       +1  4366                             mov             p5,a
1B18 22         +1  4367                             ret
1B19 B62205     +1  4368     te22:                   cjne    @r0,#22h,te23
1B1C 900000   F +1  4369                             mov                     dptr,#tabt9;заслать ус 9А       
1B1F 80EE       +1  4370                             jmp                     lotp
                +1  4371     
1B21 900000   F +1  4372     te23:   mov                     dptr,#tabt7;заслать ус 7А       
1B24 80E9       +1  4373                             jmp                     lotp
                +1  4374     
                +1  4375     
                +1  4376     
                +1  4377     
                +1  4378     
1B26 02030405   +1  4379     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
1B2A 06070809                
1B2E 0A0B                    
                +1  4380     
1B30 78AE       +1  4381     findR:                  mov                     r0,#diap
1B32 E6         +1  4382                                                     mov                     a,@r0
1B33 900000   F +1  4383                                                     mov                     dptr,#Tabn
1B36 93         +1  4384                                                     movc            a,@a+dptr
1B37 22         +1  4385                                                     ret
                    4386     
                    4387     ;$include (d:\amp\sarifm3.asm) 
                +1  4388     ; ” ©« SARIFM.ASM 8.11.95
                +1  4389     ;файл арифметики
                +1  4390       
  0008          +1  4391     ltemp    equ       8           ;long temporary
  000C          +1  4392     xtemp    equ       12          ;other temporaries
  000A          +1  4393     DECSIZE  EQU       10
  0004          +1  4394     NUMSIZE  EQU       4
  0004          +1  4395     RR4  EQU       4
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    70

  0005          +1  4396     RR5  EQU       5
                +1  4397     
                +1  4398                                                     
                +1  4399     
                +1  4400                 ; rseg     ARIF          ; Switch to this code segment.
                +1  4401     ;             using    0              ; Specify register bank for the following
                +1  4402                                            ; program code.
                +1  4403     ;                                               cseg AT 400h
                +1  4404     ; Arithmetics:  CLEARING string
                +1  4405     ; Input:
                +1  4406     ; R0 - pointer to string,
                +1  4407     ; NUMSIZE - byte count if CLRNUM used,
                +1  4408     ; DECSIZE - byte count if CLRDEC used,
                +1  4409     ; R2 - byte count if CLEAR used;
                +1  4410     ; Output:  none.
                +1  4411     
1B38            +1  4412     CLRDEC:
1B38 7A0A       +1  4413         MOV R2, #DECSIZE
1B3A 8002       +1  4414         SJMP    CLEAR
1B3C            +1  4415     CLRNUM:
1B3C 7A04       +1  4416         MOV R2, #NUMSIZE
                +1  4417         ;JMP    CLEAR
1B3E            +1  4418     CLEAR:
1B3E E4         +1  4419         CLR A
1B3F F6         +1  4420     CLR11:  MOV @R0, A
1B40 08         +1  4421         INC R0
1B41 DAFC       +1  4422         DJNZ    R2, CLR11
1B43 22         +1  4423         RET
                +1  4424     
                +1  4425     ;**********************************
                +1  4426     ;mov    r1,#abin+3
                +1  4427     ;mov    r0,#adec
                +1  4428     ; _ _ _ _
                +1  4429     ;     03ff
                +1  4430     ;ст     мл   - вход
                +1  4431     ; _ _ _ _ _ _ _ _ _ _
                +1  4432     ;             1 0 2 3
                +1  4433     ;ст                мл 
                +1  4434     ;**********************************
                +1  4435     
1B44            +1  4436     BINDEC:
                +1  4437     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  4438     ; Input:
                +1  4439     ; R0 - pointer to destination (high digit is the first),
                +1  4440     ; R1 - pointer to source,
                +1  4441     ; NUMSIZE - byte count in binary number;
                +1  4442     ; DECSIZE - byte count in decimal number;
                +1  4443     ; Output:  none.
                +1  4444     ; Source saved
                +1  4445     
                +1  4446         ; 1. Clear result
1B44 7A05       +1  4447         MOV R2, #DECSIZE/2
1B46 120000   F +1  4448         CALL   CLEAR  ; incrementing R0
                +1  4449     
                +1  4450         ; 2. Prepare convertion
1B49 18         +1  4451         DEC R0
1B4A 8804       +1  4452         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
1B4C 8905       +1  4453         MOV RR5, R1 ; R5 - pointer to low byte of binary number
1B4E 7B20       +1  4454         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  4455     
                +1  4456         ; 3. Convert cyrcle
1B50            +1  4457     BIN30:
                +1  4458     
                +1  4459         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
1B50 A905       +1  4460         MOV R1, RR5
1B52 7A04       +1  4461         MOV R2, #NUMSIZE
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    71

1B54 E7         +1  4462     BIN31:  MOV A, @R1
1B55 33         +1  4463         RLC A
1B56 F7         +1  4464         MOV @R1, A
1B57 19         +1  4465         DEC R1
1B58 DAFA       +1  4466         DJNZ    R2, BIN31
1B5A A905       +1  4467         MOV R1, RR5
1B5C E7         +1  4468         MOV A, @R1
1B5D 92E0       +1  4469         MOV ACC.0, C
1B5F F7         +1  4470         MOV @R1, A
                +1  4471     
                +1  4472         ; 3.2. Doubling decimal result with <Carry>
1B60 A804       +1  4473         MOV R0, RR4
1B62 7A05       +1  4474         MOV R2, #DECSIZE/2
1B64 E6         +1  4475     BIN32:  MOV A, @R0
1B65 36         +1  4476         ADDC    A, @R0
1B66 D4         +1  4477         DA  A
1B67 F6         +1  4478         MOV @R0, A
1B68 18         +1  4479         DEC R0
1B69 DAF9       +1  4480         DJNZ    R2, BIN32
                +1  4481     
                +1  4482         ; 3.3. End of convert cyrcle
1B6B DBE3       +1  4483         DJNZ    R3, BIN30
                +1  4484     
                +1  4485         ; 4. Make bytes from half-bytes
1B6D E8         +1  4486         MOV A, R0
1B6E 240A       +1  4487         ADD A, #DECSIZE
1B70 F8         +1  4488         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
1B71 A904       +1  4489         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
1B73 7A05       +1  4490         MOV R2, #DECSIZE/2
1B75 E7         +1  4491     BIN41:  MOV A, @R1
1B76 540F       +1  4492         ANL A, #00FH
1B78 F6         +1  4493         MOV @R0, A
1B79 18         +1  4494         DEC R0
1B7A E7         +1  4495         MOV A, @R1
1B7B C4         +1  4496         SWAP    A
1B7C 540F       +1  4497         ANL A, #00FH
1B7E F6         +1  4498         MOV @R0, A
1B7F 18         +1  4499         DEC R0
1B80 19         +1  4500         DEC R1
1B81 DAF2       +1  4501         DJNZ    R2, BIN41
1B83 22         +1  4502         RET
                +1  4503     
                +1  4504     
                +1  4505     ;*********************************
                +1  4506     ;mov    r0,#abin
                +1  4507     ;mov    r1,#adec
                +1  4508     ; _ _ _ _       -выход
                +1  4509     ; ff0000
                +1  4510     ;0004
                +1  4511     ;мл      ст
                +1  4512     
                +1  4513     ;ст                       мл
                +1  4514     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  4515     ;                       2 5 5
                +1  4516     ;                   1 0 2 4
                +1  4517     
1B84            +1  4518     DECBIN:
                +1  4519     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  4520     ; Input:
                +1  4521     ; R0 - pointer to destination,
                +1  4522     ; R1 - pointer to source (high digit is the first),
                +1  4523     ; NUMSIZE - byte count in binary number;
                +1  4524     ; DECSIZE - byte count in decimal number;
                +1  4525     ; Output:  none
                +1  4526     ; Source cleared
                +1  4527     
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    72

                +1  4528         ; 1. Clear result
1B84 120000   F +1  4529         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  4530     
                +1  4531         ; 2. Prepare convertion
1B87 18         +1  4532         DEC R0
1B88 8804       +1  4533         MOV RR4, R0 ; R4 - pointer to high byte of binary result
1B8A 8905       +1  4534         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
1B8C 900000   F +1  4535         MOV DPTR, #DECT2
1B8F 7B20       +1  4536         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  4537     
                +1  4538         ; 3. Convert cyrcle
1B91            +1  4539     DEC30:
                +1  4540     
                +1  4541         ; 3.1. Divide decimal number by 2 and prepare <Carry>
1B91 C3         +1  4542         CLR C
1B92 A905       +1  4543         MOV R1, RR5
1B94 7A0A       +1  4544         MOV R2, #DECSIZE
1B96 E7         +1  4545     DEC31:  MOV A, @R1
1B97 540F       +1  4546         ANL A, #00FH
1B99 92E4       +1  4547         MOV ACC.4, C
1B9B 93         +1  4548         MOVC    A,@A+DPTR
1B9C F7         +1  4549         MOV @R1, A
1B9D A2E7       +1  4550         MOV C, ACC.7
1B9F 09         +1  4551         INC R1
1BA0 DAF4       +1  4552         DJNZ    R2, DEC31
                +1  4553     
                +1  4554         ; 3.2. Rotate binary result one bit to right with <Carry>
1BA2 A804       +1  4555         MOV R0, RR4
1BA4 7A04       +1  4556         MOV R2, #NUMSIZE
1BA6 E6         +1  4557     DEC32:  MOV A, @R0
1BA7 13         +1  4558         RRC A
1BA8 F6         +1  4559         MOV @R0, A
1BA9 18         +1  4560         DEC R0
1BAA DAFA       +1  4561         DJNZ    R2, DEC32
                +1  4562     
                +1  4563         ; 3.3. End of convert cyrcle
1BAC DBE3       +1  4564         DJNZ    R3, DEC30
1BAE 22         +1  4565         RET
                +1  4566     
1BAF 00800181   +1  4567     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
1BB3 02820383                
1BB7 0484                    
1BB9 00000000   +1  4568         DB  00,00,00,00,00,00
1BBD 0000                    
1BBF 05850686   +1  4569         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
1BC3 07870888                
1BC7 0989                    
                +1  4570     
                +1  4571     ;   Long comparison
                +1  4572     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  4573     ;   flags and acc set as though a long subtraction was done.
                +1  4574     ;*******************************
                +1  4575     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  4576     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  4577     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  4578     ;*******************************
1BC9            +1  4579     lcmp:
1BC9 C3         +1  4580         clr c
1BCA EA         +1  4581         mov a,r2
1BCB 9508       +1  4582         subb    a,8
1BCD 700F       +1  4583         jnz done
1BCF EB         +1  4584         mov a,r3
1BD0 9509       +1  4585         subb    a,9
1BD2 7008       +1  4586         jnz done1
1BD4 EC         +1  4587         mov a,r4
1BD5 950A       +1  4588         subb    a,10
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    73

1BD7 7003       +1  4589         jnz done1
1BD9 ED         +1  4590         mov a,r5
1BDA 950B       +1  4591         subb    a,11
1BDC            +1  4592     done1:
1BDC C2D2       +1  4593         clr ov      ;overflow is significant only for top byte
1BDE            +1  4594     done:
1BDE 22         +1  4595         ret
                +1  4596     
                +1  4597     ;   Load long into r2-5 from [dptr]
                +1  4598     
1BDF            +1  4599     ldc_long:
1BDF E583       +1  4600         mov a,dph       ;is it in on board memory
1BE1 6010       +1  4601         jz  onboard     ;yes
1BE3 E4         +1  4602         clr a
1BE4 93         +1  4603         movc    a,@a+dptr
1BE5 FA         +1  4604         mov r2,a
1BE6 7401       +1  4605         mov a,#1
1BE8 93         +1  4606         movc    a,@a+dptr
1BE9 FB         +1  4607         mov r3,a
1BEA 7402       +1  4608         mov a,#2
1BEC 93         +1  4609         movc    a,@a+dptr
1BED FC         +1  4610         mov r4,a
1BEE 7403       +1  4611         mov a,#3
1BF0 93         +1  4612         movc    a,@a+dptr
1BF1 FD         +1  4613         mov r5,a
1BF2 22         +1  4614         ret
1BF3            +1  4615     onboard:
1BF3 A882       +1  4616         mov r0,dpl
1BF5 E6         +1  4617         mov a,@r0
1BF6 FA         +1  4618         mov r2,a
1BF7 08         +1  4619         inc r0
1BF8 E6         +1  4620         mov a,@r0
1BF9 FB         +1  4621         mov r3,a
1BFA 08         +1  4622         inc r0
1BFB E6         +1  4623         mov a,@r0
1BFC FC         +1  4624         mov r4,a
1BFD 08         +1  4625         inc r0
1BFE E6         +1  4626         mov a,@r0
1BFF FD         +1  4627         mov r5,a
1C00 22         +1  4628         ret
                +1  4629     
                +1  4630     ;**************************************
                +1  4631     ;загрузить ltemp...+3 из памяти программ
                +1  4632     ;mov    dptr,#CH5
                +1  4633     ;call   ldc_ltemp        ltemp <--5
                +1  4634     ;**************************************
1C01            +1  4635     ldc_ltemp:
1C01 E583       +1  4636         mov a,dph       ;is it in on board memory
1C03 6014       +1  4637         jz  oboard      ;yes
1C05 E4         +1  4638         clr a
1C06 93         +1  4639         movc    a,@a+dptr
1C07 F508       +1  4640         mov 8,a
1C09 7401       +1  4641         mov a,#1
1C0B 93         +1  4642         movc    a,@a+dptr
1C0C F509       +1  4643         mov 9,a
1C0E 7402       +1  4644         mov a,#2
1C10 93         +1  4645         movc    a,@a+dptr
1C11 F50A       +1  4646         mov 10,a
1C13 7403       +1  4647         mov a,#3
1C15 93         +1  4648         movc    a,@a+dptr
1C16 F50B       +1  4649         mov 11,a
1C18 22         +1  4650         ret
1C19            +1  4651     oboard:
1C19 A882       +1  4652         mov r0,dpl
1C1B 8608       +1  4653         mov 8,@r0
1C1D 08         +1  4654         inc r0
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    74

1C1E 8609       +1  4655         mov 9,@r0
1C20 08         +1  4656         inc r0
1C21 860A       +1  4657         mov 10,@r0
1C23 08         +1  4658         inc r0
1C24 860B       +1  4659         mov 11,@r0
1C26 22         +1  4660         ret
                +1  4661     
                +1  4662     ;*****************************
                +1  4663     ;mov    dptr,#k1
                +1  4664     ;call   ldx_long
                +1  4665     ;k1->r2..r5
                +1  4666     ;*****************************
                +1  4667     ;   Load long into r2-5 from [dptr]
                +1  4668     ;
                +1  4669     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
1C27            +1  4670     ldx_long:
1C27 E583       +1  4671         mov a,dph       ;is it in on board memory
1C29 6014       +1  4672         jz  onboar1        ;yes
1C2B C082       +1  4673         push    dpl
1C2D C083       +1  4674         push    dph
1C2F E0         +1  4675         movx    a,@dptr
1C30 FA         +1  4676         mov r2,a
1C31 A3         +1  4677         inc dptr
1C32 E0         +1  4678         movx    a,@dptr
1C33 FB         +1  4679         mov r3,a
1C34 A3         +1  4680         inc dptr
1C35 E0         +1  4681         movx    a,@dptr
1C36 FC         +1  4682         mov r4,a
1C37 A3         +1  4683         inc dptr
1C38 E0         +1  4684         movx    a,@dptr
1C39 FD         +1  4685         mov r5,a
1C3A D083       +1  4686         pop dph
1C3C D082       +1  4687         pop dpl
1C3E 22         +1  4688         ret
1C3F            +1  4689     onboar1:
1C3F A882       +1  4690         mov r0,dpl
1C41 E6         +1  4691         mov a,@r0
1C42 FA         +1  4692         mov r2,a
1C43 08         +1  4693         inc r0
1C44 E6         +1  4694         mov a,@r0
1C45 FB         +1  4695         mov r3,a
1C46 08         +1  4696         inc r0
1C47 E6         +1  4697         mov a,@r0
1C48 FC         +1  4698         mov r4,a
1C49 08         +1  4699         inc r0
1C4A E6         +1  4700         mov a,@r0
1C4B FD         +1  4701         mov r5,a
1C4C 22         +1  4702         ret
                +1  4703     
                +1  4704     ;*********************************
                +1  4705     ;mov    dptr,#k2
                +1  4706     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  4707     ;**********************************
1C4D            +1  4708     ldx_ltemp:
1C4D E583       +1  4709         mov a,dph       ;is it in on board memory
1C4F 6010       +1  4710         jz  oboard1     ;yes
1C51 E0         +1  4711         movx    a,@dptr
1C52 F508       +1  4712         mov 8,a
1C54 A3         +1  4713         inc dptr
1C55 E0         +1  4714         movx    a,@dptr
1C56 F509       +1  4715         mov 9,a
1C58 A3         +1  4716         inc dptr
1C59 E0         +1  4717         movx    a,@dptr
1C5A F50A       +1  4718         mov 10,a
1C5C A3         +1  4719         inc dptr
1C5D E0         +1  4720         movx    a,@dptr
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    75

1C5E F50B       +1  4721         mov 11,a
1C60 22         +1  4722         ret
1C61            +1  4723     oboard1:
1C61 A882       +1  4724         mov r0,dpl
1C63 8608       +1  4725         mov 8,@r0
1C65 08         +1  4726         inc r0
1C66 8609       +1  4727         mov 9,@r0
1C68 08         +1  4728         inc r0
1C69 860A       +1  4729         mov 10,@r0
1C6B 08         +1  4730         inc r0
1C6C 860B       +1  4731         mov 11,@r0
1C6E 22         +1  4732         ret
                +1  4733     ;   Long division routines for 8051
                +1  4734     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  4735     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  4736     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  4737     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  4738     ;   r1 must be saved by the caller.
                +1  4739     ;   This is long unsigned division.
                +1  4740     
                +1  4741     
                +1  4742     ;   Register usage:
                +1  4743     ;       r0 loop counter
                +1  4744     ;       xtemp (12-15) accumulates quotient
                +1  4745     ;       r5-r2 holds dividend
                +1  4746     ;       ltemp holds divisor
                +1  4747     
                +1  4748     ;************************************
                +1  4749     ;r2..r5-делимое
                +1  4750     ;ltemp..-делитель
                +1  4751     ;частное -r2..r5
                +1  4752     ;*************************************
1C6F            +1  4753     divide:
1C6F E4         +1  4754         clr a
1C70 F8         +1  4755         mov r0,a        ;initialize count
1C71 F50C       +1  4756         mov xtemp,a     ;zero quotient
1C73 F50D       +1  4757         mov xtemp+1,a
1C75 F50E       +1  4758         mov xtemp+2,a
1C77 F50F       +1  4759         mov xtemp+3,a
1C79 ED         +1  4760         mov a,r5        ;check for zero dividend
1C7A 4C         +1  4761         orl a,r4
1C7B 4B         +1  4762         orl a,r3
1C7C 4A         +1  4763         orl a,r2
1C7D 600B       +1  4764         jz  jfinis
1C7F E508       +1  4765         mov a,ltemp     ;check for zero divisor
1C81 4509       +1  4766         orl a,ltemp+1
1C83 450A       +1  4767         orl a,ltemp+2
1C85 450B       +1  4768         orl a,ltemp+3
1C87 7037       +1  4769         jnz midl
1C89 22         +1  4770         ret
                +1  4771     
1C8A 020000   F +1  4772     jfinis: jmp finis
                +1  4773     
1C8D            +1  4774     loops:
1C8D EA         +1  4775         mov a,r2
1C8E C3         +1  4776         clr c
1C8F 9508       +1  4777         subb    a,ltemp+0   ;is divisor greater than dividend yet
1C91 4033       +1  4778         jc  yes     ;yes, go no further
1C93 7013       +1  4779         jnz no
1C95 EB         +1  4780         mov a,r3
1C96 9509       +1  4781         subb    a,ltemp+1
1C98 402C       +1  4782         jc  yes
1C9A 700C       +1  4783         jnz no
1C9C EC         +1  4784         mov a,r4
1C9D 950A       +1  4785         subb    a,ltemp+2
1C9F 4025       +1  4786         jc  yes
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    76

1CA1 7005       +1  4787         jnz no
1CA3 ED         +1  4788         mov a,r5
1CA4 950B       +1  4789         subb    a,ltemp+3
1CA6 401E       +1  4790         jc  yes
1CA8            +1  4791     no:
1CA8 E50B       +1  4792         mov a,ltemp+3   ;shift divisor up one bit
1CAA 250B       +1  4793         add a,ltemp+3
1CAC F50B       +1  4794         mov ltemp+3,a
1CAE E50A       +1  4795         mov a,ltemp+2
1CB0 350A       +1  4796         addc    a,ltemp+2
1CB2 F50A       +1  4797         mov ltemp+2,a
1CB4 E509       +1  4798         mov a,ltemp+1
1CB6 3509       +1  4799         addc    a,ltemp+1
1CB8 F509       +1  4800         mov ltemp+1,a
1CBA E508       +1  4801         mov a,ltemp+0
1CBC 3508       +1  4802         addc    a,ltemp+0
1CBE F508       +1  4803         mov ltemp+0,a
1CC0            +1  4804     midl:
1CC0 08         +1  4805         inc r0      ;increment count
1CC1 E508       +1  4806         mov a,ltemp+0   ;check for safe to shift some more
1CC3 30E7C7     +1  4807         jnb acc.7,loops  ;loop if top bit clear
1CC6            +1  4808     yes:
1CC6 E508       +1  4809         mov a,ltemp+0
1CC8 C3         +1  4810         clr c
1CC9 9A         +1  4811         subb    a,r2        ;can we subtract now?
1CCA 401A       +1  4812         jc  dosub       ;yes, go and do it
1CCC 7015       +1  4813         jnz nosub
1CCE E509       +1  4814         mov a,ltemp+1
1CD0 9B         +1  4815         subb    a,r3
1CD1 4013       +1  4816         jc  dosub
1CD3 700E       +1  4817         jnz nosub
1CD5 E50A       +1  4818         mov a,ltemp+2
1CD7 9C         +1  4819         subb    a,r4
1CD8 400C       +1  4820         jc  dosub
1CDA 7007       +1  4821         jnz nosub
1CDC E50B       +1  4822         mov a,ltemp+3
1CDE 9D         +1  4823         subb    a,r5
1CDF 4005       +1  4824         jc  dosub
1CE1 6003       +1  4825         jz  dosub
1CE3            +1  4826     nosub:
1CE3 C3         +1  4827         clr c
1CE4 8012       +1  4828         sjmp    dosh
1CE6            +1  4829     dosub:
1CE6 C3         +1  4830         clr c       ;subtract divisor from dividend
1CE7 ED         +1  4831         mov a,r5
1CE8 950B       +1  4832         subb    a,ltemp+3
1CEA FD         +1  4833         mov r5,a
1CEB EC         +1  4834         mov a,r4
1CEC 950A       +1  4835         subb    a,ltemp+2
1CEE FC         +1  4836         mov r4,a
1CEF EB         +1  4837         mov a,r3
1CF0 9509       +1  4838         subb    a,ltemp+1
1CF2 FB         +1  4839         mov r3,a
1CF3 EA         +1  4840         mov a,r2
1CF4 9508       +1  4841         subb    a,ltemp+0
1CF6 FA         +1  4842         mov r2,a
1CF7 D3         +1  4843         setb    c       ;now set bit for quotient
1CF8            +1  4844     dosh:
1CF8 E50F       +1  4845         mov a,xtemp+3
1CFA 33         +1  4846         rlc a
1CFB F50F       +1  4847         mov xtemp+3,a
1CFD E50E       +1  4848         mov a,xtemp+2
1CFF 33         +1  4849         rlc a
1D00 F50E       +1  4850         mov xtemp+2,a
1D02 E50D       +1  4851         mov a,xtemp+1
1D04 33         +1  4852         rlc a
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    77

1D05 F50D       +1  4853         mov xtemp+1,a
1D07 E50C       +1  4854         mov a,xtemp+0
1D09 33         +1  4855         rlc a
1D0A F50C       +1  4856         mov xtemp+0,a
1D0C E508       +1  4857         mov a,ltemp+0       ;shift divisor down
1D0E C3         +1  4858         clr c
1D0F 13         +1  4859         rrc a
1D10 F508       +1  4860         mov ltemp+0,a
1D12 E509       +1  4861         mov a,ltemp+1
1D14 13         +1  4862         rrc a
1D15 F509       +1  4863         mov ltemp+1,a
1D17 E50A       +1  4864         mov a,ltemp+2
1D19 13         +1  4865         rrc a
1D1A F50A       +1  4866         mov ltemp+2,a
1D1C E50B       +1  4867         mov a,ltemp+3
1D1E 13         +1  4868         rrc a
1D1F F50B       +1  4869         mov ltemp+3,a
                +1  4870     
1D21 D8A3       +1  4871         djnz    r0,yes      ;and continue with the rest
                +1  4872     
1D23            +1  4873     finis:
1D23 8D0B       +1  4874         mov ltemp+3,r5
1D25 8C0A       +1  4875         mov ltemp+2,r4
1D27 8B09       +1  4876         mov ltemp+1,r3
1D29 8A08       +1  4877         mov ltemp+0,r2
1D2B AD0F       +1  4878         mov r5,xtemp+3
1D2D AC0E       +1  4879         mov r4,xtemp+2
1D2F AB0D       +1  4880         mov r3,xtemp+1
1D31 AA0C       +1  4881         mov r2,xtemp+0
1D33 22         +1  4882         ret         ;and return with the satisfaction of a job well done
                +1  4883     
                +1  4884     
                +1  4885     ;   Long multiplication
                +1  4886     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  4887     ;   other in ltemp. It really doesn't matter which one is where.
                +1  4888     
                +1  4889     ;**********************************
                +1  4890     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  4891     ;ст  мл
                +1  4892     ;**********************************
1D34            +1  4893     llmul:
1D34            +1  4894     almul:
1D34            +1  4895     lmul:
1D34 ED         +1  4896         mov a,r5        ;low order byte
1D35 850BF0     +1  4897         mov b,ltemp+3       ;times low order byte
1D38 A4         +1  4898         mul ab
1D39 F50F       +1  4899         mov xtemp+3,a       ;store low
1D3B 85F00E     +1  4900         mov xtemp+2,b   ;and high
1D3E ED         +1  4901         mov a,r5        ;low order
1D3F 850AF0     +1  4902         mov b,ltemp+2   ;times next
1D42 A4         +1  4903         mul ab
1D43 250E       +1  4904         add a,xtemp+2   ;add in
1D45 F50E       +1  4905         mov xtemp+2,a
1D47 E5F0       +1  4906         mov a,b
1D49 3400       +1  4907         addc    a,#0
1D4B F50D       +1  4908         mov xtemp+1,a
1D4D ED         +1  4909         mov a,r5
1D4E 8509F0     +1  4910         mov b,ltemp+1
1D51 A4         +1  4911         mul ab
1D52 250D       +1  4912         add a,xtemp+1
1D54 F50D       +1  4913         mov xtemp+1,a
1D56 E5F0       +1  4914         mov a,b
1D58 3400       +1  4915         addc    a,#0
1D5A F50C       +1  4916         mov xtemp+0,a
1D5C ED         +1  4917         mov a,r5
1D5D 8508F0     +1  4918         mov b,ltemp+0
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    78

1D60 A4         +1  4919         mul ab
1D61 250C       +1  4920         add a,xtemp+0
1D63 F50C       +1  4921         mov xtemp+0,a
1D65 EC         +1  4922         mov a,r4
1D66 850BF0     +1  4923         mov b,ltemp+3
1D69 A4         +1  4924         mul ab
1D6A 250E       +1  4925         add a,xtemp+2
1D6C F50E       +1  4926         mov xtemp+2,a
1D6E E5F0       +1  4927         mov a,b
1D70 350D       +1  4928         addc    a,xtemp+1
1D72 F50D       +1  4929         mov xtemp+1,a
1D74 E50C       +1  4930         mov a,xtemp+0
1D76 3400       +1  4931         addc    a,#0
1D78 F50C       +1  4932         mov xtemp+0,a
1D7A EC         +1  4933         mov a,r4
1D7B 850AF0     +1  4934         mov b,ltemp+2
1D7E A4         +1  4935         mul ab
1D7F 250D       +1  4936         add a,xtemp+1
1D81 F50D       +1  4937         mov xtemp+1,a
1D83 E5F0       +1  4938         mov a,b
1D85 350C       +1  4939         addc    a,xtemp+0
1D87 F50C       +1  4940         mov xtemp+0,a
1D89 EC         +1  4941         mov a,r4
1D8A 8509F0     +1  4942         mov b,ltemp+1
1D8D A4         +1  4943         mul ab
1D8E 250C       +1  4944         add a,xtemp+0
1D90 F50C       +1  4945         mov xtemp+0,a
                +1  4946     
1D92 EB         +1  4947         mov a,r3
1D93 850BF0     +1  4948         mov b,ltemp+3
1D96 A4         +1  4949         mul ab
1D97 250D       +1  4950         add a,xtemp+1
1D99 F50D       +1  4951         mov xtemp+1,a
1D9B E5F0       +1  4952         mov a,b
1D9D 350C       +1  4953         addc    a,xtemp+0
1D9F F50C       +1  4954         mov xtemp+0,a
1DA1 EB         +1  4955         mov a,r3
1DA2 850AF0     +1  4956         mov b,ltemp+2
1DA5 A4         +1  4957         mul ab
1DA6 250C       +1  4958         add a,xtemp+0
1DA8 F50C       +1  4959         mov xtemp+0,a
                +1  4960     
1DAA EA         +1  4961         mov a,r2
1DAB 850BF0     +1  4962         mov b,ltemp+3
1DAE A4         +1  4963         mul ab
1DAF 250C       +1  4964         add a,xtemp+0
1DB1 FA         +1  4965         mov r2,a
1DB2 AB0D       +1  4966         mov r3,xtemp+1
1DB4 AC0E       +1  4967         mov r4,xtemp+2
1DB6 AD0F       +1  4968         mov r5,xtemp+3
                +1  4969     
1DB8 22         +1  4970         ret         ;all done
                +1  4971     ;******************************
                +1  4972     ;из содержимого  r2-r5  вычесть
                +1  4973     ;содержимое          ltemp..ltemp+3
                +1  4974     ;******************************
1DB9            +1  4975     llsub:
1DB9            +1  4976      lsub:
1DB9 ED         +1  4977         mov a,r5
1DBA C3         +1  4978         clr c
1DBB 950B       +1  4979         subb    a,11
1DBD FD         +1  4980         mov r5,a
1DBE EC         +1  4981         mov a,r4
1DBF 950A       +1  4982         subb    a,10
1DC1 FC         +1  4983         mov r4,a
1DC2 EB         +1  4984         mov a,r3
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    79

1DC3 9509       +1  4985         subb    a,9
1DC5 FB         +1  4986         mov r3,a
1DC6 EA         +1  4987         mov a,r2
1DC7 9508       +1  4988         subb    a,8
1DC9 FA         +1  4989         mov r2,a
1DCA 22         +1  4990         ret
                +1  4991     
                +1  4992     ;***********************************************
                +1  4993     ;                                                      ст мл
                +1  4994     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4995     ;  r0- адрес младшего байта !!!
                +1  4996     ;результат- r2..r5
                +1  4997     ;***********************************************
                +1  4998     
1DCB C3         +1  4999     ladd:    clr       c
1DCC ED         +1  5000          mov       a,r5
1DCD 26         +1  5001          add       a,@r0
1DCE FD         +1  5002          mov       r5,a
1DCF 18         +1  5003          dec       r0
1DD0 EC         +1  5004          mov       a,r4
1DD1 36         +1  5005          addc      a,@r0
1DD2 FC         +1  5006          mov       r4,a
1DD3 18         +1  5007          dec       r0
1DD4 EB         +1  5008          mov       a,r3
1DD5 36         +1  5009          addc      a,@r0
1DD6 FB         +1  5010          mov       r3,a
1DD7 18         +1  5011          dec       r0
1DD8 EA         +1  5012          mov       a,r2
1DD9 36         +1  5013          addc      a,@r0
1DDA FA         +1  5014          mov       r2,a
1DDB 22         +1  5015          ret
                +1  5016     ;***********************************************
                +1  5017     ;                                                      ст мл
                +1  5018     ; cложение содержимого  r2..r5 с числом по адресу
                +1  5019     ;  r0- адрес младшего байта !!!
                +1  5020     ;результат- r2..r5
                +1  5021     ;***********************************************
                +1  5022     
1DDC C3         +1  5023     laddx:    clr       c
1DDD E2         +1  5024                                             movx            a,@r0
1DDE 2D         +1  5025                                             add                     a,r5
1DDF FD         +1  5026               mov     r5,a
1DE0 18         +1  5027                             dec     r0
1DE1 E2         +1  5028                             movx    a,@r0
1DE2 3C         +1  5029                             addc    a,r4
1DE3 FC         +1  5030                             mov     r4,a
1DE4 18         +1  5031                             dec     r0
1DE5 E2         +1  5032                             movx    a,@r0
1DE6 3B         +1  5033                             addc    a,r3
1DE7 FB         +1  5034                             mov     r3,a
1DE8 18         +1  5035                             dec     r0
1DE9 E2         +1  5036                             movx    a,@r0
1DEA 3A         +1  5037                             addc    a,r2
1DEB FA         +1  5038                             mov       r2,a
1DEC 22         +1  5039                             ret
                +1  5040     
                +1  5041     ;***********************************************
                +1  5042     ;                                                      ст мл
                +1  5043     ; cложение содержимого  r2..r5 с числом по адресу
                +1  5044     ;  dptr- адрес младшего байта !!!
                +1  5045     ;результат- r2..r5
                +1  5046     ;***********************************************
                +1  5047     
1DED C3         +1  5048     addx:    clr       c
1DEE E0         +1  5049                                             movx            a,@dptr
1DEF 2D         +1  5050                                             add                     a,r5
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    80

1DF0 FD         +1  5051               mov     r5,a
1DF1 120000   F +1  5052                             call            dedptr;dec     dptr
1DF4 E0         +1  5053                             movx    a,@dptr
1DF5 3C         +1  5054                             addc    a,r4
1DF6 FC         +1  5055                             mov     r4,a
1DF7 120000   F +1  5056                             call            dedptr;dec     dptr
1DFA E0         +1  5057                             movx    a,@dptr
1DFB 3B         +1  5058                             addc    a,r3
1DFC FB         +1  5059                             mov     r3,a
1DFD 120000   F +1  5060                             call            dedptr;dec     dptr
1E00 E0         +1  5061                             movx    a,@dptr
1E01 3A         +1  5062                             addc    a,r2
1E02 FA         +1  5063                             mov       r2,a
1E03 22         +1  5064                             ret
                +1  5065     
1E04 C0D0       +1  5066     dedptr:         push    psw
1E06 C3         +1  5067                                             clr             c
1E07 E582       +1  5068                                             mov             a,dpl
1E09 9401       +1  5069                                             subb    a,#1
1E0B F582       +1  5070                                             mov             dpl,a
1E0D E583       +1  5071                                             mov             a,dph
1E0F 9400       +1  5072                                             subb    a,#0
1E11 F583       +1  5073                                             mov             dph,a
1E13 D0D0       +1  5074                                             pop             psw
1E15 22         +1  5075                                             ret
                    5076     
                    5077     ;$include (d:\amp\floatm.asm)
                +1  5078     ;       Copyright (C) 1988 HI-TECH Software
                +1  5079     
                +1  5080     ;       Single Precision Floating point arithmetic routines for 8051
                +1  5081     
                +1  5082     ;       The format of floating point numbers is as follows:
                +1  5083     
                +1  5084     ;       -----------------
                +1  5085     ;       *     sign      *  1 bit
                +1  5086     ;       -----------------
                +1  5087     ;       *   exponent    *  8 bits
                +1  5088     ;       -----------------
                +1  5089     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  5090     ;       -----------------
                +1  5091     
                +1  5092     
                +1  5093     ;       As usual for the 8051 the memory layout has the most significant
                +1  5094     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  5095     ;       lowest address.
                +1  5096     
                +1  5097     ;       Calling conventions:
                +1  5098     
                +1  5099     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  5100     ;
                +1  5101     ;       Return value is in r2-r5
                +1  5102     
                +1  5103     ;       Naming conventions: A routine name is constructed by
                +1  5104     
                +1  5105     ;             ASOP
                +1  5106     
                +1  5107     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  5108     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  5109     ;       Conversion routines are named
                +1  5110     
                +1  5111     ;               AStof
                +1  5112     
                +1  5113     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  5114     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  5115     ;       Conversion from float to integer is ftol.
                +1  5116     
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    81

                +1  5117     ;               .ORG  5000h
                +1  5118     ;               .CODE
                +1  5119     ;       seg     c_text
                +1  5120     
                +1  5121     ;;      $MOD812
----            +1  5122             CSEG
                +1  5123             ;ORG 1000h
                +1  5124     
                +1  5125                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  5126             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  5127     
                +1  5128     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  5129     ;       macros
                +1  5130     
                +1  5131     saveregs        macro
                +1  5132             push    7
                +1  5133             push    6
                +1  5134             push    1
                +1  5135             push    0
                +1  5136             endm
                +1  5137     
                +1  5138     restregs        macro
                +1  5139             pop     0
                +1  5140             pop     1
                +1  5141             pop     6
                +1  5142             pop     7
                +1  5143             endm
                +1  5144     
                +1  5145     ;addr   
                +1  5146     dan     macro   pad
                +1  5147             mov     a,r5
                +1  5148             add     a,pad+3
                +1  5149             mov     pad+3,a
                +1  5150             mov     a,pad+2
                +1  5151             addc    a,r4
                +1  5152             mov     pad+2,a
                +1  5153             mov     a,pad+1
                +1  5154             addc    a,r3
                +1  5155             mov     pad+1,a
                +1  5156             mov     a,pad+0
                +1  5157             addc    a,r2
                +1  5158             mov     pad,a
                +1  5159             endm
                +1  5160     
                +1  5161     addl    macro  addr
                +1  5162             mov     a,r5
                +1  5163             add     a,addr+3
                +1  5164             mov     r5,a
                +1  5165             mov     a,addr+2
                +1  5166             addc    a,r4
                +1  5167             mov     r4,a
                +1  5168             mov     a,addr+1
                +1  5169             addc    a,r3
                +1  5170             mov     r3,a
                +1  5171             mov     a,addr+0
                +1  5172             addc    a,r2
                +1  5173             mov     r2,a
                +1  5174             endm
                +1  5175     
                +1  5176     
                +1  5177     add1    macro
                +1  5178             mov     a,r5
                +1  5179             add     a,#1
                +1  5180             mov     r5,a
                +1  5181             clr     a
                +1  5182             addc    a,r4
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    82

                +1  5183             mov     r4,a
                +1  5184             clr     a
                +1  5185             addc    a,r3
                +1  5186             mov     r3,a
                +1  5187             clr     a
                +1  5188             addc    a,r2
                +1  5189             mov     r2,a
                +1  5190             endm
                +1  5191     
                +1  5192     shfdn   macro  addr
                +1  5193             clr     c
                +1  5194             mov     a,addr
                +1  5195             rrc     a
                +1  5196             mov     addr,a
                +1  5197             mov     a,addr+1
                +1  5198             rrc     a
                +1  5199             mov     addr+1,a
                +1  5200             mov     a,addr+2
                +1  5201             rrc     a
                +1  5202             mov     addr+2,a
                +1  5203             mov     a,addr+3
                +1  5204             rrc     a
                +1  5205             mov     addr+3,a
                +1  5206             endm
                +1  5207     
                +1  5208     shfup   macro  addr
                +1  5209             clr     c
                +1  5210             mov     a,addr+3
                +1  5211             rlc     a
                +1  5212             mov     addr+3,a
                +1  5213             mov     a,addr+2
                +1  5214             rlc     a
                +1  5215             mov     addr+2,a
                +1  5216             mov     a,addr+1
                +1  5217             rlc     a
                +1  5218             mov     addr+1,a
                +1  5219             mov     a,addr
                +1  5220             rlc     a
                +1  5221             mov     addr,a
                +1  5222             endm
                +1  5223     
                +1  5224     rshift  macro
                +1  5225             clr     c
                +1  5226             mov     a,r2
                +1  5227             rrc     a
                +1  5228             mov     r2,a
                +1  5229             mov     a,r3
                +1  5230             rrc     a
                +1  5231             mov     r3,a
                +1  5232             mov     a,r4
                +1  5233             rrc     a
                +1  5234             mov     r4,a
                +1  5235             mov     a,r5
                +1  5236             rrc     a
                +1  5237             mov     r5,a
                +1  5238             endm
                +1  5239     rshift1 macro
                +1  5240             setb    c
                +1  5241             mov     a,r2
                +1  5242             rrc     a
                +1  5243             mov     r2,a
                +1  5244             mov     a,r3
                +1  5245             rrc     a
                +1  5246             mov     r3,a
                +1  5247             mov     a,r4
                +1  5248             rrc     a
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    83

                +1  5249             mov     r4,a
                +1  5250             mov     a,r5
                +1  5251             rrc     a
                +1  5252             mov     r5,a
                +1  5253             endm
                +1  5254     
                +1  5255     
                +1  5256     lshift  macro
                +1  5257             mov     a,r5
                +1  5258             rlc     a
                +1  5259             mov     r5,a
                +1  5260             mov     a,r4
                +1  5261             rlc     a
                +1  5262             mov     r4,a
                +1  5263             mov     a,r3
                +1  5264             rlc     a
                +1  5265             mov     r3,a
                +1  5266             mov     a,r2
                +1  5267             rlc     a
                +1  5268             mov     r2,a
                +1  5269             endm
                +1  5270     
                +1  5271     neg1    macro
                +1  5272             clr     c
                +1  5273             clr     a
                +1  5274             subb    a,r5
                +1  5275             mov     r5,a
                +1  5276             clr     a
                +1  5277             subb    a,r4
                +1  5278             mov     r4,a
                +1  5279             clr     a
                +1  5280             subb    a,r3
                +1  5281             mov     r3,a
                +1  5282             clr     a
                +1  5283             subb    a,r2
                +1  5284             mov     r2,a
                +1  5285             endm
                +1  5286     
                +1  5287     negm    macro  addr
                +1  5288             clr     c
                +1  5289             clr     a
                +1  5290             subb    a,addr+3
                +1  5291             mov     addr+3,a
                +1  5292             clr     a
                +1  5293             subb    a,addr+2
                +1  5294             mov     addr+2,a
                +1  5295             clr     a
                +1  5296             subb    a,addr+1
                +1  5297             mov     addr+1,a
                +1  5298             clr     a
                +1  5299             subb    a,addr
                +1  5300             mov     addr,a
                +1  5301             endm
                +1  5302     
                +1  5303     copytor macro  addr
                +1  5304             mov     r2,addr
                +1  5305             mov     r3,addr+1
                +1  5306             mov     r4,addr+2
                +1  5307             mov     r5,addr+3
                +1  5308             endm
                +1  5309     
                +1  5310     
                +1  5311     copyrto macro  addr
                +1  5312             mov     addr,r2
                +1  5313             mov     addr+1,r3
                +1  5314             mov     addr+2,r4
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    84

                +1  5315             mov     addr+3,r5
                +1  5316             endm
                +1  5317     
                +1  5318     
                +1  5319     ;       Internal representation: in this set of routines a floating number
                +1  5320     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  5321     
                +1  5322     ;       Stack offset values
                +1  5323     ;ltemp   equ     28h
                +1  5324     
  0006          +1  5325     cntr    equ     6               ;r6 is the counter
  0007          +1  5326     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  5327     exp1    equ     0               ;exponent 1 in r0
  0002          +1  5328     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  5329     exp2    equ     1               ;exponent 1 in r1
  0008          +1  5330     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  5331     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  5332     
                +1  5333     
                +1  5334     
                +1  5335     
                +1  5336     
                +1  5337     ;DECSIZE EQU     10
                +1  5338     ;NUMSIZE EQU     4
                +1  5339     ;RR4     EQU     4
                +1  5340     ;RR5     EQU     5
                +1  5341     
                +1  5342     ;       unpack1 - unpacks the left operand
                +1  5343     
009E            +1  5344     unpack1:
009E EA         +1  5345             mov     a,r2            ;get sign
009F 5480       +1  5346             anl     a,#80h
00A1 530740     +1  5347             anl     sign,#40h       ;clear other bits
00A4 4207       +1  5348             orl     sign,a          ;store sign
00A6 EB         +1  5349             mov     a,r3            ;get lsb of exponent
00A7 33         +1  5350             rlc     a               ;rotate into carry
00A8 EA         +1  5351             mov     a,r2            ;get rest of exponent
00A9 33         +1  5352             rlc     a               ;and make it 8 bits
00AA F8         +1  5353             mov     r0,a            ;store it
00AB 6006       +1  5354             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  5355             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  5356             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  5357             ret
00B3            +1  5358     zer1:
00B3 E4         +1  5359             clr     a
00B4 FA         +1  5360             mov     r2,a
00B5 FB         +1  5361             mov     r3,a
00B6 FC         +1  5362             mov     r4,a
00B7 FD         +1  5363             mov     r5,a            ;zero mantissa
00B8 F8         +1  5364             mov     r0,a            ;zero exponent
00B9 22         +1  5365             ret
                +1  5366     
                +1  5367     ;       unpack2 - unpacks right operand
                +1  5368     
00BA            +1  5369     unpack2:
00BA E508       +1  5370             mov     a,ltemp         ;get sign
00BC 13         +1  5371             rrc     a               ;shift down
00BD 5440       +1  5372             anl     a,#40h          ;mask out sign
00BF 530780     +1  5373             anl     sign,#80h       ;clear old bit
00C2 4207       +1  5374             orl     sign,a
00C4 E509       +1  5375             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  5376             rlc     a               ;rotate into carry
00C7 E508       +1  5377             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  5378             rlc     a               ;and make it 8 bits
00CA F9         +1  5379             mov     r1,a            ;store it
00CB 6007       +1  5380             jz      zer2            ;if zero, the whole thing is zero
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    85

00CD 430980     +1  5381             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  5382             mov     mant2,#0        ;clear upper byte
00D3 22         +1  5383             ret
00D4            +1  5384     zer2:
00D4 E4         +1  5385             clr     a
00D5 F508       +1  5386             mov     ltemp,a
00D7 F509       +1  5387             mov     ltemp+1,a
00D9 F50A       +1  5388             mov     ltemp+2,a
00DB F50B       +1  5389             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  5390             ret
                +1  5391     
                +1  5392     ;       pack1 - put operand 1 back into float format
                +1  5393     
00DE            +1  5394     pack1:
00DE E8         +1  5395             mov     a,r0            ;get exponent
00DF C3         +1  5396             clr     c
00E0 13         +1  5397             rrc     a               ;shift down 1 bit
00E1 530780     +1  5398             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  5399             orl     a,r7            ;or in sign bit
00E5 FA         +1  5400             mov     r2,a            ;store
00E6 E8         +1  5401             mov     a,r0            ;get other bit
00E7 03         +1  5402             rr      a               ;rotate into hi bit
00E8 5480       +1  5403             anl     a,#80h          ;mask
00EA 53037F     +1  5404             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  5405             orl     mant1+1,a       ;put in
00EF 22         +1  5406             ret
                +1  5407     
                +1  5408     
                +1  5409     ;       norm1 - normalize the unpacked value in 1
                +1  5410     
00F0            +1  5411     norm1:
00F0 E8         +1  5412             mov     a,r0            ;get exponent
00F1 60C0       +1  5413             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  5414             mov     a,r2            ;get hi byte
00F4 6023       +1  5415             jz      norup           ;zero, so shift up if anything
00F6            +1  5416     nordn:
00F6 EA         +1  5417             mov     a,r2            ;get hi byte
00F7 B4010D     +1  5418             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  5419+3           add1                    ;add in a rounding bit
00FA ED         +1  5420+1           mov     a,r5
00FB 2401       +1  5421+1           add     a,#1
00FD FD         +1  5422+1           mov     r5,a
00FE E4         +1  5423+1           clr     a
00FF 3C         +1  5424+1           addc    a,r4
0100 FC         +1  5425+1           mov     r4,a
0101 E4         +1  5426+1           clr     a
0102 3B         +1  5427+1           addc    a,r3
0103 FB         +1  5428+1           mov     r3,a
0104 E4         +1  5429+1           clr     a
0105 3A         +1  5430+1           addc    a,r2
0106 FA         +1  5431+1           mov     r2,a
0107            +1  5432     nordn1:
                +1  5433+3           rshift                  ;shift down 1 bit
0107 C3         +1  5434+1           clr     c
0108 EA         +1  5435+1           mov     a,r2
0109 13         +1  5436+1           rrc     a
010A FA         +1  5437+1           mov     r2,a
010B EB         +1  5438+1           mov     a,r3
010C 13         +1  5439+1           rrc     a
010D FB         +1  5440+1           mov     r3,a
010E EC         +1  5441+1           mov     a,r4
010F 13         +1  5442+1           rrc     a
0110 FC         +1  5443+1           mov     r4,a
0111 ED         +1  5444+1           mov     a,r5
0112 13         +1  5445+1           rrc     a
0113 FD         +1  5446+1           mov     r5,a
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    86

0114 08         +1  5447             inc     r0              ;adjust exponent
0115 EA         +1  5448             mov     a,r2            ;test high byte
0116 70DE       +1  5449             jnz     nordn           ;loop
0118 22         +1  5450             ret                     ;done
                +1  5451     
0119            +1  5452     norup:
0119 4B         +1  5453             orl     a,r3
011A 4C         +1  5454             orl     a,r4
011B 4D         +1  5455             orl     a,r5            ;test for zero mantissa
011C 6095       +1  5456             jz      zer1            ;it is - make it true zero
011E            +1  5457     norup1:
011E EB         +1  5458             mov     a,r3            ;get mantissa byte
011F 20E710     +1  5459             jb      acc.7,norup2    ;jump if set
0122 C3         +1  5460             clr     c
                +1  5461+3           lshift                  ;shift mantissa up
0123 ED         +1  5462+1           mov     a,r5
0124 33         +1  5463+1           rlc     a
0125 FD         +1  5464+1           mov     r5,a
0126 EC         +1  5465+1           mov     a,r4
0127 33         +1  5466+1           rlc     a
0128 FC         +1  5467+1           mov     r4,a
0129 EB         +1  5468+1           mov     a,r3
012A 33         +1  5469+1           rlc     a
012B FB         +1  5470+1           mov     r3,a
012C EA         +1  5471+1           mov     a,r2
012D 33         +1  5472+1           rlc     a
012E FA         +1  5473+1           mov     r2,a
012F 18         +1  5474             dec     r0              ;adjust exponent
0130 80EC       +1  5475             jmp     norup1
0132            +1  5476     norup2:
0132 22         +1  5477             ret                     ;finito
                +1  5478     
                +1  5479     
                +1  5480     ;       fpdenorm - denormalize one of the two operands so that their
                +1  5481     ;       exponents are equal. This requires the smaller number to have
                +1  5482     ;       its exponent incremented and its mantissa shifted right.
                +1  5483     
0133            +1  5484     denorm:
0133 E8         +1  5485             mov     a,r0
0134 C3         +1  5486             clr     c
0135 99         +1  5487             subb    a,r1            ;compare exponents
0136 5029       +1  5488             jnc     up2a            ;shift operand 2
0138            +1  5489     up1:
0138 08         +1  5490             inc     r0              ;increment exponent
                +1  5491+3           rshift                  ;shift mantissa down
0139 C3         +1  5492+1           clr     c
013A EA         +1  5493+1           mov     a,r2
013B 13         +1  5494+1           rrc     a
013C FA         +1  5495+1           mov     r2,a
013D EB         +1  5496+1           mov     a,r3
013E 13         +1  5497+1           rrc     a
013F FB         +1  5498+1           mov     r3,a
0140 EC         +1  5499+1           mov     a,r4
0141 13         +1  5500+1           rrc     a
0142 FC         +1  5501+1           mov     r4,a
0143 ED         +1  5502+1           mov     a,r5
0144 13         +1  5503+1           rrc     a
0145 FD         +1  5504+1           mov     r5,a
0146 E8         +1  5505             mov     a,r0
0147 B501EE     +1  5506             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  5507             ret
                +1  5508     
014B            +1  5509     up2:
014B 09         +1  5510             inc     r1              ;increment exponent 2
                +1  5511+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  5512+1           clr     c
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    87

014D E508       +1  5513+1           mov     a,mant2
014F 13         +1  5514+1           rrc     a
0150 F508       +1  5515+1           mov     mant2,a
0152 E509       +1  5516+1           mov     a,mant2+1
0154 13         +1  5517+1           rrc     a
0155 F509       +1  5518+1           mov     mant2+1,a
0157 E50A       +1  5519+1           mov     a,mant2+2
0159 13         +1  5520+1           rrc     a
015A F50A       +1  5521+1           mov     mant2+2,a
015C E50B       +1  5522+1           mov     a,mant2+3
015E 13         +1  5523+1           rrc     a
015F F50B       +1  5524+1           mov     mant2+3,a
0161            +1  5525     up2a:
0161 E8         +1  5526             mov     a,r0            ;compare exponents
0162 B501E6     +1  5527             cjne    a,exp2,up2
0165 22         +1  5528             ret                     ;all done
                +1  5529     ;------------------------------------------------------------------
                +1  5530     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  5531     
0166            +1  5532     fladd:
                +1  5533+3           saveregs
0166 C007       +1  5534+1           push    7
0168 C006       +1  5535+1           push    6
016A C001       +1  5536+1           push    1
016C C000       +1  5537+1           push    0
016E 119E       +1  5538             call    unpack1
0170 11BA       +1  5539             call    unpack2
0172 3133       +1  5540             call    denorm
0174 E507       +1  5541             mov     a,sign
0176 30E70D     +1  5542             jnb     acc.7,ok1       ;test left sign
                +1  5543+3           neg1                    ;negate op1
0179 C3         +1  5544+1           clr     c
017A E4         +1  5545+1           clr     a
017B 9D         +1  5546+1           subb    a,r5
017C FD         +1  5547+1           mov     r5,a
017D E4         +1  5548+1           clr     a
017E 9C         +1  5549+1           subb    a,r4
017F FC         +1  5550+1           mov     r4,a
0180 E4         +1  5551+1           clr     a
0181 9B         +1  5552+1           subb    a,r3
0182 FB         +1  5553+1           mov     r3,a
0183 E4         +1  5554+1           clr     a
0184 9A         +1  5555+1           subb    a,r2
0185 FA         +1  5556+1           mov     r2,a
0186            +1  5557     ok1:
0186 E507       +1  5558             mov     a,sign
0188 30E615     +1  5559             jnb     acc.6,ok2       ;test right sign
                +1  5560+3           negm    mant2           ;negate op2
018B C3         +1  5561+1           clr     c
018C E4         +1  5562+1           clr     a
018D 950B       +1  5563+1           subb    a,mant2+3
018F F50B       +1  5564+1           mov     mant2+3,a
0191 E4         +1  5565+1           clr     a
0192 950A       +1  5566+1           subb    a,mant2+2
0194 F50A       +1  5567+1           mov     mant2+2,a
0196 E4         +1  5568+1           clr     a
0197 9509       +1  5569+1           subb    a,mant2+1
0199 F509       +1  5570+1           mov     mant2+1,a
019B E4         +1  5571+1           clr     a
019C 9508       +1  5572+1           subb    a,mant2
019E F508       +1  5573+1           mov     mant2,a
01A0            +1  5574     ok2:
                +1  5575+3           addl    mant2           ;add mantissas
01A0 ED         +1  5576+1           mov     a,r5
01A1 250B       +1  5577+1           add     a,mant2+3
01A3 FD         +1  5578+1           mov     r5,a
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    88

01A4 E50A       +1  5579+1           mov     a,mant2+2
01A6 3C         +1  5580+1           addc    a,r4
01A7 FC         +1  5581+1           mov     r4,a
01A8 E509       +1  5582+1           mov     a,mant2+1
01AA 3B         +1  5583+1           addc    a,r3
01AB FB         +1  5584+1           mov     r3,a
01AC E508       +1  5585+1           mov     a,mant2+0
01AE 3A         +1  5586+1           addc    a,r2
01AF FA         +1  5587+1           mov     r2,a
01B0 E4         +1  5588             clr     a
01B1 FF         +1  5589             mov     r7,a            ;clear sign
01B2 EA         +1  5590             mov     a,r2            ;get sign of result
01B3 30E70E     +1  5591             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  5592             mov     r7,a            ;store sign
                +1  5593+3           neg1                    ;negate mantissa
01B7 C3         +1  5594+1           clr     c
01B8 E4         +1  5595+1           clr     a
01B9 9D         +1  5596+1           subb    a,r5
01BA FD         +1  5597+1           mov     r5,a
01BB E4         +1  5598+1           clr     a
01BC 9C         +1  5599+1           subb    a,r4
01BD FC         +1  5600+1           mov     r4,a
01BE E4         +1  5601+1           clr     a
01BF 9B         +1  5602+1           subb    a,r3
01C0 FB         +1  5603+1           mov     r3,a
01C1 E4         +1  5604+1           clr     a
01C2 9A         +1  5605+1           subb    a,r2
01C3 FA         +1  5606+1           mov     r2,a
01C4            +1  5607     ok3:
01C4 11F0       +1  5608             call    norm1
01C6 11DE       +1  5609             call    pack1           ;pack normalized result
                +1  5610+3           restregs                ;and return
01C8 D000       +1  5611+1           pop     0
01CA D001       +1  5612+1           pop     1
01CC D006       +1  5613+1           pop     6
01CE D007       +1  5614+1           pop     7
01D0 22         +1  5615             ret
                +1  5616     ;-------------------------------------------------------------
                +1  5617     ;       Subtract the number ltemp from the number in r2-r5
                +1  5618     
01D1            +1  5619     flsub:
01D1 630880     +1  5620             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  5621             jmp     fladd           ;and add!
                +1  5622     
                +1  5623     ;================================================================
                +1  5624     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  5625     
01D6            +1  5626     flcmp:
01D6 EA         +1  5627            mov     a,r2            ;get sign of left
01D7 6508       +1  5628            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  5629            jnb     acc.7,cexp      ;same, go check exponent
                +1  5630     ;ifdef SMALL_MODEL
01DC EA         +1  5631             mov     a,r2            ;get sign of left again
01DD 33         +1  5632             rlc     a
01DE 5001       +1  5633             jnc     flout
                +1  5634     ;endif
01E0 D3         +1  5635             setb    c
01E1 22         +1  5636     flout:          ret                    ;return with acc < 0
                +1  5637     
01E2            +1  5638     cexp:
01E2 C3         +1  5639            clr     c
01E3 EA         +1  5640            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  5641            subb    a,ltemp
01E6 7010       +1  5642            jnz     fnd
01E8 EB         +1  5643            mov     a,r3
01E9 9509       +1  5644            subb    a,ltemp+1
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    89

01EB 700B       +1  5645            jnz     fnd
01ED EC         +1  5646            mov     a,r4
01EE 950A       +1  5647            subb    a,ltemp+2
01F0 7006       +1  5648            jnz     fnd
01F2 ED         +1  5649            mov     a,r5
01F3 950B       +1  5650            subb    a,ltemp+3
01F5 7001       +1  5651            jnz     fnd
01F7            +1  5652     cdone:
01F7 22         +1  5653            ret                     ;return with acc == 0
01F8            +1  5654     fnd:
01F8 8AF0       +1  5655           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  5656          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  5657            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  5658                         orl         a,#1                          ;make non-zero
0201 B3         +1  5659             cpl     c               ;c=0->1,c=1->0
0202 22         +1  5660             ret
                +1  5661     ;==============================================================
                +1  5662     
                +1  5663     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  5664     ;       the result in r2-r5
                +1  5665     
0203            +1  5666     flmul:
                +1  5667+3           saveregs
0203 C007       +1  5668+1           push    7
0205 C006       +1  5669+1           push    6
0207 C001       +1  5670+1           push    1
0209 C000       +1  5671+1           push    0
020B 119E       +1  5672             call    unpack1
020D 11BA       +1  5673             call    unpack2
020F E4         +1  5674             clr     a
0210 F50C       +1  5675             mov     prod,a
0212 F50D       +1  5676             mov     prod+1,a        ;clear product
0214 F50E       +1  5677             mov     prod+2,a
0216 F50F       +1  5678             mov     prod+3,a
0218 7E07       +1  5679             mov     r6,#7           ;initialize counter
021A            +1  5680     mup1:
                +1  5681+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  5682+1           clr     c
021B E508       +1  5683+1           mov     a,mant2
021D 13         +1  5684+1           rrc     a
021E F508       +1  5685+1           mov     mant2,a
0220 E509       +1  5686+1           mov     a,mant2+1
0222 13         +1  5687+1           rrc     a
0223 F509       +1  5688+1           mov     mant2+1,a
0225 E50A       +1  5689+1           mov     a,mant2+2
0227 13         +1  5690+1           rrc     a
0228 F50A       +1  5691+1           mov     mant2+2,a
022A E50B       +1  5692+1           mov     a,mant2+3
022C 13         +1  5693+1           rrc     a
022D F50B       +1  5694+1           mov     mant2+3,a
022F 5014       +1  5695             jnc     nobit           ;skip if lsb was zero
                +1  5696+3           dan     prod            ;add multiplicand to product
0231 ED         +1  5697+1           mov     a,r5
0232 250F       +1  5698+1           add     a,prod+3
0234 F50F       +1  5699+1           mov     prod+3,a
0236 E50E       +1  5700+1           mov     a,prod+2
0238 3C         +1  5701+1           addc    a,r4
0239 F50E       +1  5702+1           mov     prod+2,a
023B E50D       +1  5703+1           mov     a,prod+1
023D 3B         +1  5704+1           addc    a,r3
023E F50D       +1  5705+1           mov     prod+1,a
0240 E50C       +1  5706+1           mov     a,prod+0
0242 3A         +1  5707+1           addc    a,r2
0243 F50C       +1  5708+1           mov     prod,a
0245            +1  5709     nobit:
                +1  5710+3           lshift                  ;shift multiplicand up
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    90

0245 ED         +1  5711+1           mov     a,r5
0246 33         +1  5712+1           rlc     a
0247 FD         +1  5713+1           mov     r5,a
0248 EC         +1  5714+1           mov     a,r4
0249 33         +1  5715+1           rlc     a
024A FC         +1  5716+1           mov     r4,a
024B EB         +1  5717+1           mov     a,r3
024C 33         +1  5718+1           rlc     a
024D FB         +1  5719+1           mov     r3,a
024E EA         +1  5720+1           mov     a,r2
024F 33         +1  5721+1           rlc     a
0250 FA         +1  5722+1           mov     r2,a
0251 DEC7       +1  5723             djnz    r6,mup1         ;loop if more
                +1  5724     
0253 7E11       +1  5725             mov     r6,#17          ;re-initalize counter
0255 8015       +1  5726             sjmp    mup3
0257            +1  5727     mup11:
                +1  5728+3           shfdn   prod            ;shift product right
0257 C3         +1  5729+1           clr     c
0258 E50C       +1  5730+1           mov     a,prod
025A 13         +1  5731+1           rrc     a
025B F50C       +1  5732+1           mov     prod,a
025D E50D       +1  5733+1           mov     a,prod+1
025F 13         +1  5734+1           rrc     a
0260 F50D       +1  5735+1           mov     prod+1,a
0262 E50E       +1  5736+1           mov     a,prod+2
0264 13         +1  5737+1           rrc     a
0265 F50E       +1  5738+1           mov     prod+2,a
0267 E50F       +1  5739+1           mov     a,prod+3
0269 13         +1  5740+1           rrc     a
026A F50F       +1  5741+1           mov     prod+3,a
026C            +1  5742     mup3:
                +1  5743+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  5744+1           clr     c
026D E508       +1  5745+1           mov     a,mant2
026F 13         +1  5746+1           rrc     a
0270 F508       +1  5747+1           mov     mant2,a
0272 E509       +1  5748+1           mov     a,mant2+1
0274 13         +1  5749+1           rrc     a
0275 F509       +1  5750+1           mov     mant2+1,a
0277 E50A       +1  5751+1           mov     a,mant2+2
0279 13         +1  5752+1           rrc     a
027A F50A       +1  5753+1           mov     mant2+2,a
027C E50B       +1  5754+1           mov     a,mant2+3
027E 13         +1  5755+1           rrc     a
027F F50B       +1  5756+1           mov     mant2+3,a
0281 5014       +1  5757             jnc     mup2            ;skip if bit not set
                +1  5758+3           dan     prod            ;add to prod
0283 ED         +1  5759+1           mov     a,r5
0284 250F       +1  5760+1           add     a,prod+3
0286 F50F       +1  5761+1           mov     prod+3,a
0288 E50E       +1  5762+1           mov     a,prod+2
028A 3C         +1  5763+1           addc    a,r4
028B F50E       +1  5764+1           mov     prod+2,a
028D E50D       +1  5765+1           mov     a,prod+1
028F 3B         +1  5766+1           addc    a,r3
0290 F50D       +1  5767+1           mov     prod+1,a
0292 E50C       +1  5768+1           mov     a,prod+0
0294 3A         +1  5769+1           addc    a,r2
0295 F50C       +1  5770+1           mov     prod,a
0297            +1  5771     mup2:
0297 DEBE       +1  5772             djnz    r6,mup11        ;loop if more
0299 E8         +1  5773             mov     a,r0            ;get exp1
029A 29         +1  5774             add     a,r1            ;add exp2
029B 247A       +1  5775             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  5776             mov     r0,a            ;store
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    91

029E EF         +1  5777             mov     a,r7            ;get sign
029F 23         +1  5778             rl      a               ;rotate bit into msb
02A0 6207       +1  5779             xrl     sign,a          ;xor with other bit
                +1  5780+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  5781+1           mov     r2,prod
02A4 AB0D       +1  5782+1           mov     r3,prod+1
02A6 AC0E       +1  5783+1           mov     r4,prod+2
02A8 AD0F       +1  5784+1           mov     r5,prod+3
02AA 11F0       +1  5785             call    norm1           ;normalize
02AC 11DE       +1  5786             call    pack1
                +1  5787+3           restregs
02AE D000       +1  5788+1           pop     0
02B0 D001       +1  5789+1           pop     1
02B2 D006       +1  5790+1           pop     6
02B4 D007       +1  5791+1           pop     7
02B6 22         +1  5792             ret
                +1  5793     ;-----------------------------------------------------------
                +1  5794     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  5795     
02B7            +1  5796     fldiv:
                +1  5797+3           saveregs
02B7 C007       +1  5798+1           push    7
02B9 C006       +1  5799+1           push    6
02BB C001       +1  5800+1           push    1
02BD C000       +1  5801+1           push    0
02BF 119E       +1  5802             call    unpack1
02C1 11BA       +1  5803             call    unpack2
02C3 E4         +1  5804             clr     a
02C4 F50C       +1  5805             mov     prod,a
02C6 F50D       +1  5806             mov     prod+1,a
02C8 F50E       +1  5807             mov     prod+2,a
02CA F50F       +1  5808             mov     prod+3,a
02CC E9         +1  5809             mov     a,r1            ;check for zero divisor
02CD 6067       +1  5810             jz      div9
02CF E8         +1  5811             mov     a,r0            ;check for zero dividend
02D0 6064       +1  5812             jz      div9
02D2 C3         +1  5813             clr     c
02D3 99         +1  5814             subb    a,r1            ;compute new exponent
02D4 2478       +1  5815             add     a,#127-7        ;unbias
02D6 F8         +1  5816             mov     r0,a            ;store back
02D7 EF         +1  5817             mov     a,r7            ;get sign
02D8 23         +1  5818             rl      a
02D9 6207       +1  5819             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  5820             mov     r6,#24+7        ;initialize counter
02DD            +1  5821     div1:
                +1  5822+3           shfup   prod            ;shift quotient up
02DD C3         +1  5823+1           clr     c
02DE E50F       +1  5824+1           mov     a,prod+3
02E0 33         +1  5825+1           rlc     a
02E1 F50F       +1  5826+1           mov     prod+3,a
02E3 E50E       +1  5827+1           mov     a,prod+2
02E5 33         +1  5828+1           rlc     a
02E6 F50E       +1  5829+1           mov     prod+2,a
02E8 E50D       +1  5830+1           mov     a,prod+1
02EA 33         +1  5831+1           rlc     a
02EB F50D       +1  5832+1           mov     prod+1,a
02ED E50C       +1  5833+1           mov     a,prod
02EF 33         +1  5834+1           rlc     a
02F0 F50C       +1  5835+1           mov     prod,a
02F2 C3         +1  5836             clr     c
02F3 EA         +1  5837             mov     a,r2            ;compare values
02F4 9508       +1  5838             subb    a,mant2
02F6 4028       +1  5839             jc      div2            ;skip if bigger
02F8 7013       +1  5840             jnz     div3
02FA EB         +1  5841             mov     a,r3            ;compare values
02FB 9509       +1  5842             subb    a,mant2+1
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    92

02FD 4021       +1  5843             jc      div2            ;skip if bigger
02FF 700C       +1  5844             jnz     div3
0301 EC         +1  5845             mov     a,r4            ;compare values
0302 950A       +1  5846             subb    a,mant2+2
0304 401A       +1  5847             jc      div2            ;skip if bigger
0306 7005       +1  5848             jnz     div3
0308 ED         +1  5849             mov     a,r5            ;compare values
0309 950B       +1  5850             subb    a,mant2+3
030B 4013       +1  5851             jc      div2            ;skip if bigger
030D            +1  5852     div3:
030D ED         +1  5853             mov     a,r5
030E 950B       +1  5854             subb    a,mant2+3
0310 FD         +1  5855             mov     r5,a
0311 EC         +1  5856             mov     a,r4
0312 950A       +1  5857             subb    a,mant2+2               ;do subtraction
0314 FC         +1  5858             mov     r4,a
0315 EB         +1  5859             mov     a,r3
0316 9509       +1  5860             subb    a,mant2+1               ;do subtraction
0318 FB         +1  5861             mov     r3,a
0319 EA         +1  5862             mov     a,r2
031A 9508       +1  5863             subb    a,mant2         ;do subtraction
031C FA         +1  5864             mov     r2,a
031D 430F01     +1  5865             orl     prod+3,#1       ;set lsb in quotient
0320            +1  5866     div2:
                +1  5867+3           lshift                  ;shift dividend up
0320 ED         +1  5868+1           mov     a,r5
0321 33         +1  5869+1           rlc     a
0322 FD         +1  5870+1           mov     r5,a
0323 EC         +1  5871+1           mov     a,r4
0324 33         +1  5872+1           rlc     a
0325 FC         +1  5873+1           mov     r4,a
0326 EB         +1  5874+1           mov     a,r3
0327 33         +1  5875+1           rlc     a
0328 FB         +1  5876+1           mov     r3,a
0329 EA         +1  5877+1           mov     a,r2
032A 33         +1  5878+1           rlc     a
032B FA         +1  5879+1           mov     r2,a
032C DEAF       +1  5880             djnz    r6,div1         ;loop if more
                +1  5881+3           copytor prod            ;copy quotient
032E AA0C       +1  5882+1           mov     r2,prod
0330 AB0D       +1  5883+1           mov     r3,prod+1
0332 AC0E       +1  5884+1           mov     r4,prod+2
0334 AD0F       +1  5885+1           mov     r5,prod+3
0336            +1  5886     div9:
0336 11F0       +1  5887             call    norm1           ;now normalize result
0338 11DE       +1  5888             call    pack1           ;pack it up
                +1  5889+3           restregs                ;restore registers
033A D000       +1  5890+1           pop     0
033C D001       +1  5891+1           pop     1
033E D006       +1  5892+1           pop     6
0340 D007       +1  5893+1           pop     7
0342 22         +1  5894             ret
                +1  5895     ;------------------------------------------------------------------
                +1  5896     
                +1  5897     ;       Float to long conversion: if the exponent is less than the
                +1  5898     ;       excess value, the result is zero. If the exponent is so large
                +1  5899     ;       that the value would be shifted out, the result is overflow.
                +1  5900     ;       Otherwise shift the mantissa up or down as required.
                +1  5901     
0343            +1  5902     ftol:
                +1  5903+3           saveregs
0343 C007       +1  5904+1           push    7
0345 C006       +1  5905+1           push    6
0347 C001       +1  5906+1           push    1
0349 C000       +1  5907+1           push    0
034B EA         +1  5908             mov     a,r2
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    93

034C B4BF09     +1  5909             cjne    a,#0bfh,ne05
034F EB         +1  5910             mov     a,r3
0350 7006       +1  5911             jnz     ne05
0352 EC         +1  5912             mov     a,r4
0353 7003       +1  5913             jnz     ne05
0355 ED         +1  5914             mov     a,r5
0356 6024       +1  5915             jz      ftol1
0358 119E       +1  5916     ne05:   call    unpack1
035A E8         +1  5917             mov     a,r0            ;get exponent
035B 2482       +1  5918             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  5919             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  5920             mov     a,r7            ;get sign
0361 30E70D     +1  5921             jnb     acc.7,ftol4     ;skip if +ve
                +1  5922+3           neg1                    ;negate it
0364 C3         +1  5923+1           clr     c
0365 E4         +1  5924+1           clr     a
0366 9D         +1  5925+1           subb    a,r5
0367 FD         +1  5926+1           mov     r5,a
0368 E4         +1  5927+1           clr     a
0369 9C         +1  5928+1           subb    a,r4
036A FC         +1  5929+1           mov     r4,a
036B E4         +1  5930+1           clr     a
036C 9B         +1  5931+1           subb    a,r3
036D FB         +1  5932+1           mov     r3,a
036E E4         +1  5933+1           clr     a
036F 9A         +1  5934+1           subb    a,r2
0370 FA         +1  5935+1           mov     r2,a
0371            +1  5936     ftol4:
0371 E8         +1  5937             mov     a,r0            ;get exponent
0372 246A       +1  5938             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  5939             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  5940             mov     r0,a            ;save it
0378 24F8       +1  5941             add     a,#-8           ;if > 8, too big
037A 500E       +1  5942             jnc     ftol3
037C            +1  5943     ftol1:
037C E4         +1  5944             clr     a
037D FA         +1  5945             mov     r2,a
037E FB         +1  5946             mov     r3,a
037F FC         +1  5947             mov     r4,a
0380 FD         +1  5948             mov     r5,a
0381            +1  5949     ftol9:
                +1  5950+3           restregs
0381 D000       +1  5951+1           pop     0
0383 D001       +1  5952+1           pop     1
0385 D006       +1  5953+1           pop     6
0387 D007       +1  5954+1           pop     7
0389 22         +1  5955             ret
038A            +1  5956     ftol3:
038A E8         +1  5957             mov     a,r0
038B FE         +1  5958             mov     r6,a            ;store in counter
038C 60F3       +1  5959             jz      ftol9           ;if zero, do nothing
038E            +1  5960     ftol33:
                +1  5961+3           lshift                  ;shift up
038E ED         +1  5962+1           mov     a,r5
038F 33         +1  5963+1           rlc     a
0390 FD         +1  5964+1           mov     r5,a
0391 EC         +1  5965+1           mov     a,r4
0392 33         +1  5966+1           rlc     a
0393 FC         +1  5967+1           mov     r4,a
0394 EB         +1  5968+1           mov     a,r3
0395 33         +1  5969+1           rlc     a
0396 FB         +1  5970+1           mov     r3,a
0397 EA         +1  5971+1           mov     a,r2
0398 33         +1  5972+1           rlc     a
0399 FA         +1  5973+1           mov     r2,a
039A DEF2       +1  5974             djnz    r6,ftol33       ;and loop
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    94

039C 80E3       +1  5975             sjmp    ftol9
039E            +1  5976     ftol2:
039E F4         +1  5977             cpl     a               ;complement
039F FE         +1  5978             mov     r6,a
03A0 6022       +1  5979             jz      ftol22
03A2            +1  5980     ftol23:
03A2 EF         +1  5981             mov     a,r7
03A3 30E70F     +1  5982             jnb     acc.7,ftol24
                +1  5983+3           rshift1
03A6 D3         +1  5984+1           setb    c
03A7 EA         +1  5985+1           mov     a,r2
03A8 13         +1  5986+1           rrc     a
03A9 FA         +1  5987+1           mov     r2,a
03AA EB         +1  5988+1           mov     a,r3
03AB 13         +1  5989+1           rrc     a
03AC FB         +1  5990+1           mov     r3,a
03AD EC         +1  5991+1           mov     a,r4
03AE 13         +1  5992+1           rrc     a
03AF FC         +1  5993+1           mov     r4,a
03B0 ED         +1  5994+1           mov     a,r5
03B1 13         +1  5995+1           rrc     a
03B2 FD         +1  5996+1           mov     r5,a
03B3 800D       +1  5997             jmp     ftol25
03B5            +1  5998+3   ftol24: rshift                  ;shift down
03B5 C3         +1  5999+1           clr     c
03B6 EA         +1  6000+1           mov     a,r2
03B7 13         +1  6001+1           rrc     a
03B8 FA         +1  6002+1           mov     r2,a
03B9 EB         +1  6003+1           mov     a,r3
03BA 13         +1  6004+1           rrc     a
03BB FB         +1  6005+1           mov     r3,a
03BC EC         +1  6006+1           mov     a,r4
03BD 13         +1  6007+1           rrc     a
03BE FC         +1  6008+1           mov     r4,a
03BF ED         +1  6009+1           mov     a,r5
03C0 13         +1  6010+1           rrc     a
03C1 FD         +1  6011+1           mov     r5,a
03C2 DEDE       +1  6012     ftol25: djnz    r6,ftol23
03C4            +1  6013     ftol22:
                +1  6014+3           add1                    ;round
03C4 ED         +1  6015+1           mov     a,r5
03C5 2401       +1  6016+1           add     a,#1
03C7 FD         +1  6017+1           mov     r5,a
03C8 E4         +1  6018+1           clr     a
03C9 3C         +1  6019+1           addc    a,r4
03CA FC         +1  6020+1           mov     r4,a
03CB E4         +1  6021+1           clr     a
03CC 3B         +1  6022+1           addc    a,r3
03CD FB         +1  6023+1           mov     r3,a
03CE E4         +1  6024+1           clr     a
03CF 3A         +1  6025+1           addc    a,r2
03D0 FA         +1  6026+1           mov     r2,a
03D1 EF         +1  6027             mov     a,r7
03D2 30E70F     +1  6028             jnb     acc.7,ftol26
                +1  6029+3           rshift1
03D5 D3         +1  6030+1           setb    c
03D6 EA         +1  6031+1           mov     a,r2
03D7 13         +1  6032+1           rrc     a
03D8 FA         +1  6033+1           mov     r2,a
03D9 EB         +1  6034+1           mov     a,r3
03DA 13         +1  6035+1           rrc     a
03DB FB         +1  6036+1           mov     r3,a
03DC EC         +1  6037+1           mov     a,r4
03DD 13         +1  6038+1           rrc     a
03DE FC         +1  6039+1           mov     r4,a
03DF ED         +1  6040+1           mov     a,r5
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    95

03E0 13         +1  6041+1           rrc     a
03E1 FD         +1  6042+1           mov     r5,a
03E2 809D       +1  6043             jmp     ftol9
03E4            +1  6044+3   ftol26: rshift
03E4 C3         +1  6045+1           clr     c
03E5 EA         +1  6046+1           mov     a,r2
03E6 13         +1  6047+1           rrc     a
03E7 FA         +1  6048+1           mov     r2,a
03E8 EB         +1  6049+1           mov     a,r3
03E9 13         +1  6050+1           rrc     a
03EA FB         +1  6051+1           mov     r3,a
03EB EC         +1  6052+1           mov     a,r4
03EC 13         +1  6053+1           rrc     a
03ED FC         +1  6054+1           mov     r4,a
03EE ED         +1  6055+1           mov     a,r5
03EF 13         +1  6056+1           rrc     a
03F0 FD         +1  6057+1           mov     r5,a
03F1 808E       +1  6058             jmp     ftol9
                +1  6059     
                +1  6060     ;       arithmetic integer to floating conversions
                +1  6061     
03F3            +1  6062     abtof:
03F3 ED         +1  6063             mov     a,r5
03F4 23         +1  6064             rl      a
03F5 FC         +1  6065             mov     r4,a
03F6 9C         +1  6066             subb    a,r4
03F7 FC         +1  6067             mov     r4,a
03F8 FB         +1  6068             mov     r3,a
03F9 FA         +1  6069             mov     r2,a
03FA 8006       +1  6070             jmp     altof
03FC            +1  6071     awtof:
03FC EC         +1  6072             mov     a,r4
03FD 23         +1  6073             rl      a
03FE FB         +1  6074             mov     r3,a
03FF 9B         +1  6075             subb    a,r3
0400 FB         +1  6076             mov     r3,a
0401 FA         +1  6077             mov     r2,a
0402            +1  6078     altof:
                +1  6079+3           saveregs
0402 C007       +1  6080+1           push    7
0404 C006       +1  6081+1           push    6
0406 C001       +1  6082+1           push    1
0408 C000       +1  6083+1           push    0
040A EA         +1  6084             mov     a,r2            ;get sign
040B 5480       +1  6085             anl     a,#80h
040D FF         +1  6086             mov     r7,a            ;store it
040E 30E70D     +1  6087             jnb     acc.7,altof1    ;skip if +ve
                +1  6088+3           neg1
0411 C3         +1  6089+1           clr     c
0412 E4         +1  6090+1           clr     a
0413 9D         +1  6091+1           subb    a,r5
0414 FD         +1  6092+1           mov     r5,a
0415 E4         +1  6093+1           clr     a
0416 9C         +1  6094+1           subb    a,r4
0417 FC         +1  6095+1           mov     r4,a
0418 E4         +1  6096+1           clr     a
0419 9B         +1  6097+1           subb    a,r3
041A FB         +1  6098+1           mov     r3,a
041B E4         +1  6099+1           clr     a
041C 9A         +1  6100+1           subb    a,r2
041D FA         +1  6101+1           mov     r2,a
041E            +1  6102     altof1:
041E 7896       +1  6103             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  6104             call    norm1           ;normalize it
0422 11DE       +1  6105             call    pack1           ;and pack up
                +1  6106+3           restregs
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    96

0424 D000       +1  6107+1           pop     0
0426 D001       +1  6108+1           pop     1
0428 D006       +1  6109+1           pop     6
042A D007       +1  6110+1           pop     7
042C 22         +1  6111             ret
                +1  6112     
042D            +1  6113     lbtof:
042D 7C00       +1  6114             mov     r4,#0
042F            +1  6115     lwtof:
042F E4         +1  6116             clr     a
0430 FB         +1  6117             mov     r3,a
0431 FA         +1  6118             mov     r2,a
0432            +1  6119     lltof:
                +1  6120+3           saveregs
0432 C007       +1  6121+1           push    7
0434 C006       +1  6122+1           push    6
0436 C001       +1  6123+1           push    1
0438 C000       +1  6124+1           push    0
043A 7F00       +1  6125             mov     r7,#0           ;zero sign
043C 80E0       +1  6126             sjmp    altof1
                +1  6127     
                +1  6128     ;-------------------------------------------------------
                +1  6129     
                +1  6130     
                    6131     
                    6132     ;$include (d:\amp\wriread.asm)
                +1  6133     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  6134     cle256:          mov            IE,#00H
0441 75B601     +1  6135                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  6136                              MOV            PSCTL,#03
                +1  6137                                             
0447 7400       +1  6138                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  6139                                     movx    @dptr,a                         ;wr
044A 758F00     +1  6140                                     mov             PSCTL,#00
044D 75B600     +1  6141                                 mov         FLSCL,#00
0450 75A880     +1  6142                               mov           IE,#80H
0453 22         +1  6143                                     ret
                +1  6144     
                +1  6145     ;чтение памяти программ в r8..r11
                +1  6146     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  6147     re4byte:        mov                     dph,r2
0456 8B82       +1  6148                                             mov                     dpl,r3
0458 E4         +1  6149                                             clr                     a
0459 93         +1  6150                                             movc            a,@a+dptr
045A F508       +1  6151                                             mov                     r8,a
045C A3         +1  6152                                             inc                     dptr
045D E4         +1  6153                                             clr                     a
045E 93         +1  6154                                             movc            a,@a+dptr
045F F509       +1  6155                                             mov                     r9,a
0461 A3         +1  6156                                             inc                     dptr
0462 E4         +1  6157                                             clr                     a
0463 93         +1  6158                                             movc            a,@a+dptr
0464 F50A       +1  6159                                             mov                     r10,a
0466 A3         +1  6160                                             inc                     dptr
0467 E4         +1  6161                                             clr                     a
0468 93         +1  6162                                             movc            a,@a+dptr
0469 F50B       +1  6163                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  6164                                             ret
                +1  6165      ;чтение памяти программ в r2..r5
                +1  6166     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  6167     rebyte2:        mov                     dph,r2
046E 8B82       +1  6168                                             mov                     dpl,r3
0470 E4         +1  6169                                             clr                     a
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    97

0471 93         +1  6170                                             movc            a,@a+dptr
0472 FA         +1  6171                                             mov                     r2,a
0473 A3         +1  6172                                             inc                     dptr
0474 E4         +1  6173                                             clr                     a
0475 93         +1  6174                                             movc            a,@a+dptr
0476 FB         +1  6175                                             mov                     r3,a
0477 A3         +1  6176                                             inc                     dptr
0478 E4         +1  6177                                             clr                     a
0479 93         +1  6178                                             movc            a,@a+dptr
047A FC         +1  6179                                             mov                     r4,a
047B A3         +1  6180                                             inc                     dptr
047C E4         +1  6181                                             clr                     a
047D 93         +1  6182                                             movc            a,@a+dptr
047E FD         +1  6183                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  6184                                             ret
                +1  6185      
                +1  6186     
                +1  6187      ;r7-количество байт
                +1  6188     ;dptr-адр ячейки для записи
                +1  6189     ;r1-адр ячейки  внешнего озу
                +1  6190     
0480 75A800     +1  6191     wrpage:  mov            IE,#00H
0483 75B601     +1  6192     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  6193                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  6194                      movx           a,@r1
048A F0         +1  6195                      movx           @dptr,a                         ;wr
048B 758F00     +1  6196                      mov            PSCTL,#0
048E 75B600     +1  6197                      mov            FLSCL,#00
0491 A3         +1  6198                     inc                     dptr
0492 09         +1  6199                     inc                     r1
0493 DFEE       +1  6200                     djnz            r7,WW5
0495 75A880     +1  6201                     mov             IE,#80H
0498 22         +1  6202                     ret
                +1  6203                             
                +1  6204     
                +1  6205     
                +1  6206                                                             
                +1  6207     
                +1  6208     
                +1  6209     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  6210     ;чтение памяти программ во внешнее озу
                +1  6211     ;вх-r2,r3-адр яч памяти прогр
                +1  6212     ;r1- яч внешнее озу
0499 8A83       +1  6213     copyPP:         mov                     dph,r2
049B 8B82       +1  6214                                             mov                     dpl,r3
049D 7FFF       +1  6215                                             mov                     r7,#0ffh
049F E4         +1  6216     copy1:          clr                     a
04A0 93         +1  6217                                             movc            a,@a+dptr
04A1 F3         +1  6218                                             movx                    @r1,a
04A2 A3         +1  6219                                             inc                     dptr
04A3 09         +1  6220                                             inc                     r1
04A4 DFF9       +1  6221                                             djnz            r7,copy1
04A6 22         +1  6222                                             ret
                +1  6223     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  6224     
                +1  6225                                     
                +1  6226     
                +1  6227     ;r8..r11->@r0..@r0+3
                +1  6228     ;r0-адр ячейки
                +1  6229     ;сохранить в ячейке озу
04A7 E508       +1  6230     savelte:        mov     a,ltemp
04A9 F6         +1  6231                                             mov     @r0,a
04AA 08         +1  6232                                             inc     r0
04AB E509       +1  6233                                             mov     a,ltemp+1
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    98

04AD F6         +1  6234                                             mov     @r0,a
04AE 08         +1  6235                                             inc     r0
04AF E50A       +1  6236                                             mov     a,ltemp+2
04B1 F6         +1  6237                                             mov     @r0,a
04B2 08         +1  6238                                             inc     r0
04B3 E50B       +1  6239                                             mov     a,ltemp+3
04B5 F6         +1  6240                                             mov     @r0,a
04B6 22         +1  6241                                             ret
                +1  6242     
                +1  6243     ;
                +1  6244     
                +1  6245     
                +1  6246     
                +1  6247     
                +1  6248     
                +1  6249                     
                +1  6250     
                +1  6251     
                +1  6252     
                +1  6253     
                +1  6254      
                    6255     
                    6256                                                   
                    6257     END
                                                                             
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE    99

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   032BH   R   SEG=MAIN   780 783#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1260 1317 1342 1363 1367 1370 1371 1373 1479 1484 3299 3305 3338
                                           3364 3637 3641 3665 3668 3860 3863 3887 3890 4302
ABRET. . . . . . .  C ADDR   1A3CH   R   SEG=MAIN   4231 4233#
ABTOF. . . . . . .  C ADDR   03F3H   A      6062#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 619 673 681 689 697 699 719 1024 1035 1043 1119 1429 1590 1599 1608
                                           1617 1638 1969 2233 2255 2260 2264 2267 2270 2273 2276 2279 2446 2497 2543
                                           2554 2635 2644 2652 2662 2676 2786 2804 2829 2834 2838 2841 2844 2847 2850
                                           2853 3153 3224 3586 3592 3629 3699 4469 4547 4550 4807 5459 5542 5559 5591
                                           5629 5657 5919 5921 5939 5982 6028 6087
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   1DEDH   R   SEG=MAIN   810 846 848 850 852 854 856 858 860 862 925 927 929 931 933 935
                                           937 939 941 944 946 948 950 952 954 956 958 960 962 5048#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1316 1328 1332 1347 1372 1375 1376 1483 1487 3296 3300 3335 3339
                                           3361 3365 3642 3669 3862 3865 3889 3892 4114 4131 4149 4203 4220
AFTERK . . . . . .  C ADDR   05E6H   R   SEG=MAIN   1052 1131#
AGE2 . . . . . . .  C ADDR   01C2H   R   SEG=MAIN   549# 552
AGE9 . . . . . . .  C ADDR   06E3H   R   SEG=MAIN   1264# 1267
AGEON. . . . . . .  C ADDR   01D0H   R   SEG=MAIN   558# 560
ALESS0 . . . . . .  C ADDR   0819H   R   SEG=MAIN   1429 1450#
ALLSUM . . . . . .  C ADDR   02E4H   R   SEG=MAIN   739# 775
ALMUL. . . . . . .  C ADDR   1D34H   R   SEG=MAIN   4894#
ALTOF. . . . . . .  C ADDR   0402H   A      1018 1063 1112 1144 1157 1226 1746 1807 1845 3342 3368 3645 3672 6070
                                           6078#
ALTOF1 . . . . . .  C ADDR   041EH   A      6087 6102# 6126
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   0539H   R   SEG=MAIN   1016 1032#
AN_T7. . . . . . .  C ADDR   105DH   R   SEG=MAIN   2854# 2914 2923
AUTOKA . . . . . .  C ADDR   09C9H   R   SEG=MAIN   1050 1775#
AVPGO. . . . . . .  C ADDR   066CH   R   SEG=MAIN   1203 1205#
AVTDEC1. . . . . .  C ADDR   05ABH   R   SEG=MAIN   1085 1092#
AWTOF. . . . . . .  C ADDR   03FCH   A      6071#
B. . . . . . . . .  D ADDR   00F0H   A      122# 3986 4322 4897 4900 4902 4906 4910 4914 4918 4923 4927 4934 4938
                                           4942 4948 4952 4956 4962 5655 5656
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 443#
BFORM. . . . . . .  C ADDR   0B63H   R   SEG=MAIN   2047 2052 2064# 2090
BIN30. . . . . . .  C ADDR   1B50H   R   SEG=MAIN   4457# 4483
BIN31. . . . . . .  C ADDR   1B54H   R   SEG=MAIN   4462# 4466
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   100

BIN32. . . . . . .  C ADDR   1B64H   R   SEG=MAIN   4475# 4480
BIN41. . . . . . .  C ADDR   1B75H   R   SEG=MAIN   4491# 4501
BINDEC . . . . . .  C ADDR   1B44H   R   SEG=MAIN   1318 1374 1485 3864 3891 4436#
BITAKT . . . . . .  B ADDR   0023H.2 A      348# 1564 1565 1568
BITAVP . . . . . .  B ADDR   0020H.5 A      319# 1163 1383 1556 2904 2905 2907
BITBON . . . . . .  B ADDR   0021H.2 A      326# 1668 2288 2289 2291
BITBUF . . . . . .  B ADDR   0021H.0 A      324# 1689 1691 2370
BITEIZM. . . . . .  B ADDR   0022H.5 A      339# 2887 2899 3496
BITIZM . . . . . .  B ADDR   0020H.4 A      318# 529 640 2261 2324 2409 2835 2888 2994 3015 3085 3113 3200 3208 3379
                                           3400 3455 3469 3497 3541 3578
BITKLB . . . . . .  B ADDR   0022H.2 A      336# 3576
BITMAS . . . . . .  B ADDR   0020H.1 A      315# 971 974 2029
BITMEM . . . . . .  B ADDR   0021H.3 A      327# 2629 3116 3148 3199 3207 3378
BITMENU. . . . . .  B ADDR   0022H.1 A      335# 1468 2889 3384 3399 3460 3498 3540
BITMIG . . . . . .  B ADDR   0023H.1 A      347# 2536 2793 3054 3621 3706 3797 3804 3810 3816 3820 3834 3846
BITNUL . . . . . .  B ADDR   0021H.7 A      331# 1541 2925 2926 2933
BITOLL . . . . . .  B ADDR   0022H.7 A      341# 595 1390 1467
BITPRD . . . . . .  B ADDR   0021H.1 A      325# 1667
BITRS. . . . . . .  B ADDR   0020H.3 A      317#
BITT2. . . . . . .  B ADDR   0022H.0 A      334# 1466 2410 2443 2940 3086
BITV19 . . . . . .  B ADDR   0022H.3 A      337# 2602 2605 2609 3446 3450 3526 3554 3557 3561
BITVI11. . . . . .  B ADDR   0020H.6 A      320# 1164 2282 2284 2323 2567 2993
BITVI31. . . . . .  B ADDR   0022H.6 A      340#
BITVICH. . . . . .  B ADDR   0022H.4 A      338# 1465 2283 2325 2335 2465 2957 3014
BITZNAK. . . . . .  B ADDR   0020H.0 A      314# 620 656
BITZNB . . . . . .  B ADDR   0023H.3 A      349# 3673 4229 4232
BITZUS . . . . . .  B ADDR   0020H.7 A      321# 1406
BMEM11 . . . . . .  B ADDR   0021H.4 A      328# 2568
BMEM12 . . . . . .  B ADDR   0021H.5 A      329#
BMEM13 . . . . . .  B ADDR   0021H.6 A      330#
BOUT7. . . . . . .  C ADDR   11F6H   R   SEG=MAIN   3094# 3096
BRET . . . . . . .  C ADDR   18C1H   R   SEG=MAIN   3926 3931 3935#
BUFDEC . . . . . .  C ADDR   0850H   R   SEG=MAIN   1490# 1495
BUFIND . . . . . .  D ADDR   0040H   A      298# 548 552 557 560 564 588 1263 1267 1333 1354 1375 1376 1377 1439 1444
                                           1488 1496 1498 1503 1539 1566 1569 1901 2249 2511 2529 2545 2547 2550 2698
                                           2741 2760 2822 3041 3067 3100 3106 3267 3613 3656 3801 3823 3866 3885 3893
                                           3984 4002 4113 4130 4148 4202 4219 4230
BUFON. . . . . . .  C ADDR   0CA4H   R   SEG=MAIN   2288 2291#
BUFR . . . . . . .  C ADDR   0788H   R   SEG=MAIN   1356# 1361
BUFR2. . . . . . .  C ADDR   076AH   R   SEG=MAIN   1335# 1340
BUFR3. . . . . . .  C ADDR   0763H   R   SEG=MAIN   1326 1331#
BUFR30 . . . . . .  C ADDR   0766H   R   SEG=MAIN   1329 1333#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      5652# 5656
CELLBIT. . . . . .  D ADDR   0020H   A      313# 314 315 316 317 318 319 320 321
CELLBIT1 . . . . .  D ADDR   0021H   A      323# 324 325 326 327 328 329 330 331
CELLBIT2 . . . . .  D ADDR   0022H   A      333# 334 335 336 337 338 339 340 341
CELLBIT3 . . . . .  D ADDR   0023H   A      345# 346 347 348 349
CEXP . . . . . . .  C ADDR   01E2H   A      5629 5638#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   1951H   R   SEG=MAIN   2934 4058#
CH1. . . . . . . .  C ADDR   196DH   R   SEG=MAIN   1886 4068#
CH10 . . . . . . .  C ADDR   1955H   R   SEG=MAIN   985 4059#
CH100. . . . . . .  C ADDR   1965H   R   SEG=MAIN   738 1424 4063#
CH10000. . . . . .  C ADDR   1961H   R   SEG=MAIN   4062#
CH2. . . . . . . .  C ADDR   1969H   R   SEG=MAIN   980 4064#
CH20 . . . . . . .  C ADDR   1B03H   R   SEG=MAIN   774 990 4353#
CH2THO . . . . . .  C ADDR   1981H   R   SEG=MAIN   1814 1852 4073#
CH5. . . . . . . .  C ADDR   1959H   R   SEG=MAIN   4060#
CH57 . . . . . . .  C ADDR   1AFFH   R   SEG=MAIN   4352#
CH954. . . . . . .  C ADDR   195DH   R   SEG=MAIN   4061#
CHANMA . . . . . .  C ADDR   0E34H   R   SEG=MAIN   2543 2552#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   101

CHANZ. . . . . . .  C ADDR   0E1BH   R   SEG=MAIN   2497 2541#
CHAVT. . . . . . .  D ADDR   0081H   A      363# 509 1041 1086 1092 1868 3456
CHBEFORE . . . . .  D ADDR   009BH   A      373# 531 735 750 769
CHBUF. . . . . . .  D ADDR   00ADH   A      380# 1665 1675
CHCMP. . . . . . .  C ADDR   0C08H   R   SEG=MAIN   632 1047 2206#
CHDEC. . . . . . .  C ADDR   0A6FH   R   SEG=MAIN   639 1093 1104 1878#
CHDEL. . . . . . .  D ADDR   0083H   A      364# 1715 1760 1782 1827 1862
CHDELMO. . . . . .  C ADDR   09B1H   R   SEG=MAIN   1730 1760# 1765
CHIF . . . . . . .  C ADDR   1825H   R   SEG=MAIN   3827 3829#
CHIND. . . . . . .  D ADDR   00ACH   A      379# 1178 1575
CHINKOR. . . . . .  D ADDR   0098H   A      362# 504 717 1033 1046 1088 1100 1103 1767
CHKL . . . . . . .  D ADDR   003DH   A      305# 631 638 2388 2416 2458 2868 3119 3411
CHMAS. . . . . . .  D ADDR   006EH   A      302# 968 975 993 2028
CHMASN . . . . . .  D ADDR   003FH   A      306# 724 733 770 787 799 973 975 976
CHTADC . . . . . .  C ADDR   0AB9H   R   SEG=MAIN   1927#
CHTHO. . . . . . .  C ADDR   1979H   R   SEG=MAIN   1064 1145 4071#
CHTHOU . . . . . .  C ADDR   1A07H   R   SEG=MAIN   4190#
CHZAP. . . . . . .  C ADDR   194DH   R   SEG=MAIN   1654 4057#
CH_1 . . . . . . .  C ADDR   1971H   R   SEG=MAIN   534 1280 1303 4069#
CH_10. . . . . . .  C ADDR   1991H   R   SEG=MAIN   1286 1309 4077#
CH_10TH. . . . . .  C ADDR   198DH   R   SEG=MAIN   1198 4076#
CH_200 . . . . . .  C ADDR   1989H   R   SEG=MAIN   4075#
CH_220 . . . . . .  C ADDR   1985H   R   SEG=MAIN   1158 4074#
CH_22T . . . . . .  C ADDR   1A45H   R   SEG=MAIN   1236 4238#
CH_250 . . . . . .  C ADDR   1995H   R   SEG=MAIN   1137 4078#
CH_500 . . . . . .  C ADDR   1A41H   R   SEG=MAIN   1232 4237#
CH_953 . . . . . .  C ADDR   1975H   R   SEG=MAIN   4070#
CH_B . . . . . . .  C ADDR   1A3DH   R   SEG=MAIN   1248 4235#
CH_FL. . . . . . .  C ADDR   1A49H   R   SEG=MAIN   1272 4239#
CIKLWR . . . . . .  C ADDR   0B39H   R   SEG=MAIN   2035#
CKCON. . . . . . .  D ADDR   008EH   A      30# 461
CL4. . . . . . . .  C ADDR   19A7H   R   SEG=MAIN   4093# 4095
CL4N . . . . . . .  C ADDR   19ADH   R   SEG=MAIN   4102# 4104
CLE256 . . . . . .  C ADDR   043EH   A      3532 6134#
CLEAR. . . . . . .  C ADDR   1B3EH   R   SEG=MAIN   4414 4418# 4448
CLEAR4 . . . . . .  C ADDR   19A4H   R   SEG=MAIN   747 1214 1216 1343 1364 1403 1405 2317 2319 2919 2921 4091#
CLEARN . . . . . .  C ADDR   19ACH   R   SEG=MAIN   3297 3336 3362 3638 3666 4100#
CLMASSIX . . . . .  C ADDR   0B29H   R   SEG=MAIN   503 1212 1401 1771 1872 2022# 2315 2917 3084
CLMASV . . . . . .  C ADDR   0671H   R   SEG=MAIN   1207 1209#
CLMAX. . . . . . .  C ADDR   0B2EH   R   SEG=MAIN   2024# 2027
CLR11. . . . . . .  C ADDR   1B3FH   R   SEG=MAIN   4420# 4422
CLRDEC . . . . . .  C ADDR   1B38H   R   SEG=MAIN   4412#
CLRNUM . . . . . .  C ADDR   1B3CH   R   SEG=MAIN   4415# 4529
CLRVICH. . . . . .  C ADDR   116EH   R   SEG=MAIN   3014# 3031
CNTR . . . . . . .  N NUMB   0006H   A      5325#
CO02S. . . . . . .  C ADDR   1942H   R   SEG=MAIN   4051# 4055
CO1S . . . . . . .  C ADDR   1939H   R   SEG=MAIN   4045# 4045
CO2S . . . . . . .  C ADDR   1935H   R   SEG=MAIN   4043# 4047
COMPA1 . . . . . .  C ADDR   06FFH   R   SEG=MAIN   1280# 1289
COMPA2 . . . . . .  C ADDR   0735H   R   SEG=MAIN   1303# 1312
COND . . . . . . .  C ADDR   0B9DH   R   SEG=MAIN   2119#
CONSTE . . . . . .  D ADDR   00A4H   A      377#
CONSTF . . . . . .  D ADDR   00A8H   A      378#
COPY1. . . . . . .  C ADDR   049FH   A      6216# 6221
COPYPP . . . . . .  C ADDR   0499H   A      3519 6213#
COUNT. . . . . . .  C ADDR   1917H   R   SEG=MAIN   4017# 4017
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   191EH   R   SEG=MAIN   4023# 4023
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 466
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1431 1452
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1434 1456
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   102

DAC1CN . . . . . .  D ADDR   00D7H   A      98# 467
DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1662
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1659
DCOA . . . . . . .  C ADDR   0BA2H   R   SEG=MAIN   2123# 2125
DCOB . . . . . . .  C ADDR   0BA9H   R   SEG=MAIN   2127# 2145
DCOC . . . . . . .  C ADDR   0BB4H   R   SEG=MAIN   2137# 2142
DCOD . . . . . . .  C ADDR   0BC1H   R   SEG=MAIN   2144 2147#
DD . . . . . . . .  C ADDR   01FCH   R   SEG=MAIN   586#
DDOUTF . . . . . .  C ADDR   12F3H   R   SEG=MAIN   3197 3204 3234 3240# 3291
DEC30. . . . . . .  C ADDR   1B91H   R   SEG=MAIN   4539# 4564
DEC31. . . . . . .  C ADDR   1B96H   R   SEG=MAIN   4545# 4552
DEC32. . . . . . .  C ADDR   1BA6H   R   SEG=MAIN   4557# 4561
DECBIN . . . . . .  C ADDR   1B84H   R   SEG=MAIN   3301 3340 3366 3643 3670 4518#
DECSIZE. . . . . .  N NUMB   000AH   A      4393# 4413 4447 4474 4487 4490 4544
DECT2. . . . . . .  C ADDR   1BAFH   R   SEG=MAIN   4535 4567#
DEDPTR . . . . . .  C ADDR   1E04H   R   SEG=MAIN   5052 5056 5060 5066#
DENORM . . . . . .  C ADDR   0133H   A      5484# 5540
DGOTO7 . . . . . .  C ADDR   13E2H   R   SEG=MAIN   3369# 3375
DIAP . . . . . . .  D ADDR   00AEH   A      381# 523 1202 1385 1502 2309 2341 2910 3906 3927 4162 4319 4381
DIINC. . . . . . .  C ADDR   0CC2H   R   SEG=MAIN   2312 2315#
DIKDN. . . . . . .  C ADDR   1AD7H   R   SEG=MAIN   4321 4341#
DIKDW. . . . . . .  C ADDR   19F1H   R   SEG=MAIN   4166 4178#
DIPAR. . . . . . .  C ADDR   1A05H   R   SEG=MAIN   4188#
DIV1 . . . . . . .  C ADDR   02DDH   A      5821# 5880
DIV2 . . . . . . .  C ADDR   0320H   A      5839 5843 5847 5851 5866#
DIV3 . . . . . . .  C ADDR   030DH   A      5840 5844 5848 5852#
DIV9 . . . . . . .  C ADDR   0336H   A      5810 5812 5886#
DIVIDE . . . . . .  C ADDR   1C6FH   R   SEG=MAIN   2051 4753#
DONE . . . . . . .  C ADDR   1BDEH   R   SEG=MAIN   4583 4594#
DONE1. . . . . . .  C ADDR   1BDCH   R   SEG=MAIN   4586 4589 4592#
DOSH . . . . . . .  C ADDR   1CF8H   R   SEG=MAIN   4828 4844#
DOSUB. . . . . . .  C ADDR   1CE6H   R   SEG=MAIN   4812 4816 4820 4824 4825 4829#
DPH. . . . . . . .  D ADDR   0083H   A      19# 1982 1990 2815 3688 4600 4636 4671 4674 4686 4709 5071 5073 6147 6167
                                           6213
DPL. . . . . . . .  D ADDR   0082H   A      18# 1983 1989 2814 3689 4616 4652 4673 4687 4690 4724 5068 5070 6148 6168
                                           6214
DVIG0. . . . . . .  C ADDR   0904H   R   SEG=MAIN   1611# 1613
DVIG1. . . . . . .  C ADDR   08F9H   R   SEG=MAIN   1602# 1604
DVIG2. . . . . . .  C ADDR   08EEH   R   SEG=MAIN   1593# 1595
DVIG3. . . . . . .  C ADDR   08E2H   R   SEG=MAIN   1584# 1586
DVIG4. . . . . . .  C ADDR   0910H   R   SEG=MAIN   1622# 1624
DVIG6. . . . . . .  C ADDR   092FH   R   SEG=MAIN   1647# 1649
DVM. . . . . . . .  C ADDR   092DH   R   SEG=MAIN   1638 1646#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 464
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 490 1899 1911 2231 2788 2803 3705
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDSDV . . . . . .  C ADDR   0933H   R   SEG=MAIN   1644 1650#
ENDSUM . . . . . .  C ADDR   04D2H   R   SEG=MAIN   811 863 967#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU0 . . . . . . .  C ADDR   0730H   R   SEG=MAIN   1283 1299#
EQU00. . . . . . .  C ADDR   074EH   R   SEG=MAIN   1301 1306 1315#
EQU1L. . . . . . .  C ADDR   0F68H   R   SEG=MAIN   2708 2712#
EQU2L. . . . . . .  C ADDR   132BH   R   SEG=MAIN   3277 3282#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   103

EXP1 . . . . . . .  N NUMB   0000H   A      5327#
EXP2 . . . . . . .  N NUMB   0001H   A      5329# 5506 5527
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDKOEF . . . . .  C ADDR   19E2H   R   SEG=MAIN   1060 1141 4161#
FINDR. . . . . . .  C ADDR   1B30H   R   SEG=MAIN   1369 4381#
FINIS. . . . . . .  C ADDR   1D23H   R   SEG=MAIN   4772 4873#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      1230 5532# 5621
FLCMP. . . . . . .  C ADDR   01D6H   A      1139 1160 1200 1234 1238 1282 1305 5626#
FLDIV. . . . . . .  C ADDR   02B7H   A      1066 1147 1255 1274 1288 1816 1854 5796#
FLMUL. . . . . . .  C ADDR   0203H   A      1027 1071 1124 1152 1250 1311 5666#
FLOUT. . . . . . .  C ADDR   01E1H   A      5633 5636#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 6135 6141 6192 6197
FLSUB. . . . . . .  C ADDR   01D1H   A      1116 1812 1850 5619#
FND. . . . . . . .  C ADDR   01F8H   A      5642 5645 5648 5651 5654#
FO1M . . . . . . .  C ADDR   0B60H   R   SEG=MAIN   2057 2061#
FO2M . . . . . . .  C ADDR   0B69H   R   SEG=MAIN   2064 2066#
FORM4. . . . . . .  C ADDR   0B6AH   R   SEG=MAIN   2059 2065 2069#
FT1IZM . . . . . .  C ADDR   0D90H   R   SEG=MAIN   2453#
FTOL . . . . . . .  C ADDR   0343H   A      1072 1154 1258 1473 3859 3886 5902#
FTOL1. . . . . . .  C ADDR   037CH   A      5915 5919 5943#
FTOL2. . . . . . .  C ADDR   039EH   A      5939 5976#
FTOL22 . . . . . .  C ADDR   03C4H   A      5979 6013#
FTOL23 . . . . . .  C ADDR   03A2H   A      5980# 6012
FTOL24 . . . . . .  C ADDR   03B5H   A      5982 5998#
FTOL25 . . . . . .  C ADDR   03C2H   A      5997 6012#
FTOL26 . . . . . .  C ADDR   03E4H   A      6028 6044#
FTOL3. . . . . . .  C ADDR   038AH   A      5942 5956#
FTOL33 . . . . . .  C ADDR   038EH   A      5960# 5974
FTOL4. . . . . . .  C ADDR   0371H   A      5921 5936#
FTOL9. . . . . . .  C ADDR   0381H   A      5949# 5959 5975 6043 6058
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   472# 473
GO23NO . . . . . .  C ADDR   12BBH   R   SEG=MAIN   3205 3211#
GO31L. . . . . . .  C ADDR   0F6EH   R   SEG=MAIN   2687 2717#
GO41L. . . . . . .  C ADDR   0F73H   R   SEG=MAIN   2717 2719#
GOA2 . . . . . . .  C ADDR   0631H   R   SEG=MAIN   1162 1165#
GOA3A2 . . . . . .  C ADDR   063BH   R   SEG=MAIN   1170#
GOCIKLE. . . . . .  C ADDR   096CH   R   SEG=MAIN   1669 1678 1682 1689# 1695 1698
GOFULL . . . . . .  C ADDR   12EDH   R   SEG=MAIN   3217 3238#
GOONIN . . . . . .  C ADDR   0648H   R   SEG=MAIN   1177# 1217 1391 1407
GOONIND. . . . . .  C ADDR   0822H   R   SEG=MAIN   1180 1457#
GOONT. . . . . . .  C ADDR   0956H   R   SEG=MAIN   1672 1674#
GOPART . . . . . .  C ADDR   02C2H   R   SEG=MAIN   719 722#
GOSK19 . . . . . .  C ADDR   0E9BH   R   SEG=MAIN   2602 2607#
GOTO7. . . . . . .  C ADDR   105DH   R   SEG=MAIN   2867# 2931 2938 2974 2995 3018 3043 3055 3094 3098 3158 3167 3171
                                           3185 3201 3209 3242 3252 3281 3284 3313 3326 3328 3350 3369 3381 3588 3600
                                           3657
GOTOKD . . . . . .  C ADDR   055BH   R   SEG=MAIN   1030 1054#
GOUT6. . . . . . .  C ADDR   0C51H   R   SEG=MAIN   2256# 2282
GOZNAK . . . . . .  C ADDR   0274H   R   SEG=MAIN   626 662#
HNOR11 . . . . . .  C ADDR   1179H   R   SEG=MAIN   2985 3022#
HNOR12 . . . . . .  C ADDR   112FH   R   SEG=MAIN   2975 2979#
HNOT1. . . . . . .  C ADDR   11BFH   R   SEG=MAIN   2952 3064#
HNOT2. . . . . . .  C ADDR   10FDH   R   SEG=MAIN   2949#
HR12 . . . . . . .  C ADDR   1125H   R   SEG=MAIN   2970 2975#
HVI1113. . . . . .  C ADDR   111FH   R   SEG=MAIN   2973# 2978 2983
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 491 6134 6142 6191 6201
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   10F9H   R   SEG=MAIN   2944 2946#
IND. . . . . . . .  C ADDR   0A87H   R   SEG=MAIN   553 561 586 650 1293 1297 1572 1899# 2302
INDA3. . . . . . .  C ADDR   07E8H   R   SEG=MAIN   1422#
INDOLL . . . . . .  C ADDR   07BFH   R   SEG=MAIN   1383 1384 1388#
INIACP . . . . . .  C ADDR   1A4DH   R   SEG=MAIN   592 3082 4245#
INTN . . . . . . .  C ADDR   13CBH   R   SEG=MAIN   3360#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   104

IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   11A7H   R   SEG=MAIN   3045#
IZMAN. . . . . . .  C ADDR   0D13H   R   SEG=MAIN   2229 2362#
IZMFUN . . . . . .  C ADDR   0D22H   R   SEG=MAIN   2303 2314 2321 2366 2369#
IZMPAT . . . . . .  C ADDR   0D26H   R   SEG=MAIN   2280 2290 2292 2338 2373#
IZMT2. . . . . . .  C ADDR   0D35H   R   SEG=MAIN   2389 2394#
IZMT3. . . . . . .  C ADDR   0D40H   R   SEG=MAIN   2394 2400#
JFINIS . . . . . .  C ADDR   1C8AH   R   SEG=MAIN   4764 4772#
KD . . . . . . . .  C ADDR   197DH   R   SEG=MAIN   4072#
KEYB1. . . . . . .  C ADDR   0C2AH   R   SEG=MAIN   283 2230#
KEYB2. . . . . . .  C ADDR   0FF4H   R   SEG=MAIN   286 2802#
KFULL. . . . . . .  C ADDR   12C5H   R   SEG=MAIN   3181 3216#
KGO23. . . . . . .  C ADDR   12ABH   R   SEG=MAIN   3180 3203#
KLEV1. . . . . . .  C ADDR   1269H   R   SEG=MAIN   3150 3172#
KLEV2. . . . . . .  C ADDR   126EH   R   SEG=MAIN   3172 3174#
KLEV21 . . . . . .  C ADDR   128AH   R   SEG=MAIN   3178 3187#
KLEV22 . . . . . .  C ADDR   1273H   R   SEG=MAIN   3174 3178#
KLEV23 . . . . . .  C ADDR   1295H   R   SEG=MAIN   3187 3193#
KLMAS. . . . . . .  C ADDR   0347H   R   SEG=MAIN   752 790 798#
KNAVP. . . . . . .  C ADDR   109FH   R   SEG=MAIN   2847 2904#
KNIZM. . . . . . .  B ADDR   0023H.0 A      346# 1162 1384 1560 2340 2362 2363 2367
KNIZMON. . . . . .  C ADDR   0D1DH   R   SEG=MAIN   2362 2367#
KNKMP. . . . . . .  C ADDR   0FE5H   R   SEG=MAIN   2797# 2841
KNLEFT . . . . . .  C ADDR   10ACH   R   SEG=MAIN   2801 2910#
KNMEM. . . . . . .  C ADDR   1214H   R   SEG=MAIN   2796 3113#
KNMENU . . . . . .  C ADDR   107FH   R   SEG=MAIN   2853 2887#
KNNUL. . . . . . .  C ADDR   10C7H   R   SEG=MAIN   2800 2925#
KNOPT. . . . . . .  C ADDR   0D48H   R   SEG=MAIN   2228 2408#
KNRAZR . . . . . .  C ADDR   0D5DH   R   SEG=MAIN   2227 2422#
KNRIGHT. . . . . .  C ADDR   0CB8H   R   SEG=MAIN   2270 2307#
KNVICH . . . . . .  C ADDR   0CD4H   R   SEG=MAIN   2279 2323#
KOEFKD . . . . . .  D ADDR   00A0H   A      376# 540
KOEFKM . . . . . .  D ADDR   0094H   A      370# 538 1025 1122 1858
KOEFKP . . . . . .  D ADDR   0090H   A      369# 536 1022 1117 1820
KONSTA . . . . . .  D ADDR   00BCH   A      389# 1246 3646 3857
KONSTB . . . . . .  D ADDR   00C0H   A      390# 1220 3677 3877
KON_B. . . . . . .  C ADDR   0DFFH   R   SEG=MAIN   2499 2518#
KOR0US . . . . . .  C ADDR   18D5H   R   SEG=MAIN   1728 3960#
KOR0_AN. . . . . .  D ADDR   0084H   A      366# 1113 1747 1810 1848
KORDEC1. . . . . .  C ADDR   05BEH   R   SEG=MAIN   1098 1103#
KORDEC10 . . . . .  C ADDR   05A4H   R   SEG=MAIN   1088#
KORNUL . . . . . .  C ADDR   0991H   R   SEG=MAIN   1037 1715#
KVVOD0 . . . . . .  C ADDR   12E0H   R   SEG=MAIN   3160 3224 3233#
LABEL7 . . . . . .  C ADDR   142BH   R   SEG=MAIN   3411#
LABELA . . . . . .  C ADDR   0249H   R   SEG=MAIN   629# 654 1692
LABELB . . . . . .  C ADDR   08DBH   R   SEG=MAIN   1080 1410 1577# 1703 1707 1709
LABELC . . . . . .  C ADDR   0D5DH   R   SEG=MAIN   2423#
LABELE . . . . . .  C ADDR   0D26H   R   SEG=MAIN   2371 2387# 2428 2431 2435 2439
LABELF . . . . . .  C ADDR   0D7CH   R   SEG=MAIN   2226 2442#
LABELH . . . . . .  C ADDR   10E8H   R   SEG=MAIN   2799 2940#
LABELI . . . . . .  C ADDR   156AH   R   SEG=MAIN   2955 3007 3057 3583#
LABELI2. . . . . .  C ADDR   115EH   R   SEG=MAIN   3007# 3008
LABELK . . . . . .  C ADDR   122FH   R   SEG=MAIN   2954 3126#
LABELL . . . . . .  C ADDR   0F0AH   R   SEG=MAIN   2571 2649 2658#
LABELL1. . . . . .  C ADDR   0E3CH   R   SEG=MAIN   2556# 2624 2724 2773
LABELN . . . . . .  C ADDR   0F8DH   R   SEG=MAIN   2625 2733#
LABELP . . . . . .  C ADDR   142BH   R   SEG=MAIN   3371 3384 3410# 3419
LABELS . . . . . .  C ADDR   13FDH   R   SEG=MAIN   3220 3384#
LABELS1. . . . . .  C ADDR   14E6H   R   SEG=MAIN   3477 3507#
LABELS3. . . . . .  C ADDR   157DH   R   SEG=MAIN   3567 3593#
LABELS4. . . . . .  C ADDR   1551H   R   SEG=MAIN   3544 3570#
LABL2. . . . . . .  C ADDR   0F51H   R   SEG=MAIN   2690# 3190
LABL21 . . . . . .  C ADDR   0F2AH   R   SEG=MAIN   2659 2673#
LABL22 . . . . . .  C ADDR   0F40H   R   SEG=MAIN   2677 2682#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   105

LABM . . . . . . .  C ADDR   1331H   R   SEG=MAIN   3191 3287#
LADD . . . . . . .  C ADDR   1DCBH   R   SEG=MAIN   730 766 1657 4999#
LADDX. . . . . . .  C ADDR   1DDCH   R   SEG=MAIN   5023#
LAL22. . . . . . .  C ADDR   0F22H   R   SEG=MAIN   2663 2668#
LBTOF. . . . . . .  C ADDR   042DH   A      6113#
LCMP . . . . . . .  C ADDR   1BC9H   R   SEG=MAIN   2088 2216 4579#
LDC_LONG . . . . .  C ADDR   1BDFH   R   SEG=MAIN   535 1655 1815 1853 2935 4599#
LDC_LTEMP. . . . .  C ADDR   1C01H   R   SEG=MAIN   739 981 986 991 1065 1138 1146 1159 1199 1233 1237 1249 1273 1281
                                           1287 1304 1310 1425 1887 4635#
LDX_LONG . . . . .  C ADDR   1C27H   R   SEG=MAIN   4670#
LDX_LTEMP. . . . .  C ADDR   1C4DH   R   SEG=MAIN   4708#
LEFCUR . . . . . .  C ADDR   1374H   R   SEG=MAIN   3319# 3355 3373
LEFMEM11 . . . . .  C ADDR   1237H   R   SEG=MAIN   3151# 3173 3175
LEFT_SK. . . . . .  C ADDR   1533H   R   SEG=MAIN   3509 3554#
LEV220 . . . . . .  C ADDR   1276H   R   SEG=MAIN   3179# 3188
LEV2GO . . . . . .  C ADDR   0FB3H   R   SEG=MAIN   2732 2769#
LEVEL. . . . . . .  D ADDR   00B0H   A      383# 2294 2630 2658 3117 3149 3235
LI21 . . . . . . .  C ADDR   11B1H   R   SEG=MAIN   3052 3054#
LLDI2. . . . . . .  C ADDR   0D0CH   R   SEG=MAIN   2353 2357#
LLDI23 . . . . . .  C ADDR   0D00H   R   SEG=MAIN   2345 2350#
LLDI3. . . . . . .  C ADDR   0D07H   R   SEG=MAIN   2352 2354#
LLEV2. . . . . . .  C ADDR   0F78H   R   SEG=MAIN   2689 2722#
LLMUL. . . . . . .  C ADDR   1D34H   R   SEG=MAIN   4893#
LLSUB. . . . . . .  C ADDR   1DB9H   R   SEG=MAIN   4975#
LLTOF. . . . . . .  C ADDR   0432H   A      6119#
LMUL . . . . . . .  C ADDR   1D34H   R   SEG=MAIN   2046 4895#
LOAB12 . . . . . .  C ADDR   1A9CH   R   SEG=MAIN   3080 4286#
LOAD . . . . . . .  D ADDR   00B7H   A      387# 2411 2447 2942 3076 3983
LOADB. . . . . . .  C ADDR   11D0H   R   SEG=MAIN   3071 3074# 3104 3110
LOADB2 . . . . . .  C ADDR   11F9H   R   SEG=MAIN   3092 3096#
LOADCLE. . . . . .  C ADDR   1255H   R   SEG=MAIN   3165# 3227
LOADKD . . . . . .  C ADDR   1AB9H   R   SEG=MAIN   4319#
LOADR2 . . . . . .  C ADDR   1AABH   R   SEG=MAIN   3341 3367 3644 3671 4302#
LOADT. . . . . . .  C ADDR   18F0H   R   SEG=MAIN   2413 2453 2948 3983#
LOADUS . . . . . .  C ADDR   1892H   R   SEG=MAIN   593 1210 1398 1759 1861 2320 2368 2900 2922 3083 3904#
LOBLOK . . . . . .  C ADDR   12FDH   R   SEG=MAIN   3214 3246# 3254
LOCLE. . . . . . .  C ADDR   1250H   R   SEG=MAIN   3154 3163#
LOD1 . . . . . . .  C ADDR   18FFH   R   SEG=MAIN   3991# 3996
LODT . . . . . . .  C ADDR   190BH   R   SEG=MAIN   4003# 4008
LOIZMK . . . . . .  C ADDR   1132H   R   SEG=MAIN   2980# 3012
LOKAME1. . . . . .  C ADDR   144CH   R   SEG=MAIN   3429#
LOLEVT . . . . . .  C ADDR   18F2H   R   SEG=MAIN   2300 3984#
LOLIST . . . . . .  C ADDR   1244H   R   SEG=MAIN   3156#
LOME1. . . . . . .  C ADDR   17AFH   R   SEG=MAIN   3761# 3765 3768 3771 3774 3778 3781 3784 3787 3791
LOMENU . . . . . .  C ADDR   17A7H   R   SEG=MAIN   2584 2597 3429 3464 3487 3758#
LOOP . . . . . . .  C ADDR   0AF6H   R   SEG=MAIN   1968# 1969
LOOPS. . . . . . .  C ADDR   1C8DH   R   SEG=MAIN   4774# 4807
LOSPUS . . . . . .  C ADDR   18C9H   R   SEG=MAIN   1729 3943#
LOTEXT . . . . . .  C ADDR   1907H   R   SEG=MAIN   1292 1296 1389 2331 2470 2478 2484 2490 2604 2608 2638 2647 2655
                                           2666 2670 2680 2684 2891 2973 3038 3115 3157 3166 3170 3184 3239 3247 3308
                                           3345 3397 3425 3445 3449 3483 3556 3560 3654 3761 4000#
LOTP . . . . . . .  C ADDR   1B0FH   R   SEG=MAIN   4360# 4370 4373
LOTPUS . . . . . .  C ADDR   1B07H   R   SEG=MAIN   3495 3938 4357#
LOU. . . . . . . .  C ADDR   0D12H   R   SEG=MAIN   2340 2356 2360#
LOUIZM . . . . . .  C ADDR   0CEFH   R   SEG=MAIN   2340# 2365 3935
LOUTF. . . . . . .  C ADDR   0F27H   R   SEG=MAIN   2662 2671# 2676 2723 2730
LOVICH . . . . . .  C ADDR   1128H   R   SEG=MAIN   2976# 3005 3026 3684
LOWR . . . . . . .  C ADDR   125EH   R   SEG=MAIN   3163 3168#
LOWR1. . . . . . .  C ADDR   1260H   R   SEG=MAIN   3169# 3231
LSUB . . . . . . .  C ADDR   1DB9H   R   SEG=MAIN   1077 1173 1888 4976#
LTEMP. . . . . . .  N NUMB   0008H   A      993 995 996 997 2098 2101 2104 2107 2150 2151 2152 2153 4192 4193 4194
                                           4195 4391# 4765 4766 4767 4768 4777 4781 4785 4789 4792 4793 4794 4795
                                           4796 4797 4798 4799 4800 4801 4802 4803 4806 4809 4814 4818 4822 4832 4835
                                           4838 4841 4857 4860 4861 4863 4864 4866 4867 4869 4874 4875 4876 4877 4897
                                           4902 4910 4918 4923 4934 4942 4948 4956 4962 5330 5331 5370 5375 5377 5386
                                           5387 5388 5389 5620 5628 5641 5644 5647 5650 6230 6233 6236 6239
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   106

LWR. . . . . . . .  C ADDR   0B3BH   R   SEG=MAIN   2037# 2041
LWRX . . . . . . .  C ADDR   0AFFH   R   SEG=MAIN   1981# 1993
LWTOF. . . . . . .  C ADDR   042FH   A      6115#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   0B56H   R   SEG=MAIN   1478 2045 2050 2055# 2087
MAIN . . . . . . .  C SEG    1E16H       REL=UNIT   237 294# 436
MANT1. . . . . . .  N NUMB   0002H   A      5328# 5355 5404 5405
MANT2. . . . . . .  N NUMB   0008H   A      5330# 5381 5382 5513 5515 5516 5518 5519 5521 5522 5524 5563 5564 5566
                                           5567 5569 5570 5572 5573 5577 5579 5582 5585 5683 5685 5686 5688 5689 5691
                                           5692 5694 5745 5747 5748 5750 5751 5753 5754 5756 5838 5842 5846 5850 5854
                                           5857 5860 5863
MARK0_8. . . . . .  C ADDR   0E06H   R   SEG=MAIN   2501 2519 2521#
MARKER . . . . . .  D ADDR   00B2H   A      385# 514 2248 2500 2510 2518 2528 2534 2697 2704 2740 2747 2759 2821 3016
                                           3033 3050 3248 3266 3273 3309 3319 3346 3465 3593 3612 3619 3649 3680 3793
                                           3821 3836 3847
MARLE. . . . . . .  C ADDR   1826H   R   SEG=MAIN   3327 3833#
MARRI. . . . . . .  C ADDR   1833H   R   SEG=MAIN   2767 3846#
MAS10. . . . . . .  C ADDR   0366H   R   SEG=MAIN   800 812#
MAS20. . . . . . .  C ADDR   03E3H   R   SEG=MAIN   812 865#
MAS5DIV. . . . . .  C ADDR   050CH   R   SEG=MAIN   982 987 992 999#
MASFULL. . . . . .  C ADDR   04DEH   R   SEG=MAIN   971 975#
MASS0. . . . . . .  X ADDR   0080H   A      399 400# 801 806 834 842 913 921 2023
MASS1. . . . . . .  X ADDR   0084H   A      401# 809 831 845 910 924
MASS10 . . . . . .  X ADDR   00A8H   A      410# 886 943
MASS11 . . . . . .  X ADDR   00ACH   A      411# 883 945
MASS12 . . . . . .  X ADDR   00B0H   A      412# 880 947
MASS13 . . . . . .  X ADDR   00B4H   A      413# 877 949
MASS14 . . . . . .  X ADDR   00B8H   A      414# 874 951
MASS15 . . . . . .  X ADDR   00BCH   A      415# 871 953
MASS16 . . . . . .  X ADDR   00C0H   A      416# 869 955
MASS17 . . . . . .  X ADDR   00C4H   A      417# 867 957
MASS18 . . . . . .  X ADDR   00C8H   A      418# 865 959
MASS19 . . . . . .  X ADDR   00CCH   A      419# 961
MASS2. . . . . . .  X ADDR   0088H   A      402# 828 847 907 926
MASS3. . . . . . .  X ADDR   008CH   A      403# 825 849 904 928
MASS4. . . . . . .  X ADDR   0090H   A      404# 822 851 901 930
MASS5. . . . . . .  X ADDR   0094H   A      405# 819 853 898 932
MASS6. . . . . . .  X ADDR   0098H   A      406# 817 855 896 934
MASS7. . . . . . .  X ADDR   009CH   A      407# 815 857 894 936
MASS8. . . . . . .  X ADDR   00A0H   A      408# 813 859 892 938
MASS9. . . . . . .  X ADDR   00A4H   A      409# 861 889 940
MASX5. . . . . . .  C ADDR   0502H   R   SEG=MAIN   973 993#
ME11_15DEC . . . .  C ADDR   144BH   R   SEG=MAIN   3394 3428#
ME21_23. . . . . .  C ADDR   14A4H   R   SEG=MAIN   3408 3473#
ME21_23DEC . . . .  C ADDR   14C0H   R   SEG=MAIN   3480 3485#
MEAVP. . . . . . .  C ADDR   10A7H   R   SEG=MAIN   2904 2907#
MECLE. . . . . . .  C ADDR   016FH   R   SEG=MAIN   495# 497
MEFF . . . . . . .  C ADDR   0176H   R   SEG=MAIN   499# 502
MEM12NO. . . . . .  C ADDR   12DCH   R   SEG=MAIN   3225 3229#
MENU12 . . . . . .  C ADDR   17B3H   R   SEG=MAIN   3759 3763#
MENU13 . . . . . .  C ADDR   17BBH   R   SEG=MAIN   3763 3766#
MENU14 . . . . . .  C ADDR   17C3H   R   SEG=MAIN   3766 3769#
MENU15 . . . . . .  C ADDR   17CBH   R   SEG=MAIN   3769 3772#
MENU21 . . . . . .  C ADDR   17D3H   R   SEG=MAIN   3772 3776#
MENU22 . . . . . .  C ADDR   17DBH   R   SEG=MAIN   3776 3779#
MENU23 . . . . . .  C ADDR   17E3H   R   SEG=MAIN   3779 3782#
MENU31 . . . . . .  C ADDR   17EBH   R   SEG=MAIN   3782 3785#
MENU41 . . . . . .  C ADDR   17F3H   R   SEG=MAIN   3785 3789#
MENUOFF. . . . . .  C ADDR   1093H   R   SEG=MAIN   2887 2896#
MENUON . . . . . .  C ADDR   141EH   R   SEG=MAIN   3399#
ME_41. . . . . . .  C ADDR   1521H   R   SEG=MAIN   3507 3544#
MIDL . . . . . . .  C ADDR   1CC0H   R   SEG=MAIN   4769 4804#
MIGN . . . . . . .  C ADDR   17F8H   R   SEG=MAIN   1900 3793#
MIGNN. . . . . . .  C ADDR   1800H   R   SEG=MAIN   3795 3800#
MLABL2 . . . . . .  C ADDR   1314H   R   SEG=MAIN   3240 3258# 3289
MMM. . . . . . . .  C ADDR   0244H   R   SEG=MAIN   624#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   107

MO220. . . . . . .  C ADDR   07B4H   R   SEG=MAIN   1191 1383#
MO500I . . . . . .  C ADDR   0724H   R   SEG=MAIN   1239 1295#
MO500R . . . . . .  C ADDR   0718H   R   SEG=MAIN   1235 1291#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   0EBDH   R   SEG=MAIN   2626# 2635 2644 2652
MOVE28 . . . . . .  C ADDR   0BC3H   R   SEG=MAIN   1067 1148 1222 1241 1813 1851 2150#
MOVE82 . . . . . .  C ADDR   1A0BH   R   SEG=MAIN   4192#
MOVEA3 . . . . . .  C ADDR   0822H   R   SEG=MAIN   1435 1460#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2502 2712 2752 3035 3213 3251 3282 3312 3320 3349 3468 3594 3622
                                           3652 3840
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2498 2705 2709 2748 3036 3212 3250 3274 3278 3311 3324 3348 3467
                                           3598 3651 3849
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      5680# 5723
MUP11. . . . . . .  C ADDR   0257H   A      5727# 5772
MUP2 . . . . . . .  C ADDR   0297H   A      5757 5771#
MUP3 . . . . . . .  C ADDR   026CH   A      5726 5742#
MVV11. . . . . . .  C ADDR   12F8H   R   SEG=MAIN   3236 3244#
MVV12. . . . . . .  C ADDR   1310H   R   SEG=MAIN   3244 3253#
N12DELCH . . . . .  C ADDR   0A6BH   R   SEG=MAIN   1866 1874#
N4DELCH. . . . . .  C ADDR   0A1CH   R   SEG=MAIN   1793 1831#
N8DELCH. . . . . .  C ADDR   0A59H   R   SEG=MAIN   1831 1866#
NBIMENU. . . . . .  C ADDR   0EC3H   R   SEG=MAIN   2629#
NBLOK. . . . . . .  D ADDR   00C4H   A      391# 3304
NE05 . . . . . . .  C ADDR   0358H   A      5909 5911 5913 5916#
NEXIN. . . . . . .  C ADDR   0A91H   R   SEG=MAIN   1903# 1910
NMINUS . . . . . .  C ADDR   05DBH   R   SEG=MAIN   1119 1123#
NMINUS3. . . . . .  C ADDR   052CH   R   SEG=MAIN   1024 1026#
NNDELCH. . . . . .  C ADDR   09DCH   R   SEG=MAIN   1783 1793#
NNMEMB . . . . . .  C ADDR   0FBFH   R   SEG=MAIN   2628 2774#
NNNUL. . . . . . .  C ADDR   089FH   R   SEG=MAIN   1541 1544#
NO . . . . . . . .  C ADDR   1CA8H   R   SEG=MAIN   4779 4783 4787 4791#
NO0KEY . . . . . .  C ADDR   0256H   R   SEG=MAIN   633 638#
NO11V6 . . . . . .  C ADDR   0DC5H   R   SEG=MAIN   2467 2481#
NO12V6 . . . . . .  C ADDR   0DD2H   R   SEG=MAIN   2481 2487#
NO13V6 . . . . . .  C ADDR   0DDFH   R   SEG=MAIN   2487 2495#
NO21P7 . . . . . .  C ADDR   15F3H   R   SEG=MAIN   3632 3662#
NO23RI . . . . . .  C ADDR   0E87H   R   SEG=MAIN   2595 2599#
NO2PARN. . . . . .  C ADDR   080DH   R   SEG=MAIN   1437 1443#
NO31N. . . . . . .  C ADDR   1388H   R   SEG=MAIN   3317 3330#
NO31RI . . . . . .  C ADDR   0EA6H   R   SEG=MAIN   2601 2616#
NO3PARN. . . . . .  C ADDR   0803H   R   SEG=MAIN   1437# 1521
NO4DEL . . . . . .  C ADDR   09B7H   R   SEG=MAIN   1733 1764#
NOAVK. . . . . . .  C ADDR   05B0H   R   SEG=MAIN   1048 1095#
NOAVP. . . . . . .  C ADDR   062EH   R   SEG=MAIN   1164# 1201 1204
NOBAVP . . . . . .  C ADDR   08BCH   R   SEG=MAIN   1556 1560#
NOBEF99. . . . . .  C ADDR   02FFH   R   SEG=MAIN   736 753# 772
NOBIT. . . . . . .  C ADDR   0245H   A      5695 5709#
NOBITIZM . . . . .  C ADDR   08C2H   R   SEG=MAIN   1294 1298 1378 1560 1563#
NOBUF0 . . . . . .  C ADDR   0979H   R   SEG=MAIN   1666 1697#
NOCHI0 . . . . . .  C ADDR   07E4H   R   SEG=MAIN   1192 1409#
NOCHN10. . . . . .  C ADDR   04FAH   R   SEG=MAIN   984 989#
NOCHN2 . . . . . .  C ADDR   04EFH   R   SEG=MAIN   979 984#
NODI2. . . . . . .  C ADDR   07CAH   R   SEG=MAIN   1386 1393#
NODI6. . . . . . .  C ADDR   10B5H   R   SEG=MAIN   2912 2916#
NODI8. . . . . . .  C ADDR   0875H   R   SEG=MAIN   1505 1511#
NODI9. . . . . . .  C ADDR   07CFH   R   SEG=MAIN   1395 1398#
NODIS9 . . . . . .  C ADDR   0885H   R   SEG=MAIN   1511 1523#
NOEQU1 . . . . . .  C ADDR   0FA4H   R   SEG=MAIN   2751 2755#
NOEQU2 . . . . . .  C ADDR   1382H   R   SEG=MAIN   3323 3327#
NOFIZM . . . . . .  C ADDR   0DA3H   R   SEG=MAIN   2443 2465#
NOFT1. . . . . . .  C ADDR   0D8FH   R   SEG=MAIN   2448 2452#
NOFZ . . . . . . .  C ADDR   0974H   R   SEG=MAIN   1689 1692#
NOH37. . . . . . .  C ADDR   113FH   R   SEG=MAIN   2969 2990# 2999
NOHNOT1. . . . . .  C ADDR   1209H   R   SEG=MAIN   3066 3105#
NOHNOT2. . . . . .  C ADDR   1201H   R   SEG=MAIN   3099# 3105
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   108

NOKORR . . . . . .  C ADDR   0542H   R   SEG=MAIN   1035 1038#
NOLAH. . . . . . .  C ADDR   1109H   R   SEG=MAIN   2940 2957#
NOLEV1 . . . . . .  C ADDR   0F48H   R   SEG=MAIN   2673 2687#
NOM31. . . . . . .  C ADDR   136BH   R   SEG=MAIN   3287 3315#
NOM32. . . . . . .  C ADDR   13BAH   R   SEG=MAIN   3315 3353#
NOM33. . . . . . .  C ADDR   13E5H   R   SEG=MAIN   3353 3371#
NOMARL . . . . . .  C ADDR   1592H   R   SEG=MAIN   3596 3602 3606#
NOME11 . . . . . .  C ADDR   12CCH   R   SEG=MAIN   3222#
NOMEM11. . . . . .  C ADDR   0EDEH   R   SEG=MAIN   2631 2641#
NOMEM12. . . . . .  C ADDR   0EF4H   R   SEG=MAIN   2641 2649#
NOMEMK . . . . . .  C ADDR   12C9H   R   SEG=MAIN   3125 3220#
NON1C. . . . . . .  C ADDR   0D6EH   R   SEG=MAIN   2429 2433#
NONULAVT . . . . .  C ADDR   0598H   R   SEG=MAIN   1043 1082#
NONULDEL . . . . .  C ADDR   099EH   R   SEG=MAIN   1716 1732#
NOP3_0 . . . . . .  C ADDR   07E8H   R   SEG=MAIN   1415#
NOPART1. . . . . .  C ADDR   0303H   R   SEG=MAIN   725 760#
NOPART2. . . . . .  C ADDR   0323H   R   SEG=MAIN   760 779#
NOPART3. . . . . .  C ADDR   0328H   R   SEG=MAIN   779 782#
NOPART4. . . . . .  C ADDR   033BH   R   SEG=MAIN   782 791#
NOPLUS . . . . . .  C ADDR   0E2EH   R   SEG=MAIN   2546 2549#
NOPOIN7. . . . . .  C ADDR   15A9H   R   SEG=MAIN   3592 3627#
NOPOINT. . . . . .  C ADDR   1575H   R   SEG=MAIN   3586 3590#
NOR11. . . . . . .  C ADDR   0E42H   R   SEG=MAIN   2473 2560#
NOR13. . . . . . .  C ADDR   0DB8H   R   SEG=MAIN   2475#
NORDN. . . . . . .  C ADDR   00F6H   A      5416# 5449
NORDN1 . . . . . .  C ADDR   0107H   A      5418 5432#
NORIG2 . . . . . .  C ADDR   0F81H   R   SEG=MAIN   2719 2727#
NORIM6 . . . . . .  C ADDR   0FBFH   R   SEG=MAIN   2775#
NORIME . . . . . .  C ADDR   0E6DH   R   SEG=MAIN   2582 2586#
NORIME1. . . . . .  C ADDR   0E67H   R   SEG=MAIN   2584# 2587 2600
NORM1. . . . . . .  C ADDR   00F0H   A      5411# 5608 5785 5887 6104
NORR11 . . . . . .  C ADDR   1151H   R   SEG=MAIN   3001#
NORR12 . . . . . .  C ADDR   1161H   R   SEG=MAIN   3001 3008# 3022
NORUP. . . . . . .  C ADDR   0119H   A      5415 5452#
NORUP1 . . . . . .  C ADDR   011EH   A      5457# 5475
NORUP2 . . . . . .  C ADDR   0132H   A      5459 5476#
NORVICH. . . . . .  C ADDR   08D4H   R   SEG=MAIN   1520 1573#
NOSUB. . . . . . .  C ADDR   1CE3H   R   SEG=MAIN   4813 4817 4821 4826#
NOT1IN . . . . . .  C ADDR   097CH   R   SEG=MAIN   1670 1701#
NOT1_7 . . . . . .  C ADDR   106CH   R   SEG=MAIN   2869 2876#
NOT2IN . . . . . .  C ADDR   0984H   R   SEG=MAIN   1701 1705#
NOT2_7 . . . . . .  C ADDR   1077H   R   SEG=MAIN   2876 2881#
NOT3IN . . . . . .  C ADDR   098CH   R   SEG=MAIN   1705 1708#
NOTAKT . . . . . .  C ADDR   08CCH   R   SEG=MAIN   1564 1568#
NOTT1. . . . . . .  C ADDR   095FH   R   SEG=MAIN   1676 1680#
NOTT5. . . . . . .  C ADDR   0964H   R   SEG=MAIN   1680 1684#
NOT_1. . . . . . .  C ADDR   0D75H   R   SEG=MAIN   2433 2438#
NOT_10 . . . . . .  C ADDR   0D75H   R   SEG=MAIN   2437#
NOVIR. . . . . . .  C ADDR   0E52H   R   SEG=MAIN   2464 2573#
NOVIR1 . . . . . .  C ADDR   0DA0H   R   SEG=MAIN   2464# 2465
NOZZMI . . . . . .  C ADDR   0865H   R   SEG=MAIN   1500 1502#
NSEC01 . . . . . .  C ADDR   08A8H   R   SEG=MAIN   1545 1548#
NSEC1. . . . . . .  C ADDR   08AFH   R   SEG=MAIN   1548 1551#
NSEC10 . . . . . .  C ADDR   08B4H   R   SEG=MAIN   1547 1550 1551 1555#
NULAVT . . . . . .  C ADDR   09C9H   R   SEG=MAIN   1781#
NUMSIZE. . . . . .  N NUMB   0004H   A      4394# 4416 4454 4461 4536 4556
OBOARD . . . . . .  C ADDR   1C19H   R   SEG=MAIN   4637 4651#
OBOARD1. . . . . .  C ADDR   1C61H   R   SEG=MAIN   4710 4723#
OK1. . . . . . . .  C ADDR   0186H   A      5542 5557#
OK2. . . . . . . .  C ADDR   01A0H   A      5559 5574#
OK3. . . . . . . .  C ADDR   01C4H   A      5591 5607#
ONBOAR1. . . . . .  C ADDR   1C3FH   R   SEG=MAIN   4672 4689#
ONBOARD. . . . . .  C ADDR   1BF3H   R   SEG=MAIN   4601 4615#
ONMEM11. . . . . .  C ADDR   1222H   R   SEG=MAIN   2895 2906 2908 3119# 3398 3404 3426 3430 3434 3447 3451 3470 3484
                                           3488 3499
ONMEM12. . . . . .  C ADDR   14C7H   R   SEG=MAIN   3489# 3492 3511 3548
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   109

ONMEM13. . . . . .  C ADDR   154EH   R   SEG=MAIN   3568# 3570 3574
ONMIG. . . . . . .  C ADDR   180EH   R   SEG=MAIN   3804 3813#
ONVICH . . . . . .  C ADDR   0CE7H   R   SEG=MAIN   2323 2335#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 475
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 468 472
OUT6 . . . . . . .  C ADDR   0FBFH   R   SEG=MAIN   2225 2286 2393 2398 2403 2420 2450 2455 2462 2569 2585 2598 2606
                                           2610 2776#
OUT7 . . . . . . .  C ADDR   1621H   R   SEG=MAIN   2797 2798 2873 2880 2884 2945 2950 3123 3415 3461 3542 3558 3562
                                           3581 3624 3629 3659 3687#
OUTA . . . . . . .  C ADDR   1840H   R   SEG=MAIN   3040 3857#
OUTA2. . . . . . .  C ADDR   185AH   R   SEG=MAIN   3868# 3873
OUTB . . . . . . .  C ADDR   1863H   R   SEG=MAIN   3655 3877#
OUTB2. . . . . . .  C ADDR   1889H   R   SEG=MAIN   3895# 3900
OUTB3. . . . . . .  C ADDR   1874H   R   SEG=MAIN   3881 3886#
OUTF . . . . . . .  C ADDR   0D96H   R   SEG=MAIN   2446 2458# 2471 2479 2485 2491 2516 2539 2548 2551 2558 2626 2639
                                           2648 2656 2667 2671 2681 2685 2711 2714 2754 2768 2771 3489 3553 3568
OUTFL. . . . . . .  C ADDR   0E3FH   R   SEG=MAIN   2554 2558#
OUTMA. . . . . . .  C ADDR   0E18H   R   SEG=MAIN   2537 2539#
OUTMENU. . . . . .  C ADDR   148BH   R   SEG=MAIN   3460# 3579
OUTR . . . . . . .  C ADDR   077BH   R   SEG=MAIN   1324 1347#
OUTR5. . . . . . .  C ADDR   0797H   R   SEG=MAIN   1345 1366#
OUTVIR . . . . . .  C ADDR   0C92H   R   SEG=MAIN   2255 2282#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 4593
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 1903 1907
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 446
P1 . . . . . . . .  D ADDR   0090H   A      32# 596 597 1916 1918 1921 1924 1928 1930 1931 2180 2183 2185 2188 2194
                                           2196 2198 4259 4266
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 447
P2 . . . . . . . .  D ADDR   00A0H   A      47# 1949 1953 1962
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 448
P3 . . . . . . . .  D ADDR   00B0H   A      62# 457 1948 1950 1952 1958 1959 1960 1963 1964 2254 2256 2258 2259 2262
                                           2263 2265 2266 2268 2269 2271 2272 2274 2275 2277 2278 2444 2445 2495 2496
                                           2541 2542 2552 2553 2579 2580 2593 2594 2620 2621 2622 2623 2633 2634 2642
                                           2643 2650 2651 2660 2661 2674 2675 2688 2689 2722 2723 2731 2732 2769 2770
                                           2792 2828 2830 2832 2833 2836 2837 2839 2840 2842 2843 2845 2846 2848 2849
                                           2851 2852 2941 2943 2968 2969 2990 2991 3002 3003 3009 3010 3023 3024 3064
                                           3065 3151 3152 3179 3180 3194 3195 3196 3197 3203 3204 3222 3223 3233 3234
                                           3288 3289 3290 3291 3316 3317 3330 3331 3354 3355 3356 3357 3372 3373 3374
                                           3375 3391 3392 3418 3419 3478 3479 3491 3492 3508 3509 3510 3511 3545 3546
                                           3547 3548 3571 3572 3573 3574 3584 3585 3590 3591 3627 3628 3703
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2789 2791 3700 3702
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 450
P4 . . . . . . . .  D ADDR   0084H   A      20# 2347 2349 3913 3916 3932 3934 4362
P5 . . . . . . . .  D ADDR   0085H   A      21# 520 528 1784 1789 1824 1826 2357 2359 3921 3924 3954 3957 4366
P6 . . . . . . . .  D ADDR   0086H   A      22# 598 600 604 606
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 451
PACK1. . . . . . .  C ADDR   00DEH   A      5394# 5609 5786 5888 6105
PARN . . . . . . .  D ADDR   00AFH   A      382# 525 1534 2424 3089
PART . . . . . . .  D ADDR   009AH   A      372# 521 723 1013 1055 1082 1095 1544 1574 1674 1685 2387 2425 2867 3074
                                           3088 3925 4286
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   110

PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 444
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 445
PCON . . . . . . .  D ADDR   0087H   A      23#
POIN3. . . . . . .  C ADDR   15A8H   R   SEG=MAIN   3625# 3660
POINA. . . . . . .  C ADDR   15EEH   R   SEG=MAIN   3623 3659#
POINA1 . . . . . .  C ADDR   158DH   R   SEG=MAIN   3595 3602#
POINA2 . . . . . .  C ADDR   1587H   R   SEG=MAIN   3598# 3603
POZB . . . . . . .  C ADDR   1611H   R   SEG=MAIN   3673 3677#
PROD . . . . . . .  N NUMB   000CH   A      5331# 5675 5676 5677 5678 5698 5699 5700 5702 5703 5705 5706 5708 5730
                                           5732 5733 5735 5736 5738 5739 5741 5760 5761 5762 5764 5765 5767 5768 5770
                                           5781 5782 5783 5784 5805 5806 5807 5808 5824 5826 5827 5829 5830 5832 5833
                                           5835 5865 5882 5883 5884 5885
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 6136 6140 6193 6196
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 2089 2091 2234 2785 2805 3698 5066
                                           5074
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0C9CH   R   SEG=MAIN   2276 2288#
R10. . . . . . . .  N NUMB   000AH   A      431# 629 1044 1244 1252 4334 6159
R11. . . . . . . .  N NUMB   000BH   A      432# 630 1045 1245 1251 3442 4338 6163
R8 . . . . . . . .  N NUMB   0008H   A      429# 1242 1254 2214 4326 6151
R9 . . . . . . . .  N NUMB   0009H   A      430# 1243 1253 2215 4330 6155
RAFTERK. . . . . .  C ADDR   0558H   R   SEG=MAIN   1052# 1058
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RE1. . . . . . . .  C ADDR   0BF8H   R   SEG=MAIN   2194# 2200
RE4BYTE. . . . . .  C ADDR   0454H   A      3441 6147#
REACP. . . . . . .  D ADDR   0077H   A      304# 611 613 615 617 664 680 688 696 705 712 727 763 783 792 1798 1800
                                           1802 1804 1836 1838 1840 1842
READ . . . . . . .  C ADDR   0BF6H   R   SEG=MAIN   610 612 614 2193#
READYACP . . . . .  C ADDR   02BAH   R   SEG=MAIN   706 716#
READ_X2. . . . . .  C ADDR   0AE5H   R   SEG=MAIN   1957# 1968
REBYTE . . . . . .  C ADDR   020FH   R   SEG=MAIN   595# 640 754 1762 1772 1791 1829 1864 1873 1875
REBYTE2. . . . . .  C ADDR   046CH   A      1061 1142 6167#
REF0CN . . . . . .  D ADDR   00D1H   A      92# 452
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RESAR2 . . . . . .  C ADDR   0BCFH   R   SEG=MAIN   728 764 784 793 805 840 919 1070 1111 1150 1167 1221 1224 1247
                                           1270 1423 1472 1476 1736 2158# 2928 3858 3878
RESAR8 . . . . . .  C ADDR   0B8DH   R   SEG=MAIN   1026 1076 1114 1123 1172 1811 1849 2097#
REZAM. . . . . . .  D ADDR   008CH   A      368# 1846
REZAP. . . . . . .  D ADDR   0088H   A      367# 1808
REZMUL . . . . . .  C ADDR   05C3H   R   SEG=MAIN   1090 1102 1109#
REZ_A. . . . . . .  D ADDR   0062H   A      357# 741 785 794 804 839 918 1735
REZ_A0 . . . . . .  D ADDR   006AH   A      359# 1075 1171 1215 1404 2318 2920 2929 2936
REZ_A1 . . . . . .  D ADDR   0066H   A      358# 1007 1073 1110 1155 1166 1223
REZ_A2 . . . . . .  D ADDR   007BH   A      360# 1168
REZ_A3 . . . . . .  D ADDR   009CH   A      374# 1078 1174 1422 1471 1475 1579 2927
REZ_AME. . . . . .  D ADDR   005EH   A      355# 1019 1028 1069 1127 1149
REZ_DEL. . . . . .  D ADDR   00C5H   A      392# 743
REZ_R. . . . . . .  D ADDR   00C9H   A      393# 1256 1269
RGOTO7 . . . . . .  C ADDR   1368H   R   SEG=MAIN   3313# 3331 3357
RHNOR11. . . . . .  C ADDR   1139H   R   SEG=MAIN   2967 2979 2985#
RHNOT1 . . . . . .  C ADDR   1100H   R   SEG=MAIN   2943 2952#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   111

RI21_23. . . . . .  C ADDR   0E70H   R   SEG=MAIN   2577 2589#
RI6. . . . . . . .  C ADDR   0E6AH   R   SEG=MAIN   2580 2585# 2594 2619 2623
RIGBLO . . . . . .  C ADDR   0F4BH   R   SEG=MAIN   2688# 2718 2720
RIGBLOK. . . . . .  C ADDR   0F87H   R   SEG=MAIN   2731#
RIGHT2 . . . . . .  C ADDR   0CAFH   R   SEG=MAIN   2295 2299#
RIGHT3 . . . . . .  C ADDR   0CB3H   R   SEG=MAIN   2297 2302#
RIKN . . . . . . .  C ADDR   0DF1H   R   SEG=MAIN   2502# 2520
RIZMAN . . . . . .  C ADDR   0C27H   R   SEG=MAIN   2229# 2264
RI_31. . . . . . .  C ADDR   0E8AH   R   SEG=MAIN   2592 2601#
RKNLEFT. . . . . .  C ADDR   0FF1H   R   SEG=MAIN   2801# 2844
RKNMEM . . . . . .  C ADDR   0FE2H   R   SEG=MAIN   2796# 2850
RKNNUL . . . . . .  C ADDR   0FEEH   R   SEG=MAIN   2800# 2838
RKNOPT . . . . . .  C ADDR   0C24H   R   SEG=MAIN   2228# 2273
RKNRAZR. . . . . .  C ADDR   0C21H   R   SEG=MAIN   2227# 2267
RKVVOD0. . . . . .  C ADDR   124DH   R   SEG=MAIN   3153 3160#
RLABELF. . . . . .  C ADDR   0C1EH   R   SEG=MAIN   2226# 2261
RLABELH. . . . . .  C ADDR   0FEBH   R   SEG=MAIN   2799# 2835
RLABELI. . . . . .  C ADDR   1106H   R   SEG=MAIN   2955#
RLABELK. . . . . .  C ADDR   1103H   R   SEG=MAIN   2954# 2957
RLABELL. . . . . .  C ADDR   0E4FH   R   SEG=MAIN   2568 2571#
RLABELL1 . . . . .  C ADDR   0FBCH   R   SEG=MAIN   2770 2773#
RLABELN. . . . . .  C ADDR   0EBAH   R   SEG=MAIN   2621 2625#
RLABELS3 . . . . .  C ADDR   154CH   R   SEG=MAIN   3546 3567# 3572
RLABL2 . . . . . .  C ADDR   128FH   R   SEG=MAIN   3190# 3195
RLABM. . . . . . .  C ADDR   1292H   R   SEG=MAIN   3191# 3193
RLER . . . . . . .  C ADDR   1832H   R   SEG=MAIN   3841 3843#
RME21_23 . . . . .  C ADDR   1429H   R   SEG=MAIN   3389 3408#
RMO220 . . . . . .  C ADDR   0650H   R   SEG=MAIN   1140 1161 1191#
RNNMEMB. . . . . .  C ADDR   0EC0H   R   SEG=MAIN   2628# 2629
RNO3PARN . . . . .  C ADDR   0882H   R   SEG=MAIN   1521# 1535
RNOCHI0. . . . . .  C ADDR   0653H   R   SEG=MAIN   1179 1192#
RNOH37 . . . . . .  C ADDR   114FH   R   SEG=MAIN   2999# 3003 3010 3024
RNOMEMK. . . . . .  C ADDR   122CH   R   SEG=MAIN   3125# 3148
RNOR11 . . . . . .  C ADDR   0DB5H   R   SEG=MAIN   2473# 2475
RNORVICH . . . . .  C ADDR   0880H   R   SEG=MAIN   1465 1466 1520#
RNOT1IN. . . . . .  C ADDR   0952H   R   SEG=MAIN   1576 1670#
ROUT6. . . . . . .  C ADDR   0C1BH   R   SEG=MAIN   2225# 2260
ROUT7. . . . . . .  C ADDR   0FE8H   R   SEG=MAIN   2798# 2829 2834
ROUTF. . . . . . .  C ADDR   114CH   R   SEG=MAIN   2995# 3065
RR0. . . . . . . .  N NUMB   0000H   A      422# 2235 2784 2806 3697
RR1. . . . . . . .  N NUMB   0001H   A      423# 2236 2783 2807 3696
RR2. . . . . . . .  N NUMB   0002H   A      425# 1884 2237 2782 2808 3695
RR3. . . . . . . .  N NUMB   0003H   A      426# 1885 2238 2781 2809 3694
RR4. . . . . . . .  N NUMB   0004H   A      2239 2780 2810 3693 4395# 4452 4473 4489 4533 4555
RR5. . . . . . . .  N NUMB   0005H   A      2240 2779 2811 3692 4396# 4453 4460 4467 4534 4543
RR6. . . . . . . .  N NUMB   0006H   A      424# 2241 2778 2812 3691
RR7. . . . . . . .  N NUMB   0007H   A      427# 2242 2777 2813 3690
RRIR . . . . . . .  C ADDR   183FH   R   SEG=MAIN   3852 3854#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   0817H   R   SEG=MAIN   1449# 1467 1468
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 482 2901
RTIZMRI. . . . . .  C ADDR   0D79H   R   SEG=MAIN   2441#
RVVIZKO. . . . . .  C ADDR   113BH   R   SEG=MAIN   2987# 2992
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2252 2515 2533 2702 2745 2765 2825 3271 3617 3805 3813
SAVEIR2. . . . . .  C ADDR   0B11H   R   SEG=MAIN   807 843 922 1996#
SAVELTE. . . . . .  C ADDR   04A7H   A      6230#
SAVER2 . . . . . .  C ADDR   0B1DH   R   SEG=MAIN   537 539 541 732 742 744 768 786 795 1008 1020 1029 1074 1079 1128
                                           1156 1169 1175 1257 1261 1480 1748 1809 1821 1847 1859 2010# 2930 2937
                                           3647 3678 3861 3888
SBUF0. . . . . . .  D ADDR   0099H   A      40#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   112

SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   0AA7H   R   SEG=MAIN   1916# 1923
SDV1 . . . . . . .  C ADDR   0ABBH   R   SEG=MAIN   1928# 1934
SDVIG0 . . . . . .  C ADDR   029BH   R   SEG=MAIN   692# 694
SDVIG1 . . . . . .  C ADDR   0290H   R   SEG=MAIN   684# 686
SDVIG2 . . . . . .  C ADDR   0285H   R   SEG=MAIN   676# 678
SDVIG3 . . . . . .  C ADDR   0279H   R   SEG=MAIN   667# 669
SDVIG4 . . . . . .  C ADDR   02AAH   R   SEG=MAIN   702# 704
SDVIG6 . . . . . .  C ADDR   02B4H   R   SEG=MAIN   709# 711
SDVM . . . . . . .  C ADDR   02B2H   R   SEG=MAIN   699 708#
SEEGOON. . . . . .  C ADDR   0888H   R   SEG=MAIN   1510 1518 1525#
SEEIND . . . . . .  C ADDR   0896H   R   SEG=MAIN   1441 1448 1449 1538#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      5326# 5347 5348 5373 5374 5398 5541 5558 5779 5819
SKOR19 . . . . . .  C ADDR   1474H   R   SEG=MAIN   3443 3448#
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   11B9H   R   SEG=MAIN   3060# 3075
SP . . . . . . . .  D ADDR   0081H   A      17# 443
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 488
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 487
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 1905
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SPWRI. . . . . . .  C ADDR   1507H   R   SEG=MAIN   3526 3528#
SS1. . . . . . . .  C ADDR   192CH   R   SEG=MAIN   4035# 4037
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      386# 729 731 746 765 767 1213 1402 2316 2918
SUMT2. . . . . . .  C ADDR   0306H   R   SEG=MAIN   720 762#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   1A8EH   R   SEG=MAIN   4277# 4287
TABN . . . . . . .  C ADDR   1B26H   R   SEG=MAIN   4379# 4383
TABT11 . . . . . .  C ADDR   18EAH   R   SEG=MAIN   3974# 4359
TABT7. . . . . . .  C ADDR   18EEH   R   SEG=MAIN   3978# 4372
TABT9. . . . . . .  C ADDR   18ECH   R   SEG=MAIN   3976# 4369
TABUS. . . . . . .  C ADDR   18D6H   R   SEG=MAIN   3910 3963#
TAKTIND. . . . . .  C ADDR   08D1H   R   SEG=MAIN   1567 1570#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 479 480
TE22 . . . . . . .  C ADDR   1B19H   R   SEG=MAIN   4358 4368#
TE23 . . . . . . .  C ADDR   1B21H   R   SEG=MAIN   4368 4372#
TEAEQU0. . . . . .  C ADDR   168EH   R   SEG=MAIN   3037 3721#
TEAVK. . . . . . .  C ADDR   16CBH   R   SEG=MAIN   3728# 3770
TEBBL. . . . . . .  C ADDR   177FH   R   SEG=MAIN   3307 3751#
TEBEQU0. . . . . .  C ADDR   1698H   R   SEG=MAIN   3653 3722#
TEBL . . . . . . .  C ADDR   1775H   R   SEG=MAIN   3183 3750#
TEBLOK . . . . . .  C ADDR   176BH   R   SEG=MAIN   3246 3749#
TECLE. . . . . . .  C ADDR   173AH   R   SEG=MAIN   2654 3114 3165 3744#
TEEBL. . . . . . .  C ADDR   1789H   R   SEG=MAIN   3344 3752#
TEFULL . . . . . .  C ADDR   1761H   R   SEG=MAIN   3238 3748#
TEIZMK . . . . . .  C ADDR   171CH   R   SEG=MAIN   2469 2477 2981 3741#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   113

TEKALIB. . . . . .  C ADDR   16D5H   R   SEG=MAIN   3396 3729# 3773
TELIST . . . . . .  C ADDR   1756H   R   SEG=MAIN   2646 3156 3747#
TEMEM. . . . . . .  C ADDR   1744H   R   SEG=MAIN   3745#
TEMENU . . . . . .  C ADDR   16A2H   R   SEG=MAIN   3723#
TENMIN . . . . . .  C ADDR   1999H   R   SEG=MAIN   1087 1089 1101 4080#
TEOLI. . . . . . .  C ADDR   1793H   R   SEG=MAIN   1295 3754#
TEOLL. . . . . . .  C ADDR   1730H   R   SEG=MAIN   1388 3743#
TEOLR. . . . . . .  C ADDR   179DH   R   SEG=MAIN   1291 3755#
TEOUT. . . . . . .  C ADDR   1726H   R   SEG=MAIN   2483 2562 2972 3742#
TEPAR. . . . . . .  C ADDR   1712H   R   SEG=MAIN   3739# 3790
TES19_2. . . . . .  C ADDR   1708H   R   SEG=MAIN   2607 3448 3559 3737#
TES57_6. . . . . .  C ADDR   16FEH   R   SEG=MAIN   2603 3444 3555 3736# 3786
TESKOR . . . . . .  C ADDR   16C1H   R   SEG=MAIN   3727# 3767
TEST22 . . . . . .  C ADDR   14DFH   R   SEG=MAIN   3493 3500#
TEST23 . . . . . .  C ADDR   14E4H   R   SEG=MAIN   3500 3503#
TESTS. . . . . . .  C ADDR   14D3H   R   SEG=MAIN   3495# 3502 3505
TETE11 . . . . . .  C ADDR   16E0H   R   SEG=MAIN   3424 3731# 3777
TETE7. . . . . . .  C ADDR   16F4H   R   SEG=MAIN   3482 3733# 3783
TETE9. . . . . . .  C ADDR   16EAH   R   SEG=MAIN   3732# 3780
TETESI . . . . . .  C ADDR   16ACH   R   SEG=MAIN   2890 3725# 3760
TETESR . . . . . .  C ADDR   16B6H   R   SEG=MAIN   3726# 3764
TEVICH . . . . . .  C ADDR   1684H   R   SEG=MAIN   2330 2489 2977 3720#
TEWR . . . . . . .  C ADDR   174CH   R   SEG=MAIN   2637 3169 3746#
TEXTT. . . . . . .  C ADDR   1648H   R   SEG=MAIN   3711# 3990
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 462
TH1. . . . . . . .  D ADDR   008DH   A      29#
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   0ACBH   R   SEG=MAIN   1937#
TIM1 . . . . . . .  C ADDR   0ACDH   R   SEG=MAIN   1938# 1938
TIM2 . . . . . . .  C ADDR   0AD0H   R   SEG=MAIN   1919 1922 1929 1933 1941# 2184 2186 2195 2199
TIM3 . . . . . . .  C ADDR   0AD2H   R   SEG=MAIN   1942# 1942
TIZMRI . . . . . .  C ADDR   0CA8H   R   SEG=MAIN   2294# 2441
TL0. . . . . . . .  D ADDR   008AH   A      26# 463
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   11B6H   R   SEG=MAIN   3045 3057#
TMOD . . . . . . .  D ADDR   0089H   A      25# 460
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 477
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 476
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TOME13 . . . . . .  C ADDR   1458H   R   SEG=MAIN   3432 3436#
TOME14 . . . . . .  C ADDR   147FH   R   SEG=MAIN   3436 3454#
TOME15 . . . . . .  C ADDR   1490H   R   SEG=MAIN   3454 3463#
TOME21 . . . . . .  C ADDR   1452H   R   SEG=MAIN   3422 3432#
TOSK19 . . . . . .  C ADDR   1541H   R   SEG=MAIN   3554 3559#
TOUTF. . . . . . .  C ADDR   113DH   R   SEG=MAIN   2988# 2988 2991
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 1906
UNPACK1. . . . . .  C ADDR   009EH   A      5344# 5538 5672 5802 5916
UNPACK2. . . . . .  C ADDR   00BAH   A      5369# 5539 5673 5803
UP1. . . . . . . .  C ADDR   0138H   A      5489# 5506
UP2. . . . . . . .  C ADDR   014BH   A      5509# 5527
UP2A . . . . . . .  C ADDR   0161H   A      5488 5525#
UPA. . . . . . . .  C ADDR   19C8H   R   SEG=MAIN   4133# 4139
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   114

UPA1 . . . . . . .  C ADDR   19D8H   R   SEG=MAIN   4151# 4157
UPA2 . . . . . . .  C ADDR   19B8H   R   SEG=MAIN   4116# 4122
UPAA . . . . . . .  C ADDR   1A1AH   R   SEG=MAIN   4205# 4211
UPAB . . . . . . .  C ADDR   1A2AH   R   SEG=MAIN   4222# 4228
UPAK . . . . . . .  C ADDR   19C2H   R   SEG=MAIN   4130#
UPAK2. . . . . . .  C ADDR   19B2H   R   SEG=MAIN   3298 4113#
UPAK3. . . . . . .  C ADDR   19D2H   R   SEG=MAIN   3337 3363 4148#
UPAKA. . . . . . .  C ADDR   1A14H   R   SEG=MAIN   3639 4202#
UPAKB. . . . . . .  C ADDR   1A24H   R   SEG=MAIN   3667 4219#
VICHR. . . . . . .  D ADDR   00B1H   A      384# 2327 2336 2466 2573 2581 2893 2897 2966 3028 3385 3393 3402 3417
                                           3473 3630 3682 3758 4357
VIG0 . . . . . . .  C ADDR   0919H   R   SEG=MAIN   1630# 1632
VIG4 . . . . . . .  C ADDR   0927H   R   SEG=MAIN   1641# 1643
VIOUT. . . . . . .  C ADDR   0D53H   R   SEG=MAIN   2333 2416#
VV21_23. . . . . .  C ADDR   14CAH   R   SEG=MAIN   3479 3491#
VVCHIF . . . . . .  C ADDR   1816H   R   SEG=MAIN   2556 3820#
VVIZKO . . . . . .  C ADDR   1186H   R   SEG=MAIN   2987 3028#
VVODM11_15 . . . .  C ADDR   1435H   R   SEG=MAIN   3392 3417#
VVRR6. . . . . . .  C ADDR   0DADH   R   SEG=MAIN   2469#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 458 459
WORK . . . . . . .  D ADDR   00B8H   A      388# 1276 1278 1284 1300 1307 1323 1344 1349 1365 1581 1656
WR1. . . . . . . .  C ADDR   0BE3H   R   SEG=MAIN   2180# 2187
WRITE. . . . . . .  C ADDR   0BE0H   R   SEG=MAIN   608 2178# 4248 4250 4252 4254 4256 4258 4261 4263 4265 4268 4270
                                           4272
WRITED_X1. . . . .  C ADDR   0AD6H   R   SEG=MAIN   1947#
WRITE_X1 . . . . .  C ADDR   0AD5H   R   SEG=MAIN   1946#
WRPAGE . . . . . .  C ADDR   0480H   A      3537 6191#
WW5. . . . . . . .  C ADDR   0483H   A      6192# 6200
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 454 486
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 455
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 456 485
XCIKLWR. . . . . .  C ADDR   0AFDH   R   SEG=MAIN   802 814 816 818 821 824 827 830 833 836 866 868 870 873 876 879
                                           882 885 888 890 893 895 897 900 903 906 909 912 915 1979#
XTEMP. . . . . . .  N NUMB   000CH   A      4392# 4756 4757 4758 4759 4845 4847 4848 4850 4851 4853 4854 4856 4878
                                           4879 4880 4881 4899 4900 4904 4905 4908 4912 4913 4916 4920 4921 4925 4926
                                           4928 4929 4930 4932 4936 4937 4939 4940 4944 4945 4950 4951 4953 4954 4958
                                           4959 4964 4966 4967 4968
YBNUL. . . . . . .  C ADDR   10D8H   R   SEG=MAIN   2925 2933#
YES. . . . . . . .  C ADDR   1CC6H   R   SEG=MAIN   4778 4782 4786 4790 4808# 4871
YESAVP . . . . . .  C ADDR   0656H   R   SEG=MAIN   1163 1195#
YESBUF . . . . . .  C ADDR   0956H   R   SEG=MAIN   1668 1673#
YESPRD . . . . . .  C ADDR   0954H   R   SEG=MAIN   1667 1671#
YESTEST. . . . . .  C ADDR   18C5H   R   SEG=MAIN   3937#
YESTT5 . . . . . .  C ADDR   0977H   R   SEG=MAIN   1688 1695#
YESVICH. . . . . .  C ADDR   0683H   R   SEG=MAIN   1164 1219#
YESVIR . . . . . .  C ADDR   0E47H   R   SEG=MAIN   2567#
Z01S . . . . . . .  C ADDR   1944H   R   SEG=MAIN   4052# 4054
Z100 . . . . . . .  C ADDR   1915H   R   SEG=MAIN   4016# 4018
Z15. . . . . . . .  C ADDR   1923H   R   SEG=MAIN   4028# 4030
Z1S. . . . . . . .  C ADDR   1937H   R   SEG=MAIN   4044# 4046
ZAPADC . . . . . .  C ADDR   0AA5H   R   SEG=MAIN   1915#
ZCMP . . . . . . .  C ADDR   0B7FH   R   SEG=MAIN   2087#
ZDIV . . . . . . .  C ADDR   0B4CH   R   SEG=MAIN   740 1000 1426 2050#
ZER1 . . . . . . .  C ADDR   00B3H   A      5354 5358# 5413 5456
ZER2 . . . . . . .  C ADDR   00D4H   A      5380 5384#
ZMUL . . . . . . .  C ADDR   0B42H   R   SEG=MAIN   2045#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      316# 1500 2058 2061 2064
ZNPLUS . . . . . .  C ADDR   026CH   R   SEG=MAIN   619 656#
ZZ . . . . . . . .  C ADDR   1925H   R   SEG=MAIN   4029# 4029
Z_01S. . . . . . .  C ADDR   1940H   R   SEG=MAIN   651 652 653 1690 2245 2818 3817 4050#
Z_100. . . . . . .  C ADDR   1913H   R   SEG=MAIN   4015#
Z_15 . . . . . . .  C ADDR   1921H   R   SEG=MAIN   587 4027#
Z_1MS. . . . . . .  C ADDR   192AH   R   SEG=MAIN   4034#
Z_1S . . . . . . .  C ADDR   1933H   R   SEG=MAIN   554 562 4042#
Z_5. . . . . . . .  C ADDR   191CH   R   SEG=MAIN   1951 1961 4022#
A51 MACRO ASSEMBLER  AMP23                                                                01/17/2007 14:15:23 PAGE   115

Z_9. . . . . . . .  C ADDR   0BDBH   R   SEG=MAIN   1908 2172#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
