A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp30.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp30.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236              
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                        jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti   
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;53h..5dh 10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
  0039               310     nuerr                           DATA    39h;номер ошибки (для интерфейса)       
  0038               311     nblok                           DATA    38h;номер введенного блока
  0037               312     nelem                           DATA    37h;номер лемента в блоке 0..200
  0036               313     saus                            DATA    36h;сохр упр слово
  0034               314     sadiap                  DATA    34H;сохр диапазон на кот проходила запись блока
  0033               315     chind2                          DATA    33h;счетчик индикации
                     316     ;DATA           34H
                     317     ;;;;;
  0020               318      cellbit                DATA    20h
  0000               319     bitznak         BIT     cellbit.0       ;20.0           
  0001               320     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     6

  0002               321     znmat           BIT             cellbit.2       ;20.2
  0003               322     bitrs           BIT             cellbit.3       ;20.3
  0004               323     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               324     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               325     bitvi11         BIT             cellbit.6       ;20.6   бит нажатия ввод режима вычислить R
                             !!!
  0007               326     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us 
                                  
                     327     
  0021               328     cellbit1                DATA    21h
  0008               329     bitbuf          BIT     cellbit1.0      ;21.0   
  0009               330     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               331     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               332     bitmem          BIT             cellbit1.3      ;21.3 нажата кн память
                     333     ;bmem11         BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               334     bifl_kt         BIT             cellbit1.5      ;21.5  бит для выч Км теста измерения  
                     335     ;bmem13         BIT             cellbit1.6      ;21.6            
  000F               336     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     337     
  0022               338     cellbit2                DATA    22h
  0010               339     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               340     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               341     bitklb          BIT             cellbit2.2      ;22.2  признак калибровки
  0013               342     bitv19          BIT             cellbit2.3      ;22.3           бит установки скор итерфейс
                             а 19.6
  0014               343     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               344     biteizm         BIT             cellbit2.5      ;22.5   признак теста измерения 
  0016               345     bitpar          BIT             cellbit2.6      ;22.6   бит проведенного 1раз пароля 
  0017               346     bitoll          BIT             cellbit2.7      ;22.7 бит перегрузки
                     347     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     348     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     349     ;и выдает т.н. буфер индикации  
  0023               350     cellbit3                DATA    23h
  0018               351     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               352     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               353     bitakt          BIT             cellbit3.2      ;22.2  бит такта
  001B               354     bitznB          BIT             cellbit3.3      ;22.3 БИТ ЗНАКА ПРИ ВВОДЕ константы В
                     355     ;bit            BIT             cellbit3.4      ;22.4    
                     356     ;bit            BIT             cellbit3.5      ;22.5    
                     357     ;bit            BIT             cellbit3.6      ;22.6            
                     358     ;bit            BIT             cellbit3.7      ;22.7
                     359             
  005E               360     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     361     ;hex
  0062               362     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               363     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               364     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               365     rez_A2   data 7bh; A2
                     366     
  0098               367     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               368     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               369     chdel    data  83h              ; счетчик задержки
                     370     ;float
  0084               371     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               372     rezAp    data  88h              ;4byte  A+
  008C               373     rezAm    data  8ch              ;4byte  A-
  0090               374     koefKp   data  90h              ;4byte  K+
  0094               375     koefKm   data  94h              ;4byte  K-
                     376     ;hex 
  009A               377     parT     data  9ah              ;параметр времени измерения
  009B               378     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               379     rez_A3   data  9ch              ;A3
                     380     ;FLOAT
  00A0               381     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               382     rez_Ak  data  0a4h         ;Ak
  00A8               383     parol           data  0a8h         ;храним в памяти пароль
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     7

  00AC               384     chind   data  0ach         ;счетчик индикации
                     385     ;chbuf  data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               386     diap    data  0aeh         ;номер диапазона
  00AF               387     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               388     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               389     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               390     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               391     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               392     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               393     work    data  0b8h        ;рабочая ячейка
  00BC               394     konstA  data  0bch        ;     введенная с крана константа A
  00C0               395     konstB  data  0c0h         ;    введенная с крана константа B
                     396     ;       data  0c4h         ;
  00C5               397     Rez_del data  0c5h      ;сумма n-значений /n
  00C9               398     rez_R           data    0c9h            ;рез вычисления R 4baita
  00CD               399     interva data  0cdh;значение интервала (запись)2baita
  00CF               400     chbuf   data  0cfh         ;счетчик периода загрузки в буфер и интерфейс
  00D3               401     saven_bl        data  0d3h;номер ячейки в блоке 2 baita
  00D5               402     volume          data    0d5h;объем блока
  00D6               403     chblok          data    0d6h;volume;кол измерений блока
  00D7               404     copy_hl         data  0d7h;копия адреса последней записанной ячейки блока saven_bl
                     405     ;data           0d9h
                     406     
                     407     ;внешнее ОЗУ 64K 
                     408     ;в обл внешнего озу 0..ffh читается страница рпзу и при записи в любую
                     409     ;ячейку  стирается целая страница 0..ffh рпзу
                     410     ;               XSEG AT 100h
                     411             PUBLIC    MASS0
  0100               412     MASS0  xdata 0100h;     скользящий массив измерения
  0104               413     MASS1  xdata 0104h;
  0108               414     MASS2  xdata 0108h;
  010C               415     MASS3  xdata 010ch;
  0110               416     MASS4  xdata 0110h;
  0114               417     MASS5  xdata 0114h;
  0118               418     MASS6  xdata 0118h;
  011C               419     MASS7  xdata 011ch;
  0120               420     MASS8  xdata 0120h;
  0124               421     MASS9  xdata 0124h;
  0128               422     MASS10  xdata 0128h;
  012C               423     MASS11  xdata 012ch;
  0130               424     MASS12  xdata 0130h;
  0134               425     MASS13  xdata 0134h;
  0138               426     MASS14  xdata 0138h;
  013C               427     MASS15  xdata 013ch;
  0140               428     MASS16  xdata 0140h;
  0144               429     MASS17  xdata 0144h;
  0148               430     MASS18  xdata 0148h;
  014C               431     MASS19  xdata 014ch;
                     432     ;xdata 
                     433     
  0000               434                             rr0             EQU 00
  0001               435                     rr1       equ   01
  0006               436                     rr6   equ 06
  0002               437                     rr2       equ   02
  0003               438                     rr3       equ   03
  0007               439                     rr7   equ 07
                     440     
  0008               441                     r8   equ 08
  0009               442                     r9        equ   09
  000A               443                     r10       equ   10
  000B               444                     r11   equ 11
                     445     
                     446                     
                     447        
----                 448                  rseg     Main          ; Switch to this code segment.
                     449     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     8

                     450                  using    0              ; Specify register bank for the following
                     451     
0100                 452     org 100h
                     453     ;$EJECT
                     454     
0100 7581E0          455     begin:     mov  sp, #0e0h
0103 75E900          456                                             mov             PCA0L,#00;=0x00;
0106 75D900          457                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          458                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          459                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          460                                             mov     P2MDOUT,#00;=0x00;
                     461             
0112 75A73F          462             mov     P3MDOUT,#3fh;
0115 75B5FF          463             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          464             mov     REF0CN,#03h;=0x03;
                     465             
011B 75E114          466             mov     XBR0,#14h;= 0x14;
011E 75E200          467             mov     XBR1,#00; =0x00;
0121 75E300          468             mov XBR2,#00;=0x00;
0124 75B0C0          469             mov     P3,#0c0h
0127 75FFDE          470             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          471             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          472             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          473             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          474             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          475             mov     TL0,#0f9h;=0xf9; 
0139 75E680          476             mov     EIE1,#80h;=0x80;
                     477     
013C 75D480          478             mov     DAC0CN,#80h;=0x80;
013F 75D780          479             mov     DAC1CN,#80h;=0x80;
0142 75B167          480             mov     OSCXCN,#67h;=0x67;
                     481     
                     482      
                     483     
0145 E5B1            484     gener:     mov a, oscxcn
0147 B4E7FB          485                cjne a,#11100111b,gener
                     486                            
014A 75B288          487             mov     OSCICN,#88h;=0x84;
014D 75CA00          488         mov TMR2RLL,#0;=0;
0150 75CBD1          489         mov TMR2RLH,#0d1h;=0xd1;
                     490       
0153 D28E            491                     setb  TCON.6                    ;регистр управления
0155 D28C            492                      setb tcon.4
                     493     
0157 75EF00          494             mov     RSTSRC,#0;=00   ;//источники сброса 
                     495     
                     496             
015A 75E340          497          mov        XBR2,#40h
015D 75E106          498              mov    XBR0,#06h;16h
0160 75F803          499             mov             SPI0CN,#03
0163 759D31          500             mov             spi0ckr,#31H;;;;;;;;#04
                     501     ;установка скорости
0166 759850          502                                             mov             SCON0,#50h;01010000;скорость обмена
                              определяется таймером1
0169 758780          503                                             mov             PCON,#10000000b;удвоенная скорость 
                             передачи SMOD0=1
016C 758E10          504                                             mov             CKCON,#00010000b;TIM=1
016F 758920          505                                             mov             TMOD,#00100000b;реж2 внутр ист синх
                             р
0172 758840          506                                             mov             TCON,#01000000b;счетчик запущен
0175 7A50            507                                             mov                     r2,#50h                    
                                  ;57.6->19.2
0177 7B2C            508                                             mov                     r3,#2ch
0179 120454          509                                             call            re4byte                 ;502ch 1 ba
                             it skor
017C E508            510                                             mov                     a,r8
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE     9

017E B40007          511                                             cjne            a,#00,yst19
0181 C213            512                                             clr                     bitv19                  ;57
                             .6
0183 758DF4          513                                             mov                     TH1,#244
0186 8008            514                                             jmp               yst1
0188 900000   F      515     yst19:          mov                     dptr,#teS19_2
018B D213            516                                             setb            bitv19                  ;19,2
018D 758DDC          517                                             mov                     TH1,#220
0190                 518     yst1:
0190 75E730          519                                             mov             EIE2,#30H;00110000
                     520                                     ;       mov             EIP2,#30H
0193 75A880          521                                             mov     IE,#80h;//10000000      ;//Снятие блокировк
                             и всех прерываний
                     522     ;ozu
0196 E4              523                                             clr     a
0197 7800            524                                             mov     r0,#00h 
0199 F6              525     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
019A 08              526                                             inc     r0
019B B87FFB          527                                             cjne    r0,#7fh,mecle
019E 7880            528                                             mov     r0,#80h
01A0 F6              529     meff:                   mov     @r0,a 
01A1 F2              530                                             movx @r0,a
01A2 08              531                                             inc     r0
01A3 B8DFFA          532                             cjne    r0,#0dfh,meff
01A6 120000   F      533                             call    clmassix
                     534     ;обнулить внешнее озу 4кбайта
01A9 900000          535                                     mov                     dptr,#0
01AC E4              536     extcle: clr                     a
01AD F0              537                                     movx            @dptr,a
01AE A3              538                                     inc                     dptr
01AF E583            539                                     mov                     a,dph
01B1 B410F8          540                                     cjne            a,#10h,extcle
                     541     
01B4 7898            542                             mov             r0,#chinkor
01B6 7600            543                             mov             @r0,#0;1;
01B8 08              544                             inc             r0
01B9 7664            545                             mov             @r0,#64h;0c8h;90h;
                     546                             ;;;;
01BB 7881            547                             mov             r0,#chavt
01BD 7601            548                             mov             @r0,#1
01BF 08              549                             inc             r0
01C0 7690            550                             mov             @r0,#90h
                     551     
01C2 78B2            552                                     mov             r0,#marker
01C4 76FF            553                                     mov             @r0,#0ffh
                     554                             ;mov            r0,#chind
                     555                             ;mov            @r0,#1
                     556                     
01C6 74FF            557                             mov             a,#0ffh
01C8 F585            558                        mov          p5,a
01CA 799A            559                             mov             r1,#parT
01CC 7702            560                             mov             @r1,#2                  ;Tizm=1s
01CE 79AE            561                             mov             r1,#diap
01D0 7705            562                             mov             @r1,#5                  ;10-7a
01D2 753405          563                             mov             sadiap,#5
01D5 79AF            564                             mov             r1,#parN
01D7 7702            565                             mov             @r1,#2
01D9 7400            566                             mov             a,#00h
01DB F585            567                             mov             p5,a
01DD D204            568                             setb    bitizm
                     569     
01DF 799B            570                             mov             r1,#chbefore
01E1 7700            571                             mov             @r1,#0
                     572                             ;;;;;;
01E3 900000   F      573                             mov             dptr,#ch_1              ;1->r2..r5 float
01E6 120000   F      574                             call    ldc_long
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    10

01E9 7890            575                             mov             r0,#koefKp         ;1(float)->koefKp
01EB 120000   F      576                             call    saver2
01EE 7894            577                             mov             r0,#koefKm              ;1(float)->koefKm
01F0 120000   F      578                             call    saver2
01F3 78A0            579                             mov             r0,#koefKD
01F5 120000   F      580                             call    saver2
01F8 78CF            581                             mov                     r0,#chbuf
01FA 120000   F      582                             call    saver2  
01FD 753801          583                             mov             nblok,#1                        ;номер введенного б
                             лока
0200 753701          584                             mov             nelem,#1
0203 78CD            585                             mov             r0,#interva
0205 7600            586                             mov             @r0,#0
0207 08              587                             inc             r0
0208 7601            588                             mov             @r0,#1
020A 7840            589                             mov             r0,#bufind
020C                 590     age2:
020C 76FD            591                             mov             @r0,#0fdh         ;погасить индикатор
020E 08              592                             inc             r0
020F B84CFA          593                             cjne    r0,#bufind+12,age2              
0212 120000   F      594                             call    ind
0215 120000   F      595                             call    z_1s
                     596     
                     597                                     ;зажечь все лементы индикации
0218 7840            598                             mov             r0,#bufind
021A 7669            599     ageon:          mov             @r0,#69h;0feh;?
021C 08              600                             inc             r0
021D B84CFA          601                             cjne    r0,#bufind+12,ageon             
0220 120000   F      602                             call    ind
0223 120000   F      603                             call    z_1s            ;1sec
                     604     ;;;;;;;;;;;;;;;;
                     605                     
0226 120000   F      606                             call    z_15;z_1ms
0229 434B10          607                             orl             bufind+11,#10h;бит точки после 1 знакоместа
                     608     ;;;;;;;;;;;;;;;;;;;
022C 7C60            609                             mov             r4,#60h
022E 7D00            610                             mov             r5,#00         
0230 120000   F      611                             call    iniacp;инициализация acp
0233 120000   F      612                             call    loadUS          ;us 10-7 A
                     613                             
0236 C217            614     rebyte:         clr             bitoll
0238 3095FD          615                             jnb             p1.5,$
023B 2095FD          616                             jb              p1.5,$
                     617                             ;mov            a,P6            ;p6.4=0
                     618                             ;anl            a,#0efh
                     619                             ;mov            P6,a
                     620                             ;nop
                     621                             ;nop
                     622                                     
                     623                             ;mov            a,P6                    ;p6.4=1 
                     624                             ;orl            a,#10h
                     625                             ;mov            P6,a                        
023E 7411            626                             mov             a,#11h
0240 120000   F      627                             call    write
                     628                             ;чтение acp
0243 120000   F      629                             call    read    
0246 F578            630                             mov     reacp+1,A       ;старший байт 
0248 120000   F      631                             call    read    
024B F579            632                             mov     reacp+2,A       ;средний байт 
024D 120000   F      633                             call    read
0250 F57A            634                             mov     reacp+3,A               ;мл байт
                     635                        ;;;;;;;;;;;
0252 7878            636                        mov          r0,#reacp+1
0254 E6              637                        mov          a,@r0
0255 20E740          638                             jb              acc.7,znplus;
0258 D200            639                             setb    bitznak
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    11

025A 4480            640                             orl             a,#80h  ;ост содерж яч 
025C F6              641                             mov             @r0,a
                     642                                     
025D 18              643     mmm:            dec             r0;,#reacp
025E 76FF            644                             mov             @r0,#0ffh
0260 803E            645                             jmp             goznak
                     646     
0262 120000   F      647     mem10ms:        call            ind
0265 80CF            648                                             jmp                     rebyte                     
                                  ;10ms
                     649     
0267                 650     labelA:         ;mov            r10,#0          
                     651                             ;mov            r11,#0
                     652                             ;mov            r0,#chkl
                     653                             ;call   chcmp
                     654                             ;jnz            no0key
                     655                             ;разрешить ie6,ie7
0267 E53E            656                             mov                     a,chkl+1                ;low
0269 7009            657                             jnz                     no0key
026B E53D            658                             mov                     a,chkl
026D 7005            659                             jnz                     no0key
026F 75E730          660                             mov                     EIE2,#30h ;EIE2.5,EIE2.4
0272 800D            661                             jmp                     yes0key
                     662                        
0274                 663     no0key: ;       mov             r1,#chkl 
                     664                                     ;       call    chdec
0274 C3              665                                     clr                     c
0275 E53E            666                                     mov                     a,chkl+1;chkl-1
0277 9401            667                                     subb            a,#1
0279 F53E            668                                     mov                     chkl+1,a
027B E53D            669                                     mov                     a,chkl
027D 9400            670                                     subb            a,#0
027F F53D            671                                     mov                     chkl,a
                     672                             ;;;;;;;;;;;;
0281                 673     yes0key:
0281 2004B2          674                                             jb              bitizm,rebyte
                     675                              ;буфер 2 выдать на индикацию
0284 E533            676                             mov             a,chind2                        ;реже выдавать на и
                             ндикацию
0286 700B            677                             jnz             nochind
0288 753364          678                             mov             chind2,#100
028B 120000   F      679                             call    ind
028E 120000   F      680     yes0key1:       call    z_1ms;z_01s
                     681                             ;call   z_01s
                     682                             ;call   z_01s
0291 80D4            683                             jmp             labelA
                     684     
0293 14              685     nochind:        dec             a
0294 F533            686                                             mov             chind2,a
0296 80F6            687                                     jmp             yes0key1;labelA
                     688             
0298 C200            689     znplus:         clr     bitznak
029A 547F            690                             anl             a,#7fh;fdh                      ;+
029C F6              691                             mov             @r0,a
029D 18              692                             dec             r0;,#reacp
029E 7600            693                             mov             @r0,#00h
                     694                             
02A0                 695     goznak: 
                     696     ;;;;;;;;;;;;;
02A0 787A            697                             mov     r0,#reacp+3
02A2 E6              698                             mov             a,@r0
02A3 7F05            699                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
02A5 C3              700     sdvig3:         clr             c
02A6 13              701                             rrc             a
02A7 DFFC            702                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
02A9 FA              703                             mov             r2,a    ;сохр байт
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    12

02AA 18              704                             dec             r0              ;       reacp+2
02AB E6              705                             mov             a,@r0
02AC C0E0            706                             push    acc
02AE C3              707                             clr             c
02AF 7F03            708                             mov             r7,#3;2
02B1 C3              709     sdvig2:         clr             c
02B2 33              710                             rlc             a
02B3 DFFC            711                             djnz    r7,sdvig2 ;d12..d11      средний байт
02B5 4A              712                             orl             a,r2
02B6 F57A            713                             mov             reacp+3,a;сформ мл байт
02B8 D0E0            714                             pop             acc
                     715                             
02BA 7F05            716                             mov             r7,#5;6
02BC C3              717     sdvig1:         clr             c
02BD 13              718                             rrc             a
02BE DFFC            719                             djnz    r7,sdvig1 ;d15,d14        ср байт
02C0 FA              720                             mov             r2,a   ;сохр
02C1 E578            721                             mov             a,reacp+1
02C3 C0E0            722                             push    acc
                     723                     ;;      push    acc
02C5 7F03            724                             mov             r7,#3;2
02C7 C3              725     sdvig0:         clr             c
02C8 33              726                             rlc             a
02C9 DFFC            727                             djnz    r7,sdvig0 ;       d21..d16
02CB 4A              728                             orl             a,r2
02CC F579            729                             mov             reacp+2,a       ; сформ средний  байт
02CE D0E0            730                             pop             acc       ;reacp+1
                     731                             ;;;;;;;;;;;;;;
02D0 20E70B          732                             jb              acc.7,sdvm
02D3 C3              733                             clr             c
02D4 7F05            734                             mov             r7,#5;6
02D6 C3              735     sdvig4:         clr             c
02D7 13              736                             rrc             a
02D8 DFFC            737                             djnz    r7,sdvig4 ;       d23,d22
02DA F578            738                             mov             reacp+1,a
02DC 8008            739                             jmp             readyacp;ankor;klmas
                     740     ;;;;;;;;;;;;                                    
02DE 7F05            741     sdvm:           mov             r7,#5;6
02E0 D3              742     sdvig6:         setb            c
02E1 13              743                             rrc             a
02E2 DFFC            744                             djnz    r7,sdvig6 ;       d23,d22
02E4 F578            745                             mov             reacp+1,a
                     746                                                             
                     747     ; reacp..reacp+3-результат чтения асп(hex) 
                     748     ;;;;;;;;;
02E6                 749     readyacp:
02E6 7898            750                                             mov             r0,#chinkor
02E8 E6              751                             mov             a,@r0
02E9 30E702          752                             jnb             acc.7,gopart
02EC 8044            753                                     jmp             sumt2
                     754                     
02EE                 755     gopart:
02EE 789A            756                             mov             r0,#parT        ;параметр времени
02F0 793F            757                             mov             r1,#chmasN
02F2 B6013A          758                             cjne    @r0,#1,noparT1
                     759                             ;РЕЗ+РЕЗ
02F5 7877            760                             mov             r0,#reacp
02F7 120000   F      761                             call    resar2          ;reacp->r2..r5
02FA 78B6            762                             mov             r0,#summa+3;rez_A+3
02FC 120000   F      763                             call    ladd
02FF 78B3            764                             mov             r0,#summa;rez_A
0301 120000   F      765                             call    saver2
0304 793F            766                              mov            r1,#chmasN
0306 7714            767                             mov             @r1,#20;10
0308 789B            768                             mov             r0,#chbefore
030A B6631E          769                             cjne    @r0,#99,nobef99
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    13

                     770                             ;РЕЗ/100
030D 900000   F      771                             MOV        DPTR,#ch100 
0310 120000   F      772     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
0313 120000   F      773                             call    zdiv;divide
0316 7862            774                             mov             r0,#rez_A
0318 120000   F      775                             call    saver2          ;сумма 100 отсчетов /100
031B 78C5            776                             mov             r0,#Rez_del
031D 120000   F      777                             call    saver2  
                     778                        ;;;;;
0320 78B3            779                        mov          r0,#summa
0322 120000   F      780                        call         clear4
                     781     
0325 799B            782                             mov             r1,#chbefore
0327 7700            783                             mov             @r1,#0
0329 8070            784                             jmp             klmas           ;загр в массив скользящее ср
032B 06              785     nobef99:        inc             @r0                     ;chbefore
032C 020000   F      786                             jmp             rebyte;labelA;метка A
                     787     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     788     ;а потом уже располагаем  в скользящий массив  из n
                     789     
                     790     
                     791     
032F B6021D          792     noparT1:        cjne    @r0,#2,noparT2
                     793                             ;РЕЗ+РЕЗ
0332                 794     sumt2:
0332 7877            795                              mov            r0,#reacp
0334 120000   F      796                             call    resar2          ;reacp->r2..r5
0337 78B6            797                             mov             r0,#summa+3;rez_A+3
0339 120000   F      798                             call    ladd
033C 78B3            799                             mov             r0,#summa;rez_A
033E 120000   F      800                             call    saver2
0341 789B            801                             mov             r0,#chbefore
0343 793F            802                             mov             r1,#chmasN
0345 770A            803                             mov             @r1,#10
0347 B613E1          804                             cjne    @r0,#19,nobef99;9,nobef99
                     805                             ;РЕЗ/20
034A 900000   F      806                             MOV        DPTR,#ch20;ch10 
034D 80C1            807                             jmp             allsum
                     808                             ;;;;;;;
                     809                             
                     810     
034F B6031D          811     noparT2:        cjne    @r0,#3,noparT3
                     812     
0352 7877            813                                                              mov            r0,#reacp
0354 120000   F      814                             call    resar2          ;reacp->r2..r5
0357 78B6            815                             mov             r0,#summa+3;rez_A+3
0359 120000   F      816                             call    ladd
035C 78B3            817                             mov             r0,#summa;rez_A
035E 120000   F      818                             call    saver2
0361 789B            819                             mov             r0,#chbefore
0363 793F            820                             mov             r1,#chmasN
0365 7704            821                             mov             @r1,#4                                  ;n=4
0367 B609C1          822                             cjne    @r0,#9,nobef99;9,nobef99
                     823                             ;РЕЗ/10
036A 900000   F      824                             MOV        DPTR,#ch10 
036D 80A1            825                             jmp             allsum
                     826                             
036F B6041D          827     noparT3:        cjne    @r0,#4,noparT4
0372                 828     aapar:          
0372 7877            829              mov            r0,#reacp
0374 120000   F      830                             call    resar2          ;reacp->r2..r5
0377 78B6            831                             mov             r0,#summa+3;rez_A+3
0379 120000   F      832                             call    ladd
037C 78B3            833                             mov             r0,#summa;rez_A
037E 120000   F      834                             call    saver2
0381 789B            835                             mov             r0,#chbefore
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    14

0383 793F            836                             mov             r1,#chmasN
0385 7704            837                             mov             @r1,#4
0387 B604A1          838                             cjne    @r0,#4,nobef99;9,nobef99
                     839                             ;РЕЗ/10
038A 900000   F      840                             MOV        DPTR,#ch5
038D 8081            841                             jmp             allsum
                     842     
                     843                     
038F 7702            844     noparT4:   mov          @r1,#2          ;chmasN n=2
0391 7877            845                             mov             r0,#reacp
0393 120000   F      846                             call    resar2          ;reacp->r2..r5
0396 7862            847                             mov             r0,#rez_A
0398 120000   F      848                             call    saver2
                     849     ;загрузить А в массив из 2/10 значений
                     850     ;;;;;;;;;;;;;;;
039B                 851     klmas:           
039B 793F            852                             mov             r1,#chmasN
039D B7021A          853                             cjne    @r1,#2,mas10
03A0 900100          854                             MOV        dptr,#MASS0
03A3 120000   F      855                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     856     
03A6 7862            857                             mov             r0,#rez_A
03A8 120000   F      858                             call    resar2          ;->r2..r5
03AB 900100          859                             mov                     dptr,#MASS0
03AE 120000   F      860                   call              saveIr2                 ; R2-R5 --> MAS0
                     861                     
03B1 900107          862                   MOV          dptr,#MASS1+3
03B4 120000   F      863                   CALL       addx
03B7 020000   F      864                       jmp           endsum
                     865     ;массив из 10-ти измерений
03BA B70A7D          866     mas10:                  cjne    @r1,#10,mas20
03BD 900120          867                                             mov                     dptr,#MASS8
03C0 120000   F      868                     CALL            xCIKLWR         ;MASS8->MASS9
03C3 90011C          869                                             mov                     dptr,#MASS7
03C6 120000   F      870                     CALL            xCIKLWR         ;MASS7->MASS8
03C9 900118          871                     MOV       dptr,#MASS6
03CC 120000   F      872                     CALL       xCIKLWR         ; MASS6 --> MASS7
03CF 900114          873                     MOV        dptr,#MASS5
                     874                    
03D2 120000   F      875                    CALL        xCIKLWR        ; MASS5 --> MASS6
03D5 900110          876                    MOV         dptr,#MASS4
                     877                    
03D8 120000   F      878                    CALL        xCIKLWR        ; MASS4 --> MASS5
03DB 90010C          879                             mov                     dptr,#MASS3
                     880     
03DE 120000   F      881                    CALL             xCIKLWR         ;MASS3->MASS4
03E1 900108          882                     MOV        dptr,#MASS2
                     883                    
03E4 120000   F      884                    CALL        xCIKLWR         ; MASS2 --> MASS3
03E7 900104          885                    MOV         dptr,#MASS1
                     886                     
03EA 120000   F      887                   CALL         xCIKLWR        ; MASS1 --> MASS2
03ED 900100          888                    MOV         dptr,#MASS0
                     889                   
03F0 120000   F      890                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     891     
                     892                             
03F3 7862            893                             mov             r0,#rez_A
03F5 120000   F      894                             call    resar2          ;->r2..r5
                     895                                     ;call   aform
03F8 900100          896                                     mov                     dptr,#MASS0
03FB 120000   F      897                   call              saveIr2                 ; R2-R5 --> MAS0
                     898              
03FE 900107          899                   MOV          dptr,#MASS1+3
0401 120000   F      900                   CALL       addx
0404 90010B          901                   MOV          dptr,#MASS2+3
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    15

0407 120000   F      902                   CALL       addx
040A 90010F          903                   MOV          dptr,#MASS3+3
040D 120000   F      904                  CALL        addx
0410 900113          905                   MOV       dptr,#MASS4+3
0413 120000   F      906                   call       addx
0416 900117          907                     MOV        dptr,#MASS5+3
0419 120000   F      908                  CALL        addx
041C 90011B          909                   MOV          dptr,#MASS6+3
041F 120000   F      910                   CALL       addx
0422 90011F          911                   MOV          dptr,#MASS7+3
0425 120000   F      912                  CALL        addx
0428 900123          913                  MOV        dptr,#MASS8+3
042B 120000   F      914                   call       addx
042E 900127          915                     MOV                     dptr,#MASS9+3
0431 120000   F      916                  call        addx
0434 020000   F      917                              jmp            endsum
                     918     
0437 020000   F      919     rmas4:          jmp                     mas4
                     920     ;массив из 20-ти измерений
043A B714FA          921     mas20:          cjne    @r1,#20,rmas4
043D 900148          922                                             mov                     dptr,#MASS18
0440 120000   F      923                     CALL            xCIKLWR         ;MASS18->MASS19
0443 900144          924                                             mov                     dptr,#MASS17
0446 120000   F      925                     CALL            xCIKLWR         ;MASS17->MASS18
0449 900140          926                     MOV       dptr,#MASS16
044C 120000   F      927                     CALL       xCIKLWR         ; MASS16 --> MASS17
044F 90013C          928                     MOV        dptr,#MASS15
                     929                    
0452 120000   F      930                    CALL        xCIKLWR        ; MASS15 --> MASS16
0455 900138          931                    MOV         dptr,#MASS14
                     932                    
0458 120000   F      933                    CALL        xCIKLWR        ; MASS14 --> MASS15
045B 900134          934                             mov                     dptr,#MASS13
                     935     
045E 120000   F      936                    CALL             xCIKLWR         ;MASS13->MASS14
0461 900130          937                     MOV        dptr,#MASS12
                     938                    
0464 120000   F      939                    CALL        xCIKLWR         ; MASS12 --> MASS13
0467 90012C          940                    MOV         dptr,#MASS11
                     941                     
046A 120000   F      942                   CALL         xCIKLWR        ; MASS11 --> MASS12
046D 900128          943                    MOV         dptr,#MASS10
                     944                   
0470 120000   F      945                    CALL        xCIKLWR        ; MASS10 --> MASS11
0473 900124          946                                      MOV       dptr,#MASS9
0476 120000   F      947                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     948     
0479 900120          949                                             mov                     dptr,#MASS8
047C 120000   F      950                     CALL            xCIKLWR         ;MASS8->MASS9
047F 90011C          951                                             mov                     dptr,#MASS7
0482 120000   F      952                     CALL            xCIKLWR         ;MASS7->MASS8
0485 900118          953                     MOV       dptr,#MASS6
0488 120000   F      954                     CALL       xCIKLWR         ; MASS6 --> MASS7
048B 900114          955                     MOV        dptr,#MASS5
                     956                    
048E 120000   F      957                    CALL        xCIKLWR        ; MASS5 --> MASS6
0491 900110          958                    MOV         dptr,#MASS4
                     959                    
0494 120000   F      960                    CALL        xCIKLWR        ; MASS4 --> MASS5
0497 90010C          961                             mov                     dptr,#MASS3
                     962     
049A 120000   F      963                    CALL             xCIKLWR         ;MASS3->MASS4
049D 900108          964                     MOV        dptr,#MASS2
                     965                    
04A0 120000   F      966                    CALL        xCIKLWR         ; MASS2 --> MASS3
04A3 900104          967                    MOV         dptr,#MASS1
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    16

                     968                     
04A6 120000   F      969                   CALL         xCIKLWR        ; MASS1 --> MASS2
04A9 900100          970                    MOV         dptr,#MASS0
                     971                   
04AC 120000   F      972                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     973     
                     974                             
04AF 7862            975                             mov             r0,#rez_A
04B1 120000   F      976                             call    resar2          ;->r2..r5
                     977                                     ;call   aform
04B4 900100          978                                     mov                     dptr,#MASS0
04B7 120000   F      979                   call              saveIr2                 ; R2-R5 --> MAS0
                     980              
04BA 900107          981                   MOV          dptr,#MASS1+3
04BD 120000   F      982                   CALL       addx
04C0 90010B          983                   MOV          dptr,#MASS2+3
04C3 120000   F      984                   CALL       addx
04C6 90010F          985                   MOV          dptr,#MASS3+3
04C9 120000   F      986                  CALL        addx
04CC 900113          987                   MOV       dptr,#MASS4+3
04CF 120000   F      988                   call       addx
04D2 900117          989                     MOV        dptr,#MASS5+3
04D5 120000   F      990                  CALL        addx
04D8 90011B          991                   MOV          dptr,#MASS6+3
04DB 120000   F      992                   CALL       addx
04DE 90011F          993                   MOV          dptr,#MASS7+3
04E1 120000   F      994                  CALL        addx
04E4 900123          995                  MOV        dptr,#MASS8+3
04E7 120000   F      996                   call       addx
04EA 900127          997                     MOV                     dptr,#MASS9+3
04ED 120000   F      998                  call        addx
                     999     ;27
04F0 90012B         1000                                     MOV        dptr,#MASS10+3
04F3 120000   F     1001                   CALL       addx
04F6 90012F         1002                                     MOV        dptr,#MASS11+3
04F9 120000   F     1003                   CALL       addx
04FC 900133         1004                   MOV          dptr,#MASS12+3
04FF 120000   F     1005                   CALL       addx
0502 900137         1006                   MOV          dptr,#MASS13+3
0505 120000   F     1007                  CALL        addx
0508 90013B         1008                   MOV       dptr,#MASS14+3
050B 120000   F     1009                   call       addx
050E 90013F         1010                                     MOV        dptr,#MASS15+3
0511 120000   F     1011                     CALL     addx
0514 900143         1012                   MOV          dptr,#MASS16+3
0517 120000   F     1013                   CALL       addx
051A 900147         1014                   MOV          dptr,#MASS17+3
051D 120000   F     1015                  CALL        addx
0520 90014B         1016                  MOV        dptr,#MASS18+3
0523 120000   F     1017                   call       addx
0526 90014F         1018                                     MOV                     dptr,#MASS19+3
0529 120000   F     1019                  call        addx
052C 802F           1020                                     jmp             endsum
                    1021     ;массив из 4х измерений
052E                1022     mas4:                   
052E 900108         1023                                             MOV        dptr,#MASS2
0531 120000   F     1024                    CALL        xCIKLWR         ; MASS2 --> MASS3
0534 900104         1025                    MOV         dptr,#MASS1
0537 120000   F     1026                    CALL        xCIKLWR        ; MASS1 --> MASS2
053A 900100         1027                    MOV         dptr,#MASS0
053D 120000   F     1028                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1029     
                    1030                             
0540 7862           1031                             mov             r0,#rez_A
0542 120000   F     1032                             call    resar2          ;->r2..r5
                    1033                                     ;call   aform
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    17

0545 900100         1034                                     mov                     dptr,#MASS0
0548 120000   F     1035                   call              saveIr2                 ; R2-R5 --> MAS0
                    1036              
054B 900107         1037                   MOV          dptr,#MASS1+3
054E 120000   F     1038                   CALL       addx
0551 90010B         1039                   MOV          dptr,#MASS2+3
0554 120000   F     1040                   CALL       addx
0557 90010F         1041                   MOV          dptr,#MASS3+3
055A 120000   F     1042                  CALL        addx
                    1043                  
                    1044             ;23.03          
055D                1045     endsum:
055D 786E           1046                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
055F 06             1047                                     inc             @r0
0560 E6             1048                                     mov             a,@r0   
0561 200105         1049                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                    1050                                     
0564 B53F31         1051                                     cjne    a,chmasN,masx5
0567 D201           1052                                     setb    bitmas                  ;массив заполнен
0569 853F6E         1053     masfull:                mov             chmas,chmasN
056C 783F           1054                                     mov             r0,#chmasN
056E E6             1055                                     mov             a,@r0
                    1056     ;masfull:
056F B40208         1057                                     cjne    a,#2,nochn2
0572 900000   F     1058                                     MOV        DPTR,#ch2;10 
0575 120000   F     1059                                     CALL   ldc_ltemp                 ; ltemp <-- 2
0578 8028           1060                                     jmp             mas5div
                    1061     
057A B40A08         1062     nochn2:         cjne    a,#10,nochn10
057D 900000   F     1063                                                     MOV        DPTR,#ch10 
0580 120000   F     1064                                     CALL   ldc_ltemp                 ; ltemp <-- 10
0583 801D           1065                                     jmp             mas5div
                    1066     
0585 B41408         1067     nochn10:        cjne    a,#20,nochn20
0588 900000   F     1068                                                     MOV        DPTR,#ch20 
058B 120000   F     1069                                     CALL   ldc_ltemp                 ; ltemp <-- 20
058E 8012           1070                                     jmp             mas5div
                    1071     
0590 900000   F     1072     nochn20:        MOV        DPTR,#ch4 
0593 120000   F     1073                                     CALL   ldc_ltemp                 ; ltemp <-- 4
0596 800A           1074                                     jmp             mas5div
                    1075     
0598 856E0B         1076     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
059B E4             1077                                     clr     a
059C F50A           1078                                     mov     ltemp+2,a
059E F509           1079                                     mov     ltemp+1,a
05A0 F508           1080                                     mov     ltemp,a
                    1081     
05A2                1082     mas5div:
05A2 120000   F     1083                                     CALL       zdiv;divide                           ; R2-R5 =
                    1084                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                    1085     
                    1086                             
                    1087      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1088     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1089     ;получен результат 3 байта и знак
05A5 7866           1090                             mov             r0,#rez_A1
05A7 120000   F     1091                             call    saver2           ;сохр среднее по массиву
                    1092     ;;8.11.06                       mov             chmasN,#0
                    1093      ;;;;;;;;;;;;
                    1094      ;;;;;;;;;;;;
05AA C3             1095                             clr             c
05AB 799A           1096                             mov             r1,#parT
05AD 7402           1097                             mov             a,#2
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    18

05AF 97             1098                             subb    a,@r1
05B0 501D           1099                             jnc             ankor           ;T<3
                    1100                             ;A-=РЕЗ1                                ;T>3
05B2 120402         1101                             call    altof                   ;r2..r5->float
05B5 785E           1102                             mov             r0,#rez_Ame
05B7 120000   F     1103                             call    saver2
                    1104                             ;;;;
05BA 7890           1105                             mov             r0,#koefKp;->r8..r11
05BC EA             1106                             mov             a,r2
05BD 30E702         1107                             jnb             acc.7,nminus3
05C0 7894           1108                             mov             r0,#koefKm;->r8..r11
05C2 120000   F     1109     nminus3:                call    resar8
05C5 120203         1110                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
05C8 785E           1111                             mov             r0,#rez_Ame
05CA 120000   F     1112                             call    saver2
05CD 8021           1113                             jmp             gotoKD
                    1114     
05CF                1115     ankor:  
05CF 7898           1116                             mov             r0,#chinkor
05D1 E6             1117                             mov             a,@r0
05D2 30E703         1118                             jnb             acc.7,nokorr
                    1119                             ;коррекция 0
05D5 020000   F     1120                             jmp             kornul
05D8                1121     nokorr: 
                    1122                             ;mov            r10,#00         ;       chavt
                    1123                             ;mov            r11,#00h
05D8 7881           1124                             mov              r0,#chavt      
05DA E6             1125                             mov                     a,@r0;call      chcmp           ;сравн счет
                             чик авто калибровки с 0h
05DB 30E737         1126                             jnb             acc.7,nonulavt;jnz              nonulavt        
05DE 750A00         1127                             mov             r10,#0;1;00;02          
05E1 750BC8         1128                             mov             r11,#0c8h;90h;0c8h;58h
05E4 7898           1129                             mov             r0,#chinkor
05E6 120000   F     1130                             call    chcmp
05E9 7045           1131                             jnz             noavk
                    1132                             ;автокалибровка
05EB 020000   F     1133                             jmp             autoka;noavk;
                    1134     
05EE 8079           1135     rafterK:                jmp             afterK
                    1136     ;;;;;;;;;;
05F0 C3             1137      gotoKD:                clr             c
05F1 799A           1138                             mov             r1,#parT
05F3 7404           1139                             mov             a,#4
05F5 97             1140                             subb    a,@r1
05F6 50F6           1141                             jnc             rafterK         ;T<5
                    1142                             ;A1-=A- *KD                     ;T>5
                    1143                             ;call           findkoef                                ;r2,r3-hex
                    1144                             ;       call            rebyte2                         ;r2..r5- he
                             x
                    1145                                     
                    1146                             ;       call    altof                   ;r2..r5->float
                    1147                             ;       mov     dptr,#CHtho;100000
                    1148                             ;       call    ldc_ltemp                       ;r8..r11
                    1149                             ;       call    fldiv
                    1150                             ;       call    move28
                    1151                             
05F8 785E           1152                             mov             r0,#rez_Ame;->r2..r5   ???????????/
05FA 120000   F     1153                             call    resar2
                    1154                                     ;call   flmul
05FD 120343         1155                             call    ftol                    ;float->int
0600 7866           1156                             mov             r0,#rez_A1
0602 120000   F     1157                             call    saver2
0605 786A           1158                             mov             r0,#rez_A0;->r8..r11 hex
0607 120000   F     1159                             call    resar8
060A 120000   F     1160                             call    lsub            ;A3=A-1-A0
060D 789C           1161                             mov             r0,#rez_A3
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    19

060F 120000   F     1162                             call    saver2
0612 020000   F     1163                             jmp             labelB  
                    1164      ;;;;;;;;;;; 9.11.06
0615 789A           1165     nonulavt:        mov            r0,#parT
0617 E6             1166                             mov             a,@r0
0618 6401           1167                             xrl             a,#01
061A 700F           1168                             jnz             avtdec1
061C 7982           1169                             mov             r1,#chavt+1     ;T=1 chavt-10
061E 120000   F     1170                             call    tenmin
0621 7999           1171     kordec10:       mov             r1,#chinkor+1
0623 120000   F     1172                             call    tenmin
0626 801E           1173                             jmp             rezmul
                    1174     
0628 020000   F     1175     rmo220:         jmp             mo220
                    1176     
062B 7981           1177     avtdec1:        mov             r1,#chavt       
062D 120000   F     1178                             call    chdec           ;chavt-1
                    1179     ;                       jmp             kordec1;rezmul
0630 789A           1180     noavk:          mov             r0,#parT
0632 E6             1181                             mov             a,@r0
0633 6401           1182                             xrl             a,#01
0635 700A           1183                             jnz             kordec1
                    1184                             ;T=1 chinkor-10
0637 7999           1185                     mov             r1,#chinkor+1
0639 120000   F     1186                             call    tenmin
063C 8008           1187                             jmp             rezmul
                    1188     
063E 020000   F     1189     rnotestizm:             jmp                     notestizm
0641 7998           1190     kordec1:        mov             r1,#chinkor
0643 120000   F     1191                             call    chdec           ; chinkor-1
                    1192                        ;9.11.06
                    1193                             ;;;;;;;;;;;;;;
                    1194                             ;;;;;;;;;;;;;
                    1195     ;(РЕЗ1-АN)*K
0646                1196     rezmul:
0646 7866           1197                             mov             r0,#rez_A1;->r2..r5
0648 120000   F     1198                             call    resar2
064B 120402         1199                             call    altof   ;r2..r5->float  6.06    
064E 7884           1200                             mov             r0,#kor0_AN;->r8..r11
0650 120000   F     1201                             call    resar8
0653 1201D1         1202                             call    flsub
0656 7890           1203                             mov             r0,#koefKp;->r8..r11
0658 EA             1204                             mov             a,r2
0659 30E702         1205                             jnb             acc.7,nminus
                    1206                             ;jnb            bitznak,nminus
                    1207                     
065C 7894           1208                             mov             r0,#koefKm;->r8..r11
065E 120000   F     1209     nminus:         call    resar8
0661 120203         1210                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
0664 785E           1211                             mov             r0,#rez_Ame
0666 120000   F     1212                             call    saver2
                    1213      
0669                1214     afterK:                 
                    1215     ;;;;;;;;;;;;;;
0669 EA             1216                                     mov             a,r2
066A 547F           1217                                     anl             a,#7fh
066C FA             1218                                     mov             r2,a
066D 900000   F     1219                                     mov     dptr,#ch_250;220;220000
0670 120000   F     1220                                     call    ldc_ltemp                       ;r8..r11=8
0673 1201D6         1221                                     call    flcmp
0676 50B0           1222                                     jnc             rmo220          ;A>220000
                    1223                                     ;;;;;;;;;
0678 3015C3         1224                                     jnb                     biteizm,rnotestizm
067B 78B1           1225                                     mov                     r0,#vichR
067D B62155         1226                                     cjne            @r0,#21h,note21
0680 7A50           1227                                     mov                     r2,#50h                 ;-11a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    20

0682 7B18           1228                                     mov                     r3,#18h                 ;k8
0684 12046C         1229                                     call            rebyte2                         ;r2..r5- he
                             x
0687 120402         1230                                     call            altof                   ;r2..r5->float
068A C002           1231                                     push            rr2
068C C003           1232                                     push            rr3
068E C004           1233                                     push            rr4
0690 C005           1234                                     push            rr5
0692 7A50           1235                                     mov                     r2,#50h                 ;k10
0694 7B20           1236                                     mov                     r3,#20h
0696 12046C         1237     re11_7: call            rebyte2                 ;r2..r5
0699 120402         1238                                     call            altof                   ;r2..r5->float
069C 120000   F     1239                                     call            move28
069F D005           1240                                     pop                     rr5
06A1 D004           1241                                     pop                     rr4
06A3 D003           1242                                     pop                     rr3
06A5 D002           1243                                     pop                     rr2
06A7 1202B7         1244                                     call            fldiv
                    1245                             ;       mov                     dptr,#ch_10
                    1246                             ;       call            ldc_ltemp                       ;r8..r11
                    1247                             ;       call            flmul
                    1248                                     ;;;;;2.02.07
06AA C002           1249                                     push            rr2
06AC C003           1250                                     push            rr3
06AE C004           1251                                     push            rr4
06B0 C005           1252                                     push            rr5
06B2 7A50           1253                                     mov                     r2,#50h                 ;-11a
06B4 7B2C           1254                                     mov                     r3,#2ch                 ;Km
06B6 12046C         1255                                     call            rebyte2                         ;r2..r5- he
                             x
06B9 120402         1256                                     call            altof                   ;r2..r5->float
06BC 120000   F     1257                                     call            move28
06BF D005           1258                                     pop                     rr5
06C1 D004           1259                                     pop                     rr4
06C3 D003           1260                                     pop                     rr3
06C5 D002           1261                                     pop                     rr2
06C7 120203         1262                                     call            flmul                           ;*Km
06CA 900000   F     1263                                     mov     dptr,#CHtho;100000
06CD 120000   F     1264                                     call    ldc_ltemp                       ;r8..r11=8
06D0 1202B7         1265                                     call    fldiv
                    1266                                     ;;;;;
06D3 8050           1267                                     jmp                     temul   
06D5 B62218         1268     note21: cjne            @r0,#22h,note22
06D8 7A50           1269                                     mov                     r2,#50h                 ;-09a
06DA 7B10           1270                                     mov                     r3,#10h                 ;k6
06DC 12046C         1271                                     call            rebyte2                         ;r2..r5- he
                             x
06DF 120402         1272                                     call            altof                   ;r2..r5->float
06E2 C002           1273                                     push            rr2
06E4 C003           1274                                     push            rr3
06E6 C004           1275                                     push            rr4
06E8 C005           1276                                     push            rr5
06EA 7A50           1277                                     mov                     r2,#50h                 ;k8
06EC 7B18           1278                                     mov                     r3,#18h
06EE 80A6           1279                                     jmp                     re11_7
06F0 7A50           1280     note22: mov                     r2,#50h                 ;-7a
06F2 7B08           1281                                     mov                     r3,#08h                 ;k4
06F4 12046C         1282                                     call            rebyte2                         ;r2..r5- he
                             x
06F7 120402         1283                                     call            altof                   ;r2..r5->float
06FA C002           1284                                     push            rr2
06FC C003           1285                                     push            rr3
06FE C004           1286                                     push            rr4
0700 C005           1287                                     push            rr5
0702 7A50           1288                                     mov                     r2,#50h                 ;k6
0704 7B10           1289                                     mov                     r3,#10h
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    21

0706 808E           1290                                     jmp                     re11_7  
                    1291                                     ;;;;;;;;;
0708                1292     notestizm:
0708 301208         1293                                     jnb             bitklb,komulpz
070B 900000   F     1294                                     mov     dptr,#chk;100000
070E 120000   F     1295                                     call    ldc_long                        ;r2..r5
0711 8006           1296                                     jmp             komul
0713 120000   F     1297     komulpz:call            findkoef                                ;r2,r3-hex
0716 12046C         1298                                     call            rebyte2                         ;r2..r5- he
                             x
                    1299                                     
0719 120402         1300     komul:  call    altof                   ;r2..r5->float
071C 900000   F     1301                                     mov     dptr,#CHtho;100000
071F 120000   F     1302                             call    ldc_ltemp                       ;r8..r11=8
0722 1202B7         1303                                     call    fldiv
0725 120000   F     1304     temul:                          call    move28
0728 785E           1305                                     mov             r0,#rez_Ame
072A 120000   F     1306                                     call    resar2
                    1307                     
072D 120203         1308                                     call    flmul     ;A1-=A-*KD  fl
                    1309                                     
0730 120343         1310                                     call    ftol                    ;float->int
0733 7866           1311                                     mov             r0,#rez_A1
0735 120000   F     1312                                     call    saver2
0738 120402         1313                                     call    altof                   ;r2..r5->float
073B 900000   F     1314                                     mov     dptr,#ch_220;200;200000
073E 120000   F     1315                                     call    ldc_ltemp                       ;r8..r11=8
0741 1201D6         1316                                     call    flcmp
0744 502D           1317                                     jnc             rrmo220         ;A>200000
                    1318                             ;       jnb             knizm,noavp;goA2;               bitizm,goA2
                                  
                    1319                             ;       jb              bitavp,yesavp
0746 301808         1320                                     jnb             knizm,goA2
0749 300602         1321                                     jnb             bitvi11,qu_avp
074C 8003           1322                                     jmp             goA2
074E 20052F         1323     qu_avp:                 jb              bitavp,yesavp
0751                1324     noavp:  ;               jb              bitvi11,yesvich  ;уст после ввода A B (ввод ВЫЧИСЛИ
                             ТЬ)
0751                1325     goA2:                    ;A2=A1-
0751 7866           1326                                      mov            r0,#rez_A1
0753 120000   F     1327                                     call    resar2
0756 787B           1328                                     mov             r0,#rez_A2
0758 120000   F     1329                                     call    saver2
075B                1330     goA3A2:                  ;A3=A2-A0
075B 786A           1331                                       mov           r0,#rez_A0
075D 120000   F     1332                                     call    resar8
0760 120000   F     1333                                     call    lsub
0763 789C           1334                                     mov             r0,#rez_A3
0765 120000   F     1335                                     call    saver2
                    1336                                     ;;;;;;
0768 200644         1337                                     jb              bitvi11,yesvich
076B                1338     goonin:            ;jmp         goonind;indA3;8.11.06
076B 78AC           1339                                     mov             r0,#chind
076D B60006         1340                                     cjne    @r0,#0,rnochi0
0770 020000   F     1341                                     jmp             goonind;indA3
                    1342     
0773 020000   F     1343     rrmo220:                jmp             mo220
0776 020000   F     1344     rnochi0:                jmp             nochi0
0779 7866           1345     gokaA2:                 mov             r0,#rez_A1                      ;(float)
077B 120000   F     1346                                                     call    saver2                          ;то
                              необх для калибровки ,goA2 работает с тим знач
077E 80D1           1347                                             jmp             goA2
                    1348     ;;;;;;;;;;;;;;;;
0780 EA             1349     yesavp:                 mov             a,r2
0781 547F           1350                                     anl             a,#7fh
0783 FA             1351                                     mov             r2,a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    22

0784 900000   F     1352                                     mov     dptr,#ch_10th;10000
0787 120000   F     1353                                     call    ldc_ltemp                       ;r8..r11=8
078A 1201D6         1354                                     call    flcmp
078D 50C2           1355                                     jnc             noavp           ;A>10000        
078F 78AE           1356                                     mov             r0,#diap                ;10-11
0791 B60902         1357                                     cjne    @r0,#9,avpgo
0794 80BB           1358                                     jmp             noavp
0796                1359     avpgo:                  
0796 06             1360                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
0797 B60A01         1361                                     cjne    @r0,#0ah,clmasv
079A 16             1362                                     dec             @r0
079B                1363     clmasv:         ;сбросить массив
079B 120000   F     1364                             call    loadUS
                    1365                             ;call   louizm
079E 120000   F     1366                             call     clmassix
07A1 78B3           1367                                     mov             r0,#summa
07A3 120000   F     1368                                     call    clear4
07A6 786A           1369                                     mov             r0,#rez_A0
07A8 120000   F     1370                                     call    clear4
07AB D207           1371                                     setb            bitzus;bitbuf;;;;;;;;;;;;                  
                                                                                   
07AD 80BC           1372                                jmp     goonin
                    1373     
07AF                1374     yesvich:        
                    1375                     ;                       mov             r0,#konstB
                    1376                     ;               call    resar2
                    1377                     ;               call    move28
07AF 789C           1378                                     mov             r0,#rez_A3;A1
07B1 120000   F     1379                                     call    resar2                          ;HEX
                    1380                                     
07B4 120402         1381                                     call            altof                   ;r2..r5->float
07B7 EA             1382                                     mov             a,r2                    ;модуль
07B8 547F           1383                                     anl             a,#7fh
07BA FA             1384                                     mov             r2,a
                    1385                     ;               call            fladd                           ;A1+B
                    1386                                     
07BB 900000   F     1387                                     mov     dptr,#CH_500;
07BE 120000   F     1388                                     call    ldc_ltemp                       ;r8..r11
07C1 1201D6         1389                                     call    flcmp
07C4 4073           1390                                     jc                      mo500R;error <500 >22000
07C6 900000   F     1391                                     mov     dptr,#CH_22T;
07C9 120000   F     1392                                     call    ldc_ltemp                       ;r8..r11
07CC 1201D6         1393                                     call    flcmp
07CF 5074           1394                                     jnc             mo500I          ;error
                    1395                                     ;;;;;;;;;;;;
07D1 120000   F     1396                                     call            move28
07D4 C008           1397                                     push            r8
07D6 C009           1398                                     push            r9
07D8 C00A           1399                                     push            r10
07DA C00B           1400                                     push            r11
07DC 78BC           1401                                     mov             r0,#konstA
07DE 120000   F     1402                                     call    resar2
07E1 900000   F     1403                                     mov             dptr,#CH_B
07E4 120000   F     1404                                     CALL   ldc_ltemp                 ; ltemp <-- 10-7
07E7 120203         1405                                     call            flmul                           ;A*10-7
07EA D00B           1406                                     pop                     r11
07EC D00A           1407                                     pop                     r10
07EE D009           1408                                     pop                     r9
07F0 D008           1409                                     pop                     r8
07F2 1202B7         1410                                     call            fldiv                   ;результат R
07F5 78C9           1411                                     mov                     r0,#rez_R
07F7 120000   F     1412                                     call            saver2
07FA 120343         1413                                     call            ftol                    ;float->hex
                    1414                                     ;;;;;;;;;;
07FD 784F           1415                                             mov             r0,#abin
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    23

07FF 120000   F     1416                                             call    saver2
                    1417     ;;;;;;;;
0802 7840           1418                                                     mov             r0,#bufind
0804                1419     age9:
0804 7620           1420                             mov             @r0,#" "          ;погасить индикатор
0806 08             1421                             inc             r0
0807 B84BFA         1422                             cjne    r0,#bufind+11,age9
                    1423                                             
080A 78C9           1424                                             mov             r0,#rez_R
080C 120000   F     1425                                             call            resar2
                    1426     ;;;;;;;;;;
080F 900000   F     1427                                     mov             dptr,#CH_fl
0812 120000   F     1428                                     CALL   ldc_ltemp
0815 1202B7         1429                                     call            fldiv
                    1430     
0818 78B8           1431                                     mov             r0,#work                ;степень +
081A 7600           1432                                     mov             @r0,#0
081C 78B9           1433                                     mov             r0,#work+1;степень -
081E 7600           1434                                     mov             @r0,#0
0820 900000   F     1435     compa1: mov     dptr,#ch_1;
0823 120000   F     1436                                     call    ldc_ltemp                       ;r8..r11
0826 1201D6         1437                                     call    flcmp
0829 4026           1438                                     jc              equ0            ;<1
082B 78B8           1439                                     mov             r0,#work                        ;степень +
082D 06             1440                                     inc             @r0
082E 900000   F     1441                                     mov             dptr,#ch_10;
0831 120000   F     1442                                     call    ldc_ltemp                       ;r8..r11
0834 1202B7         1443                                     call            fldiv
0837 80E7           1444                                     jmp             compa1                          ;work значе
                             ние степени n(hex)  
                    1445                                     ;;;;;;;;;;;;;;;;;;;
0839 900000   F     1446     mo500R: mov             dptr,#teOLR
083C 120000   F     1447                               call          lotext           
083F 120000   F     1448                                     call            ind
0842 020000   F     1449                                     jmp                     nobavp;nobitizm
0845 900000   F     1450     mo500I: mov             dptr,#teOLI
0848 120000   F     1451                               call          lotext           
084B 120000   F     1452                                     call            ind
084E 020000   F     1453                                     jmp                     nobavp;nobitizm
0851                1454     equ0:           ;;;;;   call            ftol                    ;float->int
0851 78B8           1455                                     mov             r0,#work                ;степень +
0853 B60019         1456                                     cjne    @r0,#0,equ00
                    1457                                     
0856 900000   F     1458     compa2: mov     dptr,#ch_1;
0859 120000   F     1459                                     call    ldc_ltemp                       ;r8..r11
085C 1201D6         1460                                     call    flcmp
085F 500E           1461                                     jnc             equ00           ;>1
0861 78B9           1462                                     mov             r0,#work+1                      ;степень -
0863 16             1463                                     dec             @r0                                        
                                          ;0,ff(-1),fe(-2)...
0864 900000   F     1464                                     mov             dptr,#ch_10;
0867 120000   F     1465                                     call    ldc_ltemp                       ;r8..r11
086A 120203         1466                                     call            flmul
086D 80E7           1467                                     jmp             compa2                          ;work значе
                             ние степени n(hex)  
                    1468     
                    1469     
086F                1470     equ00:          
086F 7853           1471                                                     mov             r0,#adec
0871 7952           1472                                             mov             r1,#abin+3      ;hex->10
0873 120000   F     1473                                             call    bindec
                    1474     
                    1475                                                     ;если степень полож убирать младший байт
                    1476                                                     ;чтобы уложиться в 5 разрядов, если отриц р
                             асполагать
                    1477                                                     ;число в bufind..bufind+5
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    24

0876 78B8           1478                                             mov             r0,#work
0878 B60021         1479                                             cjne    @r0,#0,outr
087B 08             1480                                             inc             r0                      ;work+1
087C B6FF05         1481                                             cjne            @r0,#0ffh,bufr3         ;6разрядов 
                             нужно вывести 5
087F 06             1482                                             inc                     @r0;!!!!!!!!!?
0880 785B           1483                                             mov                     r0,#adec+8;разместить в буф
                             ер индикации R
0882 8003           1484                                             jmp                     bufr30
                    1485                                             ;;;;;;;;;;;;;;
0884 06             1486     bufr3:          inc             @r0                     ;?!!!!!!!!n+1
0885 785C           1487                                                     mov             r0,#adec+9
0887 7945           1488     bufr30:         mov             r1,#bufind+5;6
0889 7F05           1489                                             mov             r7,#5;7
088B E6             1490     bufr2:                          mov             a,@r0
088C 2430           1491                                             add             a,#30h
088E F7             1492                                             mov             @r1,a
088F 19             1493                                             dec             r1
0890 18             1494                                             dec             r0
0891 DFF8           1495                                             djnz    r7,bufr2
                    1496     
0893 784F           1497                                             mov             r0,#abin
0895 120000   F     1498                                             call            clear4
0898 78B9           1499                                             mov             r0,#work+1
089A 801C           1500                                     jmp             outr5
                    1501     ;work!=0 значит после дел на 10**9 получили число > с чем 6 разрядов                       
                                          
089C 785C           1502     outr:                   mov             r0,#adec+9;разместить в буфер индикации R
089E C3             1503                                             clr             c
089F 79B8           1504                                             mov             r1,#work
08A1 E8             1505                                             mov             a,r0
08A2 14             1506                                             dec             a                                  
                                  ;n-1
08A3 97             1507                                             subb    a,@r1
08A4 F8             1508                                             mov             r0,a                    ;adec+9-n !
                             !!!!!!!!!!!!!!
08A5 7945           1509                                     mov             r1,#bufind+5;т к число разрядов > чем знако
                             мест
08A7 7F05           1510                                             mov             r7,#5;7
08A9 E6             1511     bufr:                           mov             a,@r0
08AA 2430           1512                                             add             a,#30h
08AC F7             1513                                             mov             @r1,a
08AD 19             1514                                             dec             r1
08AE 18             1515                                             dec             r0
08AF DFF8           1516                                             djnz    r7,bufr
                    1517     
08B1 784F           1518                                             mov             r0,#abin
08B3 120000   F     1519                                             call            clear4
08B6 78B8           1520                                     mov             r0,#work
08B8 E6             1521     outr5:                  mov             a,@r0
08B9 F552           1522                                             mov             abin+3,a
                    1523                                                                     ;n(hex)->abin
08BB 120000   F     1524                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
08BE 2552           1525                                             add             a,abin+3
08C0 F552           1526                                             mov             abin+3,a
08C2 7853           1527                                             mov             r0,#adec
08C4 7952           1528                                             mov             r1,#abin+3      ;hex->10
08C6 120000   F     1529                                             call    bindec
08C9 855C48         1530                                             mov             bufind+8,adec+9
08CC 855B47         1531                                             mov             bufind+7,adec+8
08CF 754966         1532                                             mov             bufind+9,#66h
08D2 020000   F     1533                                             jmp             nobavp;nobitizm;        goonin;call
                                  ind
                    1534                                             
                    1535                                     ;;;;;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    25

                    1536     ;;;;;;;;;;;;;
                    1537     
08D5 300508         1538     mo220:             jnb          bitavp,indoll
08D8 301805         1539                                jnb          knizm,indoll;bitizm,indoll
08DB 78AE           1540                                     mov             r0,#diap
08DD B6000B         1541                                     cjne    @r0,#0,nodi2
                    1542                                ;10-2
08E0 900000   F     1543     indoll:                 mov             dptr,#teOLL;OLL
08E3 120000   F     1544                                     call    lotext
08E6 D217           1545                                     setb    bitoll
08E8 020000   F     1546                                     jmp             goonin  
                    1547     
08EB 16             1548     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1549     
08EC B6FF01         1550                                     cjne    @r0,#0ffh,nodi9
08EF 06             1551                                     inc             @r0
                    1552     
08F0 120000   F     1553     nodi9:          call    loadUS
                    1554                                     ;call   louizm
                    1555                                     ;сбросить массив
08F3 120000   F     1556                                     call     clmassix
08F6 78B3           1557                                     mov             r0,#summa
08F8 120000   F     1558                                     call    clear4
08FB 786A           1559                                     mov             r0,#rez_A0
08FD 120000   F     1560                                     call    clear4  
0900 D207           1561                                     setb    bitzus;bitbuf   ;флаг задержки  после установки us 
                                                                           
0902 020000   F     1562                                jmp     goonin
                    1563     
0905 16             1564     nochi0:                 dec             @r0                     ;СТИ-1
0906 020000   F     1565                                     jmp             labelB  
                    1566     
                    1567             
                    1568     ;;;;;;;;;;;;;;;
                    1569     
0909                1570     nop3_0: ;;      ;rez_A-rez_A0
                    1571                     ;;                      mov             r0,#rez_A0
                    1572                     ;;                      call    resar8
                    1573                     ;;                      call    lsub
                    1574                     ;;                      mov             r0,#rez_A
                    1575                     ;;;                     call    saver2
                    1576      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0909 789C           1577      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
090B 120000   F     1578                                             call    resar2
090E 900000   F     1579                                             mov             dptr,#ch100              
0911 120000   F     1580                                             call    ldc_ltemp        
0914 120000   F     1581                                             call    zdiv            ;rez_A3/100=r2..r5
                    1582                                     
0917 EC             1583                                             mov             a,r4
0918 20E71E         1584                                             jb              acc.7,aless0
091B 4408           1585                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
091D F5D3           1586                                             mov             DAC0H,a
                    1587                                                                             ;мл байт
091F ED             1588                                             mov             a,r5
0920 F5D2           1589                                             mov             DAC0L,a
0922 801E           1590                                             jmp             moveA3;
                    1591     
0924 B70207         1592     no3parN:                        cjne    @r1,#2,no2parN
                    1593                                             ;в байт 0  записать пробел
0927 7946           1594                                             mov             r1,#bufind+6
0929 7720           1595                                             mov             @r1,#" ";0fdh;
092B 020000   F     1596                                             jmp             seeind;moveA3
                    1597     
092E                1598     no2parN:                        ;в байты 0 и 1 записать пробел
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    26

092E 7945           1599                                             mov             r1,#bufind+5
0930 7720           1600                                             mov             @r1,#" ";0fdh;" "
0932 09             1601                                             inc             r1
0933 7720           1602                                             mov             @r1,#" ";0fdh;" "
0935 8079           1603                                             jmp             seeind;moveA3
0937 8077           1604      rseeind:               jmp             seeind
0939 F4             1605     aless0:                         cpl             a
093A 54F7           1606                                             anl             a,#0f7h         ;d11=0
093C F5D3           1607                                             mov             DAC0H,a
                    1608                                                                             ;мл байт
093E ED             1609                                             mov             a,r5
093F F4             1610                                             cpl             a
0940 F5D2           1611                                             mov             DAC0L,a
0942                1612     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1613                                     
                    1614                                             
0942                1615     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1616                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1617                     ;до конца цикла измерения результат не размещать в буфере
                    1618                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1619                     ;и возврату в режим измерения
0942 201456         1620                                             jb              bitvich,rnorvich
0945 201053         1621                                             jb              bitt2,rnorvich
0948 2017EC         1622                                             jb              bitoll,rseeind
                    1623                                             
094B 2011E9         1624                                             jb              bitmenu,rseeind
094E 200BE6         1625                                             jb              bitmem,rseeind
                    1626     ;;;;;;;;;;;;;;
                    1627                                             ; mov           r0,#rez_A3
                    1628                                             ;call   resar2
                    1629                                             ;call   ftol                    ;float->int r2..r5
                    1630     ;;;;;;;;
0951 789C           1631                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
0953 120000   F     1632                                             call    resar2;????????????????17.01.07
                    1633                                     
0956 120000   F     1634                                             call    maform
0959 784F           1635                                             mov             r0,#abin
095B 120000   F     1636                                             call    saver2
                    1637     ;;;;;;;;
                    1638                                             
095E 7853           1639                                             mov             r0,#adec
0960 7952           1640                                             mov             r1,#abin+3      ;hex->10
0962 120000   F     1641                                             call    bindec
                    1642                                     
0965 785C           1643                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
0967 7946           1644                                             mov             r1,#bufind+6
0969 7F07           1645                                             mov             r7,#7
096B E6             1646     bufdec:                         mov             a,@r0
096C 2430           1647                                             add             a,#30h
096E F7             1648                                             mov             @r1,a
096F 19             1649                                             dec             r1
0970 18             1650                                             dec             r0
0971 DFF8           1651                                             djnz    r7,bufdec
0973 7847           1652                                             mov             r0,#bufind+7
0975 762D           1653                                             mov             @r0,#2dh          ;-2..-9
0977 7840           1654                                             mov             r0,#bufind
0979 762B           1655                                             mov             @r0,#2bh
097B 300202         1656                                             jnb             znmat,nozzmi;bitznak,nozzmi
097E 762D           1657                                             mov             @r0,#2dh
0980 79AE           1658     nozzmi:                         mov             r1,#diap
0982 7848           1659                                             mov             r0,#bufind+8
0984 E7             1660                                             mov             a,@r1
0985 B40808         1661                                             cjne    a,#8,nodi8
0988 7630           1662                                             mov             @r0,#30h                 ;10-10
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    27

098A 18             1663                                             dec             r0
098B 7663           1664                                             mov             @r0,#63h;31h
098D 08             1665                                             inc             r0
098E 8012           1666                                             jmp             seegoon
0990 B4090C         1667     nodi8:                          cjne    a,#9,nodis9
                    1668                                     
0993 7631           1669                                             mov             @r0,#31h           ;10-11
0995 18             1670                                             dec             r0
0996 7663           1671                                             mov             @r0,#63h;31h
                    1672                                     
0998 08             1673                                             inc             r0
0999 8007           1674                                             jmp             seegoon
                    1675     
099B 8079           1676     rnorvich:               jmp             norvich
099D 8085           1677     rno3parN:               jmp             no3parN
                    1678     
099F 2432           1679     nodis9:                         add             a,#32h
09A1 F6             1680                                             mov             @r0,a;#37h;"T";
09A2 08             1681     seegoon:                        inc             r0
09A3 7641           1682                                             mov             @r0,#"A";"E";
09A5 08             1683                                             inc             r0
09A6 7600           1684                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
09A8 08             1685                                             inc             r0;             mov             buf
                             ind+11
09A9 7610           1686                                             mov             @r0,#010h               ;bufind+11.
                             4 точка после первой цифры
                    1687                                             
                    1688     ;;;;;;;;;;;;;;;
                    1689     ;;;;;;goonind:
09AB 79AF           1690                                             mov             r1,#parN        ; ??????
09AD B703ED         1691                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1692             
09B0                1693     seeind:                         ;;;;;;;;;;;;;
09B0 784A           1694                                             mov             r0,#bufind+10
09B2 E6             1695                                             mov             a,@r0
09B3 300F03         1696                                             jnb             bitnul,nnnul
09B6 4408           1697                                             orl             a,#08h
09B8 F6             1698                                             mov             @r0,a
09B9 799A           1699      nnnul:         mov             r1,#parT
09BB B70204         1700                                             cjne    @r1,#2,nsec1
09BE 4420           1701                                             orl             a,#20h    ;1s
09C0 8009           1702                                             jmp             nsec10
09C2 B70104         1703     nsec1:          cjne    @r1,#1,nsec11
09C5 4440           1704                                             orl             a,#40h                  ;10s
09C7 8002           1705                                             jmp             nsec10
                    1706                                     
09C9 4410           1707     nsec11:         orl             a,#10h
                    1708                                                      ;0,1s
                    1709     ;;;;;;;;;;;;;;;;
09CB                1710     nsec10:         
                    1711     
                    1712     
09CB 784A           1713                                             mov             r0,#bufind+10   
09CD F6             1714                                             mov             @r0,a
09CE 300504         1715                                             jnb             bitavp,nobavp
09D1 4404           1716                                             orl             a,#04           ;bufind+10.2
09D3 F6             1717                                             mov             @r0,a
09D4 F6             1718                                             mov             @r0,a   
09D5 784A           1719     nobavp:         mov             r0,#bufind+10   
09D7 F6             1720                                             mov             @r0,a   
09D8 301803         1721                                        jnb          knizm,nobitizm
09DB 4402           1722                                             orl             a,#02
09DD F6             1723                                              mov            @r0,a
09DE                1724     nobitizm:                       
09DE 301A07         1725                                             jnb             bitakt,notakt
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    28

09E1 C21A           1726                                             clr             bitakt
09E3 534AFE         1727                                             anl             bufind+10,#0feh
09E6 8005           1728                                             jmp             taktind
09E8 D21A           1729     notakt:                         setb    bitakt
09EA 434A01         1730                                             orl             bufind+10,#01                      
                                          
09ED                1731     taktind:                
                    1732     ;;;;;;;;;
09ED 301517         1733                                             jnb             biteizm,yesind
09F0 79B1           1734                                             mov             r1,#vichR
09F2 7848           1735                                             mov             r0,#bufind+8
09F4 7654           1736                                             mov             @r0,#'T'
09F6 08             1737                                             inc             r0
09F7 B72104         1738                                             cjne    @r1,#21h,test9i
09FA 7631           1739                                             mov             @r0,#31h;11A
                    1740                                     ;       dec             r0
                    1741                                     ;       mov             @r0,#63h
09FC 8009           1742                                             jmp             yesind
09FE B72204         1743     test9i:         cjne    @r1,#22h,test7i
0A01 7632           1744                                             mov             @r0,#32h;39h;09A
0A03 8002           1745                                             jmp             yesind
0A05 7633           1746     test7i:         mov             @r0,#33h;37h;07A
                    1747     ;;;;;;;;;
0A07                1748     yesind:         
0A07 301203         1749                                             jnb             bitklb,noklb
0A0A 434A80         1750                                             orl             bufind+10,#80h; on kmp
0A0D 300A03         1751     noklb:          jnb             bitbon,nobuf
0A10 434B02         1752                                             orl             bufind+11,#02h; on pysk
0A13 120000   F     1753     nobuf:          call    ind        ;пп выдачи на индикатор
0A16                1754     norvich: 
0A16 789A           1755                                     mov             r0,# parT
0A18 79AC           1756                                             mov             r1,#chind
0A1A B60152         1757                                             cjne    @r0,#1,rnot1in
0A1D                1758     labelB:                    ;;;;;;;;;;;
                    1759                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
0A1D 789F           1760                                                     mov     r0,#rez_A3+3
                    1761                             ;;;;;;;;
0A1F 79BB           1762                             mov             r1,#work+3
0A21 E6             1763                             mov             a,@r0
0A22 7F07           1764                             mov             r7,#7;кол сдв вправо
0A24 C3             1765     dvig3:          clr             c
0A25 13             1766                             rrc             a
0A26 DFFC           1767                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
0A28 FA             1768                             mov             r2,a    ;сохр байт
0A29 18             1769                             dec             r0              ;rez_A3+2
0A2A E6             1770                             mov             a,@r0
0A2B C0E0           1771                             push    acc
0A2D C3             1772                             clr             c
0A2E 7F01           1773                             mov             r7,#1
0A30 C3             1774     dvig2:          clr             c
0A31 33             1775                             rlc             a
0A32 DFFC           1776                             djnz    r7,dvig2 ;d12..d11       средний байт
0A34 4A             1777                             orl             a,r2
0A35 F7             1778                             mov             @r1,a;сформ мл байт
0A36 19             1779                             dec             r1
0A37 D0E0           1780                             pop             acc
                    1781                             
0A39 7F07           1782                             mov             r7,#7
0A3B C3             1783     dvig1:          clr             c
0A3C 13             1784                             rrc             a
0A3D DFFC           1785                             djnz    r7,dvig1 ;d18     ср байт
0A3F FA             1786                             mov             r2,a   ;сохр
0A40 18             1787                             dec             r0
0A41 E6             1788                             mov             a,@r0 ;rez_A3+1
0A42 C0E0           1789                             push    acc
                    1790                     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    29

0A44 7F01           1791                             mov             r7,#1
0A46 C3             1792     dvig0:          clr             c
0A47 33             1793                             rlc             a
0A48 DFFC           1794                             djnz    r7,dvig0 ;        d21..d16
0A4A 4A             1795                             orl             a,r2
0A4B F7             1796                             mov             @r1,a   ; сформ средний  байт
0A4C 19             1797                             dec             r1
0A4D D0E0           1798                             pop             acc       ;rez_A3+1
                    1799                             ;;;;;;;;;;;;;;
                    1800     ;                       jb              acc.7,dvm
0A4F C3             1801                             clr             c
0A50 7F07           1802                             mov             r7,#7
0A52 C3             1803     dvig4:          clr             c
0A53 13             1804                             rrc             a
0A54 DFFC           1805                             djnz    r7,dvig4 ;        d22
0A56 FA             1806                             mov             r2,a   ;сохр
0A57 18             1807                             dec             r0;     rez_A3
0A58 E6             1808                             mov             a,@r0
                    1809                             ;;;;;
0A59 7F01           1810                             mov             r7,#1
0A5B C3             1811     vig0:           clr             c
0A5C 33             1812                             rlc             a
0A5D DFFC           1813                             djnz    r7,vig0 ;         d24..d30
0A5F 4A             1814                             orl             a,r2
0A60 F7             1815                             mov             @r1,a   ; сформ   байт
0A61 19             1816                             dec             r1
0A62 E6             1817                             mov             a,@r0
                    1818                             ;;;;;
0A63 20E70C         1819                             jb              acc.7,dvm
0A66 C3             1820                             clr             c
0A67 7F07           1821                             mov             r7,#7
0A69 C3             1822     vig4:           clr             c
0A6A 13             1823                             rrc             a
0A6B DFFC           1824                             djnz    r7,vig4 ;         d
0A6D 8009           1825                             jmp             endsdv
                    1826     
0A6F 020000   F     1827     rnot1in:                jmp             not1in
                    1828     
                    1829     ;;;;;;;;;;;;                                    
0A72 7F07           1830     dvm:            mov             r7,#7
0A74 D3             1831     dvig6:          setb            c
0A75 13             1832                             rrc             a
0A76 DFFC           1833                             djnz    r7,dvig6 ;        d31
0A78 F7             1834     endsdv:         mov             @r1,a
                    1835                                                             
                    1836      ;->work   
                    1837                             
0A79 900000   F     1838                             mov             dptr,#chzap
0A7C 120000   F     1839                             call     ldc_long
0A7F 78BB           1840                              mov            r0,#work+3
0A81 120000   F     1841                             call    ladd
0A84 ED             1842                             mov             a,r5
0A85 F5D5           1843                             mov             DAC1L,a
                    1844                             
0A87 EC             1845                             mov             a,r4
0A88 F5D6           1846                             mov             DAC1H,a
                    1847     
                    1848                                             ;;;;;;;;;;
0A8A 78CF           1849                                             mov                     r0,#chbuf       
0A8C 120000   F     1850                                             call            resar2  
0A8F 900000   F     1851                                             mov                     dptr,#ch_1       
0A92 120000   F     1852                                             call            ldc_ltemp
0A95 1201D1         1853                                             call            flsub
0A98 78CF           1854                                             mov                     r0,#chbuf       
0A9A 120000   F     1855                                             call            saver2  
0A9D 900000   F     1856                                             mov                     dptr,#ch_1
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    30

0AA0 120000   F     1857                                             call            ldc_ltemp
0AA3 1201D6         1858                                             call            flcmp
                    1859                                             
                    1860                                             
                    1861                                             
0AA6 5009           1862                                             jnc                     rnobuf0
0AA8 200909         1863                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
0AAB 200A08         1864                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0AAE 020000   F     1865                                             jmp             gocikle
0AB1 020000   F     1866     rnobuf0:        jmp             nobuf0
0AB4                1867     yesprd: ;передать   A3 в буфер
0AB4 801C           1868                                             jmp             goonT
0AB6                1869     yesbuf:         ;записать   A3 в буфер
0AB6 120000   F     1870                                             call            resa_hl;dptr-
0AB9 120000   F     1871                                             call            loA3_X  ;адрес след ячейки внешн оз
                             у храним
                    1872                                                                             ;в ячейке saven_bl
0ABC 120000   F     1873                                             call            save_hl
0ABF 78AE           1874                                             mov                     r0,#diap
0AC1 E6             1875                                             mov                     a,@r0
0AC2 F534           1876                                             mov                     sadiap,a
                    1877                                             ;строб
0AC4 E586           1878                                                     mov             a,P6            ;p6.4=0
0AC6 54EF           1879                             anl             a,#0efh
0AC8 F586           1880                             mov             P6,a
0ACA 00             1881                             nop
0ACB 00             1882                             nop
                    1883                                     
0ACC E586           1884                             mov             a,P6                    ;p6.4=1 
0ACE 4410           1885                             orl             a,#10h
0AD0 F586           1886                             mov             P6,a                        
0AD2 78CD           1887     goonT:                          mov             r0,#interva;high  byte loadr2
0AD4 E6             1888                                             mov             a,@r0
0AD5 FC             1889                                             mov             r4,a
0AD6 08             1890                                             inc             r0
0AD7 E6             1891                                             mov             a,@r0
0AD8 FD             1892                                             mov             r5,a
0AD9 E4             1893                                             clr             a
0ADA FB             1894                                             mov             r3,a
0ADB FA             1895                                             mov             r2,a                            ;r2
                             ..r5-interval(hex)
0ADC 120402         1896                                             call            altof                   ;r2..r5->in
                             terval (float)
                    1897     
0ADF 789A           1898                                                                             mov             r0,
                             #parT
0AE1 B60110         1899                                                                     cjne    @r0,#1,nott1
                    1900                                     
0AE4 900000   F     1901                                     mov                     dptr,#ch_2       
0AE7 120000   F     1902                                     call            ldc_ltemp
0AEA 120203         1903     intmul: call            flmul
0AED 78CF           1904     intmul1:mov                     r0,#chbuf
0AEF 120000   F     1905                                     call            saver2          ;*2
0AF2 8040           1906                                     jmp             gocikle
                    1907     
0AF4 B60208         1908     nott1:                  cjne    @r0,#2,nott2
0AF7 900000   F     1909                                                     mov                     dptr,#ch_10      
0AFA 120000   F     1910                                     call            ldc_ltemp
0AFD 80EB           1911                                     jmp                     intmul                             
                                  ;*10
                    1912     
0AFF B60308         1913     nott2:                  cjne    @r0,#3,nott3
0B02 900000   F     1914                                                     mov                     dptr,#ch_2       
0B05 120000   F     1915                                     call            ldc_ltemp
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    31

0B08 80E0           1916                                     jmp                     intmul                             
                                  ;*2
                    1917     
                    1918     
0B0A B60411         1919     nott3:          cjne    @r0,#4,nott4
0B0D 900000   F     1920                                             mov                     dptr,#ch_10      
0B10 120000   F     1921                                             call            ldc_ltemp       ;/10*4
0B13 1202B7         1922                                             call            fldiv
0B16 900000   F     1923                                             mov                     dptr,#ch_4       
0B19 120000   F     1924                                             call            ldc_ltemp
0B1C 80CC           1925                                             jmp             intmul
                    1926     
0B1E B6050B         1927     nott4:          cjne    @r0,#5,nott5
0B21 900000   F     1928                                                     mov                     dptr,#ch_5       
0B24 120000   F     1929                                             call            ldc_ltemp
0B27 1202B7         1930                                             call            fldiv           ;/5
0B2A 80C1           1931                                             jmp             intmul1;T=5
0B2C 900000   F     1932     nott5:                  mov                     dptr,#ch_1       
0B2F 120000   F     1933                                     call            ldc_ltemp
0B32 80B6           1934                                     jmp                     intmul                             
                                  ;*1
                    1935     
                    1936     
0B34 300708         1937     gocikle:        jnb             bitzus,nofz                     
0B37 120000   F     1938                             call    z_05s    ;0,5c
0B3A 120000   F     1939                             call    z_05s    ;0,5c
0B3D C207           1940                             clr     bitzus;bitbuf бит задержки засылки us
0B3F 020000   F     1941     nofz:           jmp     labelA;rebyte
                    1942     
                    1943     
0B42 80F0           1944     yestt5:         jmp             gocikle
                    1945     
0B44 78CF           1946     nobuf0:                         mov             r0,#chbuf
0B46 120000   F     1947                                                             call            resar2
0B49 900000   F     1948                                                                     mov                     dpt
                             r,#ch_1       
0B4C 120000   F     1949                                     call            ldc_ltemp
0B4F 1201D1         1950                                     call            flsub
0B52 80E0           1951                                             jmp             gocikle
                    1952     
                    1953     
0B54 B60205         1954     not1in:                         cjne    @r0,#2,not2in
0B57 7701           1955                                             mov             @r1,#1           ;T=2
0B59 020000   F     1956                                             jmp     labelB
                    1957     
0B5C B60305         1958     not2in:                         cjne    @r0,#3,not3in
0B5F 7701           1959                                             mov             @r1,#1;9                ;T=3
0B61 020000   F     1960                                             jmp     labelB
0B64 7703           1961     not3in:                         mov             @r1,#3;19
0B66 020000   F     1962                                             jmp     labelB
                    1963     
                    1964     
                    1965     ;;;;;;;;;;;3.11.06
                    1966     
                    1967     ;;коррекция 0
0B69 7883           1968     KORnul:         mov             r0,#chdel
0B6B B60010         1969                             cjne    @r0,#0,nonuldel
                    1970                                     
0B6E E584           1971                             mov             a,p4                    ;сохр  us
0B70 F536           1972                             mov             saus,a
0B72 E585           1973                             mov             a,p5
0B74 F537           1974                             mov             saus+1,a
                    1975     
0B76 900000   F     1976                             mov             dptr,#kor0us
0B79 120000   F     1977                             call    lospus          ;упр слово коррекции 0
0B7C 8018           1978                             jmp             chdelmo
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    32

                    1979     
0B7E                1980     nonuldel:       ;cjne   @r0,#7,no4del
0B7E B6031B         1981                                                     cjne    @r0,#3,no4del
                    1982                             ;рез ->AN
0B81 7862           1983                             mov             r0,#rez_A;->r2..r5
0B83 120000   F     1984                             call    resar2
                    1985             
                    1986                                     ;;;;;;;;;;
0B86 120402         1987                             call    altof           ;r2..r5->float
0B89 7884           1988                             mov             r0,#kor0_AN;->kor0_AN
0B8B 120000   F     1989                             call    saver2
                    1990                                     
0B8E E536           1991                             mov             a,saus                  ;восстан исходное упр слово
0B90 F584           1992                             mov             p4,a
0B92 E537           1993                             mov             a,saus+1
0B94 F585           1994                             mov             p5,a            
0B96 7883           1995     chdelmo:        mov             r0,#chdel
0B98 06             1996                             inc             @r0             ;chdel+1
0B99 020000   F     1997                             jmp              rebyte
                    1998     
0B9C                1999     no4del:         ;cjne   @r0,#14,chdelmo
0B9C B606F7         2000                                             cjne    @r0,#6,chdelmo
0B9F 7600           2001                             mov             @r0,#0          ;chdel
0BA1 7898           2002                             mov             r0,#chinkor
0BA3 7600           2003                             mov             @r0,#00;1;00;02;600;
0BA5 08             2004                             inc             r0
0BA6 76C8           2005                             mov             @r0,#0c8h;90h;0c8h;58h;258h
0BA8 120000   F     2006                             call    clmassix;сбросить массив скольз среднего
0BAB 020000   F     2007                             jmp              rebyte
                    2008     
                    2009     ;автокалибровка
0BAE                2010     autoka:  ;;  mov                r0,#chavt
                    2011                      ;;  call               chcmp
                    2012                      ;;  jz         nulavt
                    2013                     ;;   mov                r1,#chavt
                    2014                     ;;   call               chdec;chavt-1
                    2015                      ;; jmp         rebyte
0BAE                2016     nulavt:  ;;;;;
0BAE 7883           2017                             mov             r0,#chdel
0BB0 B60016         2018                             cjne    @r0,#0,nndelch
0BB3 E584           2019                             mov             a,p4                    ;сохр  us
0BB5 F536           2020                             mov             saus,a
0BB7 E585           2021                             mov             a,p5
0BB9 F537           2022                             mov             saus+1,a
                    2023     
0BBB E585           2024                             mov   a,p5
0BBD 4404           2025                             orl             a,#04              ;p5.2=1
0BBF 00             2026                             nop
0BC0 00             2027                             nop
0BC1 543F           2028                             anl             a,#3fh          ;p5.6,p5.7=0
0BC3 F585           2029                             mov   p5,a
0BC5 06             2030                             inc             @r0
0BC6 020000   F     2031                             jmp              rebyte
                    2032     
0BC9 B6033D         2033     nndelch:        cjne    @r0,#3,n4delch
                    2034                             ;pez->A+
                    2035                             ;K+=000/(A+-AN)
                    2036                             ;mov            r0,#rez_A;->r2..r5
                    2037                             ;call   resar2
0BCC E577           2038                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0BCE FA             2039                                     mov             r2,a
0BCF E578           2040                                     mov             a,reacp+1
0BD1 FB             2041                                     mov             r3,a
0BD2 E579           2042                                     mov             a,reacp+2
0BD4 FC             2043                                     mov             r4,a
0BD5 E57A           2044                                     mov             a,reacp+3
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    33

0BD7 FD             2045                                     mov             r5,a
                    2046                                     ;;;;;;;;;;;;;;;
0BD8 120402         2047                             call    altof                   ;r2..r5->float
0BDB 7888           2048                             mov             r0,#rezAp;->rezAp
0BDD 120000   F     2049                             call    saver2                          
0BE0 7884           2050                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0BE2 120000   F     2051                             call    resar8                          
0BE5 1201D1         2052                             call    flsub           ; r2..r5(A+-AN)
0BE8 120000   F     2053                             call    move28     ;r2..r5->r8..r11
0BEB 900000   F     2054                             mov             dptr,#CH2tho;000->r2..r5 float
0BEE 120000   F     2055                             call    ldc_long                
0BF1 1202B7         2056                             call    fldiv
0BF4 EA             2057                             mov             a,r2
0BF5 547F           2058                             anl             a,#7fh
0BF7 FA             2059                             mov             r2,a
0BF8 7890           2060                             mov             r0,#koefKp;->koefKp
0BFA 120000   F     2061                             call    saver2
                    2062                       
                    2063                     ;       anl             P5,#0feh                ;p5.0=0 
0BFD E585           2064                     mov             a,P5
0BFF 543B           2065                             anl             a,#3bh;acp-
0C01 F585           2066                             mov             P5,a
0C03 7883           2067                             mov             r0,#chdel
0C05 06             2068                             inc             @r0                       ;ch+1
0C06 020000   F     2069                             jmp             rebyte
                    2070     
0C09 B6063F         2071     n4delch:        cjne    @r0,#6,n8delch
                    2072                             ; pez->A-
                    2073                             ;K-=000/(A--AN)
                    2074                     ;       mov     r0,#rez_A;->r2..r5
                    2075                     ;       call    resar2
0C0C E577           2076                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0C0E FA             2077                                     mov             r2,a
0C0F E578           2078                                     mov             a,reacp+1
0C11 FB             2079                                     mov             r3,a
0C12 E579           2080                                     mov             a,reacp+2
0C14 FC             2081                                     mov             r4,a
0C15 E57A           2082                                     mov             a,reacp+3
0C17 FD             2083                                     mov             r5,a
                    2084                                     ;;;;;;;;;;;;;;;
0C18 120402         2085                             call    altof                   ;r2..r5->float
0C1B 788C           2086                             mov             r0,#rezAm;->rezAm
0C1D 120000   F     2087                             call    saver2                          
0C20 7884           2088                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0C22 120000   F     2089                             call    resar8                          
0C25 1201D1         2090                             call    flsub                   ; r2..r5(A--AN)
0C28 120000   F     2091                             call    move28                  ;r2..r5->r8..r11
0C2B 900000   F     2092                             mov             dptr,#CH2tho    ;000->r2..r5 float
0C2E 120000   F     2093                             call    ldc_long                
0C31 1202B7         2094                             call    fldiv
0C34 EA             2095                             mov             a,r2
0C35 547F           2096                             anl             a,#7fh
0C37 FA             2097                             mov             r2,a
0C38 7894           2098                             mov             r0,#koefKm;->koefKm
0C3A 120000   F     2099                             call    saver2
                    2100                        
0C3D E536           2101                             mov             a,saus                  ;восстан исходное упр слово
0C3F F584           2102                             mov             p4,a
0C41 E537           2103                             mov             a,saus+1
0C43 F585           2104                             mov             p5,a            
0C45 7883           2105                             mov             r0,#chdel
0C47 06             2106                             inc             @r0                       ;ch+1
0C48 020000   F     2107                        jmp    rebyte
                    2108     
0C4B B6090F         2109     n8delch:        cjne    @r0,#9,n12delch
0C4E 7600           2110                             mov             @r0,#0
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    34

0C50 7981           2111                             mov             r1,#chavt
0C52 770C           2112                             mov             @r1,#0ch;6;1;
0C54 09             2113                             inc             r1
0C55 7780           2114                             mov             @r1,#80h;40h;
0C57 120000   F     2115                             call   clmassix     ;сбросить массив среднего
0C5A 020000   F     2116                             jmp             rebyte
0C5D 06             2117     n12delch:       inc             @r0
0C5E 020000   F     2118                             jmp             rebyte
                    2119     
                    2120     
                    2121     
                    2122                                 
0C61 020000   F     2123     rout6:          jmp             out6
0C64 020000   F     2124     rlabelF:        jmp             labelF  
0C67 020000   F     2125     rknrazr:        jmp             knrazr  
0C6A 020000   F     2126     rknopt:         jmp             knopt
0C6D 020000   F     2127     rizman:         jmp             izman   
0C70                2128     keyb1:  ;IE6 
0C70 75E700         2129                                     mov             EIE2,#00H
0C73 75AD00         2130                                     mov             P3IF,#00
                    2131                                     
0C76 C0E0           2132                                     push    acc
0C78 C0D0           2133                                     push    psw
0C7A C000           2134                                     push    rr0
0C7C C001           2135                                     push    rr1
0C7E C002           2136                                     push    rr2
0C80 C003           2137                                     push    rr3
0C82 C004           2138                                     push    rr4
0C84 C005           2139                                     push    rr5
0C86 C006           2140                                     push    rr6
0C88 C007           2141                                     push    rr7
                    2142                                     ;clr            bitmig
                    2143                       ;;;;;;;;;;;;;;
0C8A 120000   F     2144                                     call    z_01s;0,1s
0C8D 120000   F     2145                                             call    z_01s
                    2146                                     ;восстан знакоместо при мигании
                    2147                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0C90 78B2           2148                                     mov             r0,#marker
0C92 7440           2149                                     mov             a,#bufind
0C94 26             2150                                     add             a,@r0                   ;a=bufind+marker
0C95 F9             2151                                     mov             r1,a
0C96 A73C           2152                                     mov             @r1,savba
                    2153                                     ;;;;;;;;;;;
0C98 E5B0           2154                             mov             a,p3
0C9A 20E644         2155                                     jb              acc.6,outviR;выход из режима выч R
0C9D E5B0           2156     gout6:                          mov             a,p3
0C9F 44FF           2157                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0CA1 F5B0           2158                                     mov             p3,a
0CA3 E5B0           2159                                     mov             a,p3
0CA5 30E6B9         2160                                     jnb             acc.6,rout6             ;error
0CA8 3004B9         2161                                     jnb             bitizm,rlabelF
0CAB 75B0FE         2162                                     mov             p3,#0feh                ;реж IZM
0CAE E5B0           2163                                     mov             a,p3
0CB0 30E6BA         2164                                     jnb             acc.6,rizman
                    2165                                     ;;;;;;
0CB3 201232         2166                                     jb              bitklb,goklb
0CB6 75B0FD         2167                                     mov             p3,#0fdh
0CB9 E5B0           2168                                     mov             a,p3
0CBB 30E6A9         2169                                     jnb             acc.6,rknrazr             ;labelC
0CBE 75B0FB         2170                                     mov             p3,#0fbh
0CC1 E5B0           2171                                     mov             a,p3
0CC3 30E655         2172                                     jnb             acc.6,knright           ;->
0CC6 75B0F7         2173                                     mov             p3,#0f7h
0CC9 E5B0           2174                                     mov             a,p3
0CCB 30E69C         2175                                     jnb             acc.6,rknopt                    ;T
0CCE 75B0EF         2176                                     mov             p3,#0efh
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    35

0CD1 E5B0           2177                                mov          a,p3
0CD3 30E615         2178                                     jnb             acc.6,pyskst                    ;pysk/stop
0CD6 75B0DF         2179                                     mov             p3,#0dfh
0CD9 E5B0           2180                                     mov             a,p3
0CDB 30E659         2181                                jnb          acc.6,knvich
0CDE 020000   F     2182                                     jmp             izmpaT
                    2183     
0CE1 3006B9         2184     outviR: jnb             bitvi11,gout6   
0CE4 C214           2185                                     clr             bitvich                         ;выход из р
                             ежима выч R  
0CE6 C206           2186                                     clr             bitvi11
                    2187                                     
0CE8 020000   F     2188     goklb:          jmp             out6
                    2189     
0CEB 200A12         2190     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0CEE D20A           2191                                     setb    bitbon  ;уст реж буфер вкл
0CF0 79D5           2192                                     mov                     r1,#volume;work         ;обьем блок
                             а
0CF2 7700           2193                                     mov                     @r1,#00
0CF4 09             2194                                     inc                     r1
0CF5 77C7           2195                                     mov                     @r1,#0c7h                       ;32
                             0h/4
0CF7 434B02         2196                                     orl             bufind+11,#02h; on pysk
0CFA 120000   F     2197                                     call            ind
0CFD 020000   F     2198                                     jmp             izmpaT
0D00 C20A           2199     bufon:                  clr             bitbon  ;уст реж буфер выкл
0D02 534BFD         2200                                             anl             bufind+11,#0fdh; off pysk
0D05 120000   F     2201                                             call    ind
0D08 020000   F     2202                                     jmp             izmpaT
                    2203     
0D0B 79B0           2204     tizmri:                 mov             r1,#level
0D0D B70102         2205                                     cjne    @r1,#1,right2
                    2206                                     ;10s->HET
0D10 8004           2207                                     jmp             right3
                    2208     
0D12 07             2209     right2:                 inc             @r1
0D13 120000   F     2210                                     call    lolevT
                    2211                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0D16 120000   F     2212     right3:                 call    ind
0D19 806D           2213                                     jmp             izmfun
                    2214     
                    2215                             
                    2216                             
0D1B                2217     knright:        
                    2218     
0D1B 79AE           2219                                     mov             r1,#diap
                    2220                             ;перекл диапазон 1 поз вверх сбр массив
0D1D 17             2221                                     dec             @r1
0D1E B7FF04         2222                                     cjne    @r1,#0ffh,diinc
0D21 7700           2223                                     mov             @r1,#0
0D23 8063           2224                                     jmp  izmfun
0D25 120000   F     2225     diinc:                  call     clmassix
0D28 78B3           2226                                     mov             r0,#summa
0D2A 120000   F     2227                                     call    clear4
0D2D 786A           2228                                     mov             r0,#rez_A0
0D2F 120000   F     2229                                     call    clear4  
0D32 120000   F     2230                                     call    loadUS
0D35 8051           2231                                      jmp  izmfun
                    2232     
0D37 200613         2233     knvich:            jb           bitvi11,onvich
0D3A C204           2234                                     clr             bitizm
0D3C D214           2235                                     setb    bitvich
                    2236                                     
0D3E 78B1           2237                                     mov             r0,#vichR
0D40 7611           2238                                     mov             @r0,#11h;;????????or 0
                    2239                                     ;ВЫЧИСЛИТЬ
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    36

0D42 900000   F     2240                                     mov     dptr,#teVICH
0D45 120000   F     2241                                     call    lotext
0D48 120000   F     2242                                call         z_1s;;;;;;;
0D4B 806C           2243                                     jmp              viout;izmpaT
                    2244     
0D4D C214           2245     onvich:                 clr             bitvich
0D4F 78B1           2246                                     mov             r0,#vichR
0D51 7600           2247                                     mov             @r0,#0
0D53 8037           2248                                     jmp              izmpaT
                    2249     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0D55 301820         2250     louizm:            jnb          knizm,lou
0D58 79AE           2251                                     mov             r1,#diap
0D5A C3             2252                                     clr             c
0D5B 7403           2253                                     mov             a,#3
0D5D 97             2254                                     subb    a,@r1
0D5E 5006           2255                                     jnc             lldi23    ;10-2..10-5
                    2256                                     ;10-6..10-11
0D60 E584           2257                                     mov             a,p4
0D62 54F7           2258                                     anl             a,#0f7h   ;d3
0D64 F584           2259                                     mov             p4,a
0D66 E7             2260     lldi23:                 mov             a,@r1
0D67 6403           2261                                     xrl             a,#3
0D69 7002           2262                                     jnz             lldi3
0D6B 8005           2263                                     jmp             lldi2   ;10-5
0D6D E7             2264     lldi3:                  mov             a,@r1
0D6E 6402           2265                                     xrl             a,#2            ;
0D70 7006           2266                                     jnz             lou             
0D72 E585           2267     lldi2:                  mov             a,p5            ;10-4
0D74 4408           2268                                     orl             a,#08
0D76 F585           2269                                     mov             p5,a
0D78 22             2270     lou:                    ret
                    2271                               ;;;;;;
0D79 201807         2272     izman:                  jb              knizm,knizmon
0D7C D218           2273                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2274                             ;       d3(k5 p4),d3(u5 p5)заслать us
0D7E 120000   F     2275                                     call    louizm 
0D81 8005           2276                                     jmp             izmfun
0D83 C218           2277     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0D85 120000   F     2278                                     call    loadUS;восстановить us
0D88                2279     izmfun:                 
0D88 D207           2280                                     setb    bitzus;bitbuf
0D8A 8000           2281                                     jmp             labelE;;;;;;;;;;;;
                    2282                                     ;;;;;;;;;;;;;;
0D8C                2283     izmpaT:
                    2284     ;;;;;;;;;;;;;;;;;
                    2285                     ;       clr             c 
                    2286                     ;       mov             r1,#parN
                    2287     
                    2288                     ;       mov             r0,#diap
                    2289                     ;       mov             a,#6            
                    2290                     ;       subb    a,@r0
                    2291                     ;       jnc             labelE          ;         ;10-2..10-8
                    2292                               
                    2293                     ;       mov             @r1,#2          ;10-9..10-11            
                    2294                     ;       jmp             labelE
                    2295     
                    2296     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0D8C 789A           2297     labelE:                 mov             r0,#parT
0D8E 793D           2298                                     mov             r1,#chkl
0D90 B60108         2299                                     cjne    @r0,#1,izmt2
0D93 7700           2300                                     mov             @r1,#0
0D95 09             2301                                     inc             r1
0D96 7702           2302                                     mov             @r1,#2
0D98 020000   F     2303                                     jmp             out6
0D9B B60208         2304     izmt2:                  cjne    @r0,#2,izmt3
0D9E 7700           2305                                     mov             @r1,#0
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    37

0DA0 09             2306                                     inc             r1
0DA1 7714           2307                                     mov             @r1,#20
0DA3 020000   F     2308                                     jmp             out6
                    2309     
0DA6 7700           2310     izmt3:                  mov             @r1,#0
0DA8 09             2311                                     inc             r1
0DA9 77C8           2312                                     mov             @r1,#200
0DAB 020000   F     2313                                     jmp             out6
                    2314     
                    2315     
                    2316     
                    2317     
0DAE                2318     knopt: ;кнопка T
0DAE C204           2319                                clr          bitizm
0DB0 D210           2320                                setb         bitt2
0DB2 79B7           2321                                mov          r1,#load
0DB4 7704           2322                                mov          @r1,#4;1s
0DB6 120000   F     2323                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2324                     
0DB9 793D           2325     viout:          mov             r1,#chkl
0DBB 7703           2326                             mov             @r1,#03
0DBD 09             2327                             inc             r1
0DBE 77E8           2328                             mov             @r1,#0e8h               ;1000
0DC0 020000   F     2329                             jmp             out6
                    2330     
0DC3                2331     knrazr:          
0DC3 C3             2332     labelC:          clr            c
0DC4 78AF           2333                             mov             r0,#parN
0DC6 799A           2334                             mov             r1,#parT
0DC8 7402           2335                             mov             a,#2
0DCA 97             2336                             subb    a,@r1
0DCB 40BF           2337                             jc              labelE          ;T>2
0DCD B60104         2338                             cjne    @r0,#1,noN1c
0DD0 7602           2339                             mov             @r0,#2          ;N=2
0DD2 80B8           2340                             jmp             labelE
                    2341     
0DD4 B60204         2342     noN1c:          cjne    @r0,#2,not_1
0DD7 7603           2343                             mov             @r0,#3          ;N=3      ;10-2..10-8
0DD9 80B1           2344                             jmp             labelE
                    2345     
0DDB                2346     not_10: 
0DDB 7601           2347     not_1:          mov             @r0,#1                          ;N=1
0DDD 80AD           2348                             jmp     labelE
                    2349     
0DDF 020000   F     2350     rtizmri:        jmp             tizmri
                    2351     
0DE2 75B0F7         2352     ttout:          mov             p3,#0f7h
0DE5 20B6D1         2353                                             jb              p3.6,viout
0DE8 D204           2354                                             setb    bitizm;отжатие кнопки t
0DEA C210           2355                                             clr             bitt2
0DEC 809E           2356                                             jmp             labelE
0DEE                2357     labelf:                 
0DEE 301037         2358                             jnb             bitt2,nofizm
0DF1 75B0FB         2359                        mov          p3,#0fbh
0DF4 E5B0           2360                        mov          a,p3
0DF6 20E6E9         2361                        jb           acc.6,ttout;outF
0DF9 79B7           2362                        mov          r1,#load;parT
0DFB B70503         2363                        cjne         @r1,#5,noft1
                    2364                        ;t=10s
0DFE 020000   F     2365                        jmp          out6;ft1izm
                    2366     
0E01 07             2367     noft1:     inc          @r1;dec         @r1
0E02 120000   F     2368     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2369                             ;call   ind
0E05 020000   F     2370                     jmp             out6;??????????????/
                    2371     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    38

                    2372                             ;увеличить счетчик задержки клавиатуры
0E08 783D           2373     outF:           mov             r0,#chkl
0E0A 7627           2374                             mov             @r0,#27h
0E0C 08             2375                             inc             r0
0E0D 7610           2376                             mov             @r0,#10h
0E0F 020000   F     2377                             jmp             out6;out7
                    2378     
0E12 020000   F     2379     noviR1:         jmp             noviR
0E15 78B1           2380     outvich:        mov                     r0,#vichR
0E17 7600           2381                                             mov                     @r0,#0
0E19 C214           2382                                             clr                     bitvich
0E1B C206           2383                                             clr                     bitvi11
0E1D C211           2384                                             clr                     bitmenu
0E1F D204           2385                                             setb            bitizm
0E21 78B2           2386                                             mov                     r0,#marker
0E23 76FF           2387                                             mov                     @r0,#0ffh
0E25 020000   F     2388                                             jmp                     out6    
                    2389     
0E28 3014E7         2390     nofizm:         jnb             bitvich,noviR1
0E2B 75B0DF         2391                                                     mov             p3,#0dfh
0E2E 30B6E4         2392                                                     jnb             p3.6,outvich;отжатие кнопки
                              вычR
0E31 78B1           2393                             mov             r0,#vichR
0E33 B61110         2394                             cjne    @r0,#11h,no11v6
0E36 75B0FB         2395                             mov                     p3,#0fbh;->
0E39 20B6CC         2396                             jb                      p3.6,outF
0E3C 7612           2397                             mov             @r0,#12h                ;11= вычислить
0E3E 900000   F     2398     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0E41 120000   F     2399                             call    lotext
0E44 80C2           2400                             jmp             outF
                    2401             
0E46 B61210         2402     no11v6:         cjne    @r0,#12h,no12v6
0E49 75B0FB         2403                             mov             p3,#0fbh;->
0E4C 20B6B9         2404                             jb              p3.6,outF
0E4F 7613           2405                             mov             @r0,#13h
0E51 900000   F     2406                             mov             dptr,#teOUT
0E54 120000   F     2407                             call    lotext
0E57 80AF           2408                             jmp             outF
                    2409                     
0E59 B61310         2410     no12v6:         cjne    @r0,#13h,no13v6
0E5C 75B0FB         2411                                                     mov             p3,#0fbh;->
0E5F 20B6A6         2412                             jb              p3.6,outF
0E62 7611           2413                             mov             @r0,#11h
0E64 900000   F     2414                             mov             dptr,#teVICH
0E67 120000   F     2415                             call    lotext
0E6A 809C           2416                             jmp             outF
                    2417     
                    2418     ;кн -> A= 0000
                    2419     ;кн -> B= +00000
0E6C 75B0FB         2420     no13v6:         mov             p3,#0fbh
0E6F E5B0           2421                             mov             a,p3
0E71 20E635         2422                             jb              acc.6,chanZ
0E74 E53B           2423                             mov             a,movrig
0E76 B40714         2424                             cjne    a,#7,kon_B      
0E79 78B2           2425                             mov             r0,#marker      ;A= 0000
0E7B B60716         2426                             cjne    @r0,#7,mark0_8          ;курсор справа ?
0E7E E53A           2427     rikn:           mov             a,movleft
0E80 F6             2428                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2429     ;                               29.12.06
                    2430     ;;;;;;;;;;;;;;;;;;
                    2431     ;необходимо не портить цифру в следуюем справа знакоместе
                    2432     ;т е сохранить ее в ячейке для мигания в противном случае
                    2433     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2434     ;       знакоместа
0E81 78B2           2435                                     mov             r0,#marker
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    39

0E83 7440           2436                                     mov             a,#bufind
0E85 26             2437                                             add             a,@r0                   ;a=bufind+m
                             arker
0E86 F9             2438                                             mov             r1,a
0E87 09             2439                                             inc             r1
0E88 873C           2440                                             mov             savba,@r1
0E8A 020000   F     2441                                     jmp             outF
                    2442     
0E8D 78B2           2443     kon_B:          mov             r0,#marker      ;B= +00000
0E8F B60802         2444                                             cjne    @r0,#8,mark0_8          ;курсор справа ?
0E92 80EA           2445                                             jmp             rikn
0E94                2446     mark0_8:
                    2447     ;                               29.12.06
                    2448     ;;;;;;;;;;;;;;;;;;
                    2449     ;необходимо не портить цифру в следуюем справа знакоместе
                    2450     ;т е сохранить ее в ячейке для мигания в противном случае
                    2451     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2452     ;       знакоместа ->B=+00000
0E94 78B2           2453                                             mov             r0,#marker
0E96 7440           2454                                     mov             a,#bufind
0E98 26             2455                                             add             a,@r0                   ;a=bufind+m
                             arker
0E99 F9             2456                                             mov             r1,a
0E9A 09             2457                                             inc             r1
0E9B 873C           2458                                             mov             savba,@r1
0E9D 78B2           2459                             mov             r0,#marker
0E9F 06             2460                             inc             @r0             ;       сдвинуть курсор вправо на 1
0EA0 C219           2461                             clr             bitmig
0EA2 B60901         2462                             cjne    @r0,#9,outma
0EA5 18             2463                             dec             r0;ppp
0EA6 020000   F     2464     outma:          jmp             outF
                    2465     
0EA9 75B0FE         2466     chanZ:          mov             p3,#0feh
0EAC E5B0           2467                             mov             a,p3
0EAE 20E611         2468                             jb              acc.6,chanma
                    2469                             ;изм знак в старшем разряде на противоположн
0EB1 E543           2470                             mov             a,bufind+3
0EB3 B42B06         2471                             cjne            a,#2bh,noplus
0EB6 75432D         2472                             mov                     bufind+3,#2dh           ;+->-   
0EB9 020000   F     2473                             jmp             outF
0EBC                2474     noplus:
0EBC 75432B         2475                             mov                     bufind+3,#2bh           ;-/+-
0EBF 020000   F     2476                             jmp             outF
0EC2 75B0FD         2477     chanma:         mov             p3,#0fdh
0EC5 E5B0           2478                             mov             a,p3
0EC7 20E603         2479                             jb              acc.6,outFl;labelL1
                    2480                             ;clr            bitmig
0ECA 120000   F     2481     labelL1:        call    vvchibl;f       ;увеличить цифру 
                    2482     
0ECD 020000   F     2483     outFl:                  jmp             outF
                    2484                     
0ED0                2485     nor11:          ;       выход
0ED0 7613           2486                     mov             @r0,#13h  ;12->13
0ED2 900000   F     2487                     mov             dptr,#teOUT
                    2488     ;               jmp             vi1113
                    2489     
                    2490     ;;;;;;;;;кнопка -> в режиме кнопки меню
                    2491     
                    2492     
                    2493     
0ED5 020000   F     2494     rlabelL:        jmp                     labelL
                    2495     ;findmem:               jmp             out6
0ED8 301171         2496     noviR:          jnb                     bitmenu,findmem;17.01.07
                    2497     ;;;;;;;;;;;;;
0EDB 78B1           2498                                             mov                     r0,#vichR
0EDD 7415           2499                                             mov                     a,#15h
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    40

0EDF C3             2500                                             clr                     c
0EE0 96             2501                                             subb            a,@r0
0EE1 4016           2502                                             jc                      ri21_23
                    2503     
0EE3 75B0FB         2504                                             mov             p3,#0fbh; реж кн меню ->
0EE6 20B60A         2505                                             jb              p3.6,ri6
0EE9 78B1           2506                                             mov             r0,#vichR
0EEB B61508         2507                                             cjne    @r0,#15h,norime
0EEE 7611           2508                                             mov             @r0,#11h
0EF0 120000   F     2509     norime1:        call            lomenu
0EF3 020000   F     2510     ri6:                    jmp             out6
0EF6 06             2511     norime:         inc             @r0
0EF7 80F7           2512                                             jmp             norime1
                    2513             
0EF9 7423           2514     ri21_23:        mov                     a,#23h          ;->
0EFB C3             2515                                             clr                     c
0EFC 96             2516                                             subb            a,@r0
0EFD 4014           2517                                             jc                      ri_31
0EFF 75B0FB         2518                                             mov                     p3,#0fbh
0F02 20B6EE         2519                                             jb                      p3.6,ri6
0F05 B62308         2520                                             cjne            @r0,#23h,no23ri
0F08 7621           2521                                             mov                     @r0,#21h
0F0A 120000   F     2522                                             call            lomenu
0F0D 020000   F     2523                                             jmp                     out6
0F10 06             2524     no23ri:         inc                     @r0
0F11 80DD           2525                                             jmp                     norime1
0F13 B63119         2526     ri_31:          cjne            @r0,#31h,no31ri;->19.2->57.6->19.2
0F16 30130B         2527                                             jnb                     bitv19,gosk19
0F19 900000   F     2528                                             mov                     dptr,#teS57_6;57,6
0F1C 120000   F     2529                                             call            lotext
0F1F C213           2530                                             clr                     bitv19
0F21 020000   F     2531                                             jmp             out6
0F24 900000   F     2532     gosk19:         mov                     dptr,#teS19_2
0F27 120000   F     2533                                             call            lotext
0F2A D213           2534                                             setb            bitv19
0F2C 020000   F     2535                                             jmp                     out6
                    2536     
                    2537     
                    2538     
                    2539     ;labelS2:       jmp                     out6
                    2540     
0F2F 7452           2541     no31ri:         mov                     a,#52h;42h              ;->
0F31 C3             2542                                             clr                     c
0F32 96             2543                                             subb            a,@r0
0F33 40BE           2544                                             jc                      ri6
0F35 75B0FB         2545                                             mov                     p3,#0fbh                   
                                  ;41,42
0F38 30B608         2546                                             jnb                     p3.6,rlabelN    ;кнопка ->(
                             пароль 000)
0F3B 75B0FD         2547                                             mov                     p3,#0fdh
0F3E 20B6B2         2548                                             jb                      p3.6,ri6
0F41 8087           2549                                             jmp             labelL1                            
                                  ;кнопка 0..9  (пароль 000)
0F43 020000   F     2550     rlabelN:                jmp             labelN
0F46 020000   F     2551     moutF:          jmp             outF
                    2552     ;;;;;;;;;;;;;;;;;;;;;;;;;
0F49 020000   F     2553     rnnmemb:        jmp             nnmemb
                    2554     
0F4C                2555     nbimenu:
0F4C 300BFA         2556     findmem:        jnb             bitmem,rnnmemb
0F4F 79B0           2557                             mov             r1,#level                                          
                                          ;-> кн ПАМЯТЬ (ОЧИСТКА ->ЗАПИСЬ-> ПРОСМОТР)
0F51 B71113         2558                        cjne         @r1,#11h,nomem11
                    2559                        
0F54 75B0FB         2560                        mov          p3,#0fbh
0F57 E5B0           2561                        mov          a,p3
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    41

0F59 20E6EA         2562                        jb           acc.6,moutF
0F5C 7712           2563                        mov          @r1,#12h
0F5E 900000   F     2564                        mov          dptr,#teWR      ;                       ЗАПИСЬ
0F61 120000   F     2565                        call         lotext
0F64 020000   F     2566                        jmp          outF
                    2567     
0F67 B71213         2568     nomem11:   cjne         @r1,#12h,nomem12
0F6A 75B0FB         2569                             mov             p3,#0fbh
0F6D E5B0           2570                        mov          a,p3
0F6F 20E6D4         2571                        jb           acc.6,moutF
0F72 7713           2572                        mov          @r1,#13h
0F74 900000   F     2573                        mov          dptr,#teLIST            ;ПРОСМОТР
0F77 120000   F     2574                        call         lotext
0F7A 020000   F     2575                        jmp          outF
0F7D B71313         2576     nomem12:         cjne           @r1,#13h,nomem13
0F80 75B0FB         2577                                             mov             p3,#0fbh
0F83 E5B0           2578                        mov          a,p3
0F85 20E6BE         2579                        jb           acc.6,moutF
0F88 7714           2580                        mov          @r1,#14h
0F8A 900000   F     2581                        mov          dptr,#teSTAT                    ;СТАТИСТИКА
0F8D 120000   F     2582                        call         lotext
0F90 020000   F     2583                          jmp                outF
                    2584                             
0F93 B71413         2585     nomem13:cjne            @r1,#14h,labelL
0F96 75B0FB         2586                             mov             p3,#0fbh
0F99 E5B0           2587                        mov          a,p3
0F9B 20E6A8         2588                        jb           acc.6,moutF
0F9E 7711           2589                        mov          @r1,#11h
0FA0 900000   F     2590                        mov          dptr,#teCLE                     ;ОЧИСТКА
0FA3 120000   F     2591                        call         lotext
0FA6 020000   F     2592                          jmp                outF
0FA9                2593     labelL: 
                    2594                             ;ПОЛНАЯ->БЛОК 00(level 21->22) 
0FA9 78B0           2595                                     mov                     r0,#level
0FAB B6210E         2596                                     cjne            @r0,#21h,nobl21
0FAE 7622           2597                                     mov                     @r0,#22h                ;->БЛОК 
0FB0 900000   F     2598                                     mov                     dptr,#teBL
0FB3 120000   F     2599     me21_22:call            lotext
                    2600                             
0FB6 120000   F     2601                                     call            z_05s;задержка чтобы не проскакивала пргр н
                             а следующий уровень
0FB9 020000   F     2602                                     jmp                     outF
                    2603     
0FBC B62207         2604     nobl21: cjne            @r0,#22h,nobl22
0FBF 900000   F     2605                                     mov                     dptr,#teFULL
0FC2 7621           2606                                     mov                     @r0,#21h                ;->ПОЛНАЯ
                    2607     
0FC4 80ED           2608                                     jmp                     me21_22
                    2609     
                    2610     ;labl21:           cjne @r0,#21h,nolev1
                    2611     ;                       mov             p3,#0fbh
                    2612     ;                       mov             a,p3
                    2613     ;                       jb              acc.6,loutF
                    2614     ;                       cjne    @r0,#21h,labl22
                    2615     ;                       mov             @r0,#22h
                    2616                             ;БЛОК
                    2617     ;                       call    lotext
                    2618     ;                       jmp             outF
                    2619     ;labl22:                mov             @r0,#21h
                    2620                             ;ПОЛНАЯ
                    2621     ;                       call    lotext
                    2622     ;                       jmp             outF
                    2623                      
0FC6 B62325         2624     nobl22:         cjne    @r0,#23h,go31l
0FC9 75B0FB         2625     rigblo:         mov             p3,#0fbh
0FCC 20B629         2626                                             jb              p3.6,llev2
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    42

0FCF                2627     labL2:    ;  уст курсор в правую позицию 
                    2628                                     ;       кнопка                  ->
                    2629     ;;;;;;;;;;;;;;;;;;
                    2630     ;необходимо не портить цифру в следуюем справа знакоместе
                    2631     ;т е сохранить ее в ячейке для мигания в противном случае
                    2632     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2633     ;       знакоместа
0FCF 78B2           2634                                             mov             r0,#marker
0FD1 7440           2635                                     mov             a,#bufind
0FD3 26             2636                                             add             a,@r0                   ;a=bufind+m
                             arker
0FD4 F9             2637                                             mov             r1,a
0FD5 09             2638                                             inc             r1
0FD6 873C           2639                                             mov             savba,@r1
0FD8 C219           2640                                             clr             bitmig
                    2641     ;;;;;;;;;;;;;;;;
0FDA 78B2           2642                       mov           r0,#marker      ;курсор справа  ?
0FDC E53B           2643                             mov             a,movrig
0FDE C3             2644                             clr             c
0FDF 96             2645                             subb    a,@r0
0FE0 6006           2646                             jz         equ1l
0FE2 E53B           2647                             mov             a,movrig;уст в правую позицию
0FE4 F6             2648                             mov             @r0,a
0FE5 020000   F     2649                             jmp             outF                                     
0FE8 E53A           2650     equ1l:          mov             a,movleft;уст в левую позицию
0FEA F6             2651                             mov             @r0,a   
0FEB 020000   F     2652     loutF:  jmp             outF
                    2653                     
                    2654     
0FEE B63102         2655     go31l:          cjne    @r0,#31h,go41l
0FF1 80D6           2656                             jmp             rigblo
0FF3 B6410B         2657     go41l:          cjne    @r0,#41h,norig2
0FF6 80D1           2658                             jmp             rigblo
                    2659     
0FF8 75B0FD         2660     llev2:          mov             p3,#0fdh
0FFB 20B6ED         2661                             jb              p3.6,loutF
0FFE 020000   F     2662                             jmp             labelL1
                    2663     
                    2664     ;->
1001 C3             2665     norig2:    clr          c               ;32,33,34,42
1002 7431           2666                             mov             a,#31h
1004 96             2667                             subb    a,@r0
1005 50E4           2668                             jnc             loutF
1007 75B0FB         2669     rigblok:        mov             p3,#0fbh  ;32,33,34,42
100A 20B626         2670                             jb              p3.6,lev2go
100D                2671     labelN: 
                    2672                             ;                               29.12.06
                    2673     ;;;;;;;;;;;;;;;;;;
                    2674     ;необходимо не портить цифру в следуюем справа знакоместе
                    2675     ;т е сохранить ее в ячейке для мигания в противном случае
                    2676     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2677     ;       знакоместа
100D 78B2           2678                                             mov             r0,#marker
100F 7440           2679                                     mov             a,#bufind
1011 26             2680                                             add             a,@r0                   ;a=bufind+m
                             arker
1012 F9             2681                                             mov             r1,a
1013 09             2682                                             inc             r1
1014 873C           2683                                             mov             savba,@r1
                    2684     ;;;;;;;;;;;;;;;;;;;
1016 78B2           2685                             mov             r0,#marker      ;курсор справа  ?
1018 E53B           2686                             mov             a,movrig
101A C3             2687                             clr             c
101B 96             2688                             subb    a,@r0
101C 7006           2689                             jnz        noequ1
101E E53A           2690                             mov             a,movleft;уст в крайнюю левую позицию
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    43

1020 F6             2691                             mov             @r0,a
1021 020000   F     2692                             jmp             outF
1024                2693     noequ1: ;29.12.06
                    2694     ;;;;;;;;;;;;;;;;;;
                    2695                             ;восстан знакоместо при мигании
                    2696                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
1024 78B2           2697                                     mov             r0,#marker
1026 7440           2698                                     mov             a,#bufind
1028 26             2699                                     add             a,@r0                   ;a=bufind+marker
1029 F9             2700                                     mov             r1,a
                    2701                                     ;mov            @r1,savba
102A 09             2702                                     inc             r1
102B 873C           2703                                     mov             savba,@r1
                    2704     ;;;;;;;;;;;;;;;;        
102D 120000   F     2705                             call    marri;уст сдвиг в правую        позицию
1030 020000   F     2706                             jmp             outF
1033 75B0FD         2707     lev2go:         mov             p3,#0fdh
1036 30B603         2708                             jnb             p3.6,rlabelL1
1039 020000   F     2709                             jmp             outF
                    2710     
103C 020000   F     2711     rlabelL1:       jmp             labelL1
                    2712     
103F                2713     nnmemb:
                    2714                                     
                    2715     
                    2716     
103F                2717     norim6:    ;kn menu
103F                2718     out6:           
103F D007           2719                                     pop             rr7     
1041 D006           2720                                     pop             rr6
1043 D005           2721                                     pop             rr5
1045 D004           2722                                     pop             rr4
1047 D003           2723                                     pop             rr3
1049 D002           2724                                     pop             rr2
104B D001           2725                                     pop             rr1                             
104D D000           2726                                     pop             rr0
104F D0D0           2727                                     pop             psw
1051 D0E0           2728                                     pop             acc
                    2729     ;clr            bitmig
                    2730                               ; mov         EIE2,#30H
                    2731                              ;  mov         a,P3IF
                    2732                             ;       anl             a,#0bfh
                    2733                             ;       mov             P3IF,a
                    2734                             ;       mov             P3,#0c0h
                    2735                             ;;;;;;
1053 75AD00         2736                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1056 75B0C0         2737                             mov             P3,#0c0h
1059 C219           2738                             clr             bitmig
105B E586           2739                                             mov             a,P6            ;p6.4=0
105D 54EF           2740                             anl             a,#0efh
105F F586           2741                             mov             P6,a
1061 00             2742                             nop
1062 00             2743                             nop
                    2744                                     
1063 E586           2745                             mov             a,P6                    ;p6.4=1 
1065 4410           2746                             orl             a,#10h
1067 F586           2747                             mov             P6,a                        
1069 32             2748                             reti
                    2749     
106A 020000   F     2750     rknMEM:                 jmp             knMEM
106D 020000   F     2751     knKMP:             jmp          out7
1070 020000   F     2752     rout7:                  jmp             out7    
1073 020000   F     2753     rlabelH:                jmp             labelH
1076 020000   F     2754     rknNUL:         jmp             knNUL
1079 020000   F     2755     rknleft:                jmp             knleft
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    44

107C                2756     keyb2:  ;IE7
107C 75E700         2757                                     mov             EIE2,#00H
107F 75AD00         2758                                     mov             P3IF,#00
                    2759     
1082 C0E0           2760                                     push    acc
1084 C0D0           2761                                     push    psw
1086 C000           2762                                     push    rr0
1088 C001           2763                                     push    rr1
108A C002           2764                                     push    rr2
108C C003           2765                                     push    rr3
108E C004           2766                                     push    rr4
1090 C005           2767                                     push    rr5
1092 C006           2768                                     push    rr6
1094 C007           2769                                     push    rr7
1096 C082           2770                                     push    dpl
1098 C083           2771                                     push    dph
                    2772                                     ;clr            bitmig
                    2773                       ;;;;;;;;;;;;;;
109A 120000   F     2774                               call  z_01s   ;0,1s
                    2775                               ;восстан знакоместо при мигании
                    2776                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
109D 78B2           2777                                     mov             r0,#marker
109F 7440           2778                                     mov             a,#bufind
10A1 26             2779                                     add             a,@r0                   ;a=bufind+marker
10A2 F9             2780                                     mov             r1,a
10A3 A73C           2781                                     mov             @r1,savba
                    2782                                     ;;;;;;;;;;;
                    2783     
10A5 E5B0           2784                             mov             a,p3
10A7 20E7C6         2785                                     jb              acc.7,rout7
10AA E5B0           2786                                     mov             a,p3
10AC 74FF           2787                                     mov             a,#0ffh         ; p3.(5-0)<-3f
10AE F5B0           2788                                     mov             p3,a
10B0 E5B0           2789                                     mov             a,p3
10B2 30E7BB         2790                                     jnb             acc.7,rout7             ;error
10B5 3004BB         2791                                     jnb             bitizm,rlabelH
10B8 75B0FE         2792                                     mov             p3,#0feh                ;реж IZM
10BB E5B0           2793                                     mov             a,p3
10BD 30E7B6         2794                                     jnb             acc.7,rknNUL
10C0 75B0FD         2795                                     mov             p3,#0fdh
10C3 E5B0           2796                                     mov             a,p3
10C5 30E7A5         2797                                     jnb             acc.7,knKMP
10C8 75B0FB         2798                                     mov             p3,#0fbh
10CB E5B0           2799                                     mov             a,p3
10CD 30E7A9         2800                                     jnb             acc.7,rknleft
10D0 75B0F7         2801                                     mov             p3,#0f7h
10D3 E5B0           2802                                     mov             a,p3
10D5 30E75B         2803                                     jnb             acc.7,knAVP
10D8 75B0EF         2804                                 mov         p3,#0efh
10DB E5B0           2805                                     mov             a,p3
10DD 30E78A         2806                                     jnb             acc.7,rknMEM
10E0 75B0DF         2807                                     mov             p3,#0dfh
10E3 E5B0           2808                                     mov             a,p3    
10E5 30E722         2809                                     jnb             acc.7,knmenu
10E8                2810     an_t7:             ;;;;;;;;;;;;
                    2811                     
                    2812     ;       clr             c
                    2813     ;       mov             r1,#parN
                    2814     ;
                    2815     ;                       mov             r0,#diap
                    2816     ;                       mov             a,#6            
                    2817     ;                       subb    a,@r0
                    2818     ;                       jnc             goto7           ;         ;10-2..10-8
                    2819                               
                    2820     ;                       mov             @r1,#2          ;10-9..10-11            
                    2821                             
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    45

                    2822                             ;;;;;;;;;;;;
10E8 799A           2823     goto7:                  mov             r1,#parT
10EA 783D           2824                                     mov             r0,#chkl
10EC B70108         2825                                     cjne    @r1,#1,not1_7
10EF 7600           2826                                     mov             @r0,#00
10F1 08             2827                                     inc             r0
10F2 7602           2828                                     mov             @r0,#2
10F4 020000   F     2829                                     jmp             out7
                    2830                             
                    2831     
10F7 B70208         2832     not1_7:                 cjne    @r1,#2,not2_7
10FA 760E           2833                                             mov             @r0,#0eh;00
10FC 08             2834                                     inc             r0
10FD 7638           2835                                     mov             @r0,#38h;20
10FF 020000   F     2836                                     jmp             out7
1102 7600           2837     not2_7:                 mov             @r0,#00
1104 08             2838                                     inc             r0
1105 76C8           2839                                     mov             @r0,#200
1107 020000   F     2840     merr:           jmp             out7
                    2841     
                    2842     
110A 2006FA         2843     knmenu: jb              bitvi11,merr
110D 201511         2844                                     jb              biteizm,menuoff
1110 C204           2845                              clr            bitizm          ;off IZM
1112 D211           2846                                     setb            bitmenu
1114 900000   F     2847                                     mov             dptr,#teTESI    ;в буф2 записать ТЕСТ-ИЗМЕР
1117 120000   F     2848                                     call    lotext
                    2849                                     
111A 78B1           2850                                     mov             r0,#vichR
111C 7611           2851                                     mov             @r0,#11h
111E 020000   F     2852                                     jmp             onmem11
1121                2853     menuoff:
1121 78B1           2854                                     mov             r0,#vichR
1123 7600           2855                                     mov             @r0,#00
1125 C215           2856                                     clr             biteizm
1127 120000   F     2857                                     call    loadus
112A 020000   F     2858                                     jmp             out7
112D 75EF10         2859                                     mov             RSTSRC,#10h
                    2860                                     ;jmp            begin;onmem11
                    2861     
1130 020000   F     2862     rendkalib:              jmp             endkalib
                    2863     
1133 2012FA         2864     knAVP:  jb              bitklb,rendkalib        
1136 200505         2865                                     jb              bitavp,meavp
1139 D205           2866                                     setb    bitavp
113B 020000   F     2867                                     jmp             onmem11
113E C205           2868     meavp:                  clr             bitavp
1140 020000   F     2869                                     jmp             onmem11
                    2870     
1143 201207         2871     knleft: jb              bitklb,lefkl
                    2872                                     ;;;;;;;;
1146 79AE           2873                                mov          r1,#diap
1148 07             2874                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
1149 B70A03         2875                                     cjne    @r1,#0ah,nodi6
114C 17             2876                                     dec             @r1
114D 8099           2877     lefkl:  jmp             an_t7
                    2878     
114F                2879     nodi6:             ;    cjne    @r1,#0,an_t7
114F 120000   F     2880                                      call    clmassix
1152 78B3           2881                                     mov             r0,#summa
1154 120000   F     2882                                     call    clear4  
1157 786A           2883                                     mov             r0,#rez_A0
1159 120000   F     2884                                     call    clear4  
115C 120000   F     2885                                     call    loadUS
115F 8087           2886                                jmp          an_t7
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    46

                    2887     
1161 200F0F         2888     knNUL:                  jb              bitnul,ybnul
1164 D20F           2889                                     setb    bitnul
1166 789C           2890                                     mov             r0,#rez_A3      ;A3
1168 120000   F     2891                                     call    resar2
116B 786A           2892                                     mov             r0,#rez_A0      
116D 120000   F     2893                                     call    saver2;A0<-A3
1170 020000   F     2894                                     jmp             goto7;an_t7
                    2895     
1173 C20F           2896     ybnul:                  clr             bitnul
1175 900000   F     2897                                      mov    DPTR,#ch0 
1178 120000   F     2898                                     CALL   ldc_long          ; r2..r5 <-- 0
117B 786A           2899                                     mov             r0,#rez_A0      ;A0=0
117D 120000   F     2900                                     call    saver2
1180 020000   F     2901                                     jmp             goto7;an_t7
                    2902     
1183 301021         2903     labelH:                 jnb             bitt2,nolah
1186 75B0FB         2904                                     mov             p3,#0fbh   ;вход в режим изм Т
1189 534A8F         2905                                     anl             bufind+10,#8fh
118C 79B7           2906                                     mov             r1,#load;parT
118E 20B70D         2907                                     jb              p3.7,rhnot1
1191 B70003         2908                                     cjne    @r1,#0,inct;
1194 020000   F     2909                                     jmp             out7;hyest6
1197 17             2910     inct:                   dec             @r1                     ;Tизм+1
                    2911                             
1198 120000   F     2912                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
119B                2913     hnot2:          ;       call    ind
119B 020000   F     2914                                     jmp             out7
                    2915     
119E 020000   F     2916      rhnot1:                jmp             hnot1
                    2917      ;rnoviR:       jmp             noviR
11A1 020000   F     2918      rlabelK:       jmp             labelK
11A4 020000   F     2919      rlabelI:       jmp             labelI          
                    2920      ;;;;;;;;;;;;;;;;;;;
11A7 3014F7         2921     nolah:          jnb             bitvich,rlabelK 
                    2922                                     
                    2923                             ;;;;;;
                    2924                             ;увеличить счетчик задержки клавиатуры
                    2925                     ;;              mov             r0,#chkl
                    2926                     ;;              mov             @r0,#27h
                    2927                     ;;              inc             r0
                    2928                     ;;              mov             @r0,#10h
                    2929                             ;;;;;;
                    2930     
11AA 78B1           2931                             mov             r0,#vichR
11AC B61128         2932                             cjne    @r0,#11h,rhnor11;rlabelI;;
11AF 75B0FB         2933                             mov             p3,#0fbh   ;<-
11B2 20B730         2934                             jb              p3.7,noh37;routF
11B5 B6110B         2935                     cjne    @r0,#11h,hr12
11B8 7613           2936                             mov             @r0,#13h        ;11= вычислить
11BA 900000   F     2937                             mov             dptr,#teOUT;teVICH
11BD 120000   F     2938     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
11C0 020000   F     2939                             jmp             goto7;outF
11C3 B61207         2940     hr12:           cjne    @r0,#12h,hnor12
11C6 7611           2941     lovich:         mov             @r0,#11h
11C8 900000   F     2942                             mov             dptr,#teVICH
11CB 80F0           2943                             jmp             hvi1113         
11CD B61307         2944     hnor12:         cjne    @r0,#13h,rhnor11
11D0 7612           2945     loizmk:         mov             @r0,#12h
11D2 900000   F     2946                             mov             dptr,#teIZMK    ;       изм конст
                    2947                                        
11D5 80E6           2948                             jmp             hvi1113
                    2949     
11D7 804C           2950     rhnor11:                jmp             hnor11
                    2951     
11D9 8057           2952     rvvizko:                jmp             vvizko
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    47

11DB C214           2953     vioutF:                 clr             bitvich
11DD C206           2954                                                     clr             bitvi11
11DF 020000   F     2955                                                     jmp             outF
11E2 020000   F     2956     toutF:                  jmp     outF
                    2957     
11E5 75B0F7         2958     noh37:          mov             p3,#0f7h
11E8 20B7F7         2959                             jb              p3.7,toutF;vioutF
11EB B611EB         2960                             cjne    @r0,#11h,rvvizko
11EE D206           2961                             setb    bitvi11    ;нажат ввод ВЫЧИСЛИТЬ
11F0 D204           2962              setb   bitizm
11F2 534B07         2963                              anl            bufind+11,#07h
11F5 434B10         2964                              orl            bufind+11,#10h;точка после 1 знакоместа
11F8 020000   F     2965     routF:          jmp             out7;goto7;outF
                    2966     
                    2967     
                    2968     
11FB 80E8           2969     rnoh37:         jmp             noh37
                    2970     
11FD B6120D         2971     norr11:         cjne    @r0,#12h,norr12
1200 75B0FB         2972                             mov             p3,#0fbh   ;<-
1203 20B7F5         2973                             jb              p3.7,rnoh37;routF
1206 760B           2974                             mov             @r0,#11;12->11
1208 80BC           2975                             jmp             lovich
                    2976     
120A 020000   F     2977     labelI2:                jmp             labelI
120D B613FA         2978     norr12:         cjne    @r0,#13h,labelI2
1210 75B0FB         2979                             mov             p3,#0fbh   ;<-
1213 20B7E5         2980                             jb              p3.7,rnoh37
1216 7612           2981                             mov             @r0,#12h
1218 80B6           2982                             jmp             loizmk
                    2983                             ;;;;
121A C214           2984     clrvich:                clr             bitvich
121C D204           2985                             setb    bitizm
121E A8B2           2986                             mov             r0,marker
1220 76FF           2987                             mov             @r0,#0ffh
1222 020000   F     2988                              jmp    goto7;  routF
                    2989     
                    2990     ;rnoh37:                jmp             noh37
                    2991      ;ввод изм конст
1225 B612E5         2992     hnor11:         cjne    @r0,#12h,norr12;clrvich
1228 75B0FB         2993                              mov            p3,#0fbh   
122B 20B7CD         2994                             jb              p3.7,rnoh37;lovich;;изм конст <-  выч
122E 7611           2995                             mov             @r0,#11h
1230 8094           2996                             jmp             lovich
                    2997     
1232 78B1           2998     vvizko:         mov             r0,#vichR
1234 E6             2999                             mov             a,@r0
                    3000                     ;       cjne    @r0,#12h,clrvich
1235 B412E2         3001                             cjne    a,#12h,clrvich
1238 7621           3002                             mov             @r0,#21h                ;изм конст->U=+0000     (vv
                             od)
123A 78B2           3003                             mov             r0,#marker
123C 7604           3004                             mov             @r0,#4;9
123E 753A04         3005                             mov             movleft,#4
1241 753B07         3006                             mov             movrig,#7
1244 900000   F     3007                             mov             dptr,#teAequ0
1247 120000   F     3008                             call    lotext
                    3009                             
124A 120000   F     3010                             call    outA
124D 534B0F         3011                             anl                     bufind+11,#0fh
                    3012             ;       mov             a,bufind+11
                    3013             ;       anl             a,#0f0h
                    3014             ;       mov             bufind+11,a
1250 434B40         3015                             orl             bufind+11,#40h;бит точки после 7 знакоместа(a=000.0
                              v)
                    3016                             
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    48

1253 020000   F     3017                             jmp             goto7;routF
                    3018     ;hnor13:                jmp             hnor12          
1256 B6210C         3019     izchi:          cjne    @r0,#21h,tlabelI
                    3020     ;<- при вводе цифр А                            
                    3021                     ;        mov            p3,#0fbh   
                    3022                     ;       jnb             p3.7,li21
                    3023             ;clr            bitmig
1259 78B2           3024                             mov             r0,#marker
125B 16             3025                             dec             @r0
125C B60201         3026                             cjne    @r0,#2,li21
125F 06             3027                             inc             @r0;marker=3 +/-
1260 C219           3028     li21:           clr             bitmig
1262 020000   F     3029                             jmp             goto7;outF
                    3030     
1265 020000   F     3031     tlabelI:        jmp             labelI
                    3032     
                    3033     ;                       load    0 1 2 3 4 5             
1268 06050403       3034     sootv:          db              6,5,4,3,2,1;parT
126C 0201                    
                    3035     ;
                    3036     
                    3037     ;нажата кн ввод при наборе Т
126E 75B0F7         3038     hnot1:                  mov             p3,#0f7h
1271 20B784         3039                                     jb              p3.7,routF;out7
1274 B70549         3040                                     cjne    @r1,#5,nohnot1  ;r1=load
1277 794A           3041                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
1279 E7             3042                                     mov             a,@r1
127A 548F           3043                                     anl             a,#8fh
127C 4440           3044                                     orl             a,#40h;.6
127E F7             3045                                     mov             @r1,a
127F 8000           3046                                     jmp             loadb
                    3047                                     
                    3048                                     
1281 789A           3049     loadB:                  mov             r0,#parT
1283 900000   F     3050                                     mov             dptr,#sootv
1286 79B7           3051                                     mov             r1,#load                
1288 E7             3052                                     mov             a,@r1;load
1289 93             3053                                     movc    a,@a+dptr
128A F6             3054                                     mov             @r0,a
128B 120000   F     3055                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    3056                                      ;r4=b1 r5=b2
128E 120000   F     3057                                     call    iniacp;инициализация АЦП
1291 120000   F     3058                                     call    loadUS
1294 120000   F     3059                                     call    clmassix        
1297 D204           3060                                     setb    bitizm
1299 C210           3061                                     clr             bitt2
                    3062     
129B 534A8F         3063                                     anl             bufind+10,#8fh
129E C3             3064                                      clr            c
129F 789A           3065                                  mov                r0,#parT
12A1 79AF           3066                                      mov            r1,#parN
12A3 7402           3067                                  mov                a,#2
12A5 96             3068                                 subb                a,@r0
12A6 5005           3069                                 jnc                 loadB2
12A8 7701           3070                                     mov             @r1,#1;N=1         ;T>=2
12AA 020000   F     3071     bout7:                  jmp             goto7;out7
                    3072     
12AD B702FA         3073     loadB2:                 cjne    @r1,#2,bout7
12B0 7702           3074                                     mov             @r1,#2;N=2
12B2 020000   F     3075                                     jmp             goto7;out7
12B5                3076     nohnot2:                ;в буфере 1 зажечь <=0,1s
12B5 794A           3077                                     mov             r1,#bufind+10
12B7 E7             3078                                     mov             a,@r1
12B8 4410           3079                                     orl             a,#10h;.4
12BA F7             3080                                     mov             @r1,a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    49

12BB 120000   F     3081                                     call            ind
12BE 80C1           3082                                     jmp             loadB
12C0 B704F2         3083     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
12C3 794A           3084                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
12C5 E7             3085                                     mov             a,@r1
12C6 4420           3086                                     orl             a,#20h;.5
12C8 F7             3087                                     mov             @r1,a
12C9 80B6           3088                                     jmp             loadB
                    3089     
                    3090     ;кнопка ПАМЯТЬ
12CB C204           3091     knMEM:                  clr             bitizm          ;off IZM
12CD 900000   F     3092                                     mov             dptr,#teCLE
12D0 120000   F     3093                                     call    lotext    ;в буф2 записать ОЧИСТКА
12D3 D20B           3094                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
12D5 534BEF         3095                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
12D8 434B01         3096                                     orl             bufind+11,#01;зажечь светодиод память
12DB 120000   F     3097                                     call            ind
12DE 78B0           3098                                     mov             r0,#level
12E0 7611           3099                                     mov             @r0,#11h
12E2 783D           3100     onmem11:                mov             r0,#chkl
12E4 7603           3101                                     mov             @r0,#03
12E6 08             3102                                     inc             r0
12E7 76E8           3103                                     mov             @r0,#0e8h               ;1000
12E9 020000   F     3104                                     jmp             out7;goto7;out7
                    3105     
12EC 020000   F     3106     rnomemk:                jmp             nomemk          ;
                    3107     
12EF 78B0           3108     outkmem:        mov                     r0,#level
12F1 7600           3109                                             mov                     @r0,#0
12F3 78B1           3110                                             mov                     r0,#vichR
12F5 7600           3111                                             mov                     @r0,#0
12F7 C20B           3112                                             clr                     bitmem
12F9 C214           3113                                             clr                     bitvich
12FB C206           3114                                             clr                     bitvi11
12FD C211           3115                                             clr                     bitmenu
12FF D204           3116                                             setb            bitizm
1301 78B2           3117                                             mov                     r0,#marker
1303 76FF           3118                                             mov                     @r0,#0ffh
1305 020000   F     3119                                             jmp                     vvod2_10
1308 020000   F     3120                                             jmp                     goto7   
130B                3121     labelK:
                    3122     
                    3123     ;;;;;;;;;;;;
130B 300BDE         3124                               jnb           bitmem,rnomemk          ;кн память (ввод и <-)
130E 75B0EF         3125                                     mov                     p3,#0efh
1311 30B7DB         3126                                     jnb                     p3.7,outkmem            ;отжатие кн
                              память на любом уровне обработки памяти
1314 78B0           3127                                      mov            r0,#level
1316 B6114E         3128                               cjne          @r0,#11h,klev1;nome11
1319 75B0FB         3129     lefmem11:         mov           p3,#0fbh
131C E5B0           3130                               mov           a,p3
131E 20E70E         3131                               jb            acc.7,rkvvod0
1321 B6110E         3132                               cjne          @r0,#11h,locle          ;<-memory
1324 7614           3133                               mov           @r0,#14h
1326 900000   F     3134     lolist:           mov           dptr,#teSTAT
1329 120000   F     3135                               call          lotext           ;СТАТИСТИКА
132C 020000   F     3136                               jmp   goto7;  outF
                    3137     
132F 020000   F     3138     rkvvod0:        jmp             kvvod0
                    3139     
                    3140     
1332 B6120B         3141     locle:          cjne            @r0,#12h,lowr           ;<-memory
1335 7611           3142                               mov           @r0,#11h                   ;ОЧИСТКА
1337 900000   F     3143     loadcle:          mov           dptr,#teCLE
133A 120000   F     3144                               call          lotext
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    50

133D 020000   F     3145                               jmp           goto7;outF
                    3146     
1340 B6130B         3147     lowr:                   cjne    @r0,#13h,lostat
1343 7612           3148                                             mov             @r0,#12h
1345 900000   F     3149      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
1348 120000   F     3150                             call    lotext
134B 020000   F     3151                             jmp             goto7;outF
                    3152     
134E 7613           3153     lostat:         mov             @r0,#13h
1350 900000   F     3154                                     mov             dptr,#teLIST              ;ПРОСМОТР
1353 120000   F     3155                             call    lotext
1356 020000   F     3156                             jmp             goto7;outF
                    3157     
1359 B6141A         3158     me_14:cjne              @r0,#14h,klev22
135C 7613           3159                                             mov             @r0,#13h
135E 900000   F     3160                             mov             dptr,#teLIST              ;;ПРОСМОТР
1361 120000   F     3161                             call    lotext
1364 020000   F     3162                             jmp             goto7
1367 B61202         3163      klev1:          cjne   @r0,#12h,klev2
136A 80AD           3164                             jmp             lefmem11
136C B61302         3165     klev2:           cjne   @r0,#13h,klev3;11-14   klev22     ;11-13 нет
136F 80A8           3166                             jmp             lefmem11
1371 B61402         3167     klev3:           cjne   @r0,#14h,klev22;
1374 80A3           3168                             jmp             lefmem11
                    3169     ;<- vvod на более низких уровнях
1376 B62117         3170     klev22:         cjne    @r0,#21h,klev21
1379 75B0FB         3171     lev220:         mov             p3,#0fbh
137C 20B766         3172                             jb              p3.7,kgo23
137F B6210B         3173                             cjne    @r0,#21h,kfullr
1382 7622           3174                             mov             @r0,#22h
1384 900000   F     3175                             mov             dptr,#teBL
1387 120000   F     3176                             call    lotext
138A 020000   F     3177                             jmp             goto7;outF
138D 020000   F     3178     kfullr:         jmp             kfull                           
1390 B6220E         3179     klev21:         cjne    @r0,#22h,klev23
1393 80E4           3180                             jmp             lev220
                    3181     
1395 020000   F     3182     rlabL2:         jmp             labL2
1398 020000   F     3183     rlabM:          jmp             labM
139B 020000   F     3184     ques:                   jmp             out7
139E 020000   F     3185     ddoutfr:        jmp             ddoutf
                    3186     
13A1 B623F4         3187     klev23:          cjne   @r0,#23h,rlabM
13A4 75B0FB         3188                              mov    p3,#0fbh
13A7 30B7F1         3189                              jnb            p3.7,ques;errr labL2
13AA 75B0F7         3190                              mov    p3,#0f7h
13AD 20B7EE         3191                              jb             p3.7,ddoutfr
                    3192                                             ;       считать с индикатора  
13B0 C3             3193                                     clr                     c
13B1 E547           3194                                mov          a,bufind+7      
13B3 9430           3195                                      subb           a,#30h
13B5 B40002         3196                                      cjne           a,#0,chaibl
13B8 7401           3197                                      mov            a,#1                    ;номера блоков 1..4
13BA                3198     chaibl:         
13BA F538           3199                                             mov             nblok,a
                    3200                                
                    3201                              ;очистить блок памяти с набранным номером
                    3202                              ;150h..1000h( 150h+nblok*320h)
13BC 120000   F     3203                                     call            adrblok         ;dptr-
                    3204     
13BF 79B8           3205                                     mov                     r1,#work                ;обьем блок
                             а
13C1 7703           3206                                     mov                     @r1,#03
13C3 09             3207                                     inc                     r1
13C4 7720           3208                                     mov                     @r1,#20h                        ;32
                             0h
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    51

                    3209     
13C6                3210     goonoff:
13C6 E4             3211                                     clr                     a
13C7 F0             3212                                     movx            @dptr,a
13C8 A3             3213                                     inc                     dptr
                    3214     
13C9 79B9           3215                                     mov                     r1,#work+1
13CB 120000   F     3216                                     call            chminus
13CE 78B8           3217                                     mov             r0,#work
13D0 E6             3218                             mov             a,@r0
13D1 30E7F2         3219                             jnb             acc.7,goonoff
                    3220     
13D4 C20B           3221                              clr    bitmem  ;сбр признак памяти 
13D6 D204           3222                              setb   bitizm
13D8 78B2           3223                              mov            r0,#marker
13DA 76FF           3224                              mov            @r0,#0ffh
13DC 020000   F     3225                                     jmp                     vvod2_10
13DF 020000   F     3226                              jmp    goto7
                    3227     
13E2 020000   F     3228     rddoutf:        jmp             ddoutf
                    3229     
                    3230     ;vvod   БЛОК->БЛОК 00           
13E5 75B0F7         3231     kgo23:           mov    p3,#0f7h
13E8 20B7F7         3232                             jb              p3.7,rddoutf
13EB B6216B         3233                             cjne    @r0,#21h,go23no
                    3234                             ;очистить память 150..dd0h
                    3235                             ;1й блок
13EE 900150         3236                              mov                    dptr,#150h
13F1 79B8           3237                                     mov                     r1,#work                ;обьем блок
                             а
13F3 7703           3238                                     mov                     @r1,#03
13F5 09             3239                                     inc                     r1
13F6 7720           3240                                     mov                     @r1,#20h                        ;32
                             0h
                    3241     
13F8                3242     gooff1:
13F8 E4             3243                                     clr                     a
13F9 F0             3244                                     movx            @dptr,a
13FA A3             3245                                     inc                     dptr
                    3246     
13FB 79B9           3247                                     mov                     r1,#work+1
13FD 120000   F     3248                                     call            chminus
1400 78B8           3249                                     mov             r0,#work
1402 E6             3250                             mov             a,@r0
1403 30E7F2         3251                             jnb             acc.7,gooff1
                    3252     ;2й блок
1406 900470         3253     mov                     dptr,#470h
1409 79B8           3254                                     mov                     r1,#work                ;обьем блок
                             а
140B 7703           3255                                     mov                     @r1,#03
140D 09             3256                                     inc                     r1
140E 7720           3257                                     mov                     @r1,#20h                        ;32
                             0h
                    3258     
1410                3259     gooff2:
1410 E4             3260                                     clr                     a
1411 F0             3261                                     movx            @dptr,a
1412 A3             3262                                     inc                     dptr
                    3263     
1413 79B9           3264                                     mov                     r1,#work+1
1415 120000   F     3265                                     call            chminus
1418 78B8           3266                                     mov             r0,#work
141A E6             3267                             mov             a,@r0
141B 30E7F2         3268                             jnb             acc.7,gooff2
                    3269     
                    3270     ;3й блок
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    52

141E 900490         3271                             mov                     dptr,#490h
1421 79B8           3272                                     mov                     r1,#work                ;обьем блок
                             а
1423 7703           3273                                     mov                     @r1,#03
1425 09             3274                                     inc                     r1
1426 7720           3275                                     mov                     @r1,#20h                        ;32
                             0h
                    3276     
1428                3277     gooff3:
1428 E4             3278                                     clr                     a
1429 F0             3279                                     movx            @dptr,a
142A A3             3280                                     inc                     dptr
                    3281     
142B 79B9           3282                                     mov                     r1,#work+1
142D 120000   F     3283                                     call            chminus
1430 78B8           3284                                     mov             r0,#work
1432 E6             3285                             mov             a,@r0
1433 30E7F2         3286                             jnb             acc.7,gooff3
                    3287     ;4й блок
1436 900AB0         3288     mov                     dptr,#0ab0h
1439 79B8           3289                                     mov                     r1,#work                ;обьем блок
                             а
143B 7703           3290                                     mov                     @r1,#03h
143D 09             3291                                     inc                     r1
143E 7720           3292                                     mov                     @r1,#20h                        ;32
                             0h
                    3293     
1440                3294     gooff4:
1440 E4             3295                                     clr                     a
1441 F0             3296                                     movx            @dptr,a
1442 A3             3297                                     inc                     dptr
                    3298     
1443 79B9           3299                                     mov                     r1,#work+1
1445 120000   F     3300                                     call            chminus
1448 78B8           3301                                     mov             r0,#work
144A E6             3302                             mov             a,@r0
144B 30E7F2         3303                             jnb             acc.7,gooff4
144E C20B           3304                             clr             bitmem
1450 D204           3305                             setb    bitizm
1452 78B2           3306                                     mov             r0,#marker
1454 76FF           3307                              mov            @r0,#0ffh
1456 020000   F     3308                             jmp                     vvod2_10;jmp            goto7
                    3309     
1459 7623           3310     go23no:    mov          @r0,#23h
145B 753B08         3311                                             mov                     movrig,#8
145E 753A07         3312                                             mov             movleft,#7
1461 8055           3313                             jmp             loblok;БЛОК 00
                    3314     
1463 7621           3315     kfull:          mov             @r0,#21h
1465 8025           3316                             jmp             gofull
                    3317                             
                    3318                                             
1467 020000   F     3319     nomemk:         jmp             labelS                  ;нажат ввод меню
                    3320                             
146A 75B0FB         3321     nome11:           mov           p3,#0fbh
146D E5B0           3322                               mov           a,p3
146F 20E70D         3323                               jb            acc.7,kvvod0
1472 B61205         3324                               cjne          @r0,#12h,mem12no        
1475 7611           3325                               mov           @r0,#11h                ;ОЧИСТКА
1477 020000   F     3326                               jmp            loadcle
                    3327     
147A                3328     mem12no:        ;cjne           @r0,#13h,lowr           
147A 7612           3329                               mov           @r0,#12h                   ;
147C 020000   F     3330                               jmp           lowr1                     ;ЗАПИСЬ
                    3331     
147F 75B0F7         3332     kvvod0:           mov           p3,#0f7h                        ;knopka vvod
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    53

1482 20B70F         3333                               jb            p3.7,ddoutf
1485 78B0           3334                               mov           r0,#level
1487 B61129         3335                               cjne          @r0,#11h,mvv11
148A 7621           3336                               mov           @r0,#21h                ;ПОЛНАЯ
148C 900000   F     3337     gofull:           mov           dptr,#teFULL
148F 120000   F     3338                               call          lotext
1492 804F           3339                                     jmp             mlabL2  ;<-????????/
                    3340     
1494                3341     ddoutf:         ;<- БЛОК 00(ОЧИСТКА)
                    3342     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3343     ;т е сохранить ее в ячейке для мигания в противном случае
                    3344     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3345     ;       знакоместа
1494 78B2           3346                                                     mov             r0,#marker
1496 7440           3347                                     mov             a,#bufind
1498 26             3348                                             add             a,@r0                   ;a=bufind+m
                             arker
1499 F9             3349                                             mov             r1,a
149A 19             3350                                             dec             r1      ;       inc             r1
149B 873C           3351                                             mov             savba,@r1
149D C219           3352                                             clr             bitmig
                    3353     ;;;;;;;;;;;;;;;;
149F 78B2           3354                       mov           r0,#marker      ;курсор слева   ?
14A1 E53A           3355                             mov             a,movleft
14A3 C3             3356                             clr             c
14A4 96             3357                             subb    a,@r0
14A5 7006           3358                             jnz        left21
14A7 E53B           3359                             mov             a,movrig;уст в правую позицию
14A9 F6             3360                             mov             @r0,a
                    3361     
14AA 020000   F     3362                             jmp             goto7                                            
14AD E53A           3363     left21:         mov             a,movleft;уст в левую позицию
14AF F6             3364                             mov             @r0,a   
14B0 020000   F     3365                             jmp             goto7
                    3366     
                    3367     
14B3 B61215         3368     mvv11:            cjne          @r0,#12h,mvv12
14B6 7631           3369                                     mov             @r0,#31h
14B8 900000   F     3370     loblok:                 mov             dptr,#teBL0;БЛОК 0
14BB 120000   F     3371                                     call    lotext
14BE E538           3372                                     mov                     a,nblok
14C0 2430           3373                                     add                     a,#30h
14C2 F547           3374                                     mov                     bufind+7,a
14C4 78B2           3375                                     mov             r0,#marker
14C6 7607           3376                                     mov             @r0,#7
                    3377                                     ;mov            movrig,#9
                    3378                                     ;mov            movleft,#6
14C8 020000   F     3379                                     jmp             goto7;outF
14CB B61411         3380     mvv12:  cjne            @r0,#14h,bl_li
14CE 7661           3381                                     mov                     @r0,#61h
14D0 900000   F     3382                                     mov             dptr,#teMIN;
14D3 120000   F     3383                                     call    lotext
14D6 120000   F     3384                                     call    vichmin
14D9 120000   F     3385                                     call    z_1s
14DC 020000   F     3386                                     jmp             out7;goto7;outF
                    3387     
14DF 7641           3388     bl_li:          mov             @r0,#41h                ; БЛОК 00(ЗАПИСЬ И ПРОСМОТР)
14E1 80D5           3389                                     jmp             loblok
                    3390     
                    3391     
                    3392     
14E3                3393     mlabL2:         ;jmp            labL2
                    3394                                             ;  уст курсор в правую позицию 
                    3395                                     ;                               29.12.06
                    3396     ;;;;;;;;;;;;;;;;;;
                    3397     ;необходимо не портить цифру в следуюем справа знакоместе
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    54

                    3398     ;т е сохранить ее в ячейке для мигания в противном случае
                    3399     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3400     ;       знакоместа
14E3 78B2           3401                                             mov             r0,#marker
14E5 7440           3402                                     mov             a,#bufind
14E7 26             3403                                             add             a,@r0                   ;a=bufind+m
                             arker
14E8 F9             3404                                             mov             r1,a
14E9 09             3405                                             inc             r1
14EA 873C           3406                                             mov             savba,@r1
                    3407     ;;;;;;;;;;;;;;;;
14EC 78B2           3408                       mov           r0,#marker      ;курсор справа  ?
14EE E53B           3409                             mov             a,movrig
14F0 C3             3410                             clr             c
14F1 96             3411                             subb    a,@r0
14F2 6006           3412                             jz         equ2l
14F4 E53B           3413                             mov             a,movrig;уст в правую позицию
14F6 F6             3414                             mov             @r0,a
                    3415     ;                       lool
14F7 020000   F     3416                             jmp             goto7                                            
14FA E53A           3417     equ2l:          mov             a,movleft;уст в левую позицию
14FC F6             3418                             mov             @r0,a   
14FD 020000   F     3419                             jmp             goto7
                    3420                     
1500 020000   F     3421     rnom31:         jmp                     nom31
1503 B631FA         3422     labM:                   cjne    @r0,#31h,rnom31
1506 75B0FB         3423                                     mov             p3,#0fbh
1509 30B7D7         3424                                     jnb             p3.7,mlabL2
150C 75B0F7         3425                                mov          p3,#0f7h
150F 20B782         3426                                jb           p3.7,ddoutf
                    3427                                
1512 7632           3428                                mov          @r0,#32h                        ;ИНТ 0000
                    3429                                     ;       считать с индикатора  
1514 C3             3430     blokvv:         clr                     c
1515 E547           3431                                mov          a,bufind+7      
1517 9430           3432                                      subb           a,#30h
1519 B40002         3433                                      cjne           a,#0,blokvvc
151C 7401           3434                                      mov            a,#1                    ;номера блоков 1..4
                    3435     
151E F538           3436     blokvvc: mov            nblok,a
1520 900000   F     3437                                mov          dptr,#teINT;ИНТ 0000c
1523 120000   F     3438                                call         lotext
1526 78CE           3439                                      mov            r0,#interva+1
1528 7952           3440                                      mov            r1,#abin+3
152A E6             3441                                      mov            a,@r0
152B F7             3442                                      mov            @r1,a
152C 18             3443                                             dec                     r0
152D 19             3444                                             dec                     r1
152E E6             3445                                             mov             a,@r0
152F F7             3446                                             mov             @r1,a
1530 19             3447                                             dec             r1
1531 E4             3448                                             clr             a
1532 F7             3449                                             mov             @r1,a
1533 19             3450                                             dec             r1
1534 F7             3451                                             mov             @r1,a
                    3452                                                                             
1535 7853           3453                                             mov             r0,#adec
1537 7952           3454                                             mov             r1,#abin+3      ;hex->10
1539 120000   F     3455                                             call    bindec
                    3456                                     
153C 785C           3457                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
153E 7948           3458                                             mov             r1,#bufind+8
1540 7F04           3459                                             mov             r7,#4
1542 E6             3460     bloin:                          mov             a,@r0
1543 2430           3461                                             add             a,#30h
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    55

1545 F7             3462                                             mov             @r1,a
1546 19             3463                                             dec             r1
1547 18             3464                                             dec             r0
1548 DFF8           3465                                             djnz    r7,bloin
154A 78B2           3466                                mov          r0,#marker
154C 7605           3467                                mov          @r0,#5
154E 753B08         3468                                mov          movrig,#8
1551 753A05         3469                                mov          movleft,#5
1554 789A           3470                                      mov            r0,#parT
1556 B60609         3471                                     cjne            @r0,#6,innot6
1559 534BF0         3472                                     anl                     bufind+11,#0f0h;after 5- 0.000c
155C 434B80         3473                                     orl                     bufind+11,#80h
                    3474                             
155F 020000   F     3475                                     jmp                     goto7
1562 B60309         3476     innot6: cjne            @r0,#3,innot3
1565 534BF0         3477                                     anl                     bufind+11,#0f0h;after 7- 000.0c
1568 434B20         3478                                     orl                     bufind+11,#20h
                    3479                                     ;call           ind
156B 020000   F     3480                                     jmp                     out7;goto7
156E C3             3481     innot3: clr                     c
156F 7403           3482                                     mov                     a,#3
1571 96             3483                                     subb            a,@r0
1572 5009           3484                                     jnc                     innot1_2
1574 534BF0         3485                                     anl                     bufind+11,#0f0h;after 6- 00.00c
1577 434B40         3486                                     orl                     bufind+11,#40h
                    3487                                     
157A 020000   F     3488                                     jmp                     goto7
                    3489     
157D                3490     innot1_2:
157D 534B0F         3491                                     anl                     bufind+11,#0fh;0h;0000c
1580 C219           3492                                     clr                     bitmig
                    3493                                     ;call           ind             нет необходимости пришет пр
                             обел         
1582 020000   F     3494     rgoto7: jmp        goto7;outF
                    3495     
1585 B63276         3496     nom31:             cjne         @r0,#32h,nom32
1588 75B0FB         3497                                     mov             p3,#0fbh
158B 20B71F         3498                                     jb              p3.7,vvinte             ;ввод интервал;no31
                             n
                    3499                                     
158E                3500     lefcur:         ;;кн <- 32 нач блок 000
                    3501     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3502     ;т е сохранить ее в ячейке для мигания в противном случае
                    3503     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3504     ;       знакоместа
158E C219           3505                                                     clr             bitmig
1590 78B2           3506                                                     mov             r0,#marker;нажата кн <- при
                              вводе цифр нач блок 000
1592 7440           3507                                     mov             a,#bufind
1594 26             3508                                             add             a,@r0                   ;a=bufind+m
                             arker
1595 F9             3509                                             mov             r1,a
1596 19             3510                                             dec             r1;;;;;;;;;;;
1597 873C           3511                                             mov             savba,@r1
                    3512                                             
1599 78B2           3513                                                     mov             r0,#marker      ;курсор сле
                             ва?
159B E53A           3514                             mov             a,movleft
159D C3             3515                             clr             c
159E 96             3516                             subb    a,@r0
159F 7006           3517                             jnz        noequ2
15A1 E53B           3518                             mov             a,movrig
15A3 F6             3519                             mov             @r0,a;уст в крайнюю правую позицию
15A4 020000   F     3520                             jmp             goto7
15A7 120000   F     3521     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
15AA 020000   F     3522                             jmp        goto7        
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    56

                    3523                                                                       
                    3524     
                    3525     ;;;;;;;;;;;;;;;;;;
15AD                3526     vvinte:         ;ввод интервал                          
15AD 75B0F7         3527     no31n:             mov          p3,#0f7h
15B0 20B7CF         3528                                     jb              p3.7,rgoto7
15B3 7633           3529                                     mov             @r0,#33h
                    3530                                     ;считать с индикатора введенный интервал
15B5 7F0A           3531                                             mov             r7,#10
15B7 7853           3532                                     mov             r0,#adec
15B9 120000   F     3533                                     call    clearN
15BC 120000   F     3534                                     call    upak4                   
15BF 784F           3535                                     mov             r0,#abin
15C1 7953           3536                                     mov             r1,#adec                        ;мл        
                              ст
15C3 120000   F     3537                                     call    decbin                  ;abin..abin+3 (hex)
15C6 794F           3538                                     mov             r1,#abin
15C8 78CE           3539                                     mov             r0,#interva+1
15CA E7             3540                                     mov             a,@r1
15CB F6             3541                                     mov             @r0,a
15CC 18             3542                                     dec             r0
15CD 09             3543                                     inc             r1
15CE E7             3544                                     mov             a,@r1
15CF F6             3545                                     mov             @r0,a
                    3546                                     
15D0 78D5           3547                                     mov             r0,#volume                      ;объем блок
                             а
15D2 7600           3548                                     mov             @r0,#0
15D4 08             3549                                     inc             r0
15D5 76C7           3550                                     mov             @r0,#0c7h
15D7 120000   F     3551                                     call            adrblok;dptr
15DA 120000   F     3552                                     call            save_hl;1я ячейка блока
15DD 78B2           3553                                mov          r0,#marker
15DF 76FF           3554                                mov          @r0,#0ffh
15E1 D204           3555                                      setb           bitizm
15E3 C20B           3556                                      clr            bitmem
15E5 789A           3557     vvod2_10: mov           r0,#parT
15E7 B6050C         3558                                      cjne           @r0,#5,no10msv
15EA 900000   F     3559                                             mov                     dptr,#te10ms
15ED 120000   F     3560     t2msme:         call            lotext
15F0 120000   F     3561                                             call            ind
15F3 020000   F     3562     no2msv:   jmp      goto7;
15F6 B606FA         3563     no10msv:        cjne            @r0,#6,no2msv   
15F9 900000   F     3564                                             mov                     dptr,#te2ms
15FC 80EF           3565                                     jmp                     t2msme
                    3566     
                    3567     
                    3568     
15FE B6332B         3569     nom32:           cjne           @r0,#33h,nom33
1601 75B0FB         3570                              mov            p3,#0fbh
1604 30B787         3571                              jnb            p3.7,lefcur
1607 75B0F7         3572                              mov            p3,#0f7h
160A 20B7E6         3573                              jb             p3.7,no2msv;rgoto7
                    3574                              ;запомнить номер ячейки конца блока
160D 7634           3575                              mov    @r0,#34h
160F 7F0A           3576     INTn:                   mov             r7,#10
1611 7853           3577                                     mov             r0,#adec
1613 120000   F     3578                                     call    clearN
1616 120000   F     3579                                     call    upak3                   
1619 784F           3580                                     mov             r0,#abin
161B 7953           3581                                     mov             r1,#adec                        ;мл        
                              ст
161D 120000   F     3582                                     call    decbin                  ;abin..abin+3 (hex)
1620 120000   F     3583                                     call    loadr2                  ;r2..r5
1623 120402         3584                                     call    altof                   ;r2..r5->int
1626 020000   F     3585     dgoto7:                  jmp            goto7
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    57

                    3586     
1629 020000   F     3587     rlefcur:                jmp             lefcur
                    3588     
162C B6345B         3589     nom33:          cjne            @r0,#34h,labelP
162F 75B0FB         3590                               mov           p3,#0fbh
1632 30B7F4         3591                              jnb            p3.7,rlefcur
1635 75B0F7         3592                              mov            p3,#0f7h
1638 20B7EB         3593                              jb             p3.7,dgoto7
163B 7635           3594                              mov            @r0,#35h
163D 78B2           3595                              mov            r0,#marker
163F 76FF           3596                              mov            @r0,#0ffh
                    3597                              ;T1<-число на индикаторе
                    3598                                               ;vvod КОН БЛ 000
1641 78CF           3599                              mov            r0,#chbuf               ;счетчик периода загрузки в
                              буфер и интерфейс
1643 7630           3600                              mov            @r0,#30h  
1645 C20B           3601                              clr            bitmem
1647 D204           3602                              setb           bitizm;;;;      
1649 020000   F     3603                             jmp        goto7
164C 020000   F     3604     vodm11_15:                      jmp             vvodm11_15
164F 020000   F     3605     me11_15de:                      jmp             me11_15dec
1652 020000   F     3606     moutkmem:                               jmp             outkmem
                    3607     
                    3608     ;обработка кнопки меню ввод
1655 301132         3609     labelS:         jnb                     bitmenu,labelP
1658 75B0DF         3610                                             mov                     p3,#0dfh
165B 30B7F4         3611                                             jnb                     p3.7,moutkmem
165E 78B1           3612                                             mov                     r0,#vichR
1660 7415           3613                                             mov                     a,#15h
1662 C3             3614                                             clr                     c
1663 96             3615                                             subb            a,@r0
1664 4021           3616                                             jc                      rme21_23
                    3617                             
1666 75B0FB         3618                                             mov                     p3,#0fbh
1669 20B7E0         3619                                             jb                      p3.7,vodm11_15
166C 78B1           3620                                             mov                     r0,#vichR
166E B611DE         3621                                             cjne                    @r0,#11h,me11_15de;<-
1671 7615           3622                                             mov                     @r0,#15h
1673 900000   F     3623                                             mov                     dptr,#teKALIB
1676 120000   F     3624                                             call            lotext
1679 020000   F     3625                                             jmp                     onmem11
167C C211           3626     menuon:         clr             bitmenu                 ;off menu
167E D204           3627                                             setb    bitizm
                    3628     
1680 78B1           3629                                     mov             r0,#vichR
1682 7600           3630                                     mov             @r0,#0
1684 020000   F     3631                                     jmp             onmem11
                    3632     
                    3633                                             ;;;;;
                    3634             
1687 020000   F     3635     rme21_23:               jmp             me21_23 
                    3636                             
                    3637     ;режим просмотра
168A B64130         3638     labelP:                 cjne            @r0,#41h,govvlist
168D 7642           3639                                                     mov                     @r0,#42h
                    3640                                                     ;       считать с индикатора  
168F C3             3641                                             clr                     c
1690 E547           3642                                mov          a,bufind+7      
1692 9430           3643                                      subb           a,#30h
1694 B40002         3644                                      cjne           a,#0,chaipr
1697 7401           3645                                      mov            a,#1
1699 F538           3646     chaipr:                          mov            nblok,a
169B 900000   F     3647                                mov          dptr,#teCH;ОТСЧЕТ 000
169E 120000   F     3648                                call         lotext
16A1 534BEF         3649                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    58

16A4 78B2           3650                                mov          r0,#marker
16A6 7607           3651                                mov          @r0,#7
16A8 753B09         3652                                mov          movrig,#9
16AB 753A07         3653                                mov          movleft,#7
16AE 120000   F     3654                                             call            z_1s
16B1 020000   F     3655                        jmp     goto7;outF
16B4 020000   F     3656     label43:                jmp             label7
                    3657     
16B7 020000   F     3658     rlist_43:                       jmp                     list_43                            
                                  
16BA 020000   F     3659     mlabL2r:                        jmp                     mlabL2
16BD B642F7         3660     govvlist:                       cjne            @r0,#42h,rlist_43
16C0 75B0FB         3661                                                                     mov                     p3,
                             #0fbh
16C3 30B7F4         3662                                                             jnb                     p3.7,mlabL2
                             r;кн <- ОТСЧЕТ 000
16C6 75B0F7         3663                                                             mov                     p3,#0f7h
16C9 20B7E8         3664                                                             jb                      p3.7,label4
                             3
16CC 7643           3665                                                             mov                     @r0,#43h;vv
                             od 
16CE 78B2           3666                                                             mov                     r0,#marker
16D0 76FF           3667                                                             mov                     @r0,#0ffh
16D2 7F0A           3668                                                                     mov             r7,#10
16D4 7853           3669                                     mov             r0,#adec
16D6 120000   F     3670                                     call    clearN
16D9 120000   F     3671                                     call    upak3                   
16DC 784F           3672                                     mov             r0,#abin
16DE 7953           3673                                     mov             r1,#adec                        ;мл        
                              ст
16E0 120000   F     3674                                     call    decbin                  ;abin..abin+3 (hex)
16E3 120000   F     3675                                     call    loadr2                  ;r2..r5
16E6 ED             3676                                     mov             a,r5                            ;сохр номер
                              лемента
16E7 F537           3677                                     mov             nelem,a
16E9 120402         3678                                     call    altof                   ;r2..r5->int
16EC 900000   F     3679                                     mov             dptr,#ch_1;
16EF 120000   F     3680                                     call    ldc_ltemp                       ;r8..r11
16F2 1201D1         3681                                     call    flsub
16F5 900000   F     3682                                     mov             dptr,#ch_4;
16F8 120000   F     3683                                     call    ldc_ltemp                       ;r8..r11
16FB 120203         3684                                     call    flmul                           ;(n(номер отсчета)-
                             1)*4+адр нач блока
16FE 120343         3685                                     call            ftol                    ;r2..r5->hex
1701 C002           3686                                     push            rr2
1703 C003           3687                                     push            rr3
1705 C004           3688                                     push            rr4
1707 C005           3689                                     push            rr5
1709 120000   F     3690                                     call            adrblok;dptr-
170C D005           3691                                     pop                     rr5
170E D004           3692                                     pop                     rr4
1710 D003           3693                                     pop                     rr3
1712 D002           3694                                     pop                     rr2
1714 79D8           3695                                     mov                     r1,#copy_hl+1;saven_bl+1;сохр адрес
                              внешн озу введенного лемента
1716 E582           3696                                     mov                     a,dpl
1718 2D             3697                                     add                     a,r5
1719 F582           3698                                     mov                     dpl,a
171B F7             3699                                     mov                     @r1,a           ;low
171C E583           3700                                     mov                     a,dph
171E 3C             3701                                     addc            a,r4
171F F583           3702                                     mov                     dph,a
1721 19             3703                                     dec                     r1
1722 F7             3704                                     mov                     @r1,a                   ;high
                    3705                             
1723                3706     li42_43:
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    59

1723 120000   F     3707                                     call            reA3_X          ;r2..r5/выдать рез из внешн
                              пам на индикатор
1726 900000   F     3708                                     mov             dptr,#ch10;
1729 120000   F     3709                                     call    ldc_ltemp
172C 120000   F     3710                                     call    zdiv    
                    3711                                     ;;;;;;;;;;;
172F 120000   F     3712                                     call    maform
                    3713                                     ;;;;
                    3714     
                    3715                                     ;;;;;;;
1732 784F           3716                                             mov             r0,#abin
1734 120000   F     3717                                             call    saver2
1737 7853           3718                                             mov             r0,#adec
1739 7952           3719                                             mov             r1,#abin+3      ;hex->10
173B 120000   F     3720                                             call    bindec
                    3721                                     
173E 785C           3722                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1740 7945           3723                                             mov             r1,#bufind+5
1742 7F07           3724                                             mov             r7,#7
1744 E6             3725     ch43:                           mov             a,@r0
1745 2430           3726                                             add             a,#30h
1747 F7             3727                                             mov             @r1,a
1748 19             3728                                             dec             r1
1749 18             3729                                             dec             r0
174A DFF8           3730                                             djnz    r7,ch43
174C 7847           3731                                             mov             r0,#bufind+7
174E 762D           3732                                             mov             @r0,#2dh          ;-2..-9
1750 7840           3733                                             mov             r0,#bufind
1752 762B           3734                                             mov             @r0,#2bh
1754 300202         3735                                             jnb             znmat,nozzmi43;bitznak,nozzmi
1757 762D           3736                                             mov             @r0,#2dh
1759 7934           3737     nozzmi43:                               mov             r1,#sadiap;diap
175B 7848           3738                                             mov             r0,#bufind+8
175D E7             3739                                             mov             a,@r1
175E B40808         3740                                             cjne    a,#8,nodi8_43
1761 7630           3741                                             mov             @r0,#30h                 ;10-10
1763 18             3742                                             dec             r0
1764 7663           3743                                             mov             @r0,#63h;31h
1766 08             3744                                             inc             r0
1767 800E           3745                                             jmp             see_l43
1769 B40908         3746     nodi8_43:       cjne    a,#9,nodi9_43
                    3747                                     
176C 7631           3748                                             mov             @r0,#31h           ;10-11
176E 18             3749                                             dec             r0
176F 7663           3750                                             mov             @r0,#63h;31h
                    3751                                     
1771 08             3752                                             inc             r0
1772 8003           3753                                             jmp             see_l43
1774 2432           3754     nodi9_43:               add             a,#32h
1776 F6             3755                                             mov             @r0,a;
1777 08             3756     see_l43:                        inc             r0
1778 7641           3757                                             mov             @r0,#"A";"E";
                    3758                             ;       inc             r0
                    3759                             ;       mov             @r0,#00h ;=feh в нач установе для поджига в
                             сех сегм
                    3760                             ;       inc             r0;             mov             bufind+11
                    3761                             ;       mov             @r0,#0d0h               ;bufind+11.4 точка 
                             после первой цифры
177A 434B10         3762                             orl                     bufind+11,#10h
177D 120000   F     3763     out43:          call            ind
1780 120000   F     3764                                             call            z_1s
1783 020000   F     3765                                             jmp             out7                               
                                  
                    3766     
                    3767                                     ;;;;;;;;        
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    60

1786 783D           3768     label7: mov             r0,#chkl
1788 7604           3769                                     mov             @r0,#04;3
178A 08             3770                                     inc             r0
178B 76E8           3771                                     mov             @r0,#0e8h               ;1000
178D 020000   F     3772                                     jmp             out7;
1790 B64351         3773     list_43:                cjne    @r0,#43h,noli_43
1793 75B0FB         3774                                                     mov             p3,#0fbh                ;43
                             h <-
1796 20B70A         3775                                                     jb              p3.7,vvod43             ;vv
                             od
1799 C20B           3776                                                     clr             bitmem
179B D204           3777                                                     setb    bitizm
179D 78B2           3778                                                     mov             r0,#marker
179F 76FF           3779                                                     mov             @r0,#0ffh
17A1 80E3           3780                                                     jmp             label7;по кн <- выход из пр
                             осмотра
                    3781     
17A3 7644           3782     vvod43:                 mov             @r0,#44h
17A5 E537           3783                                                     mov             a,nelem;вывод порядкового н
                             омера в блоке 
17A7 04             3784                                                     inc             a
17A8 F552           3785                                                     mov             abin+3,a
                    3786                                                     
17AA F537           3787                                                     mov             nelem,a
17AC E4             3788                                                     clr             a
17AD F551           3789                                                     mov             abin+2,a
17AF F550           3790                                                     mov             abin+1,a
17B1 F54F           3791                                                     mov             abin,a
                    3792                                             
17B3 7853           3793                                             mov             r0,#adec
17B5 7952           3794                                             mov             r1,#abin+3      ;hex->10
17B7 120000   F     3795                                             call    bindec
17BA 7840           3796                                             mov             r0,#bufind;почистить индикатор
17BC 7F0A           3797                                             mov             r7,#10
17BE 7420           3798                                             mov             a,#20h
17C0 F6             3799     cle20:          mov             @r0,a
17C1 08             3800                                             inc             r0
17C2 DFFC           3801                                             djnz    r7,cle20
                    3802                                             ;;;;;;
17C4 900000   F     3803                                             mov             dptr,#teCH;ОТСЧЕТ 000
17C7 120000   F     3804                                call         lotext
17CA 534BEF         3805                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
17CD 785C           3806                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
17CF 7949           3807                                             mov             r1,#bufind+9
17D1 7F03           3808                                             mov             r7,#3
17D3 E6             3809     ch43_42:                                mov             a,@r0
17D4 2430           3810                                             add             a,#30h
17D6 F7             3811                                             mov             @r1,a
17D7 19             3812                                             dec             r1
17D8 18             3813                                             dec             r0
17D9 DFF8           3814                                             djnz    r7,ch43_42
17DB 120000   F     3815                                             call            ind
17DE 120000   F     3816                                             call            z_1s
17E1 020000   F     3817                                             jmp             out7
17E4 B64419         3818     noli_43:        cjne            @r0,#44h,vvosta
17E7 7643           3819                                             mov                     @r0,#43h
17E9 79D8           3820                                                     mov                     r1,#copy_hl+1;saven
                             _bl+1
17EB E7             3821                                                     mov                     a,@r1
17EC F582           3822                                                     mov                     dpl,a
17EE 19             3823                                                     dec                     r1
17EF E7             3824                                                     mov                     a,@r1;high
17F0 F583           3825                                                     mov                     dph,a
17F2 A3             3826                                                     inc                     dptr
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    61

17F3 A3             3827                                                     inc                     dptr
17F4 A3             3828                                                     inc                     dptr
17F5 A3             3829                                                     inc                     dptr
17F6 E583           3830                                                     mov                     a,dph
17F8 F7             3831                                                     mov                     @r1,a
17F9 09             3832                                                     inc                     r1
17FA E582           3833                                                     mov                     a,dpl
17FC F7             3834                                                     mov                     @r1,a              
                                          ;сохр адр внешн озу
17FD 020000   F     3835                                             jmp                     li42_43;вывод значения след
                             ующего в блоке
                    3836     
1800 B66111         3837     vvosta:                 cjne            @r0,#61h,vvostad
1803 7662           3838                                                     mov                     @r0,#62h
1805 900000   F     3839                                                     mov                     dptr,#teMAX;
1808 120000   F     3840                                                     call            lotext
180B 120000   F     3841                                                     call            vichmax
180E 120000   F     3842                                                     call            z_1s
1811 020000   F     3843                                                     jmp             goto7
                    3844     
1814                3845     vvostad:                ;cjne           @r0,#61h
1814 7663           3846                                                     mov                     @r0,#63h
1816 900000   F     3847                                                     mov             dptr,#teMid;
1819 120000   F     3848                                                     call    lotext
181C 120000   F     3849                                                     call            vichmean
181F 020000   F     3850                                                     jmp             goto7
                    3851     
1822 020000   F     3852     rLABELP:                jmp                     LABELP
1825 78B1           3853     vvodm11_15:     mov                     r0,#vichR;vvod
1827 75B0F7         3854                                                     mov                     p3,#0f7h
182A 20B7F5         3855                                             jb                      p3.7,rLABELP;????
                    3856                                     
                    3857     
182D B61112         3858                                             cjne                    @r0,#11h,tome21
1830 7621           3859                                             mov                     @r0,#21h;vvod
1832 900000   F     3860                                             mov                     dptr,#teTE11
1835 120000   F     3861                                             call            lotext
1838 020000   F     3862                                             jmp                     onmem11
                    3863     
183B 16             3864     me11_15dec:             dec             @r0                             ;<-
183C 120000   F     3865     lokame1:        call            lomenu
183F 020000   F     3866                                             jmp                     onmem11
                    3867     
1842 B61206         3868     tome21:         cjne                    @r0,#12h,tome13
                    3869                                             ;вкл тест интерфейса
1845 020000   F     3870                                             jmp             testrs;??????????
1848 020000   F     3871                                             jmp                     onmem11
                    3872     
184B B61324         3873     tome13:         cjne                    @r0,#13h,tome14
184E 7631           3874                                             mov                     @r0,#31h
                    3875                                             
1850 7A50           3876                                             mov                     r2,#50h                    
                                  ;57.6->19.2
1852 7B2C           3877                                             mov                     r3,#2ch
1854 120454         3878                                             call            re4byte                 ;28..2bh 3b
                             ait-parol,1 bait skor
1857 E508           3879                                             mov                     a,r8
1859 B4000B         3880                                             cjne            a,#00,skor19
185C 900000   F     3881                                             mov                     dptr,#teS57_6;57,6
185F 120000   F     3882                                             call            lotext
1862 C213           3883                                             clr                     bitv19
                    3884     
1864 020000   F     3885                                             jmp             onmem11
1867 900000   F     3886     skor19:         mov                     dptr,#teS19_2
186A 120000   F     3887                                             call            lotext
186D D213           3888                                             setb            bitv19
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    62

                    3889             
186F 020000   F     3890                                             jmp                     onmem11
                    3891                                             
                    3892     
1872 B61415         3893     tome14:         cjne                    @r0,#14h,tome15
1875 D204           3894                                             setb            bitizm
1877 7881           3895                                             mov                     r0,#chavt
1879 7600           3896                                             mov                     @r0,#0
187B 08             3897                                             inc                     r0
187C 7600           3898                                             mov                     @r0,#0
187E C211           3899     outmenu:        clr                     bitmenu
1880 020000   F     3900                                             jmp                     out7
                    3901     
1883 78B1           3902     goparom:        mov             r0,#vichR               ;режим меню 52
1885 7652           3903                                             mov                     @r0,#52h                   
                                  ;пароль уже ввели
1887 020000   F     3904                                             jmp                     goparol
188A 2016F6         3905     tome15:         jb              bitpar,goparom  
188D 7651           3906                                             mov                     @r0,#51h;ПАРОЛЬ 000
188F 120000   F     3907                                             call            lomenu
1892 78B2           3908                                             mov                     r0,#marker
1894 7607           3909                                             mov                     @r0,#7
1896 753B09         3910                                             mov                     movrig,#9
1899 753A07         3911                                             mov                     movleft,#7
                    3912                                             ;setb           bitizm
189C 020000   F     3913                                             jmp                     onmem11
                    3914     
                    3915     
189F 78B1           3916     me21_23:        mov                     r0,#vichR               ;<-
18A1 7423           3917                                             mov                     a,#23h
18A3 C3             3918                                             clr                     c
18A4 96             3919                                             subb            a,@r0
18A5 403D           3920                                             jc                      labelS1
18A7 75B0FB         3921                                             mov                     p3,#0fbh
18AA 20B718         3922                                             jb                      p3.7,vv21_23
18AD B6210B         3923                                             cjne            @r0,#21h,me21_23dec;-<
18B0 7623           3924                                             mov                     @r0,#23h
18B2 900000   F     3925                                             mov                     dptr,#teTE7
18B5 120000   F     3926                                             call            lotext
18B8 020000   F     3927                                             jmp                     onmem11
18BB                3928     me21_23dec:     
18BB 16             3929                                             dec                     @r0
18BC 120000   F     3930                                             call            lomenu
18BF 020000   F     3931                                             jmp                     onmem11
18C2 020000   F     3932     onmem12:        jmp             outF    ;(ie7)                          
                    3933                                                     
18C5 75B0F7         3934     vv21_23:        mov             p3,#0f7h                ;vvod
18C8 20B7F7         3935                                             jb              p3.7,onmem12
18CB B6210C         3936                                             cjne            @r0,#21h,test22
                    3937                                             ;mov                    dptr,#tabt11;заслать ус 11А
18CE 120000   F     3938     tests:          call            lotpus
18D1 D215           3939                                             setb            biteizm;запомнить режим ТИ
18D3 D204           3940                                             setb            bitizm
18D5 C211           3941                                             clr                     bitmenu;обнулить т к не буд
                             ет индикации измерения       
18D7 020000   F     3942                                             jmp                     onmem11
18DA B62202         3943     test22:         cjne            @r0,#22h,test23
                    3944                                     ;       mov                     dptr,#tabt9;заслать ус 9А
18DD 80EF           3945                                             jmp             tests   
18DF                3946     test23:
                    3947                                     ;       mov                     dptr,#tabt7;заслать ус 7А
18DF 80ED           3948                                             jmp             tests   
18E1 020000   F     3949     left_s:         jmp                     left_sk
18E4 B63149         3950     labelS1:        cjne            @r0,#31h,me_41
18E7 75B0FB         3951                                             mov                     p3,#0fbh                   
                                  ;<-
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    63

18EA 30B7F4         3952                                             jnb                     p3.7,left_s
18ED 75B0F7         3953                                             mov                     p3,#0f7h
18F0 20B7CF         3954                                             jb                      p3.7,onmem12
                    3955                                             ;запомнить признак установленной скорости в рпзу
                    3956     
                    3957     ;чтение пам прогр(5000h) 1 страница(ffh)
                    3958     ;и запись во внешнее озу(0000h)
18F3 7900           3959                                             mov             r1,#0                   ;
18F5 7A50           3960                                     mov             r2,#50h
18F7 7B00           3961                                     mov             r3,#00
18F9 120499         3962                                     call    copyPP
                    3963                                     ;внести изменения во внешн озу
                    3964                                     ;KD=00 01 86 A0 (KD=1)
                    3965                                     ;кофф *100000 и переведенный в hex формат
                    3966                                     ;согласно адресов диапазонов и адресов яч вн озу 
18FC 792C           3967                                     mov             r1,#2ch
18FE 7400           3968                                     mov             a,#0;57,6
1900 301302         3969                                     jnb             bitv19,spwri
1903 7401           3970                                     mov             a,#1;19.6
1905 F3             3971     spwri:  movx    @r1,a
                    3972     ;стереть страницу пап прогр 
1906 905000         3973                                     mov             dptr,#5000h
1909 7FFF           3974                                     mov             r7,#0ffh
190B 12043E         3975                                     call    cle256
                    3976     ;и запись в ячейки кофф памяти прогр (3000h) 
190E 7FFF           3977                                     mov             r7,#0ffh
1910 7900           3978                                     mov             r1,#0                           ;external r
                             am
1912 905000         3979                                     mov             dptr,#5000h
1915 120480         3980                                     call    wrpage
                    3981             
1918 201305         3982                                     jb              bitv19,outsko1  ;загр Т1 в соотв с установл
                             енной скоростью
191B 758DF4         3983                                             mov                     TH1,#244                ;57
                             .6
191E 8003           3984                                             jmp                     outsko
1920 758DDC         3985     outsko1:                                        mov                     TH1,#220           
                                  ;19.6
1923 C211           3986     outsko:         clr             bitmenu
1925 D204           3987                                             setb            bitizm
1927 020000   F     3988                                             jmp                     out7
                    3989     
192A 020000   F     3990     rlabels4:               jmp             labels4
192D 020000   F     3991     rlabelS13:      jmp             labelS13
                    3992     
1930 B651F7         3993     me_41:          cjne            @r0,#51h,rlabels4
1933 75B0FB         3994                                             mov             p3,#0fbh;<-
1936 30B7F4         3995                                             jnb             p3.7,rlabelS13
1939 75B0F7         3996                                             mov             p3,#0f7h
193C 20B76D         3997                                             jb              p3.7,vvmenu
                    3998                                             ;ввод пароля
                    3999                                     
                    4000     ;       считать с индикатора 
193F 7F0E           4001                                     mov             r7,#14
1941 784F           4002                                     mov             r0,#abin
1943 120000   F     4003                                     call    clearN                  
                    4004                                     
                    4005     ;чтение номера байта с индикатора(3байта)
                    4006     ;bufind+3..bufind+9
                    4007     ;-  - - -
                    4008     ;- - - - - - - - - -
                    4009     ;adec..adec+9
                    4010     ;ст            мл
1946 7849           4011                                     mov             r0,#bufind+9;
1948 795C           4012                                     mov             r1,#adec+9
194A 7F03           4013                                     mov             r7,#3;3bait
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    64

194C C3             4014     upav1:          clr             c
194D E6             4015                                     mov             a,@r0
194E 9430           4016                                     subb    a,#30h
1950 F7             4017                                     mov             @r1,a
1951 18             4018                                     dec             r0
1952 19             4019                                     dec             r1
1953 DFF7           4020                                     djnz    r7,upav1;adec+7..adec+9
1955 7A50           4021                                             mov                     r2,#50h                    
                                  ;parol 000x    (5028h )
1957 7B28           4022                                             mov                     r3,#28h
1959 120454         4023                                             call            re4byte                 ;r8..r11(3 
                             bait parol)
195C 800F           4024     jmp                     goparol
195E E508           4025                                     mov                     a,r8                    ;сравнить п
                             ароль с индикатором
1960 B55A4C         4026                                     cjne            a,adec+7,parerr
1963 E509           4027                                     mov                     a,r9    
1965 B55B47         4028                                     cjne            a,adec+8,parerr
1968 E50A           4029                                     mov                     a,r10
196A B55C42         4030                                     cjne            a,adec+9,parerr
                    4031                                     ;равны
196D 78B1           4032     goparol:        mov             r0,#vichR               ;режим меню 52
196F 7652           4033                                             mov             @r0,#52h                ;0000-n
1971 900000   F     4034                                             mov             dptr,#teKD;00000-nA
1974 120000   F     4035                                             call            lotext
                    4036                                             ;;;;;;;;;
                    4037                                                     ;n(hex)->abin
1977 120000   F     4038                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
197A 2552           4039                                             add             a,abin+3
197C F552           4040                                             mov             abin+3,a
197E 7853           4041                                             mov             r0,#adec
1980 7952           4042                                             mov             r1,#abin+3      ;hex->10
1982 120000   F     4043                                             call    bindec
1985 855C48         4044                                             mov             bufind+8,adec+9
1988 75472D         4045                                             mov             bufind+7,#2dh
                    4046     
198B 79AE           4047                                             mov             r1,#diap
198D 7848           4048                                             mov             r0,#bufind+8
198F E7             4049                                             mov             a,@r1
1990 B40807         4050                                             cjne    a,#8,nodi8k
1993 7630           4051                                             mov             @r0,#30h                 ;10-10
1995 18             4052                                             dec             r0
1996 7663           4053                                             mov             @r0,#63h;31h
1998 8008           4054                                             jmp             nodisk9
199A B40905         4055     nodi8k:                         cjne    a,#9,nodisk9
                    4056                                     
199D 7631           4057                                             mov             @r0,#31h           ;10-11
199F 18             4058                                             dec             r0
19A0 7663           4059                                             mov             @r0,#63h;31h
                    4060                                     
                    4061     
19A2 78B2           4062     nodisk9:        mov                     r0,#marker
19A4 7601           4063                                             mov                     @r0,#1
19A6 753A01         4064                                             mov                     movleft,#1
19A9 753B05         4065                                             mov                     movrig,#5
                    4066                                             
19AC 020000   F     4067     vvmenu:         jmp             goto7
                    4068     
19AF 753932         4069     parerr:         mov                     nuerr,#32h
19B2 120000   F     4070                                             call            error
19B5 120000   F     4071                                             call            ind
19B8 120000   F     4072                                             call            z_1s
19BB C211           4073                                             clr                     bitmenu
19BD D204           4074                                             setb            bitizm
19BF 78B2           4075                                             mov                     r0,#marker
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    65

19C1 76FF           4076                                             mov                     @r0,#0ffh
19C3 020000   F     4077                                             jmp             goto7
                    4078     
19C6 30130B         4079     left_sk:                jnb                     bitv19,tosk19;<-
19C9 900000   F     4080                                             mov                     dptr,#teS57_6;57,6
19CC 120000   F     4081                                             call            lotext
19CF C213           4082                                             clr                     bitv19
19D1 020000   F     4083                                             jmp             out7
19D4 900000   F     4084     tosk19:         mov                     dptr,#teS19_2
19D7 120000   F     4085                                             call            lotext
19DA D213           4086                                             setb            bitv19
19DC 020000   F     4087                                             jmp             out7
                    4088     
19DF                4089     labelS13:;<- MENU(ПАРОЛЬ 000)
                    4090             
                    4091     ;;;;;;;;;;;;;;;;;;
                    4092     ;необходимо не портить цифру в следуюем справа знакоместе
                    4093     ;т е сохранить ее в ячейке для мигания в противном случае
                    4094     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4095     ;       знакоместа
19DF 78B2           4096                                     mov             r0,#marker
19E1 7440           4097                                     mov             a,#bufind
19E3 26             4098                                             add             a,@r0                   ;a=bufind+m
                             arker
19E4 F9             4099                                             mov             r1,a
19E5 19             4100                                             dec             r1;inc          r1
19E6 873C           4101                                             mov             savba,@r1
                    4102                                                     
19E8 78B2           4103                                                     mov             r0,#marker
19EA 16             4104                                                     dec             @r0                        
                                  
19EB C219           4105                                     clr             bitmig
19ED E53A           4106                                     mov                     a,movleft
19EF B6064F         4107                                     cjne    @r0,#6,onmem13;;нажата кн <- при вводе цифр ПАРОЛЬ 
                             000
19F2 06             4108                                     inc             @r0
19F3 020000   F     4109                                             jmp             goto7
                    4110     ;;;;;;;
                    4111     
19F6                4112     vvkali52:       ;введено значение для калибровки
                    4113                                             ;число на индикаторе ->Ak  (52h)
                    4114                                             ;       считать с индикатора 
19F6 7F0E           4115                                     mov             r7,#14
19F8 784F           4116                                     mov             r0,#abin
19FA 120000   F     4117                                     call    clearN                  
                    4118                                     
                    4119     ;чтение номера байта с индикатора(3байта)
                    4120     ;bufind+1..bufind+5
                    4121     ;-  - - -
                    4122     ;- - - - - - - - - -
                    4123     ;adec..adec+9
                    4124     ;ст            мл
19FD 7845           4125                                     mov             r0,#bufind+5;
19FF 795C           4126                                     mov             r1,#adec+9
1A01 7F05           4127                                     mov             r7,#5;5bait
1A03 C3             4128     upav2:          clr             c
1A04 E6             4129                                     mov             a,@r0
1A05 9430           4130                                     subb    a,#30h
1A07 F7             4131                                     mov             @r1,a
1A08 18             4132                                     dec             r0
1A09 19             4133                                     dec             r1
1A0A DFF7           4134                                     djnz    r7,upav2;adec+7..adec+9
                    4135     
1A0C 784F           4136                                     mov             r0,#abin
1A0E 7953           4137                                     mov             r1,#adec                        ;мл        
                              ст
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    66

1A10 120000   F     4138                                     call    decbin                  ;abin..abin+3 (hex)
1A13 120000   F     4139                                     call    loadr2                  ;r2..r5
1A16 120402         4140                                     call    altof   ;r2..r5->float
1A19 900000   F     4141                                     mov     dptr,#ch_10;10
1A1C 120000   F     4142                                     call    ldc_ltemp                       ;r8..r11=8
1A1F 120203         4143                                     call    flmul
1A22 78A4           4144                                     mov             r0,#rez_Ak
1A24 120000   F     4145                                     call    saver2
1A27 C211           4146                                             clr                     bitmenu
1A29 D212           4147                                             setb            bitklb
                    4148                                             ;зажечь KMП
1A2B D204           4149                                             setb            bitizm;бит калибровки уже установле
                             н
1A2D 78B2           4150                                             mov                     r0,#marker
1A2F 76FF           4151                                             mov                     @r0,#0ffh
1A31 783D           4152                                     mov             r0,#chkl
1A33 76FF           4153                                     mov             @r0,#0ffh
1A35 08             4154                                     inc             r0
1A36 76FF           4155                                     mov             @r0,#0ffh;38h
1A38 120000   F     4156                                     call            z_1s
1A3B 020000   F     4157                                     jmp             out7
                    4158     
                    4159     
1A3E 020000   F     4160                                             jmp             goto7
                    4161                                              
1A41 020000   F     4162     onmem13:        jmp             goto7   ;(ie7)
                    4163     
1A44 B642AF         4164     labels4:        cjne            @r0,#42h,vvkali52
1A47 75B0FB         4165                                             mov                     p3,#0fbh;<-
1A4A 30B7F4         4166                                             jnb             p3.7,onmem13
1A4D 75B0F7         4167                                             mov             p3,#0f7h;vvod
1A50 20B7EE         4168                                             jb              p3.7,onmem13
                    4169                                             
                    4170             
1A53 020000   F     4171     jmp             out7                                                    
                    4172     ;;;;;;;
1A56                4173     labelI:
1A56 75B0FE         4174                                     mov             p3,#0feh
1A59 E5B0           4175                                     mov             a,p3
1A5B 20E703         4176                                     jb              acc.7,nopoint
                    4177                                     ;
1A5E 020000   F     4178                                     jmp             goto7;out7
                    4179     
1A61 75B0FB         4180     nopoint:                mov             p3,#0fbh
1A64 E5B0           4181                                     mov             a,p3
1A66 20E72C         4182                                     jb              acc.7,nopoin7
1A69 78B2           4183     labelS3:mov             r0,#marker
1A6B E53A           4184                                     mov             a,movleft
1A6D B40309         4185                                     cjne    a,#3,poina1
1A70 B6030B         4186                                     cjne    @r0,#3,nomarl;26
                    4187                                     ;mov            @r0,#9
1A73 E53B           4188     poina2: mov                     a,movrig                ;кн <- B=+00000
1A75 F6             4189                                     mov                     @r0,a
1A76 020000   F     4190                                     jmp             goto7;  out7
                    4191     
1A79 B60402         4192     poina1:         cjne    @r0,#4,nomarl;кн <- A= 0000
1A7C 80F5           4193                                             jmp             poina2
                    4194     
                    4195     
1A7E                4196     nomarl:                 ;                               29.12.06
                    4197     ;;;;;;;;;;;;;;;;;;
                    4198     ;необходимо не портить цифру в следуюем справа знакоместе
                    4199     ;т е сохранить ее в ячейке для мигания в противном случае
                    4200     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4201     ;       знакоместа
1A7E 78B2           4202                                     mov             r0,#marker
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    67

1A80 7440           4203                                     mov             a,#bufind
1A82 26             4204                                             add             a,@r0                   ;a=bufind+m
                             arker
1A83 F9             4205                                             mov             r1,a
1A84 09             4206                                             inc             r1
1A85 873C           4207                                             mov             savba,@r1
                    4208                                                     
1A87 78B2           4209                                                     mov             r0,#marker
1A89 16             4210                                                     dec             @r0                        
                                  
1A8A C219           4211                                     clr             bitmig
1A8C E53A           4212                                     mov                     a,movleft
1A8E B40340         4213                                     cjne            a,#3,poinA
1A91 B60270         4214                                     cjne    @r0,#2,out7;;нажата кн <- при вводе цифр B=+00000
1A94 06             4215     poin3:  inc             @r0
                    4216     ;нажат ввод А =000000 запомнить константу А
1A95 75B0F7         4217     nopoin7:           mov          p3,#0f7h
1A98 E5B0           4218                                     mov             a,p3
1A9A 20E767         4219                                     jb              acc.7,out7
1A9D 78B1           4220                                     mov             r0,#vichR
1A9F E6             4221                                     mov             a,@r0
1AA0 B62133         4222                                     cjne    @r0,#21h,no21p7
1AA3 7611           4223                                     mov             @r0,#11h
                    4224                             ;       считать с индикатора  упаковать в плавающий формат
                    4225                             ;   сохранить
1AA5 7F0E           4226                                     mov             r7,#14
1AA7 784F           4227                                     mov             r0,#abin
1AA9 120000   F     4228                                     call    clearN                  
1AAC 120000   F     4229                                     call    upakA
                    4230                                     
1AAF 784F           4231                                     mov             r0,#abin
1AB1 7953           4232                                     mov             r1,#adec                        ;мл        
                              ст
1AB3 120000   F     4233                                     call    decbin                  ;abin..abin+3 (hex)
1AB6 120000   F     4234                                     call    loadr2                  ;r2..r5
1AB9 120402         4235                                     call    altof                   ;r2..r5->int
1ABC 78BC           4236                                     mov             r0,#konstA
1ABE 120000   F     4237                                     call    saver2
                    4238     ;26
1AC1 78B2           4239                                     mov             r0,#marker
1AC3 76FF           4240                                     mov             @r0,#0ffh
                    4241                                     
1AC5 900000   F     4242                                     mov             dptr,#teVICH;teBequ0
1AC8 120000   F     4243                                     call    lotext
                    4244                             ;       call            outB
1ACB 534BBF         4245                                     anl             bufind+11,#0bfh         ;гашение точки bufi
                             nd+7
                    4246                             ;       orl             bufind+11,#80h
1ACE 020000   F     4247                                     jmp             goto7;out7
                    4248     
1AD1 B60330         4249     poinA:          cjne    @r0,#3,out7;;нажата кн <- при вводе цифр A= 0000
1AD4 80BE           4250                                             jmp             poin3
                    4251     
1AD6                4252     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    4253                             ;   сохранить
1AD6 7F0E           4254                                     mov             r7,#14
1AD8 784F           4255                                     mov             r0,#abin
1ADA 120000   F     4256                                     call    clearN                  
1ADD 120000   F     4257                                     call    upakB                   
1AE0 784F           4258                                     mov             r0,#abin
1AE2 7953           4259                                     mov             r1,#adec                        ;мл        
                              ст
1AE4 120000   F     4260                                     call    decbin                  ;abin..abin+3 (hex)
1AE7 120000   F     4261                                     call    loadr2                  ;r2..r5
1AEA 120402         4262                                     call    altof                   ;r2..r5->int
1AED 301B04         4263                                     jnb             bitznB,pozB
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    68

1AF0 EA             4264                                     mov             a,r2
1AF1 4480           4265                                     orl             a,#80h
1AF3 FA             4266                                     mov             r2,a                    ;знак-
1AF4 78C0           4267     pozB:           mov             r0,#konstB
1AF6 120000   F     4268                                     call    saver2
                    4269     
1AF9 79B2           4270                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
1AFB 77FF           4271                                     mov             @r1,#0ffh
1AFD 78B1           4272                                     mov             r0,#vichR
1AFF 7611           4273                                     mov             @r0,#11h
1B01 020000   F     4274                               jmp           lovich     ;3.01.07ВЫЧИСЛИТЬ
                    4275                                     
                    4276     
1B04                4277     out7:                   ;mov            IE,#80h
1B04 D083           4278                                     pop             dph
1B06 D082           4279                                     pop             dpl
1B08 D007           4280                                     pop             rr7     
1B0A D006           4281                                     pop             rr6
1B0C D005           4282                                     pop             rr5
1B0E D004           4283                                     pop             rr4
1B10 D003           4284                                     pop             rr3
1B12 D002           4285                                     pop             rr2
1B14 D001           4286                                     pop             rr1                             
1B16 D000           4287                                     pop             rr0
1B18 D0D0           4288                                     pop             psw
1B1A D0E0           4289                                     pop             acc
1B1C 75AD00         4290                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1B1F 75B0C0         4291                             mov             P3,#0c0h
                    4292                             ;       mov             EIE2,#30H
1B22 C219           4293     clr             bitmig
1B24 E586           4294                                             mov             a,P6            ;p6.4=0
1B26 54EF           4295                             anl             a,#0efh
1B28 F586           4296                             mov             P6,a
1B2A 00             4297                             nop
1B2B 00             4298                             nop
                    4299                                     
1B2C E586           4300                             mov             a,P6                    ;p6.4=1 
1B2E 4410           4301                             orl             a,#10h
1B30 F586           4302                             mov             P6,a                        
1B32 32             4303                                     reti
                    4304     
                    4305     
                    4306                                     
                    4307     
                    4308     
1B33 78B1           4309     lomenu:         mov             r0,#vichR
1B35 B61107         4310                                             cjne    @r0,#11h,menu12
1B38 900000   F     4311                                             mov             dptr,#teTESI
1B3B 120000   F     4312     lome1:                  call    lotexT
1B3E 22             4313                                             ret
1B3F B61205         4314     menu12:         cjne    @r0,#12h,menu13
1B42 900000   F     4315                                             mov             dptr,#teTESR
1B45 80F4           4316                                             jmp             lome1
1B47 B61305         4317     menu13:         cjne    @r0,#13h,menu14
1B4A 900000   F     4318                                             mov             dptr,#teSKOR
1B4D 80EC           4319                                             jmp             lome1
1B4F B61405         4320     menu14:         cjne    @r0,#14h,menu15
1B52 900000   F     4321                                             mov             dptr,#teAVK
1B55 80E4           4322                                             jmp             lome1
1B57 B61505         4323     menu15:                 cjne    @r0,#15h,menu21
1B5A 900000   F     4324                                             mov             dptr,#teKALIB
1B5D 80DC           4325                                             jmp             lome1
                    4326     
1B5F B62105         4327     menu21: cjne    @r0,#21h,menu22
1B62 900000   F     4328                                             mov             dptr,#teTE11
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    69

1B65 80D4           4329                                             jmp             lome1
1B67 B62205         4330     menu22:         cjne    @r0,#22h,menu23
1B6A 900000   F     4331                                             mov             dptr,#teTE9
1B6D 80CC           4332                                             jmp             lome1
1B6F B62305         4333     menu23:         cjne    @r0,#23h,menu31
1B72 900000   F     4334                                             mov             dptr,#teTE7
1B75 80C4           4335                                             jmp             lome1
1B77 B63105         4336     menu31:         cjne    @r0,#31h,menu41
1B7A 900000   F     4337                                             mov             dptr,#teS57_6
1B7D 80BC           4338                                             jmp             lome1
                    4339     
1B7F                4340     menu41:         
1B7F 900000   F     4341                                             mov             dptr,#tePAR
1B82 80B7           4342                                             jmp             lome1
                    4343     
1B84 020000   F     4344     yesvi_kr:               jmp                     yesvi_km
1B87                4345     endkalib:;KD=Ak/A3
1B87 200DFA         4346                                             jb                      bifl_kt,yesvi_kr;выч кофф К
                             м
1B8A 789C           4347                                             mov                     r0,#rez_A3
1B8C 120000   F     4348                                             call            resar2
                    4349                                     
1B8F 120402         4350                                     call    altof                   ;->float
1B92 EA             4351                                             mov                     a,r2
1B93 547F           4352                                             anl                     a,#7fh
1B95 FA             4353                                             mov                     r2,a
1B96 120000   F     4354                                     call            move28
1B99 78A4           4355                                             mov                     r0,#rez_Ak
1B9B 120000   F     4356                                             call            resar2
1B9E 1202B7         4357                                             call            fldiv
                    4358                                                     
1BA1 900000   F     4359                                     mov     dptr,#CHtho;100000
1BA4 120000   F     4360                                     call    ldc_ltemp                       ;r8..r11=8
1BA7 120203         4361                                     call    flmul
1BAA 120343         4362                                     call    ftol            ;r2..r5->hex кофф KD (РЕЗ ИЗМ ЧИСЛО
                              6разрядное)
                    4363     
1BAD 78A0           4364                                             mov                     r0,#koefKD
1BAF 120000   F     4365                                             call            saver2
                    4366                                             ;запись в рпзу в соотв ячейку
                    4367                             
1BB2 7900           4368                                             mov             r1,#0                   ;счит рпзу 
                             во внешн озу
1BB4 7A50           4369                                     mov             r2,#50h
1BB6 7B00           4370                                     mov             r3,#00
1BB8 120499         4371                                     call    copyPP
                    4372                                     ;внести изменения во внешн озу
1BBB 120000   F     4373                                     call            findext                 ;r1-внешн озу
1BBE 78A0           4374                                     mov                     r0,#koefKD
1BC0 120000   F     4375                                             call            resar2
1BC3 EA             4376                                             mov                     a,r2
1BC4 F3             4377                                             movx            @r1,a
1BC5 09             4378                                             inc                     r1
1BC6 EB             4379                                             mov                     a,r3
1BC7 F3             4380                                             movx            @r1,a
1BC8 09             4381                                             inc                     r1
1BC9 EC             4382                                             mov                     a,r4
1BCA F3             4383                                             movx            @r1,a
1BCB 09             4384                                             inc                     r1
1BCC ED             4385                                             mov                     a,r5
1BCD F3             4386                                             movx            @r1,a
                    4387                                     ;кофф *100000 и переведенный в hex формат
                    4388                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4389     ;стереть страницу пап прогр 
1BCE 905000         4390                                     mov             dptr,#5000h
1BD1 7FFF           4391                                     mov             r7,#0ffh
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    70

1BD3 12043E         4392                                     call    cle256
                    4393     ;и запись в ячейки кофф памяти прогр (3000h) 
1BD6 7FFF           4394                                     mov             r7,#0ffh
1BD8 7900           4395                                     mov             r1,#0                           ;external r
                             am
1BDA 905000         4396                                     mov             dptr,#5000h
1BDD 120480         4397                                     call    wrpage
                    4398     ;2.2.07
1BE0 79AE           4399                                     mov                     r1,#diap
1BE2 B70511         4400                                     cjne            @r1,#5,fulkalib
                    4401                                     ;jb                     bifl_kt,yesvi_km;выч кофф Км
1BE5 D20D           4402                                     setb            bifl_kt
                    4403                                     ;call           loadus
1BE7 900000   F     4404                                     mov                     dptr,#tabt7;заслать ус 7А       
1BEA E4             4405                             clr             a
1BEB 93             4406                             movc    a,@a+dptr                               ;high byte
1BEC F584           4407                             mov             p4,a
1BEE A3             4408                             inc             dptr
1BEF E4             4409                             clr             a
1BF0 93             4410                             movc    a,@a+dptr                               ;low byte
1BF1 F585           4411                             mov             p5,a
1BF3 020000   F     4412                                     jmp             goto7;  out_kali
                    4413     
                    4414     ;;;
1BF6                4415     fulkalib:
1BF6 C212           4416                                             clr             bitklb
1BF8 D216           4417                                             setb    bitpar                  ;пароль провели 1 р
                             аз успешно
1BFA 900000   F     4418                                             mov             dptr,#teEND
1BFD 120000   F     4419                                             call    lotext
1C00 120000   F     4420                                             call    ind
1C03 120000   F     4421     out_kali:       call    z_1s
1C06 120000   F     4422                                             call    z_1s
1C09 020000   F     4423                                             jmp             goto7
1C0C                4424     yesvi_km:               ;выч кофф Км=(10**5/A2)*K7/K5
1C0C 7A50           4425                                     mov                     r2,#50h                 ;-11a
1C0E 7B14           4426                                     mov                     r3,#14h                 ;k7
1C10 12046C         4427                                     call            rebyte2                         ;r2..r5- he
                             x
1C13 120402         4428                                     call            altof                   ;r2..r5->float
1C16 C002           4429                                     push            rr2
1C18 C003           4430                                     push            rr3
1C1A C004           4431                                     push            rr4
1C1C C005           4432                                     push            rr5
1C1E 7A50           4433                                     mov                     r2,#50h                 ;k5
1C20 7B0C           4434                                     mov                     r3,#0ch
1C22 12046C         4435                             call            rebyte2                 ;r2..r5
1C25 120402         4436                                     call            altof                   ;r2..r5->float
1C28 120000   F     4437                                     call            move28
1C2B D005           4438                                     pop                     rr5
1C2D D004           4439                                     pop                     rr4
1C2F D003           4440                                     pop                     rr3
1C31 D002           4441                                     pop                     rr2
1C33 1202B7         4442                                     call            fldiv                   ;K7/K5
                    4443     
1C36 900000   F     4444                                     mov     dptr,#CHtho;100000
1C39 120000   F     4445                                     call    ldc_ltemp                       ;r8..r11=8
1C3C 120203         4446                                     call    flmul                           ;r2..r5 ;K7/K5*10**
                             5
1C3F C002           4447                                     push            rr2
1C41 C003           4448                                     push            rr3
1C43 C004           4449                                     push            rr4
1C45 C005           4450                                     push            rr5
                    4451                                     
1C47 789C           4452                                     mov                     r0,#rez_A3
1C49 120000   F     4453                                     call            resar2
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    71

1C4C 120402         4454                                     call            altof                           ;r2..r5->fl
                             oat
1C4F 120000   F     4455                                     call            move28
1C52 D005           4456                                     pop                     rr5
1C54 D004           4457                                     pop                     rr4
1C56 D003           4458                                     pop                     rr3
1C58 D002           4459                                     pop                     rr2
1C5A 1202B7         4460                               call          fldiv           ;Km     
                    4461     
1C5D 900000   F     4462                                     mov     dptr,#CHtho;100000
1C60 120000   F     4463                                     call    ldc_ltemp                       ;r8..r11=8
1C63 120203         4464                                     call    flmul                           ;r2..r5
1C66 120343         4465                                     call    ftol                    ;r2..r5->hex кофф Km(РЕЗ ИЗ
                             М ЧИСЛО 6разрядное)
1C69 78A0           4466                                     mov                     r0,#koefKD;2ое исп ячейки koefKD
1C6B 120000   F     4467                                     call            saver2
                    4468                                     ;запись в рпзу в соотв ячейку
1C6E 7900           4469                                     mov             r1,#0                   ;счит рпзу во внешн
                              озу
1C70 7A50           4470                                     mov             r2,#50h
1C72 7B00           4471                                     mov             r3,#00
1C74 120499         4472                                     call    copyPP
                    4473                                     ;внести изменения во внешн озу
1C77 78A0           4474                                     mov                     r0,#koefKD
1C79 120000   F     4475                                     call            resar2
1C7C 792C           4476                                     mov                     r1,#2ch                 ;r1-внешн о
                             зу кофф Km
                    4477                             
1C7E EA             4478                                     mov                     a,r2
1C7F F3             4479                                             movx            @r1,a
1C80 09             4480                                             inc                     r1
1C81 EB             4481                                             mov                     a,r3
1C82 F3             4482                                             movx            @r1,a
1C83 09             4483                                             inc                     r1
1C84 EC             4484                                             mov                     a,r4
1C85 F3             4485                                             movx            @r1,a
1C86 09             4486                                             inc                     r1
1C87 ED             4487                                             mov                     a,r5
1C88 F3             4488                                             movx            @r1,a
                    4489                                     ;кофф *100000 и переведенный в hex формат
                    4490                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4491     ;стереть страницу пап прогр 
1C89 905000         4492                                     mov             dptr,#5000h
1C8C 7FFF           4493                                     mov             r7,#0ffh
1C8E 12043E         4494                                     call    cle256
                    4495     ;и запись в ячейки кофф памяти прогр (3000h) 
1C91 7FFF           4496                                     mov             r7,#0ffh
1C93 7900           4497                                     mov             r1,#0                           ;external r
                             am
1C95 905000         4498                                     mov             dptr,#5000h
1C98 120480         4499                                     call    wrpage
                    4500     
1C9B C20D           4501                                             clr             bifl_kt
1C9D 120000   F     4502                                             call    loadus
1CA0 020000   F     4503                                             jmp             fulkalib
                    4504     
                    4505     ;выч среднего по блоку
                    4506     ;вых r2..r5
1CA3                4507     vichmean:       
1CA3 120000   F     4508                                             call            resa_hl;save_bl->dptr
1CA6 78D7           4509                                             mov                     r0,#copy_hl
1CA8 E583           4510                                             mov                     a,dph
1CAA F6             4511                                             mov                     @r0,a
1CAB 08             4512                                             inc                     r0
1CAC E582           4513                                             mov                     a,dpl
1CAE F6             4514                                             mov                     @r0,a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    72

1CAF 78B8           4515                                             mov                     r0,#work
1CB1 120000   F     4516                                             call            clear4
1CB4 78D6           4517                                             mov                     r0,#chblok;volume
1CB6 7600           4518                                             mov                     @r0,#0
1CB8 120000   F     4519     meng:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1CBB E582           4520                                             mov                     a,dpl
1CBD FF             4521                                             mov                     r7,a
1CBE E583           4522                                             mov                     a,dph
1CC0 FE             4523                                             mov                     r6,a
                    4524     
1CC1 78D7           4525                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1CC3 E6             4526                                             mov                     a,@r0
1CC4 F583           4527                                             mov                     dph,a
1CC6 08             4528                                             inc                     r0
1CC7 E6             4529                                             mov                     a,@r0
1CC8 F582           4530                                             mov                     dpl,a
                    4531                                             
1CCA C3             4532                                             clr                     c;-4
1CCB E582           4533                                             mov                     a,dpl
1CCD 9404           4534                                             subb            a,#4
1CCF F582           4535                                             mov                     dpl,a
1CD1 E583           4536                                             mov                     a,dph
1CD3 9400           4537                                             subb            a,#0
1CD5 F583           4538                                             mov                     dph,a;dptr-4
                    4539                                             ;;;;;;;;
1CD7 79D7           4540                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1CD9 E583           4541                                                     mov             a,dph
1CDB F7             4542                                               mov           @r1,a
1CDC 09             4543                                                     inc             r1
1CDD E582           4544                                                     mov             a,dpl
1CDF F7             4545                                                     mov             @r1,a
                    4546                                                     ;;;;;;;;;
1CE0 C3             4547                                                     clr             c;пришли в начало блока?
1CE1 E582           4548                                                     mov                     a,dpl
1CE3 9F             4549                                                     subb            a,r7
1CE4 FF             4550                                                     mov                     r7,a
1CE5 7006           4551                                                     jnz                     nextmea
1CE7 E583           4552                                                     mov                     a,dph
1CE9 9E             4553                                                     subb            a,r6
1CEA FE             4554                                                     mov                     r6,a
1CEB 601B           4555                                                     jz                      outmea;
                    4556                                                     
                    4557                                                     ;продолжаем сравнение
                    4558                                                     ;;;;;;;;;;;             
1CED 120000   F     4559     nextmea:                call            loahl_r2        ;из яч внешн озу ->r2..r5
1CF0 120402         4560                                             call            altof;->float
1CF3 120000   F     4561                                             call            move28                  ;r8..r11
1CF6 78B8           4562                                             mov                     r0,#work
1CF8 120000   F     4563                                             call            resar2
1CFB 120166         4564                                             call            fladd
1CFE 78B8           4565                                             mov                     r0,#work
1D00 120000   F     4566                                             call            saver2
1D03 78D6           4567                                             mov                     r0,#chblok;volume;кол измер
                             ений блока
1D05 06             4568                                             inc                     @r0
1D06 80B0           4569                                             jmp                     meng
1D08                4570     outmea:         
1D08 120000   F     4571                                             call            loahl_r2        ;из яч внешн озу ->
                             r2..r5
1D0B 120402         4572                                             call            altof;->float
1D0E 120000   F     4573                                             call            move28                  ;r8..r11
1D11 78B8           4574                                             mov                     r0,#work
1D13 120000   F     4575                                             call            resar2
1D16 120166         4576                                             call            fladd
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    73

1D19 78B8           4577                                             mov                     r0,#work
1D1B 120000   F     4578                                             call            saver2
1D1E E4             4579                                             clr                     a
1D1F FA             4580                                             mov                     r2,a
1D20 FB             4581                                             mov                     r3,a
1D21 FC             4582                                             mov                     r4,a
1D22 78D6           4583                                             mov                     r0,#chblok;volume;кол измер
                             ений блока...200d
1D24 E6             4584                                             mov                     a,@r0
1D25 2401           4585                                             add                     a,#1
1D27 FD             4586                                             mov                     r5,a
1D28 120402         4587                                             call            altof;r2..r5 float
1D2B 120000   F     4588                                             call            move28
1D2E 78B8           4589                                             mov                     r0,#work
1D30 120000   F     4590                                             call            resar2
1D33 1202B7         4591                                             call            fldiv
1D36 900000   F     4592                                             mov                     dptr,#ch_10      
1D39 120000   F     4593                                     call            ldc_ltemp
1D3C 1202B7         4594                                     call            fldiv
1D3F 120343         4595                                             call            ftol                            ;->
                             hex
1D42 120000   F     4596                                             call    maform
1D45 784F           4597                                             mov             r0,#abin
1D47 120000   F     4598                                             call    saver2
                    4599     ;;;;;;;;
                    4600                                             
1D4A 7853           4601                                             mov             r0,#adec
1D4C 7952           4602                                             mov             r1,#abin+3      ;hex->10
1D4E 120000   F     4603                                             call    bindec
                    4604                                     
1D51 785C           4605                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1D53 7949           4606                                             mov             r1,#bufind+9
1D55 7F05           4607                                             mov             r7,#5
1D57 E6             4608     bufmea:                         mov             a,@r0
1D58 2430           4609                                             add             a,#30h
1D5A F7             4610                                             mov             @r1,a
1D5B 19             4611                                             dec             r1
1D5C 18             4612                                             dec             r0
1D5D DFF8           4613                                             djnz    r7,bufmea
1D5F 7844           4614                                             mov             r0,#bufind+4
1D61 762B           4615                                             mov             @r0,#2bh          
1D63 300202         4616                                             jnb             znmat,nozmea
1D66 762D           4617                                             mov             @r0,#2dh
1D68 434B05         4618     nozmea:         orl             bufind+11,#05h
1D6B 22             4619                                             ret
                    4620     
                    4621     
1D6C E0             4622     loahl_r2:       movx            a,@dptr         ;из яч внешн озу ->r2..r5
1D6D FA             4623                                             mov                     r2,a
1D6E A3             4624                                             inc                     dptr
1D6F E0             4625                                             movx            a,@dptr
1D70 FB             4626                                             mov                     r3,a
1D71 A3             4627                                             inc                     dptr
1D72 E0             4628                                             movx            a,@dptr
1D73 FC             4629                                             mov                     r4,a
1D74 A3             4630                                             inc                     dptr
1D75 E0             4631                                             movx            a,@dptr
1D76 FD             4632                                             mov                     r5,a    
1D77 22             4633                                             ret
                    4634     
1D78 C3             4635     min4_hl:        clr                     c;-4
1D79 E582           4636                                             mov                     a,dpl
1D7B 9404           4637                                             subb            a,#4
1D7D F582           4638                                             mov                     dpl,a
1D7F E583           4639                                             mov                     a,dph
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    74

1D81 9400           4640                                             subb            a,#0
1D83 F583           4641                                             mov                     dph,a;dptr-4
1D85 22             4642                                             ret
                    4643     
                    4644     ;мин значение по по блоку
1D86                4645     vichmin:        
1D86 120000   F     4646                                             call            resa_hl;save_bl->dptr
                    4647                                                                                     
                    4648     ;с конца блока адрес 2го измерение
1D89 120000   F     4649                                             call            min4_hl
                    4650                                             
1D8C 78B8           4651                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4652                                             
1D8E E0             4653                                             movx            a,@dptr
1D8F F6             4654                                             mov                     @r0,a
1D90 08             4655                                             inc                     r0
1D91 A3             4656                                             inc                     dptr
1D92 E0             4657                                             movx            a,@dptr
1D93 F6             4658                                             mov                     @r0,a
1D94 08             4659                                             inc                     r0
1D95 A3             4660                                             inc                     dptr
1D96 E0             4661                                             movx            a,@dptr
1D97 F6             4662                                             mov                     @r0,a
1D98 08             4663                                             inc                     r0
1D99 A3             4664                                             inc                     dptr
1D9A E0             4665                                             movx            a,@dptr
1D9B F6             4666                                             mov                     @r0,a
1D9C A3             4667                                             inc                     dptr
                    4668                                             
1D9D 78B8           4669                                             mov                     r0,#work
1D9F 120000   F     4670                                             call            resar2
1DA2 120402         4671                                             call            altof;->float;r2..r5
1DA5 78B8           4672                                             mov                     r0,#work
1DA7 120000   F     4673                                             call            saver2
                    4674     
1DAA 120000   F     4675                                             call            min4_hl
                    4676                                             ;call           min4_hl
                    4677     
1DAD 78D7           4678                                             mov                     r0,#copy_hl
1DAF E583           4679                                             mov                     a,dph
1DB1 F6             4680                                             mov                     @r0,a
1DB2 08             4681                                             inc                     r0
1DB3 E582           4682                                             mov                     a,dpl
1DB5 F6             4683                                             mov                     @r0,a
                    4684                                     
1DB6 78D6           4685                                             mov                     r0,#chblok;volume
1DB8 7600           4686                                             mov                     @r0,#0
1DBA 120000   F     4687     ming:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1DBD E582           4688                                             mov                     a,dpl
1DBF FF             4689                                             mov                     r7,a
1DC0 E583           4690                                             mov                     a,dph
1DC2 FE             4691                                             mov                     r6,a
                    4692     
1DC3 78D7           4693                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1DC5 E6             4694                                             mov                     a,@r0
1DC6 F583           4695                                             mov                     dph,a
1DC8 08             4696                                             inc                     r0
1DC9 E6             4697                                             mov                     a,@r0
1DCA F582           4698                                             mov                     dpl,a
                    4699                                             
1DCC C3             4700                                             clr                     c;-4
1DCD E582           4701                                             mov                     a,dpl
1DCF 9404           4702                                             subb            a,#4
1DD1 F582           4703                                             mov                     dpl,a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    75

1DD3 E583           4704                                             mov                     a,dph
1DD5 9400           4705                                             subb            a,#0
1DD7 F583           4706                                             mov                     dph,a;dptr-4
                    4707                                             ;;;;;;;;
1DD9 79D7           4708                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1DDB E583           4709                                                     mov             a,dph
1DDD F7             4710                                               mov           @r1,a
1DDE 09             4711                                                     inc             r1
1DDF E582           4712                                                     mov             a,dpl
1DE1 F7             4713                                                     mov             @r1,a
                    4714                                                     ;;;;;;;;;
1DE2 C3             4715                                                     clr             c;пришли в начало блока?
1DE3 E582           4716                                                     mov                     a,dpl
1DE5 9F             4717                                                     subb            a,r7
1DE6 FF             4718                                                     mov                     r7,a
1DE7 7006           4719                                                     jnz                     nextmin
1DE9 E583           4720                                                     mov                     a,dph
1DEB 9E             4721                                                     subb            a,r6
1DEC FE             4722                                                     mov                     r6,a
1DED 601D           4723                                                     jz                      outmin;
                    4724                                                     
                    4725                                                     ;продолжаем сравнение
                    4726                                                     ;;;;;;;;;;;             
1DEF 78B8           4727     nextmin:        mov                     r0,#work
1DF1 120000   F     4728                                             call            resar2
                    4729                                             ;call           altof;->float;r2..r5
1DF4 120000   F     4730                                             call            move28;->r8..r11
1DF7 120000   F     4731                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4732     
1DFA 120402         4733                                             call            altof;->float;r2..r5
                    4734                                             
1DFD 1201D6         4735                                             call            flcmp
1E00 5005           4736                                             jnc                     nomini
1E02 78B8           4737                                             mov                     r0,#work;<
1E04 120000   F     4738                                             call            saver2;r2..r5
1E07 78D6           4739     nomini:                 mov                     r0,#chblok;volume;кол измерений блока
1E09 06             4740                                             inc                     @r0
1E0A 80AE           4741                                             jmp                     ming
                    4742     
1E0C 78B8           4743     outmin:         mov                     r0,#work;1ое измерение блока
1E0E 120000   F     4744                                             call            resar2
                    4745                                     ;       call            altof;->float;r2..r5
1E11 120000   F     4746                                             call            move28;->r8..r11
1E14 120000   F     4747                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4748     
1E17 120402         4749                                             call            altof;->float;r2..r5
                    4750                                             
1E1A 1201D6         4751                                             call            flcmp
1E1D 5005           4752                                             jnc                     minivix
1E1F 78B8           4753                                             mov                     r0,#work;<
1E21 120000   F     4754                                             call            saver2;r2..r5
                    4755                                             ;;;;;;;;;
                    4756     
1E24 78B8           4757     minivix:        mov                     r0,#work
1E26 120000   F     4758                                             call            resar2
                    4759     
                    4760                                             ;call           altof;->float
                    4761                                     
1E29 900000   F     4762                                             mov                     dptr,#ch_10      
1E2C 120000   F     4763                                             call            ldc_ltemp
1E2F 1202B7         4764                                             call            fldiv
1E32 120343         4765                                             call            ftol                            ;->
                             hex
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    76

                    4766                                             ;;;
1E35 120000   F     4767                                             call            maform
1E38 784F           4768                                             mov                     r0,#abin
1E3A 120000   F     4769                                             call            saver2
                    4770     ;;;;;;;;
                    4771                                             
1E3D 7853           4772                                             mov             r0,#adec
1E3F 7952           4773                                             mov             r1,#abin+3      ;hex->10
1E41 120000   F     4774                                             call    bindec
                    4775                                     
1E44 785C           4776                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1E46 7949           4777                                             mov             r1,#bufind+9
1E48 7F05           4778                                             mov             r7,#5
1E4A E6             4779     bufmin:                         mov             a,@r0
1E4B 2430           4780                                             add             a,#30h
1E4D F7             4781                                             mov             @r1,a
1E4E 19             4782                                             dec             r1
1E4F 18             4783                                             dec             r0
1E50 DFF8           4784                                             djnz    r7,bufmin
1E52 7844           4785                                             mov             r0,#bufind+4
1E54 762B           4786                                             mov             @r0,#2bh          
1E56 300202         4787                                             jnb             znmat,nozmin
1E59 762D           4788                                             mov             @r0,#2dh
1E5B 434B05         4789     nozmin:         orl             bufind+11,#05h
1E5E 22             4790                                             ret
                    4791     
                    4792     
                    4793     
                    4794     ;мин значение по по блоку
1E5F                4795     vichmax:        
1E5F 120000   F     4796                                             call            resa_hl;save_bl->dptr
                    4797                                             
                    4798                                             
                    4799     ;с конца блока адрес 2го измерение
1E62 120000   F     4800                                             call            min4_hl
                    4801                                             
1E65 78B8           4802                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4803                                             
1E67 E0             4804                                             movx            a,@dptr
1E68 F6             4805                                             mov                     @r0,a
1E69 08             4806                                             inc                     r0
1E6A A3             4807                                             inc                     dptr
1E6B E0             4808                                             movx            a,@dptr
1E6C F6             4809                                             mov                     @r0,a
1E6D 08             4810                                             inc                     r0
1E6E A3             4811                                             inc                     dptr
1E6F E0             4812                                             movx            a,@dptr
1E70 F6             4813                                             mov                     @r0,a
1E71 08             4814                                             inc                     r0
1E72 A3             4815                                             inc                     dptr
1E73 E0             4816                                             movx            a,@dptr
1E74 F6             4817                                             mov                     @r0,a
1E75 A3             4818                                             inc                     dptr
                    4819                                             
1E76 78B8           4820                                             mov                     r0,#work
1E78 120000   F     4821                                             call            resar2
1E7B 120402         4822                                             call            altof;->float;r2..r5
1E7E 78B8           4823                                             mov                     r0,#work
1E80 120000   F     4824                                             call            saver2
                    4825     
1E83 120000   F     4826                                             call            min4_hl
                    4827                                     ;       call            min4_hl
                    4828     
1E86 78D7           4829                                             mov                     r0,#copy_hl
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    77

1E88 E583           4830                                             mov                     a,dph
1E8A F6             4831                                             mov                     @r0,a
1E8B 08             4832                                             inc                     r0
1E8C E582           4833                                             mov                     a,dpl
1E8E F6             4834                                             mov                     @r0,a
                    4835                                     
1E8F 78D6           4836                                             mov                     r0,#chblok;volume
1E91 7600           4837                                             mov                     @r0,#0
1E93 120000   F     4838     maxg:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1E96 E582           4839                                             mov                     a,dpl
1E98 FF             4840                                             mov                     r7,a
1E99 E583           4841                                             mov                     a,dph
1E9B FE             4842                                             mov                     r6,a
                    4843     
1E9C 78D7           4844                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1E9E E6             4845                                             mov                     a,@r0
1E9F F583           4846                                             mov                     dph,a
1EA1 08             4847                                             inc                     r0
1EA2 E6             4848                                             mov                     a,@r0
1EA3 F582           4849                                             mov                     dpl,a
                    4850                                             
1EA5 C3             4851                                             clr                     c;-4
1EA6 E582           4852                                             mov                     a,dpl
1EA8 9404           4853                                             subb            a,#4
1EAA F582           4854                                             mov                     dpl,a
1EAC E583           4855                                             mov                     a,dph
1EAE 9400           4856                                             subb            a,#0
1EB0 F583           4857                                             mov                     dph,a;dptr-4
                    4858                                             ;;;;;;;;
1EB2 79D7           4859                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1EB4 E583           4860                                                     mov             a,dph
1EB6 F7             4861                                               mov           @r1,a
1EB7 09             4862                                                     inc             r1
1EB8 E582           4863                                                     mov             a,dpl
1EBA F7             4864                                                     mov             @r1,a
                    4865                                                     ;;;;;;;;;
1EBB C3             4866                                                     clr             c;пришли в начало блока?
1EBC E582           4867                                                     mov                     a,dpl
1EBE 9F             4868                                                     subb            a,r7
1EBF FF             4869                                                     mov                     r7,a
1EC0 7006           4870                                                     jnz                     nextmax
1EC2 E583           4871                                                     mov                     a,dph
1EC4 9E             4872                                                     subb            a,r6
1EC5 FE             4873                                                     mov                     r6,a
1EC6 601D           4874                                                     jz                      outmax;
                    4875                                                     
                    4876                                                     ;продолжаем сравнение
                    4877                                                     ;;;;;;;;;;;             
1EC8 78B8           4878     nextmax:        mov                     r0,#work
1ECA 120000   F     4879                                             call            resar2
                    4880                                             ;call           altof;->float;r2..r5
1ECD 120000   F     4881                                             call            move28;->r8..r11
1ED0 120000   F     4882                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4883     
1ED3 120402         4884                                             call            altof;->float;r2..r5
                    4885                                             
1ED6 1201D6         4886                                             call            flcmp
1ED9 4005           4887                                             jc                      nomaxi
1EDB 78B8           4888                                             mov                     r0,#work;>
1EDD 120000   F     4889                                             call            saver2;r2..r5
1EE0 78D6           4890     nomaxi:                 mov                     r0,#chblok;volume;кол измерений блока
1EE2 06             4891                                             inc                     @r0
1EE3 80AE           4892                                             jmp                     maxg
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    78

1EE5 78B8           4893     outmax:         mov                     r0,#work;1ое измерение блока
1EE7 120000   F     4894                                             call            resar2
                    4895                                     ;       call            altof;->float;r2..r5
1EEA 120000   F     4896                                             call            move28;->r8..r11
1EED 120000   F     4897                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4898     
1EF0 120402         4899                                             call            altof;->float;r2..r5
                    4900                                             
1EF3 1201D6         4901                                             call            flcmp
1EF6 4005           4902                                             jc                      maxvix
1EF8 78B8           4903                                             mov                     r0,#work;>
1EFA 120000   F     4904                                             call            saver2;r2..r5
                    4905                                             ;;;;;;;;;
                    4906     
1EFD 020000   F     4907     maxvix:         jmp             minivix
                    4908     
                    4909     
                    4910     
                    4911     ;$include (d:\amp\subr5.asm) 
                +1  4912     ;
                +1  4913     ;goprogr:       jmp     izm
                +1  4914     ;тест интерфейса
1F00            +1  4915     testrs: ;jb     p0.3,goprogr
1F00 C2AC       +1  4916                                     clr     IE.4
1F02 759955     +1  4917     test1:  mov     SBUF0,#55h
1F05 3099FD     +1  4918                                     jnb     SCON0.1,$
1F08 78B8       +1  4919                                     mov     r0,#work;chtest
1F0A 76BE       +1  4920                                     mov     @r0,#190d;60
                +1  4921     
1F0C 309825     +1  4922     test01: jnb     SCON0.0,test2
1F0F E599       +1  4923                                     mov     a,SBUF0
1F11 B45512     +1  4924                                     cjne    a,#55h,test3
1F14 C299       +1  4925     test4:  clr     SCON0.1
1F16 C298       +1  4926                                     clr     SCON0.0
1F18 7D0A       +1  4927                                     mov     r5,#10
1F1A 7840       +1  4928                                     mov     r0,#bufind              ;- - - -
1F1C 762D       +1  4929     test04: mov     @r0,#2dh
1F1E 08         +1  4930                                     inc     r0
1F1F DDFB       +1  4931                                     djnz    r5,test04
1F21 120000   F +1  4932                                     call    ind
1F24 80DC       +1  4933                                     jmp     test1
1F26            +1  4934     test3:  
1F26 753933     +1  4935                                     mov     nuerr,#33h
1F29 120000   F +1  4936                                     call    error           ;на кран прибора ERR 3
                +1  4937                             
1F2C 120000   F +1  4938                                     call    ind;
1F2F 120000   F +1  4939                                     call    z_01s           ;100ms
1F32 80E0       +1  4940                                     jmp     test4
1F34 78B8       +1  4941     test2:  mov     r0,#work;chtest
1F36 B60002     +1  4942                                     cjne    @r0,#0,test02
1F39 8003       +1  4943                                     jmp     test5
1F3B 16         +1  4944     test02: dec     @r0
1F3C 80CE       +1  4945                                     jmp     test01
1F3E 120000   F +1  4946     test5:  call    z_1ms           ;1ms
1F41 C299       +1  4947                                     clr     SCON0.1
                +1  4948             
1F43 753933     +1  4949                                     mov     nuerr,#33h
1F46 120000   F +1  4950                                     call    error           ;на кран прибора ERR 3
                +1  4951                                     
1F49 120000   F +1  4952                                     call    ind
1F4C 120000   F +1  4953                                     call    z_01s           ;100ms
1F4F 80B1       +1  4954                                     jmp     test1   
                +1  4955     
                +1  4956     
                +1  4957     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    79

1F51 75E700     +1  4958      ind:   mov             EIE2,#00H;mov   IE,#00h
1F54 120000   F +1  4959                     call    mign
1F57 7840       +1  4960                      mov            r0,#bufind;+11
1F59 7F0C       +1  4961                      mov            r7,#12
1F5B C286       +1  4962      nexin: clr             p0.6
1F5D E6         +1  4963                     mov             a,@r0
1F5E F59B       +1  4964                     mov             SPI0DAT,a
1F60 20FBFD     +1  4965                     jb              TXBSY,$
1F63 D286       +1  4966                     setb    p0.6
1F65 120000   F +1  4967                     call    z_9             ;25mks
1F68 08         +1  4968                     inc             r0;dec          r0
1F69 DFF0       +1  4969                     djnz    r7,nexin
1F6B 75E730     +1  4970                     mov             EIE2,#30H;mov   IE,#80h
1F6E 22         +1  4971                ret
                +1  4972     
                +1  4973     
1F6F 7A08       +1  4974     zapadc:   mov R2,#8
1F71 D297       +1  4975     sdv:      setb P1.7
1F73 33         +1  4976               rlc A
1F74 9296       +1  4977                     mov P1.6,C
1F76 120000   F +1  4978                     call tim2
                +1  4979                                     
1F79 C297       +1  4980                     clr P1.7
1F7B 120000   F +1  4981                     call tim2
1F7E DAF1       +1  4982                     djnz R2,sdv
1F80 D296       +1  4983                     setb P1.6
1F82 22         +1  4984                     ret
                +1  4985     
1F83 7A08       +1  4986     chtadc:   mov R2,#8
1F85 D297       +1  4987     sdv1:     setb P1.7
1F87 120000   F +1  4988               call tim2
1F8A C297       +1  4989                     clr P1.7
1F8C A296       +1  4990                     mov C,P1.6
1F8E 33         +1  4991                     rlc A
1F8F 120000   F +1  4992                     call tim2
1F92 DAF1       +1  4993                     djnz R2,sdv1
1F94 22         +1  4994                     ret
                +1  4995     
1F95 7E30       +1  4996     tim:      mov R6,#30h;38h
1F97 DEFE       +1  4997     tim1:     djnz R6,tim1
1F99 22         +1  4998               ret
                +1  4999               
1F9A 7E10       +1  5000     tim2:     mov R6,#10h;14h
1F9C DEFE       +1  5001     tim3:     djnz R6,tim3
1F9E 22         +1  5002               ret
                +1  5003     
                +1  5004     ;запись из acc
1F9F C3         +1  5005     write_x1: clr   c
1FA0            +1  5006     writeD_x1:
1FA0 92B1       +1  5007                       mov P3.1,c        ;запись
1FA2 F5A0       +1  5008               mov P2,A
1FA4 D2B3       +1  5009                       setb P3.3
1FA6 120000   F +1  5010                       call z_5
1FA9 C2B3       +1  5011                       clr P3.3
1FAB 75A0FF     +1  5012                       mov P2,#0FFh
1FAE 22         +1  5013                       ret
                +1  5014     
                +1  5015     ;чтение в acc
1FAF C3         +1  5016     read_x2:  clr   c  
1FB0 92B1       +1  5017               mov P3.1,c        ;чтение
1FB2 D2B2       +1  5018               setb P3.2
1FB4 D2B3       +1  5019                       setb P3.3
1FB6 120000   F +1  5020                     call z_5
1FB9 E5A0       +1  5021                       mov A,P2
1FBB C2B3       +1  5022                       clr P3.3
1FBD C2B2       +1  5023                       clr P3.2
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    80

1FBF 22         +1  5024                       ret
                +1  5025     
                +1  5026     
1FC0 120000   F +1  5027     loop:     call read_x2;x2    ;ожидание флага готовности
1FC3 20E7FA     +1  5028                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
1FC6 22         +1  5029                        ret           ;возврат, если бит А(7)<>1
                +1  5030                                      
                +1  5031                                        
                +1  5032     
                +1  5033     
                +1  5034     
                +1  5035     
                +1  5036     
                +1  5037     
                +1  5038     
                +1  5039     ;принимаемый байт в acc
                +1  5040     ;прием байта последовательным кодом старшими разрядами вперед
1FC7 7A08       +1  5041     read:    mov R2,#8
1FC9 C297       +1  5042     re1:     clr P1.7;P1.2
1FCB 120000   F +1  5043              call tim2        ;5mks
1FCE A294       +1  5044                     mov C,P1.4;P1.0
1FD0 33         +1  5045                     rlc A           
1FD1 D297       +1  5046                     setb P1.7;P1.2
1FD3 120000   F +1  5047                     call tim2
1FD6 DAF1       +1  5048                     djnz R2,re1
1FD8 22         +1  5049                     ret
                +1  5050     
                +1  5051      ;in r0-count   
                +1  5052     ;r10,r11-значение с котоым сравнивается счетчик
                +1  5053     ;r2..r5 -значение счетчика
1FD9            +1  5054     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
1FD9 E6         +1  5055                     mov                     a,@r0
1FDA FC         +1  5056                     mov                     r4,a
1FDB 08         +1  5057                     inc                     r0
1FDC E6         +1  5058                     mov                     a,@r0
1FDD FD         +1  5059                     mov                     r5,a
1FDE 7B00       +1  5060                     mov                     r3,#0
1FE0 7A00       +1  5061                     mov                     r2,#0
1FE2 750800     +1  5062                     mov                     r8,#0;clr                       r8
1FE5 750900     +1  5063                     mov                     r9,#0;clr                       r9
1FE8 120000   F +1  5064                     call            lcmp
1FEB 22         +1  5065                     ret
                +1  5066     
                +1  5067     
                +1  5068     ;in-r1-count
1FEC            +1  5069     chdec:          ;mov            r1,#chavt               ;chavt-1
1FEC E7         +1  5070                             mov             a,@r1
1FED FC         +1  5071                             mov             r4,a
1FEE 09         +1  5072                             inc             r1
1FEF E7         +1  5073                             mov             a,@r1
1FF0 FD         +1  5074                             mov             r5,a
1FF1 C202       +1  5075                             clr             rr2
1FF3 C203       +1  5076                             clr             rr3
1FF5 900000   F +1  5077                             mov             dptr,#ch1        
1FF8 120000   F +1  5078                             call    ldc_ltemp
1FFB 120000   F +1  5079                             call    lsub
1FFE ED         +1  5080                             mov             a,r5
1FFF F7         +1  5081                             mov             @r1,a
2000 19         +1  5082                             dec             r1
2001 EC         +1  5083                             mov             a,r4
2002 F7         +1  5084                             mov             @r1,a
2003 22         +1  5085                             ret      
                +1  5086     
                +1  5087     
                +1  5088     
                +1  5089     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    81

2004            +1  5090     loadUS: ;если идет тест измерения ус восстановить для теста
2004 201533     +1  5091                                     jb              biteizm,yestest
2007 79AE       +1  5092                                             mov             r1,#diap
2009 E7         +1  5093                             mov             a,@r1
200A 23         +1  5094                             rl              a;*2
200B FC         +1  5095                             mov             r4,a                    ;save a
200C 900000   F +1  5096                             mov             dptr,#tabus
200F 93         +1  5097                             movc    a,@a+dptr
2010 FA         +1  5098                             mov             r2,a                    ;high byte
2011 E584       +1  5099                             mov             a,p4
2013 5401       +1  5100                             anl             a,#01
2015 4A         +1  5101                             orl             a,r2
2016 F584       +1  5102                             mov             p4,a
2018 0C         +1  5103                             inc             r4
2019 EC         +1  5104                             mov             a,r4
201A 93         +1  5105                             movc    a,@a+dptr
201B FB         +1  5106                             mov             r3,a                    ;low byte
201C E585       +1  5107                             mov             a,p5
201E 5401       +1  5108                             anl             a,#01
2020 4B         +1  5109                             orl             a,r3
2021 F585       +1  5110                             mov             p5,a
2023 799A       +1  5111                             mov             r1,#parT
2025 B7010E     +1  5112                             cjne    @r1,#1,bret
2028 79AE       +1  5113                             mov             r1,#diap                  ;10s (parT=1)
202A 7405       +1  5114                             mov             a,#5                      ;10-8..10-11 p4.1=1
202C C3         +1  5115                             clr             c
202D 97         +1  5116                             subb    a,@r1
202E 5006       +1  5117                             jnc             bret
2030 E584       +1  5118                             mov             a,p4
2032 4402       +1  5119                             orl             a,#02
2034 F584       +1  5120                             mov             p4,a                     ;10-8..10-11 p4.1=1
2036 120000   F +1  5121     bret:      call          louizm         ;us если вкл кн ИЗМЕР
2039 22         +1  5122                             ret
203A            +1  5123     yestest:
203A 120000   F +1  5124                             call            lotpus          ;ус теста измерения
203D 22         +1  5125                             ret
                +1  5126                             
                +1  5127     ;загр ус для кор 0
                +1  5128     ;dptr-
203E E4         +1  5129     lospus:         clr             a
                +1  5130                             ;movc   a,@a+dptr
                +1  5131                             ;mov            r2,a                    ;high byte
                +1  5132                             ;mov            a,p4
                +1  5133                             ;anl            a,#01
                +1  5134                             ;orl            a,r2
                +1  5135                             ;mov            p4,a
                +1  5136                             ;inc            dptr
203F E4         +1  5137                             clr             a
2040 93         +1  5138                             movc    a,@a+dptr
2041 FB         +1  5139                             mov             r3,a                    ;low byte
2042 E585       +1  5140                             mov             a,p5
2044 54BF       +1  5141                             anl             a,#0bfh;01
2046 4B         +1  5142                             orl             a,r3
2047 F585       +1  5143                             mov             p5,a
2049 22         +1  5144                             ret
                +1  5145     
204A 80         +1  5146     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                +1  5147     
                +1  5148     ;us кнопка измерения выкл
204B 88D6       +1  5149     tabus:     db           88h,0d6h         ;10-2
204D 88F6       +1  5150                             db      88h,0f6h         ;10-3
204F 88D6       +1  5151                             db              88h,0d6h         ;10-4
2051 88F6       +1  5152                             db              88h,0f6h         ;10-5
2053 9AD6       +1  5153                             db      9ah,0d6h         ;10-6
2055 9AF6       +1  5154                             db              9ah,0f6h         ;10-7
2057 ACD6       +1  5155                             db              0ach,0d6h        ;10-8
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    82

2059 ACF6       +1  5156                             db      0ach,0f6h        ;10-9
205B C8D6       +1  5157                             db              0c8h,0d6h        ;10-10
205D C8F6       +1  5158                             db              0c8h,0f6h        ;10-11
                +1  5159     
205F            +1  5160     tabt11: 
205F 66E6       +1  5161                             db              66h,0e6h;10-11
2061            +1  5162     tabt9:  
2061 32E6       +1  5163                             db              32h,0e6h;10-9
2063            +1  5164     tabt7:  
2063 18EE       +1  5165                             db              18h,0eeh;10-7
                +1  5166     
                +1  5167      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  5168     ;в зав от parT (Tизм)
2065 79B7       +1  5169     loadT:          mov             r1,#load;parT
2067 7840       +1  5170     lolevT:         mov             r0,#bufind+0
2069 7B0A       +1  5171                             mov             r3,#10
206B 75F00A     +1  5172                             mov             b,#10
206E E7         +1  5173                             mov             a,@r1
206F A4         +1  5174                             mul             ab
2070 FC         +1  5175                             mov             r4,a                    ;save a
2071 900000   F +1  5176                             mov             dptr,#textT
2074 93         +1  5177             lod1:   movc    a,@a+dptr
2075 F6         +1  5178                             mov             @r0,a
2076 08         +1  5179                             inc             r0
2077 0C         +1  5180                             inc             r4
2078 EC         +1  5181                             mov             a,r4
2079 DBF9       +1  5182                             djnz    r3,lod1
207B 22         +1  5183                             ret     
                +1  5184     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  5185     ;dptr-адр строки текста         
207C            +1  5186     lotext:         
207C 7B0A       +1  5187                             mov             r3,#10
207E 7840       +1  5188                             mov             r0,#bufind+0
2080 E4         +1  5189     lodt:           clr             a
2081 93         +1  5190                             movc    a,@a+dptr
2082 F6         +1  5191                             mov             @r0,a
2083 08         +1  5192                             inc             r0
2084 A3         +1  5193                             inc             dptr
2085 DBF9       +1  5194                             djnz    r3,lodt
2087 22         +1  5195                             ret                                     
                +1  5196     
                +1  5197     
                +1  5198     
                +1  5199     
                +1  5200      ;задержка 100 мкс
2088 7978       +1  5201     z_100:    mov R1,#78h     ;загрузка первого числа
208A 7A02       +1  5202     z100:     mov R2,#2h     ;загрузка второго числа
208C DAFE       +1  5203     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
208E D9FA       +1  5204               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
2090 22         +1  5205               ret           
                +1  5206     
                +1  5207     ;задержка 34 мкс
2091 7B8B       +1  5208     z_5:      mov R3,#8Bh      ;загрузка числа
2093 DBFE       +1  5209     ct:       djnz R3,ct
2095 22         +1  5210               ret
                +1  5211     
                +1  5212     ;задержка 15 мс
2096 79FA       +1  5213     z_15:     mov R1,#0FAh    ;загрузка первого числа
2098 7AED       +1  5214     z15:      mov R2,#0EDh   ;загрузка второго числа
209A DAFE       +1  5215     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
209C D9FA       +1  5216               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
209E 22         +1  5217               ret   
                +1  5218                                               
                +1  5219      ;задержка 1 мс
209F 7910       +1  5220     z_1ms:     mov R1,#10h     
20A1 7AED       +1  5221     ss1:       mov R2,#0EDh    
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    83

20A3 DAFE       +1  5222                djnz R2, $    
20A5 D9FA       +1  5223                djnz R1, ss1   
20A7 22         +1  5224                ret   
                +1  5225     
                +1  5226      ;????????
                +1  5227     ;задержка 1с
20A8 7D1F       +1  5228     z_1s:   mov             r5,#01fh 
20AA 7EFF       +1  5229     co2s:   mov     R6,#0ffh     
20AC 7FFF       +1  5230     z1s:     mov    R7,#0ffh     
20AE DFFE       +1  5231     co1s:   djnz    R7, co1s        
20B0 DEFA       +1  5232             djnz    R6, z1s 
20B2 DDF6       +1  5233                     djnz    r5,co2s
20B4 22         +1  5234               ret
                +1  5235     ;задержка 0,1с
20B5 7D03       +1  5236     z_01s:           mov            r5,#03h 
20B7 7EFF       +1  5237     co02s:          mov     R6,#0ffh     
20B9 7FFF       +1  5238     z01s:           mov     R7,#0ffh     
20BB DFFE       +1  5239                             djnz    R7, $   
20BD DEFA       +1  5240                     djnz    R6, z01s 
20BF DDF6       +1  5241                             djnz    r5,co02s
20C1 22         +1  5242                      ret
                +1  5243                                               
                +1  5244     ;задержка 0,5с
20C2 7D0D       +1  5245     z_05s:           mov            r5,#0dh 
20C4 7EFF       +1  5246     co05s:                  mov     R6,#0ffh     
20C6 7FFF       +1  5247     z05s:           mov     R7,#0ffh     
20C8 DFFE       +1  5248                                     djnz    R7, $   
20CA DEFA       +1  5249                     djnz    R6, z05s 
20CC DDF6       +1  5250                                             djnz    r5,co05s
20CE 22         +1  5251                      ret                                                     
                +1  5252                                                               
20CF 000007FF   +1  5253     chzap:  db      00,00,07h,0ffh             
20D3 00000000   +1  5254     ch0:    db      00,00,00,00
20D7 0000000A   +1  5255     ch10:   db      00,00,00,0ah                            ;10
20DB 00000005   +1  5256     ch5:    db      00,00,00,05                                             ;5
20DF 00000004   +1  5257     ch4:    db      00,00,00,04                                             ;4
20E3 000003B9   +1  5258     ch954:  db 00,00,03,0b9h                                                ;954
20E7 000003E8   +1  5259     ch10000:        db 00,00,03h,0e8h                                               ;10000
20EB 00000064   +1  5260     ch100:  db 00,00,00,64h ;100
20EF 00000002   +1  5261     ch2:    db      00,00,00,02                                             
                +1  5262     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  5263     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  5264     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
20F3 00000001   +1  5265     ch1:    db  00,00,00,01
20F7 49742400   +1  5266     ch_mln: db      49h,74h,24h,00;10*6
20FB 3F800000   +1  5267     ch_1:   db      3fh,80h,00,00   
20FF 40000000   +1  5268     ch_2:   db      40h,00,00,00;2
2103 40800000   +1  5269     ch_4:   db      40h,80h,00,00;4 
2107 40A00000   +1  5270     ch_5:   db      40h,0a0h,00,00;5
                +1  5271     
                +1  5272             
210B 3F741EDF   +1  5273     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
210F 47C35000   +1  5274     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
2113 3F800347   +1  5275     KD:             db      3fh,80h,03h,47h;1,0001
2117 48435000   +1  5276     CH2tho: db      48h,43h,50h,00;200000
211B 4856D800   +1  5277     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
211F 4856D800   +1  5278     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
2123 461C4000   +1  5279     ch_10th:db  46h,1ch,40h,00;10000-2710h
2127 41200000   +1  5280     ch_10:  db      41h,20h,00,00;10d
212B 48742400   +1  5281     ch_250: db      48h,74h,24h,00;250000
212F 000186A0   +1  5282     chk:            db      00,01,86h,0a0h;
2133 00000320   +1  5283     ch320h: db      00,00,03h,20h;320h=800d
2137 00000150   +1  5284     ch150h: db      00,00,01h,50h;150h
                +1  5285     ;r1- мл байт 2х байтного числа
213B            +1  5286     tenmin:         ;-10
213B C3         +1  5287                             clr             c
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    84

213C E7         +1  5288                     mov             a,@r1
213D 9405       +1  5289                             subb    a,#5;10
213F F7         +1  5290                             mov             @r1,a
2140 19         +1  5291                             dec             r1
2141 E7         +1  5292                             mov             a,@r1
2142 9400       +1  5293                             subb    a,#0
2144 F7         +1  5294                             mov             @r1,a
2145 22         +1  5295                             ret
                +1  5296       ;r0-обнуление ячеек памяти  
2146 7F04       +1  5297       clear4:        mov    r7,#4
2148 E4         +1  5298                             clr             a
2149 F6         +1  5299       cl4:          mov             @r0,a
214A 08         +1  5300                             inc             r0
214B DFFC       +1  5301                             djnz    r7,cl4
214D 22         +1  5302                             ret     
                +1  5303     
                +1  5304      ;r0-обнуление ячеек памяти 
                +1  5305      ;R7- 
214E            +1  5306       clearN:        
214E E4         +1  5307                             clr             a
214F F6         +1  5308       cl4N:         mov             @r0,a
2150 08         +1  5309                             inc             r0
2151 DFFC       +1  5310                             djnz    r7,cl4N
2153 22         +1  5311                             ret     
                +1  5312     
                +1  5313       ;чтение номера байта с индикатора(2байта)
                +1  5314     ;bufind+8..bufind+9
                +1  5315     ;-  - - -
                +1  5316     ;- - - - - - - - - -
                +1  5317     ;adec..adec+9
                +1  5318     ;ст            мл
2154 7848       +1  5319     upak2:  mov             r0,#bufind+8;
2156 795C       +1  5320                     mov             r1,#adec+9
2158 7F02       +1  5321                     mov             r7,#2;2bait
215A C3         +1  5322     upa2:   clr             c
215B E6         +1  5323                     mov             a,@r0
215C 9430       +1  5324                     subb    a,#30h
215E F7         +1  5325                     mov             @r1,a
215F 18         +1  5326                     dec             r0
2160 19         +1  5327                     dec             r1
2161 DFF7       +1  5328                     djnz    r7,upa2
2163 22         +1  5329                     ret  
                +1  5330     
                +1  5331     
                +1  5332         
                +1  5333      ;bufind+4..bufind+9
                +1  5334     ;-  - - -
                +1  5335     ;- - - - - - - - - -
                +1  5336     ;adec..adec+9
                +1  5337     ;ст            мл
2164 7849       +1  5338     upak:   mov             r0,#bufind+9;
2166 795C       +1  5339                     mov             r1,#adec+9
2168 7F06       +1  5340                     mov             r7,#6
216A C3         +1  5341     upa:    clr             c
216B E6         +1  5342                     mov             a,@r0
216C 9430       +1  5343                     subb    a,#30h
216E F7         +1  5344                     mov             @r1,a
216F 18         +1  5345                     dec             r0
2170 19         +1  5346                     dec             r1
2171 DFF7       +1  5347                     djnz    r7,upa
2173 22         +1  5348                     ret
                +1  5349     
                +1  5350      ;чтение номера байта с индикатора(3байта)
                +1  5351     ;bufind+3..bufind+9
                +1  5352     ;-  - - -
                +1  5353     ;- - - - - - - - - -
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    85

                +1  5354     ;adec..adec+9
                +1  5355     ;ст            мл
2174 7849       +1  5356     upak3:  mov             r0,#bufind+9;
2176 795C       +1  5357                     mov             r1,#adec+9
2178 7F03       +1  5358                     mov             r7,#3;3bait
217A C3         +1  5359     upa1:   clr             c
217B E6         +1  5360                     mov             a,@r0
217C 9430       +1  5361                     subb    a,#30h
217E F7         +1  5362                     mov             @r1,a
217F 18         +1  5363                     dec             r0
2180 19         +1  5364                     dec             r1
2181 DFF7       +1  5365                     djnz    r7,upa1
2183 22         +1  5366                     ret
                +1  5367     
                +1  5368     ;вых-r2,r3-адрес ячее памяти прогр
2184            +1  5369     findkoef:
2184 79AE       +1  5370                                     mov             r1,#diap
2186 E7         +1  5371                                     mov             a,@r1
2187 23         +1  5372                                     rl              a                                          
                                          ;diap*2(2bait )
2188 FC         +1  5373                                     mov             r4,a                                    ;sa
                             ve
2189 900000   F +1  5374                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  5375                                     
218C 93         +1  5376                                     movc    a,@a+dptr                       ;ст байт
218D FA         +1  5377                                     mov             r2,a
218E A3         +1  5378                                     inc             dptr
218F EC         +1  5379                                     mov             a,r4
2190 93         +1  5380                                     movc    a,@a+dptr
2191 FB         +1  5381                                     mov             r3,a                    ;мл байт
2192 22         +1  5382                                     ret
                +1  5383     ;r2..r5 в опр яч внешн озу
2193            +1  5384     findext:
2193 79AE       +1  5385                                     mov             r1,#diap
2195 E7         +1  5386                                     mov             a,@r1
2196 23         +1  5387                                     rl              a                                          
                                          ;diap*2(2bait )
2197 23         +1  5388                                     rl              a                                          
                                          ;diap*2(2bait )
2198 F9         +1  5389                                     mov             r1,a                                    ;r1
                             -номер ячейки внешнего озу
                +1  5390                                     
2199 22         +1  5391                                     ret
                +1  5392     
                +1  5393     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  5394     ;(5000h..5027h)
219A 5000       +1  5395     diKDw:  dw              5000h                   ;10-2
219C 5004       +1  5396                                     dw              5004h                   ;10-3
219E 5008       +1  5397                                     dw              5008h                   ;10-4
21A0 500C       +1  5398                                     dw              500ch                   ;10-5
21A2 5010       +1  5399                                     dw              5010h                   ;10-6
21A4 5014       +1  5400                                     dw              5014h                   ;10-7
21A6 5018       +1  5401                                     dw              5018h                   ;10-8
21A8 501C       +1  5402                                     dw              501ch                   ;10-9
21AA 5020       +1  5403                                     dw              5020h                   ;10-10
21AC 5024       +1  5404                                     dw              5024h                   ;10-11
21AE 5028       +1  5405     dipar:  dw              5028h                   ;parol
21B0 502C       +1  5406     diKm:           dw              502ch                   ;Km для теста измерения
21B2 000186A0   +1  5407     chthou: db      00,01,86h,0a0h  ;100.000
                +1  5408     
21B6 AA08       +1  5409     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
21B8 AB09       +1  5410                                             mov     r3,ltemp+1
21BA AC0A       +1  5411                                             mov     r4,ltemp+2
21BC AD0B       +1  5412                                             mov     r5,ltemp+3
21BE 22         +1  5413                                             ret
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    86

                +1  5414     ;bufind+4..bufind+9
                +1  5415     ;-  - - -
                +1  5416     ;- - - - - - - - - -
                +1  5417     ;adec..adec+9
                +1  5418     ;ст            мл
21BF 7847       +1  5419     upakA:  mov             r0,#bufind+7;
21C1 795C       +1  5420                     mov             r1,#adec+9
21C3 7F04       +1  5421                     mov             r7,#4
21C5 C3         +1  5422     upaa4:  clr             c
21C6 E6         +1  5423                     mov             a,@r0
21C7 9430       +1  5424                     subb    a,#30h
21C9 F7         +1  5425                     mov             @r1,a
21CA 18         +1  5426                     dec             r0
21CB 19         +1  5427                     dec             r1
21CC DFF7       +1  5428                     djnz    r7,upaa4
21CE 22         +1  5429                     ret
                +1  5430     
                +1  5431     ;bufind+4..bufind+9
                +1  5432     ;-  - - -
                +1  5433     ;- - - - - - - - - -
                +1  5434     ;adec..adec+9
                +1  5435     ;ст            мл
21CF 7848       +1  5436     upakB:  mov             r0,#bufind+8;
21D1 795C       +1  5437                     mov             r1,#adec+9
21D3 7F05       +1  5438                     mov             r7,#5
21D5 C3         +1  5439     upab:   clr             c
21D6 E6         +1  5440                     mov             a,@r0
21D7 9430       +1  5441                     subb    a,#30h
21D9 F7         +1  5442                     mov             @r1,a
21DA 18         +1  5443                     dec             r0
21DB 19         +1  5444                     dec             r1
21DC DFF7       +1  5445                     djnz    r7,upab
21DE C21B       +1  5446                     clr                     bitznB
21E0 E543       +1  5447                     mov             a,bufind+3
21E2 B42D02     +1  5448                     cjne            a,#2dh,abret
21E5 D21B       +1  5449                     setb            bitznB
21E7            +1  5450     abret:
21E7 22         +1  5451                     ret
21E8            +1  5452     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
21E8 4E6E6AA8   +1  5453                                             db      4eh,6eh,6ah,0a8h;10**9
21EC 43FA0000   +1  5454     CH_500:         db              43h,0fah,00,00;1fah=500
21F0 4856D800   +1  5455     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
21F4 49742400   +1  5456     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  5457     
                +1  5458     
                +1  5459     
                +1  5460     ;управление AD7731
                +1  5461     ;r4=b1 r5=b2
21F8            +1  5462     iniacp: ;управление AD7731
21F8 7403       +1  5463                             mov             a,#03
                +1  5464     
21FA 120000   F +1  5465                             call    write
21FD EC         +1  5466                             mov             a,r4;#80h
21FE 120000   F +1  5467                             call    write
2201 ED         +1  5468                             mov             a,r5;#04
2202 120000   F +1  5469                             call    write
2205 7402       +1  5470                             mov             a,#02
2207 120000   F +1  5471                             call    write
220A 74A1       +1  5472                             mov             a,#0a1h
220C 120000   F +1  5473                             call    write
220F 7474       +1  5474                             mov             a,#74h
2211 120000   F +1  5475                             call    write
2214 2095FD     +1  5476                             jb              p1.5,$;p1.3,$
2217 7402       +1  5477                             mov             a,#02
2219 120000   F +1  5478                             call    write
221C 7481       +1  5479                             mov             a,#81h
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    87

221E 120000   F +1  5480                             call    write
2221 7474       +1  5481                             mov             a,#74h
2223 120000   F +1  5482                             call    write
2226 2095FD     +1  5483                             jb              p1.5,$;p1.3,$
2229 7402       +1  5484                             mov             a,#02
222B 120000   F +1  5485                             call    write
222E 7421       +1  5486                             mov             a,#21h
2230 120000   F +1  5487                             call    write
2233 7474       +1  5488                             mov             a,#74h
2235 120000   F +1  5489                             call    write
2238 22         +1  5490                             ret
                +1  5491                             ;;;;;;;;;;;;;;;;
                +1  5492     ;;;;;;;;;;;;;;;;;
                +1  5493     ;;;;;;;;;;;;;;;;;
2239 0000       +1  5494     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
223B 6000       +1  5495                                     db              60h,00h;40h,04h         ;10s
223D 6000       +1  5496                                     db              60h,00;40h,04h          ;1s
223F 6000       +1  5497                                     db              60h,00h;40h,04h         ;0,1s
2241 6000       +1  5498                                     db              60h,00h;20h,04h         ;50ms
2243 6000       +1  5499                                     db              60h,00h;20h,04h          ;10ms
2245 1332       +1  5500                                     db              13h,32h         ;2ms
                +1  5501     
                +1  5502     ;загр В1,В2 в завис от Т                                
2247 799A       +1  5503     loab12:                 mov             r1,#parT
2249 900000   F +1  5504                                     mov             dptr,#tabB1_2
224C E7         +1  5505                                     mov             a,@r1
224D 23         +1  5506                                     rl              a;*2
224E FF         +1  5507                                     mov             r7,a                    ;save a
224F 93         +1  5508                                     movc    a,@a+dptr
2250 FC         +1  5509                                     mov             r4,a   ;b1
2251 0F         +1  5510                                     inc             r7
2252 EF         +1  5511                                     mov             a,r7
2253 93         +1  5512                                     movc    a,@a+dptr
2254 FD         +1  5513                                     mov             r5,a
                +1  5514                                     ;после загр В1,2 загр упр слово для нового Т
                +1  5515                             
2255 22         +1  5516                                     ret
                +1  5517     
                +1  5518     
2256 7852       +1  5519     loadr2: mov             r0,#abin+3              ;r2..r5
2258 E6         +1  5520                     mov             a,@r0                   ; ст мл   
2259 FA         +1  5521                     mov             r2,a
225A 18         +1  5522                     dec             r0
225B E6         +1  5523                     mov             a,@r0
225C FB         +1  5524                     mov             r3,a
225D 18         +1  5525                     dec             r0
225E E6         +1  5526                     mov             a,@r0
225F FC         +1  5527                     mov             r4,a
2260 18         +1  5528                     dec             r0
2261 E6         +1  5529                     mov             a,@r0
2262 FD         +1  5530                     mov             r5,a
2263 22         +1  5531                     ret
                +1  5532                                             
                +1  5533      ;;;;;;;;;;;;;;;;;;;      
                +1  5534      ;загрузка KD в зависимости от диап изм  
                +1  5535      ;koef->r8..r11
2264 78AE       +1  5536     loadKD:                 mov             r0,#diap
2266 E6         +1  5537                                     mov             a,@r0
2267 900000   F +1  5538                                     mov             dptr,#diKDn
226A 75F004     +1  5539                                     mov             b,#4
226D A4         +1  5540                                     mul             ab
226E FF         +1  5541                                     mov             r7,a;save
226F 93         +1  5542                                     movc    a,@a+dptr
2270 F508       +1  5543                                     mov             r8,a
2272 A3         +1  5544                                     inc             dptr
2273 EF         +1  5545                                     mov             a,r7
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    88

2274 93         +1  5546                                     movc    a,@a+dptr
2275 F509       +1  5547                                     mov             r9,a
2277 A3         +1  5548                                     inc             dptr
2278 EF         +1  5549                                     mov             a,r7
2279 93         +1  5550                                     movc    a,@a+dptr
227A F50A       +1  5551                                     mov             r10,a
227C A3         +1  5552                                     inc             dptr
227D EF         +1  5553                                     mov             a,r7
227E 93         +1  5554                                     movc    a,@a+dptr
227F F50B       +1  5555                                     mov             r11,a
2281 22         +1  5556                                     ret
                +1  5557     
2282 3F506B7B   +1  5558      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
2286 3F507FCC   +1  5559                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
228A 3F4F9D0B   +1  5560                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
228E 3F4FE869   +1  5561                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
2292 3F50294A   +1  5562                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
2296 3F50639E   +1  5563                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
229A 3F4BC9F0   +1  5564                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
229E 3F4C063B   +1  5565                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
22A2 3F50EFDD   +1  5566                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
22A6 3F512AD9   +1  5567                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  5568     
22AA 00000039   +1  5569     ch57:   db      00,00,00,39h;57
22AE 00000014   +1  5570     ch20:   db      00,00,00,14h;20
                +1  5571     
                +1  5572     ;загр ус для тестов ацп 
                +1  5573     ;dptr-
22B2 78B1       +1  5574     lotpus: mov             r0,#vichR
22B4 B6210D     +1  5575                                     cjne    @r0,#21h,te22
22B7 900000   F +1  5576                                     mov                     dptr,#tabt11;заслать ус 11А
22BA E4         +1  5577     lotp:           clr             a
22BB 93         +1  5578                             movc    a,@a+dptr                               ;high byte
22BC F584       +1  5579                             mov             p4,a
22BE A3         +1  5580                             inc             dptr
22BF E4         +1  5581                             clr             a
22C0 93         +1  5582                             movc    a,@a+dptr                               ;low byte
22C1 F585       +1  5583                             mov             p5,a
22C3 22         +1  5584                             ret
22C4 B62205     +1  5585     te22:                   cjne    @r0,#22h,te23
22C7 900000   F +1  5586                             mov                     dptr,#tabt9;заслать ус 9А       
22CA 80EE       +1  5587                             jmp                     lotp
                +1  5588     
22CC 900000   F +1  5589     te23:   mov                     dptr,#tabt7;заслать ус 7А       
22CF 80E9       +1  5590                             jmp                     lotp
                +1  5591     
                +1  5592     
                +1  5593     
                +1  5594     
                +1  5595     
22D1 02030405   +1  5596     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
22D5 06070809                
22D9 0A0B                    
                +1  5597     
22DB 78AE       +1  5598     findR:                  mov                     r0,#diap
22DD E6         +1  5599                                                     mov                     a,@r0
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    89

22DE 900000   F +1  5600                                                     mov                     dptr,#Tabn
22E1 93         +1  5601                                                     movc            a,@a+dptr
22E2 22         +1  5602                                                     ret
                +1  5603     ;bufind=30h..39h                                                                           
                                           ;
22E3 C219       +1  5604     vvchif:                 clr             bitmig
22E5 79B2       +1  5605                                     mov             r1,#marker
22E7 E7         +1  5606                                     mov             a,@r1                   ;изм цифры
22E8 7840       +1  5607                                     mov             r0,#bufind                      ;0000
22EA 28         +1  5608                                     add             a,r0
22EB F8         +1  5609                                     mov             r0,a
22EC 06         +1  5610                                     inc             @r0
22ED B63A03     +1  5611                                     cjne    @r0,#3ah,chif
22F0 7630       +1  5612                                     mov             @r0,#30h
22F2 22         +1  5613                                     ret
22F3 C3         +1  5614     chif:           clr                     c
22F4 7430       +1  5615                                     mov                     a,#30h
22F6 96         +1  5616                                     subb            a,@r0
22F7 4002       +1  5617                                     jc                      chif5
22F9 7630       +1  5618                                     mov             @r0,#30h
22FB 22         +1  5619     chif5:  ret
                +1  5620     
22FC 80E5       +1  5621     vvnol41:        jmp                     vvchif  ;при наборе цифр в интервале и константах
                +1  5622     
22FE B641FB     +1  5623     vvnol31:        cjne            @r0,#41h,vvnol41
2301 800A       +1  5624                                             jmp                     chifour
2303 B631F8     +1  5625     vvnol23:        cjne            @r0,#31h,vvnol31
2306 8005       +1  5626                                             jmp                     chifour 
                +1  5627     
2308 78B0       +1  5628     vvchibl:        mov                     r0,#level
230A B623F6     +1  5629                                             cjne            @r0,#23h,vvnol23;при наборе цифр в 
                             блоке
230D C219       +1  5630     chifour:                clr             bitmig
230F 79B2       +1  5631                                     mov             r1,#marker
2311 E7         +1  5632                                     mov             a,@r1                   ;изм цифры
2312 7840       +1  5633                                     mov             r0,#bufind                      ;1..4
2314 28         +1  5634                                     add             a,r0
2315 F8         +1  5635                                     mov             r0,a
2316 06         +1  5636                                     inc             @r0
2317 B63504     +1  5637                                     cjne    @r0,#35h,chifb
231A 7631       +1  5638                                     mov             @r0,#31h
231C 8006       +1  5639                                     jmp             chifb1
231E B63003     +1  5640     chifb:  cjne    @r0,#30h,chifb1
2321 7631       +1  5641                                     mov             @r0,#31h
2323 22         +1  5642                                     ret
2324            +1  5643     chifb1:;;;;;;;;;;
2324 C3         +1  5644                                     clr                     c
2325 7430       +1  5645                                     mov                     a,#30h
2327 96         +1  5646                                     subb            a,@r0
2328 4002       +1  5647                                     jc                      chifl5
232A 7630       +1  5648                                     mov             @r0,#30h
                +1  5649                                     
232C 22         +1  5650     chifl5: ret
                +1  5651     ;;;;;;;;;;;;;
232D 22         +1  5652             ret
                +1  5653       ;перевод маркера влево
232E            +1  5654     marle:  
232E C219       +1  5655                     clr             bitmig
                +1  5656                     ;mov            savba,#0   нельзя обнулять
2330 78B2       +1  5657             mov             r0,#marker
2332 16         +1  5658                     dec             @r0
2333 E6         +1  5659                     mov             a,@r0
2334 C3         +1  5660                     clr             c
2335 953A       +1  5661                     subb    a,movleft         ;крайне левое положение
2337 5001       +1  5662                     jnc             rler
2339 06         +1  5663                     inc             @r0
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    90

233A 22         +1  5664     rler:   ret
                +1  5665         
                +1  5666     ;перевод маркера вправо
233B C219       +1  5667     marri:  clr             bitmig
233D 78B2       +1  5668                     mov             r0,#marker
233F 06         +1  5669                     inc         @r0
2340 E53B       +1  5670                     mov             a,movrig           ;крайне правое положение
2342 C3         +1  5671                     clr             c
2343 96         +1  5672                     subb    a,@r0
2344 5001       +1  5673                     jnc             rrir
2346 16         +1  5674                     dec             @r0
2347 22         +1  5675     rrir:   ret
                +1  5676         
                +1  5677     ;konstA->bufind+4..bufind+7
2348 78BC       +1  5678     outA:           mov                     r0,#konstA
234A 120000   F +1  5679                                     call            resar2
234D 120343     +1  5680                                     call            ftol                    ;->hex
2350 784F       +1  5681                                     mov             r0,#abin
2352 120000   F +1  5682                                     call            saver2
2355 7853       +1  5683                                     mov                     r0,#adec
2357 7952       +1  5684                                     mov             r1,#abin+3
2359 120000   F +1  5685                                     call            bindec
235C 785C       +1  5686                                     mov                     r0,#adec+9
235E 7947       +1  5687                                     mov                     r1,#bufind+7
2360 7F04       +1  5688                                     mov                     r7,#4
2362 E6         +1  5689     outa2:  mov             a,@r0
2363 2430       +1  5690                               add           a,#30h
2365 F7         +1  5691                                     mov             @r1,a
2366 19         +1  5692                                     dec             r1
2367 18         +1  5693                                     dec             r0
2368 DFF8       +1  5694                                     djnz    r7,outa2
236A 22         +1  5695                                     ret
                +1  5696                                             
                +1  5697     ;konstB->bufind+4..bufind+8
236B 78C0       +1  5698     outB:           mov                     r0,#konstB
236D 120000   F +1  5699                                     call            resar2
2370 EA         +1  5700                                     mov                     a,r2
2371 5480       +1  5701                                     anl                     a,#80h
2373 6007       +1  5702                                     jz                      outb3
2375 EA         +1  5703     mov                     a,r2
2376 547F       +1  5704                                     anl                     a,#7fh
2378 FA         +1  5705                                     mov                     r2,a
2379 75432D     +1  5706                                     mov                     bufind+3,#2dh
237C 120343     +1  5707     outb3:  call            ftol                    ;->hex
237F 784F       +1  5708                                     mov             r0,#abin
2381 120000   F +1  5709                                     call            saver2
2384 7853       +1  5710                                     mov                     r0,#adec
2386 7952       +1  5711                                     mov             r1,#abin+3
2388 120000   F +1  5712                                     call            bindec
238B 785C       +1  5713                                     mov                     r0,#adec+9
238D 7948       +1  5714                                     mov                     r1,#bufind+8
238F 7F05       +1  5715                                     mov                     r7,#5
2391 E6         +1  5716     outb2:  mov             a,@r0
2392 2430       +1  5717                               add           a,#30h
2394 F7         +1  5718                                     mov             @r1,a
2395 19         +1  5719                                     dec             r1
2396 18         +1  5720                                     dec             r0
2397 DFF8       +1  5721                                     djnz    r7,outb2
2399 22         +1  5722                                     ret
                +1  5723     
                +1  5724     
                +1  5725     ;пп мигания индикации
239A 78B2       +1  5726     mign:           mov             r0,#marker
                +1  5727                                     
239C B6FF03     +1  5728                                     cjne    @r0,#0ffh,mignn
                +1  5729                                     ;реж изм мигает *
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    91

239F C219       +1  5730                                     clr             bitmig
23A1 22         +1  5731                                     ret
                +1  5732     
23A2            +1  5733     mignn:                  ;clr            c
23A2 7440       +1  5734                                     mov             a,#bufind
23A4 26         +1  5735                                     add             a,@r0                   ;a=bufind+marker
23A5 F9         +1  5736                                     mov             r1,a
23A6 201907     +1  5737                                     jb              bitmig,onmig
23A9 873C       +1  5738                                     mov             savba,@r1
                +1  5739                             ;       mov             a,@r1
                +1  5740                             ;       mov             savba,a
23AB 7720       +1  5741                                     mov             @r1,#" "
                +1  5742                                     
23AD D219       +1  5743                                     setb    bitmig
23AF 22         +1  5744                                     ret
                +1  5745     
23B0 A73C       +1  5746     onmig:                  mov             @r1,savba
                +1  5747                                     ;mov            a,savba
                +1  5748                                     ; mov           @r1,a
23B2 C219       +1  5749                                     clr             bitmig
23B4 120000   F +1  5750                                     call    z_01s
23B7 22         +1  5751                                     ret
                +1  5752     ;номер ошибки bufind+6
23B8 900000   F +1  5753     error:          mov             dptr,#teERR
23BB 120000   F +1  5754                                             call    lotext
23BE 853946     +1  5755                                             mov             bufind+6,nuerr
23C1 22         +1  5756                                     ret
                +1  5757     
                +1  5758     
23C2            +1  5759     textT:          
23C2 FD543D32   +1  5760     te2ms:                  db              0fdh,"T","=",32h,"m",67h,0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
23C6 6D67FDFD                
23CA FDFD                    
23CC FD543D31   +1  5761     te10ms:                 db              0fdh,"T","=",31h,30h,"m",67h,0fdh,0fdh,0fdh
23D0 306D67FD                
23D4 FDFD                    
23D6 FD543D35   +1  5762                             db              0fdh,"T","=",35h,30h,"m",67h,0fdh,0fdh,0fdh
23DA 306D67FD                
23DE FDFD                    
23E0 FD543D64   +1  5763                             db              0fdh,"T","=",64h,31h,67h,0fdh,0fdh,0fdh,0fdh
23E4 3167FDFD                
23E8 FDFD                    
23EA 20202054   +1  5764                             db              " "," "," ","T","=",31h,67h," "," "," "
23EE 3D316720                
23F2 2020                    
23F4 2020543D   +1  5765                             db              " "," ","T","=",31h,30h,67h," "," "," "  
23F8 31306720                
23FC 2020                    
                +1  5766     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                +1  5767     
23FE 42753474   +1  5768     teVICH: db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
2402 79767454                
2406 7720                    
2408 20553D20   +1  5769     teAequ0:        db              " ",'U','='," "," "," "," "," "," ",65h
240C 20202020                
2410 2065                    
2412 20423D2B   +1  5770     teBequ0:        db              " ",'B','=','+'," "," "," "," "," "," "
2416 20202020                
241A 2020                    
241C 20207145   +1  5771     teMENU: db              " "," ",71h,"E","H",72h," "," "," "," "
2420 48722020                
2424 2020                    
                +1  5772     
2426 20544579   +1  5773     teTESI: db      " ","T","E",79h,"T",2dh,74h,33h,71h," ";ТЕСТ -ИЗМ    11
242A 542D7433                
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    92

242E 7120                    
2430 54457954   +1  5774     teTESR: db      "T","E",79h,"T"," ","R",35h," "," "," ";ТЕСТ RS 12
2434 20523520                
2438 2020                    
243A 20794B30   +1  5775     teSKOR: db      " ",79h,'K',30h,"P"," ","R",35h," "," ";СКОР 232      13
243E 50205235                
2442 2020                    
2444 20204142   +1  5776     teAVK:  db      " "," ",'A','B','K'," "," "," "," "," "  ;AВK                              
                                  14
2448 4B202020                
244C 2020                    
244E 204B4176   +1  5777     teKALIB:         db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР    15
2452 74735020                
2456 202020                  
                +1  5778     
2459 20544579   +1  5779     teTE11:         db              " ",'T',"E",79h,'T'," "," "," ",'T',31h;          21
245D 54202020                
2461 5431                    
2463 20544579   +1  5780     teTE9:          db              " ",'T',"E",79h,'T'," "," "," ",'T',32h;                   
                                                  22
2467 54202020                
246B 5432                    
246D 20544579   +1  5781     teTE7:          db              " ",'T',"E",79h,'T'," "," "," ",'T',33h;                   
                                                  23
2471 54202020                
2475 5433                    
                +1  5782     
                +1  5783     
2477 20353736   +1  5784     teS57_6:                db              " ",35h,37h,36h," "," "," "," "," "," ";57.6
247B 20202020                
247F 2020                    
2481 20313932   +1  5785     teS19_2:                db              " ",31h,39h,32h," "," "," "," "," "," ";19,2
2485 20202020                
2489 2020                    
                +1  5786     
248B 61415030   +1  5787     tePAR:          db              61h,'A',"P",30h,76h,77h," ",30h,30h,30h;пароль
248F 76772030                
2493 3030                    
2495 20303030   +1  5788     teKD:                   db              " ",30h,30h,30h,30h,30h," "," "," ",'A';00000
2499 30302020                
249D 2041                    
249F 74337120   +1  5789     teIZMK: db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
24A3 4B304879                
24A7 5420                    
24A9 20204275   +1  5790     teOUT:          db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
24AD 58307820                
24B1 2020                    
24B3 2020304C   +1  5791     teOLL:          db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
24B7 4C202020                
24BB 2020                    
24BD 20203034   +1  5792     teCLE:          db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
24C1 7479544B                
24C5 4120                    
24C7 20203041   +1  5793     teMEM:          db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
24CB 71795420                
24CF 20203341   +1  5794     teWR:           db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
24D3 61747977                
24D7 2020                    
24D9 20206150   +1  5795     teLIST: db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
24DD 30797130                
24E1 545020                  
24E4 20206130   +1  5796     teFULL: db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
24E8 76484162                
24EC 2020                    
24EE 20744854   +1  5797     teINT:  db      " ",74h,"H",'T'," ",30h,30h,30h,30h,67h;ИНТ 0000
24F2 20303030                
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    93

24F6 3067                    
24F8 20207376   +1  5798     teBL:           db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
24FC 304B2020                
2500 2020                    
2502 20207376   +1  5799     teBL0:  db      " "," ",73h,76h,30h,'K'," ",30h," "," ";БЛОК 0
2506 304B2030                
250A 2020                    
250C 30547934   +1  5800     teCH:           db      30h,'T',79h,34h,"E",'T'," ",30h,30h,30h;ОТСЧЕТ 000
2510 45542030                
2514 3030                    
2516 79544154   +1  5801     teSTAT:         db      79h,'T','A','T',74h,79h,'T',74h,'K','A';СТАТИСТИКА
251A 74795474                
251E 4B41                    
2520 71744820   +1  5802     teMIN:  db      71h,74h,"H"," "," "," "," "," "," "," ";МИН  00000
2524 20202020                
2528 2020                    
252A 71414B79   +1  5803     teMAX:  db      71h,'A','K',79h," "," "," "," "," "," ";МАКС 00000
252E 20202020                
2532 2020                    
2534 79504578   +1  5804     teMID:  db      79h,"P","E",78h," "," "," "," "," "," ";СРЕД 00000
2538 20202020                
253C 2020                    
                +1  5805      ;;;;;;;;;;;;;;;;;;;         
253E 2020304C   +1  5806     teOLI:  db              " "," ",30h,"L","L"," ","I"," "," "," "
2542 4C204920                
2546 2020                    
2548 2020304C   +1  5807     teOLR:  db              " "," ",30h,"L","L"," ",66h," "," "," "
254C 4C206620                
2550 2020                    
2552 20204552   +1  5808     teERR:  db              " "," ","E","R","R"," "," "," "," "," " ;ERR
2556 52202020                
255A 2020                    
255C 2020454E   +1  5809     teEND:  db              " "," ","E","N","D"," "," "," "," "," " ;END
2560 44202020                
2564 2020                    
                +1  5810     
                +1  5811     ;dptr+4-приемник
                +1  5812     ;dptr-источник
                +1  5813     ;r7-кол байт  
2566            +1  5814     xCIKLWR:
2566 7F04       +1  5815                             mov             r7,#4   
2568 E0         +1  5816     lwrx:   movx    a,@dptr
2569 C083       +1  5817                             push    dph
256B C082       +1  5818                             push    dpl
256D A3         +1  5819                             inc             dptr
256E A3         +1  5820                             inc             dptr
256F A3         +1  5821                             inc             dptr
2570 A3         +1  5822                             inc             dptr
2571 F0         +1  5823                             movx    @dptr,a
2572 D082       +1  5824                             pop             dpl
2574 D083       +1  5825                             pop             dph
                +1  5826                             
2576 A3         +1  5827                             inc             dptr
2577 DFEF       +1  5828                             djnz    r7,lwrx
2579 22         +1  5829                             ret
                +1  5830     ;r2..r5->@dptr..@dptr+3                         
257A EA         +1  5831     saveIr2:                mov     a,r2
257B F0         +1  5832                                             movx    @dptr,a
257C A3         +1  5833                                             inc     dptr
257D EB         +1  5834                                             mov     a,r3
257E F0         +1  5835                                             movx    @dptr,a
257F A3         +1  5836                                             inc     dptr
2580 EC         +1  5837                                             mov     a,r4
2581 F0         +1  5838                                             movx    @dptr,a
2582 A3         +1  5839                                             inc     dptr
2583 ED         +1  5840                                             mov     a,r5
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    94

2584 F0         +1  5841                                             movx    @dptr,a
2585 22         +1  5842                                             ret
                +1  5843     ;r2..r5-> @r0..@r0+3
                +1  5844     
2586 EA         +1  5845     saver2:         mov     a,r2
2587 F6         +1  5846                                             mov     @r0,a
2588 08         +1  5847                                             inc     r0
2589 EB         +1  5848                                             mov     a,r3
258A F6         +1  5849                                             mov     @r0,a
258B 08         +1  5850                                             inc     r0
258C EC         +1  5851                                             mov     a,r4
258D F6         +1  5852                                             mov     @r0,a
258E 08         +1  5853                                             inc     r0
258F ED         +1  5854                                             mov     a,r5
2590 F6         +1  5855                                             mov     @r0,a
2591 22         +1  5856                                             ret 
2592 7F50       +1  5857     clmassix:       mov                     r7,#50h;28h
2594 900100     +1  5858                             mov     dptr,#MASS0        ;забить массив A нулями
2597 7400       +1  5859     clmax:          mov          a,#00h
2599 F0         +1  5860                  movx    @dptr,a
259A A3         +1  5861                  inc     dptr
259B DFFA       +1  5862                 djnz                r7,clmax                
259D F56E       +1  5863                  mov     chmas,a
259F C201       +1  5864                  clr     bitmas
25A1 22         +1  5865                 ret
                +1  5866     ;r1-яЁшхьшъ
                +1  5867     ;r0-шёЄюўшъ
                +1  5868     ;r7-ъюы срщЄ  
25A2            +1  5869     CIKLWR:
25A2 7F04       +1  5870                             mov             r7,#4   
25A4 E6         +1  5871     lwr:    mov     a,@r0
25A5 F7         +1  5872                             mov     @r1,a
25A6 09         +1  5873                             inc             r1
25A7 08         +1  5874                             inc             r0
25A8 DFFA       +1  5875                             djnz    r7,lwr
25AA 22         +1  5876                             ret     
                +1  5877     ;r2..r5-> @dptr..@dptr+3
                +1  5878     
25AB 120000   F +1  5879     zmul:   call    maform
25AE 120000   F +1  5880                     call    lmul
25B1 120000   F +1  5881                     call    bform
25B4 22         +1  5882                     ret
                +1  5883     
25B5 120000   F +1  5884     zdiv:   call    maform
25B8 120000   F +1  5885                     call    divide
25BB 120000   F +1  5886                     call    bform
25BE 22         +1  5887                     ret
                +1  5888     
25BF EA         +1  5889     maform: mov a,r2
25C0 33         +1  5890             rlc a
25C1 5006       +1  5891             jnc             fo1m
25C3 D202       +1  5892                     setb            znmat
25C5 120000   F +1  5893                     call   form4
25C8 22         +1  5894                     ret
25C9 C202       +1  5895     fo1m:   clr             znmat
25CB 22         +1  5896                     ret
                +1  5897     
25CC 300203     +1  5898     bform:  jnb             znmat,fo2m
25CF 120000   F +1  5899                     call    form4
25D2 22         +1  5900     fo2m:   ret
                +1  5901       
                +1  5902     ;r2..r5 яхЁхтхёЄш т фюя ъюф
25D3 ED         +1  5903     form4:          mov a,r5
25D4 F4         +1  5904             cpl a
25D5 2401       +1  5905             add a,#1
25D7 FD         +1  5906             mov r5,a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    95

25D8 EC         +1  5907             mov a,r4
25D9 F4         +1  5908             cpl a
25DA 3400       +1  5909             addc    a,#0
25DC FC         +1  5910             mov r4,a
25DD EB         +1  5911             mov a,r3
25DE F4         +1  5912                 cpl a
25DF 3400       +1  5913             addc    a,#0
25E1 FB         +1  5914             mov r3,a
25E2 EA         +1  5915             mov a,r2
25E3 F4         +1  5916             cpl a
25E4 3400       +1  5917             addc    a,#0
25E6 FA         +1  5918             mov r2,a
25E7 22         +1  5919             ret
                +1  5920     
25E8 120000   F +1  5921     zcmp:   call            maform
25EB 120000   F +1  5922                     call            lcmp
25EE C0D0       +1  5923                     push            psw
25F0 120000   F +1  5924                     call    bform
25F3 D0D0       +1  5925                     pop             psw
25F5 22         +1  5926                     ret
                +1  5927     
                +1  5928     
                +1  5929     ;@r0..@r0+3->r8..r11
                +1  5930     
25F6 E6         +1  5931     resar8: mov     a,@r0
25F7 F508       +1  5932                     mov     ltemp,a
25F9 08         +1  5933                     inc     r0
25FA E6         +1  5934                     mov     a,@r0
25FB F509       +1  5935                     mov     ltemp+1,a
25FD 08         +1  5936                     inc     r0
25FE E6         +1  5937                     mov     a,@r0
25FF F50A       +1  5938                     mov     ltemp+2,a
2601 08         +1  5939                     inc     r0
2602 E6         +1  5940                     mov     a,@r0
2603 F50B       +1  5941                     mov     ltemp+3,a
2605 22         +1  5942                     ret
                +1  5943     
                +1  5944     ;
                +1  5945     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                +1  5946     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                +1  5947     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                +1  5948     ;r2 a    ўшёыю 180
                +1  5949     ;00 b4
                +1  5950     ;т_ї- mabin..mabin+2
                +1  5951     ;     80 01 00
                +1  5952      
2606 C8         +1  5953     cond:   xch     a,r0    
2607 F9         +1  5954                     mov     r1,a
2608 C8         +1  5955                     xch     a,r0
2609 7C03       +1  5956                     mov     r4,#03
260B 7700       +1  5957     dcoa:   mov     @r1,#00
260D 09         +1  5958                     inc     r1
260E DCFB       +1  5959                     djnz    r4,dcoa
2610 7B10       +1  5960                     mov     r3,#10h
2612 C3         +1  5961     dcob:   clr     c
2613 33         +1  5962                     rlc     a
2614 CA         +1  5963                     xch     a,r2
2615 33         +1  5964                     rlc     a
2616 CA         +1  5965                     xch     a,r2
2617 C8         +1  5966                     xch     a,r0
2618 F9         +1  5967                     mov     r1,a
2619 C8         +1  5968                     xch     a,r0
261A 7C03       +1  5969                     mov     r4,#03
261C FD         +1  5970                     mov     r5,a
261D E7         +1  5971     dcoc:   mov     a,@r1 
261E 37         +1  5972                     addc    a,@r1
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    96

261F D4         +1  5973                     da      a
2620 F7         +1  5974                     mov     @r1,a
2621 09         +1  5975                     inc     r1
2622 DCF9       +1  5976                     djnz    r4,dcoc
2624 ED         +1  5977                     mov     a,r5
2625 4003       +1  5978                     jc      dcod
2627 DBE9       +1  5979                     djnz    r3,dcob
2629 C3         +1  5980                     clr     c
262A 00         +1  5981     dcod:   nop
262B 22         +1  5982                     ret
                +1  5983     
262C 8A08       +1  5984     move28: mov     ltemp,r2                        ;r2..r5->ltemp
262E 850309     +1  5985                     mov     ltemp+1,3
2631 85040A     +1  5986                     mov     ltemp+2,4
2634 85050B     +1  5987                     mov     ltemp+3,5
2637 22         +1  5988                     ret
                +1  5989     
                +1  5990     ;@r0..@r0+3->r2..r5
                +1  5991     
2638 E6         +1  5992     resar2: mov     a,@r0
2639 FA         +1  5993                     mov     r2,a
263A 08         +1  5994                     inc     r0
263B E6         +1  5995                     mov     a,@r0
263C FB         +1  5996                     mov     r3,a
263D 08         +1  5997                     inc     r0
263E E6         +1  5998                     mov     a,@r0
263F FC         +1  5999                     mov     r4,a
2640 08         +1  6000                     inc     r0
2641 E6         +1  6001                     mov     a,@r0
2642 FD         +1  6002                     mov     r5,a
2643 22         +1  6003                     ret
                +1  6004     
                +1  6005     ;25mkc !!!!!!!!!!!!!!!1
2644 7B4B       +1  6006     z_9:      mov R3,#4Bh      ;загрузка числа
2646 DBFE       +1  6007                    djnz R3,$
2648 22         +1  6008               ret
                +1  6009     
                +1  6010     ;запись   передаваемый байт в acc
                +1  6011     ;передача байта послед кодом старшими разрядами  вперед
2649 7A08       +1  6012     write:     mov R2,#8
264B C3         +1  6013                             clr  c  
264C C297       +1  6014     wr1:            clr             p1.7;P1.2
264E 00         +1  6015                         nop 
264F 33         +1  6016                             rlc A
2650 9296       +1  6017                             mov P1.6,C;P1.1,C
2652 120000   F +1  6018                        call tim2
2655 D297       +1  6019                        setb P1.7;P1.2
2657 120000   F +1  6020                call tim2
265A DAF0       +1  6021                       djnz R2,wr1
265C C296       +1  6022                       clr P1.6;P1.1
265E 22         +1  6023                                              ret
                +1  6024     
                +1  6025     ;чтение номера байта с индикатора(2байта)
                +1  6026     ;bufind+8..bufind+9
                +1  6027     ;-  - - -
                +1  6028     ;- - - - - - - - - -
                +1  6029     ;adec..adec+9
                +1  6030     ;ст            мл
265F 7847       +1  6031     upak1:  mov             r0,#bufind+7;
2661 795C       +1  6032                                     mov             r1,#adec+9
2663 C3         +1  6033                                     clr             c
2664 E6         +1  6034                                     mov             a,@r0
2665 9430       +1  6035                                     subb    a,#30h
2667 FF         +1  6036                                     mov             r7,a
2668 C3         +1  6037                                     clr             c
2669 9405       +1  6038                                     subb    a,#5
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    97

266B 4004       +1  6039                                     jc              upk1
266D 7404       +1  6040                                     mov             a,#4
266F 8001       +1  6041                                     jmp             upk2
2671 EF         +1  6042     upk1:           mov             a,r7
2672 F7         +1  6043     upk2:           mov             @r1,a
2673 22         +1  6044                                     ret  
                +1  6045     ;r1-мл байт счетчика ячеек
2674 C3         +1  6046     chminus:        clr                     c
2675 E7         +1  6047                                             mov                     a,@r1
2676 9401       +1  6048                                             subb            a,#01
2678 F7         +1  6049                                             mov                     @r1,a;low
2679 19         +1  6050                                             dec                     r1
267A E7         +1  6051                                             mov                     a,@r1
267B 9400       +1  6052                                             subb            a,#00
267D F7         +1  6053                                             mov                     @r1,a
267E 22         +1  6054                                             ret
                +1  6055     
                +1  6056     
                +1  6057     ;чтение номера байта с индикатора(4байта)
                +1  6058     ;bufind+6..bufind+9
                +1  6059     ;-  - - -
                +1  6060     ;- - - - - - - - - -
                +1  6061     ;adec..adec+9
                +1  6062     ;ст            мл
267F 7848       +1  6063     upak4:  mov             r0,#bufind+8;
2681 795C       +1  6064                     mov             r1,#adec+9
2683 7F04       +1  6065                     mov             r7,#4
2685 C3         +1  6066     upaa:   clr             c
2686 E6         +1  6067                     mov             a,@r0
2687 9430       +1  6068                     subb    a,#30h
2689 F7         +1  6069                     mov             @r1,a
268A 18         +1  6070                     dec             r0
268B 19         +1  6071                     dec             r1
268C DFF7       +1  6072                     djnz    r7,upaa
268E 22         +1  6073                     ret
                +1  6074     
                +1  6075     ;dptr-адр ячейки 1й соотв блока 
268F E538       +1  6076     adrblok:         mov            a,nblok
2691 C3         +1  6077                              clr            c
2692 9401       +1  6078                              subb           a,#1
2694 FD         +1  6079                              mov            r5,a
2695 E4         +1  6080                              clr            a
2696 FC         +1  6081                              mov            r4,a
2697 FB         +1  6082                              mov            r3,a
2698 FA         +1  6083                              mov            r2,a
2699 900000   F +1  6084                                     mov                     dptr,#ch320h
269C 120000   F +1  6085                                     CALL   ldc_ltemp                 ; ltemp <-320
269F 120000   F +1  6086                                     call            lmul;r2..r5
26A2 ED         +1  6087                                     mov                     a,r5
26A3 2450       +1  6088                                     add                     a,#50h
26A5 F582       +1  6089                                     mov                     dpl,a
26A7 EC         +1  6090                                     mov                     a,r4
26A8 3401       +1  6091                                     addc            a,#01           
26AA F583       +1  6092                                     mov                     dph,a                   ;dptr-
26AC 22         +1  6093                                     ret
                +1  6094     
                +1  6095     ;
                +1  6096     ;saven_bl<-dptr  адрес след ячейки внешн озу 
26AD 79D3       +1  6097     save_hl:                mov             r1,#saven_bl
26AF E583       +1  6098                                                     mov             a,dph
26B1 F7         +1  6099                                               mov           @r1,a
26B2 09         +1  6100                                                     inc             r1
26B3 E582       +1  6101                                                     mov             a,dpl
26B5 F7         +1  6102                                                     mov             @r1,a
                +1  6103                                                     ;;;;;;;;;не конец ли блока
                +1  6104                             
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    98

                +1  6105     
26B6 79D6       +1  6106                                     mov                     r1,#volume+1;work+1
26B8 120000   F +1  6107                                     call            chminus
26BB 78D5       +1  6108                                     mov             r0,#volume
26BD E6         +1  6109                                     mov             a,@r0
26BE 30E708     +1  6110                                     jnb             acc.7,noendli
26C1 C20A       +1  6111                                     clr                     bitbon                  ;блок закон
                             чился
26C3 534BFD     +1  6112                                     anl                     bufind+11,#0fdh
26C6 120000   F +1  6113                                     call            ind
                +1  6114                             
26C9            +1  6115     noendli:        
26C9 22         +1  6116                                             ret
                +1  6117     ;загрузка dptr сохр ранее значением адреса ячейки
26CA 79D3       +1  6118     resa_hl:                mov             r1,#saven_bl
26CC E7         +1  6119                                                     mov             a,@r1
26CD F583       +1  6120                                                     mov             dph,a
                +1  6121                                               
26CF 09         +1  6122                                                     inc             r1
26D0 E7         +1  6123                                                     mov             a,@r1
26D1 F582       +1  6124                                                     mov             dpl,a
26D3 22         +1  6125                                                     ret
                +1  6126     ;загрузка rez_A3 в соотв яч внешн озу
26D4 789C       +1  6127     loA3_X:                 mov             r0,#rez_A3
26D6 120000   F +1  6128                                                     call    resar2
                +1  6129                                                     
26D9 EA         +1  6130                                                     mov             a,r2                    ;
26DA F0         +1  6131                                                     movx    @dptr,a
26DB A3         +1  6132                                                     inc             dptr
26DC EB         +1  6133                                                     mov             a,r3
26DD F0         +1  6134                                                     movx    @dptr,a
26DE A3         +1  6135                                                     inc             dptr
26DF EC         +1  6136                                                     mov             a,r4
26E0 F0         +1  6137                                                     movx    @dptr,a
26E1 A3         +1  6138                                                     inc             dptr
26E2 ED         +1  6139                                                     mov             a,r5
26E3 F0         +1  6140                                                     movx    @dptr,a
26E4 A3         +1  6141                                                     inc             dptr;адрес след ячейки внеш
                             н озу храним
26E5 22         +1  6142                                                     ret             ;в ячейке saven_bl
                +1  6143     ;чтение в rez_A3 из соотв яч внешн озу
26E6            +1  6144     reA3_X:         
                +1  6145                                                     
26E6 E0         +1  6146                                                     movx    a,@dptr
26E7 FA         +1  6147                                                     mov             r2,a
26E8 A3         +1  6148                                                     inc             dptr
26E9 E0         +1  6149                                                     movx    a,@dptr
26EA FB         +1  6150                                                     mov             r3,a
26EB A3         +1  6151                                                     inc             dptr
26EC E0         +1  6152                                                     movx    a,@dptr
26ED FC         +1  6153                                                     mov             r4,a
26EE A3         +1  6154                                                     inc             dptr
26EF E0         +1  6155                                                     movx    a,@dptr
26F0 FD         +1  6156                                                     mov             r5,a
26F1 A3         +1  6157                                                     inc             dptr
26F2 789C       +1  6158                                                     mov             r0,#rez_A3
26F4 120000   F +1  6159                                                     call    saver2
26F7 22         +1  6160                                                     ret
                +1  6161     ;;;;;;;;;;;;;;;;;
                +1  6162     ;разбивка внешнего озу
                +1  6163     ;0..ffh считывается страница рпзу калибровочных коффициентов
                +1  6164     ;100h..150h обл внеш озу для скользящего массива измерения
                +1  6165     ;150h..46fh 1й блок
                +1  6166     ;470h..78fh     2й блок
                +1  6167     ;790h..aaf      3й блок
                +1  6168     ;ab0h..dcfh 4й блок
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE    99

                +1  6169     ;dd0..fffh свободная область
                +1  6170     ;
                    6171     
                    6172     ;$include (d:\amp\sarifm3.asm) 
                +1  6173     ; ” ©« SARIFM.ASM 8.11.95
                +1  6174     ;файл арифметики
                +1  6175       
  0008          +1  6176     ltemp    equ       8           ;long temporary
  000C          +1  6177     xtemp    equ       12          ;other temporaries
  000A          +1  6178     DECSIZE  EQU       10
  0004          +1  6179     NUMSIZE  EQU       4
  0004          +1  6180     RR4  EQU       4
  0005          +1  6181     RR5  EQU       5
                +1  6182     
                +1  6183                                                     
                +1  6184     
                +1  6185                 ; rseg     ARIF          ; Switch to this code segment.
                +1  6186     ;             using    0              ; Specify register bank for the following
                +1  6187                                            ; program code.
                +1  6188     ;                                               cseg AT 400h
                +1  6189     ; Arithmetics:  CLEARING string
                +1  6190     ; Input:
                +1  6191     ; R0 - pointer to string,
                +1  6192     ; NUMSIZE - byte count if CLRNUM used,
                +1  6193     ; DECSIZE - byte count if CLRDEC used,
                +1  6194     ; R2 - byte count if CLEAR used;
                +1  6195     ; Output:  none.
                +1  6196     
26F8            +1  6197     CLRDEC:
26F8 7A0A       +1  6198         MOV R2, #DECSIZE
26FA 8002       +1  6199         SJMP    CLEAR
26FC            +1  6200     CLRNUM:
26FC 7A04       +1  6201         MOV R2, #NUMSIZE
                +1  6202         ;JMP    CLEAR
26FE            +1  6203     CLEAR:
26FE E4         +1  6204         CLR A
26FF F6         +1  6205     CLR11:  MOV @R0, A
2700 08         +1  6206         INC R0
2701 DAFC       +1  6207         DJNZ    R2, CLR11
2703 22         +1  6208         RET
                +1  6209     
                +1  6210     ;**********************************
                +1  6211     ;mov    r1,#abin+3
                +1  6212     ;mov    r0,#adec
                +1  6213     ; _ _ _ _
                +1  6214     ;     03ff
                +1  6215     ;ст     мл   - вход
                +1  6216     ; _ _ _ _ _ _ _ _ _ _
                +1  6217     ;             1 0 2 3
                +1  6218     ;ст                мл 
                +1  6219     ;**********************************
                +1  6220     
2704            +1  6221     BINDEC:
                +1  6222     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  6223     ; Input:
                +1  6224     ; R0 - pointer to destination (high digit is the first),
                +1  6225     ; R1 - pointer to source,
                +1  6226     ; NUMSIZE - byte count in binary number;
                +1  6227     ; DECSIZE - byte count in decimal number;
                +1  6228     ; Output:  none.
                +1  6229     ; Source saved
                +1  6230     
                +1  6231         ; 1. Clear result
2704 7A05       +1  6232         MOV R2, #DECSIZE/2
2706 120000   F +1  6233         CALL   CLEAR  ; incrementing R0
                +1  6234     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   100

                +1  6235         ; 2. Prepare convertion
2709 18         +1  6236         DEC R0
270A 8804       +1  6237         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
270C 8905       +1  6238         MOV RR5, R1 ; R5 - pointer to low byte of binary number
270E 7B20       +1  6239         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6240     
                +1  6241         ; 3. Convert cyrcle
2710            +1  6242     BIN30:
                +1  6243     
                +1  6244         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
2710 A905       +1  6245         MOV R1, RR5
2712 7A04       +1  6246         MOV R2, #NUMSIZE
2714 E7         +1  6247     BIN31:  MOV A, @R1
2715 33         +1  6248         RLC A
2716 F7         +1  6249         MOV @R1, A
2717 19         +1  6250         DEC R1
2718 DAFA       +1  6251         DJNZ    R2, BIN31
271A A905       +1  6252         MOV R1, RR5
271C E7         +1  6253         MOV A, @R1
271D 92E0       +1  6254         MOV ACC.0, C
271F F7         +1  6255         MOV @R1, A
                +1  6256     
                +1  6257         ; 3.2. Doubling decimal result with <Carry>
2720 A804       +1  6258         MOV R0, RR4
2722 7A05       +1  6259         MOV R2, #DECSIZE/2
2724 E6         +1  6260     BIN32:  MOV A, @R0
2725 36         +1  6261         ADDC    A, @R0
2726 D4         +1  6262         DA  A
2727 F6         +1  6263         MOV @R0, A
2728 18         +1  6264         DEC R0
2729 DAF9       +1  6265         DJNZ    R2, BIN32
                +1  6266     
                +1  6267         ; 3.3. End of convert cyrcle
272B DBE3       +1  6268         DJNZ    R3, BIN30
                +1  6269     
                +1  6270         ; 4. Make bytes from half-bytes
272D E8         +1  6271         MOV A, R0
272E 240A       +1  6272         ADD A, #DECSIZE
2730 F8         +1  6273         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
2731 A904       +1  6274         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
2733 7A05       +1  6275         MOV R2, #DECSIZE/2
2735 E7         +1  6276     BIN41:  MOV A, @R1
2736 540F       +1  6277         ANL A, #00FH
2738 F6         +1  6278         MOV @R0, A
2739 18         +1  6279         DEC R0
273A E7         +1  6280         MOV A, @R1
273B C4         +1  6281         SWAP    A
273C 540F       +1  6282         ANL A, #00FH
273E F6         +1  6283         MOV @R0, A
273F 18         +1  6284         DEC R0
2740 19         +1  6285         DEC R1
2741 DAF2       +1  6286         DJNZ    R2, BIN41
2743 22         +1  6287         RET
                +1  6288     
                +1  6289     
                +1  6290     ;*********************************
                +1  6291     ;mov    r0,#abin
                +1  6292     ;mov    r1,#adec
                +1  6293     ; _ _ _ _       -выход
                +1  6294     ; ff0000
                +1  6295     ;0004
                +1  6296     ;мл      ст
                +1  6297     
                +1  6298     ;ст                       мл
                +1  6299     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  6300     ;                       2 5 5
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   101

                +1  6301     ;                   1 0 2 4
                +1  6302     
2744            +1  6303     DECBIN:
                +1  6304     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  6305     ; Input:
                +1  6306     ; R0 - pointer to destination,
                +1  6307     ; R1 - pointer to source (high digit is the first),
                +1  6308     ; NUMSIZE - byte count in binary number;
                +1  6309     ; DECSIZE - byte count in decimal number;
                +1  6310     ; Output:  none
                +1  6311     ; Source cleared
                +1  6312     
                +1  6313         ; 1. Clear result
2744 120000   F +1  6314         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  6315     
                +1  6316         ; 2. Prepare convertion
2747 18         +1  6317         DEC R0
2748 8804       +1  6318         MOV RR4, R0 ; R4 - pointer to high byte of binary result
274A 8905       +1  6319         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
274C 900000   F +1  6320         MOV DPTR, #DECT2
274F 7B20       +1  6321         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6322     
                +1  6323         ; 3. Convert cyrcle
2751            +1  6324     DEC30:
                +1  6325     
                +1  6326         ; 3.1. Divide decimal number by 2 and prepare <Carry>
2751 C3         +1  6327         CLR C
2752 A905       +1  6328         MOV R1, RR5
2754 7A0A       +1  6329         MOV R2, #DECSIZE
2756 E7         +1  6330     DEC31:  MOV A, @R1
2757 540F       +1  6331         ANL A, #00FH
2759 92E4       +1  6332         MOV ACC.4, C
275B 93         +1  6333         MOVC    A,@A+DPTR
275C F7         +1  6334         MOV @R1, A
275D A2E7       +1  6335         MOV C, ACC.7
275F 09         +1  6336         INC R1
2760 DAF4       +1  6337         DJNZ    R2, DEC31
                +1  6338     
                +1  6339         ; 3.2. Rotate binary result one bit to right with <Carry>
2762 A804       +1  6340         MOV R0, RR4
2764 7A04       +1  6341         MOV R2, #NUMSIZE
2766 E6         +1  6342     DEC32:  MOV A, @R0
2767 13         +1  6343         RRC A
2768 F6         +1  6344         MOV @R0, A
2769 18         +1  6345         DEC R0
276A DAFA       +1  6346         DJNZ    R2, DEC32
                +1  6347     
                +1  6348         ; 3.3. End of convert cyrcle
276C DBE3       +1  6349         DJNZ    R3, DEC30
276E 22         +1  6350         RET
                +1  6351     
276F 00800181   +1  6352     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
2773 02820383                
2777 0484                    
2779 00000000   +1  6353         DB  00,00,00,00,00,00
277D 0000                    
277F 05850686   +1  6354         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
2783 07870888                
2787 0989                    
                +1  6355     
                +1  6356     ;   Long comparison
                +1  6357     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  6358     ;   flags and acc set as though a long subtraction was done.
                +1  6359     ;*******************************
                +1  6360     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  6361     ;c=1     r2..r5< ltemp..ltemp+3     a<b
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   102

                +1  6362     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  6363     ;*******************************
2789            +1  6364     lcmp:
2789 C3         +1  6365         clr c
278A EA         +1  6366         mov a,r2
278B 9508       +1  6367         subb    a,8
278D 700F       +1  6368         jnz done
278F EB         +1  6369         mov a,r3
2790 9509       +1  6370         subb    a,9
2792 7008       +1  6371         jnz done1
2794 EC         +1  6372         mov a,r4
2795 950A       +1  6373         subb    a,10
2797 7003       +1  6374         jnz done1
2799 ED         +1  6375         mov a,r5
279A 950B       +1  6376         subb    a,11
279C            +1  6377     done1:
279C C2D2       +1  6378         clr ov      ;overflow is significant only for top byte
279E            +1  6379     done:
279E 22         +1  6380         ret
                +1  6381     
                +1  6382     ;   Load long into r2-5 from [dptr]
                +1  6383     
279F            +1  6384     ldc_long:
279F E583       +1  6385         mov a,dph       ;is it in on board memory
27A1 6010       +1  6386         jz  onboard     ;yes
27A3 E4         +1  6387         clr a
27A4 93         +1  6388         movc    a,@a+dptr
27A5 FA         +1  6389         mov r2,a
27A6 7401       +1  6390         mov a,#1
27A8 93         +1  6391         movc    a,@a+dptr
27A9 FB         +1  6392         mov r3,a
27AA 7402       +1  6393         mov a,#2
27AC 93         +1  6394         movc    a,@a+dptr
27AD FC         +1  6395         mov r4,a
27AE 7403       +1  6396         mov a,#3
27B0 93         +1  6397         movc    a,@a+dptr
27B1 FD         +1  6398         mov r5,a
27B2 22         +1  6399         ret
27B3            +1  6400     onboard:
27B3 A882       +1  6401         mov r0,dpl
27B5 E6         +1  6402         mov a,@r0
27B6 FA         +1  6403         mov r2,a
27B7 08         +1  6404         inc r0
27B8 E6         +1  6405         mov a,@r0
27B9 FB         +1  6406         mov r3,a
27BA 08         +1  6407         inc r0
27BB E6         +1  6408         mov a,@r0
27BC FC         +1  6409         mov r4,a
27BD 08         +1  6410         inc r0
27BE E6         +1  6411         mov a,@r0
27BF FD         +1  6412         mov r5,a
27C0 22         +1  6413         ret
                +1  6414     
                +1  6415     ;**************************************
                +1  6416     ;загрузить ltemp...+3 из памяти программ
                +1  6417     ;mov    dptr,#CH5
                +1  6418     ;call   ldc_ltemp        ltemp <--5
                +1  6419     ;**************************************
27C1            +1  6420     ldc_ltemp:
27C1 E583       +1  6421         mov a,dph       ;is it in on board memory
27C3 6014       +1  6422         jz  oboard      ;yes
27C5 E4         +1  6423         clr a
27C6 93         +1  6424         movc    a,@a+dptr
27C7 F508       +1  6425         mov 8,a
27C9 7401       +1  6426         mov a,#1
27CB 93         +1  6427         movc    a,@a+dptr
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   103

27CC F509       +1  6428         mov 9,a
27CE 7402       +1  6429         mov a,#2
27D0 93         +1  6430         movc    a,@a+dptr
27D1 F50A       +1  6431         mov 10,a
27D3 7403       +1  6432         mov a,#3
27D5 93         +1  6433         movc    a,@a+dptr
27D6 F50B       +1  6434         mov 11,a
27D8 22         +1  6435         ret
27D9            +1  6436     oboard:
27D9 A882       +1  6437         mov r0,dpl
27DB 8608       +1  6438         mov 8,@r0
27DD 08         +1  6439         inc r0
27DE 8609       +1  6440         mov 9,@r0
27E0 08         +1  6441         inc r0
27E1 860A       +1  6442         mov 10,@r0
27E3 08         +1  6443         inc r0
27E4 860B       +1  6444         mov 11,@r0
27E6 22         +1  6445         ret
                +1  6446     
                +1  6447     ;*****************************
                +1  6448     ;mov    dptr,#k1
                +1  6449     ;call   ldx_long
                +1  6450     ;k1->r2..r5
                +1  6451     ;*****************************
                +1  6452     ;   Load long into r2-5 from [dptr]
                +1  6453     ;
                +1  6454     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
27E7            +1  6455     ldx_long:
27E7 E583       +1  6456         mov a,dph       ;is it in on board memory
27E9 6014       +1  6457         jz  onboar1        ;yes
27EB C082       +1  6458         push    dpl
27ED C083       +1  6459         push    dph
27EF E0         +1  6460         movx    a,@dptr
27F0 FA         +1  6461         mov r2,a
27F1 A3         +1  6462         inc dptr
27F2 E0         +1  6463         movx    a,@dptr
27F3 FB         +1  6464         mov r3,a
27F4 A3         +1  6465         inc dptr
27F5 E0         +1  6466         movx    a,@dptr
27F6 FC         +1  6467         mov r4,a
27F7 A3         +1  6468         inc dptr
27F8 E0         +1  6469         movx    a,@dptr
27F9 FD         +1  6470         mov r5,a
27FA D083       +1  6471         pop dph
27FC D082       +1  6472         pop dpl
27FE 22         +1  6473         ret
27FF            +1  6474     onboar1:
27FF A882       +1  6475         mov r0,dpl
2801 E6         +1  6476         mov a,@r0
2802 FA         +1  6477         mov r2,a
2803 08         +1  6478         inc r0
2804 E6         +1  6479         mov a,@r0
2805 FB         +1  6480         mov r3,a
2806 08         +1  6481         inc r0
2807 E6         +1  6482         mov a,@r0
2808 FC         +1  6483         mov r4,a
2809 08         +1  6484         inc r0
280A E6         +1  6485         mov a,@r0
280B FD         +1  6486         mov r5,a
280C 22         +1  6487         ret
                +1  6488     
                +1  6489     ;*********************************
                +1  6490     ;mov    dptr,#k2
                +1  6491     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  6492     ;**********************************
280D            +1  6493     ldx_ltemp:
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   104

280D E583       +1  6494         mov a,dph       ;is it in on board memory
280F 6010       +1  6495         jz  oboard1     ;yes
2811 E0         +1  6496         movx    a,@dptr
2812 F508       +1  6497         mov 8,a
2814 A3         +1  6498         inc dptr
2815 E0         +1  6499         movx    a,@dptr
2816 F509       +1  6500         mov 9,a
2818 A3         +1  6501         inc dptr
2819 E0         +1  6502         movx    a,@dptr
281A F50A       +1  6503         mov 10,a
281C A3         +1  6504         inc dptr
281D E0         +1  6505         movx    a,@dptr
281E F50B       +1  6506         mov 11,a
2820 22         +1  6507         ret
2821            +1  6508     oboard1:
2821 A882       +1  6509         mov r0,dpl
2823 8608       +1  6510         mov 8,@r0
2825 08         +1  6511         inc r0
2826 8609       +1  6512         mov 9,@r0
2828 08         +1  6513         inc r0
2829 860A       +1  6514         mov 10,@r0
282B 08         +1  6515         inc r0
282C 860B       +1  6516         mov 11,@r0
282E 22         +1  6517         ret
                +1  6518     ;   Long division routines for 8051
                +1  6519     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  6520     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  6521     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  6522     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  6523     ;   r1 must be saved by the caller.
                +1  6524     ;   This is long unsigned division.
                +1  6525     
                +1  6526     
                +1  6527     ;   Register usage:
                +1  6528     ;       r0 loop counter
                +1  6529     ;       xtemp (12-15) accumulates quotient
                +1  6530     ;       r5-r2 holds dividend
                +1  6531     ;       ltemp holds divisor
                +1  6532     
                +1  6533     ;************************************
                +1  6534     ;r2..r5-делимое
                +1  6535     ;ltemp..-делитель
                +1  6536     ;частное -r2..r5
                +1  6537     ;*************************************
282F            +1  6538     divide:
282F E4         +1  6539         clr a
2830 F8         +1  6540         mov r0,a        ;initialize count
2831 F50C       +1  6541         mov xtemp,a     ;zero quotient
2833 F50D       +1  6542         mov xtemp+1,a
2835 F50E       +1  6543         mov xtemp+2,a
2837 F50F       +1  6544         mov xtemp+3,a
2839 ED         +1  6545         mov a,r5        ;check for zero dividend
283A 4C         +1  6546         orl a,r4
283B 4B         +1  6547         orl a,r3
283C 4A         +1  6548         orl a,r2
283D 600B       +1  6549         jz  jfinis
283F E508       +1  6550         mov a,ltemp     ;check for zero divisor
2841 4509       +1  6551         orl a,ltemp+1
2843 450A       +1  6552         orl a,ltemp+2
2845 450B       +1  6553         orl a,ltemp+3
2847 7037       +1  6554         jnz midl
2849 22         +1  6555         ret
                +1  6556     
284A 020000   F +1  6557     jfinis: jmp finis
                +1  6558     
284D            +1  6559     loops:
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   105

284D EA         +1  6560         mov a,r2
284E C3         +1  6561         clr c
284F 9508       +1  6562         subb    a,ltemp+0   ;is divisor greater than dividend yet
2851 4033       +1  6563         jc  yes     ;yes, go no further
2853 7013       +1  6564         jnz no
2855 EB         +1  6565         mov a,r3
2856 9509       +1  6566         subb    a,ltemp+1
2858 402C       +1  6567         jc  yes
285A 700C       +1  6568         jnz no
285C EC         +1  6569         mov a,r4
285D 950A       +1  6570         subb    a,ltemp+2
285F 4025       +1  6571         jc  yes
2861 7005       +1  6572         jnz no
2863 ED         +1  6573         mov a,r5
2864 950B       +1  6574         subb    a,ltemp+3
2866 401E       +1  6575         jc  yes
2868            +1  6576     no:
2868 E50B       +1  6577         mov a,ltemp+3   ;shift divisor up one bit
286A 250B       +1  6578         add a,ltemp+3
286C F50B       +1  6579         mov ltemp+3,a
286E E50A       +1  6580         mov a,ltemp+2
2870 350A       +1  6581         addc    a,ltemp+2
2872 F50A       +1  6582         mov ltemp+2,a
2874 E509       +1  6583         mov a,ltemp+1
2876 3509       +1  6584         addc    a,ltemp+1
2878 F509       +1  6585         mov ltemp+1,a
287A E508       +1  6586         mov a,ltemp+0
287C 3508       +1  6587         addc    a,ltemp+0
287E F508       +1  6588         mov ltemp+0,a
2880            +1  6589     midl:
2880 08         +1  6590         inc r0      ;increment count
2881 E508       +1  6591         mov a,ltemp+0   ;check for safe to shift some more
2883 30E7C7     +1  6592         jnb acc.7,loops  ;loop if top bit clear
2886            +1  6593     yes:
2886 E508       +1  6594         mov a,ltemp+0
2888 C3         +1  6595         clr c
2889 9A         +1  6596         subb    a,r2        ;can we subtract now?
288A 401A       +1  6597         jc  dosub       ;yes, go and do it
288C 7015       +1  6598         jnz nosub
288E E509       +1  6599         mov a,ltemp+1
2890 9B         +1  6600         subb    a,r3
2891 4013       +1  6601         jc  dosub
2893 700E       +1  6602         jnz nosub
2895 E50A       +1  6603         mov a,ltemp+2
2897 9C         +1  6604         subb    a,r4
2898 400C       +1  6605         jc  dosub
289A 7007       +1  6606         jnz nosub
289C E50B       +1  6607         mov a,ltemp+3
289E 9D         +1  6608         subb    a,r5
289F 4005       +1  6609         jc  dosub
28A1 6003       +1  6610         jz  dosub
28A3            +1  6611     nosub:
28A3 C3         +1  6612         clr c
28A4 8012       +1  6613         sjmp    dosh
28A6            +1  6614     dosub:
28A6 C3         +1  6615         clr c       ;subtract divisor from dividend
28A7 ED         +1  6616         mov a,r5
28A8 950B       +1  6617         subb    a,ltemp+3
28AA FD         +1  6618         mov r5,a
28AB EC         +1  6619         mov a,r4
28AC 950A       +1  6620         subb    a,ltemp+2
28AE FC         +1  6621         mov r4,a
28AF EB         +1  6622         mov a,r3
28B0 9509       +1  6623         subb    a,ltemp+1
28B2 FB         +1  6624         mov r3,a
28B3 EA         +1  6625         mov a,r2
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   106

28B4 9508       +1  6626         subb    a,ltemp+0
28B6 FA         +1  6627         mov r2,a
28B7 D3         +1  6628         setb    c       ;now set bit for quotient
28B8            +1  6629     dosh:
28B8 E50F       +1  6630         mov a,xtemp+3
28BA 33         +1  6631         rlc a
28BB F50F       +1  6632         mov xtemp+3,a
28BD E50E       +1  6633         mov a,xtemp+2
28BF 33         +1  6634         rlc a
28C0 F50E       +1  6635         mov xtemp+2,a
28C2 E50D       +1  6636         mov a,xtemp+1
28C4 33         +1  6637         rlc a
28C5 F50D       +1  6638         mov xtemp+1,a
28C7 E50C       +1  6639         mov a,xtemp+0
28C9 33         +1  6640         rlc a
28CA F50C       +1  6641         mov xtemp+0,a
28CC E508       +1  6642         mov a,ltemp+0       ;shift divisor down
28CE C3         +1  6643         clr c
28CF 13         +1  6644         rrc a
28D0 F508       +1  6645         mov ltemp+0,a
28D2 E509       +1  6646         mov a,ltemp+1
28D4 13         +1  6647         rrc a
28D5 F509       +1  6648         mov ltemp+1,a
28D7 E50A       +1  6649         mov a,ltemp+2
28D9 13         +1  6650         rrc a
28DA F50A       +1  6651         mov ltemp+2,a
28DC E50B       +1  6652         mov a,ltemp+3
28DE 13         +1  6653         rrc a
28DF F50B       +1  6654         mov ltemp+3,a
                +1  6655     
28E1 D8A3       +1  6656         djnz    r0,yes      ;and continue with the rest
                +1  6657     
28E3            +1  6658     finis:
28E3 8D0B       +1  6659         mov ltemp+3,r5
28E5 8C0A       +1  6660         mov ltemp+2,r4
28E7 8B09       +1  6661         mov ltemp+1,r3
28E9 8A08       +1  6662         mov ltemp+0,r2
28EB AD0F       +1  6663         mov r5,xtemp+3
28ED AC0E       +1  6664         mov r4,xtemp+2
28EF AB0D       +1  6665         mov r3,xtemp+1
28F1 AA0C       +1  6666         mov r2,xtemp+0
28F3 22         +1  6667         ret         ;and return with the satisfaction of a job well done
                +1  6668     
                +1  6669     
                +1  6670     ;   Long multiplication
                +1  6671     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  6672     ;   other in ltemp. It really doesn't matter which one is where.
                +1  6673     
                +1  6674     ;**********************************
                +1  6675     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  6676     ;ст  мл
                +1  6677     ;**********************************
28F4            +1  6678     llmul:
28F4            +1  6679     almul:
28F4            +1  6680     lmul:
28F4 ED         +1  6681         mov a,r5        ;low order byte
28F5 850BF0     +1  6682         mov b,ltemp+3       ;times low order byte
28F8 A4         +1  6683         mul ab
28F9 F50F       +1  6684         mov xtemp+3,a       ;store low
28FB 85F00E     +1  6685         mov xtemp+2,b   ;and high
28FE ED         +1  6686         mov a,r5        ;low order
28FF 850AF0     +1  6687         mov b,ltemp+2   ;times next
2902 A4         +1  6688         mul ab
2903 250E       +1  6689         add a,xtemp+2   ;add in
2905 F50E       +1  6690         mov xtemp+2,a
2907 E5F0       +1  6691         mov a,b
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   107

2909 3400       +1  6692         addc    a,#0
290B F50D       +1  6693         mov xtemp+1,a
290D ED         +1  6694         mov a,r5
290E 8509F0     +1  6695         mov b,ltemp+1
2911 A4         +1  6696         mul ab
2912 250D       +1  6697         add a,xtemp+1
2914 F50D       +1  6698         mov xtemp+1,a
2916 E5F0       +1  6699         mov a,b
2918 3400       +1  6700         addc    a,#0
291A F50C       +1  6701         mov xtemp+0,a
291C ED         +1  6702         mov a,r5
291D 8508F0     +1  6703         mov b,ltemp+0
2920 A4         +1  6704         mul ab
2921 250C       +1  6705         add a,xtemp+0
2923 F50C       +1  6706         mov xtemp+0,a
2925 EC         +1  6707         mov a,r4
2926 850BF0     +1  6708         mov b,ltemp+3
2929 A4         +1  6709         mul ab
292A 250E       +1  6710         add a,xtemp+2
292C F50E       +1  6711         mov xtemp+2,a
292E E5F0       +1  6712         mov a,b
2930 350D       +1  6713         addc    a,xtemp+1
2932 F50D       +1  6714         mov xtemp+1,a
2934 E50C       +1  6715         mov a,xtemp+0
2936 3400       +1  6716         addc    a,#0
2938 F50C       +1  6717         mov xtemp+0,a
293A EC         +1  6718         mov a,r4
293B 850AF0     +1  6719         mov b,ltemp+2
293E A4         +1  6720         mul ab
293F 250D       +1  6721         add a,xtemp+1
2941 F50D       +1  6722         mov xtemp+1,a
2943 E5F0       +1  6723         mov a,b
2945 350C       +1  6724         addc    a,xtemp+0
2947 F50C       +1  6725         mov xtemp+0,a
2949 EC         +1  6726         mov a,r4
294A 8509F0     +1  6727         mov b,ltemp+1
294D A4         +1  6728         mul ab
294E 250C       +1  6729         add a,xtemp+0
2950 F50C       +1  6730         mov xtemp+0,a
                +1  6731     
2952 EB         +1  6732         mov a,r3
2953 850BF0     +1  6733         mov b,ltemp+3
2956 A4         +1  6734         mul ab
2957 250D       +1  6735         add a,xtemp+1
2959 F50D       +1  6736         mov xtemp+1,a
295B E5F0       +1  6737         mov a,b
295D 350C       +1  6738         addc    a,xtemp+0
295F F50C       +1  6739         mov xtemp+0,a
2961 EB         +1  6740         mov a,r3
2962 850AF0     +1  6741         mov b,ltemp+2
2965 A4         +1  6742         mul ab
2966 250C       +1  6743         add a,xtemp+0
2968 F50C       +1  6744         mov xtemp+0,a
                +1  6745     
296A EA         +1  6746         mov a,r2
296B 850BF0     +1  6747         mov b,ltemp+3
296E A4         +1  6748         mul ab
296F 250C       +1  6749         add a,xtemp+0
2971 FA         +1  6750         mov r2,a
2972 AB0D       +1  6751         mov r3,xtemp+1
2974 AC0E       +1  6752         mov r4,xtemp+2
2976 AD0F       +1  6753         mov r5,xtemp+3
                +1  6754     
2978 22         +1  6755         ret         ;all done
                +1  6756     ;******************************
                +1  6757     ;из содержимого  r2-r5  вычесть
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   108

                +1  6758     ;содержимое          ltemp..ltemp+3
                +1  6759     ;******************************
2979            +1  6760     llsub:
2979            +1  6761      lsub:
2979 ED         +1  6762         mov a,r5
297A C3         +1  6763         clr c
297B 950B       +1  6764         subb    a,11
297D FD         +1  6765         mov r5,a
297E EC         +1  6766         mov a,r4
297F 950A       +1  6767         subb    a,10
2981 FC         +1  6768         mov r4,a
2982 EB         +1  6769         mov a,r3
2983 9509       +1  6770         subb    a,9
2985 FB         +1  6771         mov r3,a
2986 EA         +1  6772         mov a,r2
2987 9508       +1  6773         subb    a,8
2989 FA         +1  6774         mov r2,a
298A 22         +1  6775         ret
                +1  6776     
                +1  6777     ;***********************************************
                +1  6778     ;                                                      ст мл
                +1  6779     ; cложение содержимого  r2..r5 с числом по адресу
                +1  6780     ;  r0- адрес младшего байта !!!
                +1  6781     ;результат- r2..r5
                +1  6782     ;***********************************************
                +1  6783     
298B C3         +1  6784     ladd:    clr       c
298C ED         +1  6785          mov       a,r5
298D 26         +1  6786          add       a,@r0
298E FD         +1  6787          mov       r5,a
298F 18         +1  6788          dec       r0
2990 EC         +1  6789          mov       a,r4
2991 36         +1  6790          addc      a,@r0
2992 FC         +1  6791          mov       r4,a
2993 18         +1  6792          dec       r0
2994 EB         +1  6793          mov       a,r3
2995 36         +1  6794          addc      a,@r0
2996 FB         +1  6795          mov       r3,a
2997 18         +1  6796          dec       r0
2998 EA         +1  6797          mov       a,r2
2999 36         +1  6798          addc      a,@r0
299A FA         +1  6799          mov       r2,a
299B 22         +1  6800          ret
                +1  6801     ;***********************************************
                +1  6802     ;                                                      ст мл
                +1  6803     ; cложение содержимого  r2..r5 с числом по адресу
                +1  6804     ;  r0- адрес младшего байта !!!
                +1  6805     ;результат- r2..r5
                +1  6806     ;***********************************************
                +1  6807     
299C C3         +1  6808     laddx:    clr       c
299D E2         +1  6809                                             movx            a,@r0
299E 2D         +1  6810                                             add                     a,r5
299F FD         +1  6811               mov     r5,a
29A0 18         +1  6812                             dec     r0
29A1 E2         +1  6813                             movx    a,@r0
29A2 3C         +1  6814                             addc    a,r4
29A3 FC         +1  6815                             mov     r4,a
29A4 18         +1  6816                             dec     r0
29A5 E2         +1  6817                             movx    a,@r0
29A6 3B         +1  6818                             addc    a,r3
29A7 FB         +1  6819                             mov     r3,a
29A8 18         +1  6820                             dec     r0
29A9 E2         +1  6821                             movx    a,@r0
29AA 3A         +1  6822                             addc    a,r2
29AB FA         +1  6823                             mov       r2,a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   109

29AC 22         +1  6824                             ret
                +1  6825     
                +1  6826     ;***********************************************
                +1  6827     ;                                                      ст мл
                +1  6828     ; cложение содержимого  r2..r5 с числом по адресу
                +1  6829     ;  dptr- адрес младшего байта !!!
                +1  6830     ;результат- r2..r5
                +1  6831     ;***********************************************
                +1  6832     
29AD C3         +1  6833     addx:    clr       c
29AE E0         +1  6834                                             movx            a,@dptr
29AF 2D         +1  6835                                             add                     a,r5
29B0 FD         +1  6836               mov     r5,a
29B1 120000   F +1  6837                             call            dedptr;dec     dptr
29B4 E0         +1  6838                             movx    a,@dptr
29B5 3C         +1  6839                             addc    a,r4
29B6 FC         +1  6840                             mov     r4,a
29B7 120000   F +1  6841                             call            dedptr;dec     dptr
29BA E0         +1  6842                             movx    a,@dptr
29BB 3B         +1  6843                             addc    a,r3
29BC FB         +1  6844                             mov     r3,a
29BD 120000   F +1  6845                             call            dedptr;dec     dptr
29C0 E0         +1  6846                             movx    a,@dptr
29C1 3A         +1  6847                             addc    a,r2
29C2 FA         +1  6848                             mov       r2,a
29C3 22         +1  6849                             ret
                +1  6850     
29C4 C0D0       +1  6851     dedptr:         push    psw
29C6 C3         +1  6852                                             clr             c
29C7 E582       +1  6853                                             mov             a,dpl
29C9 9401       +1  6854                                             subb    a,#1
29CB F582       +1  6855                                             mov             dpl,a
29CD E583       +1  6856                                             mov             a,dph
29CF 9400       +1  6857                                             subb    a,#0
29D1 F583       +1  6858                                             mov             dph,a
29D3 D0D0       +1  6859                                             pop             psw
29D5 22         +1  6860                                             ret
                    6861     
                    6862     ;$include (d:\amp\floatm.asm)
                +1  6863     ;       Copyright (C) 1988 HI-TECH Software
                +1  6864     
                +1  6865     ;       Single Precision Floating point arithmetic routines for 8051
                +1  6866     
                +1  6867     ;       The format of floating point numbers is as follows:
                +1  6868     
                +1  6869     ;       -----------------
                +1  6870     ;       *     sign      *  1 bit
                +1  6871     ;       -----------------
                +1  6872     ;       *   exponent    *  8 bits
                +1  6873     ;       -----------------
                +1  6874     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  6875     ;       -----------------
                +1  6876     
                +1  6877     
                +1  6878     ;       As usual for the 8051 the memory layout has the most significant
                +1  6879     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  6880     ;       lowest address.
                +1  6881     
                +1  6882     ;       Calling conventions:
                +1  6883     
                +1  6884     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  6885     ;
                +1  6886     ;       Return value is in r2-r5
                +1  6887     
                +1  6888     ;       Naming conventions: A routine name is constructed by
                +1  6889     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   110

                +1  6890     ;             ASOP
                +1  6891     
                +1  6892     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  6893     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  6894     ;       Conversion routines are named
                +1  6895     
                +1  6896     ;               AStof
                +1  6897     
                +1  6898     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  6899     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  6900     ;       Conversion from float to integer is ftol.
                +1  6901     
                +1  6902     ;               .ORG  5000h
                +1  6903     ;               .CODE
                +1  6904     ;       seg     c_text
                +1  6905     
                +1  6906     ;;      $MOD812
----            +1  6907             CSEG
                +1  6908             ;ORG 1000h
                +1  6909     
                +1  6910                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  6911             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  6912     
                +1  6913     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  6914     ;       macros
                +1  6915     
                +1  6916     saveregs        macro
                +1  6917             push    7
                +1  6918             push    6
                +1  6919             push    1
                +1  6920             push    0
                +1  6921             endm
                +1  6922     
                +1  6923     restregs        macro
                +1  6924             pop     0
                +1  6925             pop     1
                +1  6926             pop     6
                +1  6927             pop     7
                +1  6928             endm
                +1  6929     
                +1  6930     ;addr   
                +1  6931     dan     macro   pad
                +1  6932             mov     a,r5
                +1  6933             add     a,pad+3
                +1  6934             mov     pad+3,a
                +1  6935             mov     a,pad+2
                +1  6936             addc    a,r4
                +1  6937             mov     pad+2,a
                +1  6938             mov     a,pad+1
                +1  6939             addc    a,r3
                +1  6940             mov     pad+1,a
                +1  6941             mov     a,pad+0
                +1  6942             addc    a,r2
                +1  6943             mov     pad,a
                +1  6944             endm
                +1  6945     
                +1  6946     addl    macro  addr
                +1  6947             mov     a,r5
                +1  6948             add     a,addr+3
                +1  6949             mov     r5,a
                +1  6950             mov     a,addr+2
                +1  6951             addc    a,r4
                +1  6952             mov     r4,a
                +1  6953             mov     a,addr+1
                +1  6954             addc    a,r3
                +1  6955             mov     r3,a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   111

                +1  6956             mov     a,addr+0
                +1  6957             addc    a,r2
                +1  6958             mov     r2,a
                +1  6959             endm
                +1  6960     
                +1  6961     
                +1  6962     add1    macro
                +1  6963             mov     a,r5
                +1  6964             add     a,#1
                +1  6965             mov     r5,a
                +1  6966             clr     a
                +1  6967             addc    a,r4
                +1  6968             mov     r4,a
                +1  6969             clr     a
                +1  6970             addc    a,r3
                +1  6971             mov     r3,a
                +1  6972             clr     a
                +1  6973             addc    a,r2
                +1  6974             mov     r2,a
                +1  6975             endm
                +1  6976     
                +1  6977     shfdn   macro  addr
                +1  6978             clr     c
                +1  6979             mov     a,addr
                +1  6980             rrc     a
                +1  6981             mov     addr,a
                +1  6982             mov     a,addr+1
                +1  6983             rrc     a
                +1  6984             mov     addr+1,a
                +1  6985             mov     a,addr+2
                +1  6986             rrc     a
                +1  6987             mov     addr+2,a
                +1  6988             mov     a,addr+3
                +1  6989             rrc     a
                +1  6990             mov     addr+3,a
                +1  6991             endm
                +1  6992     
                +1  6993     shfup   macro  addr
                +1  6994             clr     c
                +1  6995             mov     a,addr+3
                +1  6996             rlc     a
                +1  6997             mov     addr+3,a
                +1  6998             mov     a,addr+2
                +1  6999             rlc     a
                +1  7000             mov     addr+2,a
                +1  7001             mov     a,addr+1
                +1  7002             rlc     a
                +1  7003             mov     addr+1,a
                +1  7004             mov     a,addr
                +1  7005             rlc     a
                +1  7006             mov     addr,a
                +1  7007             endm
                +1  7008     
                +1  7009     rshift  macro
                +1  7010             clr     c
                +1  7011             mov     a,r2
                +1  7012             rrc     a
                +1  7013             mov     r2,a
                +1  7014             mov     a,r3
                +1  7015             rrc     a
                +1  7016             mov     r3,a
                +1  7017             mov     a,r4
                +1  7018             rrc     a
                +1  7019             mov     r4,a
                +1  7020             mov     a,r5
                +1  7021             rrc     a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   112

                +1  7022             mov     r5,a
                +1  7023             endm
                +1  7024     rshift1 macro
                +1  7025             setb    c
                +1  7026             mov     a,r2
                +1  7027             rrc     a
                +1  7028             mov     r2,a
                +1  7029             mov     a,r3
                +1  7030             rrc     a
                +1  7031             mov     r3,a
                +1  7032             mov     a,r4
                +1  7033             rrc     a
                +1  7034             mov     r4,a
                +1  7035             mov     a,r5
                +1  7036             rrc     a
                +1  7037             mov     r5,a
                +1  7038             endm
                +1  7039     
                +1  7040     
                +1  7041     lshift  macro
                +1  7042             mov     a,r5
                +1  7043             rlc     a
                +1  7044             mov     r5,a
                +1  7045             mov     a,r4
                +1  7046             rlc     a
                +1  7047             mov     r4,a
                +1  7048             mov     a,r3
                +1  7049             rlc     a
                +1  7050             mov     r3,a
                +1  7051             mov     a,r2
                +1  7052             rlc     a
                +1  7053             mov     r2,a
                +1  7054             endm
                +1  7055     
                +1  7056     neg1    macro
                +1  7057             clr     c
                +1  7058             clr     a
                +1  7059             subb    a,r5
                +1  7060             mov     r5,a
                +1  7061             clr     a
                +1  7062             subb    a,r4
                +1  7063             mov     r4,a
                +1  7064             clr     a
                +1  7065             subb    a,r3
                +1  7066             mov     r3,a
                +1  7067             clr     a
                +1  7068             subb    a,r2
                +1  7069             mov     r2,a
                +1  7070             endm
                +1  7071     
                +1  7072     negm    macro  addr
                +1  7073             clr     c
                +1  7074             clr     a
                +1  7075             subb    a,addr+3
                +1  7076             mov     addr+3,a
                +1  7077             clr     a
                +1  7078             subb    a,addr+2
                +1  7079             mov     addr+2,a
                +1  7080             clr     a
                +1  7081             subb    a,addr+1
                +1  7082             mov     addr+1,a
                +1  7083             clr     a
                +1  7084             subb    a,addr
                +1  7085             mov     addr,a
                +1  7086             endm
                +1  7087     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   113

                +1  7088     copytor macro  addr
                +1  7089             mov     r2,addr
                +1  7090             mov     r3,addr+1
                +1  7091             mov     r4,addr+2
                +1  7092             mov     r5,addr+3
                +1  7093             endm
                +1  7094     
                +1  7095     
                +1  7096     copyrto macro  addr
                +1  7097             mov     addr,r2
                +1  7098             mov     addr+1,r3
                +1  7099             mov     addr+2,r4
                +1  7100             mov     addr+3,r5
                +1  7101             endm
                +1  7102     
                +1  7103     
                +1  7104     ;       Internal representation: in this set of routines a floating number
                +1  7105     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  7106     
                +1  7107     ;       Stack offset values
                +1  7108     ;ltemp   equ     28h
                +1  7109     
  0006          +1  7110     cntr    equ     6               ;r6 is the counter
  0007          +1  7111     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  7112     exp1    equ     0               ;exponent 1 in r0
  0002          +1  7113     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  7114     exp2    equ     1               ;exponent 1 in r1
  0008          +1  7115     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  7116     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  7117     
                +1  7118     
                +1  7119     
                +1  7120     
                +1  7121     
                +1  7122     ;DECSIZE EQU     10
                +1  7123     ;NUMSIZE EQU     4
                +1  7124     ;RR4     EQU     4
                +1  7125     ;RR5     EQU     5
                +1  7126     
                +1  7127     ;       unpack1 - unpacks the left operand
                +1  7128     
009E            +1  7129     unpack1:
009E EA         +1  7130             mov     a,r2            ;get sign
009F 5480       +1  7131             anl     a,#80h
00A1 530740     +1  7132             anl     sign,#40h       ;clear other bits
00A4 4207       +1  7133             orl     sign,a          ;store sign
00A6 EB         +1  7134             mov     a,r3            ;get lsb of exponent
00A7 33         +1  7135             rlc     a               ;rotate into carry
00A8 EA         +1  7136             mov     a,r2            ;get rest of exponent
00A9 33         +1  7137             rlc     a               ;and make it 8 bits
00AA F8         +1  7138             mov     r0,a            ;store it
00AB 6006       +1  7139             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  7140             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  7141             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  7142             ret
00B3            +1  7143     zer1:
00B3 E4         +1  7144             clr     a
00B4 FA         +1  7145             mov     r2,a
00B5 FB         +1  7146             mov     r3,a
00B6 FC         +1  7147             mov     r4,a
00B7 FD         +1  7148             mov     r5,a            ;zero mantissa
00B8 F8         +1  7149             mov     r0,a            ;zero exponent
00B9 22         +1  7150             ret
                +1  7151     
                +1  7152     ;       unpack2 - unpacks right operand
                +1  7153     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   114

00BA            +1  7154     unpack2:
00BA E508       +1  7155             mov     a,ltemp         ;get sign
00BC 13         +1  7156             rrc     a               ;shift down
00BD 5440       +1  7157             anl     a,#40h          ;mask out sign
00BF 530780     +1  7158             anl     sign,#80h       ;clear old bit
00C2 4207       +1  7159             orl     sign,a
00C4 E509       +1  7160             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  7161             rlc     a               ;rotate into carry
00C7 E508       +1  7162             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  7163             rlc     a               ;and make it 8 bits
00CA F9         +1  7164             mov     r1,a            ;store it
00CB 6007       +1  7165             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  7166             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  7167             mov     mant2,#0        ;clear upper byte
00D3 22         +1  7168             ret
00D4            +1  7169     zer2:
00D4 E4         +1  7170             clr     a
00D5 F508       +1  7171             mov     ltemp,a
00D7 F509       +1  7172             mov     ltemp+1,a
00D9 F50A       +1  7173             mov     ltemp+2,a
00DB F50B       +1  7174             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  7175             ret
                +1  7176     
                +1  7177     ;       pack1 - put operand 1 back into float format
                +1  7178     
00DE            +1  7179     pack1:
00DE E8         +1  7180             mov     a,r0            ;get exponent
00DF C3         +1  7181             clr     c
00E0 13         +1  7182             rrc     a               ;shift down 1 bit
00E1 530780     +1  7183             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  7184             orl     a,r7            ;or in sign bit
00E5 FA         +1  7185             mov     r2,a            ;store
00E6 E8         +1  7186             mov     a,r0            ;get other bit
00E7 03         +1  7187             rr      a               ;rotate into hi bit
00E8 5480       +1  7188             anl     a,#80h          ;mask
00EA 53037F     +1  7189             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  7190             orl     mant1+1,a       ;put in
00EF 22         +1  7191             ret
                +1  7192     
                +1  7193     
                +1  7194     ;       norm1 - normalize the unpacked value in 1
                +1  7195     
00F0            +1  7196     norm1:
00F0 E8         +1  7197             mov     a,r0            ;get exponent
00F1 60C0       +1  7198             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  7199             mov     a,r2            ;get hi byte
00F4 6023       +1  7200             jz      norup           ;zero, so shift up if anything
00F6            +1  7201     nordn:
00F6 EA         +1  7202             mov     a,r2            ;get hi byte
00F7 B4010D     +1  7203             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  7204+3           add1                    ;add in a rounding bit
00FA ED         +1  7205+1           mov     a,r5
00FB 2401       +1  7206+1           add     a,#1
00FD FD         +1  7207+1           mov     r5,a
00FE E4         +1  7208+1           clr     a
00FF 3C         +1  7209+1           addc    a,r4
0100 FC         +1  7210+1           mov     r4,a
0101 E4         +1  7211+1           clr     a
0102 3B         +1  7212+1           addc    a,r3
0103 FB         +1  7213+1           mov     r3,a
0104 E4         +1  7214+1           clr     a
0105 3A         +1  7215+1           addc    a,r2
0106 FA         +1  7216+1           mov     r2,a
0107            +1  7217     nordn1:
                +1  7218+3           rshift                  ;shift down 1 bit
0107 C3         +1  7219+1           clr     c
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   115

0108 EA         +1  7220+1           mov     a,r2
0109 13         +1  7221+1           rrc     a
010A FA         +1  7222+1           mov     r2,a
010B EB         +1  7223+1           mov     a,r3
010C 13         +1  7224+1           rrc     a
010D FB         +1  7225+1           mov     r3,a
010E EC         +1  7226+1           mov     a,r4
010F 13         +1  7227+1           rrc     a
0110 FC         +1  7228+1           mov     r4,a
0111 ED         +1  7229+1           mov     a,r5
0112 13         +1  7230+1           rrc     a
0113 FD         +1  7231+1           mov     r5,a
0114 08         +1  7232             inc     r0              ;adjust exponent
0115 EA         +1  7233             mov     a,r2            ;test high byte
0116 70DE       +1  7234             jnz     nordn           ;loop
0118 22         +1  7235             ret                     ;done
                +1  7236     
0119            +1  7237     norup:
0119 4B         +1  7238             orl     a,r3
011A 4C         +1  7239             orl     a,r4
011B 4D         +1  7240             orl     a,r5            ;test for zero mantissa
011C 6095       +1  7241             jz      zer1            ;it is - make it true zero
011E            +1  7242     norup1:
011E EB         +1  7243             mov     a,r3            ;get mantissa byte
011F 20E710     +1  7244             jb      acc.7,norup2    ;jump if set
0122 C3         +1  7245             clr     c
                +1  7246+3           lshift                  ;shift mantissa up
0123 ED         +1  7247+1           mov     a,r5
0124 33         +1  7248+1           rlc     a
0125 FD         +1  7249+1           mov     r5,a
0126 EC         +1  7250+1           mov     a,r4
0127 33         +1  7251+1           rlc     a
0128 FC         +1  7252+1           mov     r4,a
0129 EB         +1  7253+1           mov     a,r3
012A 33         +1  7254+1           rlc     a
012B FB         +1  7255+1           mov     r3,a
012C EA         +1  7256+1           mov     a,r2
012D 33         +1  7257+1           rlc     a
012E FA         +1  7258+1           mov     r2,a
012F 18         +1  7259             dec     r0              ;adjust exponent
0130 80EC       +1  7260             jmp     norup1
0132            +1  7261     norup2:
0132 22         +1  7262             ret                     ;finito
                +1  7263     
                +1  7264     
                +1  7265     ;       fpdenorm - denormalize one of the two operands so that their
                +1  7266     ;       exponents are equal. This requires the smaller number to have
                +1  7267     ;       its exponent incremented and its mantissa shifted right.
                +1  7268     
0133            +1  7269     denorm:
0133 E8         +1  7270             mov     a,r0
0134 C3         +1  7271             clr     c
0135 99         +1  7272             subb    a,r1            ;compare exponents
0136 5029       +1  7273             jnc     up2a            ;shift operand 2
0138            +1  7274     up1:
0138 08         +1  7275             inc     r0              ;increment exponent
                +1  7276+3           rshift                  ;shift mantissa down
0139 C3         +1  7277+1           clr     c
013A EA         +1  7278+1           mov     a,r2
013B 13         +1  7279+1           rrc     a
013C FA         +1  7280+1           mov     r2,a
013D EB         +1  7281+1           mov     a,r3
013E 13         +1  7282+1           rrc     a
013F FB         +1  7283+1           mov     r3,a
0140 EC         +1  7284+1           mov     a,r4
0141 13         +1  7285+1           rrc     a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   116

0142 FC         +1  7286+1           mov     r4,a
0143 ED         +1  7287+1           mov     a,r5
0144 13         +1  7288+1           rrc     a
0145 FD         +1  7289+1           mov     r5,a
0146 E8         +1  7290             mov     a,r0
0147 B501EE     +1  7291             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  7292             ret
                +1  7293     
014B            +1  7294     up2:
014B 09         +1  7295             inc     r1              ;increment exponent 2
                +1  7296+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  7297+1           clr     c
014D E508       +1  7298+1           mov     a,mant2
014F 13         +1  7299+1           rrc     a
0150 F508       +1  7300+1           mov     mant2,a
0152 E509       +1  7301+1           mov     a,mant2+1
0154 13         +1  7302+1           rrc     a
0155 F509       +1  7303+1           mov     mant2+1,a
0157 E50A       +1  7304+1           mov     a,mant2+2
0159 13         +1  7305+1           rrc     a
015A F50A       +1  7306+1           mov     mant2+2,a
015C E50B       +1  7307+1           mov     a,mant2+3
015E 13         +1  7308+1           rrc     a
015F F50B       +1  7309+1           mov     mant2+3,a
0161            +1  7310     up2a:
0161 E8         +1  7311             mov     a,r0            ;compare exponents
0162 B501E6     +1  7312             cjne    a,exp2,up2
0165 22         +1  7313             ret                     ;all done
                +1  7314     ;------------------------------------------------------------------
                +1  7315     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  7316     
0166            +1  7317     fladd:
                +1  7318+3           saveregs
0166 C007       +1  7319+1           push    7
0168 C006       +1  7320+1           push    6
016A C001       +1  7321+1           push    1
016C C000       +1  7322+1           push    0
016E 119E       +1  7323             call    unpack1
0170 11BA       +1  7324             call    unpack2
0172 3133       +1  7325             call    denorm
0174 E507       +1  7326             mov     a,sign
0176 30E70D     +1  7327             jnb     acc.7,ok1       ;test left sign
                +1  7328+3           neg1                    ;negate op1
0179 C3         +1  7329+1           clr     c
017A E4         +1  7330+1           clr     a
017B 9D         +1  7331+1           subb    a,r5
017C FD         +1  7332+1           mov     r5,a
017D E4         +1  7333+1           clr     a
017E 9C         +1  7334+1           subb    a,r4
017F FC         +1  7335+1           mov     r4,a
0180 E4         +1  7336+1           clr     a
0181 9B         +1  7337+1           subb    a,r3
0182 FB         +1  7338+1           mov     r3,a
0183 E4         +1  7339+1           clr     a
0184 9A         +1  7340+1           subb    a,r2
0185 FA         +1  7341+1           mov     r2,a
0186            +1  7342     ok1:
0186 E507       +1  7343             mov     a,sign
0188 30E615     +1  7344             jnb     acc.6,ok2       ;test right sign
                +1  7345+3           negm    mant2           ;negate op2
018B C3         +1  7346+1           clr     c
018C E4         +1  7347+1           clr     a
018D 950B       +1  7348+1           subb    a,mant2+3
018F F50B       +1  7349+1           mov     mant2+3,a
0191 E4         +1  7350+1           clr     a
0192 950A       +1  7351+1           subb    a,mant2+2
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   117

0194 F50A       +1  7352+1           mov     mant2+2,a
0196 E4         +1  7353+1           clr     a
0197 9509       +1  7354+1           subb    a,mant2+1
0199 F509       +1  7355+1           mov     mant2+1,a
019B E4         +1  7356+1           clr     a
019C 9508       +1  7357+1           subb    a,mant2
019E F508       +1  7358+1           mov     mant2,a
01A0            +1  7359     ok2:
                +1  7360+3           addl    mant2           ;add mantissas
01A0 ED         +1  7361+1           mov     a,r5
01A1 250B       +1  7362+1           add     a,mant2+3
01A3 FD         +1  7363+1           mov     r5,a
01A4 E50A       +1  7364+1           mov     a,mant2+2
01A6 3C         +1  7365+1           addc    a,r4
01A7 FC         +1  7366+1           mov     r4,a
01A8 E509       +1  7367+1           mov     a,mant2+1
01AA 3B         +1  7368+1           addc    a,r3
01AB FB         +1  7369+1           mov     r3,a
01AC E508       +1  7370+1           mov     a,mant2+0
01AE 3A         +1  7371+1           addc    a,r2
01AF FA         +1  7372+1           mov     r2,a
01B0 E4         +1  7373             clr     a
01B1 FF         +1  7374             mov     r7,a            ;clear sign
01B2 EA         +1  7375             mov     a,r2            ;get sign of result
01B3 30E70E     +1  7376             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  7377             mov     r7,a            ;store sign
                +1  7378+3           neg1                    ;negate mantissa
01B7 C3         +1  7379+1           clr     c
01B8 E4         +1  7380+1           clr     a
01B9 9D         +1  7381+1           subb    a,r5
01BA FD         +1  7382+1           mov     r5,a
01BB E4         +1  7383+1           clr     a
01BC 9C         +1  7384+1           subb    a,r4
01BD FC         +1  7385+1           mov     r4,a
01BE E4         +1  7386+1           clr     a
01BF 9B         +1  7387+1           subb    a,r3
01C0 FB         +1  7388+1           mov     r3,a
01C1 E4         +1  7389+1           clr     a
01C2 9A         +1  7390+1           subb    a,r2
01C3 FA         +1  7391+1           mov     r2,a
01C4            +1  7392     ok3:
01C4 11F0       +1  7393             call    norm1
01C6 11DE       +1  7394             call    pack1           ;pack normalized result
                +1  7395+3           restregs                ;and return
01C8 D000       +1  7396+1           pop     0
01CA D001       +1  7397+1           pop     1
01CC D006       +1  7398+1           pop     6
01CE D007       +1  7399+1           pop     7
01D0 22         +1  7400             ret
                +1  7401     ;-------------------------------------------------------------
                +1  7402     ;       Subtract the number ltemp from the number in r2-r5
                +1  7403     
01D1            +1  7404     flsub:
01D1 630880     +1  7405             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  7406             jmp     fladd           ;and add!
                +1  7407     
                +1  7408     ;================================================================
                +1  7409     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  7410     
01D6            +1  7411     flcmp:
01D6 EA         +1  7412            mov     a,r2            ;get sign of left
01D7 6508       +1  7413            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  7414            jnb     acc.7,cexp      ;same, go check exponent
                +1  7415     ;ifdef SMALL_MODEL
01DC EA         +1  7416             mov     a,r2            ;get sign of left again
01DD 33         +1  7417             rlc     a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   118

01DE 5001       +1  7418             jnc     flout
                +1  7419     ;endif
01E0 D3         +1  7420             setb    c
01E1 22         +1  7421     flout:          ret                    ;return with acc < 0
                +1  7422     
01E2            +1  7423     cexp:
01E2 C3         +1  7424            clr     c
01E3 EA         +1  7425            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  7426            subb    a,ltemp
01E6 7010       +1  7427            jnz     fnd
01E8 EB         +1  7428            mov     a,r3
01E9 9509       +1  7429            subb    a,ltemp+1
01EB 700B       +1  7430            jnz     fnd
01ED EC         +1  7431            mov     a,r4
01EE 950A       +1  7432            subb    a,ltemp+2
01F0 7006       +1  7433            jnz     fnd
01F2 ED         +1  7434            mov     a,r5
01F3 950B       +1  7435            subb    a,ltemp+3
01F5 7001       +1  7436            jnz     fnd
01F7            +1  7437     cdone:
01F7 22         +1  7438            ret                     ;return with acc == 0
01F8            +1  7439     fnd:
01F8 8AF0       +1  7440           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  7441          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  7442            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  7443                         orl         a,#1                          ;make non-zero
0201 B3         +1  7444             cpl     c               ;c=0->1,c=1->0
0202 22         +1  7445             ret
                +1  7446     ;==============================================================
                +1  7447     
                +1  7448     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  7449     ;       the result in r2-r5
                +1  7450     
0203            +1  7451     flmul:
                +1  7452+3           saveregs
0203 C007       +1  7453+1           push    7
0205 C006       +1  7454+1           push    6
0207 C001       +1  7455+1           push    1
0209 C000       +1  7456+1           push    0
020B 119E       +1  7457             call    unpack1
020D 11BA       +1  7458             call    unpack2
020F E4         +1  7459             clr     a
0210 F50C       +1  7460             mov     prod,a
0212 F50D       +1  7461             mov     prod+1,a        ;clear product
0214 F50E       +1  7462             mov     prod+2,a
0216 F50F       +1  7463             mov     prod+3,a
0218 7E07       +1  7464             mov     r6,#7           ;initialize counter
021A            +1  7465     mup1:
                +1  7466+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  7467+1           clr     c
021B E508       +1  7468+1           mov     a,mant2
021D 13         +1  7469+1           rrc     a
021E F508       +1  7470+1           mov     mant2,a
0220 E509       +1  7471+1           mov     a,mant2+1
0222 13         +1  7472+1           rrc     a
0223 F509       +1  7473+1           mov     mant2+1,a
0225 E50A       +1  7474+1           mov     a,mant2+2
0227 13         +1  7475+1           rrc     a
0228 F50A       +1  7476+1           mov     mant2+2,a
022A E50B       +1  7477+1           mov     a,mant2+3
022C 13         +1  7478+1           rrc     a
022D F50B       +1  7479+1           mov     mant2+3,a
022F 5014       +1  7480             jnc     nobit           ;skip if lsb was zero
                +1  7481+3           dan     prod            ;add multiplicand to product
0231 ED         +1  7482+1           mov     a,r5
0232 250F       +1  7483+1           add     a,prod+3
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   119

0234 F50F       +1  7484+1           mov     prod+3,a
0236 E50E       +1  7485+1           mov     a,prod+2
0238 3C         +1  7486+1           addc    a,r4
0239 F50E       +1  7487+1           mov     prod+2,a
023B E50D       +1  7488+1           mov     a,prod+1
023D 3B         +1  7489+1           addc    a,r3
023E F50D       +1  7490+1           mov     prod+1,a
0240 E50C       +1  7491+1           mov     a,prod+0
0242 3A         +1  7492+1           addc    a,r2
0243 F50C       +1  7493+1           mov     prod,a
0245            +1  7494     nobit:
                +1  7495+3           lshift                  ;shift multiplicand up
0245 ED         +1  7496+1           mov     a,r5
0246 33         +1  7497+1           rlc     a
0247 FD         +1  7498+1           mov     r5,a
0248 EC         +1  7499+1           mov     a,r4
0249 33         +1  7500+1           rlc     a
024A FC         +1  7501+1           mov     r4,a
024B EB         +1  7502+1           mov     a,r3
024C 33         +1  7503+1           rlc     a
024D FB         +1  7504+1           mov     r3,a
024E EA         +1  7505+1           mov     a,r2
024F 33         +1  7506+1           rlc     a
0250 FA         +1  7507+1           mov     r2,a
0251 DEC7       +1  7508             djnz    r6,mup1         ;loop if more
                +1  7509     
0253 7E11       +1  7510             mov     r6,#17          ;re-initalize counter
0255 8015       +1  7511             sjmp    mup3
0257            +1  7512     mup11:
                +1  7513+3           shfdn   prod            ;shift product right
0257 C3         +1  7514+1           clr     c
0258 E50C       +1  7515+1           mov     a,prod
025A 13         +1  7516+1           rrc     a
025B F50C       +1  7517+1           mov     prod,a
025D E50D       +1  7518+1           mov     a,prod+1
025F 13         +1  7519+1           rrc     a
0260 F50D       +1  7520+1           mov     prod+1,a
0262 E50E       +1  7521+1           mov     a,prod+2
0264 13         +1  7522+1           rrc     a
0265 F50E       +1  7523+1           mov     prod+2,a
0267 E50F       +1  7524+1           mov     a,prod+3
0269 13         +1  7525+1           rrc     a
026A F50F       +1  7526+1           mov     prod+3,a
026C            +1  7527     mup3:
                +1  7528+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  7529+1           clr     c
026D E508       +1  7530+1           mov     a,mant2
026F 13         +1  7531+1           rrc     a
0270 F508       +1  7532+1           mov     mant2,a
0272 E509       +1  7533+1           mov     a,mant2+1
0274 13         +1  7534+1           rrc     a
0275 F509       +1  7535+1           mov     mant2+1,a
0277 E50A       +1  7536+1           mov     a,mant2+2
0279 13         +1  7537+1           rrc     a
027A F50A       +1  7538+1           mov     mant2+2,a
027C E50B       +1  7539+1           mov     a,mant2+3
027E 13         +1  7540+1           rrc     a
027F F50B       +1  7541+1           mov     mant2+3,a
0281 5014       +1  7542             jnc     mup2            ;skip if bit not set
                +1  7543+3           dan     prod            ;add to prod
0283 ED         +1  7544+1           mov     a,r5
0284 250F       +1  7545+1           add     a,prod+3
0286 F50F       +1  7546+1           mov     prod+3,a
0288 E50E       +1  7547+1           mov     a,prod+2
028A 3C         +1  7548+1           addc    a,r4
028B F50E       +1  7549+1           mov     prod+2,a
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   120

028D E50D       +1  7550+1           mov     a,prod+1
028F 3B         +1  7551+1           addc    a,r3
0290 F50D       +1  7552+1           mov     prod+1,a
0292 E50C       +1  7553+1           mov     a,prod+0
0294 3A         +1  7554+1           addc    a,r2
0295 F50C       +1  7555+1           mov     prod,a
0297            +1  7556     mup2:
0297 DEBE       +1  7557             djnz    r6,mup11        ;loop if more
0299 E8         +1  7558             mov     a,r0            ;get exp1
029A 29         +1  7559             add     a,r1            ;add exp2
029B 247A       +1  7560             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  7561             mov     r0,a            ;store
029E EF         +1  7562             mov     a,r7            ;get sign
029F 23         +1  7563             rl      a               ;rotate bit into msb
02A0 6207       +1  7564             xrl     sign,a          ;xor with other bit
                +1  7565+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  7566+1           mov     r2,prod
02A4 AB0D       +1  7567+1           mov     r3,prod+1
02A6 AC0E       +1  7568+1           mov     r4,prod+2
02A8 AD0F       +1  7569+1           mov     r5,prod+3
02AA 11F0       +1  7570             call    norm1           ;normalize
02AC 11DE       +1  7571             call    pack1
                +1  7572+3           restregs
02AE D000       +1  7573+1           pop     0
02B0 D001       +1  7574+1           pop     1
02B2 D006       +1  7575+1           pop     6
02B4 D007       +1  7576+1           pop     7
02B6 22         +1  7577             ret
                +1  7578     ;-----------------------------------------------------------
                +1  7579     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  7580     
02B7            +1  7581     fldiv:
                +1  7582+3           saveregs
02B7 C007       +1  7583+1           push    7
02B9 C006       +1  7584+1           push    6
02BB C001       +1  7585+1           push    1
02BD C000       +1  7586+1           push    0
02BF 119E       +1  7587             call    unpack1
02C1 11BA       +1  7588             call    unpack2
02C3 E4         +1  7589             clr     a
02C4 F50C       +1  7590             mov     prod,a
02C6 F50D       +1  7591             mov     prod+1,a
02C8 F50E       +1  7592             mov     prod+2,a
02CA F50F       +1  7593             mov     prod+3,a
02CC E9         +1  7594             mov     a,r1            ;check for zero divisor
02CD 6067       +1  7595             jz      div9
02CF E8         +1  7596             mov     a,r0            ;check for zero dividend
02D0 6064       +1  7597             jz      div9
02D2 C3         +1  7598             clr     c
02D3 99         +1  7599             subb    a,r1            ;compute new exponent
02D4 2478       +1  7600             add     a,#127-7        ;unbias
02D6 F8         +1  7601             mov     r0,a            ;store back
02D7 EF         +1  7602             mov     a,r7            ;get sign
02D8 23         +1  7603             rl      a
02D9 6207       +1  7604             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  7605             mov     r6,#24+7        ;initialize counter
02DD            +1  7606     div1:
                +1  7607+3           shfup   prod            ;shift quotient up
02DD C3         +1  7608+1           clr     c
02DE E50F       +1  7609+1           mov     a,prod+3
02E0 33         +1  7610+1           rlc     a
02E1 F50F       +1  7611+1           mov     prod+3,a
02E3 E50E       +1  7612+1           mov     a,prod+2
02E5 33         +1  7613+1           rlc     a
02E6 F50E       +1  7614+1           mov     prod+2,a
02E8 E50D       +1  7615+1           mov     a,prod+1
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   121

02EA 33         +1  7616+1           rlc     a
02EB F50D       +1  7617+1           mov     prod+1,a
02ED E50C       +1  7618+1           mov     a,prod
02EF 33         +1  7619+1           rlc     a
02F0 F50C       +1  7620+1           mov     prod,a
02F2 C3         +1  7621             clr     c
02F3 EA         +1  7622             mov     a,r2            ;compare values
02F4 9508       +1  7623             subb    a,mant2
02F6 4028       +1  7624             jc      div2            ;skip if bigger
02F8 7013       +1  7625             jnz     div3
02FA EB         +1  7626             mov     a,r3            ;compare values
02FB 9509       +1  7627             subb    a,mant2+1
02FD 4021       +1  7628             jc      div2            ;skip if bigger
02FF 700C       +1  7629             jnz     div3
0301 EC         +1  7630             mov     a,r4            ;compare values
0302 950A       +1  7631             subb    a,mant2+2
0304 401A       +1  7632             jc      div2            ;skip if bigger
0306 7005       +1  7633             jnz     div3
0308 ED         +1  7634             mov     a,r5            ;compare values
0309 950B       +1  7635             subb    a,mant2+3
030B 4013       +1  7636             jc      div2            ;skip if bigger
030D            +1  7637     div3:
030D ED         +1  7638             mov     a,r5
030E 950B       +1  7639             subb    a,mant2+3
0310 FD         +1  7640             mov     r5,a
0311 EC         +1  7641             mov     a,r4
0312 950A       +1  7642             subb    a,mant2+2               ;do subtraction
0314 FC         +1  7643             mov     r4,a
0315 EB         +1  7644             mov     a,r3
0316 9509       +1  7645             subb    a,mant2+1               ;do subtraction
0318 FB         +1  7646             mov     r3,a
0319 EA         +1  7647             mov     a,r2
031A 9508       +1  7648             subb    a,mant2         ;do subtraction
031C FA         +1  7649             mov     r2,a
031D 430F01     +1  7650             orl     prod+3,#1       ;set lsb in quotient
0320            +1  7651     div2:
                +1  7652+3           lshift                  ;shift dividend up
0320 ED         +1  7653+1           mov     a,r5
0321 33         +1  7654+1           rlc     a
0322 FD         +1  7655+1           mov     r5,a
0323 EC         +1  7656+1           mov     a,r4
0324 33         +1  7657+1           rlc     a
0325 FC         +1  7658+1           mov     r4,a
0326 EB         +1  7659+1           mov     a,r3
0327 33         +1  7660+1           rlc     a
0328 FB         +1  7661+1           mov     r3,a
0329 EA         +1  7662+1           mov     a,r2
032A 33         +1  7663+1           rlc     a
032B FA         +1  7664+1           mov     r2,a
032C DEAF       +1  7665             djnz    r6,div1         ;loop if more
                +1  7666+3           copytor prod            ;copy quotient
032E AA0C       +1  7667+1           mov     r2,prod
0330 AB0D       +1  7668+1           mov     r3,prod+1
0332 AC0E       +1  7669+1           mov     r4,prod+2
0334 AD0F       +1  7670+1           mov     r5,prod+3
0336            +1  7671     div9:
0336 11F0       +1  7672             call    norm1           ;now normalize result
0338 11DE       +1  7673             call    pack1           ;pack it up
                +1  7674+3           restregs                ;restore registers
033A D000       +1  7675+1           pop     0
033C D001       +1  7676+1           pop     1
033E D006       +1  7677+1           pop     6
0340 D007       +1  7678+1           pop     7
0342 22         +1  7679             ret
                +1  7680     ;------------------------------------------------------------------
                +1  7681     
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   122

                +1  7682     ;       Float to long conversion: if the exponent is less than the
                +1  7683     ;       excess value, the result is zero. If the exponent is so large
                +1  7684     ;       that the value would be shifted out, the result is overflow.
                +1  7685     ;       Otherwise shift the mantissa up or down as required.
                +1  7686     
0343            +1  7687     ftol:
                +1  7688+3           saveregs
0343 C007       +1  7689+1           push    7
0345 C006       +1  7690+1           push    6
0347 C001       +1  7691+1           push    1
0349 C000       +1  7692+1           push    0
034B EA         +1  7693             mov     a,r2
034C B4BF09     +1  7694             cjne    a,#0bfh,ne05
034F EB         +1  7695             mov     a,r3
0350 7006       +1  7696             jnz     ne05
0352 EC         +1  7697             mov     a,r4
0353 7003       +1  7698             jnz     ne05
0355 ED         +1  7699             mov     a,r5
0356 6024       +1  7700             jz      ftol1
0358 119E       +1  7701     ne05:   call    unpack1
035A E8         +1  7702             mov     a,r0            ;get exponent
035B 2482       +1  7703             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  7704             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  7705             mov     a,r7            ;get sign
0361 30E70D     +1  7706             jnb     acc.7,ftol4     ;skip if +ve
                +1  7707+3           neg1                    ;negate it
0364 C3         +1  7708+1           clr     c
0365 E4         +1  7709+1           clr     a
0366 9D         +1  7710+1           subb    a,r5
0367 FD         +1  7711+1           mov     r5,a
0368 E4         +1  7712+1           clr     a
0369 9C         +1  7713+1           subb    a,r4
036A FC         +1  7714+1           mov     r4,a
036B E4         +1  7715+1           clr     a
036C 9B         +1  7716+1           subb    a,r3
036D FB         +1  7717+1           mov     r3,a
036E E4         +1  7718+1           clr     a
036F 9A         +1  7719+1           subb    a,r2
0370 FA         +1  7720+1           mov     r2,a
0371            +1  7721     ftol4:
0371 E8         +1  7722             mov     a,r0            ;get exponent
0372 246A       +1  7723             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  7724             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  7725             mov     r0,a            ;save it
0378 24F8       +1  7726             add     a,#-8           ;if > 8, too big
037A 500E       +1  7727             jnc     ftol3
037C            +1  7728     ftol1:
037C E4         +1  7729             clr     a
037D FA         +1  7730             mov     r2,a
037E FB         +1  7731             mov     r3,a
037F FC         +1  7732             mov     r4,a
0380 FD         +1  7733             mov     r5,a
0381            +1  7734     ftol9:
                +1  7735+3           restregs
0381 D000       +1  7736+1           pop     0
0383 D001       +1  7737+1           pop     1
0385 D006       +1  7738+1           pop     6
0387 D007       +1  7739+1           pop     7
0389 22         +1  7740             ret
038A            +1  7741     ftol3:
038A E8         +1  7742             mov     a,r0
038B FE         +1  7743             mov     r6,a            ;store in counter
038C 60F3       +1  7744             jz      ftol9           ;if zero, do nothing
038E            +1  7745     ftol33:
                +1  7746+3           lshift                  ;shift up
038E ED         +1  7747+1           mov     a,r5
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   123

038F 33         +1  7748+1           rlc     a
0390 FD         +1  7749+1           mov     r5,a
0391 EC         +1  7750+1           mov     a,r4
0392 33         +1  7751+1           rlc     a
0393 FC         +1  7752+1           mov     r4,a
0394 EB         +1  7753+1           mov     a,r3
0395 33         +1  7754+1           rlc     a
0396 FB         +1  7755+1           mov     r3,a
0397 EA         +1  7756+1           mov     a,r2
0398 33         +1  7757+1           rlc     a
0399 FA         +1  7758+1           mov     r2,a
039A DEF2       +1  7759             djnz    r6,ftol33       ;and loop
039C 80E3       +1  7760             sjmp    ftol9
039E            +1  7761     ftol2:
039E F4         +1  7762             cpl     a               ;complement
039F FE         +1  7763             mov     r6,a
03A0 6022       +1  7764             jz      ftol22
03A2            +1  7765     ftol23:
03A2 EF         +1  7766             mov     a,r7
03A3 30E70F     +1  7767             jnb     acc.7,ftol24
                +1  7768+3           rshift1
03A6 D3         +1  7769+1           setb    c
03A7 EA         +1  7770+1           mov     a,r2
03A8 13         +1  7771+1           rrc     a
03A9 FA         +1  7772+1           mov     r2,a
03AA EB         +1  7773+1           mov     a,r3
03AB 13         +1  7774+1           rrc     a
03AC FB         +1  7775+1           mov     r3,a
03AD EC         +1  7776+1           mov     a,r4
03AE 13         +1  7777+1           rrc     a
03AF FC         +1  7778+1           mov     r4,a
03B0 ED         +1  7779+1           mov     a,r5
03B1 13         +1  7780+1           rrc     a
03B2 FD         +1  7781+1           mov     r5,a
03B3 800D       +1  7782             jmp     ftol25
03B5            +1  7783+3   ftol24: rshift                  ;shift down
03B5 C3         +1  7784+1           clr     c
03B6 EA         +1  7785+1           mov     a,r2
03B7 13         +1  7786+1           rrc     a
03B8 FA         +1  7787+1           mov     r2,a
03B9 EB         +1  7788+1           mov     a,r3
03BA 13         +1  7789+1           rrc     a
03BB FB         +1  7790+1           mov     r3,a
03BC EC         +1  7791+1           mov     a,r4
03BD 13         +1  7792+1           rrc     a
03BE FC         +1  7793+1           mov     r4,a
03BF ED         +1  7794+1           mov     a,r5
03C0 13         +1  7795+1           rrc     a
03C1 FD         +1  7796+1           mov     r5,a
03C2 DEDE       +1  7797     ftol25: djnz    r6,ftol23
03C4            +1  7798     ftol22:
                +1  7799+3           add1                    ;round
03C4 ED         +1  7800+1           mov     a,r5
03C5 2401       +1  7801+1           add     a,#1
03C7 FD         +1  7802+1           mov     r5,a
03C8 E4         +1  7803+1           clr     a
03C9 3C         +1  7804+1           addc    a,r4
03CA FC         +1  7805+1           mov     r4,a
03CB E4         +1  7806+1           clr     a
03CC 3B         +1  7807+1           addc    a,r3
03CD FB         +1  7808+1           mov     r3,a
03CE E4         +1  7809+1           clr     a
03CF 3A         +1  7810+1           addc    a,r2
03D0 FA         +1  7811+1           mov     r2,a
03D1 EF         +1  7812             mov     a,r7
03D2 30E70F     +1  7813             jnb     acc.7,ftol26
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   124

                +1  7814+3           rshift1
03D5 D3         +1  7815+1           setb    c
03D6 EA         +1  7816+1           mov     a,r2
03D7 13         +1  7817+1           rrc     a
03D8 FA         +1  7818+1           mov     r2,a
03D9 EB         +1  7819+1           mov     a,r3
03DA 13         +1  7820+1           rrc     a
03DB FB         +1  7821+1           mov     r3,a
03DC EC         +1  7822+1           mov     a,r4
03DD 13         +1  7823+1           rrc     a
03DE FC         +1  7824+1           mov     r4,a
03DF ED         +1  7825+1           mov     a,r5
03E0 13         +1  7826+1           rrc     a
03E1 FD         +1  7827+1           mov     r5,a
03E2 809D       +1  7828             jmp     ftol9
03E4            +1  7829+3   ftol26: rshift
03E4 C3         +1  7830+1           clr     c
03E5 EA         +1  7831+1           mov     a,r2
03E6 13         +1  7832+1           rrc     a
03E7 FA         +1  7833+1           mov     r2,a
03E8 EB         +1  7834+1           mov     a,r3
03E9 13         +1  7835+1           rrc     a
03EA FB         +1  7836+1           mov     r3,a
03EB EC         +1  7837+1           mov     a,r4
03EC 13         +1  7838+1           rrc     a
03ED FC         +1  7839+1           mov     r4,a
03EE ED         +1  7840+1           mov     a,r5
03EF 13         +1  7841+1           rrc     a
03F0 FD         +1  7842+1           mov     r5,a
03F1 808E       +1  7843             jmp     ftol9
                +1  7844     
                +1  7845     ;       arithmetic integer to floating conversions
                +1  7846     
03F3            +1  7847     abtof:
03F3 ED         +1  7848             mov     a,r5
03F4 23         +1  7849             rl      a
03F5 FC         +1  7850             mov     r4,a
03F6 9C         +1  7851             subb    a,r4
03F7 FC         +1  7852             mov     r4,a
03F8 FB         +1  7853             mov     r3,a
03F9 FA         +1  7854             mov     r2,a
03FA 8006       +1  7855             jmp     altof
03FC            +1  7856     awtof:
03FC EC         +1  7857             mov     a,r4
03FD 23         +1  7858             rl      a
03FE FB         +1  7859             mov     r3,a
03FF 9B         +1  7860             subb    a,r3
0400 FB         +1  7861             mov     r3,a
0401 FA         +1  7862             mov     r2,a
0402            +1  7863     altof:
                +1  7864+3           saveregs
0402 C007       +1  7865+1           push    7
0404 C006       +1  7866+1           push    6
0406 C001       +1  7867+1           push    1
0408 C000       +1  7868+1           push    0
040A EA         +1  7869             mov     a,r2            ;get sign
040B 5480       +1  7870             anl     a,#80h
040D FF         +1  7871             mov     r7,a            ;store it
040E 30E70D     +1  7872             jnb     acc.7,altof1    ;skip if +ve
                +1  7873+3           neg1
0411 C3         +1  7874+1           clr     c
0412 E4         +1  7875+1           clr     a
0413 9D         +1  7876+1           subb    a,r5
0414 FD         +1  7877+1           mov     r5,a
0415 E4         +1  7878+1           clr     a
0416 9C         +1  7879+1           subb    a,r4
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   125

0417 FC         +1  7880+1           mov     r4,a
0418 E4         +1  7881+1           clr     a
0419 9B         +1  7882+1           subb    a,r3
041A FB         +1  7883+1           mov     r3,a
041B E4         +1  7884+1           clr     a
041C 9A         +1  7885+1           subb    a,r2
041D FA         +1  7886+1           mov     r2,a
041E            +1  7887     altof1:
041E 7896       +1  7888             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  7889             call    norm1           ;normalize it
0422 11DE       +1  7890             call    pack1           ;and pack up
                +1  7891+3           restregs
0424 D000       +1  7892+1           pop     0
0426 D001       +1  7893+1           pop     1
0428 D006       +1  7894+1           pop     6
042A D007       +1  7895+1           pop     7
042C 22         +1  7896             ret
                +1  7897     
042D            +1  7898     lbtof:
042D 7C00       +1  7899             mov     r4,#0
042F            +1  7900     lwtof:
042F E4         +1  7901             clr     a
0430 FB         +1  7902             mov     r3,a
0431 FA         +1  7903             mov     r2,a
0432            +1  7904     lltof:
                +1  7905+3           saveregs
0432 C007       +1  7906+1           push    7
0434 C006       +1  7907+1           push    6
0436 C001       +1  7908+1           push    1
0438 C000       +1  7909+1           push    0
043A 7F00       +1  7910             mov     r7,#0           ;zero sign
043C 80E0       +1  7911             sjmp    altof1
                +1  7912     
                +1  7913     ;-------------------------------------------------------
                +1  7914     
                +1  7915     
                    7916     
                    7917     ;$include (d:\amp\wriread.asm)
                +1  7918     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  7919     cle256:          mov            IE,#00H
0441 75B601     +1  7920                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  7921                              MOV            PSCTL,#03
                +1  7922                                             
0447 7400       +1  7923                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  7924                                     movx    @dptr,a                         ;wr
044A 758F00     +1  7925                                     mov             PSCTL,#00
044D 75B600     +1  7926                                 mov         FLSCL,#00
0450 75A880     +1  7927                               mov           IE,#80H
0453 22         +1  7928                                     ret
                +1  7929     
                +1  7930     ;чтение памяти программ в r8..r11
                +1  7931     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  7932     re4byte:        mov                     dph,r2
0456 8B82       +1  7933                                             mov                     dpl,r3
0458 E4         +1  7934                                             clr                     a
0459 93         +1  7935                                             movc            a,@a+dptr
045A F508       +1  7936                                             mov                     r8,a
045C A3         +1  7937                                             inc                     dptr
045D E4         +1  7938                                             clr                     a
045E 93         +1  7939                                             movc            a,@a+dptr
045F F509       +1  7940                                             mov                     r9,a
0461 A3         +1  7941                                             inc                     dptr
0462 E4         +1  7942                                             clr                     a
0463 93         +1  7943                                             movc            a,@a+dptr
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   126

0464 F50A       +1  7944                                             mov                     r10,a
0466 A3         +1  7945                                             inc                     dptr
0467 E4         +1  7946                                             clr                     a
0468 93         +1  7947                                             movc            a,@a+dptr
0469 F50B       +1  7948                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  7949                                             ret
                +1  7950      ;чтение памяти программ в r2..r5
                +1  7951     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  7952     rebyte2:        mov                     dph,r2
046E 8B82       +1  7953                                             mov                     dpl,r3
0470 E4         +1  7954                                             clr                     a
0471 93         +1  7955                                             movc            a,@a+dptr
0472 FA         +1  7956                                             mov                     r2,a
0473 A3         +1  7957                                             inc                     dptr
0474 E4         +1  7958                                             clr                     a
0475 93         +1  7959                                             movc            a,@a+dptr
0476 FB         +1  7960                                             mov                     r3,a
0477 A3         +1  7961                                             inc                     dptr
0478 E4         +1  7962                                             clr                     a
0479 93         +1  7963                                             movc            a,@a+dptr
047A FC         +1  7964                                             mov                     r4,a
047B A3         +1  7965                                             inc                     dptr
047C E4         +1  7966                                             clr                     a
047D 93         +1  7967                                             movc            a,@a+dptr
047E FD         +1  7968                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  7969                                             ret
                +1  7970      
                +1  7971     
                +1  7972      ;r7-количество байт
                +1  7973     ;dptr-адр ячейки для записи
                +1  7974     ;r1-адр ячейки  внешнего озу
                +1  7975     
0480 75A800     +1  7976     wrpage:  mov            IE,#00H
0483 75B601     +1  7977     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  7978                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  7979                      movx           a,@r1
048A F0         +1  7980                      movx           @dptr,a                         ;wr
048B 758F00     +1  7981                      mov            PSCTL,#0
048E 75B600     +1  7982                      mov            FLSCL,#00
0491 A3         +1  7983                     inc                     dptr
0492 09         +1  7984                     inc                     r1
0493 DFEE       +1  7985                     djnz            r7,WW5
0495 75A880     +1  7986                     mov             IE,#80H
0498 22         +1  7987                     ret
                +1  7988                             
                +1  7989     
                +1  7990     
                +1  7991                                                             
                +1  7992     
                +1  7993     
                +1  7994     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  7995     ;чтение памяти программ во внешнее озу
                +1  7996     ;вх-r2,r3-адр яч памяти прогр
                +1  7997     ;r1- яч внешнее озу
0499 8A83       +1  7998     copyPP:         mov                     dph,r2
049B 8B82       +1  7999                                             mov                     dpl,r3
049D 7FFF       +1  8000                                             mov                     r7,#0ffh
049F E4         +1  8001     copy1:          clr                     a
04A0 93         +1  8002                                             movc            a,@a+dptr
04A1 F3         +1  8003                                             movx                    @r1,a
04A2 A3         +1  8004                                             inc                     dptr
04A3 09         +1  8005                                             inc                     r1
04A4 DFF9       +1  8006                                             djnz            r7,copy1
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   127

04A6 22         +1  8007                                             ret
                +1  8008     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8009     
                +1  8010                                     
                +1  8011     
                +1  8012     ;r8..r11->@r0..@r0+3
                +1  8013     ;r0-адр ячейки
                +1  8014     ;сохранить в ячейке озу
04A7 E508       +1  8015     savelte:        mov     a,ltemp
04A9 F6         +1  8016                                             mov     @r0,a
04AA 08         +1  8017                                             inc     r0
04AB E509       +1  8018                                             mov     a,ltemp+1
04AD F6         +1  8019                                             mov     @r0,a
04AE 08         +1  8020                                             inc     r0
04AF E50A       +1  8021                                             mov     a,ltemp+2
04B1 F6         +1  8022                                             mov     @r0,a
04B2 08         +1  8023                                             inc     r0
04B3 E50B       +1  8024                                             mov     a,ltemp+3
04B5 F6         +1  8025                                             mov     @r0,a
04B6 22         +1  8026                                             ret
                +1  8027     
                +1  8028     ;
                +1  8029     
                +1  8030     
                +1  8031     
                +1  8032     
                +1  8033     
                +1  8034                     
                +1  8035     
                +1  8036     
                +1  8037     
                +1  8038     
                +1  8039      
                    8040     
                    8041                                                   
                    8042     END
                                                                             
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   128

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   0372H   R   SEG=MAIN   828#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1415 1472 1497 1518 1522 1525 1526 1528 1635 1640 3440 3454 3535
                                           3538 3580 3672 3716 3719 3785 3789 3790 3791 3794 4002 4039 4040 4042 4116
                                           4136 4227 4231 4255 4258 4597 4602 4768 4773 5519 5681 5684 5708 5711
ABRET. . . . . . .  C ADDR   21E7H   R   SEG=MAIN   5448 5450#
ABTOF. . . . . . .  C ADDR   03F3H   A      7847#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 638 706 714 722 730 732 752 1107 1118 1126 1205 1584 1771 1780 1789
                                           1798 1819 2132 2155 2160 2164 2169 2172 2175 2178 2181 2361 2422 2468 2479
                                           2562 2571 2579 2588 2728 2760 2785 2790 2794 2797 2800 2803 2806 2809 3131
                                           3219 3251 3268 3286 3303 3323 4176 4182 4219 4289 5028 6110 6254 6332 6335
                                           6592 7244 7327 7344 7376 7414 7442 7704 7706 7724 7767 7813 7872
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   29ADH   R   SEG=MAIN   863 900 902 904 906 908 910 912 914 916 982 984 986 988 990 992
                                           994 996 998 1001 1003 1005 1007 1009 1011 1013 1015 1017 1019 1038 1040
                                           1042 6833#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1471 1483 1487 1502 1527 1530 1531 1639 1643 3453 3457 3532 3536
                                           3577 3581 3669 3673 3718 3722 3793 3806 4012 4026 4028 4030 4041 4044 4126
                                           4137 4232 4259 4601 4605 4772 4776 5320 5339 5357 5420 5437 5683 5686 5710
                                           5713 6032 6064
ADRBLOK. . . . . .  C ADDR   268FH   R   SEG=MAIN   3203 3551 3690 4519 4687 4838 6076#
AFTERK . . . . . .  C ADDR   0669H   R   SEG=MAIN   1135 1214#
AGE2 . . . . . . .  C ADDR   020CH   R   SEG=MAIN   590# 593
AGE9 . . . . . . .  C ADDR   0804H   R   SEG=MAIN   1419# 1422
AGEON. . . . . . .  C ADDR   021AH   R   SEG=MAIN   599# 601
ALESS0 . . . . . .  C ADDR   0939H   R   SEG=MAIN   1584 1605#
ALLSUM . . . . . .  C ADDR   0310H   R   SEG=MAIN   772# 807 825 841
ALMUL. . . . . . .  C ADDR   28F4H   R   SEG=MAIN   6679#
ALTOF. . . . . . .  C ADDR   0402H   A      1101 1199 1230 1238 1256 1272 1283 1300 1313 1381 1896 1987 2047 2085
                                           3584 3678 4140 4235 4262 4350 4428 4436 4454 4560 4572 4587 4671 4733 4749
                                           4822 4884 4899 7855 7863#
ALTOF1 . . . . . .  C ADDR   041EH   A      7872 7887# 7911
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   05CFH   R   SEG=MAIN   1099 1115#
AN_T7. . . . . . .  C ADDR   10E8H   R   SEG=MAIN   2810# 2877 2886
AUTOKA . . . . . .  C ADDR   0BAEH   R   SEG=MAIN   1133 2010#
AVPGO. . . . . . .  C ADDR   0796H   R   SEG=MAIN   1357 1359#
AVTDEC1. . . . . .  C ADDR   062BH   R   SEG=MAIN   1168 1177#
AWTOF. . . . . . .  C ADDR   03FCH   A      7856#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   129

B. . . . . . . . .  D ADDR   00F0H   A      122# 5172 5539 6682 6685 6687 6691 6695 6699 6703 6708 6712 6719 6723
                                           6727 6733 6737 6741 6747 7440 7441
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 455#
BFORM. . . . . . .  C ADDR   25CCH   R   SEG=MAIN   5881 5886 5898# 5924
BIFL_KT. . . . . .  B ADDR   0021H.5 A      334# 4346 4402 4501
BIN30. . . . . . .  C ADDR   2710H   R   SEG=MAIN   6242# 6268
BIN31. . . . . . .  C ADDR   2714H   R   SEG=MAIN   6247# 6251
BIN32. . . . . . .  C ADDR   2724H   R   SEG=MAIN   6260# 6265
BIN41. . . . . . .  C ADDR   2735H   R   SEG=MAIN   6276# 6286
BINDEC . . . . . .  C ADDR   2704H   R   SEG=MAIN   1473 1529 1641 3455 3720 3795 4043 4603 4774 5685 5712 6221#
BITAKT . . . . . .  B ADDR   0023H.2 A      353# 1725 1726 1729
BITAVP . . . . . .  B ADDR   0020H.5 A      324# 1323 1538 1715 2865 2866 2868
BITBON . . . . . .  B ADDR   0021H.2 A      331# 1751 1864 2190 2191 2199 6111
BITBUF . . . . . .  B ADDR   0021H.0 A      329#
BITEIZM. . . . . .  B ADDR   0022H.5 A      344# 1224 1733 2844 2856 3939 5091
BITIZM . . . . . .  B ADDR   0020H.4 A      323# 568 674 2161 2234 2319 2354 2385 2791 2845 2962 2985 3060 3091 3116
                                           3222 3305 3555 3602 3627 3777 3894 3940 3987 4074 4149
BITKLB . . . . . .  B ADDR   0022H.2 A      341# 1293 1749 2166 2864 2871 4147 4416
BITMAS . . . . . .  B ADDR   0020H.1 A      320# 1049 1052 5864
BITMEM . . . . . .  B ADDR   0021H.3 A      332# 1625 2556 3094 3112 3124 3221 3304 3556 3601 3776
BITMENU. . . . . .  B ADDR   0022H.1 A      340# 1624 2384 2496 2846 3115 3609 3626 3899 3941 3986 4073 4146
BITMIG . . . . . .  B ADDR   0023H.1 A      352# 2461 2640 2738 3028 3352 3492 3505 4105 4211 4293 5604 5630 5655
                                           5667 5730 5737 5743 5749
BITNUL . . . . . .  B ADDR   0021H.7 A      336# 1696 2888 2889 2896
BITOLL . . . . . .  B ADDR   0022H.7 A      346# 614 1545 1622
BITPAR . . . . . .  B ADDR   0022H.6 A      345# 3905 4417
BITPRD . . . . . .  B ADDR   0021H.1 A      330# 1863
BITRS. . . . . . .  B ADDR   0020H.3 A      322#
BITT2. . . . . . .  B ADDR   0022H.0 A      339# 1621 2320 2355 2358 2903 3061
BITV19 . . . . . .  B ADDR   0022H.3 A      342# 512 516 2527 2530 2534 3883 3888 3969 3982 4079 4082 4086
BITVI11. . . . . .  B ADDR   0020H.6 A      325# 1321 1337 2184 2186 2233 2383 2843 2954 2961 3114
BITVICH. . . . . .  B ADDR   0022H.4 A      343# 1620 2185 2235 2245 2382 2390 2921 2953 2984 3113
BITZNAK. . . . . .  B ADDR   0020H.0 A      319# 639 689
BITZNB . . . . . .  B ADDR   0023H.3 A      354# 4263 5446 5449
BITZUS . . . . . .  B ADDR   0020H.7 A      326# 1371 1561 1937 1940 2280
BLOIN. . . . . . .  C ADDR   1542H   R   SEG=MAIN   3460# 3465
BLOKVV . . . . . .  C ADDR   1514H   R   SEG=MAIN   3430#
BLOKVVC. . . . . .  C ADDR   151EH   R   SEG=MAIN   3433 3436#
BL_LI. . . . . . .  C ADDR   14DFH   R   SEG=MAIN   3380 3388#
BOUT7. . . . . . .  C ADDR   12AAH   R   SEG=MAIN   3071# 3073
BRET . . . . . . .  C ADDR   2036H   R   SEG=MAIN   5112 5117 5121#
BUFDEC . . . . . .  C ADDR   096BH   R   SEG=MAIN   1646# 1651
BUFIND . . . . . .  D ADDR   0040H   A      298# 589 593 598 601 607 1418 1422 1488 1509 1530 1531 1532 1594 1599
                                           1644 1652 1654 1659 1694 1713 1719 1727 1730 1735 1750 1752 2149 2196 2200
                                           2436 2454 2470 2472 2475 2635 2679 2698 2778 2905 2963 2964 3011 3015 3041
                                           3063 3077 3084 3095 3096 3194 3347 3374 3402 3431 3458 3472 3473 3477 3478
                                           3485 3486 3491 3507 3642 3649 3723 3731 3733 3738 3762 3796 3805 3807 4011
                                           4044 4045 4048 4097 4125 4203 4245 4606 4614 4618 4777 4785 4789 4928 4960
                                           5170 5188 5319 5338 5356 5419 5436 5447 5607 5633 5687 5706 5714 5734 5755
                                           6031 6063 6112
BUFMEA . . . . . .  C ADDR   1D57H   R   SEG=MAIN   4608# 4613
BUFMIN . . . . . .  C ADDR   1E4AH   R   SEG=MAIN   4779# 4784
BUFON. . . . . . .  C ADDR   0D00H   R   SEG=MAIN   2190 2199#
BUFR . . . . . . .  C ADDR   08A9H   R   SEG=MAIN   1511# 1516
BUFR2. . . . . . .  C ADDR   088BH   R   SEG=MAIN   1490# 1495
BUFR3. . . . . . .  C ADDR   0884H   R   SEG=MAIN   1481 1486#
BUFR30 . . . . . .  C ADDR   0887H   R   SEG=MAIN   1484 1488#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      7437# 7441
CELLBIT. . . . . .  D ADDR   0020H   A      318# 319 320 321 322 323 324 325 326
CELLBIT1 . . . . .  D ADDR   0021H   A      328# 329 330 331 332 334 336
CELLBIT2 . . . . .  D ADDR   0022H   A      338# 339 340 341 342 343 344 345 346
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   130

CELLBIT3 . . . . .  D ADDR   0023H   A      350# 351 352 353 354
CEXP . . . . . . .  C ADDR   01E2H   A      7414 7423#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   20D3H   R   SEG=MAIN   2897 5254#
CH1. . . . . . . .  C ADDR   20F3H   R   SEG=MAIN   5077 5265#
CH10 . . . . . . .  C ADDR   20D7H   R   SEG=MAIN   824 1063 3708 5255#
CH100. . . . . . .  C ADDR   20EBH   R   SEG=MAIN   771 1579 5260#
CH10000. . . . . .  C ADDR   20E7H   R   SEG=MAIN   5259#
CH150H . . . . . .  C ADDR   2137H   R   SEG=MAIN   5284#
CH2. . . . . . . .  C ADDR   20EFH   R   SEG=MAIN   1058 5261#
CH20 . . . . . . .  C ADDR   22AEH   R   SEG=MAIN   806 1068 5570#
CH2THO . . . . . .  C ADDR   2117H   R   SEG=MAIN   2054 2092 5276#
CH320H . . . . . .  C ADDR   2133H   R   SEG=MAIN   5283# 6084
CH4. . . . . . . .  C ADDR   20DFH   R   SEG=MAIN   1072 5257#
CH43 . . . . . . .  C ADDR   1744H   R   SEG=MAIN   3725# 3730
CH43_42. . . . . .  C ADDR   17D3H   R   SEG=MAIN   3809# 3814
CH5. . . . . . . .  C ADDR   20DBH   R   SEG=MAIN   840 5256#
CH57 . . . . . . .  C ADDR   22AAH   R   SEG=MAIN   5569#
CH954. . . . . . .  C ADDR   20E3H   R   SEG=MAIN   5258#
CHAIBL . . . . . .  C ADDR   13BAH   R   SEG=MAIN   3196 3198#
CHAIPR . . . . . .  C ADDR   1699H   R   SEG=MAIN   3644 3646#
CHANMA . . . . . .  C ADDR   0EC2H   R   SEG=MAIN   2468 2477#
CHANZ. . . . . . .  C ADDR   0EA9H   R   SEG=MAIN   2422 2466#
CHAVT. . . . . . .  D ADDR   0081H   A      368# 547 1124 1169 1177 2111 3895
CHBEFORE . . . . .  D ADDR   009BH   A      378# 570 768 782 801 819 835
CHBLOK . . . . . .  D ADDR   00D6H   A      403# 4517 4567 4583 4685 4739 4836 4890
CHBUF. . . . . . .  D ADDR   00CFH   A      400# 581 1849 1854 1904 1946 3599
CHCMP. . . . . . .  C ADDR   1FD9H   R   SEG=MAIN   1130 5054#
CHDEC. . . . . . .  C ADDR   1FECH   R   SEG=MAIN   1178 1191 5069#
CHDEL. . . . . . .  D ADDR   0083H   A      369# 1968 1995 2017 2067 2105
CHDELMO. . . . . .  C ADDR   0B96H   R   SEG=MAIN   1978 1995# 2000
CHIF . . . . . . .  C ADDR   22F3H   R   SEG=MAIN   5611 5614#
CHIF5. . . . . . .  C ADDR   22FBH   R   SEG=MAIN   5617 5619#
CHIFB. . . . . . .  C ADDR   231EH   R   SEG=MAIN   5637 5640#
CHIFB1 . . . . . .  C ADDR   2324H   R   SEG=MAIN   5639 5640 5643#
CHIFL5 . . . . . .  C ADDR   232CH   R   SEG=MAIN   5647 5650#
CHIFOUR. . . . . .  C ADDR   230DH   R   SEG=MAIN   5624 5626 5630#
CHIND. . . . . . .  D ADDR   00ACH   A      384# 1339 1756
CHIND2 . . . . . .  D ADDR   0033H   A      315# 676 678 686
CHINKOR. . . . . .  D ADDR   0098H   A      367# 542 750 1116 1129 1171 1185 1190 2002
CHK. . . . . . . .  C ADDR   212FH   R   SEG=MAIN   1294 5282#
CHKL . . . . . . .  D ADDR   003DH   A      305# 656 658 666 668 669 671 2298 2325 2373 2824 3100 3768 4152
CHMAS. . . . . . .  D ADDR   006EH   A      302# 1046 1053 1076 5863
CHMASN . . . . . .  D ADDR   003FH   A      306# 757 766 802 820 836 852 1051 1053 1054
CHMINUS. . . . . .  C ADDR   2674H   R   SEG=MAIN   3216 3248 3265 3283 3300 6046# 6107
CHTADC . . . . . .  C ADDR   1F83H   R   SEG=MAIN   4986#
CHTHO. . . . . . .  C ADDR   210FH   R   SEG=MAIN   1263 1301 4359 4444 4462 5274#
CHTHOU . . . . . .  C ADDR   21B2H   R   SEG=MAIN   5407#
CHZAP. . . . . . .  C ADDR   20CFH   R   SEG=MAIN   1838 5253#
CH_1 . . . . . . .  C ADDR   20FBH   R   SEG=MAIN   573 1435 1458 1851 1856 1932 1948 3679 5267#
CH_10. . . . . . .  C ADDR   2127H   R   SEG=MAIN   1441 1464 1909 1920 4141 4592 4762 5280#
CH_10TH. . . . . .  C ADDR   2123H   R   SEG=MAIN   1352 5279#
CH_2 . . . . . . .  C ADDR   20FFH   R   SEG=MAIN   1901 1914 5268#
CH_200 . . . . . .  C ADDR   211FH   R   SEG=MAIN   5278#
CH_220 . . . . . .  C ADDR   211BH   R   SEG=MAIN   1314 5277#
CH_22T . . . . . .  C ADDR   21F0H   R   SEG=MAIN   1391 5455#
CH_250 . . . . . .  C ADDR   212BH   R   SEG=MAIN   1219 5281#
CH_4 . . . . . . .  C ADDR   2103H   R   SEG=MAIN   1923 3682 5269#
CH_5 . . . . . . .  C ADDR   2107H   R   SEG=MAIN   1928 5270#
CH_500 . . . . . .  C ADDR   21ECH   R   SEG=MAIN   1387 5454#
CH_953 . . . . . .  C ADDR   210BH   R   SEG=MAIN   5273#
CH_B . . . . . . .  C ADDR   21E8H   R   SEG=MAIN   1403 5452#
CH_FL. . . . . . .  C ADDR   21F4H   R   SEG=MAIN   1427 5456#
CH_MLN . . . . . .  C ADDR   20F7H   R   SEG=MAIN   5266#
CIKLWR . . . . . .  C ADDR   25A2H   R   SEG=MAIN   5869#
CKCON. . . . . . .  D ADDR   008EH   A      30# 473 504
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   131

CL4. . . . . . . .  C ADDR   2149H   R   SEG=MAIN   5299# 5301
CL4N . . . . . . .  C ADDR   214FH   R   SEG=MAIN   5308# 5310
CLE20. . . . . . .  C ADDR   17C0H   R   SEG=MAIN   3799# 3801
CLE256 . . . . . .  C ADDR   043EH   A      3975 4392 4494 7919#
CLEAR. . . . . . .  C ADDR   26FEH   R   SEG=MAIN   6199 6203# 6233
CLEAR4 . . . . . .  C ADDR   2146H   R   SEG=MAIN   780 1368 1370 1498 1519 1558 1560 2227 2229 2882 2884 4516 5297#
CLEARN . . . . . .  C ADDR   214EH   R   SEG=MAIN   3533 3578 3670 4003 4117 4228 4256 5306#
CLMASSIX . . . . .  C ADDR   2592H   R   SEG=MAIN   533 1366 1556 2006 2115 2225 2880 3059 5857#
CLMASV . . . . . .  C ADDR   079BH   R   SEG=MAIN   1361 1363#
CLMAX. . . . . . .  C ADDR   2597H   R   SEG=MAIN   5859# 5862
CLR11. . . . . . .  C ADDR   26FFH   R   SEG=MAIN   6205# 6207
CLRDEC . . . . . .  C ADDR   26F8H   R   SEG=MAIN   6197#
CLRNUM . . . . . .  C ADDR   26FCH   R   SEG=MAIN   6200# 6314
CLRVICH. . . . . .  C ADDR   121AH   R   SEG=MAIN   2984# 3001
CNTR . . . . . . .  N NUMB   0006H   A      7110#
CO02S. . . . . . .  C ADDR   20B7H   R   SEG=MAIN   5237# 5241
CO05S. . . . . . .  C ADDR   20C4H   R   SEG=MAIN   5246# 5250
CO1S . . . . . . .  C ADDR   20AEH   R   SEG=MAIN   5231# 5231
CO2S . . . . . . .  C ADDR   20AAH   R   SEG=MAIN   5229# 5233
COMPA1 . . . . . .  C ADDR   0820H   R   SEG=MAIN   1435# 1444
COMPA2 . . . . . .  C ADDR   0856H   R   SEG=MAIN   1458# 1467
COND . . . . . . .  C ADDR   2606H   R   SEG=MAIN   5953#
COPY1. . . . . . .  C ADDR   049FH   A      8001# 8006
COPYPP . . . . . .  C ADDR   0499H   A      3962 4371 4472 7998#
COPY_HL. . . . . .  D ADDR   00D7H   A      404# 3695 3820 4509 4525 4540 4678 4693 4708 4829 4844 4859
COUNT. . . . . . .  C ADDR   208CH   R   SEG=MAIN   5203# 5203
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   2093H   R   SEG=MAIN   5209# 5209
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 478
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1586 1607
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1589 1611
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 479
DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1846
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1843
DCOA . . . . . . .  C ADDR   260BH   R   SEG=MAIN   5957# 5959
DCOB . . . . . . .  C ADDR   2612H   R   SEG=MAIN   5961# 5979
DCOC . . . . . . .  C ADDR   261DH   R   SEG=MAIN   5971# 5976
DCOD . . . . . . .  C ADDR   262AH   R   SEG=MAIN   5978 5981#
DDOUTF . . . . . .  C ADDR   1494H   R   SEG=MAIN   3185 3228 3333 3341# 3426
DDOUTFR. . . . . .  C ADDR   139EH   R   SEG=MAIN   3185# 3191
DEC30. . . . . . .  C ADDR   2751H   R   SEG=MAIN   6324# 6349
DEC31. . . . . . .  C ADDR   2756H   R   SEG=MAIN   6330# 6337
DEC32. . . . . . .  C ADDR   2766H   R   SEG=MAIN   6342# 6346
DECBIN . . . . . .  C ADDR   2744H   R   SEG=MAIN   3537 3582 3674 4138 4233 4260 6303#
DECSIZE. . . . . .  N NUMB   000AH   A      6178# 6198 6232 6259 6272 6275 6329
DECT2. . . . . . .  C ADDR   276FH   R   SEG=MAIN   6320 6352#
DEDPTR . . . . . .  C ADDR   29C4H   R   SEG=MAIN   6837 6841 6845 6851#
DENORM . . . . . .  C ADDR   0133H   A      7269# 7325
DGOTO7 . . . . . .  C ADDR   1626H   R   SEG=MAIN   3585# 3593
DIAP . . . . . . .  D ADDR   00AEH   A      386# 561 1356 1540 1658 1874 2219 2251 2873 4047 4399 5092 5113 5370 5385
                                           5536 5598
DIINC. . . . . . .  C ADDR   0D25H   R   SEG=MAIN   2222 2225#
DIKDN. . . . . . .  C ADDR   2282H   R   SEG=MAIN   5538 5558#
DIKDW. . . . . . .  C ADDR   219AH   R   SEG=MAIN   5374 5395#
DIKM . . . . . . .  C ADDR   21B0H   R   SEG=MAIN   5406#
DIPAR. . . . . . .  C ADDR   21AEH   R   SEG=MAIN   5405#
DIV1 . . . . . . .  C ADDR   02DDH   A      7606# 7665
DIV2 . . . . . . .  C ADDR   0320H   A      7624 7628 7632 7636 7651#
DIV3 . . . . . . .  C ADDR   030DH   A      7625 7629 7633 7637#
DIV9 . . . . . . .  C ADDR   0336H   A      7595 7597 7671#
DIVIDE . . . . . .  C ADDR   282FH   R   SEG=MAIN   5885 6538#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   132

DONE . . . . . . .  C ADDR   279EH   R   SEG=MAIN   6368 6379#
DONE1. . . . . . .  C ADDR   279CH   R   SEG=MAIN   6371 6374 6377#
DOSH . . . . . . .  C ADDR   28B8H   R   SEG=MAIN   6613 6629#
DOSUB. . . . . . .  C ADDR   28A6H   R   SEG=MAIN   6597 6601 6605 6609 6610 6614#
DPH. . . . . . . .  D ADDR   0083H   A      19# 539 2771 3700 3702 3825 3830 4278 4510 4522 4527 4536 4538 4541 4552
                                           4639 4641 4679 4690 4695 4704 4706 4709 4720 4830 4841 4846 4855 4857 4860
                                           4871 5817 5825 6092 6098 6120 6385 6421 6456 6459 6471 6494 6856 6858 7932
                                           7952 7998
DPL. . . . . . . .  D ADDR   0082H   A      18# 2770 3696 3698 3822 3833 4279 4513 4520 4530 4533 4535 4544 4548 4636
                                           4638 4682 4688 4698 4701 4703 4712 4716 4833 4839 4849 4852 4854 4863 4867
                                           5818 5824 6089 6101 6124 6401 6437 6458 6472 6475 6509 6853 6855 7933 7953
                                           7999
DVIG0. . . . . . .  C ADDR   0A46H   R   SEG=MAIN   1792# 1794
DVIG1. . . . . . .  C ADDR   0A3BH   R   SEG=MAIN   1783# 1785
DVIG2. . . . . . .  C ADDR   0A30H   R   SEG=MAIN   1774# 1776
DVIG3. . . . . . .  C ADDR   0A24H   R   SEG=MAIN   1765# 1767
DVIG4. . . . . . .  C ADDR   0A52H   R   SEG=MAIN   1803# 1805
DVIG6. . . . . . .  C ADDR   0A74H   R   SEG=MAIN   1831# 1833
DVM. . . . . . . .  C ADDR   0A72H   R   SEG=MAIN   1819 1830#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 476
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 519 660 2129 2757 4958 4970
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDKALIB . . . . .  C ADDR   1B87H   R   SEG=MAIN   2862 4345#
ENDSDV . . . . . .  C ADDR   0A78H   R   SEG=MAIN   1825 1834#
ENDSUM . . . . . .  C ADDR   055DH   R   SEG=MAIN   864 917 1020 1045#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU0 . . . . . . .  C ADDR   0851H   R   SEG=MAIN   1438 1454#
EQU00. . . . . . .  C ADDR   086FH   R   SEG=MAIN   1456 1461 1470#
EQU1L. . . . . . .  C ADDR   0FE8H   R   SEG=MAIN   2646 2650#
EQU2L. . . . . . .  C ADDR   14FAH   R   SEG=MAIN   3412 3417#
ERROR. . . . . . .  C ADDR   23B8H   R   SEG=MAIN   4070 4936 4950 5753#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      7112#
EXP2 . . . . . . .  N NUMB   0001H   A      7114# 7291 7312
EXTCLE . . . . . .  C ADDR   01ACH   R   SEG=MAIN   536# 540
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDEXT. . . . . .  C ADDR   2193H   R   SEG=MAIN   4373 5384#
FINDKOEF . . . . .  C ADDR   2184H   R   SEG=MAIN   1297 5369#
FINDMEM. . . . . .  C ADDR   0F4CH   R   SEG=MAIN   2496 2556#
FINDR. . . . . . .  C ADDR   22DBH   R   SEG=MAIN   1524 4038 5598#
FINIS. . . . . . .  C ADDR   28E3H   R   SEG=MAIN   6557 6658#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      4564 4576 7317# 7406
FLCMP. . . . . . .  C ADDR   01D6H   A      1221 1316 1354 1389 1393 1437 1460 1858 4735 4751 4886 4901 7411#
FLDIV. . . . . . .  C ADDR   02B7H   A      1244 1265 1303 1410 1429 1443 1922 1930 2056 2094 4357 4442 4460 4591
                                           4594 4764 7581#
FLMUL. . . . . . .  C ADDR   0203H   A      1110 1210 1262 1308 1405 1466 1903 3684 4143 4361 4446 4464 7451#
FLOUT. . . . . . .  C ADDR   01E1H   A      7418 7421#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 7920 7926 7977 7982
FLSUB. . . . . . .  C ADDR   01D1H   A      1202 1853 1950 2052 2090 3681 7404#
FND. . . . . . . .  C ADDR   01F8H   A      7427 7430 7433 7436 7439#
FO1M . . . . . . .  C ADDR   25C9H   R   SEG=MAIN   5891 5895#
FO2M . . . . . . .  C ADDR   25D2H   R   SEG=MAIN   5898 5900#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   133

FORM4. . . . . . .  C ADDR   25D3H   R   SEG=MAIN   5893 5899 5903#
FT1IZM . . . . . .  C ADDR   0E02H   R   SEG=MAIN   2368#
FTOL . . . . . . .  C ADDR   0343H   A      1155 1310 1413 3685 4362 4465 4595 4765 5680 5707 7687#
FTOL1. . . . . . .  C ADDR   037CH   A      7700 7704 7728#
FTOL2. . . . . . .  C ADDR   039EH   A      7724 7761#
FTOL22 . . . . . .  C ADDR   03C4H   A      7764 7798#
FTOL23 . . . . . .  C ADDR   03A2H   A      7765# 7797
FTOL24 . . . . . .  C ADDR   03B5H   A      7767 7783#
FTOL25 . . . . . .  C ADDR   03C2H   A      7782 7797#
FTOL26 . . . . . .  C ADDR   03E4H   A      7813 7829#
FTOL3. . . . . . .  C ADDR   038AH   A      7727 7741#
FTOL33 . . . . . .  C ADDR   038EH   A      7745# 7759
FTOL4. . . . . . .  C ADDR   0371H   A      7706 7721#
FTOL9. . . . . . .  C ADDR   0381H   A      7734# 7744 7760 7828 7843
FULKALIB . . . . .  C ADDR   1BF6H   R   SEG=MAIN   4400 4415# 4503
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   484# 485
GO23NO . . . . . .  C ADDR   1459H   R   SEG=MAIN   3233 3310#
GO31L. . . . . . .  C ADDR   0FEEH   R   SEG=MAIN   2624 2655#
GO41L. . . . . . .  C ADDR   0FF3H   R   SEG=MAIN   2655 2657#
GOA2 . . . . . . .  C ADDR   0751H   R   SEG=MAIN   1320 1322 1325# 1347
GOA3A2 . . . . . .  C ADDR   075BH   R   SEG=MAIN   1330#
GOCIKLE. . . . . .  C ADDR   0B34H   R   SEG=MAIN   1865 1906 1937# 1944 1951
GOFULL . . . . . .  C ADDR   148CH   R   SEG=MAIN   3316 3337#
GOKAA2 . . . . . .  C ADDR   0779H   R   SEG=MAIN   1345#
GOKLB. . . . . . .  C ADDR   0CE8H   R   SEG=MAIN   2166 2188#
GOOFF1 . . . . . .  C ADDR   13F8H   R   SEG=MAIN   3242# 3251
GOOFF2 . . . . . .  C ADDR   1410H   R   SEG=MAIN   3259# 3268
GOOFF3 . . . . . .  C ADDR   1428H   R   SEG=MAIN   3277# 3286
GOOFF4 . . . . . .  C ADDR   1440H   R   SEG=MAIN   3294# 3303
GOONIN . . . . . .  C ADDR   076BH   R   SEG=MAIN   1338# 1372 1546 1562
GOONIND. . . . . .  C ADDR   0942H   R   SEG=MAIN   1341 1612#
GOONOFF. . . . . .  C ADDR   13C6H   R   SEG=MAIN   3210# 3219
GOONT. . . . . . .  C ADDR   0AD2H   R   SEG=MAIN   1868 1887#
GOPAROL. . . . . .  C ADDR   196DH   R   SEG=MAIN   3904 4024 4032#
GOPAROM. . . . . .  C ADDR   1883H   R   SEG=MAIN   3902# 3905
GOPART . . . . . .  C ADDR   02EEH   R   SEG=MAIN   752 755#
GOSK19 . . . . . .  C ADDR   0F24H   R   SEG=MAIN   2527 2532#
GOTO7. . . . . . .  C ADDR   10E8H   R   SEG=MAIN   2823# 2894 2901 2939 2988 3017 3029 3071 3075 3120 3136 3145 3151
                                           3156 3162 3177 3226 3362 3365 3379 3416 3419 3475 3488 3494 3520 3522 3562
                                           3585 3603 3655 3843 3850 4067 4077 4109 4160 4162 4178 4190 4247 4412 4423
GOTOKD . . . . . .  C ADDR   05F0H   R   SEG=MAIN   1113 1137#
GOUT6. . . . . . .  C ADDR   0C9DH   R   SEG=MAIN   2156# 2184
GOVVLIST . . . . .  C ADDR   16BDH   R   SEG=MAIN   3638 3660#
GOZNAK . . . . . .  C ADDR   02A0H   R   SEG=MAIN   645 695#
HNOR11 . . . . . .  C ADDR   1225H   R   SEG=MAIN   2950 2992#
HNOR12 . . . . . .  C ADDR   11CDH   R   SEG=MAIN   2940 2944#
HNOT1. . . . . . .  C ADDR   126EH   R   SEG=MAIN   2916 3038#
HNOT2. . . . . . .  C ADDR   119BH   R   SEG=MAIN   2913#
HR12 . . . . . . .  C ADDR   11C3H   R   SEG=MAIN   2935 2940#
HVI1113. . . . . .  C ADDR   11BDH   R   SEG=MAIN   2938# 2943 2948
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 521 4916 7919 7927 7976 7986
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   1197H   R   SEG=MAIN   2908 2910#
IND. . . . . . . .  C ADDR   1F51H   R   SEG=MAIN   594 602 647 679 1448 1452 1753 2197 2201 2212 3081 3097 3561 3763
                                           3815 4071 4420 4932 4938 4952 4958# 6113
INDA3. . . . . . .  C ADDR   0909H   R   SEG=MAIN   1577#
INDOLL . . . . . .  C ADDR   08E0H   R   SEG=MAIN   1538 1539 1543#
INIACP . . . . . .  C ADDR   21F8H   R   SEG=MAIN   611 3057 5462#
INNOT1_2 . . . . .  C ADDR   157DH   R   SEG=MAIN   3484 3490#
INNOT3 . . . . . .  C ADDR   156EH   R   SEG=MAIN   3476 3481#
INNOT6 . . . . . .  C ADDR   1562H   R   SEG=MAIN   3471 3476#
INTERVA. . . . . .  D ADDR   00CDH   A      399# 585 1887 3439 3539
INTMUL . . . . . .  C ADDR   0AEAH   R   SEG=MAIN   1903# 1911 1916 1925 1934
INTMUL1. . . . . .  C ADDR   0AEDH   R   SEG=MAIN   1904# 1931
INTN . . . . . . .  C ADDR   160FH   R   SEG=MAIN   3576#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   134

IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   1256H   R   SEG=MAIN   3019#
IZMAN. . . . . . .  C ADDR   0D79H   R   SEG=MAIN   2127 2272#
IZMFUN . . . . . .  C ADDR   0D88H   R   SEG=MAIN   2213 2224 2231 2276 2279#
IZMPAT . . . . . .  C ADDR   0D8CH   R   SEG=MAIN   2182 2198 2202 2248 2283#
IZMT2. . . . . . .  C ADDR   0D9BH   R   SEG=MAIN   2299 2304#
IZMT3. . . . . . .  C ADDR   0DA6H   R   SEG=MAIN   2304 2310#
JFINIS . . . . . .  C ADDR   284AH   R   SEG=MAIN   6549 6557#
KD . . . . . . . .  C ADDR   2113H   R   SEG=MAIN   5275#
KEYB1. . . . . . .  C ADDR   0C70H   R   SEG=MAIN   283 2128#
KEYB2. . . . . . .  C ADDR   107CH   R   SEG=MAIN   286 2756#
KFULL. . . . . . .  C ADDR   1463H   R   SEG=MAIN   3178 3315#
KFULLR . . . . . .  C ADDR   138DH   R   SEG=MAIN   3173 3178#
KGO23. . . . . . .  C ADDR   13E5H   R   SEG=MAIN   3172 3231#
KLEV1. . . . . . .  C ADDR   1367H   R   SEG=MAIN   3128 3163#
KLEV2. . . . . . .  C ADDR   136CH   R   SEG=MAIN   3163 3165#
KLEV21 . . . . . .  C ADDR   1390H   R   SEG=MAIN   3170 3179#
KLEV22 . . . . . .  C ADDR   1376H   R   SEG=MAIN   3158 3167 3170#
KLEV23 . . . . . .  C ADDR   13A1H   R   SEG=MAIN   3179 3187#
KLEV3. . . . . . .  C ADDR   1371H   R   SEG=MAIN   3165 3167#
KLMAS. . . . . . .  C ADDR   039BH   R   SEG=MAIN   784 851#
KNAVP. . . . . . .  C ADDR   1133H   R   SEG=MAIN   2803 2864#
KNIZM. . . . . . .  B ADDR   0023H.0 A      351# 1320 1539 1721 2250 2272 2273 2277
KNIZMON. . . . . .  C ADDR   0D83H   R   SEG=MAIN   2272 2277#
KNKMP. . . . . . .  C ADDR   106DH   R   SEG=MAIN   2751# 2797
KNLEFT . . . . . .  C ADDR   1143H   R   SEG=MAIN   2755 2871#
KNMEM. . . . . . .  C ADDR   12CBH   R   SEG=MAIN   2750 3091#
KNMENU . . . . . .  C ADDR   110AH   R   SEG=MAIN   2809 2843#
KNNUL. . . . . . .  C ADDR   1161H   R   SEG=MAIN   2754 2888#
KNOPT. . . . . . .  C ADDR   0DAEH   R   SEG=MAIN   2126 2318#
KNRAZR . . . . . .  C ADDR   0DC3H   R   SEG=MAIN   2125 2331#
KNRIGHT. . . . . .  C ADDR   0D1BH   R   SEG=MAIN   2172 2217#
KNVICH . . . . . .  C ADDR   0D37H   R   SEG=MAIN   2181 2233#
KOEFKD . . . . . .  D ADDR   00A0H   A      381# 579 4364 4374 4466 4474
KOEFKM . . . . . .  D ADDR   0094H   A      375# 577 1108 1208 2098
KOEFKP . . . . . .  D ADDR   0090H   A      374# 575 1105 1203 2060
KOMUL. . . . . . .  C ADDR   0719H   R   SEG=MAIN   1296 1300#
KOMULPZ. . . . . .  C ADDR   0713H   R   SEG=MAIN   1293 1297#
KONSTA . . . . . .  D ADDR   00BCH   A      394# 1401 4236 5678
KONSTB . . . . . .  D ADDR   00C0H   A      395# 4267 5698
KON_B. . . . . . .  C ADDR   0E8DH   R   SEG=MAIN   2424 2443#
KOR0US . . . . . .  C ADDR   204AH   R   SEG=MAIN   1976 5146#
KOR0_AN. . . . . .  D ADDR   0084H   A      371# 1200 1988 2050 2088
KORDEC1. . . . . .  C ADDR   0641H   R   SEG=MAIN   1183 1190#
KORDEC10 . . . . .  C ADDR   0621H   R   SEG=MAIN   1171#
KORNUL . . . . . .  C ADDR   0B69H   R   SEG=MAIN   1120 1968#
KVVOD0 . . . . . .  C ADDR   147FH   R   SEG=MAIN   3138 3323 3332#
LABEL43. . . . . .  C ADDR   16B4H   R   SEG=MAIN   3656# 3664
LABEL7 . . . . . .  C ADDR   1786H   R   SEG=MAIN   3656 3768# 3780
LABELA . . . . . .  C ADDR   0267H   R   SEG=MAIN   650# 683 1941
LABELB . . . . . .  C ADDR   0A1DH   R   SEG=MAIN   1163 1565 1758# 1956 1960 1962
LABELC . . . . . .  C ADDR   0DC3H   R   SEG=MAIN   2332#
LABELE . . . . . .  C ADDR   0D8CH   R   SEG=MAIN   2281 2297# 2337 2340 2344 2348 2356
LABELF . . . . . .  C ADDR   0DEEH   R   SEG=MAIN   2124 2357#
LABELH . . . . . .  C ADDR   1183H   R   SEG=MAIN   2753 2903#
LABELI . . . . . .  C ADDR   1A56H   R   SEG=MAIN   2919 2977 3031 4173#
LABELI2. . . . . .  C ADDR   120AH   R   SEG=MAIN   2977# 2978
LABELK . . . . . .  C ADDR   130BH   R   SEG=MAIN   2918 3121#
LABELL . . . . . .  C ADDR   0FA9H   R   SEG=MAIN   2494 2585 2593#
LABELL1. . . . . .  C ADDR   0ECAH   R   SEG=MAIN   2481# 2549 2662 2711
LABELN . . . . . .  C ADDR   100DH   R   SEG=MAIN   2550 2671#
LABELP . . . . . .  C ADDR   168AH   R   SEG=MAIN   3589 3609 3638# 3852
LABELS . . . . . .  C ADDR   1655H   R   SEG=MAIN   3319 3609#
LABELS1. . . . . .  C ADDR   18E4H   R   SEG=MAIN   3920 3950#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   135

LABELS13 . . . . .  C ADDR   19DFH   R   SEG=MAIN   3991 4089#
LABELS3. . . . . .  C ADDR   1A69H   R   SEG=MAIN   4183#
LABELS4. . . . . .  C ADDR   1A44H   R   SEG=MAIN   3990 4164#
LABL2. . . . . . .  C ADDR   0FCFH   R   SEG=MAIN   2627# 3182
LABM . . . . . . .  C ADDR   1503H   R   SEG=MAIN   3183 3422#
LADD . . . . . . .  C ADDR   298BH   R   SEG=MAIN   763 798 816 832 1841 6784#
LADDX. . . . . . .  C ADDR   299CH   R   SEG=MAIN   6808#
LBTOF. . . . . . .  C ADDR   042DH   A      7898#
LCMP . . . . . . .  C ADDR   2789H   R   SEG=MAIN   5064 5922 6364#
LDC_LONG . . . . .  C ADDR   279FH   R   SEG=MAIN   574 1295 1839 2055 2093 2898 6384#
LDC_LTEMP. . . . .  C ADDR   27C1H   R   SEG=MAIN   772 1059 1064 1069 1073 1220 1264 1302 1315 1353 1388 1392 1404
                                           1428 1436 1442 1459 1465 1580 1852 1857 1902 1910 1915 1921 1924 1929 1933
                                           1949 3680 3683 3709 4142 4360 4445 4463 4593 4763 5078 6085 6420#
LDX_LONG . . . . .  C ADDR   27E7H   R   SEG=MAIN   6455#
LDX_LTEMP. . . . .  C ADDR   280DH   R   SEG=MAIN   6493#
LEFCUR . . . . . .  C ADDR   158EH   R   SEG=MAIN   3500# 3571 3587
LEFKL. . . . . . .  C ADDR   114DH   R   SEG=MAIN   2871 2877#
LEFMEM11 . . . . .  C ADDR   1319H   R   SEG=MAIN   3129# 3164 3166 3168
LEFT21 . . . . . .  C ADDR   14ADH   R   SEG=MAIN   3358 3363#
LEFT_S . . . . . .  C ADDR   18E1H   R   SEG=MAIN   3949# 3952
LEFT_SK. . . . . .  C ADDR   19C6H   R   SEG=MAIN   3949 4079#
LEV220 . . . . . .  C ADDR   1379H   R   SEG=MAIN   3171# 3180
LEV2GO . . . . . .  C ADDR   1033H   R   SEG=MAIN   2670 2707#
LEVEL. . . . . . .  D ADDR   00B0H   A      388# 2204 2557 2595 3098 3108 3127 3334 5628
LI21 . . . . . . .  C ADDR   1260H   R   SEG=MAIN   3026 3028#
LI42_43. . . . . .  C ADDR   1723H   R   SEG=MAIN   3706# 3835
LIST_43. . . . . .  C ADDR   1790H   R   SEG=MAIN   3658 3773#
LLDI2. . . . . . .  C ADDR   0D72H   R   SEG=MAIN   2263 2267#
LLDI23 . . . . . .  C ADDR   0D66H   R   SEG=MAIN   2255 2260#
LLDI3. . . . . . .  C ADDR   0D6DH   R   SEG=MAIN   2262 2264#
LLEV2. . . . . . .  C ADDR   0FF8H   R   SEG=MAIN   2626 2660#
LLMUL. . . . . . .  C ADDR   28F4H   R   SEG=MAIN   6678#
LLSUB. . . . . . .  C ADDR   2979H   R   SEG=MAIN   6760#
LLTOF. . . . . . .  C ADDR   0432H   A      7904#
LMUL . . . . . . .  C ADDR   28F4H   R   SEG=MAIN   5880 6086 6680#
LOA3_X . . . . . .  C ADDR   26D4H   R   SEG=MAIN   1871 6127#
LOAB12 . . . . . .  C ADDR   2247H   R   SEG=MAIN   3055 5503#
LOAD . . . . . . .  D ADDR   00B7H   A      392# 2321 2362 2906 3051 5169
LOADB. . . . . . .  C ADDR   1281H   R   SEG=MAIN   3046 3049# 3082 3088
LOADB2 . . . . . .  C ADDR   12ADH   R   SEG=MAIN   3069 3073#
LOADCLE. . . . . .  C ADDR   1337H   R   SEG=MAIN   3143# 3326
LOADKD . . . . . .  C ADDR   2264H   R   SEG=MAIN   5536#
LOADR2 . . . . . .  C ADDR   2256H   R   SEG=MAIN   3583 3675 4139 4234 4261 5519#
LOADT. . . . . . .  C ADDR   2065H   R   SEG=MAIN   2323 2368 2912 5169#
LOADUS . . . . . .  C ADDR   2004H   R   SEG=MAIN   612 1364 1553 2230 2278 2857 2885 3058 4502 5090#
LOAHL_R2 . . . . .  C ADDR   1D6CH   R   SEG=MAIN   4559 4571 4622# 4731 4747 4882 4897
LOBLOK . . . . . .  C ADDR   14B8H   R   SEG=MAIN   3313 3370# 3389
LOCLE. . . . . . .  C ADDR   1332H   R   SEG=MAIN   3132 3141#
LOD1 . . . . . . .  C ADDR   2074H   R   SEG=MAIN   5177# 5182
LODT . . . . . . .  C ADDR   2080H   R   SEG=MAIN   5189# 5194
LOIZMK . . . . . .  C ADDR   11D0H   R   SEG=MAIN   2945# 2982
LOKAME1. . . . . .  C ADDR   183CH   R   SEG=MAIN   3865#
LOLEVT . . . . . .  C ADDR   2067H   R   SEG=MAIN   2210 5170#
LOLIST . . . . . .  C ADDR   1326H   R   SEG=MAIN   3134#
LOME1. . . . . . .  C ADDR   1B3BH   R   SEG=MAIN   4312# 4316 4319 4322 4325 4329 4332 4335 4338 4342
LOMENU . . . . . .  C ADDR   1B33H   R   SEG=MAIN   2509 2522 3865 3907 3930 4309#
LOOP . . . . . . .  C ADDR   1FC0H   R   SEG=MAIN   5027# 5028
LOOPS. . . . . . .  C ADDR   284DH   R   SEG=MAIN   6559# 6592
LOSPUS . . . . . .  C ADDR   203EH   R   SEG=MAIN   1977 5129#
LOSTAT . . . . . .  C ADDR   134EH   R   SEG=MAIN   3147 3153#
LOTEXT . . . . . .  C ADDR   207CH   R   SEG=MAIN   1447 1451 1544 2241 2399 2407 2415 2529 2533 2565 2574 2582 2591
                                           2599 2848 2938 3008 3093 3135 3144 3150 3155 3161 3176 3338 3371 3383 3438
                                           3560 3624 3648 3804 3840 3848 3861 3882 3887 3926 4035 4081 4085 4243 4312
                                           4419 5186# 5754
LOTP . . . . . . .  C ADDR   22BAH   R   SEG=MAIN   5577# 5587 5590
LOTPUS . . . . . .  C ADDR   22B2H   R   SEG=MAIN   3938 5124 5574#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   136

LOU. . . . . . . .  C ADDR   0D78H   R   SEG=MAIN   2250 2266 2270#
LOUIZM . . . . . .  C ADDR   0D55H   R   SEG=MAIN   2250# 2275 5121
LOUTF. . . . . . .  C ADDR   0FEBH   R   SEG=MAIN   2652# 2661 2668
LOVICH . . . . . .  C ADDR   11C6H   R   SEG=MAIN   2941# 2975 2996 4274
LOWR . . . . . . .  C ADDR   1340H   R   SEG=MAIN   3141 3147#
LOWR1. . . . . . .  C ADDR   1345H   R   SEG=MAIN   3149# 3330
LSUB . . . . . . .  C ADDR   2979H   R   SEG=MAIN   1160 1333 5079 6761#
LTEMP. . . . . . .  N NUMB   0008H   A      1076 1078 1079 1080 5409 5410 5411 5412 5932 5935 5938 5941 5984 5985
                                           5986 5987 6176# 6550 6551 6552 6553 6562 6566 6570 6574 6577 6578 6579
                                           6580 6581 6582 6583 6584 6585 6586 6587 6588 6591 6594 6599 6603 6607 6617
                                           6620 6623 6626 6642 6645 6646 6648 6649 6651 6652 6654 6659 6660 6661 6662
                                           6682 6687 6695 6703 6708 6719 6727 6733 6741 6747 7115 7116 7155 7160 7162
                                           7171 7172 7173 7174 7405 7413 7426 7429 7432 7435 8015 8018 8021 8024
LWR. . . . . . . .  C ADDR   25A4H   R   SEG=MAIN   5871# 5875
LWRX . . . . . . .  C ADDR   2568H   R   SEG=MAIN   5816# 5828
LWTOF. . . . . . .  C ADDR   042FH   A      7900#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   25BFH   R   SEG=MAIN   1634 3712 4596 4767 5879 5884 5889# 5921
MAIN . . . . . . .  C SEG    29D6H       REL=UNIT   237 294# 448
MANT1. . . . . . .  N NUMB   0002H   A      7113# 7140 7189 7190
MANT2. . . . . . .  N NUMB   0008H   A      7115# 7166 7167 7298 7300 7301 7303 7304 7306 7307 7309 7348 7349 7351
                                           7352 7354 7355 7357 7358 7362 7364 7367 7370 7468 7470 7471 7473 7474 7476
                                           7477 7479 7530 7532 7533 7535 7536 7538 7539 7541 7623 7627 7631 7635 7639
                                           7642 7645 7648
MARK0_8. . . . . .  C ADDR   0E94H   R   SEG=MAIN   2426 2444 2446#
MARKER . . . . . .  D ADDR   00B2H   A      390# 552 2148 2386 2425 2435 2443 2453 2459 2634 2642 2678 2685 2697 2777
                                           2986 3003 3024 3117 3223 3306 3346 3354 3375 3401 3408 3466 3506 3513 3553
                                           3595 3650 3666 3778 3908 4062 4075 4096 4103 4150 4183 4202 4209 4239 4270
                                           5605 5631 5657 5668 5726
MARLE. . . . . . .  C ADDR   232EH   R   SEG=MAIN   3521 5654#
MARRI. . . . . . .  C ADDR   233BH   R   SEG=MAIN   2705 5667#
MAS10. . . . . . .  C ADDR   03BAH   R   SEG=MAIN   853 866#
MAS20. . . . . . .  C ADDR   043AH   R   SEG=MAIN   866 921#
MAS4 . . . . . . .  C ADDR   052EH   R   SEG=MAIN   919 1022#
MAS5DIV. . . . . .  C ADDR   05A2H   R   SEG=MAIN   1060 1065 1070 1074 1082#
MASFULL. . . . . .  C ADDR   0569H   R   SEG=MAIN   1049 1053#
MASS0. . . . . . .  X ADDR   0100H   A      411 412# 854 859 888 896 970 978 1027 1034 5858
MASS1. . . . . . .  X ADDR   0104H   A      413# 862 885 899 967 981 1025 1037
MASS10 . . . . . .  X ADDR   0128H   A      422# 943 1000
MASS11 . . . . . .  X ADDR   012CH   A      423# 940 1002
MASS12 . . . . . .  X ADDR   0130H   A      424# 937 1004
MASS13 . . . . . .  X ADDR   0134H   A      425# 934 1006
MASS14 . . . . . .  X ADDR   0138H   A      426# 931 1008
MASS15 . . . . . .  X ADDR   013CH   A      427# 928 1010
MASS16 . . . . . .  X ADDR   0140H   A      428# 926 1012
MASS17 . . . . . .  X ADDR   0144H   A      429# 924 1014
MASS18 . . . . . .  X ADDR   0148H   A      430# 922 1016
MASS19 . . . . . .  X ADDR   014CH   A      431# 1018
MASS2. . . . . . .  X ADDR   0108H   A      414# 882 901 964 983 1023 1039
MASS3. . . . . . .  X ADDR   010CH   A      415# 879 903 961 985 1041
MASS4. . . . . . .  X ADDR   0110H   A      416# 876 905 958 987
MASS5. . . . . . .  X ADDR   0114H   A      417# 873 907 955 989
MASS6. . . . . . .  X ADDR   0118H   A      418# 871 909 953 991
MASS7. . . . . . .  X ADDR   011CH   A      419# 869 911 951 993
MASS8. . . . . . .  X ADDR   0120H   A      420# 867 913 949 995
MASS9. . . . . . .  X ADDR   0124H   A      421# 915 946 997
MASX5. . . . . . .  C ADDR   0598H   R   SEG=MAIN   1051 1076#
MAXG . . . . . . .  C ADDR   1E93H   R   SEG=MAIN   4838# 4892
MAXVIX . . . . . .  C ADDR   1EFDH   R   SEG=MAIN   4902 4907#
ME11_15DE. . . . .  C ADDR   164FH   R   SEG=MAIN   3605# 3621
ME11_15DEC . . . .  C ADDR   183BH   R   SEG=MAIN   3605 3864#
ME21_22. . . . . .  C ADDR   0FB3H   R   SEG=MAIN   2599# 2608
ME21_23. . . . . .  C ADDR   189FH   R   SEG=MAIN   3635 3916#
ME21_23DEC . . . .  C ADDR   18BBH   R   SEG=MAIN   3923 3928#
MEAVP. . . . . . .  C ADDR   113EH   R   SEG=MAIN   2865 2868#
MECLE. . . . . . .  C ADDR   0199H   R   SEG=MAIN   525# 527
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   137

MEFF . . . . . . .  C ADDR   01A0H   R   SEG=MAIN   529# 532
MEM10MS. . . . . .  C ADDR   0262H   R   SEG=MAIN   647#
MEM12NO. . . . . .  C ADDR   147AH   R   SEG=MAIN   3324 3328#
MENG . . . . . . .  C ADDR   1CB8H   R   SEG=MAIN   4519# 4569
MENU12 . . . . . .  C ADDR   1B3FH   R   SEG=MAIN   4310 4314#
MENU13 . . . . . .  C ADDR   1B47H   R   SEG=MAIN   4314 4317#
MENU14 . . . . . .  C ADDR   1B4FH   R   SEG=MAIN   4317 4320#
MENU15 . . . . . .  C ADDR   1B57H   R   SEG=MAIN   4320 4323#
MENU21 . . . . . .  C ADDR   1B5FH   R   SEG=MAIN   4323 4327#
MENU22 . . . . . .  C ADDR   1B67H   R   SEG=MAIN   4327 4330#
MENU23 . . . . . .  C ADDR   1B6FH   R   SEG=MAIN   4330 4333#
MENU31 . . . . . .  C ADDR   1B77H   R   SEG=MAIN   4333 4336#
MENU41 . . . . . .  C ADDR   1B7FH   R   SEG=MAIN   4336 4340#
MENUOFF. . . . . .  C ADDR   1121H   R   SEG=MAIN   2844 2853#
MENUON . . . . . .  C ADDR   167CH   R   SEG=MAIN   3626#
MERR . . . . . . .  C ADDR   1107H   R   SEG=MAIN   2840# 2843
ME_14. . . . . . .  C ADDR   1359H   R   SEG=MAIN   3158#
ME_41. . . . . . .  C ADDR   1930H   R   SEG=MAIN   3950 3993#
MIDL . . . . . . .  C ADDR   2880H   R   SEG=MAIN   6554 6589#
MIGN . . . . . . .  C ADDR   239AH   R   SEG=MAIN   4959 5726#
MIGNN. . . . . . .  C ADDR   23A2H   R   SEG=MAIN   5728 5733#
MIN4_HL. . . . . .  C ADDR   1D78H   R   SEG=MAIN   4635# 4649 4675 4800 4826
MING . . . . . . .  C ADDR   1DBAH   R   SEG=MAIN   4687# 4741
MINIVIX. . . . . .  C ADDR   1E24H   R   SEG=MAIN   4752 4757# 4907
MLABL2 . . . . . .  C ADDR   14E3H   R   SEG=MAIN   3339 3393# 3424 3659
MLABL2R. . . . . .  C ADDR   16BAH   R   SEG=MAIN   3659# 3662
MMM. . . . . . . .  C ADDR   025DH   R   SEG=MAIN   643#
MO220. . . . . . .  C ADDR   08D5H   R   SEG=MAIN   1175 1343 1538#
MO500I . . . . . .  C ADDR   0845H   R   SEG=MAIN   1394 1450#
MO500R . . . . . .  C ADDR   0839H   R   SEG=MAIN   1390 1446#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   0F46H   R   SEG=MAIN   2551# 2562 2571 2579 2588
MOUTKMEM . . . . .  C ADDR   1652H   R   SEG=MAIN   3606# 3611
MOVE28 . . . . . .  C ADDR   262CH   R   SEG=MAIN   1239 1257 1304 1396 2053 2091 4354 4437 4455 4561 4573 4588 4730
                                           4746 4881 4896 5984#
MOVE82 . . . . . .  C ADDR   21B6H   R   SEG=MAIN   5409#
MOVEA3 . . . . . .  C ADDR   0942H   R   SEG=MAIN   1590 1615#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2427 2650 2690 3005 3312 3355 3363 3417 3469 3514 3653 3911 4064
                                           4106 4184 4212 5661
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2423 2643 2647 2686 3006 3311 3359 3409 3413 3468 3518 3652 3910
                                           4065 4188 5670
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      7465# 7508
MUP11. . . . . . .  C ADDR   0257H   A      7512# 7557
MUP2 . . . . . . .  C ADDR   0297H   A      7542 7556#
MUP3 . . . . . . .  C ADDR   026CH   A      7511 7527#
MVV11. . . . . . .  C ADDR   14B3H   R   SEG=MAIN   3335 3368#
MVV12. . . . . . .  C ADDR   14CBH   R   SEG=MAIN   3368 3380#
N12DELCH . . . . .  C ADDR   0C5DH   R   SEG=MAIN   2109 2117#
N4DELCH. . . . . .  C ADDR   0C09H   R   SEG=MAIN   2033 2071#
N8DELCH. . . . . .  C ADDR   0C4BH   R   SEG=MAIN   2071 2109#
NBIMENU. . . . . .  C ADDR   0F4CH   R   SEG=MAIN   2555#
NBLOK. . . . . . .  D ADDR   0038H   A      311# 583 3199 3372 3436 3646 6076
NE05 . . . . . . .  C ADDR   0358H   A      7694 7696 7698 7701#
NELEM. . . . . . .  D ADDR   0037H   A      312# 584 3677 3783 3787
NEXIN. . . . . . .  C ADDR   1F5BH   R   SEG=MAIN   4962# 4969
NEXTMAX. . . . . .  C ADDR   1EC8H   R   SEG=MAIN   4870 4878#
NEXTMEA. . . . . .  C ADDR   1CEDH   R   SEG=MAIN   4551 4559#
NEXTMIN. . . . . .  C ADDR   1DEFH   R   SEG=MAIN   4719 4727#
NMINUS . . . . . .  C ADDR   065EH   R   SEG=MAIN   1205 1209#
NMINUS3. . . . . .  C ADDR   05C2H   R   SEG=MAIN   1107 1109#
NNDELCH. . . . . .  C ADDR   0BC9H   R   SEG=MAIN   2018 2033#
NNMEMB . . . . . .  C ADDR   103FH   R   SEG=MAIN   2553 2713#
NNNUL. . . . . . .  C ADDR   09B9H   R   SEG=MAIN   1696 1699#
NO . . . . . . . .  C ADDR   2868H   R   SEG=MAIN   6564 6568 6572 6576#
NO0KEY . . . . . .  C ADDR   0274H   R   SEG=MAIN   657 659 663#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   138

NO10MSV. . . . . .  C ADDR   15F6H   R   SEG=MAIN   3558 3563#
NO11V6 . . . . . .  C ADDR   0E46H   R   SEG=MAIN   2394 2402#
NO12V6 . . . . . .  C ADDR   0E59H   R   SEG=MAIN   2402 2410#
NO13V6 . . . . . .  C ADDR   0E6CH   R   SEG=MAIN   2410 2420#
NO21P7 . . . . . .  C ADDR   1AD6H   R   SEG=MAIN   4222 4252#
NO23RI . . . . . .  C ADDR   0F10H   R   SEG=MAIN   2520 2524#
NO2MSV . . . . . .  C ADDR   15F3H   R   SEG=MAIN   3562# 3563 3573
NO2PARN. . . . . .  C ADDR   092EH   R   SEG=MAIN   1592 1598#
NO31N. . . . . . .  C ADDR   15ADH   R   SEG=MAIN   3527#
NO31RI . . . . . .  C ADDR   0F2FH   R   SEG=MAIN   2526 2541#
NO3PARN. . . . . .  C ADDR   0924H   R   SEG=MAIN   1592# 1677
NO4DEL . . . . . .  C ADDR   0B9CH   R   SEG=MAIN   1981 1999#
NOAVK. . . . . . .  C ADDR   0630H   R   SEG=MAIN   1131 1180#
NOAVP. . . . . . .  C ADDR   0751H   R   SEG=MAIN   1324# 1355 1358
NOBAVP . . . . . .  C ADDR   09D5H   R   SEG=MAIN   1449 1453 1533 1715 1719#
NOBEF99. . . . . .  C ADDR   032BH   R   SEG=MAIN   769 785# 804 822 838
NOBIT. . . . . . .  C ADDR   0245H   A      7480 7494#
NOBITIZM . . . . .  C ADDR   09DEH   R   SEG=MAIN   1721 1724#
NOBL21 . . . . . .  C ADDR   0FBCH   R   SEG=MAIN   2596 2604#
NOBL22 . . . . . .  C ADDR   0FC6H   R   SEG=MAIN   2604 2624#
NOBUF. . . . . . .  C ADDR   0A13H   R   SEG=MAIN   1751 1753#
NOBUF0 . . . . . .  C ADDR   0B44H   R   SEG=MAIN   1866 1946#
NOCHI0 . . . . . .  C ADDR   0905H   R   SEG=MAIN   1344 1564#
NOCHIND. . . . . .  C ADDR   0293H   R   SEG=MAIN   677 685#
NOCHN10. . . . . .  C ADDR   0585H   R   SEG=MAIN   1062 1067#
NOCHN2 . . . . . .  C ADDR   057AH   R   SEG=MAIN   1057 1062#
NOCHN20. . . . . .  C ADDR   0590H   R   SEG=MAIN   1067 1072#
NODI2. . . . . . .  C ADDR   08EBH   R   SEG=MAIN   1541 1548#
NODI6. . . . . . .  C ADDR   114FH   R   SEG=MAIN   2875 2879#
NODI8. . . . . . .  C ADDR   0990H   R   SEG=MAIN   1661 1667#
NODI8K . . . . . .  C ADDR   199AH   R   SEG=MAIN   4050 4055#
NODI8_43 . . . . .  C ADDR   1769H   R   SEG=MAIN   3740 3746#
NODI9. . . . . . .  C ADDR   08F0H   R   SEG=MAIN   1550 1553#
NODI9_43 . . . . .  C ADDR   1774H   R   SEG=MAIN   3746 3754#
NODIS9 . . . . . .  C ADDR   099FH   R   SEG=MAIN   1667 1679#
NODISK9. . . . . .  C ADDR   19A2H   R   SEG=MAIN   4054 4055 4062#
NOENDLI. . . . . .  C ADDR   26C9H   R   SEG=MAIN   6110 6115#
NOEQU1 . . . . . .  C ADDR   1024H   R   SEG=MAIN   2689 2693#
NOEQU2 . . . . . .  C ADDR   15A7H   R   SEG=MAIN   3517 3521#
NOFIZM . . . . . .  C ADDR   0E28H   R   SEG=MAIN   2358 2390#
NOFT1. . . . . . .  C ADDR   0E01H   R   SEG=MAIN   2363 2367#
NOFZ . . . . . . .  C ADDR   0B3FH   R   SEG=MAIN   1937 1941#
NOH37. . . . . . .  C ADDR   11E5H   R   SEG=MAIN   2934 2958# 2969
NOHNOT1. . . . . .  C ADDR   12C0H   R   SEG=MAIN   3040 3083#
NOHNOT2. . . . . .  C ADDR   12B5H   R   SEG=MAIN   3076# 3083
NOKLB. . . . . . .  C ADDR   0A0DH   R   SEG=MAIN   1749 1751#
NOKORR . . . . . .  C ADDR   05D8H   R   SEG=MAIN   1118 1121#
NOLAH. . . . . . .  C ADDR   11A7H   R   SEG=MAIN   2903 2921#
NOLI_43. . . . . .  C ADDR   17E4H   R   SEG=MAIN   3773 3818#
NOM31. . . . . . .  C ADDR   1585H   R   SEG=MAIN   3421 3496#
NOM32. . . . . . .  C ADDR   15FEH   R   SEG=MAIN   3496 3569#
NOM33. . . . . . .  C ADDR   162CH   R   SEG=MAIN   3569 3589#
NOMARL . . . . . .  C ADDR   1A7EH   R   SEG=MAIN   4186 4192 4196#
NOMAXI . . . . . .  C ADDR   1EE0H   R   SEG=MAIN   4887 4890#
NOME11 . . . . . .  C ADDR   146AH   R   SEG=MAIN   3321#
NOMEM11. . . . . .  C ADDR   0F67H   R   SEG=MAIN   2558 2568#
NOMEM12. . . . . .  C ADDR   0F7DH   R   SEG=MAIN   2568 2576#
NOMEM13. . . . . .  C ADDR   0F93H   R   SEG=MAIN   2576 2585#
NOMEMK . . . . . .  C ADDR   1467H   R   SEG=MAIN   3106 3319#
NOMINI . . . . . .  C ADDR   1E07H   R   SEG=MAIN   4736 4739#
NON1C. . . . . . .  C ADDR   0DD4H   R   SEG=MAIN   2338 2342#
NONULAVT . . . . .  C ADDR   0615H   R   SEG=MAIN   1126 1165#
NONULDEL . . . . .  C ADDR   0B7EH   R   SEG=MAIN   1969 1980#
NOP3_0 . . . . . .  C ADDR   0909H   R   SEG=MAIN   1570#
NOPART1. . . . . .  C ADDR   032FH   R   SEG=MAIN   758 792#
NOPART2. . . . . .  C ADDR   034FH   R   SEG=MAIN   792 811#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   139

NOPART3. . . . . .  C ADDR   036FH   R   SEG=MAIN   811 827#
NOPART4. . . . . .  C ADDR   038FH   R   SEG=MAIN   827 844#
NOPLUS . . . . . .  C ADDR   0EBCH   R   SEG=MAIN   2471 2474#
NOPOIN7. . . . . .  C ADDR   1A95H   R   SEG=MAIN   4182 4217#
NOPOINT. . . . . .  C ADDR   1A61H   R   SEG=MAIN   4176 4180#
NOR11. . . . . . .  C ADDR   0ED0H   R   SEG=MAIN   2485#
NORDN. . . . . . .  C ADDR   00F6H   A      7201# 7234
NORDN1 . . . . . .  C ADDR   0107H   A      7203 7217#
NORIG2 . . . . . .  C ADDR   1001H   R   SEG=MAIN   2657 2665#
NORIM6 . . . . . .  C ADDR   103FH   R   SEG=MAIN   2717#
NORIME . . . . . .  C ADDR   0EF6H   R   SEG=MAIN   2507 2511#
NORIME1. . . . . .  C ADDR   0EF0H   R   SEG=MAIN   2509# 2512 2525
NORM1. . . . . . .  C ADDR   00F0H   A      7196# 7393 7570 7672 7889
NORR11 . . . . . .  C ADDR   11FDH   R   SEG=MAIN   2971#
NORR12 . . . . . .  C ADDR   120DH   R   SEG=MAIN   2971 2978# 2992
NORUP. . . . . . .  C ADDR   0119H   A      7200 7237#
NORUP1 . . . . . .  C ADDR   011EH   A      7242# 7260
NORUP2 . . . . . .  C ADDR   0132H   A      7244 7261#
NORVICH. . . . . .  C ADDR   0A16H   R   SEG=MAIN   1676 1754#
NOSUB. . . . . . .  C ADDR   28A3H   R   SEG=MAIN   6598 6602 6606 6611#
NOT1IN . . . . . .  C ADDR   0B54H   R   SEG=MAIN   1827 1954#
NOT1_7 . . . . . .  C ADDR   10F7H   R   SEG=MAIN   2825 2832#
NOT2IN . . . . . .  C ADDR   0B5CH   R   SEG=MAIN   1954 1958#
NOT2_7 . . . . . .  C ADDR   1102H   R   SEG=MAIN   2832 2837#
NOT3IN . . . . . .  C ADDR   0B64H   R   SEG=MAIN   1958 1961#
NOTAKT . . . . . .  C ADDR   09E8H   R   SEG=MAIN   1725 1729#
NOTE21 . . . . . .  C ADDR   06D5H   R   SEG=MAIN   1226 1268#
NOTE22 . . . . . .  C ADDR   06F0H   R   SEG=MAIN   1268 1280#
NOTESTIZM. . . . .  C ADDR   0708H   R   SEG=MAIN   1189 1292#
NOTT1. . . . . . .  C ADDR   0AF4H   R   SEG=MAIN   1899 1908#
NOTT2. . . . . . .  C ADDR   0AFFH   R   SEG=MAIN   1908 1913#
NOTT3. . . . . . .  C ADDR   0B0AH   R   SEG=MAIN   1913 1919#
NOTT4. . . . . . .  C ADDR   0B1EH   R   SEG=MAIN   1919 1927#
NOTT5. . . . . . .  C ADDR   0B2CH   R   SEG=MAIN   1927 1932#
NOT_1. . . . . . .  C ADDR   0DDBH   R   SEG=MAIN   2342 2347#
NOT_10 . . . . . .  C ADDR   0DDBH   R   SEG=MAIN   2346#
NOVIR. . . . . . .  C ADDR   0ED8H   R   SEG=MAIN   2379 2496#
NOVIR1 . . . . . .  C ADDR   0E12H   R   SEG=MAIN   2379# 2390
NOZMEA . . . . . .  C ADDR   1D68H   R   SEG=MAIN   4616 4618#
NOZMIN . . . . . .  C ADDR   1E5BH   R   SEG=MAIN   4787 4789#
NOZZMI . . . . . .  C ADDR   0980H   R   SEG=MAIN   1656 1658#
NOZZMI43 . . . . .  C ADDR   1759H   R   SEG=MAIN   3735 3737#
NSEC1. . . . . . .  C ADDR   09C2H   R   SEG=MAIN   1700 1703#
NSEC10 . . . . . .  C ADDR   09CBH   R   SEG=MAIN   1702 1705 1710#
NSEC11 . . . . . .  C ADDR   09C9H   R   SEG=MAIN   1703 1707#
NUERR. . . . . . .  D ADDR   0039H   A      310# 4069 4935 4949 5755
NULAVT . . . . . .  C ADDR   0BAEH   R   SEG=MAIN   2016#
NUMSIZE. . . . . .  N NUMB   0004H   A      6179# 6201 6239 6246 6321 6341
OBOARD . . . . . .  C ADDR   27D9H   R   SEG=MAIN   6422 6436#
OBOARD1. . . . . .  C ADDR   2821H   R   SEG=MAIN   6495 6508#
OK1. . . . . . . .  C ADDR   0186H   A      7327 7342#
OK2. . . . . . . .  C ADDR   01A0H   A      7344 7359#
OK3. . . . . . . .  C ADDR   01C4H   A      7376 7392#
ONBOAR1. . . . . .  C ADDR   27FFH   R   SEG=MAIN   6457 6474#
ONBOARD. . . . . .  C ADDR   27B3H   R   SEG=MAIN   6386 6400#
ONMEM11. . . . . .  C ADDR   12E2H   R   SEG=MAIN   2852 2867 2869 3100# 3625 3631 3862 3866 3871 3885 3890 3913 3927
                                           3931 3942
ONMEM12. . . . . .  C ADDR   18C2H   R   SEG=MAIN   3932# 3935 3954
ONMEM13. . . . . .  C ADDR   1A41H   R   SEG=MAIN   4107 4162# 4166 4168
ONMIG. . . . . . .  C ADDR   23B0H   R   SEG=MAIN   5737 5746#
ONVICH . . . . . .  C ADDR   0D4DH   R   SEG=MAIN   2233 2245#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 487
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 480 484
OUT43. . . . . . .  C ADDR   177DH   R   SEG=MAIN   3763#
OUT6 . . . . . . .  C ADDR   103FH   R   SEG=MAIN   2123 2188 2303 2308 2313 2329 2365 2370 2377 2388 2510 2523 2531
                                           2535 2718#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   140

OUT7 . . . . . . .  C ADDR   1B04H   R   SEG=MAIN   2751 2752 2829 2836 2840 2858 2909 2914 2965 3104 3184 3386 3480
                                           3765 3772 3817 3900 3988 4083 4087 4157 4171 4214 4219 4249 4277#
OUTA . . . . . . .  C ADDR   2348H   R   SEG=MAIN   3010 5678#
OUTA2. . . . . . .  C ADDR   2362H   R   SEG=MAIN   5689# 5694
OUTB . . . . . . .  C ADDR   236BH   R   SEG=MAIN   5698#
OUTB2. . . . . . .  C ADDR   2391H   R   SEG=MAIN   5716# 5721
OUTB3. . . . . . .  C ADDR   237CH   R   SEG=MAIN   5702 5707#
OUTF . . . . . . .  C ADDR   0E08H   R   SEG=MAIN   2373# 2396 2400 2404 2408 2412 2416 2441 2464 2473 2476 2483 2551
                                           2566 2575 2583 2592 2602 2649 2652 2692 2706 2709 2955 2956 3932
OUTFL. . . . . . .  C ADDR   0ECDH   R   SEG=MAIN   2479 2483#
OUTKMEM. . . . . .  C ADDR   12EFH   R   SEG=MAIN   3108# 3126 3606
OUTMA. . . . . . .  C ADDR   0EA6H   R   SEG=MAIN   2462 2464#
OUTMAX . . . . . .  C ADDR   1EE5H   R   SEG=MAIN   4874 4893#
OUTMEA . . . . . .  C ADDR   1D08H   R   SEG=MAIN   4555 4570#
OUTMENU. . . . . .  C ADDR   187EH   R   SEG=MAIN   3899#
OUTMIN . . . . . .  C ADDR   1E0CH   R   SEG=MAIN   4723 4743#
OUTR . . . . . . .  C ADDR   089CH   R   SEG=MAIN   1479 1502#
OUTR5. . . . . . .  C ADDR   08B8H   R   SEG=MAIN   1500 1521#
OUTSKO . . . . . .  C ADDR   1923H   R   SEG=MAIN   3984 3986#
OUTSKO1. . . . . .  C ADDR   1920H   R   SEG=MAIN   3982 3985#
OUTVICH. . . . . .  C ADDR   0E15H   R   SEG=MAIN   2380# 2392
OUTVIR . . . . . .  C ADDR   0CE1H   R   SEG=MAIN   2155 2184#
OUT_KALI . . . . .  C ADDR   1C03H   R   SEG=MAIN   4421#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 6378
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 4962 4966
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 458
P1 . . . . . . . .  D ADDR   0090H   A      32# 615 616 4975 4977 4980 4983 4987 4989 4990 5042 5044 5046 5476 5483
                                           6014 6017 6019 6022
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 459
P2 . . . . . . . .  D ADDR   00A0H   A      47# 5008 5012 5021
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 460
P3 . . . . . . . .  D ADDR   00B0H   A      62# 469 2154 2156 2158 2159 2162 2163 2167 2168 2170 2171 2173 2174 2176
                                           2177 2179 2180 2352 2353 2359 2360 2391 2392 2395 2396 2403 2404 2411 2412
                                           2420 2421 2466 2467 2477 2478 2504 2505 2518 2519 2545 2546 2547 2548 2560
                                           2561 2569 2570 2577 2578 2586 2587 2625 2626 2660 2661 2669 2670 2707 2708
                                           2737 2784 2786 2788 2789 2792 2793 2795 2796 2798 2799 2801 2802 2804 2805
                                           2807 2808 2904 2907 2933 2934 2958 2959 2972 2973 2979 2980 2993 2994 3038
                                           3039 3125 3126 3129 3130 3171 3172 3188 3189 3190 3191 3231 3232 3321 3322
                                           3332 3333 3423 3424 3425 3426 3497 3498 3527 3528 3570 3571 3572 3573 3590
                                           3591 3592 3593 3610 3611 3618 3619 3661 3662 3663 3664 3774 3775 3854 3855
                                           3921 3922 3934 3935 3951 3952 3953 3954 3994 3995 3996 3997 4165 4166 4167
                                           4168 4174 4175 4180 4181 4217 4218 4291 5007 5009 5011 5017 5018 5019 5022
                                           5023
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2130 2736 2758 4290
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 462
P4 . . . . . . . .  D ADDR   0084H   A      20# 1971 1992 2019 2102 2257 2259 4407 5099 5102 5118 5120 5579
P5 . . . . . . . .  D ADDR   0085H   A      21# 558 567 1973 1994 2021 2024 2029 2064 2066 2104 2267 2269 4411 5107
                                           5110 5140 5143 5583
P6 . . . . . . . .  D ADDR   0086H   A      22# 1878 1880 1884 1886 2739 2741 2745 2747 4294 4296 4300 4302
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 463
PACK1. . . . . . .  C ADDR   00DEH   A      7179# 7394 7571 7673 7890
PARERR . . . . . .  C ADDR   19AFH   R   SEG=MAIN   4026 4028 4030 4069#
PARN . . . . . . .  D ADDR   00AFH   A      387# 564 1690 2333 3066
PAROL. . . . . . .  D ADDR   00A8H   A      383#
PART . . . . . . .  D ADDR   009AH   A      377# 559 756 1096 1138 1165 1180 1699 1755 1898 2297 2334 2823 3049 3065
                                           3470 3557 5111 5503
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   141

PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 456
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 457
PCON . . . . . . .  D ADDR   0087H   A      23# 503
POIN3. . . . . . .  C ADDR   1A94H   R   SEG=MAIN   4215# 4250
POINA. . . . . . .  C ADDR   1AD1H   R   SEG=MAIN   4213 4249#
POINA1 . . . . . .  C ADDR   1A79H   R   SEG=MAIN   4185 4192#
POINA2 . . . . . .  C ADDR   1A73H   R   SEG=MAIN   4188# 4193
POZB . . . . . . .  C ADDR   1AF4H   R   SEG=MAIN   4263 4267#
PROD . . . . . . .  N NUMB   000CH   A      7116# 7460 7461 7462 7463 7483 7484 7485 7487 7488 7490 7491 7493 7515
                                           7517 7518 7520 7521 7523 7524 7526 7545 7546 7547 7549 7550 7552 7553 7555
                                           7566 7567 7568 7569 7590 7591 7592 7593 7609 7611 7612 7614 7615 7617 7618
                                           7620 7650 7667 7668 7669 7670
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 7921 7925 7978 7981
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 2133 2727 2761 4288 5923 5925 6851
                                           6859
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0CEBH   R   SEG=MAIN   2178 2190#
QUES . . . . . . .  C ADDR   139BH   R   SEG=MAIN   3184# 3189
QU_AVP . . . . . .  C ADDR   074EH   R   SEG=MAIN   1321 1323#
R10. . . . . . . .  N NUMB   000AH   A      443# 1127 1399 1407 4029 5551 7944
R11. . . . . . . .  N NUMB   000BH   A      444# 1128 1400 1406 5555 7948
R8 . . . . . . . .  N NUMB   0008H   A      441# 510 1397 1409 3879 4025 5062 5543 7936
R9 . . . . . . . .  N NUMB   0009H   A      442# 1398 1408 4027 5063 5547 7940
RAFTERK. . . . . .  C ADDR   05EEH   R   SEG=MAIN   1135# 1141
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RDDOUTF. . . . . .  C ADDR   13E2H   R   SEG=MAIN   3228# 3232
RE1. . . . . . . .  C ADDR   1FC9H   R   SEG=MAIN   5042# 5048
RE11_7 . . . . . .  C ADDR   0696H   R   SEG=MAIN   1237# 1279 1290
RE4BYTE. . . . . .  C ADDR   0454H   A      509 3878 4023 7932#
REA3_X . . . . . .  C ADDR   26E6H   R   SEG=MAIN   3707 6144#
REACP. . . . . . .  D ADDR   0077H   A      304# 630 632 634 636 697 713 721 729 738 745 760 795 813 829 845 2038
                                           2040 2042 2044 2076 2078 2080 2082
READ . . . . . . .  C ADDR   1FC7H   R   SEG=MAIN   629 631 633 5041#
READYACP . . . . .  C ADDR   02E6H   R   SEG=MAIN   739 749#
READ_X2. . . . . .  C ADDR   1FAFH   R   SEG=MAIN   5016# 5027
REBYTE . . . . . .  C ADDR   0236H   R   SEG=MAIN   614# 648 674 786 1997 2007 2031 2069 2107 2116 2118
REBYTE2. . . . . .  C ADDR   046CH   A      1229 1237 1255 1271 1282 1298 4427 4435 7952#
REF0CN . . . . . .  D ADDR   00D1H   A      92# 464
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RENDKALIB. . . . .  C ADDR   1130H   R   SEG=MAIN   2862# 2864
RESAR2 . . . . . .  C ADDR   2638H   R   SEG=MAIN   761 796 814 830 846 858 894 976 1032 1153 1198 1306 1327 1379
                                           1402 1425 1578 1632 1850 1947 1984 2891 4348 4356 4375 4453 4475 4563 4575
                                           4590 4670 4728 4744 4758 4821 4879 4894 5679 5699 5992# 6128
RESAR8 . . . . . .  C ADDR   25F6H   R   SEG=MAIN   1109 1159 1201 1209 1332 2051 2089 5931#
RESA_HL. . . . . .  C ADDR   26CAH   R   SEG=MAIN   1870 4508 4646 4796 6118#
REZAM. . . . . . .  D ADDR   008CH   A      373# 2086
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   142

REZAP. . . . . . .  D ADDR   0088H   A      372# 2048
REZMUL . . . . . .  C ADDR   0646H   R   SEG=MAIN   1173 1187 1196#
REZ_A. . . . . . .  D ADDR   0062H   A      362# 774 847 857 893 975 1031 1983
REZ_A0 . . . . . .  D ADDR   006AH   A      364# 1158 1331 1369 1559 2228 2883 2892 2899
REZ_A1 . . . . . .  D ADDR   0066H   A      363# 1090 1156 1197 1311 1326 1345
REZ_A2 . . . . . .  D ADDR   007BH   A      365# 1328
REZ_A3 . . . . . .  D ADDR   009CH   A      379# 1161 1334 1378 1577 1631 1760 2890 4347 4452 6127 6158
REZ_AK . . . . . .  D ADDR   00A4H   A      382# 4144 4355
REZ_AME. . . . . .  D ADDR   005EH   A      360# 1102 1111 1152 1211 1305
REZ_DEL. . . . . .  D ADDR   00C5H   A      397# 776
REZ_R. . . . . . .  D ADDR   00C9H   A      398# 1411 1424
RGOTO7 . . . . . .  C ADDR   1582H   R   SEG=MAIN   3494# 3528
RHNOR11. . . . . .  C ADDR   11D7H   R   SEG=MAIN   2932 2944 2950#
RHNOT1 . . . . . .  C ADDR   119EH   R   SEG=MAIN   2907 2916#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RI21_23. . . . . .  C ADDR   0EF9H   R   SEG=MAIN   2502 2514#
RI6. . . . . . . .  C ADDR   0EF3H   R   SEG=MAIN   2505 2510# 2519 2544 2548
RIGBLO . . . . . .  C ADDR   0FC9H   R   SEG=MAIN   2625# 2656 2658
RIGBLOK. . . . . .  C ADDR   1007H   R   SEG=MAIN   2669#
RIGHT2 . . . . . .  C ADDR   0D12H   R   SEG=MAIN   2205 2209#
RIGHT3 . . . . . .  C ADDR   0D16H   R   SEG=MAIN   2207 2212#
RIKN . . . . . . .  C ADDR   0E7EH   R   SEG=MAIN   2427# 2445
RIZMAN . . . . . .  C ADDR   0C6DH   R   SEG=MAIN   2127# 2164
RI_31. . . . . . .  C ADDR   0F13H   R   SEG=MAIN   2517 2526#
RKNLEFT. . . . . .  C ADDR   1079H   R   SEG=MAIN   2755# 2800
RKNMEM . . . . . .  C ADDR   106AH   R   SEG=MAIN   2750# 2806
RKNNUL . . . . . .  C ADDR   1076H   R   SEG=MAIN   2754# 2794
RKNOPT . . . . . .  C ADDR   0C6AH   R   SEG=MAIN   2126# 2175
RKNRAZR. . . . . .  C ADDR   0C67H   R   SEG=MAIN   2125# 2169
RKVVOD0. . . . . .  C ADDR   132FH   R   SEG=MAIN   3131 3138#
RLABELF. . . . . .  C ADDR   0C64H   R   SEG=MAIN   2124# 2161
RLABELH. . . . . .  C ADDR   1073H   R   SEG=MAIN   2753# 2791
RLABELI. . . . . .  C ADDR   11A4H   R   SEG=MAIN   2919#
RLABELK. . . . . .  C ADDR   11A1H   R   SEG=MAIN   2918# 2921
RLABELL. . . . . .  C ADDR   0ED5H   R   SEG=MAIN   2494#
RLABELL1 . . . . .  C ADDR   103CH   R   SEG=MAIN   2708 2711#
RLABELN. . . . . .  C ADDR   0F43H   R   SEG=MAIN   2546 2550#
RLABELP. . . . . .  C ADDR   1822H   R   SEG=MAIN   3852# 3855
RLABELS13. . . . .  C ADDR   192DH   R   SEG=MAIN   3991# 3995
RLABELS4 . . . . .  C ADDR   192AH   R   SEG=MAIN   3990# 3993
RLABL2 . . . . . .  C ADDR   1395H   R   SEG=MAIN   3182#
RLABM. . . . . . .  C ADDR   1398H   R   SEG=MAIN   3183# 3187
RLEFCUR. . . . . .  C ADDR   1629H   R   SEG=MAIN   3587# 3591
RLER . . . . . . .  C ADDR   233AH   R   SEG=MAIN   5662 5664#
RLIST_43 . . . . .  C ADDR   16B7H   R   SEG=MAIN   3658# 3660
RMAS4. . . . . . .  C ADDR   0437H   R   SEG=MAIN   919# 921
RME21_23 . . . . .  C ADDR   1687H   R   SEG=MAIN   3616 3635#
RMO220 . . . . . .  C ADDR   0628H   R   SEG=MAIN   1175# 1222
RNNMEMB. . . . . .  C ADDR   0F49H   R   SEG=MAIN   2553# 2556
RNO3PARN . . . . .  C ADDR   099DH   R   SEG=MAIN   1677# 1691
RNOBUF0. . . . . .  C ADDR   0AB1H   R   SEG=MAIN   1862 1866#
RNOCHI0. . . . . .  C ADDR   0776H   R   SEG=MAIN   1340 1344#
RNOH37 . . . . . .  C ADDR   11FBH   R   SEG=MAIN   2969# 2973 2980 2994
RNOM31 . . . . . .  C ADDR   1500H   R   SEG=MAIN   3421# 3422
RNOMEMK. . . . . .  C ADDR   12ECH   R   SEG=MAIN   3106# 3124
RNORVICH . . . . .  C ADDR   099BH   R   SEG=MAIN   1620 1621 1676#
RNOT1IN. . . . . .  C ADDR   0A6FH   R   SEG=MAIN   1757 1827#
RNOTESTIZM . . . .  C ADDR   063EH   R   SEG=MAIN   1189# 1224
ROUT6. . . . . . .  C ADDR   0C61H   R   SEG=MAIN   2123# 2160
ROUT7. . . . . . .  C ADDR   1070H   R   SEG=MAIN   2752# 2785 2790
ROUTF. . . . . . .  C ADDR   11F8H   R   SEG=MAIN   2965# 3039
RR0. . . . . . . .  N NUMB   0000H   A      434# 2134 2726 2762 4287
RR1. . . . . . . .  N NUMB   0001H   A      435# 2135 2725 2763 4286
RR2. . . . . . . .  N NUMB   0002H   A      437# 1231 1243 1249 1261 1273 1284 2136 2724 2764 3686 3694 4285 4429
                                           4441 4447 4459 5075
RR3. . . . . . . .  N NUMB   0003H   A      438# 1232 1242 1250 1260 1274 1285 2137 2723 2765 3687 3693 4284 4430
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   143

                                           4440 4448 4458 5076
RR4. . . . . . . .  N NUMB   0004H   A      1233 1241 1251 1259 1275 1286 2138 2722 2766 3688 3692 4283 4431 4439
                                           4449 4457 6180# 6237 6258 6274 6318 6340
RR5. . . . . . . .  N NUMB   0005H   A      1234 1240 1252 1258 1276 1287 2139 2721 2767 3689 3691 4282 4432 4438
                                           4450 4456 6181# 6238 6245 6252 6319 6328
RR6. . . . . . . .  N NUMB   0006H   A      436# 2140 2720 2768 4281
RR7. . . . . . . .  N NUMB   0007H   A      439# 2141 2719 2769 4280
RRIR . . . . . . .  C ADDR   2347H   R   SEG=MAIN   5673 5675#
RRMO220. . . . . .  C ADDR   0773H   R   SEG=MAIN   1317 1343#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   0937H   R   SEG=MAIN   1604# 1622 1624 1625
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 494 2859
RTIZMRI. . . . . .  C ADDR   0DDFH   R   SEG=MAIN   2350#
RVVIZKO. . . . . .  C ADDR   11D9H   R   SEG=MAIN   2952# 2960
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SADIAP . . . . . .  D ADDR   0034H   A      314# 563 1876 3737
SAUS . . . . . . .  D ADDR   0036H   A      313# 1972 1974 1991 1993 2020 2022 2101 2103
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2152 2440 2458 2639 2683 2703 2781 3351 3406 3511 4101 4207 5738
                                           5746
SAVEIR2. . . . . .  C ADDR   257AH   R   SEG=MAIN   860 897 979 1035 5831#
SAVELTE. . . . . .  C ADDR   04A7H   A      8015#
SAVEN_BL . . . . .  D ADDR   00D3H   A      401# 6097 6118
SAVER2 . . . . . .  C ADDR   2586H   R   SEG=MAIN   576 578 580 582 765 775 777 800 818 834 848 1091 1103 1112 1157
                                           1162 1212 1312 1329 1335 1346 1412 1416 1636 1855 1905 1989 2049 2061 2087
                                           2099 2893 2900 3717 4145 4237 4268 4365 4467 4566 4578 4598 4673 4738 4754
                                           4769 4824 4889 4904 5682 5709 5845# 6159
SAVE_HL. . . . . .  C ADDR   26ADH   R   SEG=MAIN   1873 3552 6097#
SBUF0. . . . . . .  D ADDR   0099H   A      40# 4917 4923
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160 502 4918 4922 4925 4926 4947
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   1F71H   R   SEG=MAIN   4975# 4982
SDV1 . . . . . . .  C ADDR   1F85H   R   SEG=MAIN   4987# 4993
SDVIG0 . . . . . .  C ADDR   02C7H   R   SEG=MAIN   725# 727
SDVIG1 . . . . . .  C ADDR   02BCH   R   SEG=MAIN   717# 719
SDVIG2 . . . . . .  C ADDR   02B1H   R   SEG=MAIN   709# 711
SDVIG3 . . . . . .  C ADDR   02A5H   R   SEG=MAIN   700# 702
SDVIG4 . . . . . .  C ADDR   02D6H   R   SEG=MAIN   735# 737
SDVIG6 . . . . . .  C ADDR   02E0H   R   SEG=MAIN   742# 744
SDVM . . . . . . .  C ADDR   02DEH   R   SEG=MAIN   732 741#
SEEGOON. . . . . .  C ADDR   09A2H   R   SEG=MAIN   1666 1674 1681#
SEEIND . . . . . .  C ADDR   09B0H   R   SEG=MAIN   1596 1603 1604 1693#
SEE_L43. . . . . .  C ADDR   1777H   R   SEG=MAIN   3745 3753 3756#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      7111# 7132 7133 7158 7159 7183 7326 7343 7564 7604
SKOR19 . . . . . .  C ADDR   1867H   R   SEG=MAIN   3880 3886#
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   1268H   R   SEG=MAIN   3034# 3050
SP . . . . . . . .  D ADDR   0081H   A      17# 455
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 500
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   144

SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 499
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 4964
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SPWRI. . . . . . .  C ADDR   1905H   R   SEG=MAIN   3969 3971#
SS1. . . . . . . .  C ADDR   20A1H   R   SEG=MAIN   5221# 5223
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      391# 762 764 779 797 799 815 817 831 833 1367 1557 2226 2881
SUMT2. . . . . . .  C ADDR   0332H   R   SEG=MAIN   753 794#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T2MSME . . . . . .  C ADDR   15EDH   R   SEG=MAIN   3560# 3565
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   2239H   R   SEG=MAIN   5494# 5504
TABN . . . . . . .  C ADDR   22D1H   R   SEG=MAIN   5596# 5600
TABT11 . . . . . .  C ADDR   205FH   R   SEG=MAIN   5160# 5576
TABT7. . . . . . .  C ADDR   2063H   R   SEG=MAIN   4404 5164# 5589
TABT9. . . . . . .  C ADDR   2061H   R   SEG=MAIN   5162# 5586
TABUS. . . . . . .  C ADDR   204BH   R   SEG=MAIN   5096 5149#
TAKTIND. . . . . .  C ADDR   09EDH   R   SEG=MAIN   1728 1731#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 491 492 506
TE10MS . . . . . .  C ADDR   23CCH   R   SEG=MAIN   3559 5761#
TE22 . . . . . . .  C ADDR   22C4H   R   SEG=MAIN   5575 5585#
TE23 . . . . . . .  C ADDR   22CCH   R   SEG=MAIN   5585 5589#
TE2MS. . . . . . .  C ADDR   23C2H   R   SEG=MAIN   3564 5760#
TEAEQU0. . . . . .  C ADDR   2408H   R   SEG=MAIN   3007 5769#
TEAVK. . . . . . .  C ADDR   2444H   R   SEG=MAIN   4321 5776#
TEBEQU0. . . . . .  C ADDR   2412H   R   SEG=MAIN   5770#
TEBL . . . . . . .  C ADDR   24F8H   R   SEG=MAIN   2598 3175 5798#
TEBL0. . . . . . .  C ADDR   2502H   R   SEG=MAIN   3370 5799#
TECH . . . . . . .  C ADDR   250CH   R   SEG=MAIN   3647 3803 5800#
TECLE. . . . . . .  C ADDR   24BDH   R   SEG=MAIN   2590 3092 3143 5792#
TEEND. . . . . . .  C ADDR   255CH   R   SEG=MAIN   4418 5809#
TEERR. . . . . . .  C ADDR   2552H   R   SEG=MAIN   5753 5808#
TEFULL . . . . . .  C ADDR   24E4H   R   SEG=MAIN   2605 3337 5796#
TEINT. . . . . . .  C ADDR   24EEH   R   SEG=MAIN   3437 5797#
TEIZMK . . . . . .  C ADDR   249FH   R   SEG=MAIN   2398 2946 5789#
TEKALIB. . . . . .  C ADDR   244EH   R   SEG=MAIN   3623 4324 5777#
TEKD . . . . . . .  C ADDR   2495H   R   SEG=MAIN   4034 5788#
TELIST . . . . . .  C ADDR   24D9H   R   SEG=MAIN   2573 3154 3160 5795#
TEMAX. . . . . . .  C ADDR   252AH   R   SEG=MAIN   3839 5803#
TEMEM. . . . . . .  C ADDR   24C7H   R   SEG=MAIN   5793#
TEMENU . . . . . .  C ADDR   241CH   R   SEG=MAIN   5771#
TEMID. . . . . . .  C ADDR   2534H   R   SEG=MAIN   3847 5804#
TEMIN. . . . . . .  C ADDR   2520H   R   SEG=MAIN   3382 5802#
TEMUL. . . . . . .  C ADDR   0725H   R   SEG=MAIN   1267 1304#
TENMIN . . . . . .  C ADDR   213BH   R   SEG=MAIN   1170 1172 1186 5286#
TEOLI. . . . . . .  C ADDR   253EH   R   SEG=MAIN   1450 5806#
TEOLL. . . . . . .  C ADDR   24B3H   R   SEG=MAIN   1543 5791#
TEOLR. . . . . . .  C ADDR   2548H   R   SEG=MAIN   1446 5807#
TEOUT. . . . . . .  C ADDR   24A9H   R   SEG=MAIN   2406 2487 2937 5790#
TEPAR. . . . . . .  C ADDR   248BH   R   SEG=MAIN   4341 5787#
TES19_2. . . . . .  C ADDR   2481H   R   SEG=MAIN   515 2532 3886 4084 5785#
TES57_6. . . . . .  C ADDR   2477H   R   SEG=MAIN   2528 3881 4080 4337 5784#
TESKOR . . . . . .  C ADDR   243AH   R   SEG=MAIN   4318 5775#
TEST01 . . . . . .  C ADDR   1F0CH   R   SEG=MAIN   4922# 4945
TEST02 . . . . . .  C ADDR   1F3BH   R   SEG=MAIN   4942 4944#
TEST04 . . . . . .  C ADDR   1F1CH   R   SEG=MAIN   4929# 4931
TEST1. . . . . . .  C ADDR   1F02H   R   SEG=MAIN   4917# 4933 4954
TEST2. . . . . . .  C ADDR   1F34H   R   SEG=MAIN   4922 4941#
TEST22 . . . . . .  C ADDR   18DAH   R   SEG=MAIN   3936 3943#
TEST23 . . . . . .  C ADDR   18DFH   R   SEG=MAIN   3943 3946#
TEST3. . . . . . .  C ADDR   1F26H   R   SEG=MAIN   4924 4934#
TEST4. . . . . . .  C ADDR   1F14H   R   SEG=MAIN   4925# 4940
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   145

TEST5. . . . . . .  C ADDR   1F3EH   R   SEG=MAIN   4943 4946#
TEST7I . . . . . .  C ADDR   0A05H   R   SEG=MAIN   1743 1746#
TEST9I . . . . . .  C ADDR   09FEH   R   SEG=MAIN   1738 1743#
TESTAT . . . . . .  C ADDR   2516H   R   SEG=MAIN   2581 3134 5801#
TESTRS . . . . . .  C ADDR   1F00H   R   SEG=MAIN   3870 4915#
TESTS. . . . . . .  C ADDR   18CEH   R   SEG=MAIN   3938# 3945 3948
TETE11 . . . . . .  C ADDR   2459H   R   SEG=MAIN   3860 4328 5779#
TETE7. . . . . . .  C ADDR   246DH   R   SEG=MAIN   3925 4334 5781#
TETE9. . . . . . .  C ADDR   2463H   R   SEG=MAIN   4331 5780#
TETESI . . . . . .  C ADDR   2426H   R   SEG=MAIN   2847 4311 5773#
TETESR . . . . . .  C ADDR   2430H   R   SEG=MAIN   4315 5774#
TEVICH . . . . . .  C ADDR   23FEH   R   SEG=MAIN   2240 2414 2942 4242 5768#
TEWR . . . . . . .  C ADDR   24CFH   R   SEG=MAIN   2564 3149 5794#
TEXTT. . . . . . .  C ADDR   23C2H   R   SEG=MAIN   5176 5759#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 474
TH1. . . . . . . .  D ADDR   008DH   A      29# 513 517 3983 3985
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   1F95H   R   SEG=MAIN   4996#
TIM1 . . . . . . .  C ADDR   1F97H   R   SEG=MAIN   4997# 4997
TIM2 . . . . . . .  C ADDR   1F9AH   R   SEG=MAIN   4978 4981 4988 4992 5000# 5043 5047 6018 6020
TIM3 . . . . . . .  C ADDR   1F9CH   R   SEG=MAIN   5001# 5001
TIZMRI . . . . . .  C ADDR   0D0BH   R   SEG=MAIN   2204# 2350
TL0. . . . . . . .  D ADDR   008AH   A      26# 475
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   1265H   R   SEG=MAIN   3019 3031#
TMOD . . . . . . .  D ADDR   0089H   A      25# 472 505
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 489
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 488
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TOME13 . . . . . .  C ADDR   184BH   R   SEG=MAIN   3868 3873#
TOME14 . . . . . .  C ADDR   1872H   R   SEG=MAIN   3873 3893#
TOME15 . . . . . .  C ADDR   188AH   R   SEG=MAIN   3893 3905#
TOME21 . . . . . .  C ADDR   1842H   R   SEG=MAIN   3858 3868#
TOSK19 . . . . . .  C ADDR   19D4H   R   SEG=MAIN   4079 4084#
TOUTF. . . . . . .  C ADDR   11E2H   R   SEG=MAIN   2956# 2959
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TTOUT. . . . . . .  C ADDR   0DE2H   R   SEG=MAIN   2352# 2361
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 4965
UNPACK1. . . . . .  C ADDR   009EH   A      7129# 7323 7457 7587 7701
UNPACK2. . . . . .  C ADDR   00BAH   A      7154# 7324 7458 7588
UP1. . . . . . . .  C ADDR   0138H   A      7274# 7291
UP2. . . . . . . .  C ADDR   014BH   A      7294# 7312
UP2A . . . . . . .  C ADDR   0161H   A      7273 7310#
UPA. . . . . . . .  C ADDR   216AH   R   SEG=MAIN   5341# 5347
UPA1 . . . . . . .  C ADDR   217AH   R   SEG=MAIN   5359# 5365
UPA2 . . . . . . .  C ADDR   215AH   R   SEG=MAIN   5322# 5328
UPAA . . . . . . .  C ADDR   2685H   R   SEG=MAIN   6066# 6072
UPAA4. . . . . . .  C ADDR   21C5H   R   SEG=MAIN   5422# 5428
UPAB . . . . . . .  C ADDR   21D5H   R   SEG=MAIN   5439# 5445
UPAK . . . . . . .  C ADDR   2164H   R   SEG=MAIN   5338#
UPAK1. . . . . . .  C ADDR   265FH   R   SEG=MAIN   6031#
UPAK2. . . . . . .  C ADDR   2154H   R   SEG=MAIN   5319#
UPAK3. . . . . . .  C ADDR   2174H   R   SEG=MAIN   3579 3671 5356#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   146

UPAK4. . . . . . .  C ADDR   267FH   R   SEG=MAIN   3534 6063#
UPAKA. . . . . . .  C ADDR   21BFH   R   SEG=MAIN   4229 5419#
UPAKB. . . . . . .  C ADDR   21CFH   R   SEG=MAIN   4257 5436#
UPAV1. . . . . . .  C ADDR   194CH   R   SEG=MAIN   4014# 4020
UPAV2. . . . . . .  C ADDR   1A03H   R   SEG=MAIN   4128# 4134
UPK1 . . . . . . .  C ADDR   2671H   R   SEG=MAIN   6039 6042#
UPK2 . . . . . . .  C ADDR   2672H   R   SEG=MAIN   6041 6043#
VICHMAX. . . . . .  C ADDR   1E5FH   R   SEG=MAIN   3841 4795#
VICHMEAN . . . . .  C ADDR   1CA3H   R   SEG=MAIN   3849 4507#
VICHMIN. . . . . .  C ADDR   1D86H   R   SEG=MAIN   3384 4645#
VICHR. . . . . . .  D ADDR   00B1H   A      389# 1225 1734 2237 2246 2380 2393 2498 2506 2850 2854 2931 2998 3110
                                           3612 3620 3629 3853 3902 3916 4032 4220 4272 4309 5574
VIG0 . . . . . . .  C ADDR   0A5BH   R   SEG=MAIN   1811# 1813
VIG4 . . . . . . .  C ADDR   0A69H   R   SEG=MAIN   1822# 1824
VIOUT. . . . . . .  C ADDR   0DB9H   R   SEG=MAIN   2243 2325# 2353
VIOUTF . . . . . .  C ADDR   11DBH   R   SEG=MAIN   2953#
VODM11_15. . . . .  C ADDR   164CH   R   SEG=MAIN   3604# 3619
VOLUME . . . . . .  D ADDR   00D5H   A      402# 2192 3547 6106 6108
VV21_23. . . . . .  C ADDR   18C5H   R   SEG=MAIN   3922 3934#
VVCHIBL. . . . . .  C ADDR   2308H   R   SEG=MAIN   2481 5628#
VVCHIF . . . . . .  C ADDR   22E3H   R   SEG=MAIN   5604# 5621
VVINTE . . . . . .  C ADDR   15ADH   R   SEG=MAIN   3498 3526#
VVIZKO . . . . . .  C ADDR   1232H   R   SEG=MAIN   2952 2998#
VVKALI52 . . . . .  C ADDR   19F6H   R   SEG=MAIN   4112# 4164
VVMENU . . . . . .  C ADDR   19ACH   R   SEG=MAIN   3997 4067#
VVNOL23. . . . . .  C ADDR   2303H   R   SEG=MAIN   5625# 5629
VVNOL31. . . . . .  C ADDR   22FEH   R   SEG=MAIN   5623# 5625
VVNOL41. . . . . .  C ADDR   22FCH   R   SEG=MAIN   5621# 5623
VVOD2_10 . . . . .  C ADDR   15E5H   R   SEG=MAIN   3119 3225 3308 3557#
VVOD43 . . . . . .  C ADDR   17A3H   R   SEG=MAIN   3775 3782#
VVODM11_15 . . . .  C ADDR   1825H   R   SEG=MAIN   3604 3853#
VVOSTA . . . . . .  C ADDR   1800H   R   SEG=MAIN   3818 3837#
VVOSTAD. . . . . .  C ADDR   1814H   R   SEG=MAIN   3837 3845#
VVRR6. . . . . . .  C ADDR   0E3EH   R   SEG=MAIN   2398#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 470 471
WORK . . . . . . .  D ADDR   00B8H   A      393# 1431 1433 1439 1455 1462 1478 1499 1504 1520 1762 1840 3205 3215
                                           3217 3237 3247 3249 3254 3264 3266 3272 3282 3284 3289 3299 3301 4515 4562
                                           4565 4574 4577 4589 4651 4669 4672 4727 4737 4743 4753 4757 4802 4820 4823
                                           4878 4888 4893 4903 4919 4941
WR1. . . . . . . .  C ADDR   264CH   R   SEG=MAIN   6014# 6021
WRITE. . . . . . .  C ADDR   2649H   R   SEG=MAIN   627 5465 5467 5469 5471 5473 5475 5478 5480 5482 5485 5487 5489
                                           6012#
WRITED_X1. . . . .  C ADDR   1FA0H   R   SEG=MAIN   5006#
WRITE_X1 . . . . .  C ADDR   1F9FH   R   SEG=MAIN   5005#
WRPAGE . . . . . .  C ADDR   0480H   A      3980 4397 4499 7976#
WW5. . . . . . . .  C ADDR   0483H   A      7977# 7985
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 466 498
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 467
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 468 497
XCIKLWR. . . . . .  C ADDR   2566H   R   SEG=MAIN   855 868 870 872 875 878 881 884 887 890 923 925 927 930 933 936
                                           939 942 945 947 950 952 954 957 960 963 966 969 972 1024 1026 1028 5814#
XTEMP. . . . . . .  N NUMB   000CH   A      6177# 6541 6542 6543 6544 6630 6632 6633 6635 6636 6638 6639 6641 6663
                                           6664 6665 6666 6684 6685 6689 6690 6693 6697 6698 6701 6705 6706 6710 6711
                                           6713 6714 6715 6717 6721 6722 6724 6725 6729 6730 6735 6736 6738 6739 6743
                                           6744 6749 6751 6752 6753
YBNUL. . . . . . .  C ADDR   1173H   R   SEG=MAIN   2888 2896#
YES. . . . . . . .  C ADDR   2886H   R   SEG=MAIN   6563 6567 6571 6575 6593# 6656
YES0KEY. . . . . .  C ADDR   0281H   R   SEG=MAIN   661 673#
YES0KEY1 . . . . .  C ADDR   028EH   R   SEG=MAIN   680# 687
YESAVP . . . . . .  C ADDR   0780H   R   SEG=MAIN   1323 1349#
YESBUF . . . . . .  C ADDR   0AB6H   R   SEG=MAIN   1864 1869#
YESIND . . . . . .  C ADDR   0A07H   R   SEG=MAIN   1733 1742 1745 1748#
YESPRD . . . . . .  C ADDR   0AB4H   R   SEG=MAIN   1863 1867#
YESTEST. . . . . .  C ADDR   203AH   R   SEG=MAIN   5091 5123#
YESTT5 . . . . . .  C ADDR   0B42H   R   SEG=MAIN   1944#
A51 MACRO ASSEMBLER  AMP30                                                                02/09/2007 11:57:49 PAGE   147

YESVICH. . . . . .  C ADDR   07AFH   R   SEG=MAIN   1337 1374#
YESVI_KM . . . . .  C ADDR   1C0CH   R   SEG=MAIN   4344 4424#
YESVI_KR . . . . .  C ADDR   1B84H   R   SEG=MAIN   4344# 4346
YST1 . . . . . . .  C ADDR   0190H   R   SEG=MAIN   514 518#
YST19. . . . . . .  C ADDR   0188H   R   SEG=MAIN   511 515#
Z01S . . . . . . .  C ADDR   20B9H   R   SEG=MAIN   5238# 5240
Z05S . . . . . . .  C ADDR   20C6H   R   SEG=MAIN   5247# 5249
Z100 . . . . . . .  C ADDR   208AH   R   SEG=MAIN   5202# 5204
Z15. . . . . . . .  C ADDR   2098H   R   SEG=MAIN   5214# 5216
Z1S. . . . . . . .  C ADDR   20ACH   R   SEG=MAIN   5230# 5232
ZAPADC . . . . . .  C ADDR   1F6FH   R   SEG=MAIN   4974#
ZCMP . . . . . . .  C ADDR   25E8H   R   SEG=MAIN   5921#
ZDIV . . . . . . .  C ADDR   25B5H   R   SEG=MAIN   773 1083 1581 3710 5884#
ZER1 . . . . . . .  C ADDR   00B3H   A      7139 7143# 7198 7241
ZER2 . . . . . . .  C ADDR   00D4H   A      7165 7169#
ZMUL . . . . . . .  C ADDR   25ABH   R   SEG=MAIN   5879#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      321# 1656 3735 4616 4787 5892 5895 5898
ZNPLUS . . . . . .  C ADDR   0298H   R   SEG=MAIN   638 689#
ZZ . . . . . . . .  C ADDR   209AH   R   SEG=MAIN   5215# 5215
Z_01S. . . . . . .  C ADDR   20B5H   R   SEG=MAIN   2144 2145 2774 4939 4953 5236# 5750
Z_05S. . . . . . .  C ADDR   20C2H   R   SEG=MAIN   1938 1939 2601 5245#
Z_100. . . . . . .  C ADDR   2088H   R   SEG=MAIN   5201#
Z_15 . . . . . . .  C ADDR   2096H   R   SEG=MAIN   606 5213#
Z_1MS. . . . . . .  C ADDR   209FH   R   SEG=MAIN   680 4946 5220#
Z_1S . . . . . . .  C ADDR   20A8H   R   SEG=MAIN   595 603 2242 3385 3654 3764 3816 3842 4072 4156 4421 4422 5228#
Z_5. . . . . . . .  C ADDR   2091H   R   SEG=MAIN   5010 5020 5208#
Z_9. . . . . . . .  C ADDR   2644H   R   SEG=MAIN   4967 6006#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
