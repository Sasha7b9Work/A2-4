A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp31_2.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp31_2.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236              
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                          jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti   
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti 
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;53h..5dh 10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
  0039               310     nuerr                           DATA    39h;номер ошибки (для интерфейса)       
  0038               311     nblok                           DATA    38h;номер введенного блока
  0037               312     nelem                           DATA    37h;номер лемента в блоке 0..200
  0036               313     saus                            DATA    36h;сохр упр слово
  0034               314     sadiap                  DATA    34H;сохр диапазон на кот проходила запись блока1
  0033               315     chind2                          DATA    33h;счетчик индикации
  0032               316     sadiap2                 DATA    32h;сохр диапазон на кот проходила запись блока2
  0031               317     sadiap3                 DATA    31h;сохр диапазон на кот проходила запись блока3
  0030               318     sadiap4                 DATA    30h;сохр диапазон на кот проходила запись блока4
                     319     ;DATA           2fh
                     320     ;;;;;
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     6

  0020               321      cellbit                DATA    20h
  0000               322     bitznak         BIT     cellbit.0       ;20.0           
  0001               323     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               324     znmat           BIT             cellbit.2       ;20.2
  0003               325     bitrs           BIT             cellbit.3       ;20.3
  0004               326     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               327     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               328     bitvi11         BIT             cellbit.6       ;20.6   бит нажатия ввод режима вычислить R
                             !!!
  0007               329     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us 
                                  
                     330     
  0021               331     cellbit1                DATA    21h
  0008               332     bitbuf          BIT     cellbit1.0      ;21.0   
  0009               333     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               334     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               335     bitmem          BIT             cellbit1.3      ;21.3 нажата кн память
                     336     ;bmem11         BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               337     bifl_kt         BIT             cellbit1.5      ;21.5  бит для выч Км теста измерения  
                     338     ;bmem13         BIT             cellbit1.6      ;21.6            
  000F               339     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     340     
  0022               341     cellbit2                DATA    22h
  0010               342     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               343     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               344     bitklb          BIT             cellbit2.2      ;22.2  признак калибровки
  0013               345     bitv19          BIT             cellbit2.3      ;22.3           бит установки скор итерфейс
                             а 19.6
  0014               346     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               347     biteizm         BIT             cellbit2.5      ;22.5   признак теста измерения 
  0016               348     bitpar          BIT             cellbit2.6      ;22.6   бит проведенного 1раз пароля 
  0017               349     bitoll          BIT             cellbit2.7      ;22.7 бит перегрузки
                     350     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     351     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     352     ;и выдает т.н. буфер индикации  
  0023               353     cellbit3                DATA    23h
  0018               354     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               355     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               356     bitakt          BIT             cellbit3.2      ;22.2  бит такта
  001B               357     bitznB          BIT             cellbit3.3      ;22.3 БИТ ЗНАКА ПРИ ВВОДЕ константы В
                     358     ;bit            BIT             cellbit3.4      ;22.4    
                     359     ;bit            BIT             cellbit3.5      ;22.5    
                     360     ;bit            BIT             cellbit3.6      ;22.6            
                     361     ;bit            BIT             cellbit3.7      ;22.7
                     362             
  005E               363     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     364     ;hex
  0062               365     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               366     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               367     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               368     rez_A2   data 7bh; A2
                     369     
  0098               370     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               371     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               372     chdel    data  83h              ; счетчик задержки
                     373     ;float
  0084               374     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               375     rezAp    data  88h              ;4byte  A+
  008C               376     rezAm    data  8ch              ;4byte  A-
  0090               377     koefKp   data  90h              ;4byte  K+
  0094               378     koefKm   data  94h              ;4byte  K-
                     379     ;hex 
  009A               380     parT     data  9ah              ;параметр времени измерения
  009B               381     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               382     rez_A3   data  9ch              ;A3
                     383     ;FLOAT
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     7

  00A0               384     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               385     rez_Ak  data  0a4h         ;Ak
  00A8               386     parol           data  0a8h         ;храним в памяти пароль
  00AC               387     chind   data  0ach         ;счетчик индикации
                     388     ;chbuf  data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               389     diap    data  0aeh         ;номер диапазона
  00AF               390     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               391     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               392     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               393     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               394     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               395     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               396     work    data  0b8h        ;рабочая ячейка
  00BC               397     konstA  data  0bch        ;     введенная с крана константа A
                     398     ;konstB data  0c0h         ;    введенная с крана константа B
  00C0               399     saven_bl2       data    0c0h;;копия адреса последней записанной ячейки блока2
  00C2               400     saven_bl3       data  0c2h;копия адреса последней записанной ячейки блока3 
                     401                ;c4 1bait
  00C5               402     Rez_del data  0c5h      ;сумма n-значений /n
  00C9               403     rez_R           data    0c9h            ;рез вычисления R 4baita
  00CD               404     interva data  0cdh;значение интервала (запись)2baita
  00CF               405     chbuf   data  0cfh         ;счетчик периода загрузки в буфер и интерфейс
  00D3               406     saven_bl        data  0d3h;номер ячейки в блоке 2 baita
  00D5               407     volume          data    0d5h;объем блока 2 baita
  00D6               408     chblok          data    0d6h;volume;кол измерений блока
  00D7               409     copy_hl         data  0d7h;адрес ячейки блока для просмотра 
  00D9               410     saven_bl4       data  0d9h;копия адреса последней записанной ячейки блока4
                     411     ;data           0dbh e0h-граница стека
                     412     
                     413     ;внешнее ОЗУ 64K 
                     414     ;в обл внешнего озу 0..ffh читается страница рпзу и при записи в любую
                     415     ;ячейку  стирается целая страница 0..ffh рпзу
                     416     ;               XSEG AT 100h
                     417             PUBLIC    MASS0
  0100               418     MASS0  xdata 0100h;     скользящий массив измерения
  0104               419     MASS1  xdata 0104h;
  0108               420     MASS2  xdata 0108h;
  010C               421     MASS3  xdata 010ch;
  0110               422     MASS4  xdata 0110h;
  0114               423     MASS5  xdata 0114h;
  0118               424     MASS6  xdata 0118h;
  011C               425     MASS7  xdata 011ch;
  0120               426     MASS8  xdata 0120h;
  0124               427     MASS9  xdata 0124h;
  0128               428     MASS10  xdata 0128h;
  012C               429     MASS11  xdata 012ch;
  0130               430     MASS12  xdata 0130h;
  0134               431     MASS13  xdata 0134h;
  0138               432     MASS14  xdata 0138h;
  013C               433     MASS15  xdata 013ch;
  0140               434     MASS16  xdata 0140h;
  0144               435     MASS17  xdata 0144h;
  0148               436     MASS18  xdata 0148h;
  014C               437     MASS19  xdata 014ch;
  0E00               438     chbuf1  xdata 0e00h;счетчик буфера 1
                     439     ;xdata  0e04
                     440     
  0000               441                             rr0             EQU 00
  0001               442                     rr1       equ   01
  0006               443                     rr6   equ 06
  0002               444                     rr2       equ   02
  0003               445                     rr3       equ   03
  0007               446                     rr7   equ 07
                     447     
  0008               448                     r8   equ 08
  0009               449                     r9        equ   09
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     8

  000A               450                     r10       equ   10
  000B               451                     r11   equ 11
                     452     
                     453                     
                     454        
----                 455                  rseg     Main          ; Switch to this code segment.
                     456     
                     457                  using    0              ; Specify register bank for the following
                     458     
0100                 459     org 100h
                     460     ;$EJECT
                     461     
0100 7581E0          462     begin:     mov  sp, #0e0h
0103 75E900          463                                             mov             PCA0L,#00;=0x00;
0106 75D900          464                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          465                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          466                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          467                                             mov     P2MDOUT,#00;=0x00;
                     468             
0112 75A73F          469             mov     P3MDOUT,#3fh;
0115 75B5FF          470             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          471             mov     REF0CN,#03h;=0x03;
                     472             
011B 75E114          473             mov     XBR0,#14h;= 0x14;
011E 75E200          474             mov     XBR1,#00; =0x00;
0121 75E300          475             mov XBR2,#00;=0x00;
0124 75B0C0          476             mov     P3,#0c0h
0127 75FFDE          477             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          478             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          479             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          480             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          481             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          482             mov     TL0,#0f9h;=0xf9; 
0139 75E680          483             mov     EIE1,#80h;=0x80;
                     484     
013C 75D480          485             mov     DAC0CN,#80h;=0x80;
013F 75D780          486             mov     DAC1CN,#80h;=0x80;
0142 75B167          487             mov     OSCXCN,#67h;=0x67;
                     488     
                     489      
                     490     
0145 E5B1            491     gener:     mov a, oscxcn
0147 B4E7FB          492                cjne a,#11100111b,gener
                     493                            
014A 75B288          494             mov     OSCICN,#88h;=0x84;
014D 75CA00          495         mov TMR2RLL,#0;=0;
0150 75CBD1          496         mov TMR2RLH,#0d1h;=0xd1;
                     497       
0153 D28E            498                     setb  TCON.6                    ;регистр управления
0155 D28C            499                      setb tcon.4
                     500     
0157 75EF00          501             mov     RSTSRC,#0;=00   ;//источники сброса 
                     502     
                     503             
015A 75E340          504          mov        XBR2,#40h
015D 75E10E          505              mov    XBR0,#0eh;06h;16h
0160 75F803          506             mov             SPI0CN,#03
0163 759D31          507             mov             spi0ckr,#31H;;;;;;;;#04
                     508     ;установка скорости
0166 759850          509                                             mov             SCON0,#50h;01010000;скорость обмена
                              определяется таймером1
0169 758780          510                                             mov             PCON,#10000000b;удвоенная скорость 
                             передачи SMOD0=1
016C 758E10          511                                             mov             CKCON,#00010000b;TIM=1
016F 758920          512                                             mov             TMOD,#00100000b;реж2 внутр ист синх
                             р
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE     9

0172 758840          513                                             mov             TCON,#01000000b;счетчик запущен
                     514     ;;;;;
0175 75D900          515                                             mov             PCA0MD,#00              ;PCA 
0178 75DA46          516                                             mov             PCA0CPM0,#01000110b
017B 75EA00          517                                             mov             PCA0CPL0,#00
017E 75FA80          518                                             mov             PCA0CPH0,#80h
0181 75D840          519                                             mov             PCA0CN,#40h
                     520     ;;;;;;
0184 7A50            521                                             mov                     r2,#50h                    
                                  ;57.6->19.2
0186 7B2C            522                                             mov                     r3,#2ch
0188 120454          523                                             call            re4byte                 ;502ch 1 ba
                             it skor
018B E508            524                                             mov                     a,r8
018D B40007          525                                             cjne            a,#00,yst19
0190 C213            526                                             clr                     bitv19                  ;57
                             .6
0192 758DF4          527                                             mov                     TH1,#244
0195 8008            528                                             jmp               yst1
0197 900000   F      529     yst19:          mov                     dptr,#teS19_2
019A D213            530                                             setb            bitv19                  ;19,2
019C 758DDC          531                                             mov                     TH1,#220
019F                 532     yst1:
019F 75E730          533                                             mov             EIE2,#30H;00110000
                     534                                     ;       mov             EIP2,#30H
01A2 75A880          535                                             mov     IE,#80h;//10000000      ;//Снятие блокировк
                             и всех прерываний
                     536     ;ozu
01A5 E4              537                                             clr     a
01A6 7800            538                                             mov     r0,#00h 
01A8 F6              539     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
01A9 08              540                                             inc     r0
01AA B87FFB          541                                             cjne    r0,#7fh,mecle
01AD 7880            542                                             mov     r0,#80h
01AF F6              543     meff:                   mov     @r0,a 
01B0 F2              544                                             movx @r0,a
01B1 08              545                                             inc     r0
01B2 B8DFFA          546                             cjne    r0,#0dfh,meff
01B5 120000   F      547                             call    clmassix
                     548     ;обнулить внешнее озу 4кбайта
01B8 900000          549                                     mov                     dptr,#0
01BB E4              550     extcle: clr                     a
01BC F0              551                                     movx            @dptr,a
01BD A3              552                                     inc                     dptr
01BE E583            553                                     mov                     a,dph
01C0 B410F8          554                                     cjne            a,#10h,extcle
                     555     
01C3 7898            556                             mov             r0,#chinkor
01C5 7600            557                             mov             @r0,#0;1;
01C7 08              558                             inc             r0
01C8 7619            559                             mov             @r0,#19h;64h;0c8h;90h;
                     560                             ;;;;
01CA 7881            561                             mov             r0,#chavt
01CC 7601            562                             mov             @r0,#1
01CE 08              563                             inc             r0
01CF 7690            564                             mov             @r0,#90h
                     565     
01D1 78B2            566                                     mov             r0,#marker
01D3 76FF            567                                     mov             @r0,#0ffh
                     568                             ;mov            r0,#chind
                     569                             ;mov            @r0,#1
                     570                     
01D5 74FF            571                             mov             a,#0ffh
01D7 F585            572                        mov          p5,a
01D9 799A            573                             mov             r1,#parT
01DB 7702            574                             mov             @r1,#2                  ;Tizm=1s
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    10

01DD 79AE            575                             mov             r1,#diap
01DF 7705            576                             mov             @r1,#5                  ;10-7a
01E1 753405          577                             mov             sadiap,#5
01E4 79AF            578                             mov             r1,#parN
01E6 7702            579                             mov             @r1,#2
01E8 7400            580                             mov             a,#00h
01EA F585            581                             mov             p5,a
01EC D204            582                             setb    bitizm
                     583     
01EE 799B            584                             mov             r1,#chbefore
01F0 7700            585                             mov             @r1,#0
                     586                             ;;;;;;
01F2 900000   F      587                             mov             dptr,#ch_1              ;1->r2..r5 float
01F5 120000   F      588                             call    ldc_long
01F8 7890            589                             mov             r0,#koefKp         ;1(float)->koefKp
01FA 120000   F      590                             call    saver2
01FD 7894            591                             mov             r0,#koefKm              ;1(float)->koefKm
01FF 120000   F      592                             call    saver2
0202 78A0            593                             mov             r0,#koefKD
0204 120000   F      594                             call    saver2
0207 78CF            595                             mov                     r0,#chbuf
0209 120000   F      596                             call    saver2
020C 900158          597                             mov                     dptr,#158h;1 блок(2е с конца измерение) 
020F 79D3            598                             mov             r1,#saven_bl
0211 E583            599                             mov             a,dph
0213 F7              600                                               mov           @r1,a
0214 09              601                                                     inc             r1
0215 E582            602                                                     mov             a,dpl
0217 F7              603                                                     mov             @r1,a
                     604     
0218 900478          605                             mov                     dptr,#478h;2 блок(2е с конца измерение) 
021B 79C0            606                             mov             r1,#saven_bl2
021D E583            607                             mov             a,dph
021F F7              608                                               mov           @r1,a
0220 09              609                                                     inc             r1
0221 E582            610                                                     mov             a,dpl
0223 F7              611                                                     mov             @r1,a
0224 900798          612                                     mov                     dptr,#798h;3 блок(2е с конца измере
                             ние) 
0227 79C2            613                             mov             r1,#saven_bl3
0229 E583            614                             mov             a,dph
022B F7              615                                               mov           @r1,a
022C 09              616                                                     inc             r1
022D E582            617                                                     mov             a,dpl
022F F7              618                                                     mov             @r1,a
0230 900AB8          619                             mov                     dptr,#0ab8h;4 блок(2е с конца измерение)   
                                  
0233 79D9            620                             mov             r1,#saven_bl4
0235 E583            621                             mov             a,dph
0237 F7              622                                               mov           @r1,a
0238 09              623                                                     inc             r1
0239 E582            624                                                     mov             a,dpl
023B F7              625                                                     mov             @r1,a
023C 753801          626                             mov             nblok,#1                        ;номер введенного б
                             лока
023F 753701          627                             mov             nelem,#1
0242 78CD            628                             mov             r0,#interva
0244 7600            629                             mov             @r0,#0
0246 08              630                             inc             r0
0247 7601            631                             mov             @r0,#1
0249 7840            632                             mov             r0,#bufind
024B                 633     age2:
024B 76FD            634                             mov             @r0,#0fdh         ;погасить индикатор
024D 08              635                             inc             r0
024E B84CFA          636                             cjne    r0,#bufind+12,age2              
0251 120000   F      637                             call    ind
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    11

0254 120000   F      638                             call    z_1s
                     639     
                     640                                     ;зажечь все лементы индикации
0257 7840            641                             mov             r0,#bufind
0259 7669            642     ageon:          mov             @r0,#69h;0feh;?
025B 08              643                             inc             r0
025C B84CFA          644                             cjne    r0,#bufind+12,ageon             
025F 120000   F      645                             call    ind
0262 120000   F      646                             call    z_1s            ;1sec
                     647     ;;;;;;;;;;;;;;;;
                     648                     
0265 120000   F      649                             call    z_15;z_1ms
0268 434B10          650                             orl             bufind+11,#10h;бит точки после 1 знакоместа
                     651     ;;;;;;;;;;;;;;;;;;;
026B 7C60            652                             mov             r4,#60h
026D 7D00            653                             mov             r5,#00         
026F 120000   F      654                             call    iniacp;инициализация acp
0272 120000   F      655                             call    loadUS          ;us 10-7 A
                     656                             
0275 C217            657     rebyte:         clr             bitoll
0277 3095FD          658                             jnb             p1.5,$
027A 2095FD          659                             jb              p1.5,$
                     660                             ;mov            a,P6            ;p6.4=0
                     661                             ;anl            a,#0efh
                     662                             ;mov            P6,a
                     663                             ;nop
                     664                             ;nop
                     665                                     
                     666                             ;mov            a,P6                    ;p6.4=1 
                     667                             ;orl            a,#10h
                     668                             ;mov            P6,a                        
027D 7411            669                             mov             a,#11h
027F 120000   F      670                             call    write
                     671                             ;чтение acp
0282 120000   F      672                             call    read    
0285 F578            673                             mov     reacp+1,A       ;старший байт 
0287 120000   F      674                             call    read    
028A F579            675                             mov     reacp+2,A       ;средний байт 
028C 120000   F      676                             call    read
028F F57A            677                             mov     reacp+3,A               ;мл байт
                     678                        ;;;;;;;;;;;
0291 7878            679                        mov          r0,#reacp+1
0293 E6              680                        mov          a,@r0
0294 20E740          681                             jb              acc.7,znplus;
0297 D200            682                             setb    bitznak
0299 4480            683                             orl             a,#80h  ;ост содерж яч 
029B F6              684                             mov             @r0,a
                     685                                     
029C 18              686     mmm:            dec             r0;,#reacp
029D 76FF            687                             mov             @r0,#0ffh
029F 803E            688                             jmp             goznak
                     689     
02A1 120000   F      690     mem10ms:        call            ind
02A4 80CF            691                                             jmp                     rebyte                     
                                  ;10ms
                     692     
02A6                 693     labelA: 
                     694                             ;разрешить ie6,ie7
02A6 E53E            695                             mov                     a,chkl+1                ;low
02A8 7009            696                             jnz                     no0key
02AA E53D            697                             mov                     a,chkl
02AC 7005            698                             jnz                     no0key
02AE 75E730          699                             mov                     EIE2,#30h ;EIE2.5,EIE2.4
02B1 800D            700                             jmp                     yes0key
                     701                        
02B3                 702     no0key: ;       mov             r1,#chkl 
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    12

                     703                                     ;       call    chdec
02B3 C3              704                                     clr                     c
02B4 E53E            705                                     mov                     a,chkl+1;chkl-1
02B6 9401            706                                     subb            a,#1
02B8 F53E            707                                     mov                     chkl+1,a
02BA E53D            708                                     mov                     a,chkl
02BC 9400            709                                     subb            a,#0
02BE F53D            710                                     mov                     chkl,a
                     711                             ;;;;;;;;;;;;
02C0                 712     yes0key:
02C0 2004B2          713                                             jb              bitizm,rebyte
                     714                              ;буфер 2 выдать на индикацию
02C3 E533            715                             mov             a,chind2                        ;реже выдавать на и
                             ндикацию
02C5 700B            716                             jnz             nochind
02C7 753364          717                             mov             chind2,#100
02CA 120000   F      718                             call    ind
02CD 120000   F      719     yes0key1:       call    z_1ms;z_01s
                     720                             ;call   z_01s
                     721                             ;call   z_01s
02D0 80D4            722                             jmp             labelA
                     723     
02D2 14              724     nochind:        dec             a
02D3 F533            725                                             mov             chind2,a
02D5 80F6            726                                     jmp             yes0key1;labelA
                     727             
02D7 C200            728     znplus:         clr     bitznak
02D9 547F            729                             anl             a,#7fh;fdh                      ;+
02DB F6              730                             mov             @r0,a
02DC 18              731                             dec             r0;,#reacp
02DD 7600            732                             mov             @r0,#00h
                     733                             
02DF                 734     goznak: 
                     735     ;;;;;;;;;;;;;
02DF 787A            736                             mov     r0,#reacp+3
02E1 E6              737                             mov             a,@r0
02E2 7F05            738                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
02E4 C3              739     sdvig3:         clr             c
02E5 13              740                             rrc             a
02E6 DFFC            741                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
02E8 FA              742                             mov             r2,a    ;сохр байт
02E9 18              743                             dec             r0              ;       reacp+2
02EA E6              744                             mov             a,@r0
02EB C0E0            745                             push    acc
02ED C3              746                             clr             c
02EE 7F03            747                             mov             r7,#3;2
02F0 C3              748     sdvig2:         clr             c
02F1 33              749                             rlc             a
02F2 DFFC            750                             djnz    r7,sdvig2 ;d12..d11      средний байт
02F4 4A              751                             orl             a,r2
02F5 F57A            752                             mov             reacp+3,a;сформ мл байт
02F7 D0E0            753                             pop             acc
                     754                             
02F9 7F05            755                             mov             r7,#5;6
02FB C3              756     sdvig1:         clr             c
02FC 13              757                             rrc             a
02FD DFFC            758                             djnz    r7,sdvig1 ;d15,d14        ср байт
02FF FA              759                             mov             r2,a   ;сохр
0300 E578            760                             mov             a,reacp+1
0302 C0E0            761                             push    acc
                     762                     ;;      push    acc
0304 7F03            763                             mov             r7,#3;2
0306 C3              764     sdvig0:         clr             c
0307 33              765                             rlc             a
0308 DFFC            766                             djnz    r7,sdvig0 ;       d21..d16
030A 4A              767                             orl             a,r2
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    13

030B F579            768                             mov             reacp+2,a       ; сформ средний  байт
030D D0E0            769                             pop             acc       ;reacp+1
                     770                             ;;;;;;;;;;;;;;
030F 20E70B          771                             jb              acc.7,sdvm
0312 C3              772                             clr             c
0313 7F05            773                             mov             r7,#5;6
0315 C3              774     sdvig4:         clr             c
0316 13              775                             rrc             a
0317 DFFC            776                             djnz    r7,sdvig4 ;       d23,d22
0319 F578            777                             mov             reacp+1,a
031B 8008            778                             jmp             readyacp;ankor;klmas
                     779     ;;;;;;;;;;;;                                    
031D 7F05            780     sdvm:           mov             r7,#5;6
031F D3              781     sdvig6:         setb            c
0320 13              782                             rrc             a
0321 DFFC            783                             djnz    r7,sdvig6 ;       d23,d22
0323 F578            784                             mov             reacp+1,a
                     785                                                             
                     786     ; reacp..reacp+3-результат чтения асп(hex) 
                     787     ;;;;;;;;;
0325                 788     readyacp:
0325 7898            789                                             mov             r0,#chinkor
0327 E6              790                             mov             a,@r0
0328 30E702          791                             jnb             acc.7,gopart
032B 8044            792                                     jmp             sumt2
                     793                     
032D                 794     gopart:
032D 789A            795                             mov             r0,#parT        ;параметр времени
032F 793F            796                             mov             r1,#chmasN
0331 B6013A          797                             cjne    @r0,#1,noparT1
                     798                             ;РЕЗ+РЕЗ
0334 7877            799                             mov             r0,#reacp
0336 120000   F      800                             call    resar2          ;reacp->r2..r5
0339 78B6            801                             mov             r0,#summa+3;rez_A+3
033B 120000   F      802                             call    ladd
033E 78B3            803                             mov             r0,#summa;rez_A
0340 120000   F      804                             call    saver2
0343 793F            805                              mov            r1,#chmasN
0345 7714            806                             mov             @r1,#20;10
0347 789B            807                             mov             r0,#chbefore
0349 B6631E          808                             cjne    @r0,#99,nobef99
                     809                             ;РЕЗ/100
034C 900000   F      810                             MOV        DPTR,#ch100 
034F 120000   F      811     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
0352 120000   F      812                             call    zdiv;divide
0355 7862            813                             mov             r0,#rez_A
0357 120000   F      814                             call    saver2          ;сумма 100 отсчетов /100
035A 78C5            815                             mov             r0,#Rez_del
035C 120000   F      816                             call    saver2  
                     817                        ;;;;;
035F 78B3            818                        mov          r0,#summa
0361 120000   F      819                        call         clear4
                     820     
0364 799B            821                             mov             r1,#chbefore
0366 7700            822                             mov             @r1,#0
0368 8070            823                             jmp             klmas           ;загр в массив скользящее ср
036A 06              824     nobef99:        inc             @r0                     ;chbefore
036B 020000   F      825                             jmp             rebyte;labelA;метка A
                     826     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     827     ;а потом уже располагаем  в скользящий массив  из n
                     828     
                     829     
                     830     
036E B6021D          831     noparT1:        cjne    @r0,#2,noparT2
                     832                             ;РЕЗ+РЕЗ
0371                 833     sumt2:
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    14

0371 7877            834                              mov            r0,#reacp
0373 120000   F      835                             call    resar2          ;reacp->r2..r5
0376 78B6            836                             mov             r0,#summa+3;rez_A+3
0378 120000   F      837                             call    ladd
037B 78B3            838                             mov             r0,#summa;rez_A
037D 120000   F      839                             call    saver2
0380 789B            840                             mov             r0,#chbefore
0382 793F            841                             mov             r1,#chmasN
0384 770A            842                             mov             @r1,#10
0386 B613E1          843                             cjne    @r0,#19,nobef99;9,nobef99
                     844                             ;РЕЗ/20
0389 900000   F      845                             MOV        DPTR,#ch20;ch10 
038C 80C1            846                             jmp             allsum
                     847                             ;;;;;;;
                     848                             
                     849     
038E B6031D          850     noparT2:        cjne    @r0,#3,noparT3
                     851     
0391 7877            852                                                              mov            r0,#reacp
0393 120000   F      853                             call    resar2          ;reacp->r2..r5
0396 78B6            854                             mov             r0,#summa+3;rez_A+3
0398 120000   F      855                             call    ladd
039B 78B3            856                             mov             r0,#summa;rez_A
039D 120000   F      857                             call    saver2
03A0 789B            858                             mov             r0,#chbefore
03A2 793F            859                             mov             r1,#chmasN
03A4 7704            860                             mov             @r1,#4                                  ;n=4
03A6 B609C1          861                             cjne    @r0,#9,nobef99;9,nobef99
                     862                             ;РЕЗ/10
03A9 900000   F      863                             MOV        DPTR,#ch10 
03AC 80A1            864                             jmp             allsum
                     865                             
03AE B6041D          866     noparT3:        cjne    @r0,#4,noparT4
03B1                 867     aapar:          
03B1 7877            868              mov            r0,#reacp
03B3 120000   F      869                             call    resar2          ;reacp->r2..r5
03B6 78B6            870                             mov             r0,#summa+3;rez_A+3
03B8 120000   F      871                             call    ladd
03BB 78B3            872                             mov             r0,#summa;rez_A
03BD 120000   F      873                             call    saver2
03C0 789B            874                             mov             r0,#chbefore
03C2 793F            875                             mov             r1,#chmasN
03C4 7704            876                             mov             @r1,#4
03C6 B604A1          877                             cjne    @r0,#4,nobef99;9,nobef99
                     878                             ;РЕЗ/10
03C9 900000   F      879                             MOV        DPTR,#ch5
03CC 8081            880                             jmp             allsum
                     881     
                     882                     
03CE 7702            883     noparT4:   mov          @r1,#2          ;chmasN n=2
03D0 7877            884                             mov             r0,#reacp
03D2 120000   F      885                             call    resar2          ;reacp->r2..r5
03D5 7862            886                             mov             r0,#rez_A
03D7 120000   F      887                             call    saver2
                     888     ;загрузить А в массив из 2/10 значений
                     889     ;;;;;;;;;;;;;;;
03DA                 890     klmas:           
03DA 793F            891                             mov             r1,#chmasN
03DC B7021A          892                             cjne    @r1,#2,mas10
03DF 900100          893                             MOV        dptr,#MASS0
03E2 120000   F      894                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     895     
03E5 7862            896                             mov             r0,#rez_A
03E7 120000   F      897                             call    resar2          ;->r2..r5
03EA 900100          898                             mov                     dptr,#MASS0
03ED 120000   F      899                   call              saveIr2                 ; R2-R5 --> MAS0
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    15

                     900                     
03F0 900107          901                   MOV          dptr,#MASS1+3
03F3 120000   F      902                   CALL       addx
03F6 020000   F      903                       jmp           endsum
                     904     ;массив из 10-ти измерений
03F9 B70A7D          905     mas10:                  cjne    @r1,#10,mas20
03FC 900120          906                                             mov                     dptr,#MASS8
03FF 120000   F      907                     CALL            xCIKLWR         ;MASS8->MASS9
0402 90011C          908                                             mov                     dptr,#MASS7
0405 120000   F      909                     CALL            xCIKLWR         ;MASS7->MASS8
0408 900118          910                     MOV       dptr,#MASS6
040B 120000   F      911                     CALL       xCIKLWR         ; MASS6 --> MASS7
040E 900114          912                     MOV        dptr,#MASS5
                     913                    
0411 120000   F      914                    CALL        xCIKLWR        ; MASS5 --> MASS6
0414 900110          915                    MOV         dptr,#MASS4
                     916                    
0417 120000   F      917                    CALL        xCIKLWR        ; MASS4 --> MASS5
041A 90010C          918                             mov                     dptr,#MASS3
                     919     
041D 120000   F      920                    CALL             xCIKLWR         ;MASS3->MASS4
0420 900108          921                     MOV        dptr,#MASS2
                     922                    
0423 120000   F      923                    CALL        xCIKLWR         ; MASS2 --> MASS3
0426 900104          924                    MOV         dptr,#MASS1
                     925                     
0429 120000   F      926                   CALL         xCIKLWR        ; MASS1 --> MASS2
042C 900100          927                    MOV         dptr,#MASS0
                     928                   
042F 120000   F      929                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     930     
                     931                             
0432 7862            932                             mov             r0,#rez_A
0434 120000   F      933                             call    resar2          ;->r2..r5
                     934                                     ;call   aform
0437 900100          935                                     mov                     dptr,#MASS0
043A 120000   F      936                   call              saveIr2                 ; R2-R5 --> MAS0
                     937              
043D 900107          938                   MOV          dptr,#MASS1+3
0440 120000   F      939                   CALL       addx
0443 90010B          940                   MOV          dptr,#MASS2+3
0446 120000   F      941                   CALL       addx
0449 90010F          942                   MOV          dptr,#MASS3+3
044C 120000   F      943                  CALL        addx
044F 900113          944                   MOV       dptr,#MASS4+3
0452 120000   F      945                   call       addx
0455 900117          946                     MOV        dptr,#MASS5+3
0458 120000   F      947                  CALL        addx
045B 90011B          948                   MOV          dptr,#MASS6+3
045E 120000   F      949                   CALL       addx
0461 90011F          950                   MOV          dptr,#MASS7+3
0464 120000   F      951                  CALL        addx
0467 900123          952                  MOV        dptr,#MASS8+3
046A 120000   F      953                   call       addx
046D 900127          954                     MOV                     dptr,#MASS9+3
0470 120000   F      955                  call        addx
0473 020000   F      956                              jmp            endsum
                     957     
0476 020000   F      958     rmas4:          jmp                     mas4
                     959     ;массив из 20-ти измерений
0479 B714FA          960     mas20:          cjne    @r1,#20,rmas4
047C 900148          961                                             mov                     dptr,#MASS18
047F 120000   F      962                     CALL            xCIKLWR         ;MASS18->MASS19
0482 900144          963                                             mov                     dptr,#MASS17
0485 120000   F      964                     CALL            xCIKLWR         ;MASS17->MASS18
0488 900140          965                     MOV       dptr,#MASS16
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    16

048B 120000   F      966                     CALL       xCIKLWR         ; MASS16 --> MASS17
048E 90013C          967                     MOV        dptr,#MASS15
                     968                    
0491 120000   F      969                    CALL        xCIKLWR        ; MASS15 --> MASS16
0494 900138          970                    MOV         dptr,#MASS14
                     971                    
0497 120000   F      972                    CALL        xCIKLWR        ; MASS14 --> MASS15
049A 900134          973                             mov                     dptr,#MASS13
                     974     
049D 120000   F      975                    CALL             xCIKLWR         ;MASS13->MASS14
04A0 900130          976                     MOV        dptr,#MASS12
                     977                    
04A3 120000   F      978                    CALL        xCIKLWR         ; MASS12 --> MASS13
04A6 90012C          979                    MOV         dptr,#MASS11
                     980                     
04A9 120000   F      981                   CALL         xCIKLWR        ; MASS11 --> MASS12
04AC 900128          982                    MOV         dptr,#MASS10
                     983                   
04AF 120000   F      984                    CALL        xCIKLWR        ; MASS10 --> MASS11
04B2 900124          985                                      MOV       dptr,#MASS9
04B5 120000   F      986                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     987     
04B8 900120          988                                             mov                     dptr,#MASS8
04BB 120000   F      989                     CALL            xCIKLWR         ;MASS8->MASS9
04BE 90011C          990                                             mov                     dptr,#MASS7
04C1 120000   F      991                     CALL            xCIKLWR         ;MASS7->MASS8
04C4 900118          992                     MOV       dptr,#MASS6
04C7 120000   F      993                     CALL       xCIKLWR         ; MASS6 --> MASS7
04CA 900114          994                     MOV        dptr,#MASS5
                     995                    
04CD 120000   F      996                    CALL        xCIKLWR        ; MASS5 --> MASS6
04D0 900110          997                    MOV         dptr,#MASS4
                     998                    
04D3 120000   F      999                    CALL        xCIKLWR        ; MASS4 --> MASS5
04D6 90010C         1000                             mov                     dptr,#MASS3
                    1001     
04D9 120000   F     1002                    CALL             xCIKLWR         ;MASS3->MASS4
04DC 900108         1003                     MOV        dptr,#MASS2
                    1004                    
04DF 120000   F     1005                    CALL        xCIKLWR         ; MASS2 --> MASS3
04E2 900104         1006                    MOV         dptr,#MASS1
                    1007                     
04E5 120000   F     1008                   CALL         xCIKLWR        ; MASS1 --> MASS2
04E8 900100         1009                    MOV         dptr,#MASS0
                    1010                   
04EB 120000   F     1011                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1012     
                    1013                             
04EE 7862           1014                             mov             r0,#rez_A
04F0 120000   F     1015                             call    resar2          ;->r2..r5
                    1016                                     ;call   aform
04F3 900100         1017                                     mov                     dptr,#MASS0
04F6 120000   F     1018                   call              saveIr2                 ; R2-R5 --> MAS0
                    1019              
04F9 900107         1020                   MOV          dptr,#MASS1+3
04FC 120000   F     1021                   CALL       addx
04FF 90010B         1022                   MOV          dptr,#MASS2+3
0502 120000   F     1023                   CALL       addx
0505 90010F         1024                   MOV          dptr,#MASS3+3
0508 120000   F     1025                  CALL        addx
050B 900113         1026                   MOV       dptr,#MASS4+3
050E 120000   F     1027                   call       addx
0511 900117         1028                     MOV        dptr,#MASS5+3
0514 120000   F     1029                  CALL        addx
0517 90011B         1030                   MOV          dptr,#MASS6+3
051A 120000   F     1031                   CALL       addx
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    17

051D 90011F         1032                   MOV          dptr,#MASS7+3
0520 120000   F     1033                  CALL        addx
0523 900123         1034                  MOV        dptr,#MASS8+3
0526 120000   F     1035                   call       addx
0529 900127         1036                     MOV                     dptr,#MASS9+3
052C 120000   F     1037                  call        addx
                    1038     ;27
052F 90012B         1039                                     MOV        dptr,#MASS10+3
0532 120000   F     1040                   CALL       addx
0535 90012F         1041                                     MOV        dptr,#MASS11+3
0538 120000   F     1042                   CALL       addx
053B 900133         1043                   MOV          dptr,#MASS12+3
053E 120000   F     1044                   CALL       addx
0541 900137         1045                   MOV          dptr,#MASS13+3
0544 120000   F     1046                  CALL        addx
0547 90013B         1047                   MOV       dptr,#MASS14+3
054A 120000   F     1048                   call       addx
054D 90013F         1049                                     MOV        dptr,#MASS15+3
0550 120000   F     1050                     CALL     addx
0553 900143         1051                   MOV          dptr,#MASS16+3
0556 120000   F     1052                   CALL       addx
0559 900147         1053                   MOV          dptr,#MASS17+3
055C 120000   F     1054                  CALL        addx
055F 90014B         1055                  MOV        dptr,#MASS18+3
0562 120000   F     1056                   call       addx
0565 90014F         1057                                     MOV                     dptr,#MASS19+3
0568 120000   F     1058                  call        addx
056B 802F           1059                                     jmp             endsum
                    1060     ;массив из 4х измерений
056D                1061     mas4:                   
056D 900108         1062                                             MOV        dptr,#MASS2
0570 120000   F     1063                    CALL        xCIKLWR         ; MASS2 --> MASS3
0573 900104         1064                    MOV         dptr,#MASS1
0576 120000   F     1065                    CALL        xCIKLWR        ; MASS1 --> MASS2
0579 900100         1066                    MOV         dptr,#MASS0
057C 120000   F     1067                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1068     
                    1069                             
057F 7862           1070                             mov             r0,#rez_A
0581 120000   F     1071                             call    resar2          ;->r2..r5
                    1072                                     ;call   aform
0584 900100         1073                                     mov                     dptr,#MASS0
0587 120000   F     1074                   call              saveIr2                 ; R2-R5 --> MAS0
                    1075              
058A 900107         1076                   MOV          dptr,#MASS1+3
058D 120000   F     1077                   CALL       addx
0590 90010B         1078                   MOV          dptr,#MASS2+3
0593 120000   F     1079                   CALL       addx
0596 90010F         1080                   MOV          dptr,#MASS3+3
0599 120000   F     1081                  CALL        addx
                    1082                  
                    1083             ;23.03          
059C                1084     endsum:
059C 786E           1085                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
059E 06             1086                                     inc             @r0
059F E6             1087                                     mov             a,@r0   
05A0 200105         1088                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                    1089                                     
05A3 B53F31         1090                                     cjne    a,chmasN,masx5
05A6 D201           1091                                     setb    bitmas                  ;массив заполнен
05A8 853F6E         1092     masfull:                mov             chmas,chmasN
05AB 783F           1093                                     mov             r0,#chmasN
05AD E6             1094                                     mov             a,@r0
                    1095     ;masfull:
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    18

05AE B40208         1096                                     cjne    a,#2,nochn2
05B1 900000   F     1097                                     MOV        DPTR,#ch2;10 
05B4 120000   F     1098                                     CALL   ldc_ltemp                 ; ltemp <-- 2
05B7 8028           1099                                     jmp             mas5div
                    1100     
05B9 B40A08         1101     nochn2:         cjne    a,#10,nochn10
05BC 900000   F     1102                                                     MOV        DPTR,#ch10 
05BF 120000   F     1103                                     CALL   ldc_ltemp                 ; ltemp <-- 10
05C2 801D           1104                                     jmp             mas5div
                    1105     
05C4 B41408         1106     nochn10:        cjne    a,#20,nochn20
05C7 900000   F     1107                                                     MOV        DPTR,#ch20 
05CA 120000   F     1108                                     CALL   ldc_ltemp                 ; ltemp <-- 20
05CD 8012           1109                                     jmp             mas5div
                    1110     
05CF 900000   F     1111     nochn20:        MOV        DPTR,#ch4 
05D2 120000   F     1112                                     CALL   ldc_ltemp                 ; ltemp <-- 4
05D5 800A           1113                                     jmp             mas5div
                    1114     
05D7 856E0B         1115     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
05DA E4             1116                                     clr     a
05DB F50A           1117                                     mov     ltemp+2,a
05DD F509           1118                                     mov     ltemp+1,a
05DF F508           1119                                     mov     ltemp,a
                    1120     
05E1                1121     mas5div:
05E1 120000   F     1122                                     CALL       zdiv;divide                           ; R2-R5 =
                    1123                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                    1124     
                    1125                             
                    1126      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1127     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1128     ;получен результат 3 байта и знак
05E4 7866           1129                             mov             r0,#rez_A1
05E6 120000   F     1130                             call    saver2           ;сохр среднее по массиву
                    1131     ;;8.11.06                       mov             chmasN,#0
                    1132      ;;;;;;;;;;;;
                    1133      ;;;;;;;;;;;;
05E9 C3             1134                             clr             c
05EA 799A           1135                             mov             r1,#parT
05EC 7402           1136                             mov             a,#2
05EE 97             1137                             subb    a,@r1
05EF 501D           1138                             jnc             ankor           ;T<3
                    1139                             ;A-=РЕЗ1                                ;T>3
05F1 120402         1140                             call    altof                   ;r2..r5->float
05F4 785E           1141                             mov             r0,#rez_Ame
05F6 120000   F     1142                             call    saver2
                    1143                             ;;;;
05F9 7890           1144                             mov             r0,#koefKp;->r8..r11
05FB EA             1145                             mov             a,r2
05FC 30E702         1146                             jnb             acc.7,nminus3
05FF 7894           1147                             mov             r0,#koefKm;->r8..r11
0601 120000   F     1148     nminus3:                call    resar8
0604 120203         1149                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
0607 785E           1150                             mov             r0,#rez_Ame
0609 120000   F     1151                             call    saver2
060C 8021           1152                             jmp             gotoKD
                    1153     
060E                1154     ankor:  
060E 7898           1155                             mov             r0,#chinkor
0610 E6             1156                             mov             a,@r0
0611 30E703         1157                             jnb             acc.7,nokorr
                    1158                             ;коррекция 0
0614 020000   F     1159                             jmp             kornul
0617                1160     nokorr: 
                    1161                             ;mov            r10,#00         ;       chavt
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    19

                    1162                             ;mov            r11,#00h
0617 7881           1163                             mov              r0,#chavt      
0619 E6             1164                             mov                     a,@r0;call      chcmp           ;сравн счет
                             чик авто калибровки с 0h
061A 30E737         1165                             jnb             acc.7,nonulavt;jnz              nonulavt        
061D 750A00         1166                             mov             r10,#0;1;00;02          
0620 750BC8         1167                             mov             r11,#0c8h;90h;0c8h;58h
0623 7898           1168                             mov             r0,#chinkor
0625 120000   F     1169                             call    chcmp
0628 7045           1170                             jnz             noavk
                    1171                             ;автокалибровка
062A 020000   F     1172                             jmp             autoka;noavk;
                    1173     
062D 8079           1174     rafterK:                jmp             afterK
                    1175     ;;;;;;;;;;
062F C3             1176      gotoKD:                clr             c
0630 799A           1177                             mov             r1,#parT
0632 7404           1178                             mov             a,#4
0634 97             1179                             subb    a,@r1
0635 50F6           1180                             jnc             rafterK         ;T<5
                    1181                             ;A1-=A- *KD                     ;T>5
                    1182                             ;call           findkoef                                ;r2,r3-hex
                    1183                             ;       call            rebyte2                         ;r2..r5- he
                             x
                    1184                                     
                    1185                             ;       call    altof                   ;r2..r5->float
                    1186                             ;       mov     dptr,#CHtho;100000
                    1187                             ;       call    ldc_ltemp                       ;r8..r11
                    1188                             ;       call    fldiv
                    1189                             ;       call    move28
                    1190                             
0637 785E           1191                             mov             r0,#rez_Ame;->r2..r5   ???????????/
0639 120000   F     1192                             call    resar2
                    1193                                     ;call   flmul
063C 120343         1194                             call    ftol                    ;float->int
063F 7866           1195                             mov             r0,#rez_A1
0641 120000   F     1196                             call    saver2
0644 786A           1197                             mov             r0,#rez_A0;->r8..r11 hex
0646 120000   F     1198                             call    resar8
0649 120000   F     1199                             call    lsub            ;A3=A-1-A0
064C 789C           1200                             mov             r0,#rez_A3
064E 120000   F     1201                             call    saver2
0651 020000   F     1202                             jmp             labelB  
                    1203      ;;;;;;;;;;; 9.11.06
0654 789A           1204     nonulavt:        mov            r0,#parT
0656 E6             1205                             mov             a,@r0
0657 6401           1206                             xrl             a,#01
0659 700F           1207                             jnz             avtdec1
065B 7982           1208                             mov             r1,#chavt+1     ;T=1 chavt-10
065D 120000   F     1209                             call    tenmin
0660 7999           1210     kordec10:       mov             r1,#chinkor+1
0662 120000   F     1211                             call    tenmin
0665 801E           1212                             jmp             rezmul
                    1213     
0667 020000   F     1214     rmo220:         jmp             mo220
                    1215     
066A 7981           1216     avtdec1:        mov             r1,#chavt       
066C 120000   F     1217                             call    chdec           ;chavt-1
                    1218     ;                       jmp             kordec1;rezmul
066F 789A           1219     noavk:          mov             r0,#parT
0671 E6             1220                             mov             a,@r0
0672 6401           1221                             xrl             a,#01
0674 700A           1222                             jnz             kordec1
                    1223                             ;T=1 chinkor-10
0676 7999           1224                     mov             r1,#chinkor+1
0678 120000   F     1225                             call    tenmin
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    20

067B 8008           1226                             jmp             rezmul
                    1227     
067D 020000   F     1228     rnotestizm:             jmp                     notestizm
0680 7998           1229     kordec1:        mov             r1,#chinkor
0682 120000   F     1230                             call    chdec           ; chinkor-1
                    1231                        ;9.11.06
                    1232                             ;;;;;;;;;;;;;;
                    1233                             ;;;;;;;;;;;;;
                    1234     ;(РЕЗ1-АN)*K
0685                1235     rezmul:
0685 7866           1236                             mov             r0,#rez_A1;->r2..r5
0687 120000   F     1237                             call    resar2
068A 120402         1238                             call    altof   ;r2..r5->float  6.06    
068D 7884           1239                             mov             r0,#kor0_AN;->r8..r11
068F 120000   F     1240                             call    resar8
0692 1201D1         1241                             call    flsub
0695 7890           1242                             mov             r0,#koefKp;->r8..r11
0697 EA             1243                             mov             a,r2
0698 30E702         1244                             jnb             acc.7,nminus
                    1245                             ;jnb            bitznak,nminus
                    1246                     
069B 7894           1247                             mov             r0,#koefKm;->r8..r11
069D 120000   F     1248     nminus:         call    resar8
06A0 120203         1249                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
06A3 785E           1250                             mov             r0,#rez_Ame
06A5 120000   F     1251                             call    saver2
                    1252      
06A8                1253     afterK:                 
                    1254     ;;;;;;;;;;;;;;
06A8 EA             1255                                     mov             a,r2
06A9 547F           1256                                     anl             a,#7fh
06AB FA             1257                                     mov             r2,a
06AC 900000   F     1258                                     mov     dptr,#ch_250;220;220000
06AF 120000   F     1259                                     call    ldc_ltemp                       ;r8..r11=8
06B2 1201D6         1260                                     call    flcmp
06B5 50B0           1261                                     jnc             rmo220          ;A>220000
                    1262                                     ;;;;;;;;;
06B7 3015C3         1263                                     jnb                     biteizm,rnotestizm
06BA 78B1           1264                                     mov                     r0,#vichR
06BC B62155         1265                                     cjne            @r0,#21h,note21
06BF 7A50           1266                                     mov                     r2,#50h                 ;-11a
06C1 7B18           1267                                     mov                     r3,#18h                 ;k8
06C3 12046C         1268                                     call            rebyte2                         ;r2..r5- he
                             x
06C6 120402         1269                                     call            altof                   ;r2..r5->float
06C9 C002           1270                                     push            rr2
06CB C003           1271                                     push            rr3
06CD C004           1272                                     push            rr4
06CF C005           1273                                     push            rr5
06D1 7A50           1274                                     mov                     r2,#50h                 ;k10
06D3 7B20           1275                                     mov                     r3,#20h
06D5 12046C         1276     re11_7: call            rebyte2                 ;r2..r5
06D8 120402         1277                                     call            altof                   ;r2..r5->float
06DB 120000   F     1278                                     call            move28
06DE D005           1279                                     pop                     rr5
06E0 D004           1280                                     pop                     rr4
06E2 D003           1281                                     pop                     rr3
06E4 D002           1282                                     pop                     rr2
06E6 1202B7         1283                                     call            fldiv
                    1284                             ;       mov                     dptr,#ch_10
                    1285                             ;       call            ldc_ltemp                       ;r8..r11
                    1286                             ;       call            flmul
                    1287                                     ;;;;;2.02.07
06E9 C002           1288                                     push            rr2
06EB C003           1289                                     push            rr3
06ED C004           1290                                     push            rr4
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    21

06EF C005           1291                                     push            rr5
06F1 7A50           1292                                     mov                     r2,#50h                 ;-11a
06F3 7B2C           1293                                     mov                     r3,#2ch                 ;Km
06F5 12046C         1294                                     call            rebyte2                         ;r2..r5- he
                             x
06F8 120402         1295                                     call            altof                   ;r2..r5->float
06FB 120000   F     1296                                     call            move28
06FE D005           1297                                     pop                     rr5
0700 D004           1298                                     pop                     rr4
0702 D003           1299                                     pop                     rr3
0704 D002           1300                                     pop                     rr2
0706 120203         1301                                     call            flmul                           ;*Km
0709 900000   F     1302                                     mov     dptr,#CHtho;100000
070C 120000   F     1303                                     call    ldc_ltemp                       ;r8..r11=8
070F 1202B7         1304                                     call    fldiv
                    1305                                     ;;;;;
0712 8050           1306                                     jmp                     temul   
0714 B62218         1307     note21: cjne            @r0,#22h,note22
0717 7A50           1308                                     mov                     r2,#50h                 ;-09a
0719 7B10           1309                                     mov                     r3,#10h                 ;k6
071B 12046C         1310                                     call            rebyte2                         ;r2..r5- he
                             x
071E 120402         1311                                     call            altof                   ;r2..r5->float
0721 C002           1312                                     push            rr2
0723 C003           1313                                     push            rr3
0725 C004           1314                                     push            rr4
0727 C005           1315                                     push            rr5
0729 7A50           1316                                     mov                     r2,#50h                 ;k8
072B 7B18           1317                                     mov                     r3,#18h
072D 80A6           1318                                     jmp                     re11_7
072F 7A50           1319     note22: mov                     r2,#50h                 ;-7a
0731 7B08           1320                                     mov                     r3,#08h                 ;k4
0733 12046C         1321                                     call            rebyte2                         ;r2..r5- he
                             x
0736 120402         1322                                     call            altof                   ;r2..r5->float
0739 C002           1323                                     push            rr2
073B C003           1324                                     push            rr3
073D C004           1325                                     push            rr4
073F C005           1326                                     push            rr5
0741 7A50           1327                                     mov                     r2,#50h                 ;k6
0743 7B10           1328                                     mov                     r3,#10h
0745 808E           1329                                     jmp                     re11_7  
                    1330                                     ;;;;;;;;;
0747                1331     notestizm:
0747 301208         1332                                     jnb             bitklb,komulpz
074A 900000   F     1333                                     mov     dptr,#chk;100000
074D 120000   F     1334                                     call    ldc_long                        ;r2..r5
0750 8006           1335                                     jmp             komul
0752 120000   F     1336     komulpz:call            findkoef                                ;r2,r3-hex
0755 12046C         1337                                     call            rebyte2                         ;r2..r5- he
                             x
                    1338                                     
0758 120402         1339     komul:  call    altof                   ;r2..r5->float
075B 900000   F     1340                                     mov     dptr,#CHtho;100000
075E 120000   F     1341                             call    ldc_ltemp                       ;r8..r11=8
0761 1202B7         1342                                     call    fldiv
0764 120000   F     1343     temul:                          call    move28
0767 785E           1344                                     mov             r0,#rez_Ame
0769 120000   F     1345                                     call    resar2
                    1346                     
076C 120203         1347                                     call    flmul     ;A1-=A-*KD  fl
                    1348                                     
076F 120343         1349                                     call    ftol                    ;float->int
0772 7866           1350                                     mov             r0,#rez_A1
0774 120000   F     1351                                     call    saver2
0777 120402         1352                                     call    altof                   ;r2..r5->float
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    22

077A EA             1353                                     mov             a,r2
077B 547F           1354                                     anl             a,#7fh
077D FA             1355                                     mov             r2,a
077E 900000   F     1356                                     mov     dptr,#ch_220;200;200000
0781 120000   F     1357                                     call    ldc_ltemp                       ;r8..r11=8
0784 1201D6         1358                                     call    flcmp
0787 502D           1359                                     jnc             rrmo220         ;A>200000
                    1360                             ;       jnb             knizm,noavp;goA2;               bitizm,goA2
                                  
                    1361                             ;       jb              bitavp,yesavp
0789 301808         1362                                     jnb             knizm,goA2
078C 300602         1363                                     jnb             bitvi11,qu_avp
078F 8003           1364                                     jmp             goA2
0791 20052F         1365     qu_avp:                 jb              bitavp,yesavp
0794                1366     noavp:  ;               jb              bitvi11,yesvich  ;уст после ввода A B (ввод ВЫЧИСЛИ
                             ТЬ)
0794                1367     goA2:                    ;A2=A1-
0794 7866           1368                                      mov            r0,#rez_A1
0796 120000   F     1369                                     call    resar2
0799 787B           1370                                     mov             r0,#rez_A2
079B 120000   F     1371                                     call    saver2
079E                1372     goA3A2:                  ;A3=A2-A0
079E 786A           1373                                       mov           r0,#rez_A0
07A0 120000   F     1374                                     call    resar8
07A3 120000   F     1375                                     call    lsub
07A6 789C           1376                                     mov             r0,#rez_A3
07A8 120000   F     1377                                     call    saver2
                    1378                                     ;;;;;;
07AB 200660         1379                                     jb              bitvi11,yesvich
07AE                1380     goonin:            ;jmp         goonind;indA3;8.11.06
07AE 78AC           1381                                     mov             r0,#chind
07B0 B60006         1382                                     cjne    @r0,#0,rnochi0
07B3 020000   F     1383                                     jmp             goonind;indA3
                    1384     
07B6 020000   F     1385     rrmo220:                jmp             mo220
07B9 020000   F     1386     rnochi0:                jmp             nochi0
07BC 7866           1387     gokaA2:                 mov             r0,#rez_A1                      ;(float)
07BE 120000   F     1388                                                     call    saver2                          ;то
                              необх для калибровки ,goA2 работает с тим знач
07C1 80D1           1389                                             jmp             goA2
                    1390     ;;;;;;;;;;;;;;;;
07C3 EA             1391     yesavp:                 mov             a,r2
07C4 547F           1392                                     anl             a,#7fh
07C6 FA             1393                                     mov             r2,a
07C7 900000   F     1394                                     mov     dptr,#ch_10th;10000
07CA 120000   F     1395                                     call    ldc_ltemp                       ;r8..r11=8
07CD 1201D6         1396                                     call    flcmp
07D0 50C2           1397                                     jnc             noavp           ;A>10000        
07D2 78AE           1398                                     mov             r0,#diap                ;10-11
07D4 B60902         1399                                     cjne    @r0,#9,avpgo
07D7 80BB           1400                                     jmp             noavp
07D9                1401     avpgo:                  
07D9 06             1402                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
07DA B60A01         1403                                     cjne    @r0,#0ah,clmasv
07DD 16             1404                                     dec             @r0
07DE                1405     clmasv:         ;сбросить массив
07DE 120000   F     1406                             call    loadUS
                    1407                             ;call   louizm
07E1 120000   F     1408                             call     clmassix
07E4 78B3           1409                                     mov             r0,#summa
07E6 120000   F     1410                                     call    clear4
07E9 786A           1411                                     mov             r0,#rez_A0
07EB 120000   F     1412                                     call    clear4
07EE C20F           1413                                     clr             bitnul
07F0 D207           1414                                     setb            bitzus;bitbuf;;;;;;;;;;;;                  
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    23

                                                                                   
07F2 80BA           1415                                jmp     goonin
                    1416     
07F4 D00B           1417     erra01:         pop                     r11
07F6 D00A           1418                                     pop                     r10
07F8 D009           1419                                     pop                     r9
07FA D008           1420                                     pop                     r8
07FC C214           1421                                     clr             bitvich
07FE C206           1422                                     clr             bitvi11
0800 753934         1423                                             mov                     nuerr,#34h;константа не дол
                             жна быть равна0
0803 120000   F     1424                                             call            error
0806 120000   F     1425                                             call            ind
0809 120000   F     1426                                             call            z_1s
080C 80A0           1427                                             jmp             goonin
                    1428     
                    1429     
080E                1430     yesvich:        
                    1431                     ;                       mov             r0,#konstB
                    1432                     ;               call    resar2
                    1433                     ;               call    move28
080E 789C           1434                                     mov             r0,#rez_A3;A1
0810 120000   F     1435                                     call    resar2                          ;HEX
                    1436                                     
0813 120402         1437                                     call            altof                   ;r2..r5->float
0816 EA             1438                                     mov             a,r2                    ;модуль
0817 547F           1439                                     anl             a,#7fh
0819 FA             1440                                     mov             r2,a
                    1441                     ;               call            fladd                           ;A1+B
                    1442                                     
081A 900000   F     1443                                     mov     dptr,#CH_500;
081D 120000   F     1444                                     call    ldc_ltemp                       ;r8..r11
0820 1201D6         1445                                     call    flcmp
0823 407E           1446                                     jc                      mo500R;error <500 >22000
0825 900000   F     1447                                     mov     dptr,#CH_22T;
0828 120000   F     1448                                     call    ldc_ltemp                       ;r8..r11
082B 1201D6         1449                                     call    flcmp
082E 507F           1450                                     jnc             mo500I          ;error
                    1451                                     ;;;;;;;;;;;;
0830 120000   F     1452                                     call            move28
0833 C008           1453                                     push            r8
0835 C009           1454                                     push            r9
0837 C00A           1455                                     push            r10
0839 C00B           1456                                     push            r11
083B 78BC           1457                                     mov             r0,#konstA
083D 120000   F     1458                                     call    resar2
0840 900000   F     1459                                     mov                     dptr,#ch0
0843 120000   F     1460                                     call            ldc_ltemp
0846 1201D6         1461                                     call            flcmp
0849 60A9           1462                                     jz              erra01
084B 900000   F     1463                                     mov             dptr,#CH_B
084E 120000   F     1464                                     CALL   ldc_ltemp                 ; ltemp <-- 10-7
0851 120203         1465                                     call            flmul                           ;A*10-7
0854 D00B           1466                                     pop                     r11
0856 D00A           1467                                     pop                     r10
0858 D009           1468                                     pop                     r9
085A D008           1469                                     pop                     r8
085C 1202B7         1470                                     call            fldiv                   ;результат R
085F 78C9           1471                                     mov                     r0,#rez_R
0861 120000   F     1472                                     call            saver2
0864 120343         1473                                     call            ftol                    ;float->hex
                    1474                                     ;;;;;;;;;;
0867 784F           1475                                             mov             r0,#abin
0869 120000   F     1476                                             call    saver2
                    1477     ;;;;;;;;
086C 7840           1478                                                     mov             r0,#bufind
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    24

086E                1479     age9:
086E 7620           1480                             mov             @r0,#" "          ;погасить индикатор
0870 08             1481                             inc             r0
0871 B84BFA         1482                             cjne    r0,#bufind+11,age9
                    1483                                             
0874 78C9           1484                                             mov             r0,#rez_R
0876 120000   F     1485                                             call            resar2
                    1486     ;;;;;;;;;;
0879 900000   F     1487                                     mov             dptr,#CH_fl
087C 120000   F     1488                                     CALL   ldc_ltemp
087F 1202B7         1489                                     call            fldiv
                    1490     
0882 78B8           1491                                     mov             r0,#work                ;степень +
0884 7600           1492                                     mov             @r0,#0
0886 78B9           1493                                     mov             r0,#work+1;степень -
0888 7600           1494                                     mov             @r0,#0
088A 900000   F     1495     compa1: mov     dptr,#ch_1;
088D 120000   F     1496                                     call    ldc_ltemp                       ;r8..r11
0890 1201D6         1497                                     call    flcmp
0893 4026           1498                                     jc              equ0            ;<1
0895 78B8           1499                                     mov             r0,#work                        ;степень +
0897 06             1500                                     inc             @r0
0898 900000   F     1501                                     mov             dptr,#ch_10;
089B 120000   F     1502                                     call    ldc_ltemp                       ;r8..r11
089E 1202B7         1503                                     call            fldiv
08A1 80E7           1504                                     jmp             compa1                          ;work значе
                             ние степени n(hex)  
                    1505                                     ;;;;;;;;;;;;;;;;;;;
08A3 900000   F     1506     mo500R: mov             dptr,#teOLR
08A6 120000   F     1507                               call          lotext           
08A9 120000   F     1508                                     call            ind
08AC 020000   F     1509                                     jmp                     nobavp;nobitizm
08AF 900000   F     1510     mo500I: mov             dptr,#teOLI
08B2 120000   F     1511                               call          lotext           
08B5 120000   F     1512                                     call            ind
08B8 020000   F     1513                                     jmp                     nobavp;nobitizm
08BB                1514     equ0:           ;;;;;   call            ftol                    ;float->int
08BB 78B8           1515                                     mov             r0,#work                ;степень +
08BD B60019         1516                                     cjne    @r0,#0,equ00
                    1517                                     
08C0 900000   F     1518     compa2: mov     dptr,#ch_1;
08C3 120000   F     1519                                     call    ldc_ltemp                       ;r8..r11
08C6 1201D6         1520                                     call    flcmp
08C9 500E           1521                                     jnc             equ00           ;>1
08CB 78B9           1522                                     mov             r0,#work+1                      ;степень -
08CD 16             1523                                     dec             @r0                                        
                                          ;0,ff(-1),fe(-2)...
08CE 900000   F     1524                                     mov             dptr,#ch_10;
08D1 120000   F     1525                                     call    ldc_ltemp                       ;r8..r11
08D4 120203         1526                                     call            flmul
08D7 80E7           1527                                     jmp             compa2                          ;work значе
                             ние степени n(hex)  
                    1528     
                    1529     
08D9                1530     equ00:          
08D9 7853           1531                                                     mov             r0,#adec
08DB 7952           1532                                             mov             r1,#abin+3      ;hex->10
08DD 120000   F     1533                                             call    bindec
                    1534     
                    1535                                                     ;если степень полож убирать младший байт
                    1536                                                     ;чтобы уложиться в 5 разрядов, если отриц р
                             асполагать
                    1537                                                     ;число в bufind..bufind+5
08E0 78B8           1538                                             mov             r0,#work
08E2 B60021         1539                                             cjne    @r0,#0,outr
08E5 08             1540                                             inc             r0                      ;work+1
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    25

08E6 B6FF05         1541                                             cjne            @r0,#0ffh,bufr3         ;6разрядов 
                             нужно вывести 5
08E9 06             1542                                             inc                     @r0;!!!!!!!!!?
08EA 785B           1543                                             mov                     r0,#adec+8;разместить в буф
                             ер индикации R
08EC 8003           1544                                             jmp                     bufr30
                    1545                                             ;;;;;;;;;;;;;;
08EE 06             1546     bufr3:          inc             @r0                     ;?!!!!!!!!n+1
08EF 785C           1547                                                     mov             r0,#adec+9
08F1 7945           1548     bufr30:         mov             r1,#bufind+5;6
08F3 7F05           1549                                             mov             r7,#5;7
08F5 E6             1550     bufr2:                          mov             a,@r0
08F6 2430           1551                                             add             a,#30h
08F8 F7             1552                                             mov             @r1,a
08F9 19             1553                                             dec             r1
08FA 18             1554                                             dec             r0
08FB DFF8           1555                                             djnz    r7,bufr2
                    1556     
08FD 784F           1557                                             mov             r0,#abin
08FF 120000   F     1558                                             call            clear4
0902 78B9           1559                                             mov             r0,#work+1
0904 801C           1560                                     jmp             outr5
                    1561     ;work!=0 значит после дел на 10**9 получили число > с чем 6 разрядов                       
                                          
0906 785C           1562     outr:                   mov             r0,#adec+9;разместить в буфер индикации R
0908 C3             1563                                             clr             c
0909 79B8           1564                                             mov             r1,#work
090B E8             1565                                             mov             a,r0
090C 14             1566                                             dec             a                                  
                                  ;n-1
090D 97             1567                                             subb    a,@r1
090E F8             1568                                             mov             r0,a                    ;adec+9-n !
                             !!!!!!!!!!!!!!
090F 7945           1569                                     mov             r1,#bufind+5;т к число разрядов > чем знако
                             мест
0911 7F05           1570                                             mov             r7,#5;7
0913 E6             1571     bufr:                           mov             a,@r0
0914 2430           1572                                             add             a,#30h
0916 F7             1573                                             mov             @r1,a
0917 19             1574                                             dec             r1
0918 18             1575                                             dec             r0
0919 DFF8           1576                                             djnz    r7,bufr
                    1577     
091B 784F           1578                                             mov             r0,#abin
091D 120000   F     1579                                             call            clear4
0920 78B8           1580                                     mov             r0,#work
0922 E6             1581     outr5:                  mov             a,@r0
0923 F552           1582                                             mov             abin+3,a
                    1583                                                                     ;n(hex)->abin
0925 120000   F     1584                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
0928 2552           1585                                             add             a,abin+3
092A F552           1586                                             mov             abin+3,a
092C 7853           1587                                             mov             r0,#adec
092E 7952           1588                                             mov             r1,#abin+3      ;hex->10
0930 120000   F     1589                                             call    bindec
0933 855C48         1590                                             mov             bufind+8,adec+9
0936 855B47         1591                                             mov             bufind+7,adec+8
0939 754966         1592                                             mov             bufind+9,#66h
093C 020000   F     1593                                             jmp             nobavp;nobitizm;        goonin;call
                                  ind
                    1594                                             
                    1595                                     ;;;;;;;;;;;;;;;;;;;;;
                    1596     ;;;;;;;;;;;;;
                    1597     
093F 300508         1598     mo220:             jnb          bitavp,indoll
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    26

0942 301805         1599                                jnb          knizm,indoll;bitizm,indoll
0945 78AE           1600                                     mov             r0,#diap
0947 B6000E         1601                                     cjne    @r0,#0,nodi2
                    1602                                ;10-2
094A 300408         1603     indoll:         jnb             bitizm,goonin1;чтобы не OLL было при нажатии кнопок меню,па
                             м,вычR
094D 900000   F     1604                                             mov             dptr,#teOLL;OLL
0950 120000   F     1605                                             call    lotext
0953 D217           1606                                             setb    bitoll
0955 020000   F     1607     goonin1:                jmp             goonin  
                    1608     
0958 16             1609     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1610     
0959 B6FF01         1611                                     cjne    @r0,#0ffh,nodi9
095C 06             1612                                     inc             @r0
                    1613     
095D 120000   F     1614     nodi9:          call    loadUS
                    1615                                     ;call   louizm
                    1616                                     ;сбросить массив
0960 120000   F     1617                                     call     clmassix
0963 78B3           1618                                     mov             r0,#summa
0965 120000   F     1619                                     call    clear4
0968 786A           1620                                     mov             r0,#rez_A0
096A 120000   F     1621                                     call    clear4
096D C20F           1622                                     clr             bitnul  
096F D207           1623                                     setb    bitzus;bitbuf   ;флаг задержки  после установки us 
                                                                           
0971 020000   F     1624                                jmp     goonin
                    1625     
0974 16             1626     nochi0:                 dec             @r0                     ;СТИ-1
0975 020000   F     1627                                     jmp             labelB  
                    1628     
                    1629             
                    1630     ;;;;;;;;;;;;;;;
                    1631     
0978                1632     nop3_0: ;;      ;rez_A-rez_A0
                    1633                     ;;                      mov             r0,#rez_A0
                    1634                     ;;                      call    resar8
                    1635                     ;;                      call    lsub
                    1636                     ;;                      mov             r0,#rez_A
                    1637                     ;;;                     call    saver2
                    1638      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0978 789C           1639      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
097A 120000   F     1640                                             call    resar2
097D 900000   F     1641                                             mov             dptr,#ch100              
0980 120000   F     1642                                             call    ldc_ltemp        
0983 120000   F     1643                                             call    zdiv            ;rez_A3/100=r2..r5
                    1644                                     
0986 EC             1645                                             mov             a,r4
0987 20E71F         1646                                             jb              acc.7,aless0
098A 4408           1647                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
098C F5D3           1648                                             mov             DAC0H,a
                    1649                                                                             ;мл байт
098E ED             1650                                             mov             a,r5
098F F5D2           1651                                             mov             DAC0L,a
0991 801F           1652                                             jmp             moveA3;
                    1653     
0993 B70207         1654     no3parN:                        cjne    @r1,#2,no2parN
                    1655                                             ;в байт 0  записать пробел
0996 7946           1656                                             mov             r1,#bufind+6
0998 7720           1657                                             mov             @r1,#" ";0fdh;
099A 020000   F     1658                                             jmp             seeind;moveA3
                    1659     
099D                1660     no2parN:                        ;в байты 0 и 1 записать пробел
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    27

099D 7945           1661                                             mov             r1,#bufind+5
099F 7720           1662                                             mov             @r1,#" ";0fdh;" "
09A1 09             1663                                             inc             r1
09A2 7720           1664                                             mov             @r1,#" ";0fdh;" "
09A4 020000   F     1665                                             jmp             seeind;moveA3
09A7 807E           1666      rseeind:               jmp             seeind
09A9 F4             1667     aless0:                         cpl             a
09AA 54F7           1668                                             anl             a,#0f7h         ;d11=0
09AC F5D3           1669                                             mov             DAC0H,a
                    1670                                                                             ;мл байт
09AE ED             1671                                             mov             a,r5
09AF F4             1672                                             cpl             a
09B0 F5D2           1673                                             mov             DAC0L,a
09B2                1674     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1675                                     
                    1676                                             
09B2                1677     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1678                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1679                     ;до конца цикла измерения результат не размещать в буфере
                    1680                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1681                     ;и возврату в режим измерения
09B2 20145C         1682                                             jb              bitvich,rnorvich
09B5 201059         1683                                             jb              bitt2,rnorvich
09B8 2017EC         1684                                             jb              bitoll,rseeind
                    1685                                             
09BB 2011E9         1686                                             jb              bitmenu,rseeind
09BE 200BE6         1687                                             jb              bitmem,rseeind
                    1688     ;;;;;;;;;;;;;;
                    1689                                             ; mov           r0,#rez_A3
                    1690                                             ;call   resar2
                    1691                                             ;call   ftol                    ;float->int r2..r5
                    1692     ;;;;;;;;
09C1 789C           1693                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
09C3 120000   F     1694                                             call    resar2;????????????????17.01.07
                    1695                                     
09C6 120000   F     1696                                             call    maform
09C9 784F           1697                                             mov             r0,#abin
09CB 120000   F     1698                                             call    saver2
                    1699     ;;;;;;;;
                    1700                                             
09CE 7853           1701                                             mov             r0,#adec
09D0 7952           1702                                             mov             r1,#abin+3      ;hex->10
09D2 120000   F     1703                                             call    bindec
                    1704                                     
09D5 785C           1705                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
09D7 7946           1706                                             mov             r1,#bufind+6
09D9 7F07           1707                                             mov             r7,#7
09DB E6             1708     bufdec:                         mov             a,@r0
09DC 2430           1709                                             add             a,#30h
09DE F7             1710                                             mov             @r1,a
09DF 19             1711                                             dec             r1
09E0 18             1712                                             dec             r0
09E1 DFF8           1713                                             djnz    r7,bufdec
09E3 7847           1714                                             mov             r0,#bufind+7
09E5 762D           1715                                             mov             @r0,#2dh          ;-2..-9
09E7 7840           1716                                             mov             r0,#bufind
09E9 762B           1717                                             mov             @r0,#2bh
09EB 300202         1718                                             jnb             znmat,nozzmi;bitznak,nozzmi
09EE 762D           1719                                             mov             @r0,#2dh
09F0 79AE           1720     nozzmi:                         mov             r1,#diap
09F2 7848           1721                                             mov             r0,#bufind+8
09F4 E7             1722                                             mov             a,@r1
09F5 B4080B         1723                                             cjne    a,#8,nodi8
09F8 20151E         1724                                             jb              biteizm,seegoon
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    28

09FB 7630           1725                                             mov             @r0,#30h                 ;10-10
09FD 18             1726                                             dec             r0
09FE 7663           1727                                             mov             @r0,#63h;31h
0A00 08             1728                                             inc             r0
0A01 8016           1729                                             jmp             seegoon
0A03 B40910         1730     nodi8:                          cjne    a,#9,nodis9
0A06 201510         1731                                     jb              biteizm,seegoon
0A09 7631           1732                                             mov             @r0,#31h           ;10-11
0A0B 18             1733                                             dec             r0
0A0C 7663           1734                                             mov             @r0,#63h;31h
                    1735                                     
0A0E 08             1736                                             inc             r0
0A0F 8008           1737                                             jmp             seegoon
                    1738     
0A11 807A           1739     rnorvich:               jmp             norvich
0A13 020000   F     1740     rno3parN:               jmp             no3parN
                    1741     
0A16 2432           1742     nodis9:                         add             a,#32h
0A18 F6             1743                                             mov             @r0,a;#37h;"T";
0A19 08             1744     seegoon:                        inc             r0
0A1A 7641           1745                                             mov             @r0,#"A";"E";
0A1C 08             1746                                             inc             r0
0A1D 7600           1747                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
0A1F 08             1748                                             inc             r0;             mov             buf
                             ind+11
0A20 7610           1749                                             mov             @r0,#010h               ;bufind+11.
                             4 точка после первой цифры
                    1750                                             
                    1751     ;;;;;;;;;;;;;;;
                    1752     ;;;;;;goonind:
0A22 79AF           1753                                             mov             r1,#parN        ; ??????
0A24 B703EC         1754                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1755             
0A27                1756     seeind:                         ;;;;;;;;;;;;;
0A27 784A           1757                                             mov             r0,#bufind+10
0A29 E6             1758                                             mov             a,@r0
0A2A 300F03         1759                                             jnb             bitnul,nnnul
0A2D 4408           1760                                             orl             a,#08h
0A2F F6             1761                                             mov             @r0,a
0A30 799A           1762      nnnul:         mov             r1,#parT
0A32 B70204         1763                                             cjne    @r1,#2,nsec1
0A35 4420           1764                                             orl             a,#20h    ;1s
0A37 8009           1765                                             jmp             nsec10
0A39 B70104         1766     nsec1:          cjne    @r1,#1,nsec11
0A3C 4440           1767                                             orl             a,#40h                  ;10s
0A3E 8002           1768                                             jmp             nsec10
                    1769                                     
0A40 4410           1770     nsec11:         orl             a,#10h
                    1771                                                      ;0,1s
                    1772     ;;;;;;;;;;;;;;;;
0A42                1773     nsec10:         
                    1774     
                    1775     
0A42 784A           1776                                             mov             r0,#bufind+10   
0A44 F6             1777                                             mov             @r0,a
0A45 300504         1778                                             jnb             bitavp,nobavp
0A48 4404           1779                                             orl             a,#04           ;bufind+10.2
0A4A F6             1780                                             mov             @r0,a
0A4B F6             1781                                             mov             @r0,a   
0A4C 784A           1782     nobavp:         mov             r0,#bufind+10   
0A4E F6             1783                                             mov             @r0,a   
0A4F 301803         1784                                        jnb          knizm,nobitizm
0A52 4402           1785                                             orl             a,#02
0A54 F6             1786                                              mov            @r0,a
0A55                1787     nobitizm:                       
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    29

0A55 301A07         1788                                             jnb             bitakt,notakt
0A58 C21A           1789                                             clr             bitakt
0A5A 534AFE         1790                                             anl             bufind+10,#0feh
0A5D 8005           1791                                             jmp             taktind
0A5F D21A           1792     notakt:                         setb    bitakt
0A61 434A01         1793                                             orl             bufind+10,#01                      
                                          
0A64                1794     taktind:                
                    1795     ;;;;;;;;;
0A64 301517         1796                                             jnb             biteizm,yesind
0A67 79B1           1797                                             mov             r1,#vichR
0A69 7848           1798                                             mov             r0,#bufind+8
0A6B 7654           1799                                             mov             @r0,#'T'
0A6D 08             1800                                             inc             r0
0A6E B72104         1801                                             cjne    @r1,#21h,test9i
0A71 7631           1802                                             mov             @r0,#31h;11A
                    1803                                     ;       dec             r0
                    1804                                     ;       mov             @r0,#63h
0A73 8009           1805                                             jmp             yesind
0A75 B72204         1806     test9i:         cjne    @r1,#22h,test7i
0A78 7632           1807                                             mov             @r0,#32h;39h;09A
0A7A 8002           1808                                             jmp             yesind
0A7C 7633           1809     test7i:         mov             @r0,#33h;37h;07A
                    1810     ;;;;;;;;;
0A7E                1811     yesind:         
0A7E 301203         1812                                             jnb             bitklb,noklb
0A81 434A80         1813                                             orl             bufind+10,#80h; on kmp
0A84 300A03         1814     noklb:          jnb             bitbon,nobuf
0A87 434B02         1815                                             orl             bufind+11,#02h; on pysk
0A8A 120000   F     1816     nobuf:          call    ind        ;пп выдачи на индикатор
0A8D                1817     norvich: 
0A8D 789A           1818                                     mov             r0,# parT
0A8F 79AC           1819                                             mov             r1,#chind
0A91 B60152         1820                                             cjne    @r0,#1,rnot1in
0A94                1821     labelB:                    ;;;;;;;;;;;
                    1822                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
0A94 789F           1823                                                     mov     r0,#rez_A3+3
                    1824                             ;;;;;;;;
0A96 79BB           1825                             mov             r1,#work+3
0A98 E6             1826                             mov             a,@r0
0A99 7F07           1827                             mov             r7,#7;кол сдв вправо
0A9B C3             1828     dvig3:          clr             c
0A9C 13             1829                             rrc             a
0A9D DFFC           1830                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
0A9F FA             1831                             mov             r2,a    ;сохр байт
0AA0 18             1832                             dec             r0              ;rez_A3+2
0AA1 E6             1833                             mov             a,@r0
0AA2 C0E0           1834                             push    acc
0AA4 C3             1835                             clr             c
0AA5 7F01           1836                             mov             r7,#1
0AA7 C3             1837     dvig2:          clr             c
0AA8 33             1838                             rlc             a
0AA9 DFFC           1839                             djnz    r7,dvig2 ;d12..d11       средний байт
0AAB 4A             1840                             orl             a,r2
0AAC F7             1841                             mov             @r1,a;сформ мл байт
0AAD 19             1842                             dec             r1
0AAE D0E0           1843                             pop             acc
                    1844                             
0AB0 7F07           1845                             mov             r7,#7
0AB2 C3             1846     dvig1:          clr             c
0AB3 13             1847                             rrc             a
0AB4 DFFC           1848                             djnz    r7,dvig1 ;d18     ср байт
0AB6 FA             1849                             mov             r2,a   ;сохр
0AB7 18             1850                             dec             r0
0AB8 E6             1851                             mov             a,@r0 ;rez_A3+1
0AB9 C0E0           1852                             push    acc
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    30

                    1853                     
0ABB 7F01           1854                             mov             r7,#1
0ABD C3             1855     dvig0:          clr             c
0ABE 33             1856                             rlc             a
0ABF DFFC           1857                             djnz    r7,dvig0 ;        d21..d16
0AC1 4A             1858                             orl             a,r2
0AC2 F7             1859                             mov             @r1,a   ; сформ средний  байт
0AC3 19             1860                             dec             r1
0AC4 D0E0           1861                             pop             acc       ;rez_A3+1
                    1862                             ;;;;;;;;;;;;;;
                    1863     ;                       jb              acc.7,dvm
0AC6 C3             1864                             clr             c
0AC7 7F07           1865                             mov             r7,#7
0AC9 C3             1866     dvig4:          clr             c
0ACA 13             1867                             rrc             a
0ACB DFFC           1868                             djnz    r7,dvig4 ;        d22
0ACD FA             1869                             mov             r2,a   ;сохр
0ACE 18             1870                             dec             r0;     rez_A3
0ACF E6             1871                             mov             a,@r0
                    1872                             ;;;;;
0AD0 7F01           1873                             mov             r7,#1
0AD2 C3             1874     vig0:           clr             c
0AD3 33             1875                             rlc             a
0AD4 DFFC           1876                             djnz    r7,vig0 ;         d24..d30
0AD6 4A             1877                             orl             a,r2
0AD7 F7             1878                             mov             @r1,a   ; сформ   байт
0AD8 19             1879                             dec             r1
0AD9 E6             1880                             mov             a,@r0
                    1881                             ;;;;;
0ADA 20E70C         1882                             jb              acc.7,dvm
0ADD C3             1883                             clr             c
0ADE 7F07           1884                             mov             r7,#7
0AE0 C3             1885     vig4:           clr             c
0AE1 13             1886                             rrc             a
0AE2 DFFC           1887                             djnz    r7,vig4 ;         d
0AE4 8009           1888                             jmp             endsdv
                    1889     
0AE6 020000   F     1890     rnot1in:                jmp             not1in
                    1891     
                    1892     ;;;;;;;;;;;;                                    
0AE9 7F07           1893     dvm:            mov             r7,#7
0AEB D3             1894     dvig6:          setb            c
0AEC 13             1895                             rrc             a
0AED DFFC           1896                             djnz    r7,dvig6 ;        d31
0AEF F7             1897     endsdv:         mov             @r1,a
                    1898                                                             
                    1899      ;->work   
                    1900                             
0AF0 900000   F     1901                             mov             dptr,#chzap
0AF3 120000   F     1902                             call     ldc_long
0AF6 78BB           1903                              mov            r0,#work+3
0AF8 120000   F     1904                             call    ladd
0AFB ED             1905                             mov             a,r5
0AFC F5D5           1906                             mov             DAC1L,a
                    1907                             
0AFE EC             1908                             mov             a,r4
0AFF F5D6           1909                             mov             DAC1H,a
                    1910     
                    1911                                             ;;;;;;;;;;
0B01 78CF           1912                                             mov                     r0,#chbuf               ;fl
                             oat
0B03 120000   F     1913                                             call            resar2
0B06 900000   F     1914                                             mov                     dptr,#ch_2;ch0;ch_1
0B09 120000   F     1915                                             call            ldc_ltemp
0B0C 1201D6         1916                                             call            flcmp
0B0F 5020           1917                                             jnc                     rnobuf0
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    31

                    1918                                             
0B11 900000   F     1919                                             mov                     dptr,#ch_1
0B14 120000   F     1920                                             call            ldc_ltemp
0B17 1201D1         1921                                             call            flsub
0B1A 900E00         1922                                             mov                     dptr,#chbuf1               
                                  ;СБ1 внешн озу
0B1D EA             1923                                             mov                     a,r2
0B1E F0             1924                                             movx            @dptr,a
0B1F A3             1925                                             inc                     dptr
0B20 EB             1926                                             mov                     a,r3
0B21 F0             1927                                             movx            @dptr,a
0B22 A3             1928                                             inc                     dptr
0B23 EC             1929                                             mov                     a,r4
0B24 F0             1930                                             movx            @dptr,a
0B25 A3             1931                                             inc                     dptr
0B26 ED             1932                                             mov                     a,r5
0B27 F0             1933                                             movx            @dptr,a
                    1934                                             
                    1935                                             
                    1936                                             ;jnc                    rnobuf0
0B28 200909         1937                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
0B2B 200A08         1938                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0B2E 020000   F     1939                                             jmp             gocikle
0B31 020000   F     1940     rnobuf0:        jmp             nobuf0
0B34                1941     yesprd: ;передать   A3 в буфер
0B34 8035           1942                                             jmp             goonT
0B36                1943     yesbuf:         ;записать   A3 в буфер
0B36 120000   F     1944                                             call            resa_hl;dptr-
0B39 120000   F     1945                                             call            loA3_X  ;адрес след ячейки внешн оз
                             у храним
                    1946                                                                             ;в ячейке saven_bl
0B3C 120000   F     1947                                             call            save_hl
0B3F 78AE           1948                                             mov                     r0,#diap
0B41 E6             1949                                             mov                     a,@r0
0B42 7938           1950                                             mov                     r1,#nblok
0B44 B70104         1951                                             cjne            @r1,#1,nosav1
0B47 F534           1952                                             mov                     sadiap,a
0B49 8012           1953                                             jmp                     gotostrob
0B4B B70204         1954     nosav1:         cjne            @r1,#2,nosav2
0B4E F532           1955                                             mov                     sadiap2,a
0B50 800B           1956                                     jmp                     gotostrob
0B52 B70304         1957     nosav2:         cjne            @r1,#3,nosav3
0B55 F531           1958                                             mov                     sadiap3,a
0B57 8004           1959                                     jmp                     gotostrob
0B59                1960     nosav3:         
0B59 F530           1961                                             mov                     sadiap4,a
0B5B 8000           1962                                     jmp                     gotostrob
                    1963     
                    1964                                             ;строб
0B5D                1965     gotostrob:
0B5D E586           1966                                     mov             a,P6            ;p6.4=0
0B5F 54EF           1967                             anl             a,#0efh
0B61 F586           1968                             mov             P6,a
0B63 00             1969                             nop
0B64 00             1970                             nop
                    1971                                     
0B65 E586           1972                             mov             a,P6                    ;p6.4=1 
0B67 4410           1973                             orl             a,#10h
0B69 F586           1974                             mov             P6,a                        
0B6B 78CD           1975     goonT:                          mov             r0,#interva;high  byte loadr2
0B6D E6             1976                                             mov             a,@r0
0B6E FC             1977                                             mov             r4,a
0B6F 08             1978                                             inc             r0
0B70 E6             1979                                             mov             a,@r0
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    32

0B71 FD             1980                                             mov             r5,a
0B72 E4             1981                                             clr             a
0B73 FB             1982                                             mov             r3,a
0B74 FA             1983                                             mov             r2,a                            ;r2
                             ..r5-interval(hex)
0B75 120402         1984                                             call            altof                   ;r2..r5->in
                             terval (float)
                    1985     
0B78 789A           1986                                             mov             r0,#parT
0B7A B60108         1987                                             cjne    @r0,#1,nott1
0B7D 900000   F     1988                                             mov                     dptr,#ch_2       
0B80 120000   F     1989                                             call            ldc_ltemp
0B83 8009           1990                                             jmp                     intmul
                    1991     
0B85 B60225         1992     nott1:                  cjne    @r0,#2,nott2
0B88 900000   F     1993                                                     mov                     dptr,#ch_10      
0B8B 120000   F     1994                                                     call            ldc_ltemp
                    1995                                                                             
0B8E 120203         1996     intmul: call            flmul                                   ;*10
0B91 900E00         1997     intmul1:        mov             dptr,#chbuf1    ;СБ1
0B94 E0             1998                                             movx    a,@dptr
0B95 F508           1999                                             mov             r8,a
0B97 A3             2000                                             inc             dptr
0B98 E0             2001                                     movx    a,@dptr
0B99 F509           2002                                             mov             r9,a
0B9B A3             2003                                             inc             dptr
0B9C E0             2004                                     movx    a,@dptr
0B9D F50A           2005                                             mov             r10,a
0B9F A3             2006                                             inc             dptr
0BA0 E0             2007                                             movx    a,@dptr
0BA1 F50B           2008                                             mov             r11,a
0BA3 120166         2009                                             call            fladd           ;СБ+СБ1
0BA6 78CF           2010     intmul2:        mov                     r0,#chbuf
0BA8 120000   F     2011                                     call            saver2          ;*2
                    2012                                     
0BAB 803E           2013                                     jmp             gocikle
                    2014     
0BAD B6030B         2015     nott2:                  cjne    @r0,#3,nott3
0BB0 900000   F     2016                                                     mov                     dptr,#ch_2       
0BB3 120000   F     2017                                                     call            ldc_ltemp
0BB6 120203         2018                                                     call            flmul
0BB9 80EB           2019                                                     jmp                     intmul2            
                                                  ;*2
                    2020     
                    2021     
0BBB B60414         2022     nott3:          cjne    @r0,#4,nott4
0BBE 900000   F     2023                                             mov                     dptr,#ch_10      
0BC1 120000   F     2024                                             call            ldc_ltemp       ;/10*4
0BC4 1202B7         2025                                             call            fldiv
0BC7 900000   F     2026                                             mov                     dptr,#ch_4       
0BCA 120000   F     2027                                             call            ldc_ltemp
0BCD 120203         2028                                             call            flmul
0BD0 80D4           2029                                             jmp             intmul2
                    2030     
0BD2 B6050B         2031     nott4:          cjne    @r0,#5,nott5
0BD5 900000   F     2032                                                     mov                     dptr,#ch_2       
0BD8 120000   F     2033                                             call            ldc_ltemp;*2
0BDB 120203         2034                                             call            flmul
0BDE 80C6           2035                                             jmp             intmul2;T=5
0BE0 900000   F     2036     nott5:                  mov                     dptr,#ch_1       
0BE3 120000   F     2037                                             call            ldc_ltemp
0BE6 120203         2038                                             call            flmul
0BE9 80BB           2039                                     jmp                     intmul2                            
                                  ;*1
                    2040     
                    2041     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    33

0BEB 300708         2042     gocikle:        jnb             bitzus,nofz                     
0BEE 120000   F     2043                             call    z_05s    ;0,5c
0BF1 120000   F     2044                             call    z_05s    ;0,5c
0BF4 C207           2045                             clr     bitzus;bitbuf бит задержки засылки us
0BF6 020000   F     2046     nofz:           jmp     labelA;rebyte
                    2047     
                    2048     
0BF9 80F0           2049     yestt5:         jmp             gocikle
                    2050     
0BFB 78CF           2051     nobuf0:                 mov             r0,#chbuf
0BFD 120000   F     2052                                                     call            resar2
0C00 900000   F     2053                                                     mov                     dptr,#ch_1       
0C03 120000   F     2054                                             call            ldc_ltemp
0C06 1201D1         2055                                             call            flsub
0C09 78CF           2056                                             mov                     r0,#chbuf       
0C0B 120000   F     2057                                             call            saver2  
0C0E 80DB           2058                                             jmp             gocikle
                    2059     
                    2060     
0C10 B60205         2061     not1in:                         cjne    @r0,#2,not2in
0C13 7701           2062                                             mov             @r1,#1           ;T=2
0C15 020000   F     2063                                             jmp     labelB
                    2064     
0C18 B60305         2065     not2in:                         cjne    @r0,#3,not3in
0C1B 7701           2066                                             mov             @r1,#1;9                ;T=3
0C1D 020000   F     2067                                             jmp     labelB
0C20 7703           2068     not3in:                         mov             @r1,#3;19
0C22 020000   F     2069                                             jmp     labelB
                    2070     
                    2071     
                    2072     ;;;;;;;;;;;3.11.06
                    2073     
                    2074     ;;коррекция 0
0C25 7883           2075     KORnul:         mov             r0,#chdel
0C27 B60010         2076                             cjne    @r0,#0,nonuldel
                    2077                                     
0C2A E584           2078                             mov             a,p4                    ;сохр  us
0C2C F536           2079                             mov             saus,a
0C2E E585           2080                             mov             a,p5
0C30 F537           2081                             mov             saus+1,a
                    2082     
0C32 900000   F     2083                             mov             dptr,#kor0us
0C35 120000   F     2084                             call    lospus          ;упр слово коррекции 0
0C38 8018           2085                             jmp             chdelmo
                    2086     
0C3A                2087     nonuldel:       ;cjne   @r0,#7,no4del
0C3A B6031B         2088                                                     cjne    @r0,#3,no4del
                    2089                             ;рез ->AN
0C3D 7862           2090                             mov             r0,#rez_A;->r2..r5
0C3F 120000   F     2091                             call    resar2
                    2092             
                    2093                                     ;;;;;;;;;;
0C42 120402         2094                             call    altof           ;r2..r5->float
0C45 7884           2095                             mov             r0,#kor0_AN;->kor0_AN
0C47 120000   F     2096                             call    saver2
                    2097                                     
0C4A E536           2098                             mov             a,saus                  ;восстан исходное упр слово
0C4C F584           2099                             mov             p4,a
0C4E E537           2100                             mov             a,saus+1
0C50 F585           2101                             mov             p5,a            
0C52 7883           2102     chdelmo:        mov             r0,#chdel
0C54 06             2103                             inc             @r0             ;chdel+1
0C55 020000   F     2104                             jmp              rebyte
                    2105     
0C58                2106     no4del:         ;cjne   @r0,#14,chdelmo
0C58 B606F7         2107                                             cjne    @r0,#6,chdelmo
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    34

0C5B 7600           2108                             mov             @r0,#0          ;chdel
0C5D 7898           2109                             mov             r0,#chinkor
0C5F 7600           2110                             mov             @r0,#00;1;00;02;600;
0C61 08             2111                             inc             r0
0C62 76C8           2112                             mov             @r0,#0c8h;90h;0c8h;58h;258h
0C64 120000   F     2113                             call    clmassix;сбросить массив скольз среднего
0C67                2114     bonpart:
0C67 300A20         2115                             jnb                     bitbon,rebyter
0C6A 78CF           2116                             mov                     r0,#chbuf
0C6C 120000   F     2117                             call            resar2
0C6F 799A           2118                             mov                     r1,#parT
0C71 B70211         2119                             cjne            @r1,#2,no6del
0C74 900000   F     2120                             mov                     dptr,#ch_7;5
0C77                2121     no5del:
0C77 120000   F     2122                             call            ldc_ltemp
0C7A 1201D1         2123                             call            flsub   
0C7D 78CF           2124                             mov                     r0,#chbuf
0C7F 120000   F     2125                             call            saver2
0C82 020000   F     2126                             jmp              rebyte
0C85                2127     no6del:
0C85 900000   F     2128                             mov                     dptr,#ch_1
0C88 80ED           2129                             jmp                     no5del
0C8A 020000   F     2130     rebyter:        jmp             rebyte
                    2131     
                    2132     
                    2133     ;автокалибровка
0C8D 200AFA         2134     autoka:  jb             bitbon,rebyter
0C90                2135     nulavt:  ;;;;;
0C90 7883           2136                             mov             r0,#chdel
0C92 B60016         2137                             cjne    @r0,#0,nndelch
0C95 E584           2138                             mov             a,p4                    ;сохр  us
0C97 F536           2139                             mov             saus,a
0C99 E585           2140                             mov             a,p5
0C9B F537           2141                             mov             saus+1,a
                    2142     
0C9D E585           2143                             mov   a,p5
0C9F 4404           2144                             orl             a,#04              ;p5.2=1
0CA1 00             2145                             nop
0CA2 00             2146                             nop
0CA3 543F           2147                             anl             a,#3fh          ;p5.6,p5.7=0
0CA5 F585           2148                             mov   p5,a
0CA7 06             2149                             inc             @r0
0CA8 020000   F     2150                             jmp              rebyte
                    2151     
0CAB B6033D         2152     nndelch:        cjne    @r0,#3,n4delch
                    2153                             ;pez->A+
                    2154                             ;K+=000/(A+-AN)
                    2155                             ;mov            r0,#rez_A;->r2..r5
                    2156                             ;call   resar2
0CAE E577           2157                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0CB0 FA             2158                                     mov             r2,a
0CB1 E578           2159                                     mov             a,reacp+1
0CB3 FB             2160                                     mov             r3,a
0CB4 E579           2161                                     mov             a,reacp+2
0CB6 FC             2162                                     mov             r4,a
0CB7 E57A           2163                                     mov             a,reacp+3
0CB9 FD             2164                                     mov             r5,a
                    2165                                     ;;;;;;;;;;;;;;;
0CBA 120402         2166                             call    altof                   ;r2..r5->float
0CBD 7888           2167                             mov             r0,#rezAp;->rezAp
0CBF 120000   F     2168                             call    saver2                          
0CC2 7884           2169                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0CC4 120000   F     2170                             call    resar8                          
0CC7 1201D1         2171                             call    flsub           ; r2..r5(A+-AN)
0CCA 120000   F     2172                             call    move28     ;r2..r5->r8..r11
0CCD 900000   F     2173                             mov             dptr,#CH2tho;000->r2..r5 float
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    35

0CD0 120000   F     2174                             call    ldc_long                
0CD3 1202B7         2175                             call    fldiv
0CD6 EA             2176                             mov             a,r2
0CD7 547F           2177                             anl             a,#7fh
0CD9 FA             2178                             mov             r2,a
0CDA 7890           2179                             mov             r0,#koefKp;->koefKp
0CDC 120000   F     2180                             call    saver2
                    2181                       
                    2182                     ;       anl             P5,#0feh                ;p5.0=0 
0CDF E585           2183                     mov             a,P5
0CE1 543B           2184                             anl             a,#3bh;acp-
0CE3 F585           2185                             mov             P5,a
0CE5 7883           2186                             mov             r0,#chdel
0CE7 06             2187                             inc             @r0                       ;ch+1
0CE8 020000   F     2188                             jmp             rebyte
                    2189     
0CEB B6063F         2190     n4delch:        cjne    @r0,#6,n8delch
                    2191                             ; pez->A-
                    2192                             ;K-=000/(A--AN)
                    2193                     ;       mov     r0,#rez_A;->r2..r5
                    2194                     ;       call    resar2
0CEE E577           2195                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0CF0 FA             2196                                     mov             r2,a
0CF1 E578           2197                                     mov             a,reacp+1
0CF3 FB             2198                                     mov             r3,a
0CF4 E579           2199                                     mov             a,reacp+2
0CF6 FC             2200                                     mov             r4,a
0CF7 E57A           2201                                     mov             a,reacp+3
0CF9 FD             2202                                     mov             r5,a
                    2203                                     ;;;;;;;;;;;;;;;
0CFA 120402         2204                             call    altof                   ;r2..r5->float
0CFD 788C           2205                             mov             r0,#rezAm;->rezAm
0CFF 120000   F     2206                             call    saver2                          
0D02 7884           2207                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0D04 120000   F     2208                             call    resar8                          
0D07 1201D1         2209                             call    flsub                   ; r2..r5(A--AN)
0D0A 120000   F     2210                             call    move28                  ;r2..r5->r8..r11
0D0D 900000   F     2211                             mov             dptr,#CH2tho    ;000->r2..r5 float
0D10 120000   F     2212                             call    ldc_long                
0D13 1202B7         2213                             call    fldiv
0D16 EA             2214                             mov             a,r2
0D17 547F           2215                             anl             a,#7fh
0D19 FA             2216                             mov             r2,a
0D1A 7894           2217                             mov             r0,#koefKm;->koefKm
0D1C 120000   F     2218                             call    saver2
                    2219                        
0D1F E536           2220                             mov             a,saus                  ;восстан исходное упр слово
0D21 F584           2221                             mov             p4,a
0D23 E537           2222                             mov             a,saus+1
0D25 F585           2223                             mov             p5,a            
0D27 7883           2224                             mov             r0,#chdel
0D29 06             2225                             inc             @r0                       ;ch+1
0D2A 020000   F     2226                        jmp    rebyte
                    2227     
0D2D B6090F         2228     n8delch:        cjne    @r0,#9,n12delch
0D30 7600           2229                             mov             @r0,#0
0D32 7981           2230                             mov             r1,#chavt
0D34 770C           2231                             mov             @r1,#0ch;6;1;
0D36 09             2232                             inc             r1
0D37 7780           2233                             mov             @r1,#80h;40h;
0D39 120000   F     2234                             call   clmassix     ;сбросить массив среднего
0D3C 020000   F     2235                             jmp             rebyte; bonpart;
0D3F 06             2236     n12delch:       inc             @r0
0D40 020000   F     2237                             jmp             rebyte
                    2238     
                    2239     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    36

                    2240     
                    2241                                 
0D43 020000   F     2242     rout6:          jmp             out6
0D46 020000   F     2243     rlabelF:        jmp             labelF  
0D49 020000   F     2244     rknrazr:        jmp             knrazr  
0D4C 020000   F     2245     rknopt:         jmp             knopt
0D4F 020000   F     2246     rizman:         jmp             izman   
0D52                2247     keyb1:  ;IE6 
0D52 75E700         2248                                     mov             EIE2,#00H
0D55 75AD00         2249                                     mov             P3IF,#00
                    2250                                     
0D58 C0E0           2251                                     push    acc
0D5A C0D0           2252                                     push    psw
0D5C C000           2253                                     push    rr0
0D5E C001           2254                                     push    rr1
0D60 C002           2255                                     push    rr2
0D62 C003           2256                                     push    rr3
0D64 C004           2257                                     push    rr4
0D66 C005           2258                                     push    rr5
0D68 C006           2259                                     push    rr6
0D6A C007           2260                                     push    rr7
0D6C C082           2261                                     push    dpl
0D6E C083           2262                                     push    dph
                    2263                                     ;clr            bitmig
                    2264                       ;;;;;;;;;;;;;;
0D70 120000   F     2265                                     call    z_01s;0,1s
0D73 120000   F     2266                                             call    z_01s
                    2267                                     ;восстан знакоместо при мигании
                    2268                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0D76 78B2           2269                                     mov             r0,#marker
0D78 7440           2270                                     mov             a,#bufind
0D7A 26             2271                                     add             a,@r0                   ;a=bufind+marker
0D7B F9             2272                                     mov             r1,a
0D7C A73C           2273                                     mov             @r1,savba
                    2274                                     ;;;;;;;;;;;
0D7E E5B0           2275                             mov             a,p3
0D80 20E644         2276                                     jb              acc.6,outviR;выход из режима выч R
0D83 E5B0           2277     gout6:                          mov             a,p3
0D85 44FF           2278                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0D87 F5B0           2279                                     mov             p3,a
0D89 E5B0           2280                                     mov             a,p3
0D8B 30E6B5         2281                                     jnb             acc.6,rout6             ;error
0D8E 3004B5         2282                                     jnb             bitizm,rlabelF
0D91 75B0FE         2283                                     mov             p3,#0feh                ;реж IZM
0D94 E5B0           2284                                     mov             a,p3
0D96 30E6B6         2285                                     jnb             acc.6,rizman
                    2286                                     ;;;;;;
0D99 201232         2287                                     jb              bitklb,goklb
0D9C 75B0FD         2288                                     mov             p3,#0fdh
0D9F E5B0           2289                                     mov             a,p3
0DA1 30E6A5         2290                                     jnb             acc.6,rknrazr             ;labelC
0DA4 75B0FB         2291                                     mov             p3,#0fbh
0DA7 E5B0           2292                                     mov             a,p3
0DA9 30E655         2293                                     jnb             acc.6,knright           ;->
0DAC 75B0F7         2294                                     mov             p3,#0f7h
0DAF E5B0           2295                                     mov             a,p3
0DB1 30E698         2296                                     jnb             acc.6,rknopt                    ;T
0DB4 75B0EF         2297                                     mov             p3,#0efh
0DB7 E5B0           2298                                mov          a,p3
0DB9 30E615         2299                                     jnb             acc.6,pyskst                    ;pysk/stop
0DBC 75B0DF         2300                                     mov             p3,#0dfh
0DBF E5B0           2301                                     mov             a,p3
0DC1 30E65E         2302                                jnb          acc.6,knvich
0DC4 020000   F     2303                                     jmp             izmpaT
                    2304     
0DC7 3006B9         2305     outviR: jnb             bitvi11,gout6   
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    37

0DCA C214           2306                                     clr             bitvich                         ;выход из р
                             ежима выч R  
0DCC C206           2307                                     clr             bitvi11
                    2308                                     
0DCE 020000   F     2309     goklb:          jmp             out6
                    2310     
0DD1 200A12         2311     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0DD4 D20A           2312                                     setb    bitbon  ;уст реж буфер вкл
0DD6 79D5           2313                                     mov                     r1,#volume;work         ;обьем блок
                             а
0DD8 7700           2314                                     mov                     @r1,#00
0DDA 09             2315                                     inc                     r1
0DDB 77C7           2316                                     mov                     @r1,#0c7h                       ;32
                             0h/4
0DDD 434B02         2317                                     orl             bufind+11,#02h; on pysk
0DE0 120000   F     2318                                     call            ind
0DE3 020000   F     2319                                     jmp             izmpaT
0DE6 C20A           2320     bufon:                  clr             bitbon  ;уст реж буфер выкл
0DE8 534BFD         2321                                             anl             bufind+11,#0fdh; off pysk
0DEB 120000   F     2322                                             call    ind
0DEE 020000   F     2323                                     jmp             izmpaT
                    2324     
0DF1 79B0           2325     tizmri:                 mov             r1,#level
0DF3 B70102         2326                                     cjne    @r1,#1,right2
                    2327                                     ;10s->HET
0DF6 8004           2328                                     jmp             right3
                    2329     
0DF8 07             2330     right2:                 inc             @r1
0DF9 120000   F     2331                                     call    lolevT
                    2332                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0DFC 120000   F     2333     right3:                 call    ind
0DFF 807A           2334                                     jmp             izmfun
                    2335     
                    2336                             
                    2337                             
0E01                2338     knright:        
                    2339     
0E01 79AE           2340                                     mov             r1,#diap
                    2341                             ;перекл диапазон 1 поз вверх сбр массив
0E03 17             2342                                     dec             @r1
0E04 B7FF04         2343                                     cjne    @r1,#0ffh,diinc
0E07 7700           2344                                     mov             @r1,#0
0E09 8070           2345                                     jmp  izmfun
0E0B 120000   F     2346     diinc:                  call     clmassix
0E0E 78B3           2347                                     mov             r0,#summa
0E10 120000   F     2348                                     call    clear4
0E13 786A           2349                                     mov             r0,#rez_A0
0E15 120000   F     2350                                     call    clear4
0E18 C20F           2351                                     clr             bitnul          ;гасить светодиод НУЛЬ  
0E1A 120000   F     2352                                     call    loadUS
0E1D 805C           2353                                      jmp  izmfun
                    2354     
0E1F 020000   F     2355     vit2_10:                jmp             out6
0E22                2356     knvich:                 ;12.02.07
0E22 789A           2357                                             mov                     r0,#parT
0E24 C3             2358                                             clr                     c
0E25 7404           2359                                             mov                     a,#4 
0E27 96             2360                                             subb            a,@r0
0E28 40F5           2361                                             jc                      vit2_10;не нажимать кнопку 
                             ВЫЧ R T=10ms,2ms
0E2A 200613         2362                               jb            bitvi11,onvich
0E2D C204           2363                                     clr             bitizm
0E2F D214           2364                                     setb    bitvich
                    2365                                     
0E31 78B1           2366                                     mov             r0,#vichR
0E33 7611           2367                                     mov             @r0,#11h;;????????or 0
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    38

                    2368                                     ;ВЫЧИСЛИТЬ
0E35 900000   F     2369                                     mov     dptr,#teVICH
0E38 120000   F     2370                                     call    lotext
0E3B 120000   F     2371                                call         z_1s;;;;;;;
0E3E 806C           2372                                     jmp              viout;izmpaT
                    2373     
0E40 C214           2374     onvich:                 clr             bitvich
0E42 78B1           2375                                     mov             r0,#vichR
0E44 7600           2376                                     mov             @r0,#0
0E46 8037           2377                                     jmp              izmpaT
                    2378     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0E48 301820         2379     louizm:            jnb          knizm,lou
0E4B 79AE           2380                                     mov             r1,#diap
0E4D C3             2381                                     clr             c
0E4E 7403           2382                                     mov             a,#3
0E50 97             2383                                     subb    a,@r1
0E51 5006           2384                                     jnc             lldi23    ;10-2..10-5
                    2385                                     ;10-6..10-11
0E53 E584           2386                                     mov             a,p4
0E55 54F7           2387                                     anl             a,#0f7h   ;d3
0E57 F584           2388                                     mov             p4,a
0E59 E7             2389     lldi23:                 mov             a,@r1
0E5A 6403           2390                                     xrl             a,#3
0E5C 7002           2391                                     jnz             lldi3
0E5E 8005           2392                                     jmp             lldi2   ;10-5
0E60 E7             2393     lldi3:                  mov             a,@r1
0E61 6402           2394                                     xrl             a,#2            ;
0E63 7006           2395                                     jnz             lou             
0E65 E585           2396     lldi2:                  mov             a,p5            ;10-4
0E67 4408           2397                                     orl             a,#08
0E69 F585           2398                                     mov             p5,a
0E6B 22             2399     lou:                    ret
                    2400                               ;;;;;;
0E6C 201807         2401     izman:                  jb              knizm,knizmon
0E6F D218           2402                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2403                             ;       d3(k5 p4),d3(u5 p5)заслать us
0E71 120000   F     2404                                     call    louizm 
0E74 8005           2405                                     jmp             izmfun
0E76 C218           2406     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0E78 120000   F     2407                                     call    loadUS;восстановить us
0E7B                2408     izmfun:                 
0E7B D207           2409                                     setb    bitzus;bitbuf
0E7D 8000           2410                                     jmp             labelE;;;;;;;;;;;;
                    2411                                     ;;;;;;;;;;;;;;
0E7F                2412     izmpaT:
                    2413     ;;;;;;;;;;;;;;;;;
                    2414                     ;       clr             c 
                    2415                     ;       mov             r1,#parN
                    2416     
                    2417                     ;       mov             r0,#diap
                    2418                     ;       mov             a,#6            
                    2419                     ;       subb    a,@r0
                    2420                     ;       jnc             labelE          ;         ;10-2..10-8
                    2421                               
                    2422                     ;       mov             @r1,#2          ;10-9..10-11            
                    2423                     ;       jmp             labelE
                    2424     
                    2425     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0E7F 789A           2426     labelE:                 mov             r0,#parT
0E81 793D           2427                                     mov             r1,#chkl
0E83 B60108         2428                                     cjne    @r0,#1,izmt2
0E86 7700           2429                                     mov             @r1,#0
0E88 09             2430                                     inc             r1
0E89 7702           2431                                     mov             @r1,#2
0E8B 020000   F     2432                                     jmp             out6
0E8E B60208         2433     izmt2:                  cjne    @r0,#2,izmt3
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    39

0E91 7700           2434                                     mov             @r1,#0
0E93 09             2435                                     inc             r1
0E94 7714           2436                                     mov             @r1,#20
0E96 020000   F     2437                                     jmp             out6
                    2438     
0E99 7700           2439     izmt3:                  mov             @r1,#0
0E9B 09             2440                                     inc             r1
0E9C 77C8           2441                                     mov             @r1,#200
0E9E 020000   F     2442                                     jmp             out6
                    2443     
                    2444     
                    2445     
                    2446     
0EA1                2447     knopt: ;кнопка T
0EA1 C204           2448                                clr          bitizm
0EA3 D210           2449                                setb         bitt2
0EA5 79B7           2450                                mov          r1,#load
0EA7 7704           2451                                mov          @r1,#4;1s
0EA9 120000   F     2452                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2453                     
0EAC 793D           2454     viout:          mov             r1,#chkl
0EAE 7703           2455                             mov             @r1,#03
0EB0 09             2456                             inc             r1
0EB1 77E8           2457                             mov             @r1,#0e8h               ;1000
0EB3 020000   F     2458                             jmp             out6
                    2459     
0EB6                2460     knrazr:          
0EB6 C3             2461     labelC:          clr            c
0EB7 78AF           2462                             mov             r0,#parN
0EB9 799A           2463                             mov             r1,#parT
0EBB 7402           2464                             mov             a,#2
0EBD 97             2465                             subb    a,@r1
0EBE 40BF           2466                             jc              labelE          ;T>2
0EC0 B60104         2467                             cjne    @r0,#1,noN1c
0EC3 7602           2468                             mov             @r0,#2          ;N=2
0EC5 80B8           2469                             jmp             labelE
                    2470     
0EC7 B60204         2471     noN1c:          cjne    @r0,#2,not_1
0ECA 7603           2472                             mov             @r0,#3          ;N=3      ;10-2..10-8
0ECC 80B1           2473                             jmp             labelE
                    2474     
0ECE                2475     not_10: 
0ECE 7601           2476     not_1:          mov             @r0,#1                          ;N=1
0ED0 80AD           2477                             jmp     labelE
                    2478     
0ED2 020000   F     2479     rtizmri:        jmp             tizmri
                    2480     
0ED5 75B0F7         2481     ttout:          mov             p3,#0f7h
0ED8 20B6D1         2482                                             jb              p3.6,viout
0EDB D204           2483                                             setb    bitizm;отжатие кнопки t
0EDD C210           2484                                             clr             bitt2
0EDF 809E           2485                                             jmp             labelE
0EE1                2486     labelf:                 
0EE1 301037         2487                             jnb             bitt2,nofizm
0EE4 75B0FB         2488                        mov          p3,#0fbh
0EE7 E5B0           2489                        mov          a,p3
0EE9 20E6E9         2490                        jb           acc.6,ttout;outF
0EEC 79B7           2491                        mov          r1,#load;parT
0EEE B70503         2492                        cjne         @r1,#5,noft1
                    2493                        ;t=10s
0EF1 020000   F     2494                        jmp          out6;ft1izm
                    2495     
0EF4 07             2496     noft1:     inc          @r1;dec         @r1
0EF5 120000   F     2497     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2498                             ;call   ind
0EF8 020000   F     2499                     jmp             out6;??????????????/
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    40

                    2500     
                    2501                             ;увеличить счетчик задержки клавиатуры
0EFB 783D           2502     outF:           mov             r0,#chkl
0EFD 7627           2503                             mov             @r0,#27h
0EFF 08             2504                             inc             r0
0F00 7610           2505                             mov             @r0,#10h
0F02 020000   F     2506                             jmp             out6;out7
                    2507     
0F05 020000   F     2508     noviR1:         jmp             noviR
0F08 78B1           2509     outvich:        mov                     r0,#vichR
0F0A 7600           2510                                             mov                     @r0,#0
0F0C C214           2511                                             clr                     bitvich
0F0E C206           2512                                             clr                     bitvi11
0F10 C211           2513                                             clr                     bitmenu
0F12 D204           2514                                             setb            bitizm
0F14 78B2           2515                                             mov                     r0,#marker
0F16 76FF           2516                                             mov                     @r0,#0ffh
0F18 020000   F     2517                                             jmp                     out6    
                    2518     
0F1B 3014E7         2519     nofizm:         jnb             bitvich,noviR1
0F1E 75B0DF         2520                                                     mov             p3,#0dfh
0F21 30B6E4         2521                                                     jnb             p3.6,outvich;отжатие кнопки
                              вычR
0F24 78B1           2522                             mov             r0,#vichR
0F26 B61110         2523                             cjne    @r0,#11h,no11v6
0F29 75B0FB         2524                             mov                     p3,#0fbh;->
0F2C 20B6CC         2525                             jb                      p3.6,outF
0F2F 7612           2526                             mov             @r0,#12h                ;11= вычислить
0F31 900000   F     2527     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0F34 120000   F     2528                             call    lotext
0F37 80C2           2529                             jmp             outF
                    2530             
0F39 B61210         2531     no11v6:         cjne    @r0,#12h,no12v6
0F3C 75B0FB         2532                             mov             p3,#0fbh;->
0F3F 20B6B9         2533                             jb              p3.6,outF
0F42 7613           2534                             mov             @r0,#13h
0F44 900000   F     2535                             mov             dptr,#teOUT
0F47 120000   F     2536                             call    lotext
0F4A 80AF           2537                             jmp             outF
                    2538                     
0F4C B61310         2539     no12v6:         cjne    @r0,#13h,no13v6
0F4F 75B0FB         2540                                                     mov             p3,#0fbh;->
0F52 20B6A6         2541                             jb              p3.6,outF
0F55 7611           2542                             mov             @r0,#11h
0F57 900000   F     2543                             mov             dptr,#teVICH
0F5A 120000   F     2544                             call    lotext
0F5D 809C           2545                             jmp             outF
                    2546     
                    2547     ;кн -> A= 0000
                    2548     ;кн -> B= +00000
0F5F 75B0FB         2549     no13v6:         mov             p3,#0fbh
0F62 E5B0           2550                             mov             a,p3
0F64 20E635         2551                             jb              acc.6,chanZ
0F67 E53B           2552                             mov             a,movrig
0F69 B40714         2553                             cjne    a,#7,kon_B      
0F6C 78B2           2554                             mov             r0,#marker      ;A= 0000
0F6E B60716         2555                             cjne    @r0,#7,mark0_8          ;курсор справа ?
0F71 E53A           2556     rikn:           mov             a,movleft
0F73 F6             2557                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2558     ;                               29.12.06
                    2559     ;;;;;;;;;;;;;;;;;;
                    2560     ;необходимо не портить цифру в следуюем справа знакоместе
                    2561     ;т е сохранить ее в ячейке для мигания в противном случае
                    2562     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2563     ;       знакоместа
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    41

0F74 78B2           2564                                     mov             r0,#marker
0F76 7440           2565                                     mov             a,#bufind
0F78 26             2566                                             add             a,@r0                   ;a=bufind+m
                             arker
0F79 F9             2567                                             mov             r1,a
0F7A 09             2568                                             inc             r1
0F7B 873C           2569                                             mov             savba,@r1
0F7D 020000   F     2570                                     jmp             outF
                    2571     
0F80 78B2           2572     kon_B:          mov             r0,#marker      ;B= +00000
0F82 B60802         2573                                             cjne    @r0,#8,mark0_8          ;курсор справа ?
0F85 80EA           2574                                             jmp             rikn
0F87                2575     mark0_8:
                    2576     ;                               29.12.06
                    2577     ;;;;;;;;;;;;;;;;;;
                    2578     ;необходимо не портить цифру в следуюем справа знакоместе
                    2579     ;т е сохранить ее в ячейке для мигания в противном случае
                    2580     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2581     ;       знакоместа ->B=+00000
0F87 78B2           2582                                             mov             r0,#marker
0F89 7440           2583                                     mov             a,#bufind
0F8B 26             2584                                             add             a,@r0                   ;a=bufind+m
                             arker
0F8C F9             2585                                             mov             r1,a
0F8D 09             2586                                             inc             r1
0F8E 873C           2587                                             mov             savba,@r1
0F90 78B2           2588                             mov             r0,#marker
0F92 06             2589                             inc             @r0             ;       сдвинуть курсор вправо на 1
0F93 C219           2590                             clr             bitmig
0F95 B60901         2591                             cjne    @r0,#9,outma
0F98 18             2592                             dec             r0;ppp
0F99 020000   F     2593     outma:          jmp             outF
                    2594     
0F9C 75B0FE         2595     chanZ:          mov             p3,#0feh
0F9F E5B0           2596                             mov             a,p3
0FA1 20E611         2597                             jb              acc.6,chanma
                    2598                             ;изм знак в старшем разряде на противоположн
0FA4 E543           2599                             mov             a,bufind+3
0FA6 B42B06         2600                             cjne            a,#2bh,noplus
0FA9 75432D         2601                             mov                     bufind+3,#2dh           ;+->-   
0FAC 020000   F     2602                             jmp             outF
0FAF                2603     noplus:
0FAF 75432B         2604                             mov                     bufind+3,#2bh           ;-/+-
0FB2 020000   F     2605                             jmp             outF
0FB5 75B0FD         2606     chanma:         mov             p3,#0fdh
0FB8 E5B0           2607                             mov             a,p3
0FBA 20E603         2608                             jb              acc.6,outFl;labelL1
                    2609                             ;clr            bitmig
0FBD 120000   F     2610     labelL1:        call    vvchibl;f       ;увеличить цифру 
                    2611     
0FC0 020000   F     2612     outFl:                  jmp             outF
                    2613                     
0FC3                2614     nor11:          ;       выход
0FC3 7613           2615                     mov             @r0,#13h  ;12->13
0FC5 900000   F     2616                     mov             dptr,#teOUT
                    2617     ;               jmp             vi1113
                    2618     
                    2619     ;;;;;;;;;кнопка -> в режиме кнопки меню
                    2620     
                    2621     
                    2622     
0FC8 020000   F     2623     rlabelL:        jmp                     labelL
0FCB 020000   F     2624     rfindmem:               jmp             findmem
0FCE 3011FA         2625     noviR:          jnb                     bitmenu,rfindmem;17.01.07
                    2626     ;;;;;;;;;;;;;
0FD1 78B1           2627                                             mov                     r0,#vichR
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    42

0FD3 7415           2628                                             mov                     a,#15h
0FD5 C3             2629                                             clr                     c
0FD6 96             2630                                             subb            a,@r0
0FD7 4016           2631                                             jc                      ri21_23
                    2632     
0FD9 75B0FB         2633                                             mov             p3,#0fbh; реж кн меню ->
0FDC 20B60A         2634                                             jb              p3.6,ri6
0FDF 78B1           2635                                             mov             r0,#vichR
0FE1 B61508         2636                                             cjne    @r0,#15h,norime
0FE4 7611           2637                                             mov             @r0,#11h
0FE6 120000   F     2638     norime1:        call            lomenu
0FE9 020000   F     2639     ri6:                    jmp             out6
0FEC 06             2640     norime:         inc             @r0
0FED 80F7           2641                                             jmp             norime1
                    2642             
0FEF 7423           2643     ri21_23:        mov                     a,#23h          ;->
0FF1 C3             2644                                             clr                     c
0FF2 96             2645                                             subb            a,@r0
0FF3 4014           2646                                             jc                      ri_31
0FF5 75B0FB         2647                                             mov                     p3,#0fbh
0FF8 20B6EE         2648                                             jb                      p3.6,ri6
0FFB B62308         2649                                             cjne            @r0,#23h,no23ri
0FFE 7621           2650                                             mov                     @r0,#21h
1000 120000   F     2651                                             call            lomenu
1003 020000   F     2652                                             jmp                     out6
1006 06             2653     no23ri:         inc                     @r0
1007 80DD           2654                                             jmp                     norime1
1009 B6312B         2655     ri_31:          cjne            @r0,#31h,no31ri;->19.2->57.6->19.2
                    2656     
                    2657     ;;
100C 75B0FB         2658                                             mov                     p3,#0fbh
100F 20B6D7         2659                                             jb                      p3.6,ri6
                    2660     ;;
1012 301311         2661                                             jnb                     bitv19,gosk19
1015 900000   F     2662                                             mov                     dptr,#teS57_6;57,6
1018 120000   F     2663                                             call            lotext
101B 534B03         2664                                             anl                     bufind+11,#03h
101E 434B80         2665                                             orl                     bufind+11,#80h
1021 C213           2666                                             clr                     bitv19
1023 020000   F     2667                                             jmp                     out6
1026 900000   F     2668     gosk19:         mov                     dptr,#teS19_2
1029 120000   F     2669                                             call            lotext
102C 534B03         2670                                             anl                     bufind+11,#03h
102F 434B80         2671                                             orl                     bufind+11,#80h
1032 D213           2672                                             setb            bitv19
1034 020000   F     2673                                             jmp                     out6
                    2674     
                    2675     
                    2676     
                    2677     ;labelS2:       jmp                     out6
                    2678     
1037 7452           2679     no31ri:         mov                     a,#52h;42h              ;->
1039 C3             2680                                             clr                     c
103A 96             2681                                             subb            a,@r0
103B 40AC           2682                                             jc                      ri6
103D 75B0FB         2683                                             mov                     p3,#0fbh                   
                                  ;41,42
1040 30B609         2684                                             jnb                     p3.6,rlabelN    ;кнопка ->(
                             пароль 000)
1043 75B0FD         2685                                             mov                     p3,#0fdh
1046 20B6A0         2686                                             jb                      p3.6,ri6
1049 020000   F     2687                                             jmp             labelL1                            
                                  ;кнопка 0..9  (пароль 000)
104C 020000   F     2688     rlabelN:                jmp             labelN
104F 020000   F     2689     moutF:          jmp             outF
                    2690     ;;;;;;;;;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    43

1052 020000   F     2691     rnnmemb:        jmp             nnmemb
                    2692     
1055                2693     nbimenu:
1055 300BFA         2694     findmem:        jnb             bitmem,rnnmemb
1058 79B0           2695                             mov             r1,#level                                          
                                          ;-> кн ПАМЯТЬ (ОЧИСТКА ->ЗАПИСЬ-> ПРОСМОТР)
105A B71113         2696                        cjne         @r1,#11h,nomem11
                    2697                        
105D 75B0FB         2698                        mov          p3,#0fbh
1060 E5B0           2699                        mov          a,p3
1062 20E6EA         2700                        jb           acc.6,moutF
1065 7712           2701                        mov          @r1,#12h
1067 900000   F     2702                        mov          dptr,#teWR      ;                       ЗАПИСЬ
106A 120000   F     2703                        call         lotext
106D 020000   F     2704                        jmp          outF
                    2705     
1070 B71213         2706     nomem11:   cjne         @r1,#12h,nomem12
1073 75B0FB         2707                             mov             p3,#0fbh
1076 E5B0           2708                        mov          a,p3
1078 20E6D4         2709                        jb           acc.6,moutF
107B 7713           2710                        mov          @r1,#13h
107D 900000   F     2711                        mov          dptr,#teLIST            ;ПРОСМОТР
1080 120000   F     2712                        call         lotext
1083 020000   F     2713                        jmp          outF
1086 B71313         2714     nomem12:         cjne           @r1,#13h,nomem13
1089 75B0FB         2715                                             mov             p3,#0fbh
108C E5B0           2716                        mov          a,p3
108E 20E6BE         2717                        jb           acc.6,moutF
1091 7714           2718                        mov          @r1,#14h
1093 900000   F     2719                        mov          dptr,#teSTAT                    ;СТАТИСТИКА
1096 120000   F     2720                        call         lotext
1099 020000   F     2721                          jmp                outF
                    2722                             
109C B71413         2723     nomem13:cjne            @r1,#14h,labelL
109F 75B0FB         2724                             mov             p3,#0fbh
10A2 E5B0           2725                        mov          a,p3
10A4 20E6A8         2726                        jb           acc.6,moutF
10A7 7711           2727                        mov          @r1,#11h
10A9 900000   F     2728                        mov          dptr,#teCLE                     ;ОЧИСТКА
10AC 120000   F     2729                        call         lotext
10AF 020000   F     2730                          jmp                outF
10B2                2731     labelL: 
                    2732                             ;ПОЛНАЯ->БЛОК 00(level 21->22) 
10B2 78B0           2733                                     mov                     r0,#level
10B4 B6210E         2734                                     cjne            @r0,#21h,nobl21
10B7 7622           2735                                     mov                     @r0,#22h                ;->БЛОК 
10B9 900000   F     2736                                     mov                     dptr,#teBL
10BC 120000   F     2737     me21_22:call            lotext
                    2738                             
10BF 120000   F     2739                                     call            z_05s;задержка чтобы не проскакивала пргр н
                             а следующий уровень
10C2 020000   F     2740                                     jmp                     outF
                    2741     
10C5 B62207         2742     nobl21: cjne            @r0,#22h,nobl22
10C8 900000   F     2743                                     mov                     dptr,#teFULL
10CB 7621           2744                                     mov                     @r0,#21h                ;->ПОЛНАЯ
                    2745     
10CD 80ED           2746                                     jmp                     me21_22
                    2747     
                    2748     ;labl21:           cjne @r0,#21h,nolev1
                    2749     ;                       mov             p3,#0fbh
                    2750     ;                       mov             a,p3
                    2751     ;                       jb              acc.6,loutF
                    2752     ;                       cjne    @r0,#21h,labl22
                    2753     ;                       mov             @r0,#22h
                    2754                             ;БЛОК
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    44

                    2755     ;                       call    lotext
                    2756     ;                       jmp             outF
                    2757     ;labl22:                mov             @r0,#21h
                    2758                             ;ПОЛНАЯ
                    2759     ;                       call    lotext
                    2760     ;                       jmp             outF
                    2761                      
10CF B62325         2762     nobl22:         cjne    @r0,#23h,go31l
10D2 75B0FB         2763     rigblo:         mov             p3,#0fbh
10D5 20B629         2764                                             jb              p3.6,llev2
10D8                2765     labL2:    ;  уст курсор в правую позицию 
                    2766                                     ;       кнопка                  ->
                    2767     ;;;;;;;;;;;;;;;;;;
                    2768     ;необходимо не портить цифру в следуюем справа знакоместе
                    2769     ;т е сохранить ее в ячейке для мигания в противном случае
                    2770     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2771     ;       знакоместа
10D8 78B2           2772                                             mov             r0,#marker
10DA 7440           2773                                     mov             a,#bufind
10DC 26             2774                                             add             a,@r0                   ;a=bufind+m
                             arker
10DD F9             2775                                             mov             r1,a
10DE 09             2776                                             inc             r1
10DF 873C           2777                                             mov             savba,@r1
10E1 C219           2778                                             clr             bitmig
                    2779     ;;;;;;;;;;;;;;;;
10E3 78B2           2780                       mov           r0,#marker      ;курсор справа  ?
10E5 E53B           2781                             mov             a,movrig
10E7 C3             2782                             clr             c
10E8 96             2783                             subb    a,@r0
10E9 6006           2784                             jz         equ1l
10EB E53B           2785                             mov             a,movrig;уст в правую позицию
10ED F6             2786                             mov             @r0,a
10EE 020000   F     2787                             jmp             outF                                     
10F1 E53A           2788     equ1l:          mov             a,movleft;уст в левую позицию
10F3 F6             2789                             mov             @r0,a   
10F4 020000   F     2790     loutF:  jmp             outF
                    2791                     
                    2792     
10F7 B63102         2793     go31l:          cjne    @r0,#31h,go41l
10FA 80D6           2794                             jmp             rigblo
10FC B6410B         2795     go41l:          cjne    @r0,#41h,norig2
10FF 80D1           2796                             jmp             rigblo
                    2797     
1101 75B0FD         2798     llev2:          mov             p3,#0fdh
1104 20B6ED         2799                             jb              p3.6,loutF
1107 020000   F     2800                             jmp             labelL1
                    2801     
                    2802     ;->
110A C3             2803     norig2:    clr          c               ;32,33,34,42
110B 7431           2804                             mov             a,#31h
110D 96             2805                             subb    a,@r0
110E 50E4           2806                             jnc             loutF
1110 75B0FB         2807     rigblok:        mov             p3,#0fbh  ;32,33,34,42
1113 20B626         2808                             jb              p3.6,lev2go
1116                2809     labelN: 
                    2810                             ;                               29.12.06
                    2811     ;;;;;;;;;;;;;;;;;;
                    2812     ;необходимо не портить цифру в следуюем справа знакоместе
                    2813     ;т е сохранить ее в ячейке для мигания в противном случае
                    2814     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2815     ;       знакоместа
1116 78B2           2816                                             mov             r0,#marker
1118 7440           2817                                     mov             a,#bufind
111A 26             2818                                             add             a,@r0                   ;a=bufind+m
                             arker
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    45

111B F9             2819                                             mov             r1,a
111C 09             2820                                             inc             r1
111D 873C           2821                                             mov             savba,@r1
                    2822     ;;;;;;;;;;;;;;;;;;;
111F 78B2           2823                             mov             r0,#marker      ;курсор справа  ?
1121 E53B           2824                             mov             a,movrig
1123 C3             2825                             clr             c
1124 96             2826                             subb    a,@r0
1125 7006           2827                             jnz        noequ1
1127 E53A           2828                             mov             a,movleft;уст в крайнюю левую позицию
1129 F6             2829                             mov             @r0,a
112A 020000   F     2830                             jmp             outF
112D                2831     noequ1: ;29.12.06
                    2832     ;;;;;;;;;;;;;;;;;;
                    2833                             ;восстан знакоместо при мигании
                    2834                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
112D 78B2           2835                                     mov             r0,#marker
112F 7440           2836                                     mov             a,#bufind
1131 26             2837                                     add             a,@r0                   ;a=bufind+marker
1132 F9             2838                                     mov             r1,a
                    2839                                     ;mov            @r1,savba
1133 09             2840                                     inc             r1
1134 873C           2841                                     mov             savba,@r1
                    2842     ;;;;;;;;;;;;;;;;        
1136 120000   F     2843                             call    marri;уст сдвиг в правую        позицию
1139 020000   F     2844                             jmp             outF
113C 75B0FD         2845     lev2go:         mov             p3,#0fdh
113F 30B603         2846                             jnb             p3.6,rlabelL1
1142 020000   F     2847                             jmp             outF
                    2848     
1145 020000   F     2849     rlabelL1:       jmp             labelL1
                    2850     
1148                2851     nnmemb:
                    2852                                     
                    2853     
                    2854     
1148                2855     norim6:    ;kn menu
1148 D083           2856     out6:           pop             dph
114A D082           2857                                     pop             dpl
114C D007           2858                                     pop             rr7     
114E D006           2859                                     pop             rr6
1150 D005           2860                                     pop             rr5
1152 D004           2861                                     pop             rr4
1154 D003           2862                                     pop             rr3
1156 D002           2863                                     pop             rr2
1158 D001           2864                                     pop             rr1                             
115A D000           2865                                     pop             rr0
115C D0D0           2866                                     pop             psw
115E D0E0           2867                                     pop             acc
                    2868     ;clr            bitmig
                    2869                               ; mov         EIE2,#30H
                    2870                              ;  mov         a,P3IF
                    2871                             ;       anl             a,#0bfh
                    2872                             ;       mov             P3IF,a
                    2873                             ;       mov             P3,#0c0h
                    2874                             ;;;;;;
1160 75AD00         2875                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1163 75B0C0         2876                             mov             P3,#0c0h
1166 C219           2877                             clr             bitmig
1168 E586           2878                                             mov             a,P6            ;p6.4=0
116A 54EF           2879                             anl             a,#0efh
116C F586           2880                             mov             P6,a
116E 00             2881                             nop
116F 00             2882                             nop
                    2883                                     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    46

1170 E586           2884                             mov             a,P6                    ;p6.4=1 
1172 4410           2885                             orl             a,#10h
1174 F586           2886                             mov             P6,a                        
1176 32             2887                             reti
                    2888     
1177 020000   F     2889     rknMEM:                 jmp             knMEM
117A 020000   F     2890     knKMP:             jmp          out7
117D 020000   F     2891     rout7:                  jmp             out7    
1180 020000   F     2892     rlabelH:                jmp             labelH
1183 020000   F     2893     rknNUL:         jmp             knNUL
1186 020000   F     2894     rknleft:                jmp             knleft
1189                2895     keyb2:  ;IE7
1189 75E700         2896                                     mov             EIE2,#00H
118C 75AD00         2897                                     mov             P3IF,#00
                    2898     
118F C0E0           2899                                     push    acc
1191 C0D0           2900                                     push    psw
1193 C000           2901                                     push    rr0
1195 C001           2902                                     push    rr1
1197 C002           2903                                     push    rr2
1199 C003           2904                                     push    rr3
119B C004           2905                                     push    rr4
119D C005           2906                                     push    rr5
119F C006           2907                                     push    rr6
11A1 C007           2908                                     push    rr7
11A3 C082           2909                                     push    dpl
11A5 C083           2910                                     push    dph
                    2911                                     ;clr            bitmig
                    2912                       ;;;;;;;;;;;;;;
11A7 120000   F     2913                               call  z_01s   ;0,1s
                    2914                               ;восстан знакоместо при мигании
                    2915                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
11AA 78B2           2916                                     mov             r0,#marker
11AC 7440           2917                                     mov             a,#bufind
11AE 26             2918                                     add             a,@r0                   ;a=bufind+marker
11AF F9             2919                                     mov             r1,a
11B0 A73C           2920                                     mov             @r1,savba
                    2921                                     ;;;;;;;;;;;
                    2922     
11B2 E5B0           2923                             mov             a,p3
11B4 20E7C6         2924                                     jb              acc.7,rout7
11B7 E5B0           2925                                     mov             a,p3
11B9 74FF           2926                                     mov             a,#0ffh         ; p3.(5-0)<-3f
11BB F5B0           2927                                     mov             p3,a
11BD E5B0           2928                                     mov             a,p3
11BF 30E7BB         2929                                     jnb             acc.7,rout7             ;error
11C2 3004BB         2930                                     jnb             bitizm,rlabelH
11C5 75B0FE         2931                                     mov             p3,#0feh                ;реж IZM
11C8 E5B0           2932                                     mov             a,p3
11CA 30E7B6         2933                                     jnb             acc.7,rknNUL
11CD 75B0FD         2934                                     mov             p3,#0fdh
11D0 E5B0           2935                                     mov             a,p3
11D2 30E7A5         2936                                     jnb             acc.7,knKMP
11D5 75B0FB         2937                                     mov             p3,#0fbh
11D8 E5B0           2938                                     mov             a,p3
11DA 30E7A9         2939                                     jnb             acc.7,rknleft
11DD 75B0F7         2940                                     mov             p3,#0f7h
11E0 E5B0           2941                                     mov             a,p3
11E2 30E76F         2942                                     jnb             acc.7,knAVP
11E5 75B0EF         2943                                 mov         p3,#0efh
11E8 E5B0           2944                                     mov             a,p3
11EA 30E78A         2945                                     jnb             acc.7,rknMEM
11ED 75B0DF         2946                                     mov             p3,#0dfh
11F0 E5B0           2947                                     mov             a,p3    
11F2 30E722         2948                                     jnb             acc.7,knmenu
11F5                2949     an_t7:             ;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    47

                    2950                     
                    2951     ;       clr             c
                    2952     ;       mov             r1,#parN
                    2953     ;
                    2954     ;                       mov             r0,#diap
                    2955     ;                       mov             a,#6            
                    2956     ;                       subb    a,@r0
                    2957     ;                       jnc             goto7           ;         ;10-2..10-8
                    2958                               
                    2959     ;                       mov             @r1,#2          ;10-9..10-11            
                    2960                             
                    2961                             ;;;;;;;;;;;;
11F5 799A           2962     goto7:                  mov             r1,#parT
11F7 783D           2963                                     mov             r0,#chkl
11F9 B70108         2964                                     cjne    @r1,#1,not1_7
11FC 7600           2965                                     mov             @r0,#00
11FE 08             2966                                     inc             r0
11FF 7602           2967                                     mov             @r0,#2
1201 020000   F     2968                                     jmp             out7
                    2969                             
                    2970     
1204 B70208         2971     not1_7:                 cjne    @r1,#2,not2_7
1207 760E           2972                                             mov             @r0,#0eh;00
1209 08             2973                                     inc             r0
120A 7638           2974                                     mov             @r0,#38h;20
120C 020000   F     2975                                     jmp             out7
120F 7600           2976     not2_7:                 mov             @r0,#00
1211 08             2977                                     inc             r0
1212 76C8           2978                                     mov             @r0,#200
1214 020000   F     2979     merr:           jmp             out7
                    2980     
                    2981     
1217 2006FA         2982     knmenu: jb              bitvi11,merr
121A 20151C         2983                                     jb              biteizm,menuoff
                    2984                                     ;;;;;
121D 201225         2985                                     jb              bitklb,klboff
1220 C204           2986                              clr            bitizm          ;off IZM
1222 D211           2987                                     setb            bitmenu
1224 C217           2988                                     clr             bitoll
1226 900000   F     2989                                     mov             dptr,#teTESI    ;в буф2 записать ТЕСТ-ИЗМЕР
1229 120000   F     2990                                     call    lotext
122C 534B03         2991                                     anl                     bufind+11,#03h ;погасить запятые
122F 120000   F     2992                                     call            ind
1232 78B1           2993                                     mov             r0,#vichR
1234 7611           2994                                     mov             @r0,#11h
1236 020000   F     2995                                     jmp             onmem11
1239                2996     menuoff:
1239 78B1           2997                                     mov             r0,#vichR
123B 7600           2998                                     mov             @r0,#00
123D C215           2999                                     clr             biteizm
123F 120000   F     3000                                     call    loadus
1242 020000   F     3001                                     jmp             out7
                    3002     
1245 C212           3003     klboff:                 clr             bitklb
1247 120000   F     3004                                                     call            loadUS
124A 78B1           3005                                                     mov             r0,#vichR
124C 7600           3006                                                     mov             @r0,#00
124E 020000   F     3007                                                     jmp             out7
                    3008     
1251 020000   F     3009     rendkalib:              jmp             endkalib
                    3010     
1254 2012FA         3011     knAVP:  jb              bitklb,rendkalib        
1257 200505         3012                                     jb              bitavp,meavp
125A D205           3013                                     setb    bitavp
125C 020000   F     3014                                     jmp             onmem11
125F C205           3015     meavp:                  clr             bitavp
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    48

1261 020000   F     3016                                     jmp             onmem11
                    3017     
1264 201207         3018     knleft: jb              bitklb,lefkl
                    3019                                     ;;;;;;;;
1267 79AE           3020                                mov          r1,#diap
1269 07             3021                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
126A B70A03         3022                                     cjne    @r1,#0ah,nodi6
126D 17             3023                                     dec             @r1
126E 8085           3024     lefkl:  jmp             an_t7
                    3025     
1270                3026     nodi6:             ;    cjne    @r1,#0,an_t7
1270 120000   F     3027                                      call    clmassix
1273 78B3           3028                                     mov             r0,#summa
1275 120000   F     3029                                     call    clear4  
1278 786A           3030                                     mov             r0,#rez_A0
127A 120000   F     3031                                     call    clear4
127D C20F           3032                                     clr             bitnul          ;гасить светодиод НУЛЬ  
127F 120000   F     3033                                     call    loadUS
1282 020000   F     3034                                jmp          an_t7
                    3035     
1285 200F0F         3036     knNUL:                  jb              bitnul,ybnul
1288 D20F           3037                                     setb    bitnul
128A 789C           3038                                     mov             r0,#rez_A3      ;A3
128C 120000   F     3039                                     call    resar2
128F 786A           3040                                     mov             r0,#rez_A0      
1291 120000   F     3041                                     call    saver2;A0<-A3
1294 020000   F     3042                                     jmp             goto7;an_t7
                    3043     
1297 C20F           3044     ybnul:                  clr             bitnul
1299 900000   F     3045                                      mov    DPTR,#ch0 
129C 120000   F     3046                                     CALL   ldc_long          ; r2..r5 <-- 0
129F 786A           3047                                     mov             r0,#rez_A0      ;A0=0
12A1 120000   F     3048                                     call    saver2
12A4 020000   F     3049                                     jmp             goto7;an_t7
                    3050     
12A7 301021         3051     labelH:                 jnb             bitt2,nolah
12AA 75B0FB         3052                                     mov             p3,#0fbh   ;вход в режим изм Т
12AD 534A8F         3053                                     anl             bufind+10,#8fh
12B0 79B7           3054                                     mov             r1,#load;parT
12B2 20B70D         3055                                     jb              p3.7,rhnot1
12B5 B70003         3056                                     cjne    @r1,#0,inct;
12B8 020000   F     3057                                     jmp             out7;hyest6
12BB 17             3058     inct:                   dec             @r1                     ;Tизм+1
                    3059                             
12BC 120000   F     3060                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
12BF                3061     hnot2:          ;       call    ind
12BF 020000   F     3062                                     jmp             out7
                    3063     
12C2 020000   F     3064      rhnot1:                jmp             hnot1
                    3065      ;rnoviR:       jmp             noviR
12C5 020000   F     3066      rlabelK:       jmp             labelK
12C8 020000   F     3067      rlabelI:       jmp             labelI          
                    3068      ;;;;;;;;;;;;;;;;;;;
12CB 3014F7         3069     nolah:          jnb             bitvich,rlabelK 
                    3070                                     
                    3071                             ;;;;;;
                    3072                             ;увеличить счетчик задержки клавиатуры
                    3073                     ;;              mov             r0,#chkl
                    3074                     ;;              mov             @r0,#27h
                    3075                     ;;              inc             r0
                    3076                     ;;              mov             @r0,#10h
                    3077                             ;;;;;;
                    3078     
12CE 78B1           3079                             mov             r0,#vichR
12D0 B61128         3080                             cjne    @r0,#11h,rhnor11;rlabelI;;
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    49

12D3 75B0FB         3081                             mov             p3,#0fbh   ;<-
12D6 20B730         3082                             jb              p3.7,noh37;routF
12D9 B6110B         3083                     cjne    @r0,#11h,hr12
12DC 7613           3084                             mov             @r0,#13h        ;11= вычислить
12DE 900000   F     3085                             mov             dptr,#teOUT;teVICH
12E1 120000   F     3086     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
12E4 020000   F     3087                             jmp             goto7;outF
12E7 B61207         3088     hr12:           cjne    @r0,#12h,hnor12
12EA 7611           3089     lovich:         mov             @r0,#11h
12EC 900000   F     3090                             mov             dptr,#teVICH
12EF 80F0           3091                             jmp             hvi1113         
12F1 B61307         3092     hnor12:         cjne    @r0,#13h,rhnor11
12F4 7612           3093     loizmk:         mov             @r0,#12h
12F6 900000   F     3094                             mov             dptr,#teIZMK    ;       изм конст
                    3095                                        
12F9 80E6           3096                             jmp             hvi1113
                    3097     
12FB 804C           3098     rhnor11:                jmp             hnor11
                    3099     
12FD 8057           3100     rvvizko:                jmp             vvizko
12FF C214           3101     vioutF:                 clr             bitvich
1301 C206           3102                                                     clr             bitvi11
1303 020000   F     3103                                                     jmp             outF
1306 020000   F     3104     toutF:                  jmp     outF
                    3105     
1309 75B0F7         3106     noh37:          mov             p3,#0f7h
130C 20B7F7         3107                             jb              p3.7,toutF;vioutF
130F B611EB         3108                             cjne    @r0,#11h,rvvizko
1312 D206           3109                             setb    bitvi11    ;нажат ввод ВЫЧИСЛИТЬ
1314 D204           3110              setb   bitizm
1316 534B07         3111                              anl            bufind+11,#07h
1319 434B10         3112                              orl            bufind+11,#10h;точка после 1 знакоместа
131C 020000   F     3113     routF:          jmp             out7;goto7;outF
                    3114     
                    3115     
                    3116     
131F 80E8           3117     rnoh37:         jmp             noh37
                    3118     
1321 B6120D         3119     norr11:         cjne    @r0,#12h,norr12
1324 75B0FB         3120                             mov             p3,#0fbh   ;<-
1327 20B7F5         3121                             jb              p3.7,rnoh37;routF
132A 760B           3122                             mov             @r0,#11;12->11
132C 80BC           3123                             jmp             lovich
                    3124     
132E 020000   F     3125     labelI2:                jmp             labelI
1331 B613FA         3126     norr12:         cjne    @r0,#13h,labelI2
1334 75B0FB         3127                             mov             p3,#0fbh   ;<-
1337 20B7E5         3128                             jb              p3.7,rnoh37
133A 7612           3129                             mov             @r0,#12h
133C 80B6           3130                             jmp             loizmk
                    3131                             ;;;;
133E C214           3132     clrvich:                clr             bitvich
1340 D204           3133                             setb    bitizm
1342 A8B2           3134                             mov             r0,marker
1344 76FF           3135                             mov             @r0,#0ffh
1346 020000   F     3136                              jmp    goto7;  routF
                    3137     
                    3138     ;rnoh37:                jmp             noh37
                    3139      ;ввод изм конст
1349 B612E5         3140     hnor11:         cjne    @r0,#12h,norr12;clrvich
134C 75B0FB         3141                              mov            p3,#0fbh   
134F 20B7CD         3142                             jb              p3.7,rnoh37;lovich;;изм конст <-  выч
1352 7611           3143                             mov             @r0,#11h
1354 8094           3144                             jmp             lovich
                    3145     
1356 78B1           3146     vvizko:         mov             r0,#vichR
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    50

1358 E6             3147                             mov             a,@r0
                    3148                     ;       cjne    @r0,#12h,clrvich
1359 B412E2         3149                             cjne    a,#12h,clrvich
135C 7621           3150                             mov             @r0,#21h                ;изм конст->U=+0000     (vv
                             od)
135E 78B2           3151                             mov             r0,#marker
1360 7604           3152                             mov             @r0,#4;9
1362 753A04         3153                             mov             movleft,#4
1365 753B07         3154                             mov             movrig,#7
1368 900000   F     3155                             mov             dptr,#teAequ0
136B 120000   F     3156                             call    lotext
                    3157                             
136E 120000   F     3158                             call    outA
1371 534B0F         3159                             anl                     bufind+11,#0fh
                    3160             ;       mov             a,bufind+11
                    3161             ;       anl             a,#0f0h
                    3162             ;       mov             bufind+11,a
1374 434B40         3163                             orl             bufind+11,#40h;бит точки после 7 знакоместа(a=000.0
                              v)
                    3164                             
1377 020000   F     3165                             jmp             goto7;routF
                    3166     ;hnor13:                jmp             hnor12          
137A B6210C         3167     izchi:          cjne    @r0,#21h,tlabelI
                    3168     ;<- при вводе цифр А                            
                    3169                     ;        mov            p3,#0fbh   
                    3170                     ;       jnb             p3.7,li21
                    3171             ;clr            bitmig
137D 78B2           3172                             mov             r0,#marker
137F 16             3173                             dec             @r0
1380 B60201         3174                             cjne    @r0,#2,li21
1383 06             3175                             inc             @r0;marker=3 +/-
1384 C219           3176     li21:           clr             bitmig
1386 020000   F     3177                             jmp             goto7;outF
                    3178     
1389 020000   F     3179     tlabelI:        jmp             labelI
                    3180     
                    3181     ;                       load    0 1 2 3 4 5             
138C 06050403       3182     sootv:          db              6,5,4,3,2,1;parT
1390 0201                    
                    3183     ;
                    3184     
                    3185     ;нажата кн ввод при наборе Т
1392 75B0F7         3186     hnot1:                  mov             p3,#0f7h
1395 20B784         3187                                     jb              p3.7,routF;out7
1398 B70549         3188                                     cjne    @r1,#5,nohnot1  ;r1=load
139B 794A           3189                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
139D E7             3190                                     mov             a,@r1
139E 548F           3191                                     anl             a,#8fh
13A0 4440           3192                                     orl             a,#40h;.6
13A2 F7             3193                                     mov             @r1,a
13A3 8000           3194                                     jmp             loadb
                    3195                                     
                    3196                                     
13A5 789A           3197     loadB:                  mov             r0,#parT
13A7 900000   F     3198                                     mov             dptr,#sootv
13AA 79B7           3199                                     mov             r1,#load                
13AC E7             3200                                     mov             a,@r1;load
13AD 93             3201                                     movc    a,@a+dptr
13AE F6             3202                                     mov             @r0,a
13AF 120000   F     3203                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    3204                                      ;r4=b1 r5=b2
13B2 120000   F     3205                                     call    iniacp;инициализация АЦП
13B5 120000   F     3206                                     call    loadUS
13B8 120000   F     3207                                     call    clmassix        
13BB D204           3208                                     setb    bitizm
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    51

13BD C210           3209                                     clr             bitt2
                    3210     
13BF 534A8F         3211                                     anl             bufind+10,#8fh
13C2 C3             3212                                      clr            c
13C3 789A           3213                                  mov                r0,#parT
13C5 79AF           3214                                      mov            r1,#parN
13C7 7402           3215                                  mov                a,#2
13C9 96             3216                                 subb                a,@r0
13CA 5005           3217                                 jnc                 loadB2
13CC 7701           3218                                     mov             @r1,#1;N=1         ;T>=2
13CE 020000   F     3219     bout7:                  jmp             goto7;out7
                    3220     
13D1 B702FA         3221     loadB2:                 cjne    @r1,#2,bout7
13D4 7702           3222                                     mov             @r1,#2;N=2
13D6 020000   F     3223                                     jmp             goto7;out7
13D9                3224     nohnot2:                ;в буфере 1 зажечь <=0,1s
13D9 794A           3225                                     mov             r1,#bufind+10
13DB E7             3226                                     mov             a,@r1
13DC 4410           3227                                     orl             a,#10h;.4
13DE F7             3228                                     mov             @r1,a
13DF 120000   F     3229                                     call            ind
13E2 80C1           3230                                     jmp             loadB
13E4 B704F2         3231     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
13E7 794A           3232                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
13E9 E7             3233                                     mov             a,@r1
13EA 4420           3234                                     orl             a,#20h;.5
13EC F7             3235                                     mov             @r1,a
13ED 80B6           3236                                     jmp             loadB
                    3237     
                    3238     ;кнопка ПАМЯТЬ
13EF C204           3239     knMEM:                  clr             bitizm          ;off IZM
13F1 900000   F     3240                                     mov             dptr,#teLIST;CLE
13F4 120000   F     3241                                     call    lotext    ;в буф2 записать ОЧИСТКА
13F7 D20B           3242                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
13F9 534BEF         3243                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
13FC 434B01         3244                                     orl             bufind+11,#01;зажечь светодиод память
13FF 120000   F     3245                                     call            ind
1402 78B0           3246                                     mov             r0,#level
1404 7613           3247                                     mov             @r0,#13h;11h
1406 783D           3248     onmem11:                mov             r0,#chkl
1408 7603           3249                                     mov             @r0,#03
140A 08             3250                                     inc             r0
140B 76E8           3251                                     mov             @r0,#0e8h               ;1000
140D 020000   F     3252                                     jmp             out7;goto7;out7
                    3253     
1410 020000   F     3254     rnomemk:                jmp             nomemk          ;
                    3255     
1413 78B0           3256     outkmem:        mov                     r0,#level
1415 7600           3257                                             mov                     @r0,#0
1417 78B1           3258                                             mov                     r0,#vichR
1419 7600           3259                                             mov                     @r0,#0
141B C20B           3260                                             clr                     bitmem
141D C214           3261                                             clr                     bitvich
141F C206           3262                                             clr                     bitvi11
1421 C211           3263                                             clr                     bitmenu
1423 D204           3264                                             setb            bitizm
1425 78B2           3265                                             mov                     r0,#marker
1427 76FF           3266                                             mov                     @r0,#0ffh
1429 020000   F     3267                                             jmp                     vvod2_10
142C 020000   F     3268                                             jmp                     goto7   
142F                3269     labelK:
                    3270     
                    3271     ;;;;;;;;;;;;
142F 300BDE         3272                               jnb           bitmem,rnomemk          ;кн память (ввод и <-)
1432 75B0EF         3273                                     mov                     p3,#0efh
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    52

1435 30B7DB         3274                                     jnb                     p3.7,outkmem            ;отжатие кн
                              память на любом уровне обработки памяти
1438 78B0           3275                                      mov            r0,#level
143A B6114E         3276                               cjne          @r0,#11h,klev1;nome11
143D 75B0FB         3277     lefmem11:         mov           p3,#0fbh
1440 E5B0           3278                               mov           a,p3
1442 20E70E         3279                               jb            acc.7,rkvvod0
1445 B6110E         3280                               cjne          @r0,#11h,locle          ;<-memory
1448 7614           3281                               mov           @r0,#14h
144A 900000   F     3282     lolist:           mov           dptr,#teSTAT
144D 120000   F     3283                               call          lotext           ;СТАТИСТИКА
1450 020000   F     3284                               jmp   goto7;  outF
                    3285     
1453 020000   F     3286     rkvvod0:        jmp             kvvod0
                    3287     
                    3288     
1456 B6120B         3289     locle:          cjne            @r0,#12h,lowr           ;<-memory
1459 7611           3290                               mov           @r0,#11h                   ;ОЧИСТКА
145B 900000   F     3291     loadcle:          mov           dptr,#teCLE
145E 120000   F     3292                               call          lotext
1461 020000   F     3293                               jmp           goto7;outF
                    3294     
1464 B6130B         3295     lowr:                   cjne    @r0,#13h,lostat
1467 7612           3296                                             mov             @r0,#12h
1469 900000   F     3297      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
146C 120000   F     3298                             call    lotext
146F 020000   F     3299                             jmp             goto7;outF
                    3300     
1472 7613           3301     lostat:         mov             @r0,#13h
1474 900000   F     3302                                     mov             dptr,#teLIST              ;ПРОСМОТР
1477 120000   F     3303                             call    lotext
147A 020000   F     3304                             jmp             goto7;outF
                    3305     
147D B6141A         3306     me_14:cjne              @r0,#14h,klev22
1480 7613           3307                                             mov             @r0,#13h
1482 900000   F     3308                             mov             dptr,#teLIST              ;;ПРОСМОТР
1485 120000   F     3309                             call    lotext
1488 020000   F     3310                             jmp             goto7
148B B61202         3311      klev1:          cjne   @r0,#12h,klev2
148E 80AD           3312                             jmp             lefmem11
1490 B61302         3313     klev2:           cjne   @r0,#13h,klev3;11-14   klev22     ;11-13 нет
1493 80A8           3314                             jmp             lefmem11
1495 B61402         3315     klev3:           cjne   @r0,#14h,klev22;
1498 80A3           3316                             jmp             lefmem11
                    3317     ;<- vvod на более низких уровнях
149A B62117         3318     klev22:         cjne    @r0,#21h,klev21
149D 75B0FB         3319     lev220:         mov             p3,#0fbh
14A0 20B77B         3320                             jb              p3.7,kgo23
14A3 B6210B         3321                             cjne    @r0,#21h,kfullr
14A6 7622           3322                             mov             @r0,#22h
14A8 900000   F     3323                             mov             dptr,#teBL
14AB 120000   F     3324                             call    lotext
14AE 020000   F     3325                             jmp             goto7;outF
14B1 020000   F     3326     kfullr:         jmp             kfull                           
14B4 B6220E         3327     klev21:         cjne    @r0,#22h,klev23
14B7 80E4           3328                             jmp             lev220
                    3329     
14B9 020000   F     3330     rlabL2:         jmp             labL2
14BC 020000   F     3331     rlabM:          jmp             labM
14BF 020000   F     3332     ques:                   jmp             out7
14C2 020000   F     3333     ddoutfr:        jmp             ddoutf
                    3334     
14C5 B623F4         3335     klev23:          cjne   @r0,#23h,rlabM
14C8 75B0FB         3336                              mov    p3,#0fbh
14CB 30B7F1         3337                              jnb            p3.7,ques;errr labL2
14CE 75B0F7         3338                              mov    p3,#0f7h
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    53

14D1 20B7EE         3339                              jb             p3.7,ddoutfr
                    3340                                             ;       считать с индикатора  
14D4 C3             3341                                     clr                     c
14D5 E547           3342                                mov          a,bufind+7      
14D7 9430           3343                                      subb           a,#30h
14D9 B40002         3344                                      cjne           a,#0,chaibl
14DC 7401           3345                                      mov            a,#1                    ;номера блоков 1..4
14DE                3346     chaibl:         
14DE F538           3347                                             mov             nblok,a
                    3348                                
                    3349                              ;очистить блок памяти с набранным номером
                    3350                              ;150h..1000h( 150h+nblok*320h)
14E0 120000   F     3351                                     call            adrblok         ;dptr-
                    3352     
14E3 79B8           3353                                     mov                     r1,#work                ;обьем блок
                             а
14E5 7703           3354                                     mov                     @r1,#03
14E7 09             3355                                     inc                     r1
14E8 7720           3356                                     mov                     @r1,#20h                        ;32
                             0h
                    3357     
14EA                3358     goonoff:
14EA E4             3359                                     clr                     a
14EB F0             3360                                     movx            @dptr,a
14EC A3             3361                                     inc                     dptr
                    3362     
14ED 79B9           3363                                     mov                     r1,#work+1
14EF 120000   F     3364                                     call            chminus
14F2 78B8           3365                                     mov             r0,#work
14F4 E6             3366                             mov             a,@r0
14F5 30E7F2         3367                             jnb             acc.7,goonoff
                    3368     
14F8 C20B           3369                              clr    bitmem  ;сбр признак памяти 
14FA D204           3370                              setb   bitizm
                    3371                             ;после очистки блока сохраняем в saven_bl 
                    3372                             ;адрес второго с конца измерения потому
                    3373                             ;добавляем 8;;
14FC 120000   F     3374                             call            adrblok;dptr-начало блока
14FF E582           3375                             mov                     a,dpl
1501 2408           3376                             add                     a,#8
1503 F582           3377                             mov                     dpl,a
1505 E583           3378                             mov                     a,dph
1507 3400           3379                             addc            a,#0
1509 F583           3380                             mov                     dph,a
150B 120000   F     3381                             call            save_hl;подготовка записи в начало блока
                    3382                             ;;;;;
                    3383     
150E 78B2           3384                              mov            r0,#marker
1510 76FF           3385                              mov            @r0,#0ffh
1512 020000   F     3386                                     jmp                     vvod2_10
1515 020000   F     3387                              jmp    goto7
                    3388     
1518 020000   F     3389     rddoutf:        jmp             ddoutf
151B 020000   F     3390     rgo23no:        jmp             go23no
                    3391     
                    3392     ;vvod   БЛОК->БЛОК 00           
151E 75B0F7         3393     kgo23:           mov    p3,#0f7h
1521 20B7F4         3394                             jb              p3.7,rddoutf
1524 B621F4         3395                             cjne    @r0,#21h,rgo23no
                    3396                             ;очистить память 150..dd0h
                    3397                             ;1й блок
1527 900150         3398                              mov                    dptr,#150h
152A 79B8           3399                                     mov                     r1,#work                ;обьем блок
                             а
152C 7703           3400                                     mov                     @r1,#03
152E 09             3401                                     inc                     r1
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    54

152F 7720           3402                                     mov                     @r1,#20h                        ;32
                             0h
                    3403     
1531                3404     gooff1:
1531 E4             3405                                     clr                     a
1532 F0             3406                                     movx            @dptr,a
1533 A3             3407                                     inc                     dptr
                    3408     
1534 79B9           3409                                     mov                     r1,#work+1
1536 120000   F     3410                                     call            chminus
1539 78B8           3411                                     mov             r0,#work
153B E6             3412                             mov             a,@r0
153C 30E7F2         3413                             jnb             acc.7,gooff1
153F 900158         3414                             mov                     dptr,#158h;начало 1 го блока
                    3415                             ;после очистки блока сохраняем в saven_bl 
                    3416                             ;адрес второго с конца измерения потому
                    3417                             ;добавляем 8;;
1542 120000   F     3418                             call            save_hl;подготовка записи в начало блока
                    3419     ;2й блок
1545 900470         3420                             mov                     dptr,#470h
1548 79B8           3421                                     mov                     r1,#work                ;обьем блок
                             а
154A 7703           3422                                     mov                     @r1,#03
154C 09             3423                                     inc                     r1
154D 7720           3424                                     mov                     @r1,#20h                        ;32
                             0h
                    3425     
154F                3426     gooff2:
154F E4             3427                                     clr                     a
1550 F0             3428                                     movx            @dptr,a
1551 A3             3429                                     inc                     dptr
                    3430     
1552 79B9           3431                                     mov                     r1,#work+1
1554 120000   F     3432                                     call            chminus
1557 78B8           3433                                     mov             r0,#work
1559 E6             3434                             mov             a,@r0
155A 30E7F2         3435                             jnb             acc.7,gooff2
155D 900478         3436                             mov                     dptr,#478h;начало 2 го блока
1560 120000   F     3437                             call            save_hl;подготовка записи в начало блока
                    3438     ;3й блок
1563 900790         3439                             mov                     dptr,#790h
1566 79B8           3440                                     mov                     r1,#work                ;обьем блок
                             а
1568 7703           3441                                     mov                     @r1,#03
156A 09             3442                                     inc                     r1
156B 7720           3443                                     mov                     @r1,#20h                        ;32
                             0h
                    3444     
156D                3445     gooff3:
156D E4             3446                                     clr                     a
156E F0             3447                                     movx            @dptr,a
156F A3             3448                                     inc                     dptr
                    3449     
1570 79B9           3450                                     mov                     r1,#work+1
1572 120000   F     3451                                     call            chminus
1575 78B8           3452                                     mov             r0,#work
1577 E6             3453                             mov             a,@r0
1578 30E7F2         3454                             jnb             acc.7,gooff3
157B 900798         3455                             mov                     dptr,#798h;начало 3 го блока
                    3456                                     ;после очистки блока сохраняем в saven_bl 
                    3457                             ;адрес второго с конца измерения потому
                    3458                             ;добавляем 8;;
157E 120000   F     3459                             call            save_hl;подготовка записи в начало блока
                    3460     ;4й блок
1581 900AB0         3461     mov                     dptr,#0ab0h
1584 79B8           3462                                     mov                     r1,#work                ;обьем блок
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    55

                             а
1586 7703           3463                                     mov                     @r1,#03h
1588 09             3464                                     inc                     r1
1589 7720           3465                                     mov                     @r1,#20h                        ;32
                             0h
                    3466     
158B                3467     gooff4:
158B E4             3468                                     clr                     a
158C F0             3469                                     movx            @dptr,a
158D A3             3470                                     inc                     dptr
                    3471     
158E 79B9           3472                                     mov                     r1,#work+1
1590 120000   F     3473                                     call            chminus
1593 78B8           3474                                     mov             r0,#work
1595 E6             3475                             mov             a,@r0
1596 30E7F2         3476                             jnb             acc.7,gooff4
1599 900AB8         3477                             mov                     dptr,#0ab8h;начало 4 го блока
                    3478                             ;после очистки блока сохраняем в saven_bl 
                    3479                             ;адрес второго с конца измерения потому
                    3480                             ;добавляем 8;;
159C 120000   F     3481                             call            save_hl;подготовка записи в начало блока
159F C20B           3482                             clr             bitmem
15A1 D204           3483                             setb    bitizm
15A3 78B2           3484                                     mov             r0,#marker
15A5 76FF           3485                              mov            @r0,#0ffh
15A7 020000   F     3486                             jmp                     vvod2_10;jmp            goto7
                    3487     
15AA 7623           3488     go23no:    mov          @r0,#23h
15AC 753B08         3489                                             mov                     movrig,#8
15AF 753A07         3490                                             mov             movleft,#7
15B2 8055           3491                             jmp             loblok;БЛОК 00
                    3492     
15B4 7621           3493     kfull:          mov             @r0,#21h
15B6 8025           3494                             jmp             gofull
                    3495                             
                    3496                                             
15B8                3497     nomemk:                         
15B8 020000   F     3498                                     jmp             labelS                  ;нажат ввод меню
                    3499                             
15BB 75B0FB         3500     nome11:           mov           p3,#0fbh
15BE E5B0           3501                               mov           a,p3
15C0 20E70D         3502                               jb            acc.7,kvvod0
15C3 B61205         3503                               cjne          @r0,#12h,mem12no        
15C6 7611           3504                               mov           @r0,#11h                ;ОЧИСТКА
15C8 020000   F     3505                               jmp            loadcle
                    3506     
15CB                3507     mem12no:        ;cjne           @r0,#13h,lowr           
15CB 7612           3508                               mov           @r0,#12h                   ;
15CD 020000   F     3509                               jmp           lowr1                     ;ЗАПИСЬ
                    3510     
15D0 75B0F7         3511     kvvod0:           mov           p3,#0f7h                        ;knopka vvod
15D3 20B70F         3512                               jb            p3.7,ddoutf
15D6 78B0           3513                               mov           r0,#level
15D8 B61129         3514                               cjne          @r0,#11h,mvv11
15DB 7621           3515                               mov           @r0,#21h                ;ПОЛНАЯ
15DD 900000   F     3516     gofull:           mov           dptr,#teFULL
15E0 120000   F     3517                               call          lotext
15E3 804F           3518                                     jmp             mlabL2  ;<-????????/
                    3519     
15E5                3520     ddoutf:         ;<- БЛОК 00(ОЧИСТКА)
                    3521     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3522     ;т е сохранить ее в ячейке для мигания в противном случае
                    3523     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3524     ;       знакоместа
15E5 78B2           3525                                                     mov             r0,#marker
15E7 7440           3526                                     mov             a,#bufind
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    56

15E9 26             3527                                             add             a,@r0                   ;a=bufind+m
                             arker
15EA F9             3528                                             mov             r1,a
15EB 19             3529                                             dec             r1      ;       inc             r1
15EC 873C           3530                                             mov             savba,@r1
15EE C219           3531                                             clr             bitmig
                    3532     ;;;;;;;;;;;;;;;;
15F0 78B2           3533                       mov           r0,#marker      ;курсор слева   ?
15F2 E53A           3534                             mov             a,movleft
15F4 C3             3535                             clr             c
15F5 96             3536                             subb    a,@r0
15F6 7006           3537                             jnz        left21
15F8 E53B           3538                             mov             a,movrig;уст в правую позицию
15FA F6             3539                             mov             @r0,a
                    3540     
15FB 020000   F     3541                             jmp             goto7                                            
15FE E53A           3542     left21:         mov             a,movleft;уст в левую позицию
1600 F6             3543                             mov             @r0,a   
1601 020000   F     3544                             jmp             goto7
                    3545     
                    3546     
1604 B61215         3547     mvv11:            cjne          @r0,#12h,mvv12
1607 7631           3548                                     mov             @r0,#31h
1609 900000   F     3549     loblok:                 mov             dptr,#teBL0;БЛОК 0
160C 120000   F     3550                                     call    lotext
160F E538           3551                                     mov                     a,nblok
1611 2430           3552                                     add                     a,#30h
1613 F547           3553                                     mov                     bufind+7,a
1615 78B2           3554                                     mov             r0,#marker
1617 7607           3555                                     mov             @r0,#7
                    3556                                     ;mov            movrig,#9
                    3557                                     ;mov            movleft,#6
1619 020000   F     3558                                     jmp             goto7;outF
161C B61411         3559     mvv12:  cjne            @r0,#14h,bl_li
161F 7661           3560                                     mov                     @r0,#61h
1621 900000   F     3561                                     mov             dptr,#teMIN;
1624 120000   F     3562                                     call    lotext
1627 120000   F     3563                                     call    vichmin
162A 120000   F     3564                                     call    z_1s
162D 020000   F     3565                                     jmp             out7;goto7;outF
                    3566     
1630 7641           3567     bl_li:          mov             @r0,#41h                ; БЛОК 00(ЗАПИСЬ И ПРОСМОТР)
1632 80D5           3568                                     jmp             loblok
                    3569     
                    3570     
                    3571     
1634                3572     mlabL2:         ;jmp            labL2
                    3573                                             ;  уст курсор в правую позицию 
                    3574                                     ;                               29.12.06
                    3575     ;;;;;;;;;;;;;;;;;;
                    3576     ;необходимо не портить цифру в следуюем справа знакоместе
                    3577     ;т е сохранить ее в ячейке для мигания в противном случае
                    3578     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3579     ;       знакоместа
1634 78B2           3580                                             mov             r0,#marker
1636 7440           3581                                     mov             a,#bufind
1638 26             3582                                             add             a,@r0                   ;a=bufind+m
                             arker
1639 F9             3583                                             mov             r1,a
163A 09             3584                                             inc             r1
163B 873C           3585                                             mov             savba,@r1
                    3586     ;;;;;;;;;;;;;;;;
163D 78B2           3587                       mov           r0,#marker      ;курсор справа  ?
163F E53B           3588                             mov             a,movrig
1641 C3             3589                             clr             c
1642 96             3590                             subb    a,@r0
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    57

1643 6006           3591                             jz         equ2l
1645 E53B           3592                             mov             a,movrig;уст в правую позицию
1647 F6             3593                             mov             @r0,a
                    3594     ;                       lool
1648 020000   F     3595                             jmp             goto7                                            
164B E53A           3596     equ2l:          mov             a,movleft;уст в левую позицию
164D F6             3597                             mov             @r0,a   
164E 020000   F     3598                             jmp             goto7
                    3599                     
1651 020000   F     3600     rnom31:         jmp                     nom31
1654 B631FA         3601     labM:                   cjne    @r0,#31h,rnom31
1657 75B0FB         3602                                     mov             p3,#0fbh
165A 30B7D7         3603                                     jnb             p3.7,mlabL2
165D 75B0F7         3604                                mov          p3,#0f7h
1660 20B782         3605                                jb           p3.7,ddoutf
                    3606                                
1663 7632           3607                                mov          @r0,#32h                        ;ИНТ 0000
                    3608                                     ;       считать с индикатора  
1665 C3             3609     blokvv:         clr                     c
1666 E547           3610                                mov          a,bufind+7      
1668 9430           3611                                      subb           a,#30h
166A B40002         3612                                      cjne           a,#0,blokvvc
166D 7401           3613                                      mov            a,#1                    ;номера блоков 1..4
                    3614     
166F F538           3615     blokvvc: mov            nblok,a
1671 900000   F     3616                                mov          dptr,#teINT;ИНТ 0000c
1674 120000   F     3617                                call         lotext
1677 78CE           3618                                      mov            r0,#interva+1
1679 7952           3619                                      mov            r1,#abin+3
167B E6             3620                                      mov            a,@r0
167C F7             3621                                      mov            @r1,a
167D 18             3622                                             dec                     r0
167E 19             3623                                             dec                     r1
167F E6             3624                                             mov             a,@r0
1680 F7             3625                                             mov             @r1,a
1681 19             3626                                             dec             r1
1682 E4             3627                                             clr             a
1683 F7             3628                                             mov             @r1,a
1684 19             3629                                             dec             r1
1685 F7             3630                                             mov             @r1,a
                    3631                                                                             
1686 7853           3632                                             mov             r0,#adec
1688 7952           3633                                             mov             r1,#abin+3      ;hex->10
168A 120000   F     3634                                             call    bindec
                    3635                                     
168D 785C           3636                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
168F 7948           3637                                             mov             r1,#bufind+8
1691 7F04           3638                                             mov             r7,#4
1693 E6             3639     bloin:                          mov             a,@r0
1694 2430           3640                                             add             a,#30h
1696 F7             3641                                             mov             @r1,a
1697 19             3642                                             dec             r1
1698 18             3643                                             dec             r0
1699 DFF8           3644                                             djnz    r7,bloin
169B 78B2           3645                                mov          r0,#marker
169D 7605           3646                                mov          @r0,#5
169F 753B08         3647                                mov          movrig,#8
16A2 753A05         3648                                mov          movleft,#5
16A5 789A           3649                                      mov            r0,#parT
16A7 B60609         3650                                     cjne            @r0,#6,innot6
16AA 534BF0         3651                                     anl                     bufind+11,#0f0h;after 5- 0.000c
16AD 434B04         3652                                     orl                     bufind+11,#04h
                    3653                             
16B0 020000   F     3654                                     jmp                     goto7
16B3 B60309         3655     innot6: cjne            @r0,#3,innot3
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    58

16B6 534BF0         3656                                     anl                     bufind+11,#0f0h;after 7- 000.0c
16B9 434B20         3657                                     orl                     bufind+11,#20h
                    3658                                     ;call           ind
16BC 020000   F     3659                                     jmp                     out7;goto7
16BF C3             3660     innot3: clr                     c
16C0 7403           3661                                     mov                     a,#3
16C2 96             3662                                     subb            a,@r0
16C3 5009           3663                                     jnc                     innot1_2
16C5 534BF0         3664                                     anl                     bufind+11,#0f0h;after 6- 00.00c
16C8 434B40         3665                                     orl                     bufind+11,#40h
                    3666                                     
16CB 020000   F     3667                                     jmp                     goto7
                    3668     
16CE                3669     innot1_2:
16CE 534B0F         3670                                     anl                     bufind+11,#0fh;0h;0000c
16D1 C219           3671                                     clr                     bitmig
                    3672                                     ;call           ind             нет необходимости пришет пр
                             обел         
16D3 020000   F     3673     rgoto7: jmp        goto7;outF
                    3674     
16D6 B63276         3675     nom31:             cjne         @r0,#32h,nom32
16D9 75B0FB         3676                                     mov             p3,#0fbh
16DC 20B71F         3677                                     jb              p3.7,vvinte             ;ввод интервал;no31
                             n
                    3678                                     
16DF                3679     lefcur:         ;;кн <- 32 нач блок 000
                    3680     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3681     ;т е сохранить ее в ячейке для мигания в противном случае
                    3682     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3683     ;       знакоместа
16DF C219           3684                                                     clr             bitmig
16E1 78B2           3685                                                     mov             r0,#marker;нажата кн <- при
                              вводе цифр нач блок 000
16E3 7440           3686                                     mov             a,#bufind
16E5 26             3687                                             add             a,@r0                   ;a=bufind+m
                             arker
16E6 F9             3688                                             mov             r1,a
16E7 19             3689                                             dec             r1;;;;;;;;;;;
16E8 873C           3690                                             mov             savba,@r1
                    3691                                             
16EA 78B2           3692                                                     mov             r0,#marker      ;курсор сле
                             ва?
16EC E53A           3693                             mov             a,movleft
16EE C3             3694                             clr             c
16EF 96             3695                             subb    a,@r0
16F0 7006           3696                             jnz        noequ2
16F2 E53B           3697                             mov             a,movrig
16F4 F6             3698                             mov             @r0,a;уст в крайнюю правую позицию
16F5 020000   F     3699                             jmp             goto7
16F8 120000   F     3700     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
16FB 020000   F     3701                             jmp        goto7        
                    3702                                                                       
                    3703     
                    3704     ;;;;;;;;;;;;;;;;;;
16FE                3705     vvinte:         ;ввод интервал                          
16FE 75B0F7         3706     no31n:             mov          p3,#0f7h
1701 20B7CF         3707                                     jb              p3.7,rgoto7
1704 7633           3708                                     mov             @r0,#33h
                    3709                                     ;считать с индикатора введенный интервал
1706 7F0A           3710                                             mov             r7,#10
1708 7853           3711                                     mov             r0,#adec
170A 120000   F     3712                                     call    clearN
170D 120000   F     3713                                     call    upak4                   
1710 784F           3714                                     mov             r0,#abin
1712 7953           3715                                     mov             r1,#adec                        ;мл        
                              ст
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    59

1714 120000   F     3716                                     call    decbin                  ;abin..abin+3 (hex)
1717 794F           3717                                     mov             r1,#abin
1719 78CE           3718                                     mov             r0,#interva+1
171B E7             3719                                     mov             a,@r1
171C F6             3720                                     mov             @r0,a
171D 18             3721                                     dec             r0
171E 09             3722                                     inc             r1
171F E7             3723                                     mov             a,@r1
1720 F6             3724                                     mov             @r0,a
                    3725                                     
1721 78D5           3726                                     mov             r0,#volume                      ;объем блок
                             а
1723 7600           3727                                     mov             @r0,#0
1725 08             3728                                     inc             r0
1726 76C7           3729                                     mov             @r0,#0c7h
1728 120000   F     3730                                     call            adrblok;dptr
172B 120000   F     3731                                     call            save_hl;1я ячейка блока
172E 78B2           3732                                mov          r0,#marker
1730 76FF           3733                                mov          @r0,#0ffh
1732 D204           3734                                      setb           bitizm
1734 C20B           3735                                      clr            bitmem
1736 789A           3736     vvod2_10: mov           r0,#parT
1738 B6050C         3737                                      cjne           @r0,#5,no10msv
173B 900000   F     3738                                             mov                     dptr,#te10ms
173E 120000   F     3739     t2msme:         call            lotext
                    3740                                             
1741 120000   F     3741                                             call            ind
1744 020000   F     3742     no2msv:   jmp      goto7;
1747 B606FA         3743     no10msv:        cjne            @r0,#6,no2msv   
174A 900000   F     3744                                             mov                     dptr,#te2ms
174D 80EF           3745                                     jmp                     t2msme
                    3746     
                    3747     
                    3748     
174F B6332B         3749     nom32:           cjne           @r0,#33h,nom33
1752 75B0FB         3750                              mov            p3,#0fbh
1755 30B787         3751                              jnb            p3.7,lefcur
1758 75B0F7         3752                              mov            p3,#0f7h
175B 20B7E6         3753                              jb             p3.7,no2msv;rgoto7
                    3754                              ;запомнить номер ячейки конца блока
175E 7634           3755                              mov    @r0,#34h
1760 7F0A           3756     INTn:                   mov             r7,#10
1762 7853           3757                                     mov             r0,#adec
1764 120000   F     3758                                     call    clearN
1767 120000   F     3759                                     call    upak3                   
176A 784F           3760                                     mov             r0,#abin
176C 7953           3761                                     mov             r1,#adec                        ;мл        
                              ст
176E 120000   F     3762                                     call    decbin                  ;abin..abin+3 (hex)
1771 120000   F     3763                                     call    loadr2                  ;r2..r5
1774 120402         3764                                     call    altof                   ;r2..r5->int
1777 020000   F     3765     dgoto7:                  jmp            goto7
                    3766     
177A 020000   F     3767     rlefcur:                jmp             lefcur
                    3768     
177D B63464         3769     nom33:          cjne            @r0,#34h,labelP
1780 75B0FB         3770                               mov           p3,#0fbh
1783 30B7F4         3771                              jnb            p3.7,rlefcur
1786 75B0F7         3772                              mov            p3,#0f7h
1789 20B7EB         3773                              jb             p3.7,dgoto7
178C 7635           3774                              mov            @r0,#35h
178E 78B2           3775                              mov            r0,#marker
1790 76FF           3776                              mov            @r0,#0ffh
                    3777                              ;T1<-число на индикаторе
                    3778                                               ;vvod КОН БЛ 000
1792 78CF           3779                              mov            r0,#chbuf               ;счетчик периода загрузки в
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    60

                              буфер и интерфейс
1794 7630           3780                              mov            @r0,#30h  
1796 C20B           3781                              clr            bitmem
1798 D204           3782                              setb           bitizm;;;;      
179A 020000   F     3783                             jmp        goto7
179D 020000   F     3784     vodm11_15:                      jmp             vvodm11_15
17A0 020000   F     3785     me11_15de:                      jmp             me11_15dec
17A3 020000   F     3786     moutkmem:                               jmp             outkmem
                    3787     
17A6 020000   F     3788     nmem_menu:              jmp             out7                    ;нажата память в режиме мен
                             ю
                    3789     ;обработка кнопки меню ввод
17A9 301138         3790     labelS:         jnb                     bitmenu,labelP
17AC 75B0EF         3791                                             mov                     p3,#0efh
17AF 30B7F4         3792                                             jnb                     p3.7,nmem_menu
17B2 75B0DF         3793                                             mov                     p3,#0dfh
17B5 30B7EB         3794                                             jnb                     p3.7,moutkmem
17B8 78B1           3795                                             mov                     r0,#vichR
17BA 7415           3796                                             mov                     a,#15h
17BC C3             3797                                             clr                     c
17BD 96             3798                                             subb            a,@r0
17BE 4021           3799                                             jc                      rme21_23
                    3800                             
17C0 75B0FB         3801                                             mov                     p3,#0fbh
17C3 20B7D7         3802                                             jb                      p3.7,vodm11_15
17C6 78B1           3803                                             mov                     r0,#vichR
17C8 B611D5         3804                                             cjne                    @r0,#11h,me11_15de;<-
17CB 7615           3805                                             mov                     @r0,#15h
17CD 900000   F     3806                                             mov                     dptr,#teKALIB
17D0 120000   F     3807                                             call            lotext
17D3 020000   F     3808                                             jmp                     onmem11
17D6 C211           3809     menuon:         clr             bitmenu                 ;off menu
17D8 D204           3810                                             setb    bitizm
                    3811     
17DA 78B1           3812                                     mov             r0,#vichR
17DC 7600           3813                                     mov             @r0,#0
17DE 020000   F     3814                                     jmp             onmem11
                    3815     
                    3816                                             ;;;;;
                    3817             
17E1 020000   F     3818     rme21_23:               jmp             me21_23 
                    3819                             
                    3820     ;режим просмотра
17E4 B64130         3821     labelP:                 cjne            @r0,#41h,govvlist
17E7 7642           3822                                                     mov                     @r0,#42h
                    3823                                                     ;       считать с индикатора  
17E9 C3             3824                                             clr                     c
17EA E547           3825                                mov          a,bufind+7      
17EC 9430           3826                                      subb           a,#30h
17EE B40002         3827                                      cjne           a,#0,chaipr
17F1 7401           3828                                      mov            a,#1
17F3 F538           3829     chaipr:                          mov            nblok,a
17F5 900000   F     3830                                mov          dptr,#teCH;ОТСЧЕТ 000
17F8 120000   F     3831                                call         lotext
17FB 534BEF         3832                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
17FE 78B2           3833                                mov          r0,#marker
1800 7607           3834                                mov          @r0,#7
1802 753B09         3835                                mov          movrig,#9
1805 753A07         3836                                mov          movleft,#7
1808 120000   F     3837                                             call            z_1s
180B 020000   F     3838                        jmp     goto7;outF
180E 020000   F     3839     label43:                jmp             label7
                    3840     
1811 020000   F     3841     rlist_43:                       jmp                     list_43                            
                                  
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    61

1814 020000   F     3842     mlabL2r:                        jmp                     mlabL2
1817 B642F7         3843     govvlist:                       cjne            @r0,#42h,rlist_43
181A 75B0FB         3844                                                                     mov                     p3,
                             #0fbh
181D 30B7F4         3845                                                             jnb                     p3.7,mlabL2
                             r;кн <- ОТСЧЕТ 000
1820 75B0F7         3846                                                             mov                     p3,#0f7h
1823 20B7E8         3847                                                             jb                      p3.7,label4
                             3
1826 7643           3848                                                             mov                     @r0,#43h;vv
                             od 
1828 78B2           3849                                                             mov                     r0,#marker
182A 76FF           3850                                                             mov                     @r0,#0ffh
182C 7F0A           3851                                                                     mov             r7,#10
182E 7853           3852                                     mov             r0,#adec
1830 120000   F     3853                                     call    clearN
1833 120000   F     3854                                     call    upak3                   
1836 784F           3855                                     mov             r0,#abin
1838 7953           3856                                     mov             r1,#adec                        ;мл        
                              ст
183A 120000   F     3857                                     call    decbin                  ;abin..abin+3 (hex)
183D 120000   F     3858                                     call    loadr2                  ;r2..r5
1840 ED             3859                                     mov             a,r5                            ;сохр номер
                              лемента
1841 F537           3860                                     mov             nelem,a
1843 120402         3861                                     call    altof                   ;r2..r5->int
1846 900000   F     3862                                     mov             dptr,#ch_1;
1849 120000   F     3863                                     call    ldc_ltemp                       ;r8..r11
184C 1201D1         3864                                     call    flsub
184F 900000   F     3865                                     mov             dptr,#ch_4;
1852 120000   F     3866                                     call    ldc_ltemp                       ;r8..r11
1855 120203         3867                                     call    flmul                           ;(n(номер отсчета)-
                             1)*4+адр нач блока
1858 120343         3868                                     call            ftol                    ;r2..r5->hex
185B C002           3869                                     push            rr2
185D C003           3870                                     push            rr3
185F C004           3871                                     push            rr4
1861 C005           3872                                     push            rr5
1863 120000   F     3873                                     call            adrblok;dptr-
1866 D005           3874                                     pop                     rr5
1868 D004           3875                                     pop                     rr4
186A D003           3876                                     pop                     rr3
186C D002           3877                                     pop                     rr2
186E 79D8           3878                                     mov                     r1,#copy_hl+1;saven_bl+1;сохр адрес
                              внешн озу введенного лемента
1870 E582           3879                                     mov                     a,dpl
1872 2D             3880                                     add                     a,r5
1873 F582           3881                                     mov                     dpl,a
1875 F7             3882                                     mov                     @r1,a           ;low
1876 E583           3883                                     mov                     a,dph
1878 3C             3884                                     addc            a,r4
1879 F583           3885                                     mov                     dph,a
187B 19             3886                                     dec                     r1
187C F7             3887                                     mov                     @r1,a                   ;high
                    3888                             
187D                3889     li42_43:
187D 120000   F     3890                                     call            reA3_X          ;r2..r5/выдать рез из внешн
                              пам на индикатор
1880 900000   F     3891                                     mov             dptr,#ch10;
1883 120000   F     3892                                     call    ldc_ltemp
1886 120000   F     3893                                     call    zdiv    
                    3894                                     ;;;;;;;;;;;
1889 120000   F     3895                                     call    maform
                    3896                                     ;;;;
                    3897     
                    3898                                     ;;;;;;;
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    62

188C 784F           3899                                             mov             r0,#abin
188E 120000   F     3900                                             call    saver2
1891 7853           3901                                             mov             r0,#adec
1893 7952           3902                                             mov             r1,#abin+3      ;hex->10
1895 120000   F     3903                                             call    bindec
                    3904                                     
1898 785C           3905                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
189A 7945           3906                                             mov             r1,#bufind+5
189C 7F07           3907                                             mov             r7,#7
189E E6             3908     ch43:                           mov             a,@r0
189F 2430           3909                                             add             a,#30h
18A1 F7             3910                                             mov             @r1,a
18A2 19             3911                                             dec             r1
18A3 18             3912                                             dec             r0
18A4 DFF8           3913                                             djnz    r7,ch43
18A6 7847           3914                                             mov             r0,#bufind+7
18A8 762D           3915                                             mov             @r0,#2dh          ;-2..-9
18AA 7840           3916                                             mov             r0,#bufind
18AC 762B           3917                                             mov             @r0,#2bh
18AE 300202         3918                                             jnb             znmat,nozzmi43;bitznak,nozzmi
18B1 762D           3919                                             mov             @r0,#2dh
18B3 E538           3920     nozzmi43:       mov             a,nblok
18B5 B40104         3921                                             cjne    a,#1,nozzmi1            
18B8 7934           3922                                             mov             r1,#sadiap;diap
18BA 8010           3923                                             jmp             nozzbl
18BC B40204         3924     nozzmi1:        cjne    a,#2,nozzmi2            
18BF 7932           3925                                             mov             r1,#sadiap2;diap
18C1 8009           3926                                             jmp             nozzbl
18C3 B40304         3927     nozzmi2:        cjne    a,#3,nozzmi3            
18C6 7931           3928                                             mov             r1,#sadiap3;diap
18C8 8002           3929                                             jmp             nozzbl
18CA 7930           3930     nozzmi3:        mov             r1,#sadiap4;diap
                    3931                                     
18CC 7848           3932     nozzbl:         mov             r0,#bufind+8
18CE E7             3933                                             mov             a,@r1
18CF B40808         3934                                             cjne    a,#8,nodi8_43
18D2 7630           3935                                             mov             @r0,#30h                 ;10-10
18D4 18             3936                                             dec             r0
18D5 7663           3937                                             mov             @r0,#63h;31h
18D7 08             3938                                             inc             r0
18D8 800E           3939                                             jmp             see_l43
18DA B40908         3940     nodi8_43:       cjne    a,#9,nodi9_43
                    3941                                     
18DD 7631           3942                                             mov             @r0,#31h           ;10-11
18DF 18             3943                                             dec             r0
18E0 7663           3944                                             mov             @r0,#63h;31h
                    3945                                     
18E2 08             3946                                             inc             r0
18E3 8003           3947                                             jmp             see_l43
18E5 2432           3948     nodi9_43:               add             a,#32h
18E7 F6             3949                                             mov             @r0,a;
18E8 08             3950     see_l43:                        inc             r0
18E9 7641           3951                                             mov             @r0,#"A";"E";
                    3952                             ;       inc             r0
                    3953                             ;       mov             @r0,#00h ;=feh в нач установе для поджига в
                             сех сегм
                    3954                             ;       inc             r0;             mov             bufind+11
                    3955                             ;       mov             @r0,#0d0h               ;bufind+11.4 точка 
                             после первой цифры
18EB 434B10         3956                             orl                     bufind+11,#10h
18EE 120000   F     3957     out43:          call            ind
18F1 120000   F     3958                                             call            z_1s
18F4 020000   F     3959                                             jmp             out7                               
                                  
                    3960     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    63

                    3961                                     ;;;;;;;;        
18F7 783D           3962     label7: mov             r0,#chkl
18F9 7604           3963                                     mov             @r0,#04;3
18FB 08             3964                                     inc             r0
18FC 76E8           3965                                     mov             @r0,#0e8h               ;1000
18FE 020000   F     3966                                     jmp             out7;
1901 B64351         3967     list_43:                cjne    @r0,#43h,noli_43
1904 75B0FB         3968                                                     mov             p3,#0fbh                ;43
                             h <-
1907 20B70A         3969                                                     jb              p3.7,vvod43             ;vv
                             od
190A C20B           3970                                                     clr             bitmem
190C D204           3971                                                     setb    bitizm
190E 78B2           3972                                                     mov             r0,#marker
1910 76FF           3973                                                     mov             @r0,#0ffh
1912 80E3           3974                                                     jmp             label7;по кн <- выход из пр
                             осмотра
                    3975     
1914 7644           3976     vvod43:                 mov             @r0,#44h
1916 E537           3977                                                     mov             a,nelem;вывод порядкового н
                             омера в блоке 
1918 04             3978                                                     inc             a
1919 F552           3979                                                     mov             abin+3,a
                    3980                                                     
191B F537           3981                                                     mov             nelem,a
191D E4             3982                                                     clr             a
191E F551           3983                                                     mov             abin+2,a
1920 F550           3984                                                     mov             abin+1,a
1922 F54F           3985                                                     mov             abin,a
                    3986                                             
1924 7853           3987                                             mov             r0,#adec
1926 7952           3988                                             mov             r1,#abin+3      ;hex->10
1928 120000   F     3989                                             call    bindec
192B 7840           3990                                             mov             r0,#bufind;почистить индикатор
192D 7F0A           3991                                             mov             r7,#10
192F 7420           3992                                             mov             a,#20h
1931 F6             3993     cle20:          mov             @r0,a
1932 08             3994                                             inc             r0
1933 DFFC           3995                                             djnz    r7,cle20
                    3996                                             ;;;;;;
1935 900000   F     3997                                             mov             dptr,#teCH;ОТСЧЕТ 000
1938 120000   F     3998                                call         lotext
193B 534BEF         3999                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
193E 785C           4000                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1940 7949           4001                                             mov             r1,#bufind+9
1942 7F03           4002                                             mov             r7,#3
1944 E6             4003     ch43_42:                                mov             a,@r0
1945 2430           4004                                             add             a,#30h
1947 F7             4005                                             mov             @r1,a
1948 19             4006                                             dec             r1
1949 18             4007                                             dec             r0
194A DFF8           4008                                             djnz    r7,ch43_42
194C 120000   F     4009                                             call            ind
194F 120000   F     4010                                             call            z_1s
1952 020000   F     4011                                             jmp             out7
1955 B64419         4012     noli_43:        cjne            @r0,#44h,vvosta
1958 7643           4013                                             mov                     @r0,#43h
195A 79D8           4014                                                     mov                     r1,#copy_hl+1;saven
                             _bl+1
195C E7             4015                                                     mov                     a,@r1
195D F582           4016                                                     mov                     dpl,a
195F 19             4017                                                     dec                     r1
1960 E7             4018                                                     mov                     a,@r1;high
1961 F583           4019                                                     mov                     dph,a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    64

1963 A3             4020                                                     inc                     dptr
1964 A3             4021                                                     inc                     dptr
1965 A3             4022                                                     inc                     dptr
1966 A3             4023                                                     inc                     dptr
1967 E583           4024                                                     mov                     a,dph
1969 F7             4025                                                     mov                     @r1,a
196A 09             4026                                                     inc                     r1
196B E582           4027                                                     mov                     a,dpl
196D F7             4028                                                     mov                     @r1,a              
                                          ;сохр адр внешн озу
196E 020000   F     4029                                             jmp                     li42_43;вывод значения след
                             ующего в блоке
                    4030     
1971 B66111         4031     vvosta:                 cjne            @r0,#61h,vvostad
1974 7662           4032                                                     mov                     @r0,#62h
1976 900000   F     4033                                                     mov                     dptr,#teMAX;
1979 120000   F     4034                                                     call            lotext
197C 120000   F     4035                                                     call            vichmax
197F 120000   F     4036                                                     call            z_05s;z_1s
1982 020000   F     4037                                                     jmp             goto7
                    4038     
1985 B66211         4039     vvostad:                cjne            @r0,#62h,rousta
1988 7663           4040                                                     mov                     @r0,#63h
198A 900000   F     4041                                                     mov             dptr,#teMid;
198D 120000   F     4042                                                     call    lotext
1990 120000   F     4043                                                     call            vichmean
1993 120000   F     4044                                                     call            z_05s
1996 020000   F     4045                                                     jmp             goto7
                    4046     
1999 B6630E         4047     rousta:                 cjne            @r0,#63h,rousta1
199C 7661           4048                                                     mov                     @r0,#61h
199E 900000   F     4049                                                     mov             dptr,#teMin;
19A1 120000   F     4050                                                     call    lotext
19A4 120000   F     4051                                                     call            vichmin
19A7 120000   F     4052                                                     call            z_05s
19AA 020000   F     4053     rousta1:                jmp             goto7
                    4054     
19AD 020000   F     4055     rLABELP:                jmp                     LABELP
19B0 78B1           4056     vvodm11_15:     mov                     r0,#vichR;vvod
19B2 75B0F7         4057                                                     mov                     p3,#0f7h
19B5 20B7F5         4058                                             jb                      p3.7,rLABELP;????
                    4059                                     
                    4060     
19B8 B61115         4061                                             cjne                    @r0,#11h,tome21
19BB 7621           4062                                             mov                     @r0,#21h;vvod
19BD 900000   F     4063                                             mov                     dptr,#teTE11
19C0 120000   F     4064                                             call            lotext
19C3 534B03         4065                                             anl                     bufind+11,#03h ;погасить за
                             пятые
19C6 020000   F     4066                                             jmp                     onmem11
                    4067     
19C9 16             4068     me11_15dec:             dec             @r0                             ;<-
19CA 120000   F     4069     lokame1:        call            lomenu
19CD 020000   F     4070                                             jmp                     onmem11
                    4071     
19D0 B61206         4072     tome21:         cjne                    @r0,#12h,tome13
                    4073                                             ;вкл тест интерфейса
19D3 020000   F     4074                                             jmp             testrs;??????????
19D6 020000   F     4075                                             jmp                     onmem11
                    4076     
19D9 B6132A         4077     tome13:         cjne                    @r0,#13h,tome14
19DC 7631           4078                                             mov                     @r0,#31h
                    4079                                             
19DE 7A50           4080                                             mov                     r2,#50h                    
                                  ;57.6->19.2
19E0 7B2C           4081                                             mov                     r3,#2ch
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    65

19E2 120454         4082                                             call            re4byte                 ;28..2bh 3b
                             ait-parol,1 bait skor
19E5 E508           4083                                             mov                     a,r8
19E7 B4000E         4084                                             cjne            a,#00,skor19
19EA 900000   F     4085                                             mov                     dptr,#teS57_6;57,6
19ED 120000   F     4086                                             call            lotext
19F0 434B80         4087                                     orl                     bufind+11,#80h
19F3 C213           4088                                             clr                     bitv19
                    4089     
19F5 020000   F     4090                                             jmp             onmem11
19F8 900000   F     4091     skor19:         mov                     dptr,#teS19_2
19FB 120000   F     4092                                             call            lotext
19FE D213           4093                                             setb            bitv19
1A00 434B80         4094                                             orl                     bufind+11,#80h
1A03 020000   F     4095                                             jmp                     onmem11
                    4096                                             
                    4097     
1A06 B61415         4098     tome14:         cjne                    @r0,#14h,tome15
1A09 D204           4099                                             setb            bitizm
1A0B 7881           4100                                             mov                     r0,#chavt
1A0D 7600           4101                                             mov                     @r0,#0
1A0F 08             4102                                             inc                     r0
1A10 7600           4103                                             mov                     @r0,#0
1A12 C211           4104     outmenu:        clr                     bitmenu
1A14 020000   F     4105                                             jmp                     out7
                    4106     
1A17 78B1           4107     goparom:        mov             r0,#vichR               ;режим меню 52
1A19 7652           4108                                             mov                     @r0,#52h                   
                                  ;пароль уже ввели
1A1B 020000   F     4109                                             jmp                     goparol
1A1E 2016F6         4110     tome15:         jb              bitpar,goparom  
1A21 7651           4111                                             mov                     @r0,#51h;ПАРОЛЬ 000
1A23 120000   F     4112                                             call            lomenu
1A26 78B2           4113                                             mov                     r0,#marker
1A28 7607           4114                                             mov                     @r0,#7
1A2A 753B09         4115                                             mov                     movrig,#9
1A2D 753A07         4116                                             mov                     movleft,#7
                    4117                                             ;setb           bitizm
1A30 020000   F     4118                                             jmp                     onmem11
                    4119     
                    4120     
1A33 78B1           4121     me21_23:        mov                     r0,#vichR               ;<-
1A35 7423           4122                                             mov                     a,#23h
1A37 C3             4123                                             clr                     c
1A38 96             4124                                             subb            a,@r0
1A39 403D           4125                                             jc                      labelS1
1A3B 75B0FB         4126                                             mov                     p3,#0fbh
1A3E 20B718         4127                                             jb                      p3.7,vv21_23
1A41 B6210B         4128                                             cjne            @r0,#21h,me21_23dec;-<
1A44 7623           4129                                             mov                     @r0,#23h
1A46 900000   F     4130                                             mov                     dptr,#teTE7
1A49 120000   F     4131                                             call            lotext
1A4C 020000   F     4132                                             jmp                     onmem11
1A4F                4133     me21_23dec:     
1A4F 16             4134                                             dec                     @r0
1A50 120000   F     4135                                             call            lomenu
1A53 020000   F     4136                                             jmp                     onmem11
1A56 020000   F     4137     onmem12:        jmp             outF    ;(ie7)                          
                    4138                                                     
1A59 75B0F7         4139     vv21_23:        mov             p3,#0f7h                ;vvod
1A5C 20B7F7         4140                                             jb              p3.7,onmem12
1A5F B6210C         4141                                             cjne            @r0,#21h,test22
                    4142                                             ;mov                    dptr,#tabt11;заслать ус 11А
1A62 120000   F     4143     tests:          call            lotpus
1A65 D215           4144                                             setb            biteizm;запомнить режим ТИ
1A67 D204           4145                                             setb            bitizm
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    66

1A69 C211           4146                                             clr                     bitmenu;обнулить т к не буд
                             ет индикации измерения       
1A6B 020000   F     4147                                             jmp                     onmem11
1A6E B62202         4148     test22:         cjne            @r0,#22h,test23
                    4149                                     ;       mov                     dptr,#tabt9;заслать ус 9А
1A71 80EF           4150                                             jmp             tests   
1A73                4151     test23:
                    4152                                     ;       mov                     dptr,#tabt7;заслать ус 7А
1A73 80ED           4153                                             jmp             tests   
1A75 020000   F     4154     left_s:         jmp                     left_sk
1A78 B63175         4155     labelS1:        cjne            @r0,#31h,me_41
1A7B 75B0FB         4156                                             mov                     p3,#0fbh                   
                                  ;<-
1A7E 30B7F4         4157                                             jnb                     p3.7,left_s
1A81 75B0F7         4158                                             mov                     p3,#0f7h
1A84 20B7CF         4159                                             jb                      p3.7,onmem12
                    4160                                             ;запомнить признак установленной скорости в рпзу
                    4161     
                    4162     ;чтение пам прогр(5000h) 1 страница(ffh)
                    4163     ;и запись во внешнее озу(0000h)
1A87 7900           4164                                             mov             r1,#0                   ;
1A89 7A50           4165                                     mov             r2,#50h
1A8B 7B00           4166                                     mov             r3,#00
1A8D 120499         4167                                     call    copyPP
                    4168                                     ;внести изменения во внешн озу
                    4169                                     ;KD=00 01 86 A0 (KD=1)
                    4170                                     ;кофф *100000 и переведенный в hex формат
                    4171                                     ;согласно адресов диапазонов и адресов яч вн озу 
1A90 792C           4172                                     mov             r1,#2ch
1A92 7400           4173                                     mov             a,#0;57,6
1A94 301302         4174                                     jnb             bitv19,spwri
1A97 7401           4175                                     mov             a,#1;19.6
1A99 F3             4176     spwri:  movx    @r1,a
                    4177     ;стереть страницу пап прогр 
1A9A 905000         4178                                     mov             dptr,#5000h
1A9D 7FFF           4179                                     mov             r7,#0ffh
1A9F 12043E         4180                                     call    cle256
                    4181     ;и запись в ячейки кофф памяти прогр (3000h) 
1AA2 7FFF           4182                                     mov             r7,#0ffh
1AA4 7900           4183                                     mov             r1,#0                           ;external r
                             am
1AA6 905000         4184                                     mov             dptr,#5000h
1AA9 120480         4185                                     call    wrpage
                    4186             
1AAC 201305         4187                                     jb              bitv19,outsko1  ;загр Т1 в соотв с установл
                             енной скоростью
1AAF 758DF4         4188                                             mov                     TH1,#244                ;57
                             .6
1AB2 8003           4189                                             jmp                     outsko
1AB4 758DDC         4190     outsko1:                                        mov                     TH1,#220           
                                  ;19.6
1AB7 C211           4191     outsko:         clr             bitmenu
1AB9 D204           4192                                             setb            bitizm
1ABB 020000   F     4193                                             jmp                     out7
                    4194     
1ABE 020000   F     4195     rlabels4:               jmp             labels4
1AC1 020000   F     4196     rlabelS13:      jmp             labelS13
                    4197     
1AC4 B652F7         4198     me_52:          cjne            @r0,#52h,rlabels4
1AC7 75B0FB         4199                                             mov                     p3,#0fbh;<-
1ACA 20B717         4200                                             jb                      p3.7,vv_52v     ;ввод в кал
                             ибровке
1ACD 78B2           4201                                                     mov             r0,#marker              ;сд
                             виг маркера влево при калибр
1ACF 7440           4202                                     mov             a,#bufind
1AD1 26             4203                                             add             a,@r0                   ;a=bufind+m
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    67

                             arker
1AD2 F9             4204                                             mov             r1,a
1AD3 19             4205                                             dec             r1;inc          r1
1AD4 873C           4206                                             mov             savba,@r1
                    4207                                                     
1AD6 78B2           4208                                             mov             r0,#marker
1AD8 16             4209                                             dec             @r0                             
1AD9 C219           4210                                             clr             bitmig
1ADB E53A           4211                                             mov                     a,movleft
1ADD B60001         4212                                             cjne    @r0,#0,me_52v;ажата кн <- при вводе цифр ка
                             либровки
1AE0 06             4213                                             inc                     @r0
1AE1 020000   F     4214     me_52v:         jmp                     goto7
                    4215     
1AE4 75B0F7         4216     vv_52v:         mov             p3,#0f7h
1AE7 30B703         4217                                             jnb             p3.7,rvvkali52
1AEA 020000   F     4218                                             jmp                     goto7
1AED 020000   F     4219     rvvkali52:      jmp             vvkali52
                    4220     
                    4221     
1AF0 B651D1         4222     me_41:          cjne            @r0,#51h,me_52;rlabels4
1AF3 75B0FB         4223                                             mov             p3,#0fbh;<-
1AF6 30B7C8         4224                                             jnb             p3.7,rlabelS13
1AF9 75B0F7         4225                                             mov             p3,#0f7h
1AFC 20B773         4226                                             jb              p3.7,vvmenu
                    4227                                             ;ввод пароля
                    4228                                     
                    4229     ;       считать с индикатора 
1AFF 7F0E           4230                                     mov             r7,#14
1B01 784F           4231                                     mov             r0,#abin
1B03 120000   F     4232                                     call    clearN                  
                    4233                                     
                    4234     ;чтение номера байта с индикатора(3байта)
                    4235     ;bufind+3..bufind+9
                    4236     ;-  - - -
                    4237     ;- - - - - - - - - -
                    4238     ;adec..adec+9
                    4239     ;ст            мл
1B06 7849           4240                                     mov             r0,#bufind+9;
1B08 795C           4241                                     mov             r1,#adec+9
1B0A 7F03           4242                                     mov             r7,#3;3bait
1B0C C3             4243     upav1:          clr             c
1B0D E6             4244                                     mov             a,@r0
1B0E 9430           4245                                     subb    a,#30h
1B10 F7             4246                                     mov             @r1,a
1B11 18             4247                                     dec             r0
1B12 19             4248                                     dec             r1
1B13 DFF7           4249                                     djnz    r7,upav1;adec+7..adec+9
1B15 7A50           4250                                             mov                     r2,#50h                    
                                  ;parol 000x    (5028h )
1B17 7B28           4251                                             mov                     r3,#28h
1B19 120454         4252                                             call            re4byte                 ;r8..r11(3 
                             bait parol)
1B1C 800F           4253     jmp                     goparol
1B1E E508           4254                                     mov                     a,r8                    ;сравнить п
                             ароль с индикатором
1B20 B55A52         4255                                     cjne            a,adec+7,parerr
1B23 E509           4256                                     mov                     a,r9    
1B25 B55B4D         4257                                     cjne            a,adec+8,parerr
1B28 E50A           4258                                     mov                     a,r10
1B2A B55C48         4259                                     cjne            a,adec+9,parerr
                    4260                                     ;равны
1B2D 78B1           4261     goparol:        mov             r0,#vichR               ;режим меню 52
1B2F 7652           4262                                             mov             @r0,#52h                ;0000-n
1B31 900000   F     4263                                             mov             dptr,#teKD;00000-nA
1B34 120000   F     4264                                             call            lotext
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    68

                    4265                                             ;;;;;;;;;
                    4266                                                     ;n(hex)->abin
1B37 120000   F     4267                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
1B3A 2552           4268                                             add             a,abin+3
1B3C F552           4269                                             mov             abin+3,a
1B3E 7853           4270                                             mov             r0,#adec
1B40 7952           4271                                             mov             r1,#abin+3      ;hex->10
1B42 120000   F     4272                                             call    bindec
1B45 855C48         4273                                             mov             bufind+8,adec+9
1B48 75472D         4274                                             mov             bufind+7,#2dh
1B4B 434A80         4275                                             orl                     bufind+10,#80h;зажечь KMП
1B4E 434B10         4276                                             orl                     bufind+11,#10h;точка после 
                             1 знакоместа
1B51 79AE           4277                                             mov             r1,#diap
1B53 7848           4278                                             mov             r0,#bufind+8
1B55 E7             4279                                             mov             a,@r1
1B56 B40807         4280                                             cjne    a,#8,nodi8k
1B59 7630           4281                                             mov             @r0,#30h                 ;10-10
1B5B 18             4282                                             dec             r0
1B5C 7663           4283                                             mov             @r0,#63h;31h
1B5E 8008           4284                                             jmp             nodisk9
1B60 B40905         4285     nodi8k:                         cjne    a,#9,nodisk9
                    4286                                     
1B63 7631           4287                                             mov             @r0,#31h           ;10-11
1B65 18             4288                                             dec             r0
1B66 7663           4289                                             mov             @r0,#63h;31h
                    4290                                     
                    4291     
1B68 78B2           4292     nodisk9:        mov                     r0,#marker
1B6A 7601           4293                                             mov                     @r0,#1
1B6C 753A01         4294                                             mov                     movleft,#1
1B6F 753B05         4295                                             mov                     movrig,#5
                    4296                                             
1B72 020000   F     4297     vvmenu:         jmp             goto7
                    4298     
1B75 753932         4299     parerr:         mov                     nuerr,#32h
1B78 120000   F     4300                                             call            error
1B7B 120000   F     4301                                             call            ind
1B7E 120000   F     4302                                             call            z_1s
1B81 C211           4303                                             clr                     bitmenu
1B83 D204           4304                                             setb            bitizm
1B85 78B2           4305                                             mov                     r0,#marker
1B87 76FF           4306                                             mov                     @r0,#0ffh
1B89 020000   F     4307                                             jmp             goto7
                    4308     
1B8C 30130E         4309     left_sk:                jnb                     bitv19,tosk19;<-
1B8F 900000   F     4310                                             mov                     dptr,#teS57_6;57,6
1B92 120000   F     4311                                             call            lotext
1B95 434B80         4312                                             orl                     bufind+11,#80h
1B98 C213           4313                                             clr                     bitv19
1B9A 020000   F     4314                                             jmp             out7
1B9D 900000   F     4315     tosk19:         mov                     dptr,#teS19_2
1BA0 120000   F     4316                                             call            lotext
1BA3 434B80         4317                                             orl                     bufind+11,#80h
1BA6 D213           4318                                             setb            bitv19
1BA8 020000   F     4319                                             jmp             out7
                    4320     
1BAB                4321     labelS13:;<- MENU(ПАРОЛЬ 000)
                    4322             
                    4323     ;;;;;;;;;;;;;;;;;;
                    4324     ;необходимо не портить цифру в следуюем слева знакоместе
                    4325     ;т е сохранить ее в ячейке для мигания в противном случае
                    4326     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4327     ;       знакоместа
1BAB 78B2           4328                                     mov             r0,#marker
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    69

1BAD 7440           4329                                     mov             a,#bufind
1BAF 26             4330                                             add             a,@r0                   ;a=bufind+m
                             arker
1BB0 F9             4331                                             mov             r1,a
1BB1 19             4332                                             dec             r1;inc          r1
1BB2 873C           4333                                             mov             savba,@r1
                    4334                                                     
1BB4 78B2           4335                                                     mov             r0,#marker
1BB6 16             4336                                                     dec             @r0                        
                                  
1BB7 C219           4337                                     clr             bitmig
1BB9 E53A           4338                                     mov                     a,movleft
1BBB B60652         4339                                     cjne    @r0,#6,onmem13;;нажата кн <- при вводе цифр ПАРОЛЬ 
                             000
1BBE 06             4340                                     inc             @r0
1BBF 020000   F     4341                                             jmp             goto7
                    4342     ;;;;;;;
                    4343     
1BC2                4344     vvkali52:       ;введено значение для калибровки
                    4345                                             ;число на индикаторе ->Ak  (52h)
                    4346                                             ;       считать с индикатора 
1BC2 7F0E           4347                                     mov             r7,#14
1BC4 784F           4348                                     mov             r0,#abin
1BC6 120000   F     4349                                     call    clearN                  
                    4350                                     
                    4351     ;чтение номера байта с индикатора(3байта)
                    4352     ;bufind+1..bufind+5
                    4353     ;-  - - -
                    4354     ;- - - - - - - - - -
                    4355     ;adec..adec+9
                    4356     ;ст            мл
1BC9 7845           4357                                     mov             r0,#bufind+5;
1BCB 795C           4358                                     mov             r1,#adec+9
1BCD 7F05           4359                                     mov             r7,#5;5bait
1BCF C3             4360     upav2:          clr             c
1BD0 E6             4361                                     mov             a,@r0
1BD1 9430           4362                                     subb    a,#30h
1BD3 F7             4363                                     mov             @r1,a
1BD4 18             4364                                     dec             r0
1BD5 19             4365                                     dec             r1
1BD6 DFF7           4366                                     djnz    r7,upav2;adec+7..adec+9
                    4367     
1BD8 784F           4368                                     mov             r0,#abin
1BDA 7953           4369                                     mov             r1,#adec                        ;мл        
                              ст
1BDC 120000   F     4370                                     call    decbin                  ;abin..abin+3 (hex)
1BDF 120000   F     4371                                     call    loadr2                  ;r2..r5
1BE2 120402         4372                                     call    altof   ;r2..r5->float
1BE5 900000   F     4373                                     mov     dptr,#ch_10;10
1BE8 120000   F     4374                                     call    ldc_ltemp                       ;r8..r11=8
1BEB 120203         4375                                     call    flmul
1BEE 78A4           4376                                     mov             r0,#rez_Ak
1BF0 120000   F     4377                                     call    saver2
1BF3 C211           4378                                             clr                     bitmenu
1BF5 D212           4379                                             setb            bitklb
1BF7 434A80         4380                                             orl                     bufind+10,#80h;зажечь KMП
1BFA D204           4381                                             setb            bitizm;бит калибровки уже установле
                             н
1BFC 78B2           4382                                             mov                     r0,#marker
1BFE 76FF           4383                                             mov                     @r0,#0ffh
1C00 783D           4384                                     mov             r0,#chkl
1C02 76FF           4385                                     mov             @r0,#0ffh
1C04 08             4386                                     inc             r0
1C05 76FF           4387                                     mov             @r0,#0ffh;38h
1C07 120000   F     4388                                     call            z_1s
1C0A 020000   F     4389                                     jmp             out7
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    70

                    4390     
                    4391     
1C0D 020000   F     4392                                             jmp             goto7
                    4393                                              
1C10 020000   F     4394     onmem13:        jmp             goto7   ;(ie7)
                    4395     
1C13 B642AC         4396     labels4:        cjne            @r0,#42h,vvkali52
1C16 75B0FB         4397                                             mov                     p3,#0fbh;<-
1C19 30B7F4         4398                                             jnb             p3.7,onmem13
1C1C 75B0F7         4399                                             mov             p3,#0f7h;vvod
1C1F 20B7EE         4400                                             jb              p3.7,onmem13
                    4401                                             
                    4402             
1C22 020000   F     4403     jmp             out7                                                    
                    4404     ;;;;;;;
1C25                4405     labelI:
1C25 75B0FE         4406                                     mov             p3,#0feh
1C28 E5B0           4407                                     mov             a,p3
1C2A 20E703         4408                                     jb              acc.7,nopoint
                    4409                                     ;
1C2D 020000   F     4410                                     jmp             goto7;out7
                    4411     
1C30 75B0FB         4412     nopoint:                mov             p3,#0fbh
1C33 E5B0           4413                                     mov             a,p3
1C35 20E72C         4414                                     jb              acc.7,nopoin7
1C38 78B2           4415     labelS3:mov             r0,#marker
1C3A E53A           4416                                     mov             a,movleft
1C3C B40309         4417                                     cjne    a,#3,poina1
1C3F B6030B         4418                                     cjne    @r0,#3,nomarl;26
                    4419                                     ;mov            @r0,#9
1C42 E53B           4420     poina2: mov                     a,movrig                ;кн <- B=+00000
1C44 F6             4421                                     mov                     @r0,a
1C45 020000   F     4422                                     jmp             goto7;  out7
                    4423     
1C48 B60402         4424     poina1:         cjne    @r0,#4,nomarl;кн <- A= 0000
1C4B 80F5           4425                                             jmp             poina2
                    4426     
                    4427     
1C4D                4428     nomarl:                 ;                               29.12.06
                    4429     ;;;;;;;;;;;;;;;;;;
                    4430     ;необходимо не портить цифру в следуюем справа знакоместе
                    4431     ;т е сохранить ее в ячейке для мигания в противном случае
                    4432     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4433     ;       знакоместа
1C4D 78B2           4434                                     mov             r0,#marker
1C4F 7440           4435                                     mov             a,#bufind
1C51 26             4436                                             add             a,@r0                   ;a=bufind+m
                             arker
1C52 F9             4437                                             mov             r1,a
1C53 09             4438                                             inc             r1
1C54 873C           4439                                             mov             savba,@r1
                    4440                                                     
1C56 78B2           4441                                                     mov             r0,#marker
1C58 16             4442                                                     dec             @r0                        
                                  
1C59 C219           4443                                     clr             bitmig
1C5B E53A           4444                                     mov                     a,movleft
1C5D B4036B         4445                                     cjne            a,#3,poinA
1C60 B60266         4446                                     cjne    @r0,#2,gogo7;out7;;нажата кн <- при вводе цифр B=+0
                             0000
1C63 06             4447     poin3:  inc             @r0
                    4448     ;нажат ввод А =000000 запомнить константу А
1C64 75B0F7         4449     nopoin7:           mov          p3,#0f7h
1C67 E5B0           4450                                     mov             a,p3
1C69 20E75D         4451                                     jb              acc.7,gogo7;out7
1C6C 78B1           4452                                     mov             r0,#vichR
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    71

1C6E E6             4453                                     mov             a,@r0
1C6F B6215E         4454                                     cjne    @r0,#21h,no21p7
1C72 7611           4455                                     mov             @r0,#11h
                    4456                             ;       считать с индикатора  упаковать в плавающий формат
                    4457                             ;   сохранить
1C74 7F0E           4458                                     mov             r7,#14
1C76 784F           4459                                     mov             r0,#abin
1C78 120000   F     4460                                     call    clearN                  
1C7B 120000   F     4461                                     call    upakA
                    4462                                     
1C7E 784F           4463                                     mov             r0,#abin
1C80 7953           4464                                     mov             r1,#adec                        ;мл        
                              ст
1C82 120000   F     4465                                     call    decbin                  ;abin..abin+3 (hex)
1C85 120000   F     4466                                     call    loadr2                  ;r2..r5
1C88 120402         4467                                     call    altof                   ;r2..r5->float
1C8B 78BC           4468                                     mov                     r0,#konstA
1C8D 120000   F     4469                                     call            saver2
1C90 900000   F     4470                                     mov                     dptr,#ch0
1C93 120000   F     4471                                     call            ldc_ltemp
1C96 1201D6         4472                                     call            flcmp
1C99 6010           4473                                     jz              erra0
                    4474     ;26
1C9B 78B2           4475                                     mov             r0,#marker
1C9D 76FF           4476                                     mov             @r0,#0ffh
                    4477                                     
1C9F 900000   F     4478                                     mov             dptr,#teVICH;teBequ0
1CA2 120000   F     4479                                     call    lotext
                    4480                             ;       call            outB
1CA5 534BBF         4481                                     anl             bufind+11,#0bfh         ;гашение точки bufi
                             nd+7
                    4482                             ;       orl             bufind+11,#80h
1CA8 020000   F     4483                                     jmp             goto7
                    4484     
1CAB 78B2           4485     erra0:          mov             r0,#marker
1CAD 76FF           4486                                             mov             @r0,#0ffh
1CAF 753934         4487                                             mov                     nuerr,#34h;константа не дол
                             жна быть равна0
1CB2 120000   F     4488                                             call            error
1CB5 120000   F     4489                                             call            ind
1CB8 120000   F     4490                                             call            z_1s
1CBB 78B1           4491                                             mov                     r0,#vichR
1CBD 7600           4492                                             mov                     @r0,#0
1CBF C214           4493                                             clr                     bitvich
1CC1 C206           4494                                             clr                     bitvi11
1CC3 D204           4495                                             setb            bitizm
1CC5 78B2           4496                                             mov                     r0,#marker
1CC7 76FF           4497                                             mov                     @r0,#0ffh
1CC9 802E           4498     gogo7:          jmp                     out7;goto7
                    4499     
1CCB B6032B         4500     poinA:          cjne    @r0,#3,out7;;нажата кн <- при вводе цифр A= 0000
1CCE 8093           4501                                             jmp             poin3
                    4502     
1CD0                4503     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    4504                             ;   сохранить
1CD0 7F0E           4505                                     mov             r7,#14
1CD2 784F           4506                                     mov             r0,#abin
1CD4 120000   F     4507                                     call    clearN                  
1CD7 120000   F     4508                                     call    upakB                   
1CDA 784F           4509                                     mov             r0,#abin
1CDC 7953           4510                                     mov             r1,#adec                        ;мл        
                              ст
1CDE 120000   F     4511                                     call    decbin                  ;abin..abin+3 (hex)
1CE1 120000   F     4512                                     call    loadr2                  ;r2..r5
1CE4 120402         4513                                     call    altof                   ;r2..r5->int
1CE7 301B04         4514                                     jnb             bitznB,pozB
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    72

1CEA EA             4515                                     mov             a,r2
1CEB 4480           4516                                     orl             a,#80h
1CED FA             4517                                     mov             r2,a                    ;знак-
1CEE                4518     pozB:           ;mov            r0,#konstB
                    4519                                     ;call   saver2
                    4520     
1CEE 79B2           4521                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
1CF0 77FF           4522                                     mov             @r1,#0ffh
1CF2 78B1           4523                                     mov             r0,#vichR
1CF4 7611           4524                                     mov             @r0,#11h
1CF6 020000   F     4525                               jmp           lovich     ;3.01.07ВЫЧИСЛИТЬ
                    4526                                     
                    4527     
1CF9                4528     out7:                   ;mov            IE,#80h
1CF9 D083           4529                                     pop             dph
1CFB D082           4530                                     pop             dpl
1CFD D007           4531                                     pop             rr7     
1CFF D006           4532                                     pop             rr6
1D01 D005           4533                                     pop             rr5
1D03 D004           4534                                     pop             rr4
1D05 D003           4535                                     pop             rr3
1D07 D002           4536                                     pop             rr2
1D09 D001           4537                                     pop             rr1                             
1D0B D000           4538                                     pop             rr0
1D0D D0D0           4539                                     pop             psw
1D0F D0E0           4540                                     pop             acc
1D11 75AD00         4541                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1D14 75B0C0         4542                             mov             P3,#0c0h
                    4543                             ;       mov             EIE2,#30H
1D17 C219           4544     clr             bitmig
1D19 E586           4545                                             mov             a,P6            ;p6.4=0
1D1B 54EF           4546                             anl             a,#0efh
1D1D F586           4547                             mov             P6,a
1D1F 00             4548                             nop
1D20 00             4549                             nop
                    4550                                     
1D21 E586           4551                             mov             a,P6                    ;p6.4=1 
1D23 4410           4552                             orl             a,#10h
1D25 F586           4553                             mov             P6,a                        
1D27 32             4554                                     reti
                    4555     
                    4556     
                    4557                                     
                    4558     
                    4559     
1D28 78B1           4560     lomenu:         mov             r0,#vichR
1D2A B61107         4561                                             cjne    @r0,#11h,menu12
1D2D 900000   F     4562                                             mov             dptr,#teTESI
1D30 120000   F     4563     lome1:                  call    lotexT
1D33 22             4564                                             ret
1D34 B61205         4565     menu12:         cjne    @r0,#12h,menu13
1D37 900000   F     4566                                             mov             dptr,#teTESR
1D3A 80F4           4567                                             jmp             lome1
1D3C B61305         4568     menu13:         cjne    @r0,#13h,menu14
1D3F 900000   F     4569                                             mov             dptr,#teSKOR
1D42 80EC           4570                                             jmp             lome1
1D44 B61405         4571     menu14:         cjne    @r0,#14h,menu15
1D47 900000   F     4572                                             mov             dptr,#teAVK
1D4A 80E4           4573                                             jmp             lome1
1D4C B61505         4574     menu15:                 cjne    @r0,#15h,menu21
1D4F 900000   F     4575                                             mov             dptr,#teKALIB
1D52 80DC           4576                                             jmp             lome1
                    4577     
1D54 B62105         4578     menu21: cjne    @r0,#21h,menu22
1D57 900000   F     4579                                             mov             dptr,#teTE11
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    73

1D5A 80D4           4580                                             jmp             lome1
1D5C B62205         4581     menu22:         cjne    @r0,#22h,menu23
1D5F 900000   F     4582                                             mov             dptr,#teTE9
1D62 80CC           4583                                             jmp             lome1
1D64 B62305         4584     menu23:         cjne    @r0,#23h,menu31
1D67 900000   F     4585                                             mov             dptr,#teTE7
1D6A 80C4           4586                                             jmp             lome1
1D6C B63105         4587     menu31:         cjne    @r0,#31h,menu41
1D6F 900000   F     4588                                             mov             dptr,#teS57_6
1D72 80BC           4589                                             jmp             lome1
                    4590     
1D74                4591     menu41:         
1D74 900000   F     4592                                             mov             dptr,#tePAR
1D77 80B7           4593                                             jmp             lome1
                    4594     
1D79 020000   F     4595     yesvi_kr:               jmp                     yesvi_km
1D7C                4596     endkalib:;KD=Ak/A3
1D7C 200DFA         4597                                             jb                      bifl_kt,yesvi_kr;выч кофф К
                             м
1D7F 789C           4598                                             mov                     r0,#rez_A3
1D81 120000   F     4599                                             call            resar2
                    4600                                     
1D84 120402         4601                                     call    altof                   ;->float
1D87 EA             4602                                             mov                     a,r2
1D88 547F           4603                                             anl                     a,#7fh
1D8A FA             4604                                             mov                     r2,a
1D8B 120000   F     4605                                     call            move28
1D8E 78A4           4606                                             mov                     r0,#rez_Ak
1D90 120000   F     4607                                             call            resar2
1D93 1202B7         4608                                             call            fldiv
                    4609                                                     
1D96 900000   F     4610                                     mov     dptr,#CHtho;100000
1D99 120000   F     4611                                     call    ldc_ltemp                       ;r8..r11=8
1D9C 120203         4612                                     call    flmul
1D9F 120343         4613                                     call    ftol            ;r2..r5->hex кофф KD (РЕЗ ИЗМ ЧИСЛО
                              6разрядное)
                    4614     
1DA2 78A0           4615                                             mov                     r0,#koefKD
1DA4 120000   F     4616                                             call            saver2
                    4617                                             ;запись в рпзу в соотв ячейку
                    4618                             
1DA7 7900           4619                                             mov             r1,#0                   ;счит рпзу 
                             во внешн озу
1DA9 7A50           4620                                     mov             r2,#50h
1DAB 7B00           4621                                     mov             r3,#00
1DAD 120499         4622                                     call    copyPP
                    4623                                     ;внести изменения во внешн озу
1DB0 120000   F     4624                                     call            findext                 ;r1-внешн озу
1DB3 78A0           4625                                     mov                     r0,#koefKD
1DB5 120000   F     4626                                             call            resar2
1DB8 EA             4627                                             mov                     a,r2
1DB9 F3             4628                                             movx            @r1,a
1DBA 09             4629                                             inc                     r1
1DBB EB             4630                                             mov                     a,r3
1DBC F3             4631                                             movx            @r1,a
1DBD 09             4632                                             inc                     r1
1DBE EC             4633                                             mov                     a,r4
1DBF F3             4634                                             movx            @r1,a
1DC0 09             4635                                             inc                     r1
1DC1 ED             4636                                             mov                     a,r5
1DC2 F3             4637                                             movx            @r1,a
                    4638                                     ;кофф *100000 и переведенный в hex формат
                    4639                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4640     ;стереть страницу пап прогр 
1DC3 905000         4641                                     mov             dptr,#5000h
1DC6 7FFF           4642                                     mov             r7,#0ffh
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    74

1DC8 12043E         4643                                     call    cle256
                    4644     ;и запись в ячейки кофф памяти прогр (3000h) 
1DCB 7FFF           4645                                     mov             r7,#0ffh
1DCD 7900           4646                                     mov             r1,#0                           ;external r
                             am
1DCF 905000         4647                                     mov             dptr,#5000h
1DD2 120480         4648                                     call    wrpage
                    4649     ;2.2.07
1DD5 79AE           4650                                     mov                     r1,#diap
1DD7 B70511         4651                                     cjne            @r1,#5,fulkalib
                    4652                                     ;jb                     bifl_kt,yesvi_km;выч кофф Км
1DDA D20D           4653                                     setb            bifl_kt
                    4654                                     ;call           loadus
1DDC 900000   F     4655                                     mov                     dptr,#tabt7;заслать ус 7А       
1DDF E4             4656                             clr             a
1DE0 93             4657                             movc    a,@a+dptr                               ;high byte
1DE1 F584           4658                             mov             p4,a
1DE3 A3             4659                             inc             dptr
1DE4 E4             4660                             clr             a
1DE5 93             4661                             movc    a,@a+dptr                               ;low byte
1DE6 F585           4662                             mov             p5,a
1DE8 020000   F     4663                                     jmp             goto7;  out_kali
                    4664     
                    4665     ;;;
1DEB                4666     fulkalib:
1DEB C212           4667                                             clr             bitklb
1DED D216           4668                                             setb    bitpar                  ;пароль провели 1 р
                             аз успешно
1DEF 900000   F     4669                                             mov             dptr,#teEND
1DF2 120000   F     4670                                             call    lotext
1DF5 120000   F     4671                                             call    ind
1DF8 120000   F     4672     out_kali:       call    z_1s
1DFB 120000   F     4673                                             call    z_1s
1DFE 020000   F     4674                                             jmp             goto7
1E01                4675     yesvi_km:               ;выч кофф Км=(10**5/A2)*K7/K5
1E01 7A50           4676                                     mov                     r2,#50h                 ;-11a
1E03 7B14           4677                                     mov                     r3,#14h                 ;k7
1E05 12046C         4678                                     call            rebyte2                         ;r2..r5- he
                             x
1E08 120402         4679                                     call            altof                   ;r2..r5->float
1E0B C002           4680                                     push            rr2
1E0D C003           4681                                     push            rr3
1E0F C004           4682                                     push            rr4
1E11 C005           4683                                     push            rr5
1E13 7A50           4684                                     mov                     r2,#50h                 ;k5
1E15 7B0C           4685                                     mov                     r3,#0ch
1E17 12046C         4686                             call            rebyte2                 ;r2..r5
1E1A 120402         4687                                     call            altof                   ;r2..r5->float
1E1D 120000   F     4688                                     call            move28
1E20 D005           4689                                     pop                     rr5
1E22 D004           4690                                     pop                     rr4
1E24 D003           4691                                     pop                     rr3
1E26 D002           4692                                     pop                     rr2
1E28 1202B7         4693                                     call            fldiv                   ;K7/K5
                    4694     
1E2B 900000   F     4695                                     mov     dptr,#CHtho;100000
1E2E 120000   F     4696                                     call    ldc_ltemp                       ;r8..r11=8
1E31 120203         4697                                     call    flmul                           ;r2..r5 ;K7/K5*10**
                             5
1E34 C002           4698                                     push            rr2
1E36 C003           4699                                     push            rr3
1E38 C004           4700                                     push            rr4
1E3A C005           4701                                     push            rr5
                    4702                                     
1E3C 789C           4703                                     mov                     r0,#rez_A3
1E3E 120000   F     4704                                     call            resar2
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    75

1E41 120402         4705                                     call            altof                           ;r2..r5->fl
                             oat
1E44 120000   F     4706                                     call            move28
1E47 D005           4707                                     pop                     rr5
1E49 D004           4708                                     pop                     rr4
1E4B D003           4709                                     pop                     rr3
1E4D D002           4710                                     pop                     rr2
1E4F 1202B7         4711                               call          fldiv           ;Km     
                    4712     
1E52 900000   F     4713                                     mov     dptr,#CHtho;100000
1E55 120000   F     4714                                     call    ldc_ltemp                       ;r8..r11=8
1E58 120203         4715                                     call    flmul                           ;r2..r5
1E5B 120343         4716                                     call    ftol                    ;r2..r5->hex кофф Km(РЕЗ ИЗ
                             М ЧИСЛО 6разрядное)
1E5E 78A0           4717                                     mov                     r0,#koefKD;2ое исп ячейки koefKD
1E60 120000   F     4718                                     call            saver2
                    4719                                     ;запись в рпзу в соотв ячейку
1E63 7900           4720                                     mov             r1,#0                   ;счит рпзу во внешн
                              озу
1E65 7A50           4721                                     mov             r2,#50h
1E67 7B00           4722                                     mov             r3,#00
1E69 120499         4723                                     call    copyPP
                    4724                                     ;внести изменения во внешн озу
1E6C 78A0           4725                                     mov                     r0,#koefKD
1E6E 120000   F     4726                                     call            resar2
1E71 792C           4727                                     mov                     r1,#2ch                 ;r1-внешн о
                             зу кофф Km
                    4728                             
1E73 EA             4729                                     mov                     a,r2
1E74 F3             4730                                             movx            @r1,a
1E75 09             4731                                             inc                     r1
1E76 EB             4732                                             mov                     a,r3
1E77 F3             4733                                             movx            @r1,a
1E78 09             4734                                             inc                     r1
1E79 EC             4735                                             mov                     a,r4
1E7A F3             4736                                             movx            @r1,a
1E7B 09             4737                                             inc                     r1
1E7C ED             4738                                             mov                     a,r5
1E7D F3             4739                                             movx            @r1,a
                    4740                                     ;кофф *100000 и переведенный в hex формат
                    4741                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4742     ;стереть страницу пап прогр 
1E7E 905000         4743                                     mov             dptr,#5000h
1E81 7FFF           4744                                     mov             r7,#0ffh
1E83 12043E         4745                                     call    cle256
                    4746     ;и запись в ячейки кофф памяти прогр (3000h) 
1E86 7FFF           4747                                     mov             r7,#0ffh
1E88 7900           4748                                     mov             r1,#0                           ;external r
                             am
1E8A 905000         4749                                     mov             dptr,#5000h
1E8D 120480         4750                                     call    wrpage
                    4751     
1E90 C20D           4752                                             clr             bifl_kt
1E92 120000   F     4753                                             call    loadus
1E95 020000   F     4754                                             jmp             fulkalib
                    4755     
                    4756     ;выч среднего по блоку
                    4757     ;вых r2..r5
1E98                4758     vichmean:       
1E98 120000   F     4759                                             call            resa_hl;save_bl->dptr
1E9B 78D7           4760                                             mov                     r0,#copy_hl
1E9D E583           4761                                             mov                     a,dph
1E9F F6             4762                                             mov                     @r0,a
1EA0 08             4763                                             inc                     r0
1EA1 E582           4764                                             mov                     a,dpl
1EA3 F6             4765                                             mov                     @r0,a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    76

1EA4 78B8           4766                                             mov                     r0,#work
1EA6 120000   F     4767                                             call            clear4
1EA9 78D6           4768                                             mov                     r0,#chblok;volume
1EAB 7600           4769                                             mov                     @r0,#0
1EAD 120000   F     4770     meng:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1EB0 E582           4771                                             mov                     a,dpl
1EB2 FF             4772                                             mov                     r7,a
1EB3 E583           4773                                             mov                     a,dph
1EB5 FE             4774                                             mov                     r6,a
                    4775     
1EB6 78D7           4776                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1EB8 E6             4777                                             mov                     a,@r0
1EB9 F583           4778                                             mov                     dph,a
1EBB 08             4779                                             inc                     r0
1EBC E6             4780                                             mov                     a,@r0
1EBD F582           4781                                             mov                     dpl,a
                    4782                                             
1EBF C3             4783                                             clr                     c;-4
1EC0 E582           4784                                             mov                     a,dpl
1EC2 9404           4785                                             subb            a,#4
1EC4 F582           4786                                             mov                     dpl,a
1EC6 E583           4787                                             mov                     a,dph
1EC8 9400           4788                                             subb            a,#0
1ECA F583           4789                                             mov                     dph,a;dptr-4
                    4790                                             ;;;;;;;;
1ECC 79D7           4791                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1ECE E583           4792                                                     mov             a,dph
1ED0 F7             4793                                               mov           @r1,a
1ED1 09             4794                                                     inc             r1
1ED2 E582           4795                                                     mov             a,dpl
1ED4 F7             4796                                                     mov             @r1,a
                    4797                                                     ;;;;;;;;;
1ED5 C3             4798                                                     clr             c;пришли в начало блока?
1ED6 E582           4799                                                     mov                     a,dpl
1ED8 9F             4800                                                     subb            a,r7
1ED9 FF             4801                                                     mov                     r7,a
1EDA 7006           4802                                                     jnz                     nextmea
1EDC E583           4803                                                     mov                     a,dph
1EDE 9E             4804                                                     subb            a,r6
1EDF FE             4805                                                     mov                     r6,a
1EE0 601B           4806                                                     jz                      outmea;
                    4807                                                     
                    4808                                                     ;продолжаем сравнение
                    4809                                                     ;;;;;;;;;;;             
1EE2 120000   F     4810     nextmea:                call            loahl_r2        ;из яч внешн озу ->r2..r5
1EE5 120402         4811                                             call            altof;->float
1EE8 120000   F     4812                                             call            move28                  ;r8..r11
1EEB 78B8           4813                                             mov                     r0,#work
1EED 120000   F     4814                                             call            resar2
1EF0 120166         4815                                             call            fladd
1EF3 78B8           4816                                             mov                     r0,#work
1EF5 120000   F     4817                                             call            saver2
1EF8 78D6           4818                                             mov                     r0,#chblok;volume;кол измер
                             ений блока
1EFA 06             4819                                             inc                     @r0
1EFB 80B0           4820                                             jmp                     meng
1EFD                4821     outmea:         
1EFD 120000   F     4822                                             call            loahl_r2        ;из яч внешн озу ->
                             r2..r5
1F00 120402         4823                                             call            altof;->float
1F03 120000   F     4824                                             call            move28                  ;r8..r11
1F06 78B8           4825                                             mov                     r0,#work
1F08 120000   F     4826                                             call            resar2
1F0B 120166         4827                                             call            fladd
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    77

1F0E 78B8           4828                                             mov                     r0,#work
1F10 120000   F     4829                                             call            saver2
1F13 E4             4830                                             clr                     a
1F14 FA             4831                                             mov                     r2,a
1F15 FB             4832                                             mov                     r3,a
1F16 FC             4833                                             mov                     r4,a
1F17 78D6           4834                                             mov                     r0,#chblok;volume;кол измер
                             ений блока...200d
1F19 E6             4835                                             mov                     a,@r0
1F1A 2401           4836                                             add                     a,#1
1F1C FD             4837                                             mov                     r5,a
1F1D 120402         4838                                             call            altof;r2..r5 float
1F20 120000   F     4839                                             call            move28
1F23 78B8           4840                                             mov                     r0,#work
1F25 120000   F     4841                                             call            resar2
1F28 1202B7         4842                                             call            fldiv
1F2B 900000   F     4843                                             mov                     dptr,#ch_10      
1F2E 120000   F     4844                                     call            ldc_ltemp
1F31 1202B7         4845                                     call            fldiv
1F34 120343         4846                                             call            ftol                            ;->
                             hex
1F37 120000   F     4847                                             call    maform
1F3A 784F           4848                                             mov             r0,#abin
1F3C 120000   F     4849                                             call    saver2
                    4850     ;;;;;;;;
                    4851                                             
1F3F 7853           4852                                             mov             r0,#adec
1F41 7952           4853                                             mov             r1,#abin+3      ;hex->10
1F43 120000   F     4854                                             call    bindec
                    4855                                     
1F46 785C           4856                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1F48 7949           4857                                             mov             r1,#bufind+9
1F4A 7F05           4858                                             mov             r7,#5
1F4C E6             4859     bufmea:                         mov             a,@r0
1F4D 2430           4860                                             add             a,#30h
1F4F F7             4861                                             mov             @r1,a
1F50 19             4862                                             dec             r1
1F51 18             4863                                             dec             r0
1F52 DFF8           4864                                             djnz    r7,bufmea
1F54 7844           4865                                             mov             r0,#bufind+4
1F56 762B           4866                                             mov             @r0,#2bh          
1F58 300202         4867                                             jnb             znmat,nozmea
1F5B 762D           4868                                             mov             @r0,#2dh
1F5D 434B05         4869     nozmea:         orl             bufind+11,#05h
1F60 22             4870                                             ret
                    4871     
                    4872     
1F61 E0             4873     loahl_r2:       movx            a,@dptr         ;из яч внешн озу ->r2..r5
1F62 FA             4874                                             mov                     r2,a
1F63 A3             4875                                             inc                     dptr
1F64 E0             4876                                             movx            a,@dptr
1F65 FB             4877                                             mov                     r3,a
1F66 A3             4878                                             inc                     dptr
1F67 E0             4879                                             movx            a,@dptr
1F68 FC             4880                                             mov                     r4,a
1F69 A3             4881                                             inc                     dptr
1F6A E0             4882                                             movx            a,@dptr
1F6B FD             4883                                             mov                     r5,a    
1F6C 22             4884                                             ret
                    4885     
1F6D C3             4886     min4_hl:        clr                     c;-4
1F6E E582           4887                                             mov                     a,dpl
1F70 9404           4888                                             subb            a,#4
1F72 F582           4889                                             mov                     dpl,a
1F74 E583           4890                                             mov                     a,dph
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    78

1F76 9400           4891                                             subb            a,#0
1F78 F583           4892                                             mov                     dph,a;dptr-4
1F7A 22             4893                                             ret
                    4894     
                    4895     ;мин значение по по блоку
1F7B                4896     vichmin:        
1F7B 120000   F     4897                                             call            resa_hl;save_bl->dptr
                    4898                                                                                     
                    4899     ;с конца блока адрес 2го измерение
1F7E 120000   F     4900                                             call            min4_hl
                    4901                                             
1F81 78B8           4902                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4903                                             
1F83 E0             4904                                             movx            a,@dptr
1F84 F6             4905                                             mov                     @r0,a
1F85 08             4906                                             inc                     r0
1F86 A3             4907                                             inc                     dptr
1F87 E0             4908                                             movx            a,@dptr
1F88 F6             4909                                             mov                     @r0,a
1F89 08             4910                                             inc                     r0
1F8A A3             4911                                             inc                     dptr
1F8B E0             4912                                             movx            a,@dptr
1F8C F6             4913                                             mov                     @r0,a
1F8D 08             4914                                             inc                     r0
1F8E A3             4915                                             inc                     dptr
1F8F E0             4916                                             movx            a,@dptr
1F90 F6             4917                                             mov                     @r0,a
1F91 A3             4918                                             inc                     dptr
                    4919                                             
1F92 78B8           4920                                             mov                     r0,#work
1F94 120000   F     4921                                             call            resar2
1F97 120402         4922                                             call            altof;->float;r2..r5
1F9A 78B8           4923                                             mov                     r0,#work
1F9C 120000   F     4924                                             call            saver2
                    4925     
1F9F 120000   F     4926                                             call            min4_hl
                    4927                                             ;call           min4_hl
                    4928     
1FA2 78D7           4929                                             mov                     r0,#copy_hl
1FA4 E583           4930                                             mov                     a,dph
1FA6 F6             4931                                             mov                     @r0,a
1FA7 08             4932                                             inc                     r0
1FA8 E582           4933                                             mov                     a,dpl
1FAA F6             4934                                             mov                     @r0,a
                    4935                                     
1FAB 78D6           4936                                             mov                     r0,#chblok;volume
1FAD 7600           4937                                             mov                     @r0,#0
1FAF 120000   F     4938     ming:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1FB2 E582           4939                                             mov                     a,dpl
1FB4 FF             4940                                             mov                     r7,a
1FB5 E583           4941                                             mov                     a,dph
1FB7 FE             4942                                             mov                     r6,a
                    4943     
1FB8 78D7           4944                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1FBA E6             4945                                             mov                     a,@r0
1FBB F583           4946                                             mov                     dph,a
1FBD 08             4947                                             inc                     r0
1FBE E6             4948                                             mov                     a,@r0
1FBF F582           4949                                             mov                     dpl,a
                    4950                                             
1FC1 C3             4951                                             clr                     c;-4
1FC2 E582           4952                                             mov                     a,dpl
1FC4 9404           4953                                             subb            a,#4
1FC6 F582           4954                                             mov                     dpl,a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    79

1FC8 E583           4955                                             mov                     a,dph
1FCA 9400           4956                                             subb            a,#0
1FCC F583           4957                                             mov                     dph,a;dptr-4
                    4958                                             ;;;;;;;;
1FCE 79D7           4959                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1FD0 E583           4960                                                     mov             a,dph
1FD2 F7             4961                                               mov           @r1,a
1FD3 09             4962                                                     inc             r1
1FD4 E582           4963                                                     mov             a,dpl
1FD6 F7             4964                                                     mov             @r1,a
                    4965                                                     ;;;;;;;;;
1FD7 C3             4966                                                     clr             c;пришли в начало блока?
1FD8 E582           4967                                                     mov                     a,dpl
1FDA 9F             4968                                                     subb            a,r7
1FDB FF             4969                                                     mov                     r7,a
1FDC 7006           4970                                                     jnz                     nextmin
1FDE E583           4971                                                     mov                     a,dph
1FE0 9E             4972                                                     subb            a,r6
1FE1 FE             4973                                                     mov                     r6,a
1FE2 601D           4974                                                     jz                      outmin;
                    4975                                                     
                    4976                                                     ;продолжаем сравнение
                    4977                                                     ;;;;;;;;;;;             
1FE4 78B8           4978     nextmin:        mov                     r0,#work
1FE6 120000   F     4979                                             call            resar2
                    4980                                             ;call           altof;->float;r2..r5
1FE9 120000   F     4981                                             call            move28;->r8..r11
1FEC 120000   F     4982                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4983     
1FEF 120402         4984                                             call            altof;->float;r2..r5
                    4985                                             
1FF2 1201D6         4986                                             call            flcmp
1FF5 5005           4987                                             jnc                     nomini
1FF7 78B8           4988                                             mov                     r0,#work;<
1FF9 120000   F     4989                                             call            saver2;r2..r5
1FFC 78D6           4990     nomini:                 mov                     r0,#chblok;volume;кол измерений блока
1FFE 06             4991                                             inc                     @r0
1FFF 80AE           4992                                             jmp                     ming
                    4993     
2001 78B8           4994     outmin:         mov                     r0,#work;1ое измерение блока
2003 120000   F     4995                                             call            resar2
                    4996                                     ;       call            altof;->float;r2..r5
2006 120000   F     4997                                             call            move28;->r8..r11
2009 120000   F     4998                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4999     
200C 120402         5000                                             call            altof;->float;r2..r5
                    5001                                             
200F 1201D6         5002                                             call            flcmp
2012 5005           5003                                             jnc                     minivix
2014 78B8           5004                                             mov                     r0,#work;<
2016 120000   F     5005                                             call            saver2;r2..r5
                    5006                                             ;;;;;;;;;
                    5007     
2019 78B8           5008     minivix:        mov                     r0,#work
201B 120000   F     5009                                             call            resar2
                    5010     
                    5011                                             ;call           altof;->float
                    5012                                     
201E 900000   F     5013                                             mov                     dptr,#ch_10      
2021 120000   F     5014                                             call            ldc_ltemp
2024 1202B7         5015                                             call            fldiv
2027 120343         5016                                             call            ftol                            ;->
                             hex
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    80

                    5017                                             ;;;
202A 120000   F     5018                                             call            maform
202D 784F           5019                                             mov                     r0,#abin
202F 120000   F     5020                                             call            saver2
                    5021     ;;;;;;;;
                    5022                                             
2032 7853           5023                                             mov             r0,#adec
2034 7952           5024                                             mov             r1,#abin+3      ;hex->10
2036 120000   F     5025                                             call    bindec
                    5026                                     
2039 785C           5027                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
203B 7949           5028                                             mov             r1,#bufind+9
203D 7F05           5029                                             mov             r7,#5
203F E6             5030     bufmin:                         mov             a,@r0
2040 2430           5031                                             add             a,#30h
2042 F7             5032                                             mov             @r1,a
2043 19             5033                                             dec             r1
2044 18             5034                                             dec             r0
2045 DFF8           5035                                             djnz    r7,bufmin
2047 7844           5036                                             mov             r0,#bufind+4
2049 762B           5037                                             mov             @r0,#2bh          
204B 300202         5038                                             jnb             znmat,nozmin
204E 762D           5039                                             mov             @r0,#2dh
2050 434B05         5040     nozmin:         orl             bufind+11,#05h
2053 22             5041                                             ret
                    5042     
                    5043     
                    5044     
                    5045     ;мин значение по по блоку
2054                5046     vichmax:        
2054 120000   F     5047                                             call            resa_hl;save_bl->dptr
                    5048                                             
                    5049                                             
                    5050     ;с конца блока адрес 2го измерение
2057 120000   F     5051                                             call            min4_hl
                    5052                                             
205A 78B8           5053                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    5054                                             
205C E0             5055                                             movx            a,@dptr
205D F6             5056                                             mov                     @r0,a
205E 08             5057                                             inc                     r0
205F A3             5058                                             inc                     dptr
2060 E0             5059                                             movx            a,@dptr
2061 F6             5060                                             mov                     @r0,a
2062 08             5061                                             inc                     r0
2063 A3             5062                                             inc                     dptr
2064 E0             5063                                             movx            a,@dptr
2065 F6             5064                                             mov                     @r0,a
2066 08             5065                                             inc                     r0
2067 A3             5066                                             inc                     dptr
2068 E0             5067                                             movx            a,@dptr
2069 F6             5068                                             mov                     @r0,a
206A A3             5069                                             inc                     dptr
                    5070                                             
206B 78B8           5071                                             mov                     r0,#work
206D 120000   F     5072                                             call            resar2
2070 120402         5073                                             call            altof;->float;r2..r5
2073 78B8           5074                                             mov                     r0,#work
2075 120000   F     5075                                             call            saver2
                    5076     
2078 120000   F     5077                                             call            min4_hl
                    5078                                     ;       call            min4_hl
                    5079     
207B 78D7           5080                                             mov                     r0,#copy_hl
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    81

207D E583           5081                                             mov                     a,dph
207F F6             5082                                             mov                     @r0,a
2080 08             5083                                             inc                     r0
2081 E582           5084                                             mov                     a,dpl
2083 F6             5085                                             mov                     @r0,a
                    5086                                     
2084 78D6           5087                                             mov                     r0,#chblok;volume
2086 7600           5088                                             mov                     @r0,#0
2088 120000   F     5089     maxg:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
208B E582           5090                                             mov                     a,dpl
208D FF             5091                                             mov                     r7,a
208E E583           5092                                             mov                     a,dph
2090 FE             5093                                             mov                     r6,a
                    5094     
2091 78D7           5095                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
2093 E6             5096                                             mov                     a,@r0
2094 F583           5097                                             mov                     dph,a
2096 08             5098                                             inc                     r0
2097 E6             5099                                             mov                     a,@r0
2098 F582           5100                                             mov                     dpl,a
                    5101                                             
209A C3             5102                                             clr                     c;-4
209B E582           5103                                             mov                     a,dpl
209D 9404           5104                                             subb            a,#4
209F F582           5105                                             mov                     dpl,a
20A1 E583           5106                                             mov                     a,dph
20A3 9400           5107                                             subb            a,#0
20A5 F583           5108                                             mov                     dph,a;dptr-4
                    5109                                             ;;;;;;;;
20A7 79D7           5110                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
20A9 E583           5111                                                     mov             a,dph
20AB F7             5112                                               mov           @r1,a
20AC 09             5113                                                     inc             r1
20AD E582           5114                                                     mov             a,dpl
20AF F7             5115                                                     mov             @r1,a
                    5116                                                     ;;;;;;;;;
20B0 C3             5117                                                     clr             c;пришли в начало блока?
20B1 E582           5118                                                     mov                     a,dpl
20B3 9F             5119                                                     subb            a,r7
20B4 FF             5120                                                     mov                     r7,a
20B5 7006           5121                                                     jnz                     nextmax
20B7 E583           5122                                                     mov                     a,dph
20B9 9E             5123                                                     subb            a,r6
20BA FE             5124                                                     mov                     r6,a
20BB 601D           5125                                                     jz                      outmax;
                    5126                                                     
                    5127                                                     ;продолжаем сравнение
                    5128                                                     ;;;;;;;;;;;             
20BD 78B8           5129     nextmax:        mov                     r0,#work
20BF 120000   F     5130                                             call            resar2
                    5131                                             ;call           altof;->float;r2..r5
20C2 120000   F     5132                                             call            move28;->r8..r11
20C5 120000   F     5133                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5134     
20C8 120402         5135                                             call            altof;->float;r2..r5
                    5136                                             
20CB 1201D6         5137                                             call            flcmp
20CE 4005           5138                                             jc                      nomaxi
20D0 78B8           5139                                             mov                     r0,#work;>
20D2 120000   F     5140                                             call            saver2;r2..r5
20D5 78D6           5141     nomaxi:                 mov                     r0,#chblok;volume;кол измерений блока
20D7 06             5142                                             inc                     @r0
20D8 80AE           5143                                             jmp                     maxg
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    82

20DA 78B8           5144     outmax:         mov                     r0,#work;1ое измерение блока
20DC 120000   F     5145                                             call            resar2
                    5146                                     ;       call            altof;->float;r2..r5
20DF 120000   F     5147                                             call            move28;->r8..r11
20E2 120000   F     5148                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5149     
20E5 120402         5150                                             call            altof;->float;r2..r5
                    5151                                             
20E8 1201D6         5152                                             call            flcmp
20EB 4005           5153                                             jc                      maxvix
20ED 78B8           5154                                             mov                     r0,#work;>
20EF 120000   F     5155                                             call            saver2;r2..r5
                    5156                                             ;;;;;;;;;
                    5157     
20F2 020000   F     5158     maxvix:         jmp             minivix
                    5159     
                    5160     
20F5 78CF           5161     bufl_dec:       mov                     r0,#chbuf       
20F7 120000   F     5162                                             call            resar2  
20FA 900000   F     5163                                             mov                     dptr,#ch_1       
20FD 120000   F     5164                                             call            ldc_ltemp
2100 1201D1         5165                                             call            flsub
2103 78CF           5166                                             mov                     r0,#chbuf       
2105 120000   F     5167                                             call            saver2  
2108 22             5168                                             ret
                    5169     
                    5170     
                    5171     ;$include (d:\amp\subr6.asm) 
                +1  5172     
                +1  5173     ;тест интерфейса
2109            +1  5174     testrs: ;jb     p0.3,goprogr
2109 C2AC       +1  5175                                     clr     IE.4
210B 759955     +1  5176     test1:  mov     SBUF0,#55h
210E 3099FD     +1  5177                                     jnb     SCON0.1,$
2111 78B8       +1  5178                                     mov     r0,#work;chtest
2113 76BE       +1  5179                                     mov     @r0,#190d;60
                +1  5180     
2115 309825     +1  5181     test01: jnb     SCON0.0,test2
2118 E599       +1  5182                                     mov     a,SBUF0
211A B45512     +1  5183                                     cjne    a,#55h,test3
211D C299       +1  5184     test4:  clr     SCON0.1
211F C298       +1  5185                                     clr     SCON0.0
2121 7D0A       +1  5186                                     mov     r5,#10
2123 7840       +1  5187                                     mov     r0,#bufind              ;- - - -
2125 762D       +1  5188     test04: mov     @r0,#2dh
2127 08         +1  5189                                     inc     r0
2128 DDFB       +1  5190                                     djnz    r5,test04
212A 120000   F +1  5191                                     call    ind
212D 80DC       +1  5192                                     jmp     test1
212F            +1  5193     test3:  
212F 753933     +1  5194                                     mov     nuerr,#33h
2132 120000   F +1  5195                                     call    error           ;на кран прибора ERR 3
                +1  5196                             
2135 120000   F +1  5197                                     call    ind;
2138 120000   F +1  5198                                     call    z_01s           ;100ms
213B 80E0       +1  5199                                     jmp     test4
213D 78B8       +1  5200     test2:  mov     r0,#work;chtest
213F B60002     +1  5201                                     cjne    @r0,#0,test02
2142 8003       +1  5202                                     jmp     test5
2144 16         +1  5203     test02: dec     @r0
2145 80CE       +1  5204                                     jmp     test01
2147 120000   F +1  5205     test5:  call    z_1ms           ;1ms
214A C299       +1  5206                                     clr     SCON0.1
                +1  5207             
214C 753933     +1  5208                                     mov     nuerr,#33h
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    83

214F 120000   F +1  5209                                     call    error           ;на кран прибора ERR 3
                +1  5210                                     
2152 120000   F +1  5211                                     call    ind
2155 120000   F +1  5212                                     call    z_01s           ;100ms
2158 80B1       +1  5213                                     jmp     test1   
                +1  5214     
                +1  5215     
                +1  5216     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
215A 75E700     +1  5217      ind:   mov             EIE2,#00H;mov   IE,#00h
215D 120000   F +1  5218                     call    mign
2160 7840       +1  5219                      mov            r0,#bufind;+11
2162 7F0C       +1  5220                      mov            r7,#12
2164 C287       +1  5221      nexin: clr             p0.7;6
2166 E6         +1  5222                     mov             a,@r0
2167 F59B       +1  5223                     mov             SPI0DAT,a
2169 20FBFD     +1  5224                     jb              TXBSY,$
216C D287       +1  5225                     setb    p0.7;6
216E 120000   F +1  5226                     call    z_9             ;25mks
2171 08         +1  5227                     inc             r0;dec          r0
2172 DFF0       +1  5228                     djnz    r7,nexin
2174 75E730     +1  5229                     mov             EIE2,#30H;mov   IE,#80h
2177 22         +1  5230                ret
                +1  5231     
                +1  5232     
2178 7A08       +1  5233     zapadc:   mov R2,#8
217A D297       +1  5234     sdv:      setb P1.7
217C 33         +1  5235               rlc A
217D 9296       +1  5236                     mov P1.6,C
217F 120000   F +1  5237                     call tim2
                +1  5238                                     
2182 C297       +1  5239                     clr P1.7
2184 120000   F +1  5240                     call tim2
2187 DAF1       +1  5241                     djnz R2,sdv
2189 D296       +1  5242                     setb P1.6
218B 22         +1  5243                     ret
                +1  5244     
218C 7A08       +1  5245     chtadc:   mov R2,#8
218E D297       +1  5246     sdv1:     setb P1.7
2190 120000   F +1  5247               call tim2
2193 C297       +1  5248                     clr P1.7
2195 A296       +1  5249                     mov C,P1.6
2197 33         +1  5250                     rlc A
2198 120000   F +1  5251                     call tim2
219B DAF1       +1  5252                     djnz R2,sdv1
219D 22         +1  5253                     ret
                +1  5254     
219E 7E30       +1  5255     tim:      mov R6,#30h;38h
21A0 DEFE       +1  5256     tim1:     djnz R6,tim1
21A2 22         +1  5257               ret
                +1  5258               
21A3 7E10       +1  5259     tim2:     mov R6,#10h;14h
21A5 DEFE       +1  5260     tim3:     djnz R6,tim3
21A7 22         +1  5261               ret
                +1  5262     
                +1  5263     ;запись из acc
21A8 C3         +1  5264     write_x1: clr   c
21A9            +1  5265     writeD_x1:
21A9 92B1       +1  5266                       mov P3.1,c        ;запись
21AB F5A0       +1  5267               mov P2,A
21AD D2B3       +1  5268                       setb P3.3
21AF 120000   F +1  5269                       call z_5
21B2 C2B3       +1  5270                       clr P3.3
21B4 75A0FF     +1  5271                       mov P2,#0FFh
21B7 22         +1  5272                       ret
                +1  5273     
                +1  5274     ;чтение в acc
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    84

21B8 C3         +1  5275     read_x2:  clr   c  
21B9 92B1       +1  5276               mov P3.1,c        ;чтение
21BB D2B2       +1  5277               setb P3.2
21BD D2B3       +1  5278                       setb P3.3
21BF 120000   F +1  5279                     call z_5
21C2 E5A0       +1  5280                       mov A,P2
21C4 C2B3       +1  5281                       clr P3.3
21C6 C2B2       +1  5282                       clr P3.2
21C8 22         +1  5283                       ret
                +1  5284     
                +1  5285     
21C9 120000   F +1  5286     loop:     call read_x2;x2    ;ожидание флага готовности
21CC 20E7FA     +1  5287                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
21CF 22         +1  5288                        ret           ;возврат, если бит А(7)<>1
                +1  5289                                      
                +1  5290                                        
                +1  5291     
                +1  5292     
                +1  5293     
                +1  5294     
                +1  5295     
                +1  5296     
                +1  5297     
                +1  5298     ;принимаемый байт в acc
                +1  5299     ;прием байта последовательным кодом старшими разрядами вперед
21D0 7A08       +1  5300     read:    mov R2,#8
21D2 C297       +1  5301     re1:     clr P1.7;P1.2
21D4 120000   F +1  5302              call tim2        ;5mks
21D7 A294       +1  5303                     mov C,P1.4;P1.0
21D9 33         +1  5304                     rlc A           
21DA D297       +1  5305                     setb P1.7;P1.2
21DC 120000   F +1  5306                     call tim2
21DF DAF1       +1  5307                     djnz R2,re1
21E1 22         +1  5308                     ret
                +1  5309     
                +1  5310      ;in r0-count   
                +1  5311     ;r10,r11-значение с котоым сравнивается счетчик
                +1  5312     ;r2..r5 -значение счетчика
21E2            +1  5313     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
21E2 E6         +1  5314                     mov                     a,@r0
21E3 FC         +1  5315                     mov                     r4,a
21E4 08         +1  5316                     inc                     r0
21E5 E6         +1  5317                     mov                     a,@r0
21E6 FD         +1  5318                     mov                     r5,a
21E7 7B00       +1  5319                     mov                     r3,#0
21E9 7A00       +1  5320                     mov                     r2,#0
21EB 750800     +1  5321                     mov                     r8,#0;clr                       r8
21EE 750900     +1  5322                     mov                     r9,#0;clr                       r9
21F1 120000   F +1  5323                     call            lcmp
21F4 22         +1  5324                     ret
                +1  5325     
                +1  5326     
                +1  5327     ;in-r1-count
21F5            +1  5328     chdec:          ;mov            r1,#chavt               ;chavt-1
21F5 E7         +1  5329                             mov             a,@r1
21F6 FC         +1  5330                             mov             r4,a
21F7 09         +1  5331                             inc             r1
21F8 E7         +1  5332                             mov             a,@r1
21F9 FD         +1  5333                             mov             r5,a
21FA C202       +1  5334                             clr             rr2
21FC C203       +1  5335                             clr             rr3
21FE 900000   F +1  5336                             mov             dptr,#ch1        
2201 120000   F +1  5337                             call    ldc_ltemp
2204 120000   F +1  5338                             call    lsub
2207 ED         +1  5339                             mov             a,r5
2208 F7         +1  5340                             mov             @r1,a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    85

2209 19         +1  5341                             dec             r1
220A EC         +1  5342                             mov             a,r4
220B F7         +1  5343                             mov             @r1,a
                +1  5344                             
220C 22         +1  5345                             ret      
                +1  5346     
                +1  5347     
                +1  5348     
                +1  5349     
220D            +1  5350     loadUS: ;если идет тест измерения ус восстановить для теста
220D 201533     +1  5351                                     jb              biteizm,yestest
2210 79AE       +1  5352                                             mov             r1,#diap
2212 E7         +1  5353                             mov             a,@r1
2213 23         +1  5354                             rl              a;*2
2214 FC         +1  5355                             mov             r4,a                    ;save a
2215 900000   F +1  5356                             mov             dptr,#tabus
2218 93         +1  5357                             movc    a,@a+dptr
2219 FA         +1  5358                             mov             r2,a                    ;high byte
221A E584       +1  5359                             mov             a,p4
221C 5401       +1  5360                             anl             a,#01
221E 4A         +1  5361                             orl             a,r2
221F F584       +1  5362                             mov             p4,a
2221 0C         +1  5363                             inc             r4
2222 EC         +1  5364                             mov             a,r4
2223 93         +1  5365                             movc    a,@a+dptr
2224 FB         +1  5366                             mov             r3,a                    ;low byte
2225 E585       +1  5367                             mov             a,p5
2227 5401       +1  5368                             anl             a,#01
2229 4B         +1  5369                             orl             a,r3
222A F585       +1  5370                             mov             p5,a
222C 799A       +1  5371                             mov             r1,#parT
222E B7010E     +1  5372                             cjne    @r1,#1,bret
2231 79AE       +1  5373                             mov             r1,#diap                  ;10s (parT=1)
2233 7405       +1  5374                             mov             a,#5                      ;10-8..10-11 p4.1=1
2235 C3         +1  5375                             clr             c
2236 97         +1  5376                             subb    a,@r1
2237 5006       +1  5377                             jnc             bret
2239 E584       +1  5378                             mov             a,p4
223B 4402       +1  5379                             orl             a,#02
223D F584       +1  5380                             mov             p4,a                     ;10-8..10-11 p4.1=1
223F 120000   F +1  5381     bret:      call          louizm         ;us если вкл кн ИЗМЕР
2242 22         +1  5382                             ret
2243            +1  5383     yestest:
2243 120000   F +1  5384                             call            lotpus          ;ус теста измерения
2246 22         +1  5385                             ret
                +1  5386                             
                +1  5387     ;загр ус для кор 0
                +1  5388     ;dptr-
2247 E4         +1  5389     lospus:         clr             a
                +1  5390                             ;movc   a,@a+dptr
                +1  5391                             ;mov            r2,a                    ;high byte
                +1  5392                             ;mov            a,p4
                +1  5393                             ;anl            a,#01
                +1  5394                             ;orl            a,r2
                +1  5395                             ;mov            p4,a
                +1  5396                             ;inc            dptr
2248 E4         +1  5397                             clr             a
2249 93         +1  5398                             movc    a,@a+dptr
224A FB         +1  5399                             mov             r3,a                    ;low byte
224B E585       +1  5400                             mov             a,p5
224D 54BF       +1  5401                             anl             a,#0bfh;01
224F 4B         +1  5402                             orl             a,r3
2250 F585       +1  5403                             mov             p5,a
2252 22         +1  5404                             ret
                +1  5405     
2253 80         +1  5406     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    86

                +1  5407     
                +1  5408     ;us кнопка измерения выкл
2254 88D6       +1  5409     tabus:     db           88h,0d6h         ;10-2
2256 88F6       +1  5410                             db      88h,0f6h         ;10-3
2258 88D6       +1  5411                             db              88h,0d6h         ;10-4
225A 88F6       +1  5412                             db              88h,0f6h         ;10-5
225C 9AD6       +1  5413                             db      9ah,0d6h         ;10-6
225E 9AF6       +1  5414                             db              9ah,0f6h         ;10-7
2260 ACD6       +1  5415                             db              0ach,0d6h        ;10-8
2262 ACF6       +1  5416                             db      0ach,0f6h        ;10-9
2264 C8D6       +1  5417                             db              0c8h,0d6h        ;10-10
2266 C8F6       +1  5418                             db              0c8h,0f6h        ;10-11
                +1  5419     
2268            +1  5420     tabt11: 
2268 66E6       +1  5421                             db              66h,0e6h;10-11
226A            +1  5422     tabt9:  
226A 32E6       +1  5423                             db              32h,0e6h;10-9
226C            +1  5424     tabt7:  
226C 18EE       +1  5425                             db              18h,0eeh;10-7
                +1  5426     
                +1  5427      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  5428     ;в зав от parT (Tизм)
226E 79B7       +1  5429     loadT:          mov             r1,#load;parT
2270 7840       +1  5430     lolevT:         mov             r0,#bufind+0
2272 7B0A       +1  5431                             mov             r3,#10
2274 75F00A     +1  5432                             mov             b,#10
2277 E7         +1  5433                             mov             a,@r1
2278 A4         +1  5434                             mul             ab
2279 FC         +1  5435                             mov             r4,a                    ;save a
227A 900000   F +1  5436                             mov             dptr,#textT
227D 93         +1  5437             lod1:   movc    a,@a+dptr
227E F6         +1  5438                             mov             @r0,a
227F 08         +1  5439                             inc             r0
2280 0C         +1  5440                             inc             r4
2281 EC         +1  5441                             mov             a,r4
2282 DBF9       +1  5442                             djnz    r3,lod1
2284 534B03     +1  5443                             anl                     bufind+11,#03h          ;гашение точек
2287 22         +1  5444                             ret     
                +1  5445     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  5446     ;dptr-адр строки текста         
2288            +1  5447     lotext:         
2288 7B0A       +1  5448                             mov             r3,#10
228A 7840       +1  5449                             mov             r0,#bufind+0
228C E4         +1  5450     lodt:           clr             a
228D 93         +1  5451                             movc    a,@a+dptr
228E F6         +1  5452                             mov             @r0,a
228F 08         +1  5453                             inc             r0
2290 A3         +1  5454                             inc             dptr
2291 DBF9       +1  5455                             djnz    r3,lodt
2293 534B03     +1  5456                             anl                     bufind+11,#03h          ;гашение точек
2296 22         +1  5457                             ret                                     
                +1  5458     
                +1  5459     
                +1  5460     
                +1  5461     
                +1  5462      ;задержка 100 мкс
2297 7978       +1  5463     z_100:    mov R1,#78h     ;загрузка первого числа
2299 7A02       +1  5464     z100:     mov R2,#2h     ;загрузка второго числа
229B DAFE       +1  5465     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
229D D9FA       +1  5466               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
229F 22         +1  5467               ret           
                +1  5468     
                +1  5469     ;задержка 34 мкс
22A0 7B8B       +1  5470     z_5:      mov R3,#8Bh      ;загрузка числа
22A2 DBFE       +1  5471     ct:       djnz R3,ct
22A4 22         +1  5472               ret
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    87

                +1  5473     
                +1  5474     ;задержка 15 мс
22A5 79FA       +1  5475     z_15:     mov R1,#0FAh    ;загрузка первого числа
22A7 7AED       +1  5476     z15:      mov R2,#0EDh   ;загрузка второго числа
22A9 DAFE       +1  5477     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
22AB D9FA       +1  5478               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
22AD 22         +1  5479               ret   
                +1  5480                                               
                +1  5481      ;задержка 1 мс
22AE 7910       +1  5482     z_1ms:     mov R1,#10h     
22B0 7AED       +1  5483     ss1:       mov R2,#0EDh    
22B2 DAFE       +1  5484                djnz R2, $    
22B4 D9FA       +1  5485                djnz R1, ss1   
22B6 22         +1  5486                ret   
                +1  5487     
                +1  5488      ;????????
                +1  5489     ;задержка 1с
22B7 7D1F       +1  5490     z_1s:   mov             r5,#01fh 
22B9 7EFF       +1  5491     co2s:   mov     R6,#0ffh     
22BB 7FFF       +1  5492     z1s:     mov    R7,#0ffh     
22BD DFFE       +1  5493     co1s:   djnz    R7, co1s        
22BF DEFA       +1  5494             djnz    R6, z1s 
22C1 DDF6       +1  5495                     djnz    r5,co2s
22C3 22         +1  5496               ret
                +1  5497     ;задержка 0,1с
22C4 7D03       +1  5498     z_01s:           mov            r5,#03h 
22C6 7EFF       +1  5499     co02s:          mov     R6,#0ffh     
22C8 7FFF       +1  5500     z01s:           mov     R7,#0ffh     
22CA DFFE       +1  5501                             djnz    R7, $   
22CC DEFA       +1  5502                     djnz    R6, z01s 
22CE DDF6       +1  5503                             djnz    r5,co02s
22D0 22         +1  5504                      ret
                +1  5505                                               
                +1  5506     ;задержка 0,5с
22D1 7D0D       +1  5507     z_05s:           mov            r5,#0dh 
22D3 7EFF       +1  5508     co05s:                  mov     R6,#0ffh     
22D5 7FFF       +1  5509     z05s:           mov     R7,#0ffh     
22D7 DFFE       +1  5510                                     djnz    R7, $   
22D9 DEFA       +1  5511                     djnz    R6, z05s 
22DB DDF6       +1  5512                                             djnz    r5,co05s
22DD 22         +1  5513                      ret                                                     
                +1  5514                                                               
22DE 000007FF   +1  5515     chzap:  db      00,00,07h,0ffh             
22E2 00000000   +1  5516     ch0:    db      00,00,00,00
22E6 0000000A   +1  5517     ch10:   db      00,00,00,0ah                            ;10
22EA 00000005   +1  5518     ch5:    db      00,00,00,05                                             ;5
22EE 00000004   +1  5519     ch4:    db      00,00,00,04                                             ;4
22F2 000003B9   +1  5520     ch954:  db 00,00,03,0b9h                                                ;954
22F6 000003E8   +1  5521     ch10000:        db 00,00,03h,0e8h                                               ;10000
22FA 00000064   +1  5522     ch100:  db 00,00,00,64h ;100
22FE 00000002   +1  5523     ch2:    db      00,00,00,02                                             
                +1  5524     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  5525     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  5526     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
2302 00000001   +1  5527     ch1:    db  00,00,00,01
2306 49742400   +1  5528     ch_mln: db      49h,74h,24h,00;10*6
230A 3F800000   +1  5529     ch_1:   db      3fh,80h,00,00   
230E 40000000   +1  5530     ch_2:   db      40h,00,00,00;2
2312 40800000   +1  5531     ch_4:   db      40h,80h,00,00;4 
2316 40A00000   +1  5532     ch_5:   db      40h,0a0h,00,00;5
231A 40E00000   +1  5533     ch_7:   db      40h,0e0h,00,00;7
                +1  5534             
231E 3F741EDF   +1  5535     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
2322 47C35000   +1  5536     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
2326 3F800347   +1  5537     KD:             db      3fh,80h,03h,47h;1,0001
232A 48435000   +1  5538     CH2tho: db      48h,43h,50h,00;200000
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    88

232E 4856D800   +1  5539     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
2332 4856D800   +1  5540     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
2336 461C4000   +1  5541     ch_10th:db  46h,1ch,40h,00;10000-2710h
233A 41200000   +1  5542     ch_10:  db      41h,20h,00,00;10d
233E 48742400   +1  5543     ch_250: db      48h,74h,24h,00;250000
2342 000186A0   +1  5544     chk:            db      00,01,86h,0a0h;
2346 00000320   +1  5545     ch320h: db      00,00,03h,20h;320h=800d
234A 00000150   +1  5546     ch150h: db      00,00,01h,50h;150h
234E C0400000   +1  5547     ch_m3:  db      0c0h,40h,00,00;-3
                +1  5548     
                +1  5549     
                +1  5550     ;r1- мл байт 2х байтного числа
2352            +1  5551     tenmin:         ;-10
2352 C3         +1  5552                             clr             c
2353 E7         +1  5553                     mov             a,@r1
2354 9405       +1  5554                             subb    a,#5;10
2356 F7         +1  5555                             mov             @r1,a
2357 19         +1  5556                             dec             r1
2358 E7         +1  5557                             mov             a,@r1
2359 9400       +1  5558                             subb    a,#0
235B F7         +1  5559                             mov             @r1,a
235C 22         +1  5560                             ret
                +1  5561       ;r0-обнуление ячеек памяти  
235D 7F04       +1  5562       clear4:        mov    r7,#4
235F E4         +1  5563                             clr             a
2360 F6         +1  5564       cl4:          mov             @r0,a
2361 08         +1  5565                             inc             r0
2362 DFFC       +1  5566                             djnz    r7,cl4
2364 22         +1  5567                             ret     
                +1  5568     
                +1  5569      ;r0-обнуление ячеек памяти 
                +1  5570      ;R7- 
2365            +1  5571       clearN:        
2365 E4         +1  5572                             clr             a
2366 F6         +1  5573       cl4N:         mov             @r0,a
2367 08         +1  5574                             inc             r0
2368 DFFC       +1  5575                             djnz    r7,cl4N
236A 22         +1  5576                             ret     
                +1  5577     
                +1  5578       ;чтение номера байта с индикатора(2байта)
                +1  5579     ;bufind+8..bufind+9
                +1  5580     ;-  - - -
                +1  5581     ;- - - - - - - - - -
                +1  5582     ;adec..adec+9
                +1  5583     ;ст            мл
236B 7848       +1  5584     upak2:  mov             r0,#bufind+8;
236D 795C       +1  5585                     mov             r1,#adec+9
236F 7F02       +1  5586                     mov             r7,#2;2bait
2371 C3         +1  5587     upa2:   clr             c
2372 E6         +1  5588                     mov             a,@r0
2373 9430       +1  5589                     subb    a,#30h
2375 F7         +1  5590                     mov             @r1,a
2376 18         +1  5591                     dec             r0
2377 19         +1  5592                     dec             r1
2378 DFF7       +1  5593                     djnz    r7,upa2
237A 22         +1  5594                     ret  
                +1  5595     
                +1  5596     
                +1  5597         
                +1  5598      ;bufind+4..bufind+9
                +1  5599     ;-  - - -
                +1  5600     ;- - - - - - - - - -
                +1  5601     ;adec..adec+9
                +1  5602     ;ст            мл
237B 7849       +1  5603     upak:   mov             r0,#bufind+9;
237D 795C       +1  5604                     mov             r1,#adec+9
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    89

237F 7F06       +1  5605                     mov             r7,#6
2381 C3         +1  5606     upa:    clr             c
2382 E6         +1  5607                     mov             a,@r0
2383 9430       +1  5608                     subb    a,#30h
2385 F7         +1  5609                     mov             @r1,a
2386 18         +1  5610                     dec             r0
2387 19         +1  5611                     dec             r1
2388 DFF7       +1  5612                     djnz    r7,upa
238A 22         +1  5613                     ret
                +1  5614     
                +1  5615      ;чтение номера байта с индикатора(3байта)
                +1  5616     ;bufind+3..bufind+9
                +1  5617     ;-  - - -
                +1  5618     ;- - - - - - - - - -
                +1  5619     ;adec..adec+9
                +1  5620     ;ст            мл
238B 7849       +1  5621     upak3:  mov             r0,#bufind+9;
238D 795C       +1  5622                     mov             r1,#adec+9
238F 7F03       +1  5623                     mov             r7,#3;3bait
2391 C3         +1  5624     upa1:   clr             c
2392 E6         +1  5625                     mov             a,@r0
2393 9430       +1  5626                     subb    a,#30h
2395 F7         +1  5627                     mov             @r1,a
2396 18         +1  5628                     dec             r0
2397 19         +1  5629                     dec             r1
2398 DFF7       +1  5630                     djnz    r7,upa1
239A 22         +1  5631                     ret
                +1  5632     
                +1  5633     ;вых-r2,r3-адрес ячее памяти прогр
239B            +1  5634     findkoef:
239B 79AE       +1  5635                                     mov             r1,#diap
239D E7         +1  5636                                     mov             a,@r1
239E 23         +1  5637                                     rl              a                                          
                                          ;diap*2(2bait )
239F FC         +1  5638                                     mov             r4,a                                    ;sa
                             ve
23A0 900000   F +1  5639                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  5640                                     
23A3 93         +1  5641                                     movc    a,@a+dptr                       ;ст байт
23A4 FA         +1  5642                                     mov             r2,a
23A5 A3         +1  5643                                     inc             dptr
23A6 EC         +1  5644                                     mov             a,r4
23A7 93         +1  5645                                     movc    a,@a+dptr
23A8 FB         +1  5646                                     mov             r3,a                    ;мл байт
23A9 22         +1  5647                                     ret
                +1  5648     ;r2..r5 в опр яч внешн озу
23AA            +1  5649     findext:
23AA 79AE       +1  5650                                     mov             r1,#diap
23AC E7         +1  5651                                     mov             a,@r1
23AD 23         +1  5652                                     rl              a                                          
                                          ;diap*2(2bait )
23AE 23         +1  5653                                     rl              a                                          
                                          ;diap*2(2bait )
23AF F9         +1  5654                                     mov             r1,a                                    ;r1
                             -номер ячейки внешнего озу
                +1  5655                                     
23B0 22         +1  5656                                     ret
                +1  5657     
                +1  5658     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  5659     ;(5000h..5027h)
23B1 5000       +1  5660     diKDw:  dw              5000h                   ;10-2
23B3 5004       +1  5661                                     dw              5004h                   ;10-3
23B5 5008       +1  5662                                     dw              5008h                   ;10-4
23B7 500C       +1  5663                                     dw              500ch                   ;10-5
23B9 5010       +1  5664                                     dw              5010h                   ;10-6
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    90

23BB 5014       +1  5665                                     dw              5014h                   ;10-7
23BD 5018       +1  5666                                     dw              5018h                   ;10-8
23BF 501C       +1  5667                                     dw              501ch                   ;10-9
23C1 5020       +1  5668                                     dw              5020h                   ;10-10
23C3 5024       +1  5669                                     dw              5024h                   ;10-11
23C5 5028       +1  5670     dipar:  dw              5028h                   ;parol
23C7 502C       +1  5671     diKm:           dw              502ch                   ;Km для теста измерения
23C9 000186A0   +1  5672     chthou: db      00,01,86h,0a0h  ;100.000
                +1  5673     
23CD AA08       +1  5674     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
23CF AB09       +1  5675                                             mov     r3,ltemp+1
23D1 AC0A       +1  5676                                             mov     r4,ltemp+2
23D3 AD0B       +1  5677                                             mov     r5,ltemp+3
23D5 22         +1  5678                                             ret
                +1  5679     ;bufind+4..bufind+9
                +1  5680     ;-  - - -
                +1  5681     ;- - - - - - - - - -
                +1  5682     ;adec..adec+9
                +1  5683     ;ст            мл
23D6 7847       +1  5684     upakA:  mov             r0,#bufind+7;
23D8 795C       +1  5685                     mov             r1,#adec+9
23DA 7F04       +1  5686                     mov             r7,#4
23DC C3         +1  5687     upaa4:  clr             c
23DD E6         +1  5688                     mov             a,@r0
23DE 9430       +1  5689                     subb    a,#30h
23E0 F7         +1  5690                     mov             @r1,a
23E1 18         +1  5691                     dec             r0
23E2 19         +1  5692                     dec             r1
23E3 DFF7       +1  5693                     djnz    r7,upaa4
23E5 22         +1  5694                     ret
                +1  5695     
                +1  5696     ;bufind+4..bufind+9
                +1  5697     ;-  - - -
                +1  5698     ;- - - - - - - - - -
                +1  5699     ;adec..adec+9
                +1  5700     ;ст            мл
23E6 7848       +1  5701     upakB:  mov             r0,#bufind+8;
23E8 795C       +1  5702                     mov             r1,#adec+9
23EA 7F05       +1  5703                     mov             r7,#5
23EC C3         +1  5704     upab:   clr             c
23ED E6         +1  5705                     mov             a,@r0
23EE 9430       +1  5706                     subb    a,#30h
23F0 F7         +1  5707                     mov             @r1,a
23F1 18         +1  5708                     dec             r0
23F2 19         +1  5709                     dec             r1
23F3 DFF7       +1  5710                     djnz    r7,upab
23F5 C21B       +1  5711                     clr                     bitznB
23F7 E543       +1  5712                     mov             a,bufind+3
23F9 B42D02     +1  5713                     cjne            a,#2dh,abret
23FC D21B       +1  5714                     setb            bitznB
23FE            +1  5715     abret:
23FE 22         +1  5716                     ret
23FF            +1  5717     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
23FF 4E6E6AA8   +1  5718                                             db      4eh,6eh,6ah,0a8h;10**9
2403 43FA0000   +1  5719     CH_500:         db              43h,0fah,00,00;1fah=500
2407 4856D800   +1  5720     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
240B 49742400   +1  5721     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  5722     
                +1  5723     
                +1  5724     
                +1  5725     ;управление AD7731
                +1  5726     ;r4=b1 r5=b2
240F            +1  5727     iniacp: ;управление AD7731
240F 7403       +1  5728                             mov             a,#03
                +1  5729     
2411 120000   F +1  5730                             call    write
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    91

2414 EC         +1  5731                             mov             a,r4;#80h
2415 120000   F +1  5732                             call    write
2418 ED         +1  5733                             mov             a,r5;#04
2419 120000   F +1  5734                             call    write
241C 7402       +1  5735                             mov             a,#02
241E 120000   F +1  5736                             call    write
2421 74A1       +1  5737                             mov             a,#0a1h
2423 120000   F +1  5738                             call    write
2426 7474       +1  5739                             mov             a,#74h
2428 120000   F +1  5740                             call    write
242B 2095FD     +1  5741                             jb              p1.5,$;p1.3,$
242E 7402       +1  5742                             mov             a,#02
2430 120000   F +1  5743                             call    write
2433 7481       +1  5744                             mov             a,#81h
2435 120000   F +1  5745                             call    write
2438 7474       +1  5746                             mov             a,#74h
243A 120000   F +1  5747                             call    write
243D 2095FD     +1  5748                             jb              p1.5,$;p1.3,$
2440 7402       +1  5749                             mov             a,#02
2442 120000   F +1  5750                             call    write
2445 7421       +1  5751                             mov             a,#21h
2447 120000   F +1  5752                             call    write
244A 7474       +1  5753                             mov             a,#74h
244C 120000   F +1  5754                             call    write
244F 22         +1  5755                             ret
                +1  5756                             ;;;;;;;;;;;;;;;;
                +1  5757     ;;;;;;;;;;;;;;;;;
                +1  5758     ;;;;;;;;;;;;;;;;;
2450 0000       +1  5759     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
2452 6000       +1  5760                                     db              60h,00h;40h,04h         ;10s
2454 6000       +1  5761                                     db              60h,00;40h,04h          ;1s
2456 6000       +1  5762                                     db              60h,00h;40h,04h         ;0,1s
2458 6000       +1  5763                                     db              60h,00h;20h,04h         ;50ms
245A 6000       +1  5764                                     db              60h,00h;20h,04h          ;10ms
245C 1332       +1  5765                                     db              13h,32h         ;2ms
                +1  5766     
                +1  5767     ;загр В1,В2 в завис от Т                                
245E 799A       +1  5768     loab12:                 mov             r1,#parT
2460 900000   F +1  5769                                     mov             dptr,#tabB1_2
2463 E7         +1  5770                                     mov             a,@r1
2464 23         +1  5771                                     rl              a;*2
2465 FF         +1  5772                                     mov             r7,a                    ;save a
2466 93         +1  5773                                     movc    a,@a+dptr
2467 FC         +1  5774                                     mov             r4,a   ;b1
2468 0F         +1  5775                                     inc             r7
2469 EF         +1  5776                                     mov             a,r7
246A 93         +1  5777                                     movc    a,@a+dptr
246B FD         +1  5778                                     mov             r5,a
                +1  5779                                     ;после загр В1,2 загр упр слово для нового Т
                +1  5780                             
246C 22         +1  5781                                     ret
                +1  5782     
                +1  5783     
246D 7852       +1  5784     loadr2: mov             r0,#abin+3              ;r2..r5
246F E6         +1  5785                     mov             a,@r0                   ; ст мл   
2470 FA         +1  5786                     mov             r2,a
2471 18         +1  5787                     dec             r0
2472 E6         +1  5788                     mov             a,@r0
2473 FB         +1  5789                     mov             r3,a
2474 18         +1  5790                     dec             r0
2475 E6         +1  5791                     mov             a,@r0
2476 FC         +1  5792                     mov             r4,a
2477 18         +1  5793                     dec             r0
2478 E6         +1  5794                     mov             a,@r0
2479 FD         +1  5795                     mov             r5,a
247A 22         +1  5796                     ret
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    92

                +1  5797                                             
                +1  5798      ;;;;;;;;;;;;;;;;;;;      
                +1  5799      ;загрузка KD в зависимости от диап изм  
                +1  5800      ;koef->r8..r11
247B 78AE       +1  5801     loadKD:                 mov             r0,#diap
247D E6         +1  5802                                     mov             a,@r0
247E 900000   F +1  5803                                     mov             dptr,#diKDn
2481 75F004     +1  5804                                     mov             b,#4
2484 A4         +1  5805                                     mul             ab
2485 FF         +1  5806                                     mov             r7,a;save
2486 93         +1  5807                                     movc    a,@a+dptr
2487 F508       +1  5808                                     mov             r8,a
2489 A3         +1  5809                                     inc             dptr
248A EF         +1  5810                                     mov             a,r7
248B 93         +1  5811                                     movc    a,@a+dptr
248C F509       +1  5812                                     mov             r9,a
248E A3         +1  5813                                     inc             dptr
248F EF         +1  5814                                     mov             a,r7
2490 93         +1  5815                                     movc    a,@a+dptr
2491 F50A       +1  5816                                     mov             r10,a
2493 A3         +1  5817                                     inc             dptr
2494 EF         +1  5818                                     mov             a,r7
2495 93         +1  5819                                     movc    a,@a+dptr
2496 F50B       +1  5820                                     mov             r11,a
2498 22         +1  5821                                     ret
                +1  5822     
2499 3F506B7B   +1  5823      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
249D 3F507FCC   +1  5824                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
24A1 3F4F9D0B   +1  5825                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
24A5 3F4FE869   +1  5826                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
24A9 3F50294A   +1  5827                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
24AD 3F50639E   +1  5828                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
24B1 3F4BC9F0   +1  5829                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
24B5 3F4C063B   +1  5830                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
24B9 3F50EFDD   +1  5831                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
24BD 3F512AD9   +1  5832                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  5833     
24C1 00000039   +1  5834     ch57:   db      00,00,00,39h;57
24C5 00000014   +1  5835     ch20:   db      00,00,00,14h;20
                +1  5836     
                +1  5837     ;загр ус для тестов ацп 
                +1  5838     ;dptr-
24C9 78B1       +1  5839     lotpus: mov             r0,#vichR
24CB B6210D     +1  5840                                     cjne    @r0,#21h,te22
24CE 900000   F +1  5841                                     mov                     dptr,#tabt11;заслать ус 11А
24D1 E4         +1  5842     lotp:           clr             a
24D2 93         +1  5843                             movc    a,@a+dptr                               ;high byte
24D3 F584       +1  5844                             mov             p4,a
24D5 A3         +1  5845                             inc             dptr
24D6 E4         +1  5846                             clr             a
24D7 93         +1  5847                             movc    a,@a+dptr                               ;low byte
24D8 F585       +1  5848                             mov             p5,a
24DA 22         +1  5849                             ret
24DB B62205     +1  5850     te22:                   cjne    @r0,#22h,te23
24DE 900000   F +1  5851                             mov                     dptr,#tabt9;заслать ус 9А       
24E1 80EE       +1  5852                             jmp                     lotp
                +1  5853     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    93

24E3 900000   F +1  5854     te23:   mov                     dptr,#tabt7;заслать ус 7А       
24E6 80E9       +1  5855                             jmp                     lotp
                +1  5856     
                +1  5857     
                +1  5858     
                +1  5859     
                +1  5860     
24E8 02030405   +1  5861     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
24EC 06070809                
24F0 0A0B                    
                +1  5862     
24F2 78AE       +1  5863     findR:                  mov                     r0,#diap
24F4 E6         +1  5864                                                     mov                     a,@r0
24F5 900000   F +1  5865                                                     mov                     dptr,#Tabn
24F8 93         +1  5866                                                     movc            a,@a+dptr
24F9 22         +1  5867                                                     ret
                +1  5868     ;bufind=30h..39h                                                                           
                                           ;
24FA C219       +1  5869     vvchif:                 clr             bitmig
24FC 79B2       +1  5870                                     mov             r1,#marker
24FE E7         +1  5871                                     mov             a,@r1                   ;изм цифры
24FF 7840       +1  5872                                     mov             r0,#bufind                      ;0000
2501 28         +1  5873                                     add             a,r0
2502 F8         +1  5874                                     mov             r0,a
2503 06         +1  5875                                     inc             @r0
2504 B63A03     +1  5876                                     cjne    @r0,#3ah,chif
2507 7630       +1  5877                                     mov             @r0,#30h
2509 22         +1  5878                                     ret
250A C3         +1  5879     chif:           clr                     c
250B 7430       +1  5880                                     mov                     a,#30h
250D 96         +1  5881                                     subb            a,@r0
250E 4002       +1  5882                                     jc                      chif5
2510 7630       +1  5883                                     mov             @r0,#30h
2512 22         +1  5884     chif5:  ret
                +1  5885     
2513 80E5       +1  5886     vvnol41:        jmp                     vvchif  ;при наборе цифр в интервале и константах
                +1  5887     
2515 B641FB     +1  5888     vvnol31:        cjne            @r0,#41h,vvnol41
2518 800A       +1  5889                                             jmp                     chifour
251A B631F8     +1  5890     vvnol23:        cjne            @r0,#31h,vvnol31
251D 8005       +1  5891                                             jmp                     chifour 
                +1  5892     
251F 78B0       +1  5893     vvchibl:        mov                     r0,#level
2521 B623F6     +1  5894                                             cjne            @r0,#23h,vvnol23;при наборе цифр в 
                             блоке
2524 C219       +1  5895     chifour:                clr             bitmig
2526 79B2       +1  5896                                     mov             r1,#marker
2528 E7         +1  5897                                     mov             a,@r1                   ;изм цифры
2529 7840       +1  5898                                     mov             r0,#bufind                      ;1..4
252B 28         +1  5899                                     add             a,r0
252C F8         +1  5900                                     mov             r0,a
252D 06         +1  5901                                     inc             @r0
252E B63504     +1  5902                                     cjne    @r0,#35h,chifb
2531 7631       +1  5903                                     mov             @r0,#31h
2533 8006       +1  5904                                     jmp             chifb1
2535 B63003     +1  5905     chifb:  cjne    @r0,#30h,chifb1
2538 7631       +1  5906                                     mov             @r0,#31h
253A 22         +1  5907                                     ret
253B            +1  5908     chifb1:;;;;;;;;;;
253B C3         +1  5909                                     clr                     c
253C 7430       +1  5910                                     mov                     a,#30h
253E 96         +1  5911                                     subb            a,@r0
253F 4002       +1  5912                                     jc                      chifl5
2541 7630       +1  5913                                     mov             @r0,#30h
                +1  5914                                     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    94

2543 22         +1  5915     chifl5: ret
                +1  5916     ;;;;;;;;;;;;;
2544 22         +1  5917             ret
                +1  5918       ;перевод маркера влево
2545            +1  5919     marle:  
2545 C219       +1  5920                     clr             bitmig
                +1  5921                     ;mov            savba,#0   нельзя обнулять
2547 78B2       +1  5922             mov             r0,#marker
2549 16         +1  5923                     dec             @r0
254A E6         +1  5924                     mov             a,@r0
254B C3         +1  5925                     clr             c
254C 953A       +1  5926                     subb    a,movleft         ;крайне левое положение
254E 5001       +1  5927                     jnc             rler
2550 06         +1  5928                     inc             @r0
2551 22         +1  5929     rler:   ret
                +1  5930         
                +1  5931     ;перевод маркера вправо
2552 C219       +1  5932     marri:  clr             bitmig
2554 78B2       +1  5933                     mov             r0,#marker
2556 06         +1  5934                     inc         @r0
2557 E53B       +1  5935                     mov             a,movrig           ;крайне правое положение
2559 C3         +1  5936                     clr             c
255A 96         +1  5937                     subb    a,@r0
255B 5001       +1  5938                     jnc             rrir
255D 16         +1  5939                     dec             @r0
255E 22         +1  5940     rrir:   ret
                +1  5941         
                +1  5942     ;konstA->bufind+4..bufind+7
255F 78BC       +1  5943     outA:           mov                     r0,#konstA
2561 120000   F +1  5944                                     call            resar2
2564 120343     +1  5945                                     call            ftol                    ;->hex
2567 784F       +1  5946                                     mov             r0,#abin
2569 120000   F +1  5947                                     call            saver2
256C 7853       +1  5948                                     mov                     r0,#adec
256E 7952       +1  5949                                     mov             r1,#abin+3
2570 120000   F +1  5950                                     call            bindec
2573 785C       +1  5951                                     mov                     r0,#adec+9
2575 7947       +1  5952                                     mov                     r1,#bufind+7
2577 7F04       +1  5953                                     mov                     r7,#4
2579 E6         +1  5954     outa2:  mov             a,@r0
257A 2430       +1  5955                               add           a,#30h
257C F7         +1  5956                                     mov             @r1,a
257D 19         +1  5957                                     dec             r1
257E 18         +1  5958                                     dec             r0
257F DFF8       +1  5959                                     djnz    r7,outa2
2581 22         +1  5960                                     ret
                +1  5961                                             
                +1  5962     ;konstB->bufind+4..bufind+8
                +1  5963     ;outB:          mov                     r0,#konstB
                +1  5964     ;                               call            resar2
                +1  5965     ;                               mov                     a,r2
                +1  5966     ;                               anl                     a,#80h
                +1  5967     ;                               jz                      outb3
                +1  5968     ;mov                    a,r2
                +1  5969     ;                               anl                     a,#7fh
                +1  5970     ;                               mov                     r2,a
                +1  5971     ;                               mov                     bufind+3,#2dh
                +1  5972     ;outb3: call            ftol                    ;->hex
                +1  5973     ;                               mov             r0,#abin
                +1  5974     ;                               call            saver2
                +1  5975     ;                               mov                     r0,#adec
                +1  5976     ;                               mov             r1,#abin+3
                +1  5977     ;                               call            bindec
                +1  5978     ;                               mov                     r0,#adec+9
                +1  5979     ;                               mov                     r1,#bufind+8
                +1  5980     ;                               mov                     r7,#5
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    95

                +1  5981     ;outb2: mov             a,@r0
                +1  5982     ;                         add           a,#30h
                +1  5983     ;                               mov             @r1,a
                +1  5984     ;                               dec             r1
                +1  5985     ;                               dec             r0
                +1  5986     ;                               djnz    r7,outb2
                +1  5987     ;                               ret
                +1  5988     
                +1  5989     
                +1  5990     ;пп мигания индикации
2582 78B2       +1  5991     mign:           mov             r0,#marker
                +1  5992                                     
2584 B6FF03     +1  5993                                     cjne    @r0,#0ffh,mignn
                +1  5994                                     ;реж изм мигает *
2587 C219       +1  5995                                     clr             bitmig
2589 22         +1  5996                                     ret
                +1  5997     
258A            +1  5998     mignn:                  ;clr            c
258A 7440       +1  5999                                     mov             a,#bufind
258C 26         +1  6000                                     add             a,@r0                   ;a=bufind+marker
258D F9         +1  6001                                     mov             r1,a
258E 201907     +1  6002                                     jb              bitmig,onmig
2591 873C       +1  6003                                     mov             savba,@r1
                +1  6004                             ;       mov             a,@r1
                +1  6005                             ;       mov             savba,a
2593 7720       +1  6006                                     mov             @r1,#" "
                +1  6007                                     
2595 D219       +1  6008                                     setb    bitmig
2597 22         +1  6009                                     ret
                +1  6010     
2598 A73C       +1  6011     onmig:                  mov             @r1,savba
                +1  6012                                     ;mov            a,savba
                +1  6013                                     ; mov           @r1,a
259A C219       +1  6014                                     clr             bitmig
259C 120000   F +1  6015                                     call    z_01s
259F 22         +1  6016                                     ret
                +1  6017     ;номер ошибки bufind+6
25A0 900000   F +1  6018     error:          mov             dptr,#teERR
25A3 120000   F +1  6019                                             call    lotext
25A6 853946     +1  6020                                             mov             bufind+6,nuerr
25A9 22         +1  6021                                     ret
                +1  6022     
                +1  6023     
25AA            +1  6024     textT:          
25AA FD543D32   +1  6025     te2ms:                  db              0fdh,"T","=",32h,"m",67h,0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
25AE 6D67FDFD                
25B2 FDFD                    
25B4 FD543D31   +1  6026     te10ms:                 db              0fdh,"T","=",31h,30h,"m",67h,0fdh,0fdh,0fdh
25B8 306D67FD                
25BC FDFD                    
25BE FD543D35   +1  6027                             db              0fdh,"T","=",35h,30h,"m",67h,0fdh,0fdh,0fdh
25C2 306D67FD                
25C6 FDFD                    
25C8 FD543D64   +1  6028                             db              0fdh,"T","=",64h,31h,67h,0fdh,0fdh,0fdh,0fdh
25CC 3167FDFD                
25D0 FDFD                    
25D2 20202054   +1  6029                             db              " "," "," ","T","=",31h,67h," "," "," "
25D6 3D316720                
25DA 2020                    
25DC 2020543D   +1  6030                             db              " "," ","T","=",31h,30h,67h," "," "," "  
25E0 31306720                
25E4 2020                    
                +1  6031     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                +1  6032     
25E6 42753474   +1  6033     teVICH: db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    96

25EA 79767454                
25EE 7720                    
25F0 20553D20   +1  6034     teAequ0:        db              " ",'U','='," "," "," "," "," "," ",65h
25F4 20202020                
25F8 2065                    
25FA 20423D2B   +1  6035     teBequ0:        db              " ",'B','=','+'," "," "," "," "," "," "
25FE 20202020                
2602 2020                    
2604 20207145   +1  6036     teMENU: db              " "," ",71h,"E","H",72h," "," "," "," "
2608 48722020                
260C 2020                    
                +1  6037     
260E 20544579   +1  6038     teTESI: db      " ","T","E",79h,"T",2dh,74h,33h,71h," ";ТЕСТ -ИЗМ    11
2612 542D7433                
2616 7120                    
2618 54457954   +1  6039     teTESR: db      "T","E",79h,"T"," ","R",35h," "," "," ";ТЕСТ RS 12
261C 20523520                
2620 2020                    
2622 20794B30   +1  6040     teSKOR: db      " ",79h,'K',30h,"P"," ","R",35h," "," ";СКОР 232      13
2626 50205235                
262A 2020                    
262C 20204142   +1  6041     teAVK:  db      " "," ",'A','B','K'," "," "," "," "," "  ;AВK                              
                                  14
2630 4B202020                
2634 2020                    
2636 204B4176   +1  6042     teKALIB:         db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР    15
263A 74735020                
263E 202020                  
                +1  6043     
2641 20544579   +1  6044     teTE11:         db              " ",'T',"E",79h,'T'," "," "," ",'T',31h;          21
2645 54202020                
2649 5431                    
264B 20544579   +1  6045     teTE9:          db              " ",'T',"E",79h,'T'," "," "," ",'T',32h;                   
                                                  22
264F 54202020                
2653 5432                    
2655 20544579   +1  6046     teTE7:          db              " ",'T',"E",79h,'T'," "," "," ",'T',33h;                   
                                                  23
2659 54202020                
265D 5433                    
                +1  6047     
                +1  6048     
265F 20202035   +1  6049     teS57_6:                db              " "," "," ",35h,37h,36h," "," "," "," ";57.6
2663 37362020                
2667 2020                    
2669 20202031   +1  6050     teS19_2:                db              " "," "," ",31h,39h,32h," "," "," "," ";19,2
266D 39322020                
2671 2020                    
                +1  6051     
2673 61415030   +1  6052     tePAR:          db              61h,'A',"P",30h,76h,77h," ",30h,30h,30h;пароль
2677 76772030                
267B 3030                    
267D 20303030   +1  6053     teKD:                   db              " ",30h,30h,30h,30h,30h," "," "," ",'A';00000
2681 30302020                
2685 2041                    
2687 74337120   +1  6054     teIZMK: db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
268B 4B304879                
268F 5420                    
2691 20204275   +1  6055     teOUT:          db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
2695 58307820                
2699 2020                    
269B 2020304C   +1  6056     teOLL:          db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
269F 4C202020                
26A3 2020                    
26A5 20203034   +1  6057     teCLE:          db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
26A9 7479544B                
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    97

26AD 4120                    
26AF 20203041   +1  6058     teMEM:          db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
26B3 71795420                
26B7 20203341   +1  6059     teWR:           db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
26BB 61747977                
26BF 2020                    
26C1 20206150   +1  6060     teLIST: db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
26C5 30797130                
26C9 545020                  
26CC 20206130   +1  6061     teFULL: db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
26D0 76484162                
26D4 2020                    
26D6 20744854   +1  6062     teINT:  db      " ",74h,"H",'T'," ",30h,30h,30h,30h,67h;ИНТ 0000
26DA 20303030                
26DE 3067                    
26E0 20207376   +1  6063     teBL:           db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
26E4 304B2020                
26E8 2020                    
26EA 20207376   +1  6064     teBL0:  db      " "," ",73h,76h,30h,'K'," ",30h," "," ";БЛОК 0
26EE 304B2030                
26F2 2020                    
26F4 30547934   +1  6065     teCH:           db      30h,'T',79h,34h,"E",'T'," ",30h,30h,31h;ОТСЧЕТ 001
26F8 45542030                
26FC 3031                    
26FE 79544154   +1  6066     teSTAT:         db      79h,'T','A','T',74h,79h,'T',74h,'K','A';СТАТИСТИКА
2702 74795474                
2706 4B41                    
2708 71744820   +1  6067     teMIN:  db      71h,74h,"H"," "," "," "," "," "," "," ";МИН  00000
270C 20202020                
2710 2020                    
2712 71414B79   +1  6068     teMAX:  db      71h,'A','K',79h," "," "," "," "," "," ";МАКС 00000
2716 20202020                
271A 2020                    
271C 79504578   +1  6069     teMID:  db      79h,"P","E",78h," "," "," "," "," "," ";СРЕД 00000
2720 20202020                
2724 2020                    
                +1  6070      ;;;;;;;;;;;;;;;;;;;         
2726 2020304C   +1  6071     teOLI:  db              " "," ",30h,"L","L"," ","I"," "," "," "
272A 4C204920                
272E 2020                    
2730 2020304C   +1  6072     teOLR:  db              " "," ",30h,"L","L"," ",66h," "," "," "
2734 4C206620                
2738 2020                    
273A 20204552   +1  6073     teERR:  db              " "," ","E","R","R"," "," "," "," "," " ;ERR
273E 52202020                
2742 2020                    
2744 2020454E   +1  6074     teEND:  db              " "," ","E","N","D"," "," "," "," "," " ;END
2748 44202020                
274C 2020                    
                +1  6075     
                +1  6076     ;dptr+4-приемник
                +1  6077     ;dptr-источник
                +1  6078     ;r7-кол байт  
274E            +1  6079     xCIKLWR:
274E 7F04       +1  6080                             mov             r7,#4   
2750 E0         +1  6081     lwrx:   movx    a,@dptr
2751 C083       +1  6082                             push    dph
2753 C082       +1  6083                             push    dpl
2755 A3         +1  6084                             inc             dptr
2756 A3         +1  6085                             inc             dptr
2757 A3         +1  6086                             inc             dptr
2758 A3         +1  6087                             inc             dptr
2759 F0         +1  6088                             movx    @dptr,a
275A D082       +1  6089                             pop             dpl
275C D083       +1  6090                             pop             dph
                +1  6091                             
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    98

275E A3         +1  6092                             inc             dptr
275F DFEF       +1  6093                             djnz    r7,lwrx
2761 22         +1  6094                             ret
                +1  6095     ;r2..r5->@dptr..@dptr+3                         
2762 EA         +1  6096     saveIr2:                mov     a,r2
2763 F0         +1  6097                                             movx    @dptr,a
2764 A3         +1  6098                                             inc     dptr
2765 EB         +1  6099                                             mov     a,r3
2766 F0         +1  6100                                             movx    @dptr,a
2767 A3         +1  6101                                             inc     dptr
2768 EC         +1  6102                                             mov     a,r4
2769 F0         +1  6103                                             movx    @dptr,a
276A A3         +1  6104                                             inc     dptr
276B ED         +1  6105                                             mov     a,r5
276C F0         +1  6106                                             movx    @dptr,a
276D 22         +1  6107                                             ret
                +1  6108     ;r2..r5-> @r0..@r0+3
                +1  6109     
276E EA         +1  6110     saver2:         mov     a,r2
276F F6         +1  6111                                             mov     @r0,a
2770 08         +1  6112                                             inc     r0
2771 EB         +1  6113                                             mov     a,r3
2772 F6         +1  6114                                             mov     @r0,a
2773 08         +1  6115                                             inc     r0
2774 EC         +1  6116                                             mov     a,r4
2775 F6         +1  6117                                             mov     @r0,a
2776 08         +1  6118                                             inc     r0
2777 ED         +1  6119                                             mov     a,r5
2778 F6         +1  6120                                             mov     @r0,a
2779 22         +1  6121                                             ret 
277A 7F50       +1  6122     clmassix:       mov                     r7,#50h;28h
277C 900100     +1  6123                             mov     dptr,#MASS0        ;забить массив A нулями
277F 7400       +1  6124     clmax:          mov          a,#00h
2781 F0         +1  6125                  movx    @dptr,a
2782 A3         +1  6126                  inc     dptr
2783 DFFA       +1  6127                 djnz                r7,clmax                
2785 F56E       +1  6128                  mov     chmas,a
2787 C201       +1  6129                  clr     bitmas
2789 22         +1  6130                 ret
                +1  6131     ;r1-яЁшхьшъ
                +1  6132     ;r0-шёЄюўшъ
                +1  6133     ;r7-ъюы срщЄ  
278A            +1  6134     CIKLWR:
278A 7F04       +1  6135                             mov             r7,#4   
278C E6         +1  6136     lwr:    mov     a,@r0
278D F7         +1  6137                             mov     @r1,a
278E 09         +1  6138                             inc             r1
278F 08         +1  6139                             inc             r0
2790 DFFA       +1  6140                             djnz    r7,lwr
2792 22         +1  6141                             ret     
                +1  6142     ;r2..r5-> @dptr..@dptr+3
                +1  6143     
2793 120000   F +1  6144     zmul:   call    maform
2796 120000   F +1  6145                     call    lmul
2799 120000   F +1  6146                     call    bform
279C 22         +1  6147                     ret
                +1  6148     
279D 120000   F +1  6149     zdiv:   call    maform
27A0 120000   F +1  6150                     call    divide
27A3 120000   F +1  6151                     call    bform
27A6 22         +1  6152                     ret
                +1  6153     
27A7 EA         +1  6154     maform: mov a,r2
27A8 33         +1  6155             rlc a
27A9 5006       +1  6156             jnc             fo1m
27AB D202       +1  6157                     setb            znmat
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE    99

27AD 120000   F +1  6158                     call   form4
27B0 22         +1  6159                     ret
27B1 C202       +1  6160     fo1m:   clr             znmat
27B3 22         +1  6161                     ret
                +1  6162     
27B4 300203     +1  6163     bform:  jnb             znmat,fo2m
27B7 120000   F +1  6164                     call    form4
27BA 22         +1  6165     fo2m:   ret
                +1  6166       
                +1  6167     ;r2..r5 яхЁхтхёЄш т фюя ъюф
27BB ED         +1  6168     form4:          mov a,r5
27BC F4         +1  6169             cpl a
27BD 2401       +1  6170             add a,#1
27BF FD         +1  6171             mov r5,a
27C0 EC         +1  6172             mov a,r4
27C1 F4         +1  6173             cpl a
27C2 3400       +1  6174             addc    a,#0
27C4 FC         +1  6175             mov r4,a
27C5 EB         +1  6176             mov a,r3
27C6 F4         +1  6177                 cpl a
27C7 3400       +1  6178             addc    a,#0
27C9 FB         +1  6179             mov r3,a
27CA EA         +1  6180             mov a,r2
27CB F4         +1  6181             cpl a
27CC 3400       +1  6182             addc    a,#0
27CE FA         +1  6183             mov r2,a
27CF 22         +1  6184             ret
                +1  6185     
27D0 120000   F +1  6186     zcmp:   call            maform
27D3 120000   F +1  6187                     call            lcmp
27D6 C0D0       +1  6188                     push            psw
27D8 120000   F +1  6189                     call    bform
27DB D0D0       +1  6190                     pop             psw
27DD 22         +1  6191                     ret
                +1  6192     
                +1  6193     
                +1  6194     ;@r0..@r0+3->r8..r11
                +1  6195     
27DE E6         +1  6196     resar8: mov     a,@r0
27DF F508       +1  6197                     mov     ltemp,a
27E1 08         +1  6198                     inc     r0
27E2 E6         +1  6199                     mov     a,@r0
27E3 F509       +1  6200                     mov     ltemp+1,a
27E5 08         +1  6201                     inc     r0
27E6 E6         +1  6202                     mov     a,@r0
27E7 F50A       +1  6203                     mov     ltemp+2,a
27E9 08         +1  6204                     inc     r0
27EA E6         +1  6205                     mov     a,@r0
27EB F50B       +1  6206                     mov     ltemp+3,a
27ED 22         +1  6207                     ret
                +1  6208     
                +1  6209     ;
                +1  6210     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                +1  6211     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                +1  6212     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                +1  6213     ;r2 a    ўшёыю 180
                +1  6214     ;00 b4
                +1  6215     ;т_ї- mabin..mabin+2
                +1  6216     ;     80 01 00
                +1  6217      
27EE C8         +1  6218     cond:   xch     a,r0    
27EF F9         +1  6219                     mov     r1,a
27F0 C8         +1  6220                     xch     a,r0
27F1 7C03       +1  6221                     mov     r4,#03
27F3 7700       +1  6222     dcoa:   mov     @r1,#00
27F5 09         +1  6223                     inc     r1
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   100

27F6 DCFB       +1  6224                     djnz    r4,dcoa
27F8 7B10       +1  6225                     mov     r3,#10h
27FA C3         +1  6226     dcob:   clr     c
27FB 33         +1  6227                     rlc     a
27FC CA         +1  6228                     xch     a,r2
27FD 33         +1  6229                     rlc     a
27FE CA         +1  6230                     xch     a,r2
27FF C8         +1  6231                     xch     a,r0
2800 F9         +1  6232                     mov     r1,a
2801 C8         +1  6233                     xch     a,r0
2802 7C03       +1  6234                     mov     r4,#03
2804 FD         +1  6235                     mov     r5,a
2805 E7         +1  6236     dcoc:   mov     a,@r1 
2806 37         +1  6237                     addc    a,@r1
2807 D4         +1  6238                     da      a
2808 F7         +1  6239                     mov     @r1,a
2809 09         +1  6240                     inc     r1
280A DCF9       +1  6241                     djnz    r4,dcoc
280C ED         +1  6242                     mov     a,r5
280D 4003       +1  6243                     jc      dcod
280F DBE9       +1  6244                     djnz    r3,dcob
2811 C3         +1  6245                     clr     c
2812 00         +1  6246     dcod:   nop
2813 22         +1  6247                     ret
                +1  6248     
2814 8A08       +1  6249     move28: mov     ltemp,r2                        ;r2..r5->ltemp
2816 850309     +1  6250                     mov     ltemp+1,3
2819 85040A     +1  6251                     mov     ltemp+2,4
281C 85050B     +1  6252                     mov     ltemp+3,5
281F 22         +1  6253                     ret
                +1  6254     
                +1  6255     ;@r0..@r0+3->r2..r5
                +1  6256     
2820 E6         +1  6257     resar2: mov     a,@r0
2821 FA         +1  6258                     mov     r2,a
2822 08         +1  6259                     inc     r0
2823 E6         +1  6260                     mov     a,@r0
2824 FB         +1  6261                     mov     r3,a
2825 08         +1  6262                     inc     r0
2826 E6         +1  6263                     mov     a,@r0
2827 FC         +1  6264                     mov     r4,a
2828 08         +1  6265                     inc     r0
2829 E6         +1  6266                     mov     a,@r0
282A FD         +1  6267                     mov     r5,a
282B 22         +1  6268                     ret
                +1  6269     
                +1  6270     ;25mkc !!!!!!!!!!!!!!!1
282C 7B4B       +1  6271     z_9:      mov R3,#4Bh      ;загрузка числа
282E DBFE       +1  6272                    djnz R3,$
2830 22         +1  6273               ret
                +1  6274     
                +1  6275     ;запись   передаваемый байт в acc
                +1  6276     ;передача байта послед кодом старшими разрядами  вперед
2831 7A08       +1  6277     write:     mov R2,#8
2833 C3         +1  6278                             clr  c  
2834 C297       +1  6279     wr1:            clr             p1.7;P1.2
2836 00         +1  6280                         nop 
2837 33         +1  6281                             rlc A
2838 9296       +1  6282                             mov P1.6,C;P1.1,C
283A 120000   F +1  6283                        call tim2
283D D297       +1  6284                        setb P1.7;P1.2
283F 120000   F +1  6285                call tim2
2842 DAF0       +1  6286                       djnz R2,wr1
2844 C296       +1  6287                       clr P1.6;P1.1
2846 22         +1  6288                                              ret
                +1  6289     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   101

                +1  6290     ;чтение номера байта с индикатора(2байта)
                +1  6291     ;bufind+8..bufind+9
                +1  6292     ;-  - - -
                +1  6293     ;- - - - - - - - - -
                +1  6294     ;adec..adec+9
                +1  6295     ;ст            мл
2847 7847       +1  6296     upak1:  mov             r0,#bufind+7;
2849 795C       +1  6297                                     mov             r1,#adec+9
284B C3         +1  6298                                     clr             c
284C E6         +1  6299                                     mov             a,@r0
284D 9430       +1  6300                                     subb    a,#30h
284F FF         +1  6301                                     mov             r7,a
2850 C3         +1  6302                                     clr             c
2851 9405       +1  6303                                     subb    a,#5
2853 4004       +1  6304                                     jc              upk1
2855 7404       +1  6305                                     mov             a,#4
2857 8001       +1  6306                                     jmp             upk2
2859 EF         +1  6307     upk1:           mov             a,r7
285A F7         +1  6308     upk2:           mov             @r1,a
285B 22         +1  6309                                     ret  
                +1  6310     ;r1-мл байт счетчика ячеек
285C C3         +1  6311     chminus:        clr                     c
285D E7         +1  6312                                             mov                     a,@r1
285E 9401       +1  6313                                             subb            a,#01
2860 F7         +1  6314                                             mov                     @r1,a;low
2861 19         +1  6315                                             dec                     r1
2862 E7         +1  6316                                             mov                     a,@r1
2863 9400       +1  6317                                             subb            a,#00
2865 F7         +1  6318                                             mov                     @r1,a
2866 22         +1  6319                                             ret
                +1  6320     
                +1  6321     
                +1  6322     ;чтение номера байта с индикатора(4байта)
                +1  6323     ;bufind+6..bufind+9
                +1  6324     ;-  - - -
                +1  6325     ;- - - - - - - - - -
                +1  6326     ;adec..adec+9
                +1  6327     ;ст            мл
2867 7848       +1  6328     upak4:  mov             r0,#bufind+8;
2869 795C       +1  6329                     mov             r1,#adec+9
286B 7F04       +1  6330                     mov             r7,#4
286D C3         +1  6331     upaa:   clr             c
286E E6         +1  6332                     mov             a,@r0
286F 9430       +1  6333                     subb    a,#30h
2871 F7         +1  6334                     mov             @r1,a
2872 18         +1  6335                     dec             r0
2873 19         +1  6336                     dec             r1
2874 DFF7       +1  6337                     djnz    r7,upaa
2876 22         +1  6338                     ret
                +1  6339     
                +1  6340     ;dptr-адр ячейки 1й соотв блока 
2877 E538       +1  6341     adrblok:         mov            a,nblok
2879 C3         +1  6342                              clr            c
287A 9401       +1  6343                              subb           a,#1
287C FD         +1  6344                              mov            r5,a
287D E4         +1  6345                              clr            a
287E FC         +1  6346                              mov            r4,a
287F FB         +1  6347                              mov            r3,a
2880 FA         +1  6348                              mov            r2,a
2881 900000   F +1  6349                                     mov                     dptr,#ch320h
2884 120000   F +1  6350                                     CALL   ldc_ltemp                 ; ltemp <-320
2887 120000   F +1  6351                                     call            lmul;r2..r5
288A ED         +1  6352                                     mov                     a,r5
288B 2450       +1  6353                                     add                     a,#50h
288D F582       +1  6354                                     mov                     dpl,a
288F EC         +1  6355                                     mov                     a,r4
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   102

2890 3401       +1  6356                                     addc            a,#01           
2892 F583       +1  6357                                     mov                     dph,a                   ;dptr-
2894 22         +1  6358                                     ret
                +1  6359     
                +1  6360     ;
                +1  6361     ;saven_bl<-dptr  адрес след ячейки внешн озу 
2895 E538       +1  6362     save_hl:                mov             a,nblok
2897 B4011D     +1  6363                                                     cjne    a,#1,sa_hl1
289A 79D3       +1  6364                                                     mov             r1,#saven_bl
289C E583       +1  6365     sa_hl:                  mov             a,dph
289E F7         +1  6366                                               mov           @r1,a
289F 09         +1  6367                                                     inc             r1
28A0 E582       +1  6368                                                     mov             a,dpl
28A2 F7         +1  6369                                                     mov             @r1,a
                +1  6370                                                     ;;;;;;;;;не конец ли блока
                +1  6371                             
28A3 79D6       +1  6372                                     mov                     r1,#volume+1;work+1
28A5 120000   F +1  6373                                     call            chminus
28A8 78D5       +1  6374                                     mov             r0,#volume
28AA E6         +1  6375                                     mov             a,@r0
28AB 30E708     +1  6376                                     jnb             acc.7,noendli
28AE C20A       +1  6377                                     clr                     bitbon                  ;блок закон
                             чился
28B0 534BFD     +1  6378                                     anl                     bufind+11,#0fdh
28B3 120000   F +1  6379                                     call            ind
28B6 22         +1  6380     noendli:ret
                +1  6381     
28B7 B40204     +1  6382     sa_hl1:         cjne    a,#2,sa_hl2
28BA 79C0       +1  6383                                                     mov             r1,#saven_bl2
28BC 80DE       +1  6384                                                     jmp             sa_hl
                +1  6385     
28BE B40304     +1  6386     sa_hl2:         cjne    a,#3,sa_hl3
28C1 79C2       +1  6387                                                     mov             r1,#saven_bl3
28C3 80D7       +1  6388                                                     jmp             sa_hl
28C5 79D9       +1  6389     sa_hl3:                 mov             r1,#saven_bl4
28C7 80D3       +1  6390                                                     jmp             sa_hl
                +1  6391     
                +1  6392     ;загрузка dptr сохр ранее значением адреса ячейки
28C9 E538       +1  6393     resa_hl:                mov             a,nblok
28CB B4010A     +1  6394                                                     cjne    a,#1,re_hl1
28CE 79D3       +1  6395                                                     mov             r1,#saven_bl;блок1 150h..46
                             fh
28D0 E7         +1  6396     re_hl:                  mov             a,@r1   
28D1 F583       +1  6397                                                     mov             dph,a
                +1  6398                                               
28D3 09         +1  6399                                                     inc             r1
28D4 E7         +1  6400                                                     mov             a,@r1
28D5 F582       +1  6401                                                     mov             dpl,a
28D7 22         +1  6402                                                     ret
                +1  6403     
28D8 B40204     +1  6404     re_hl1:                 cjne    a,#2,re_hl2
28DB 79C0       +1  6405                                                     mov             r1,#saven_bl2   ;блок2 470h
                             ..78fh
28DD 80F1       +1  6406                                                     jmp             re_hl
                +1  6407     
28DF B40304     +1  6408     re_hl2:                 cjne    a,#3,re_hl3
28E2 79C2       +1  6409                                                     mov             r1,#saven_bl3   ;блок3 790h
                             ..aafh
28E4 80EA       +1  6410                                                     jmp             re_hl
                +1  6411     
28E6 79D9       +1  6412     re_hl3:                 mov             r1,#saven_bl4   ;блок4 ab0h..dcfh
28E8 80E6       +1  6413                                                     jmp             re_hl
                +1  6414     ;загрузка rez_A3 в соотв яч внешн озу
28EA 789C       +1  6415     loA3_X:                 mov             r0,#rez_A3
28EC 120000   F +1  6416                                                     call    resar2
                +1  6417                                                     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   103

28EF EA         +1  6418                                                     mov             a,r2                    ;
28F0 F0         +1  6419                                                     movx    @dptr,a
28F1 A3         +1  6420                                                     inc             dptr
28F2 EB         +1  6421                                                     mov             a,r3
28F3 F0         +1  6422                                                     movx    @dptr,a
28F4 A3         +1  6423                                                     inc             dptr
28F5 EC         +1  6424                                                     mov             a,r4
28F6 F0         +1  6425                                                     movx    @dptr,a
28F7 A3         +1  6426                                                     inc             dptr
28F8 ED         +1  6427                                                     mov             a,r5
28F9 F0         +1  6428                                                     movx    @dptr,a
28FA A3         +1  6429                                                     inc             dptr;адрес след ячейки внеш
                             н озу храним
28FB 22         +1  6430                                                     ret             ;в ячейке saven_bl
                +1  6431     ;чтение в rez_A3 из соотв яч внешн озу
28FC            +1  6432     reA3_X:         
                +1  6433                                                     
28FC E0         +1  6434                                                     movx    a,@dptr
28FD FA         +1  6435                                                     mov             r2,a
28FE A3         +1  6436                                                     inc             dptr
28FF E0         +1  6437                                                     movx    a,@dptr
2900 FB         +1  6438                                                     mov             r3,a
2901 A3         +1  6439                                                     inc             dptr
2902 E0         +1  6440                                                     movx    a,@dptr
2903 FC         +1  6441                                                     mov             r4,a
2904 A3         +1  6442                                                     inc             dptr
2905 E0         +1  6443                                                     movx    a,@dptr
2906 FD         +1  6444                                                     mov             r5,a
2907 A3         +1  6445                                                     inc             dptr
2908 789C       +1  6446                                                     mov             r0,#rez_A3
290A 120000   F +1  6447                                                     call    saver2
290D 22         +1  6448                                                     ret
                +1  6449     ;;;;;;;;;;;;;;;;;
                +1  6450     ;разбивка внешнего озу
                +1  6451     ;0..ffh считывается страница рпзу калибровочных коффициентов
                +1  6452     ;100h..150h обл внеш озу для скользящего массива измерения
                +1  6453     ;150h..46fh 1й блок
                +1  6454     ;470h..78fh     2й блок
                +1  6455     ;790h..aaf      3й блок
                +1  6456     ;ab0h..dcfh 4й блок
                +1  6457     ;dd0..fffh свободная область
                +1  6458     ;
                +1  6459     ;светодиоды и точки для индикатора
                +1  6460     ;bufind+10.0->makoi.7 такт
                +1  6461     ;bufind+10.1->makoi+1.7 измер
                +1  6462     ;bufind+10.2->makoi+2.7 avp
                +1  6463     ;bufind+10.3->makoi+3.7 нуль
                +1  6464     ;bufind+10.4->makoi+4.7 0,1s
                +1  6465     ;bufind+10.5->makoi+5.7 1s
                +1  6466     ;bufind+10.6->makoi+6.7 10s
                +1  6467     ;bufind+10.7->makoi+7.7 кмп
                +1  6468     ;bufind+11.0->makoi+8.7 память
                +1  6469     ;bufind+11.1->makoi+9.7 пуск
                +1  6470     ;знакоместа 0..9(10 знакомест)
                +1  6471     ;bufind+11.2->точка после 5 знакоместа
                +1  6472     ;bufind+11.3->точка после 8 знакоместа
                +1  6473     ;bufind+11.4->точка после 1 знакоместа(+0,0000  -7a)
                +1  6474     ;bufind+11.5->точка после 7 знакоместа
                +1  6475     ;bufind+11.6->точка после 6 знакоместа
                +1  6476     ;bufind+11.7->точка после 4 знакоместа
                +1  6477     
                +1  6478     ;ERR ошибки
                +1  6479     ;ERR 2-пароль в калибровке не соответствует
                +1  6480     ;ERR 3-не проходит тест RS
                +1  6481     ;ERR 4-в режиме R не введена константа U=0000(=0)
                    6482     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   104

                    6483     ;$include (d:\amp\sarifm3.asm) 
                +1  6484     ; ” ©« SARIFM.ASM 8.11.95
                +1  6485     ;файл арифметики
                +1  6486       
  0008          +1  6487     ltemp    equ       8           ;long temporary
  000C          +1  6488     xtemp    equ       12          ;other temporaries
  000A          +1  6489     DECSIZE  EQU       10
  0004          +1  6490     NUMSIZE  EQU       4
  0004          +1  6491     RR4  EQU       4
  0005          +1  6492     RR5  EQU       5
                +1  6493     
                +1  6494                                                     
                +1  6495     
                +1  6496                 ; rseg     ARIF          ; Switch to this code segment.
                +1  6497     ;             using    0              ; Specify register bank for the following
                +1  6498                                            ; program code.
                +1  6499     ;                                               cseg AT 400h
                +1  6500     ; Arithmetics:  CLEARING string
                +1  6501     ; Input:
                +1  6502     ; R0 - pointer to string,
                +1  6503     ; NUMSIZE - byte count if CLRNUM used,
                +1  6504     ; DECSIZE - byte count if CLRDEC used,
                +1  6505     ; R2 - byte count if CLEAR used;
                +1  6506     ; Output:  none.
                +1  6507     
290E            +1  6508     CLRDEC:
290E 7A0A       +1  6509         MOV R2, #DECSIZE
2910 8002       +1  6510         SJMP    CLEAR
2912            +1  6511     CLRNUM:
2912 7A04       +1  6512         MOV R2, #NUMSIZE
                +1  6513         ;JMP    CLEAR
2914            +1  6514     CLEAR:
2914 E4         +1  6515         CLR A
2915 F6         +1  6516     CLR11:  MOV @R0, A
2916 08         +1  6517         INC R0
2917 DAFC       +1  6518         DJNZ    R2, CLR11
2919 22         +1  6519         RET
                +1  6520     
                +1  6521     ;**********************************
                +1  6522     ;mov    r1,#abin+3
                +1  6523     ;mov    r0,#adec
                +1  6524     ; _ _ _ _
                +1  6525     ;     03ff
                +1  6526     ;ст     мл   - вход
                +1  6527     ; _ _ _ _ _ _ _ _ _ _
                +1  6528     ;             1 0 2 3
                +1  6529     ;ст                мл 
                +1  6530     ;**********************************
                +1  6531     
291A            +1  6532     BINDEC:
                +1  6533     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  6534     ; Input:
                +1  6535     ; R0 - pointer to destination (high digit is the first),
                +1  6536     ; R1 - pointer to source,
                +1  6537     ; NUMSIZE - byte count in binary number;
                +1  6538     ; DECSIZE - byte count in decimal number;
                +1  6539     ; Output:  none.
                +1  6540     ; Source saved
                +1  6541     
                +1  6542         ; 1. Clear result
291A 7A05       +1  6543         MOV R2, #DECSIZE/2
291C 120000   F +1  6544         CALL   CLEAR  ; incrementing R0
                +1  6545     
                +1  6546         ; 2. Prepare convertion
291F 18         +1  6547         DEC R0
2920 8804       +1  6548         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   105

2922 8905       +1  6549         MOV RR5, R1 ; R5 - pointer to low byte of binary number
2924 7B20       +1  6550         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6551     
                +1  6552         ; 3. Convert cyrcle
2926            +1  6553     BIN30:
                +1  6554     
                +1  6555         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
2926 A905       +1  6556         MOV R1, RR5
2928 7A04       +1  6557         MOV R2, #NUMSIZE
292A E7         +1  6558     BIN31:  MOV A, @R1
292B 33         +1  6559         RLC A
292C F7         +1  6560         MOV @R1, A
292D 19         +1  6561         DEC R1
292E DAFA       +1  6562         DJNZ    R2, BIN31
2930 A905       +1  6563         MOV R1, RR5
2932 E7         +1  6564         MOV A, @R1
2933 92E0       +1  6565         MOV ACC.0, C
2935 F7         +1  6566         MOV @R1, A
                +1  6567     
                +1  6568         ; 3.2. Doubling decimal result with <Carry>
2936 A804       +1  6569         MOV R0, RR4
2938 7A05       +1  6570         MOV R2, #DECSIZE/2
293A E6         +1  6571     BIN32:  MOV A, @R0
293B 36         +1  6572         ADDC    A, @R0
293C D4         +1  6573         DA  A
293D F6         +1  6574         MOV @R0, A
293E 18         +1  6575         DEC R0
293F DAF9       +1  6576         DJNZ    R2, BIN32
                +1  6577     
                +1  6578         ; 3.3. End of convert cyrcle
2941 DBE3       +1  6579         DJNZ    R3, BIN30
                +1  6580     
                +1  6581         ; 4. Make bytes from half-bytes
2943 E8         +1  6582         MOV A, R0
2944 240A       +1  6583         ADD A, #DECSIZE
2946 F8         +1  6584         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
2947 A904       +1  6585         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
2949 7A05       +1  6586         MOV R2, #DECSIZE/2
294B E7         +1  6587     BIN41:  MOV A, @R1
294C 540F       +1  6588         ANL A, #00FH
294E F6         +1  6589         MOV @R0, A
294F 18         +1  6590         DEC R0
2950 E7         +1  6591         MOV A, @R1
2951 C4         +1  6592         SWAP    A
2952 540F       +1  6593         ANL A, #00FH
2954 F6         +1  6594         MOV @R0, A
2955 18         +1  6595         DEC R0
2956 19         +1  6596         DEC R1
2957 DAF2       +1  6597         DJNZ    R2, BIN41
2959 22         +1  6598         RET
                +1  6599     
                +1  6600     
                +1  6601     ;*********************************
                +1  6602     ;mov    r0,#abin
                +1  6603     ;mov    r1,#adec
                +1  6604     ; _ _ _ _       -выход
                +1  6605     ; ff0000
                +1  6606     ;0004
                +1  6607     ;мл      ст
                +1  6608     
                +1  6609     ;ст                       мл
                +1  6610     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  6611     ;                       2 5 5
                +1  6612     ;                   1 0 2 4
                +1  6613     
295A            +1  6614     DECBIN:
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   106

                +1  6615     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  6616     ; Input:
                +1  6617     ; R0 - pointer to destination,
                +1  6618     ; R1 - pointer to source (high digit is the first),
                +1  6619     ; NUMSIZE - byte count in binary number;
                +1  6620     ; DECSIZE - byte count in decimal number;
                +1  6621     ; Output:  none
                +1  6622     ; Source cleared
                +1  6623     
                +1  6624         ; 1. Clear result
295A 120000   F +1  6625         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  6626     
                +1  6627         ; 2. Prepare convertion
295D 18         +1  6628         DEC R0
295E 8804       +1  6629         MOV RR4, R0 ; R4 - pointer to high byte of binary result
2960 8905       +1  6630         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
2962 900000   F +1  6631         MOV DPTR, #DECT2
2965 7B20       +1  6632         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6633     
                +1  6634         ; 3. Convert cyrcle
2967            +1  6635     DEC30:
                +1  6636     
                +1  6637         ; 3.1. Divide decimal number by 2 and prepare <Carry>
2967 C3         +1  6638         CLR C
2968 A905       +1  6639         MOV R1, RR5
296A 7A0A       +1  6640         MOV R2, #DECSIZE
296C E7         +1  6641     DEC31:  MOV A, @R1
296D 540F       +1  6642         ANL A, #00FH
296F 92E4       +1  6643         MOV ACC.4, C
2971 93         +1  6644         MOVC    A,@A+DPTR
2972 F7         +1  6645         MOV @R1, A
2973 A2E7       +1  6646         MOV C, ACC.7
2975 09         +1  6647         INC R1
2976 DAF4       +1  6648         DJNZ    R2, DEC31
                +1  6649     
                +1  6650         ; 3.2. Rotate binary result one bit to right with <Carry>
2978 A804       +1  6651         MOV R0, RR4
297A 7A04       +1  6652         MOV R2, #NUMSIZE
297C E6         +1  6653     DEC32:  MOV A, @R0
297D 13         +1  6654         RRC A
297E F6         +1  6655         MOV @R0, A
297F 18         +1  6656         DEC R0
2980 DAFA       +1  6657         DJNZ    R2, DEC32
                +1  6658     
                +1  6659         ; 3.3. End of convert cyrcle
2982 DBE3       +1  6660         DJNZ    R3, DEC30
2984 22         +1  6661         RET
                +1  6662     
2985 00800181   +1  6663     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
2989 02820383                
298D 0484                    
298F 00000000   +1  6664         DB  00,00,00,00,00,00
2993 0000                    
2995 05850686   +1  6665         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
2999 07870888                
299D 0989                    
                +1  6666     
                +1  6667     ;   Long comparison
                +1  6668     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  6669     ;   flags and acc set as though a long subtraction was done.
                +1  6670     ;*******************************
                +1  6671     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  6672     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  6673     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  6674     ;*******************************
299F            +1  6675     lcmp:
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   107

299F C3         +1  6676         clr c
29A0 EA         +1  6677         mov a,r2
29A1 9508       +1  6678         subb    a,8
29A3 700F       +1  6679         jnz done
29A5 EB         +1  6680         mov a,r3
29A6 9509       +1  6681         subb    a,9
29A8 7008       +1  6682         jnz done1
29AA EC         +1  6683         mov a,r4
29AB 950A       +1  6684         subb    a,10
29AD 7003       +1  6685         jnz done1
29AF ED         +1  6686         mov a,r5
29B0 950B       +1  6687         subb    a,11
29B2            +1  6688     done1:
29B2 C2D2       +1  6689         clr ov      ;overflow is significant only for top byte
29B4            +1  6690     done:
29B4 22         +1  6691         ret
                +1  6692     
                +1  6693     ;   Load long into r2-5 from [dptr]
                +1  6694     
29B5            +1  6695     ldc_long:
29B5 E583       +1  6696         mov a,dph       ;is it in on board memory
29B7 6010       +1  6697         jz  onboard     ;yes
29B9 E4         +1  6698         clr a
29BA 93         +1  6699         movc    a,@a+dptr
29BB FA         +1  6700         mov r2,a
29BC 7401       +1  6701         mov a,#1
29BE 93         +1  6702         movc    a,@a+dptr
29BF FB         +1  6703         mov r3,a
29C0 7402       +1  6704         mov a,#2
29C2 93         +1  6705         movc    a,@a+dptr
29C3 FC         +1  6706         mov r4,a
29C4 7403       +1  6707         mov a,#3
29C6 93         +1  6708         movc    a,@a+dptr
29C7 FD         +1  6709         mov r5,a
29C8 22         +1  6710         ret
29C9            +1  6711     onboard:
29C9 A882       +1  6712         mov r0,dpl
29CB E6         +1  6713         mov a,@r0
29CC FA         +1  6714         mov r2,a
29CD 08         +1  6715         inc r0
29CE E6         +1  6716         mov a,@r0
29CF FB         +1  6717         mov r3,a
29D0 08         +1  6718         inc r0
29D1 E6         +1  6719         mov a,@r0
29D2 FC         +1  6720         mov r4,a
29D3 08         +1  6721         inc r0
29D4 E6         +1  6722         mov a,@r0
29D5 FD         +1  6723         mov r5,a
29D6 22         +1  6724         ret
                +1  6725     
                +1  6726     ;**************************************
                +1  6727     ;загрузить ltemp...+3 из памяти программ
                +1  6728     ;mov    dptr,#CH5
                +1  6729     ;call   ldc_ltemp        ltemp <--5
                +1  6730     ;**************************************
29D7            +1  6731     ldc_ltemp:
29D7 E583       +1  6732         mov a,dph       ;is it in on board memory
29D9 6014       +1  6733         jz  oboard      ;yes
29DB E4         +1  6734         clr a
29DC 93         +1  6735         movc    a,@a+dptr
29DD F508       +1  6736         mov 8,a
29DF 7401       +1  6737         mov a,#1
29E1 93         +1  6738         movc    a,@a+dptr
29E2 F509       +1  6739         mov 9,a
29E4 7402       +1  6740         mov a,#2
29E6 93         +1  6741         movc    a,@a+dptr
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   108

29E7 F50A       +1  6742         mov 10,a
29E9 7403       +1  6743         mov a,#3
29EB 93         +1  6744         movc    a,@a+dptr
29EC F50B       +1  6745         mov 11,a
29EE 22         +1  6746         ret
29EF            +1  6747     oboard:
29EF A882       +1  6748         mov r0,dpl
29F1 8608       +1  6749         mov 8,@r0
29F3 08         +1  6750         inc r0
29F4 8609       +1  6751         mov 9,@r0
29F6 08         +1  6752         inc r0
29F7 860A       +1  6753         mov 10,@r0
29F9 08         +1  6754         inc r0
29FA 860B       +1  6755         mov 11,@r0
29FC 22         +1  6756         ret
                +1  6757     
                +1  6758     ;*****************************
                +1  6759     ;mov    dptr,#k1
                +1  6760     ;call   ldx_long
                +1  6761     ;k1->r2..r5
                +1  6762     ;*****************************
                +1  6763     ;   Load long into r2-5 from [dptr]
                +1  6764     ;
                +1  6765     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
29FD            +1  6766     ldx_long:
29FD E583       +1  6767         mov a,dph       ;is it in on board memory
29FF 6014       +1  6768         jz  onboar1        ;yes
2A01 C082       +1  6769         push    dpl
2A03 C083       +1  6770         push    dph
2A05 E0         +1  6771         movx    a,@dptr
2A06 FA         +1  6772         mov r2,a
2A07 A3         +1  6773         inc dptr
2A08 E0         +1  6774         movx    a,@dptr
2A09 FB         +1  6775         mov r3,a
2A0A A3         +1  6776         inc dptr
2A0B E0         +1  6777         movx    a,@dptr
2A0C FC         +1  6778         mov r4,a
2A0D A3         +1  6779         inc dptr
2A0E E0         +1  6780         movx    a,@dptr
2A0F FD         +1  6781         mov r5,a
2A10 D083       +1  6782         pop dph
2A12 D082       +1  6783         pop dpl
2A14 22         +1  6784         ret
2A15            +1  6785     onboar1:
2A15 A882       +1  6786         mov r0,dpl
2A17 E6         +1  6787         mov a,@r0
2A18 FA         +1  6788         mov r2,a
2A19 08         +1  6789         inc r0
2A1A E6         +1  6790         mov a,@r0
2A1B FB         +1  6791         mov r3,a
2A1C 08         +1  6792         inc r0
2A1D E6         +1  6793         mov a,@r0
2A1E FC         +1  6794         mov r4,a
2A1F 08         +1  6795         inc r0
2A20 E6         +1  6796         mov a,@r0
2A21 FD         +1  6797         mov r5,a
2A22 22         +1  6798         ret
                +1  6799     
                +1  6800     ;*********************************
                +1  6801     ;mov    dptr,#k2
                +1  6802     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  6803     ;**********************************
2A23            +1  6804     ldx_ltemp:
2A23 E583       +1  6805         mov a,dph       ;is it in on board memory
2A25 6010       +1  6806         jz  oboard1     ;yes
2A27 E0         +1  6807         movx    a,@dptr
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   109

2A28 F508       +1  6808         mov 8,a
2A2A A3         +1  6809         inc dptr
2A2B E0         +1  6810         movx    a,@dptr
2A2C F509       +1  6811         mov 9,a
2A2E A3         +1  6812         inc dptr
2A2F E0         +1  6813         movx    a,@dptr
2A30 F50A       +1  6814         mov 10,a
2A32 A3         +1  6815         inc dptr
2A33 E0         +1  6816         movx    a,@dptr
2A34 F50B       +1  6817         mov 11,a
2A36 22         +1  6818         ret
2A37            +1  6819     oboard1:
2A37 A882       +1  6820         mov r0,dpl
2A39 8608       +1  6821         mov 8,@r0
2A3B 08         +1  6822         inc r0
2A3C 8609       +1  6823         mov 9,@r0
2A3E 08         +1  6824         inc r0
2A3F 860A       +1  6825         mov 10,@r0
2A41 08         +1  6826         inc r0
2A42 860B       +1  6827         mov 11,@r0
2A44 22         +1  6828         ret
                +1  6829     ;   Long division routines for 8051
                +1  6830     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  6831     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  6832     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  6833     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  6834     ;   r1 must be saved by the caller.
                +1  6835     ;   This is long unsigned division.
                +1  6836     
                +1  6837     
                +1  6838     ;   Register usage:
                +1  6839     ;       r0 loop counter
                +1  6840     ;       xtemp (12-15) accumulates quotient
                +1  6841     ;       r5-r2 holds dividend
                +1  6842     ;       ltemp holds divisor
                +1  6843     
                +1  6844     ;************************************
                +1  6845     ;r2..r5-делимое
                +1  6846     ;ltemp..-делитель
                +1  6847     ;частное -r2..r5
                +1  6848     ;*************************************
2A45            +1  6849     divide:
2A45 E4         +1  6850         clr a
2A46 F8         +1  6851         mov r0,a        ;initialize count
2A47 F50C       +1  6852         mov xtemp,a     ;zero quotient
2A49 F50D       +1  6853         mov xtemp+1,a
2A4B F50E       +1  6854         mov xtemp+2,a
2A4D F50F       +1  6855         mov xtemp+3,a
2A4F ED         +1  6856         mov a,r5        ;check for zero dividend
2A50 4C         +1  6857         orl a,r4
2A51 4B         +1  6858         orl a,r3
2A52 4A         +1  6859         orl a,r2
2A53 600B       +1  6860         jz  jfinis
2A55 E508       +1  6861         mov a,ltemp     ;check for zero divisor
2A57 4509       +1  6862         orl a,ltemp+1
2A59 450A       +1  6863         orl a,ltemp+2
2A5B 450B       +1  6864         orl a,ltemp+3
2A5D 7037       +1  6865         jnz midl
2A5F 22         +1  6866         ret
                +1  6867     
2A60 020000   F +1  6868     jfinis: jmp finis
                +1  6869     
2A63            +1  6870     loops:
2A63 EA         +1  6871         mov a,r2
2A64 C3         +1  6872         clr c
2A65 9508       +1  6873         subb    a,ltemp+0   ;is divisor greater than dividend yet
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   110

2A67 4033       +1  6874         jc  yes     ;yes, go no further
2A69 7013       +1  6875         jnz no
2A6B EB         +1  6876         mov a,r3
2A6C 9509       +1  6877         subb    a,ltemp+1
2A6E 402C       +1  6878         jc  yes
2A70 700C       +1  6879         jnz no
2A72 EC         +1  6880         mov a,r4
2A73 950A       +1  6881         subb    a,ltemp+2
2A75 4025       +1  6882         jc  yes
2A77 7005       +1  6883         jnz no
2A79 ED         +1  6884         mov a,r5
2A7A 950B       +1  6885         subb    a,ltemp+3
2A7C 401E       +1  6886         jc  yes
2A7E            +1  6887     no:
2A7E E50B       +1  6888         mov a,ltemp+3   ;shift divisor up one bit
2A80 250B       +1  6889         add a,ltemp+3
2A82 F50B       +1  6890         mov ltemp+3,a
2A84 E50A       +1  6891         mov a,ltemp+2
2A86 350A       +1  6892         addc    a,ltemp+2
2A88 F50A       +1  6893         mov ltemp+2,a
2A8A E509       +1  6894         mov a,ltemp+1
2A8C 3509       +1  6895         addc    a,ltemp+1
2A8E F509       +1  6896         mov ltemp+1,a
2A90 E508       +1  6897         mov a,ltemp+0
2A92 3508       +1  6898         addc    a,ltemp+0
2A94 F508       +1  6899         mov ltemp+0,a
2A96            +1  6900     midl:
2A96 08         +1  6901         inc r0      ;increment count
2A97 E508       +1  6902         mov a,ltemp+0   ;check for safe to shift some more
2A99 30E7C7     +1  6903         jnb acc.7,loops  ;loop if top bit clear
2A9C            +1  6904     yes:
2A9C E508       +1  6905         mov a,ltemp+0
2A9E C3         +1  6906         clr c
2A9F 9A         +1  6907         subb    a,r2        ;can we subtract now?
2AA0 401A       +1  6908         jc  dosub       ;yes, go and do it
2AA2 7015       +1  6909         jnz nosub
2AA4 E509       +1  6910         mov a,ltemp+1
2AA6 9B         +1  6911         subb    a,r3
2AA7 4013       +1  6912         jc  dosub
2AA9 700E       +1  6913         jnz nosub
2AAB E50A       +1  6914         mov a,ltemp+2
2AAD 9C         +1  6915         subb    a,r4
2AAE 400C       +1  6916         jc  dosub
2AB0 7007       +1  6917         jnz nosub
2AB2 E50B       +1  6918         mov a,ltemp+3
2AB4 9D         +1  6919         subb    a,r5
2AB5 4005       +1  6920         jc  dosub
2AB7 6003       +1  6921         jz  dosub
2AB9            +1  6922     nosub:
2AB9 C3         +1  6923         clr c
2ABA 8012       +1  6924         sjmp    dosh
2ABC            +1  6925     dosub:
2ABC C3         +1  6926         clr c       ;subtract divisor from dividend
2ABD ED         +1  6927         mov a,r5
2ABE 950B       +1  6928         subb    a,ltemp+3
2AC0 FD         +1  6929         mov r5,a
2AC1 EC         +1  6930         mov a,r4
2AC2 950A       +1  6931         subb    a,ltemp+2
2AC4 FC         +1  6932         mov r4,a
2AC5 EB         +1  6933         mov a,r3
2AC6 9509       +1  6934         subb    a,ltemp+1
2AC8 FB         +1  6935         mov r3,a
2AC9 EA         +1  6936         mov a,r2
2ACA 9508       +1  6937         subb    a,ltemp+0
2ACC FA         +1  6938         mov r2,a
2ACD D3         +1  6939         setb    c       ;now set bit for quotient
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   111

2ACE            +1  6940     dosh:
2ACE E50F       +1  6941         mov a,xtemp+3
2AD0 33         +1  6942         rlc a
2AD1 F50F       +1  6943         mov xtemp+3,a
2AD3 E50E       +1  6944         mov a,xtemp+2
2AD5 33         +1  6945         rlc a
2AD6 F50E       +1  6946         mov xtemp+2,a
2AD8 E50D       +1  6947         mov a,xtemp+1
2ADA 33         +1  6948         rlc a
2ADB F50D       +1  6949         mov xtemp+1,a
2ADD E50C       +1  6950         mov a,xtemp+0
2ADF 33         +1  6951         rlc a
2AE0 F50C       +1  6952         mov xtemp+0,a
2AE2 E508       +1  6953         mov a,ltemp+0       ;shift divisor down
2AE4 C3         +1  6954         clr c
2AE5 13         +1  6955         rrc a
2AE6 F508       +1  6956         mov ltemp+0,a
2AE8 E509       +1  6957         mov a,ltemp+1
2AEA 13         +1  6958         rrc a
2AEB F509       +1  6959         mov ltemp+1,a
2AED E50A       +1  6960         mov a,ltemp+2
2AEF 13         +1  6961         rrc a
2AF0 F50A       +1  6962         mov ltemp+2,a
2AF2 E50B       +1  6963         mov a,ltemp+3
2AF4 13         +1  6964         rrc a
2AF5 F50B       +1  6965         mov ltemp+3,a
                +1  6966     
2AF7 D8A3       +1  6967         djnz    r0,yes      ;and continue with the rest
                +1  6968     
2AF9            +1  6969     finis:
2AF9 8D0B       +1  6970         mov ltemp+3,r5
2AFB 8C0A       +1  6971         mov ltemp+2,r4
2AFD 8B09       +1  6972         mov ltemp+1,r3
2AFF 8A08       +1  6973         mov ltemp+0,r2
2B01 AD0F       +1  6974         mov r5,xtemp+3
2B03 AC0E       +1  6975         mov r4,xtemp+2
2B05 AB0D       +1  6976         mov r3,xtemp+1
2B07 AA0C       +1  6977         mov r2,xtemp+0
2B09 22         +1  6978         ret         ;and return with the satisfaction of a job well done
                +1  6979     
                +1  6980     
                +1  6981     ;   Long multiplication
                +1  6982     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  6983     ;   other in ltemp. It really doesn't matter which one is where.
                +1  6984     
                +1  6985     ;**********************************
                +1  6986     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  6987     ;ст  мл
                +1  6988     ;**********************************
2B0A            +1  6989     llmul:
2B0A            +1  6990     almul:
2B0A            +1  6991     lmul:
2B0A ED         +1  6992         mov a,r5        ;low order byte
2B0B 850BF0     +1  6993         mov b,ltemp+3       ;times low order byte
2B0E A4         +1  6994         mul ab
2B0F F50F       +1  6995         mov xtemp+3,a       ;store low
2B11 85F00E     +1  6996         mov xtemp+2,b   ;and high
2B14 ED         +1  6997         mov a,r5        ;low order
2B15 850AF0     +1  6998         mov b,ltemp+2   ;times next
2B18 A4         +1  6999         mul ab
2B19 250E       +1  7000         add a,xtemp+2   ;add in
2B1B F50E       +1  7001         mov xtemp+2,a
2B1D E5F0       +1  7002         mov a,b
2B1F 3400       +1  7003         addc    a,#0
2B21 F50D       +1  7004         mov xtemp+1,a
2B23 ED         +1  7005         mov a,r5
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   112

2B24 8509F0     +1  7006         mov b,ltemp+1
2B27 A4         +1  7007         mul ab
2B28 250D       +1  7008         add a,xtemp+1
2B2A F50D       +1  7009         mov xtemp+1,a
2B2C E5F0       +1  7010         mov a,b
2B2E 3400       +1  7011         addc    a,#0
2B30 F50C       +1  7012         mov xtemp+0,a
2B32 ED         +1  7013         mov a,r5
2B33 8508F0     +1  7014         mov b,ltemp+0
2B36 A4         +1  7015         mul ab
2B37 250C       +1  7016         add a,xtemp+0
2B39 F50C       +1  7017         mov xtemp+0,a
2B3B EC         +1  7018         mov a,r4
2B3C 850BF0     +1  7019         mov b,ltemp+3
2B3F A4         +1  7020         mul ab
2B40 250E       +1  7021         add a,xtemp+2
2B42 F50E       +1  7022         mov xtemp+2,a
2B44 E5F0       +1  7023         mov a,b
2B46 350D       +1  7024         addc    a,xtemp+1
2B48 F50D       +1  7025         mov xtemp+1,a
2B4A E50C       +1  7026         mov a,xtemp+0
2B4C 3400       +1  7027         addc    a,#0
2B4E F50C       +1  7028         mov xtemp+0,a
2B50 EC         +1  7029         mov a,r4
2B51 850AF0     +1  7030         mov b,ltemp+2
2B54 A4         +1  7031         mul ab
2B55 250D       +1  7032         add a,xtemp+1
2B57 F50D       +1  7033         mov xtemp+1,a
2B59 E5F0       +1  7034         mov a,b
2B5B 350C       +1  7035         addc    a,xtemp+0
2B5D F50C       +1  7036         mov xtemp+0,a
2B5F EC         +1  7037         mov a,r4
2B60 8509F0     +1  7038         mov b,ltemp+1
2B63 A4         +1  7039         mul ab
2B64 250C       +1  7040         add a,xtemp+0
2B66 F50C       +1  7041         mov xtemp+0,a
                +1  7042     
2B68 EB         +1  7043         mov a,r3
2B69 850BF0     +1  7044         mov b,ltemp+3
2B6C A4         +1  7045         mul ab
2B6D 250D       +1  7046         add a,xtemp+1
2B6F F50D       +1  7047         mov xtemp+1,a
2B71 E5F0       +1  7048         mov a,b
2B73 350C       +1  7049         addc    a,xtemp+0
2B75 F50C       +1  7050         mov xtemp+0,a
2B77 EB         +1  7051         mov a,r3
2B78 850AF0     +1  7052         mov b,ltemp+2
2B7B A4         +1  7053         mul ab
2B7C 250C       +1  7054         add a,xtemp+0
2B7E F50C       +1  7055         mov xtemp+0,a
                +1  7056     
2B80 EA         +1  7057         mov a,r2
2B81 850BF0     +1  7058         mov b,ltemp+3
2B84 A4         +1  7059         mul ab
2B85 250C       +1  7060         add a,xtemp+0
2B87 FA         +1  7061         mov r2,a
2B88 AB0D       +1  7062         mov r3,xtemp+1
2B8A AC0E       +1  7063         mov r4,xtemp+2
2B8C AD0F       +1  7064         mov r5,xtemp+3
                +1  7065     
2B8E 22         +1  7066         ret         ;all done
                +1  7067     ;******************************
                +1  7068     ;из содержимого  r2-r5  вычесть
                +1  7069     ;содержимое          ltemp..ltemp+3
                +1  7070     ;******************************
2B8F            +1  7071     llsub:
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   113

2B8F            +1  7072      lsub:
2B8F ED         +1  7073         mov a,r5
2B90 C3         +1  7074         clr c
2B91 950B       +1  7075         subb    a,11
2B93 FD         +1  7076         mov r5,a
2B94 EC         +1  7077         mov a,r4
2B95 950A       +1  7078         subb    a,10
2B97 FC         +1  7079         mov r4,a
2B98 EB         +1  7080         mov a,r3
2B99 9509       +1  7081         subb    a,9
2B9B FB         +1  7082         mov r3,a
2B9C EA         +1  7083         mov a,r2
2B9D 9508       +1  7084         subb    a,8
2B9F FA         +1  7085         mov r2,a
2BA0 22         +1  7086         ret
                +1  7087     
                +1  7088     ;***********************************************
                +1  7089     ;                                                      ст мл
                +1  7090     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7091     ;  r0- адрес младшего байта !!!
                +1  7092     ;результат- r2..r5
                +1  7093     ;***********************************************
                +1  7094     
2BA1 C3         +1  7095     ladd:    clr       c
2BA2 ED         +1  7096          mov       a,r5
2BA3 26         +1  7097          add       a,@r0
2BA4 FD         +1  7098          mov       r5,a
2BA5 18         +1  7099          dec       r0
2BA6 EC         +1  7100          mov       a,r4
2BA7 36         +1  7101          addc      a,@r0
2BA8 FC         +1  7102          mov       r4,a
2BA9 18         +1  7103          dec       r0
2BAA EB         +1  7104          mov       a,r3
2BAB 36         +1  7105          addc      a,@r0
2BAC FB         +1  7106          mov       r3,a
2BAD 18         +1  7107          dec       r0
2BAE EA         +1  7108          mov       a,r2
2BAF 36         +1  7109          addc      a,@r0
2BB0 FA         +1  7110          mov       r2,a
2BB1 22         +1  7111          ret
                +1  7112     ;***********************************************
                +1  7113     ;                                                      ст мл
                +1  7114     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7115     ;  r0- адрес младшего байта !!!
                +1  7116     ;результат- r2..r5
                +1  7117     ;***********************************************
                +1  7118     
2BB2 C3         +1  7119     laddx:    clr       c
2BB3 E2         +1  7120                                             movx            a,@r0
2BB4 2D         +1  7121                                             add                     a,r5
2BB5 FD         +1  7122               mov     r5,a
2BB6 18         +1  7123                             dec     r0
2BB7 E2         +1  7124                             movx    a,@r0
2BB8 3C         +1  7125                             addc    a,r4
2BB9 FC         +1  7126                             mov     r4,a
2BBA 18         +1  7127                             dec     r0
2BBB E2         +1  7128                             movx    a,@r0
2BBC 3B         +1  7129                             addc    a,r3
2BBD FB         +1  7130                             mov     r3,a
2BBE 18         +1  7131                             dec     r0
2BBF E2         +1  7132                             movx    a,@r0
2BC0 3A         +1  7133                             addc    a,r2
2BC1 FA         +1  7134                             mov       r2,a
2BC2 22         +1  7135                             ret
                +1  7136     
                +1  7137     ;***********************************************
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   114

                +1  7138     ;                                                      ст мл
                +1  7139     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7140     ;  dptr- адрес младшего байта !!!
                +1  7141     ;результат- r2..r5
                +1  7142     ;***********************************************
                +1  7143     
2BC3 C3         +1  7144     addx:    clr       c
2BC4 E0         +1  7145                                             movx            a,@dptr
2BC5 2D         +1  7146                                             add                     a,r5
2BC6 FD         +1  7147               mov     r5,a
2BC7 120000   F +1  7148                             call            dedptr;dec     dptr
2BCA E0         +1  7149                             movx    a,@dptr
2BCB 3C         +1  7150                             addc    a,r4
2BCC FC         +1  7151                             mov     r4,a
2BCD 120000   F +1  7152                             call            dedptr;dec     dptr
2BD0 E0         +1  7153                             movx    a,@dptr
2BD1 3B         +1  7154                             addc    a,r3
2BD2 FB         +1  7155                             mov     r3,a
2BD3 120000   F +1  7156                             call            dedptr;dec     dptr
2BD6 E0         +1  7157                             movx    a,@dptr
2BD7 3A         +1  7158                             addc    a,r2
2BD8 FA         +1  7159                             mov       r2,a
2BD9 22         +1  7160                             ret
                +1  7161     
2BDA C0D0       +1  7162     dedptr:         push    psw
2BDC C3         +1  7163                                             clr             c
2BDD E582       +1  7164                                             mov             a,dpl
2BDF 9401       +1  7165                                             subb    a,#1
2BE1 F582       +1  7166                                             mov             dpl,a
2BE3 E583       +1  7167                                             mov             a,dph
2BE5 9400       +1  7168                                             subb    a,#0
2BE7 F583       +1  7169                                             mov             dph,a
2BE9 D0D0       +1  7170                                             pop             psw
2BEB 22         +1  7171                                             ret
                    7172     
                    7173     ;$include (d:\amp\floatm.asm)
                +1  7174     ;       Copyright (C) 1988 HI-TECH Software
                +1  7175     
                +1  7176     ;       Single Precision Floating point arithmetic routines for 8051
                +1  7177     
                +1  7178     ;       The format of floating point numbers is as follows:
                +1  7179     
                +1  7180     ;       -----------------
                +1  7181     ;       *     sign      *  1 bit
                +1  7182     ;       -----------------
                +1  7183     ;       *   exponent    *  8 bits
                +1  7184     ;       -----------------
                +1  7185     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  7186     ;       -----------------
                +1  7187     
                +1  7188     
                +1  7189     ;       As usual for the 8051 the memory layout has the most significant
                +1  7190     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  7191     ;       lowest address.
                +1  7192     
                +1  7193     ;       Calling conventions:
                +1  7194     
                +1  7195     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  7196     ;
                +1  7197     ;       Return value is in r2-r5
                +1  7198     
                +1  7199     ;       Naming conventions: A routine name is constructed by
                +1  7200     
                +1  7201     ;             ASOP
                +1  7202     
                +1  7203     ;       Where A is the arithmetic type (f for float), and op is the operation,
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   115

                +1  7204     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  7205     ;       Conversion routines are named
                +1  7206     
                +1  7207     ;               AStof
                +1  7208     
                +1  7209     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  7210     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  7211     ;       Conversion from float to integer is ftol.
                +1  7212     
                +1  7213     ;               .ORG  5000h
                +1  7214     ;               .CODE
                +1  7215     ;       seg     c_text
                +1  7216     
                +1  7217     ;;      $MOD812
----            +1  7218             CSEG
                +1  7219             ;ORG 1000h
                +1  7220     
                +1  7221                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  7222             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  7223     
                +1  7224     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  7225     ;       macros
                +1  7226     
                +1  7227     saveregs        macro
                +1  7228             push    7
                +1  7229             push    6
                +1  7230             push    1
                +1  7231             push    0
                +1  7232             endm
                +1  7233     
                +1  7234     restregs        macro
                +1  7235             pop     0
                +1  7236             pop     1
                +1  7237             pop     6
                +1  7238             pop     7
                +1  7239             endm
                +1  7240     
                +1  7241     ;addr   
                +1  7242     dan     macro   pad
                +1  7243             mov     a,r5
                +1  7244             add     a,pad+3
                +1  7245             mov     pad+3,a
                +1  7246             mov     a,pad+2
                +1  7247             addc    a,r4
                +1  7248             mov     pad+2,a
                +1  7249             mov     a,pad+1
                +1  7250             addc    a,r3
                +1  7251             mov     pad+1,a
                +1  7252             mov     a,pad+0
                +1  7253             addc    a,r2
                +1  7254             mov     pad,a
                +1  7255             endm
                +1  7256     
                +1  7257     addl    macro  addr
                +1  7258             mov     a,r5
                +1  7259             add     a,addr+3
                +1  7260             mov     r5,a
                +1  7261             mov     a,addr+2
                +1  7262             addc    a,r4
                +1  7263             mov     r4,a
                +1  7264             mov     a,addr+1
                +1  7265             addc    a,r3
                +1  7266             mov     r3,a
                +1  7267             mov     a,addr+0
                +1  7268             addc    a,r2
                +1  7269             mov     r2,a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   116

                +1  7270             endm
                +1  7271     
                +1  7272     
                +1  7273     add1    macro
                +1  7274             mov     a,r5
                +1  7275             add     a,#1
                +1  7276             mov     r5,a
                +1  7277             clr     a
                +1  7278             addc    a,r4
                +1  7279             mov     r4,a
                +1  7280             clr     a
                +1  7281             addc    a,r3
                +1  7282             mov     r3,a
                +1  7283             clr     a
                +1  7284             addc    a,r2
                +1  7285             mov     r2,a
                +1  7286             endm
                +1  7287     
                +1  7288     shfdn   macro  addr
                +1  7289             clr     c
                +1  7290             mov     a,addr
                +1  7291             rrc     a
                +1  7292             mov     addr,a
                +1  7293             mov     a,addr+1
                +1  7294             rrc     a
                +1  7295             mov     addr+1,a
                +1  7296             mov     a,addr+2
                +1  7297             rrc     a
                +1  7298             mov     addr+2,a
                +1  7299             mov     a,addr+3
                +1  7300             rrc     a
                +1  7301             mov     addr+3,a
                +1  7302             endm
                +1  7303     
                +1  7304     shfup   macro  addr
                +1  7305             clr     c
                +1  7306             mov     a,addr+3
                +1  7307             rlc     a
                +1  7308             mov     addr+3,a
                +1  7309             mov     a,addr+2
                +1  7310             rlc     a
                +1  7311             mov     addr+2,a
                +1  7312             mov     a,addr+1
                +1  7313             rlc     a
                +1  7314             mov     addr+1,a
                +1  7315             mov     a,addr
                +1  7316             rlc     a
                +1  7317             mov     addr,a
                +1  7318             endm
                +1  7319     
                +1  7320     rshift  macro
                +1  7321             clr     c
                +1  7322             mov     a,r2
                +1  7323             rrc     a
                +1  7324             mov     r2,a
                +1  7325             mov     a,r3
                +1  7326             rrc     a
                +1  7327             mov     r3,a
                +1  7328             mov     a,r4
                +1  7329             rrc     a
                +1  7330             mov     r4,a
                +1  7331             mov     a,r5
                +1  7332             rrc     a
                +1  7333             mov     r5,a
                +1  7334             endm
                +1  7335     rshift1 macro
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   117

                +1  7336             setb    c
                +1  7337             mov     a,r2
                +1  7338             rrc     a
                +1  7339             mov     r2,a
                +1  7340             mov     a,r3
                +1  7341             rrc     a
                +1  7342             mov     r3,a
                +1  7343             mov     a,r4
                +1  7344             rrc     a
                +1  7345             mov     r4,a
                +1  7346             mov     a,r5
                +1  7347             rrc     a
                +1  7348             mov     r5,a
                +1  7349             endm
                +1  7350     
                +1  7351     
                +1  7352     lshift  macro
                +1  7353             mov     a,r5
                +1  7354             rlc     a
                +1  7355             mov     r5,a
                +1  7356             mov     a,r4
                +1  7357             rlc     a
                +1  7358             mov     r4,a
                +1  7359             mov     a,r3
                +1  7360             rlc     a
                +1  7361             mov     r3,a
                +1  7362             mov     a,r2
                +1  7363             rlc     a
                +1  7364             mov     r2,a
                +1  7365             endm
                +1  7366     
                +1  7367     neg1    macro
                +1  7368             clr     c
                +1  7369             clr     a
                +1  7370             subb    a,r5
                +1  7371             mov     r5,a
                +1  7372             clr     a
                +1  7373             subb    a,r4
                +1  7374             mov     r4,a
                +1  7375             clr     a
                +1  7376             subb    a,r3
                +1  7377             mov     r3,a
                +1  7378             clr     a
                +1  7379             subb    a,r2
                +1  7380             mov     r2,a
                +1  7381             endm
                +1  7382     
                +1  7383     negm    macro  addr
                +1  7384             clr     c
                +1  7385             clr     a
                +1  7386             subb    a,addr+3
                +1  7387             mov     addr+3,a
                +1  7388             clr     a
                +1  7389             subb    a,addr+2
                +1  7390             mov     addr+2,a
                +1  7391             clr     a
                +1  7392             subb    a,addr+1
                +1  7393             mov     addr+1,a
                +1  7394             clr     a
                +1  7395             subb    a,addr
                +1  7396             mov     addr,a
                +1  7397             endm
                +1  7398     
                +1  7399     copytor macro  addr
                +1  7400             mov     r2,addr
                +1  7401             mov     r3,addr+1
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   118

                +1  7402             mov     r4,addr+2
                +1  7403             mov     r5,addr+3
                +1  7404             endm
                +1  7405     
                +1  7406     
                +1  7407     copyrto macro  addr
                +1  7408             mov     addr,r2
                +1  7409             mov     addr+1,r3
                +1  7410             mov     addr+2,r4
                +1  7411             mov     addr+3,r5
                +1  7412             endm
                +1  7413     
                +1  7414     
                +1  7415     ;       Internal representation: in this set of routines a floating number
                +1  7416     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  7417     
                +1  7418     ;       Stack offset values
                +1  7419     ;ltemp   equ     28h
                +1  7420     
  0006          +1  7421     cntr    equ     6               ;r6 is the counter
  0007          +1  7422     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  7423     exp1    equ     0               ;exponent 1 in r0
  0002          +1  7424     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  7425     exp2    equ     1               ;exponent 1 in r1
  0008          +1  7426     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  7427     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  7428     
                +1  7429     
                +1  7430     
                +1  7431     
                +1  7432     
                +1  7433     ;DECSIZE EQU     10
                +1  7434     ;NUMSIZE EQU     4
                +1  7435     ;RR4     EQU     4
                +1  7436     ;RR5     EQU     5
                +1  7437     
                +1  7438     ;       unpack1 - unpacks the left operand
                +1  7439     
009E            +1  7440     unpack1:
009E EA         +1  7441             mov     a,r2            ;get sign
009F 5480       +1  7442             anl     a,#80h
00A1 530740     +1  7443             anl     sign,#40h       ;clear other bits
00A4 4207       +1  7444             orl     sign,a          ;store sign
00A6 EB         +1  7445             mov     a,r3            ;get lsb of exponent
00A7 33         +1  7446             rlc     a               ;rotate into carry
00A8 EA         +1  7447             mov     a,r2            ;get rest of exponent
00A9 33         +1  7448             rlc     a               ;and make it 8 bits
00AA F8         +1  7449             mov     r0,a            ;store it
00AB 6006       +1  7450             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  7451             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  7452             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  7453             ret
00B3            +1  7454     zer1:
00B3 E4         +1  7455             clr     a
00B4 FA         +1  7456             mov     r2,a
00B5 FB         +1  7457             mov     r3,a
00B6 FC         +1  7458             mov     r4,a
00B7 FD         +1  7459             mov     r5,a            ;zero mantissa
00B8 F8         +1  7460             mov     r0,a            ;zero exponent
00B9 22         +1  7461             ret
                +1  7462     
                +1  7463     ;       unpack2 - unpacks right operand
                +1  7464     
00BA            +1  7465     unpack2:
00BA E508       +1  7466             mov     a,ltemp         ;get sign
00BC 13         +1  7467             rrc     a               ;shift down
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   119

00BD 5440       +1  7468             anl     a,#40h          ;mask out sign
00BF 530780     +1  7469             anl     sign,#80h       ;clear old bit
00C2 4207       +1  7470             orl     sign,a
00C4 E509       +1  7471             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  7472             rlc     a               ;rotate into carry
00C7 E508       +1  7473             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  7474             rlc     a               ;and make it 8 bits
00CA F9         +1  7475             mov     r1,a            ;store it
00CB 6007       +1  7476             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  7477             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  7478             mov     mant2,#0        ;clear upper byte
00D3 22         +1  7479             ret
00D4            +1  7480     zer2:
00D4 E4         +1  7481             clr     a
00D5 F508       +1  7482             mov     ltemp,a
00D7 F509       +1  7483             mov     ltemp+1,a
00D9 F50A       +1  7484             mov     ltemp+2,a
00DB F50B       +1  7485             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  7486             ret
                +1  7487     
                +1  7488     ;       pack1 - put operand 1 back into float format
                +1  7489     
00DE            +1  7490     pack1:
00DE E8         +1  7491             mov     a,r0            ;get exponent
00DF C3         +1  7492             clr     c
00E0 13         +1  7493             rrc     a               ;shift down 1 bit
00E1 530780     +1  7494             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  7495             orl     a,r7            ;or in sign bit
00E5 FA         +1  7496             mov     r2,a            ;store
00E6 E8         +1  7497             mov     a,r0            ;get other bit
00E7 03         +1  7498             rr      a               ;rotate into hi bit
00E8 5480       +1  7499             anl     a,#80h          ;mask
00EA 53037F     +1  7500             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  7501             orl     mant1+1,a       ;put in
00EF 22         +1  7502             ret
                +1  7503     
                +1  7504     
                +1  7505     ;       norm1 - normalize the unpacked value in 1
                +1  7506     
00F0            +1  7507     norm1:
00F0 E8         +1  7508             mov     a,r0            ;get exponent
00F1 60C0       +1  7509             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  7510             mov     a,r2            ;get hi byte
00F4 6023       +1  7511             jz      norup           ;zero, so shift up if anything
00F6            +1  7512     nordn:
00F6 EA         +1  7513             mov     a,r2            ;get hi byte
00F7 B4010D     +1  7514             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  7515+3           add1                    ;add in a rounding bit
00FA ED         +1  7516+1           mov     a,r5
00FB 2401       +1  7517+1           add     a,#1
00FD FD         +1  7518+1           mov     r5,a
00FE E4         +1  7519+1           clr     a
00FF 3C         +1  7520+1           addc    a,r4
0100 FC         +1  7521+1           mov     r4,a
0101 E4         +1  7522+1           clr     a
0102 3B         +1  7523+1           addc    a,r3
0103 FB         +1  7524+1           mov     r3,a
0104 E4         +1  7525+1           clr     a
0105 3A         +1  7526+1           addc    a,r2
0106 FA         +1  7527+1           mov     r2,a
0107            +1  7528     nordn1:
                +1  7529+3           rshift                  ;shift down 1 bit
0107 C3         +1  7530+1           clr     c
0108 EA         +1  7531+1           mov     a,r2
0109 13         +1  7532+1           rrc     a
010A FA         +1  7533+1           mov     r2,a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   120

010B EB         +1  7534+1           mov     a,r3
010C 13         +1  7535+1           rrc     a
010D FB         +1  7536+1           mov     r3,a
010E EC         +1  7537+1           mov     a,r4
010F 13         +1  7538+1           rrc     a
0110 FC         +1  7539+1           mov     r4,a
0111 ED         +1  7540+1           mov     a,r5
0112 13         +1  7541+1           rrc     a
0113 FD         +1  7542+1           mov     r5,a
0114 08         +1  7543             inc     r0              ;adjust exponent
0115 EA         +1  7544             mov     a,r2            ;test high byte
0116 70DE       +1  7545             jnz     nordn           ;loop
0118 22         +1  7546             ret                     ;done
                +1  7547     
0119            +1  7548     norup:
0119 4B         +1  7549             orl     a,r3
011A 4C         +1  7550             orl     a,r4
011B 4D         +1  7551             orl     a,r5            ;test for zero mantissa
011C 6095       +1  7552             jz      zer1            ;it is - make it true zero
011E            +1  7553     norup1:
011E EB         +1  7554             mov     a,r3            ;get mantissa byte
011F 20E710     +1  7555             jb      acc.7,norup2    ;jump if set
0122 C3         +1  7556             clr     c
                +1  7557+3           lshift                  ;shift mantissa up
0123 ED         +1  7558+1           mov     a,r5
0124 33         +1  7559+1           rlc     a
0125 FD         +1  7560+1           mov     r5,a
0126 EC         +1  7561+1           mov     a,r4
0127 33         +1  7562+1           rlc     a
0128 FC         +1  7563+1           mov     r4,a
0129 EB         +1  7564+1           mov     a,r3
012A 33         +1  7565+1           rlc     a
012B FB         +1  7566+1           mov     r3,a
012C EA         +1  7567+1           mov     a,r2
012D 33         +1  7568+1           rlc     a
012E FA         +1  7569+1           mov     r2,a
012F 18         +1  7570             dec     r0              ;adjust exponent
0130 80EC       +1  7571             jmp     norup1
0132            +1  7572     norup2:
0132 22         +1  7573             ret                     ;finito
                +1  7574     
                +1  7575     
                +1  7576     ;       fpdenorm - denormalize one of the two operands so that their
                +1  7577     ;       exponents are equal. This requires the smaller number to have
                +1  7578     ;       its exponent incremented and its mantissa shifted right.
                +1  7579     
0133            +1  7580     denorm:
0133 E8         +1  7581             mov     a,r0
0134 C3         +1  7582             clr     c
0135 99         +1  7583             subb    a,r1            ;compare exponents
0136 5029       +1  7584             jnc     up2a            ;shift operand 2
0138            +1  7585     up1:
0138 08         +1  7586             inc     r0              ;increment exponent
                +1  7587+3           rshift                  ;shift mantissa down
0139 C3         +1  7588+1           clr     c
013A EA         +1  7589+1           mov     a,r2
013B 13         +1  7590+1           rrc     a
013C FA         +1  7591+1           mov     r2,a
013D EB         +1  7592+1           mov     a,r3
013E 13         +1  7593+1           rrc     a
013F FB         +1  7594+1           mov     r3,a
0140 EC         +1  7595+1           mov     a,r4
0141 13         +1  7596+1           rrc     a
0142 FC         +1  7597+1           mov     r4,a
0143 ED         +1  7598+1           mov     a,r5
0144 13         +1  7599+1           rrc     a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   121

0145 FD         +1  7600+1           mov     r5,a
0146 E8         +1  7601             mov     a,r0
0147 B501EE     +1  7602             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  7603             ret
                +1  7604     
014B            +1  7605     up2:
014B 09         +1  7606             inc     r1              ;increment exponent 2
                +1  7607+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  7608+1           clr     c
014D E508       +1  7609+1           mov     a,mant2
014F 13         +1  7610+1           rrc     a
0150 F508       +1  7611+1           mov     mant2,a
0152 E509       +1  7612+1           mov     a,mant2+1
0154 13         +1  7613+1           rrc     a
0155 F509       +1  7614+1           mov     mant2+1,a
0157 E50A       +1  7615+1           mov     a,mant2+2
0159 13         +1  7616+1           rrc     a
015A F50A       +1  7617+1           mov     mant2+2,a
015C E50B       +1  7618+1           mov     a,mant2+3
015E 13         +1  7619+1           rrc     a
015F F50B       +1  7620+1           mov     mant2+3,a
0161            +1  7621     up2a:
0161 E8         +1  7622             mov     a,r0            ;compare exponents
0162 B501E6     +1  7623             cjne    a,exp2,up2
0165 22         +1  7624             ret                     ;all done
                +1  7625     ;------------------------------------------------------------------
                +1  7626     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  7627     
0166            +1  7628     fladd:
                +1  7629+3           saveregs
0166 C007       +1  7630+1           push    7
0168 C006       +1  7631+1           push    6
016A C001       +1  7632+1           push    1
016C C000       +1  7633+1           push    0
016E 119E       +1  7634             call    unpack1
0170 11BA       +1  7635             call    unpack2
0172 3133       +1  7636             call    denorm
0174 E507       +1  7637             mov     a,sign
0176 30E70D     +1  7638             jnb     acc.7,ok1       ;test left sign
                +1  7639+3           neg1                    ;negate op1
0179 C3         +1  7640+1           clr     c
017A E4         +1  7641+1           clr     a
017B 9D         +1  7642+1           subb    a,r5
017C FD         +1  7643+1           mov     r5,a
017D E4         +1  7644+1           clr     a
017E 9C         +1  7645+1           subb    a,r4
017F FC         +1  7646+1           mov     r4,a
0180 E4         +1  7647+1           clr     a
0181 9B         +1  7648+1           subb    a,r3
0182 FB         +1  7649+1           mov     r3,a
0183 E4         +1  7650+1           clr     a
0184 9A         +1  7651+1           subb    a,r2
0185 FA         +1  7652+1           mov     r2,a
0186            +1  7653     ok1:
0186 E507       +1  7654             mov     a,sign
0188 30E615     +1  7655             jnb     acc.6,ok2       ;test right sign
                +1  7656+3           negm    mant2           ;negate op2
018B C3         +1  7657+1           clr     c
018C E4         +1  7658+1           clr     a
018D 950B       +1  7659+1           subb    a,mant2+3
018F F50B       +1  7660+1           mov     mant2+3,a
0191 E4         +1  7661+1           clr     a
0192 950A       +1  7662+1           subb    a,mant2+2
0194 F50A       +1  7663+1           mov     mant2+2,a
0196 E4         +1  7664+1           clr     a
0197 9509       +1  7665+1           subb    a,mant2+1
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   122

0199 F509       +1  7666+1           mov     mant2+1,a
019B E4         +1  7667+1           clr     a
019C 9508       +1  7668+1           subb    a,mant2
019E F508       +1  7669+1           mov     mant2,a
01A0            +1  7670     ok2:
                +1  7671+3           addl    mant2           ;add mantissas
01A0 ED         +1  7672+1           mov     a,r5
01A1 250B       +1  7673+1           add     a,mant2+3
01A3 FD         +1  7674+1           mov     r5,a
01A4 E50A       +1  7675+1           mov     a,mant2+2
01A6 3C         +1  7676+1           addc    a,r4
01A7 FC         +1  7677+1           mov     r4,a
01A8 E509       +1  7678+1           mov     a,mant2+1
01AA 3B         +1  7679+1           addc    a,r3
01AB FB         +1  7680+1           mov     r3,a
01AC E508       +1  7681+1           mov     a,mant2+0
01AE 3A         +1  7682+1           addc    a,r2
01AF FA         +1  7683+1           mov     r2,a
01B0 E4         +1  7684             clr     a
01B1 FF         +1  7685             mov     r7,a            ;clear sign
01B2 EA         +1  7686             mov     a,r2            ;get sign of result
01B3 30E70E     +1  7687             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  7688             mov     r7,a            ;store sign
                +1  7689+3           neg1                    ;negate mantissa
01B7 C3         +1  7690+1           clr     c
01B8 E4         +1  7691+1           clr     a
01B9 9D         +1  7692+1           subb    a,r5
01BA FD         +1  7693+1           mov     r5,a
01BB E4         +1  7694+1           clr     a
01BC 9C         +1  7695+1           subb    a,r4
01BD FC         +1  7696+1           mov     r4,a
01BE E4         +1  7697+1           clr     a
01BF 9B         +1  7698+1           subb    a,r3
01C0 FB         +1  7699+1           mov     r3,a
01C1 E4         +1  7700+1           clr     a
01C2 9A         +1  7701+1           subb    a,r2
01C3 FA         +1  7702+1           mov     r2,a
01C4            +1  7703     ok3:
01C4 11F0       +1  7704             call    norm1
01C6 11DE       +1  7705             call    pack1           ;pack normalized result
                +1  7706+3           restregs                ;and return
01C8 D000       +1  7707+1           pop     0
01CA D001       +1  7708+1           pop     1
01CC D006       +1  7709+1           pop     6
01CE D007       +1  7710+1           pop     7
01D0 22         +1  7711             ret
                +1  7712     ;-------------------------------------------------------------
                +1  7713     ;       Subtract the number ltemp from the number in r2-r5
                +1  7714     
01D1            +1  7715     flsub:
01D1 630880     +1  7716             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  7717             jmp     fladd           ;and add!
                +1  7718     
                +1  7719     ;================================================================
                +1  7720     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  7721     
01D6            +1  7722     flcmp:
01D6 EA         +1  7723            mov     a,r2            ;get sign of left
01D7 6508       +1  7724            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  7725            jnb     acc.7,cexp      ;same, go check exponent
                +1  7726     ;ifdef SMALL_MODEL
01DC EA         +1  7727             mov     a,r2            ;get sign of left again
01DD 33         +1  7728             rlc     a
01DE 5001       +1  7729             jnc     flout
                +1  7730     ;endif
01E0 D3         +1  7731             setb    c
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   123

01E1 22         +1  7732     flout:          ret                    ;return with acc < 0
                +1  7733     
01E2            +1  7734     cexp:
01E2 C3         +1  7735            clr     c
01E3 EA         +1  7736            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  7737            subb    a,ltemp
01E6 7010       +1  7738            jnz     fnd
01E8 EB         +1  7739            mov     a,r3
01E9 9509       +1  7740            subb    a,ltemp+1
01EB 700B       +1  7741            jnz     fnd
01ED EC         +1  7742            mov     a,r4
01EE 950A       +1  7743            subb    a,ltemp+2
01F0 7006       +1  7744            jnz     fnd
01F2 ED         +1  7745            mov     a,r5
01F3 950B       +1  7746            subb    a,ltemp+3
01F5 7001       +1  7747            jnz     fnd
01F7            +1  7748     cdone:
01F7 22         +1  7749            ret                     ;return with acc == 0
01F8            +1  7750     fnd:
01F8 8AF0       +1  7751           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  7752          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  7753            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  7754                         orl         a,#1                          ;make non-zero
0201 B3         +1  7755             cpl     c               ;c=0->1,c=1->0
0202 22         +1  7756             ret
                +1  7757     ;==============================================================
                +1  7758     
                +1  7759     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  7760     ;       the result in r2-r5
                +1  7761     
0203            +1  7762     flmul:
                +1  7763+3           saveregs
0203 C007       +1  7764+1           push    7
0205 C006       +1  7765+1           push    6
0207 C001       +1  7766+1           push    1
0209 C000       +1  7767+1           push    0
020B 119E       +1  7768             call    unpack1
020D 11BA       +1  7769             call    unpack2
020F E4         +1  7770             clr     a
0210 F50C       +1  7771             mov     prod,a
0212 F50D       +1  7772             mov     prod+1,a        ;clear product
0214 F50E       +1  7773             mov     prod+2,a
0216 F50F       +1  7774             mov     prod+3,a
0218 7E07       +1  7775             mov     r6,#7           ;initialize counter
021A            +1  7776     mup1:
                +1  7777+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  7778+1           clr     c
021B E508       +1  7779+1           mov     a,mant2
021D 13         +1  7780+1           rrc     a
021E F508       +1  7781+1           mov     mant2,a
0220 E509       +1  7782+1           mov     a,mant2+1
0222 13         +1  7783+1           rrc     a
0223 F509       +1  7784+1           mov     mant2+1,a
0225 E50A       +1  7785+1           mov     a,mant2+2
0227 13         +1  7786+1           rrc     a
0228 F50A       +1  7787+1           mov     mant2+2,a
022A E50B       +1  7788+1           mov     a,mant2+3
022C 13         +1  7789+1           rrc     a
022D F50B       +1  7790+1           mov     mant2+3,a
022F 5014       +1  7791             jnc     nobit           ;skip if lsb was zero
                +1  7792+3           dan     prod            ;add multiplicand to product
0231 ED         +1  7793+1           mov     a,r5
0232 250F       +1  7794+1           add     a,prod+3
0234 F50F       +1  7795+1           mov     prod+3,a
0236 E50E       +1  7796+1           mov     a,prod+2
0238 3C         +1  7797+1           addc    a,r4
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   124

0239 F50E       +1  7798+1           mov     prod+2,a
023B E50D       +1  7799+1           mov     a,prod+1
023D 3B         +1  7800+1           addc    a,r3
023E F50D       +1  7801+1           mov     prod+1,a
0240 E50C       +1  7802+1           mov     a,prod+0
0242 3A         +1  7803+1           addc    a,r2
0243 F50C       +1  7804+1           mov     prod,a
0245            +1  7805     nobit:
                +1  7806+3           lshift                  ;shift multiplicand up
0245 ED         +1  7807+1           mov     a,r5
0246 33         +1  7808+1           rlc     a
0247 FD         +1  7809+1           mov     r5,a
0248 EC         +1  7810+1           mov     a,r4
0249 33         +1  7811+1           rlc     a
024A FC         +1  7812+1           mov     r4,a
024B EB         +1  7813+1           mov     a,r3
024C 33         +1  7814+1           rlc     a
024D FB         +1  7815+1           mov     r3,a
024E EA         +1  7816+1           mov     a,r2
024F 33         +1  7817+1           rlc     a
0250 FA         +1  7818+1           mov     r2,a
0251 DEC7       +1  7819             djnz    r6,mup1         ;loop if more
                +1  7820     
0253 7E11       +1  7821             mov     r6,#17          ;re-initalize counter
0255 8015       +1  7822             sjmp    mup3
0257            +1  7823     mup11:
                +1  7824+3           shfdn   prod            ;shift product right
0257 C3         +1  7825+1           clr     c
0258 E50C       +1  7826+1           mov     a,prod
025A 13         +1  7827+1           rrc     a
025B F50C       +1  7828+1           mov     prod,a
025D E50D       +1  7829+1           mov     a,prod+1
025F 13         +1  7830+1           rrc     a
0260 F50D       +1  7831+1           mov     prod+1,a
0262 E50E       +1  7832+1           mov     a,prod+2
0264 13         +1  7833+1           rrc     a
0265 F50E       +1  7834+1           mov     prod+2,a
0267 E50F       +1  7835+1           mov     a,prod+3
0269 13         +1  7836+1           rrc     a
026A F50F       +1  7837+1           mov     prod+3,a
026C            +1  7838     mup3:
                +1  7839+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  7840+1           clr     c
026D E508       +1  7841+1           mov     a,mant2
026F 13         +1  7842+1           rrc     a
0270 F508       +1  7843+1           mov     mant2,a
0272 E509       +1  7844+1           mov     a,mant2+1
0274 13         +1  7845+1           rrc     a
0275 F509       +1  7846+1           mov     mant2+1,a
0277 E50A       +1  7847+1           mov     a,mant2+2
0279 13         +1  7848+1           rrc     a
027A F50A       +1  7849+1           mov     mant2+2,a
027C E50B       +1  7850+1           mov     a,mant2+3
027E 13         +1  7851+1           rrc     a
027F F50B       +1  7852+1           mov     mant2+3,a
0281 5014       +1  7853             jnc     mup2            ;skip if bit not set
                +1  7854+3           dan     prod            ;add to prod
0283 ED         +1  7855+1           mov     a,r5
0284 250F       +1  7856+1           add     a,prod+3
0286 F50F       +1  7857+1           mov     prod+3,a
0288 E50E       +1  7858+1           mov     a,prod+2
028A 3C         +1  7859+1           addc    a,r4
028B F50E       +1  7860+1           mov     prod+2,a
028D E50D       +1  7861+1           mov     a,prod+1
028F 3B         +1  7862+1           addc    a,r3
0290 F50D       +1  7863+1           mov     prod+1,a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   125

0292 E50C       +1  7864+1           mov     a,prod+0
0294 3A         +1  7865+1           addc    a,r2
0295 F50C       +1  7866+1           mov     prod,a
0297            +1  7867     mup2:
0297 DEBE       +1  7868             djnz    r6,mup11        ;loop if more
0299 E8         +1  7869             mov     a,r0            ;get exp1
029A 29         +1  7870             add     a,r1            ;add exp2
029B 247A       +1  7871             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  7872             mov     r0,a            ;store
029E EF         +1  7873             mov     a,r7            ;get sign
029F 23         +1  7874             rl      a               ;rotate bit into msb
02A0 6207       +1  7875             xrl     sign,a          ;xor with other bit
                +1  7876+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  7877+1           mov     r2,prod
02A4 AB0D       +1  7878+1           mov     r3,prod+1
02A6 AC0E       +1  7879+1           mov     r4,prod+2
02A8 AD0F       +1  7880+1           mov     r5,prod+3
02AA 11F0       +1  7881             call    norm1           ;normalize
02AC 11DE       +1  7882             call    pack1
                +1  7883+3           restregs
02AE D000       +1  7884+1           pop     0
02B0 D001       +1  7885+1           pop     1
02B2 D006       +1  7886+1           pop     6
02B4 D007       +1  7887+1           pop     7
02B6 22         +1  7888             ret
                +1  7889     ;-----------------------------------------------------------
                +1  7890     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  7891     
02B7            +1  7892     fldiv:
                +1  7893+3           saveregs
02B7 C007       +1  7894+1           push    7
02B9 C006       +1  7895+1           push    6
02BB C001       +1  7896+1           push    1
02BD C000       +1  7897+1           push    0
02BF 119E       +1  7898             call    unpack1
02C1 11BA       +1  7899             call    unpack2
02C3 E4         +1  7900             clr     a
02C4 F50C       +1  7901             mov     prod,a
02C6 F50D       +1  7902             mov     prod+1,a
02C8 F50E       +1  7903             mov     prod+2,a
02CA F50F       +1  7904             mov     prod+3,a
02CC E9         +1  7905             mov     a,r1            ;check for zero divisor
02CD 6067       +1  7906             jz      div9
02CF E8         +1  7907             mov     a,r0            ;check for zero dividend
02D0 6064       +1  7908             jz      div9
02D2 C3         +1  7909             clr     c
02D3 99         +1  7910             subb    a,r1            ;compute new exponent
02D4 2478       +1  7911             add     a,#127-7        ;unbias
02D6 F8         +1  7912             mov     r0,a            ;store back
02D7 EF         +1  7913             mov     a,r7            ;get sign
02D8 23         +1  7914             rl      a
02D9 6207       +1  7915             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  7916             mov     r6,#24+7        ;initialize counter
02DD            +1  7917     div1:
                +1  7918+3           shfup   prod            ;shift quotient up
02DD C3         +1  7919+1           clr     c
02DE E50F       +1  7920+1           mov     a,prod+3
02E0 33         +1  7921+1           rlc     a
02E1 F50F       +1  7922+1           mov     prod+3,a
02E3 E50E       +1  7923+1           mov     a,prod+2
02E5 33         +1  7924+1           rlc     a
02E6 F50E       +1  7925+1           mov     prod+2,a
02E8 E50D       +1  7926+1           mov     a,prod+1
02EA 33         +1  7927+1           rlc     a
02EB F50D       +1  7928+1           mov     prod+1,a
02ED E50C       +1  7929+1           mov     a,prod
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   126

02EF 33         +1  7930+1           rlc     a
02F0 F50C       +1  7931+1           mov     prod,a
02F2 C3         +1  7932             clr     c
02F3 EA         +1  7933             mov     a,r2            ;compare values
02F4 9508       +1  7934             subb    a,mant2
02F6 4028       +1  7935             jc      div2            ;skip if bigger
02F8 7013       +1  7936             jnz     div3
02FA EB         +1  7937             mov     a,r3            ;compare values
02FB 9509       +1  7938             subb    a,mant2+1
02FD 4021       +1  7939             jc      div2            ;skip if bigger
02FF 700C       +1  7940             jnz     div3
0301 EC         +1  7941             mov     a,r4            ;compare values
0302 950A       +1  7942             subb    a,mant2+2
0304 401A       +1  7943             jc      div2            ;skip if bigger
0306 7005       +1  7944             jnz     div3
0308 ED         +1  7945             mov     a,r5            ;compare values
0309 950B       +1  7946             subb    a,mant2+3
030B 4013       +1  7947             jc      div2            ;skip if bigger
030D            +1  7948     div3:
030D ED         +1  7949             mov     a,r5
030E 950B       +1  7950             subb    a,mant2+3
0310 FD         +1  7951             mov     r5,a
0311 EC         +1  7952             mov     a,r4
0312 950A       +1  7953             subb    a,mant2+2               ;do subtraction
0314 FC         +1  7954             mov     r4,a
0315 EB         +1  7955             mov     a,r3
0316 9509       +1  7956             subb    a,mant2+1               ;do subtraction
0318 FB         +1  7957             mov     r3,a
0319 EA         +1  7958             mov     a,r2
031A 9508       +1  7959             subb    a,mant2         ;do subtraction
031C FA         +1  7960             mov     r2,a
031D 430F01     +1  7961             orl     prod+3,#1       ;set lsb in quotient
0320            +1  7962     div2:
                +1  7963+3           lshift                  ;shift dividend up
0320 ED         +1  7964+1           mov     a,r5
0321 33         +1  7965+1           rlc     a
0322 FD         +1  7966+1           mov     r5,a
0323 EC         +1  7967+1           mov     a,r4
0324 33         +1  7968+1           rlc     a
0325 FC         +1  7969+1           mov     r4,a
0326 EB         +1  7970+1           mov     a,r3
0327 33         +1  7971+1           rlc     a
0328 FB         +1  7972+1           mov     r3,a
0329 EA         +1  7973+1           mov     a,r2
032A 33         +1  7974+1           rlc     a
032B FA         +1  7975+1           mov     r2,a
032C DEAF       +1  7976             djnz    r6,div1         ;loop if more
                +1  7977+3           copytor prod            ;copy quotient
032E AA0C       +1  7978+1           mov     r2,prod
0330 AB0D       +1  7979+1           mov     r3,prod+1
0332 AC0E       +1  7980+1           mov     r4,prod+2
0334 AD0F       +1  7981+1           mov     r5,prod+3
0336            +1  7982     div9:
0336 11F0       +1  7983             call    norm1           ;now normalize result
0338 11DE       +1  7984             call    pack1           ;pack it up
                +1  7985+3           restregs                ;restore registers
033A D000       +1  7986+1           pop     0
033C D001       +1  7987+1           pop     1
033E D006       +1  7988+1           pop     6
0340 D007       +1  7989+1           pop     7
0342 22         +1  7990             ret
                +1  7991     ;------------------------------------------------------------------
                +1  7992     
                +1  7993     ;       Float to long conversion: if the exponent is less than the
                +1  7994     ;       excess value, the result is zero. If the exponent is so large
                +1  7995     ;       that the value would be shifted out, the result is overflow.
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   127

                +1  7996     ;       Otherwise shift the mantissa up or down as required.
                +1  7997     
0343            +1  7998     ftol:
                +1  7999+3           saveregs
0343 C007       +1  8000+1           push    7
0345 C006       +1  8001+1           push    6
0347 C001       +1  8002+1           push    1
0349 C000       +1  8003+1           push    0
034B EA         +1  8004             mov     a,r2
034C B4BF09     +1  8005             cjne    a,#0bfh,ne05
034F EB         +1  8006             mov     a,r3
0350 7006       +1  8007             jnz     ne05
0352 EC         +1  8008             mov     a,r4
0353 7003       +1  8009             jnz     ne05
0355 ED         +1  8010             mov     a,r5
0356 6024       +1  8011             jz      ftol1
0358 119E       +1  8012     ne05:   call    unpack1
035A E8         +1  8013             mov     a,r0            ;get exponent
035B 2482       +1  8014             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  8015             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  8016             mov     a,r7            ;get sign
0361 30E70D     +1  8017             jnb     acc.7,ftol4     ;skip if +ve
                +1  8018+3           neg1                    ;negate it
0364 C3         +1  8019+1           clr     c
0365 E4         +1  8020+1           clr     a
0366 9D         +1  8021+1           subb    a,r5
0367 FD         +1  8022+1           mov     r5,a
0368 E4         +1  8023+1           clr     a
0369 9C         +1  8024+1           subb    a,r4
036A FC         +1  8025+1           mov     r4,a
036B E4         +1  8026+1           clr     a
036C 9B         +1  8027+1           subb    a,r3
036D FB         +1  8028+1           mov     r3,a
036E E4         +1  8029+1           clr     a
036F 9A         +1  8030+1           subb    a,r2
0370 FA         +1  8031+1           mov     r2,a
0371            +1  8032     ftol4:
0371 E8         +1  8033             mov     a,r0            ;get exponent
0372 246A       +1  8034             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  8035             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  8036             mov     r0,a            ;save it
0378 24F8       +1  8037             add     a,#-8           ;if > 8, too big
037A 500E       +1  8038             jnc     ftol3
037C            +1  8039     ftol1:
037C E4         +1  8040             clr     a
037D FA         +1  8041             mov     r2,a
037E FB         +1  8042             mov     r3,a
037F FC         +1  8043             mov     r4,a
0380 FD         +1  8044             mov     r5,a
0381            +1  8045     ftol9:
                +1  8046+3           restregs
0381 D000       +1  8047+1           pop     0
0383 D001       +1  8048+1           pop     1
0385 D006       +1  8049+1           pop     6
0387 D007       +1  8050+1           pop     7
0389 22         +1  8051             ret
038A            +1  8052     ftol3:
038A E8         +1  8053             mov     a,r0
038B FE         +1  8054             mov     r6,a            ;store in counter
038C 60F3       +1  8055             jz      ftol9           ;if zero, do nothing
038E            +1  8056     ftol33:
                +1  8057+3           lshift                  ;shift up
038E ED         +1  8058+1           mov     a,r5
038F 33         +1  8059+1           rlc     a
0390 FD         +1  8060+1           mov     r5,a
0391 EC         +1  8061+1           mov     a,r4
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   128

0392 33         +1  8062+1           rlc     a
0393 FC         +1  8063+1           mov     r4,a
0394 EB         +1  8064+1           mov     a,r3
0395 33         +1  8065+1           rlc     a
0396 FB         +1  8066+1           mov     r3,a
0397 EA         +1  8067+1           mov     a,r2
0398 33         +1  8068+1           rlc     a
0399 FA         +1  8069+1           mov     r2,a
039A DEF2       +1  8070             djnz    r6,ftol33       ;and loop
039C 80E3       +1  8071             sjmp    ftol9
039E            +1  8072     ftol2:
039E F4         +1  8073             cpl     a               ;complement
039F FE         +1  8074             mov     r6,a
03A0 6022       +1  8075             jz      ftol22
03A2            +1  8076     ftol23:
03A2 EF         +1  8077             mov     a,r7
03A3 30E70F     +1  8078             jnb     acc.7,ftol24
                +1  8079+3           rshift1
03A6 D3         +1  8080+1           setb    c
03A7 EA         +1  8081+1           mov     a,r2
03A8 13         +1  8082+1           rrc     a
03A9 FA         +1  8083+1           mov     r2,a
03AA EB         +1  8084+1           mov     a,r3
03AB 13         +1  8085+1           rrc     a
03AC FB         +1  8086+1           mov     r3,a
03AD EC         +1  8087+1           mov     a,r4
03AE 13         +1  8088+1           rrc     a
03AF FC         +1  8089+1           mov     r4,a
03B0 ED         +1  8090+1           mov     a,r5
03B1 13         +1  8091+1           rrc     a
03B2 FD         +1  8092+1           mov     r5,a
03B3 800D       +1  8093             jmp     ftol25
03B5            +1  8094+3   ftol24: rshift                  ;shift down
03B5 C3         +1  8095+1           clr     c
03B6 EA         +1  8096+1           mov     a,r2
03B7 13         +1  8097+1           rrc     a
03B8 FA         +1  8098+1           mov     r2,a
03B9 EB         +1  8099+1           mov     a,r3
03BA 13         +1  8100+1           rrc     a
03BB FB         +1  8101+1           mov     r3,a
03BC EC         +1  8102+1           mov     a,r4
03BD 13         +1  8103+1           rrc     a
03BE FC         +1  8104+1           mov     r4,a
03BF ED         +1  8105+1           mov     a,r5
03C0 13         +1  8106+1           rrc     a
03C1 FD         +1  8107+1           mov     r5,a
03C2 DEDE       +1  8108     ftol25: djnz    r6,ftol23
03C4            +1  8109     ftol22:
                +1  8110+3           add1                    ;round
03C4 ED         +1  8111+1           mov     a,r5
03C5 2401       +1  8112+1           add     a,#1
03C7 FD         +1  8113+1           mov     r5,a
03C8 E4         +1  8114+1           clr     a
03C9 3C         +1  8115+1           addc    a,r4
03CA FC         +1  8116+1           mov     r4,a
03CB E4         +1  8117+1           clr     a
03CC 3B         +1  8118+1           addc    a,r3
03CD FB         +1  8119+1           mov     r3,a
03CE E4         +1  8120+1           clr     a
03CF 3A         +1  8121+1           addc    a,r2
03D0 FA         +1  8122+1           mov     r2,a
03D1 EF         +1  8123             mov     a,r7
03D2 30E70F     +1  8124             jnb     acc.7,ftol26
                +1  8125+3           rshift1
03D5 D3         +1  8126+1           setb    c
03D6 EA         +1  8127+1           mov     a,r2
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   129

03D7 13         +1  8128+1           rrc     a
03D8 FA         +1  8129+1           mov     r2,a
03D9 EB         +1  8130+1           mov     a,r3
03DA 13         +1  8131+1           rrc     a
03DB FB         +1  8132+1           mov     r3,a
03DC EC         +1  8133+1           mov     a,r4
03DD 13         +1  8134+1           rrc     a
03DE FC         +1  8135+1           mov     r4,a
03DF ED         +1  8136+1           mov     a,r5
03E0 13         +1  8137+1           rrc     a
03E1 FD         +1  8138+1           mov     r5,a
03E2 809D       +1  8139             jmp     ftol9
03E4            +1  8140+3   ftol26: rshift
03E4 C3         +1  8141+1           clr     c
03E5 EA         +1  8142+1           mov     a,r2
03E6 13         +1  8143+1           rrc     a
03E7 FA         +1  8144+1           mov     r2,a
03E8 EB         +1  8145+1           mov     a,r3
03E9 13         +1  8146+1           rrc     a
03EA FB         +1  8147+1           mov     r3,a
03EB EC         +1  8148+1           mov     a,r4
03EC 13         +1  8149+1           rrc     a
03ED FC         +1  8150+1           mov     r4,a
03EE ED         +1  8151+1           mov     a,r5
03EF 13         +1  8152+1           rrc     a
03F0 FD         +1  8153+1           mov     r5,a
03F1 808E       +1  8154             jmp     ftol9
                +1  8155     
                +1  8156     ;       arithmetic integer to floating conversions
                +1  8157     
03F3            +1  8158     abtof:
03F3 ED         +1  8159             mov     a,r5
03F4 23         +1  8160             rl      a
03F5 FC         +1  8161             mov     r4,a
03F6 9C         +1  8162             subb    a,r4
03F7 FC         +1  8163             mov     r4,a
03F8 FB         +1  8164             mov     r3,a
03F9 FA         +1  8165             mov     r2,a
03FA 8006       +1  8166             jmp     altof
03FC            +1  8167     awtof:
03FC EC         +1  8168             mov     a,r4
03FD 23         +1  8169             rl      a
03FE FB         +1  8170             mov     r3,a
03FF 9B         +1  8171             subb    a,r3
0400 FB         +1  8172             mov     r3,a
0401 FA         +1  8173             mov     r2,a
0402            +1  8174     altof:
                +1  8175+3           saveregs
0402 C007       +1  8176+1           push    7
0404 C006       +1  8177+1           push    6
0406 C001       +1  8178+1           push    1
0408 C000       +1  8179+1           push    0
040A EA         +1  8180             mov     a,r2            ;get sign
040B 5480       +1  8181             anl     a,#80h
040D FF         +1  8182             mov     r7,a            ;store it
040E 30E70D     +1  8183             jnb     acc.7,altof1    ;skip if +ve
                +1  8184+3           neg1
0411 C3         +1  8185+1           clr     c
0412 E4         +1  8186+1           clr     a
0413 9D         +1  8187+1           subb    a,r5
0414 FD         +1  8188+1           mov     r5,a
0415 E4         +1  8189+1           clr     a
0416 9C         +1  8190+1           subb    a,r4
0417 FC         +1  8191+1           mov     r4,a
0418 E4         +1  8192+1           clr     a
0419 9B         +1  8193+1           subb    a,r3
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   130

041A FB         +1  8194+1           mov     r3,a
041B E4         +1  8195+1           clr     a
041C 9A         +1  8196+1           subb    a,r2
041D FA         +1  8197+1           mov     r2,a
041E            +1  8198     altof1:
041E 7896       +1  8199             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  8200             call    norm1           ;normalize it
0422 11DE       +1  8201             call    pack1           ;and pack up
                +1  8202+3           restregs
0424 D000       +1  8203+1           pop     0
0426 D001       +1  8204+1           pop     1
0428 D006       +1  8205+1           pop     6
042A D007       +1  8206+1           pop     7
042C 22         +1  8207             ret
                +1  8208     
042D            +1  8209     lbtof:
042D 7C00       +1  8210             mov     r4,#0
042F            +1  8211     lwtof:
042F E4         +1  8212             clr     a
0430 FB         +1  8213             mov     r3,a
0431 FA         +1  8214             mov     r2,a
0432            +1  8215     lltof:
                +1  8216+3           saveregs
0432 C007       +1  8217+1           push    7
0434 C006       +1  8218+1           push    6
0436 C001       +1  8219+1           push    1
0438 C000       +1  8220+1           push    0
043A 7F00       +1  8221             mov     r7,#0           ;zero sign
043C 80E0       +1  8222             sjmp    altof1
                +1  8223     
                +1  8224     ;-------------------------------------------------------
                +1  8225     
                +1  8226     
                    8227     
                    8228     ;$include (d:\amp\wriread.asm)
                +1  8229     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  8230     cle256:          mov            IE,#00H
0441 75B601     +1  8231                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  8232                              MOV            PSCTL,#03
                +1  8233                                             
0447 7400       +1  8234                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  8235                                     movx    @dptr,a                         ;wr
044A 758F00     +1  8236                                     mov             PSCTL,#00
044D 75B600     +1  8237                                 mov         FLSCL,#00
0450 75A880     +1  8238                               mov           IE,#80H
0453 22         +1  8239                                     ret
                +1  8240     
                +1  8241     ;чтение памяти программ в r8..r11
                +1  8242     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  8243     re4byte:        mov                     dph,r2
0456 8B82       +1  8244                                             mov                     dpl,r3
0458 E4         +1  8245                                             clr                     a
0459 93         +1  8246                                             movc            a,@a+dptr
045A F508       +1  8247                                             mov                     r8,a
045C A3         +1  8248                                             inc                     dptr
045D E4         +1  8249                                             clr                     a
045E 93         +1  8250                                             movc            a,@a+dptr
045F F509       +1  8251                                             mov                     r9,a
0461 A3         +1  8252                                             inc                     dptr
0462 E4         +1  8253                                             clr                     a
0463 93         +1  8254                                             movc            a,@a+dptr
0464 F50A       +1  8255                                             mov                     r10,a
0466 A3         +1  8256                                             inc                     dptr
0467 E4         +1  8257                                             clr                     a
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   131

0468 93         +1  8258                                             movc            a,@a+dptr
0469 F50B       +1  8259                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  8260                                             ret
                +1  8261      ;чтение памяти программ в r2..r5
                +1  8262     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  8263     rebyte2:        mov                     dph,r2
046E 8B82       +1  8264                                             mov                     dpl,r3
0470 E4         +1  8265                                             clr                     a
0471 93         +1  8266                                             movc            a,@a+dptr
0472 FA         +1  8267                                             mov                     r2,a
0473 A3         +1  8268                                             inc                     dptr
0474 E4         +1  8269                                             clr                     a
0475 93         +1  8270                                             movc            a,@a+dptr
0476 FB         +1  8271                                             mov                     r3,a
0477 A3         +1  8272                                             inc                     dptr
0478 E4         +1  8273                                             clr                     a
0479 93         +1  8274                                             movc            a,@a+dptr
047A FC         +1  8275                                             mov                     r4,a
047B A3         +1  8276                                             inc                     dptr
047C E4         +1  8277                                             clr                     a
047D 93         +1  8278                                             movc            a,@a+dptr
047E FD         +1  8279                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  8280                                             ret
                +1  8281      
                +1  8282     
                +1  8283      ;r7-количество байт
                +1  8284     ;dptr-адр ячейки для записи
                +1  8285     ;r1-адр ячейки  внешнего озу
                +1  8286     
0480 75A800     +1  8287     wrpage:  mov            IE,#00H
0483 75B601     +1  8288     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  8289                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  8290                      movx           a,@r1
048A F0         +1  8291                      movx           @dptr,a                         ;wr
048B 758F00     +1  8292                      mov            PSCTL,#0
048E 75B600     +1  8293                      mov            FLSCL,#00
0491 A3         +1  8294                     inc                     dptr
0492 09         +1  8295                     inc                     r1
0493 DFEE       +1  8296                     djnz            r7,WW5
0495 75A880     +1  8297                     mov             IE,#80H
0498 22         +1  8298                     ret
                +1  8299                             
                +1  8300     
                +1  8301     
                +1  8302                                                             
                +1  8303     
                +1  8304     
                +1  8305     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8306     ;чтение памяти программ во внешнее озу
                +1  8307     ;вх-r2,r3-адр яч памяти прогр
                +1  8308     ;r1- яч внешнее озу
0499 8A83       +1  8309     copyPP:         mov                     dph,r2
049B 8B82       +1  8310                                             mov                     dpl,r3
049D 7FFF       +1  8311                                             mov                     r7,#0ffh
049F E4         +1  8312     copy1:          clr                     a
04A0 93         +1  8313                                             movc            a,@a+dptr
04A1 F3         +1  8314                                             movx                    @r1,a
04A2 A3         +1  8315                                             inc                     dptr
04A3 09         +1  8316                                             inc                     r1
04A4 DFF9       +1  8317                                             djnz            r7,copy1
04A6 22         +1  8318                                             ret
                +1  8319     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8320     
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   132

                +1  8321                                     
                +1  8322     
                +1  8323     ;r8..r11->@r0..@r0+3
                +1  8324     ;r0-адр ячейки
                +1  8325     ;сохранить в ячейке озу
04A7 E508       +1  8326     savelte:        mov     a,ltemp
04A9 F6         +1  8327                                             mov     @r0,a
04AA 08         +1  8328                                             inc     r0
04AB E509       +1  8329                                             mov     a,ltemp+1
04AD F6         +1  8330                                             mov     @r0,a
04AE 08         +1  8331                                             inc     r0
04AF E50A       +1  8332                                             mov     a,ltemp+2
04B1 F6         +1  8333                                             mov     @r0,a
04B2 08         +1  8334                                             inc     r0
04B3 E50B       +1  8335                                             mov     a,ltemp+3
04B5 F6         +1  8336                                             mov     @r0,a
04B6 22         +1  8337                                             ret
                +1  8338     
                +1  8339     ;
                +1  8340     
                +1  8341     
                +1  8342     
                +1  8343     
                +1  8344     
                +1  8345                     
                +1  8346     
                +1  8347     
                +1  8348     
                +1  8349     
                +1  8350      
                    8351     
                    8352                                                   
                    8353     END
                                                                             
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   133

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   03B1H   R   SEG=MAIN   867#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1475 1532 1557 1578 1582 1585 1586 1588 1697 1702 3619 3633 3714
                                           3717 3760 3855 3899 3902 3979 3983 3984 3985 3988 4231 4268 4269 4271 4348
                                           4368 4459 4463 4506 4509 4848 4853 5019 5024 5784 5946 5949
ABRET. . . . . . .  C ADDR   23FEH   R   SEG=MAIN   5713 5715#
ABTOF. . . . . . .  C ADDR   03F3H   A      8158#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 681 745 753 761 769 771 791 1146 1157 1165 1244 1646 1834 1843 1852
                                           1861 1882 2251 2276 2281 2285 2290 2293 2296 2299 2302 2490 2551 2597 2608
                                           2700 2709 2717 2726 2867 2899 2924 2929 2933 2936 2939 2942 2945 2948 3279
                                           3367 3413 3435 3454 3476 3502 4408 4414 4451 4540 5287 6376 6565 6643 6646
                                           6903 7555 7638 7655 7687 7725 7753 8015 8017 8035 8078 8124 8183
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   2BC3H   R   SEG=MAIN   902 939 941 943 945 947 949 951 953 955 1021 1023 1025 1027 1029
                                           1031 1033 1035 1037 1040 1042 1044 1046 1048 1050 1052 1054 1056 1058 1077
                                           1079 1081 7144#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1531 1543 1547 1562 1587 1590 1591 1701 1705 3632 3636 3711 3715
                                           3757 3761 3852 3856 3901 3905 3987 4000 4241 4255 4257 4259 4270 4273 4358
                                           4369 4464 4510 4852 4856 5023 5027 5585 5604 5622 5685 5702 5948 5951 6297
                                           6329
ADRBLOK. . . . . .  C ADDR   2877H   R   SEG=MAIN   3351 3374 3730 3873 4770 4938 5089 6341#
AFTERK . . . . . .  C ADDR   06A8H   R   SEG=MAIN   1174 1253#
AGE2 . . . . . . .  C ADDR   024BH   R   SEG=MAIN   633# 636
AGE9 . . . . . . .  C ADDR   086EH   R   SEG=MAIN   1479# 1482
AGEON. . . . . . .  C ADDR   0259H   R   SEG=MAIN   642# 644
ALESS0 . . . . . .  C ADDR   09A9H   R   SEG=MAIN   1646 1667#
ALLSUM . . . . . .  C ADDR   034FH   R   SEG=MAIN   811# 846 864 880
ALMUL. . . . . . .  C ADDR   2B0AH   R   SEG=MAIN   6990#
ALTOF. . . . . . .  C ADDR   0402H   A      1140 1238 1269 1277 1295 1311 1322 1339 1352 1437 1984 2094 2166 2204
                                           3764 3861 4372 4467 4513 4601 4679 4687 4705 4811 4823 4838 4922 4984 5000
                                           5073 5135 5150 8166 8174#
ALTOF1 . . . . . .  C ADDR   041EH   A      8183 8198# 8222
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   060EH   R   SEG=MAIN   1138 1154#
AN_T7. . . . . . .  C ADDR   11F5H   R   SEG=MAIN   2949# 3024 3034
AUTOKA . . . . . .  C ADDR   0C8DH   R   SEG=MAIN   1172 2134#
AVPGO. . . . . . .  C ADDR   07D9H   R   SEG=MAIN   1399 1401#
AVTDEC1. . . . . .  C ADDR   066AH   R   SEG=MAIN   1207 1216#
AWTOF. . . . . . .  C ADDR   03FCH   A      8167#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   134

B. . . . . . . . .  D ADDR   00F0H   A      122# 5432 5804 6993 6996 6998 7002 7006 7010 7014 7019 7023 7030 7034
                                           7038 7044 7048 7052 7058 7751 7752
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 462#
BFORM. . . . . . .  C ADDR   27B4H   R   SEG=MAIN   6146 6151 6163# 6189
BIFL_KT. . . . . .  B ADDR   0021H.5 A      337# 4597 4653 4752
BIN30. . . . . . .  C ADDR   2926H   R   SEG=MAIN   6553# 6579
BIN31. . . . . . .  C ADDR   292AH   R   SEG=MAIN   6558# 6562
BIN32. . . . . . .  C ADDR   293AH   R   SEG=MAIN   6571# 6576
BIN41. . . . . . .  C ADDR   294BH   R   SEG=MAIN   6587# 6597
BINDEC . . . . . .  C ADDR   291AH   R   SEG=MAIN   1533 1589 1703 3634 3903 3989 4272 4854 5025 5950 6532#
BITAKT . . . . . .  B ADDR   0023H.2 A      356# 1788 1789 1792
BITAVP . . . . . .  B ADDR   0020H.5 A      327# 1365 1598 1778 3012 3013 3015
BITBON . . . . . .  B ADDR   0021H.2 A      334# 1814 1938 2115 2134 2311 2312 2320 6377
BITBUF . . . . . .  B ADDR   0021H.0 A      332#
BITEIZM. . . . . .  B ADDR   0022H.5 A      347# 1263 1724 1731 1796 2983 2999 4144 5351
BITIZM . . . . . .  B ADDR   0020H.4 A      326# 582 713 1603 2282 2363 2448 2483 2514 2930 2986 3110 3133 3208 3239
                                           3264 3370 3483 3734 3782 3810 3971 4099 4145 4192 4304 4381 4495
BITKLB . . . . . .  B ADDR   0022H.2 A      344# 1332 1812 2287 2985 3003 3011 3018 4379 4667
BITMAS . . . . . .  B ADDR   0020H.1 A      323# 1088 1091 6129
BITMEM . . . . . .  B ADDR   0021H.3 A      335# 1687 2694 3242 3260 3272 3369 3482 3735 3781 3970
BITMENU. . . . . .  B ADDR   0022H.1 A      343# 1686 2513 2625 2987 3263 3790 3809 4104 4146 4191 4303 4378
BITMIG . . . . . .  B ADDR   0023H.1 A      355# 2590 2778 2877 3176 3531 3671 3684 4210 4337 4443 4544 5869 5895
                                           5920 5932 5995 6002 6008 6014
BITNUL . . . . . .  B ADDR   0021H.7 A      339# 1413 1622 1759 2351 3032 3036 3037 3044
BITOLL . . . . . .  B ADDR   0022H.7 A      349# 657 1606 1684 2988
BITPAR . . . . . .  B ADDR   0022H.6 A      348# 4110 4668
BITPRD . . . . . .  B ADDR   0021H.1 A      333# 1937
BITRS. . . . . . .  B ADDR   0020H.3 A      325#
BITT2. . . . . . .  B ADDR   0022H.0 A      342# 1683 2449 2484 2487 3051 3209
BITV19 . . . . . .  B ADDR   0022H.3 A      345# 526 530 2661 2666 2672 4088 4093 4174 4187 4309 4313 4318
BITVI11. . . . . .  B ADDR   0020H.6 A      328# 1363 1379 1422 2305 2307 2362 2512 2982 3102 3109 3262 4494
BITVICH. . . . . .  B ADDR   0022H.4 A      346# 1421 1682 2306 2364 2374 2511 2519 3069 3101 3132 3261 4493
BITZNAK. . . . . .  B ADDR   0020H.0 A      322# 682 728
BITZNB . . . . . .  B ADDR   0023H.3 A      357# 4514 5711 5714
BITZUS . . . . . .  B ADDR   0020H.7 A      329# 1414 1623 2042 2045 2409
BLOIN. . . . . . .  C ADDR   1693H   R   SEG=MAIN   3639# 3644
BLOKVV . . . . . .  C ADDR   1665H   R   SEG=MAIN   3609#
BLOKVVC. . . . . .  C ADDR   166FH   R   SEG=MAIN   3612 3615#
BL_LI. . . . . . .  C ADDR   1630H   R   SEG=MAIN   3559 3567#
BONPART. . . . . .  C ADDR   0C67H   R   SEG=MAIN   2114#
BOUT7. . . . . . .  C ADDR   13CEH   R   SEG=MAIN   3219# 3221
BRET . . . . . . .  C ADDR   223FH   R   SEG=MAIN   5372 5377 5381#
BUFDEC . . . . . .  C ADDR   09DBH   R   SEG=MAIN   1708# 1713
BUFIND . . . . . .  D ADDR   0040H   A      298# 632 636 641 644 650 1478 1482 1548 1569 1590 1591 1592 1656 1661
                                           1706 1714 1716 1721 1757 1776 1782 1790 1793 1798 1813 1815 2270 2317 2321
                                           2565 2583 2599 2601 2604 2664 2665 2670 2671 2773 2817 2836 2917 2991 3053
                                           3111 3112 3159 3163 3189 3211 3225 3232 3243 3244 3342 3526 3553 3581 3610
                                           3637 3651 3652 3656 3657 3664 3665 3670 3686 3825 3832 3906 3914 3916 3932
                                           3956 3990 3999 4001 4065 4087 4094 4202 4240 4273 4274 4275 4276 4278 4312
                                           4317 4329 4357 4380 4435 4481 4857 4865 4869 5028 5036 5040 5187 5219 5430
                                           5443 5449 5456 5584 5603 5621 5684 5701 5712 5872 5898 5952 5999 6020 6296
                                           6328 6378
BUFL_DEC . . . . .  C ADDR   20F5H   R   SEG=MAIN   5161#
BUFMEA . . . . . .  C ADDR   1F4CH   R   SEG=MAIN   4859# 4864
BUFMIN . . . . . .  C ADDR   203FH   R   SEG=MAIN   5030# 5035
BUFON. . . . . . .  C ADDR   0DE6H   R   SEG=MAIN   2311 2320#
BUFR . . . . . . .  C ADDR   0913H   R   SEG=MAIN   1571# 1576
BUFR2. . . . . . .  C ADDR   08F5H   R   SEG=MAIN   1550# 1555
BUFR3. . . . . . .  C ADDR   08EEH   R   SEG=MAIN   1541 1546#
BUFR30 . . . . . .  C ADDR   08F1H   R   SEG=MAIN   1544 1548#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      7748# 7752
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   135

CELLBIT. . . . . .  D ADDR   0020H   A      321# 322 323 324 325 326 327 328 329
CELLBIT1 . . . . .  D ADDR   0021H   A      331# 332 333 334 335 337 339
CELLBIT2 . . . . .  D ADDR   0022H   A      341# 342 343 344 345 346 347 348 349
CELLBIT3 . . . . .  D ADDR   0023H   A      353# 354 355 356 357
CEXP . . . . . . .  C ADDR   01E2H   A      7725 7734#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   22E2H   R   SEG=MAIN   1459 3045 4470 5516#
CH1. . . . . . . .  C ADDR   2302H   R   SEG=MAIN   5336 5527#
CH10 . . . . . . .  C ADDR   22E6H   R   SEG=MAIN   863 1102 3891 5517#
CH100. . . . . . .  C ADDR   22FAH   R   SEG=MAIN   810 1641 5522#
CH10000. . . . . .  C ADDR   22F6H   R   SEG=MAIN   5521#
CH150H . . . . . .  C ADDR   234AH   R   SEG=MAIN   5546#
CH2. . . . . . . .  C ADDR   22FEH   R   SEG=MAIN   1097 5523#
CH20 . . . . . . .  C ADDR   24C5H   R   SEG=MAIN   845 1107 5835#
CH2THO . . . . . .  C ADDR   232AH   R   SEG=MAIN   2173 2211 5538#
CH320H . . . . . .  C ADDR   2346H   R   SEG=MAIN   5545# 6349
CH4. . . . . . . .  C ADDR   22EEH   R   SEG=MAIN   1111 5519#
CH43 . . . . . . .  C ADDR   189EH   R   SEG=MAIN   3908# 3913
CH43_42. . . . . .  C ADDR   1944H   R   SEG=MAIN   4003# 4008
CH5. . . . . . . .  C ADDR   22EAH   R   SEG=MAIN   879 5518#
CH57 . . . . . . .  C ADDR   24C1H   R   SEG=MAIN   5834#
CH954. . . . . . .  C ADDR   22F2H   R   SEG=MAIN   5520#
CHAIBL . . . . . .  C ADDR   14DEH   R   SEG=MAIN   3344 3346#
CHAIPR . . . . . .  C ADDR   17F3H   R   SEG=MAIN   3827 3829#
CHANMA . . . . . .  C ADDR   0FB5H   R   SEG=MAIN   2597 2606#
CHANZ. . . . . . .  C ADDR   0F9CH   R   SEG=MAIN   2551 2595#
CHAVT. . . . . . .  D ADDR   0081H   A      371# 561 1163 1208 1216 2230 4100
CHBEFORE . . . . .  D ADDR   009BH   A      381# 584 807 821 840 858 874
CHBLOK . . . . . .  D ADDR   00D6H   A      408# 4768 4818 4834 4936 4990 5087 5141
CHBUF. . . . . . .  D ADDR   00CFH   A      405# 595 1912 2010 2051 2056 2116 2124 3779 5161 5166
CHBUF1 . . . . . .  X ADDR   0E00H   A      438# 1922 1997
CHCMP. . . . . . .  C ADDR   21E2H   R   SEG=MAIN   1169 5313#
CHDEC. . . . . . .  C ADDR   21F5H   R   SEG=MAIN   1217 1230 5328#
CHDEL. . . . . . .  D ADDR   0083H   A      372# 2075 2102 2136 2186 2224
CHDELMO. . . . . .  C ADDR   0C52H   R   SEG=MAIN   2085 2102# 2107
CHIF . . . . . . .  C ADDR   250AH   R   SEG=MAIN   5876 5879#
CHIF5. . . . . . .  C ADDR   2512H   R   SEG=MAIN   5882 5884#
CHIFB. . . . . . .  C ADDR   2535H   R   SEG=MAIN   5902 5905#
CHIFB1 . . . . . .  C ADDR   253BH   R   SEG=MAIN   5904 5905 5908#
CHIFL5 . . . . . .  C ADDR   2543H   R   SEG=MAIN   5912 5915#
CHIFOUR. . . . . .  C ADDR   2524H   R   SEG=MAIN   5889 5891 5895#
CHIND. . . . . . .  D ADDR   00ACH   A      387# 1381 1819
CHIND2 . . . . . .  D ADDR   0033H   A      315# 715 717 725
CHINKOR. . . . . .  D ADDR   0098H   A      370# 556 789 1155 1168 1210 1224 1229 2109
CHK. . . . . . . .  C ADDR   2342H   R   SEG=MAIN   1333 5544#
CHKL . . . . . . .  D ADDR   003DH   A      305# 695 697 705 707 708 710 2427 2454 2502 2963 3248 3962 4384
CHMAS. . . . . . .  D ADDR   006EH   A      302# 1085 1092 1115 6128
CHMASN . . . . . .  D ADDR   003FH   A      306# 796 805 841 859 875 891 1090 1092 1093
CHMINUS. . . . . .  C ADDR   285CH   R   SEG=MAIN   3364 3410 3432 3451 3473 6311# 6373
CHTADC . . . . . .  C ADDR   218CH   R   SEG=MAIN   5245#
CHTHO. . . . . . .  C ADDR   2322H   R   SEG=MAIN   1302 1340 4610 4695 4713 5536#
CHTHOU . . . . . .  C ADDR   23C9H   R   SEG=MAIN   5672#
CHZAP. . . . . . .  C ADDR   22DEH   R   SEG=MAIN   1901 5515#
CH_1 . . . . . . .  C ADDR   230AH   R   SEG=MAIN   587 1495 1518 1919 2036 2053 2128 3862 5163 5529#
CH_10. . . . . . .  C ADDR   233AH   R   SEG=MAIN   1501 1524 1993 2023 4373 4843 5013 5542#
CH_10TH. . . . . .  C ADDR   2336H   R   SEG=MAIN   1394 5541#
CH_2 . . . . . . .  C ADDR   230EH   R   SEG=MAIN   1914 1988 2016 2032 5530#
CH_200 . . . . . .  C ADDR   2332H   R   SEG=MAIN   5540#
CH_220 . . . . . .  C ADDR   232EH   R   SEG=MAIN   1356 5539#
CH_22T . . . . . .  C ADDR   2407H   R   SEG=MAIN   1447 5720#
CH_250 . . . . . .  C ADDR   233EH   R   SEG=MAIN   1258 5543#
CH_4 . . . . . . .  C ADDR   2312H   R   SEG=MAIN   2026 3865 5531#
CH_5 . . . . . . .  C ADDR   2316H   R   SEG=MAIN   5532#
CH_500 . . . . . .  C ADDR   2403H   R   SEG=MAIN   1443 5719#
CH_7 . . . . . . .  C ADDR   231AH   R   SEG=MAIN   2120 5533#
CH_953 . . . . . .  C ADDR   231EH   R   SEG=MAIN   5535#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   136

CH_B . . . . . . .  C ADDR   23FFH   R   SEG=MAIN   1463 5717#
CH_FL. . . . . . .  C ADDR   240BH   R   SEG=MAIN   1487 5721#
CH_M3. . . . . . .  C ADDR   234EH   R   SEG=MAIN   5547#
CH_MLN . . . . . .  C ADDR   2306H   R   SEG=MAIN   5528#
CIKLWR . . . . . .  C ADDR   278AH   R   SEG=MAIN   6134#
CKCON. . . . . . .  D ADDR   008EH   A      30# 480 511
CL4. . . . . . . .  C ADDR   2360H   R   SEG=MAIN   5564# 5566
CL4N . . . . . . .  C ADDR   2366H   R   SEG=MAIN   5573# 5575
CLE20. . . . . . .  C ADDR   1931H   R   SEG=MAIN   3993# 3995
CLE256 . . . . . .  C ADDR   043EH   A      4180 4643 4745 8230#
CLEAR. . . . . . .  C ADDR   2914H   R   SEG=MAIN   6510 6514# 6544
CLEAR4 . . . . . .  C ADDR   235DH   R   SEG=MAIN   819 1410 1412 1558 1579 1619 1621 2348 2350 3029 3031 4767 5562#
CLEARN . . . . . .  C ADDR   2365H   R   SEG=MAIN   3712 3758 3853 4232 4349 4460 4507 5571#
CLMASSIX . . . . .  C ADDR   277AH   R   SEG=MAIN   547 1408 1617 2113 2234 2346 3027 3207 6122#
CLMASV . . . . . .  C ADDR   07DEH   R   SEG=MAIN   1403 1405#
CLMAX. . . . . . .  C ADDR   277FH   R   SEG=MAIN   6124# 6127
CLR11. . . . . . .  C ADDR   2915H   R   SEG=MAIN   6516# 6518
CLRDEC . . . . . .  C ADDR   290EH   R   SEG=MAIN   6508#
CLRNUM . . . . . .  C ADDR   2912H   R   SEG=MAIN   6511# 6625
CLRVICH. . . . . .  C ADDR   133EH   R   SEG=MAIN   3132# 3149
CNTR . . . . . . .  N NUMB   0006H   A      7421#
CO02S. . . . . . .  C ADDR   22C6H   R   SEG=MAIN   5499# 5503
CO05S. . . . . . .  C ADDR   22D3H   R   SEG=MAIN   5508# 5512
CO1S . . . . . . .  C ADDR   22BDH   R   SEG=MAIN   5493# 5493
CO2S . . . . . . .  C ADDR   22B9H   R   SEG=MAIN   5491# 5495
COMPA1 . . . . . .  C ADDR   088AH   R   SEG=MAIN   1495# 1504
COMPA2 . . . . . .  C ADDR   08C0H   R   SEG=MAIN   1518# 1527
COND . . . . . . .  C ADDR   27EEH   R   SEG=MAIN   6218#
COPY1. . . . . . .  C ADDR   049FH   A      8312# 8317
COPYPP . . . . . .  C ADDR   0499H   A      4167 4622 4723 8309#
COPY_HL. . . . . .  D ADDR   00D7H   A      409# 3878 4014 4760 4776 4791 4929 4944 4959 5080 5095 5110
COUNT. . . . . . .  C ADDR   229BH   R   SEG=MAIN   5465# 5465
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   22A2H   R   SEG=MAIN   5471# 5471
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 485
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1648 1669
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1651 1673
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 486
DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1909
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1906
DCOA . . . . . . .  C ADDR   27F3H   R   SEG=MAIN   6222# 6224
DCOB . . . . . . .  C ADDR   27FAH   R   SEG=MAIN   6226# 6244
DCOC . . . . . . .  C ADDR   2805H   R   SEG=MAIN   6236# 6241
DCOD . . . . . . .  C ADDR   2812H   R   SEG=MAIN   6243 6246#
DDOUTF . . . . . .  C ADDR   15E5H   R   SEG=MAIN   3333 3389 3512 3520# 3605
DDOUTFR. . . . . .  C ADDR   14C2H   R   SEG=MAIN   3333# 3339
DEC30. . . . . . .  C ADDR   2967H   R   SEG=MAIN   6635# 6660
DEC31. . . . . . .  C ADDR   296CH   R   SEG=MAIN   6641# 6648
DEC32. . . . . . .  C ADDR   297CH   R   SEG=MAIN   6653# 6657
DECBIN . . . . . .  C ADDR   295AH   R   SEG=MAIN   3716 3762 3857 4370 4465 4511 6614#
DECSIZE. . . . . .  N NUMB   000AH   A      6489# 6509 6543 6570 6583 6586 6640
DECT2. . . . . . .  C ADDR   2985H   R   SEG=MAIN   6631 6663#
DEDPTR . . . . . .  C ADDR   2BDAH   R   SEG=MAIN   7148 7152 7156 7162#
DENORM . . . . . .  C ADDR   0133H   A      7580# 7636
DGOTO7 . . . . . .  C ADDR   1777H   R   SEG=MAIN   3765# 3773
DIAP . . . . . . .  D ADDR   00AEH   A      389# 575 1398 1600 1720 1948 2340 2380 3020 4277 4650 5352 5373 5635 5650
                                           5801 5863
DIINC. . . . . . .  C ADDR   0E0BH   R   SEG=MAIN   2343 2346#
DIKDN. . . . . . .  C ADDR   2499H   R   SEG=MAIN   5803 5823#
DIKDW. . . . . . .  C ADDR   23B1H   R   SEG=MAIN   5639 5660#
DIKM . . . . . . .  C ADDR   23C7H   R   SEG=MAIN   5671#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   137

DIPAR. . . . . . .  C ADDR   23C5H   R   SEG=MAIN   5670#
DIV1 . . . . . . .  C ADDR   02DDH   A      7917# 7976
DIV2 . . . . . . .  C ADDR   0320H   A      7935 7939 7943 7947 7962#
DIV3 . . . . . . .  C ADDR   030DH   A      7936 7940 7944 7948#
DIV9 . . . . . . .  C ADDR   0336H   A      7906 7908 7982#
DIVIDE . . . . . .  C ADDR   2A45H   R   SEG=MAIN   6150 6849#
DONE . . . . . . .  C ADDR   29B4H   R   SEG=MAIN   6679 6690#
DONE1. . . . . . .  C ADDR   29B2H   R   SEG=MAIN   6682 6685 6688#
DOSH . . . . . . .  C ADDR   2ACEH   R   SEG=MAIN   6924 6940#
DOSUB. . . . . . .  C ADDR   2ABCH   R   SEG=MAIN   6908 6912 6916 6920 6921 6925#
DPH. . . . . . . .  D ADDR   0083H   A      19# 553 599 607 614 621 2262 2856 2910 3378 3380 3883 3885 4019 4024 4529
                                           4761 4773 4778 4787 4789 4792 4803 4890 4892 4930 4941 4946 4955 4957 4960
                                           4971 5081 5092 5097 5106 5108 5111 5122 6082 6090 6357 6365 6397 6696 6732
                                           6767 6770 6782 6805 7167 7169 8243 8263 8309
DPL. . . . . . . .  D ADDR   0082H   A      18# 602 610 617 624 2261 2857 2909 3375 3377 3879 3881 4016 4027 4530
                                           4764 4771 4781 4784 4786 4795 4799 4887 4889 4933 4939 4949 4952 4954 4963
                                           4967 5084 5090 5100 5103 5105 5114 5118 6083 6089 6354 6368 6401 6712 6748
                                           6769 6783 6786 6820 7164 7166 8244 8264 8310
DVIG0. . . . . . .  C ADDR   0ABDH   R   SEG=MAIN   1855# 1857
DVIG1. . . . . . .  C ADDR   0AB2H   R   SEG=MAIN   1846# 1848
DVIG2. . . . . . .  C ADDR   0AA7H   R   SEG=MAIN   1837# 1839
DVIG3. . . . . . .  C ADDR   0A9BH   R   SEG=MAIN   1828# 1830
DVIG4. . . . . . .  C ADDR   0AC9H   R   SEG=MAIN   1866# 1868
DVIG6. . . . . . .  C ADDR   0AEBH   R   SEG=MAIN   1894# 1896
DVM. . . . . . . .  C ADDR   0AE9H   R   SEG=MAIN   1882 1893#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 483
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 533 699 2248 2896 5217 5229
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDKALIB . . . . .  C ADDR   1D7CH   R   SEG=MAIN   3009 4596#
ENDSDV . . . . . .  C ADDR   0AEFH   R   SEG=MAIN   1888 1897#
ENDSUM . . . . . .  C ADDR   059CH   R   SEG=MAIN   903 956 1059 1084#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU0 . . . . . . .  C ADDR   08BBH   R   SEG=MAIN   1498 1514#
EQU00. . . . . . .  C ADDR   08D9H   R   SEG=MAIN   1516 1521 1530#
EQU1L. . . . . . .  C ADDR   10F1H   R   SEG=MAIN   2784 2788#
EQU2L. . . . . . .  C ADDR   164BH   R   SEG=MAIN   3591 3596#
ERRA0. . . . . . .  C ADDR   1CABH   R   SEG=MAIN   4473 4485#
ERRA01 . . . . . .  C ADDR   07F4H   R   SEG=MAIN   1417# 1462
ERROR. . . . . . .  C ADDR   25A0H   R   SEG=MAIN   1424 4300 4488 5195 5209 6018#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      7423#
EXP2 . . . . . . .  N NUMB   0001H   A      7425# 7602 7623
EXTCLE . . . . . .  C ADDR   01BBH   R   SEG=MAIN   550# 554
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDEXT. . . . . .  C ADDR   23AAH   R   SEG=MAIN   4624 5649#
FINDKOEF . . . . .  C ADDR   239BH   R   SEG=MAIN   1336 5634#
FINDMEM. . . . . .  C ADDR   1055H   R   SEG=MAIN   2624 2694#
FINDR. . . . . . .  C ADDR   24F2H   R   SEG=MAIN   1584 4267 5863#
FINIS. . . . . . .  C ADDR   2AF9H   R   SEG=MAIN   6868 6969#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      2009 4815 4827 7628# 7717
FLCMP. . . . . . .  C ADDR   01D6H   A      1260 1358 1396 1445 1449 1461 1497 1520 1916 4472 4986 5002 5137 5152
                                           7722#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   138

FLDIV. . . . . . .  C ADDR   02B7H   A      1283 1304 1342 1470 1489 1503 2025 2175 2213 4608 4693 4711 4842 4845
                                           5015 7892#
FLMUL. . . . . . .  C ADDR   0203H   A      1149 1249 1301 1347 1465 1526 1996 2018 2028 2034 2038 3867 4375 4612
                                           4697 4715 7762#
FLOUT. . . . . . .  C ADDR   01E1H   A      7729 7732#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 8231 8237 8288 8293
FLSUB. . . . . . .  C ADDR   01D1H   A      1241 1921 2055 2123 2171 2209 3864 5165 7715#
FND. . . . . . . .  C ADDR   01F8H   A      7738 7741 7744 7747 7750#
FO1M . . . . . . .  C ADDR   27B1H   R   SEG=MAIN   6156 6160#
FO2M . . . . . . .  C ADDR   27BAH   R   SEG=MAIN   6163 6165#
FORM4. . . . . . .  C ADDR   27BBH   R   SEG=MAIN   6158 6164 6168#
FT1IZM . . . . . .  C ADDR   0EF5H   R   SEG=MAIN   2497#
FTOL . . . . . . .  C ADDR   0343H   A      1194 1349 1473 3868 4613 4716 4846 5016 5945 7998#
FTOL1. . . . . . .  C ADDR   037CH   A      8011 8015 8039#
FTOL2. . . . . . .  C ADDR   039EH   A      8035 8072#
FTOL22 . . . . . .  C ADDR   03C4H   A      8075 8109#
FTOL23 . . . . . .  C ADDR   03A2H   A      8076# 8108
FTOL24 . . . . . .  C ADDR   03B5H   A      8078 8094#
FTOL25 . . . . . .  C ADDR   03C2H   A      8093 8108#
FTOL26 . . . . . .  C ADDR   03E4H   A      8124 8140#
FTOL3. . . . . . .  C ADDR   038AH   A      8038 8052#
FTOL33 . . . . . .  C ADDR   038EH   A      8056# 8070
FTOL4. . . . . . .  C ADDR   0371H   A      8017 8032#
FTOL9. . . . . . .  C ADDR   0381H   A      8045# 8055 8071 8139 8154
FULKALIB . . . . .  C ADDR   1DEBH   R   SEG=MAIN   4651 4666# 4754
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   491# 492
GO23NO . . . . . .  C ADDR   15AAH   R   SEG=MAIN   3390 3488#
GO31L. . . . . . .  C ADDR   10F7H   R   SEG=MAIN   2762 2793#
GO41L. . . . . . .  C ADDR   10FCH   R   SEG=MAIN   2793 2795#
GOA2 . . . . . . .  C ADDR   0794H   R   SEG=MAIN   1362 1364 1367# 1389
GOA3A2 . . . . . .  C ADDR   079EH   R   SEG=MAIN   1372#
GOCIKLE. . . . . .  C ADDR   0BEBH   R   SEG=MAIN   1939 2013 2042# 2049 2058
GOFULL . . . . . .  C ADDR   15DDH   R   SEG=MAIN   3494 3516#
GOGO7. . . . . . .  C ADDR   1CC9H   R   SEG=MAIN   4446 4451 4498#
GOKAA2 . . . . . .  C ADDR   07BCH   R   SEG=MAIN   1387#
GOKLB. . . . . . .  C ADDR   0DCEH   R   SEG=MAIN   2287 2309#
GOOFF1 . . . . . .  C ADDR   1531H   R   SEG=MAIN   3404# 3413
GOOFF2 . . . . . .  C ADDR   154FH   R   SEG=MAIN   3426# 3435
GOOFF3 . . . . . .  C ADDR   156DH   R   SEG=MAIN   3445# 3454
GOOFF4 . . . . . .  C ADDR   158BH   R   SEG=MAIN   3467# 3476
GOONIN . . . . . .  C ADDR   07AEH   R   SEG=MAIN   1380# 1415 1427 1607 1624
GOONIN1. . . . . .  C ADDR   0955H   R   SEG=MAIN   1603 1607#
GOONIND. . . . . .  C ADDR   09B2H   R   SEG=MAIN   1383 1674#
GOONOFF. . . . . .  C ADDR   14EAH   R   SEG=MAIN   3358# 3367
GOONT. . . . . . .  C ADDR   0B6BH   R   SEG=MAIN   1942 1975#
GOPAROL. . . . . .  C ADDR   1B2DH   R   SEG=MAIN   4109 4253 4261#
GOPAROM. . . . . .  C ADDR   1A17H   R   SEG=MAIN   4107# 4110
GOPART . . . . . .  C ADDR   032DH   R   SEG=MAIN   791 794#
GOSK19 . . . . . .  C ADDR   1026H   R   SEG=MAIN   2661 2668#
GOTO7. . . . . . .  C ADDR   11F5H   R   SEG=MAIN   2962# 3042 3049 3087 3136 3165 3177 3219 3223 3268 3284 3293 3299
                                           3304 3310 3325 3387 3541 3544 3558 3595 3598 3654 3667 3673 3699 3701 3742
                                           3765 3783 3838 4037 4045 4053 4214 4218 4297 4307 4341 4392 4394 4410 4422
                                           4483 4663 4674
GOTOKD . . . . . .  C ADDR   062FH   R   SEG=MAIN   1152 1176#
GOTOSTROB. . . . .  C ADDR   0B5DH   R   SEG=MAIN   1953 1956 1959 1962 1965#
GOUT6. . . . . . .  C ADDR   0D83H   R   SEG=MAIN   2277# 2305
GOVVLIST . . . . .  C ADDR   1817H   R   SEG=MAIN   3821 3843#
GOZNAK . . . . . .  C ADDR   02DFH   R   SEG=MAIN   688 734#
HNOR11 . . . . . .  C ADDR   1349H   R   SEG=MAIN   3098 3140#
HNOR12 . . . . . .  C ADDR   12F1H   R   SEG=MAIN   3088 3092#
HNOT1. . . . . . .  C ADDR   1392H   R   SEG=MAIN   3064 3186#
HNOT2. . . . . . .  C ADDR   12BFH   R   SEG=MAIN   3061#
HR12 . . . . . . .  C ADDR   12E7H   R   SEG=MAIN   3083 3088#
HVI1113. . . . . .  C ADDR   12E1H   R   SEG=MAIN   3086# 3091 3096
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 535 5175 8230 8238 8287 8297
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   139

IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   12BBH   R   SEG=MAIN   3056 3058#
IND. . . . . . . .  C ADDR   215AH   R   SEG=MAIN   637 645 690 718 1425 1508 1512 1816 2318 2322 2333 2992 3229 3245
                                           3741 3957 4009 4301 4489 4671 5191 5197 5211 5217# 6379
INDA3. . . . . . .  C ADDR   0978H   R   SEG=MAIN   1639#
INDOLL . . . . . .  C ADDR   094AH   R   SEG=MAIN   1598 1599 1603#
INIACP . . . . . .  C ADDR   240FH   R   SEG=MAIN   654 3205 5727#
INNOT1_2 . . . . .  C ADDR   16CEH   R   SEG=MAIN   3663 3669#
INNOT3 . . . . . .  C ADDR   16BFH   R   SEG=MAIN   3655 3660#
INNOT6 . . . . . .  C ADDR   16B3H   R   SEG=MAIN   3650 3655#
INTERVA. . . . . .  D ADDR   00CDH   A      404# 628 1975 3618 3718
INTMUL . . . . . .  C ADDR   0B8EH   R   SEG=MAIN   1990 1996#
INTMUL1. . . . . .  C ADDR   0B91H   R   SEG=MAIN   1997#
INTMUL2. . . . . .  C ADDR   0BA6H   R   SEG=MAIN   2010# 2019 2029 2035 2039
INTN . . . . . . .  C ADDR   1760H   R   SEG=MAIN   3756#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   137AH   R   SEG=MAIN   3167#
IZMAN. . . . . . .  C ADDR   0E6CH   R   SEG=MAIN   2246 2401#
IZMFUN . . . . . .  C ADDR   0E7BH   R   SEG=MAIN   2334 2345 2353 2405 2408#
IZMPAT . . . . . .  C ADDR   0E7FH   R   SEG=MAIN   2303 2319 2323 2377 2412#
IZMT2. . . . . . .  C ADDR   0E8EH   R   SEG=MAIN   2428 2433#
IZMT3. . . . . . .  C ADDR   0E99H   R   SEG=MAIN   2433 2439#
JFINIS . . . . . .  C ADDR   2A60H   R   SEG=MAIN   6860 6868#
KD . . . . . . . .  C ADDR   2326H   R   SEG=MAIN   5537#
KEYB1. . . . . . .  C ADDR   0D52H   R   SEG=MAIN   283 2247#
KEYB2. . . . . . .  C ADDR   1189H   R   SEG=MAIN   286 2895#
KFULL. . . . . . .  C ADDR   15B4H   R   SEG=MAIN   3326 3493#
KFULLR . . . . . .  C ADDR   14B1H   R   SEG=MAIN   3321 3326#
KGO23. . . . . . .  C ADDR   151EH   R   SEG=MAIN   3320 3393#
KLBOFF . . . . . .  C ADDR   1245H   R   SEG=MAIN   2985 3003#
KLEV1. . . . . . .  C ADDR   148BH   R   SEG=MAIN   3276 3311#
KLEV2. . . . . . .  C ADDR   1490H   R   SEG=MAIN   3311 3313#
KLEV21 . . . . . .  C ADDR   14B4H   R   SEG=MAIN   3318 3327#
KLEV22 . . . . . .  C ADDR   149AH   R   SEG=MAIN   3306 3315 3318#
KLEV23 . . . . . .  C ADDR   14C5H   R   SEG=MAIN   3327 3335#
KLEV3. . . . . . .  C ADDR   1495H   R   SEG=MAIN   3313 3315#
KLMAS. . . . . . .  C ADDR   03DAH   R   SEG=MAIN   823 890#
KNAVP. . . . . . .  C ADDR   1254H   R   SEG=MAIN   2942 3011#
KNIZM. . . . . . .  B ADDR   0023H.0 A      354# 1362 1599 1784 2379 2401 2402 2406
KNIZMON. . . . . .  C ADDR   0E76H   R   SEG=MAIN   2401 2406#
KNKMP. . . . . . .  C ADDR   117AH   R   SEG=MAIN   2890# 2936
KNLEFT . . . . . .  C ADDR   1264H   R   SEG=MAIN   2894 3018#
KNMEM. . . . . . .  C ADDR   13EFH   R   SEG=MAIN   2889 3239#
KNMENU . . . . . .  C ADDR   1217H   R   SEG=MAIN   2948 2982#
KNNUL. . . . . . .  C ADDR   1285H   R   SEG=MAIN   2893 3036#
KNOPT. . . . . . .  C ADDR   0EA1H   R   SEG=MAIN   2245 2447#
KNRAZR . . . . . .  C ADDR   0EB6H   R   SEG=MAIN   2244 2460#
KNRIGHT. . . . . .  C ADDR   0E01H   R   SEG=MAIN   2293 2338#
KNVICH . . . . . .  C ADDR   0E22H   R   SEG=MAIN   2302 2356#
KOEFKD . . . . . .  D ADDR   00A0H   A      384# 593 4615 4625 4717 4725
KOEFKM . . . . . .  D ADDR   0094H   A      378# 591 1147 1247 2217
KOEFKP . . . . . .  D ADDR   0090H   A      377# 589 1144 1242 2179
KOMUL. . . . . . .  C ADDR   0758H   R   SEG=MAIN   1335 1339#
KOMULPZ. . . . . .  C ADDR   0752H   R   SEG=MAIN   1332 1336#
KONSTA . . . . . .  D ADDR   00BCH   A      397# 1457 4468 5943
KON_B. . . . . . .  C ADDR   0F80H   R   SEG=MAIN   2553 2572#
KOR0US . . . . . .  C ADDR   2253H   R   SEG=MAIN   2083 5406#
KOR0_AN. . . . . .  D ADDR   0084H   A      374# 1239 2095 2169 2207
KORDEC1. . . . . .  C ADDR   0680H   R   SEG=MAIN   1222 1229#
KORDEC10 . . . . .  C ADDR   0660H   R   SEG=MAIN   1210#
KORNUL . . . . . .  C ADDR   0C25H   R   SEG=MAIN   1159 2075#
KVVOD0 . . . . . .  C ADDR   15D0H   R   SEG=MAIN   3286 3502 3511#
LABEL43. . . . . .  C ADDR   180EH   R   SEG=MAIN   3839# 3847
LABEL7 . . . . . .  C ADDR   18F7H   R   SEG=MAIN   3839 3962# 3974
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   140

LABELA . . . . . .  C ADDR   02A6H   R   SEG=MAIN   693# 722 2046
LABELB . . . . . .  C ADDR   0A94H   R   SEG=MAIN   1202 1627 1821# 2063 2067 2069
LABELC . . . . . .  C ADDR   0EB6H   R   SEG=MAIN   2461#
LABELE . . . . . .  C ADDR   0E7FH   R   SEG=MAIN   2410 2426# 2466 2469 2473 2477 2485
LABELF . . . . . .  C ADDR   0EE1H   R   SEG=MAIN   2243 2486#
LABELH . . . . . .  C ADDR   12A7H   R   SEG=MAIN   2892 3051#
LABELI . . . . . .  C ADDR   1C25H   R   SEG=MAIN   3067 3125 3179 4405#
LABELI2. . . . . .  C ADDR   132EH   R   SEG=MAIN   3125# 3126
LABELK . . . . . .  C ADDR   142FH   R   SEG=MAIN   3066 3269#
LABELL . . . . . .  C ADDR   10B2H   R   SEG=MAIN   2623 2723 2731#
LABELL1. . . . . .  C ADDR   0FBDH   R   SEG=MAIN   2610# 2687 2800 2849
LABELN . . . . . .  C ADDR   1116H   R   SEG=MAIN   2688 2809#
LABELP . . . . . .  C ADDR   17E4H   R   SEG=MAIN   3769 3790 3821# 4055
LABELS . . . . . .  C ADDR   17A9H   R   SEG=MAIN   3498 3790#
LABELS1. . . . . .  C ADDR   1A78H   R   SEG=MAIN   4125 4155#
LABELS13 . . . . .  C ADDR   1BABH   R   SEG=MAIN   4196 4321#
LABELS3. . . . . .  C ADDR   1C38H   R   SEG=MAIN   4415#
LABELS4. . . . . .  C ADDR   1C13H   R   SEG=MAIN   4195 4396#
LABL2. . . . . . .  C ADDR   10D8H   R   SEG=MAIN   2765# 3330
LABM . . . . . . .  C ADDR   1654H   R   SEG=MAIN   3331 3601#
LADD . . . . . . .  C ADDR   2BA1H   R   SEG=MAIN   802 837 855 871 1904 7095#
LADDX. . . . . . .  C ADDR   2BB2H   R   SEG=MAIN   7119#
LBTOF. . . . . . .  C ADDR   042DH   A      8209#
LCMP . . . . . . .  C ADDR   299FH   R   SEG=MAIN   5323 6187 6675#
LDC_LONG . . . . .  C ADDR   29B5H   R   SEG=MAIN   588 1334 1902 2174 2212 3046 6695#
LDC_LTEMP. . . . .  C ADDR   29D7H   R   SEG=MAIN   811 1098 1103 1108 1112 1259 1303 1341 1357 1395 1444 1448 1460
                                           1464 1488 1496 1502 1519 1525 1642 1915 1920 1989 1994 2017 2024 2027 2033
                                           2037 2054 2122 3863 3866 3892 4374 4471 4611 4696 4714 4844 5014 5164 5337
                                           6350 6731#
LDX_LONG . . . . .  C ADDR   29FDH   R   SEG=MAIN   6766#
LDX_LTEMP. . . . .  C ADDR   2A23H   R   SEG=MAIN   6804#
LEFCUR . . . . . .  C ADDR   16DFH   R   SEG=MAIN   3679# 3751 3767
LEFKL. . . . . . .  C ADDR   126EH   R   SEG=MAIN   3018 3024#
LEFMEM11 . . . . .  C ADDR   143DH   R   SEG=MAIN   3277# 3312 3314 3316
LEFT21 . . . . . .  C ADDR   15FEH   R   SEG=MAIN   3537 3542#
LEFT_S . . . . . .  C ADDR   1A75H   R   SEG=MAIN   4154# 4157
LEFT_SK. . . . . .  C ADDR   1B8CH   R   SEG=MAIN   4154 4309#
LEV220 . . . . . .  C ADDR   149DH   R   SEG=MAIN   3319# 3328
LEV2GO . . . . . .  C ADDR   113CH   R   SEG=MAIN   2808 2845#
LEVEL. . . . . . .  D ADDR   00B0H   A      391# 2325 2695 2733 3246 3256 3275 3513 5893
LI21 . . . . . . .  C ADDR   1384H   R   SEG=MAIN   3174 3176#
LI42_43. . . . . .  C ADDR   187DH   R   SEG=MAIN   3889# 4029
LIST_43. . . . . .  C ADDR   1901H   R   SEG=MAIN   3841 3967#
LLDI2. . . . . . .  C ADDR   0E65H   R   SEG=MAIN   2392 2396#
LLDI23 . . . . . .  C ADDR   0E59H   R   SEG=MAIN   2384 2389#
LLDI3. . . . . . .  C ADDR   0E60H   R   SEG=MAIN   2391 2393#
LLEV2. . . . . . .  C ADDR   1101H   R   SEG=MAIN   2764 2798#
LLMUL. . . . . . .  C ADDR   2B0AH   R   SEG=MAIN   6989#
LLSUB. . . . . . .  C ADDR   2B8FH   R   SEG=MAIN   7071#
LLTOF. . . . . . .  C ADDR   0432H   A      8215#
LMUL . . . . . . .  C ADDR   2B0AH   R   SEG=MAIN   6145 6351 6991#
LOA3_X . . . . . .  C ADDR   28EAH   R   SEG=MAIN   1945 6415#
LOAB12 . . . . . .  C ADDR   245EH   R   SEG=MAIN   3203 5768#
LOAD . . . . . . .  D ADDR   00B7H   A      395# 2450 2491 3054 3199 5429
LOADB. . . . . . .  C ADDR   13A5H   R   SEG=MAIN   3194 3197# 3230 3236
LOADB2 . . . . . .  C ADDR   13D1H   R   SEG=MAIN   3217 3221#
LOADCLE. . . . . .  C ADDR   145BH   R   SEG=MAIN   3291# 3505
LOADKD . . . . . .  C ADDR   247BH   R   SEG=MAIN   5801#
LOADR2 . . . . . .  C ADDR   246DH   R   SEG=MAIN   3763 3858 4371 4466 4512 5784#
LOADT. . . . . . .  C ADDR   226EH   R   SEG=MAIN   2452 2497 3060 5429#
LOADUS . . . . . .  C ADDR   220DH   R   SEG=MAIN   655 1406 1614 2352 2407 3000 3004 3033 3206 4753 5350#
LOAHL_R2 . . . . .  C ADDR   1F61H   R   SEG=MAIN   4810 4822 4873# 4982 4998 5133 5148
LOBLOK . . . . . .  C ADDR   1609H   R   SEG=MAIN   3491 3549# 3568
LOCLE. . . . . . .  C ADDR   1456H   R   SEG=MAIN   3280 3289#
LOD1 . . . . . . .  C ADDR   227DH   R   SEG=MAIN   5437# 5442
LODT . . . . . . .  C ADDR   228CH   R   SEG=MAIN   5450# 5455
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   141

LOIZMK . . . . . .  C ADDR   12F4H   R   SEG=MAIN   3093# 3130
LOKAME1. . . . . .  C ADDR   19CAH   R   SEG=MAIN   4069#
LOLEVT . . . . . .  C ADDR   2270H   R   SEG=MAIN   2331 5430#
LOLIST . . . . . .  C ADDR   144AH   R   SEG=MAIN   3282#
LOME1. . . . . . .  C ADDR   1D30H   R   SEG=MAIN   4563# 4567 4570 4573 4576 4580 4583 4586 4589 4593
LOMENU . . . . . .  C ADDR   1D28H   R   SEG=MAIN   2638 2651 4069 4112 4135 4560#
LOOP . . . . . . .  C ADDR   21C9H   R   SEG=MAIN   5286# 5287
LOOPS. . . . . . .  C ADDR   2A63H   R   SEG=MAIN   6870# 6903
LOSPUS . . . . . .  C ADDR   2247H   R   SEG=MAIN   2084 5389#
LOSTAT . . . . . .  C ADDR   1472H   R   SEG=MAIN   3295 3301#
LOTEXT . . . . . .  C ADDR   2288H   R   SEG=MAIN   1507 1511 1605 2370 2528 2536 2544 2663 2669 2703 2712 2720 2729
                                           2737 2990 3086 3156 3241 3283 3292 3298 3303 3309 3324 3517 3550 3562 3617
                                           3739 3807 3831 3998 4034 4042 4050 4064 4086 4092 4131 4264 4311 4316 4479
                                           4563 4670 5447# 6019
LOTP . . . . . . .  C ADDR   24D1H   R   SEG=MAIN   5842# 5852 5855
LOTPUS . . . . . .  C ADDR   24C9H   R   SEG=MAIN   4143 5384 5839#
LOU. . . . . . . .  C ADDR   0E6BH   R   SEG=MAIN   2379 2395 2399#
LOUIZM . . . . . .  C ADDR   0E48H   R   SEG=MAIN   2379# 2404 5381
LOUTF. . . . . . .  C ADDR   10F4H   R   SEG=MAIN   2790# 2799 2806
LOVICH . . . . . .  C ADDR   12EAH   R   SEG=MAIN   3089# 3123 3144 4525
LOWR . . . . . . .  C ADDR   1464H   R   SEG=MAIN   3289 3295#
LOWR1. . . . . . .  C ADDR   1469H   R   SEG=MAIN   3297# 3509
LSUB . . . . . . .  C ADDR   2B8FH   R   SEG=MAIN   1199 1375 5338 7072#
LTEMP. . . . . . .  N NUMB   0008H   A      1115 1117 1118 1119 5674 5675 5676 5677 6197 6200 6203 6206 6249 6250
                                           6251 6252 6487# 6861 6862 6863 6864 6873 6877 6881 6885 6888 6889 6890
                                           6891 6892 6893 6894 6895 6896 6897 6898 6899 6902 6905 6910 6914 6918 6928
                                           6931 6934 6937 6953 6956 6957 6959 6960 6962 6963 6965 6970 6971 6972 6973
                                           6993 6998 7006 7014 7019 7030 7038 7044 7052 7058 7426 7427 7466 7471 7473
                                           7482 7483 7484 7485 7716 7724 7737 7740 7743 7746 8326 8329 8332 8335
LWR. . . . . . . .  C ADDR   278CH   R   SEG=MAIN   6136# 6140
LWRX . . . . . . .  C ADDR   2750H   R   SEG=MAIN   6081# 6093
LWTOF. . . . . . .  C ADDR   042FH   A      8211#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   27A7H   R   SEG=MAIN   1696 3895 4847 5018 6144 6149 6154# 6186
MAIN . . . . . . .  C SEG    2BECH       REL=UNIT   237 294# 455
MANT1. . . . . . .  N NUMB   0002H   A      7424# 7451 7500 7501
MANT2. . . . . . .  N NUMB   0008H   A      7426# 7477 7478 7609 7611 7612 7614 7615 7617 7618 7620 7659 7660 7662
                                           7663 7665 7666 7668 7669 7673 7675 7678 7681 7779 7781 7782 7784 7785 7787
                                           7788 7790 7841 7843 7844 7846 7847 7849 7850 7852 7934 7938 7942 7946 7950
                                           7953 7956 7959
MARK0_8. . . . . .  C ADDR   0F87H   R   SEG=MAIN   2555 2573 2575#
MARKER . . . . . .  D ADDR   00B2H   A      393# 566 2269 2515 2554 2564 2572 2582 2588 2772 2780 2816 2823 2835 2916
                                           3134 3151 3172 3265 3384 3484 3525 3533 3554 3580 3587 3645 3685 3692 3732
                                           3775 3833 3849 3972 4113 4201 4208 4292 4305 4328 4335 4382 4415 4434 4441
                                           4475 4485 4496 4521 5870 5896 5922 5933 5991
MARLE. . . . . . .  C ADDR   2545H   R   SEG=MAIN   3700 5919#
MARRI. . . . . . .  C ADDR   2552H   R   SEG=MAIN   2843 5932#
MAS10. . . . . . .  C ADDR   03F9H   R   SEG=MAIN   892 905#
MAS20. . . . . . .  C ADDR   0479H   R   SEG=MAIN   905 960#
MAS4 . . . . . . .  C ADDR   056DH   R   SEG=MAIN   958 1061#
MAS5DIV. . . . . .  C ADDR   05E1H   R   SEG=MAIN   1099 1104 1109 1113 1121#
MASFULL. . . . . .  C ADDR   05A8H   R   SEG=MAIN   1088 1092#
MASS0. . . . . . .  X ADDR   0100H   A      417 418# 893 898 927 935 1009 1017 1066 1073 6123
MASS1. . . . . . .  X ADDR   0104H   A      419# 901 924 938 1006 1020 1064 1076
MASS10 . . . . . .  X ADDR   0128H   A      428# 982 1039
MASS11 . . . . . .  X ADDR   012CH   A      429# 979 1041
MASS12 . . . . . .  X ADDR   0130H   A      430# 976 1043
MASS13 . . . . . .  X ADDR   0134H   A      431# 973 1045
MASS14 . . . . . .  X ADDR   0138H   A      432# 970 1047
MASS15 . . . . . .  X ADDR   013CH   A      433# 967 1049
MASS16 . . . . . .  X ADDR   0140H   A      434# 965 1051
MASS17 . . . . . .  X ADDR   0144H   A      435# 963 1053
MASS18 . . . . . .  X ADDR   0148H   A      436# 961 1055
MASS19 . . . . . .  X ADDR   014CH   A      437# 1057
MASS2. . . . . . .  X ADDR   0108H   A      420# 921 940 1003 1022 1062 1078
MASS3. . . . . . .  X ADDR   010CH   A      421# 918 942 1000 1024 1080
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   142

MASS4. . . . . . .  X ADDR   0110H   A      422# 915 944 997 1026
MASS5. . . . . . .  X ADDR   0114H   A      423# 912 946 994 1028
MASS6. . . . . . .  X ADDR   0118H   A      424# 910 948 992 1030
MASS7. . . . . . .  X ADDR   011CH   A      425# 908 950 990 1032
MASS8. . . . . . .  X ADDR   0120H   A      426# 906 952 988 1034
MASS9. . . . . . .  X ADDR   0124H   A      427# 954 985 1036
MASX5. . . . . . .  C ADDR   05D7H   R   SEG=MAIN   1090 1115#
MAXG . . . . . . .  C ADDR   2088H   R   SEG=MAIN   5089# 5143
MAXVIX . . . . . .  C ADDR   20F2H   R   SEG=MAIN   5153 5158#
ME11_15DE. . . . .  C ADDR   17A0H   R   SEG=MAIN   3785# 3804
ME11_15DEC . . . .  C ADDR   19C9H   R   SEG=MAIN   3785 4068#
ME21_22. . . . . .  C ADDR   10BCH   R   SEG=MAIN   2737# 2746
ME21_23. . . . . .  C ADDR   1A33H   R   SEG=MAIN   3818 4121#
ME21_23DEC . . . .  C ADDR   1A4FH   R   SEG=MAIN   4128 4133#
MEAVP. . . . . . .  C ADDR   125FH   R   SEG=MAIN   3012 3015#
MECLE. . . . . . .  C ADDR   01A8H   R   SEG=MAIN   539# 541
MEFF . . . . . . .  C ADDR   01AFH   R   SEG=MAIN   543# 546
MEM10MS. . . . . .  C ADDR   02A1H   R   SEG=MAIN   690#
MEM12NO. . . . . .  C ADDR   15CBH   R   SEG=MAIN   3503 3507#
MENG . . . . . . .  C ADDR   1EADH   R   SEG=MAIN   4770# 4820
MENU12 . . . . . .  C ADDR   1D34H   R   SEG=MAIN   4561 4565#
MENU13 . . . . . .  C ADDR   1D3CH   R   SEG=MAIN   4565 4568#
MENU14 . . . . . .  C ADDR   1D44H   R   SEG=MAIN   4568 4571#
MENU15 . . . . . .  C ADDR   1D4CH   R   SEG=MAIN   4571 4574#
MENU21 . . . . . .  C ADDR   1D54H   R   SEG=MAIN   4574 4578#
MENU22 . . . . . .  C ADDR   1D5CH   R   SEG=MAIN   4578 4581#
MENU23 . . . . . .  C ADDR   1D64H   R   SEG=MAIN   4581 4584#
MENU31 . . . . . .  C ADDR   1D6CH   R   SEG=MAIN   4584 4587#
MENU41 . . . . . .  C ADDR   1D74H   R   SEG=MAIN   4587 4591#
MENUOFF. . . . . .  C ADDR   1239H   R   SEG=MAIN   2983 2996#
MENUON . . . . . .  C ADDR   17D6H   R   SEG=MAIN   3809#
MERR . . . . . . .  C ADDR   1214H   R   SEG=MAIN   2979# 2982
ME_14. . . . . . .  C ADDR   147DH   R   SEG=MAIN   3306#
ME_41. . . . . . .  C ADDR   1AF0H   R   SEG=MAIN   4155 4222#
ME_52. . . . . . .  C ADDR   1AC4H   R   SEG=MAIN   4198# 4222
ME_52V . . . . . .  C ADDR   1AE1H   R   SEG=MAIN   4212 4214#
MIDL . . . . . . .  C ADDR   2A96H   R   SEG=MAIN   6865 6900#
MIGN . . . . . . .  C ADDR   2582H   R   SEG=MAIN   5218 5991#
MIGNN. . . . . . .  C ADDR   258AH   R   SEG=MAIN   5993 5998#
MIN4_HL. . . . . .  C ADDR   1F6DH   R   SEG=MAIN   4886# 4900 4926 5051 5077
MING . . . . . . .  C ADDR   1FAFH   R   SEG=MAIN   4938# 4992
MINIVIX. . . . . .  C ADDR   2019H   R   SEG=MAIN   5003 5008# 5158
MLABL2 . . . . . .  C ADDR   1634H   R   SEG=MAIN   3518 3572# 3603 3842
MLABL2R. . . . . .  C ADDR   1814H   R   SEG=MAIN   3842# 3845
MMM. . . . . . . .  C ADDR   029CH   R   SEG=MAIN   686#
MO220. . . . . . .  C ADDR   093FH   R   SEG=MAIN   1214 1385 1598#
MO500I . . . . . .  C ADDR   08AFH   R   SEG=MAIN   1450 1510#
MO500R . . . . . .  C ADDR   08A3H   R   SEG=MAIN   1446 1506#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   104FH   R   SEG=MAIN   2689# 2700 2709 2717 2726
MOUTKMEM . . . . .  C ADDR   17A3H   R   SEG=MAIN   3786# 3794
MOVE28 . . . . . .  C ADDR   2814H   R   SEG=MAIN   1278 1296 1343 1452 2172 2210 4605 4688 4706 4812 4824 4839 4981
                                           4997 5132 5147 6249#
MOVE82 . . . . . .  C ADDR   23CDH   R   SEG=MAIN   5674#
MOVEA3 . . . . . .  C ADDR   09B2H   R   SEG=MAIN   1652 1677#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2556 2788 2828 3153 3490 3534 3542 3596 3648 3693 3836 4116 4211
                                           4294 4338 4416 4444 5926
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2552 2781 2785 2824 3154 3489 3538 3588 3592 3647 3697 3835 4115
                                           4295 4420 5935
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      7776# 7819
MUP11. . . . . . .  C ADDR   0257H   A      7823# 7868
MUP2 . . . . . . .  C ADDR   0297H   A      7853 7867#
MUP3 . . . . . . .  C ADDR   026CH   A      7822 7838#
MVV11. . . . . . .  C ADDR   1604H   R   SEG=MAIN   3514 3547#
MVV12. . . . . . .  C ADDR   161CH   R   SEG=MAIN   3547 3559#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   143

N12DELCH . . . . .  C ADDR   0D3FH   R   SEG=MAIN   2228 2236#
N4DELCH. . . . . .  C ADDR   0CEBH   R   SEG=MAIN   2152 2190#
N8DELCH. . . . . .  C ADDR   0D2DH   R   SEG=MAIN   2190 2228#
NBIMENU. . . . . .  C ADDR   1055H   R   SEG=MAIN   2693#
NBLOK. . . . . . .  D ADDR   0038H   A      311# 626 1950 3347 3551 3615 3829 3920 6341 6362 6393
NE05 . . . . . . .  C ADDR   0358H   A      8005 8007 8009 8012#
NELEM. . . . . . .  D ADDR   0037H   A      312# 627 3860 3977 3981
NEXIN. . . . . . .  C ADDR   2164H   R   SEG=MAIN   5221# 5228
NEXTMAX. . . . . .  C ADDR   20BDH   R   SEG=MAIN   5121 5129#
NEXTMEA. . . . . .  C ADDR   1EE2H   R   SEG=MAIN   4802 4810#
NEXTMIN. . . . . .  C ADDR   1FE4H   R   SEG=MAIN   4970 4978#
NMEM_MENU. . . . .  C ADDR   17A6H   R   SEG=MAIN   3788# 3792
NMINUS . . . . . .  C ADDR   069DH   R   SEG=MAIN   1244 1248#
NMINUS3. . . . . .  C ADDR   0601H   R   SEG=MAIN   1146 1148#
NNDELCH. . . . . .  C ADDR   0CABH   R   SEG=MAIN   2137 2152#
NNMEMB . . . . . .  C ADDR   1148H   R   SEG=MAIN   2691 2851#
NNNUL. . . . . . .  C ADDR   0A30H   R   SEG=MAIN   1759 1762#
NO . . . . . . . .  C ADDR   2A7EH   R   SEG=MAIN   6875 6879 6883 6887#
NO0KEY . . . . . .  C ADDR   02B3H   R   SEG=MAIN   696 698 702#
NO10MSV. . . . . .  C ADDR   1747H   R   SEG=MAIN   3737 3743#
NO11V6 . . . . . .  C ADDR   0F39H   R   SEG=MAIN   2523 2531#
NO12V6 . . . . . .  C ADDR   0F4CH   R   SEG=MAIN   2531 2539#
NO13V6 . . . . . .  C ADDR   0F5FH   R   SEG=MAIN   2539 2549#
NO21P7 . . . . . .  C ADDR   1CD0H   R   SEG=MAIN   4454 4503#
NO23RI . . . . . .  C ADDR   1006H   R   SEG=MAIN   2649 2653#
NO2MSV . . . . . .  C ADDR   1744H   R   SEG=MAIN   3742# 3743 3753
NO2PARN. . . . . .  C ADDR   099DH   R   SEG=MAIN   1654 1660#
NO31N. . . . . . .  C ADDR   16FEH   R   SEG=MAIN   3706#
NO31RI . . . . . .  C ADDR   1037H   R   SEG=MAIN   2655 2679#
NO3PARN. . . . . .  C ADDR   0993H   R   SEG=MAIN   1654# 1740
NO4DEL . . . . . .  C ADDR   0C58H   R   SEG=MAIN   2088 2106#
NO5DEL . . . . . .  C ADDR   0C77H   R   SEG=MAIN   2121# 2129
NO6DEL . . . . . .  C ADDR   0C85H   R   SEG=MAIN   2119 2127#
NOAVK. . . . . . .  C ADDR   066FH   R   SEG=MAIN   1170 1219#
NOAVP. . . . . . .  C ADDR   0794H   R   SEG=MAIN   1366# 1397 1400
NOBAVP . . . . . .  C ADDR   0A4CH   R   SEG=MAIN   1509 1513 1593 1778 1782#
NOBEF99. . . . . .  C ADDR   036AH   R   SEG=MAIN   808 824# 843 861 877
NOBIT. . . . . . .  C ADDR   0245H   A      7791 7805#
NOBITIZM . . . . .  C ADDR   0A55H   R   SEG=MAIN   1784 1787#
NOBL21 . . . . . .  C ADDR   10C5H   R   SEG=MAIN   2734 2742#
NOBL22 . . . . . .  C ADDR   10CFH   R   SEG=MAIN   2742 2762#
NOBUF. . . . . . .  C ADDR   0A8AH   R   SEG=MAIN   1814 1816#
NOBUF0 . . . . . .  C ADDR   0BFBH   R   SEG=MAIN   1940 2051#
NOCHI0 . . . . . .  C ADDR   0974H   R   SEG=MAIN   1386 1626#
NOCHIND. . . . . .  C ADDR   02D2H   R   SEG=MAIN   716 724#
NOCHN10. . . . . .  C ADDR   05C4H   R   SEG=MAIN   1101 1106#
NOCHN2 . . . . . .  C ADDR   05B9H   R   SEG=MAIN   1096 1101#
NOCHN20. . . . . .  C ADDR   05CFH   R   SEG=MAIN   1106 1111#
NODI2. . . . . . .  C ADDR   0958H   R   SEG=MAIN   1601 1609#
NODI6. . . . . . .  C ADDR   1270H   R   SEG=MAIN   3022 3026#
NODI8. . . . . . .  C ADDR   0A03H   R   SEG=MAIN   1723 1730#
NODI8K . . . . . .  C ADDR   1B60H   R   SEG=MAIN   4280 4285#
NODI8_43 . . . . .  C ADDR   18DAH   R   SEG=MAIN   3934 3940#
NODI9. . . . . . .  C ADDR   095DH   R   SEG=MAIN   1611 1614#
NODI9_43 . . . . .  C ADDR   18E5H   R   SEG=MAIN   3940 3948#
NODIS9 . . . . . .  C ADDR   0A16H   R   SEG=MAIN   1730 1742#
NODISK9. . . . . .  C ADDR   1B68H   R   SEG=MAIN   4284 4285 4292#
NOENDLI. . . . . .  C ADDR   28B6H   R   SEG=MAIN   6376 6380#
NOEQU1 . . . . . .  C ADDR   112DH   R   SEG=MAIN   2827 2831#
NOEQU2 . . . . . .  C ADDR   16F8H   R   SEG=MAIN   3696 3700#
NOFIZM . . . . . .  C ADDR   0F1BH   R   SEG=MAIN   2487 2519#
NOFT1. . . . . . .  C ADDR   0EF4H   R   SEG=MAIN   2492 2496#
NOFZ . . . . . . .  C ADDR   0BF6H   R   SEG=MAIN   2042 2046#
NOH37. . . . . . .  C ADDR   1309H   R   SEG=MAIN   3082 3106# 3117
NOHNOT1. . . . . .  C ADDR   13E4H   R   SEG=MAIN   3188 3231#
NOHNOT2. . . . . .  C ADDR   13D9H   R   SEG=MAIN   3224# 3231
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   144

NOKLB. . . . . . .  C ADDR   0A84H   R   SEG=MAIN   1812 1814#
NOKORR . . . . . .  C ADDR   0617H   R   SEG=MAIN   1157 1160#
NOLAH. . . . . . .  C ADDR   12CBH   R   SEG=MAIN   3051 3069#
NOLI_43. . . . . .  C ADDR   1955H   R   SEG=MAIN   3967 4012#
NOM31. . . . . . .  C ADDR   16D6H   R   SEG=MAIN   3600 3675#
NOM32. . . . . . .  C ADDR   174FH   R   SEG=MAIN   3675 3749#
NOM33. . . . . . .  C ADDR   177DH   R   SEG=MAIN   3749 3769#
NOMARL . . . . . .  C ADDR   1C4DH   R   SEG=MAIN   4418 4424 4428#
NOMAXI . . . . . .  C ADDR   20D5H   R   SEG=MAIN   5138 5141#
NOME11 . . . . . .  C ADDR   15BBH   R   SEG=MAIN   3500#
NOMEM11. . . . . .  C ADDR   1070H   R   SEG=MAIN   2696 2706#
NOMEM12. . . . . .  C ADDR   1086H   R   SEG=MAIN   2706 2714#
NOMEM13. . . . . .  C ADDR   109CH   R   SEG=MAIN   2714 2723#
NOMEMK . . . . . .  C ADDR   15B8H   R   SEG=MAIN   3254 3497#
NOMINI . . . . . .  C ADDR   1FFCH   R   SEG=MAIN   4987 4990#
NON1C. . . . . . .  C ADDR   0EC7H   R   SEG=MAIN   2467 2471#
NONULAVT . . . . .  C ADDR   0654H   R   SEG=MAIN   1165 1204#
NONULDEL . . . . .  C ADDR   0C3AH   R   SEG=MAIN   2076 2087#
NOP3_0 . . . . . .  C ADDR   0978H   R   SEG=MAIN   1632#
NOPART1. . . . . .  C ADDR   036EH   R   SEG=MAIN   797 831#
NOPART2. . . . . .  C ADDR   038EH   R   SEG=MAIN   831 850#
NOPART3. . . . . .  C ADDR   03AEH   R   SEG=MAIN   850 866#
NOPART4. . . . . .  C ADDR   03CEH   R   SEG=MAIN   866 883#
NOPLUS . . . . . .  C ADDR   0FAFH   R   SEG=MAIN   2600 2603#
NOPOIN7. . . . . .  C ADDR   1C64H   R   SEG=MAIN   4414 4449#
NOPOINT. . . . . .  C ADDR   1C30H   R   SEG=MAIN   4408 4412#
NOR11. . . . . . .  C ADDR   0FC3H   R   SEG=MAIN   2614#
NORDN. . . . . . .  C ADDR   00F6H   A      7512# 7545
NORDN1 . . . . . .  C ADDR   0107H   A      7514 7528#
NORIG2 . . . . . .  C ADDR   110AH   R   SEG=MAIN   2795 2803#
NORIM6 . . . . . .  C ADDR   1148H   R   SEG=MAIN   2855#
NORIME . . . . . .  C ADDR   0FECH   R   SEG=MAIN   2636 2640#
NORIME1. . . . . .  C ADDR   0FE6H   R   SEG=MAIN   2638# 2641 2654
NORM1. . . . . . .  C ADDR   00F0H   A      7507# 7704 7881 7983 8200
NORR11 . . . . . .  C ADDR   1321H   R   SEG=MAIN   3119#
NORR12 . . . . . .  C ADDR   1331H   R   SEG=MAIN   3119 3126# 3140
NORUP. . . . . . .  C ADDR   0119H   A      7511 7548#
NORUP1 . . . . . .  C ADDR   011EH   A      7553# 7571
NORUP2 . . . . . .  C ADDR   0132H   A      7555 7572#
NORVICH. . . . . .  C ADDR   0A8DH   R   SEG=MAIN   1739 1817#
NOSAV1 . . . . . .  C ADDR   0B4BH   R   SEG=MAIN   1951 1954#
NOSAV2 . . . . . .  C ADDR   0B52H   R   SEG=MAIN   1954 1957#
NOSAV3 . . . . . .  C ADDR   0B59H   R   SEG=MAIN   1957 1960#
NOSUB. . . . . . .  C ADDR   2AB9H   R   SEG=MAIN   6909 6913 6917 6922#
NOT1IN . . . . . .  C ADDR   0C10H   R   SEG=MAIN   1890 2061#
NOT1_7 . . . . . .  C ADDR   1204H   R   SEG=MAIN   2964 2971#
NOT2IN . . . . . .  C ADDR   0C18H   R   SEG=MAIN   2061 2065#
NOT2_7 . . . . . .  C ADDR   120FH   R   SEG=MAIN   2971 2976#
NOT3IN . . . . . .  C ADDR   0C20H   R   SEG=MAIN   2065 2068#
NOTAKT . . . . . .  C ADDR   0A5FH   R   SEG=MAIN   1788 1792#
NOTE21 . . . . . .  C ADDR   0714H   R   SEG=MAIN   1265 1307#
NOTE22 . . . . . .  C ADDR   072FH   R   SEG=MAIN   1307 1319#
NOTESTIZM. . . . .  C ADDR   0747H   R   SEG=MAIN   1228 1331#
NOTT1. . . . . . .  C ADDR   0B85H   R   SEG=MAIN   1987 1992#
NOTT2. . . . . . .  C ADDR   0BADH   R   SEG=MAIN   1992 2015#
NOTT3. . . . . . .  C ADDR   0BBBH   R   SEG=MAIN   2015 2022#
NOTT4. . . . . . .  C ADDR   0BD2H   R   SEG=MAIN   2022 2031#
NOTT5. . . . . . .  C ADDR   0BE0H   R   SEG=MAIN   2031 2036#
NOT_1. . . . . . .  C ADDR   0ECEH   R   SEG=MAIN   2471 2476#
NOT_10 . . . . . .  C ADDR   0ECEH   R   SEG=MAIN   2475#
NOVIR. . . . . . .  C ADDR   0FCEH   R   SEG=MAIN   2508 2625#
NOVIR1 . . . . . .  C ADDR   0F05H   R   SEG=MAIN   2508# 2519
NOZMEA . . . . . .  C ADDR   1F5DH   R   SEG=MAIN   4867 4869#
NOZMIN . . . . . .  C ADDR   2050H   R   SEG=MAIN   5038 5040#
NOZZBL . . . . . .  C ADDR   18CCH   R   SEG=MAIN   3923 3926 3929 3932#
NOZZMI . . . . . .  C ADDR   09F0H   R   SEG=MAIN   1718 1720#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   145

NOZZMI1. . . . . .  C ADDR   18BCH   R   SEG=MAIN   3921 3924#
NOZZMI2. . . . . .  C ADDR   18C3H   R   SEG=MAIN   3924 3927#
NOZZMI3. . . . . .  C ADDR   18CAH   R   SEG=MAIN   3927 3930#
NOZZMI43 . . . . .  C ADDR   18B3H   R   SEG=MAIN   3918 3920#
NSEC1. . . . . . .  C ADDR   0A39H   R   SEG=MAIN   1763 1766#
NSEC10 . . . . . .  C ADDR   0A42H   R   SEG=MAIN   1765 1768 1773#
NSEC11 . . . . . .  C ADDR   0A40H   R   SEG=MAIN   1766 1770#
NUERR. . . . . . .  D ADDR   0039H   A      310# 1423 4299 4487 5194 5208 6020
NULAVT . . . . . .  C ADDR   0C90H   R   SEG=MAIN   2135#
NUMSIZE. . . . . .  N NUMB   0004H   A      6490# 6512 6550 6557 6632 6652
OBOARD . . . . . .  C ADDR   29EFH   R   SEG=MAIN   6733 6747#
OBOARD1. . . . . .  C ADDR   2A37H   R   SEG=MAIN   6806 6819#
OK1. . . . . . . .  C ADDR   0186H   A      7638 7653#
OK2. . . . . . . .  C ADDR   01A0H   A      7655 7670#
OK3. . . . . . . .  C ADDR   01C4H   A      7687 7703#
ONBOAR1. . . . . .  C ADDR   2A15H   R   SEG=MAIN   6768 6785#
ONBOARD. . . . . .  C ADDR   29C9H   R   SEG=MAIN   6697 6711#
ONMEM11. . . . . .  C ADDR   1406H   R   SEG=MAIN   2995 3014 3016 3248# 3808 3814 4066 4070 4075 4090 4095 4118 4132
                                           4136 4147
ONMEM12. . . . . .  C ADDR   1A56H   R   SEG=MAIN   4137# 4140 4159
ONMEM13. . . . . .  C ADDR   1C10H   R   SEG=MAIN   4339 4394# 4398 4400
ONMIG. . . . . . .  C ADDR   2598H   R   SEG=MAIN   6002 6011#
ONVICH . . . . . .  C ADDR   0E40H   R   SEG=MAIN   2362 2374#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 494
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 487 491
OUT43. . . . . . .  C ADDR   18EEH   R   SEG=MAIN   3957#
OUT6 . . . . . . .  C ADDR   1148H   R   SEG=MAIN   2242 2309 2355 2432 2437 2442 2458 2494 2499 2506 2517 2639 2652
                                           2667 2673 2856#
OUT7 . . . . . . .  C ADDR   1CF9H   R   SEG=MAIN   2890 2891 2968 2975 2979 3001 3007 3057 3062 3113 3252 3332 3565
                                           3659 3788 3959 3966 4011 4105 4193 4314 4319 4389 4403 4498 4500 4528#
OUTA . . . . . . .  C ADDR   255FH   R   SEG=MAIN   3158 5943#
OUTA2. . . . . . .  C ADDR   2579H   R   SEG=MAIN   5954# 5959
OUTF . . . . . . .  C ADDR   0EFBH   R   SEG=MAIN   2502# 2525 2529 2533 2537 2541 2545 2570 2593 2602 2605 2612 2689
                                           2704 2713 2721 2730 2740 2787 2790 2830 2844 2847 3103 3104 4137
OUTFL. . . . . . .  C ADDR   0FC0H   R   SEG=MAIN   2608 2612#
OUTKMEM. . . . . .  C ADDR   1413H   R   SEG=MAIN   3256# 3274 3786
OUTMA. . . . . . .  C ADDR   0F99H   R   SEG=MAIN   2591 2593#
OUTMAX . . . . . .  C ADDR   20DAH   R   SEG=MAIN   5125 5144#
OUTMEA . . . . . .  C ADDR   1EFDH   R   SEG=MAIN   4806 4821#
OUTMENU. . . . . .  C ADDR   1A12H   R   SEG=MAIN   4104#
OUTMIN . . . . . .  C ADDR   2001H   R   SEG=MAIN   4974 4994#
OUTR . . . . . . .  C ADDR   0906H   R   SEG=MAIN   1539 1562#
OUTR5. . . . . . .  C ADDR   0922H   R   SEG=MAIN   1560 1581#
OUTSKO . . . . . .  C ADDR   1AB7H   R   SEG=MAIN   4189 4191#
OUTSKO1. . . . . .  C ADDR   1AB4H   R   SEG=MAIN   4187 4190#
OUTVICH. . . . . .  C ADDR   0F08H   R   SEG=MAIN   2509# 2521
OUTVIR . . . . . .  C ADDR   0DC7H   R   SEG=MAIN   2276 2305#
OUT_KALI . . . . .  C ADDR   1DF8H   R   SEG=MAIN   4672#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 6689
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 5221 5225
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 465
P1 . . . . . . . .  D ADDR   0090H   A      32# 658 659 5234 5236 5239 5242 5246 5248 5249 5301 5303 5305 5741 5748
                                           6279 6282 6284 6287
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 466
P2 . . . . . . . .  D ADDR   00A0H   A      47# 5267 5271 5280
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 467
P3 . . . . . . . .  D ADDR   00B0H   A      62# 476 2275 2277 2279 2280 2283 2284 2288 2289 2291 2292 2294 2295 2297
                                           2298 2300 2301 2481 2482 2488 2489 2520 2521 2524 2525 2532 2533 2540 2541
                                           2549 2550 2595 2596 2606 2607 2633 2634 2647 2648 2658 2659 2683 2684 2685
                                           2686 2698 2699 2707 2708 2715 2716 2724 2725 2763 2764 2798 2799 2807 2808
                                           2845 2846 2876 2923 2925 2927 2928 2931 2932 2934 2935 2937 2938 2940 2941
                                           2943 2944 2946 2947 3052 3055 3081 3082 3106 3107 3120 3121 3127 3128 3141
                                           3142 3186 3187 3273 3274 3277 3278 3319 3320 3336 3337 3338 3339 3393 3394
                                           3500 3501 3511 3512 3602 3603 3604 3605 3676 3677 3706 3707 3750 3751 3752
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   146

                                           3753 3770 3771 3772 3773 3791 3792 3793 3794 3801 3802 3844 3845 3846 3847
                                           3968 3969 4057 4058 4126 4127 4139 4140 4156 4157 4158 4159 4199 4200 4216
                                           4217 4223 4224 4225 4226 4397 4398 4399 4400 4406 4407 4412 4413 4449 4450
                                           4542 5266 5268 5270 5276 5277 5278 5281 5282
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2249 2875 2897 4541
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 469
P4 . . . . . . . .  D ADDR   0084H   A      20# 2078 2099 2138 2221 2386 2388 4658 5359 5362 5378 5380 5844
P5 . . . . . . . .  D ADDR   0085H   A      21# 572 581 2080 2101 2140 2143 2148 2183 2185 2223 2396 2398 4662 5367
                                           5370 5400 5403 5848
P6 . . . . . . . .  D ADDR   0086H   A      22# 1966 1968 1972 1974 2878 2880 2884 2886 4545 4547 4551 4553
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 470
PACK1. . . . . . .  C ADDR   00DEH   A      7490# 7705 7882 7984 8201
PARERR . . . . . .  C ADDR   1B75H   R   SEG=MAIN   4255 4257 4259 4299#
PARN . . . . . . .  D ADDR   00AFH   A      390# 578 1753 2462 3214
PAROL. . . . . . .  D ADDR   00A8H   A      386#
PART . . . . . . .  D ADDR   009AH   A      380# 573 795 1135 1177 1204 1219 1762 1818 1986 2118 2357 2426 2463 2962
                                           3197 3213 3649 3736 5371 5768
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215 519
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132# 518
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116# 517
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101# 516
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 463
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 464 515
PCON . . . . . . .  D ADDR   0087H   A      23# 510
POIN3. . . . . . .  C ADDR   1C63H   R   SEG=MAIN   4447# 4501
POINA. . . . . . .  C ADDR   1CCBH   R   SEG=MAIN   4445 4500#
POINA1 . . . . . .  C ADDR   1C48H   R   SEG=MAIN   4417 4424#
POINA2 . . . . . .  C ADDR   1C42H   R   SEG=MAIN   4420# 4425
POZB . . . . . . .  C ADDR   1CEEH   R   SEG=MAIN   4514 4518#
PROD . . . . . . .  N NUMB   000CH   A      7427# 7771 7772 7773 7774 7794 7795 7796 7798 7799 7801 7802 7804 7826
                                           7828 7829 7831 7832 7834 7835 7837 7856 7857 7858 7860 7861 7863 7864 7866
                                           7877 7878 7879 7880 7901 7902 7903 7904 7920 7922 7923 7925 7926 7928 7929
                                           7931 7961 7978 7979 7980 7981
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 8232 8236 8289 8292
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 2252 2866 2900 4539 6188 6190 7162
                                           7170
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0DD1H   R   SEG=MAIN   2299 2311#
QUES . . . . . . .  C ADDR   14BFH   R   SEG=MAIN   3332# 3337
QU_AVP . . . . . .  C ADDR   0791H   R   SEG=MAIN   1363 1365#
R10. . . . . . . .  N NUMB   000AH   A      450# 1166 1418 1455 1467 2005 4258 5816 8255
R11. . . . . . . .  N NUMB   000BH   A      451# 1167 1417 1456 1466 2008 5820 8259
R8 . . . . . . . .  N NUMB   0008H   A      448# 524 1420 1453 1469 1999 4083 4254 5321 5808 8247
R9 . . . . . . . .  N NUMB   0009H   A      449# 1419 1454 1468 2002 4256 5322 5812 8251
RAFTERK. . . . . .  C ADDR   062DH   R   SEG=MAIN   1174# 1180
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   147

RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RDDOUTF. . . . . .  C ADDR   1518H   R   SEG=MAIN   3389# 3394
RE1. . . . . . . .  C ADDR   21D2H   R   SEG=MAIN   5301# 5307
RE11_7 . . . . . .  C ADDR   06D5H   R   SEG=MAIN   1276# 1318 1329
RE4BYTE. . . . . .  C ADDR   0454H   A      523 4082 4252 8243#
REA3_X . . . . . .  C ADDR   28FCH   R   SEG=MAIN   3890 6432#
REACP. . . . . . .  D ADDR   0077H   A      304# 673 675 677 679 736 752 760 768 777 784 799 834 852 868 884 2157
                                           2159 2161 2163 2195 2197 2199 2201
READ . . . . . . .  C ADDR   21D0H   R   SEG=MAIN   672 674 676 5300#
READYACP . . . . .  C ADDR   0325H   R   SEG=MAIN   778 788#
READ_X2. . . . . .  C ADDR   21B8H   R   SEG=MAIN   5275# 5286
REBYTE . . . . . .  C ADDR   0275H   R   SEG=MAIN   657# 691 713 825 2104 2126 2130 2150 2188 2226 2235 2237
REBYTE2. . . . . .  C ADDR   046CH   A      1268 1276 1294 1310 1321 1337 4678 4686 8263#
REBYTER. . . . . .  C ADDR   0C8AH   R   SEG=MAIN   2115 2130# 2134
REF0CN . . . . . .  D ADDR   00D1H   A      92# 471
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RENDKALIB. . . . .  C ADDR   1251H   R   SEG=MAIN   3009# 3011
RESAR2 . . . . . .  C ADDR   2820H   R   SEG=MAIN   800 835 853 869 885 897 933 1015 1071 1192 1237 1345 1369 1435
                                           1458 1485 1640 1694 1913 2052 2091 2117 3039 4599 4607 4626 4704 4726 4814
                                           4826 4841 4921 4979 4995 5009 5072 5130 5145 5162 5944 6257# 6416
RESAR8 . . . . . .  C ADDR   27DEH   R   SEG=MAIN   1148 1198 1240 1248 1374 2170 2208 6196#
RESA_HL. . . . . .  C ADDR   28C9H   R   SEG=MAIN   1944 4759 4897 5047 6393#
REZAM. . . . . . .  D ADDR   008CH   A      376# 2205
REZAP. . . . . . .  D ADDR   0088H   A      375# 2167
REZMUL . . . . . .  C ADDR   0685H   R   SEG=MAIN   1212 1226 1235#
REZ_A. . . . . . .  D ADDR   0062H   A      365# 813 886 896 932 1014 1070 2090
REZ_A0 . . . . . .  D ADDR   006AH   A      367# 1197 1373 1411 1620 2349 3030 3040 3047
REZ_A1 . . . . . .  D ADDR   0066H   A      366# 1129 1195 1236 1350 1368 1387
REZ_A2 . . . . . .  D ADDR   007BH   A      368# 1370
REZ_A3 . . . . . .  D ADDR   009CH   A      382# 1200 1376 1434 1639 1693 1823 3038 4598 4703 6415 6446
REZ_AK . . . . . .  D ADDR   00A4H   A      385# 4376 4606
REZ_AME. . . . . .  D ADDR   005EH   A      363# 1141 1150 1191 1250 1344
REZ_DEL. . . . . .  D ADDR   00C5H   A      402# 815
REZ_R. . . . . . .  D ADDR   00C9H   A      403# 1471 1484
RE_HL. . . . . . .  C ADDR   28D0H   R   SEG=MAIN   6396# 6406 6410 6413
RE_HL1 . . . . . .  C ADDR   28D8H   R   SEG=MAIN   6394 6404#
RE_HL2 . . . . . .  C ADDR   28DFH   R   SEG=MAIN   6404 6408#
RE_HL3 . . . . . .  C ADDR   28E6H   R   SEG=MAIN   6408 6412#
RFINDMEM . . . . .  C ADDR   0FCBH   R   SEG=MAIN   2624# 2625
RGO23NO. . . . . .  C ADDR   151BH   R   SEG=MAIN   3390# 3395
RGOTO7 . . . . . .  C ADDR   16D3H   R   SEG=MAIN   3673# 3707
RHNOR11. . . . . .  C ADDR   12FBH   R   SEG=MAIN   3080 3092 3098#
RHNOT1 . . . . . .  C ADDR   12C2H   R   SEG=MAIN   3055 3064#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RI21_23. . . . . .  C ADDR   0FEFH   R   SEG=MAIN   2631 2643#
RI6. . . . . . . .  C ADDR   0FE9H   R   SEG=MAIN   2634 2639# 2648 2659 2682 2686
RIGBLO . . . . . .  C ADDR   10D2H   R   SEG=MAIN   2763# 2794 2796
RIGBLOK. . . . . .  C ADDR   1110H   R   SEG=MAIN   2807#
RIGHT2 . . . . . .  C ADDR   0DF8H   R   SEG=MAIN   2326 2330#
RIGHT3 . . . . . .  C ADDR   0DFCH   R   SEG=MAIN   2328 2333#
RIKN . . . . . . .  C ADDR   0F71H   R   SEG=MAIN   2556# 2574
RIZMAN . . . . . .  C ADDR   0D4FH   R   SEG=MAIN   2246# 2285
RI_31. . . . . . .  C ADDR   1009H   R   SEG=MAIN   2646 2655#
RKNLEFT. . . . . .  C ADDR   1186H   R   SEG=MAIN   2894# 2939
RKNMEM . . . . . .  C ADDR   1177H   R   SEG=MAIN   2889# 2945
RKNNUL . . . . . .  C ADDR   1183H   R   SEG=MAIN   2893# 2933
RKNOPT . . . . . .  C ADDR   0D4CH   R   SEG=MAIN   2245# 2296
RKNRAZR. . . . . .  C ADDR   0D49H   R   SEG=MAIN   2244# 2290
RKVVOD0. . . . . .  C ADDR   1453H   R   SEG=MAIN   3279 3286#
RLABELF. . . . . .  C ADDR   0D46H   R   SEG=MAIN   2243# 2282
RLABELH. . . . . .  C ADDR   1180H   R   SEG=MAIN   2892# 2930
RLABELI. . . . . .  C ADDR   12C8H   R   SEG=MAIN   3067#
RLABELK. . . . . .  C ADDR   12C5H   R   SEG=MAIN   3066# 3069
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   148

RLABELL. . . . . .  C ADDR   0FC8H   R   SEG=MAIN   2623#
RLABELL1 . . . . .  C ADDR   1145H   R   SEG=MAIN   2846 2849#
RLABELN. . . . . .  C ADDR   104CH   R   SEG=MAIN   2684 2688#
RLABELP. . . . . .  C ADDR   19ADH   R   SEG=MAIN   4055# 4058
RLABELS13. . . . .  C ADDR   1AC1H   R   SEG=MAIN   4196# 4224
RLABELS4 . . . . .  C ADDR   1ABEH   R   SEG=MAIN   4195# 4198
RLABL2 . . . . . .  C ADDR   14B9H   R   SEG=MAIN   3330#
RLABM. . . . . . .  C ADDR   14BCH   R   SEG=MAIN   3331# 3335
RLEFCUR. . . . . .  C ADDR   177AH   R   SEG=MAIN   3767# 3771
RLER . . . . . . .  C ADDR   2551H   R   SEG=MAIN   5927 5929#
RLIST_43 . . . . .  C ADDR   1811H   R   SEG=MAIN   3841# 3843
RMAS4. . . . . . .  C ADDR   0476H   R   SEG=MAIN   958# 960
RME21_23 . . . . .  C ADDR   17E1H   R   SEG=MAIN   3799 3818#
RMO220 . . . . . .  C ADDR   0667H   R   SEG=MAIN   1214# 1261
RNNMEMB. . . . . .  C ADDR   1052H   R   SEG=MAIN   2691# 2694
RNO3PARN . . . . .  C ADDR   0A13H   R   SEG=MAIN   1740# 1754
RNOBUF0. . . . . .  C ADDR   0B31H   R   SEG=MAIN   1917 1940#
RNOCHI0. . . . . .  C ADDR   07B9H   R   SEG=MAIN   1382 1386#
RNOH37 . . . . . .  C ADDR   131FH   R   SEG=MAIN   3117# 3121 3128 3142
RNOM31 . . . . . .  C ADDR   1651H   R   SEG=MAIN   3600# 3601
RNOMEMK. . . . . .  C ADDR   1410H   R   SEG=MAIN   3254# 3272
RNORVICH . . . . .  C ADDR   0A11H   R   SEG=MAIN   1682 1683 1739#
RNOT1IN. . . . . .  C ADDR   0AE6H   R   SEG=MAIN   1820 1890#
RNOTESTIZM . . . .  C ADDR   067DH   R   SEG=MAIN   1228# 1263
ROUSTA . . . . . .  C ADDR   1999H   R   SEG=MAIN   4039 4047#
ROUSTA1. . . . . .  C ADDR   19AAH   R   SEG=MAIN   4047 4053#
ROUT6. . . . . . .  C ADDR   0D43H   R   SEG=MAIN   2242# 2281
ROUT7. . . . . . .  C ADDR   117DH   R   SEG=MAIN   2891# 2924 2929
ROUTF. . . . . . .  C ADDR   131CH   R   SEG=MAIN   3113# 3187
RR0. . . . . . . .  N NUMB   0000H   A      441# 2253 2865 2901 4538
RR1. . . . . . . .  N NUMB   0001H   A      442# 2254 2864 2902 4537
RR2. . . . . . . .  N NUMB   0002H   A      444# 1270 1282 1288 1300 1312 1323 2255 2863 2903 3869 3877 4536 4680
                                           4692 4698 4710 5334
RR3. . . . . . . .  N NUMB   0003H   A      445# 1271 1281 1289 1299 1313 1324 2256 2862 2904 3870 3876 4535 4681
                                           4691 4699 4709 5335
RR4. . . . . . . .  N NUMB   0004H   A      1272 1280 1290 1298 1314 1325 2257 2861 2905 3871 3875 4534 4682 4690
                                           4700 4708 6491# 6548 6569 6585 6629 6651
RR5. . . . . . . .  N NUMB   0005H   A      1273 1279 1291 1297 1315 1326 2258 2860 2906 3872 3874 4533 4683 4689
                                           4701 4707 6492# 6549 6556 6563 6630 6639
RR6. . . . . . . .  N NUMB   0006H   A      443# 2259 2859 2907 4532
RR7. . . . . . . .  N NUMB   0007H   A      446# 2260 2858 2908 4531
RRIR . . . . . . .  C ADDR   255EH   R   SEG=MAIN   5938 5940#
RRMO220. . . . . .  C ADDR   07B6H   R   SEG=MAIN   1359 1385#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   09A7H   R   SEG=MAIN   1666# 1684 1686 1687
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 501
RTIZMRI. . . . . .  C ADDR   0ED2H   R   SEG=MAIN   2479#
RVVIZKO. . . . . .  C ADDR   12FDH   R   SEG=MAIN   3100# 3108
RVVKALI52. . . . .  C ADDR   1AEDH   R   SEG=MAIN   4217 4219#
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SADIAP . . . . . .  D ADDR   0034H   A      314# 577 1952 3922
SADIAP2. . . . . .  D ADDR   0032H   A      316# 1955 3925
SADIAP3. . . . . .  D ADDR   0031H   A      317# 1958 3928
SADIAP4. . . . . .  D ADDR   0030H   A      318# 1961 3930
SAUS . . . . . . .  D ADDR   0036H   A      313# 2079 2081 2098 2100 2139 2141 2220 2222
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2273 2569 2587 2777 2821 2841 2920 3530 3585 3690 4206 4333 4439
                                           6003 6011
SAVEIR2. . . . . .  C ADDR   2762H   R   SEG=MAIN   899 936 1018 1074 6096#
SAVELTE. . . . . .  C ADDR   04A7H   A      8326#
SAVEN_BL . . . . .  D ADDR   00D3H   A      406# 598 6364 6395
SAVEN_BL2. . . . .  D ADDR   00C0H   A      399# 606 6383 6405
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   149

SAVEN_BL3. . . . .  D ADDR   00C2H   A      400# 613 6387 6409
SAVEN_BL4. . . . .  D ADDR   00D9H   A      410# 620 6389 6412
SAVER2 . . . . . .  C ADDR   276EH   R   SEG=MAIN   590 592 594 596 804 814 816 839 857 873 887 1130 1142 1151 1196
                                           1201 1251 1351 1371 1377 1388 1472 1476 1698 2011 2057 2096 2125 2168 2180
                                           2206 2218 3041 3048 3900 4377 4469 4616 4718 4817 4829 4849 4924 4989 5005
                                           5020 5075 5140 5155 5167 5947 6110# 6447
SAVE_HL. . . . . .  C ADDR   2895H   R   SEG=MAIN   1947 3381 3418 3437 3459 3481 3731 6362#
SA_HL. . . . . . .  C ADDR   289CH   R   SEG=MAIN   6365# 6384 6388 6390
SA_HL1 . . . . . .  C ADDR   28B7H   R   SEG=MAIN   6363 6382#
SA_HL2 . . . . . .  C ADDR   28BEH   R   SEG=MAIN   6382 6386#
SA_HL3 . . . . . .  C ADDR   28C5H   R   SEG=MAIN   6386 6389#
SBUF0. . . . . . .  D ADDR   0099H   A      40# 5176 5182
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160 509 5177 5181 5184 5185 5206
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   217AH   R   SEG=MAIN   5234# 5241
SDV1 . . . . . . .  C ADDR   218EH   R   SEG=MAIN   5246# 5252
SDVIG0 . . . . . .  C ADDR   0306H   R   SEG=MAIN   764# 766
SDVIG1 . . . . . .  C ADDR   02FBH   R   SEG=MAIN   756# 758
SDVIG2 . . . . . .  C ADDR   02F0H   R   SEG=MAIN   748# 750
SDVIG3 . . . . . .  C ADDR   02E4H   R   SEG=MAIN   739# 741
SDVIG4 . . . . . .  C ADDR   0315H   R   SEG=MAIN   774# 776
SDVIG6 . . . . . .  C ADDR   031FH   R   SEG=MAIN   781# 783
SDVM . . . . . . .  C ADDR   031DH   R   SEG=MAIN   771 780#
SEEGOON. . . . . .  C ADDR   0A19H   R   SEG=MAIN   1724 1729 1731 1737 1744#
SEEIND . . . . . .  C ADDR   0A27H   R   SEG=MAIN   1658 1665 1666 1756#
SEE_L43. . . . . .  C ADDR   18E8H   R   SEG=MAIN   3939 3947 3950#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      7422# 7443 7444 7469 7470 7494 7637 7654 7875 7915
SKOR19 . . . . . .  C ADDR   19F8H   R   SEG=MAIN   4084 4091#
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   138CH   R   SEG=MAIN   3182# 3198
SP . . . . . . . .  D ADDR   0081H   A      17# 462
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 507
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 506
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 5223
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SPWRI. . . . . . .  C ADDR   1A99H   R   SEG=MAIN   4174 4176#
SS1. . . . . . . .  C ADDR   22B0H   R   SEG=MAIN   5483# 5485
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      394# 801 803 818 836 838 854 856 870 872 1409 1618 2347 3028
SUMT2. . . . . . .  C ADDR   0371H   R   SEG=MAIN   792 833#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T2MSME . . . . . .  C ADDR   173EH   R   SEG=MAIN   3739# 3745
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   2450H   R   SEG=MAIN   5759# 5769
TABN . . . . . . .  C ADDR   24E8H   R   SEG=MAIN   5861# 5865
TABT11 . . . . . .  C ADDR   2268H   R   SEG=MAIN   5420# 5841
TABT7. . . . . . .  C ADDR   226CH   R   SEG=MAIN   4655 5424# 5854
TABT9. . . . . . .  C ADDR   226AH   R   SEG=MAIN   5422# 5851
TABUS. . . . . . .  C ADDR   2254H   R   SEG=MAIN   5356 5409#
TAKTIND. . . . . .  C ADDR   0A64H   R   SEG=MAIN   1791 1794#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   150

TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 498 499 513
TE10MS . . . . . .  C ADDR   25B4H   R   SEG=MAIN   3738 6026#
TE22 . . . . . . .  C ADDR   24DBH   R   SEG=MAIN   5840 5850#
TE23 . . . . . . .  C ADDR   24E3H   R   SEG=MAIN   5850 5854#
TE2MS. . . . . . .  C ADDR   25AAH   R   SEG=MAIN   3744 6025#
TEAEQU0. . . . . .  C ADDR   25F0H   R   SEG=MAIN   3155 6034#
TEAVK. . . . . . .  C ADDR   262CH   R   SEG=MAIN   4572 6041#
TEBEQU0. . . . . .  C ADDR   25FAH   R   SEG=MAIN   6035#
TEBL . . . . . . .  C ADDR   26E0H   R   SEG=MAIN   2736 3323 6063#
TEBL0. . . . . . .  C ADDR   26EAH   R   SEG=MAIN   3549 6064#
TECH . . . . . . .  C ADDR   26F4H   R   SEG=MAIN   3830 3997 6065#
TECLE. . . . . . .  C ADDR   26A5H   R   SEG=MAIN   2728 3291 6057#
TEEND. . . . . . .  C ADDR   2744H   R   SEG=MAIN   4669 6074#
TEERR. . . . . . .  C ADDR   273AH   R   SEG=MAIN   6018 6073#
TEFULL . . . . . .  C ADDR   26CCH   R   SEG=MAIN   2743 3516 6061#
TEINT. . . . . . .  C ADDR   26D6H   R   SEG=MAIN   3616 6062#
TEIZMK . . . . . .  C ADDR   2687H   R   SEG=MAIN   2527 3094 6054#
TEKALIB. . . . . .  C ADDR   2636H   R   SEG=MAIN   3806 4575 6042#
TEKD . . . . . . .  C ADDR   267DH   R   SEG=MAIN   4263 6053#
TELIST . . . . . .  C ADDR   26C1H   R   SEG=MAIN   2711 3240 3302 3308 6060#
TEMAX. . . . . . .  C ADDR   2712H   R   SEG=MAIN   4033 6068#
TEMEM. . . . . . .  C ADDR   26AFH   R   SEG=MAIN   6058#
TEMENU . . . . . .  C ADDR   2604H   R   SEG=MAIN   6036#
TEMID. . . . . . .  C ADDR   271CH   R   SEG=MAIN   4041 6069#
TEMIN. . . . . . .  C ADDR   2708H   R   SEG=MAIN   3561 4049 6067#
TEMUL. . . . . . .  C ADDR   0764H   R   SEG=MAIN   1306 1343#
TENMIN . . . . . .  C ADDR   2352H   R   SEG=MAIN   1209 1211 1225 5551#
TEOLI. . . . . . .  C ADDR   2726H   R   SEG=MAIN   1510 6071#
TEOLL. . . . . . .  C ADDR   269BH   R   SEG=MAIN   1604 6056#
TEOLR. . . . . . .  C ADDR   2730H   R   SEG=MAIN   1506 6072#
TEOUT. . . . . . .  C ADDR   2691H   R   SEG=MAIN   2535 2616 3085 6055#
TEPAR. . . . . . .  C ADDR   2673H   R   SEG=MAIN   4592 6052#
TES19_2. . . . . .  C ADDR   2669H   R   SEG=MAIN   529 2668 4091 4315 6050#
TES57_6. . . . . .  C ADDR   265FH   R   SEG=MAIN   2662 4085 4310 4588 6049#
TESKOR . . . . . .  C ADDR   2622H   R   SEG=MAIN   4569 6040#
TEST01 . . . . . .  C ADDR   2115H   R   SEG=MAIN   5181# 5204
TEST02 . . . . . .  C ADDR   2144H   R   SEG=MAIN   5201 5203#
TEST04 . . . . . .  C ADDR   2125H   R   SEG=MAIN   5188# 5190
TEST1. . . . . . .  C ADDR   210BH   R   SEG=MAIN   5176# 5192 5213
TEST2. . . . . . .  C ADDR   213DH   R   SEG=MAIN   5181 5200#
TEST22 . . . . . .  C ADDR   1A6EH   R   SEG=MAIN   4141 4148#
TEST23 . . . . . .  C ADDR   1A73H   R   SEG=MAIN   4148 4151#
TEST3. . . . . . .  C ADDR   212FH   R   SEG=MAIN   5183 5193#
TEST4. . . . . . .  C ADDR   211DH   R   SEG=MAIN   5184# 5199
TEST5. . . . . . .  C ADDR   2147H   R   SEG=MAIN   5202 5205#
TEST7I . . . . . .  C ADDR   0A7CH   R   SEG=MAIN   1806 1809#
TEST9I . . . . . .  C ADDR   0A75H   R   SEG=MAIN   1801 1806#
TESTAT . . . . . .  C ADDR   26FEH   R   SEG=MAIN   2719 3282 6066#
TESTRS . . . . . .  C ADDR   2109H   R   SEG=MAIN   4074 5174#
TESTS. . . . . . .  C ADDR   1A62H   R   SEG=MAIN   4143# 4150 4153
TETE11 . . . . . .  C ADDR   2641H   R   SEG=MAIN   4063 4579 6044#
TETE7. . . . . . .  C ADDR   2655H   R   SEG=MAIN   4130 4585 6046#
TETE9. . . . . . .  C ADDR   264BH   R   SEG=MAIN   4582 6045#
TETESI . . . . . .  C ADDR   260EH   R   SEG=MAIN   2989 4562 6038#
TETESR . . . . . .  C ADDR   2618H   R   SEG=MAIN   4566 6039#
TEVICH . . . . . .  C ADDR   25E6H   R   SEG=MAIN   2369 2543 3090 4478 6033#
TEWR . . . . . . .  C ADDR   26B7H   R   SEG=MAIN   2702 3297 6059#
TEXTT. . . . . . .  C ADDR   25AAH   R   SEG=MAIN   5436 6024#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 481
TH1. . . . . . . .  D ADDR   008DH   A      29# 527 531 4188 4190
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   151

TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   219EH   R   SEG=MAIN   5255#
TIM1 . . . . . . .  C ADDR   21A0H   R   SEG=MAIN   5256# 5256
TIM2 . . . . . . .  C ADDR   21A3H   R   SEG=MAIN   5237 5240 5247 5251 5259# 5302 5306 6283 6285
TIM3 . . . . . . .  C ADDR   21A5H   R   SEG=MAIN   5260# 5260
TIZMRI . . . . . .  C ADDR   0DF1H   R   SEG=MAIN   2325# 2479
TL0. . . . . . . .  D ADDR   008AH   A      26# 482
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   1389H   R   SEG=MAIN   3167 3179#
TMOD . . . . . . .  D ADDR   0089H   A      25# 479 512
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 496
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 495
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TOME13 . . . . . .  C ADDR   19D9H   R   SEG=MAIN   4072 4077#
TOME14 . . . . . .  C ADDR   1A06H   R   SEG=MAIN   4077 4098#
TOME15 . . . . . .  C ADDR   1A1EH   R   SEG=MAIN   4098 4110#
TOME21 . . . . . .  C ADDR   19D0H   R   SEG=MAIN   4061 4072#
TOSK19 . . . . . .  C ADDR   1B9DH   R   SEG=MAIN   4309 4315#
TOUTF. . . . . . .  C ADDR   1306H   R   SEG=MAIN   3104# 3107
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TTOUT. . . . . . .  C ADDR   0ED5H   R   SEG=MAIN   2481# 2490
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 5224
UNPACK1. . . . . .  C ADDR   009EH   A      7440# 7634 7768 7898 8012
UNPACK2. . . . . .  C ADDR   00BAH   A      7465# 7635 7769 7899
UP1. . . . . . . .  C ADDR   0138H   A      7585# 7602
UP2. . . . . . . .  C ADDR   014BH   A      7605# 7623
UP2A . . . . . . .  C ADDR   0161H   A      7584 7621#
UPA. . . . . . . .  C ADDR   2381H   R   SEG=MAIN   5606# 5612
UPA1 . . . . . . .  C ADDR   2391H   R   SEG=MAIN   5624# 5630
UPA2 . . . . . . .  C ADDR   2371H   R   SEG=MAIN   5587# 5593
UPAA . . . . . . .  C ADDR   286DH   R   SEG=MAIN   6331# 6337
UPAA4. . . . . . .  C ADDR   23DCH   R   SEG=MAIN   5687# 5693
UPAB . . . . . . .  C ADDR   23ECH   R   SEG=MAIN   5704# 5710
UPAK . . . . . . .  C ADDR   237BH   R   SEG=MAIN   5603#
UPAK1. . . . . . .  C ADDR   2847H   R   SEG=MAIN   6296#
UPAK2. . . . . . .  C ADDR   236BH   R   SEG=MAIN   5584#
UPAK3. . . . . . .  C ADDR   238BH   R   SEG=MAIN   3759 3854 5621#
UPAK4. . . . . . .  C ADDR   2867H   R   SEG=MAIN   3713 6328#
UPAKA. . . . . . .  C ADDR   23D6H   R   SEG=MAIN   4461 5684#
UPAKB. . . . . . .  C ADDR   23E6H   R   SEG=MAIN   4508 5701#
UPAV1. . . . . . .  C ADDR   1B0CH   R   SEG=MAIN   4243# 4249
UPAV2. . . . . . .  C ADDR   1BCFH   R   SEG=MAIN   4360# 4366
UPK1 . . . . . . .  C ADDR   2859H   R   SEG=MAIN   6304 6307#
UPK2 . . . . . . .  C ADDR   285AH   R   SEG=MAIN   6306 6308#
VICHMAX. . . . . .  C ADDR   2054H   R   SEG=MAIN   4035 5046#
VICHMEAN . . . . .  C ADDR   1E98H   R   SEG=MAIN   4043 4758#
VICHMIN. . . . . .  C ADDR   1F7BH   R   SEG=MAIN   3563 4051 4896#
VICHR. . . . . . .  D ADDR   00B1H   A      392# 1264 1797 2366 2375 2509 2522 2627 2635 2993 2997 3005 3079 3146
                                           3258 3795 3803 3812 4056 4107 4121 4261 4452 4491 4523 4560 5839
VIG0 . . . . . . .  C ADDR   0AD2H   R   SEG=MAIN   1874# 1876
VIG4 . . . . . . .  C ADDR   0AE0H   R   SEG=MAIN   1885# 1887
VIOUT. . . . . . .  C ADDR   0EACH   R   SEG=MAIN   2372 2454# 2482
VIOUTF . . . . . .  C ADDR   12FFH   R   SEG=MAIN   3101#
VIT2_10. . . . . .  C ADDR   0E1FH   R   SEG=MAIN   2355# 2361
VODM11_15. . . . .  C ADDR   179DH   R   SEG=MAIN   3784# 3802
VOLUME . . . . . .  D ADDR   00D5H   A      407# 2313 3726 6372 6374
VV21_23. . . . . .  C ADDR   1A59H   R   SEG=MAIN   4127 4139#
VVCHIBL. . . . . .  C ADDR   251FH   R   SEG=MAIN   2610 5893#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   152

VVCHIF . . . . . .  C ADDR   24FAH   R   SEG=MAIN   5869# 5886
VVINTE . . . . . .  C ADDR   16FEH   R   SEG=MAIN   3677 3705#
VVIZKO . . . . . .  C ADDR   1356H   R   SEG=MAIN   3100 3146#
VVKALI52 . . . . .  C ADDR   1BC2H   R   SEG=MAIN   4219 4344# 4396
VVMENU . . . . . .  C ADDR   1B72H   R   SEG=MAIN   4226 4297#
VVNOL23. . . . . .  C ADDR   251AH   R   SEG=MAIN   5890# 5894
VVNOL31. . . . . .  C ADDR   2515H   R   SEG=MAIN   5888# 5890
VVNOL41. . . . . .  C ADDR   2513H   R   SEG=MAIN   5886# 5888
VVOD2_10 . . . . .  C ADDR   1736H   R   SEG=MAIN   3267 3386 3486 3736#
VVOD43 . . . . . .  C ADDR   1914H   R   SEG=MAIN   3969 3976#
VVODM11_15 . . . .  C ADDR   19B0H   R   SEG=MAIN   3784 4056#
VVOSTA . . . . . .  C ADDR   1971H   R   SEG=MAIN   4012 4031#
VVOSTAD. . . . . .  C ADDR   1985H   R   SEG=MAIN   4031 4039#
VVRR6. . . . . . .  C ADDR   0F31H   R   SEG=MAIN   2527#
VV_52V . . . . . .  C ADDR   1AE4H   R   SEG=MAIN   4200 4216#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 477 478
WORK . . . . . . .  D ADDR   00B8H   A      396# 1491 1493 1499 1515 1522 1538 1559 1564 1580 1825 1903 3353 3363
                                           3365 3399 3409 3411 3421 3431 3433 3440 3450 3452 3462 3472 3474 4766 4813
                                           4816 4825 4828 4840 4902 4920 4923 4978 4988 4994 5004 5008 5053 5071 5074
                                           5129 5139 5144 5154 5178 5200
WR1. . . . . . . .  C ADDR   2834H   R   SEG=MAIN   6279# 6286
WRITE. . . . . . .  C ADDR   2831H   R   SEG=MAIN   670 5730 5732 5734 5736 5738 5740 5743 5745 5747 5750 5752 5754
                                           6277#
WRITED_X1. . . . .  C ADDR   21A9H   R   SEG=MAIN   5265#
WRITE_X1 . . . . .  C ADDR   21A8H   R   SEG=MAIN   5264#
WRPAGE . . . . . .  C ADDR   0480H   A      4185 4648 4750 8287#
WW5. . . . . . . .  C ADDR   0483H   A      8288# 8296
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 473 505
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 474
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 475 504
XCIKLWR. . . . . .  C ADDR   274EH   R   SEG=MAIN   894 907 909 911 914 917 920 923 926 929 962 964 966 969 972 975
                                           978 981 984 986 989 991 993 996 999 1002 1005 1008 1011 1063 1065 1067
                                           6079#
XTEMP. . . . . . .  N NUMB   000CH   A      6488# 6852 6853 6854 6855 6941 6943 6944 6946 6947 6949 6950 6952 6974
                                           6975 6976 6977 6995 6996 7000 7001 7004 7008 7009 7012 7016 7017 7021 7022
                                           7024 7025 7026 7028 7032 7033 7035 7036 7040 7041 7046 7047 7049 7050 7054
                                           7055 7060 7062 7063 7064
YBNUL. . . . . . .  C ADDR   1297H   R   SEG=MAIN   3036 3044#
YES. . . . . . . .  C ADDR   2A9CH   R   SEG=MAIN   6874 6878 6882 6886 6904# 6967
YES0KEY. . . . . .  C ADDR   02C0H   R   SEG=MAIN   700 712#
YES0KEY1 . . . . .  C ADDR   02CDH   R   SEG=MAIN   719# 726
YESAVP . . . . . .  C ADDR   07C3H   R   SEG=MAIN   1365 1391#
YESBUF . . . . . .  C ADDR   0B36H   R   SEG=MAIN   1938 1943#
YESIND . . . . . .  C ADDR   0A7EH   R   SEG=MAIN   1796 1805 1808 1811#
YESPRD . . . . . .  C ADDR   0B34H   R   SEG=MAIN   1937 1941#
YESTEST. . . . . .  C ADDR   2243H   R   SEG=MAIN   5351 5383#
YESTT5 . . . . . .  C ADDR   0BF9H   R   SEG=MAIN   2049#
YESVICH. . . . . .  C ADDR   080EH   R   SEG=MAIN   1379 1430#
YESVI_KM . . . . .  C ADDR   1E01H   R   SEG=MAIN   4595 4675#
YESVI_KR . . . . .  C ADDR   1D79H   R   SEG=MAIN   4595# 4597
YST1 . . . . . . .  C ADDR   019FH   R   SEG=MAIN   528 532#
YST19. . . . . . .  C ADDR   0197H   R   SEG=MAIN   525 529#
Z01S . . . . . . .  C ADDR   22C8H   R   SEG=MAIN   5500# 5502
Z05S . . . . . . .  C ADDR   22D5H   R   SEG=MAIN   5509# 5511
Z100 . . . . . . .  C ADDR   2299H   R   SEG=MAIN   5464# 5466
Z15. . . . . . . .  C ADDR   22A7H   R   SEG=MAIN   5476# 5478
Z1S. . . . . . . .  C ADDR   22BBH   R   SEG=MAIN   5492# 5494
ZAPADC . . . . . .  C ADDR   2178H   R   SEG=MAIN   5233#
ZCMP . . . . . . .  C ADDR   27D0H   R   SEG=MAIN   6186#
ZDIV . . . . . . .  C ADDR   279DH   R   SEG=MAIN   812 1122 1643 3893 6149#
ZER1 . . . . . . .  C ADDR   00B3H   A      7450 7454# 7509 7552
ZER2 . . . . . . .  C ADDR   00D4H   A      7476 7480#
ZMUL . . . . . . .  C ADDR   2793H   R   SEG=MAIN   6144#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      324# 1718 3918 4867 5038 6157 6160 6163
ZNPLUS . . . . . .  C ADDR   02D7H   R   SEG=MAIN   681 728#
A51 MACRO ASSEMBLER  AMP31_2                                                              02/19/2007 15:15:54 PAGE   153

ZZ . . . . . . . .  C ADDR   22A9H   R   SEG=MAIN   5477# 5477
Z_01S. . . . . . .  C ADDR   22C4H   R   SEG=MAIN   2265 2266 2913 5198 5212 5498# 6015
Z_05S. . . . . . .  C ADDR   22D1H   R   SEG=MAIN   2043 2044 2739 4036 4044 4052 5507#
Z_100. . . . . . .  C ADDR   2297H   R   SEG=MAIN   5463#
Z_15 . . . . . . .  C ADDR   22A5H   R   SEG=MAIN   649 5475#
Z_1MS. . . . . . .  C ADDR   22AEH   R   SEG=MAIN   719 5205 5482#
Z_1S . . . . . . .  C ADDR   22B7H   R   SEG=MAIN   638 646 1426 2371 3564 3837 3958 4010 4302 4388 4490 4672 4673
                                           5490#
Z_5. . . . . . . .  C ADDR   22A0H   R   SEG=MAIN   5269 5279 5470#
Z_9. . . . . . . .  C ADDR   282CH   R   SEG=MAIN   5226 6271#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
