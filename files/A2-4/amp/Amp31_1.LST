A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp31_1.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp31_1.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236              
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                        jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti   
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti 
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;53h..5dh 10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
  0039               310     nuerr                           DATA    39h;номер ошибки (для интерфейса)       
  0038               311     nblok                           DATA    38h;номер введенного блока
  0037               312     nelem                           DATA    37h;номер лемента в блоке 0..200
  0036               313     saus                            DATA    36h;сохр упр слово
  0034               314     sadiap                  DATA    34H;сохр диапазон на кот проходила запись блока1
  0033               315     chind2                          DATA    33h;счетчик индикации
  0032               316     sadiap2                 DATA    32h;сохр диапазон на кот проходила запись блока2
  0031               317     sadiap3                 DATA    31h;сохр диапазон на кот проходила запись блока3
  0030               318     sadiap4                 DATA    30h;сохр диапазон на кот проходила запись блока4
                     319     ;DATA           2fh
                     320     ;;;;;
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     6

  0020               321      cellbit                DATA    20h
  0000               322     bitznak         BIT     cellbit.0       ;20.0           
  0001               323     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               324     znmat           BIT             cellbit.2       ;20.2
  0003               325     bitrs           BIT             cellbit.3       ;20.3
  0004               326     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               327     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               328     bitvi11         BIT             cellbit.6       ;20.6   бит нажатия ввод режима вычислить R
                             !!!
  0007               329     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us 
                                  
                     330     
  0021               331     cellbit1                DATA    21h
  0008               332     bitbuf          BIT     cellbit1.0      ;21.0   
  0009               333     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               334     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               335     bitmem          BIT             cellbit1.3      ;21.3 нажата кн память
                     336     ;bmem11         BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               337     bifl_kt         BIT             cellbit1.5      ;21.5  бит для выч Км теста измерения  
                     338     ;bmem13         BIT             cellbit1.6      ;21.6            
  000F               339     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     340     
  0022               341     cellbit2                DATA    22h
  0010               342     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               343     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               344     bitklb          BIT             cellbit2.2      ;22.2  признак калибровки
  0013               345     bitv19          BIT             cellbit2.3      ;22.3           бит установки скор итерфейс
                             а 19.6
  0014               346     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               347     biteizm         BIT             cellbit2.5      ;22.5   признак теста измерения 
  0016               348     bitpar          BIT             cellbit2.6      ;22.6   бит проведенного 1раз пароля 
  0017               349     bitoll          BIT             cellbit2.7      ;22.7 бит перегрузки
                     350     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     351     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     352     ;и выдает т.н. буфер индикации  
  0023               353     cellbit3                DATA    23h
  0018               354     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               355     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               356     bitakt          BIT             cellbit3.2      ;22.2  бит такта
  001B               357     bitznB          BIT             cellbit3.3      ;22.3 БИТ ЗНАКА ПРИ ВВОДЕ константы В
                     358     ;bit            BIT             cellbit3.4      ;22.4    
                     359     ;bit            BIT             cellbit3.5      ;22.5    
                     360     ;bit            BIT             cellbit3.6      ;22.6            
                     361     ;bit            BIT             cellbit3.7      ;22.7
                     362             
  005E               363     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     364     ;hex
  0062               365     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               366     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               367     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               368     rez_A2   data 7bh; A2
                     369     
  0098               370     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               371     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               372     chdel    data  83h              ; счетчик задержки
                     373     ;float
  0084               374     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               375     rezAp    data  88h              ;4byte  A+
  008C               376     rezAm    data  8ch              ;4byte  A-
  0090               377     koefKp   data  90h              ;4byte  K+
  0094               378     koefKm   data  94h              ;4byte  K-
                     379     ;hex 
  009A               380     parT     data  9ah              ;параметр времени измерения
  009B               381     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               382     rez_A3   data  9ch              ;A3
                     383     ;FLOAT
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     7

  00A0               384     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               385     rez_Ak  data  0a4h         ;Ak
  00A8               386     parol           data  0a8h         ;храним в памяти пароль
  00AC               387     chind   data  0ach         ;счетчик индикации
                     388     ;chbuf  data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               389     diap    data  0aeh         ;номер диапазона
  00AF               390     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               391     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               392     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               393     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               394     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               395     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               396     work    data  0b8h        ;рабочая ячейка
  00BC               397     konstA  data  0bch        ;     введенная с крана константа A
                     398     ;konstB data  0c0h         ;    введенная с крана константа B
  00C0               399     saven_bl2       data    0c0h;;копия адреса последней записанной ячейки блока2
  00C2               400     saven_bl3       data  0c2h;копия адреса последней записанной ячейки блока3 
                     401                ;c4 1bait
  00C5               402     Rez_del data  0c5h      ;сумма n-значений /n
  00C9               403     rez_R           data    0c9h            ;рез вычисления R 4baita
  00CD               404     interva data  0cdh;значение интервала (запись)2baita
  00CF               405     chbuf   data  0cfh         ;счетчик периода загрузки в буфер и интерфейс
  00D3               406     saven_bl        data  0d3h;номер ячейки в блоке 2 baita
  00D5               407     volume          data    0d5h;объем блока 2 baita
  00D6               408     chblok          data    0d6h;volume;кол измерений блока
  00D7               409     copy_hl         data  0d7h;адрес ячейки блока для просмотра 
  00D9               410     saven_bl4       data  0d9h;копия адреса последней записанной ячейки блока4
                     411     ;data           0dbh e0h-граница стека
                     412     
                     413     ;внешнее ОЗУ 64K 
                     414     ;в обл внешнего озу 0..ffh читается страница рпзу и при записи в любую
                     415     ;ячейку  стирается целая страница 0..ffh рпзу
                     416     ;               XSEG AT 100h
                     417             PUBLIC    MASS0
  0100               418     MASS0  xdata 0100h;     скользящий массив измерения
  0104               419     MASS1  xdata 0104h;
  0108               420     MASS2  xdata 0108h;
  010C               421     MASS3  xdata 010ch;
  0110               422     MASS4  xdata 0110h;
  0114               423     MASS5  xdata 0114h;
  0118               424     MASS6  xdata 0118h;
  011C               425     MASS7  xdata 011ch;
  0120               426     MASS8  xdata 0120h;
  0124               427     MASS9  xdata 0124h;
  0128               428     MASS10  xdata 0128h;
  012C               429     MASS11  xdata 012ch;
  0130               430     MASS12  xdata 0130h;
  0134               431     MASS13  xdata 0134h;
  0138               432     MASS14  xdata 0138h;
  013C               433     MASS15  xdata 013ch;
  0140               434     MASS16  xdata 0140h;
  0144               435     MASS17  xdata 0144h;
  0148               436     MASS18  xdata 0148h;
  014C               437     MASS19  xdata 014ch;
                     438     ;xdata 
                     439     
  0000               440                             rr0             EQU 00
  0001               441                     rr1       equ   01
  0006               442                     rr6   equ 06
  0002               443                     rr2       equ   02
  0003               444                     rr3       equ   03
  0007               445                     rr7   equ 07
                     446     
  0008               447                     r8   equ 08
  0009               448                     r9        equ   09
  000A               449                     r10       equ   10
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     8

  000B               450                     r11   equ 11
                     451     
                     452                     
                     453        
----                 454                  rseg     Main          ; Switch to this code segment.
                     455     
                     456                  using    0              ; Specify register bank for the following
                     457     
0100                 458     org 100h
                     459     ;$EJECT
                     460     
0100 7581E0          461     begin:     mov  sp, #0e0h
0103 75E900          462                                             mov             PCA0L,#00;=0x00;
0106 75D900          463                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          464                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          465                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          466                                             mov     P2MDOUT,#00;=0x00;
                     467             
0112 75A73F          468             mov     P3MDOUT,#3fh;
0115 75B5FF          469             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          470             mov     REF0CN,#03h;=0x03;
                     471             
011B 75E114          472             mov     XBR0,#14h;= 0x14;
011E 75E200          473             mov     XBR1,#00; =0x00;
0121 75E300          474             mov XBR2,#00;=0x00;
0124 75B0C0          475             mov     P3,#0c0h
0127 75FFDE          476             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          477             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          478             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          479             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          480             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          481             mov     TL0,#0f9h;=0xf9; 
0139 75E680          482             mov     EIE1,#80h;=0x80;
                     483     
013C 75D480          484             mov     DAC0CN,#80h;=0x80;
013F 75D780          485             mov     DAC1CN,#80h;=0x80;
0142 75B167          486             mov     OSCXCN,#67h;=0x67;
                     487     
                     488      
                     489     
0145 E5B1            490     gener:     mov a, oscxcn
0147 B4E7FB          491                cjne a,#11100111b,gener
                     492                            
014A 75B288          493             mov     OSCICN,#88h;=0x84;
014D 75CA00          494         mov TMR2RLL,#0;=0;
0150 75CBD1          495         mov TMR2RLH,#0d1h;=0xd1;
                     496       
0153 D28E            497                     setb  TCON.6                    ;регистр управления
0155 D28C            498                      setb tcon.4
                     499     
0157 75EF00          500             mov     RSTSRC,#0;=00   ;//источники сброса 
                     501     
                     502             
015A 75E340          503          mov        XBR2,#40h
015D 75E106          504              mov    XBR0,#06h;16h
0160 75F803          505             mov             SPI0CN,#03
0163 759D31          506             mov             spi0ckr,#31H;;;;;;;;#04
                     507     ;установка скорости
0166 759850          508                                             mov             SCON0,#50h;01010000;скорость обмена
                              определяется таймером1
0169 758780          509                                             mov             PCON,#10000000b;удвоенная скорость 
                             передачи SMOD0=1
016C 758E10          510                                             mov             CKCON,#00010000b;TIM=1
016F 758920          511                                             mov             TMOD,#00100000b;реж2 внутр ист синх
                             р
0172 758840          512                                             mov             TCON,#01000000b;счетчик запущен
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE     9

0175 7A50            513                                             mov                     r2,#50h                    
                                  ;57.6->19.2
0177 7B2C            514                                             mov                     r3,#2ch
0179 120454          515                                             call            re4byte                 ;502ch 1 ba
                             it skor
017C E508            516                                             mov                     a,r8
017E B40007          517                                             cjne            a,#00,yst19
0181 C213            518                                             clr                     bitv19                  ;57
                             .6
0183 758DF4          519                                             mov                     TH1,#244
0186 8008            520                                             jmp               yst1
0188 900000   F      521     yst19:          mov                     dptr,#teS19_2
018B D213            522                                             setb            bitv19                  ;19,2
018D 758DDC          523                                             mov                     TH1,#220
0190                 524     yst1:
0190 75E730          525                                             mov             EIE2,#30H;00110000
                     526                                     ;       mov             EIP2,#30H
0193 75A880          527                                             mov     IE,#80h;//10000000      ;//Снятие блокировк
                             и всех прерываний
                     528     ;ozu
0196 E4              529                                             clr     a
0197 7800            530                                             mov     r0,#00h 
0199 F6              531     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
019A 08              532                                             inc     r0
019B B87FFB          533                                             cjne    r0,#7fh,mecle
019E 7880            534                                             mov     r0,#80h
01A0 F6              535     meff:                   mov     @r0,a 
01A1 F2              536                                             movx @r0,a
01A2 08              537                                             inc     r0
01A3 B8DFFA          538                             cjne    r0,#0dfh,meff
01A6 120000   F      539                             call    clmassix
                     540     ;обнулить внешнее озу 4кбайта
01A9 900000          541                                     mov                     dptr,#0
01AC E4              542     extcle: clr                     a
01AD F0              543                                     movx            @dptr,a
01AE A3              544                                     inc                     dptr
01AF E583            545                                     mov                     a,dph
01B1 B410F8          546                                     cjne            a,#10h,extcle
                     547     
01B4 7898            548                             mov             r0,#chinkor
01B6 7600            549                             mov             @r0,#0;1;
01B8 08              550                             inc             r0
01B9 7619            551                             mov             @r0,#19h;64h;0c8h;90h;
                     552                             ;;;;
01BB 7881            553                             mov             r0,#chavt
01BD 7601            554                             mov             @r0,#1
01BF 08              555                             inc             r0
01C0 7690            556                             mov             @r0,#90h
                     557     
01C2 78B2            558                                     mov             r0,#marker
01C4 76FF            559                                     mov             @r0,#0ffh
                     560                             ;mov            r0,#chind
                     561                             ;mov            @r0,#1
                     562                     
01C6 74FF            563                             mov             a,#0ffh
01C8 F585            564                        mov          p5,a
01CA 799A            565                             mov             r1,#parT
01CC 7702            566                             mov             @r1,#2                  ;Tizm=1s
01CE 79AE            567                             mov             r1,#diap
01D0 7705            568                             mov             @r1,#5                  ;10-7a
01D2 753405          569                             mov             sadiap,#5
01D5 79AF            570                             mov             r1,#parN
01D7 7702            571                             mov             @r1,#2
01D9 7400            572                             mov             a,#00h
01DB F585            573                             mov             p5,a
01DD D204            574                             setb    bitizm
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    10

                     575     
01DF 799B            576                             mov             r1,#chbefore
01E1 7700            577                             mov             @r1,#0
                     578                             ;;;;;;
01E3 900000   F      579                             mov             dptr,#ch_1              ;1->r2..r5 float
01E6 120000   F      580                             call    ldc_long
01E9 7890            581                             mov             r0,#koefKp         ;1(float)->koefKp
01EB 120000   F      582                             call    saver2
01EE 7894            583                             mov             r0,#koefKm              ;1(float)->koefKm
01F0 120000   F      584                             call    saver2
01F3 78A0            585                             mov             r0,#koefKD
01F5 120000   F      586                             call    saver2
01F8 78CF            587                             mov                     r0,#chbuf
01FA 120000   F      588                             call    saver2
01FD 900158          589                             mov                     dptr,#158h;1 блок(2е с конца измерение) 
0200 79D3            590                             mov             r1,#saven_bl
0202 E583            591                             mov             a,dph
0204 F7              592                                               mov           @r1,a
0205 09              593                                                     inc             r1
0206 E582            594                                                     mov             a,dpl
0208 F7              595                                                     mov             @r1,a
                     596     
0209 900478          597                             mov                     dptr,#478h;2 блок(2е с конца измерение) 
020C 79C0            598                             mov             r1,#saven_bl2
020E E583            599                             mov             a,dph
0210 F7              600                                               mov           @r1,a
0211 09              601                                                     inc             r1
0212 E582            602                                                     mov             a,dpl
0214 F7              603                                                     mov             @r1,a
0215 900798          604                                     mov                     dptr,#798h;3 блок(2е с конца измере
                             ние) 
0218 79C2            605                             mov             r1,#saven_bl3
021A E583            606                             mov             a,dph
021C F7              607                                               mov           @r1,a
021D 09              608                                                     inc             r1
021E E582            609                                                     mov             a,dpl
0220 F7              610                                                     mov             @r1,a
0221 900AB8          611                             mov                     dptr,#0ab8h;4 блок(2е с конца измерение)   
                                  
0224 79D9            612                             mov             r1,#saven_bl4
0226 E583            613                             mov             a,dph
0228 F7              614                                               mov           @r1,a
0229 09              615                                                     inc             r1
022A E582            616                                                     mov             a,dpl
022C F7              617                                                     mov             @r1,a
022D 753801          618                             mov             nblok,#1                        ;номер введенного б
                             лока
0230 753701          619                             mov             nelem,#1
0233 78CD            620                             mov             r0,#interva
0235 7600            621                             mov             @r0,#0
0237 08              622                             inc             r0
0238 7601            623                             mov             @r0,#1
023A 7840            624                             mov             r0,#bufind
023C                 625     age2:
023C 76FD            626                             mov             @r0,#0fdh         ;погасить индикатор
023E 08              627                             inc             r0
023F B84CFA          628                             cjne    r0,#bufind+12,age2              
0242 120000   F      629                             call    ind
0245 120000   F      630                             call    z_1s
                     631     
                     632                                     ;зажечь все лементы индикации
0248 7840            633                             mov             r0,#bufind
024A 7669            634     ageon:          mov             @r0,#69h;0feh;?
024C 08              635                             inc             r0
024D B84CFA          636                             cjne    r0,#bufind+12,ageon             
0250 120000   F      637                             call    ind
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    11

0253 120000   F      638                             call    z_1s            ;1sec
                     639     ;;;;;;;;;;;;;;;;
                     640                     
0256 120000   F      641                             call    z_15;z_1ms
0259 434B10          642                             orl             bufind+11,#10h;бит точки после 1 знакоместа
                     643     ;;;;;;;;;;;;;;;;;;;
025C 7C60            644                             mov             r4,#60h
025E 7D00            645                             mov             r5,#00         
0260 120000   F      646                             call    iniacp;инициализация acp
0263 120000   F      647                             call    loadUS          ;us 10-7 A
                     648                             
0266 C217            649     rebyte:         clr             bitoll
0268 3095FD          650                             jnb             p1.5,$
026B 2095FD          651                             jb              p1.5,$
                     652                             ;mov            a,P6            ;p6.4=0
                     653                             ;anl            a,#0efh
                     654                             ;mov            P6,a
                     655                             ;nop
                     656                             ;nop
                     657                                     
                     658                             ;mov            a,P6                    ;p6.4=1 
                     659                             ;orl            a,#10h
                     660                             ;mov            P6,a                        
026E 7411            661                             mov             a,#11h
0270 120000   F      662                             call    write
                     663                             ;чтение acp
0273 120000   F      664                             call    read    
0276 F578            665                             mov     reacp+1,A       ;старший байт 
0278 120000   F      666                             call    read    
027B F579            667                             mov     reacp+2,A       ;средний байт 
027D 120000   F      668                             call    read
0280 F57A            669                             mov     reacp+3,A               ;мл байт
                     670                        ;;;;;;;;;;;
0282 7878            671                        mov          r0,#reacp+1
0284 E6              672                        mov          a,@r0
0285 20E740          673                             jb              acc.7,znplus;
0288 D200            674                             setb    bitznak
028A 4480            675                             orl             a,#80h  ;ост содерж яч 
028C F6              676                             mov             @r0,a
                     677                                     
028D 18              678     mmm:            dec             r0;,#reacp
028E 76FF            679                             mov             @r0,#0ffh
0290 803E            680                             jmp             goznak
                     681     
0292 120000   F      682     mem10ms:        call            ind
0295 80CF            683                                             jmp                     rebyte                     
                                  ;10ms
                     684     
0297                 685     labelA: 
                     686                             ;разрешить ie6,ie7
0297 E53E            687                             mov                     a,chkl+1                ;low
0299 7009            688                             jnz                     no0key
029B E53D            689                             mov                     a,chkl
029D 7005            690                             jnz                     no0key
029F 75E730          691                             mov                     EIE2,#30h ;EIE2.5,EIE2.4
02A2 800D            692                             jmp                     yes0key
                     693                        
02A4                 694     no0key: ;       mov             r1,#chkl 
                     695                                     ;       call    chdec
02A4 C3              696                                     clr                     c
02A5 E53E            697                                     mov                     a,chkl+1;chkl-1
02A7 9401            698                                     subb            a,#1
02A9 F53E            699                                     mov                     chkl+1,a
02AB E53D            700                                     mov                     a,chkl
02AD 9400            701                                     subb            a,#0
02AF F53D            702                                     mov                     chkl,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    12

                     703                             ;;;;;;;;;;;;
02B1                 704     yes0key:
02B1 2004B2          705                                             jb              bitizm,rebyte
                     706                              ;буфер 2 выдать на индикацию
02B4 E533            707                             mov             a,chind2                        ;реже выдавать на и
                             ндикацию
02B6 700B            708                             jnz             nochind
02B8 753364          709                             mov             chind2,#100
02BB 120000   F      710                             call    ind
02BE 120000   F      711     yes0key1:       call    z_1ms;z_01s
                     712                             ;call   z_01s
                     713                             ;call   z_01s
02C1 80D4            714                             jmp             labelA
                     715     
02C3 14              716     nochind:        dec             a
02C4 F533            717                                             mov             chind2,a
02C6 80F6            718                                     jmp             yes0key1;labelA
                     719             
02C8 C200            720     znplus:         clr     bitznak
02CA 547F            721                             anl             a,#7fh;fdh                      ;+
02CC F6              722                             mov             @r0,a
02CD 18              723                             dec             r0;,#reacp
02CE 7600            724                             mov             @r0,#00h
                     725                             
02D0                 726     goznak: 
                     727     ;;;;;;;;;;;;;
02D0 787A            728                             mov     r0,#reacp+3
02D2 E6              729                             mov             a,@r0
02D3 7F05            730                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
02D5 C3              731     sdvig3:         clr             c
02D6 13              732                             rrc             a
02D7 DFFC            733                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
02D9 FA              734                             mov             r2,a    ;сохр байт
02DA 18              735                             dec             r0              ;       reacp+2
02DB E6              736                             mov             a,@r0
02DC C0E0            737                             push    acc
02DE C3              738                             clr             c
02DF 7F03            739                             mov             r7,#3;2
02E1 C3              740     sdvig2:         clr             c
02E2 33              741                             rlc             a
02E3 DFFC            742                             djnz    r7,sdvig2 ;d12..d11      средний байт
02E5 4A              743                             orl             a,r2
02E6 F57A            744                             mov             reacp+3,a;сформ мл байт
02E8 D0E0            745                             pop             acc
                     746                             
02EA 7F05            747                             mov             r7,#5;6
02EC C3              748     sdvig1:         clr             c
02ED 13              749                             rrc             a
02EE DFFC            750                             djnz    r7,sdvig1 ;d15,d14        ср байт
02F0 FA              751                             mov             r2,a   ;сохр
02F1 E578            752                             mov             a,reacp+1
02F3 C0E0            753                             push    acc
                     754                     ;;      push    acc
02F5 7F03            755                             mov             r7,#3;2
02F7 C3              756     sdvig0:         clr             c
02F8 33              757                             rlc             a
02F9 DFFC            758                             djnz    r7,sdvig0 ;       d21..d16
02FB 4A              759                             orl             a,r2
02FC F579            760                             mov             reacp+2,a       ; сформ средний  байт
02FE D0E0            761                             pop             acc       ;reacp+1
                     762                             ;;;;;;;;;;;;;;
0300 20E70B          763                             jb              acc.7,sdvm
0303 C3              764                             clr             c
0304 7F05            765                             mov             r7,#5;6
0306 C3              766     sdvig4:         clr             c
0307 13              767                             rrc             a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    13

0308 DFFC            768                             djnz    r7,sdvig4 ;       d23,d22
030A F578            769                             mov             reacp+1,a
030C 8008            770                             jmp             readyacp;ankor;klmas
                     771     ;;;;;;;;;;;;                                    
030E 7F05            772     sdvm:           mov             r7,#5;6
0310 D3              773     sdvig6:         setb            c
0311 13              774                             rrc             a
0312 DFFC            775                             djnz    r7,sdvig6 ;       d23,d22
0314 F578            776                             mov             reacp+1,a
                     777                                                             
                     778     ; reacp..reacp+3-результат чтения асп(hex) 
                     779     ;;;;;;;;;
0316                 780     readyacp:
0316 7898            781                                             mov             r0,#chinkor
0318 E6              782                             mov             a,@r0
0319 30E702          783                             jnb             acc.7,gopart
031C 8044            784                                     jmp             sumt2
                     785                     
031E                 786     gopart:
031E 789A            787                             mov             r0,#parT        ;параметр времени
0320 793F            788                             mov             r1,#chmasN
0322 B6013A          789                             cjne    @r0,#1,noparT1
                     790                             ;РЕЗ+РЕЗ
0325 7877            791                             mov             r0,#reacp
0327 120000   F      792                             call    resar2          ;reacp->r2..r5
032A 78B6            793                             mov             r0,#summa+3;rez_A+3
032C 120000   F      794                             call    ladd
032F 78B3            795                             mov             r0,#summa;rez_A
0331 120000   F      796                             call    saver2
0334 793F            797                              mov            r1,#chmasN
0336 7714            798                             mov             @r1,#20;10
0338 789B            799                             mov             r0,#chbefore
033A B6631E          800                             cjne    @r0,#99,nobef99
                     801                             ;РЕЗ/100
033D 900000   F      802                             MOV        DPTR,#ch100 
0340 120000   F      803     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
0343 120000   F      804                             call    zdiv;divide
0346 7862            805                             mov             r0,#rez_A
0348 120000   F      806                             call    saver2          ;сумма 100 отсчетов /100
034B 78C5            807                             mov             r0,#Rez_del
034D 120000   F      808                             call    saver2  
                     809                        ;;;;;
0350 78B3            810                        mov          r0,#summa
0352 120000   F      811                        call         clear4
                     812     
0355 799B            813                             mov             r1,#chbefore
0357 7700            814                             mov             @r1,#0
0359 8070            815                             jmp             klmas           ;загр в массив скользящее ср
035B 06              816     nobef99:        inc             @r0                     ;chbefore
035C 020000   F      817                             jmp             rebyte;labelA;метка A
                     818     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     819     ;а потом уже располагаем  в скользящий массив  из n
                     820     
                     821     
                     822     
035F B6021D          823     noparT1:        cjne    @r0,#2,noparT2
                     824                             ;РЕЗ+РЕЗ
0362                 825     sumt2:
0362 7877            826                              mov            r0,#reacp
0364 120000   F      827                             call    resar2          ;reacp->r2..r5
0367 78B6            828                             mov             r0,#summa+3;rez_A+3
0369 120000   F      829                             call    ladd
036C 78B3            830                             mov             r0,#summa;rez_A
036E 120000   F      831                             call    saver2
0371 789B            832                             mov             r0,#chbefore
0373 793F            833                             mov             r1,#chmasN
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    14

0375 770A            834                             mov             @r1,#10
0377 B613E1          835                             cjne    @r0,#19,nobef99;9,nobef99
                     836                             ;РЕЗ/20
037A 900000   F      837                             MOV        DPTR,#ch20;ch10 
037D 80C1            838                             jmp             allsum
                     839                             ;;;;;;;
                     840                             
                     841     
037F B6031D          842     noparT2:        cjne    @r0,#3,noparT3
                     843     
0382 7877            844                                                              mov            r0,#reacp
0384 120000   F      845                             call    resar2          ;reacp->r2..r5
0387 78B6            846                             mov             r0,#summa+3;rez_A+3
0389 120000   F      847                             call    ladd
038C 78B3            848                             mov             r0,#summa;rez_A
038E 120000   F      849                             call    saver2
0391 789B            850                             mov             r0,#chbefore
0393 793F            851                             mov             r1,#chmasN
0395 7704            852                             mov             @r1,#4                                  ;n=4
0397 B609C1          853                             cjne    @r0,#9,nobef99;9,nobef99
                     854                             ;РЕЗ/10
039A 900000   F      855                             MOV        DPTR,#ch10 
039D 80A1            856                             jmp             allsum
                     857                             
039F B6041D          858     noparT3:        cjne    @r0,#4,noparT4
03A2                 859     aapar:          
03A2 7877            860              mov            r0,#reacp
03A4 120000   F      861                             call    resar2          ;reacp->r2..r5
03A7 78B6            862                             mov             r0,#summa+3;rez_A+3
03A9 120000   F      863                             call    ladd
03AC 78B3            864                             mov             r0,#summa;rez_A
03AE 120000   F      865                             call    saver2
03B1 789B            866                             mov             r0,#chbefore
03B3 793F            867                             mov             r1,#chmasN
03B5 7704            868                             mov             @r1,#4
03B7 B604A1          869                             cjne    @r0,#4,nobef99;9,nobef99
                     870                             ;РЕЗ/10
03BA 900000   F      871                             MOV        DPTR,#ch5
03BD 8081            872                             jmp             allsum
                     873     
                     874                     
03BF 7702            875     noparT4:   mov          @r1,#2          ;chmasN n=2
03C1 7877            876                             mov             r0,#reacp
03C3 120000   F      877                             call    resar2          ;reacp->r2..r5
03C6 7862            878                             mov             r0,#rez_A
03C8 120000   F      879                             call    saver2
                     880     ;загрузить А в массив из 2/10 значений
                     881     ;;;;;;;;;;;;;;;
03CB                 882     klmas:           
03CB 793F            883                             mov             r1,#chmasN
03CD B7021A          884                             cjne    @r1,#2,mas10
03D0 900100          885                             MOV        dptr,#MASS0
03D3 120000   F      886                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     887     
03D6 7862            888                             mov             r0,#rez_A
03D8 120000   F      889                             call    resar2          ;->r2..r5
03DB 900100          890                             mov                     dptr,#MASS0
03DE 120000   F      891                   call              saveIr2                 ; R2-R5 --> MAS0
                     892                     
03E1 900107          893                   MOV          dptr,#MASS1+3
03E4 120000   F      894                   CALL       addx
03E7 020000   F      895                       jmp           endsum
                     896     ;массив из 10-ти измерений
03EA B70A7D          897     mas10:                  cjne    @r1,#10,mas20
03ED 900120          898                                             mov                     dptr,#MASS8
03F0 120000   F      899                     CALL            xCIKLWR         ;MASS8->MASS9
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    15

03F3 90011C          900                                             mov                     dptr,#MASS7
03F6 120000   F      901                     CALL            xCIKLWR         ;MASS7->MASS8
03F9 900118          902                     MOV       dptr,#MASS6
03FC 120000   F      903                     CALL       xCIKLWR         ; MASS6 --> MASS7
03FF 900114          904                     MOV        dptr,#MASS5
                     905                    
0402 120000   F      906                    CALL        xCIKLWR        ; MASS5 --> MASS6
0405 900110          907                    MOV         dptr,#MASS4
                     908                    
0408 120000   F      909                    CALL        xCIKLWR        ; MASS4 --> MASS5
040B 90010C          910                             mov                     dptr,#MASS3
                     911     
040E 120000   F      912                    CALL             xCIKLWR         ;MASS3->MASS4
0411 900108          913                     MOV        dptr,#MASS2
                     914                    
0414 120000   F      915                    CALL        xCIKLWR         ; MASS2 --> MASS3
0417 900104          916                    MOV         dptr,#MASS1
                     917                     
041A 120000   F      918                   CALL         xCIKLWR        ; MASS1 --> MASS2
041D 900100          919                    MOV         dptr,#MASS0
                     920                   
0420 120000   F      921                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     922     
                     923                             
0423 7862            924                             mov             r0,#rez_A
0425 120000   F      925                             call    resar2          ;->r2..r5
                     926                                     ;call   aform
0428 900100          927                                     mov                     dptr,#MASS0
042B 120000   F      928                   call              saveIr2                 ; R2-R5 --> MAS0
                     929              
042E 900107          930                   MOV          dptr,#MASS1+3
0431 120000   F      931                   CALL       addx
0434 90010B          932                   MOV          dptr,#MASS2+3
0437 120000   F      933                   CALL       addx
043A 90010F          934                   MOV          dptr,#MASS3+3
043D 120000   F      935                  CALL        addx
0440 900113          936                   MOV       dptr,#MASS4+3
0443 120000   F      937                   call       addx
0446 900117          938                     MOV        dptr,#MASS5+3
0449 120000   F      939                  CALL        addx
044C 90011B          940                   MOV          dptr,#MASS6+3
044F 120000   F      941                   CALL       addx
0452 90011F          942                   MOV          dptr,#MASS7+3
0455 120000   F      943                  CALL        addx
0458 900123          944                  MOV        dptr,#MASS8+3
045B 120000   F      945                   call       addx
045E 900127          946                     MOV                     dptr,#MASS9+3
0461 120000   F      947                  call        addx
0464 020000   F      948                              jmp            endsum
                     949     
0467 020000   F      950     rmas4:          jmp                     mas4
                     951     ;массив из 20-ти измерений
046A B714FA          952     mas20:          cjne    @r1,#20,rmas4
046D 900148          953                                             mov                     dptr,#MASS18
0470 120000   F      954                     CALL            xCIKLWR         ;MASS18->MASS19
0473 900144          955                                             mov                     dptr,#MASS17
0476 120000   F      956                     CALL            xCIKLWR         ;MASS17->MASS18
0479 900140          957                     MOV       dptr,#MASS16
047C 120000   F      958                     CALL       xCIKLWR         ; MASS16 --> MASS17
047F 90013C          959                     MOV        dptr,#MASS15
                     960                    
0482 120000   F      961                    CALL        xCIKLWR        ; MASS15 --> MASS16
0485 900138          962                    MOV         dptr,#MASS14
                     963                    
0488 120000   F      964                    CALL        xCIKLWR        ; MASS14 --> MASS15
048B 900134          965                             mov                     dptr,#MASS13
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    16

                     966     
048E 120000   F      967                    CALL             xCIKLWR         ;MASS13->MASS14
0491 900130          968                     MOV        dptr,#MASS12
                     969                    
0494 120000   F      970                    CALL        xCIKLWR         ; MASS12 --> MASS13
0497 90012C          971                    MOV         dptr,#MASS11
                     972                     
049A 120000   F      973                   CALL         xCIKLWR        ; MASS11 --> MASS12
049D 900128          974                    MOV         dptr,#MASS10
                     975                   
04A0 120000   F      976                    CALL        xCIKLWR        ; MASS10 --> MASS11
04A3 900124          977                                      MOV       dptr,#MASS9
04A6 120000   F      978                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     979     
04A9 900120          980                                             mov                     dptr,#MASS8
04AC 120000   F      981                     CALL            xCIKLWR         ;MASS8->MASS9
04AF 90011C          982                                             mov                     dptr,#MASS7
04B2 120000   F      983                     CALL            xCIKLWR         ;MASS7->MASS8
04B5 900118          984                     MOV       dptr,#MASS6
04B8 120000   F      985                     CALL       xCIKLWR         ; MASS6 --> MASS7
04BB 900114          986                     MOV        dptr,#MASS5
                     987                    
04BE 120000   F      988                    CALL        xCIKLWR        ; MASS5 --> MASS6
04C1 900110          989                    MOV         dptr,#MASS4
                     990                    
04C4 120000   F      991                    CALL        xCIKLWR        ; MASS4 --> MASS5
04C7 90010C          992                             mov                     dptr,#MASS3
                     993     
04CA 120000   F      994                    CALL             xCIKLWR         ;MASS3->MASS4
04CD 900108          995                     MOV        dptr,#MASS2
                     996                    
04D0 120000   F      997                    CALL        xCIKLWR         ; MASS2 --> MASS3
04D3 900104          998                    MOV         dptr,#MASS1
                     999                     
04D6 120000   F     1000                   CALL         xCIKLWR        ; MASS1 --> MASS2
04D9 900100         1001                    MOV         dptr,#MASS0
                    1002                   
04DC 120000   F     1003                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1004     
                    1005                             
04DF 7862           1006                             mov             r0,#rez_A
04E1 120000   F     1007                             call    resar2          ;->r2..r5
                    1008                                     ;call   aform
04E4 900100         1009                                     mov                     dptr,#MASS0
04E7 120000   F     1010                   call              saveIr2                 ; R2-R5 --> MAS0
                    1011              
04EA 900107         1012                   MOV          dptr,#MASS1+3
04ED 120000   F     1013                   CALL       addx
04F0 90010B         1014                   MOV          dptr,#MASS2+3
04F3 120000   F     1015                   CALL       addx
04F6 90010F         1016                   MOV          dptr,#MASS3+3
04F9 120000   F     1017                  CALL        addx
04FC 900113         1018                   MOV       dptr,#MASS4+3
04FF 120000   F     1019                   call       addx
0502 900117         1020                     MOV        dptr,#MASS5+3
0505 120000   F     1021                  CALL        addx
0508 90011B         1022                   MOV          dptr,#MASS6+3
050B 120000   F     1023                   CALL       addx
050E 90011F         1024                   MOV          dptr,#MASS7+3
0511 120000   F     1025                  CALL        addx
0514 900123         1026                  MOV        dptr,#MASS8+3
0517 120000   F     1027                   call       addx
051A 900127         1028                     MOV                     dptr,#MASS9+3
051D 120000   F     1029                  call        addx
                    1030     ;27
0520 90012B         1031                                     MOV        dptr,#MASS10+3
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    17

0523 120000   F     1032                   CALL       addx
0526 90012F         1033                                     MOV        dptr,#MASS11+3
0529 120000   F     1034                   CALL       addx
052C 900133         1035                   MOV          dptr,#MASS12+3
052F 120000   F     1036                   CALL       addx
0532 900137         1037                   MOV          dptr,#MASS13+3
0535 120000   F     1038                  CALL        addx
0538 90013B         1039                   MOV       dptr,#MASS14+3
053B 120000   F     1040                   call       addx
053E 90013F         1041                                     MOV        dptr,#MASS15+3
0541 120000   F     1042                     CALL     addx
0544 900143         1043                   MOV          dptr,#MASS16+3
0547 120000   F     1044                   CALL       addx
054A 900147         1045                   MOV          dptr,#MASS17+3
054D 120000   F     1046                  CALL        addx
0550 90014B         1047                  MOV        dptr,#MASS18+3
0553 120000   F     1048                   call       addx
0556 90014F         1049                                     MOV                     dptr,#MASS19+3
0559 120000   F     1050                  call        addx
055C 802F           1051                                     jmp             endsum
                    1052     ;массив из 4х измерений
055E                1053     mas4:                   
055E 900108         1054                                             MOV        dptr,#MASS2
0561 120000   F     1055                    CALL        xCIKLWR         ; MASS2 --> MASS3
0564 900104         1056                    MOV         dptr,#MASS1
0567 120000   F     1057                    CALL        xCIKLWR        ; MASS1 --> MASS2
056A 900100         1058                    MOV         dptr,#MASS0
056D 120000   F     1059                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1060     
                    1061                             
0570 7862           1062                             mov             r0,#rez_A
0572 120000   F     1063                             call    resar2          ;->r2..r5
                    1064                                     ;call   aform
0575 900100         1065                                     mov                     dptr,#MASS0
0578 120000   F     1066                   call              saveIr2                 ; R2-R5 --> MAS0
                    1067              
057B 900107         1068                   MOV          dptr,#MASS1+3
057E 120000   F     1069                   CALL       addx
0581 90010B         1070                   MOV          dptr,#MASS2+3
0584 120000   F     1071                   CALL       addx
0587 90010F         1072                   MOV          dptr,#MASS3+3
058A 120000   F     1073                  CALL        addx
                    1074                  
                    1075             ;23.03          
058D                1076     endsum:
058D 786E           1077                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
058F 06             1078                                     inc             @r0
0590 E6             1079                                     mov             a,@r0   
0591 200105         1080                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                    1081                                     
0594 B53F31         1082                                     cjne    a,chmasN,masx5
0597 D201           1083                                     setb    bitmas                  ;массив заполнен
0599 853F6E         1084     masfull:                mov             chmas,chmasN
059C 783F           1085                                     mov             r0,#chmasN
059E E6             1086                                     mov             a,@r0
                    1087     ;masfull:
059F B40208         1088                                     cjne    a,#2,nochn2
05A2 900000   F     1089                                     MOV        DPTR,#ch2;10 
05A5 120000   F     1090                                     CALL   ldc_ltemp                 ; ltemp <-- 2
05A8 8028           1091                                     jmp             mas5div
                    1092     
05AA B40A08         1093     nochn2:         cjne    a,#10,nochn10
05AD 900000   F     1094                                                     MOV        DPTR,#ch10 
05B0 120000   F     1095                                     CALL   ldc_ltemp                 ; ltemp <-- 10
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    18

05B3 801D           1096                                     jmp             mas5div
                    1097     
05B5 B41408         1098     nochn10:        cjne    a,#20,nochn20
05B8 900000   F     1099                                                     MOV        DPTR,#ch20 
05BB 120000   F     1100                                     CALL   ldc_ltemp                 ; ltemp <-- 20
05BE 8012           1101                                     jmp             mas5div
                    1102     
05C0 900000   F     1103     nochn20:        MOV        DPTR,#ch4 
05C3 120000   F     1104                                     CALL   ldc_ltemp                 ; ltemp <-- 4
05C6 800A           1105                                     jmp             mas5div
                    1106     
05C8 856E0B         1107     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
05CB E4             1108                                     clr     a
05CC F50A           1109                                     mov     ltemp+2,a
05CE F509           1110                                     mov     ltemp+1,a
05D0 F508           1111                                     mov     ltemp,a
                    1112     
05D2                1113     mas5div:
05D2 120000   F     1114                                     CALL       zdiv;divide                           ; R2-R5 =
                    1115                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                    1116     
                    1117                             
                    1118      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1119     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1120     ;получен результат 3 байта и знак
05D5 7866           1121                             mov             r0,#rez_A1
05D7 120000   F     1122                             call    saver2           ;сохр среднее по массиву
                    1123     ;;8.11.06                       mov             chmasN,#0
                    1124      ;;;;;;;;;;;;
                    1125      ;;;;;;;;;;;;
05DA C3             1126                             clr             c
05DB 799A           1127                             mov             r1,#parT
05DD 7402           1128                             mov             a,#2
05DF 97             1129                             subb    a,@r1
05E0 501D           1130                             jnc             ankor           ;T<3
                    1131                             ;A-=РЕЗ1                                ;T>3
05E2 120402         1132                             call    altof                   ;r2..r5->float
05E5 785E           1133                             mov             r0,#rez_Ame
05E7 120000   F     1134                             call    saver2
                    1135                             ;;;;
05EA 7890           1136                             mov             r0,#koefKp;->r8..r11
05EC EA             1137                             mov             a,r2
05ED 30E702         1138                             jnb             acc.7,nminus3
05F0 7894           1139                             mov             r0,#koefKm;->r8..r11
05F2 120000   F     1140     nminus3:                call    resar8
05F5 120203         1141                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
05F8 785E           1142                             mov             r0,#rez_Ame
05FA 120000   F     1143                             call    saver2
05FD 8021           1144                             jmp             gotoKD
                    1145     
05FF                1146     ankor:  
05FF 7898           1147                             mov             r0,#chinkor
0601 E6             1148                             mov             a,@r0
0602 30E703         1149                             jnb             acc.7,nokorr
                    1150                             ;коррекция 0
0605 020000   F     1151                             jmp             kornul
0608                1152     nokorr: 
                    1153                             ;mov            r10,#00         ;       chavt
                    1154                             ;mov            r11,#00h
0608 7881           1155                             mov              r0,#chavt      
060A E6             1156                             mov                     a,@r0;call      chcmp           ;сравн счет
                             чик авто калибровки с 0h
060B 30E737         1157                             jnb             acc.7,nonulavt;jnz              nonulavt        
060E 750A00         1158                             mov             r10,#0;1;00;02          
0611 750BC8         1159                             mov             r11,#0c8h;90h;0c8h;58h
0614 7898           1160                             mov             r0,#chinkor
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    19

0616 120000   F     1161                             call    chcmp
0619 7045           1162                             jnz             noavk
                    1163                             ;автокалибровка
061B 020000   F     1164                             jmp             autoka;noavk;
                    1165     
061E 8079           1166     rafterK:                jmp             afterK
                    1167     ;;;;;;;;;;
0620 C3             1168      gotoKD:                clr             c
0621 799A           1169                             mov             r1,#parT
0623 7404           1170                             mov             a,#4
0625 97             1171                             subb    a,@r1
0626 50F6           1172                             jnc             rafterK         ;T<5
                    1173                             ;A1-=A- *KD                     ;T>5
                    1174                             ;call           findkoef                                ;r2,r3-hex
                    1175                             ;       call            rebyte2                         ;r2..r5- he
                             x
                    1176                                     
                    1177                             ;       call    altof                   ;r2..r5->float
                    1178                             ;       mov     dptr,#CHtho;100000
                    1179                             ;       call    ldc_ltemp                       ;r8..r11
                    1180                             ;       call    fldiv
                    1181                             ;       call    move28
                    1182                             
0628 785E           1183                             mov             r0,#rez_Ame;->r2..r5   ???????????/
062A 120000   F     1184                             call    resar2
                    1185                                     ;call   flmul
062D 120343         1186                             call    ftol                    ;float->int
0630 7866           1187                             mov             r0,#rez_A1
0632 120000   F     1188                             call    saver2
0635 786A           1189                             mov             r0,#rez_A0;->r8..r11 hex
0637 120000   F     1190                             call    resar8
063A 120000   F     1191                             call    lsub            ;A3=A-1-A0
063D 789C           1192                             mov             r0,#rez_A3
063F 120000   F     1193                             call    saver2
0642 020000   F     1194                             jmp             labelB  
                    1195      ;;;;;;;;;;; 9.11.06
0645 789A           1196     nonulavt:        mov            r0,#parT
0647 E6             1197                             mov             a,@r0
0648 6401           1198                             xrl             a,#01
064A 700F           1199                             jnz             avtdec1
064C 7982           1200                             mov             r1,#chavt+1     ;T=1 chavt-10
064E 120000   F     1201                             call    tenmin
0651 7999           1202     kordec10:       mov             r1,#chinkor+1
0653 120000   F     1203                             call    tenmin
0656 801E           1204                             jmp             rezmul
                    1205     
0658 020000   F     1206     rmo220:         jmp             mo220
                    1207     
065B 7981           1208     avtdec1:        mov             r1,#chavt       
065D 120000   F     1209                             call    chdec           ;chavt-1
                    1210     ;                       jmp             kordec1;rezmul
0660 789A           1211     noavk:          mov             r0,#parT
0662 E6             1212                             mov             a,@r0
0663 6401           1213                             xrl             a,#01
0665 700A           1214                             jnz             kordec1
                    1215                             ;T=1 chinkor-10
0667 7999           1216                     mov             r1,#chinkor+1
0669 120000   F     1217                             call    tenmin
066C 8008           1218                             jmp             rezmul
                    1219     
066E 020000   F     1220     rnotestizm:             jmp                     notestizm
0671 7998           1221     kordec1:        mov             r1,#chinkor
0673 120000   F     1222                             call    chdec           ; chinkor-1
                    1223                        ;9.11.06
                    1224                             ;;;;;;;;;;;;;;
                    1225                             ;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    20

                    1226     ;(РЕЗ1-АN)*K
0676                1227     rezmul:
0676 7866           1228                             mov             r0,#rez_A1;->r2..r5
0678 120000   F     1229                             call    resar2
067B 120402         1230                             call    altof   ;r2..r5->float  6.06    
067E 7884           1231                             mov             r0,#kor0_AN;->r8..r11
0680 120000   F     1232                             call    resar8
0683 1201D1         1233                             call    flsub
0686 7890           1234                             mov             r0,#koefKp;->r8..r11
0688 EA             1235                             mov             a,r2
0689 30E702         1236                             jnb             acc.7,nminus
                    1237                             ;jnb            bitznak,nminus
                    1238                     
068C 7894           1239                             mov             r0,#koefKm;->r8..r11
068E 120000   F     1240     nminus:         call    resar8
0691 120203         1241                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
0694 785E           1242                             mov             r0,#rez_Ame
0696 120000   F     1243                             call    saver2
                    1244      
0699                1245     afterK:                 
                    1246     ;;;;;;;;;;;;;;
0699 EA             1247                                     mov             a,r2
069A 547F           1248                                     anl             a,#7fh
069C FA             1249                                     mov             r2,a
069D 900000   F     1250                                     mov     dptr,#ch_250;220;220000
06A0 120000   F     1251                                     call    ldc_ltemp                       ;r8..r11=8
06A3 1201D6         1252                                     call    flcmp
06A6 50B0           1253                                     jnc             rmo220          ;A>220000
                    1254                                     ;;;;;;;;;
06A8 3015C3         1255                                     jnb                     biteizm,rnotestizm
06AB 78B1           1256                                     mov                     r0,#vichR
06AD B62155         1257                                     cjne            @r0,#21h,note21
06B0 7A50           1258                                     mov                     r2,#50h                 ;-11a
06B2 7B18           1259                                     mov                     r3,#18h                 ;k8
06B4 12046C         1260                                     call            rebyte2                         ;r2..r5- he
                             x
06B7 120402         1261                                     call            altof                   ;r2..r5->float
06BA C002           1262                                     push            rr2
06BC C003           1263                                     push            rr3
06BE C004           1264                                     push            rr4
06C0 C005           1265                                     push            rr5
06C2 7A50           1266                                     mov                     r2,#50h                 ;k10
06C4 7B20           1267                                     mov                     r3,#20h
06C6 12046C         1268     re11_7: call            rebyte2                 ;r2..r5
06C9 120402         1269                                     call            altof                   ;r2..r5->float
06CC 120000   F     1270                                     call            move28
06CF D005           1271                                     pop                     rr5
06D1 D004           1272                                     pop                     rr4
06D3 D003           1273                                     pop                     rr3
06D5 D002           1274                                     pop                     rr2
06D7 1202B7         1275                                     call            fldiv
                    1276                             ;       mov                     dptr,#ch_10
                    1277                             ;       call            ldc_ltemp                       ;r8..r11
                    1278                             ;       call            flmul
                    1279                                     ;;;;;2.02.07
06DA C002           1280                                     push            rr2
06DC C003           1281                                     push            rr3
06DE C004           1282                                     push            rr4
06E0 C005           1283                                     push            rr5
06E2 7A50           1284                                     mov                     r2,#50h                 ;-11a
06E4 7B2C           1285                                     mov                     r3,#2ch                 ;Km
06E6 12046C         1286                                     call            rebyte2                         ;r2..r5- he
                             x
06E9 120402         1287                                     call            altof                   ;r2..r5->float
06EC 120000   F     1288                                     call            move28
06EF D005           1289                                     pop                     rr5
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    21

06F1 D004           1290                                     pop                     rr4
06F3 D003           1291                                     pop                     rr3
06F5 D002           1292                                     pop                     rr2
06F7 120203         1293                                     call            flmul                           ;*Km
06FA 900000   F     1294                                     mov     dptr,#CHtho;100000
06FD 120000   F     1295                                     call    ldc_ltemp                       ;r8..r11=8
0700 1202B7         1296                                     call    fldiv
                    1297                                     ;;;;;
0703 8050           1298                                     jmp                     temul   
0705 B62218         1299     note21: cjne            @r0,#22h,note22
0708 7A50           1300                                     mov                     r2,#50h                 ;-09a
070A 7B10           1301                                     mov                     r3,#10h                 ;k6
070C 12046C         1302                                     call            rebyte2                         ;r2..r5- he
                             x
070F 120402         1303                                     call            altof                   ;r2..r5->float
0712 C002           1304                                     push            rr2
0714 C003           1305                                     push            rr3
0716 C004           1306                                     push            rr4
0718 C005           1307                                     push            rr5
071A 7A50           1308                                     mov                     r2,#50h                 ;k8
071C 7B18           1309                                     mov                     r3,#18h
071E 80A6           1310                                     jmp                     re11_7
0720 7A50           1311     note22: mov                     r2,#50h                 ;-7a
0722 7B08           1312                                     mov                     r3,#08h                 ;k4
0724 12046C         1313                                     call            rebyte2                         ;r2..r5- he
                             x
0727 120402         1314                                     call            altof                   ;r2..r5->float
072A C002           1315                                     push            rr2
072C C003           1316                                     push            rr3
072E C004           1317                                     push            rr4
0730 C005           1318                                     push            rr5
0732 7A50           1319                                     mov                     r2,#50h                 ;k6
0734 7B10           1320                                     mov                     r3,#10h
0736 808E           1321                                     jmp                     re11_7  
                    1322                                     ;;;;;;;;;
0738                1323     notestizm:
0738 301208         1324                                     jnb             bitklb,komulpz
073B 900000   F     1325                                     mov     dptr,#chk;100000
073E 120000   F     1326                                     call    ldc_long                        ;r2..r5
0741 8006           1327                                     jmp             komul
0743 120000   F     1328     komulpz:call            findkoef                                ;r2,r3-hex
0746 12046C         1329                                     call            rebyte2                         ;r2..r5- he
                             x
                    1330                                     
0749 120402         1331     komul:  call    altof                   ;r2..r5->float
074C 900000   F     1332                                     mov     dptr,#CHtho;100000
074F 120000   F     1333                             call    ldc_ltemp                       ;r8..r11=8
0752 1202B7         1334                                     call    fldiv
0755 120000   F     1335     temul:                          call    move28
0758 785E           1336                                     mov             r0,#rez_Ame
075A 120000   F     1337                                     call    resar2
                    1338                     
075D 120203         1339                                     call    flmul     ;A1-=A-*KD  fl
                    1340                                     
0760 120343         1341                                     call    ftol                    ;float->int
0763 7866           1342                                     mov             r0,#rez_A1
0765 120000   F     1343                                     call    saver2
0768 120402         1344                                     call    altof                   ;r2..r5->float
076B 900000   F     1345                                     mov     dptr,#ch_220;200;200000
076E 120000   F     1346                                     call    ldc_ltemp                       ;r8..r11=8
0771 1201D6         1347                                     call    flcmp
0774 502D           1348                                     jnc             rrmo220         ;A>200000
                    1349                             ;       jnb             knizm,noavp;goA2;               bitizm,goA2
                                  
                    1350                             ;       jb              bitavp,yesavp
0776 301808         1351                                     jnb             knizm,goA2
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    22

0779 300602         1352                                     jnb             bitvi11,qu_avp
077C 8003           1353                                     jmp             goA2
077E 20052F         1354     qu_avp:                 jb              bitavp,yesavp
0781                1355     noavp:  ;               jb              bitvi11,yesvich  ;уст после ввода A B (ввод ВЫЧИСЛИ
                             ТЬ)
0781                1356     goA2:                    ;A2=A1-
0781 7866           1357                                      mov            r0,#rez_A1
0783 120000   F     1358                                     call    resar2
0786 787B           1359                                     mov             r0,#rez_A2
0788 120000   F     1360                                     call    saver2
078B                1361     goA3A2:                  ;A3=A2-A0
078B 786A           1362                                       mov           r0,#rez_A0
078D 120000   F     1363                                     call    resar8
0790 120000   F     1364                                     call    lsub
0793 789C           1365                                     mov             r0,#rez_A3
0795 120000   F     1366                                     call    saver2
                    1367                                     ;;;;;;
0798 20065E         1368                                     jb              bitvi11,yesvich
079B                1369     goonin:            ;jmp         goonind;indA3;8.11.06
079B 78AC           1370                                     mov             r0,#chind
079D B60006         1371                                     cjne    @r0,#0,rnochi0
07A0 020000   F     1372                                     jmp             goonind;indA3
                    1373     
07A3 020000   F     1374     rrmo220:                jmp             mo220
07A6 020000   F     1375     rnochi0:                jmp             nochi0
07A9 7866           1376     gokaA2:                 mov             r0,#rez_A1                      ;(float)
07AB 120000   F     1377                                                     call    saver2                          ;то
                              необх для калибровки ,goA2 работает с тим знач
07AE 80D1           1378                                             jmp             goA2
                    1379     ;;;;;;;;;;;;;;;;
07B0 EA             1380     yesavp:                 mov             a,r2
07B1 547F           1381                                     anl             a,#7fh
07B3 FA             1382                                     mov             r2,a
07B4 900000   F     1383                                     mov     dptr,#ch_10th;10000
07B7 120000   F     1384                                     call    ldc_ltemp                       ;r8..r11=8
07BA 1201D6         1385                                     call    flcmp
07BD 50C2           1386                                     jnc             noavp           ;A>10000        
07BF 78AE           1387                                     mov             r0,#diap                ;10-11
07C1 B60902         1388                                     cjne    @r0,#9,avpgo
07C4 80BB           1389                                     jmp             noavp
07C6                1390     avpgo:                  
07C6 06             1391                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
07C7 B60A01         1392                                     cjne    @r0,#0ah,clmasv
07CA 16             1393                                     dec             @r0
07CB                1394     clmasv:         ;сбросить массив
07CB 120000   F     1395                             call    loadUS
                    1396                             ;call   louizm
07CE 120000   F     1397                             call     clmassix
07D1 78B3           1398                                     mov             r0,#summa
07D3 120000   F     1399                                     call    clear4
07D6 786A           1400                                     mov             r0,#rez_A0
07D8 120000   F     1401                                     call    clear4
07DB D207           1402                                     setb            bitzus;bitbuf;;;;;;;;;;;;                  
                                                                                   
07DD 80BC           1403                                jmp     goonin
                    1404     
07DF D00B           1405     erra01:         pop                     r11
07E1 D00A           1406                                     pop                     r10
07E3 D009           1407                                     pop                     r9
07E5 D008           1408                                     pop                     r8
07E7 C214           1409                                     clr             bitvich
07E9 C206           1410                                     clr             bitvi11
07EB 753934         1411                                             mov                     nuerr,#34h;константа не дол
                             жна быть равна0
07EE 120000   F     1412                                             call            error
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    23

07F1 120000   F     1413                                             call            ind
07F4 120000   F     1414                                             call            z_1s
07F7 80A2           1415                                             jmp             goonin
                    1416     
                    1417     
07F9                1418     yesvich:        
                    1419                     ;                       mov             r0,#konstB
                    1420                     ;               call    resar2
                    1421                     ;               call    move28
07F9 789C           1422                                     mov             r0,#rez_A3;A1
07FB 120000   F     1423                                     call    resar2                          ;HEX
                    1424                                     
07FE 120402         1425                                     call            altof                   ;r2..r5->float
0801 EA             1426                                     mov             a,r2                    ;модуль
0802 547F           1427                                     anl             a,#7fh
0804 FA             1428                                     mov             r2,a
                    1429                     ;               call            fladd                           ;A1+B
                    1430                                     
0805 900000   F     1431                                     mov     dptr,#CH_500;
0808 120000   F     1432                                     call    ldc_ltemp                       ;r8..r11
080B 1201D6         1433                                     call    flcmp
080E 407E           1434                                     jc                      mo500R;error <500 >22000
0810 900000   F     1435                                     mov     dptr,#CH_22T;
0813 120000   F     1436                                     call    ldc_ltemp                       ;r8..r11
0816 1201D6         1437                                     call    flcmp
0819 507F           1438                                     jnc             mo500I          ;error
                    1439                                     ;;;;;;;;;;;;
081B 120000   F     1440                                     call            move28
081E C008           1441                                     push            r8
0820 C009           1442                                     push            r9
0822 C00A           1443                                     push            r10
0824 C00B           1444                                     push            r11
0826 78BC           1445                                     mov             r0,#konstA
0828 120000   F     1446                                     call    resar2
082B 900000   F     1447                                     mov                     dptr,#ch0
082E 120000   F     1448                                     call            ldc_ltemp
0831 1201D6         1449                                     call            flcmp
0834 60A9           1450                                     jz              erra01
0836 900000   F     1451                                     mov             dptr,#CH_B
0839 120000   F     1452                                     CALL   ldc_ltemp                 ; ltemp <-- 10-7
083C 120203         1453                                     call            flmul                           ;A*10-7
083F D00B           1454                                     pop                     r11
0841 D00A           1455                                     pop                     r10
0843 D009           1456                                     pop                     r9
0845 D008           1457                                     pop                     r8
0847 1202B7         1458                                     call            fldiv                   ;результат R
084A 78C9           1459                                     mov                     r0,#rez_R
084C 120000   F     1460                                     call            saver2
084F 120343         1461                                     call            ftol                    ;float->hex
                    1462                                     ;;;;;;;;;;
0852 784F           1463                                             mov             r0,#abin
0854 120000   F     1464                                             call    saver2
                    1465     ;;;;;;;;
0857 7840           1466                                                     mov             r0,#bufind
0859                1467     age9:
0859 7620           1468                             mov             @r0,#" "          ;погасить индикатор
085B 08             1469                             inc             r0
085C B84BFA         1470                             cjne    r0,#bufind+11,age9
                    1471                                             
085F 78C9           1472                                             mov             r0,#rez_R
0861 120000   F     1473                                             call            resar2
                    1474     ;;;;;;;;;;
0864 900000   F     1475                                     mov             dptr,#CH_fl
0867 120000   F     1476                                     CALL   ldc_ltemp
086A 1202B7         1477                                     call            fldiv
                    1478     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    24

086D 78B8           1479                                     mov             r0,#work                ;степень +
086F 7600           1480                                     mov             @r0,#0
0871 78B9           1481                                     mov             r0,#work+1;степень -
0873 7600           1482                                     mov             @r0,#0
0875 900000   F     1483     compa1: mov     dptr,#ch_1;
0878 120000   F     1484                                     call    ldc_ltemp                       ;r8..r11
087B 1201D6         1485                                     call    flcmp
087E 4026           1486                                     jc              equ0            ;<1
0880 78B8           1487                                     mov             r0,#work                        ;степень +
0882 06             1488                                     inc             @r0
0883 900000   F     1489                                     mov             dptr,#ch_10;
0886 120000   F     1490                                     call    ldc_ltemp                       ;r8..r11
0889 1202B7         1491                                     call            fldiv
088C 80E7           1492                                     jmp             compa1                          ;work значе
                             ние степени n(hex)  
                    1493                                     ;;;;;;;;;;;;;;;;;;;
088E 900000   F     1494     mo500R: mov             dptr,#teOLR
0891 120000   F     1495                               call          lotext           
0894 120000   F     1496                                     call            ind
0897 020000   F     1497                                     jmp                     nobavp;nobitizm
089A 900000   F     1498     mo500I: mov             dptr,#teOLI
089D 120000   F     1499                               call          lotext           
08A0 120000   F     1500                                     call            ind
08A3 020000   F     1501                                     jmp                     nobavp;nobitizm
08A6                1502     equ0:           ;;;;;   call            ftol                    ;float->int
08A6 78B8           1503                                     mov             r0,#work                ;степень +
08A8 B60019         1504                                     cjne    @r0,#0,equ00
                    1505                                     
08AB 900000   F     1506     compa2: mov     dptr,#ch_1;
08AE 120000   F     1507                                     call    ldc_ltemp                       ;r8..r11
08B1 1201D6         1508                                     call    flcmp
08B4 500E           1509                                     jnc             equ00           ;>1
08B6 78B9           1510                                     mov             r0,#work+1                      ;степень -
08B8 16             1511                                     dec             @r0                                        
                                          ;0,ff(-1),fe(-2)...
08B9 900000   F     1512                                     mov             dptr,#ch_10;
08BC 120000   F     1513                                     call    ldc_ltemp                       ;r8..r11
08BF 120203         1514                                     call            flmul
08C2 80E7           1515                                     jmp             compa2                          ;work значе
                             ние степени n(hex)  
                    1516     
                    1517     
08C4                1518     equ00:          
08C4 7853           1519                                                     mov             r0,#adec
08C6 7952           1520                                             mov             r1,#abin+3      ;hex->10
08C8 120000   F     1521                                             call    bindec
                    1522     
                    1523                                                     ;если степень полож убирать младший байт
                    1524                                                     ;чтобы уложиться в 5 разрядов, если отриц р
                             асполагать
                    1525                                                     ;число в bufind..bufind+5
08CB 78B8           1526                                             mov             r0,#work
08CD B60021         1527                                             cjne    @r0,#0,outr
08D0 08             1528                                             inc             r0                      ;work+1
08D1 B6FF05         1529                                             cjne            @r0,#0ffh,bufr3         ;6разрядов 
                             нужно вывести 5
08D4 06             1530                                             inc                     @r0;!!!!!!!!!?
08D5 785B           1531                                             mov                     r0,#adec+8;разместить в буф
                             ер индикации R
08D7 8003           1532                                             jmp                     bufr30
                    1533                                             ;;;;;;;;;;;;;;
08D9 06             1534     bufr3:          inc             @r0                     ;?!!!!!!!!n+1
08DA 785C           1535                                                     mov             r0,#adec+9
08DC 7945           1536     bufr30:         mov             r1,#bufind+5;6
08DE 7F05           1537                                             mov             r7,#5;7
08E0 E6             1538     bufr2:                          mov             a,@r0
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    25

08E1 2430           1539                                             add             a,#30h
08E3 F7             1540                                             mov             @r1,a
08E4 19             1541                                             dec             r1
08E5 18             1542                                             dec             r0
08E6 DFF8           1543                                             djnz    r7,bufr2
                    1544     
08E8 784F           1545                                             mov             r0,#abin
08EA 120000   F     1546                                             call            clear4
08ED 78B9           1547                                             mov             r0,#work+1
08EF 801C           1548                                     jmp             outr5
                    1549     ;work!=0 значит после дел на 10**9 получили число > с чем 6 разрядов                       
                                          
08F1 785C           1550     outr:                   mov             r0,#adec+9;разместить в буфер индикации R
08F3 C3             1551                                             clr             c
08F4 79B8           1552                                             mov             r1,#work
08F6 E8             1553                                             mov             a,r0
08F7 14             1554                                             dec             a                                  
                                  ;n-1
08F8 97             1555                                             subb    a,@r1
08F9 F8             1556                                             mov             r0,a                    ;adec+9-n !
                             !!!!!!!!!!!!!!
08FA 7945           1557                                     mov             r1,#bufind+5;т к число разрядов > чем знако
                             мест
08FC 7F05           1558                                             mov             r7,#5;7
08FE E6             1559     bufr:                           mov             a,@r0
08FF 2430           1560                                             add             a,#30h
0901 F7             1561                                             mov             @r1,a
0902 19             1562                                             dec             r1
0903 18             1563                                             dec             r0
0904 DFF8           1564                                             djnz    r7,bufr
                    1565     
0906 784F           1566                                             mov             r0,#abin
0908 120000   F     1567                                             call            clear4
090B 78B8           1568                                     mov             r0,#work
090D E6             1569     outr5:                  mov             a,@r0
090E F552           1570                                             mov             abin+3,a
                    1571                                                                     ;n(hex)->abin
0910 120000   F     1572                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
0913 2552           1573                                             add             a,abin+3
0915 F552           1574                                             mov             abin+3,a
0917 7853           1575                                             mov             r0,#adec
0919 7952           1576                                             mov             r1,#abin+3      ;hex->10
091B 120000   F     1577                                             call    bindec
091E 855C48         1578                                             mov             bufind+8,adec+9
0921 855B47         1579                                             mov             bufind+7,adec+8
0924 754966         1580                                             mov             bufind+9,#66h
0927 020000   F     1581                                             jmp             nobavp;nobitizm;        goonin;call
                                  ind
                    1582                                             
                    1583                                     ;;;;;;;;;;;;;;;;;;;;;
                    1584     ;;;;;;;;;;;;;
                    1585     
092A 300508         1586     mo220:             jnb          bitavp,indoll
092D 301805         1587                                jnb          knizm,indoll;bitizm,indoll
0930 78AE           1588                                     mov             r0,#diap
0932 B6000B         1589                                     cjne    @r0,#0,nodi2
                    1590                                ;10-2
0935 900000   F     1591     indoll:                 mov             dptr,#teOLL;OLL
0938 120000   F     1592                                     call    lotext
093B D217           1593                                     setb    bitoll
093D 020000   F     1594                                     jmp             goonin  
                    1595     
0940 16             1596     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1597     
0941 B6FF01         1598                                     cjne    @r0,#0ffh,nodi9
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    26

0944 06             1599                                     inc             @r0
                    1600     
0945 120000   F     1601     nodi9:          call    loadUS
                    1602                                     ;call   louizm
                    1603                                     ;сбросить массив
0948 120000   F     1604                                     call     clmassix
094B 78B3           1605                                     mov             r0,#summa
094D 120000   F     1606                                     call    clear4
0950 786A           1607                                     mov             r0,#rez_A0
0952 120000   F     1608                                     call    clear4  
0955 D207           1609                                     setb    bitzus;bitbuf   ;флаг задержки  после установки us 
                                                                           
0957 020000   F     1610                                jmp     goonin
                    1611     
095A 16             1612     nochi0:                 dec             @r0                     ;СТИ-1
095B 020000   F     1613                                     jmp             labelB  
                    1614     
                    1615             
                    1616     ;;;;;;;;;;;;;;;
                    1617     
095E                1618     nop3_0: ;;      ;rez_A-rez_A0
                    1619                     ;;                      mov             r0,#rez_A0
                    1620                     ;;                      call    resar8
                    1621                     ;;                      call    lsub
                    1622                     ;;                      mov             r0,#rez_A
                    1623                     ;;;                     call    saver2
                    1624      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
095E 789C           1625      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
0960 120000   F     1626                                             call    resar2
0963 900000   F     1627                                             mov             dptr,#ch100              
0966 120000   F     1628                                             call    ldc_ltemp        
0969 120000   F     1629                                             call    zdiv            ;rez_A3/100=r2..r5
                    1630                                     
096C EC             1631                                             mov             a,r4
096D 20E71E         1632                                             jb              acc.7,aless0
0970 4408           1633                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
0972 F5D3           1634                                             mov             DAC0H,a
                    1635                                                                             ;мл байт
0974 ED             1636                                             mov             a,r5
0975 F5D2           1637                                             mov             DAC0L,a
0977 801E           1638                                             jmp             moveA3;
                    1639     
0979 B70207         1640     no3parN:                        cjne    @r1,#2,no2parN
                    1641                                             ;в байт 0  записать пробел
097C 7946           1642                                             mov             r1,#bufind+6
097E 7720           1643                                             mov             @r1,#" ";0fdh;
0980 020000   F     1644                                             jmp             seeind;moveA3
                    1645     
0983                1646     no2parN:                        ;в байты 0 и 1 записать пробел
0983 7945           1647                                             mov             r1,#bufind+5
0985 7720           1648                                             mov             @r1,#" ";0fdh;" "
0987 09             1649                                             inc             r1
0988 7720           1650                                             mov             @r1,#" ";0fdh;" "
098A 8079           1651                                             jmp             seeind;moveA3
098C 8077           1652      rseeind:               jmp             seeind
098E F4             1653     aless0:                         cpl             a
098F 54F7           1654                                             anl             a,#0f7h         ;d11=0
0991 F5D3           1655                                             mov             DAC0H,a
                    1656                                                                             ;мл байт
0993 ED             1657                                             mov             a,r5
0994 F4             1658                                             cpl             a
0995 F5D2           1659                                             mov             DAC0L,a
0997                1660     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1661                                     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    27

                    1662                                             
0997                1663     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1664                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1665                     ;до конца цикла измерения результат не размещать в буфере
                    1666                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1667                     ;и возврату в режим измерения
0997 201456         1668                                             jb              bitvich,rnorvich
099A 201053         1669                                             jb              bitt2,rnorvich
099D 2017EC         1670                                             jb              bitoll,rseeind
                    1671                                             
09A0 2011E9         1672                                             jb              bitmenu,rseeind
09A3 200BE6         1673                                             jb              bitmem,rseeind
                    1674     ;;;;;;;;;;;;;;
                    1675                                             ; mov           r0,#rez_A3
                    1676                                             ;call   resar2
                    1677                                             ;call   ftol                    ;float->int r2..r5
                    1678     ;;;;;;;;
09A6 789C           1679                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
09A8 120000   F     1680                                             call    resar2;????????????????17.01.07
                    1681                                     
09AB 120000   F     1682                                             call    maform
09AE 784F           1683                                             mov             r0,#abin
09B0 120000   F     1684                                             call    saver2
                    1685     ;;;;;;;;
                    1686                                             
09B3 7853           1687                                             mov             r0,#adec
09B5 7952           1688                                             mov             r1,#abin+3      ;hex->10
09B7 120000   F     1689                                             call    bindec
                    1690                                     
09BA 785C           1691                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
09BC 7946           1692                                             mov             r1,#bufind+6
09BE 7F07           1693                                             mov             r7,#7
09C0 E6             1694     bufdec:                         mov             a,@r0
09C1 2430           1695                                             add             a,#30h
09C3 F7             1696                                             mov             @r1,a
09C4 19             1697                                             dec             r1
09C5 18             1698                                             dec             r0
09C6 DFF8           1699                                             djnz    r7,bufdec
09C8 7847           1700                                             mov             r0,#bufind+7
09CA 762D           1701                                             mov             @r0,#2dh          ;-2..-9
09CC 7840           1702                                             mov             r0,#bufind
09CE 762B           1703                                             mov             @r0,#2bh
09D0 300202         1704                                             jnb             znmat,nozzmi;bitznak,nozzmi
09D3 762D           1705                                             mov             @r0,#2dh
09D5 79AE           1706     nozzmi:                         mov             r1,#diap
09D7 7848           1707                                             mov             r0,#bufind+8
09D9 E7             1708                                             mov             a,@r1
09DA B40808         1709                                             cjne    a,#8,nodi8
09DD 7630           1710                                             mov             @r0,#30h                 ;10-10
09DF 18             1711                                             dec             r0
09E0 7663           1712                                             mov             @r0,#63h;31h
09E2 08             1713                                             inc             r0
09E3 8012           1714                                             jmp             seegoon
09E5 B4090C         1715     nodi8:                          cjne    a,#9,nodis9
                    1716                                     
09E8 7631           1717                                             mov             @r0,#31h           ;10-11
09EA 18             1718                                             dec             r0
09EB 7663           1719                                             mov             @r0,#63h;31h
                    1720                                     
09ED 08             1721                                             inc             r0
09EE 8007           1722                                             jmp             seegoon
                    1723     
09F0 8079           1724     rnorvich:               jmp             norvich
09F2 8085           1725     rno3parN:               jmp             no3parN
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    28

                    1726     
09F4 2432           1727     nodis9:                         add             a,#32h
09F6 F6             1728                                             mov             @r0,a;#37h;"T";
09F7 08             1729     seegoon:                        inc             r0
09F8 7641           1730                                             mov             @r0,#"A";"E";
09FA 08             1731                                             inc             r0
09FB 7600           1732                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
09FD 08             1733                                             inc             r0;             mov             buf
                             ind+11
09FE 7610           1734                                             mov             @r0,#010h               ;bufind+11.
                             4 точка после первой цифры
                    1735                                             
                    1736     ;;;;;;;;;;;;;;;
                    1737     ;;;;;;goonind:
0A00 79AF           1738                                             mov             r1,#parN        ; ??????
0A02 B703ED         1739                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1740             
0A05                1741     seeind:                         ;;;;;;;;;;;;;
0A05 784A           1742                                             mov             r0,#bufind+10
0A07 E6             1743                                             mov             a,@r0
0A08 300F03         1744                                             jnb             bitnul,nnnul
0A0B 4408           1745                                             orl             a,#08h
0A0D F6             1746                                             mov             @r0,a
0A0E 799A           1747      nnnul:         mov             r1,#parT
0A10 B70204         1748                                             cjne    @r1,#2,nsec1
0A13 4420           1749                                             orl             a,#20h    ;1s
0A15 8009           1750                                             jmp             nsec10
0A17 B70104         1751     nsec1:          cjne    @r1,#1,nsec11
0A1A 4440           1752                                             orl             a,#40h                  ;10s
0A1C 8002           1753                                             jmp             nsec10
                    1754                                     
0A1E 4410           1755     nsec11:         orl             a,#10h
                    1756                                                      ;0,1s
                    1757     ;;;;;;;;;;;;;;;;
0A20                1758     nsec10:         
                    1759     
                    1760     
0A20 784A           1761                                             mov             r0,#bufind+10   
0A22 F6             1762                                             mov             @r0,a
0A23 300504         1763                                             jnb             bitavp,nobavp
0A26 4404           1764                                             orl             a,#04           ;bufind+10.2
0A28 F6             1765                                             mov             @r0,a
0A29 F6             1766                                             mov             @r0,a   
0A2A 784A           1767     nobavp:         mov             r0,#bufind+10   
0A2C F6             1768                                             mov             @r0,a   
0A2D 301803         1769                                        jnb          knizm,nobitizm
0A30 4402           1770                                             orl             a,#02
0A32 F6             1771                                              mov            @r0,a
0A33                1772     nobitizm:                       
0A33 301A07         1773                                             jnb             bitakt,notakt
0A36 C21A           1774                                             clr             bitakt
0A38 534AFE         1775                                             anl             bufind+10,#0feh
0A3B 8005           1776                                             jmp             taktind
0A3D D21A           1777     notakt:                         setb    bitakt
0A3F 434A01         1778                                             orl             bufind+10,#01                      
                                          
0A42                1779     taktind:                
                    1780     ;;;;;;;;;
0A42 301517         1781                                             jnb             biteizm,yesind
0A45 79B1           1782                                             mov             r1,#vichR
0A47 7848           1783                                             mov             r0,#bufind+8
0A49 7654           1784                                             mov             @r0,#'T'
0A4B 08             1785                                             inc             r0
0A4C B72104         1786                                             cjne    @r1,#21h,test9i
0A4F 7631           1787                                             mov             @r0,#31h;11A
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    29

                    1788                                     ;       dec             r0
                    1789                                     ;       mov             @r0,#63h
0A51 8009           1790                                             jmp             yesind
0A53 B72204         1791     test9i:         cjne    @r1,#22h,test7i
0A56 7632           1792                                             mov             @r0,#32h;39h;09A
0A58 8002           1793                                             jmp             yesind
0A5A 7633           1794     test7i:         mov             @r0,#33h;37h;07A
                    1795     ;;;;;;;;;
0A5C                1796     yesind:         
0A5C 301203         1797                                             jnb             bitklb,noklb
0A5F 434A80         1798                                             orl             bufind+10,#80h; on kmp
0A62 300A03         1799     noklb:          jnb             bitbon,nobuf
0A65 434B02         1800                                             orl             bufind+11,#02h; on pysk
0A68 120000   F     1801     nobuf:          call    ind        ;пп выдачи на индикатор
0A6B                1802     norvich: 
0A6B 789A           1803                                     mov             r0,# parT
0A6D 79AC           1804                                             mov             r1,#chind
0A6F B60152         1805                                             cjne    @r0,#1,rnot1in
0A72                1806     labelB:                    ;;;;;;;;;;;
                    1807                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
0A72 789F           1808                                                     mov     r0,#rez_A3+3
                    1809                             ;;;;;;;;
0A74 79BB           1810                             mov             r1,#work+3
0A76 E6             1811                             mov             a,@r0
0A77 7F07           1812                             mov             r7,#7;кол сдв вправо
0A79 C3             1813     dvig3:          clr             c
0A7A 13             1814                             rrc             a
0A7B DFFC           1815                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
0A7D FA             1816                             mov             r2,a    ;сохр байт
0A7E 18             1817                             dec             r0              ;rez_A3+2
0A7F E6             1818                             mov             a,@r0
0A80 C0E0           1819                             push    acc
0A82 C3             1820                             clr             c
0A83 7F01           1821                             mov             r7,#1
0A85 C3             1822     dvig2:          clr             c
0A86 33             1823                             rlc             a
0A87 DFFC           1824                             djnz    r7,dvig2 ;d12..d11       средний байт
0A89 4A             1825                             orl             a,r2
0A8A F7             1826                             mov             @r1,a;сформ мл байт
0A8B 19             1827                             dec             r1
0A8C D0E0           1828                             pop             acc
                    1829                             
0A8E 7F07           1830                             mov             r7,#7
0A90 C3             1831     dvig1:          clr             c
0A91 13             1832                             rrc             a
0A92 DFFC           1833                             djnz    r7,dvig1 ;d18     ср байт
0A94 FA             1834                             mov             r2,a   ;сохр
0A95 18             1835                             dec             r0
0A96 E6             1836                             mov             a,@r0 ;rez_A3+1
0A97 C0E0           1837                             push    acc
                    1838                     
0A99 7F01           1839                             mov             r7,#1
0A9B C3             1840     dvig0:          clr             c
0A9C 33             1841                             rlc             a
0A9D DFFC           1842                             djnz    r7,dvig0 ;        d21..d16
0A9F 4A             1843                             orl             a,r2
0AA0 F7             1844                             mov             @r1,a   ; сформ средний  байт
0AA1 19             1845                             dec             r1
0AA2 D0E0           1846                             pop             acc       ;rez_A3+1
                    1847                             ;;;;;;;;;;;;;;
                    1848     ;                       jb              acc.7,dvm
0AA4 C3             1849                             clr             c
0AA5 7F07           1850                             mov             r7,#7
0AA7 C3             1851     dvig4:          clr             c
0AA8 13             1852                             rrc             a
0AA9 DFFC           1853                             djnz    r7,dvig4 ;        d22
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    30

0AAB FA             1854                             mov             r2,a   ;сохр
0AAC 18             1855                             dec             r0;     rez_A3
0AAD E6             1856                             mov             a,@r0
                    1857                             ;;;;;
0AAE 7F01           1858                             mov             r7,#1
0AB0 C3             1859     vig0:           clr             c
0AB1 33             1860                             rlc             a
0AB2 DFFC           1861                             djnz    r7,vig0 ;         d24..d30
0AB4 4A             1862                             orl             a,r2
0AB5 F7             1863                             mov             @r1,a   ; сформ   байт
0AB6 19             1864                             dec             r1
0AB7 E6             1865                             mov             a,@r0
                    1866                             ;;;;;
0AB8 20E70C         1867                             jb              acc.7,dvm
0ABB C3             1868                             clr             c
0ABC 7F07           1869                             mov             r7,#7
0ABE C3             1870     vig4:           clr             c
0ABF 13             1871                             rrc             a
0AC0 DFFC           1872                             djnz    r7,vig4 ;         d
0AC2 8009           1873                             jmp             endsdv
                    1874     
0AC4 020000   F     1875     rnot1in:                jmp             not1in
                    1876     
                    1877     ;;;;;;;;;;;;                                    
0AC7 7F07           1878     dvm:            mov             r7,#7
0AC9 D3             1879     dvig6:          setb            c
0ACA 13             1880                             rrc             a
0ACB DFFC           1881                             djnz    r7,dvig6 ;        d31
0ACD F7             1882     endsdv:         mov             @r1,a
                    1883                                                             
                    1884      ;->work   
                    1885                             
0ACE 900000   F     1886                             mov             dptr,#chzap
0AD1 120000   F     1887                             call     ldc_long
0AD4 78BB           1888                              mov            r0,#work+3
0AD6 120000   F     1889                             call    ladd
0AD9 ED             1890                             mov             a,r5
0ADA F5D5           1891                             mov             DAC1L,a
                    1892                             
0ADC EC             1893                             mov             a,r4
0ADD F5D6           1894                             mov             DAC1H,a
                    1895     
                    1896                                             ;;;;;;;;;;
0ADF 78CF           1897                                             mov                     r0,#chbuf       
0AE1 120000   F     1898                                             call            resar2  
0AE4 900000   F     1899                                             mov                     dptr,#ch_1       
0AE7 120000   F     1900                                             call            ldc_ltemp
0AEA 1201D1         1901                                             call            flsub
0AED 78CF           1902                                             mov                     r0,#chbuf       
0AEF 120000   F     1903                                             call            saver2  
0AF2 900000   F     1904                                             mov                     dptr,#ch_1
0AF5 120000   F     1905                                             call            ldc_ltemp
0AF8 1201D6         1906                                             call            flcmp
                    1907                                             
                    1908                                             
                    1909                                             
0AFB 5009           1910                                             jnc                     rnobuf0
0AFD 200909         1911                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
0B00 200A08         1912                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0B03 020000   F     1913                                             jmp             gocikle
0B06 020000   F     1914     rnobuf0:        jmp             nobuf0
0B09                1915     yesprd: ;передать   A3 в буфер
0B09 8035           1916                                             jmp             goonT
0B0B                1917     yesbuf:         ;записать   A3 в буфер
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    31

0B0B 120000   F     1918                                             call            resa_hl;dptr-
0B0E 120000   F     1919                                             call            loA3_X  ;адрес след ячейки внешн оз
                             у храним
                    1920                                                                             ;в ячейке saven_bl
0B11 120000   F     1921                                             call            save_hl
0B14 78AE           1922                                             mov                     r0,#diap
0B16 E6             1923                                             mov                     a,@r0
0B17 7938           1924                                             mov                     r1,#nblok
0B19 B70104         1925                                             cjne            @r1,#1,nosav1
0B1C F534           1926                                             mov                     sadiap,a
0B1E 8012           1927                                             jmp                     gotostrob
0B20 B70204         1928     nosav1:         cjne            @r1,#2,nosav2
0B23 F532           1929                                             mov                     sadiap2,a
0B25 800B           1930                                     jmp                     gotostrob
0B27 B70304         1931     nosav2:         cjne            @r1,#3,nosav3
0B2A F531           1932                                             mov                     sadiap3,a
0B2C 8004           1933                                     jmp                     gotostrob
0B2E                1934     nosav3:         
0B2E F530           1935                                             mov                     sadiap4,a
0B30 8000           1936                                     jmp                     gotostrob
                    1937     
                    1938                                             ;строб
0B32                1939     gotostrob:
0B32 E586           1940                                     mov             a,P6            ;p6.4=0
0B34 54EF           1941                             anl             a,#0efh
0B36 F586           1942                             mov             P6,a
0B38 00             1943                             nop
0B39 00             1944                             nop
                    1945                                     
0B3A E586           1946                             mov             a,P6                    ;p6.4=1 
0B3C 4410           1947                             orl             a,#10h
0B3E F586           1948                             mov             P6,a                        
0B40 78CD           1949     goonT:                          mov             r0,#interva;high  byte loadr2
0B42 E6             1950                                             mov             a,@r0
0B43 FC             1951                                             mov             r4,a
0B44 08             1952                                             inc             r0
0B45 E6             1953                                             mov             a,@r0
0B46 FD             1954                                             mov             r5,a
0B47 E4             1955                                             clr             a
0B48 FB             1956                                             mov             r3,a
0B49 FA             1957                                             mov             r2,a                            ;r2
                             ..r5-interval(hex)
0B4A 120402         1958                                             call            altof                   ;r2..r5->in
                             terval (float)
                    1959     
0B4D 789A           1960                                                                             mov             r0,
                             #parT
0B4F B60110         1961                                                                     cjne    @r0,#1,nott1
                    1962                                     
0B52 900000   F     1963                                     mov                     dptr,#ch_2       
0B55 120000   F     1964                                     call            ldc_ltemp
0B58 120203         1965     intmul: call            flmul
0B5B 78CF           1966     intmul1:mov                     r0,#chbuf
0B5D 120000   F     1967                                     call            saver2          ;*2
0B60 803D           1968                                     jmp             gocikle
                    1969     
0B62 B60208         1970     nott1:                  cjne    @r0,#2,nott2
0B65 900000   F     1971                                                     mov                     dptr,#ch_10      
0B68 120000   F     1972                                     call            ldc_ltemp
0B6B 80EB           1973                                     jmp                     intmul                             
                                  ;*10
                    1974     
0B6D B60308         1975     nott2:                  cjne    @r0,#3,nott3
0B70 900000   F     1976                                                     mov                     dptr,#ch_2       
0B73 120000   F     1977                                     call            ldc_ltemp
0B76 80E0           1978                                     jmp                     intmul                             
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    32

                                  ;*2
                    1979     
                    1980     
0B78 B60411         1981     nott3:          cjne    @r0,#4,nott4
0B7B 900000   F     1982                                             mov                     dptr,#ch_10      
0B7E 120000   F     1983                                             call            ldc_ltemp       ;/10*4
0B81 1202B7         1984                                             call            fldiv
0B84 900000   F     1985                                             mov                     dptr,#ch_4       
0B87 120000   F     1986                                             call            ldc_ltemp
0B8A 80CC           1987                                             jmp             intmul
                    1988     
0B8C B60508         1989     nott4:          cjne    @r0,#5,nott5
0B8F 900000   F     1990                                                     mov                     dptr,#ch_2       
0B92 120000   F     1991                                             call            ldc_ltemp;*2
0B95 80C1           1992                                             jmp             intmul;T=5
0B97 900000   F     1993     nott5:                  mov                     dptr,#ch_1       
0B9A 120000   F     1994                                     call            ldc_ltemp
0B9D 80B9           1995                                     jmp                     intmul                             
                                  ;*1
                    1996     
                    1997     
0B9F 300708         1998     gocikle:        jnb             bitzus,nofz                     
0BA2 120000   F     1999                             call    z_05s    ;0,5c
0BA5 120000   F     2000                             call    z_05s    ;0,5c
0BA8 C207           2001                             clr     bitzus;bitbuf бит задержки засылки us
0BAA 020000   F     2002     nofz:           jmp     labelA;rebyte
                    2003     
                    2004     
0BAD 80F0           2005     yestt5:         jmp             gocikle
                    2006     
0BAF 78CF           2007     nobuf0:                         mov             r0,#chbuf
0BB1 120000   F     2008                                                             call            resar2
0BB4 900000   F     2009                                                                     mov                     dpt
                             r,#ch_1       
0BB7 120000   F     2010                                     call            ldc_ltemp
0BBA 1201D1         2011                                     call            flsub
0BBD 80E0           2012                                             jmp             gocikle
                    2013     
                    2014     
0BBF B60205         2015     not1in:                         cjne    @r0,#2,not2in
0BC2 7701           2016                                             mov             @r1,#1           ;T=2
0BC4 020000   F     2017                                             jmp     labelB
                    2018     
0BC7 B60305         2019     not2in:                         cjne    @r0,#3,not3in
0BCA 7701           2020                                             mov             @r1,#1;9                ;T=3
0BCC 020000   F     2021                                             jmp     labelB
0BCF 7703           2022     not3in:                         mov             @r1,#3;19
0BD1 020000   F     2023                                             jmp     labelB
                    2024     
                    2025     
                    2026     ;;;;;;;;;;;3.11.06
                    2027     
                    2028     ;;коррекция 0
0BD4 7883           2029     KORnul:         mov             r0,#chdel
0BD6 B60010         2030                             cjne    @r0,#0,nonuldel
                    2031                                     
0BD9 E584           2032                             mov             a,p4                    ;сохр  us
0BDB F536           2033                             mov             saus,a
0BDD E585           2034                             mov             a,p5
0BDF F537           2035                             mov             saus+1,a
                    2036     
0BE1 900000   F     2037                             mov             dptr,#kor0us
0BE4 120000   F     2038                             call    lospus          ;упр слово коррекции 0
0BE7 8018           2039                             jmp             chdelmo
                    2040     
0BE9                2041     nonuldel:       ;cjne   @r0,#7,no4del
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    33

0BE9 B60323         2042                                                     cjne    @r0,#3,no4del
                    2043                             ;рез ->AN
0BEC 7862           2044                             mov             r0,#rez_A;->r2..r5
0BEE 120000   F     2045                             call    resar2
                    2046             
                    2047                                     ;;;;;;;;;;
0BF1 120402         2048                             call    altof           ;r2..r5->float
0BF4 7884           2049                             mov             r0,#kor0_AN;->kor0_AN
0BF6 120000   F     2050                             call    saver2
                    2051                                     
0BF9 E536           2052                             mov             a,saus                  ;восстан исходное упр слово
0BFB F584           2053                             mov             p4,a
0BFD E537           2054                             mov             a,saus+1
0BFF F585           2055                             mov             p5,a            
0C01 7883           2056     chdelmo:        mov             r0,#chdel
0C03 06             2057                             inc             @r0             ;chdel+1
0C04 300A05         2058     llka:   jnb                     bitbon,gotoa
0C07 79CF           2059                             mov                     r1,#chbuf
0C09 120000   F     2060                             call            chdec
0C0C                2061     gotoa:
                    2062     
0C0C 020000   F     2063                             jmp              rebyte
                    2064     
0C0F                2065     no4del:         ;cjne   @r0,#14,chdelmo
0C0F B606EF         2066                                             cjne    @r0,#6,chdelmo
0C12 7600           2067                             mov             @r0,#0          ;chdel
0C14 7898           2068                             mov             r0,#chinkor
0C16 7600           2069                             mov             @r0,#00;1;00;02;600;
0C18 08             2070                             inc             r0
0C19 76C8           2071                             mov             @r0,#0c8h;90h;0c8h;58h;258h
0C1B 120000   F     2072                             call    clmassix;сбросить массив скольз среднего
0C1E 80E4           2073                             jmp              llka;rebyte
                    2074     
                    2075     ;автокалибровка
0C20                2076     autoka:  ;;  mov                r0,#chavt
                    2077                      ;;  call               chcmp
                    2078                      ;;  jz         nulavt
                    2079                     ;;   mov                r1,#chavt
                    2080                     ;;   call               chdec;chavt-1
                    2081                      ;; jmp         rebyte
0C20                2082     nulavt:  ;;;;;
0C20 7883           2083                             mov             r0,#chdel
0C22 B60016         2084                             cjne    @r0,#0,nndelch
0C25 E584           2085                             mov             a,p4                    ;сохр  us
0C27 F536           2086                             mov             saus,a
0C29 E585           2087                             mov             a,p5
0C2B F537           2088                             mov             saus+1,a
                    2089     
0C2D E585           2090                             mov   a,p5
0C2F 4404           2091                             orl             a,#04              ;p5.2=1
0C31 00             2092                             nop
0C32 00             2093                             nop
0C33 543F           2094                             anl             a,#3fh          ;p5.6,p5.7=0
0C35 F585           2095                             mov   p5,a
0C37 06             2096                             inc             @r0
0C38 020000   F     2097                             jmp              rebyte
                    2098     
0C3B B6033D         2099     nndelch:        cjne    @r0,#3,n4delch
                    2100                             ;pez->A+
                    2101                             ;K+=000/(A+-AN)
                    2102                             ;mov            r0,#rez_A;->r2..r5
                    2103                             ;call   resar2
0C3E E577           2104                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0C40 FA             2105                                     mov             r2,a
0C41 E578           2106                                     mov             a,reacp+1
0C43 FB             2107                                     mov             r3,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    34

0C44 E579           2108                                     mov             a,reacp+2
0C46 FC             2109                                     mov             r4,a
0C47 E57A           2110                                     mov             a,reacp+3
0C49 FD             2111                                     mov             r5,a
                    2112                                     ;;;;;;;;;;;;;;;
0C4A 120402         2113                             call    altof                   ;r2..r5->float
0C4D 7888           2114                             mov             r0,#rezAp;->rezAp
0C4F 120000   F     2115                             call    saver2                          
0C52 7884           2116                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0C54 120000   F     2117                             call    resar8                          
0C57 1201D1         2118                             call    flsub           ; r2..r5(A+-AN)
0C5A 120000   F     2119                             call    move28     ;r2..r5->r8..r11
0C5D 900000   F     2120                             mov             dptr,#CH2tho;000->r2..r5 float
0C60 120000   F     2121                             call    ldc_long                
0C63 1202B7         2122                             call    fldiv
0C66 EA             2123                             mov             a,r2
0C67 547F           2124                             anl             a,#7fh
0C69 FA             2125                             mov             r2,a
0C6A 7890           2126                             mov             r0,#koefKp;->koefKp
0C6C 120000   F     2127                             call    saver2
                    2128                       
                    2129                     ;       anl             P5,#0feh                ;p5.0=0 
0C6F E585           2130                     mov             a,P5
0C71 543B           2131                             anl             a,#3bh;acp-
0C73 F585           2132                             mov             P5,a
0C75 7883           2133                             mov             r0,#chdel
0C77 06             2134                             inc             @r0                       ;ch+1
0C78 020000   F     2135                             jmp             rebyte
                    2136     
0C7B B6063F         2137     n4delch:        cjne    @r0,#6,n8delch
                    2138                             ; pez->A-
                    2139                             ;K-=000/(A--AN)
                    2140                     ;       mov     r0,#rez_A;->r2..r5
                    2141                     ;       call    resar2
0C7E E577           2142                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0C80 FA             2143                                     mov             r2,a
0C81 E578           2144                                     mov             a,reacp+1
0C83 FB             2145                                     mov             r3,a
0C84 E579           2146                                     mov             a,reacp+2
0C86 FC             2147                                     mov             r4,a
0C87 E57A           2148                                     mov             a,reacp+3
0C89 FD             2149                                     mov             r5,a
                    2150                                     ;;;;;;;;;;;;;;;
0C8A 120402         2151                             call    altof                   ;r2..r5->float
0C8D 788C           2152                             mov             r0,#rezAm;->rezAm
0C8F 120000   F     2153                             call    saver2                          
0C92 7884           2154                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0C94 120000   F     2155                             call    resar8                          
0C97 1201D1         2156                             call    flsub                   ; r2..r5(A--AN)
0C9A 120000   F     2157                             call    move28                  ;r2..r5->r8..r11
0C9D 900000   F     2158                             mov             dptr,#CH2tho    ;000->r2..r5 float
0CA0 120000   F     2159                             call    ldc_long                
0CA3 1202B7         2160                             call    fldiv
0CA6 EA             2161                             mov             a,r2
0CA7 547F           2162                             anl             a,#7fh
0CA9 FA             2163                             mov             r2,a
0CAA 7894           2164                             mov             r0,#koefKm;->koefKm
0CAC 120000   F     2165                             call    saver2
                    2166                        
0CAF E536           2167                             mov             a,saus                  ;восстан исходное упр слово
0CB1 F584           2168                             mov             p4,a
0CB3 E537           2169                             mov             a,saus+1
0CB5 F585           2170                             mov             p5,a            
0CB7 7883           2171                             mov             r0,#chdel
0CB9 06             2172                             inc             @r0                       ;ch+1
0CBA 020000   F     2173                        jmp    rebyte
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    35

                    2174     
0CBD B6090F         2175     n8delch:        cjne    @r0,#9,n12delch
0CC0 7600           2176                             mov             @r0,#0
0CC2 7981           2177                             mov             r1,#chavt
0CC4 770C           2178                             mov             @r1,#0ch;6;1;
0CC6 09             2179                             inc             r1
0CC7 7780           2180                             mov             @r1,#80h;40h;
0CC9 120000   F     2181                             call   clmassix     ;сбросить массив среднего
0CCC 020000   F     2182                             jmp             rebyte
0CCF 06             2183     n12delch:       inc             @r0
0CD0 020000   F     2184                             jmp             rebyte
                    2185     
                    2186     
                    2187     
                    2188                                 
0CD3 020000   F     2189     rout6:          jmp             out6
0CD6 020000   F     2190     rlabelF:        jmp             labelF  
0CD9 020000   F     2191     rknrazr:        jmp             knrazr  
0CDC 020000   F     2192     rknopt:         jmp             knopt
0CDF 020000   F     2193     rizman:         jmp             izman   
0CE2                2194     keyb1:  ;IE6 
0CE2 75E700         2195                                     mov             EIE2,#00H
0CE5 75AD00         2196                                     mov             P3IF,#00
                    2197                                     
0CE8 C0E0           2198                                     push    acc
0CEA C0D0           2199                                     push    psw
0CEC C000           2200                                     push    rr0
0CEE C001           2201                                     push    rr1
0CF0 C002           2202                                     push    rr2
0CF2 C003           2203                                     push    rr3
0CF4 C004           2204                                     push    rr4
0CF6 C005           2205                                     push    rr5
0CF8 C006           2206                                     push    rr6
0CFA C007           2207                                     push    rr7
                    2208                                     ;clr            bitmig
                    2209                       ;;;;;;;;;;;;;;
0CFC 120000   F     2210                                     call    z_01s;0,1s
0CFF 120000   F     2211                                             call    z_01s
                    2212                                     ;восстан знакоместо при мигании
                    2213                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0D02 78B2           2214                                     mov             r0,#marker
0D04 7440           2215                                     mov             a,#bufind
0D06 26             2216                                     add             a,@r0                   ;a=bufind+marker
0D07 F9             2217                                     mov             r1,a
0D08 A73C           2218                                     mov             @r1,savba
                    2219                                     ;;;;;;;;;;;
0D0A E5B0           2220                             mov             a,p3
0D0C 20E644         2221                                     jb              acc.6,outviR;выход из режима выч R
0D0F E5B0           2222     gout6:                          mov             a,p3
0D11 44FF           2223                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0D13 F5B0           2224                                     mov             p3,a
0D15 E5B0           2225                                     mov             a,p3
0D17 30E6B9         2226                                     jnb             acc.6,rout6             ;error
0D1A 3004B9         2227                                     jnb             bitizm,rlabelF
0D1D 75B0FE         2228                                     mov             p3,#0feh                ;реж IZM
0D20 E5B0           2229                                     mov             a,p3
0D22 30E6BA         2230                                     jnb             acc.6,rizman
                    2231                                     ;;;;;;
0D25 201232         2232                                     jb              bitklb,goklb
0D28 75B0FD         2233                                     mov             p3,#0fdh
0D2B E5B0           2234                                     mov             a,p3
0D2D 30E6A9         2235                                     jnb             acc.6,rknrazr             ;labelC
0D30 75B0FB         2236                                     mov             p3,#0fbh
0D33 E5B0           2237                                     mov             a,p3
0D35 30E655         2238                                     jnb             acc.6,knright           ;->
0D38 75B0F7         2239                                     mov             p3,#0f7h
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    36

0D3B E5B0           2240                                     mov             a,p3
0D3D 30E69C         2241                                     jnb             acc.6,rknopt                    ;T
0D40 75B0EF         2242                                     mov             p3,#0efh
0D43 E5B0           2243                                mov          a,p3
0D45 30E615         2244                                     jnb             acc.6,pyskst                    ;pysk/stop
0D48 75B0DF         2245                                     mov             p3,#0dfh
0D4B E5B0           2246                                     mov             a,p3
0D4D 30E65C         2247                                jnb          acc.6,knvich
0D50 020000   F     2248                                     jmp             izmpaT
                    2249     
0D53 3006B9         2250     outviR: jnb             bitvi11,gout6   
0D56 C214           2251                                     clr             bitvich                         ;выход из р
                             ежима выч R  
0D58 C206           2252                                     clr             bitvi11
                    2253                                     
0D5A 020000   F     2254     goklb:          jmp             out6
                    2255     
0D5D 200A12         2256     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0D60 D20A           2257                                     setb    bitbon  ;уст реж буфер вкл
0D62 79D5           2258                                     mov                     r1,#volume;work         ;обьем блок
                             а
0D64 7700           2259                                     mov                     @r1,#00
0D66 09             2260                                     inc                     r1
0D67 77C7           2261                                     mov                     @r1,#0c7h                       ;32
                             0h/4
0D69 434B02         2262                                     orl             bufind+11,#02h; on pysk
0D6C 120000   F     2263                                     call            ind
0D6F 020000   F     2264                                     jmp             izmpaT
0D72 C20A           2265     bufon:                  clr             bitbon  ;уст реж буфер выкл
0D74 534BFD         2266                                             anl             bufind+11,#0fdh; off pysk
0D77 120000   F     2267                                             call    ind
0D7A 020000   F     2268                                     jmp             izmpaT
                    2269     
0D7D 79B0           2270     tizmri:                 mov             r1,#level
0D7F B70102         2271                                     cjne    @r1,#1,right2
                    2272                                     ;10s->HET
0D82 8004           2273                                     jmp             right3
                    2274     
0D84 07             2275     right2:                 inc             @r1
0D85 120000   F     2276                                     call    lolevT
                    2277                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0D88 120000   F     2278     right3:                 call    ind
0D8B 8078           2279                                     jmp             izmfun
                    2280     
                    2281                             
                    2282                             
0D8D                2283     knright:        
                    2284     
0D8D 79AE           2285                                     mov             r1,#diap
                    2286                             ;перекл диапазон 1 поз вверх сбр массив
0D8F 17             2287                                     dec             @r1
0D90 B7FF04         2288                                     cjne    @r1,#0ffh,diinc
0D93 7700           2289                                     mov             @r1,#0
0D95 806E           2290                                     jmp  izmfun
0D97 120000   F     2291     diinc:                  call     clmassix
0D9A 78B3           2292                                     mov             r0,#summa
0D9C 120000   F     2293                                     call    clear4
0D9F 786A           2294                                     mov             r0,#rez_A0
0DA1 120000   F     2295                                     call    clear4  
0DA4 120000   F     2296                                     call    loadUS
0DA7 805C           2297                                      jmp  izmfun
                    2298     
0DA9 020000   F     2299     vit2_10:                jmp             out6
0DAC                2300     knvich:                 ;12.02.07
0DAC 789A           2301                                             mov                     r0,#parT
0DAE C3             2302                                             clr                     c
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    37

0DAF 7404           2303                                             mov                     a,#4 
0DB1 96             2304                                             subb            a,@r0
0DB2 40F5           2305                                             jc                      vit2_10;не нажимать кнопку 
                             ВЫЧ R T=10ms,2ms
0DB4 200613         2306                               jb            bitvi11,onvich
0DB7 C204           2307                                     clr             bitizm
0DB9 D214           2308                                     setb    bitvich
                    2309                                     
0DBB 78B1           2310                                     mov             r0,#vichR
0DBD 7611           2311                                     mov             @r0,#11h;;????????or 0
                    2312                                     ;ВЫЧИСЛИТЬ
0DBF 900000   F     2313                                     mov     dptr,#teVICH
0DC2 120000   F     2314                                     call    lotext
0DC5 120000   F     2315                                call         z_1s;;;;;;;
0DC8 806C           2316                                     jmp              viout;izmpaT
                    2317     
0DCA C214           2318     onvich:                 clr             bitvich
0DCC 78B1           2319                                     mov             r0,#vichR
0DCE 7600           2320                                     mov             @r0,#0
0DD0 8037           2321                                     jmp              izmpaT
                    2322     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0DD2 301820         2323     louizm:            jnb          knizm,lou
0DD5 79AE           2324                                     mov             r1,#diap
0DD7 C3             2325                                     clr             c
0DD8 7403           2326                                     mov             a,#3
0DDA 97             2327                                     subb    a,@r1
0DDB 5006           2328                                     jnc             lldi23    ;10-2..10-5
                    2329                                     ;10-6..10-11
0DDD E584           2330                                     mov             a,p4
0DDF 54F7           2331                                     anl             a,#0f7h   ;d3
0DE1 F584           2332                                     mov             p4,a
0DE3 E7             2333     lldi23:                 mov             a,@r1
0DE4 6403           2334                                     xrl             a,#3
0DE6 7002           2335                                     jnz             lldi3
0DE8 8005           2336                                     jmp             lldi2   ;10-5
0DEA E7             2337     lldi3:                  mov             a,@r1
0DEB 6402           2338                                     xrl             a,#2            ;
0DED 7006           2339                                     jnz             lou             
0DEF E585           2340     lldi2:                  mov             a,p5            ;10-4
0DF1 4408           2341                                     orl             a,#08
0DF3 F585           2342                                     mov             p5,a
0DF5 22             2343     lou:                    ret
                    2344                               ;;;;;;
0DF6 201807         2345     izman:                  jb              knizm,knizmon
0DF9 D218           2346                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2347                             ;       d3(k5 p4),d3(u5 p5)заслать us
0DFB 120000   F     2348                                     call    louizm 
0DFE 8005           2349                                     jmp             izmfun
0E00 C218           2350     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0E02 120000   F     2351                                     call    loadUS;восстановить us
0E05                2352     izmfun:                 
0E05 D207           2353                                     setb    bitzus;bitbuf
0E07 8000           2354                                     jmp             labelE;;;;;;;;;;;;
                    2355                                     ;;;;;;;;;;;;;;
0E09                2356     izmpaT:
                    2357     ;;;;;;;;;;;;;;;;;
                    2358                     ;       clr             c 
                    2359                     ;       mov             r1,#parN
                    2360     
                    2361                     ;       mov             r0,#diap
                    2362                     ;       mov             a,#6            
                    2363                     ;       subb    a,@r0
                    2364                     ;       jnc             labelE          ;         ;10-2..10-8
                    2365                               
                    2366                     ;       mov             @r1,#2          ;10-9..10-11            
                    2367                     ;       jmp             labelE
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    38

                    2368     
                    2369     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0E09 789A           2370     labelE:                 mov             r0,#parT
0E0B 793D           2371                                     mov             r1,#chkl
0E0D B60108         2372                                     cjne    @r0,#1,izmt2
0E10 7700           2373                                     mov             @r1,#0
0E12 09             2374                                     inc             r1
0E13 7702           2375                                     mov             @r1,#2
0E15 020000   F     2376                                     jmp             out6
0E18 B60208         2377     izmt2:                  cjne    @r0,#2,izmt3
0E1B 7700           2378                                     mov             @r1,#0
0E1D 09             2379                                     inc             r1
0E1E 7714           2380                                     mov             @r1,#20
0E20 020000   F     2381                                     jmp             out6
                    2382     
0E23 7700           2383     izmt3:                  mov             @r1,#0
0E25 09             2384                                     inc             r1
0E26 77C8           2385                                     mov             @r1,#200
0E28 020000   F     2386                                     jmp             out6
                    2387     
                    2388     
                    2389     
                    2390     
0E2B                2391     knopt: ;кнопка T
0E2B C204           2392                                clr          bitizm
0E2D D210           2393                                setb         bitt2
0E2F 79B7           2394                                mov          r1,#load
0E31 7704           2395                                mov          @r1,#4;1s
0E33 120000   F     2396                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2397                     
0E36 793D           2398     viout:          mov             r1,#chkl
0E38 7703           2399                             mov             @r1,#03
0E3A 09             2400                             inc             r1
0E3B 77E8           2401                             mov             @r1,#0e8h               ;1000
0E3D 020000   F     2402                             jmp             out6
                    2403     
0E40                2404     knrazr:          
0E40 C3             2405     labelC:          clr            c
0E41 78AF           2406                             mov             r0,#parN
0E43 799A           2407                             mov             r1,#parT
0E45 7402           2408                             mov             a,#2
0E47 97             2409                             subb    a,@r1
0E48 40BF           2410                             jc              labelE          ;T>2
0E4A B60104         2411                             cjne    @r0,#1,noN1c
0E4D 7602           2412                             mov             @r0,#2          ;N=2
0E4F 80B8           2413                             jmp             labelE
                    2414     
0E51 B60204         2415     noN1c:          cjne    @r0,#2,not_1
0E54 7603           2416                             mov             @r0,#3          ;N=3      ;10-2..10-8
0E56 80B1           2417                             jmp             labelE
                    2418     
0E58                2419     not_10: 
0E58 7601           2420     not_1:          mov             @r0,#1                          ;N=1
0E5A 80AD           2421                             jmp     labelE
                    2422     
0E5C 020000   F     2423     rtizmri:        jmp             tizmri
                    2424     
0E5F 75B0F7         2425     ttout:          mov             p3,#0f7h
0E62 20B6D1         2426                                             jb              p3.6,viout
0E65 D204           2427                                             setb    bitizm;отжатие кнопки t
0E67 C210           2428                                             clr             bitt2
0E69 809E           2429                                             jmp             labelE
0E6B                2430     labelf:                 
0E6B 301037         2431                             jnb             bitt2,nofizm
0E6E 75B0FB         2432                        mov          p3,#0fbh
0E71 E5B0           2433                        mov          a,p3
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    39

0E73 20E6E9         2434                        jb           acc.6,ttout;outF
0E76 79B7           2435                        mov          r1,#load;parT
0E78 B70503         2436                        cjne         @r1,#5,noft1
                    2437                        ;t=10s
0E7B 020000   F     2438                        jmp          out6;ft1izm
                    2439     
0E7E 07             2440     noft1:     inc          @r1;dec         @r1
0E7F 120000   F     2441     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2442                             ;call   ind
0E82 020000   F     2443                     jmp             out6;??????????????/
                    2444     
                    2445                             ;увеличить счетчик задержки клавиатуры
0E85 783D           2446     outF:           mov             r0,#chkl
0E87 7627           2447                             mov             @r0,#27h
0E89 08             2448                             inc             r0
0E8A 7610           2449                             mov             @r0,#10h
0E8C 020000   F     2450                             jmp             out6;out7
                    2451     
0E8F 020000   F     2452     noviR1:         jmp             noviR
0E92 78B1           2453     outvich:        mov                     r0,#vichR
0E94 7600           2454                                             mov                     @r0,#0
0E96 C214           2455                                             clr                     bitvich
0E98 C206           2456                                             clr                     bitvi11
0E9A C211           2457                                             clr                     bitmenu
0E9C D204           2458                                             setb            bitizm
0E9E 78B2           2459                                             mov                     r0,#marker
0EA0 76FF           2460                                             mov                     @r0,#0ffh
0EA2 020000   F     2461                                             jmp                     out6    
                    2462     
0EA5 3014E7         2463     nofizm:         jnb             bitvich,noviR1
0EA8 75B0DF         2464                                                     mov             p3,#0dfh
0EAB 30B6E4         2465                                                     jnb             p3.6,outvich;отжатие кнопки
                              вычR
0EAE 78B1           2466                             mov             r0,#vichR
0EB0 B61110         2467                             cjne    @r0,#11h,no11v6
0EB3 75B0FB         2468                             mov                     p3,#0fbh;->
0EB6 20B6CC         2469                             jb                      p3.6,outF
0EB9 7612           2470                             mov             @r0,#12h                ;11= вычислить
0EBB 900000   F     2471     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0EBE 120000   F     2472                             call    lotext
0EC1 80C2           2473                             jmp             outF
                    2474             
0EC3 B61210         2475     no11v6:         cjne    @r0,#12h,no12v6
0EC6 75B0FB         2476                             mov             p3,#0fbh;->
0EC9 20B6B9         2477                             jb              p3.6,outF
0ECC 7613           2478                             mov             @r0,#13h
0ECE 900000   F     2479                             mov             dptr,#teOUT
0ED1 120000   F     2480                             call    lotext
0ED4 80AF           2481                             jmp             outF
                    2482                     
0ED6 B61310         2483     no12v6:         cjne    @r0,#13h,no13v6
0ED9 75B0FB         2484                                                     mov             p3,#0fbh;->
0EDC 20B6A6         2485                             jb              p3.6,outF
0EDF 7611           2486                             mov             @r0,#11h
0EE1 900000   F     2487                             mov             dptr,#teVICH
0EE4 120000   F     2488                             call    lotext
0EE7 809C           2489                             jmp             outF
                    2490     
                    2491     ;кн -> A= 0000
                    2492     ;кн -> B= +00000
0EE9 75B0FB         2493     no13v6:         mov             p3,#0fbh
0EEC E5B0           2494                             mov             a,p3
0EEE 20E635         2495                             jb              acc.6,chanZ
0EF1 E53B           2496                             mov             a,movrig
0EF3 B40714         2497                             cjne    a,#7,kon_B      
0EF6 78B2           2498                             mov             r0,#marker      ;A= 0000
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    40

0EF8 B60716         2499                             cjne    @r0,#7,mark0_8          ;курсор справа ?
0EFB E53A           2500     rikn:           mov             a,movleft
0EFD F6             2501                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2502     ;                               29.12.06
                    2503     ;;;;;;;;;;;;;;;;;;
                    2504     ;необходимо не портить цифру в следуюем справа знакоместе
                    2505     ;т е сохранить ее в ячейке для мигания в противном случае
                    2506     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2507     ;       знакоместа
0EFE 78B2           2508                                     mov             r0,#marker
0F00 7440           2509                                     mov             a,#bufind
0F02 26             2510                                             add             a,@r0                   ;a=bufind+m
                             arker
0F03 F9             2511                                             mov             r1,a
0F04 09             2512                                             inc             r1
0F05 873C           2513                                             mov             savba,@r1
0F07 020000   F     2514                                     jmp             outF
                    2515     
0F0A 78B2           2516     kon_B:          mov             r0,#marker      ;B= +00000
0F0C B60802         2517                                             cjne    @r0,#8,mark0_8          ;курсор справа ?
0F0F 80EA           2518                                             jmp             rikn
0F11                2519     mark0_8:
                    2520     ;                               29.12.06
                    2521     ;;;;;;;;;;;;;;;;;;
                    2522     ;необходимо не портить цифру в следуюем справа знакоместе
                    2523     ;т е сохранить ее в ячейке для мигания в противном случае
                    2524     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2525     ;       знакоместа ->B=+00000
0F11 78B2           2526                                             mov             r0,#marker
0F13 7440           2527                                     mov             a,#bufind
0F15 26             2528                                             add             a,@r0                   ;a=bufind+m
                             arker
0F16 F9             2529                                             mov             r1,a
0F17 09             2530                                             inc             r1
0F18 873C           2531                                             mov             savba,@r1
0F1A 78B2           2532                             mov             r0,#marker
0F1C 06             2533                             inc             @r0             ;       сдвинуть курсор вправо на 1
0F1D C219           2534                             clr             bitmig
0F1F B60901         2535                             cjne    @r0,#9,outma
0F22 18             2536                             dec             r0;ppp
0F23 020000   F     2537     outma:          jmp             outF
                    2538     
0F26 75B0FE         2539     chanZ:          mov             p3,#0feh
0F29 E5B0           2540                             mov             a,p3
0F2B 20E611         2541                             jb              acc.6,chanma
                    2542                             ;изм знак в старшем разряде на противоположн
0F2E E543           2543                             mov             a,bufind+3
0F30 B42B06         2544                             cjne            a,#2bh,noplus
0F33 75432D         2545                             mov                     bufind+3,#2dh           ;+->-   
0F36 020000   F     2546                             jmp             outF
0F39                2547     noplus:
0F39 75432B         2548                             mov                     bufind+3,#2bh           ;-/+-
0F3C 020000   F     2549                             jmp             outF
0F3F 75B0FD         2550     chanma:         mov             p3,#0fdh
0F42 E5B0           2551                             mov             a,p3
0F44 20E603         2552                             jb              acc.6,outFl;labelL1
                    2553                             ;clr            bitmig
0F47 120000   F     2554     labelL1:        call    vvchibl;f       ;увеличить цифру 
                    2555     
0F4A 020000   F     2556     outFl:                  jmp             outF
                    2557                     
0F4D                2558     nor11:          ;       выход
0F4D 7613           2559                     mov             @r0,#13h  ;12->13
0F4F 900000   F     2560                     mov             dptr,#teOUT
                    2561     ;               jmp             vi1113
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    41

                    2562     
                    2563     ;;;;;;;;;кнопка -> в режиме кнопки меню
                    2564     
                    2565     
                    2566     
0F52 020000   F     2567     rlabelL:        jmp                     labelL
                    2568     ;findmem:               jmp             out6
0F55 30117E         2569     noviR:          jnb                     bitmenu,findmem;17.01.07
                    2570     ;;;;;;;;;;;;;
0F58 78B1           2571                                             mov                     r0,#vichR
0F5A 7415           2572                                             mov                     a,#15h
0F5C C3             2573                                             clr                     c
0F5D 96             2574                                             subb            a,@r0
0F5E 4016           2575                                             jc                      ri21_23
                    2576     
0F60 75B0FB         2577                                             mov             p3,#0fbh; реж кн меню ->
0F63 20B60A         2578                                             jb              p3.6,ri6
0F66 78B1           2579                                             mov             r0,#vichR
0F68 B61508         2580                                             cjne    @r0,#15h,norime
0F6B 7611           2581                                             mov             @r0,#11h
0F6D 120000   F     2582     norime1:        call            lomenu
0F70 020000   F     2583     ri6:                    jmp             out6
0F73 06             2584     norime:         inc             @r0
0F74 80F7           2585                                             jmp             norime1
                    2586             
0F76 7423           2587     ri21_23:        mov                     a,#23h          ;->
0F78 C3             2588                                             clr                     c
0F79 96             2589                                             subb            a,@r0
0F7A 4014           2590                                             jc                      ri_31
0F7C 75B0FB         2591                                             mov                     p3,#0fbh
0F7F 20B6EE         2592                                             jb                      p3.6,ri6
0F82 B62308         2593                                             cjne            @r0,#23h,no23ri
0F85 7621           2594                                             mov                     @r0,#21h
0F87 120000   F     2595                                             call            lomenu
0F8A 020000   F     2596                                             jmp                     out6
0F8D 06             2597     no23ri:         inc                     @r0
0F8E 80DD           2598                                             jmp                     norime1
0F90 B63125         2599     ri_31:          cjne            @r0,#31h,no31ri;->19.2->57.6->19.2
0F93 301311         2600                                             jnb                     bitv19,gosk19
0F96 900000   F     2601                                             mov                     dptr,#teS57_6;57,6
0F99 120000   F     2602                                             call            lotext
0F9C 534B03         2603                                             anl                     bufind+11,#03h
0F9F 434B80         2604                                             orl                     bufind+11,#80h
0FA2 C213           2605                                             clr                     bitv19
0FA4 020000   F     2606                                             jmp             out6
0FA7 900000   F     2607     gosk19:         mov                     dptr,#teS19_2
0FAA 120000   F     2608                                             call            lotext
0FAD 534B03         2609                                             anl                     bufind+11,#03h
0FB0 434B80         2610                                             orl                     bufind+11,#80h
0FB3 D213           2611                                             setb            bitv19
0FB5 020000   F     2612                                             jmp                     out6
                    2613     
                    2614     
                    2615     
                    2616     ;labelS2:       jmp                     out6
                    2617     
0FB8 7452           2618     no31ri:         mov                     a,#52h;42h              ;->
0FBA C3             2619                                             clr                     c
0FBB 96             2620                                             subb            a,@r0
0FBC 40B2           2621                                             jc                      ri6
0FBE 75B0FB         2622                                             mov                     p3,#0fbh                   
                                  ;41,42
0FC1 30B609         2623                                             jnb                     p3.6,rlabelN    ;кнопка ->(
                             пароль 000)
0FC4 75B0FD         2624                                             mov                     p3,#0fdh
0FC7 20B6A6         2625                                             jb                      p3.6,ri6
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    42

0FCA 020000   F     2626                                             jmp             labelL1                            
                                  ;кнопка 0..9  (пароль 000)
0FCD 020000   F     2627     rlabelN:                jmp             labelN
0FD0 020000   F     2628     moutF:          jmp             outF
                    2629     ;;;;;;;;;;;;;;;;;;;;;;;;;
0FD3 020000   F     2630     rnnmemb:        jmp             nnmemb
                    2631     
0FD6                2632     nbimenu:
0FD6 300BFA         2633     findmem:        jnb             bitmem,rnnmemb
0FD9 79B0           2634                             mov             r1,#level                                          
                                          ;-> кн ПАМЯТЬ (ОЧИСТКА ->ЗАПИСЬ-> ПРОСМОТР)
0FDB B71113         2635                        cjne         @r1,#11h,nomem11
                    2636                        
0FDE 75B0FB         2637                        mov          p3,#0fbh
0FE1 E5B0           2638                        mov          a,p3
0FE3 20E6EA         2639                        jb           acc.6,moutF
0FE6 7712           2640                        mov          @r1,#12h
0FE8 900000   F     2641                        mov          dptr,#teWR      ;                       ЗАПИСЬ
0FEB 120000   F     2642                        call         lotext
0FEE 020000   F     2643                        jmp          outF
                    2644     
0FF1 B71213         2645     nomem11:   cjne         @r1,#12h,nomem12
0FF4 75B0FB         2646                             mov             p3,#0fbh
0FF7 E5B0           2647                        mov          a,p3
0FF9 20E6D4         2648                        jb           acc.6,moutF
0FFC 7713           2649                        mov          @r1,#13h
0FFE 900000   F     2650                        mov          dptr,#teLIST            ;ПРОСМОТР
1001 120000   F     2651                        call         lotext
1004 020000   F     2652                        jmp          outF
1007 B71313         2653     nomem12:         cjne           @r1,#13h,nomem13
100A 75B0FB         2654                                             mov             p3,#0fbh
100D E5B0           2655                        mov          a,p3
100F 20E6BE         2656                        jb           acc.6,moutF
1012 7714           2657                        mov          @r1,#14h
1014 900000   F     2658                        mov          dptr,#teSTAT                    ;СТАТИСТИКА
1017 120000   F     2659                        call         lotext
101A 020000   F     2660                          jmp                outF
                    2661                             
101D B71413         2662     nomem13:cjne            @r1,#14h,labelL
1020 75B0FB         2663                             mov             p3,#0fbh
1023 E5B0           2664                        mov          a,p3
1025 20E6A8         2665                        jb           acc.6,moutF
1028 7711           2666                        mov          @r1,#11h
102A 900000   F     2667                        mov          dptr,#teCLE                     ;ОЧИСТКА
102D 120000   F     2668                        call         lotext
1030 020000   F     2669                          jmp                outF
1033                2670     labelL: 
                    2671                             ;ПОЛНАЯ->БЛОК 00(level 21->22) 
1033 78B0           2672                                     mov                     r0,#level
1035 B6210E         2673                                     cjne            @r0,#21h,nobl21
1038 7622           2674                                     mov                     @r0,#22h                ;->БЛОК 
103A 900000   F     2675                                     mov                     dptr,#teBL
103D 120000   F     2676     me21_22:call            lotext
                    2677                             
1040 120000   F     2678                                     call            z_05s;задержка чтобы не проскакивала пргр н
                             а следующий уровень
1043 020000   F     2679                                     jmp                     outF
                    2680     
1046 B62207         2681     nobl21: cjne            @r0,#22h,nobl22
1049 900000   F     2682                                     mov                     dptr,#teFULL
104C 7621           2683                                     mov                     @r0,#21h                ;->ПОЛНАЯ
                    2684     
104E 80ED           2685                                     jmp                     me21_22
                    2686     
                    2687     ;labl21:           cjne @r0,#21h,nolev1
                    2688     ;                       mov             p3,#0fbh
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    43

                    2689     ;                       mov             a,p3
                    2690     ;                       jb              acc.6,loutF
                    2691     ;                       cjne    @r0,#21h,labl22
                    2692     ;                       mov             @r0,#22h
                    2693                             ;БЛОК
                    2694     ;                       call    lotext
                    2695     ;                       jmp             outF
                    2696     ;labl22:                mov             @r0,#21h
                    2697                             ;ПОЛНАЯ
                    2698     ;                       call    lotext
                    2699     ;                       jmp             outF
                    2700                      
1050 B62325         2701     nobl22:         cjne    @r0,#23h,go31l
1053 75B0FB         2702     rigblo:         mov             p3,#0fbh
1056 20B629         2703                                             jb              p3.6,llev2
1059                2704     labL2:    ;  уст курсор в правую позицию 
                    2705                                     ;       кнопка                  ->
                    2706     ;;;;;;;;;;;;;;;;;;
                    2707     ;необходимо не портить цифру в следуюем справа знакоместе
                    2708     ;т е сохранить ее в ячейке для мигания в противном случае
                    2709     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2710     ;       знакоместа
1059 78B2           2711                                             mov             r0,#marker
105B 7440           2712                                     mov             a,#bufind
105D 26             2713                                             add             a,@r0                   ;a=bufind+m
                             arker
105E F9             2714                                             mov             r1,a
105F 09             2715                                             inc             r1
1060 873C           2716                                             mov             savba,@r1
1062 C219           2717                                             clr             bitmig
                    2718     ;;;;;;;;;;;;;;;;
1064 78B2           2719                       mov           r0,#marker      ;курсор справа  ?
1066 E53B           2720                             mov             a,movrig
1068 C3             2721                             clr             c
1069 96             2722                             subb    a,@r0
106A 6006           2723                             jz         equ1l
106C E53B           2724                             mov             a,movrig;уст в правую позицию
106E F6             2725                             mov             @r0,a
106F 020000   F     2726                             jmp             outF                                     
1072 E53A           2727     equ1l:          mov             a,movleft;уст в левую позицию
1074 F6             2728                             mov             @r0,a   
1075 020000   F     2729     loutF:  jmp             outF
                    2730                     
                    2731     
1078 B63102         2732     go31l:          cjne    @r0,#31h,go41l
107B 80D6           2733                             jmp             rigblo
107D B6410B         2734     go41l:          cjne    @r0,#41h,norig2
1080 80D1           2735                             jmp             rigblo
                    2736     
1082 75B0FD         2737     llev2:          mov             p3,#0fdh
1085 20B6ED         2738                             jb              p3.6,loutF
1088 020000   F     2739                             jmp             labelL1
                    2740     
                    2741     ;->
108B C3             2742     norig2:    clr          c               ;32,33,34,42
108C 7431           2743                             mov             a,#31h
108E 96             2744                             subb    a,@r0
108F 50E4           2745                             jnc             loutF
1091 75B0FB         2746     rigblok:        mov             p3,#0fbh  ;32,33,34,42
1094 20B626         2747                             jb              p3.6,lev2go
1097                2748     labelN: 
                    2749                             ;                               29.12.06
                    2750     ;;;;;;;;;;;;;;;;;;
                    2751     ;необходимо не портить цифру в следуюем справа знакоместе
                    2752     ;т е сохранить ее в ячейке для мигания в противном случае
                    2753     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    44

                    2754     ;       знакоместа
1097 78B2           2755                                             mov             r0,#marker
1099 7440           2756                                     mov             a,#bufind
109B 26             2757                                             add             a,@r0                   ;a=bufind+m
                             arker
109C F9             2758                                             mov             r1,a
109D 09             2759                                             inc             r1
109E 873C           2760                                             mov             savba,@r1
                    2761     ;;;;;;;;;;;;;;;;;;;
10A0 78B2           2762                             mov             r0,#marker      ;курсор справа  ?
10A2 E53B           2763                             mov             a,movrig
10A4 C3             2764                             clr             c
10A5 96             2765                             subb    a,@r0
10A6 7006           2766                             jnz        noequ1
10A8 E53A           2767                             mov             a,movleft;уст в крайнюю левую позицию
10AA F6             2768                             mov             @r0,a
10AB 020000   F     2769                             jmp             outF
10AE                2770     noequ1: ;29.12.06
                    2771     ;;;;;;;;;;;;;;;;;;
                    2772                             ;восстан знакоместо при мигании
                    2773                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
10AE 78B2           2774                                     mov             r0,#marker
10B0 7440           2775                                     mov             a,#bufind
10B2 26             2776                                     add             a,@r0                   ;a=bufind+marker
10B3 F9             2777                                     mov             r1,a
                    2778                                     ;mov            @r1,savba
10B4 09             2779                                     inc             r1
10B5 873C           2780                                     mov             savba,@r1
                    2781     ;;;;;;;;;;;;;;;;        
10B7 120000   F     2782                             call    marri;уст сдвиг в правую        позицию
10BA 020000   F     2783                             jmp             outF
10BD 75B0FD         2784     lev2go:         mov             p3,#0fdh
10C0 30B603         2785                             jnb             p3.6,rlabelL1
10C3 020000   F     2786                             jmp             outF
                    2787     
10C6 020000   F     2788     rlabelL1:       jmp             labelL1
                    2789     
10C9                2790     nnmemb:
                    2791                                     
                    2792     
                    2793     
10C9                2794     norim6:    ;kn menu
10C9                2795     out6:           
10C9 D007           2796                                     pop             rr7     
10CB D006           2797                                     pop             rr6
10CD D005           2798                                     pop             rr5
10CF D004           2799                                     pop             rr4
10D1 D003           2800                                     pop             rr3
10D3 D002           2801                                     pop             rr2
10D5 D001           2802                                     pop             rr1                             
10D7 D000           2803                                     pop             rr0
10D9 D0D0           2804                                     pop             psw
10DB D0E0           2805                                     pop             acc
                    2806     ;clr            bitmig
                    2807                               ; mov         EIE2,#30H
                    2808                              ;  mov         a,P3IF
                    2809                             ;       anl             a,#0bfh
                    2810                             ;       mov             P3IF,a
                    2811                             ;       mov             P3,#0c0h
                    2812                             ;;;;;;
10DD 75AD00         2813                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
10E0 75B0C0         2814                             mov             P3,#0c0h
10E3 C219           2815                             clr             bitmig
10E5 E586           2816                                             mov             a,P6            ;p6.4=0
10E7 54EF           2817                             anl             a,#0efh
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    45

10E9 F586           2818                             mov             P6,a
10EB 00             2819                             nop
10EC 00             2820                             nop
                    2821                                     
10ED E586           2822                             mov             a,P6                    ;p6.4=1 
10EF 4410           2823                             orl             a,#10h
10F1 F586           2824                             mov             P6,a                        
10F3 32             2825                             reti
                    2826     
10F4 020000   F     2827     rknMEM:                 jmp             knMEM
10F7 020000   F     2828     knKMP:             jmp          out7
10FA 020000   F     2829     rout7:                  jmp             out7    
10FD 020000   F     2830     rlabelH:                jmp             labelH
1100 020000   F     2831     rknNUL:         jmp             knNUL
1103 020000   F     2832     rknleft:                jmp             knleft
1106                2833     keyb2:  ;IE7
1106 75E700         2834                                     mov             EIE2,#00H
1109 75AD00         2835                                     mov             P3IF,#00
                    2836     
110C C0E0           2837                                     push    acc
110E C0D0           2838                                     push    psw
1110 C000           2839                                     push    rr0
1112 C001           2840                                     push    rr1
1114 C002           2841                                     push    rr2
1116 C003           2842                                     push    rr3
1118 C004           2843                                     push    rr4
111A C005           2844                                     push    rr5
111C C006           2845                                     push    rr6
111E C007           2846                                     push    rr7
1120 C082           2847                                     push    dpl
1122 C083           2848                                     push    dph
                    2849                                     ;clr            bitmig
                    2850                       ;;;;;;;;;;;;;;
1124 120000   F     2851                               call  z_01s   ;0,1s
                    2852                               ;восстан знакоместо при мигании
                    2853                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
1127 78B2           2854                                     mov             r0,#marker
1129 7440           2855                                     mov             a,#bufind
112B 26             2856                                     add             a,@r0                   ;a=bufind+marker
112C F9             2857                                     mov             r1,a
112D A73C           2858                                     mov             @r1,savba
                    2859                                     ;;;;;;;;;;;
                    2860     
112F E5B0           2861                             mov             a,p3
1131 20E7C6         2862                                     jb              acc.7,rout7
1134 E5B0           2863                                     mov             a,p3
1136 74FF           2864                                     mov             a,#0ffh         ; p3.(5-0)<-3f
1138 F5B0           2865                                     mov             p3,a
113A E5B0           2866                                     mov             a,p3
113C 30E7BB         2867                                     jnb             acc.7,rout7             ;error
113F 3004BB         2868                                     jnb             bitizm,rlabelH
1142 75B0FE         2869                                     mov             p3,#0feh                ;реж IZM
1145 E5B0           2870                                     mov             a,p3
1147 30E7B6         2871                                     jnb             acc.7,rknNUL
114A 75B0FD         2872                                     mov             p3,#0fdh
114D E5B0           2873                                     mov             a,p3
114F 30E7A5         2874                                     jnb             acc.7,knKMP
1152 75B0FB         2875                                     mov             p3,#0fbh
1155 E5B0           2876                                     mov             a,p3
1157 30E7A9         2877                                     jnb             acc.7,rknleft
115A 75B0F7         2878                                     mov             p3,#0f7h
115D E5B0           2879                                     mov             a,p3
115F 30E75E         2880                                     jnb             acc.7,knAVP
1162 75B0EF         2881                                 mov         p3,#0efh
1165 E5B0           2882                                     mov             a,p3
1167 30E78A         2883                                     jnb             acc.7,rknMEM
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    46

116A 75B0DF         2884                                     mov             p3,#0dfh
116D E5B0           2885                                     mov             a,p3    
116F 30E722         2886                                     jnb             acc.7,knmenu
1172                2887     an_t7:             ;;;;;;;;;;;;
                    2888                     
                    2889     ;       clr             c
                    2890     ;       mov             r1,#parN
                    2891     ;
                    2892     ;                       mov             r0,#diap
                    2893     ;                       mov             a,#6            
                    2894     ;                       subb    a,@r0
                    2895     ;                       jnc             goto7           ;         ;10-2..10-8
                    2896                               
                    2897     ;                       mov             @r1,#2          ;10-9..10-11            
                    2898                             
                    2899                             ;;;;;;;;;;;;
1172 799A           2900     goto7:                  mov             r1,#parT
1174 783D           2901                                     mov             r0,#chkl
1176 B70108         2902                                     cjne    @r1,#1,not1_7
1179 7600           2903                                     mov             @r0,#00
117B 08             2904                                     inc             r0
117C 7602           2905                                     mov             @r0,#2
117E 020000   F     2906                                     jmp             out7
                    2907                             
                    2908     
1181 B70208         2909     not1_7:                 cjne    @r1,#2,not2_7
1184 760E           2910                                             mov             @r0,#0eh;00
1186 08             2911                                     inc             r0
1187 7638           2912                                     mov             @r0,#38h;20
1189 020000   F     2913                                     jmp             out7
118C 7600           2914     not2_7:                 mov             @r0,#00
118E 08             2915                                     inc             r0
118F 76C8           2916                                     mov             @r0,#200
1191 020000   F     2917     merr:           jmp             out7
                    2918     
                    2919     
1194 2006FA         2920     knmenu: jb              bitvi11,merr
1197 201514         2921                                     jb              biteizm,menuoff
119A C204           2922                              clr            bitizm          ;off IZM
119C D211           2923                                     setb            bitmenu
119E 900000   F     2924                                     mov             dptr,#teTESI    ;в буф2 записать ТЕСТ-ИЗМЕР
11A1 120000   F     2925                                     call    lotext
11A4 534B03         2926                                     anl                     bufind+11,#03h ;погасить запятые
11A7 78B1           2927                                     mov             r0,#vichR
11A9 7611           2928                                     mov             @r0,#11h
11AB 020000   F     2929                                     jmp             onmem11
11AE                2930     menuoff:
11AE 78B1           2931                                     mov             r0,#vichR
11B0 7600           2932                                     mov             @r0,#00
11B2 C215           2933                                     clr             biteizm
11B4 120000   F     2934                                     call    loadus
11B7 020000   F     2935                                     jmp             out7
11BA 75EF10         2936                                     mov             RSTSRC,#10h
                    2937                                     ;jmp            begin;onmem11
                    2938     
11BD 020000   F     2939     rendkalib:              jmp             endkalib
                    2940     
11C0 2012FA         2941     knAVP:  jb              bitklb,rendkalib        
11C3 200505         2942                                     jb              bitavp,meavp
11C6 D205           2943                                     setb    bitavp
11C8 020000   F     2944                                     jmp             onmem11
11CB C205           2945     meavp:                  clr             bitavp
11CD 020000   F     2946                                     jmp             onmem11
                    2947     
11D0 201207         2948     knleft: jb              bitklb,lefkl
                    2949                                     ;;;;;;;;
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    47

11D3 79AE           2950                                mov          r1,#diap
11D5 07             2951                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
11D6 B70A03         2952                                     cjne    @r1,#0ah,nodi6
11D9 17             2953                                     dec             @r1
11DA 8096           2954     lefkl:  jmp             an_t7
                    2955     
11DC                2956     nodi6:             ;    cjne    @r1,#0,an_t7
11DC 120000   F     2957                                      call    clmassix
11DF 78B3           2958                                     mov             r0,#summa
11E1 120000   F     2959                                     call    clear4  
11E4 786A           2960                                     mov             r0,#rez_A0
11E6 120000   F     2961                                     call    clear4  
11E9 120000   F     2962                                     call    loadUS
11EC 8084           2963                                jmp          an_t7
                    2964     
11EE 200F0F         2965     knNUL:                  jb              bitnul,ybnul
11F1 D20F           2966                                     setb    bitnul
11F3 789C           2967                                     mov             r0,#rez_A3      ;A3
11F5 120000   F     2968                                     call    resar2
11F8 786A           2969                                     mov             r0,#rez_A0      
11FA 120000   F     2970                                     call    saver2;A0<-A3
11FD 020000   F     2971                                     jmp             goto7;an_t7
                    2972     
1200 C20F           2973     ybnul:                  clr             bitnul
1202 900000   F     2974                                      mov    DPTR,#ch0 
1205 120000   F     2975                                     CALL   ldc_long          ; r2..r5 <-- 0
1208 786A           2976                                     mov             r0,#rez_A0      ;A0=0
120A 120000   F     2977                                     call    saver2
120D 020000   F     2978                                     jmp             goto7;an_t7
                    2979     
1210 301021         2980     labelH:                 jnb             bitt2,nolah
1213 75B0FB         2981                                     mov             p3,#0fbh   ;вход в режим изм Т
1216 534A8F         2982                                     anl             bufind+10,#8fh
1219 79B7           2983                                     mov             r1,#load;parT
121B 20B70D         2984                                     jb              p3.7,rhnot1
121E B70003         2985                                     cjne    @r1,#0,inct;
1221 020000   F     2986                                     jmp             out7;hyest6
1224 17             2987     inct:                   dec             @r1                     ;Tизм+1
                    2988                             
1225 120000   F     2989                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
1228                2990     hnot2:          ;       call    ind
1228 020000   F     2991                                     jmp             out7
                    2992     
122B 020000   F     2993      rhnot1:                jmp             hnot1
                    2994      ;rnoviR:       jmp             noviR
122E 020000   F     2995      rlabelK:       jmp             labelK
1231 020000   F     2996      rlabelI:       jmp             labelI          
                    2997      ;;;;;;;;;;;;;;;;;;;
1234 3014F7         2998     nolah:          jnb             bitvich,rlabelK 
                    2999                                     
                    3000                             ;;;;;;
                    3001                             ;увеличить счетчик задержки клавиатуры
                    3002                     ;;              mov             r0,#chkl
                    3003                     ;;              mov             @r0,#27h
                    3004                     ;;              inc             r0
                    3005                     ;;              mov             @r0,#10h
                    3006                             ;;;;;;
                    3007     
1237 78B1           3008                             mov             r0,#vichR
1239 B61128         3009                             cjne    @r0,#11h,rhnor11;rlabelI;;
123C 75B0FB         3010                             mov             p3,#0fbh   ;<-
123F 20B730         3011                             jb              p3.7,noh37;routF
1242 B6110B         3012                     cjne    @r0,#11h,hr12
1245 7613           3013                             mov             @r0,#13h        ;11= вычислить
1247 900000   F     3014                             mov             dptr,#teOUT;teVICH
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    48

124A 120000   F     3015     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
124D 020000   F     3016                             jmp             goto7;outF
1250 B61207         3017     hr12:           cjne    @r0,#12h,hnor12
1253 7611           3018     lovich:         mov             @r0,#11h
1255 900000   F     3019                             mov             dptr,#teVICH
1258 80F0           3020                             jmp             hvi1113         
125A B61307         3021     hnor12:         cjne    @r0,#13h,rhnor11
125D 7612           3022     loizmk:         mov             @r0,#12h
125F 900000   F     3023                             mov             dptr,#teIZMK    ;       изм конст
                    3024                                        
1262 80E6           3025                             jmp             hvi1113
                    3026     
1264 804C           3027     rhnor11:                jmp             hnor11
                    3028     
1266 8057           3029     rvvizko:                jmp             vvizko
1268 C214           3030     vioutF:                 clr             bitvich
126A C206           3031                                                     clr             bitvi11
126C 020000   F     3032                                                     jmp             outF
126F 020000   F     3033     toutF:                  jmp     outF
                    3034     
1272 75B0F7         3035     noh37:          mov             p3,#0f7h
1275 20B7F7         3036                             jb              p3.7,toutF;vioutF
1278 B611EB         3037                             cjne    @r0,#11h,rvvizko
127B D206           3038                             setb    bitvi11    ;нажат ввод ВЫЧИСЛИТЬ
127D D204           3039              setb   bitizm
127F 534B07         3040                              anl            bufind+11,#07h
1282 434B10         3041                              orl            bufind+11,#10h;точка после 1 знакоместа
1285 020000   F     3042     routF:          jmp             out7;goto7;outF
                    3043     
                    3044     
                    3045     
1288 80E8           3046     rnoh37:         jmp             noh37
                    3047     
128A B6120D         3048     norr11:         cjne    @r0,#12h,norr12
128D 75B0FB         3049                             mov             p3,#0fbh   ;<-
1290 20B7F5         3050                             jb              p3.7,rnoh37;routF
1293 760B           3051                             mov             @r0,#11;12->11
1295 80BC           3052                             jmp             lovich
                    3053     
1297 020000   F     3054     labelI2:                jmp             labelI
129A B613FA         3055     norr12:         cjne    @r0,#13h,labelI2
129D 75B0FB         3056                             mov             p3,#0fbh   ;<-
12A0 20B7E5         3057                             jb              p3.7,rnoh37
12A3 7612           3058                             mov             @r0,#12h
12A5 80B6           3059                             jmp             loizmk
                    3060                             ;;;;
12A7 C214           3061     clrvich:                clr             bitvich
12A9 D204           3062                             setb    bitizm
12AB A8B2           3063                             mov             r0,marker
12AD 76FF           3064                             mov             @r0,#0ffh
12AF 020000   F     3065                              jmp    goto7;  routF
                    3066     
                    3067     ;rnoh37:                jmp             noh37
                    3068      ;ввод изм конст
12B2 B612E5         3069     hnor11:         cjne    @r0,#12h,norr12;clrvich
12B5 75B0FB         3070                              mov            p3,#0fbh   
12B8 20B7CD         3071                             jb              p3.7,rnoh37;lovich;;изм конст <-  выч
12BB 7611           3072                             mov             @r0,#11h
12BD 8094           3073                             jmp             lovich
                    3074     
12BF 78B1           3075     vvizko:         mov             r0,#vichR
12C1 E6             3076                             mov             a,@r0
                    3077                     ;       cjne    @r0,#12h,clrvich
12C2 B412E2         3078                             cjne    a,#12h,clrvich
12C5 7621           3079                             mov             @r0,#21h                ;изм конст->U=+0000     (vv
                             od)
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    49

12C7 78B2           3080                             mov             r0,#marker
12C9 7604           3081                             mov             @r0,#4;9
12CB 753A04         3082                             mov             movleft,#4
12CE 753B07         3083                             mov             movrig,#7
12D1 900000   F     3084                             mov             dptr,#teAequ0
12D4 120000   F     3085                             call    lotext
                    3086                             
12D7 120000   F     3087                             call    outA
12DA 534B0F         3088                             anl                     bufind+11,#0fh
                    3089             ;       mov             a,bufind+11
                    3090             ;       anl             a,#0f0h
                    3091             ;       mov             bufind+11,a
12DD 434B40         3092                             orl             bufind+11,#40h;бит точки после 7 знакоместа(a=000.0
                              v)
                    3093                             
12E0 020000   F     3094                             jmp             goto7;routF
                    3095     ;hnor13:                jmp             hnor12          
12E3 B6210C         3096     izchi:          cjne    @r0,#21h,tlabelI
                    3097     ;<- при вводе цифр А                            
                    3098                     ;        mov            p3,#0fbh   
                    3099                     ;       jnb             p3.7,li21
                    3100             ;clr            bitmig
12E6 78B2           3101                             mov             r0,#marker
12E8 16             3102                             dec             @r0
12E9 B60201         3103                             cjne    @r0,#2,li21
12EC 06             3104                             inc             @r0;marker=3 +/-
12ED C219           3105     li21:           clr             bitmig
12EF 020000   F     3106                             jmp             goto7;outF
                    3107     
12F2 020000   F     3108     tlabelI:        jmp             labelI
                    3109     
                    3110     ;                       load    0 1 2 3 4 5             
12F5 06050403       3111     sootv:          db              6,5,4,3,2,1;parT
12F9 0201                    
                    3112     ;
                    3113     
                    3114     ;нажата кн ввод при наборе Т
12FB 75B0F7         3115     hnot1:                  mov             p3,#0f7h
12FE 20B784         3116                                     jb              p3.7,routF;out7
1301 B70549         3117                                     cjne    @r1,#5,nohnot1  ;r1=load
1304 794A           3118                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
1306 E7             3119                                     mov             a,@r1
1307 548F           3120                                     anl             a,#8fh
1309 4440           3121                                     orl             a,#40h;.6
130B F7             3122                                     mov             @r1,a
130C 8000           3123                                     jmp             loadb
                    3124                                     
                    3125                                     
130E 789A           3126     loadB:                  mov             r0,#parT
1310 900000   F     3127                                     mov             dptr,#sootv
1313 79B7           3128                                     mov             r1,#load                
1315 E7             3129                                     mov             a,@r1;load
1316 93             3130                                     movc    a,@a+dptr
1317 F6             3131                                     mov             @r0,a
1318 120000   F     3132                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    3133                                      ;r4=b1 r5=b2
131B 120000   F     3134                                     call    iniacp;инициализация АЦП
131E 120000   F     3135                                     call    loadUS
1321 120000   F     3136                                     call    clmassix        
1324 D204           3137                                     setb    bitizm
1326 C210           3138                                     clr             bitt2
                    3139     
1328 534A8F         3140                                     anl             bufind+10,#8fh
132B C3             3141                                      clr            c
132C 789A           3142                                  mov                r0,#parT
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    50

132E 79AF           3143                                      mov            r1,#parN
1330 7402           3144                                  mov                a,#2
1332 96             3145                                 subb                a,@r0
1333 5005           3146                                 jnc                 loadB2
1335 7701           3147                                     mov             @r1,#1;N=1         ;T>=2
1337 020000   F     3148     bout7:                  jmp             goto7;out7
                    3149     
133A B702FA         3150     loadB2:                 cjne    @r1,#2,bout7
133D 7702           3151                                     mov             @r1,#2;N=2
133F 020000   F     3152                                     jmp             goto7;out7
1342                3153     nohnot2:                ;в буфере 1 зажечь <=0,1s
1342 794A           3154                                     mov             r1,#bufind+10
1344 E7             3155                                     mov             a,@r1
1345 4410           3156                                     orl             a,#10h;.4
1347 F7             3157                                     mov             @r1,a
1348 120000   F     3158                                     call            ind
134B 80C1           3159                                     jmp             loadB
134D B704F2         3160     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
1350 794A           3161                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
1352 E7             3162                                     mov             a,@r1
1353 4420           3163                                     orl             a,#20h;.5
1355 F7             3164                                     mov             @r1,a
1356 80B6           3165                                     jmp             loadB
                    3166     
                    3167     ;кнопка ПАМЯТЬ
1358 C204           3168     knMEM:                  clr             bitizm          ;off IZM
135A 900000   F     3169                                     mov             dptr,#teLIST;CLE
135D 120000   F     3170                                     call    lotext    ;в буф2 записать ОЧИСТКА
1360 D20B           3171                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
1362 534BEF         3172                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
1365 434B01         3173                                     orl             bufind+11,#01;зажечь светодиод память
1368 120000   F     3174                                     call            ind
136B 78B0           3175                                     mov             r0,#level
136D 7613           3176                                     mov             @r0,#13h;11h
136F 783D           3177     onmem11:                mov             r0,#chkl
1371 7603           3178                                     mov             @r0,#03
1373 08             3179                                     inc             r0
1374 76E8           3180                                     mov             @r0,#0e8h               ;1000
1376 020000   F     3181                                     jmp             out7;goto7;out7
                    3182     
1379 020000   F     3183     rnomemk:                jmp             nomemk          ;
                    3184     
137C 78B0           3185     outkmem:        mov                     r0,#level
137E 7600           3186                                             mov                     @r0,#0
1380 78B1           3187                                             mov                     r0,#vichR
1382 7600           3188                                             mov                     @r0,#0
1384 C20B           3189                                             clr                     bitmem
1386 C214           3190                                             clr                     bitvich
1388 C206           3191                                             clr                     bitvi11
138A C211           3192                                             clr                     bitmenu
138C D204           3193                                             setb            bitizm
138E 78B2           3194                                             mov                     r0,#marker
1390 76FF           3195                                             mov                     @r0,#0ffh
1392 020000   F     3196                                             jmp                     vvod2_10
1395 020000   F     3197                                             jmp                     goto7   
1398                3198     labelK:
                    3199     
                    3200     ;;;;;;;;;;;;
1398 300BDE         3201                               jnb           bitmem,rnomemk          ;кн память (ввод и <-)
139B 75B0EF         3202                                     mov                     p3,#0efh
139E 30B7DB         3203                                     jnb                     p3.7,outkmem            ;отжатие кн
                              память на любом уровне обработки памяти
13A1 78B0           3204                                      mov            r0,#level
13A3 B6114E         3205                               cjne          @r0,#11h,klev1;nome11
13A6 75B0FB         3206     lefmem11:         mov           p3,#0fbh
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    51

13A9 E5B0           3207                               mov           a,p3
13AB 20E70E         3208                               jb            acc.7,rkvvod0
13AE B6110E         3209                               cjne          @r0,#11h,locle          ;<-memory
13B1 7614           3210                               mov           @r0,#14h
13B3 900000   F     3211     lolist:           mov           dptr,#teSTAT
13B6 120000   F     3212                               call          lotext           ;СТАТИСТИКА
13B9 020000   F     3213                               jmp   goto7;  outF
                    3214     
13BC 020000   F     3215     rkvvod0:        jmp             kvvod0
                    3216     
                    3217     
13BF B6120B         3218     locle:          cjne            @r0,#12h,lowr           ;<-memory
13C2 7611           3219                               mov           @r0,#11h                   ;ОЧИСТКА
13C4 900000   F     3220     loadcle:          mov           dptr,#teCLE
13C7 120000   F     3221                               call          lotext
13CA 020000   F     3222                               jmp           goto7;outF
                    3223     
13CD B6130B         3224     lowr:                   cjne    @r0,#13h,lostat
13D0 7612           3225                                             mov             @r0,#12h
13D2 900000   F     3226      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
13D5 120000   F     3227                             call    lotext
13D8 020000   F     3228                             jmp             goto7;outF
                    3229     
13DB 7613           3230     lostat:         mov             @r0,#13h
13DD 900000   F     3231                                     mov             dptr,#teLIST              ;ПРОСМОТР
13E0 120000   F     3232                             call    lotext
13E3 020000   F     3233                             jmp             goto7;outF
                    3234     
13E6 B6141A         3235     me_14:cjne              @r0,#14h,klev22
13E9 7613           3236                                             mov             @r0,#13h
13EB 900000   F     3237                             mov             dptr,#teLIST              ;;ПРОСМОТР
13EE 120000   F     3238                             call    lotext
13F1 020000   F     3239                             jmp             goto7
13F4 B61202         3240      klev1:          cjne   @r0,#12h,klev2
13F7 80AD           3241                             jmp             lefmem11
13F9 B61302         3242     klev2:           cjne   @r0,#13h,klev3;11-14   klev22     ;11-13 нет
13FC 80A8           3243                             jmp             lefmem11
13FE B61402         3244     klev3:           cjne   @r0,#14h,klev22;
1401 80A3           3245                             jmp             lefmem11
                    3246     ;<- vvod на более низких уровнях
1403 B62117         3247     klev22:         cjne    @r0,#21h,klev21
1406 75B0FB         3248     lev220:         mov             p3,#0fbh
1409 20B77B         3249                             jb              p3.7,kgo23
140C B6210B         3250                             cjne    @r0,#21h,kfullr
140F 7622           3251                             mov             @r0,#22h
1411 900000   F     3252                             mov             dptr,#teBL
1414 120000   F     3253                             call    lotext
1417 020000   F     3254                             jmp             goto7;outF
141A 020000   F     3255     kfullr:         jmp             kfull                           
141D B6220E         3256     klev21:         cjne    @r0,#22h,klev23
1420 80E4           3257                             jmp             lev220
                    3258     
1422 020000   F     3259     rlabL2:         jmp             labL2
1425 020000   F     3260     rlabM:          jmp             labM
1428 020000   F     3261     ques:                   jmp             out7
142B 020000   F     3262     ddoutfr:        jmp             ddoutf
                    3263     
142E B623F4         3264     klev23:          cjne   @r0,#23h,rlabM
1431 75B0FB         3265                              mov    p3,#0fbh
1434 30B7F1         3266                              jnb            p3.7,ques;errr labL2
1437 75B0F7         3267                              mov    p3,#0f7h
143A 20B7EE         3268                              jb             p3.7,ddoutfr
                    3269                                             ;       считать с индикатора  
143D C3             3270                                     clr                     c
143E E547           3271                                mov          a,bufind+7      
1440 9430           3272                                      subb           a,#30h
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    52

1442 B40002         3273                                      cjne           a,#0,chaibl
1445 7401           3274                                      mov            a,#1                    ;номера блоков 1..4
1447                3275     chaibl:         
1447 F538           3276                                             mov             nblok,a
                    3277                                
                    3278                              ;очистить блок памяти с набранным номером
                    3279                              ;150h..1000h( 150h+nblok*320h)
1449 120000   F     3280                                     call            adrblok         ;dptr-
                    3281     
144C 79B8           3282                                     mov                     r1,#work                ;обьем блок
                             а
144E 7703           3283                                     mov                     @r1,#03
1450 09             3284                                     inc                     r1
1451 7720           3285                                     mov                     @r1,#20h                        ;32
                             0h
                    3286     
1453                3287     goonoff:
1453 E4             3288                                     clr                     a
1454 F0             3289                                     movx            @dptr,a
1455 A3             3290                                     inc                     dptr
                    3291     
1456 79B9           3292                                     mov                     r1,#work+1
1458 120000   F     3293                                     call            chminus
145B 78B8           3294                                     mov             r0,#work
145D E6             3295                             mov             a,@r0
145E 30E7F2         3296                             jnb             acc.7,goonoff
                    3297     
1461 C20B           3298                              clr    bitmem  ;сбр признак памяти 
1463 D204           3299                              setb   bitizm
                    3300                             ;после очистки блока сохраняем в saven_bl 
                    3301                             ;адрес второго с конца измерения потому
                    3302                             ;добавляем 8;;
1465 120000   F     3303                             call            adrblok;dptr-начало блока
1468 E582           3304                             mov                     a,dpl
146A 2408           3305                             add                     a,#8
146C F582           3306                             mov                     dpl,a
146E E583           3307                             mov                     a,dph
1470 3400           3308                             addc            a,#0
1472 F583           3309                             mov                     dph,a
1474 120000   F     3310                             call            save_hl;подготовка записи в начало блока
                    3311                             ;;;;;
                    3312     
1477 78B2           3313                              mov            r0,#marker
1479 76FF           3314                              mov            @r0,#0ffh
147B 020000   F     3315                                     jmp                     vvod2_10
147E 020000   F     3316                              jmp    goto7
                    3317     
1481 020000   F     3318     rddoutf:        jmp             ddoutf
1484 020000   F     3319     rgo23no:        jmp             go23no
                    3320     
                    3321     ;vvod   БЛОК->БЛОК 00           
1487 75B0F7         3322     kgo23:           mov    p3,#0f7h
148A 20B7F4         3323                             jb              p3.7,rddoutf
148D B621F4         3324                             cjne    @r0,#21h,rgo23no
                    3325                             ;очистить память 150..dd0h
                    3326                             ;1й блок
1490 900150         3327                              mov                    dptr,#150h
1493 79B8           3328                                     mov                     r1,#work                ;обьем блок
                             а
1495 7703           3329                                     mov                     @r1,#03
1497 09             3330                                     inc                     r1
1498 7720           3331                                     mov                     @r1,#20h                        ;32
                             0h
                    3332     
149A                3333     gooff1:
149A E4             3334                                     clr                     a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    53

149B F0             3335                                     movx            @dptr,a
149C A3             3336                                     inc                     dptr
                    3337     
149D 79B9           3338                                     mov                     r1,#work+1
149F 120000   F     3339                                     call            chminus
14A2 78B8           3340                                     mov             r0,#work
14A4 E6             3341                             mov             a,@r0
14A5 30E7F2         3342                             jnb             acc.7,gooff1
14A8 900158         3343                             mov                     dptr,#158h;начало 1 го блока
                    3344                             ;после очистки блока сохраняем в saven_bl 
                    3345                             ;адрес второго с конца измерения потому
                    3346                             ;добавляем 8;;
14AB 120000   F     3347                             call            save_hl;подготовка записи в начало блока
                    3348     ;2й блок
14AE 900470         3349                             mov                     dptr,#470h
14B1 79B8           3350                                     mov                     r1,#work                ;обьем блок
                             а
14B3 7703           3351                                     mov                     @r1,#03
14B5 09             3352                                     inc                     r1
14B6 7720           3353                                     mov                     @r1,#20h                        ;32
                             0h
                    3354     
14B8                3355     gooff2:
14B8 E4             3356                                     clr                     a
14B9 F0             3357                                     movx            @dptr,a
14BA A3             3358                                     inc                     dptr
                    3359     
14BB 79B9           3360                                     mov                     r1,#work+1
14BD 120000   F     3361                                     call            chminus
14C0 78B8           3362                                     mov             r0,#work
14C2 E6             3363                             mov             a,@r0
14C3 30E7F2         3364                             jnb             acc.7,gooff2
14C6 900478         3365                             mov                     dptr,#478h;начало 2 го блока
14C9 120000   F     3366                             call            save_hl;подготовка записи в начало блока
                    3367     ;3й блок
14CC 900790         3368                             mov                     dptr,#790h
14CF 79B8           3369                                     mov                     r1,#work                ;обьем блок
                             а
14D1 7703           3370                                     mov                     @r1,#03
14D3 09             3371                                     inc                     r1
14D4 7720           3372                                     mov                     @r1,#20h                        ;32
                             0h
                    3373     
14D6                3374     gooff3:
14D6 E4             3375                                     clr                     a
14D7 F0             3376                                     movx            @dptr,a
14D8 A3             3377                                     inc                     dptr
                    3378     
14D9 79B9           3379                                     mov                     r1,#work+1
14DB 120000   F     3380                                     call            chminus
14DE 78B8           3381                                     mov             r0,#work
14E0 E6             3382                             mov             a,@r0
14E1 30E7F2         3383                             jnb             acc.7,gooff3
14E4 900798         3384                             mov                     dptr,#798h;начало 3 го блока
                    3385                                     ;после очистки блока сохраняем в saven_bl 
                    3386                             ;адрес второго с конца измерения потому
                    3387                             ;добавляем 8;;
14E7 120000   F     3388                             call            save_hl;подготовка записи в начало блока
                    3389     ;4й блок
14EA 900AB0         3390     mov                     dptr,#0ab0h
14ED 79B8           3391                                     mov                     r1,#work                ;обьем блок
                             а
14EF 7703           3392                                     mov                     @r1,#03h
14F1 09             3393                                     inc                     r1
14F2 7720           3394                                     mov                     @r1,#20h                        ;32
                             0h
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    54

                    3395     
14F4                3396     gooff4:
14F4 E4             3397                                     clr                     a
14F5 F0             3398                                     movx            @dptr,a
14F6 A3             3399                                     inc                     dptr
                    3400     
14F7 79B9           3401                                     mov                     r1,#work+1
14F9 120000   F     3402                                     call            chminus
14FC 78B8           3403                                     mov             r0,#work
14FE E6             3404                             mov             a,@r0
14FF 30E7F2         3405                             jnb             acc.7,gooff4
1502 900AB8         3406                             mov                     dptr,#0ab8h;начало 4 го блока
                    3407                             ;после очистки блока сохраняем в saven_bl 
                    3408                             ;адрес второго с конца измерения потому
                    3409                             ;добавляем 8;;
1505 120000   F     3410                             call            save_hl;подготовка записи в начало блока
1508 C20B           3411                             clr             bitmem
150A D204           3412                             setb    bitizm
150C 78B2           3413                                     mov             r0,#marker
150E 76FF           3414                              mov            @r0,#0ffh
1510 020000   F     3415                             jmp                     vvod2_10;jmp            goto7
                    3416     
1513 7623           3417     go23no:    mov          @r0,#23h
1515 753B08         3418                                             mov                     movrig,#8
1518 753A07         3419                                             mov             movleft,#7
151B 8055           3420                             jmp             loblok;БЛОК 00
                    3421     
151D 7621           3422     kfull:          mov             @r0,#21h
151F 8025           3423                             jmp             gofull
                    3424                             
                    3425                                             
1521                3426     nomemk:                         
1521 020000   F     3427                                     jmp             labelS                  ;нажат ввод меню
                    3428                             
1524 75B0FB         3429     nome11:           mov           p3,#0fbh
1527 E5B0           3430                               mov           a,p3
1529 20E70D         3431                               jb            acc.7,kvvod0
152C B61205         3432                               cjne          @r0,#12h,mem12no        
152F 7611           3433                               mov           @r0,#11h                ;ОЧИСТКА
1531 020000   F     3434                               jmp            loadcle
                    3435     
1534                3436     mem12no:        ;cjne           @r0,#13h,lowr           
1534 7612           3437                               mov           @r0,#12h                   ;
1536 020000   F     3438                               jmp           lowr1                     ;ЗАПИСЬ
                    3439     
1539 75B0F7         3440     kvvod0:           mov           p3,#0f7h                        ;knopka vvod
153C 20B70F         3441                               jb            p3.7,ddoutf
153F 78B0           3442                               mov           r0,#level
1541 B61129         3443                               cjne          @r0,#11h,mvv11
1544 7621           3444                               mov           @r0,#21h                ;ПОЛНАЯ
1546 900000   F     3445     gofull:           mov           dptr,#teFULL
1549 120000   F     3446                               call          lotext
154C 804F           3447                                     jmp             mlabL2  ;<-????????/
                    3448     
154E                3449     ddoutf:         ;<- БЛОК 00(ОЧИСТКА)
                    3450     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3451     ;т е сохранить ее в ячейке для мигания в противном случае
                    3452     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3453     ;       знакоместа
154E 78B2           3454                                                     mov             r0,#marker
1550 7440           3455                                     mov             a,#bufind
1552 26             3456                                             add             a,@r0                   ;a=bufind+m
                             arker
1553 F9             3457                                             mov             r1,a
1554 19             3458                                             dec             r1      ;       inc             r1
1555 873C           3459                                             mov             savba,@r1
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    55

1557 C219           3460                                             clr             bitmig
                    3461     ;;;;;;;;;;;;;;;;
1559 78B2           3462                       mov           r0,#marker      ;курсор слева   ?
155B E53A           3463                             mov             a,movleft
155D C3             3464                             clr             c
155E 96             3465                             subb    a,@r0
155F 7006           3466                             jnz        left21
1561 E53B           3467                             mov             a,movrig;уст в правую позицию
1563 F6             3468                             mov             @r0,a
                    3469     
1564 020000   F     3470                             jmp             goto7                                            
1567 E53A           3471     left21:         mov             a,movleft;уст в левую позицию
1569 F6             3472                             mov             @r0,a   
156A 020000   F     3473                             jmp             goto7
                    3474     
                    3475     
156D B61215         3476     mvv11:            cjne          @r0,#12h,mvv12
1570 7631           3477                                     mov             @r0,#31h
1572 900000   F     3478     loblok:                 mov             dptr,#teBL0;БЛОК 0
1575 120000   F     3479                                     call    lotext
1578 E538           3480                                     mov                     a,nblok
157A 2430           3481                                     add                     a,#30h
157C F547           3482                                     mov                     bufind+7,a
157E 78B2           3483                                     mov             r0,#marker
1580 7607           3484                                     mov             @r0,#7
                    3485                                     ;mov            movrig,#9
                    3486                                     ;mov            movleft,#6
1582 020000   F     3487                                     jmp             goto7;outF
1585 B61411         3488     mvv12:  cjne            @r0,#14h,bl_li
1588 7661           3489                                     mov                     @r0,#61h
158A 900000   F     3490                                     mov             dptr,#teMIN;
158D 120000   F     3491                                     call    lotext
1590 120000   F     3492                                     call    vichmin
1593 120000   F     3493                                     call    z_1s
1596 020000   F     3494                                     jmp             out7;goto7;outF
                    3495     
1599 7641           3496     bl_li:          mov             @r0,#41h                ; БЛОК 00(ЗАПИСЬ И ПРОСМОТР)
159B 80D5           3497                                     jmp             loblok
                    3498     
                    3499     
                    3500     
159D                3501     mlabL2:         ;jmp            labL2
                    3502                                             ;  уст курсор в правую позицию 
                    3503                                     ;                               29.12.06
                    3504     ;;;;;;;;;;;;;;;;;;
                    3505     ;необходимо не портить цифру в следуюем справа знакоместе
                    3506     ;т е сохранить ее в ячейке для мигания в противном случае
                    3507     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3508     ;       знакоместа
159D 78B2           3509                                             mov             r0,#marker
159F 7440           3510                                     mov             a,#bufind
15A1 26             3511                                             add             a,@r0                   ;a=bufind+m
                             arker
15A2 F9             3512                                             mov             r1,a
15A3 09             3513                                             inc             r1
15A4 873C           3514                                             mov             savba,@r1
                    3515     ;;;;;;;;;;;;;;;;
15A6 78B2           3516                       mov           r0,#marker      ;курсор справа  ?
15A8 E53B           3517                             mov             a,movrig
15AA C3             3518                             clr             c
15AB 96             3519                             subb    a,@r0
15AC 6006           3520                             jz         equ2l
15AE E53B           3521                             mov             a,movrig;уст в правую позицию
15B0 F6             3522                             mov             @r0,a
                    3523     ;                       lool
15B1 020000   F     3524                             jmp             goto7                                            
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    56

15B4 E53A           3525     equ2l:          mov             a,movleft;уст в левую позицию
15B6 F6             3526                             mov             @r0,a   
15B7 020000   F     3527                             jmp             goto7
                    3528                     
15BA 020000   F     3529     rnom31:         jmp                     nom31
15BD B631FA         3530     labM:                   cjne    @r0,#31h,rnom31
15C0 75B0FB         3531                                     mov             p3,#0fbh
15C3 30B7D7         3532                                     jnb             p3.7,mlabL2
15C6 75B0F7         3533                                mov          p3,#0f7h
15C9 20B782         3534                                jb           p3.7,ddoutf
                    3535                                
15CC 7632           3536                                mov          @r0,#32h                        ;ИНТ 0000
                    3537                                     ;       считать с индикатора  
15CE C3             3538     blokvv:         clr                     c
15CF E547           3539                                mov          a,bufind+7      
15D1 9430           3540                                      subb           a,#30h
15D3 B40002         3541                                      cjne           a,#0,blokvvc
15D6 7401           3542                                      mov            a,#1                    ;номера блоков 1..4
                    3543     
15D8 F538           3544     blokvvc: mov            nblok,a
15DA 900000   F     3545                                mov          dptr,#teINT;ИНТ 0000c
15DD 120000   F     3546                                call         lotext
15E0 78CE           3547                                      mov            r0,#interva+1
15E2 7952           3548                                      mov            r1,#abin+3
15E4 E6             3549                                      mov            a,@r0
15E5 F7             3550                                      mov            @r1,a
15E6 18             3551                                             dec                     r0
15E7 19             3552                                             dec                     r1
15E8 E6             3553                                             mov             a,@r0
15E9 F7             3554                                             mov             @r1,a
15EA 19             3555                                             dec             r1
15EB E4             3556                                             clr             a
15EC F7             3557                                             mov             @r1,a
15ED 19             3558                                             dec             r1
15EE F7             3559                                             mov             @r1,a
                    3560                                                                             
15EF 7853           3561                                             mov             r0,#adec
15F1 7952           3562                                             mov             r1,#abin+3      ;hex->10
15F3 120000   F     3563                                             call    bindec
                    3564                                     
15F6 785C           3565                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
15F8 7948           3566                                             mov             r1,#bufind+8
15FA 7F04           3567                                             mov             r7,#4
15FC E6             3568     bloin:                          mov             a,@r0
15FD 2430           3569                                             add             a,#30h
15FF F7             3570                                             mov             @r1,a
1600 19             3571                                             dec             r1
1601 18             3572                                             dec             r0
1602 DFF8           3573                                             djnz    r7,bloin
1604 78B2           3574                                mov          r0,#marker
1606 7605           3575                                mov          @r0,#5
1608 753B08         3576                                mov          movrig,#8
160B 753A05         3577                                mov          movleft,#5
160E 789A           3578                                      mov            r0,#parT
1610 B60609         3579                                     cjne            @r0,#6,innot6
1613 534BF0         3580                                     anl                     bufind+11,#0f0h;after 5- 0.000c
1616 434B04         3581                                     orl                     bufind+11,#04h
                    3582                             
1619 020000   F     3583                                     jmp                     goto7
161C B60309         3584     innot6: cjne            @r0,#3,innot3
161F 534BF0         3585                                     anl                     bufind+11,#0f0h;after 7- 000.0c
1622 434B20         3586                                     orl                     bufind+11,#20h
                    3587                                     ;call           ind
1625 020000   F     3588                                     jmp                     out7;goto7
1628 C3             3589     innot3: clr                     c
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    57

1629 7403           3590                                     mov                     a,#3
162B 96             3591                                     subb            a,@r0
162C 5009           3592                                     jnc                     innot1_2
162E 534BF0         3593                                     anl                     bufind+11,#0f0h;after 6- 00.00c
1631 434B40         3594                                     orl                     bufind+11,#40h
                    3595                                     
1634 020000   F     3596                                     jmp                     goto7
                    3597     
1637                3598     innot1_2:
1637 534B0F         3599                                     anl                     bufind+11,#0fh;0h;0000c
163A C219           3600                                     clr                     bitmig
                    3601                                     ;call           ind             нет необходимости пришет пр
                             обел         
163C 020000   F     3602     rgoto7: jmp        goto7;outF
                    3603     
163F B63276         3604     nom31:             cjne         @r0,#32h,nom32
1642 75B0FB         3605                                     mov             p3,#0fbh
1645 20B71F         3606                                     jb              p3.7,vvinte             ;ввод интервал;no31
                             n
                    3607                                     
1648                3608     lefcur:         ;;кн <- 32 нач блок 000
                    3609     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3610     ;т е сохранить ее в ячейке для мигания в противном случае
                    3611     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3612     ;       знакоместа
1648 C219           3613                                                     clr             bitmig
164A 78B2           3614                                                     mov             r0,#marker;нажата кн <- при
                              вводе цифр нач блок 000
164C 7440           3615                                     mov             a,#bufind
164E 26             3616                                             add             a,@r0                   ;a=bufind+m
                             arker
164F F9             3617                                             mov             r1,a
1650 19             3618                                             dec             r1;;;;;;;;;;;
1651 873C           3619                                             mov             savba,@r1
                    3620                                             
1653 78B2           3621                                                     mov             r0,#marker      ;курсор сле
                             ва?
1655 E53A           3622                             mov             a,movleft
1657 C3             3623                             clr             c
1658 96             3624                             subb    a,@r0
1659 7006           3625                             jnz        noequ2
165B E53B           3626                             mov             a,movrig
165D F6             3627                             mov             @r0,a;уст в крайнюю правую позицию
165E 020000   F     3628                             jmp             goto7
1661 120000   F     3629     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
1664 020000   F     3630                             jmp        goto7        
                    3631                                                                       
                    3632     
                    3633     ;;;;;;;;;;;;;;;;;;
1667                3634     vvinte:         ;ввод интервал                          
1667 75B0F7         3635     no31n:             mov          p3,#0f7h
166A 20B7CF         3636                                     jb              p3.7,rgoto7
166D 7633           3637                                     mov             @r0,#33h
                    3638                                     ;считать с индикатора введенный интервал
166F 7F0A           3639                                             mov             r7,#10
1671 7853           3640                                     mov             r0,#adec
1673 120000   F     3641                                     call    clearN
1676 120000   F     3642                                     call    upak4                   
1679 784F           3643                                     mov             r0,#abin
167B 7953           3644                                     mov             r1,#adec                        ;мл        
                              ст
167D 120000   F     3645                                     call    decbin                  ;abin..abin+3 (hex)
1680 794F           3646                                     mov             r1,#abin
1682 78CE           3647                                     mov             r0,#interva+1
1684 E7             3648                                     mov             a,@r1
1685 F6             3649                                     mov             @r0,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    58

1686 18             3650                                     dec             r0
1687 09             3651                                     inc             r1
1688 E7             3652                                     mov             a,@r1
1689 F6             3653                                     mov             @r0,a
                    3654                                     
168A 78D5           3655                                     mov             r0,#volume                      ;объем блок
                             а
168C 7600           3656                                     mov             @r0,#0
168E 08             3657                                     inc             r0
168F 76C7           3658                                     mov             @r0,#0c7h
1691 120000   F     3659                                     call            adrblok;dptr
1694 120000   F     3660                                     call            save_hl;1я ячейка блока
1697 78B2           3661                                mov          r0,#marker
1699 76FF           3662                                mov          @r0,#0ffh
169B D204           3663                                      setb           bitizm
169D C20B           3664                                      clr            bitmem
169F 789A           3665     vvod2_10: mov           r0,#parT
16A1 B6050C         3666                                      cjne           @r0,#5,no10msv
16A4 900000   F     3667                                             mov                     dptr,#te10ms
16A7 120000   F     3668     t2msme:         call            lotext
                    3669                                             
16AA 120000   F     3670                                             call            ind
16AD 020000   F     3671     no2msv:   jmp      goto7;
16B0 B606FA         3672     no10msv:        cjne            @r0,#6,no2msv   
16B3 900000   F     3673                                             mov                     dptr,#te2ms
16B6 80EF           3674                                     jmp                     t2msme
                    3675     
                    3676     
                    3677     
16B8 B6332B         3678     nom32:           cjne           @r0,#33h,nom33
16BB 75B0FB         3679                              mov            p3,#0fbh
16BE 30B787         3680                              jnb            p3.7,lefcur
16C1 75B0F7         3681                              mov            p3,#0f7h
16C4 20B7E6         3682                              jb             p3.7,no2msv;rgoto7
                    3683                              ;запомнить номер ячейки конца блока
16C7 7634           3684                              mov    @r0,#34h
16C9 7F0A           3685     INTn:                   mov             r7,#10
16CB 7853           3686                                     mov             r0,#adec
16CD 120000   F     3687                                     call    clearN
16D0 120000   F     3688                                     call    upak3                   
16D3 784F           3689                                     mov             r0,#abin
16D5 7953           3690                                     mov             r1,#adec                        ;мл        
                              ст
16D7 120000   F     3691                                     call    decbin                  ;abin..abin+3 (hex)
16DA 120000   F     3692                                     call    loadr2                  ;r2..r5
16DD 120402         3693                                     call    altof                   ;r2..r5->int
16E0 020000   F     3694     dgoto7:                  jmp            goto7
                    3695     
16E3 020000   F     3696     rlefcur:                jmp             lefcur
                    3697     
16E6 B63464         3698     nom33:          cjne            @r0,#34h,labelP
16E9 75B0FB         3699                               mov           p3,#0fbh
16EC 30B7F4         3700                              jnb            p3.7,rlefcur
16EF 75B0F7         3701                              mov            p3,#0f7h
16F2 20B7EB         3702                              jb             p3.7,dgoto7
16F5 7635           3703                              mov            @r0,#35h
16F7 78B2           3704                              mov            r0,#marker
16F9 76FF           3705                              mov            @r0,#0ffh
                    3706                              ;T1<-число на индикаторе
                    3707                                               ;vvod КОН БЛ 000
16FB 78CF           3708                              mov            r0,#chbuf               ;счетчик периода загрузки в
                              буфер и интерфейс
16FD 7630           3709                              mov            @r0,#30h  
16FF C20B           3710                              clr            bitmem
1701 D204           3711                              setb           bitizm;;;;      
1703 020000   F     3712                             jmp        goto7
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    59

1706 020000   F     3713     vodm11_15:                      jmp             vvodm11_15
1709 020000   F     3714     me11_15de:                      jmp             me11_15dec
170C 020000   F     3715     moutkmem:                               jmp             outkmem
                    3716     
170F 020000   F     3717     nmem_menu:              jmp             out7                    ;нажата память в режиме мен
                             ю
                    3718     ;обработка кнопки меню ввод
1712 301138         3719     labelS:         jnb                     bitmenu,labelP
1715 75B0EF         3720                                             mov                     p3,#0efh
1718 30B7F4         3721                                             jnb                     p3.7,nmem_menu
171B 75B0DF         3722                                             mov                     p3,#0dfh
171E 30B7EB         3723                                             jnb                     p3.7,moutkmem
1721 78B1           3724                                             mov                     r0,#vichR
1723 7415           3725                                             mov                     a,#15h
1725 C3             3726                                             clr                     c
1726 96             3727                                             subb            a,@r0
1727 4021           3728                                             jc                      rme21_23
                    3729                             
1729 75B0FB         3730                                             mov                     p3,#0fbh
172C 20B7D7         3731                                             jb                      p3.7,vodm11_15
172F 78B1           3732                                             mov                     r0,#vichR
1731 B611D5         3733                                             cjne                    @r0,#11h,me11_15de;<-
1734 7615           3734                                             mov                     @r0,#15h
1736 900000   F     3735                                             mov                     dptr,#teKALIB
1739 120000   F     3736                                             call            lotext
173C 020000   F     3737                                             jmp                     onmem11
173F C211           3738     menuon:         clr             bitmenu                 ;off menu
1741 D204           3739                                             setb    bitizm
                    3740     
1743 78B1           3741                                     mov             r0,#vichR
1745 7600           3742                                     mov             @r0,#0
1747 020000   F     3743                                     jmp             onmem11
                    3744     
                    3745                                             ;;;;;
                    3746             
174A 020000   F     3747     rme21_23:               jmp             me21_23 
                    3748                             
                    3749     ;режим просмотра
174D B64130         3750     labelP:                 cjne            @r0,#41h,govvlist
1750 7642           3751                                                     mov                     @r0,#42h
                    3752                                                     ;       считать с индикатора  
1752 C3             3753                                             clr                     c
1753 E547           3754                                mov          a,bufind+7      
1755 9430           3755                                      subb           a,#30h
1757 B40002         3756                                      cjne           a,#0,chaipr
175A 7401           3757                                      mov            a,#1
175C F538           3758     chaipr:                          mov            nblok,a
175E 900000   F     3759                                mov          dptr,#teCH;ОТСЧЕТ 000
1761 120000   F     3760                                call         lotext
1764 534BEF         3761                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
1767 78B2           3762                                mov          r0,#marker
1769 7607           3763                                mov          @r0,#7
176B 753B09         3764                                mov          movrig,#9
176E 753A07         3765                                mov          movleft,#7
1771 120000   F     3766                                             call            z_1s
1774 020000   F     3767                        jmp     goto7;outF
1777 020000   F     3768     label43:                jmp             label7
                    3769     
177A 020000   F     3770     rlist_43:                       jmp                     list_43                            
                                  
177D 020000   F     3771     mlabL2r:                        jmp                     mlabL2
1780 B642F7         3772     govvlist:                       cjne            @r0,#42h,rlist_43
1783 75B0FB         3773                                                                     mov                     p3,
                             #0fbh
1786 30B7F4         3774                                                             jnb                     p3.7,mlabL2
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    60

                             r;кн <- ОТСЧЕТ 000
1789 75B0F7         3775                                                             mov                     p3,#0f7h
178C 20B7E8         3776                                                             jb                      p3.7,label4
                             3
178F 7643           3777                                                             mov                     @r0,#43h;vv
                             od 
1791 78B2           3778                                                             mov                     r0,#marker
1793 76FF           3779                                                             mov                     @r0,#0ffh
1795 7F0A           3780                                                                     mov             r7,#10
1797 7853           3781                                     mov             r0,#adec
1799 120000   F     3782                                     call    clearN
179C 120000   F     3783                                     call    upak3                   
179F 784F           3784                                     mov             r0,#abin
17A1 7953           3785                                     mov             r1,#adec                        ;мл        
                              ст
17A3 120000   F     3786                                     call    decbin                  ;abin..abin+3 (hex)
17A6 120000   F     3787                                     call    loadr2                  ;r2..r5
17A9 ED             3788                                     mov             a,r5                            ;сохр номер
                              лемента
17AA F537           3789                                     mov             nelem,a
17AC 120402         3790                                     call    altof                   ;r2..r5->int
17AF 900000   F     3791                                     mov             dptr,#ch_1;
17B2 120000   F     3792                                     call    ldc_ltemp                       ;r8..r11
17B5 1201D1         3793                                     call    flsub
17B8 900000   F     3794                                     mov             dptr,#ch_4;
17BB 120000   F     3795                                     call    ldc_ltemp                       ;r8..r11
17BE 120203         3796                                     call    flmul                           ;(n(номер отсчета)-
                             1)*4+адр нач блока
17C1 120343         3797                                     call            ftol                    ;r2..r5->hex
17C4 C002           3798                                     push            rr2
17C6 C003           3799                                     push            rr3
17C8 C004           3800                                     push            rr4
17CA C005           3801                                     push            rr5
17CC 120000   F     3802                                     call            adrblok;dptr-
17CF D005           3803                                     pop                     rr5
17D1 D004           3804                                     pop                     rr4
17D3 D003           3805                                     pop                     rr3
17D5 D002           3806                                     pop                     rr2
17D7 79D8           3807                                     mov                     r1,#copy_hl+1;saven_bl+1;сохр адрес
                              внешн озу введенного лемента
17D9 E582           3808                                     mov                     a,dpl
17DB 2D             3809                                     add                     a,r5
17DC F582           3810                                     mov                     dpl,a
17DE F7             3811                                     mov                     @r1,a           ;low
17DF E583           3812                                     mov                     a,dph
17E1 3C             3813                                     addc            a,r4
17E2 F583           3814                                     mov                     dph,a
17E4 19             3815                                     dec                     r1
17E5 F7             3816                                     mov                     @r1,a                   ;high
                    3817                             
17E6                3818     li42_43:
17E6 120000   F     3819                                     call            reA3_X          ;r2..r5/выдать рез из внешн
                              пам на индикатор
17E9 900000   F     3820                                     mov             dptr,#ch10;
17EC 120000   F     3821                                     call    ldc_ltemp
17EF 120000   F     3822                                     call    zdiv    
                    3823                                     ;;;;;;;;;;;
17F2 120000   F     3824                                     call    maform
                    3825                                     ;;;;
                    3826     
                    3827                                     ;;;;;;;
17F5 784F           3828                                             mov             r0,#abin
17F7 120000   F     3829                                             call    saver2
17FA 7853           3830                                             mov             r0,#adec
17FC 7952           3831                                             mov             r1,#abin+3      ;hex->10
17FE 120000   F     3832                                             call    bindec
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    61

                    3833                                     
1801 785C           3834                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1803 7945           3835                                             mov             r1,#bufind+5
1805 7F07           3836                                             mov             r7,#7
1807 E6             3837     ch43:                           mov             a,@r0
1808 2430           3838                                             add             a,#30h
180A F7             3839                                             mov             @r1,a
180B 19             3840                                             dec             r1
180C 18             3841                                             dec             r0
180D DFF8           3842                                             djnz    r7,ch43
180F 7847           3843                                             mov             r0,#bufind+7
1811 762D           3844                                             mov             @r0,#2dh          ;-2..-9
1813 7840           3845                                             mov             r0,#bufind
1815 762B           3846                                             mov             @r0,#2bh
1817 300202         3847                                             jnb             znmat,nozzmi43;bitznak,nozzmi
181A 762D           3848                                             mov             @r0,#2dh
181C E538           3849     nozzmi43:       mov             a,nblok
181E B40104         3850                                             cjne    a,#1,nozzmi1            
1821 7934           3851                                             mov             r1,#sadiap;diap
1823 8010           3852                                             jmp             nozzbl
1825 B40204         3853     nozzmi1:        cjne    a,#2,nozzmi2            
1828 7932           3854                                             mov             r1,#sadiap2;diap
182A 8009           3855                                             jmp             nozzbl
182C B40304         3856     nozzmi2:        cjne    a,#3,nozzmi3            
182F 7931           3857                                             mov             r1,#sadiap3;diap
1831 8002           3858                                             jmp             nozzbl
1833 7930           3859     nozzmi3:        mov             r1,#sadiap4;diap
                    3860                                     
1835 7848           3861     nozzbl:         mov             r0,#bufind+8
1837 E7             3862                                             mov             a,@r1
1838 B40808         3863                                             cjne    a,#8,nodi8_43
183B 7630           3864                                             mov             @r0,#30h                 ;10-10
183D 18             3865                                             dec             r0
183E 7663           3866                                             mov             @r0,#63h;31h
1840 08             3867                                             inc             r0
1841 800E           3868                                             jmp             see_l43
1843 B40908         3869     nodi8_43:       cjne    a,#9,nodi9_43
                    3870                                     
1846 7631           3871                                             mov             @r0,#31h           ;10-11
1848 18             3872                                             dec             r0
1849 7663           3873                                             mov             @r0,#63h;31h
                    3874                                     
184B 08             3875                                             inc             r0
184C 8003           3876                                             jmp             see_l43
184E 2432           3877     nodi9_43:               add             a,#32h
1850 F6             3878                                             mov             @r0,a;
1851 08             3879     see_l43:                        inc             r0
1852 7641           3880                                             mov             @r0,#"A";"E";
                    3881                             ;       inc             r0
                    3882                             ;       mov             @r0,#00h ;=feh в нач установе для поджига в
                             сех сегм
                    3883                             ;       inc             r0;             mov             bufind+11
                    3884                             ;       mov             @r0,#0d0h               ;bufind+11.4 точка 
                             после первой цифры
1854 434B10         3885                             orl                     bufind+11,#10h
1857 120000   F     3886     out43:          call            ind
185A 120000   F     3887                                             call            z_1s
185D 020000   F     3888                                             jmp             out7                               
                                  
                    3889     
                    3890                                     ;;;;;;;;        
1860 783D           3891     label7: mov             r0,#chkl
1862 7604           3892                                     mov             @r0,#04;3
1864 08             3893                                     inc             r0
1865 76E8           3894                                     mov             @r0,#0e8h               ;1000
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    62

1867 020000   F     3895                                     jmp             out7;
186A B64351         3896     list_43:                cjne    @r0,#43h,noli_43
186D 75B0FB         3897                                                     mov             p3,#0fbh                ;43
                             h <-
1870 20B70A         3898                                                     jb              p3.7,vvod43             ;vv
                             od
1873 C20B           3899                                                     clr             bitmem
1875 D204           3900                                                     setb    bitizm
1877 78B2           3901                                                     mov             r0,#marker
1879 76FF           3902                                                     mov             @r0,#0ffh
187B 80E3           3903                                                     jmp             label7;по кн <- выход из пр
                             осмотра
                    3904     
187D 7644           3905     vvod43:                 mov             @r0,#44h
187F E537           3906                                                     mov             a,nelem;вывод порядкового н
                             омера в блоке 
1881 04             3907                                                     inc             a
1882 F552           3908                                                     mov             abin+3,a
                    3909                                                     
1884 F537           3910                                                     mov             nelem,a
1886 E4             3911                                                     clr             a
1887 F551           3912                                                     mov             abin+2,a
1889 F550           3913                                                     mov             abin+1,a
188B F54F           3914                                                     mov             abin,a
                    3915                                             
188D 7853           3916                                             mov             r0,#adec
188F 7952           3917                                             mov             r1,#abin+3      ;hex->10
1891 120000   F     3918                                             call    bindec
1894 7840           3919                                             mov             r0,#bufind;почистить индикатор
1896 7F0A           3920                                             mov             r7,#10
1898 7420           3921                                             mov             a,#20h
189A F6             3922     cle20:          mov             @r0,a
189B 08             3923                                             inc             r0
189C DFFC           3924                                             djnz    r7,cle20
                    3925                                             ;;;;;;
189E 900000   F     3926                                             mov             dptr,#teCH;ОТСЧЕТ 000
18A1 120000   F     3927                                call         lotext
18A4 534BEF         3928                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
18A7 785C           3929                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
18A9 7949           3930                                             mov             r1,#bufind+9
18AB 7F03           3931                                             mov             r7,#3
18AD E6             3932     ch43_42:                                mov             a,@r0
18AE 2430           3933                                             add             a,#30h
18B0 F7             3934                                             mov             @r1,a
18B1 19             3935                                             dec             r1
18B2 18             3936                                             dec             r0
18B3 DFF8           3937                                             djnz    r7,ch43_42
18B5 120000   F     3938                                             call            ind
18B8 120000   F     3939                                             call            z_1s
18BB 020000   F     3940                                             jmp             out7
18BE B64419         3941     noli_43:        cjne            @r0,#44h,vvosta
18C1 7643           3942                                             mov                     @r0,#43h
18C3 79D8           3943                                                     mov                     r1,#copy_hl+1;saven
                             _bl+1
18C5 E7             3944                                                     mov                     a,@r1
18C6 F582           3945                                                     mov                     dpl,a
18C8 19             3946                                                     dec                     r1
18C9 E7             3947                                                     mov                     a,@r1;high
18CA F583           3948                                                     mov                     dph,a
18CC A3             3949                                                     inc                     dptr
18CD A3             3950                                                     inc                     dptr
18CE A3             3951                                                     inc                     dptr
18CF A3             3952                                                     inc                     dptr
18D0 E583           3953                                                     mov                     a,dph
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    63

18D2 F7             3954                                                     mov                     @r1,a
18D3 09             3955                                                     inc                     r1
18D4 E582           3956                                                     mov                     a,dpl
18D6 F7             3957                                                     mov                     @r1,a              
                                          ;сохр адр внешн озу
18D7 020000   F     3958                                             jmp                     li42_43;вывод значения след
                             ующего в блоке
                    3959     
18DA B66111         3960     vvosta:                 cjne            @r0,#61h,vvostad
18DD 7662           3961                                                     mov                     @r0,#62h
18DF 900000   F     3962                                                     mov                     dptr,#teMAX;
18E2 120000   F     3963                                                     call            lotext
18E5 120000   F     3964                                                     call            vichmax
18E8 120000   F     3965                                                     call            z_05s;z_1s
18EB 020000   F     3966                                                     jmp             goto7
                    3967     
18EE B66211         3968     vvostad:                cjne            @r0,#62h,rousta
18F1 7663           3969                                                     mov                     @r0,#63h
18F3 900000   F     3970                                                     mov             dptr,#teMid;
18F6 120000   F     3971                                                     call    lotext
18F9 120000   F     3972                                                     call            vichmean
18FC 120000   F     3973                                                     call            z_05s
18FF 020000   F     3974                                                     jmp             goto7
                    3975     
1902 B6630E         3976     rousta:                 cjne            @r0,#63h,rousta1
1905 7661           3977                                                     mov                     @r0,#61h
1907 900000   F     3978                                                     mov             dptr,#teMin;
190A 120000   F     3979                                                     call    lotext
190D 120000   F     3980                                                     call            vichmin
1910 120000   F     3981                                                     call            z_05s
1913 020000   F     3982     rousta1:                jmp             goto7
                    3983     
1916 020000   F     3984     rLABELP:                jmp                     LABELP
1919 78B1           3985     vvodm11_15:     mov                     r0,#vichR;vvod
191B 75B0F7         3986                                                     mov                     p3,#0f7h
191E 20B7F5         3987                                             jb                      p3.7,rLABELP;????
                    3988                                     
                    3989     
1921 B61115         3990                                             cjne                    @r0,#11h,tome21
1924 7621           3991                                             mov                     @r0,#21h;vvod
1926 900000   F     3992                                             mov                     dptr,#teTE11
1929 120000   F     3993                                             call            lotext
192C 534B03         3994                                             anl                     bufind+11,#03h ;погасить за
                             пятые
192F 020000   F     3995                                             jmp                     onmem11
                    3996     
1932 16             3997     me11_15dec:             dec             @r0                             ;<-
1933 120000   F     3998     lokame1:        call            lomenu
1936 020000   F     3999                                             jmp                     onmem11
                    4000     
1939 B61206         4001     tome21:         cjne                    @r0,#12h,tome13
                    4002                                             ;вкл тест интерфейса
193C 020000   F     4003                                             jmp             testrs;??????????
193F 020000   F     4004                                             jmp                     onmem11
                    4005     
1942 B6132A         4006     tome13:         cjne                    @r0,#13h,tome14
1945 7631           4007                                             mov                     @r0,#31h
                    4008                                             
1947 7A50           4009                                             mov                     r2,#50h                    
                                  ;57.6->19.2
1949 7B2C           4010                                             mov                     r3,#2ch
194B 120454         4011                                             call            re4byte                 ;28..2bh 3b
                             ait-parol,1 bait skor
194E E508           4012                                             mov                     a,r8
1950 B4000E         4013                                             cjne            a,#00,skor19
1953 900000   F     4014                                             mov                     dptr,#teS57_6;57,6
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    64

1956 120000   F     4015                                             call            lotext
1959 434B80         4016                                     orl                     bufind+11,#80h
195C C213           4017                                             clr                     bitv19
                    4018     
195E 020000   F     4019                                             jmp             onmem11
1961 900000   F     4020     skor19:         mov                     dptr,#teS19_2
1964 120000   F     4021                                             call            lotext
1967 D213           4022                                             setb            bitv19
1969 434B80         4023                                             orl                     bufind+11,#80h
196C 020000   F     4024                                             jmp                     onmem11
                    4025                                             
                    4026     
196F B61415         4027     tome14:         cjne                    @r0,#14h,tome15
1972 D204           4028                                             setb            bitizm
1974 7881           4029                                             mov                     r0,#chavt
1976 7600           4030                                             mov                     @r0,#0
1978 08             4031                                             inc                     r0
1979 7600           4032                                             mov                     @r0,#0
197B C211           4033     outmenu:        clr                     bitmenu
197D 020000   F     4034                                             jmp                     out7
                    4035     
1980 78B1           4036     goparom:        mov             r0,#vichR               ;режим меню 52
1982 7652           4037                                             mov                     @r0,#52h                   
                                  ;пароль уже ввели
1984 020000   F     4038                                             jmp                     goparol
1987 2016F6         4039     tome15:         jb              bitpar,goparom  
198A 7651           4040                                             mov                     @r0,#51h;ПАРОЛЬ 000
198C 120000   F     4041                                             call            lomenu
198F 78B2           4042                                             mov                     r0,#marker
1991 7607           4043                                             mov                     @r0,#7
1993 753B09         4044                                             mov                     movrig,#9
1996 753A07         4045                                             mov                     movleft,#7
                    4046                                             ;setb           bitizm
1999 020000   F     4047                                             jmp                     onmem11
                    4048     
                    4049     
199C 78B1           4050     me21_23:        mov                     r0,#vichR               ;<-
199E 7423           4051                                             mov                     a,#23h
19A0 C3             4052                                             clr                     c
19A1 96             4053                                             subb            a,@r0
19A2 403D           4054                                             jc                      labelS1
19A4 75B0FB         4055                                             mov                     p3,#0fbh
19A7 20B718         4056                                             jb                      p3.7,vv21_23
19AA B6210B         4057                                             cjne            @r0,#21h,me21_23dec;-<
19AD 7623           4058                                             mov                     @r0,#23h
19AF 900000   F     4059                                             mov                     dptr,#teTE7
19B2 120000   F     4060                                             call            lotext
19B5 020000   F     4061                                             jmp                     onmem11
19B8                4062     me21_23dec:     
19B8 16             4063                                             dec                     @r0
19B9 120000   F     4064                                             call            lomenu
19BC 020000   F     4065                                             jmp                     onmem11
19BF 020000   F     4066     onmem12:        jmp             outF    ;(ie7)                          
                    4067                                                     
19C2 75B0F7         4068     vv21_23:        mov             p3,#0f7h                ;vvod
19C5 20B7F7         4069                                             jb              p3.7,onmem12
19C8 B6210C         4070                                             cjne            @r0,#21h,test22
                    4071                                             ;mov                    dptr,#tabt11;заслать ус 11А
19CB 120000   F     4072     tests:          call            lotpus
19CE D215           4073                                             setb            biteizm;запомнить режим ТИ
19D0 D204           4074                                             setb            bitizm
19D2 C211           4075                                             clr                     bitmenu;обнулить т к не буд
                             ет индикации измерения       
19D4 020000   F     4076                                             jmp                     onmem11
19D7 B62202         4077     test22:         cjne            @r0,#22h,test23
                    4078                                     ;       mov                     dptr,#tabt9;заслать ус 9А
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    65

19DA 80EF           4079                                             jmp             tests   
19DC                4080     test23:
                    4081                                     ;       mov                     dptr,#tabt7;заслать ус 7А
19DC 80ED           4082                                             jmp             tests   
19DE 020000   F     4083     left_s:         jmp                     left_sk
19E1 B63149         4084     labelS1:        cjne            @r0,#31h,me_41
19E4 75B0FB         4085                                             mov                     p3,#0fbh                   
                                  ;<-
19E7 30B7F4         4086                                             jnb                     p3.7,left_s
19EA 75B0F7         4087                                             mov                     p3,#0f7h
19ED 20B7CF         4088                                             jb                      p3.7,onmem12
                    4089                                             ;запомнить признак установленной скорости в рпзу
                    4090     
                    4091     ;чтение пам прогр(5000h) 1 страница(ffh)
                    4092     ;и запись во внешнее озу(0000h)
19F0 7900           4093                                             mov             r1,#0                   ;
19F2 7A50           4094                                     mov             r2,#50h
19F4 7B00           4095                                     mov             r3,#00
19F6 120499         4096                                     call    copyPP
                    4097                                     ;внести изменения во внешн озу
                    4098                                     ;KD=00 01 86 A0 (KD=1)
                    4099                                     ;кофф *100000 и переведенный в hex формат
                    4100                                     ;согласно адресов диапазонов и адресов яч вн озу 
19F9 792C           4101                                     mov             r1,#2ch
19FB 7400           4102                                     mov             a,#0;57,6
19FD 301302         4103                                     jnb             bitv19,spwri
1A00 7401           4104                                     mov             a,#1;19.6
1A02 F3             4105     spwri:  movx    @r1,a
                    4106     ;стереть страницу пап прогр 
1A03 905000         4107                                     mov             dptr,#5000h
1A06 7FFF           4108                                     mov             r7,#0ffh
1A08 12043E         4109                                     call    cle256
                    4110     ;и запись в ячейки кофф памяти прогр (3000h) 
1A0B 7FFF           4111                                     mov             r7,#0ffh
1A0D 7900           4112                                     mov             r1,#0                           ;external r
                             am
1A0F 905000         4113                                     mov             dptr,#5000h
1A12 120480         4114                                     call    wrpage
                    4115             
1A15 201305         4116                                     jb              bitv19,outsko1  ;загр Т1 в соотв с установл
                             енной скоростью
1A18 758DF4         4117                                             mov                     TH1,#244                ;57
                             .6
1A1B 8003           4118                                             jmp                     outsko
1A1D 758DDC         4119     outsko1:                                        mov                     TH1,#220           
                                  ;19.6
1A20 C211           4120     outsko:         clr             bitmenu
1A22 D204           4121                                             setb            bitizm
1A24 020000   F     4122                                             jmp                     out7
                    4123     
1A27 020000   F     4124     rlabels4:               jmp             labels4
1A2A 020000   F     4125     rlabelS13:      jmp             labelS13
                    4126     
1A2D B651F7         4127     me_41:          cjne            @r0,#51h,rlabels4
1A30 75B0FB         4128                                             mov             p3,#0fbh;<-
1A33 30B7F4         4129                                             jnb             p3.7,rlabelS13
1A36 75B0F7         4130                                             mov             p3,#0f7h
1A39 20B76D         4131                                             jb              p3.7,vvmenu
                    4132                                             ;ввод пароля
                    4133                                     
                    4134     ;       считать с индикатора 
1A3C 7F0E           4135                                     mov             r7,#14
1A3E 784F           4136                                     mov             r0,#abin
1A40 120000   F     4137                                     call    clearN                  
                    4138                                     
                    4139     ;чтение номера байта с индикатора(3байта)
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    66

                    4140     ;bufind+3..bufind+9
                    4141     ;-  - - -
                    4142     ;- - - - - - - - - -
                    4143     ;adec..adec+9
                    4144     ;ст            мл
1A43 7849           4145                                     mov             r0,#bufind+9;
1A45 795C           4146                                     mov             r1,#adec+9
1A47 7F03           4147                                     mov             r7,#3;3bait
1A49 C3             4148     upav1:          clr             c
1A4A E6             4149                                     mov             a,@r0
1A4B 9430           4150                                     subb    a,#30h
1A4D F7             4151                                     mov             @r1,a
1A4E 18             4152                                     dec             r0
1A4F 19             4153                                     dec             r1
1A50 DFF7           4154                                     djnz    r7,upav1;adec+7..adec+9
1A52 7A50           4155                                             mov                     r2,#50h                    
                                  ;parol 000x    (5028h )
1A54 7B28           4156                                             mov                     r3,#28h
1A56 120454         4157                                             call            re4byte                 ;r8..r11(3 
                             bait parol)
1A59 800F           4158     jmp                     goparol
1A5B E508           4159                                     mov                     a,r8                    ;сравнить п
                             ароль с индикатором
1A5D B55A4C         4160                                     cjne            a,adec+7,parerr
1A60 E509           4161                                     mov                     a,r9    
1A62 B55B47         4162                                     cjne            a,adec+8,parerr
1A65 E50A           4163                                     mov                     a,r10
1A67 B55C42         4164                                     cjne            a,adec+9,parerr
                    4165                                     ;равны
1A6A 78B1           4166     goparol:        mov             r0,#vichR               ;режим меню 52
1A6C 7652           4167                                             mov             @r0,#52h                ;0000-n
1A6E 900000   F     4168                                             mov             dptr,#teKD;00000-nA
1A71 120000   F     4169                                             call            lotext
                    4170                                             ;;;;;;;;;
                    4171                                                     ;n(hex)->abin
1A74 120000   F     4172                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
1A77 2552           4173                                             add             a,abin+3
1A79 F552           4174                                             mov             abin+3,a
1A7B 7853           4175                                             mov             r0,#adec
1A7D 7952           4176                                             mov             r1,#abin+3      ;hex->10
1A7F 120000   F     4177                                             call    bindec
1A82 855C48         4178                                             mov             bufind+8,adec+9
1A85 75472D         4179                                             mov             bufind+7,#2dh
                    4180     
1A88 79AE           4181                                             mov             r1,#diap
1A8A 7848           4182                                             mov             r0,#bufind+8
1A8C E7             4183                                             mov             a,@r1
1A8D B40807         4184                                             cjne    a,#8,nodi8k
1A90 7630           4185                                             mov             @r0,#30h                 ;10-10
1A92 18             4186                                             dec             r0
1A93 7663           4187                                             mov             @r0,#63h;31h
1A95 8008           4188                                             jmp             nodisk9
1A97 B40905         4189     nodi8k:                         cjne    a,#9,nodisk9
                    4190                                     
1A9A 7631           4191                                             mov             @r0,#31h           ;10-11
1A9C 18             4192                                             dec             r0
1A9D 7663           4193                                             mov             @r0,#63h;31h
                    4194                                     
                    4195     
1A9F 78B2           4196     nodisk9:        mov                     r0,#marker
1AA1 7601           4197                                             mov                     @r0,#1
1AA3 753A01         4198                                             mov                     movleft,#1
1AA6 753B05         4199                                             mov                     movrig,#5
                    4200                                             
1AA9 020000   F     4201     vvmenu:         jmp             goto7
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    67

                    4202     
1AAC 753932         4203     parerr:         mov                     nuerr,#32h
1AAF 120000   F     4204                                             call            error
1AB2 120000   F     4205                                             call            ind
1AB5 120000   F     4206                                             call            z_1s
1AB8 C211           4207                                             clr                     bitmenu
1ABA D204           4208                                             setb            bitizm
1ABC 78B2           4209                                             mov                     r0,#marker
1ABE 76FF           4210                                             mov                     @r0,#0ffh
1AC0 020000   F     4211                                             jmp             goto7
                    4212     
1AC3 30130B         4213     left_sk:                jnb                     bitv19,tosk19;<-
1AC6 900000   F     4214                                             mov                     dptr,#teS57_6;57,6
1AC9 120000   F     4215                                             call            lotext
1ACC C213           4216                                             clr                     bitv19
1ACE 020000   F     4217                                             jmp             out7
1AD1 900000   F     4218     tosk19:         mov                     dptr,#teS19_2
1AD4 120000   F     4219                                             call            lotext
1AD7 D213           4220                                             setb            bitv19
1AD9 020000   F     4221                                             jmp             out7
                    4222     
1ADC                4223     labelS13:;<- MENU(ПАРОЛЬ 000)
                    4224             
                    4225     ;;;;;;;;;;;;;;;;;;
                    4226     ;необходимо не портить цифру в следуюем справа знакоместе
                    4227     ;т е сохранить ее в ячейке для мигания в противном случае
                    4228     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4229     ;       знакоместа
1ADC 78B2           4230                                     mov             r0,#marker
1ADE 7440           4231                                     mov             a,#bufind
1AE0 26             4232                                             add             a,@r0                   ;a=bufind+m
                             arker
1AE1 F9             4233                                             mov             r1,a
1AE2 19             4234                                             dec             r1;inc          r1
1AE3 873C           4235                                             mov             savba,@r1
                    4236                                                     
1AE5 78B2           4237                                                     mov             r0,#marker
1AE7 16             4238                                                     dec             @r0                        
                                  
1AE8 C219           4239                                     clr             bitmig
1AEA E53A           4240                                     mov                     a,movleft
1AEC B6064F         4241                                     cjne    @r0,#6,onmem13;;нажата кн <- при вводе цифр ПАРОЛЬ 
                             000
1AEF 06             4242                                     inc             @r0
1AF0 020000   F     4243                                             jmp             goto7
                    4244     ;;;;;;;
                    4245     
1AF3                4246     vvkali52:       ;введено значение для калибровки
                    4247                                             ;число на индикаторе ->Ak  (52h)
                    4248                                             ;       считать с индикатора 
1AF3 7F0E           4249                                     mov             r7,#14
1AF5 784F           4250                                     mov             r0,#abin
1AF7 120000   F     4251                                     call    clearN                  
                    4252                                     
                    4253     ;чтение номера байта с индикатора(3байта)
                    4254     ;bufind+1..bufind+5
                    4255     ;-  - - -
                    4256     ;- - - - - - - - - -
                    4257     ;adec..adec+9
                    4258     ;ст            мл
1AFA 7845           4259                                     mov             r0,#bufind+5;
1AFC 795C           4260                                     mov             r1,#adec+9
1AFE 7F05           4261                                     mov             r7,#5;5bait
1B00 C3             4262     upav2:          clr             c
1B01 E6             4263                                     mov             a,@r0
1B02 9430           4264                                     subb    a,#30h
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    68

1B04 F7             4265                                     mov             @r1,a
1B05 18             4266                                     dec             r0
1B06 19             4267                                     dec             r1
1B07 DFF7           4268                                     djnz    r7,upav2;adec+7..adec+9
                    4269     
1B09 784F           4270                                     mov             r0,#abin
1B0B 7953           4271                                     mov             r1,#adec                        ;мл        
                              ст
1B0D 120000   F     4272                                     call    decbin                  ;abin..abin+3 (hex)
1B10 120000   F     4273                                     call    loadr2                  ;r2..r5
1B13 120402         4274                                     call    altof   ;r2..r5->float
1B16 900000   F     4275                                     mov     dptr,#ch_10;10
1B19 120000   F     4276                                     call    ldc_ltemp                       ;r8..r11=8
1B1C 120203         4277                                     call    flmul
1B1F 78A4           4278                                     mov             r0,#rez_Ak
1B21 120000   F     4279                                     call    saver2
1B24 C211           4280                                             clr                     bitmenu
1B26 D212           4281                                             setb            bitklb
                    4282                                             ;зажечь KMП
1B28 D204           4283                                             setb            bitizm;бит калибровки уже установле
                             н
1B2A 78B2           4284                                             mov                     r0,#marker
1B2C 76FF           4285                                             mov                     @r0,#0ffh
1B2E 783D           4286                                     mov             r0,#chkl
1B30 76FF           4287                                     mov             @r0,#0ffh
1B32 08             4288                                     inc             r0
1B33 76FF           4289                                     mov             @r0,#0ffh;38h
1B35 120000   F     4290                                     call            z_1s
1B38 020000   F     4291                                     jmp             out7
                    4292     
                    4293     
1B3B 020000   F     4294                                             jmp             goto7
                    4295                                              
1B3E 020000   F     4296     onmem13:        jmp             goto7   ;(ie7)
                    4297     
1B41 B642AF         4298     labels4:        cjne            @r0,#42h,vvkali52
1B44 75B0FB         4299                                             mov                     p3,#0fbh;<-
1B47 30B7F4         4300                                             jnb             p3.7,onmem13
1B4A 75B0F7         4301                                             mov             p3,#0f7h;vvod
1B4D 20B7EE         4302                                             jb              p3.7,onmem13
                    4303                                             
                    4304             
1B50 020000   F     4305     jmp             out7                                                    
                    4306     ;;;;;;;
1B53                4307     labelI:
1B53 75B0FE         4308                                     mov             p3,#0feh
1B56 E5B0           4309                                     mov             a,p3
1B58 20E703         4310                                     jb              acc.7,nopoint
                    4311                                     ;
1B5B 020000   F     4312                                     jmp             goto7;out7
                    4313     
1B5E 75B0FB         4314     nopoint:                mov             p3,#0fbh
1B61 E5B0           4315                                     mov             a,p3
1B63 20E72C         4316                                     jb              acc.7,nopoin7
1B66 78B2           4317     labelS3:mov             r0,#marker
1B68 E53A           4318                                     mov             a,movleft
1B6A B40309         4319                                     cjne    a,#3,poina1
1B6D B6030B         4320                                     cjne    @r0,#3,nomarl;26
                    4321                                     ;mov            @r0,#9
1B70 E53B           4322     poina2: mov                     a,movrig                ;кн <- B=+00000
1B72 F6             4323                                     mov                     @r0,a
1B73 020000   F     4324                                     jmp             goto7;  out7
                    4325     
1B76 B60402         4326     poina1:         cjne    @r0,#4,nomarl;кн <- A= 0000
1B79 80F5           4327                                             jmp             poina2
                    4328     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    69

                    4329     
1B7B                4330     nomarl:                 ;                               29.12.06
                    4331     ;;;;;;;;;;;;;;;;;;
                    4332     ;необходимо не портить цифру в следуюем справа знакоместе
                    4333     ;т е сохранить ее в ячейке для мигания в противном случае
                    4334     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4335     ;       знакоместа
1B7B 78B2           4336                                     mov             r0,#marker
1B7D 7440           4337                                     mov             a,#bufind
1B7F 26             4338                                             add             a,@r0                   ;a=bufind+m
                             arker
1B80 F9             4339                                             mov             r1,a
1B81 09             4340                                             inc             r1
1B82 873C           4341                                             mov             savba,@r1
                    4342                                                     
1B84 78B2           4343                                                     mov             r0,#marker
1B86 16             4344                                                     dec             @r0                        
                                  
1B87 C219           4345                                     clr             bitmig
1B89 E53A           4346                                     mov                     a,movleft
1B8B B4036B         4347                                     cjne            a,#3,poinA
1B8E B60266         4348                                     cjne    @r0,#2,gogo7;out7;;нажата кн <- при вводе цифр B=+0
                             0000
1B91 06             4349     poin3:  inc             @r0
                    4350     ;нажат ввод А =000000 запомнить константу А
1B92 75B0F7         4351     nopoin7:           mov          p3,#0f7h
1B95 E5B0           4352                                     mov             a,p3
1B97 20E75D         4353                                     jb              acc.7,gogo7;out7
1B9A 78B1           4354                                     mov             r0,#vichR
1B9C E6             4355                                     mov             a,@r0
1B9D B6215E         4356                                     cjne    @r0,#21h,no21p7
1BA0 7611           4357                                     mov             @r0,#11h
                    4358                             ;       считать с индикатора  упаковать в плавающий формат
                    4359                             ;   сохранить
1BA2 7F0E           4360                                     mov             r7,#14
1BA4 784F           4361                                     mov             r0,#abin
1BA6 120000   F     4362                                     call    clearN                  
1BA9 120000   F     4363                                     call    upakA
                    4364                                     
1BAC 784F           4365                                     mov             r0,#abin
1BAE 7953           4366                                     mov             r1,#adec                        ;мл        
                              ст
1BB0 120000   F     4367                                     call    decbin                  ;abin..abin+3 (hex)
1BB3 120000   F     4368                                     call    loadr2                  ;r2..r5
1BB6 120402         4369                                     call    altof                   ;r2..r5->float
1BB9 78BC           4370                                     mov                     r0,#konstA
1BBB 120000   F     4371                                     call            saver2
1BBE 900000   F     4372                                     mov                     dptr,#ch0
1BC1 120000   F     4373                                     call            ldc_ltemp
1BC4 1201D6         4374                                     call            flcmp
1BC7 6010           4375                                     jz              erra0
                    4376     ;26
1BC9 78B2           4377                                     mov             r0,#marker
1BCB 76FF           4378                                     mov             @r0,#0ffh
                    4379                                     
1BCD 900000   F     4380                                     mov             dptr,#teVICH;teBequ0
1BD0 120000   F     4381                                     call    lotext
                    4382                             ;       call            outB
1BD3 534BBF         4383                                     anl             bufind+11,#0bfh         ;гашение точки bufi
                             nd+7
                    4384                             ;       orl             bufind+11,#80h
1BD6 020000   F     4385                                     jmp             goto7
                    4386     
1BD9 78B2           4387     erra0:          mov             r0,#marker
1BDB 76FF           4388                                             mov             @r0,#0ffh
1BDD 753934         4389                                             mov                     nuerr,#34h;константа не дол
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    70

                             жна быть равна0
1BE0 120000   F     4390                                             call            error
1BE3 120000   F     4391                                             call            ind
1BE6 120000   F     4392                                             call            z_1s
1BE9 78B1           4393                                             mov                     r0,#vichR
1BEB 7600           4394                                             mov                     @r0,#0
1BED C214           4395                                             clr                     bitvich
1BEF C206           4396                                             clr                     bitvi11
1BF1 D204           4397                                             setb            bitizm
1BF3 78B2           4398                                             mov                     r0,#marker
1BF5 76FF           4399                                             mov                     @r0,#0ffh
1BF7 802E           4400     gogo7:          jmp                     out7;goto7
                    4401     
1BF9 B6032B         4402     poinA:          cjne    @r0,#3,out7;;нажата кн <- при вводе цифр A= 0000
1BFC 8093           4403                                             jmp             poin3
                    4404     
1BFE                4405     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    4406                             ;   сохранить
1BFE 7F0E           4407                                     mov             r7,#14
1C00 784F           4408                                     mov             r0,#abin
1C02 120000   F     4409                                     call    clearN                  
1C05 120000   F     4410                                     call    upakB                   
1C08 784F           4411                                     mov             r0,#abin
1C0A 7953           4412                                     mov             r1,#adec                        ;мл        
                              ст
1C0C 120000   F     4413                                     call    decbin                  ;abin..abin+3 (hex)
1C0F 120000   F     4414                                     call    loadr2                  ;r2..r5
1C12 120402         4415                                     call    altof                   ;r2..r5->int
1C15 301B04         4416                                     jnb             bitznB,pozB
1C18 EA             4417                                     mov             a,r2
1C19 4480           4418                                     orl             a,#80h
1C1B FA             4419                                     mov             r2,a                    ;знак-
1C1C                4420     pozB:           ;mov            r0,#konstB
                    4421                                     ;call   saver2
                    4422     
1C1C 79B2           4423                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
1C1E 77FF           4424                                     mov             @r1,#0ffh
1C20 78B1           4425                                     mov             r0,#vichR
1C22 7611           4426                                     mov             @r0,#11h
1C24 020000   F     4427                               jmp           lovich     ;3.01.07ВЫЧИСЛИТЬ
                    4428                                     
                    4429     
1C27                4430     out7:                   ;mov            IE,#80h
1C27 D083           4431                                     pop             dph
1C29 D082           4432                                     pop             dpl
1C2B D007           4433                                     pop             rr7     
1C2D D006           4434                                     pop             rr6
1C2F D005           4435                                     pop             rr5
1C31 D004           4436                                     pop             rr4
1C33 D003           4437                                     pop             rr3
1C35 D002           4438                                     pop             rr2
1C37 D001           4439                                     pop             rr1                             
1C39 D000           4440                                     pop             rr0
1C3B D0D0           4441                                     pop             psw
1C3D D0E0           4442                                     pop             acc
1C3F 75AD00         4443                             mov             P3IF,#00;               обязательно сбросить опять 
                             приходит на обработку прерывания
1C42 75B0C0         4444                             mov             P3,#0c0h
                    4445                             ;       mov             EIE2,#30H
1C45 C219           4446     clr             bitmig
1C47 E586           4447                                             mov             a,P6            ;p6.4=0
1C49 54EF           4448                             anl             a,#0efh
1C4B F586           4449                             mov             P6,a
1C4D 00             4450                             nop
1C4E 00             4451                             nop
                    4452                                     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    71

1C4F E586           4453                             mov             a,P6                    ;p6.4=1 
1C51 4410           4454                             orl             a,#10h
1C53 F586           4455                             mov             P6,a                        
1C55 32             4456                                     reti
                    4457     
                    4458     
                    4459                                     
                    4460     
                    4461     
1C56 78B1           4462     lomenu:         mov             r0,#vichR
1C58 B61107         4463                                             cjne    @r0,#11h,menu12
1C5B 900000   F     4464                                             mov             dptr,#teTESI
1C5E 120000   F     4465     lome1:                  call    lotexT
1C61 22             4466                                             ret
1C62 B61205         4467     menu12:         cjne    @r0,#12h,menu13
1C65 900000   F     4468                                             mov             dptr,#teTESR
1C68 80F4           4469                                             jmp             lome1
1C6A B61305         4470     menu13:         cjne    @r0,#13h,menu14
1C6D 900000   F     4471                                             mov             dptr,#teSKOR
1C70 80EC           4472                                             jmp             lome1
1C72 B61405         4473     menu14:         cjne    @r0,#14h,menu15
1C75 900000   F     4474                                             mov             dptr,#teAVK
1C78 80E4           4475                                             jmp             lome1
1C7A B61505         4476     menu15:                 cjne    @r0,#15h,menu21
1C7D 900000   F     4477                                             mov             dptr,#teKALIB
1C80 80DC           4478                                             jmp             lome1
                    4479     
1C82 B62105         4480     menu21: cjne    @r0,#21h,menu22
1C85 900000   F     4481                                             mov             dptr,#teTE11
1C88 80D4           4482                                             jmp             lome1
1C8A B62205         4483     menu22:         cjne    @r0,#22h,menu23
1C8D 900000   F     4484                                             mov             dptr,#teTE9
1C90 80CC           4485                                             jmp             lome1
1C92 B62305         4486     menu23:         cjne    @r0,#23h,menu31
1C95 900000   F     4487                                             mov             dptr,#teTE7
1C98 80C4           4488                                             jmp             lome1
1C9A B63105         4489     menu31:         cjne    @r0,#31h,menu41
1C9D 900000   F     4490                                             mov             dptr,#teS57_6
1CA0 80BC           4491                                             jmp             lome1
                    4492     
1CA2                4493     menu41:         
1CA2 900000   F     4494                                             mov             dptr,#tePAR
1CA5 80B7           4495                                             jmp             lome1
                    4496     
1CA7 020000   F     4497     yesvi_kr:               jmp                     yesvi_km
1CAA                4498     endkalib:;KD=Ak/A3
1CAA 200DFA         4499                                             jb                      bifl_kt,yesvi_kr;выч кофф К
                             м
1CAD 789C           4500                                             mov                     r0,#rez_A3
1CAF 120000   F     4501                                             call            resar2
                    4502                                     
1CB2 120402         4503                                     call    altof                   ;->float
1CB5 EA             4504                                             mov                     a,r2
1CB6 547F           4505                                             anl                     a,#7fh
1CB8 FA             4506                                             mov                     r2,a
1CB9 120000   F     4507                                     call            move28
1CBC 78A4           4508                                             mov                     r0,#rez_Ak
1CBE 120000   F     4509                                             call            resar2
1CC1 1202B7         4510                                             call            fldiv
                    4511                                                     
1CC4 900000   F     4512                                     mov     dptr,#CHtho;100000
1CC7 120000   F     4513                                     call    ldc_ltemp                       ;r8..r11=8
1CCA 120203         4514                                     call    flmul
1CCD 120343         4515                                     call    ftol            ;r2..r5->hex кофф KD (РЕЗ ИЗМ ЧИСЛО
                              6разрядное)
                    4516     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    72

1CD0 78A0           4517                                             mov                     r0,#koefKD
1CD2 120000   F     4518                                             call            saver2
                    4519                                             ;запись в рпзу в соотв ячейку
                    4520                             
1CD5 7900           4521                                             mov             r1,#0                   ;счит рпзу 
                             во внешн озу
1CD7 7A50           4522                                     mov             r2,#50h
1CD9 7B00           4523                                     mov             r3,#00
1CDB 120499         4524                                     call    copyPP
                    4525                                     ;внести изменения во внешн озу
1CDE 120000   F     4526                                     call            findext                 ;r1-внешн озу
1CE1 78A0           4527                                     mov                     r0,#koefKD
1CE3 120000   F     4528                                             call            resar2
1CE6 EA             4529                                             mov                     a,r2
1CE7 F3             4530                                             movx            @r1,a
1CE8 09             4531                                             inc                     r1
1CE9 EB             4532                                             mov                     a,r3
1CEA F3             4533                                             movx            @r1,a
1CEB 09             4534                                             inc                     r1
1CEC EC             4535                                             mov                     a,r4
1CED F3             4536                                             movx            @r1,a
1CEE 09             4537                                             inc                     r1
1CEF ED             4538                                             mov                     a,r5
1CF0 F3             4539                                             movx            @r1,a
                    4540                                     ;кофф *100000 и переведенный в hex формат
                    4541                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4542     ;стереть страницу пап прогр 
1CF1 905000         4543                                     mov             dptr,#5000h
1CF4 7FFF           4544                                     mov             r7,#0ffh
1CF6 12043E         4545                                     call    cle256
                    4546     ;и запись в ячейки кофф памяти прогр (3000h) 
1CF9 7FFF           4547                                     mov             r7,#0ffh
1CFB 7900           4548                                     mov             r1,#0                           ;external r
                             am
1CFD 905000         4549                                     mov             dptr,#5000h
1D00 120480         4550                                     call    wrpage
                    4551     ;2.2.07
1D03 79AE           4552                                     mov                     r1,#diap
1D05 B70511         4553                                     cjne            @r1,#5,fulkalib
                    4554                                     ;jb                     bifl_kt,yesvi_km;выч кофф Км
1D08 D20D           4555                                     setb            bifl_kt
                    4556                                     ;call           loadus
1D0A 900000   F     4557                                     mov                     dptr,#tabt7;заслать ус 7А       
1D0D E4             4558                             clr             a
1D0E 93             4559                             movc    a,@a+dptr                               ;high byte
1D0F F584           4560                             mov             p4,a
1D11 A3             4561                             inc             dptr
1D12 E4             4562                             clr             a
1D13 93             4563                             movc    a,@a+dptr                               ;low byte
1D14 F585           4564                             mov             p5,a
1D16 020000   F     4565                                     jmp             goto7;  out_kali
                    4566     
                    4567     ;;;
1D19                4568     fulkalib:
1D19 C212           4569                                             clr             bitklb
1D1B D216           4570                                             setb    bitpar                  ;пароль провели 1 р
                             аз успешно
1D1D 900000   F     4571                                             mov             dptr,#teEND
1D20 120000   F     4572                                             call    lotext
1D23 120000   F     4573                                             call    ind
1D26 120000   F     4574     out_kali:       call    z_1s
1D29 120000   F     4575                                             call    z_1s
1D2C 020000   F     4576                                             jmp             goto7
1D2F                4577     yesvi_km:               ;выч кофф Км=(10**5/A2)*K7/K5
1D2F 7A50           4578                                     mov                     r2,#50h                 ;-11a
1D31 7B14           4579                                     mov                     r3,#14h                 ;k7
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    73

1D33 12046C         4580                                     call            rebyte2                         ;r2..r5- he
                             x
1D36 120402         4581                                     call            altof                   ;r2..r5->float
1D39 C002           4582                                     push            rr2
1D3B C003           4583                                     push            rr3
1D3D C004           4584                                     push            rr4
1D3F C005           4585                                     push            rr5
1D41 7A50           4586                                     mov                     r2,#50h                 ;k5
1D43 7B0C           4587                                     mov                     r3,#0ch
1D45 12046C         4588                             call            rebyte2                 ;r2..r5
1D48 120402         4589                                     call            altof                   ;r2..r5->float
1D4B 120000   F     4590                                     call            move28
1D4E D005           4591                                     pop                     rr5
1D50 D004           4592                                     pop                     rr4
1D52 D003           4593                                     pop                     rr3
1D54 D002           4594                                     pop                     rr2
1D56 1202B7         4595                                     call            fldiv                   ;K7/K5
                    4596     
1D59 900000   F     4597                                     mov     dptr,#CHtho;100000
1D5C 120000   F     4598                                     call    ldc_ltemp                       ;r8..r11=8
1D5F 120203         4599                                     call    flmul                           ;r2..r5 ;K7/K5*10**
                             5
1D62 C002           4600                                     push            rr2
1D64 C003           4601                                     push            rr3
1D66 C004           4602                                     push            rr4
1D68 C005           4603                                     push            rr5
                    4604                                     
1D6A 789C           4605                                     mov                     r0,#rez_A3
1D6C 120000   F     4606                                     call            resar2
1D6F 120402         4607                                     call            altof                           ;r2..r5->fl
                             oat
1D72 120000   F     4608                                     call            move28
1D75 D005           4609                                     pop                     rr5
1D77 D004           4610                                     pop                     rr4
1D79 D003           4611                                     pop                     rr3
1D7B D002           4612                                     pop                     rr2
1D7D 1202B7         4613                               call          fldiv           ;Km     
                    4614     
1D80 900000   F     4615                                     mov     dptr,#CHtho;100000
1D83 120000   F     4616                                     call    ldc_ltemp                       ;r8..r11=8
1D86 120203         4617                                     call    flmul                           ;r2..r5
1D89 120343         4618                                     call    ftol                    ;r2..r5->hex кофф Km(РЕЗ ИЗ
                             М ЧИСЛО 6разрядное)
1D8C 78A0           4619                                     mov                     r0,#koefKD;2ое исп ячейки koefKD
1D8E 120000   F     4620                                     call            saver2
                    4621                                     ;запись в рпзу в соотв ячейку
1D91 7900           4622                                     mov             r1,#0                   ;счит рпзу во внешн
                              озу
1D93 7A50           4623                                     mov             r2,#50h
1D95 7B00           4624                                     mov             r3,#00
1D97 120499         4625                                     call    copyPP
                    4626                                     ;внести изменения во внешн озу
1D9A 78A0           4627                                     mov                     r0,#koefKD
1D9C 120000   F     4628                                     call            resar2
1D9F 792C           4629                                     mov                     r1,#2ch                 ;r1-внешн о
                             зу кофф Km
                    4630                             
1DA1 EA             4631                                     mov                     a,r2
1DA2 F3             4632                                             movx            @r1,a
1DA3 09             4633                                             inc                     r1
1DA4 EB             4634                                             mov                     a,r3
1DA5 F3             4635                                             movx            @r1,a
1DA6 09             4636                                             inc                     r1
1DA7 EC             4637                                             mov                     a,r4
1DA8 F3             4638                                             movx            @r1,a
1DA9 09             4639                                             inc                     r1
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    74

1DAA ED             4640                                             mov                     a,r5
1DAB F3             4641                                             movx            @r1,a
                    4642                                     ;кофф *100000 и переведенный в hex формат
                    4643                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4644     ;стереть страницу пап прогр 
1DAC 905000         4645                                     mov             dptr,#5000h
1DAF 7FFF           4646                                     mov             r7,#0ffh
1DB1 12043E         4647                                     call    cle256
                    4648     ;и запись в ячейки кофф памяти прогр (3000h) 
1DB4 7FFF           4649                                     mov             r7,#0ffh
1DB6 7900           4650                                     mov             r1,#0                           ;external r
                             am
1DB8 905000         4651                                     mov             dptr,#5000h
1DBB 120480         4652                                     call    wrpage
                    4653     
1DBE C20D           4654                                             clr             bifl_kt
1DC0 120000   F     4655                                             call    loadus
1DC3 020000   F     4656                                             jmp             fulkalib
                    4657     
                    4658     ;выч среднего по блоку
                    4659     ;вых r2..r5
1DC6                4660     vichmean:       
1DC6 120000   F     4661                                             call            resa_hl;save_bl->dptr
1DC9 78D7           4662                                             mov                     r0,#copy_hl
1DCB E583           4663                                             mov                     a,dph
1DCD F6             4664                                             mov                     @r0,a
1DCE 08             4665                                             inc                     r0
1DCF E582           4666                                             mov                     a,dpl
1DD1 F6             4667                                             mov                     @r0,a
1DD2 78B8           4668                                             mov                     r0,#work
1DD4 120000   F     4669                                             call            clear4
1DD7 78D6           4670                                             mov                     r0,#chblok;volume
1DD9 7600           4671                                             mov                     @r0,#0
1DDB 120000   F     4672     meng:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1DDE E582           4673                                             mov                     a,dpl
1DE0 FF             4674                                             mov                     r7,a
1DE1 E583           4675                                             mov                     a,dph
1DE3 FE             4676                                             mov                     r6,a
                    4677     
1DE4 78D7           4678                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1DE6 E6             4679                                             mov                     a,@r0
1DE7 F583           4680                                             mov                     dph,a
1DE9 08             4681                                             inc                     r0
1DEA E6             4682                                             mov                     a,@r0
1DEB F582           4683                                             mov                     dpl,a
                    4684                                             
1DED C3             4685                                             clr                     c;-4
1DEE E582           4686                                             mov                     a,dpl
1DF0 9404           4687                                             subb            a,#4
1DF2 F582           4688                                             mov                     dpl,a
1DF4 E583           4689                                             mov                     a,dph
1DF6 9400           4690                                             subb            a,#0
1DF8 F583           4691                                             mov                     dph,a;dptr-4
                    4692                                             ;;;;;;;;
1DFA 79D7           4693                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1DFC E583           4694                                                     mov             a,dph
1DFE F7             4695                                               mov           @r1,a
1DFF 09             4696                                                     inc             r1
1E00 E582           4697                                                     mov             a,dpl
1E02 F7             4698                                                     mov             @r1,a
                    4699                                                     ;;;;;;;;;
1E03 C3             4700                                                     clr             c;пришли в начало блока?
1E04 E582           4701                                                     mov                     a,dpl
1E06 9F             4702                                                     subb            a,r7
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    75

1E07 FF             4703                                                     mov                     r7,a
1E08 7006           4704                                                     jnz                     nextmea
1E0A E583           4705                                                     mov                     a,dph
1E0C 9E             4706                                                     subb            a,r6
1E0D FE             4707                                                     mov                     r6,a
1E0E 601B           4708                                                     jz                      outmea;
                    4709                                                     
                    4710                                                     ;продолжаем сравнение
                    4711                                                     ;;;;;;;;;;;             
1E10 120000   F     4712     nextmea:                call            loahl_r2        ;из яч внешн озу ->r2..r5
1E13 120402         4713                                             call            altof;->float
1E16 120000   F     4714                                             call            move28                  ;r8..r11
1E19 78B8           4715                                             mov                     r0,#work
1E1B 120000   F     4716                                             call            resar2
1E1E 120166         4717                                             call            fladd
1E21 78B8           4718                                             mov                     r0,#work
1E23 120000   F     4719                                             call            saver2
1E26 78D6           4720                                             mov                     r0,#chblok;volume;кол измер
                             ений блока
1E28 06             4721                                             inc                     @r0
1E29 80B0           4722                                             jmp                     meng
1E2B                4723     outmea:         
1E2B 120000   F     4724                                             call            loahl_r2        ;из яч внешн озу ->
                             r2..r5
1E2E 120402         4725                                             call            altof;->float
1E31 120000   F     4726                                             call            move28                  ;r8..r11
1E34 78B8           4727                                             mov                     r0,#work
1E36 120000   F     4728                                             call            resar2
1E39 120166         4729                                             call            fladd
1E3C 78B8           4730                                             mov                     r0,#work
1E3E 120000   F     4731                                             call            saver2
1E41 E4             4732                                             clr                     a
1E42 FA             4733                                             mov                     r2,a
1E43 FB             4734                                             mov                     r3,a
1E44 FC             4735                                             mov                     r4,a
1E45 78D6           4736                                             mov                     r0,#chblok;volume;кол измер
                             ений блока...200d
1E47 E6             4737                                             mov                     a,@r0
1E48 2401           4738                                             add                     a,#1
1E4A FD             4739                                             mov                     r5,a
1E4B 120402         4740                                             call            altof;r2..r5 float
1E4E 120000   F     4741                                             call            move28
1E51 78B8           4742                                             mov                     r0,#work
1E53 120000   F     4743                                             call            resar2
1E56 1202B7         4744                                             call            fldiv
1E59 900000   F     4745                                             mov                     dptr,#ch_10      
1E5C 120000   F     4746                                     call            ldc_ltemp
1E5F 1202B7         4747                                     call            fldiv
1E62 120343         4748                                             call            ftol                            ;->
                             hex
1E65 120000   F     4749                                             call    maform
1E68 784F           4750                                             mov             r0,#abin
1E6A 120000   F     4751                                             call    saver2
                    4752     ;;;;;;;;
                    4753                                             
1E6D 7853           4754                                             mov             r0,#adec
1E6F 7952           4755                                             mov             r1,#abin+3      ;hex->10
1E71 120000   F     4756                                             call    bindec
                    4757                                     
1E74 785C           4758                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1E76 7949           4759                                             mov             r1,#bufind+9
1E78 7F05           4760                                             mov             r7,#5
1E7A E6             4761     bufmea:                         mov             a,@r0
1E7B 2430           4762                                             add             a,#30h
1E7D F7             4763                                             mov             @r1,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    76

1E7E 19             4764                                             dec             r1
1E7F 18             4765                                             dec             r0
1E80 DFF8           4766                                             djnz    r7,bufmea
1E82 7844           4767                                             mov             r0,#bufind+4
1E84 762B           4768                                             mov             @r0,#2bh          
1E86 300202         4769                                             jnb             znmat,nozmea
1E89 762D           4770                                             mov             @r0,#2dh
1E8B 434B05         4771     nozmea:         orl             bufind+11,#05h
1E8E 22             4772                                             ret
                    4773     
                    4774     
1E8F E0             4775     loahl_r2:       movx            a,@dptr         ;из яч внешн озу ->r2..r5
1E90 FA             4776                                             mov                     r2,a
1E91 A3             4777                                             inc                     dptr
1E92 E0             4778                                             movx            a,@dptr
1E93 FB             4779                                             mov                     r3,a
1E94 A3             4780                                             inc                     dptr
1E95 E0             4781                                             movx            a,@dptr
1E96 FC             4782                                             mov                     r4,a
1E97 A3             4783                                             inc                     dptr
1E98 E0             4784                                             movx            a,@dptr
1E99 FD             4785                                             mov                     r5,a    
1E9A 22             4786                                             ret
                    4787     
1E9B C3             4788     min4_hl:        clr                     c;-4
1E9C E582           4789                                             mov                     a,dpl
1E9E 9404           4790                                             subb            a,#4
1EA0 F582           4791                                             mov                     dpl,a
1EA2 E583           4792                                             mov                     a,dph
1EA4 9400           4793                                             subb            a,#0
1EA6 F583           4794                                             mov                     dph,a;dptr-4
1EA8 22             4795                                             ret
                    4796     
                    4797     ;мин значение по по блоку
1EA9                4798     vichmin:        
1EA9 120000   F     4799                                             call            resa_hl;save_bl->dptr
                    4800                                                                                     
                    4801     ;с конца блока адрес 2го измерение
1EAC 120000   F     4802                                             call            min4_hl
                    4803                                             
1EAF 78B8           4804                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4805                                             
1EB1 E0             4806                                             movx            a,@dptr
1EB2 F6             4807                                             mov                     @r0,a
1EB3 08             4808                                             inc                     r0
1EB4 A3             4809                                             inc                     dptr
1EB5 E0             4810                                             movx            a,@dptr
1EB6 F6             4811                                             mov                     @r0,a
1EB7 08             4812                                             inc                     r0
1EB8 A3             4813                                             inc                     dptr
1EB9 E0             4814                                             movx            a,@dptr
1EBA F6             4815                                             mov                     @r0,a
1EBB 08             4816                                             inc                     r0
1EBC A3             4817                                             inc                     dptr
1EBD E0             4818                                             movx            a,@dptr
1EBE F6             4819                                             mov                     @r0,a
1EBF A3             4820                                             inc                     dptr
                    4821                                             
1EC0 78B8           4822                                             mov                     r0,#work
1EC2 120000   F     4823                                             call            resar2
1EC5 120402         4824                                             call            altof;->float;r2..r5
1EC8 78B8           4825                                             mov                     r0,#work
1ECA 120000   F     4826                                             call            saver2
                    4827     
1ECD 120000   F     4828                                             call            min4_hl
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    77

                    4829                                             ;call           min4_hl
                    4830     
1ED0 78D7           4831                                             mov                     r0,#copy_hl
1ED2 E583           4832                                             mov                     a,dph
1ED4 F6             4833                                             mov                     @r0,a
1ED5 08             4834                                             inc                     r0
1ED6 E582           4835                                             mov                     a,dpl
1ED8 F6             4836                                             mov                     @r0,a
                    4837                                     
1ED9 78D6           4838                                             mov                     r0,#chblok;volume
1EDB 7600           4839                                             mov                     @r0,#0
1EDD 120000   F     4840     ming:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1EE0 E582           4841                                             mov                     a,dpl
1EE2 FF             4842                                             mov                     r7,a
1EE3 E583           4843                                             mov                     a,dph
1EE5 FE             4844                                             mov                     r6,a
                    4845     
1EE6 78D7           4846                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1EE8 E6             4847                                             mov                     a,@r0
1EE9 F583           4848                                             mov                     dph,a
1EEB 08             4849                                             inc                     r0
1EEC E6             4850                                             mov                     a,@r0
1EED F582           4851                                             mov                     dpl,a
                    4852                                             
1EEF C3             4853                                             clr                     c;-4
1EF0 E582           4854                                             mov                     a,dpl
1EF2 9404           4855                                             subb            a,#4
1EF4 F582           4856                                             mov                     dpl,a
1EF6 E583           4857                                             mov                     a,dph
1EF8 9400           4858                                             subb            a,#0
1EFA F583           4859                                             mov                     dph,a;dptr-4
                    4860                                             ;;;;;;;;
1EFC 79D7           4861                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1EFE E583           4862                                                     mov             a,dph
1F00 F7             4863                                               mov           @r1,a
1F01 09             4864                                                     inc             r1
1F02 E582           4865                                                     mov             a,dpl
1F04 F7             4866                                                     mov             @r1,a
                    4867                                                     ;;;;;;;;;
1F05 C3             4868                                                     clr             c;пришли в начало блока?
1F06 E582           4869                                                     mov                     a,dpl
1F08 9F             4870                                                     subb            a,r7
1F09 FF             4871                                                     mov                     r7,a
1F0A 7006           4872                                                     jnz                     nextmin
1F0C E583           4873                                                     mov                     a,dph
1F0E 9E             4874                                                     subb            a,r6
1F0F FE             4875                                                     mov                     r6,a
1F10 601D           4876                                                     jz                      outmin;
                    4877                                                     
                    4878                                                     ;продолжаем сравнение
                    4879                                                     ;;;;;;;;;;;             
1F12 78B8           4880     nextmin:        mov                     r0,#work
1F14 120000   F     4881                                             call            resar2
                    4882                                             ;call           altof;->float;r2..r5
1F17 120000   F     4883                                             call            move28;->r8..r11
1F1A 120000   F     4884                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4885     
1F1D 120402         4886                                             call            altof;->float;r2..r5
                    4887                                             
1F20 1201D6         4888                                             call            flcmp
1F23 5005           4889                                             jnc                     nomini
1F25 78B8           4890                                             mov                     r0,#work;<
1F27 120000   F     4891                                             call            saver2;r2..r5
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    78

1F2A 78D6           4892     nomini:                 mov                     r0,#chblok;volume;кол измерений блока
1F2C 06             4893                                             inc                     @r0
1F2D 80AE           4894                                             jmp                     ming
                    4895     
1F2F 78B8           4896     outmin:         mov                     r0,#work;1ое измерение блока
1F31 120000   F     4897                                             call            resar2
                    4898                                     ;       call            altof;->float;r2..r5
1F34 120000   F     4899                                             call            move28;->r8..r11
1F37 120000   F     4900                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4901     
1F3A 120402         4902                                             call            altof;->float;r2..r5
                    4903                                             
1F3D 1201D6         4904                                             call            flcmp
1F40 5005           4905                                             jnc                     minivix
1F42 78B8           4906                                             mov                     r0,#work;<
1F44 120000   F     4907                                             call            saver2;r2..r5
                    4908                                             ;;;;;;;;;
                    4909     
1F47 78B8           4910     minivix:        mov                     r0,#work
1F49 120000   F     4911                                             call            resar2
                    4912     
                    4913                                             ;call           altof;->float
                    4914                                     
1F4C 900000   F     4915                                             mov                     dptr,#ch_10      
1F4F 120000   F     4916                                             call            ldc_ltemp
1F52 1202B7         4917                                             call            fldiv
1F55 120343         4918                                             call            ftol                            ;->
                             hex
                    4919                                             ;;;
1F58 120000   F     4920                                             call            maform
1F5B 784F           4921                                             mov                     r0,#abin
1F5D 120000   F     4922                                             call            saver2
                    4923     ;;;;;;;;
                    4924                                             
1F60 7853           4925                                             mov             r0,#adec
1F62 7952           4926                                             mov             r1,#abin+3      ;hex->10
1F64 120000   F     4927                                             call    bindec
                    4928                                     
1F67 785C           4929                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1F69 7949           4930                                             mov             r1,#bufind+9
1F6B 7F05           4931                                             mov             r7,#5
1F6D E6             4932     bufmin:                         mov             a,@r0
1F6E 2430           4933                                             add             a,#30h
1F70 F7             4934                                             mov             @r1,a
1F71 19             4935                                             dec             r1
1F72 18             4936                                             dec             r0
1F73 DFF8           4937                                             djnz    r7,bufmin
1F75 7844           4938                                             mov             r0,#bufind+4
1F77 762B           4939                                             mov             @r0,#2bh          
1F79 300202         4940                                             jnb             znmat,nozmin
1F7C 762D           4941                                             mov             @r0,#2dh
1F7E 434B05         4942     nozmin:         orl             bufind+11,#05h
1F81 22             4943                                             ret
                    4944     
                    4945     
                    4946     
                    4947     ;мин значение по по блоку
1F82                4948     vichmax:        
1F82 120000   F     4949                                             call            resa_hl;save_bl->dptr
                    4950                                             
                    4951                                             
                    4952     ;с конца блока адрес 2го измерение
1F85 120000   F     4953                                             call            min4_hl
                    4954                                             
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    79

1F88 78B8           4955                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4956                                             
1F8A E0             4957                                             movx            a,@dptr
1F8B F6             4958                                             mov                     @r0,a
1F8C 08             4959                                             inc                     r0
1F8D A3             4960                                             inc                     dptr
1F8E E0             4961                                             movx            a,@dptr
1F8F F6             4962                                             mov                     @r0,a
1F90 08             4963                                             inc                     r0
1F91 A3             4964                                             inc                     dptr
1F92 E0             4965                                             movx            a,@dptr
1F93 F6             4966                                             mov                     @r0,a
1F94 08             4967                                             inc                     r0
1F95 A3             4968                                             inc                     dptr
1F96 E0             4969                                             movx            a,@dptr
1F97 F6             4970                                             mov                     @r0,a
1F98 A3             4971                                             inc                     dptr
                    4972                                             
1F99 78B8           4973                                             mov                     r0,#work
1F9B 120000   F     4974                                             call            resar2
1F9E 120402         4975                                             call            altof;->float;r2..r5
1FA1 78B8           4976                                             mov                     r0,#work
1FA3 120000   F     4977                                             call            saver2
                    4978     
1FA6 120000   F     4979                                             call            min4_hl
                    4980                                     ;       call            min4_hl
                    4981     
1FA9 78D7           4982                                             mov                     r0,#copy_hl
1FAB E583           4983                                             mov                     a,dph
1FAD F6             4984                                             mov                     @r0,a
1FAE 08             4985                                             inc                     r0
1FAF E582           4986                                             mov                     a,dpl
1FB1 F6             4987                                             mov                     @r0,a
                    4988                                     
1FB2 78D6           4989                                             mov                     r0,#chblok;volume
1FB4 7600           4990                                             mov                     @r0,#0
1FB6 120000   F     4991     maxg:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1FB9 E582           4992                                             mov                     a,dpl
1FBB FF             4993                                             mov                     r7,a
1FBC E583           4994                                             mov                     a,dph
1FBE FE             4995                                             mov                     r6,a
                    4996     
1FBF 78D7           4997                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1FC1 E6             4998                                             mov                     a,@r0
1FC2 F583           4999                                             mov                     dph,a
1FC4 08             5000                                             inc                     r0
1FC5 E6             5001                                             mov                     a,@r0
1FC6 F582           5002                                             mov                     dpl,a
                    5003                                             
1FC8 C3             5004                                             clr                     c;-4
1FC9 E582           5005                                             mov                     a,dpl
1FCB 9404           5006                                             subb            a,#4
1FCD F582           5007                                             mov                     dpl,a
1FCF E583           5008                                             mov                     a,dph
1FD1 9400           5009                                             subb            a,#0
1FD3 F583           5010                                             mov                     dph,a;dptr-4
                    5011                                             ;;;;;;;;
1FD5 79D7           5012                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1FD7 E583           5013                                                     mov             a,dph
1FD9 F7             5014                                               mov           @r1,a
1FDA 09             5015                                                     inc             r1
1FDB E582           5016                                                     mov             a,dpl
1FDD F7             5017                                                     mov             @r1,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    80

                    5018                                                     ;;;;;;;;;
1FDE C3             5019                                                     clr             c;пришли в начало блока?
1FDF E582           5020                                                     mov                     a,dpl
1FE1 9F             5021                                                     subb            a,r7
1FE2 FF             5022                                                     mov                     r7,a
1FE3 7006           5023                                                     jnz                     nextmax
1FE5 E583           5024                                                     mov                     a,dph
1FE7 9E             5025                                                     subb            a,r6
1FE8 FE             5026                                                     mov                     r6,a
1FE9 601D           5027                                                     jz                      outmax;
                    5028                                                     
                    5029                                                     ;продолжаем сравнение
                    5030                                                     ;;;;;;;;;;;             
1FEB 78B8           5031     nextmax:        mov                     r0,#work
1FED 120000   F     5032                                             call            resar2
                    5033                                             ;call           altof;->float;r2..r5
1FF0 120000   F     5034                                             call            move28;->r8..r11
1FF3 120000   F     5035                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5036     
1FF6 120402         5037                                             call            altof;->float;r2..r5
                    5038                                             
1FF9 1201D6         5039                                             call            flcmp
1FFC 4005           5040                                             jc                      nomaxi
1FFE 78B8           5041                                             mov                     r0,#work;>
2000 120000   F     5042                                             call            saver2;r2..r5
2003 78D6           5043     nomaxi:                 mov                     r0,#chblok;volume;кол измерений блока
2005 06             5044                                             inc                     @r0
2006 80AE           5045                                             jmp                     maxg
2008 78B8           5046     outmax:         mov                     r0,#work;1ое измерение блока
200A 120000   F     5047                                             call            resar2
                    5048                                     ;       call            altof;->float;r2..r5
200D 120000   F     5049                                             call            move28;->r8..r11
2010 120000   F     5050                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    5051     
2013 120402         5052                                             call            altof;->float;r2..r5
                    5053                                             
2016 1201D6         5054                                             call            flcmp
2019 4005           5055                                             jc                      maxvix
201B 78B8           5056                                             mov                     r0,#work;>
201D 120000   F     5057                                             call            saver2;r2..r5
                    5058                                             ;;;;;;;;;
                    5059     
2020 020000   F     5060     maxvix:         jmp             minivix
                    5061     
                    5062     
                    5063     
                    5064     ;$include (d:\amp\subr6.asm) 
                +1  5065     
                +1  5066     ;тест интерфейса
2023            +1  5067     testrs: ;jb     p0.3,goprogr
2023 C2AC       +1  5068                                     clr     IE.4
2025 759955     +1  5069     test1:  mov     SBUF0,#55h
2028 3099FD     +1  5070                                     jnb     SCON0.1,$
202B 78B8       +1  5071                                     mov     r0,#work;chtest
202D 76BE       +1  5072                                     mov     @r0,#190d;60
                +1  5073     
202F 309825     +1  5074     test01: jnb     SCON0.0,test2
2032 E599       +1  5075                                     mov     a,SBUF0
2034 B45512     +1  5076                                     cjne    a,#55h,test3
2037 C299       +1  5077     test4:  clr     SCON0.1
2039 C298       +1  5078                                     clr     SCON0.0
203B 7D0A       +1  5079                                     mov     r5,#10
203D 7840       +1  5080                                     mov     r0,#bufind              ;- - - -
203F 762D       +1  5081     test04: mov     @r0,#2dh
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    81

2041 08         +1  5082                                     inc     r0
2042 DDFB       +1  5083                                     djnz    r5,test04
2044 120000   F +1  5084                                     call    ind
2047 80DC       +1  5085                                     jmp     test1
2049            +1  5086     test3:  
2049 753933     +1  5087                                     mov     nuerr,#33h
204C 120000   F +1  5088                                     call    error           ;на кран прибора ERR 3
                +1  5089                             
204F 120000   F +1  5090                                     call    ind;
2052 120000   F +1  5091                                     call    z_01s           ;100ms
2055 80E0       +1  5092                                     jmp     test4
2057 78B8       +1  5093     test2:  mov     r0,#work;chtest
2059 B60002     +1  5094                                     cjne    @r0,#0,test02
205C 8003       +1  5095                                     jmp     test5
205E 16         +1  5096     test02: dec     @r0
205F 80CE       +1  5097                                     jmp     test01
2061 120000   F +1  5098     test5:  call    z_1ms           ;1ms
2064 C299       +1  5099                                     clr     SCON0.1
                +1  5100             
2066 753933     +1  5101                                     mov     nuerr,#33h
2069 120000   F +1  5102                                     call    error           ;на кран прибора ERR 3
                +1  5103                                     
206C 120000   F +1  5104                                     call    ind
206F 120000   F +1  5105                                     call    z_01s           ;100ms
2072 80B1       +1  5106                                     jmp     test1   
                +1  5107     
                +1  5108     
                +1  5109     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
2074 75E700     +1  5110      ind:   mov             EIE2,#00H;mov   IE,#00h
2077 120000   F +1  5111                     call    mign
207A 7840       +1  5112                      mov            r0,#bufind;+11
207C 7F0C       +1  5113                      mov            r7,#12
207E C287       +1  5114      nexin: clr             p0.7;6
2080 E6         +1  5115                     mov             a,@r0
2081 F59B       +1  5116                     mov             SPI0DAT,a
2083 20FBFD     +1  5117                     jb              TXBSY,$
2086 D287       +1  5118                     setb    p0.7;6
2088 120000   F +1  5119                     call    z_9             ;25mks
208B 08         +1  5120                     inc             r0;dec          r0
208C DFF0       +1  5121                     djnz    r7,nexin
208E 75E730     +1  5122                     mov             EIE2,#30H;mov   IE,#80h
2091 22         +1  5123                ret
                +1  5124     
                +1  5125     
2092 7A08       +1  5126     zapadc:   mov R2,#8
2094 D297       +1  5127     sdv:      setb P1.7
2096 33         +1  5128               rlc A
2097 9296       +1  5129                     mov P1.6,C
2099 120000   F +1  5130                     call tim2
                +1  5131                                     
209C C297       +1  5132                     clr P1.7
209E 120000   F +1  5133                     call tim2
20A1 DAF1       +1  5134                     djnz R2,sdv
20A3 D296       +1  5135                     setb P1.6
20A5 22         +1  5136                     ret
                +1  5137     
20A6 7A08       +1  5138     chtadc:   mov R2,#8
20A8 D297       +1  5139     sdv1:     setb P1.7
20AA 120000   F +1  5140               call tim2
20AD C297       +1  5141                     clr P1.7
20AF A296       +1  5142                     mov C,P1.6
20B1 33         +1  5143                     rlc A
20B2 120000   F +1  5144                     call tim2
20B5 DAF1       +1  5145                     djnz R2,sdv1
20B7 22         +1  5146                     ret
                +1  5147     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    82

20B8 7E30       +1  5148     tim:      mov R6,#30h;38h
20BA DEFE       +1  5149     tim1:     djnz R6,tim1
20BC 22         +1  5150               ret
                +1  5151               
20BD 7E10       +1  5152     tim2:     mov R6,#10h;14h
20BF DEFE       +1  5153     tim3:     djnz R6,tim3
20C1 22         +1  5154               ret
                +1  5155     
                +1  5156     ;запись из acc
20C2 C3         +1  5157     write_x1: clr   c
20C3            +1  5158     writeD_x1:
20C3 92B1       +1  5159                       mov P3.1,c        ;запись
20C5 F5A0       +1  5160               mov P2,A
20C7 D2B3       +1  5161                       setb P3.3
20C9 120000   F +1  5162                       call z_5
20CC C2B3       +1  5163                       clr P3.3
20CE 75A0FF     +1  5164                       mov P2,#0FFh
20D1 22         +1  5165                       ret
                +1  5166     
                +1  5167     ;чтение в acc
20D2 C3         +1  5168     read_x2:  clr   c  
20D3 92B1       +1  5169               mov P3.1,c        ;чтение
20D5 D2B2       +1  5170               setb P3.2
20D7 D2B3       +1  5171                       setb P3.3
20D9 120000   F +1  5172                     call z_5
20DC E5A0       +1  5173                       mov A,P2
20DE C2B3       +1  5174                       clr P3.3
20E0 C2B2       +1  5175                       clr P3.2
20E2 22         +1  5176                       ret
                +1  5177     
                +1  5178     
20E3 120000   F +1  5179     loop:     call read_x2;x2    ;ожидание флага готовности
20E6 20E7FA     +1  5180                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
20E9 22         +1  5181                        ret           ;возврат, если бит А(7)<>1
                +1  5182                                      
                +1  5183                                        
                +1  5184     
                +1  5185     
                +1  5186     
                +1  5187     
                +1  5188     
                +1  5189     
                +1  5190     
                +1  5191     ;принимаемый байт в acc
                +1  5192     ;прием байта последовательным кодом старшими разрядами вперед
20EA 7A08       +1  5193     read:    mov R2,#8
20EC C297       +1  5194     re1:     clr P1.7;P1.2
20EE 120000   F +1  5195              call tim2        ;5mks
20F1 A294       +1  5196                     mov C,P1.4;P1.0
20F3 33         +1  5197                     rlc A           
20F4 D297       +1  5198                     setb P1.7;P1.2
20F6 120000   F +1  5199                     call tim2
20F9 DAF1       +1  5200                     djnz R2,re1
20FB 22         +1  5201                     ret
                +1  5202     
                +1  5203      ;in r0-count   
                +1  5204     ;r10,r11-значение с котоым сравнивается счетчик
                +1  5205     ;r2..r5 -значение счетчика
20FC            +1  5206     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
20FC E6         +1  5207                     mov                     a,@r0
20FD FC         +1  5208                     mov                     r4,a
20FE 08         +1  5209                     inc                     r0
20FF E6         +1  5210                     mov                     a,@r0
2100 FD         +1  5211                     mov                     r5,a
2101 7B00       +1  5212                     mov                     r3,#0
2103 7A00       +1  5213                     mov                     r2,#0
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    83

2105 750800     +1  5214                     mov                     r8,#0;clr                       r8
2108 750900     +1  5215                     mov                     r9,#0;clr                       r9
210B 120000   F +1  5216                     call            lcmp
210E 22         +1  5217                     ret
                +1  5218     
                +1  5219     
                +1  5220     ;in-r1-count
210F            +1  5221     chdec:          ;mov            r1,#chavt               ;chavt-1
210F E7         +1  5222                             mov             a,@r1
2110 FC         +1  5223                             mov             r4,a
2111 09         +1  5224                             inc             r1
2112 E7         +1  5225                             mov             a,@r1
2113 FD         +1  5226                             mov             r5,a
2114 C202       +1  5227                             clr             rr2
2116 C203       +1  5228                             clr             rr3
2118 900000   F +1  5229                             mov             dptr,#ch1        
211B 120000   F +1  5230                             call    ldc_ltemp
211E 120000   F +1  5231                             call    lsub
2121 ED         +1  5232                             mov             a,r5
2122 F7         +1  5233                             mov             @r1,a
2123 19         +1  5234                             dec             r1
2124 EC         +1  5235                             mov             a,r4
2125 F7         +1  5236                             mov             @r1,a
                +1  5237                             
2126 22         +1  5238                             ret      
                +1  5239     
                +1  5240     
                +1  5241     
                +1  5242     
2127            +1  5243     loadUS: ;если идет тест измерения ус восстановить для теста
2127 201533     +1  5244                                     jb              biteizm,yestest
212A 79AE       +1  5245                                             mov             r1,#diap
212C E7         +1  5246                             mov             a,@r1
212D 23         +1  5247                             rl              a;*2
212E FC         +1  5248                             mov             r4,a                    ;save a
212F 900000   F +1  5249                             mov             dptr,#tabus
2132 93         +1  5250                             movc    a,@a+dptr
2133 FA         +1  5251                             mov             r2,a                    ;high byte
2134 E584       +1  5252                             mov             a,p4
2136 5401       +1  5253                             anl             a,#01
2138 4A         +1  5254                             orl             a,r2
2139 F584       +1  5255                             mov             p4,a
213B 0C         +1  5256                             inc             r4
213C EC         +1  5257                             mov             a,r4
213D 93         +1  5258                             movc    a,@a+dptr
213E FB         +1  5259                             mov             r3,a                    ;low byte
213F E585       +1  5260                             mov             a,p5
2141 5401       +1  5261                             anl             a,#01
2143 4B         +1  5262                             orl             a,r3
2144 F585       +1  5263                             mov             p5,a
2146 799A       +1  5264                             mov             r1,#parT
2148 B7010E     +1  5265                             cjne    @r1,#1,bret
214B 79AE       +1  5266                             mov             r1,#diap                  ;10s (parT=1)
214D 7405       +1  5267                             mov             a,#5                      ;10-8..10-11 p4.1=1
214F C3         +1  5268                             clr             c
2150 97         +1  5269                             subb    a,@r1
2151 5006       +1  5270                             jnc             bret
2153 E584       +1  5271                             mov             a,p4
2155 4402       +1  5272                             orl             a,#02
2157 F584       +1  5273                             mov             p4,a                     ;10-8..10-11 p4.1=1
2159 120000   F +1  5274     bret:      call          louizm         ;us если вкл кн ИЗМЕР
215C 22         +1  5275                             ret
215D            +1  5276     yestest:
215D 120000   F +1  5277                             call            lotpus          ;ус теста измерения
2160 22         +1  5278                             ret
                +1  5279                             
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    84

                +1  5280     ;загр ус для кор 0
                +1  5281     ;dptr-
2161 E4         +1  5282     lospus:         clr             a
                +1  5283                             ;movc   a,@a+dptr
                +1  5284                             ;mov            r2,a                    ;high byte
                +1  5285                             ;mov            a,p4
                +1  5286                             ;anl            a,#01
                +1  5287                             ;orl            a,r2
                +1  5288                             ;mov            p4,a
                +1  5289                             ;inc            dptr
2162 E4         +1  5290                             clr             a
2163 93         +1  5291                             movc    a,@a+dptr
2164 FB         +1  5292                             mov             r3,a                    ;low byte
2165 E585       +1  5293                             mov             a,p5
2167 54BF       +1  5294                             anl             a,#0bfh;01
2169 4B         +1  5295                             orl             a,r3
216A F585       +1  5296                             mov             p5,a
216C 22         +1  5297                             ret
                +1  5298     
216D 80         +1  5299     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                +1  5300     
                +1  5301     ;us кнопка измерения выкл
216E 88D6       +1  5302     tabus:     db           88h,0d6h         ;10-2
2170 88F6       +1  5303                             db      88h,0f6h         ;10-3
2172 88D6       +1  5304                             db              88h,0d6h         ;10-4
2174 88F6       +1  5305                             db              88h,0f6h         ;10-5
2176 9AD6       +1  5306                             db      9ah,0d6h         ;10-6
2178 9AF6       +1  5307                             db              9ah,0f6h         ;10-7
217A ACD6       +1  5308                             db              0ach,0d6h        ;10-8
217C ACF6       +1  5309                             db      0ach,0f6h        ;10-9
217E C8D6       +1  5310                             db              0c8h,0d6h        ;10-10
2180 C8F6       +1  5311                             db              0c8h,0f6h        ;10-11
                +1  5312     
2182            +1  5313     tabt11: 
2182 66E6       +1  5314                             db              66h,0e6h;10-11
2184            +1  5315     tabt9:  
2184 32E6       +1  5316                             db              32h,0e6h;10-9
2186            +1  5317     tabt7:  
2186 18EE       +1  5318                             db              18h,0eeh;10-7
                +1  5319     
                +1  5320      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  5321     ;в зав от parT (Tизм)
2188 79B7       +1  5322     loadT:          mov             r1,#load;parT
218A 7840       +1  5323     lolevT:         mov             r0,#bufind+0
218C 7B0A       +1  5324                             mov             r3,#10
218E 75F00A     +1  5325                             mov             b,#10
2191 E7         +1  5326                             mov             a,@r1
2192 A4         +1  5327                             mul             ab
2193 FC         +1  5328                             mov             r4,a                    ;save a
2194 900000   F +1  5329                             mov             dptr,#textT
2197 93         +1  5330             lod1:   movc    a,@a+dptr
2198 F6         +1  5331                             mov             @r0,a
2199 08         +1  5332                             inc             r0
219A 0C         +1  5333                             inc             r4
219B EC         +1  5334                             mov             a,r4
219C DBF9       +1  5335                             djnz    r3,lod1
219E 534B03     +1  5336                             anl                     bufind+11,#03h          ;гашение точек
21A1 22         +1  5337                             ret     
                +1  5338     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  5339     ;dptr-адр строки текста         
21A2            +1  5340     lotext:         
21A2 7B0A       +1  5341                             mov             r3,#10
21A4 7840       +1  5342                             mov             r0,#bufind+0
21A6 E4         +1  5343     lodt:           clr             a
21A7 93         +1  5344                             movc    a,@a+dptr
21A8 F6         +1  5345                             mov             @r0,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    85

21A9 08         +1  5346                             inc             r0
21AA A3         +1  5347                             inc             dptr
21AB DBF9       +1  5348                             djnz    r3,lodt
21AD 534B03     +1  5349                             anl                     bufind+11,#03h          ;гашение точек
21B0 22         +1  5350                             ret                                     
                +1  5351     
                +1  5352     
                +1  5353     
                +1  5354     
                +1  5355      ;задержка 100 мкс
21B1 7978       +1  5356     z_100:    mov R1,#78h     ;загрузка первого числа
21B3 7A02       +1  5357     z100:     mov R2,#2h     ;загрузка второго числа
21B5 DAFE       +1  5358     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
21B7 D9FA       +1  5359               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
21B9 22         +1  5360               ret           
                +1  5361     
                +1  5362     ;задержка 34 мкс
21BA 7B8B       +1  5363     z_5:      mov R3,#8Bh      ;загрузка числа
21BC DBFE       +1  5364     ct:       djnz R3,ct
21BE 22         +1  5365               ret
                +1  5366     
                +1  5367     ;задержка 15 мс
21BF 79FA       +1  5368     z_15:     mov R1,#0FAh    ;загрузка первого числа
21C1 7AED       +1  5369     z15:      mov R2,#0EDh   ;загрузка второго числа
21C3 DAFE       +1  5370     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
21C5 D9FA       +1  5371               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
21C7 22         +1  5372               ret   
                +1  5373                                               
                +1  5374      ;задержка 1 мс
21C8 7910       +1  5375     z_1ms:     mov R1,#10h     
21CA 7AED       +1  5376     ss1:       mov R2,#0EDh    
21CC DAFE       +1  5377                djnz R2, $    
21CE D9FA       +1  5378                djnz R1, ss1   
21D0 22         +1  5379                ret   
                +1  5380     
                +1  5381      ;????????
                +1  5382     ;задержка 1с
21D1 7D1F       +1  5383     z_1s:   mov             r5,#01fh 
21D3 7EFF       +1  5384     co2s:   mov     R6,#0ffh     
21D5 7FFF       +1  5385     z1s:     mov    R7,#0ffh     
21D7 DFFE       +1  5386     co1s:   djnz    R7, co1s        
21D9 DEFA       +1  5387             djnz    R6, z1s 
21DB DDF6       +1  5388                     djnz    r5,co2s
21DD 22         +1  5389               ret
                +1  5390     ;задержка 0,1с
21DE 7D03       +1  5391     z_01s:           mov            r5,#03h 
21E0 7EFF       +1  5392     co02s:          mov     R6,#0ffh     
21E2 7FFF       +1  5393     z01s:           mov     R7,#0ffh     
21E4 DFFE       +1  5394                             djnz    R7, $   
21E6 DEFA       +1  5395                     djnz    R6, z01s 
21E8 DDF6       +1  5396                             djnz    r5,co02s
21EA 22         +1  5397                      ret
                +1  5398                                               
                +1  5399     ;задержка 0,5с
21EB 7D0D       +1  5400     z_05s:           mov            r5,#0dh 
21ED 7EFF       +1  5401     co05s:                  mov     R6,#0ffh     
21EF 7FFF       +1  5402     z05s:           mov     R7,#0ffh     
21F1 DFFE       +1  5403                                     djnz    R7, $   
21F3 DEFA       +1  5404                     djnz    R6, z05s 
21F5 DDF6       +1  5405                                             djnz    r5,co05s
21F7 22         +1  5406                      ret                                                     
                +1  5407                                                               
21F8 000007FF   +1  5408     chzap:  db      00,00,07h,0ffh             
21FC 00000000   +1  5409     ch0:    db      00,00,00,00
2200 0000000A   +1  5410     ch10:   db      00,00,00,0ah                            ;10
2204 00000005   +1  5411     ch5:    db      00,00,00,05                                             ;5
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    86

2208 00000004   +1  5412     ch4:    db      00,00,00,04                                             ;4
220C 000003B9   +1  5413     ch954:  db 00,00,03,0b9h                                                ;954
2210 000003E8   +1  5414     ch10000:        db 00,00,03h,0e8h                                               ;10000
2214 00000064   +1  5415     ch100:  db 00,00,00,64h ;100
2218 00000002   +1  5416     ch2:    db      00,00,00,02                                             
                +1  5417     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  5418     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  5419     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
221C 00000001   +1  5420     ch1:    db  00,00,00,01
2220 49742400   +1  5421     ch_mln: db      49h,74h,24h,00;10*6
2224 3F800000   +1  5422     ch_1:   db      3fh,80h,00,00   
2228 40000000   +1  5423     ch_2:   db      40h,00,00,00;2
222C 40800000   +1  5424     ch_4:   db      40h,80h,00,00;4 
2230 40A00000   +1  5425     ch_5:   db      40h,0a0h,00,00;5
2234 40E00000   +1  5426     ch_7:   db      40h,0e0h,00,00;7
                +1  5427             
2238 3F741EDF   +1  5428     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
223C 47C35000   +1  5429     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
2240 3F800347   +1  5430     KD:             db      3fh,80h,03h,47h;1,0001
2244 48435000   +1  5431     CH2tho: db      48h,43h,50h,00;200000
2248 4856D800   +1  5432     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
224C 4856D800   +1  5433     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
2250 461C4000   +1  5434     ch_10th:db  46h,1ch,40h,00;10000-2710h
2254 41200000   +1  5435     ch_10:  db      41h,20h,00,00;10d
2258 48742400   +1  5436     ch_250: db      48h,74h,24h,00;250000
225C 000186A0   +1  5437     chk:            db      00,01,86h,0a0h;
2260 00000320   +1  5438     ch320h: db      00,00,03h,20h;320h=800d
2264 00000150   +1  5439     ch150h: db      00,00,01h,50h;150h
2268 C0400000   +1  5440     ch_m3:  db      0c0h,40h,00,00;-3
                +1  5441     
                +1  5442     
                +1  5443     ;r1- мл байт 2х байтного числа
226C            +1  5444     tenmin:         ;-10
226C C3         +1  5445                             clr             c
226D E7         +1  5446                     mov             a,@r1
226E 9405       +1  5447                             subb    a,#5;10
2270 F7         +1  5448                             mov             @r1,a
2271 19         +1  5449                             dec             r1
2272 E7         +1  5450                             mov             a,@r1
2273 9400       +1  5451                             subb    a,#0
2275 F7         +1  5452                             mov             @r1,a
2276 22         +1  5453                             ret
                +1  5454       ;r0-обнуление ячеек памяти  
2277 7F04       +1  5455       clear4:        mov    r7,#4
2279 E4         +1  5456                             clr             a
227A F6         +1  5457       cl4:          mov             @r0,a
227B 08         +1  5458                             inc             r0
227C DFFC       +1  5459                             djnz    r7,cl4
227E 22         +1  5460                             ret     
                +1  5461     
                +1  5462      ;r0-обнуление ячеек памяти 
                +1  5463      ;R7- 
227F            +1  5464       clearN:        
227F E4         +1  5465                             clr             a
2280 F6         +1  5466       cl4N:         mov             @r0,a
2281 08         +1  5467                             inc             r0
2282 DFFC       +1  5468                             djnz    r7,cl4N
2284 22         +1  5469                             ret     
                +1  5470     
                +1  5471       ;чтение номера байта с индикатора(2байта)
                +1  5472     ;bufind+8..bufind+9
                +1  5473     ;-  - - -
                +1  5474     ;- - - - - - - - - -
                +1  5475     ;adec..adec+9
                +1  5476     ;ст            мл
2285 7848       +1  5477     upak2:  mov             r0,#bufind+8;
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    87

2287 795C       +1  5478                     mov             r1,#adec+9
2289 7F02       +1  5479                     mov             r7,#2;2bait
228B C3         +1  5480     upa2:   clr             c
228C E6         +1  5481                     mov             a,@r0
228D 9430       +1  5482                     subb    a,#30h
228F F7         +1  5483                     mov             @r1,a
2290 18         +1  5484                     dec             r0
2291 19         +1  5485                     dec             r1
2292 DFF7       +1  5486                     djnz    r7,upa2
2294 22         +1  5487                     ret  
                +1  5488     
                +1  5489     
                +1  5490         
                +1  5491      ;bufind+4..bufind+9
                +1  5492     ;-  - - -
                +1  5493     ;- - - - - - - - - -
                +1  5494     ;adec..adec+9
                +1  5495     ;ст            мл
2295 7849       +1  5496     upak:   mov             r0,#bufind+9;
2297 795C       +1  5497                     mov             r1,#adec+9
2299 7F06       +1  5498                     mov             r7,#6
229B C3         +1  5499     upa:    clr             c
229C E6         +1  5500                     mov             a,@r0
229D 9430       +1  5501                     subb    a,#30h
229F F7         +1  5502                     mov             @r1,a
22A0 18         +1  5503                     dec             r0
22A1 19         +1  5504                     dec             r1
22A2 DFF7       +1  5505                     djnz    r7,upa
22A4 22         +1  5506                     ret
                +1  5507     
                +1  5508      ;чтение номера байта с индикатора(3байта)
                +1  5509     ;bufind+3..bufind+9
                +1  5510     ;-  - - -
                +1  5511     ;- - - - - - - - - -
                +1  5512     ;adec..adec+9
                +1  5513     ;ст            мл
22A5 7849       +1  5514     upak3:  mov             r0,#bufind+9;
22A7 795C       +1  5515                     mov             r1,#adec+9
22A9 7F03       +1  5516                     mov             r7,#3;3bait
22AB C3         +1  5517     upa1:   clr             c
22AC E6         +1  5518                     mov             a,@r0
22AD 9430       +1  5519                     subb    a,#30h
22AF F7         +1  5520                     mov             @r1,a
22B0 18         +1  5521                     dec             r0
22B1 19         +1  5522                     dec             r1
22B2 DFF7       +1  5523                     djnz    r7,upa1
22B4 22         +1  5524                     ret
                +1  5525     
                +1  5526     ;вых-r2,r3-адрес ячее памяти прогр
22B5            +1  5527     findkoef:
22B5 79AE       +1  5528                                     mov             r1,#diap
22B7 E7         +1  5529                                     mov             a,@r1
22B8 23         +1  5530                                     rl              a                                          
                                          ;diap*2(2bait )
22B9 FC         +1  5531                                     mov             r4,a                                    ;sa
                             ve
22BA 900000   F +1  5532                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  5533                                     
22BD 93         +1  5534                                     movc    a,@a+dptr                       ;ст байт
22BE FA         +1  5535                                     mov             r2,a
22BF A3         +1  5536                                     inc             dptr
22C0 EC         +1  5537                                     mov             a,r4
22C1 93         +1  5538                                     movc    a,@a+dptr
22C2 FB         +1  5539                                     mov             r3,a                    ;мл байт
22C3 22         +1  5540                                     ret
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    88

                +1  5541     ;r2..r5 в опр яч внешн озу
22C4            +1  5542     findext:
22C4 79AE       +1  5543                                     mov             r1,#diap
22C6 E7         +1  5544                                     mov             a,@r1
22C7 23         +1  5545                                     rl              a                                          
                                          ;diap*2(2bait )
22C8 23         +1  5546                                     rl              a                                          
                                          ;diap*2(2bait )
22C9 F9         +1  5547                                     mov             r1,a                                    ;r1
                             -номер ячейки внешнего озу
                +1  5548                                     
22CA 22         +1  5549                                     ret
                +1  5550     
                +1  5551     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  5552     ;(5000h..5027h)
22CB 5000       +1  5553     diKDw:  dw              5000h                   ;10-2
22CD 5004       +1  5554                                     dw              5004h                   ;10-3
22CF 5008       +1  5555                                     dw              5008h                   ;10-4
22D1 500C       +1  5556                                     dw              500ch                   ;10-5
22D3 5010       +1  5557                                     dw              5010h                   ;10-6
22D5 5014       +1  5558                                     dw              5014h                   ;10-7
22D7 5018       +1  5559                                     dw              5018h                   ;10-8
22D9 501C       +1  5560                                     dw              501ch                   ;10-9
22DB 5020       +1  5561                                     dw              5020h                   ;10-10
22DD 5024       +1  5562                                     dw              5024h                   ;10-11
22DF 5028       +1  5563     dipar:  dw              5028h                   ;parol
22E1 502C       +1  5564     diKm:           dw              502ch                   ;Km для теста измерения
22E3 000186A0   +1  5565     chthou: db      00,01,86h,0a0h  ;100.000
                +1  5566     
22E7 AA08       +1  5567     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
22E9 AB09       +1  5568                                             mov     r3,ltemp+1
22EB AC0A       +1  5569                                             mov     r4,ltemp+2
22ED AD0B       +1  5570                                             mov     r5,ltemp+3
22EF 22         +1  5571                                             ret
                +1  5572     ;bufind+4..bufind+9
                +1  5573     ;-  - - -
                +1  5574     ;- - - - - - - - - -
                +1  5575     ;adec..adec+9
                +1  5576     ;ст            мл
22F0 7847       +1  5577     upakA:  mov             r0,#bufind+7;
22F2 795C       +1  5578                     mov             r1,#adec+9
22F4 7F04       +1  5579                     mov             r7,#4
22F6 C3         +1  5580     upaa4:  clr             c
22F7 E6         +1  5581                     mov             a,@r0
22F8 9430       +1  5582                     subb    a,#30h
22FA F7         +1  5583                     mov             @r1,a
22FB 18         +1  5584                     dec             r0
22FC 19         +1  5585                     dec             r1
22FD DFF7       +1  5586                     djnz    r7,upaa4
22FF 22         +1  5587                     ret
                +1  5588     
                +1  5589     ;bufind+4..bufind+9
                +1  5590     ;-  - - -
                +1  5591     ;- - - - - - - - - -
                +1  5592     ;adec..adec+9
                +1  5593     ;ст            мл
2300 7848       +1  5594     upakB:  mov             r0,#bufind+8;
2302 795C       +1  5595                     mov             r1,#adec+9
2304 7F05       +1  5596                     mov             r7,#5
2306 C3         +1  5597     upab:   clr             c
2307 E6         +1  5598                     mov             a,@r0
2308 9430       +1  5599                     subb    a,#30h
230A F7         +1  5600                     mov             @r1,a
230B 18         +1  5601                     dec             r0
230C 19         +1  5602                     dec             r1
230D DFF7       +1  5603                     djnz    r7,upab
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    89

230F C21B       +1  5604                     clr                     bitznB
2311 E543       +1  5605                     mov             a,bufind+3
2313 B42D02     +1  5606                     cjne            a,#2dh,abret
2316 D21B       +1  5607                     setb            bitznB
2318            +1  5608     abret:
2318 22         +1  5609                     ret
2319            +1  5610     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
2319 4E6E6AA8   +1  5611                                             db      4eh,6eh,6ah,0a8h;10**9
231D 43FA0000   +1  5612     CH_500:         db              43h,0fah,00,00;1fah=500
2321 4856D800   +1  5613     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
2325 49742400   +1  5614     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  5615     
                +1  5616     
                +1  5617     
                +1  5618     ;управление AD7731
                +1  5619     ;r4=b1 r5=b2
2329            +1  5620     iniacp: ;управление AD7731
2329 7403       +1  5621                             mov             a,#03
                +1  5622     
232B 120000   F +1  5623                             call    write
232E EC         +1  5624                             mov             a,r4;#80h
232F 120000   F +1  5625                             call    write
2332 ED         +1  5626                             mov             a,r5;#04
2333 120000   F +1  5627                             call    write
2336 7402       +1  5628                             mov             a,#02
2338 120000   F +1  5629                             call    write
233B 74A1       +1  5630                             mov             a,#0a1h
233D 120000   F +1  5631                             call    write
2340 7474       +1  5632                             mov             a,#74h
2342 120000   F +1  5633                             call    write
2345 2095FD     +1  5634                             jb              p1.5,$;p1.3,$
2348 7402       +1  5635                             mov             a,#02
234A 120000   F +1  5636                             call    write
234D 7481       +1  5637                             mov             a,#81h
234F 120000   F +1  5638                             call    write
2352 7474       +1  5639                             mov             a,#74h
2354 120000   F +1  5640                             call    write
2357 2095FD     +1  5641                             jb              p1.5,$;p1.3,$
235A 7402       +1  5642                             mov             a,#02
235C 120000   F +1  5643                             call    write
235F 7421       +1  5644                             mov             a,#21h
2361 120000   F +1  5645                             call    write
2364 7474       +1  5646                             mov             a,#74h
2366 120000   F +1  5647                             call    write
2369 22         +1  5648                             ret
                +1  5649                             ;;;;;;;;;;;;;;;;
                +1  5650     ;;;;;;;;;;;;;;;;;
                +1  5651     ;;;;;;;;;;;;;;;;;
236A 0000       +1  5652     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
236C 6000       +1  5653                                     db              60h,00h;40h,04h         ;10s
236E 6000       +1  5654                                     db              60h,00;40h,04h          ;1s
2370 6000       +1  5655                                     db              60h,00h;40h,04h         ;0,1s
2372 6000       +1  5656                                     db              60h,00h;20h,04h         ;50ms
2374 6000       +1  5657                                     db              60h,00h;20h,04h          ;10ms
2376 1332       +1  5658                                     db              13h,32h         ;2ms
                +1  5659     
                +1  5660     ;загр В1,В2 в завис от Т                                
2378 799A       +1  5661     loab12:                 mov             r1,#parT
237A 900000   F +1  5662                                     mov             dptr,#tabB1_2
237D E7         +1  5663                                     mov             a,@r1
237E 23         +1  5664                                     rl              a;*2
237F FF         +1  5665                                     mov             r7,a                    ;save a
2380 93         +1  5666                                     movc    a,@a+dptr
2381 FC         +1  5667                                     mov             r4,a   ;b1
2382 0F         +1  5668                                     inc             r7
2383 EF         +1  5669                                     mov             a,r7
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    90

2384 93         +1  5670                                     movc    a,@a+dptr
2385 FD         +1  5671                                     mov             r5,a
                +1  5672                                     ;после загр В1,2 загр упр слово для нового Т
                +1  5673                             
2386 22         +1  5674                                     ret
                +1  5675     
                +1  5676     
2387 7852       +1  5677     loadr2: mov             r0,#abin+3              ;r2..r5
2389 E6         +1  5678                     mov             a,@r0                   ; ст мл   
238A FA         +1  5679                     mov             r2,a
238B 18         +1  5680                     dec             r0
238C E6         +1  5681                     mov             a,@r0
238D FB         +1  5682                     mov             r3,a
238E 18         +1  5683                     dec             r0
238F E6         +1  5684                     mov             a,@r0
2390 FC         +1  5685                     mov             r4,a
2391 18         +1  5686                     dec             r0
2392 E6         +1  5687                     mov             a,@r0
2393 FD         +1  5688                     mov             r5,a
2394 22         +1  5689                     ret
                +1  5690                                             
                +1  5691      ;;;;;;;;;;;;;;;;;;;      
                +1  5692      ;загрузка KD в зависимости от диап изм  
                +1  5693      ;koef->r8..r11
2395 78AE       +1  5694     loadKD:                 mov             r0,#diap
2397 E6         +1  5695                                     mov             a,@r0
2398 900000   F +1  5696                                     mov             dptr,#diKDn
239B 75F004     +1  5697                                     mov             b,#4
239E A4         +1  5698                                     mul             ab
239F FF         +1  5699                                     mov             r7,a;save
23A0 93         +1  5700                                     movc    a,@a+dptr
23A1 F508       +1  5701                                     mov             r8,a
23A3 A3         +1  5702                                     inc             dptr
23A4 EF         +1  5703                                     mov             a,r7
23A5 93         +1  5704                                     movc    a,@a+dptr
23A6 F509       +1  5705                                     mov             r9,a
23A8 A3         +1  5706                                     inc             dptr
23A9 EF         +1  5707                                     mov             a,r7
23AA 93         +1  5708                                     movc    a,@a+dptr
23AB F50A       +1  5709                                     mov             r10,a
23AD A3         +1  5710                                     inc             dptr
23AE EF         +1  5711                                     mov             a,r7
23AF 93         +1  5712                                     movc    a,@a+dptr
23B0 F50B       +1  5713                                     mov             r11,a
23B2 22         +1  5714                                     ret
                +1  5715     
23B3 3F506B7B   +1  5716      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
23B7 3F507FCC   +1  5717                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
23BB 3F4F9D0B   +1  5718                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
23BF 3F4FE869   +1  5719                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
23C3 3F50294A   +1  5720                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
23C7 3F50639E   +1  5721                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
23CB 3F4BC9F0   +1  5722                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
23CF 3F4C063B   +1  5723                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
23D3 3F50EFDD   +1  5724                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
23D7 3F512AD9   +1  5725                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  5726     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    91

23DB 00000039   +1  5727     ch57:   db      00,00,00,39h;57
23DF 00000014   +1  5728     ch20:   db      00,00,00,14h;20
                +1  5729     
                +1  5730     ;загр ус для тестов ацп 
                +1  5731     ;dptr-
23E3 78B1       +1  5732     lotpus: mov             r0,#vichR
23E5 B6210D     +1  5733                                     cjne    @r0,#21h,te22
23E8 900000   F +1  5734                                     mov                     dptr,#tabt11;заслать ус 11А
23EB E4         +1  5735     lotp:           clr             a
23EC 93         +1  5736                             movc    a,@a+dptr                               ;high byte
23ED F584       +1  5737                             mov             p4,a
23EF A3         +1  5738                             inc             dptr
23F0 E4         +1  5739                             clr             a
23F1 93         +1  5740                             movc    a,@a+dptr                               ;low byte
23F2 F585       +1  5741                             mov             p5,a
23F4 22         +1  5742                             ret
23F5 B62205     +1  5743     te22:                   cjne    @r0,#22h,te23
23F8 900000   F +1  5744                             mov                     dptr,#tabt9;заслать ус 9А       
23FB 80EE       +1  5745                             jmp                     lotp
                +1  5746     
23FD 900000   F +1  5747     te23:   mov                     dptr,#tabt7;заслать ус 7А       
2400 80E9       +1  5748                             jmp                     lotp
                +1  5749     
                +1  5750     
                +1  5751     
                +1  5752     
                +1  5753     
2402 02030405   +1  5754     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
2406 06070809                
240A 0A0B                    
                +1  5755     
240C 78AE       +1  5756     findR:                  mov                     r0,#diap
240E E6         +1  5757                                                     mov                     a,@r0
240F 900000   F +1  5758                                                     mov                     dptr,#Tabn
2412 93         +1  5759                                                     movc            a,@a+dptr
2413 22         +1  5760                                                     ret
                +1  5761     ;bufind=30h..39h                                                                           
                                           ;
2414 C219       +1  5762     vvchif:                 clr             bitmig
2416 79B2       +1  5763                                     mov             r1,#marker
2418 E7         +1  5764                                     mov             a,@r1                   ;изм цифры
2419 7840       +1  5765                                     mov             r0,#bufind                      ;0000
241B 28         +1  5766                                     add             a,r0
241C F8         +1  5767                                     mov             r0,a
241D 06         +1  5768                                     inc             @r0
241E B63A03     +1  5769                                     cjne    @r0,#3ah,chif
2421 7630       +1  5770                                     mov             @r0,#30h
2423 22         +1  5771                                     ret
2424 C3         +1  5772     chif:           clr                     c
2425 7430       +1  5773                                     mov                     a,#30h
2427 96         +1  5774                                     subb            a,@r0
2428 4002       +1  5775                                     jc                      chif5
242A 7630       +1  5776                                     mov             @r0,#30h
242C 22         +1  5777     chif5:  ret
                +1  5778     
242D 80E5       +1  5779     vvnol41:        jmp                     vvchif  ;при наборе цифр в интервале и константах
                +1  5780     
242F B641FB     +1  5781     vvnol31:        cjne            @r0,#41h,vvnol41
2432 800A       +1  5782                                             jmp                     chifour
2434 B631F8     +1  5783     vvnol23:        cjne            @r0,#31h,vvnol31
2437 8005       +1  5784                                             jmp                     chifour 
                +1  5785     
2439 78B0       +1  5786     vvchibl:        mov                     r0,#level
243B B623F6     +1  5787                                             cjne            @r0,#23h,vvnol23;при наборе цифр в 
                             блоке
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    92

243E C219       +1  5788     chifour:                clr             bitmig
2440 79B2       +1  5789                                     mov             r1,#marker
2442 E7         +1  5790                                     mov             a,@r1                   ;изм цифры
2443 7840       +1  5791                                     mov             r0,#bufind                      ;1..4
2445 28         +1  5792                                     add             a,r0
2446 F8         +1  5793                                     mov             r0,a
2447 06         +1  5794                                     inc             @r0
2448 B63504     +1  5795                                     cjne    @r0,#35h,chifb
244B 7631       +1  5796                                     mov             @r0,#31h
244D 8006       +1  5797                                     jmp             chifb1
244F B63003     +1  5798     chifb:  cjne    @r0,#30h,chifb1
2452 7631       +1  5799                                     mov             @r0,#31h
2454 22         +1  5800                                     ret
2455            +1  5801     chifb1:;;;;;;;;;;
2455 C3         +1  5802                                     clr                     c
2456 7430       +1  5803                                     mov                     a,#30h
2458 96         +1  5804                                     subb            a,@r0
2459 4002       +1  5805                                     jc                      chifl5
245B 7630       +1  5806                                     mov             @r0,#30h
                +1  5807                                     
245D 22         +1  5808     chifl5: ret
                +1  5809     ;;;;;;;;;;;;;
245E 22         +1  5810             ret
                +1  5811       ;перевод маркера влево
245F            +1  5812     marle:  
245F C219       +1  5813                     clr             bitmig
                +1  5814                     ;mov            savba,#0   нельзя обнулять
2461 78B2       +1  5815             mov             r0,#marker
2463 16         +1  5816                     dec             @r0
2464 E6         +1  5817                     mov             a,@r0
2465 C3         +1  5818                     clr             c
2466 953A       +1  5819                     subb    a,movleft         ;крайне левое положение
2468 5001       +1  5820                     jnc             rler
246A 06         +1  5821                     inc             @r0
246B 22         +1  5822     rler:   ret
                +1  5823         
                +1  5824     ;перевод маркера вправо
246C C219       +1  5825     marri:  clr             bitmig
246E 78B2       +1  5826                     mov             r0,#marker
2470 06         +1  5827                     inc         @r0
2471 E53B       +1  5828                     mov             a,movrig           ;крайне правое положение
2473 C3         +1  5829                     clr             c
2474 96         +1  5830                     subb    a,@r0
2475 5001       +1  5831                     jnc             rrir
2477 16         +1  5832                     dec             @r0
2478 22         +1  5833     rrir:   ret
                +1  5834         
                +1  5835     ;konstA->bufind+4..bufind+7
2479 78BC       +1  5836     outA:           mov                     r0,#konstA
247B 120000   F +1  5837                                     call            resar2
247E 120343     +1  5838                                     call            ftol                    ;->hex
2481 784F       +1  5839                                     mov             r0,#abin
2483 120000   F +1  5840                                     call            saver2
2486 7853       +1  5841                                     mov                     r0,#adec
2488 7952       +1  5842                                     mov             r1,#abin+3
248A 120000   F +1  5843                                     call            bindec
248D 785C       +1  5844                                     mov                     r0,#adec+9
248F 7947       +1  5845                                     mov                     r1,#bufind+7
2491 7F04       +1  5846                                     mov                     r7,#4
2493 E6         +1  5847     outa2:  mov             a,@r0
2494 2430       +1  5848                               add           a,#30h
2496 F7         +1  5849                                     mov             @r1,a
2497 19         +1  5850                                     dec             r1
2498 18         +1  5851                                     dec             r0
2499 DFF8       +1  5852                                     djnz    r7,outa2
249B 22         +1  5853                                     ret
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    93

                +1  5854                                             
                +1  5855     ;konstB->bufind+4..bufind+8
                +1  5856     ;outB:          mov                     r0,#konstB
                +1  5857     ;                               call            resar2
                +1  5858     ;                               mov                     a,r2
                +1  5859     ;                               anl                     a,#80h
                +1  5860     ;                               jz                      outb3
                +1  5861     ;mov                    a,r2
                +1  5862     ;                               anl                     a,#7fh
                +1  5863     ;                               mov                     r2,a
                +1  5864     ;                               mov                     bufind+3,#2dh
                +1  5865     ;outb3: call            ftol                    ;->hex
                +1  5866     ;                               mov             r0,#abin
                +1  5867     ;                               call            saver2
                +1  5868     ;                               mov                     r0,#adec
                +1  5869     ;                               mov             r1,#abin+3
                +1  5870     ;                               call            bindec
                +1  5871     ;                               mov                     r0,#adec+9
                +1  5872     ;                               mov                     r1,#bufind+8
                +1  5873     ;                               mov                     r7,#5
                +1  5874     ;outb2: mov             a,@r0
                +1  5875     ;                         add           a,#30h
                +1  5876     ;                               mov             @r1,a
                +1  5877     ;                               dec             r1
                +1  5878     ;                               dec             r0
                +1  5879     ;                               djnz    r7,outb2
                +1  5880     ;                               ret
                +1  5881     
                +1  5882     
                +1  5883     ;пп мигания индикации
249C 78B2       +1  5884     mign:           mov             r0,#marker
                +1  5885                                     
249E B6FF03     +1  5886                                     cjne    @r0,#0ffh,mignn
                +1  5887                                     ;реж изм мигает *
24A1 C219       +1  5888                                     clr             bitmig
24A3 22         +1  5889                                     ret
                +1  5890     
24A4            +1  5891     mignn:                  ;clr            c
24A4 7440       +1  5892                                     mov             a,#bufind
24A6 26         +1  5893                                     add             a,@r0                   ;a=bufind+marker
24A7 F9         +1  5894                                     mov             r1,a
24A8 201907     +1  5895                                     jb              bitmig,onmig
24AB 873C       +1  5896                                     mov             savba,@r1
                +1  5897                             ;       mov             a,@r1
                +1  5898                             ;       mov             savba,a
24AD 7720       +1  5899                                     mov             @r1,#" "
                +1  5900                                     
24AF D219       +1  5901                                     setb    bitmig
24B1 22         +1  5902                                     ret
                +1  5903     
24B2 A73C       +1  5904     onmig:                  mov             @r1,savba
                +1  5905                                     ;mov            a,savba
                +1  5906                                     ; mov           @r1,a
24B4 C219       +1  5907                                     clr             bitmig
24B6 120000   F +1  5908                                     call    z_01s
24B9 22         +1  5909                                     ret
                +1  5910     ;номер ошибки bufind+6
24BA 900000   F +1  5911     error:          mov             dptr,#teERR
24BD 120000   F +1  5912                                             call    lotext
24C0 853946     +1  5913                                             mov             bufind+6,nuerr
24C3 22         +1  5914                                     ret
                +1  5915     
                +1  5916     
24C4            +1  5917     textT:          
24C4 FD543D32   +1  5918     te2ms:                  db              0fdh,"T","=",32h,"m",67h,0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    94

24C8 6D67FDFD                
24CC FDFD                    
24CE FD543D31   +1  5919     te10ms:                 db              0fdh,"T","=",31h,30h,"m",67h,0fdh,0fdh,0fdh
24D2 306D67FD                
24D6 FDFD                    
24D8 FD543D35   +1  5920                             db              0fdh,"T","=",35h,30h,"m",67h,0fdh,0fdh,0fdh
24DC 306D67FD                
24E0 FDFD                    
24E2 FD543D64   +1  5921                             db              0fdh,"T","=",64h,31h,67h,0fdh,0fdh,0fdh,0fdh
24E6 3167FDFD                
24EA FDFD                    
24EC 20202054   +1  5922                             db              " "," "," ","T","=",31h,67h," "," "," "
24F0 3D316720                
24F4 2020                    
24F6 2020543D   +1  5923                             db              " "," ","T","=",31h,30h,67h," "," "," "  
24FA 31306720                
24FE 2020                    
                +1  5924     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                +1  5925     
2500 42753474   +1  5926     teVICH: db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
2504 79767454                
2508 7720                    
250A 20553D20   +1  5927     teAequ0:        db              " ",'U','='," "," "," "," "," "," ",65h
250E 20202020                
2512 2065                    
2514 20423D2B   +1  5928     teBequ0:        db              " ",'B','=','+'," "," "," "," "," "," "
2518 20202020                
251C 2020                    
251E 20207145   +1  5929     teMENU: db              " "," ",71h,"E","H",72h," "," "," "," "
2522 48722020                
2526 2020                    
                +1  5930     
2528 20544579   +1  5931     teTESI: db      " ","T","E",79h,"T",2dh,74h,33h,71h," ";ТЕСТ -ИЗМ    11
252C 542D7433                
2530 7120                    
2532 54457954   +1  5932     teTESR: db      "T","E",79h,"T"," ","R",35h," "," "," ";ТЕСТ RS 12
2536 20523520                
253A 2020                    
253C 20794B30   +1  5933     teSKOR: db      " ",79h,'K',30h,"P"," ","R",35h," "," ";СКОР 232      13
2540 50205235                
2544 2020                    
2546 20204142   +1  5934     teAVK:  db      " "," ",'A','B','K'," "," "," "," "," "  ;AВK                              
                                  14
254A 4B202020                
254E 2020                    
2550 204B4176   +1  5935     teKALIB:         db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР    15
2554 74735020                
2558 202020                  
                +1  5936     
255B 20544579   +1  5937     teTE11:         db              " ",'T',"E",79h,'T'," "," "," ",'T',31h;          21
255F 54202020                
2563 5431                    
2565 20544579   +1  5938     teTE9:          db              " ",'T',"E",79h,'T'," "," "," ",'T',32h;                   
                                                  22
2569 54202020                
256D 5432                    
256F 20544579   +1  5939     teTE7:          db              " ",'T',"E",79h,'T'," "," "," ",'T',33h;                   
                                                  23
2573 54202020                
2577 5433                    
                +1  5940     
                +1  5941     
2579 20202035   +1  5942     teS57_6:                db              " "," "," ",35h,37h,36h," "," "," "," ";57.6
257D 37362020                
2581 2020                    
2583 20202031   +1  5943     teS19_2:                db              " "," "," ",31h,39h,32h," "," "," "," ";19,2
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    95

2587 39322020                
258B 2020                    
                +1  5944     
258D 61415030   +1  5945     tePAR:          db              61h,'A',"P",30h,76h,77h," ",30h,30h,30h;пароль
2591 76772030                
2595 3030                    
2597 20303030   +1  5946     teKD:                   db              " ",30h,30h,30h,30h,30h," "," "," ",'A';00000
259B 30302020                
259F 2041                    
25A1 74337120   +1  5947     teIZMK: db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
25A5 4B304879                
25A9 5420                    
25AB 20204275   +1  5948     teOUT:          db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
25AF 58307820                
25B3 2020                    
25B5 2020304C   +1  5949     teOLL:          db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
25B9 4C202020                
25BD 2020                    
25BF 20203034   +1  5950     teCLE:          db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
25C3 7479544B                
25C7 4120                    
25C9 20203041   +1  5951     teMEM:          db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
25CD 71795420                
25D1 20203341   +1  5952     teWR:           db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
25D5 61747977                
25D9 2020                    
25DB 20206150   +1  5953     teLIST: db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
25DF 30797130                
25E3 545020                  
25E6 20206130   +1  5954     teFULL: db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
25EA 76484162                
25EE 2020                    
25F0 20744854   +1  5955     teINT:  db      " ",74h,"H",'T'," ",30h,30h,30h,30h,67h;ИНТ 0000
25F4 20303030                
25F8 3067                    
25FA 20207376   +1  5956     teBL:           db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
25FE 304B2020                
2602 2020                    
2604 20207376   +1  5957     teBL0:  db      " "," ",73h,76h,30h,'K'," ",30h," "," ";БЛОК 0
2608 304B2030                
260C 2020                    
260E 30547934   +1  5958     teCH:           db      30h,'T',79h,34h,"E",'T'," ",30h,30h,31h;ОТСЧЕТ 001
2612 45542030                
2616 3031                    
2618 79544154   +1  5959     teSTAT:         db      79h,'T','A','T',74h,79h,'T',74h,'K','A';СТАТИСТИКА
261C 74795474                
2620 4B41                    
2622 71744820   +1  5960     teMIN:  db      71h,74h,"H"," "," "," "," "," "," "," ";МИН  00000
2626 20202020                
262A 2020                    
262C 71414B79   +1  5961     teMAX:  db      71h,'A','K',79h," "," "," "," "," "," ";МАКС 00000
2630 20202020                
2634 2020                    
2636 79504578   +1  5962     teMID:  db      79h,"P","E",78h," "," "," "," "," "," ";СРЕД 00000
263A 20202020                
263E 2020                    
                +1  5963      ;;;;;;;;;;;;;;;;;;;         
2640 2020304C   +1  5964     teOLI:  db              " "," ",30h,"L","L"," ","I"," "," "," "
2644 4C204920                
2648 2020                    
264A 2020304C   +1  5965     teOLR:  db              " "," ",30h,"L","L"," ",66h," "," "," "
264E 4C206620                
2652 2020                    
2654 20204552   +1  5966     teERR:  db              " "," ","E","R","R"," "," "," "," "," " ;ERR
2658 52202020                
265C 2020                    
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    96

265E 2020454E   +1  5967     teEND:  db              " "," ","E","N","D"," "," "," "," "," " ;END
2662 44202020                
2666 2020                    
                +1  5968     
                +1  5969     ;dptr+4-приемник
                +1  5970     ;dptr-источник
                +1  5971     ;r7-кол байт  
2668            +1  5972     xCIKLWR:
2668 7F04       +1  5973                             mov             r7,#4   
266A E0         +1  5974     lwrx:   movx    a,@dptr
266B C083       +1  5975                             push    dph
266D C082       +1  5976                             push    dpl
266F A3         +1  5977                             inc             dptr
2670 A3         +1  5978                             inc             dptr
2671 A3         +1  5979                             inc             dptr
2672 A3         +1  5980                             inc             dptr
2673 F0         +1  5981                             movx    @dptr,a
2674 D082       +1  5982                             pop             dpl
2676 D083       +1  5983                             pop             dph
                +1  5984                             
2678 A3         +1  5985                             inc             dptr
2679 DFEF       +1  5986                             djnz    r7,lwrx
267B 22         +1  5987                             ret
                +1  5988     ;r2..r5->@dptr..@dptr+3                         
267C EA         +1  5989     saveIr2:                mov     a,r2
267D F0         +1  5990                                             movx    @dptr,a
267E A3         +1  5991                                             inc     dptr
267F EB         +1  5992                                             mov     a,r3
2680 F0         +1  5993                                             movx    @dptr,a
2681 A3         +1  5994                                             inc     dptr
2682 EC         +1  5995                                             mov     a,r4
2683 F0         +1  5996                                             movx    @dptr,a
2684 A3         +1  5997                                             inc     dptr
2685 ED         +1  5998                                             mov     a,r5
2686 F0         +1  5999                                             movx    @dptr,a
2687 22         +1  6000                                             ret
                +1  6001     ;r2..r5-> @r0..@r0+3
                +1  6002     
2688 EA         +1  6003     saver2:         mov     a,r2
2689 F6         +1  6004                                             mov     @r0,a
268A 08         +1  6005                                             inc     r0
268B EB         +1  6006                                             mov     a,r3
268C F6         +1  6007                                             mov     @r0,a
268D 08         +1  6008                                             inc     r0
268E EC         +1  6009                                             mov     a,r4
268F F6         +1  6010                                             mov     @r0,a
2690 08         +1  6011                                             inc     r0
2691 ED         +1  6012                                             mov     a,r5
2692 F6         +1  6013                                             mov     @r0,a
2693 22         +1  6014                                             ret 
2694 7F50       +1  6015     clmassix:       mov                     r7,#50h;28h
2696 900100     +1  6016                             mov     dptr,#MASS0        ;забить массив A нулями
2699 7400       +1  6017     clmax:          mov          a,#00h
269B F0         +1  6018                  movx    @dptr,a
269C A3         +1  6019                  inc     dptr
269D DFFA       +1  6020                 djnz                r7,clmax                
269F F56E       +1  6021                  mov     chmas,a
26A1 C201       +1  6022                  clr     bitmas
26A3 22         +1  6023                 ret
                +1  6024     ;r1-яЁшхьшъ
                +1  6025     ;r0-шёЄюўшъ
                +1  6026     ;r7-ъюы срщЄ  
26A4            +1  6027     CIKLWR:
26A4 7F04       +1  6028                             mov             r7,#4   
26A6 E6         +1  6029     lwr:    mov     a,@r0
26A7 F7         +1  6030                             mov     @r1,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    97

26A8 09         +1  6031                             inc             r1
26A9 08         +1  6032                             inc             r0
26AA DFFA       +1  6033                             djnz    r7,lwr
26AC 22         +1  6034                             ret     
                +1  6035     ;r2..r5-> @dptr..@dptr+3
                +1  6036     
26AD 120000   F +1  6037     zmul:   call    maform
26B0 120000   F +1  6038                     call    lmul
26B3 120000   F +1  6039                     call    bform
26B6 22         +1  6040                     ret
                +1  6041     
26B7 120000   F +1  6042     zdiv:   call    maform
26BA 120000   F +1  6043                     call    divide
26BD 120000   F +1  6044                     call    bform
26C0 22         +1  6045                     ret
                +1  6046     
26C1 EA         +1  6047     maform: mov a,r2
26C2 33         +1  6048             rlc a
26C3 5006       +1  6049             jnc             fo1m
26C5 D202       +1  6050                     setb            znmat
26C7 120000   F +1  6051                     call   form4
26CA 22         +1  6052                     ret
26CB C202       +1  6053     fo1m:   clr             znmat
26CD 22         +1  6054                     ret
                +1  6055     
26CE 300203     +1  6056     bform:  jnb             znmat,fo2m
26D1 120000   F +1  6057                     call    form4
26D4 22         +1  6058     fo2m:   ret
                +1  6059       
                +1  6060     ;r2..r5 яхЁхтхёЄш т фюя ъюф
26D5 ED         +1  6061     form4:          mov a,r5
26D6 F4         +1  6062             cpl a
26D7 2401       +1  6063             add a,#1
26D9 FD         +1  6064             mov r5,a
26DA EC         +1  6065             mov a,r4
26DB F4         +1  6066             cpl a
26DC 3400       +1  6067             addc    a,#0
26DE FC         +1  6068             mov r4,a
26DF EB         +1  6069             mov a,r3
26E0 F4         +1  6070                 cpl a
26E1 3400       +1  6071             addc    a,#0
26E3 FB         +1  6072             mov r3,a
26E4 EA         +1  6073             mov a,r2
26E5 F4         +1  6074             cpl a
26E6 3400       +1  6075             addc    a,#0
26E8 FA         +1  6076             mov r2,a
26E9 22         +1  6077             ret
                +1  6078     
26EA 120000   F +1  6079     zcmp:   call            maform
26ED 120000   F +1  6080                     call            lcmp
26F0 C0D0       +1  6081                     push            psw
26F2 120000   F +1  6082                     call    bform
26F5 D0D0       +1  6083                     pop             psw
26F7 22         +1  6084                     ret
                +1  6085     
                +1  6086     
                +1  6087     ;@r0..@r0+3->r8..r11
                +1  6088     
26F8 E6         +1  6089     resar8: mov     a,@r0
26F9 F508       +1  6090                     mov     ltemp,a
26FB 08         +1  6091                     inc     r0
26FC E6         +1  6092                     mov     a,@r0
26FD F509       +1  6093                     mov     ltemp+1,a
26FF 08         +1  6094                     inc     r0
2700 E6         +1  6095                     mov     a,@r0
2701 F50A       +1  6096                     mov     ltemp+2,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    98

2703 08         +1  6097                     inc     r0
2704 E6         +1  6098                     mov     a,@r0
2705 F50B       +1  6099                     mov     ltemp+3,a
2707 22         +1  6100                     ret
                +1  6101     
                +1  6102     ;
                +1  6103     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                +1  6104     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                +1  6105     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                +1  6106     ;r2 a    ўшёыю 180
                +1  6107     ;00 b4
                +1  6108     ;т_ї- mabin..mabin+2
                +1  6109     ;     80 01 00
                +1  6110      
2708 C8         +1  6111     cond:   xch     a,r0    
2709 F9         +1  6112                     mov     r1,a
270A C8         +1  6113                     xch     a,r0
270B 7C03       +1  6114                     mov     r4,#03
270D 7700       +1  6115     dcoa:   mov     @r1,#00
270F 09         +1  6116                     inc     r1
2710 DCFB       +1  6117                     djnz    r4,dcoa
2712 7B10       +1  6118                     mov     r3,#10h
2714 C3         +1  6119     dcob:   clr     c
2715 33         +1  6120                     rlc     a
2716 CA         +1  6121                     xch     a,r2
2717 33         +1  6122                     rlc     a
2718 CA         +1  6123                     xch     a,r2
2719 C8         +1  6124                     xch     a,r0
271A F9         +1  6125                     mov     r1,a
271B C8         +1  6126                     xch     a,r0
271C 7C03       +1  6127                     mov     r4,#03
271E FD         +1  6128                     mov     r5,a
271F E7         +1  6129     dcoc:   mov     a,@r1 
2720 37         +1  6130                     addc    a,@r1
2721 D4         +1  6131                     da      a
2722 F7         +1  6132                     mov     @r1,a
2723 09         +1  6133                     inc     r1
2724 DCF9       +1  6134                     djnz    r4,dcoc
2726 ED         +1  6135                     mov     a,r5
2727 4003       +1  6136                     jc      dcod
2729 DBE9       +1  6137                     djnz    r3,dcob
272B C3         +1  6138                     clr     c
272C 00         +1  6139     dcod:   nop
272D 22         +1  6140                     ret
                +1  6141     
272E 8A08       +1  6142     move28: mov     ltemp,r2                        ;r2..r5->ltemp
2730 850309     +1  6143                     mov     ltemp+1,3
2733 85040A     +1  6144                     mov     ltemp+2,4
2736 85050B     +1  6145                     mov     ltemp+3,5
2739 22         +1  6146                     ret
                +1  6147     
                +1  6148     ;@r0..@r0+3->r2..r5
                +1  6149     
273A E6         +1  6150     resar2: mov     a,@r0
273B FA         +1  6151                     mov     r2,a
273C 08         +1  6152                     inc     r0
273D E6         +1  6153                     mov     a,@r0
273E FB         +1  6154                     mov     r3,a
273F 08         +1  6155                     inc     r0
2740 E6         +1  6156                     mov     a,@r0
2741 FC         +1  6157                     mov     r4,a
2742 08         +1  6158                     inc     r0
2743 E6         +1  6159                     mov     a,@r0
2744 FD         +1  6160                     mov     r5,a
2745 22         +1  6161                     ret
                +1  6162     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE    99

                +1  6163     ;25mkc !!!!!!!!!!!!!!!1
2746 7B4B       +1  6164     z_9:      mov R3,#4Bh      ;загрузка числа
2748 DBFE       +1  6165                    djnz R3,$
274A 22         +1  6166               ret
                +1  6167     
                +1  6168     ;запись   передаваемый байт в acc
                +1  6169     ;передача байта послед кодом старшими разрядами  вперед
274B 7A08       +1  6170     write:     mov R2,#8
274D C3         +1  6171                             clr  c  
274E C297       +1  6172     wr1:            clr             p1.7;P1.2
2750 00         +1  6173                         nop 
2751 33         +1  6174                             rlc A
2752 9296       +1  6175                             mov P1.6,C;P1.1,C
2754 120000   F +1  6176                        call tim2
2757 D297       +1  6177                        setb P1.7;P1.2
2759 120000   F +1  6178                call tim2
275C DAF0       +1  6179                       djnz R2,wr1
275E C296       +1  6180                       clr P1.6;P1.1
2760 22         +1  6181                                              ret
                +1  6182     
                +1  6183     ;чтение номера байта с индикатора(2байта)
                +1  6184     ;bufind+8..bufind+9
                +1  6185     ;-  - - -
                +1  6186     ;- - - - - - - - - -
                +1  6187     ;adec..adec+9
                +1  6188     ;ст            мл
2761 7847       +1  6189     upak1:  mov             r0,#bufind+7;
2763 795C       +1  6190                                     mov             r1,#adec+9
2765 C3         +1  6191                                     clr             c
2766 E6         +1  6192                                     mov             a,@r0
2767 9430       +1  6193                                     subb    a,#30h
2769 FF         +1  6194                                     mov             r7,a
276A C3         +1  6195                                     clr             c
276B 9405       +1  6196                                     subb    a,#5
276D 4004       +1  6197                                     jc              upk1
276F 7404       +1  6198                                     mov             a,#4
2771 8001       +1  6199                                     jmp             upk2
2773 EF         +1  6200     upk1:           mov             a,r7
2774 F7         +1  6201     upk2:           mov             @r1,a
2775 22         +1  6202                                     ret  
                +1  6203     ;r1-мл байт счетчика ячеек
2776 C3         +1  6204     chminus:        clr                     c
2777 E7         +1  6205                                             mov                     a,@r1
2778 9401       +1  6206                                             subb            a,#01
277A F7         +1  6207                                             mov                     @r1,a;low
277B 19         +1  6208                                             dec                     r1
277C E7         +1  6209                                             mov                     a,@r1
277D 9400       +1  6210                                             subb            a,#00
277F F7         +1  6211                                             mov                     @r1,a
2780 22         +1  6212                                             ret
                +1  6213     
                +1  6214     
                +1  6215     ;чтение номера байта с индикатора(4байта)
                +1  6216     ;bufind+6..bufind+9
                +1  6217     ;-  - - -
                +1  6218     ;- - - - - - - - - -
                +1  6219     ;adec..adec+9
                +1  6220     ;ст            мл
2781 7848       +1  6221     upak4:  mov             r0,#bufind+8;
2783 795C       +1  6222                     mov             r1,#adec+9
2785 7F04       +1  6223                     mov             r7,#4
2787 C3         +1  6224     upaa:   clr             c
2788 E6         +1  6225                     mov             a,@r0
2789 9430       +1  6226                     subb    a,#30h
278B F7         +1  6227                     mov             @r1,a
278C 18         +1  6228                     dec             r0
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   100

278D 19         +1  6229                     dec             r1
278E DFF7       +1  6230                     djnz    r7,upaa
2790 22         +1  6231                     ret
                +1  6232     
                +1  6233     ;dptr-адр ячейки 1й соотв блока 
2791 E538       +1  6234     adrblok:         mov            a,nblok
2793 C3         +1  6235                              clr            c
2794 9401       +1  6236                              subb           a,#1
2796 FD         +1  6237                              mov            r5,a
2797 E4         +1  6238                              clr            a
2798 FC         +1  6239                              mov            r4,a
2799 FB         +1  6240                              mov            r3,a
279A FA         +1  6241                              mov            r2,a
279B 900000   F +1  6242                                     mov                     dptr,#ch320h
279E 120000   F +1  6243                                     CALL   ldc_ltemp                 ; ltemp <-320
27A1 120000   F +1  6244                                     call            lmul;r2..r5
27A4 ED         +1  6245                                     mov                     a,r5
27A5 2450       +1  6246                                     add                     a,#50h
27A7 F582       +1  6247                                     mov                     dpl,a
27A9 EC         +1  6248                                     mov                     a,r4
27AA 3401       +1  6249                                     addc            a,#01           
27AC F583       +1  6250                                     mov                     dph,a                   ;dptr-
27AE 22         +1  6251                                     ret
                +1  6252     
                +1  6253     ;
                +1  6254     ;saven_bl<-dptr  адрес след ячейки внешн озу 
27AF E538       +1  6255     save_hl:                mov             a,nblok
27B1 B4011D     +1  6256                                                     cjne    a,#1,sa_hl1
27B4 79D3       +1  6257                                                     mov             r1,#saven_bl
27B6 E583       +1  6258     sa_hl:                  mov             a,dph
27B8 F7         +1  6259                                               mov           @r1,a
27B9 09         +1  6260                                                     inc             r1
27BA E582       +1  6261                                                     mov             a,dpl
27BC F7         +1  6262                                                     mov             @r1,a
                +1  6263                                                     ;;;;;;;;;не конец ли блока
                +1  6264                             
27BD 79D6       +1  6265                                     mov                     r1,#volume+1;work+1
27BF 120000   F +1  6266                                     call            chminus
27C2 78D5       +1  6267                                     mov             r0,#volume
27C4 E6         +1  6268                                     mov             a,@r0
27C5 30E708     +1  6269                                     jnb             acc.7,noendli
27C8 C20A       +1  6270                                     clr                     bitbon                  ;блок закон
                             чился
27CA 534BFD     +1  6271                                     anl                     bufind+11,#0fdh
27CD 120000   F +1  6272                                     call            ind
27D0 22         +1  6273     noendli:ret
                +1  6274     
27D1 B40204     +1  6275     sa_hl1:         cjne    a,#2,sa_hl2
27D4 79C0       +1  6276                                                     mov             r1,#saven_bl2
27D6 80DE       +1  6277                                                     jmp             sa_hl
                +1  6278     
27D8 B40304     +1  6279     sa_hl2:         cjne    a,#3,sa_hl3
27DB 79C2       +1  6280                                                     mov             r1,#saven_bl3
27DD 80D7       +1  6281                                                     jmp             sa_hl
27DF 79D9       +1  6282     sa_hl3:                 mov             r1,#saven_bl4
27E1 80D3       +1  6283                                                     jmp             sa_hl
                +1  6284     
                +1  6285     ;загрузка dptr сохр ранее значением адреса ячейки
27E3 E538       +1  6286     resa_hl:                mov             a,nblok
27E5 B4010A     +1  6287                                                     cjne    a,#1,re_hl1
27E8 79D3       +1  6288                                                     mov             r1,#saven_bl;блок1 150h..46
                             fh
27EA E7         +1  6289     re_hl:                  mov             a,@r1   
27EB F583       +1  6290                                                     mov             dph,a
                +1  6291                                               
27ED 09         +1  6292                                                     inc             r1
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   101

27EE E7         +1  6293                                                     mov             a,@r1
27EF F582       +1  6294                                                     mov             dpl,a
27F1 22         +1  6295                                                     ret
                +1  6296     
27F2 B40204     +1  6297     re_hl1:                 cjne    a,#2,re_hl2
27F5 79C0       +1  6298                                                     mov             r1,#saven_bl2   ;блок2 470h
                             ..78fh
27F7 80F1       +1  6299                                                     jmp             re_hl
                +1  6300     
27F9 B40304     +1  6301     re_hl2:                 cjne    a,#3,re_hl3
27FC 79C2       +1  6302                                                     mov             r1,#saven_bl3   ;блок3 790h
                             ..aafh
27FE 80EA       +1  6303                                                     jmp             re_hl
                +1  6304     
2800 79D9       +1  6305     re_hl3:                 mov             r1,#saven_bl4   ;блок4 ab0h..dcfh
2802 80E6       +1  6306                                                     jmp             re_hl
                +1  6307     ;загрузка rez_A3 в соотв яч внешн озу
2804 789C       +1  6308     loA3_X:                 mov             r0,#rez_A3
2806 120000   F +1  6309                                                     call    resar2
                +1  6310                                                     
2809 EA         +1  6311                                                     mov             a,r2                    ;
280A F0         +1  6312                                                     movx    @dptr,a
280B A3         +1  6313                                                     inc             dptr
280C EB         +1  6314                                                     mov             a,r3
280D F0         +1  6315                                                     movx    @dptr,a
280E A3         +1  6316                                                     inc             dptr
280F EC         +1  6317                                                     mov             a,r4
2810 F0         +1  6318                                                     movx    @dptr,a
2811 A3         +1  6319                                                     inc             dptr
2812 ED         +1  6320                                                     mov             a,r5
2813 F0         +1  6321                                                     movx    @dptr,a
2814 A3         +1  6322                                                     inc             dptr;адрес след ячейки внеш
                             н озу храним
2815 22         +1  6323                                                     ret             ;в ячейке saven_bl
                +1  6324     ;чтение в rez_A3 из соотв яч внешн озу
2816            +1  6325     reA3_X:         
                +1  6326                                                     
2816 E0         +1  6327                                                     movx    a,@dptr
2817 FA         +1  6328                                                     mov             r2,a
2818 A3         +1  6329                                                     inc             dptr
2819 E0         +1  6330                                                     movx    a,@dptr
281A FB         +1  6331                                                     mov             r3,a
281B A3         +1  6332                                                     inc             dptr
281C E0         +1  6333                                                     movx    a,@dptr
281D FC         +1  6334                                                     mov             r4,a
281E A3         +1  6335                                                     inc             dptr
281F E0         +1  6336                                                     movx    a,@dptr
2820 FD         +1  6337                                                     mov             r5,a
2821 A3         +1  6338                                                     inc             dptr
2822 789C       +1  6339                                                     mov             r0,#rez_A3
2824 120000   F +1  6340                                                     call    saver2
2827 22         +1  6341                                                     ret
                +1  6342     ;;;;;;;;;;;;;;;;;
                +1  6343     ;разбивка внешнего озу
                +1  6344     ;0..ffh считывается страница рпзу калибровочных коффициентов
                +1  6345     ;100h..150h обл внеш озу для скользящего массива измерения
                +1  6346     ;150h..46fh 1й блок
                +1  6347     ;470h..78fh     2й блок
                +1  6348     ;790h..aaf      3й блок
                +1  6349     ;ab0h..dcfh 4й блок
                +1  6350     ;dd0..fffh свободная область
                +1  6351     ;
                +1  6352     ;светодиоды и точки для индикатора
                +1  6353     ;bufind+10.0->makoi.7 такт
                +1  6354     ;bufind+10.1->makoi+1.7 измер
                +1  6355     ;bufind+10.2->makoi+2.7 avp
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   102

                +1  6356     ;bufind+10.3->makoi+3.7 нуль
                +1  6357     ;bufind+10.4->makoi+4.7 0,1s
                +1  6358     ;bufind+10.5->makoi+5.7 1s
                +1  6359     ;bufind+10.6->makoi+6.7 10s
                +1  6360     ;bufind+10.7->makoi+7.7 кмп
                +1  6361     ;bufind+11.0->makoi+8.7 память
                +1  6362     ;bufind+11.1->makoi+9.7 пуск
                +1  6363     ;знакоместа 0..9(10 знакомест)
                +1  6364     ;bufind+11.2->точка после 5 знакоместа
                +1  6365     ;bufind+11.3->точка после 8 знакоместа
                +1  6366     ;bufind+11.4->точка после 1 знакоместа(+0,0000  -7a)
                +1  6367     ;bufind+11.5->точка после 7 знакоместа
                +1  6368     ;bufind+11.6->точка после 6 знакоместа
                +1  6369     ;bufind+11.7->точка после 4 знакоместа
                +1  6370     
                +1  6371     ;ERR ошибки
                +1  6372     ;ERR 2-пароль в калибровке не соответствует
                +1  6373     ;ERR 3-не проходит тест RS
                +1  6374     ;ERR 4-в режиме R не введена константа U=0000(=0)
                    6375     
                    6376     ;$include (d:\amp\sarifm3.asm) 
                +1  6377     ; ” ©« SARIFM.ASM 8.11.95
                +1  6378     ;файл арифметики
                +1  6379       
  0008          +1  6380     ltemp    equ       8           ;long temporary
  000C          +1  6381     xtemp    equ       12          ;other temporaries
  000A          +1  6382     DECSIZE  EQU       10
  0004          +1  6383     NUMSIZE  EQU       4
  0004          +1  6384     RR4  EQU       4
  0005          +1  6385     RR5  EQU       5
                +1  6386     
                +1  6387                                                     
                +1  6388     
                +1  6389                 ; rseg     ARIF          ; Switch to this code segment.
                +1  6390     ;             using    0              ; Specify register bank for the following
                +1  6391                                            ; program code.
                +1  6392     ;                                               cseg AT 400h
                +1  6393     ; Arithmetics:  CLEARING string
                +1  6394     ; Input:
                +1  6395     ; R0 - pointer to string,
                +1  6396     ; NUMSIZE - byte count if CLRNUM used,
                +1  6397     ; DECSIZE - byte count if CLRDEC used,
                +1  6398     ; R2 - byte count if CLEAR used;
                +1  6399     ; Output:  none.
                +1  6400     
2828            +1  6401     CLRDEC:
2828 7A0A       +1  6402         MOV R2, #DECSIZE
282A 8002       +1  6403         SJMP    CLEAR
282C            +1  6404     CLRNUM:
282C 7A04       +1  6405         MOV R2, #NUMSIZE
                +1  6406         ;JMP    CLEAR
282E            +1  6407     CLEAR:
282E E4         +1  6408         CLR A
282F F6         +1  6409     CLR11:  MOV @R0, A
2830 08         +1  6410         INC R0
2831 DAFC       +1  6411         DJNZ    R2, CLR11
2833 22         +1  6412         RET
                +1  6413     
                +1  6414     ;**********************************
                +1  6415     ;mov    r1,#abin+3
                +1  6416     ;mov    r0,#adec
                +1  6417     ; _ _ _ _
                +1  6418     ;     03ff
                +1  6419     ;ст     мл   - вход
                +1  6420     ; _ _ _ _ _ _ _ _ _ _
                +1  6421     ;             1 0 2 3
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   103

                +1  6422     ;ст                мл 
                +1  6423     ;**********************************
                +1  6424     
2834            +1  6425     BINDEC:
                +1  6426     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  6427     ; Input:
                +1  6428     ; R0 - pointer to destination (high digit is the first),
                +1  6429     ; R1 - pointer to source,
                +1  6430     ; NUMSIZE - byte count in binary number;
                +1  6431     ; DECSIZE - byte count in decimal number;
                +1  6432     ; Output:  none.
                +1  6433     ; Source saved
                +1  6434     
                +1  6435         ; 1. Clear result
2834 7A05       +1  6436         MOV R2, #DECSIZE/2
2836 120000   F +1  6437         CALL   CLEAR  ; incrementing R0
                +1  6438     
                +1  6439         ; 2. Prepare convertion
2839 18         +1  6440         DEC R0
283A 8804       +1  6441         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
283C 8905       +1  6442         MOV RR5, R1 ; R5 - pointer to low byte of binary number
283E 7B20       +1  6443         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6444     
                +1  6445         ; 3. Convert cyrcle
2840            +1  6446     BIN30:
                +1  6447     
                +1  6448         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
2840 A905       +1  6449         MOV R1, RR5
2842 7A04       +1  6450         MOV R2, #NUMSIZE
2844 E7         +1  6451     BIN31:  MOV A, @R1
2845 33         +1  6452         RLC A
2846 F7         +1  6453         MOV @R1, A
2847 19         +1  6454         DEC R1
2848 DAFA       +1  6455         DJNZ    R2, BIN31
284A A905       +1  6456         MOV R1, RR5
284C E7         +1  6457         MOV A, @R1
284D 92E0       +1  6458         MOV ACC.0, C
284F F7         +1  6459         MOV @R1, A
                +1  6460     
                +1  6461         ; 3.2. Doubling decimal result with <Carry>
2850 A804       +1  6462         MOV R0, RR4
2852 7A05       +1  6463         MOV R2, #DECSIZE/2
2854 E6         +1  6464     BIN32:  MOV A, @R0
2855 36         +1  6465         ADDC    A, @R0
2856 D4         +1  6466         DA  A
2857 F6         +1  6467         MOV @R0, A
2858 18         +1  6468         DEC R0
2859 DAF9       +1  6469         DJNZ    R2, BIN32
                +1  6470     
                +1  6471         ; 3.3. End of convert cyrcle
285B DBE3       +1  6472         DJNZ    R3, BIN30
                +1  6473     
                +1  6474         ; 4. Make bytes from half-bytes
285D E8         +1  6475         MOV A, R0
285E 240A       +1  6476         ADD A, #DECSIZE
2860 F8         +1  6477         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
2861 A904       +1  6478         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
2863 7A05       +1  6479         MOV R2, #DECSIZE/2
2865 E7         +1  6480     BIN41:  MOV A, @R1
2866 540F       +1  6481         ANL A, #00FH
2868 F6         +1  6482         MOV @R0, A
2869 18         +1  6483         DEC R0
286A E7         +1  6484         MOV A, @R1
286B C4         +1  6485         SWAP    A
286C 540F       +1  6486         ANL A, #00FH
286E F6         +1  6487         MOV @R0, A
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   104

286F 18         +1  6488         DEC R0
2870 19         +1  6489         DEC R1
2871 DAF2       +1  6490         DJNZ    R2, BIN41
2873 22         +1  6491         RET
                +1  6492     
                +1  6493     
                +1  6494     ;*********************************
                +1  6495     ;mov    r0,#abin
                +1  6496     ;mov    r1,#adec
                +1  6497     ; _ _ _ _       -выход
                +1  6498     ; ff0000
                +1  6499     ;0004
                +1  6500     ;мл      ст
                +1  6501     
                +1  6502     ;ст                       мл
                +1  6503     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  6504     ;                       2 5 5
                +1  6505     ;                   1 0 2 4
                +1  6506     
2874            +1  6507     DECBIN:
                +1  6508     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  6509     ; Input:
                +1  6510     ; R0 - pointer to destination,
                +1  6511     ; R1 - pointer to source (high digit is the first),
                +1  6512     ; NUMSIZE - byte count in binary number;
                +1  6513     ; DECSIZE - byte count in decimal number;
                +1  6514     ; Output:  none
                +1  6515     ; Source cleared
                +1  6516     
                +1  6517         ; 1. Clear result
2874 120000   F +1  6518         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  6519     
                +1  6520         ; 2. Prepare convertion
2877 18         +1  6521         DEC R0
2878 8804       +1  6522         MOV RR4, R0 ; R4 - pointer to high byte of binary result
287A 8905       +1  6523         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
287C 900000   F +1  6524         MOV DPTR, #DECT2
287F 7B20       +1  6525         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6526     
                +1  6527         ; 3. Convert cyrcle
2881            +1  6528     DEC30:
                +1  6529     
                +1  6530         ; 3.1. Divide decimal number by 2 and prepare <Carry>
2881 C3         +1  6531         CLR C
2882 A905       +1  6532         MOV R1, RR5
2884 7A0A       +1  6533         MOV R2, #DECSIZE
2886 E7         +1  6534     DEC31:  MOV A, @R1
2887 540F       +1  6535         ANL A, #00FH
2889 92E4       +1  6536         MOV ACC.4, C
288B 93         +1  6537         MOVC    A,@A+DPTR
288C F7         +1  6538         MOV @R1, A
288D A2E7       +1  6539         MOV C, ACC.7
288F 09         +1  6540         INC R1
2890 DAF4       +1  6541         DJNZ    R2, DEC31
                +1  6542     
                +1  6543         ; 3.2. Rotate binary result one bit to right with <Carry>
2892 A804       +1  6544         MOV R0, RR4
2894 7A04       +1  6545         MOV R2, #NUMSIZE
2896 E6         +1  6546     DEC32:  MOV A, @R0
2897 13         +1  6547         RRC A
2898 F6         +1  6548         MOV @R0, A
2899 18         +1  6549         DEC R0
289A DAFA       +1  6550         DJNZ    R2, DEC32
                +1  6551     
                +1  6552         ; 3.3. End of convert cyrcle
289C DBE3       +1  6553         DJNZ    R3, DEC30
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   105

289E 22         +1  6554         RET
                +1  6555     
289F 00800181   +1  6556     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
28A3 02820383                
28A7 0484                    
28A9 00000000   +1  6557         DB  00,00,00,00,00,00
28AD 0000                    
28AF 05850686   +1  6558         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
28B3 07870888                
28B7 0989                    
                +1  6559     
                +1  6560     ;   Long comparison
                +1  6561     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  6562     ;   flags and acc set as though a long subtraction was done.
                +1  6563     ;*******************************
                +1  6564     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  6565     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  6566     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  6567     ;*******************************
28B9            +1  6568     lcmp:
28B9 C3         +1  6569         clr c
28BA EA         +1  6570         mov a,r2
28BB 9508       +1  6571         subb    a,8
28BD 700F       +1  6572         jnz done
28BF EB         +1  6573         mov a,r3
28C0 9509       +1  6574         subb    a,9
28C2 7008       +1  6575         jnz done1
28C4 EC         +1  6576         mov a,r4
28C5 950A       +1  6577         subb    a,10
28C7 7003       +1  6578         jnz done1
28C9 ED         +1  6579         mov a,r5
28CA 950B       +1  6580         subb    a,11
28CC            +1  6581     done1:
28CC C2D2       +1  6582         clr ov      ;overflow is significant only for top byte
28CE            +1  6583     done:
28CE 22         +1  6584         ret
                +1  6585     
                +1  6586     ;   Load long into r2-5 from [dptr]
                +1  6587     
28CF            +1  6588     ldc_long:
28CF E583       +1  6589         mov a,dph       ;is it in on board memory
28D1 6010       +1  6590         jz  onboard     ;yes
28D3 E4         +1  6591         clr a
28D4 93         +1  6592         movc    a,@a+dptr
28D5 FA         +1  6593         mov r2,a
28D6 7401       +1  6594         mov a,#1
28D8 93         +1  6595         movc    a,@a+dptr
28D9 FB         +1  6596         mov r3,a
28DA 7402       +1  6597         mov a,#2
28DC 93         +1  6598         movc    a,@a+dptr
28DD FC         +1  6599         mov r4,a
28DE 7403       +1  6600         mov a,#3
28E0 93         +1  6601         movc    a,@a+dptr
28E1 FD         +1  6602         mov r5,a
28E2 22         +1  6603         ret
28E3            +1  6604     onboard:
28E3 A882       +1  6605         mov r0,dpl
28E5 E6         +1  6606         mov a,@r0
28E6 FA         +1  6607         mov r2,a
28E7 08         +1  6608         inc r0
28E8 E6         +1  6609         mov a,@r0
28E9 FB         +1  6610         mov r3,a
28EA 08         +1  6611         inc r0
28EB E6         +1  6612         mov a,@r0
28EC FC         +1  6613         mov r4,a
28ED 08         +1  6614         inc r0
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   106

28EE E6         +1  6615         mov a,@r0
28EF FD         +1  6616         mov r5,a
28F0 22         +1  6617         ret
                +1  6618     
                +1  6619     ;**************************************
                +1  6620     ;загрузить ltemp...+3 из памяти программ
                +1  6621     ;mov    dptr,#CH5
                +1  6622     ;call   ldc_ltemp        ltemp <--5
                +1  6623     ;**************************************
28F1            +1  6624     ldc_ltemp:
28F1 E583       +1  6625         mov a,dph       ;is it in on board memory
28F3 6014       +1  6626         jz  oboard      ;yes
28F5 E4         +1  6627         clr a
28F6 93         +1  6628         movc    a,@a+dptr
28F7 F508       +1  6629         mov 8,a
28F9 7401       +1  6630         mov a,#1
28FB 93         +1  6631         movc    a,@a+dptr
28FC F509       +1  6632         mov 9,a
28FE 7402       +1  6633         mov a,#2
2900 93         +1  6634         movc    a,@a+dptr
2901 F50A       +1  6635         mov 10,a
2903 7403       +1  6636         mov a,#3
2905 93         +1  6637         movc    a,@a+dptr
2906 F50B       +1  6638         mov 11,a
2908 22         +1  6639         ret
2909            +1  6640     oboard:
2909 A882       +1  6641         mov r0,dpl
290B 8608       +1  6642         mov 8,@r0
290D 08         +1  6643         inc r0
290E 8609       +1  6644         mov 9,@r0
2910 08         +1  6645         inc r0
2911 860A       +1  6646         mov 10,@r0
2913 08         +1  6647         inc r0
2914 860B       +1  6648         mov 11,@r0
2916 22         +1  6649         ret
                +1  6650     
                +1  6651     ;*****************************
                +1  6652     ;mov    dptr,#k1
                +1  6653     ;call   ldx_long
                +1  6654     ;k1->r2..r5
                +1  6655     ;*****************************
                +1  6656     ;   Load long into r2-5 from [dptr]
                +1  6657     ;
                +1  6658     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
2917            +1  6659     ldx_long:
2917 E583       +1  6660         mov a,dph       ;is it in on board memory
2919 6014       +1  6661         jz  onboar1        ;yes
291B C082       +1  6662         push    dpl
291D C083       +1  6663         push    dph
291F E0         +1  6664         movx    a,@dptr
2920 FA         +1  6665         mov r2,a
2921 A3         +1  6666         inc dptr
2922 E0         +1  6667         movx    a,@dptr
2923 FB         +1  6668         mov r3,a
2924 A3         +1  6669         inc dptr
2925 E0         +1  6670         movx    a,@dptr
2926 FC         +1  6671         mov r4,a
2927 A3         +1  6672         inc dptr
2928 E0         +1  6673         movx    a,@dptr
2929 FD         +1  6674         mov r5,a
292A D083       +1  6675         pop dph
292C D082       +1  6676         pop dpl
292E 22         +1  6677         ret
292F            +1  6678     onboar1:
292F A882       +1  6679         mov r0,dpl
2931 E6         +1  6680         mov a,@r0
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   107

2932 FA         +1  6681         mov r2,a
2933 08         +1  6682         inc r0
2934 E6         +1  6683         mov a,@r0
2935 FB         +1  6684         mov r3,a
2936 08         +1  6685         inc r0
2937 E6         +1  6686         mov a,@r0
2938 FC         +1  6687         mov r4,a
2939 08         +1  6688         inc r0
293A E6         +1  6689         mov a,@r0
293B FD         +1  6690         mov r5,a
293C 22         +1  6691         ret
                +1  6692     
                +1  6693     ;*********************************
                +1  6694     ;mov    dptr,#k2
                +1  6695     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  6696     ;**********************************
293D            +1  6697     ldx_ltemp:
293D E583       +1  6698         mov a,dph       ;is it in on board memory
293F 6010       +1  6699         jz  oboard1     ;yes
2941 E0         +1  6700         movx    a,@dptr
2942 F508       +1  6701         mov 8,a
2944 A3         +1  6702         inc dptr
2945 E0         +1  6703         movx    a,@dptr
2946 F509       +1  6704         mov 9,a
2948 A3         +1  6705         inc dptr
2949 E0         +1  6706         movx    a,@dptr
294A F50A       +1  6707         mov 10,a
294C A3         +1  6708         inc dptr
294D E0         +1  6709         movx    a,@dptr
294E F50B       +1  6710         mov 11,a
2950 22         +1  6711         ret
2951            +1  6712     oboard1:
2951 A882       +1  6713         mov r0,dpl
2953 8608       +1  6714         mov 8,@r0
2955 08         +1  6715         inc r0
2956 8609       +1  6716         mov 9,@r0
2958 08         +1  6717         inc r0
2959 860A       +1  6718         mov 10,@r0
295B 08         +1  6719         inc r0
295C 860B       +1  6720         mov 11,@r0
295E 22         +1  6721         ret
                +1  6722     ;   Long division routines for 8051
                +1  6723     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  6724     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  6725     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  6726     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  6727     ;   r1 must be saved by the caller.
                +1  6728     ;   This is long unsigned division.
                +1  6729     
                +1  6730     
                +1  6731     ;   Register usage:
                +1  6732     ;       r0 loop counter
                +1  6733     ;       xtemp (12-15) accumulates quotient
                +1  6734     ;       r5-r2 holds dividend
                +1  6735     ;       ltemp holds divisor
                +1  6736     
                +1  6737     ;************************************
                +1  6738     ;r2..r5-делимое
                +1  6739     ;ltemp..-делитель
                +1  6740     ;частное -r2..r5
                +1  6741     ;*************************************
295F            +1  6742     divide:
295F E4         +1  6743         clr a
2960 F8         +1  6744         mov r0,a        ;initialize count
2961 F50C       +1  6745         mov xtemp,a     ;zero quotient
2963 F50D       +1  6746         mov xtemp+1,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   108

2965 F50E       +1  6747         mov xtemp+2,a
2967 F50F       +1  6748         mov xtemp+3,a
2969 ED         +1  6749         mov a,r5        ;check for zero dividend
296A 4C         +1  6750         orl a,r4
296B 4B         +1  6751         orl a,r3
296C 4A         +1  6752         orl a,r2
296D 600B       +1  6753         jz  jfinis
296F E508       +1  6754         mov a,ltemp     ;check for zero divisor
2971 4509       +1  6755         orl a,ltemp+1
2973 450A       +1  6756         orl a,ltemp+2
2975 450B       +1  6757         orl a,ltemp+3
2977 7037       +1  6758         jnz midl
2979 22         +1  6759         ret
                +1  6760     
297A 020000   F +1  6761     jfinis: jmp finis
                +1  6762     
297D            +1  6763     loops:
297D EA         +1  6764         mov a,r2
297E C3         +1  6765         clr c
297F 9508       +1  6766         subb    a,ltemp+0   ;is divisor greater than dividend yet
2981 4033       +1  6767         jc  yes     ;yes, go no further
2983 7013       +1  6768         jnz no
2985 EB         +1  6769         mov a,r3
2986 9509       +1  6770         subb    a,ltemp+1
2988 402C       +1  6771         jc  yes
298A 700C       +1  6772         jnz no
298C EC         +1  6773         mov a,r4
298D 950A       +1  6774         subb    a,ltemp+2
298F 4025       +1  6775         jc  yes
2991 7005       +1  6776         jnz no
2993 ED         +1  6777         mov a,r5
2994 950B       +1  6778         subb    a,ltemp+3
2996 401E       +1  6779         jc  yes
2998            +1  6780     no:
2998 E50B       +1  6781         mov a,ltemp+3   ;shift divisor up one bit
299A 250B       +1  6782         add a,ltemp+3
299C F50B       +1  6783         mov ltemp+3,a
299E E50A       +1  6784         mov a,ltemp+2
29A0 350A       +1  6785         addc    a,ltemp+2
29A2 F50A       +1  6786         mov ltemp+2,a
29A4 E509       +1  6787         mov a,ltemp+1
29A6 3509       +1  6788         addc    a,ltemp+1
29A8 F509       +1  6789         mov ltemp+1,a
29AA E508       +1  6790         mov a,ltemp+0
29AC 3508       +1  6791         addc    a,ltemp+0
29AE F508       +1  6792         mov ltemp+0,a
29B0            +1  6793     midl:
29B0 08         +1  6794         inc r0      ;increment count
29B1 E508       +1  6795         mov a,ltemp+0   ;check for safe to shift some more
29B3 30E7C7     +1  6796         jnb acc.7,loops  ;loop if top bit clear
29B6            +1  6797     yes:
29B6 E508       +1  6798         mov a,ltemp+0
29B8 C3         +1  6799         clr c
29B9 9A         +1  6800         subb    a,r2        ;can we subtract now?
29BA 401A       +1  6801         jc  dosub       ;yes, go and do it
29BC 7015       +1  6802         jnz nosub
29BE E509       +1  6803         mov a,ltemp+1
29C0 9B         +1  6804         subb    a,r3
29C1 4013       +1  6805         jc  dosub
29C3 700E       +1  6806         jnz nosub
29C5 E50A       +1  6807         mov a,ltemp+2
29C7 9C         +1  6808         subb    a,r4
29C8 400C       +1  6809         jc  dosub
29CA 7007       +1  6810         jnz nosub
29CC E50B       +1  6811         mov a,ltemp+3
29CE 9D         +1  6812         subb    a,r5
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   109

29CF 4005       +1  6813         jc  dosub
29D1 6003       +1  6814         jz  dosub
29D3            +1  6815     nosub:
29D3 C3         +1  6816         clr c
29D4 8012       +1  6817         sjmp    dosh
29D6            +1  6818     dosub:
29D6 C3         +1  6819         clr c       ;subtract divisor from dividend
29D7 ED         +1  6820         mov a,r5
29D8 950B       +1  6821         subb    a,ltemp+3
29DA FD         +1  6822         mov r5,a
29DB EC         +1  6823         mov a,r4
29DC 950A       +1  6824         subb    a,ltemp+2
29DE FC         +1  6825         mov r4,a
29DF EB         +1  6826         mov a,r3
29E0 9509       +1  6827         subb    a,ltemp+1
29E2 FB         +1  6828         mov r3,a
29E3 EA         +1  6829         mov a,r2
29E4 9508       +1  6830         subb    a,ltemp+0
29E6 FA         +1  6831         mov r2,a
29E7 D3         +1  6832         setb    c       ;now set bit for quotient
29E8            +1  6833     dosh:
29E8 E50F       +1  6834         mov a,xtemp+3
29EA 33         +1  6835         rlc a
29EB F50F       +1  6836         mov xtemp+3,a
29ED E50E       +1  6837         mov a,xtemp+2
29EF 33         +1  6838         rlc a
29F0 F50E       +1  6839         mov xtemp+2,a
29F2 E50D       +1  6840         mov a,xtemp+1
29F4 33         +1  6841         rlc a
29F5 F50D       +1  6842         mov xtemp+1,a
29F7 E50C       +1  6843         mov a,xtemp+0
29F9 33         +1  6844         rlc a
29FA F50C       +1  6845         mov xtemp+0,a
29FC E508       +1  6846         mov a,ltemp+0       ;shift divisor down
29FE C3         +1  6847         clr c
29FF 13         +1  6848         rrc a
2A00 F508       +1  6849         mov ltemp+0,a
2A02 E509       +1  6850         mov a,ltemp+1
2A04 13         +1  6851         rrc a
2A05 F509       +1  6852         mov ltemp+1,a
2A07 E50A       +1  6853         mov a,ltemp+2
2A09 13         +1  6854         rrc a
2A0A F50A       +1  6855         mov ltemp+2,a
2A0C E50B       +1  6856         mov a,ltemp+3
2A0E 13         +1  6857         rrc a
2A0F F50B       +1  6858         mov ltemp+3,a
                +1  6859     
2A11 D8A3       +1  6860         djnz    r0,yes      ;and continue with the rest
                +1  6861     
2A13            +1  6862     finis:
2A13 8D0B       +1  6863         mov ltemp+3,r5
2A15 8C0A       +1  6864         mov ltemp+2,r4
2A17 8B09       +1  6865         mov ltemp+1,r3
2A19 8A08       +1  6866         mov ltemp+0,r2
2A1B AD0F       +1  6867         mov r5,xtemp+3
2A1D AC0E       +1  6868         mov r4,xtemp+2
2A1F AB0D       +1  6869         mov r3,xtemp+1
2A21 AA0C       +1  6870         mov r2,xtemp+0
2A23 22         +1  6871         ret         ;and return with the satisfaction of a job well done
                +1  6872     
                +1  6873     
                +1  6874     ;   Long multiplication
                +1  6875     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  6876     ;   other in ltemp. It really doesn't matter which one is where.
                +1  6877     
                +1  6878     ;**********************************
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   110

                +1  6879     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  6880     ;ст  мл
                +1  6881     ;**********************************
2A24            +1  6882     llmul:
2A24            +1  6883     almul:
2A24            +1  6884     lmul:
2A24 ED         +1  6885         mov a,r5        ;low order byte
2A25 850BF0     +1  6886         mov b,ltemp+3       ;times low order byte
2A28 A4         +1  6887         mul ab
2A29 F50F       +1  6888         mov xtemp+3,a       ;store low
2A2B 85F00E     +1  6889         mov xtemp+2,b   ;and high
2A2E ED         +1  6890         mov a,r5        ;low order
2A2F 850AF0     +1  6891         mov b,ltemp+2   ;times next
2A32 A4         +1  6892         mul ab
2A33 250E       +1  6893         add a,xtemp+2   ;add in
2A35 F50E       +1  6894         mov xtemp+2,a
2A37 E5F0       +1  6895         mov a,b
2A39 3400       +1  6896         addc    a,#0
2A3B F50D       +1  6897         mov xtemp+1,a
2A3D ED         +1  6898         mov a,r5
2A3E 8509F0     +1  6899         mov b,ltemp+1
2A41 A4         +1  6900         mul ab
2A42 250D       +1  6901         add a,xtemp+1
2A44 F50D       +1  6902         mov xtemp+1,a
2A46 E5F0       +1  6903         mov a,b
2A48 3400       +1  6904         addc    a,#0
2A4A F50C       +1  6905         mov xtemp+0,a
2A4C ED         +1  6906         mov a,r5
2A4D 8508F0     +1  6907         mov b,ltemp+0
2A50 A4         +1  6908         mul ab
2A51 250C       +1  6909         add a,xtemp+0
2A53 F50C       +1  6910         mov xtemp+0,a
2A55 EC         +1  6911         mov a,r4
2A56 850BF0     +1  6912         mov b,ltemp+3
2A59 A4         +1  6913         mul ab
2A5A 250E       +1  6914         add a,xtemp+2
2A5C F50E       +1  6915         mov xtemp+2,a
2A5E E5F0       +1  6916         mov a,b
2A60 350D       +1  6917         addc    a,xtemp+1
2A62 F50D       +1  6918         mov xtemp+1,a
2A64 E50C       +1  6919         mov a,xtemp+0
2A66 3400       +1  6920         addc    a,#0
2A68 F50C       +1  6921         mov xtemp+0,a
2A6A EC         +1  6922         mov a,r4
2A6B 850AF0     +1  6923         mov b,ltemp+2
2A6E A4         +1  6924         mul ab
2A6F 250D       +1  6925         add a,xtemp+1
2A71 F50D       +1  6926         mov xtemp+1,a
2A73 E5F0       +1  6927         mov a,b
2A75 350C       +1  6928         addc    a,xtemp+0
2A77 F50C       +1  6929         mov xtemp+0,a
2A79 EC         +1  6930         mov a,r4
2A7A 8509F0     +1  6931         mov b,ltemp+1
2A7D A4         +1  6932         mul ab
2A7E 250C       +1  6933         add a,xtemp+0
2A80 F50C       +1  6934         mov xtemp+0,a
                +1  6935     
2A82 EB         +1  6936         mov a,r3
2A83 850BF0     +1  6937         mov b,ltemp+3
2A86 A4         +1  6938         mul ab
2A87 250D       +1  6939         add a,xtemp+1
2A89 F50D       +1  6940         mov xtemp+1,a
2A8B E5F0       +1  6941         mov a,b
2A8D 350C       +1  6942         addc    a,xtemp+0
2A8F F50C       +1  6943         mov xtemp+0,a
2A91 EB         +1  6944         mov a,r3
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   111

2A92 850AF0     +1  6945         mov b,ltemp+2
2A95 A4         +1  6946         mul ab
2A96 250C       +1  6947         add a,xtemp+0
2A98 F50C       +1  6948         mov xtemp+0,a
                +1  6949     
2A9A EA         +1  6950         mov a,r2
2A9B 850BF0     +1  6951         mov b,ltemp+3
2A9E A4         +1  6952         mul ab
2A9F 250C       +1  6953         add a,xtemp+0
2AA1 FA         +1  6954         mov r2,a
2AA2 AB0D       +1  6955         mov r3,xtemp+1
2AA4 AC0E       +1  6956         mov r4,xtemp+2
2AA6 AD0F       +1  6957         mov r5,xtemp+3
                +1  6958     
2AA8 22         +1  6959         ret         ;all done
                +1  6960     ;******************************
                +1  6961     ;из содержимого  r2-r5  вычесть
                +1  6962     ;содержимое          ltemp..ltemp+3
                +1  6963     ;******************************
2AA9            +1  6964     llsub:
2AA9            +1  6965      lsub:
2AA9 ED         +1  6966         mov a,r5
2AAA C3         +1  6967         clr c
2AAB 950B       +1  6968         subb    a,11
2AAD FD         +1  6969         mov r5,a
2AAE EC         +1  6970         mov a,r4
2AAF 950A       +1  6971         subb    a,10
2AB1 FC         +1  6972         mov r4,a
2AB2 EB         +1  6973         mov a,r3
2AB3 9509       +1  6974         subb    a,9
2AB5 FB         +1  6975         mov r3,a
2AB6 EA         +1  6976         mov a,r2
2AB7 9508       +1  6977         subb    a,8
2AB9 FA         +1  6978         mov r2,a
2ABA 22         +1  6979         ret
                +1  6980     
                +1  6981     ;***********************************************
                +1  6982     ;                                                      ст мл
                +1  6983     ; cложение содержимого  r2..r5 с числом по адресу
                +1  6984     ;  r0- адрес младшего байта !!!
                +1  6985     ;результат- r2..r5
                +1  6986     ;***********************************************
                +1  6987     
2ABB C3         +1  6988     ladd:    clr       c
2ABC ED         +1  6989          mov       a,r5
2ABD 26         +1  6990          add       a,@r0
2ABE FD         +1  6991          mov       r5,a
2ABF 18         +1  6992          dec       r0
2AC0 EC         +1  6993          mov       a,r4
2AC1 36         +1  6994          addc      a,@r0
2AC2 FC         +1  6995          mov       r4,a
2AC3 18         +1  6996          dec       r0
2AC4 EB         +1  6997          mov       a,r3
2AC5 36         +1  6998          addc      a,@r0
2AC6 FB         +1  6999          mov       r3,a
2AC7 18         +1  7000          dec       r0
2AC8 EA         +1  7001          mov       a,r2
2AC9 36         +1  7002          addc      a,@r0
2ACA FA         +1  7003          mov       r2,a
2ACB 22         +1  7004          ret
                +1  7005     ;***********************************************
                +1  7006     ;                                                      ст мл
                +1  7007     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7008     ;  r0- адрес младшего байта !!!
                +1  7009     ;результат- r2..r5
                +1  7010     ;***********************************************
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   112

                +1  7011     
2ACC C3         +1  7012     laddx:    clr       c
2ACD E2         +1  7013                                             movx            a,@r0
2ACE 2D         +1  7014                                             add                     a,r5
2ACF FD         +1  7015               mov     r5,a
2AD0 18         +1  7016                             dec     r0
2AD1 E2         +1  7017                             movx    a,@r0
2AD2 3C         +1  7018                             addc    a,r4
2AD3 FC         +1  7019                             mov     r4,a
2AD4 18         +1  7020                             dec     r0
2AD5 E2         +1  7021                             movx    a,@r0
2AD6 3B         +1  7022                             addc    a,r3
2AD7 FB         +1  7023                             mov     r3,a
2AD8 18         +1  7024                             dec     r0
2AD9 E2         +1  7025                             movx    a,@r0
2ADA 3A         +1  7026                             addc    a,r2
2ADB FA         +1  7027                             mov       r2,a
2ADC 22         +1  7028                             ret
                +1  7029     
                +1  7030     ;***********************************************
                +1  7031     ;                                                      ст мл
                +1  7032     ; cложение содержимого  r2..r5 с числом по адресу
                +1  7033     ;  dptr- адрес младшего байта !!!
                +1  7034     ;результат- r2..r5
                +1  7035     ;***********************************************
                +1  7036     
2ADD C3         +1  7037     addx:    clr       c
2ADE E0         +1  7038                                             movx            a,@dptr
2ADF 2D         +1  7039                                             add                     a,r5
2AE0 FD         +1  7040               mov     r5,a
2AE1 120000   F +1  7041                             call            dedptr;dec     dptr
2AE4 E0         +1  7042                             movx    a,@dptr
2AE5 3C         +1  7043                             addc    a,r4
2AE6 FC         +1  7044                             mov     r4,a
2AE7 120000   F +1  7045                             call            dedptr;dec     dptr
2AEA E0         +1  7046                             movx    a,@dptr
2AEB 3B         +1  7047                             addc    a,r3
2AEC FB         +1  7048                             mov     r3,a
2AED 120000   F +1  7049                             call            dedptr;dec     dptr
2AF0 E0         +1  7050                             movx    a,@dptr
2AF1 3A         +1  7051                             addc    a,r2
2AF2 FA         +1  7052                             mov       r2,a
2AF3 22         +1  7053                             ret
                +1  7054     
2AF4 C0D0       +1  7055     dedptr:         push    psw
2AF6 C3         +1  7056                                             clr             c
2AF7 E582       +1  7057                                             mov             a,dpl
2AF9 9401       +1  7058                                             subb    a,#1
2AFB F582       +1  7059                                             mov             dpl,a
2AFD E583       +1  7060                                             mov             a,dph
2AFF 9400       +1  7061                                             subb    a,#0
2B01 F583       +1  7062                                             mov             dph,a
2B03 D0D0       +1  7063                                             pop             psw
2B05 22         +1  7064                                             ret
                    7065     
                    7066     ;$include (d:\amp\floatm.asm)
                +1  7067     ;       Copyright (C) 1988 HI-TECH Software
                +1  7068     
                +1  7069     ;       Single Precision Floating point arithmetic routines for 8051
                +1  7070     
                +1  7071     ;       The format of floating point numbers is as follows:
                +1  7072     
                +1  7073     ;       -----------------
                +1  7074     ;       *     sign      *  1 bit
                +1  7075     ;       -----------------
                +1  7076     ;       *   exponent    *  8 bits
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   113

                +1  7077     ;       -----------------
                +1  7078     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  7079     ;       -----------------
                +1  7080     
                +1  7081     
                +1  7082     ;       As usual for the 8051 the memory layout has the most significant
                +1  7083     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  7084     ;       lowest address.
                +1  7085     
                +1  7086     ;       Calling conventions:
                +1  7087     
                +1  7088     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  7089     ;
                +1  7090     ;       Return value is in r2-r5
                +1  7091     
                +1  7092     ;       Naming conventions: A routine name is constructed by
                +1  7093     
                +1  7094     ;             ASOP
                +1  7095     
                +1  7096     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  7097     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  7098     ;       Conversion routines are named
                +1  7099     
                +1  7100     ;               AStof
                +1  7101     
                +1  7102     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  7103     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  7104     ;       Conversion from float to integer is ftol.
                +1  7105     
                +1  7106     ;               .ORG  5000h
                +1  7107     ;               .CODE
                +1  7108     ;       seg     c_text
                +1  7109     
                +1  7110     ;;      $MOD812
----            +1  7111             CSEG
                +1  7112             ;ORG 1000h
                +1  7113     
                +1  7114                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  7115             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  7116     
                +1  7117     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  7118     ;       macros
                +1  7119     
                +1  7120     saveregs        macro
                +1  7121             push    7
                +1  7122             push    6
                +1  7123             push    1
                +1  7124             push    0
                +1  7125             endm
                +1  7126     
                +1  7127     restregs        macro
                +1  7128             pop     0
                +1  7129             pop     1
                +1  7130             pop     6
                +1  7131             pop     7
                +1  7132             endm
                +1  7133     
                +1  7134     ;addr   
                +1  7135     dan     macro   pad
                +1  7136             mov     a,r5
                +1  7137             add     a,pad+3
                +1  7138             mov     pad+3,a
                +1  7139             mov     a,pad+2
                +1  7140             addc    a,r4
                +1  7141             mov     pad+2,a
                +1  7142             mov     a,pad+1
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   114

                +1  7143             addc    a,r3
                +1  7144             mov     pad+1,a
                +1  7145             mov     a,pad+0
                +1  7146             addc    a,r2
                +1  7147             mov     pad,a
                +1  7148             endm
                +1  7149     
                +1  7150     addl    macro  addr
                +1  7151             mov     a,r5
                +1  7152             add     a,addr+3
                +1  7153             mov     r5,a
                +1  7154             mov     a,addr+2
                +1  7155             addc    a,r4
                +1  7156             mov     r4,a
                +1  7157             mov     a,addr+1
                +1  7158             addc    a,r3
                +1  7159             mov     r3,a
                +1  7160             mov     a,addr+0
                +1  7161             addc    a,r2
                +1  7162             mov     r2,a
                +1  7163             endm
                +1  7164     
                +1  7165     
                +1  7166     add1    macro
                +1  7167             mov     a,r5
                +1  7168             add     a,#1
                +1  7169             mov     r5,a
                +1  7170             clr     a
                +1  7171             addc    a,r4
                +1  7172             mov     r4,a
                +1  7173             clr     a
                +1  7174             addc    a,r3
                +1  7175             mov     r3,a
                +1  7176             clr     a
                +1  7177             addc    a,r2
                +1  7178             mov     r2,a
                +1  7179             endm
                +1  7180     
                +1  7181     shfdn   macro  addr
                +1  7182             clr     c
                +1  7183             mov     a,addr
                +1  7184             rrc     a
                +1  7185             mov     addr,a
                +1  7186             mov     a,addr+1
                +1  7187             rrc     a
                +1  7188             mov     addr+1,a
                +1  7189             mov     a,addr+2
                +1  7190             rrc     a
                +1  7191             mov     addr+2,a
                +1  7192             mov     a,addr+3
                +1  7193             rrc     a
                +1  7194             mov     addr+3,a
                +1  7195             endm
                +1  7196     
                +1  7197     shfup   macro  addr
                +1  7198             clr     c
                +1  7199             mov     a,addr+3
                +1  7200             rlc     a
                +1  7201             mov     addr+3,a
                +1  7202             mov     a,addr+2
                +1  7203             rlc     a
                +1  7204             mov     addr+2,a
                +1  7205             mov     a,addr+1
                +1  7206             rlc     a
                +1  7207             mov     addr+1,a
                +1  7208             mov     a,addr
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   115

                +1  7209             rlc     a
                +1  7210             mov     addr,a
                +1  7211             endm
                +1  7212     
                +1  7213     rshift  macro
                +1  7214             clr     c
                +1  7215             mov     a,r2
                +1  7216             rrc     a
                +1  7217             mov     r2,a
                +1  7218             mov     a,r3
                +1  7219             rrc     a
                +1  7220             mov     r3,a
                +1  7221             mov     a,r4
                +1  7222             rrc     a
                +1  7223             mov     r4,a
                +1  7224             mov     a,r5
                +1  7225             rrc     a
                +1  7226             mov     r5,a
                +1  7227             endm
                +1  7228     rshift1 macro
                +1  7229             setb    c
                +1  7230             mov     a,r2
                +1  7231             rrc     a
                +1  7232             mov     r2,a
                +1  7233             mov     a,r3
                +1  7234             rrc     a
                +1  7235             mov     r3,a
                +1  7236             mov     a,r4
                +1  7237             rrc     a
                +1  7238             mov     r4,a
                +1  7239             mov     a,r5
                +1  7240             rrc     a
                +1  7241             mov     r5,a
                +1  7242             endm
                +1  7243     
                +1  7244     
                +1  7245     lshift  macro
                +1  7246             mov     a,r5
                +1  7247             rlc     a
                +1  7248             mov     r5,a
                +1  7249             mov     a,r4
                +1  7250             rlc     a
                +1  7251             mov     r4,a
                +1  7252             mov     a,r3
                +1  7253             rlc     a
                +1  7254             mov     r3,a
                +1  7255             mov     a,r2
                +1  7256             rlc     a
                +1  7257             mov     r2,a
                +1  7258             endm
                +1  7259     
                +1  7260     neg1    macro
                +1  7261             clr     c
                +1  7262             clr     a
                +1  7263             subb    a,r5
                +1  7264             mov     r5,a
                +1  7265             clr     a
                +1  7266             subb    a,r4
                +1  7267             mov     r4,a
                +1  7268             clr     a
                +1  7269             subb    a,r3
                +1  7270             mov     r3,a
                +1  7271             clr     a
                +1  7272             subb    a,r2
                +1  7273             mov     r2,a
                +1  7274             endm
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   116

                +1  7275     
                +1  7276     negm    macro  addr
                +1  7277             clr     c
                +1  7278             clr     a
                +1  7279             subb    a,addr+3
                +1  7280             mov     addr+3,a
                +1  7281             clr     a
                +1  7282             subb    a,addr+2
                +1  7283             mov     addr+2,a
                +1  7284             clr     a
                +1  7285             subb    a,addr+1
                +1  7286             mov     addr+1,a
                +1  7287             clr     a
                +1  7288             subb    a,addr
                +1  7289             mov     addr,a
                +1  7290             endm
                +1  7291     
                +1  7292     copytor macro  addr
                +1  7293             mov     r2,addr
                +1  7294             mov     r3,addr+1
                +1  7295             mov     r4,addr+2
                +1  7296             mov     r5,addr+3
                +1  7297             endm
                +1  7298     
                +1  7299     
                +1  7300     copyrto macro  addr
                +1  7301             mov     addr,r2
                +1  7302             mov     addr+1,r3
                +1  7303             mov     addr+2,r4
                +1  7304             mov     addr+3,r5
                +1  7305             endm
                +1  7306     
                +1  7307     
                +1  7308     ;       Internal representation: in this set of routines a floating number
                +1  7309     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  7310     
                +1  7311     ;       Stack offset values
                +1  7312     ;ltemp   equ     28h
                +1  7313     
  0006          +1  7314     cntr    equ     6               ;r6 is the counter
  0007          +1  7315     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  7316     exp1    equ     0               ;exponent 1 in r0
  0002          +1  7317     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  7318     exp2    equ     1               ;exponent 1 in r1
  0008          +1  7319     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  7320     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  7321     
                +1  7322     
                +1  7323     
                +1  7324     
                +1  7325     
                +1  7326     ;DECSIZE EQU     10
                +1  7327     ;NUMSIZE EQU     4
                +1  7328     ;RR4     EQU     4
                +1  7329     ;RR5     EQU     5
                +1  7330     
                +1  7331     ;       unpack1 - unpacks the left operand
                +1  7332     
009E            +1  7333     unpack1:
009E EA         +1  7334             mov     a,r2            ;get sign
009F 5480       +1  7335             anl     a,#80h
00A1 530740     +1  7336             anl     sign,#40h       ;clear other bits
00A4 4207       +1  7337             orl     sign,a          ;store sign
00A6 EB         +1  7338             mov     a,r3            ;get lsb of exponent
00A7 33         +1  7339             rlc     a               ;rotate into carry
00A8 EA         +1  7340             mov     a,r2            ;get rest of exponent
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   117

00A9 33         +1  7341             rlc     a               ;and make it 8 bits
00AA F8         +1  7342             mov     r0,a            ;store it
00AB 6006       +1  7343             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  7344             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  7345             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  7346             ret
00B3            +1  7347     zer1:
00B3 E4         +1  7348             clr     a
00B4 FA         +1  7349             mov     r2,a
00B5 FB         +1  7350             mov     r3,a
00B6 FC         +1  7351             mov     r4,a
00B7 FD         +1  7352             mov     r5,a            ;zero mantissa
00B8 F8         +1  7353             mov     r0,a            ;zero exponent
00B9 22         +1  7354             ret
                +1  7355     
                +1  7356     ;       unpack2 - unpacks right operand
                +1  7357     
00BA            +1  7358     unpack2:
00BA E508       +1  7359             mov     a,ltemp         ;get sign
00BC 13         +1  7360             rrc     a               ;shift down
00BD 5440       +1  7361             anl     a,#40h          ;mask out sign
00BF 530780     +1  7362             anl     sign,#80h       ;clear old bit
00C2 4207       +1  7363             orl     sign,a
00C4 E509       +1  7364             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  7365             rlc     a               ;rotate into carry
00C7 E508       +1  7366             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  7367             rlc     a               ;and make it 8 bits
00CA F9         +1  7368             mov     r1,a            ;store it
00CB 6007       +1  7369             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  7370             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  7371             mov     mant2,#0        ;clear upper byte
00D3 22         +1  7372             ret
00D4            +1  7373     zer2:
00D4 E4         +1  7374             clr     a
00D5 F508       +1  7375             mov     ltemp,a
00D7 F509       +1  7376             mov     ltemp+1,a
00D9 F50A       +1  7377             mov     ltemp+2,a
00DB F50B       +1  7378             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  7379             ret
                +1  7380     
                +1  7381     ;       pack1 - put operand 1 back into float format
                +1  7382     
00DE            +1  7383     pack1:
00DE E8         +1  7384             mov     a,r0            ;get exponent
00DF C3         +1  7385             clr     c
00E0 13         +1  7386             rrc     a               ;shift down 1 bit
00E1 530780     +1  7387             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  7388             orl     a,r7            ;or in sign bit
00E5 FA         +1  7389             mov     r2,a            ;store
00E6 E8         +1  7390             mov     a,r0            ;get other bit
00E7 03         +1  7391             rr      a               ;rotate into hi bit
00E8 5480       +1  7392             anl     a,#80h          ;mask
00EA 53037F     +1  7393             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  7394             orl     mant1+1,a       ;put in
00EF 22         +1  7395             ret
                +1  7396     
                +1  7397     
                +1  7398     ;       norm1 - normalize the unpacked value in 1
                +1  7399     
00F0            +1  7400     norm1:
00F0 E8         +1  7401             mov     a,r0            ;get exponent
00F1 60C0       +1  7402             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  7403             mov     a,r2            ;get hi byte
00F4 6023       +1  7404             jz      norup           ;zero, so shift up if anything
00F6            +1  7405     nordn:
00F6 EA         +1  7406             mov     a,r2            ;get hi byte
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   118

00F7 B4010D     +1  7407             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  7408+3           add1                    ;add in a rounding bit
00FA ED         +1  7409+1           mov     a,r5
00FB 2401       +1  7410+1           add     a,#1
00FD FD         +1  7411+1           mov     r5,a
00FE E4         +1  7412+1           clr     a
00FF 3C         +1  7413+1           addc    a,r4
0100 FC         +1  7414+1           mov     r4,a
0101 E4         +1  7415+1           clr     a
0102 3B         +1  7416+1           addc    a,r3
0103 FB         +1  7417+1           mov     r3,a
0104 E4         +1  7418+1           clr     a
0105 3A         +1  7419+1           addc    a,r2
0106 FA         +1  7420+1           mov     r2,a
0107            +1  7421     nordn1:
                +1  7422+3           rshift                  ;shift down 1 bit
0107 C3         +1  7423+1           clr     c
0108 EA         +1  7424+1           mov     a,r2
0109 13         +1  7425+1           rrc     a
010A FA         +1  7426+1           mov     r2,a
010B EB         +1  7427+1           mov     a,r3
010C 13         +1  7428+1           rrc     a
010D FB         +1  7429+1           mov     r3,a
010E EC         +1  7430+1           mov     a,r4
010F 13         +1  7431+1           rrc     a
0110 FC         +1  7432+1           mov     r4,a
0111 ED         +1  7433+1           mov     a,r5
0112 13         +1  7434+1           rrc     a
0113 FD         +1  7435+1           mov     r5,a
0114 08         +1  7436             inc     r0              ;adjust exponent
0115 EA         +1  7437             mov     a,r2            ;test high byte
0116 70DE       +1  7438             jnz     nordn           ;loop
0118 22         +1  7439             ret                     ;done
                +1  7440     
0119            +1  7441     norup:
0119 4B         +1  7442             orl     a,r3
011A 4C         +1  7443             orl     a,r4
011B 4D         +1  7444             orl     a,r5            ;test for zero mantissa
011C 6095       +1  7445             jz      zer1            ;it is - make it true zero
011E            +1  7446     norup1:
011E EB         +1  7447             mov     a,r3            ;get mantissa byte
011F 20E710     +1  7448             jb      acc.7,norup2    ;jump if set
0122 C3         +1  7449             clr     c
                +1  7450+3           lshift                  ;shift mantissa up
0123 ED         +1  7451+1           mov     a,r5
0124 33         +1  7452+1           rlc     a
0125 FD         +1  7453+1           mov     r5,a
0126 EC         +1  7454+1           mov     a,r4
0127 33         +1  7455+1           rlc     a
0128 FC         +1  7456+1           mov     r4,a
0129 EB         +1  7457+1           mov     a,r3
012A 33         +1  7458+1           rlc     a
012B FB         +1  7459+1           mov     r3,a
012C EA         +1  7460+1           mov     a,r2
012D 33         +1  7461+1           rlc     a
012E FA         +1  7462+1           mov     r2,a
012F 18         +1  7463             dec     r0              ;adjust exponent
0130 80EC       +1  7464             jmp     norup1
0132            +1  7465     norup2:
0132 22         +1  7466             ret                     ;finito
                +1  7467     
                +1  7468     
                +1  7469     ;       fpdenorm - denormalize one of the two operands so that their
                +1  7470     ;       exponents are equal. This requires the smaller number to have
                +1  7471     ;       its exponent incremented and its mantissa shifted right.
                +1  7472     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   119

0133            +1  7473     denorm:
0133 E8         +1  7474             mov     a,r0
0134 C3         +1  7475             clr     c
0135 99         +1  7476             subb    a,r1            ;compare exponents
0136 5029       +1  7477             jnc     up2a            ;shift operand 2
0138            +1  7478     up1:
0138 08         +1  7479             inc     r0              ;increment exponent
                +1  7480+3           rshift                  ;shift mantissa down
0139 C3         +1  7481+1           clr     c
013A EA         +1  7482+1           mov     a,r2
013B 13         +1  7483+1           rrc     a
013C FA         +1  7484+1           mov     r2,a
013D EB         +1  7485+1           mov     a,r3
013E 13         +1  7486+1           rrc     a
013F FB         +1  7487+1           mov     r3,a
0140 EC         +1  7488+1           mov     a,r4
0141 13         +1  7489+1           rrc     a
0142 FC         +1  7490+1           mov     r4,a
0143 ED         +1  7491+1           mov     a,r5
0144 13         +1  7492+1           rrc     a
0145 FD         +1  7493+1           mov     r5,a
0146 E8         +1  7494             mov     a,r0
0147 B501EE     +1  7495             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  7496             ret
                +1  7497     
014B            +1  7498     up2:
014B 09         +1  7499             inc     r1              ;increment exponent 2
                +1  7500+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  7501+1           clr     c
014D E508       +1  7502+1           mov     a,mant2
014F 13         +1  7503+1           rrc     a
0150 F508       +1  7504+1           mov     mant2,a
0152 E509       +1  7505+1           mov     a,mant2+1
0154 13         +1  7506+1           rrc     a
0155 F509       +1  7507+1           mov     mant2+1,a
0157 E50A       +1  7508+1           mov     a,mant2+2
0159 13         +1  7509+1           rrc     a
015A F50A       +1  7510+1           mov     mant2+2,a
015C E50B       +1  7511+1           mov     a,mant2+3
015E 13         +1  7512+1           rrc     a
015F F50B       +1  7513+1           mov     mant2+3,a
0161            +1  7514     up2a:
0161 E8         +1  7515             mov     a,r0            ;compare exponents
0162 B501E6     +1  7516             cjne    a,exp2,up2
0165 22         +1  7517             ret                     ;all done
                +1  7518     ;------------------------------------------------------------------
                +1  7519     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  7520     
0166            +1  7521     fladd:
                +1  7522+3           saveregs
0166 C007       +1  7523+1           push    7
0168 C006       +1  7524+1           push    6
016A C001       +1  7525+1           push    1
016C C000       +1  7526+1           push    0
016E 119E       +1  7527             call    unpack1
0170 11BA       +1  7528             call    unpack2
0172 3133       +1  7529             call    denorm
0174 E507       +1  7530             mov     a,sign
0176 30E70D     +1  7531             jnb     acc.7,ok1       ;test left sign
                +1  7532+3           neg1                    ;negate op1
0179 C3         +1  7533+1           clr     c
017A E4         +1  7534+1           clr     a
017B 9D         +1  7535+1           subb    a,r5
017C FD         +1  7536+1           mov     r5,a
017D E4         +1  7537+1           clr     a
017E 9C         +1  7538+1           subb    a,r4
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   120

017F FC         +1  7539+1           mov     r4,a
0180 E4         +1  7540+1           clr     a
0181 9B         +1  7541+1           subb    a,r3
0182 FB         +1  7542+1           mov     r3,a
0183 E4         +1  7543+1           clr     a
0184 9A         +1  7544+1           subb    a,r2
0185 FA         +1  7545+1           mov     r2,a
0186            +1  7546     ok1:
0186 E507       +1  7547             mov     a,sign
0188 30E615     +1  7548             jnb     acc.6,ok2       ;test right sign
                +1  7549+3           negm    mant2           ;negate op2
018B C3         +1  7550+1           clr     c
018C E4         +1  7551+1           clr     a
018D 950B       +1  7552+1           subb    a,mant2+3
018F F50B       +1  7553+1           mov     mant2+3,a
0191 E4         +1  7554+1           clr     a
0192 950A       +1  7555+1           subb    a,mant2+2
0194 F50A       +1  7556+1           mov     mant2+2,a
0196 E4         +1  7557+1           clr     a
0197 9509       +1  7558+1           subb    a,mant2+1
0199 F509       +1  7559+1           mov     mant2+1,a
019B E4         +1  7560+1           clr     a
019C 9508       +1  7561+1           subb    a,mant2
019E F508       +1  7562+1           mov     mant2,a
01A0            +1  7563     ok2:
                +1  7564+3           addl    mant2           ;add mantissas
01A0 ED         +1  7565+1           mov     a,r5
01A1 250B       +1  7566+1           add     a,mant2+3
01A3 FD         +1  7567+1           mov     r5,a
01A4 E50A       +1  7568+1           mov     a,mant2+2
01A6 3C         +1  7569+1           addc    a,r4
01A7 FC         +1  7570+1           mov     r4,a
01A8 E509       +1  7571+1           mov     a,mant2+1
01AA 3B         +1  7572+1           addc    a,r3
01AB FB         +1  7573+1           mov     r3,a
01AC E508       +1  7574+1           mov     a,mant2+0
01AE 3A         +1  7575+1           addc    a,r2
01AF FA         +1  7576+1           mov     r2,a
01B0 E4         +1  7577             clr     a
01B1 FF         +1  7578             mov     r7,a            ;clear sign
01B2 EA         +1  7579             mov     a,r2            ;get sign of result
01B3 30E70E     +1  7580             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  7581             mov     r7,a            ;store sign
                +1  7582+3           neg1                    ;negate mantissa
01B7 C3         +1  7583+1           clr     c
01B8 E4         +1  7584+1           clr     a
01B9 9D         +1  7585+1           subb    a,r5
01BA FD         +1  7586+1           mov     r5,a
01BB E4         +1  7587+1           clr     a
01BC 9C         +1  7588+1           subb    a,r4
01BD FC         +1  7589+1           mov     r4,a
01BE E4         +1  7590+1           clr     a
01BF 9B         +1  7591+1           subb    a,r3
01C0 FB         +1  7592+1           mov     r3,a
01C1 E4         +1  7593+1           clr     a
01C2 9A         +1  7594+1           subb    a,r2
01C3 FA         +1  7595+1           mov     r2,a
01C4            +1  7596     ok3:
01C4 11F0       +1  7597             call    norm1
01C6 11DE       +1  7598             call    pack1           ;pack normalized result
                +1  7599+3           restregs                ;and return
01C8 D000       +1  7600+1           pop     0
01CA D001       +1  7601+1           pop     1
01CC D006       +1  7602+1           pop     6
01CE D007       +1  7603+1           pop     7
01D0 22         +1  7604             ret
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   121

                +1  7605     ;-------------------------------------------------------------
                +1  7606     ;       Subtract the number ltemp from the number in r2-r5
                +1  7607     
01D1            +1  7608     flsub:
01D1 630880     +1  7609             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  7610             jmp     fladd           ;and add!
                +1  7611     
                +1  7612     ;================================================================
                +1  7613     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  7614     
01D6            +1  7615     flcmp:
01D6 EA         +1  7616            mov     a,r2            ;get sign of left
01D7 6508       +1  7617            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  7618            jnb     acc.7,cexp      ;same, go check exponent
                +1  7619     ;ifdef SMALL_MODEL
01DC EA         +1  7620             mov     a,r2            ;get sign of left again
01DD 33         +1  7621             rlc     a
01DE 5001       +1  7622             jnc     flout
                +1  7623     ;endif
01E0 D3         +1  7624             setb    c
01E1 22         +1  7625     flout:          ret                    ;return with acc < 0
                +1  7626     
01E2            +1  7627     cexp:
01E2 C3         +1  7628            clr     c
01E3 EA         +1  7629            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  7630            subb    a,ltemp
01E6 7010       +1  7631            jnz     fnd
01E8 EB         +1  7632            mov     a,r3
01E9 9509       +1  7633            subb    a,ltemp+1
01EB 700B       +1  7634            jnz     fnd
01ED EC         +1  7635            mov     a,r4
01EE 950A       +1  7636            subb    a,ltemp+2
01F0 7006       +1  7637            jnz     fnd
01F2 ED         +1  7638            mov     a,r5
01F3 950B       +1  7639            subb    a,ltemp+3
01F5 7001       +1  7640            jnz     fnd
01F7            +1  7641     cdone:
01F7 22         +1  7642            ret                     ;return with acc == 0
01F8            +1  7643     fnd:
01F8 8AF0       +1  7644           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  7645          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  7646            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  7647                         orl         a,#1                          ;make non-zero
0201 B3         +1  7648             cpl     c               ;c=0->1,c=1->0
0202 22         +1  7649             ret
                +1  7650     ;==============================================================
                +1  7651     
                +1  7652     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  7653     ;       the result in r2-r5
                +1  7654     
0203            +1  7655     flmul:
                +1  7656+3           saveregs
0203 C007       +1  7657+1           push    7
0205 C006       +1  7658+1           push    6
0207 C001       +1  7659+1           push    1
0209 C000       +1  7660+1           push    0
020B 119E       +1  7661             call    unpack1
020D 11BA       +1  7662             call    unpack2
020F E4         +1  7663             clr     a
0210 F50C       +1  7664             mov     prod,a
0212 F50D       +1  7665             mov     prod+1,a        ;clear product
0214 F50E       +1  7666             mov     prod+2,a
0216 F50F       +1  7667             mov     prod+3,a
0218 7E07       +1  7668             mov     r6,#7           ;initialize counter
021A            +1  7669     mup1:
                +1  7670+3           shfdn   mant2           ;shift multiplier right
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   122

021A C3         +1  7671+1           clr     c
021B E508       +1  7672+1           mov     a,mant2
021D 13         +1  7673+1           rrc     a
021E F508       +1  7674+1           mov     mant2,a
0220 E509       +1  7675+1           mov     a,mant2+1
0222 13         +1  7676+1           rrc     a
0223 F509       +1  7677+1           mov     mant2+1,a
0225 E50A       +1  7678+1           mov     a,mant2+2
0227 13         +1  7679+1           rrc     a
0228 F50A       +1  7680+1           mov     mant2+2,a
022A E50B       +1  7681+1           mov     a,mant2+3
022C 13         +1  7682+1           rrc     a
022D F50B       +1  7683+1           mov     mant2+3,a
022F 5014       +1  7684             jnc     nobit           ;skip if lsb was zero
                +1  7685+3           dan     prod            ;add multiplicand to product
0231 ED         +1  7686+1           mov     a,r5
0232 250F       +1  7687+1           add     a,prod+3
0234 F50F       +1  7688+1           mov     prod+3,a
0236 E50E       +1  7689+1           mov     a,prod+2
0238 3C         +1  7690+1           addc    a,r4
0239 F50E       +1  7691+1           mov     prod+2,a
023B E50D       +1  7692+1           mov     a,prod+1
023D 3B         +1  7693+1           addc    a,r3
023E F50D       +1  7694+1           mov     prod+1,a
0240 E50C       +1  7695+1           mov     a,prod+0
0242 3A         +1  7696+1           addc    a,r2
0243 F50C       +1  7697+1           mov     prod,a
0245            +1  7698     nobit:
                +1  7699+3           lshift                  ;shift multiplicand up
0245 ED         +1  7700+1           mov     a,r5
0246 33         +1  7701+1           rlc     a
0247 FD         +1  7702+1           mov     r5,a
0248 EC         +1  7703+1           mov     a,r4
0249 33         +1  7704+1           rlc     a
024A FC         +1  7705+1           mov     r4,a
024B EB         +1  7706+1           mov     a,r3
024C 33         +1  7707+1           rlc     a
024D FB         +1  7708+1           mov     r3,a
024E EA         +1  7709+1           mov     a,r2
024F 33         +1  7710+1           rlc     a
0250 FA         +1  7711+1           mov     r2,a
0251 DEC7       +1  7712             djnz    r6,mup1         ;loop if more
                +1  7713     
0253 7E11       +1  7714             mov     r6,#17          ;re-initalize counter
0255 8015       +1  7715             sjmp    mup3
0257            +1  7716     mup11:
                +1  7717+3           shfdn   prod            ;shift product right
0257 C3         +1  7718+1           clr     c
0258 E50C       +1  7719+1           mov     a,prod
025A 13         +1  7720+1           rrc     a
025B F50C       +1  7721+1           mov     prod,a
025D E50D       +1  7722+1           mov     a,prod+1
025F 13         +1  7723+1           rrc     a
0260 F50D       +1  7724+1           mov     prod+1,a
0262 E50E       +1  7725+1           mov     a,prod+2
0264 13         +1  7726+1           rrc     a
0265 F50E       +1  7727+1           mov     prod+2,a
0267 E50F       +1  7728+1           mov     a,prod+3
0269 13         +1  7729+1           rrc     a
026A F50F       +1  7730+1           mov     prod+3,a
026C            +1  7731     mup3:
                +1  7732+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  7733+1           clr     c
026D E508       +1  7734+1           mov     a,mant2
026F 13         +1  7735+1           rrc     a
0270 F508       +1  7736+1           mov     mant2,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   123

0272 E509       +1  7737+1           mov     a,mant2+1
0274 13         +1  7738+1           rrc     a
0275 F509       +1  7739+1           mov     mant2+1,a
0277 E50A       +1  7740+1           mov     a,mant2+2
0279 13         +1  7741+1           rrc     a
027A F50A       +1  7742+1           mov     mant2+2,a
027C E50B       +1  7743+1           mov     a,mant2+3
027E 13         +1  7744+1           rrc     a
027F F50B       +1  7745+1           mov     mant2+3,a
0281 5014       +1  7746             jnc     mup2            ;skip if bit not set
                +1  7747+3           dan     prod            ;add to prod
0283 ED         +1  7748+1           mov     a,r5
0284 250F       +1  7749+1           add     a,prod+3
0286 F50F       +1  7750+1           mov     prod+3,a
0288 E50E       +1  7751+1           mov     a,prod+2
028A 3C         +1  7752+1           addc    a,r4
028B F50E       +1  7753+1           mov     prod+2,a
028D E50D       +1  7754+1           mov     a,prod+1
028F 3B         +1  7755+1           addc    a,r3
0290 F50D       +1  7756+1           mov     prod+1,a
0292 E50C       +1  7757+1           mov     a,prod+0
0294 3A         +1  7758+1           addc    a,r2
0295 F50C       +1  7759+1           mov     prod,a
0297            +1  7760     mup2:
0297 DEBE       +1  7761             djnz    r6,mup11        ;loop if more
0299 E8         +1  7762             mov     a,r0            ;get exp1
029A 29         +1  7763             add     a,r1            ;add exp2
029B 247A       +1  7764             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  7765             mov     r0,a            ;store
029E EF         +1  7766             mov     a,r7            ;get sign
029F 23         +1  7767             rl      a               ;rotate bit into msb
02A0 6207       +1  7768             xrl     sign,a          ;xor with other bit
                +1  7769+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  7770+1           mov     r2,prod
02A4 AB0D       +1  7771+1           mov     r3,prod+1
02A6 AC0E       +1  7772+1           mov     r4,prod+2
02A8 AD0F       +1  7773+1           mov     r5,prod+3
02AA 11F0       +1  7774             call    norm1           ;normalize
02AC 11DE       +1  7775             call    pack1
                +1  7776+3           restregs
02AE D000       +1  7777+1           pop     0
02B0 D001       +1  7778+1           pop     1
02B2 D006       +1  7779+1           pop     6
02B4 D007       +1  7780+1           pop     7
02B6 22         +1  7781             ret
                +1  7782     ;-----------------------------------------------------------
                +1  7783     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  7784     
02B7            +1  7785     fldiv:
                +1  7786+3           saveregs
02B7 C007       +1  7787+1           push    7
02B9 C006       +1  7788+1           push    6
02BB C001       +1  7789+1           push    1
02BD C000       +1  7790+1           push    0
02BF 119E       +1  7791             call    unpack1
02C1 11BA       +1  7792             call    unpack2
02C3 E4         +1  7793             clr     a
02C4 F50C       +1  7794             mov     prod,a
02C6 F50D       +1  7795             mov     prod+1,a
02C8 F50E       +1  7796             mov     prod+2,a
02CA F50F       +1  7797             mov     prod+3,a
02CC E9         +1  7798             mov     a,r1            ;check for zero divisor
02CD 6067       +1  7799             jz      div9
02CF E8         +1  7800             mov     a,r0            ;check for zero dividend
02D0 6064       +1  7801             jz      div9
02D2 C3         +1  7802             clr     c
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   124

02D3 99         +1  7803             subb    a,r1            ;compute new exponent
02D4 2478       +1  7804             add     a,#127-7        ;unbias
02D6 F8         +1  7805             mov     r0,a            ;store back
02D7 EF         +1  7806             mov     a,r7            ;get sign
02D8 23         +1  7807             rl      a
02D9 6207       +1  7808             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  7809             mov     r6,#24+7        ;initialize counter
02DD            +1  7810     div1:
                +1  7811+3           shfup   prod            ;shift quotient up
02DD C3         +1  7812+1           clr     c
02DE E50F       +1  7813+1           mov     a,prod+3
02E0 33         +1  7814+1           rlc     a
02E1 F50F       +1  7815+1           mov     prod+3,a
02E3 E50E       +1  7816+1           mov     a,prod+2
02E5 33         +1  7817+1           rlc     a
02E6 F50E       +1  7818+1           mov     prod+2,a
02E8 E50D       +1  7819+1           mov     a,prod+1
02EA 33         +1  7820+1           rlc     a
02EB F50D       +1  7821+1           mov     prod+1,a
02ED E50C       +1  7822+1           mov     a,prod
02EF 33         +1  7823+1           rlc     a
02F0 F50C       +1  7824+1           mov     prod,a
02F2 C3         +1  7825             clr     c
02F3 EA         +1  7826             mov     a,r2            ;compare values
02F4 9508       +1  7827             subb    a,mant2
02F6 4028       +1  7828             jc      div2            ;skip if bigger
02F8 7013       +1  7829             jnz     div3
02FA EB         +1  7830             mov     a,r3            ;compare values
02FB 9509       +1  7831             subb    a,mant2+1
02FD 4021       +1  7832             jc      div2            ;skip if bigger
02FF 700C       +1  7833             jnz     div3
0301 EC         +1  7834             mov     a,r4            ;compare values
0302 950A       +1  7835             subb    a,mant2+2
0304 401A       +1  7836             jc      div2            ;skip if bigger
0306 7005       +1  7837             jnz     div3
0308 ED         +1  7838             mov     a,r5            ;compare values
0309 950B       +1  7839             subb    a,mant2+3
030B 4013       +1  7840             jc      div2            ;skip if bigger
030D            +1  7841     div3:
030D ED         +1  7842             mov     a,r5
030E 950B       +1  7843             subb    a,mant2+3
0310 FD         +1  7844             mov     r5,a
0311 EC         +1  7845             mov     a,r4
0312 950A       +1  7846             subb    a,mant2+2               ;do subtraction
0314 FC         +1  7847             mov     r4,a
0315 EB         +1  7848             mov     a,r3
0316 9509       +1  7849             subb    a,mant2+1               ;do subtraction
0318 FB         +1  7850             mov     r3,a
0319 EA         +1  7851             mov     a,r2
031A 9508       +1  7852             subb    a,mant2         ;do subtraction
031C FA         +1  7853             mov     r2,a
031D 430F01     +1  7854             orl     prod+3,#1       ;set lsb in quotient
0320            +1  7855     div2:
                +1  7856+3           lshift                  ;shift dividend up
0320 ED         +1  7857+1           mov     a,r5
0321 33         +1  7858+1           rlc     a
0322 FD         +1  7859+1           mov     r5,a
0323 EC         +1  7860+1           mov     a,r4
0324 33         +1  7861+1           rlc     a
0325 FC         +1  7862+1           mov     r4,a
0326 EB         +1  7863+1           mov     a,r3
0327 33         +1  7864+1           rlc     a
0328 FB         +1  7865+1           mov     r3,a
0329 EA         +1  7866+1           mov     a,r2
032A 33         +1  7867+1           rlc     a
032B FA         +1  7868+1           mov     r2,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   125

032C DEAF       +1  7869             djnz    r6,div1         ;loop if more
                +1  7870+3           copytor prod            ;copy quotient
032E AA0C       +1  7871+1           mov     r2,prod
0330 AB0D       +1  7872+1           mov     r3,prod+1
0332 AC0E       +1  7873+1           mov     r4,prod+2
0334 AD0F       +1  7874+1           mov     r5,prod+3
0336            +1  7875     div9:
0336 11F0       +1  7876             call    norm1           ;now normalize result
0338 11DE       +1  7877             call    pack1           ;pack it up
                +1  7878+3           restregs                ;restore registers
033A D000       +1  7879+1           pop     0
033C D001       +1  7880+1           pop     1
033E D006       +1  7881+1           pop     6
0340 D007       +1  7882+1           pop     7
0342 22         +1  7883             ret
                +1  7884     ;------------------------------------------------------------------
                +1  7885     
                +1  7886     ;       Float to long conversion: if the exponent is less than the
                +1  7887     ;       excess value, the result is zero. If the exponent is so large
                +1  7888     ;       that the value would be shifted out, the result is overflow.
                +1  7889     ;       Otherwise shift the mantissa up or down as required.
                +1  7890     
0343            +1  7891     ftol:
                +1  7892+3           saveregs
0343 C007       +1  7893+1           push    7
0345 C006       +1  7894+1           push    6
0347 C001       +1  7895+1           push    1
0349 C000       +1  7896+1           push    0
034B EA         +1  7897             mov     a,r2
034C B4BF09     +1  7898             cjne    a,#0bfh,ne05
034F EB         +1  7899             mov     a,r3
0350 7006       +1  7900             jnz     ne05
0352 EC         +1  7901             mov     a,r4
0353 7003       +1  7902             jnz     ne05
0355 ED         +1  7903             mov     a,r5
0356 6024       +1  7904             jz      ftol1
0358 119E       +1  7905     ne05:   call    unpack1
035A E8         +1  7906             mov     a,r0            ;get exponent
035B 2482       +1  7907             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  7908             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  7909             mov     a,r7            ;get sign
0361 30E70D     +1  7910             jnb     acc.7,ftol4     ;skip if +ve
                +1  7911+3           neg1                    ;negate it
0364 C3         +1  7912+1           clr     c
0365 E4         +1  7913+1           clr     a
0366 9D         +1  7914+1           subb    a,r5
0367 FD         +1  7915+1           mov     r5,a
0368 E4         +1  7916+1           clr     a
0369 9C         +1  7917+1           subb    a,r4
036A FC         +1  7918+1           mov     r4,a
036B E4         +1  7919+1           clr     a
036C 9B         +1  7920+1           subb    a,r3
036D FB         +1  7921+1           mov     r3,a
036E E4         +1  7922+1           clr     a
036F 9A         +1  7923+1           subb    a,r2
0370 FA         +1  7924+1           mov     r2,a
0371            +1  7925     ftol4:
0371 E8         +1  7926             mov     a,r0            ;get exponent
0372 246A       +1  7927             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  7928             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  7929             mov     r0,a            ;save it
0378 24F8       +1  7930             add     a,#-8           ;if > 8, too big
037A 500E       +1  7931             jnc     ftol3
037C            +1  7932     ftol1:
037C E4         +1  7933             clr     a
037D FA         +1  7934             mov     r2,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   126

037E FB         +1  7935             mov     r3,a
037F FC         +1  7936             mov     r4,a
0380 FD         +1  7937             mov     r5,a
0381            +1  7938     ftol9:
                +1  7939+3           restregs
0381 D000       +1  7940+1           pop     0
0383 D001       +1  7941+1           pop     1
0385 D006       +1  7942+1           pop     6
0387 D007       +1  7943+1           pop     7
0389 22         +1  7944             ret
038A            +1  7945     ftol3:
038A E8         +1  7946             mov     a,r0
038B FE         +1  7947             mov     r6,a            ;store in counter
038C 60F3       +1  7948             jz      ftol9           ;if zero, do nothing
038E            +1  7949     ftol33:
                +1  7950+3           lshift                  ;shift up
038E ED         +1  7951+1           mov     a,r5
038F 33         +1  7952+1           rlc     a
0390 FD         +1  7953+1           mov     r5,a
0391 EC         +1  7954+1           mov     a,r4
0392 33         +1  7955+1           rlc     a
0393 FC         +1  7956+1           mov     r4,a
0394 EB         +1  7957+1           mov     a,r3
0395 33         +1  7958+1           rlc     a
0396 FB         +1  7959+1           mov     r3,a
0397 EA         +1  7960+1           mov     a,r2
0398 33         +1  7961+1           rlc     a
0399 FA         +1  7962+1           mov     r2,a
039A DEF2       +1  7963             djnz    r6,ftol33       ;and loop
039C 80E3       +1  7964             sjmp    ftol9
039E            +1  7965     ftol2:
039E F4         +1  7966             cpl     a               ;complement
039F FE         +1  7967             mov     r6,a
03A0 6022       +1  7968             jz      ftol22
03A2            +1  7969     ftol23:
03A2 EF         +1  7970             mov     a,r7
03A3 30E70F     +1  7971             jnb     acc.7,ftol24
                +1  7972+3           rshift1
03A6 D3         +1  7973+1           setb    c
03A7 EA         +1  7974+1           mov     a,r2
03A8 13         +1  7975+1           rrc     a
03A9 FA         +1  7976+1           mov     r2,a
03AA EB         +1  7977+1           mov     a,r3
03AB 13         +1  7978+1           rrc     a
03AC FB         +1  7979+1           mov     r3,a
03AD EC         +1  7980+1           mov     a,r4
03AE 13         +1  7981+1           rrc     a
03AF FC         +1  7982+1           mov     r4,a
03B0 ED         +1  7983+1           mov     a,r5
03B1 13         +1  7984+1           rrc     a
03B2 FD         +1  7985+1           mov     r5,a
03B3 800D       +1  7986             jmp     ftol25
03B5            +1  7987+3   ftol24: rshift                  ;shift down
03B5 C3         +1  7988+1           clr     c
03B6 EA         +1  7989+1           mov     a,r2
03B7 13         +1  7990+1           rrc     a
03B8 FA         +1  7991+1           mov     r2,a
03B9 EB         +1  7992+1           mov     a,r3
03BA 13         +1  7993+1           rrc     a
03BB FB         +1  7994+1           mov     r3,a
03BC EC         +1  7995+1           mov     a,r4
03BD 13         +1  7996+1           rrc     a
03BE FC         +1  7997+1           mov     r4,a
03BF ED         +1  7998+1           mov     a,r5
03C0 13         +1  7999+1           rrc     a
03C1 FD         +1  8000+1           mov     r5,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   127

03C2 DEDE       +1  8001     ftol25: djnz    r6,ftol23
03C4            +1  8002     ftol22:
                +1  8003+3           add1                    ;round
03C4 ED         +1  8004+1           mov     a,r5
03C5 2401       +1  8005+1           add     a,#1
03C7 FD         +1  8006+1           mov     r5,a
03C8 E4         +1  8007+1           clr     a
03C9 3C         +1  8008+1           addc    a,r4
03CA FC         +1  8009+1           mov     r4,a
03CB E4         +1  8010+1           clr     a
03CC 3B         +1  8011+1           addc    a,r3
03CD FB         +1  8012+1           mov     r3,a
03CE E4         +1  8013+1           clr     a
03CF 3A         +1  8014+1           addc    a,r2
03D0 FA         +1  8015+1           mov     r2,a
03D1 EF         +1  8016             mov     a,r7
03D2 30E70F     +1  8017             jnb     acc.7,ftol26
                +1  8018+3           rshift1
03D5 D3         +1  8019+1           setb    c
03D6 EA         +1  8020+1           mov     a,r2
03D7 13         +1  8021+1           rrc     a
03D8 FA         +1  8022+1           mov     r2,a
03D9 EB         +1  8023+1           mov     a,r3
03DA 13         +1  8024+1           rrc     a
03DB FB         +1  8025+1           mov     r3,a
03DC EC         +1  8026+1           mov     a,r4
03DD 13         +1  8027+1           rrc     a
03DE FC         +1  8028+1           mov     r4,a
03DF ED         +1  8029+1           mov     a,r5
03E0 13         +1  8030+1           rrc     a
03E1 FD         +1  8031+1           mov     r5,a
03E2 809D       +1  8032             jmp     ftol9
03E4            +1  8033+3   ftol26: rshift
03E4 C3         +1  8034+1           clr     c
03E5 EA         +1  8035+1           mov     a,r2
03E6 13         +1  8036+1           rrc     a
03E7 FA         +1  8037+1           mov     r2,a
03E8 EB         +1  8038+1           mov     a,r3
03E9 13         +1  8039+1           rrc     a
03EA FB         +1  8040+1           mov     r3,a
03EB EC         +1  8041+1           mov     a,r4
03EC 13         +1  8042+1           rrc     a
03ED FC         +1  8043+1           mov     r4,a
03EE ED         +1  8044+1           mov     a,r5
03EF 13         +1  8045+1           rrc     a
03F0 FD         +1  8046+1           mov     r5,a
03F1 808E       +1  8047             jmp     ftol9
                +1  8048     
                +1  8049     ;       arithmetic integer to floating conversions
                +1  8050     
03F3            +1  8051     abtof:
03F3 ED         +1  8052             mov     a,r5
03F4 23         +1  8053             rl      a
03F5 FC         +1  8054             mov     r4,a
03F6 9C         +1  8055             subb    a,r4
03F7 FC         +1  8056             mov     r4,a
03F8 FB         +1  8057             mov     r3,a
03F9 FA         +1  8058             mov     r2,a
03FA 8006       +1  8059             jmp     altof
03FC            +1  8060     awtof:
03FC EC         +1  8061             mov     a,r4
03FD 23         +1  8062             rl      a
03FE FB         +1  8063             mov     r3,a
03FF 9B         +1  8064             subb    a,r3
0400 FB         +1  8065             mov     r3,a
0401 FA         +1  8066             mov     r2,a
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   128

0402            +1  8067     altof:
                +1  8068+3           saveregs
0402 C007       +1  8069+1           push    7
0404 C006       +1  8070+1           push    6
0406 C001       +1  8071+1           push    1
0408 C000       +1  8072+1           push    0
040A EA         +1  8073             mov     a,r2            ;get sign
040B 5480       +1  8074             anl     a,#80h
040D FF         +1  8075             mov     r7,a            ;store it
040E 30E70D     +1  8076             jnb     acc.7,altof1    ;skip if +ve
                +1  8077+3           neg1
0411 C3         +1  8078+1           clr     c
0412 E4         +1  8079+1           clr     a
0413 9D         +1  8080+1           subb    a,r5
0414 FD         +1  8081+1           mov     r5,a
0415 E4         +1  8082+1           clr     a
0416 9C         +1  8083+1           subb    a,r4
0417 FC         +1  8084+1           mov     r4,a
0418 E4         +1  8085+1           clr     a
0419 9B         +1  8086+1           subb    a,r3
041A FB         +1  8087+1           mov     r3,a
041B E4         +1  8088+1           clr     a
041C 9A         +1  8089+1           subb    a,r2
041D FA         +1  8090+1           mov     r2,a
041E            +1  8091     altof1:
041E 7896       +1  8092             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  8093             call    norm1           ;normalize it
0422 11DE       +1  8094             call    pack1           ;and pack up
                +1  8095+3           restregs
0424 D000       +1  8096+1           pop     0
0426 D001       +1  8097+1           pop     1
0428 D006       +1  8098+1           pop     6
042A D007       +1  8099+1           pop     7
042C 22         +1  8100             ret
                +1  8101     
042D            +1  8102     lbtof:
042D 7C00       +1  8103             mov     r4,#0
042F            +1  8104     lwtof:
042F E4         +1  8105             clr     a
0430 FB         +1  8106             mov     r3,a
0431 FA         +1  8107             mov     r2,a
0432            +1  8108     lltof:
                +1  8109+3           saveregs
0432 C007       +1  8110+1           push    7
0434 C006       +1  8111+1           push    6
0436 C001       +1  8112+1           push    1
0438 C000       +1  8113+1           push    0
043A 7F00       +1  8114             mov     r7,#0           ;zero sign
043C 80E0       +1  8115             sjmp    altof1
                +1  8116     
                +1  8117     ;-------------------------------------------------------
                +1  8118     
                +1  8119     
                    8120     
                    8121     ;$include (d:\amp\wriread.asm)
                +1  8122     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  8123     cle256:          mov            IE,#00H
0441 75B601     +1  8124                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  8125                              MOV            PSCTL,#03
                +1  8126                                             
0447 7400       +1  8127                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  8128                                     movx    @dptr,a                         ;wr
044A 758F00     +1  8129                                     mov             PSCTL,#00
044D 75B600     +1  8130                                 mov         FLSCL,#00
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   129

0450 75A880     +1  8131                               mov           IE,#80H
0453 22         +1  8132                                     ret
                +1  8133     
                +1  8134     ;чтение памяти программ в r8..r11
                +1  8135     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  8136     re4byte:        mov                     dph,r2
0456 8B82       +1  8137                                             mov                     dpl,r3
0458 E4         +1  8138                                             clr                     a
0459 93         +1  8139                                             movc            a,@a+dptr
045A F508       +1  8140                                             mov                     r8,a
045C A3         +1  8141                                             inc                     dptr
045D E4         +1  8142                                             clr                     a
045E 93         +1  8143                                             movc            a,@a+dptr
045F F509       +1  8144                                             mov                     r9,a
0461 A3         +1  8145                                             inc                     dptr
0462 E4         +1  8146                                             clr                     a
0463 93         +1  8147                                             movc            a,@a+dptr
0464 F50A       +1  8148                                             mov                     r10,a
0466 A3         +1  8149                                             inc                     dptr
0467 E4         +1  8150                                             clr                     a
0468 93         +1  8151                                             movc            a,@a+dptr
0469 F50B       +1  8152                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  8153                                             ret
                +1  8154      ;чтение памяти программ в r2..r5
                +1  8155     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  8156     rebyte2:        mov                     dph,r2
046E 8B82       +1  8157                                             mov                     dpl,r3
0470 E4         +1  8158                                             clr                     a
0471 93         +1  8159                                             movc            a,@a+dptr
0472 FA         +1  8160                                             mov                     r2,a
0473 A3         +1  8161                                             inc                     dptr
0474 E4         +1  8162                                             clr                     a
0475 93         +1  8163                                             movc            a,@a+dptr
0476 FB         +1  8164                                             mov                     r3,a
0477 A3         +1  8165                                             inc                     dptr
0478 E4         +1  8166                                             clr                     a
0479 93         +1  8167                                             movc            a,@a+dptr
047A FC         +1  8168                                             mov                     r4,a
047B A3         +1  8169                                             inc                     dptr
047C E4         +1  8170                                             clr                     a
047D 93         +1  8171                                             movc            a,@a+dptr
047E FD         +1  8172                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  8173                                             ret
                +1  8174      
                +1  8175     
                +1  8176      ;r7-количество байт
                +1  8177     ;dptr-адр ячейки для записи
                +1  8178     ;r1-адр ячейки  внешнего озу
                +1  8179     
0480 75A800     +1  8180     wrpage:  mov            IE,#00H
0483 75B601     +1  8181     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  8182                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  8183                      movx           a,@r1
048A F0         +1  8184                      movx           @dptr,a                         ;wr
048B 758F00     +1  8185                      mov            PSCTL,#0
048E 75B600     +1  8186                      mov            FLSCL,#00
0491 A3         +1  8187                     inc                     dptr
0492 09         +1  8188                     inc                     r1
0493 DFEE       +1  8189                     djnz            r7,WW5
0495 75A880     +1  8190                     mov             IE,#80H
0498 22         +1  8191                     ret
                +1  8192                             
                +1  8193     
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   130

                +1  8194     
                +1  8195                                                             
                +1  8196     
                +1  8197     
                +1  8198     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8199     ;чтение памяти программ во внешнее озу
                +1  8200     ;вх-r2,r3-адр яч памяти прогр
                +1  8201     ;r1- яч внешнее озу
0499 8A83       +1  8202     copyPP:         mov                     dph,r2
049B 8B82       +1  8203                                             mov                     dpl,r3
049D 7FFF       +1  8204                                             mov                     r7,#0ffh
049F E4         +1  8205     copy1:          clr                     a
04A0 93         +1  8206                                             movc            a,@a+dptr
04A1 F3         +1  8207                                             movx                    @r1,a
04A2 A3         +1  8208                                             inc                     dptr
04A3 09         +1  8209                                             inc                     r1
04A4 DFF9       +1  8210                                             djnz            r7,copy1
04A6 22         +1  8211                                             ret
                +1  8212     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  8213     
                +1  8214                                     
                +1  8215     
                +1  8216     ;r8..r11->@r0..@r0+3
                +1  8217     ;r0-адр ячейки
                +1  8218     ;сохранить в ячейке озу
04A7 E508       +1  8219     savelte:        mov     a,ltemp
04A9 F6         +1  8220                                             mov     @r0,a
04AA 08         +1  8221                                             inc     r0
04AB E509       +1  8222                                             mov     a,ltemp+1
04AD F6         +1  8223                                             mov     @r0,a
04AE 08         +1  8224                                             inc     r0
04AF E50A       +1  8225                                             mov     a,ltemp+2
04B1 F6         +1  8226                                             mov     @r0,a
04B2 08         +1  8227                                             inc     r0
04B3 E50B       +1  8228                                             mov     a,ltemp+3
04B5 F6         +1  8229                                             mov     @r0,a
04B6 22         +1  8230                                             ret
                +1  8231     
                +1  8232     ;
                +1  8233     
                +1  8234     
                +1  8235     
                +1  8236     
                +1  8237     
                +1  8238                     
                +1  8239     
                +1  8240     
                +1  8241     
                +1  8242     
                +1  8243      
                    8244     
                    8245                                                   
                    8246     END
                                                                             
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   131

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   03A2H   R   SEG=MAIN   859#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1463 1520 1545 1566 1570 1573 1574 1576 1683 1688 3548 3562 3643
                                           3646 3689 3784 3828 3831 3908 3912 3913 3914 3917 4136 4173 4174 4176 4250
                                           4270 4361 4365 4408 4411 4750 4755 4921 4926 5677 5839 5842
ABRET. . . . . . .  C ADDR   2318H   R   SEG=MAIN   5606 5608#
ABTOF. . . . . . .  C ADDR   03F3H   A      8051#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 673 737 745 753 761 763 783 1138 1149 1157 1236 1632 1819 1828 1837
                                           1846 1867 2198 2221 2226 2230 2235 2238 2241 2244 2247 2434 2495 2541 2552
                                           2639 2648 2656 2665 2805 2837 2862 2867 2871 2874 2877 2880 2883 2886 3208
                                           3296 3342 3364 3383 3405 3431 4310 4316 4353 4442 5180 6269 6458 6536 6539
                                           6796 7448 7531 7548 7580 7618 7646 7908 7910 7928 7971 8017 8076
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   2ADDH   R   SEG=MAIN   894 931 933 935 937 939 941 943 945 947 1013 1015 1017 1019 1021
                                           1023 1025 1027 1029 1032 1034 1036 1038 1040 1042 1044 1046 1048 1050 1069
                                           1071 1073 7037#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1519 1531 1535 1550 1575 1578 1579 1687 1691 3561 3565 3640 3644
                                           3686 3690 3781 3785 3830 3834 3916 3929 4146 4160 4162 4164 4175 4178 4260
                                           4271 4366 4412 4754 4758 4925 4929 5478 5497 5515 5578 5595 5841 5844 6190
                                           6222
ADRBLOK. . . . . .  C ADDR   2791H   R   SEG=MAIN   3280 3303 3659 3802 4672 4840 4991 6234#
AFTERK . . . . . .  C ADDR   0699H   R   SEG=MAIN   1166 1245#
AGE2 . . . . . . .  C ADDR   023CH   R   SEG=MAIN   625# 628
AGE9 . . . . . . .  C ADDR   0859H   R   SEG=MAIN   1467# 1470
AGEON. . . . . . .  C ADDR   024AH   R   SEG=MAIN   634# 636
ALESS0 . . . . . .  C ADDR   098EH   R   SEG=MAIN   1632 1653#
ALLSUM . . . . . .  C ADDR   0340H   R   SEG=MAIN   803# 838 856 872
ALMUL. . . . . . .  C ADDR   2A24H   R   SEG=MAIN   6883#
ALTOF. . . . . . .  C ADDR   0402H   A      1132 1230 1261 1269 1287 1303 1314 1331 1344 1425 1958 2048 2113 2151
                                           3693 3790 4274 4369 4415 4503 4581 4589 4607 4713 4725 4740 4824 4886 4902
                                           4975 5037 5052 8059 8067#
ALTOF1 . . . . . .  C ADDR   041EH   A      8076 8091# 8115
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   05FFH   R   SEG=MAIN   1130 1146#
AN_T7. . . . . . .  C ADDR   1172H   R   SEG=MAIN   2887# 2954 2963
AUTOKA . . . . . .  C ADDR   0C20H   R   SEG=MAIN   1164 2076#
AVPGO. . . . . . .  C ADDR   07C6H   R   SEG=MAIN   1388 1390#
AVTDEC1. . . . . .  C ADDR   065BH   R   SEG=MAIN   1199 1208#
AWTOF. . . . . . .  C ADDR   03FCH   A      8060#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   132

B. . . . . . . . .  D ADDR   00F0H   A      122# 5325 5697 6886 6889 6891 6895 6899 6903 6907 6912 6916 6923 6927
                                           6931 6937 6941 6945 6951 7644 7645
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 461#
BFORM. . . . . . .  C ADDR   26CEH   R   SEG=MAIN   6039 6044 6056# 6082
BIFL_KT. . . . . .  B ADDR   0021H.5 A      337# 4499 4555 4654
BIN30. . . . . . .  C ADDR   2840H   R   SEG=MAIN   6446# 6472
BIN31. . . . . . .  C ADDR   2844H   R   SEG=MAIN   6451# 6455
BIN32. . . . . . .  C ADDR   2854H   R   SEG=MAIN   6464# 6469
BIN41. . . . . . .  C ADDR   2865H   R   SEG=MAIN   6480# 6490
BINDEC . . . . . .  C ADDR   2834H   R   SEG=MAIN   1521 1577 1689 3563 3832 3918 4177 4756 4927 5843 6425#
BITAKT . . . . . .  B ADDR   0023H.2 A      356# 1773 1774 1777
BITAVP . . . . . .  B ADDR   0020H.5 A      327# 1354 1586 1763 2942 2943 2945
BITBON . . . . . .  B ADDR   0021H.2 A      334# 1799 1912 2058 2256 2257 2265 6270
BITBUF . . . . . .  B ADDR   0021H.0 A      332#
BITEIZM. . . . . .  B ADDR   0022H.5 A      347# 1255 1781 2921 2933 4073 5244
BITIZM . . . . . .  B ADDR   0020H.4 A      326# 574 705 2227 2307 2392 2427 2458 2868 2922 3039 3062 3137 3168 3193
                                           3299 3412 3663 3711 3739 3900 4028 4074 4121 4208 4283 4397
BITKLB . . . . . .  B ADDR   0022H.2 A      344# 1324 1797 2232 2941 2948 4281 4569
BITMAS . . . . . .  B ADDR   0020H.1 A      323# 1080 1083 6022
BITMEM . . . . . .  B ADDR   0021H.3 A      335# 1673 2633 3171 3189 3201 3298 3411 3664 3710 3899
BITMENU. . . . . .  B ADDR   0022H.1 A      343# 1672 2457 2569 2923 3192 3719 3738 4033 4075 4120 4207 4280
BITMIG . . . . . .  B ADDR   0023H.1 A      355# 2534 2717 2815 3105 3460 3600 3613 4239 4345 4446 5762 5788 5813
                                           5825 5888 5895 5901 5907
BITNUL . . . . . .  B ADDR   0021H.7 A      339# 1744 2965 2966 2973
BITOLL . . . . . .  B ADDR   0022H.7 A      349# 649 1593 1670
BITPAR . . . . . .  B ADDR   0022H.6 A      348# 4039 4570
BITPRD . . . . . .  B ADDR   0021H.1 A      333# 1911
BITRS. . . . . . .  B ADDR   0020H.3 A      325#
BITT2. . . . . . .  B ADDR   0022H.0 A      342# 1669 2393 2428 2431 2980 3138
BITV19 . . . . . .  B ADDR   0022H.3 A      345# 518 522 2600 2605 2611 4017 4022 4103 4116 4213 4216 4220
BITVI11. . . . . .  B ADDR   0020H.6 A      328# 1352 1368 1410 2250 2252 2306 2456 2920 3031 3038 3191 4396
BITVICH. . . . . .  B ADDR   0022H.4 A      346# 1409 1668 2251 2308 2318 2455 2463 2998 3030 3061 3190 4395
BITZNAK. . . . . .  B ADDR   0020H.0 A      322# 674 720
BITZNB . . . . . .  B ADDR   0023H.3 A      357# 4416 5604 5607
BITZUS . . . . . .  B ADDR   0020H.7 A      329# 1402 1609 1998 2001 2353
BLOIN. . . . . . .  C ADDR   15FCH   R   SEG=MAIN   3568# 3573
BLOKVV . . . . . .  C ADDR   15CEH   R   SEG=MAIN   3538#
BLOKVVC. . . . . .  C ADDR   15D8H   R   SEG=MAIN   3541 3544#
BL_LI. . . . . . .  C ADDR   1599H   R   SEG=MAIN   3488 3496#
BOUT7. . . . . . .  C ADDR   1337H   R   SEG=MAIN   3148# 3150
BRET . . . . . . .  C ADDR   2159H   R   SEG=MAIN   5265 5270 5274#
BUFDEC . . . . . .  C ADDR   09C0H   R   SEG=MAIN   1694# 1699
BUFIND . . . . . .  D ADDR   0040H   A      298# 624 628 633 636 642 1466 1470 1536 1557 1578 1579 1580 1642 1647
                                           1692 1700 1702 1707 1742 1761 1767 1775 1778 1783 1798 1800 2215 2262 2266
                                           2509 2527 2543 2545 2548 2603 2604 2609 2610 2712 2756 2775 2855 2926 2982
                                           3040 3041 3088 3092 3118 3140 3154 3161 3172 3173 3271 3455 3482 3510 3539
                                           3566 3580 3581 3585 3586 3593 3594 3599 3615 3754 3761 3835 3843 3845 3861
                                           3885 3919 3928 3930 3994 4016 4023 4145 4178 4179 4182 4231 4259 4337 4383
                                           4759 4767 4771 4930 4938 4942 5080 5112 5323 5336 5342 5349 5477 5496 5514
                                           5577 5594 5605 5765 5791 5845 5892 5913 6189 6221 6271
BUFMEA . . . . . .  C ADDR   1E7AH   R   SEG=MAIN   4761# 4766
BUFMIN . . . . . .  C ADDR   1F6DH   R   SEG=MAIN   4932# 4937
BUFON. . . . . . .  C ADDR   0D72H   R   SEG=MAIN   2256 2265#
BUFR . . . . . . .  C ADDR   08FEH   R   SEG=MAIN   1559# 1564
BUFR2. . . . . . .  C ADDR   08E0H   R   SEG=MAIN   1538# 1543
BUFR3. . . . . . .  C ADDR   08D9H   R   SEG=MAIN   1529 1534#
BUFR30 . . . . . .  C ADDR   08DCH   R   SEG=MAIN   1532 1536#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      7641# 7645
CELLBIT. . . . . .  D ADDR   0020H   A      321# 322 323 324 325 326 327 328 329
CELLBIT1 . . . . .  D ADDR   0021H   A      331# 332 333 334 335 337 339
CELLBIT2 . . . . .  D ADDR   0022H   A      341# 342 343 344 345 346 347 348 349
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   133

CELLBIT3 . . . . .  D ADDR   0023H   A      353# 354 355 356 357
CEXP . . . . . . .  C ADDR   01E2H   A      7618 7627#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   21FCH   R   SEG=MAIN   1447 2974 4372 5409#
CH1. . . . . . . .  C ADDR   221CH   R   SEG=MAIN   5229 5420#
CH10 . . . . . . .  C ADDR   2200H   R   SEG=MAIN   855 1094 3820 5410#
CH100. . . . . . .  C ADDR   2214H   R   SEG=MAIN   802 1627 5415#
CH10000. . . . . .  C ADDR   2210H   R   SEG=MAIN   5414#
CH150H . . . . . .  C ADDR   2264H   R   SEG=MAIN   5439#
CH2. . . . . . . .  C ADDR   2218H   R   SEG=MAIN   1089 5416#
CH20 . . . . . . .  C ADDR   23DFH   R   SEG=MAIN   837 1099 5728#
CH2THO . . . . . .  C ADDR   2244H   R   SEG=MAIN   2120 2158 5431#
CH320H . . . . . .  C ADDR   2260H   R   SEG=MAIN   5438# 6242
CH4. . . . . . . .  C ADDR   2208H   R   SEG=MAIN   1103 5412#
CH43 . . . . . . .  C ADDR   1807H   R   SEG=MAIN   3837# 3842
CH43_42. . . . . .  C ADDR   18ADH   R   SEG=MAIN   3932# 3937
CH5. . . . . . . .  C ADDR   2204H   R   SEG=MAIN   871 5411#
CH57 . . . . . . .  C ADDR   23DBH   R   SEG=MAIN   5727#
CH954. . . . . . .  C ADDR   220CH   R   SEG=MAIN   5413#
CHAIBL . . . . . .  C ADDR   1447H   R   SEG=MAIN   3273 3275#
CHAIPR . . . . . .  C ADDR   175CH   R   SEG=MAIN   3756 3758#
CHANMA . . . . . .  C ADDR   0F3FH   R   SEG=MAIN   2541 2550#
CHANZ. . . . . . .  C ADDR   0F26H   R   SEG=MAIN   2495 2539#
CHAVT. . . . . . .  D ADDR   0081H   A      371# 553 1155 1200 1208 2177 4029
CHBEFORE . . . . .  D ADDR   009BH   A      381# 576 799 813 832 850 866
CHBLOK . . . . . .  D ADDR   00D6H   A      408# 4670 4720 4736 4838 4892 4989 5043
CHBUF. . . . . . .  D ADDR   00CFH   A      405# 587 1897 1902 1966 2007 2059 3708
CHCMP. . . . . . .  C ADDR   20FCH   R   SEG=MAIN   1161 5206#
CHDEC. . . . . . .  C ADDR   210FH   R   SEG=MAIN   1209 1222 2060 5221#
CHDEL. . . . . . .  D ADDR   0083H   A      372# 2029 2056 2083 2133 2171
CHDELMO. . . . . .  C ADDR   0C01H   R   SEG=MAIN   2039 2056# 2066
CHIF . . . . . . .  C ADDR   2424H   R   SEG=MAIN   5769 5772#
CHIF5. . . . . . .  C ADDR   242CH   R   SEG=MAIN   5775 5777#
CHIFB. . . . . . .  C ADDR   244FH   R   SEG=MAIN   5795 5798#
CHIFB1 . . . . . .  C ADDR   2455H   R   SEG=MAIN   5797 5798 5801#
CHIFL5 . . . . . .  C ADDR   245DH   R   SEG=MAIN   5805 5808#
CHIFOUR. . . . . .  C ADDR   243EH   R   SEG=MAIN   5782 5784 5788#
CHIND. . . . . . .  D ADDR   00ACH   A      387# 1370 1804
CHIND2 . . . . . .  D ADDR   0033H   A      315# 707 709 717
CHINKOR. . . . . .  D ADDR   0098H   A      370# 548 781 1147 1160 1202 1216 1221 2068
CHK. . . . . . . .  C ADDR   225CH   R   SEG=MAIN   1325 5437#
CHKL . . . . . . .  D ADDR   003DH   A      305# 687 689 697 699 700 702 2371 2398 2446 2901 3177 3891 4286
CHMAS. . . . . . .  D ADDR   006EH   A      302# 1077 1084 1107 6021
CHMASN . . . . . .  D ADDR   003FH   A      306# 788 797 833 851 867 883 1082 1084 1085
CHMINUS. . . . . .  C ADDR   2776H   R   SEG=MAIN   3293 3339 3361 3380 3402 6204# 6266
CHTADC . . . . . .  C ADDR   20A6H   R   SEG=MAIN   5138#
CHTHO. . . . . . .  C ADDR   223CH   R   SEG=MAIN   1294 1332 4512 4597 4615 5429#
CHTHOU . . . . . .  C ADDR   22E3H   R   SEG=MAIN   5565#
CHZAP. . . . . . .  C ADDR   21F8H   R   SEG=MAIN   1886 5408#
CH_1 . . . . . . .  C ADDR   2224H   R   SEG=MAIN   579 1483 1506 1899 1904 1993 2009 3791 5422#
CH_10. . . . . . .  C ADDR   2254H   R   SEG=MAIN   1489 1512 1971 1982 4275 4745 4915 5435#
CH_10TH. . . . . .  C ADDR   2250H   R   SEG=MAIN   1383 5434#
CH_2 . . . . . . .  C ADDR   2228H   R   SEG=MAIN   1963 1976 1990 5423#
CH_200 . . . . . .  C ADDR   224CH   R   SEG=MAIN   5433#
CH_220 . . . . . .  C ADDR   2248H   R   SEG=MAIN   1345 5432#
CH_22T . . . . . .  C ADDR   2321H   R   SEG=MAIN   1435 5613#
CH_250 . . . . . .  C ADDR   2258H   R   SEG=MAIN   1250 5436#
CH_4 . . . . . . .  C ADDR   222CH   R   SEG=MAIN   1985 3794 5424#
CH_5 . . . . . . .  C ADDR   2230H   R   SEG=MAIN   5425#
CH_500 . . . . . .  C ADDR   231DH   R   SEG=MAIN   1431 5612#
CH_7 . . . . . . .  C ADDR   2234H   R   SEG=MAIN   5426#
CH_953 . . . . . .  C ADDR   2238H   R   SEG=MAIN   5428#
CH_B . . . . . . .  C ADDR   2319H   R   SEG=MAIN   1451 5610#
CH_FL. . . . . . .  C ADDR   2325H   R   SEG=MAIN   1475 5614#
CH_M3. . . . . . .  C ADDR   2268H   R   SEG=MAIN   5440#
CH_MLN . . . . . .  C ADDR   2220H   R   SEG=MAIN   5421#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   134

CIKLWR . . . . . .  C ADDR   26A4H   R   SEG=MAIN   6027#
CKCON. . . . . . .  D ADDR   008EH   A      30# 479 510
CL4. . . . . . . .  C ADDR   227AH   R   SEG=MAIN   5457# 5459
CL4N . . . . . . .  C ADDR   2280H   R   SEG=MAIN   5466# 5468
CLE20. . . . . . .  C ADDR   189AH   R   SEG=MAIN   3922# 3924
CLE256 . . . . . .  C ADDR   043EH   A      4109 4545 4647 8123#
CLEAR. . . . . . .  C ADDR   282EH   R   SEG=MAIN   6403 6407# 6437
CLEAR4 . . . . . .  C ADDR   2277H   R   SEG=MAIN   811 1399 1401 1546 1567 1606 1608 2293 2295 2959 2961 4669 5455#
CLEARN . . . . . .  C ADDR   227FH   R   SEG=MAIN   3641 3687 3782 4137 4251 4362 4409 5464#
CLMASSIX . . . . .  C ADDR   2694H   R   SEG=MAIN   539 1397 1604 2072 2181 2291 2957 3136 6015#
CLMASV . . . . . .  C ADDR   07CBH   R   SEG=MAIN   1392 1394#
CLMAX. . . . . . .  C ADDR   2699H   R   SEG=MAIN   6017# 6020
CLR11. . . . . . .  C ADDR   282FH   R   SEG=MAIN   6409# 6411
CLRDEC . . . . . .  C ADDR   2828H   R   SEG=MAIN   6401#
CLRNUM . . . . . .  C ADDR   282CH   R   SEG=MAIN   6404# 6518
CLRVICH. . . . . .  C ADDR   12A7H   R   SEG=MAIN   3061# 3078
CNTR . . . . . . .  N NUMB   0006H   A      7314#
CO02S. . . . . . .  C ADDR   21E0H   R   SEG=MAIN   5392# 5396
CO05S. . . . . . .  C ADDR   21EDH   R   SEG=MAIN   5401# 5405
CO1S . . . . . . .  C ADDR   21D7H   R   SEG=MAIN   5386# 5386
CO2S . . . . . . .  C ADDR   21D3H   R   SEG=MAIN   5384# 5388
COMPA1 . . . . . .  C ADDR   0875H   R   SEG=MAIN   1483# 1492
COMPA2 . . . . . .  C ADDR   08ABH   R   SEG=MAIN   1506# 1515
COND . . . . . . .  C ADDR   2708H   R   SEG=MAIN   6111#
COPY1. . . . . . .  C ADDR   049FH   A      8205# 8210
COPYPP . . . . . .  C ADDR   0499H   A      4096 4524 4625 8202#
COPY_HL. . . . . .  D ADDR   00D7H   A      409# 3807 3943 4662 4678 4693 4831 4846 4861 4982 4997 5012
COUNT. . . . . . .  C ADDR   21B5H   R   SEG=MAIN   5358# 5358
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   21BCH   R   SEG=MAIN   5364# 5364
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 484
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1634 1655
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1637 1659
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 485
DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1894
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1891
DCOA . . . . . . .  C ADDR   270DH   R   SEG=MAIN   6115# 6117
DCOB . . . . . . .  C ADDR   2714H   R   SEG=MAIN   6119# 6137
DCOC . . . . . . .  C ADDR   271FH   R   SEG=MAIN   6129# 6134
DCOD . . . . . . .  C ADDR   272CH   R   SEG=MAIN   6136 6139#
DDOUTF . . . . . .  C ADDR   154EH   R   SEG=MAIN   3262 3318 3441 3449# 3534
DDOUTFR. . . . . .  C ADDR   142BH   R   SEG=MAIN   3262# 3268
DEC30. . . . . . .  C ADDR   2881H   R   SEG=MAIN   6528# 6553
DEC31. . . . . . .  C ADDR   2886H   R   SEG=MAIN   6534# 6541
DEC32. . . . . . .  C ADDR   2896H   R   SEG=MAIN   6546# 6550
DECBIN . . . . . .  C ADDR   2874H   R   SEG=MAIN   3645 3691 3786 4272 4367 4413 6507#
DECSIZE. . . . . .  N NUMB   000AH   A      6382# 6402 6436 6463 6476 6479 6533
DECT2. . . . . . .  C ADDR   289FH   R   SEG=MAIN   6524 6556#
DEDPTR . . . . . .  C ADDR   2AF4H   R   SEG=MAIN   7041 7045 7049 7055#
DENORM . . . . . .  C ADDR   0133H   A      7473# 7529
DGOTO7 . . . . . .  C ADDR   16E0H   R   SEG=MAIN   3694# 3702
DIAP . . . . . . .  D ADDR   00AEH   A      389# 567 1387 1588 1706 1922 2285 2324 2950 4181 4552 5245 5266 5528 5543
                                           5694 5756
DIINC. . . . . . .  C ADDR   0D97H   R   SEG=MAIN   2288 2291#
DIKDN. . . . . . .  C ADDR   23B3H   R   SEG=MAIN   5696 5716#
DIKDW. . . . . . .  C ADDR   22CBH   R   SEG=MAIN   5532 5553#
DIKM . . . . . . .  C ADDR   22E1H   R   SEG=MAIN   5564#
DIPAR. . . . . . .  C ADDR   22DFH   R   SEG=MAIN   5563#
DIV1 . . . . . . .  C ADDR   02DDH   A      7810# 7869
DIV2 . . . . . . .  C ADDR   0320H   A      7828 7832 7836 7840 7855#
DIV3 . . . . . . .  C ADDR   030DH   A      7829 7833 7837 7841#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   135

DIV9 . . . . . . .  C ADDR   0336H   A      7799 7801 7875#
DIVIDE . . . . . .  C ADDR   295FH   R   SEG=MAIN   6043 6742#
DONE . . . . . . .  C ADDR   28CEH   R   SEG=MAIN   6572 6583#
DONE1. . . . . . .  C ADDR   28CCH   R   SEG=MAIN   6575 6578 6581#
DOSH . . . . . . .  C ADDR   29E8H   R   SEG=MAIN   6817 6833#
DOSUB. . . . . . .  C ADDR   29D6H   R   SEG=MAIN   6801 6805 6809 6813 6814 6818#
DPH. . . . . . . .  D ADDR   0083H   A      19# 545 591 599 606 613 2848 3307 3309 3812 3814 3948 3953 4431 4663 4675
                                           4680 4689 4691 4694 4705 4792 4794 4832 4843 4848 4857 4859 4862 4873 4983
                                           4994 4999 5008 5010 5013 5024 5975 5983 6250 6258 6290 6589 6625 6660 6663
                                           6675 6698 7060 7062 8136 8156 8202
DPL. . . . . . . .  D ADDR   0082H   A      18# 594 602 609 616 2847 3304 3306 3808 3810 3945 3956 4432 4666 4673
                                           4683 4686 4688 4697 4701 4789 4791 4835 4841 4851 4854 4856 4865 4869 4986
                                           4992 5002 5005 5007 5016 5020 5976 5982 6247 6261 6294 6605 6641 6662 6676
                                           6679 6713 7057 7059 8137 8157 8203
DVIG0. . . . . . .  C ADDR   0A9BH   R   SEG=MAIN   1840# 1842
DVIG1. . . . . . .  C ADDR   0A90H   R   SEG=MAIN   1831# 1833
DVIG2. . . . . . .  C ADDR   0A85H   R   SEG=MAIN   1822# 1824
DVIG3. . . . . . .  C ADDR   0A79H   R   SEG=MAIN   1813# 1815
DVIG4. . . . . . .  C ADDR   0AA7H   R   SEG=MAIN   1851# 1853
DVIG6. . . . . . .  C ADDR   0AC9H   R   SEG=MAIN   1879# 1881
DVM. . . . . . . .  C ADDR   0AC7H   R   SEG=MAIN   1867 1878#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 482
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 525 691 2195 2834 5110 5122
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDKALIB . . . . .  C ADDR   1CAAH   R   SEG=MAIN   2939 4498#
ENDSDV . . . . . .  C ADDR   0ACDH   R   SEG=MAIN   1873 1882#
ENDSUM . . . . . .  C ADDR   058DH   R   SEG=MAIN   895 948 1051 1076#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU0 . . . . . . .  C ADDR   08A6H   R   SEG=MAIN   1486 1502#
EQU00. . . . . . .  C ADDR   08C4H   R   SEG=MAIN   1504 1509 1518#
EQU1L. . . . . . .  C ADDR   1072H   R   SEG=MAIN   2723 2727#
EQU2L. . . . . . .  C ADDR   15B4H   R   SEG=MAIN   3520 3525#
ERRA0. . . . . . .  C ADDR   1BD9H   R   SEG=MAIN   4375 4387#
ERRA01 . . . . . .  C ADDR   07DFH   R   SEG=MAIN   1405# 1450
ERROR. . . . . . .  C ADDR   24BAH   R   SEG=MAIN   1412 4204 4390 5088 5102 5911#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      7316#
EXP2 . . . . . . .  N NUMB   0001H   A      7318# 7495 7516
EXTCLE . . . . . .  C ADDR   01ACH   R   SEG=MAIN   542# 546
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDEXT. . . . . .  C ADDR   22C4H   R   SEG=MAIN   4526 5542#
FINDKOEF . . . . .  C ADDR   22B5H   R   SEG=MAIN   1328 5527#
FINDMEM. . . . . .  C ADDR   0FD6H   R   SEG=MAIN   2569 2633#
FINDR. . . . . . .  C ADDR   240CH   R   SEG=MAIN   1572 4172 5756#
FINIS. . . . . . .  C ADDR   2A13H   R   SEG=MAIN   6761 6862#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      4717 4729 7521# 7610
FLCMP. . . . . . .  C ADDR   01D6H   A      1252 1347 1385 1433 1437 1449 1485 1508 1906 4374 4888 4904 5039 5054
                                           7615#
FLDIV. . . . . . .  C ADDR   02B7H   A      1275 1296 1334 1458 1477 1491 1984 2122 2160 4510 4595 4613 4744 4747
                                           4917 7785#
FLMUL. . . . . . .  C ADDR   0203H   A      1141 1241 1293 1339 1453 1514 1965 3796 4277 4514 4599 4617 7655#
FLOUT. . . . . . .  C ADDR   01E1H   A      7622 7625#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   136

FLSCL. . . . . . .  D ADDR   00B6H   A      66# 8124 8130 8181 8186
FLSUB. . . . . . .  C ADDR   01D1H   A      1233 1901 2011 2118 2156 3793 7608#
FND. . . . . . . .  C ADDR   01F8H   A      7631 7634 7637 7640 7643#
FO1M . . . . . . .  C ADDR   26CBH   R   SEG=MAIN   6049 6053#
FO2M . . . . . . .  C ADDR   26D4H   R   SEG=MAIN   6056 6058#
FORM4. . . . . . .  C ADDR   26D5H   R   SEG=MAIN   6051 6057 6061#
FT1IZM . . . . . .  C ADDR   0E7FH   R   SEG=MAIN   2441#
FTOL . . . . . . .  C ADDR   0343H   A      1186 1341 1461 3797 4515 4618 4748 4918 5838 7891#
FTOL1. . . . . . .  C ADDR   037CH   A      7904 7908 7932#
FTOL2. . . . . . .  C ADDR   039EH   A      7928 7965#
FTOL22 . . . . . .  C ADDR   03C4H   A      7968 8002#
FTOL23 . . . . . .  C ADDR   03A2H   A      7969# 8001
FTOL24 . . . . . .  C ADDR   03B5H   A      7971 7987#
FTOL25 . . . . . .  C ADDR   03C2H   A      7986 8001#
FTOL26 . . . . . .  C ADDR   03E4H   A      8017 8033#
FTOL3. . . . . . .  C ADDR   038AH   A      7931 7945#
FTOL33 . . . . . .  C ADDR   038EH   A      7949# 7963
FTOL4. . . . . . .  C ADDR   0371H   A      7910 7925#
FTOL9. . . . . . .  C ADDR   0381H   A      7938# 7948 7964 8032 8047
FULKALIB . . . . .  C ADDR   1D19H   R   SEG=MAIN   4553 4568# 4656
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   490# 491
GO23NO . . . . . .  C ADDR   1513H   R   SEG=MAIN   3319 3417#
GO31L. . . . . . .  C ADDR   1078H   R   SEG=MAIN   2701 2732#
GO41L. . . . . . .  C ADDR   107DH   R   SEG=MAIN   2732 2734#
GOA2 . . . . . . .  C ADDR   0781H   R   SEG=MAIN   1351 1353 1356# 1378
GOA3A2 . . . . . .  C ADDR   078BH   R   SEG=MAIN   1361#
GOCIKLE. . . . . .  C ADDR   0B9FH   R   SEG=MAIN   1913 1968 1998# 2005 2012
GOFULL . . . . . .  C ADDR   1546H   R   SEG=MAIN   3423 3445#
GOGO7. . . . . . .  C ADDR   1BF7H   R   SEG=MAIN   4348 4353 4400#
GOKAA2 . . . . . .  C ADDR   07A9H   R   SEG=MAIN   1376#
GOKLB. . . . . . .  C ADDR   0D5AH   R   SEG=MAIN   2232 2254#
GOOFF1 . . . . . .  C ADDR   149AH   R   SEG=MAIN   3333# 3342
GOOFF2 . . . . . .  C ADDR   14B8H   R   SEG=MAIN   3355# 3364
GOOFF3 . . . . . .  C ADDR   14D6H   R   SEG=MAIN   3374# 3383
GOOFF4 . . . . . .  C ADDR   14F4H   R   SEG=MAIN   3396# 3405
GOONIN . . . . . .  C ADDR   079BH   R   SEG=MAIN   1369# 1403 1415 1594 1610
GOONIND. . . . . .  C ADDR   0997H   R   SEG=MAIN   1372 1660#
GOONOFF. . . . . .  C ADDR   1453H   R   SEG=MAIN   3287# 3296
GOONT. . . . . . .  C ADDR   0B40H   R   SEG=MAIN   1916 1949#
GOPAROL. . . . . .  C ADDR   1A6AH   R   SEG=MAIN   4038 4158 4166#
GOPAROM. . . . . .  C ADDR   1980H   R   SEG=MAIN   4036# 4039
GOPART . . . . . .  C ADDR   031EH   R   SEG=MAIN   783 786#
GOSK19 . . . . . .  C ADDR   0FA7H   R   SEG=MAIN   2600 2607#
GOTO7. . . . . . .  C ADDR   1172H   R   SEG=MAIN   2900# 2971 2978 3016 3065 3094 3106 3148 3152 3197 3213 3222 3228
                                           3233 3239 3254 3316 3470 3473 3487 3524 3527 3583 3596 3602 3628 3630 3671
                                           3694 3712 3767 3966 3974 3982 4201 4211 4243 4294 4296 4312 4324 4385 4565
                                           4576
GOTOA. . . . . . .  C ADDR   0C0CH   R   SEG=MAIN   2058 2061#
GOTOKD . . . . . .  C ADDR   0620H   R   SEG=MAIN   1144 1168#
GOTOSTROB. . . . .  C ADDR   0B32H   R   SEG=MAIN   1927 1930 1933 1936 1939#
GOUT6. . . . . . .  C ADDR   0D0FH   R   SEG=MAIN   2222# 2250
GOVVLIST . . . . .  C ADDR   1780H   R   SEG=MAIN   3750 3772#
GOZNAK . . . . . .  C ADDR   02D0H   R   SEG=MAIN   680 726#
HNOR11 . . . . . .  C ADDR   12B2H   R   SEG=MAIN   3027 3069#
HNOR12 . . . . . .  C ADDR   125AH   R   SEG=MAIN   3017 3021#
HNOT1. . . . . . .  C ADDR   12FBH   R   SEG=MAIN   2993 3115#
HNOT2. . . . . . .  C ADDR   1228H   R   SEG=MAIN   2990#
HR12 . . . . . . .  C ADDR   1250H   R   SEG=MAIN   3012 3017#
HVI1113. . . . . .  C ADDR   124AH   R   SEG=MAIN   3015# 3020 3025
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 527 5068 8123 8131 8180 8190
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   1224H   R   SEG=MAIN   2985 2987#
IND. . . . . . . .  C ADDR   2074H   R   SEG=MAIN   629 637 682 710 1413 1496 1500 1801 2263 2267 2278 3158 3174 3670
                                           3886 3938 4205 4391 4573 5084 5090 5104 5110# 6272
INDA3. . . . . . .  C ADDR   095EH   R   SEG=MAIN   1625#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   137

INDOLL . . . . . .  C ADDR   0935H   R   SEG=MAIN   1586 1587 1591#
INIACP . . . . . .  C ADDR   2329H   R   SEG=MAIN   646 3134 5620#
INNOT1_2 . . . . .  C ADDR   1637H   R   SEG=MAIN   3592 3598#
INNOT3 . . . . . .  C ADDR   1628H   R   SEG=MAIN   3584 3589#
INNOT6 . . . . . .  C ADDR   161CH   R   SEG=MAIN   3579 3584#
INTERVA. . . . . .  D ADDR   00CDH   A      404# 620 1949 3547 3647
INTMUL . . . . . .  C ADDR   0B58H   R   SEG=MAIN   1965# 1973 1978 1987 1992 1995
INTMUL1. . . . . .  C ADDR   0B5BH   R   SEG=MAIN   1966#
INTN . . . . . . .  C ADDR   16C9H   R   SEG=MAIN   3685#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   12E3H   R   SEG=MAIN   3096#
IZMAN. . . . . . .  C ADDR   0DF6H   R   SEG=MAIN   2193 2345#
IZMFUN . . . . . .  C ADDR   0E05H   R   SEG=MAIN   2279 2290 2297 2349 2352#
IZMPAT . . . . . .  C ADDR   0E09H   R   SEG=MAIN   2248 2264 2268 2321 2356#
IZMT2. . . . . . .  C ADDR   0E18H   R   SEG=MAIN   2372 2377#
IZMT3. . . . . . .  C ADDR   0E23H   R   SEG=MAIN   2377 2383#
JFINIS . . . . . .  C ADDR   297AH   R   SEG=MAIN   6753 6761#
KD . . . . . . . .  C ADDR   2240H   R   SEG=MAIN   5430#
KEYB1. . . . . . .  C ADDR   0CE2H   R   SEG=MAIN   283 2194#
KEYB2. . . . . . .  C ADDR   1106H   R   SEG=MAIN   286 2833#
KFULL. . . . . . .  C ADDR   151DH   R   SEG=MAIN   3255 3422#
KFULLR . . . . . .  C ADDR   141AH   R   SEG=MAIN   3250 3255#
KGO23. . . . . . .  C ADDR   1487H   R   SEG=MAIN   3249 3322#
KLEV1. . . . . . .  C ADDR   13F4H   R   SEG=MAIN   3205 3240#
KLEV2. . . . . . .  C ADDR   13F9H   R   SEG=MAIN   3240 3242#
KLEV21 . . . . . .  C ADDR   141DH   R   SEG=MAIN   3247 3256#
KLEV22 . . . . . .  C ADDR   1403H   R   SEG=MAIN   3235 3244 3247#
KLEV23 . . . . . .  C ADDR   142EH   R   SEG=MAIN   3256 3264#
KLEV3. . . . . . .  C ADDR   13FEH   R   SEG=MAIN   3242 3244#
KLMAS. . . . . . .  C ADDR   03CBH   R   SEG=MAIN   815 882#
KNAVP. . . . . . .  C ADDR   11C0H   R   SEG=MAIN   2880 2941#
KNIZM. . . . . . .  B ADDR   0023H.0 A      354# 1351 1587 1769 2323 2345 2346 2350
KNIZMON. . . . . .  C ADDR   0E00H   R   SEG=MAIN   2345 2350#
KNKMP. . . . . . .  C ADDR   10F7H   R   SEG=MAIN   2828# 2874
KNLEFT . . . . . .  C ADDR   11D0H   R   SEG=MAIN   2832 2948#
KNMEM. . . . . . .  C ADDR   1358H   R   SEG=MAIN   2827 3168#
KNMENU . . . . . .  C ADDR   1194H   R   SEG=MAIN   2886 2920#
KNNUL. . . . . . .  C ADDR   11EEH   R   SEG=MAIN   2831 2965#
KNOPT. . . . . . .  C ADDR   0E2BH   R   SEG=MAIN   2192 2391#
KNRAZR . . . . . .  C ADDR   0E40H   R   SEG=MAIN   2191 2404#
KNRIGHT. . . . . .  C ADDR   0D8DH   R   SEG=MAIN   2238 2283#
KNVICH . . . . . .  C ADDR   0DACH   R   SEG=MAIN   2247 2300#
KOEFKD . . . . . .  D ADDR   00A0H   A      384# 585 4517 4527 4619 4627
KOEFKM . . . . . .  D ADDR   0094H   A      378# 583 1139 1239 2164
KOEFKP . . . . . .  D ADDR   0090H   A      377# 581 1136 1234 2126
KOMUL. . . . . . .  C ADDR   0749H   R   SEG=MAIN   1327 1331#
KOMULPZ. . . . . .  C ADDR   0743H   R   SEG=MAIN   1324 1328#
KONSTA . . . . . .  D ADDR   00BCH   A      397# 1445 4370 5836
KON_B. . . . . . .  C ADDR   0F0AH   R   SEG=MAIN   2497 2516#
KOR0US . . . . . .  C ADDR   216DH   R   SEG=MAIN   2037 5299#
KOR0_AN. . . . . .  D ADDR   0084H   A      374# 1231 2049 2116 2154
KORDEC1. . . . . .  C ADDR   0671H   R   SEG=MAIN   1214 1221#
KORDEC10 . . . . .  C ADDR   0651H   R   SEG=MAIN   1202#
KORNUL . . . . . .  C ADDR   0BD4H   R   SEG=MAIN   1151 2029#
KVVOD0 . . . . . .  C ADDR   1539H   R   SEG=MAIN   3215 3431 3440#
LABEL43. . . . . .  C ADDR   1777H   R   SEG=MAIN   3768# 3776
LABEL7 . . . . . .  C ADDR   1860H   R   SEG=MAIN   3768 3891# 3903
LABELA . . . . . .  C ADDR   0297H   R   SEG=MAIN   685# 714 2002
LABELB . . . . . .  C ADDR   0A72H   R   SEG=MAIN   1194 1613 1806# 2017 2021 2023
LABELC . . . . . .  C ADDR   0E40H   R   SEG=MAIN   2405#
LABELE . . . . . .  C ADDR   0E09H   R   SEG=MAIN   2354 2370# 2410 2413 2417 2421 2429
LABELF . . . . . .  C ADDR   0E6BH   R   SEG=MAIN   2190 2430#
LABELH . . . . . .  C ADDR   1210H   R   SEG=MAIN   2830 2980#
LABELI . . . . . .  C ADDR   1B53H   R   SEG=MAIN   2996 3054 3108 4307#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   138

LABELI2. . . . . .  C ADDR   1297H   R   SEG=MAIN   3054# 3055
LABELK . . . . . .  C ADDR   1398H   R   SEG=MAIN   2995 3198#
LABELL . . . . . .  C ADDR   1033H   R   SEG=MAIN   2567 2662 2670#
LABELL1. . . . . .  C ADDR   0F47H   R   SEG=MAIN   2554# 2626 2739 2788
LABELN . . . . . .  C ADDR   1097H   R   SEG=MAIN   2627 2748#
LABELP . . . . . .  C ADDR   174DH   R   SEG=MAIN   3698 3719 3750# 3984
LABELS . . . . . .  C ADDR   1712H   R   SEG=MAIN   3427 3719#
LABELS1. . . . . .  C ADDR   19E1H   R   SEG=MAIN   4054 4084#
LABELS13 . . . . .  C ADDR   1ADCH   R   SEG=MAIN   4125 4223#
LABELS3. . . . . .  C ADDR   1B66H   R   SEG=MAIN   4317#
LABELS4. . . . . .  C ADDR   1B41H   R   SEG=MAIN   4124 4298#
LABL2. . . . . . .  C ADDR   1059H   R   SEG=MAIN   2704# 3259
LABM . . . . . . .  C ADDR   15BDH   R   SEG=MAIN   3260 3530#
LADD . . . . . . .  C ADDR   2ABBH   R   SEG=MAIN   794 829 847 863 1889 6988#
LADDX. . . . . . .  C ADDR   2ACCH   R   SEG=MAIN   7012#
LBTOF. . . . . . .  C ADDR   042DH   A      8102#
LCMP . . . . . . .  C ADDR   28B9H   R   SEG=MAIN   5216 6080 6568#
LDC_LONG . . . . .  C ADDR   28CFH   R   SEG=MAIN   580 1326 1887 2121 2159 2975 6588#
LDC_LTEMP. . . . .  C ADDR   28F1H   R   SEG=MAIN   803 1090 1095 1100 1104 1251 1295 1333 1346 1384 1432 1436 1448
                                           1452 1476 1484 1490 1507 1513 1628 1900 1905 1964 1972 1977 1983 1986 1991
                                           1994 2010 3792 3795 3821 4276 4373 4513 4598 4616 4746 4916 5230 6243
                                           6624#
LDX_LONG . . . . .  C ADDR   2917H   R   SEG=MAIN   6659#
LDX_LTEMP. . . . .  C ADDR   293DH   R   SEG=MAIN   6697#
LEFCUR . . . . . .  C ADDR   1648H   R   SEG=MAIN   3608# 3680 3696
LEFKL. . . . . . .  C ADDR   11DAH   R   SEG=MAIN   2948 2954#
LEFMEM11 . . . . .  C ADDR   13A6H   R   SEG=MAIN   3206# 3241 3243 3245
LEFT21 . . . . . .  C ADDR   1567H   R   SEG=MAIN   3466 3471#
LEFT_S . . . . . .  C ADDR   19DEH   R   SEG=MAIN   4083# 4086
LEFT_SK. . . . . .  C ADDR   1AC3H   R   SEG=MAIN   4083 4213#
LEV220 . . . . . .  C ADDR   1406H   R   SEG=MAIN   3248# 3257
LEV2GO . . . . . .  C ADDR   10BDH   R   SEG=MAIN   2747 2784#
LEVEL. . . . . . .  D ADDR   00B0H   A      391# 2270 2634 2672 3175 3185 3204 3442 5786
LI21 . . . . . . .  C ADDR   12EDH   R   SEG=MAIN   3103 3105#
LI42_43. . . . . .  C ADDR   17E6H   R   SEG=MAIN   3818# 3958
LIST_43. . . . . .  C ADDR   186AH   R   SEG=MAIN   3770 3896#
LLDI2. . . . . . .  C ADDR   0DEFH   R   SEG=MAIN   2336 2340#
LLDI23 . . . . . .  C ADDR   0DE3H   R   SEG=MAIN   2328 2333#
LLDI3. . . . . . .  C ADDR   0DEAH   R   SEG=MAIN   2335 2337#
LLEV2. . . . . . .  C ADDR   1082H   R   SEG=MAIN   2703 2737#
LLKA . . . . . . .  C ADDR   0C04H   R   SEG=MAIN   2058# 2073
LLMUL. . . . . . .  C ADDR   2A24H   R   SEG=MAIN   6882#
LLSUB. . . . . . .  C ADDR   2AA9H   R   SEG=MAIN   6964#
LLTOF. . . . . . .  C ADDR   0432H   A      8108#
LMUL . . . . . . .  C ADDR   2A24H   R   SEG=MAIN   6038 6244 6884#
LOA3_X . . . . . .  C ADDR   2804H   R   SEG=MAIN   1919 6308#
LOAB12 . . . . . .  C ADDR   2378H   R   SEG=MAIN   3132 5661#
LOAD . . . . . . .  D ADDR   00B7H   A      395# 2394 2435 2983 3128 5322
LOADB. . . . . . .  C ADDR   130EH   R   SEG=MAIN   3123 3126# 3159 3165
LOADB2 . . . . . .  C ADDR   133AH   R   SEG=MAIN   3146 3150#
LOADCLE. . . . . .  C ADDR   13C4H   R   SEG=MAIN   3220# 3434
LOADKD . . . . . .  C ADDR   2395H   R   SEG=MAIN   5694#
LOADR2 . . . . . .  C ADDR   2387H   R   SEG=MAIN   3692 3787 4273 4368 4414 5677#
LOADT. . . . . . .  C ADDR   2188H   R   SEG=MAIN   2396 2441 2989 5322#
LOADUS . . . . . .  C ADDR   2127H   R   SEG=MAIN   647 1395 1601 2296 2351 2934 2962 3135 4655 5243#
LOAHL_R2 . . . . .  C ADDR   1E8FH   R   SEG=MAIN   4712 4724 4775# 4884 4900 5035 5050
LOBLOK . . . . . .  C ADDR   1572H   R   SEG=MAIN   3420 3478# 3497
LOCLE. . . . . . .  C ADDR   13BFH   R   SEG=MAIN   3209 3218#
LOD1 . . . . . . .  C ADDR   2197H   R   SEG=MAIN   5330# 5335
LODT . . . . . . .  C ADDR   21A6H   R   SEG=MAIN   5343# 5348
LOIZMK . . . . . .  C ADDR   125DH   R   SEG=MAIN   3022# 3059
LOKAME1. . . . . .  C ADDR   1933H   R   SEG=MAIN   3998#
LOLEVT . . . . . .  C ADDR   218AH   R   SEG=MAIN   2276 5323#
LOLIST . . . . . .  C ADDR   13B3H   R   SEG=MAIN   3211#
LOME1. . . . . . .  C ADDR   1C5EH   R   SEG=MAIN   4465# 4469 4472 4475 4478 4482 4485 4488 4491 4495
LOMENU . . . . . .  C ADDR   1C56H   R   SEG=MAIN   2582 2595 3998 4041 4064 4462#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   139

LOOP . . . . . . .  C ADDR   20E3H   R   SEG=MAIN   5179# 5180
LOOPS. . . . . . .  C ADDR   297DH   R   SEG=MAIN   6763# 6796
LOSPUS . . . . . .  C ADDR   2161H   R   SEG=MAIN   2038 5282#
LOSTAT . . . . . .  C ADDR   13DBH   R   SEG=MAIN   3224 3230#
LOTEXT . . . . . .  C ADDR   21A2H   R   SEG=MAIN   1495 1499 1592 2314 2472 2480 2488 2602 2608 2642 2651 2659 2668
                                           2676 2925 3015 3085 3170 3212 3221 3227 3232 3238 3253 3446 3479 3491 3546
                                           3668 3736 3760 3927 3963 3971 3979 3993 4015 4021 4060 4169 4215 4219 4381
                                           4465 4572 5340# 5912
LOTP . . . . . . .  C ADDR   23EBH   R   SEG=MAIN   5735# 5745 5748
LOTPUS . . . . . .  C ADDR   23E3H   R   SEG=MAIN   4072 5277 5732#
LOU. . . . . . . .  C ADDR   0DF5H   R   SEG=MAIN   2323 2339 2343#
LOUIZM . . . . . .  C ADDR   0DD2H   R   SEG=MAIN   2323# 2348 5274
LOUTF. . . . . . .  C ADDR   1075H   R   SEG=MAIN   2729# 2738 2745
LOVICH . . . . . .  C ADDR   1253H   R   SEG=MAIN   3018# 3052 3073 4427
LOWR . . . . . . .  C ADDR   13CDH   R   SEG=MAIN   3218 3224#
LOWR1. . . . . . .  C ADDR   13D2H   R   SEG=MAIN   3226# 3438
LSUB . . . . . . .  C ADDR   2AA9H   R   SEG=MAIN   1191 1364 5231 6965#
LTEMP. . . . . . .  N NUMB   0008H   A      1107 1109 1110 1111 5567 5568 5569 5570 6090 6093 6096 6099 6142 6143
                                           6144 6145 6380# 6754 6755 6756 6757 6766 6770 6774 6778 6781 6782 6783
                                           6784 6785 6786 6787 6788 6789 6790 6791 6792 6795 6798 6803 6807 6811 6821
                                           6824 6827 6830 6846 6849 6850 6852 6853 6855 6856 6858 6863 6864 6865 6866
                                           6886 6891 6899 6907 6912 6923 6931 6937 6945 6951 7319 7320 7359 7364 7366
                                           7375 7376 7377 7378 7609 7617 7630 7633 7636 7639 8219 8222 8225 8228
LWR. . . . . . . .  C ADDR   26A6H   R   SEG=MAIN   6029# 6033
LWRX . . . . . . .  C ADDR   266AH   R   SEG=MAIN   5974# 5986
LWTOF. . . . . . .  C ADDR   042FH   A      8104#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   26C1H   R   SEG=MAIN   1682 3824 4749 4920 6037 6042 6047# 6079
MAIN . . . . . . .  C SEG    2B06H       REL=UNIT   237 294# 454
MANT1. . . . . . .  N NUMB   0002H   A      7317# 7344 7393 7394
MANT2. . . . . . .  N NUMB   0008H   A      7319# 7370 7371 7502 7504 7505 7507 7508 7510 7511 7513 7552 7553 7555
                                           7556 7558 7559 7561 7562 7566 7568 7571 7574 7672 7674 7675 7677 7678 7680
                                           7681 7683 7734 7736 7737 7739 7740 7742 7743 7745 7827 7831 7835 7839 7843
                                           7846 7849 7852
MARK0_8. . . . . .  C ADDR   0F11H   R   SEG=MAIN   2499 2517 2519#
MARKER . . . . . .  D ADDR   00B2H   A      393# 558 2214 2459 2498 2508 2516 2526 2532 2711 2719 2755 2762 2774 2854
                                           3063 3080 3101 3194 3313 3413 3454 3462 3483 3509 3516 3574 3614 3621 3661
                                           3704 3762 3778 3901 4042 4196 4209 4230 4237 4284 4317 4336 4343 4377 4387
                                           4398 4423 5763 5789 5815 5826 5884
MARLE. . . . . . .  C ADDR   245FH   R   SEG=MAIN   3629 5812#
MARRI. . . . . . .  C ADDR   246CH   R   SEG=MAIN   2782 5825#
MAS10. . . . . . .  C ADDR   03EAH   R   SEG=MAIN   884 897#
MAS20. . . . . . .  C ADDR   046AH   R   SEG=MAIN   897 952#
MAS4 . . . . . . .  C ADDR   055EH   R   SEG=MAIN   950 1053#
MAS5DIV. . . . . .  C ADDR   05D2H   R   SEG=MAIN   1091 1096 1101 1105 1113#
MASFULL. . . . . .  C ADDR   0599H   R   SEG=MAIN   1080 1084#
MASS0. . . . . . .  X ADDR   0100H   A      417 418# 885 890 919 927 1001 1009 1058 1065 6016
MASS1. . . . . . .  X ADDR   0104H   A      419# 893 916 930 998 1012 1056 1068
MASS10 . . . . . .  X ADDR   0128H   A      428# 974 1031
MASS11 . . . . . .  X ADDR   012CH   A      429# 971 1033
MASS12 . . . . . .  X ADDR   0130H   A      430# 968 1035
MASS13 . . . . . .  X ADDR   0134H   A      431# 965 1037
MASS14 . . . . . .  X ADDR   0138H   A      432# 962 1039
MASS15 . . . . . .  X ADDR   013CH   A      433# 959 1041
MASS16 . . . . . .  X ADDR   0140H   A      434# 957 1043
MASS17 . . . . . .  X ADDR   0144H   A      435# 955 1045
MASS18 . . . . . .  X ADDR   0148H   A      436# 953 1047
MASS19 . . . . . .  X ADDR   014CH   A      437# 1049
MASS2. . . . . . .  X ADDR   0108H   A      420# 913 932 995 1014 1054 1070
MASS3. . . . . . .  X ADDR   010CH   A      421# 910 934 992 1016 1072
MASS4. . . . . . .  X ADDR   0110H   A      422# 907 936 989 1018
MASS5. . . . . . .  X ADDR   0114H   A      423# 904 938 986 1020
MASS6. . . . . . .  X ADDR   0118H   A      424# 902 940 984 1022
MASS7. . . . . . .  X ADDR   011CH   A      425# 900 942 982 1024
MASS8. . . . . . .  X ADDR   0120H   A      426# 898 944 980 1026
MASS9. . . . . . .  X ADDR   0124H   A      427# 946 977 1028
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   140

MASX5. . . . . . .  C ADDR   05C8H   R   SEG=MAIN   1082 1107#
MAXG . . . . . . .  C ADDR   1FB6H   R   SEG=MAIN   4991# 5045
MAXVIX . . . . . .  C ADDR   2020H   R   SEG=MAIN   5055 5060#
ME11_15DE. . . . .  C ADDR   1709H   R   SEG=MAIN   3714# 3733
ME11_15DEC . . . .  C ADDR   1932H   R   SEG=MAIN   3714 3997#
ME21_22. . . . . .  C ADDR   103DH   R   SEG=MAIN   2676# 2685
ME21_23. . . . . .  C ADDR   199CH   R   SEG=MAIN   3747 4050#
ME21_23DEC . . . .  C ADDR   19B8H   R   SEG=MAIN   4057 4062#
MEAVP. . . . . . .  C ADDR   11CBH   R   SEG=MAIN   2942 2945#
MECLE. . . . . . .  C ADDR   0199H   R   SEG=MAIN   531# 533
MEFF . . . . . . .  C ADDR   01A0H   R   SEG=MAIN   535# 538
MEM10MS. . . . . .  C ADDR   0292H   R   SEG=MAIN   682#
MEM12NO. . . . . .  C ADDR   1534H   R   SEG=MAIN   3432 3436#
MENG . . . . . . .  C ADDR   1DDBH   R   SEG=MAIN   4672# 4722
MENU12 . . . . . .  C ADDR   1C62H   R   SEG=MAIN   4463 4467#
MENU13 . . . . . .  C ADDR   1C6AH   R   SEG=MAIN   4467 4470#
MENU14 . . . . . .  C ADDR   1C72H   R   SEG=MAIN   4470 4473#
MENU15 . . . . . .  C ADDR   1C7AH   R   SEG=MAIN   4473 4476#
MENU21 . . . . . .  C ADDR   1C82H   R   SEG=MAIN   4476 4480#
MENU22 . . . . . .  C ADDR   1C8AH   R   SEG=MAIN   4480 4483#
MENU23 . . . . . .  C ADDR   1C92H   R   SEG=MAIN   4483 4486#
MENU31 . . . . . .  C ADDR   1C9AH   R   SEG=MAIN   4486 4489#
MENU41 . . . . . .  C ADDR   1CA2H   R   SEG=MAIN   4489 4493#
MENUOFF. . . . . .  C ADDR   11AEH   R   SEG=MAIN   2921 2930#
MENUON . . . . . .  C ADDR   173FH   R   SEG=MAIN   3738#
MERR . . . . . . .  C ADDR   1191H   R   SEG=MAIN   2917# 2920
ME_14. . . . . . .  C ADDR   13E6H   R   SEG=MAIN   3235#
ME_41. . . . . . .  C ADDR   1A2DH   R   SEG=MAIN   4084 4127#
MIDL . . . . . . .  C ADDR   29B0H   R   SEG=MAIN   6758 6793#
MIGN . . . . . . .  C ADDR   249CH   R   SEG=MAIN   5111 5884#
MIGNN. . . . . . .  C ADDR   24A4H   R   SEG=MAIN   5886 5891#
MIN4_HL. . . . . .  C ADDR   1E9BH   R   SEG=MAIN   4788# 4802 4828 4953 4979
MING . . . . . . .  C ADDR   1EDDH   R   SEG=MAIN   4840# 4894
MINIVIX. . . . . .  C ADDR   1F47H   R   SEG=MAIN   4905 4910# 5060
MLABL2 . . . . . .  C ADDR   159DH   R   SEG=MAIN   3447 3501# 3532 3771
MLABL2R. . . . . .  C ADDR   177DH   R   SEG=MAIN   3771# 3774
MMM. . . . . . . .  C ADDR   028DH   R   SEG=MAIN   678#
MO220. . . . . . .  C ADDR   092AH   R   SEG=MAIN   1206 1374 1586#
MO500I . . . . . .  C ADDR   089AH   R   SEG=MAIN   1438 1498#
MO500R . . . . . .  C ADDR   088EH   R   SEG=MAIN   1434 1494#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   0FD0H   R   SEG=MAIN   2628# 2639 2648 2656 2665
MOUTKMEM . . . . .  C ADDR   170CH   R   SEG=MAIN   3715# 3723
MOVE28 . . . . . .  C ADDR   272EH   R   SEG=MAIN   1270 1288 1335 1440 2119 2157 4507 4590 4608 4714 4726 4741 4883
                                           4899 5034 5049 6142#
MOVE82 . . . . . .  C ADDR   22E7H   R   SEG=MAIN   5567#
MOVEA3 . . . . . .  C ADDR   0997H   R   SEG=MAIN   1638 1663#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2500 2727 2767 3082 3419 3463 3471 3525 3577 3622 3765 4045 4198
                                           4240 4318 4346 5819
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2496 2720 2724 2763 3083 3418 3467 3517 3521 3576 3626 3764 4044
                                           4199 4322 5828
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      7669# 7712
MUP11. . . . . . .  C ADDR   0257H   A      7716# 7761
MUP2 . . . . . . .  C ADDR   0297H   A      7746 7760#
MUP3 . . . . . . .  C ADDR   026CH   A      7715 7731#
MVV11. . . . . . .  C ADDR   156DH   R   SEG=MAIN   3443 3476#
MVV12. . . . . . .  C ADDR   1585H   R   SEG=MAIN   3476 3488#
N12DELCH . . . . .  C ADDR   0CCFH   R   SEG=MAIN   2175 2183#
N4DELCH. . . . . .  C ADDR   0C7BH   R   SEG=MAIN   2099 2137#
N8DELCH. . . . . .  C ADDR   0CBDH   R   SEG=MAIN   2137 2175#
NBIMENU. . . . . .  C ADDR   0FD6H   R   SEG=MAIN   2632#
NBLOK. . . . . . .  D ADDR   0038H   A      311# 618 1924 3276 3480 3544 3758 3849 6234 6255 6286
NE05 . . . . . . .  C ADDR   0358H   A      7898 7900 7902 7905#
NELEM. . . . . . .  D ADDR   0037H   A      312# 619 3789 3906 3910
NEXIN. . . . . . .  C ADDR   207EH   R   SEG=MAIN   5114# 5121
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   141

NEXTMAX. . . . . .  C ADDR   1FEBH   R   SEG=MAIN   5023 5031#
NEXTMEA. . . . . .  C ADDR   1E10H   R   SEG=MAIN   4704 4712#
NEXTMIN. . . . . .  C ADDR   1F12H   R   SEG=MAIN   4872 4880#
NMEM_MENU. . . . .  C ADDR   170FH   R   SEG=MAIN   3717# 3721
NMINUS . . . . . .  C ADDR   068EH   R   SEG=MAIN   1236 1240#
NMINUS3. . . . . .  C ADDR   05F2H   R   SEG=MAIN   1138 1140#
NNDELCH. . . . . .  C ADDR   0C3BH   R   SEG=MAIN   2084 2099#
NNMEMB . . . . . .  C ADDR   10C9H   R   SEG=MAIN   2630 2790#
NNNUL. . . . . . .  C ADDR   0A0EH   R   SEG=MAIN   1744 1747#
NO . . . . . . . .  C ADDR   2998H   R   SEG=MAIN   6768 6772 6776 6780#
NO0KEY . . . . . .  C ADDR   02A4H   R   SEG=MAIN   688 690 694#
NO10MSV. . . . . .  C ADDR   16B0H   R   SEG=MAIN   3666 3672#
NO11V6 . . . . . .  C ADDR   0EC3H   R   SEG=MAIN   2467 2475#
NO12V6 . . . . . .  C ADDR   0ED6H   R   SEG=MAIN   2475 2483#
NO13V6 . . . . . .  C ADDR   0EE9H   R   SEG=MAIN   2483 2493#
NO21P7 . . . . . .  C ADDR   1BFEH   R   SEG=MAIN   4356 4405#
NO23RI . . . . . .  C ADDR   0F8DH   R   SEG=MAIN   2593 2597#
NO2MSV . . . . . .  C ADDR   16ADH   R   SEG=MAIN   3671# 3672 3682
NO2PARN. . . . . .  C ADDR   0983H   R   SEG=MAIN   1640 1646#
NO31N. . . . . . .  C ADDR   1667H   R   SEG=MAIN   3635#
NO31RI . . . . . .  C ADDR   0FB8H   R   SEG=MAIN   2599 2618#
NO3PARN. . . . . .  C ADDR   0979H   R   SEG=MAIN   1640# 1725
NO4DEL . . . . . .  C ADDR   0C0FH   R   SEG=MAIN   2042 2065#
NOAVK. . . . . . .  C ADDR   0660H   R   SEG=MAIN   1162 1211#
NOAVP. . . . . . .  C ADDR   0781H   R   SEG=MAIN   1355# 1386 1389
NOBAVP . . . . . .  C ADDR   0A2AH   R   SEG=MAIN   1497 1501 1581 1763 1767#
NOBEF99. . . . . .  C ADDR   035BH   R   SEG=MAIN   800 816# 835 853 869
NOBIT. . . . . . .  C ADDR   0245H   A      7684 7698#
NOBITIZM . . . . .  C ADDR   0A33H   R   SEG=MAIN   1769 1772#
NOBL21 . . . . . .  C ADDR   1046H   R   SEG=MAIN   2673 2681#
NOBL22 . . . . . .  C ADDR   1050H   R   SEG=MAIN   2681 2701#
NOBUF. . . . . . .  C ADDR   0A68H   R   SEG=MAIN   1799 1801#
NOBUF0 . . . . . .  C ADDR   0BAFH   R   SEG=MAIN   1914 2007#
NOCHI0 . . . . . .  C ADDR   095AH   R   SEG=MAIN   1375 1612#
NOCHIND. . . . . .  C ADDR   02C3H   R   SEG=MAIN   708 716#
NOCHN10. . . . . .  C ADDR   05B5H   R   SEG=MAIN   1093 1098#
NOCHN2 . . . . . .  C ADDR   05AAH   R   SEG=MAIN   1088 1093#
NOCHN20. . . . . .  C ADDR   05C0H   R   SEG=MAIN   1098 1103#
NODI2. . . . . . .  C ADDR   0940H   R   SEG=MAIN   1589 1596#
NODI6. . . . . . .  C ADDR   11DCH   R   SEG=MAIN   2952 2956#
NODI8. . . . . . .  C ADDR   09E5H   R   SEG=MAIN   1709 1715#
NODI8K . . . . . .  C ADDR   1A97H   R   SEG=MAIN   4184 4189#
NODI8_43 . . . . .  C ADDR   1843H   R   SEG=MAIN   3863 3869#
NODI9. . . . . . .  C ADDR   0945H   R   SEG=MAIN   1598 1601#
NODI9_43 . . . . .  C ADDR   184EH   R   SEG=MAIN   3869 3877#
NODIS9 . . . . . .  C ADDR   09F4H   R   SEG=MAIN   1715 1727#
NODISK9. . . . . .  C ADDR   1A9FH   R   SEG=MAIN   4188 4189 4196#
NOENDLI. . . . . .  C ADDR   27D0H   R   SEG=MAIN   6269 6273#
NOEQU1 . . . . . .  C ADDR   10AEH   R   SEG=MAIN   2766 2770#
NOEQU2 . . . . . .  C ADDR   1661H   R   SEG=MAIN   3625 3629#
NOFIZM . . . . . .  C ADDR   0EA5H   R   SEG=MAIN   2431 2463#
NOFT1. . . . . . .  C ADDR   0E7EH   R   SEG=MAIN   2436 2440#
NOFZ . . . . . . .  C ADDR   0BAAH   R   SEG=MAIN   1998 2002#
NOH37. . . . . . .  C ADDR   1272H   R   SEG=MAIN   3011 3035# 3046
NOHNOT1. . . . . .  C ADDR   134DH   R   SEG=MAIN   3117 3160#
NOHNOT2. . . . . .  C ADDR   1342H   R   SEG=MAIN   3153# 3160
NOKLB. . . . . . .  C ADDR   0A62H   R   SEG=MAIN   1797 1799#
NOKORR . . . . . .  C ADDR   0608H   R   SEG=MAIN   1149 1152#
NOLAH. . . . . . .  C ADDR   1234H   R   SEG=MAIN   2980 2998#
NOLI_43. . . . . .  C ADDR   18BEH   R   SEG=MAIN   3896 3941#
NOM31. . . . . . .  C ADDR   163FH   R   SEG=MAIN   3529 3604#
NOM32. . . . . . .  C ADDR   16B8H   R   SEG=MAIN   3604 3678#
NOM33. . . . . . .  C ADDR   16E6H   R   SEG=MAIN   3678 3698#
NOMARL . . . . . .  C ADDR   1B7BH   R   SEG=MAIN   4320 4326 4330#
NOMAXI . . . . . .  C ADDR   2003H   R   SEG=MAIN   5040 5043#
NOME11 . . . . . .  C ADDR   1524H   R   SEG=MAIN   3429#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   142

NOMEM11. . . . . .  C ADDR   0FF1H   R   SEG=MAIN   2635 2645#
NOMEM12. . . . . .  C ADDR   1007H   R   SEG=MAIN   2645 2653#
NOMEM13. . . . . .  C ADDR   101DH   R   SEG=MAIN   2653 2662#
NOMEMK . . . . . .  C ADDR   1521H   R   SEG=MAIN   3183 3426#
NOMINI . . . . . .  C ADDR   1F2AH   R   SEG=MAIN   4889 4892#
NON1C. . . . . . .  C ADDR   0E51H   R   SEG=MAIN   2411 2415#
NONULAVT . . . . .  C ADDR   0645H   R   SEG=MAIN   1157 1196#
NONULDEL . . . . .  C ADDR   0BE9H   R   SEG=MAIN   2030 2041#
NOP3_0 . . . . . .  C ADDR   095EH   R   SEG=MAIN   1618#
NOPART1. . . . . .  C ADDR   035FH   R   SEG=MAIN   789 823#
NOPART2. . . . . .  C ADDR   037FH   R   SEG=MAIN   823 842#
NOPART3. . . . . .  C ADDR   039FH   R   SEG=MAIN   842 858#
NOPART4. . . . . .  C ADDR   03BFH   R   SEG=MAIN   858 875#
NOPLUS . . . . . .  C ADDR   0F39H   R   SEG=MAIN   2544 2547#
NOPOIN7. . . . . .  C ADDR   1B92H   R   SEG=MAIN   4316 4351#
NOPOINT. . . . . .  C ADDR   1B5EH   R   SEG=MAIN   4310 4314#
NOR11. . . . . . .  C ADDR   0F4DH   R   SEG=MAIN   2558#
NORDN. . . . . . .  C ADDR   00F6H   A      7405# 7438
NORDN1 . . . . . .  C ADDR   0107H   A      7407 7421#
NORIG2 . . . . . .  C ADDR   108BH   R   SEG=MAIN   2734 2742#
NORIM6 . . . . . .  C ADDR   10C9H   R   SEG=MAIN   2794#
NORIME . . . . . .  C ADDR   0F73H   R   SEG=MAIN   2580 2584#
NORIME1. . . . . .  C ADDR   0F6DH   R   SEG=MAIN   2582# 2585 2598
NORM1. . . . . . .  C ADDR   00F0H   A      7400# 7597 7774 7876 8093
NORR11 . . . . . .  C ADDR   128AH   R   SEG=MAIN   3048#
NORR12 . . . . . .  C ADDR   129AH   R   SEG=MAIN   3048 3055# 3069
NORUP. . . . . . .  C ADDR   0119H   A      7404 7441#
NORUP1 . . . . . .  C ADDR   011EH   A      7446# 7464
NORUP2 . . . . . .  C ADDR   0132H   A      7448 7465#
NORVICH. . . . . .  C ADDR   0A6BH   R   SEG=MAIN   1724 1802#
NOSAV1 . . . . . .  C ADDR   0B20H   R   SEG=MAIN   1925 1928#
NOSAV2 . . . . . .  C ADDR   0B27H   R   SEG=MAIN   1928 1931#
NOSAV3 . . . . . .  C ADDR   0B2EH   R   SEG=MAIN   1931 1934#
NOSUB. . . . . . .  C ADDR   29D3H   R   SEG=MAIN   6802 6806 6810 6815#
NOT1IN . . . . . .  C ADDR   0BBFH   R   SEG=MAIN   1875 2015#
NOT1_7 . . . . . .  C ADDR   1181H   R   SEG=MAIN   2902 2909#
NOT2IN . . . . . .  C ADDR   0BC7H   R   SEG=MAIN   2015 2019#
NOT2_7 . . . . . .  C ADDR   118CH   R   SEG=MAIN   2909 2914#
NOT3IN . . . . . .  C ADDR   0BCFH   R   SEG=MAIN   2019 2022#
NOTAKT . . . . . .  C ADDR   0A3DH   R   SEG=MAIN   1773 1777#
NOTE21 . . . . . .  C ADDR   0705H   R   SEG=MAIN   1257 1299#
NOTE22 . . . . . .  C ADDR   0720H   R   SEG=MAIN   1299 1311#
NOTESTIZM. . . . .  C ADDR   0738H   R   SEG=MAIN   1220 1323#
NOTT1. . . . . . .  C ADDR   0B62H   R   SEG=MAIN   1961 1970#
NOTT2. . . . . . .  C ADDR   0B6DH   R   SEG=MAIN   1970 1975#
NOTT3. . . . . . .  C ADDR   0B78H   R   SEG=MAIN   1975 1981#
NOTT4. . . . . . .  C ADDR   0B8CH   R   SEG=MAIN   1981 1989#
NOTT5. . . . . . .  C ADDR   0B97H   R   SEG=MAIN   1989 1993#
NOT_1. . . . . . .  C ADDR   0E58H   R   SEG=MAIN   2415 2420#
NOT_10 . . . . . .  C ADDR   0E58H   R   SEG=MAIN   2419#
NOVIR. . . . . . .  C ADDR   0F55H   R   SEG=MAIN   2452 2569#
NOVIR1 . . . . . .  C ADDR   0E8FH   R   SEG=MAIN   2452# 2463
NOZMEA . . . . . .  C ADDR   1E8BH   R   SEG=MAIN   4769 4771#
NOZMIN . . . . . .  C ADDR   1F7EH   R   SEG=MAIN   4940 4942#
NOZZBL . . . . . .  C ADDR   1835H   R   SEG=MAIN   3852 3855 3858 3861#
NOZZMI . . . . . .  C ADDR   09D5H   R   SEG=MAIN   1704 1706#
NOZZMI1. . . . . .  C ADDR   1825H   R   SEG=MAIN   3850 3853#
NOZZMI2. . . . . .  C ADDR   182CH   R   SEG=MAIN   3853 3856#
NOZZMI3. . . . . .  C ADDR   1833H   R   SEG=MAIN   3856 3859#
NOZZMI43 . . . . .  C ADDR   181CH   R   SEG=MAIN   3847 3849#
NSEC1. . . . . . .  C ADDR   0A17H   R   SEG=MAIN   1748 1751#
NSEC10 . . . . . .  C ADDR   0A20H   R   SEG=MAIN   1750 1753 1758#
NSEC11 . . . . . .  C ADDR   0A1EH   R   SEG=MAIN   1751 1755#
NUERR. . . . . . .  D ADDR   0039H   A      310# 1411 4203 4389 5087 5101 5913
NULAVT . . . . . .  C ADDR   0C20H   R   SEG=MAIN   2082#
NUMSIZE. . . . . .  N NUMB   0004H   A      6383# 6405 6443 6450 6525 6545
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   143

OBOARD . . . . . .  C ADDR   2909H   R   SEG=MAIN   6626 6640#
OBOARD1. . . . . .  C ADDR   2951H   R   SEG=MAIN   6699 6712#
OK1. . . . . . . .  C ADDR   0186H   A      7531 7546#
OK2. . . . . . . .  C ADDR   01A0H   A      7548 7563#
OK3. . . . . . . .  C ADDR   01C4H   A      7580 7596#
ONBOAR1. . . . . .  C ADDR   292FH   R   SEG=MAIN   6661 6678#
ONBOARD. . . . . .  C ADDR   28E3H   R   SEG=MAIN   6590 6604#
ONMEM11. . . . . .  C ADDR   136FH   R   SEG=MAIN   2929 2944 2946 3177# 3737 3743 3995 3999 4004 4019 4024 4047 4061
                                           4065 4076
ONMEM12. . . . . .  C ADDR   19BFH   R   SEG=MAIN   4066# 4069 4088
ONMEM13. . . . . .  C ADDR   1B3EH   R   SEG=MAIN   4241 4296# 4300 4302
ONMIG. . . . . . .  C ADDR   24B2H   R   SEG=MAIN   5895 5904#
ONVICH . . . . . .  C ADDR   0DCAH   R   SEG=MAIN   2306 2318#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 493
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 486 490
OUT43. . . . . . .  C ADDR   1857H   R   SEG=MAIN   3886#
OUT6 . . . . . . .  C ADDR   10C9H   R   SEG=MAIN   2189 2254 2299 2376 2381 2386 2402 2438 2443 2450 2461 2583 2596
                                           2606 2612 2795#
OUT7 . . . . . . .  C ADDR   1C27H   R   SEG=MAIN   2828 2829 2906 2913 2917 2935 2986 2991 3042 3181 3261 3494 3588
                                           3717 3888 3895 3940 4034 4122 4217 4221 4291 4305 4400 4402 4430#
OUTA . . . . . . .  C ADDR   2479H   R   SEG=MAIN   3087 5836#
OUTA2. . . . . . .  C ADDR   2493H   R   SEG=MAIN   5847# 5852
OUTF . . . . . . .  C ADDR   0E85H   R   SEG=MAIN   2446# 2469 2473 2477 2481 2485 2489 2514 2537 2546 2549 2556 2628
                                           2643 2652 2660 2669 2679 2726 2729 2769 2783 2786 3032 3033 4066
OUTFL. . . . . . .  C ADDR   0F4AH   R   SEG=MAIN   2552 2556#
OUTKMEM. . . . . .  C ADDR   137CH   R   SEG=MAIN   3185# 3203 3715
OUTMA. . . . . . .  C ADDR   0F23H   R   SEG=MAIN   2535 2537#
OUTMAX . . . . . .  C ADDR   2008H   R   SEG=MAIN   5027 5046#
OUTMEA . . . . . .  C ADDR   1E2BH   R   SEG=MAIN   4708 4723#
OUTMENU. . . . . .  C ADDR   197BH   R   SEG=MAIN   4033#
OUTMIN . . . . . .  C ADDR   1F2FH   R   SEG=MAIN   4876 4896#
OUTR . . . . . . .  C ADDR   08F1H   R   SEG=MAIN   1527 1550#
OUTR5. . . . . . .  C ADDR   090DH   R   SEG=MAIN   1548 1569#
OUTSKO . . . . . .  C ADDR   1A20H   R   SEG=MAIN   4118 4120#
OUTSKO1. . . . . .  C ADDR   1A1DH   R   SEG=MAIN   4116 4119#
OUTVICH. . . . . .  C ADDR   0E92H   R   SEG=MAIN   2453# 2465
OUTVIR . . . . . .  C ADDR   0D53H   R   SEG=MAIN   2221 2250#
OUT_KALI . . . . .  C ADDR   1D26H   R   SEG=MAIN   4574#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 6582
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 5114 5118
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 464
P1 . . . . . . . .  D ADDR   0090H   A      32# 650 651 5127 5129 5132 5135 5139 5141 5142 5194 5196 5198 5634 5641
                                           6172 6175 6177 6180
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 465
P2 . . . . . . . .  D ADDR   00A0H   A      47# 5160 5164 5173
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 466
P3 . . . . . . . .  D ADDR   00B0H   A      62# 475 2220 2222 2224 2225 2228 2229 2233 2234 2236 2237 2239 2240 2242
                                           2243 2245 2246 2425 2426 2432 2433 2464 2465 2468 2469 2476 2477 2484 2485
                                           2493 2494 2539 2540 2550 2551 2577 2578 2591 2592 2622 2623 2624 2625 2637
                                           2638 2646 2647 2654 2655 2663 2664 2702 2703 2737 2738 2746 2747 2784 2785
                                           2814 2861 2863 2865 2866 2869 2870 2872 2873 2875 2876 2878 2879 2881 2882
                                           2884 2885 2981 2984 3010 3011 3035 3036 3049 3050 3056 3057 3070 3071 3115
                                           3116 3202 3203 3206 3207 3248 3249 3265 3266 3267 3268 3322 3323 3429 3430
                                           3440 3441 3531 3532 3533 3534 3605 3606 3635 3636 3679 3680 3681 3682 3699
                                           3700 3701 3702 3720 3721 3722 3723 3730 3731 3773 3774 3775 3776 3897 3898
                                           3986 3987 4055 4056 4068 4069 4085 4086 4087 4088 4128 4129 4130 4131 4299
                                           4300 4301 4302 4308 4309 4314 4315 4351 4352 4444 5159 5161 5163 5169 5170
                                           5171 5174 5175
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2196 2813 2835 4443
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 468
P4 . . . . . . . .  D ADDR   0084H   A      20# 2032 2053 2085 2168 2330 2332 4560 5252 5255 5271 5273 5737
P5 . . . . . . . .  D ADDR   0085H   A      21# 564 573 2034 2055 2087 2090 2095 2130 2132 2170 2340 2342 4564 5260
                                           5263 5293 5296 5741
P6 . . . . . . . .  D ADDR   0086H   A      22# 1940 1942 1946 1948 2816 2818 2822 2824 4447 4449 4453 4455
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   144

P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 469
PACK1. . . . . . .  C ADDR   00DEH   A      7383# 7598 7775 7877 8094
PARERR . . . . . .  C ADDR   1AACH   R   SEG=MAIN   4160 4162 4164 4203#
PARN . . . . . . .  D ADDR   00AFH   A      390# 570 1738 2406 3143
PAROL. . . . . . .  D ADDR   00A8H   A      386#
PART . . . . . . .  D ADDR   009AH   A      380# 565 787 1127 1169 1196 1211 1747 1803 1960 2301 2370 2407 2900 3126
                                           3142 3578 3665 5264 5661
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 462
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 463
PCON . . . . . . .  D ADDR   0087H   A      23# 509
POIN3. . . . . . .  C ADDR   1B91H   R   SEG=MAIN   4349# 4403
POINA. . . . . . .  C ADDR   1BF9H   R   SEG=MAIN   4347 4402#
POINA1 . . . . . .  C ADDR   1B76H   R   SEG=MAIN   4319 4326#
POINA2 . . . . . .  C ADDR   1B70H   R   SEG=MAIN   4322# 4327
POZB . . . . . . .  C ADDR   1C1CH   R   SEG=MAIN   4416 4420#
PROD . . . . . . .  N NUMB   000CH   A      7320# 7664 7665 7666 7667 7687 7688 7689 7691 7692 7694 7695 7697 7719
                                           7721 7722 7724 7725 7727 7728 7730 7749 7750 7751 7753 7754 7756 7757 7759
                                           7770 7771 7772 7773 7794 7795 7796 7797 7813 7815 7816 7818 7819 7821 7822
                                           7824 7854 7871 7872 7873 7874
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 8125 8129 8182 8185
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 2199 2804 2838 4441 6081 6083 7055
                                           7063
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0D5DH   R   SEG=MAIN   2244 2256#
QUES . . . . . . .  C ADDR   1428H   R   SEG=MAIN   3261# 3266
QU_AVP . . . . . .  C ADDR   077EH   R   SEG=MAIN   1352 1354#
R10. . . . . . . .  N NUMB   000AH   A      449# 1158 1406 1443 1455 4163 5709 8148
R11. . . . . . . .  N NUMB   000BH   A      450# 1159 1405 1444 1454 5713 8152
R8 . . . . . . . .  N NUMB   0008H   A      447# 516 1408 1441 1457 4012 4159 5214 5701 8140
R9 . . . . . . . .  N NUMB   0009H   A      448# 1407 1442 1456 4161 5215 5705 8144
RAFTERK. . . . . .  C ADDR   061EH   R   SEG=MAIN   1166# 1172
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RDDOUTF. . . . . .  C ADDR   1481H   R   SEG=MAIN   3318# 3323
RE1. . . . . . . .  C ADDR   20ECH   R   SEG=MAIN   5194# 5200
RE11_7 . . . . . .  C ADDR   06C6H   R   SEG=MAIN   1268# 1310 1321
RE4BYTE. . . . . .  C ADDR   0454H   A      515 4011 4157 8136#
REA3_X . . . . . .  C ADDR   2816H   R   SEG=MAIN   3819 6325#
REACP. . . . . . .  D ADDR   0077H   A      304# 665 667 669 671 728 744 752 760 769 776 791 826 844 860 876 2104
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   145

                                           2106 2108 2110 2142 2144 2146 2148
READ . . . . . . .  C ADDR   20EAH   R   SEG=MAIN   664 666 668 5193#
READYACP . . . . .  C ADDR   0316H   R   SEG=MAIN   770 780#
READ_X2. . . . . .  C ADDR   20D2H   R   SEG=MAIN   5168# 5179
REBYTE . . . . . .  C ADDR   0266H   R   SEG=MAIN   649# 683 705 817 2063 2097 2135 2173 2182 2184
REBYTE2. . . . . .  C ADDR   046CH   A      1260 1268 1286 1302 1313 1329 4580 4588 8156#
REF0CN . . . . . .  D ADDR   00D1H   A      92# 470
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RENDKALIB. . . . .  C ADDR   11BDH   R   SEG=MAIN   2939# 2941
RESAR2 . . . . . .  C ADDR   273AH   R   SEG=MAIN   792 827 845 861 877 889 925 1007 1063 1184 1229 1337 1358 1423
                                           1446 1473 1626 1680 1898 2008 2045 2968 4501 4509 4528 4606 4628 4716 4728
                                           4743 4823 4881 4897 4911 4974 5032 5047 5837 6150# 6309
RESAR8 . . . . . .  C ADDR   26F8H   R   SEG=MAIN   1140 1190 1232 1240 1363 2117 2155 6089#
RESA_HL. . . . . .  C ADDR   27E3H   R   SEG=MAIN   1918 4661 4799 4949 6286#
REZAM. . . . . . .  D ADDR   008CH   A      376# 2152
REZAP. . . . . . .  D ADDR   0088H   A      375# 2114
REZMUL . . . . . .  C ADDR   0676H   R   SEG=MAIN   1204 1218 1227#
REZ_A. . . . . . .  D ADDR   0062H   A      365# 805 878 888 924 1006 1062 2044
REZ_A0 . . . . . .  D ADDR   006AH   A      367# 1189 1362 1400 1607 2294 2960 2969 2976
REZ_A1 . . . . . .  D ADDR   0066H   A      366# 1121 1187 1228 1342 1357 1376
REZ_A2 . . . . . .  D ADDR   007BH   A      368# 1359
REZ_A3 . . . . . .  D ADDR   009CH   A      382# 1192 1365 1422 1625 1679 1808 2967 4500 4605 6308 6339
REZ_AK . . . . . .  D ADDR   00A4H   A      385# 4278 4508
REZ_AME. . . . . .  D ADDR   005EH   A      363# 1133 1142 1183 1242 1336
REZ_DEL. . . . . .  D ADDR   00C5H   A      402# 807
REZ_R. . . . . . .  D ADDR   00C9H   A      403# 1459 1472
RE_HL. . . . . . .  C ADDR   27EAH   R   SEG=MAIN   6289# 6299 6303 6306
RE_HL1 . . . . . .  C ADDR   27F2H   R   SEG=MAIN   6287 6297#
RE_HL2 . . . . . .  C ADDR   27F9H   R   SEG=MAIN   6297 6301#
RE_HL3 . . . . . .  C ADDR   2800H   R   SEG=MAIN   6301 6305#
RGO23NO. . . . . .  C ADDR   1484H   R   SEG=MAIN   3319# 3324
RGOTO7 . . . . . .  C ADDR   163CH   R   SEG=MAIN   3602# 3636
RHNOR11. . . . . .  C ADDR   1264H   R   SEG=MAIN   3009 3021 3027#
RHNOT1 . . . . . .  C ADDR   122BH   R   SEG=MAIN   2984 2993#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RI21_23. . . . . .  C ADDR   0F76H   R   SEG=MAIN   2575 2587#
RI6. . . . . . . .  C ADDR   0F70H   R   SEG=MAIN   2578 2583# 2592 2621 2625
RIGBLO . . . . . .  C ADDR   1053H   R   SEG=MAIN   2702# 2733 2735
RIGBLOK. . . . . .  C ADDR   1091H   R   SEG=MAIN   2746#
RIGHT2 . . . . . .  C ADDR   0D84H   R   SEG=MAIN   2271 2275#
RIGHT3 . . . . . .  C ADDR   0D88H   R   SEG=MAIN   2273 2278#
RIKN . . . . . . .  C ADDR   0EFBH   R   SEG=MAIN   2500# 2518
RIZMAN . . . . . .  C ADDR   0CDFH   R   SEG=MAIN   2193# 2230
RI_31. . . . . . .  C ADDR   0F90H   R   SEG=MAIN   2590 2599#
RKNLEFT. . . . . .  C ADDR   1103H   R   SEG=MAIN   2832# 2877
RKNMEM . . . . . .  C ADDR   10F4H   R   SEG=MAIN   2827# 2883
RKNNUL . . . . . .  C ADDR   1100H   R   SEG=MAIN   2831# 2871
RKNOPT . . . . . .  C ADDR   0CDCH   R   SEG=MAIN   2192# 2241
RKNRAZR. . . . . .  C ADDR   0CD9H   R   SEG=MAIN   2191# 2235
RKVVOD0. . . . . .  C ADDR   13BCH   R   SEG=MAIN   3208 3215#
RLABELF. . . . . .  C ADDR   0CD6H   R   SEG=MAIN   2190# 2227
RLABELH. . . . . .  C ADDR   10FDH   R   SEG=MAIN   2830# 2868
RLABELI. . . . . .  C ADDR   1231H   R   SEG=MAIN   2996#
RLABELK. . . . . .  C ADDR   122EH   R   SEG=MAIN   2995# 2998
RLABELL. . . . . .  C ADDR   0F52H   R   SEG=MAIN   2567#
RLABELL1 . . . . .  C ADDR   10C6H   R   SEG=MAIN   2785 2788#
RLABELN. . . . . .  C ADDR   0FCDH   R   SEG=MAIN   2623 2627#
RLABELP. . . . . .  C ADDR   1916H   R   SEG=MAIN   3984# 3987
RLABELS13. . . . .  C ADDR   1A2AH   R   SEG=MAIN   4125# 4129
RLABELS4 . . . . .  C ADDR   1A27H   R   SEG=MAIN   4124# 4127
RLABL2 . . . . . .  C ADDR   1422H   R   SEG=MAIN   3259#
RLABM. . . . . . .  C ADDR   1425H   R   SEG=MAIN   3260# 3264
RLEFCUR. . . . . .  C ADDR   16E3H   R   SEG=MAIN   3696# 3700
RLER . . . . . . .  C ADDR   246BH   R   SEG=MAIN   5820 5822#
RLIST_43 . . . . .  C ADDR   177AH   R   SEG=MAIN   3770# 3772
RMAS4. . . . . . .  C ADDR   0467H   R   SEG=MAIN   950# 952
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   146

RME21_23 . . . . .  C ADDR   174AH   R   SEG=MAIN   3728 3747#
RMO220 . . . . . .  C ADDR   0658H   R   SEG=MAIN   1206# 1253
RNNMEMB. . . . . .  C ADDR   0FD3H   R   SEG=MAIN   2630# 2633
RNO3PARN . . . . .  C ADDR   09F2H   R   SEG=MAIN   1725# 1739
RNOBUF0. . . . . .  C ADDR   0B06H   R   SEG=MAIN   1910 1914#
RNOCHI0. . . . . .  C ADDR   07A6H   R   SEG=MAIN   1371 1375#
RNOH37 . . . . . .  C ADDR   1288H   R   SEG=MAIN   3046# 3050 3057 3071
RNOM31 . . . . . .  C ADDR   15BAH   R   SEG=MAIN   3529# 3530
RNOMEMK. . . . . .  C ADDR   1379H   R   SEG=MAIN   3183# 3201
RNORVICH . . . . .  C ADDR   09F0H   R   SEG=MAIN   1668 1669 1724#
RNOT1IN. . . . . .  C ADDR   0AC4H   R   SEG=MAIN   1805 1875#
RNOTESTIZM . . . .  C ADDR   066EH   R   SEG=MAIN   1220# 1255
ROUSTA . . . . . .  C ADDR   1902H   R   SEG=MAIN   3968 3976#
ROUSTA1. . . . . .  C ADDR   1913H   R   SEG=MAIN   3976 3982#
ROUT6. . . . . . .  C ADDR   0CD3H   R   SEG=MAIN   2189# 2226
ROUT7. . . . . . .  C ADDR   10FAH   R   SEG=MAIN   2829# 2862 2867
ROUTF. . . . . . .  C ADDR   1285H   R   SEG=MAIN   3042# 3116
RR0. . . . . . . .  N NUMB   0000H   A      440# 2200 2803 2839 4440
RR1. . . . . . . .  N NUMB   0001H   A      441# 2201 2802 2840 4439
RR2. . . . . . . .  N NUMB   0002H   A      443# 1262 1274 1280 1292 1304 1315 2202 2801 2841 3798 3806 4438 4582
                                           4594 4600 4612 5227
RR3. . . . . . . .  N NUMB   0003H   A      444# 1263 1273 1281 1291 1305 1316 2203 2800 2842 3799 3805 4437 4583
                                           4593 4601 4611 5228
RR4. . . . . . . .  N NUMB   0004H   A      1264 1272 1282 1290 1306 1317 2204 2799 2843 3800 3804 4436 4584 4592
                                           4602 4610 6384# 6441 6462 6478 6522 6544
RR5. . . . . . . .  N NUMB   0005H   A      1265 1271 1283 1289 1307 1318 2205 2798 2844 3801 3803 4435 4585 4591
                                           4603 4609 6385# 6442 6449 6456 6523 6532
RR6. . . . . . . .  N NUMB   0006H   A      442# 2206 2797 2845 4434
RR7. . . . . . . .  N NUMB   0007H   A      445# 2207 2796 2846 4433
RRIR . . . . . . .  C ADDR   2478H   R   SEG=MAIN   5831 5833#
RRMO220. . . . . .  C ADDR   07A3H   R   SEG=MAIN   1348 1374#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   098CH   R   SEG=MAIN   1652# 1670 1672 1673
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 500 2936
RTIZMRI. . . . . .  C ADDR   0E5CH   R   SEG=MAIN   2423#
RVVIZKO. . . . . .  C ADDR   1266H   R   SEG=MAIN   3029# 3037
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SADIAP . . . . . .  D ADDR   0034H   A      314# 569 1926 3851
SADIAP2. . . . . .  D ADDR   0032H   A      316# 1929 3854
SADIAP3. . . . . .  D ADDR   0031H   A      317# 1932 3857
SADIAP4. . . . . .  D ADDR   0030H   A      318# 1935 3859
SAUS . . . . . . .  D ADDR   0036H   A      313# 2033 2035 2052 2054 2086 2088 2167 2169
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2218 2513 2531 2716 2760 2780 2858 3459 3514 3619 4235 4341 5896
                                           5904
SAVEIR2. . . . . .  C ADDR   267CH   R   SEG=MAIN   891 928 1010 1066 5989#
SAVELTE. . . . . .  C ADDR   04A7H   A      8219#
SAVEN_BL . . . . .  D ADDR   00D3H   A      406# 590 6257 6288
SAVEN_BL2. . . . .  D ADDR   00C0H   A      399# 598 6276 6298
SAVEN_BL3. . . . .  D ADDR   00C2H   A      400# 605 6280 6302
SAVEN_BL4. . . . .  D ADDR   00D9H   A      410# 612 6282 6305
SAVER2 . . . . . .  C ADDR   2688H   R   SEG=MAIN   582 584 586 588 796 806 808 831 849 865 879 1122 1134 1143 1188
                                           1193 1243 1343 1360 1366 1377 1460 1464 1684 1903 1967 2050 2115 2127 2153
                                           2165 2970 2977 3829 4279 4371 4518 4620 4719 4731 4751 4826 4891 4907 4922
                                           4977 5042 5057 5840 6003# 6340
SAVE_HL. . . . . .  C ADDR   27AFH   R   SEG=MAIN   1921 3310 3347 3366 3388 3410 3660 6255#
SA_HL. . . . . . .  C ADDR   27B6H   R   SEG=MAIN   6258# 6277 6281 6283
SA_HL1 . . . . . .  C ADDR   27D1H   R   SEG=MAIN   6256 6275#
SA_HL2 . . . . . .  C ADDR   27D8H   R   SEG=MAIN   6275 6279#
SA_HL3 . . . . . .  C ADDR   27DFH   R   SEG=MAIN   6279 6282#
SBUF0. . . . . . .  D ADDR   0099H   A      40# 5069 5075
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   147

SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160 508 5070 5074 5077 5078 5099
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   2094H   R   SEG=MAIN   5127# 5134
SDV1 . . . . . . .  C ADDR   20A8H   R   SEG=MAIN   5139# 5145
SDVIG0 . . . . . .  C ADDR   02F7H   R   SEG=MAIN   756# 758
SDVIG1 . . . . . .  C ADDR   02ECH   R   SEG=MAIN   748# 750
SDVIG2 . . . . . .  C ADDR   02E1H   R   SEG=MAIN   740# 742
SDVIG3 . . . . . .  C ADDR   02D5H   R   SEG=MAIN   731# 733
SDVIG4 . . . . . .  C ADDR   0306H   R   SEG=MAIN   766# 768
SDVIG6 . . . . . .  C ADDR   0310H   R   SEG=MAIN   773# 775
SDVM . . . . . . .  C ADDR   030EH   R   SEG=MAIN   763 772#
SEEGOON. . . . . .  C ADDR   09F7H   R   SEG=MAIN   1714 1722 1729#
SEEIND . . . . . .  C ADDR   0A05H   R   SEG=MAIN   1644 1651 1652 1741#
SEE_L43. . . . . .  C ADDR   1851H   R   SEG=MAIN   3868 3876 3879#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      7315# 7336 7337 7362 7363 7387 7530 7547 7768 7808
SKOR19 . . . . . .  C ADDR   1961H   R   SEG=MAIN   4013 4020#
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   12F5H   R   SEG=MAIN   3111# 3127
SP . . . . . . . .  D ADDR   0081H   A      17# 461
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 506
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 505
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 5116
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SPWRI. . . . . . .  C ADDR   1A02H   R   SEG=MAIN   4103 4105#
SS1. . . . . . . .  C ADDR   21CAH   R   SEG=MAIN   5376# 5378
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      394# 793 795 810 828 830 846 848 862 864 1398 1605 2292 2958
SUMT2. . . . . . .  C ADDR   0362H   R   SEG=MAIN   784 825#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T2MSME . . . . . .  C ADDR   16A7H   R   SEG=MAIN   3668# 3674
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   236AH   R   SEG=MAIN   5652# 5662
TABN . . . . . . .  C ADDR   2402H   R   SEG=MAIN   5754# 5758
TABT11 . . . . . .  C ADDR   2182H   R   SEG=MAIN   5313# 5734
TABT7. . . . . . .  C ADDR   2186H   R   SEG=MAIN   4557 5317# 5747
TABT9. . . . . . .  C ADDR   2184H   R   SEG=MAIN   5315# 5744
TABUS. . . . . . .  C ADDR   216EH   R   SEG=MAIN   5249 5302#
TAKTIND. . . . . .  C ADDR   0A42H   R   SEG=MAIN   1776 1779#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 497 498 512
TE10MS . . . . . .  C ADDR   24CEH   R   SEG=MAIN   3667 5919#
TE22 . . . . . . .  C ADDR   23F5H   R   SEG=MAIN   5733 5743#
TE23 . . . . . . .  C ADDR   23FDH   R   SEG=MAIN   5743 5747#
TE2MS. . . . . . .  C ADDR   24C4H   R   SEG=MAIN   3673 5918#
TEAEQU0. . . . . .  C ADDR   250AH   R   SEG=MAIN   3084 5927#
TEAVK. . . . . . .  C ADDR   2546H   R   SEG=MAIN   4474 5934#
TEBEQU0. . . . . .  C ADDR   2514H   R   SEG=MAIN   5928#
TEBL . . . . . . .  C ADDR   25FAH   R   SEG=MAIN   2675 3252 5956#
TEBL0. . . . . . .  C ADDR   2604H   R   SEG=MAIN   3478 5957#
TECH . . . . . . .  C ADDR   260EH   R   SEG=MAIN   3759 3926 5958#
TECLE. . . . . . .  C ADDR   25BFH   R   SEG=MAIN   2667 3220 5950#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   148

TEEND. . . . . . .  C ADDR   265EH   R   SEG=MAIN   4571 5967#
TEERR. . . . . . .  C ADDR   2654H   R   SEG=MAIN   5911 5966#
TEFULL . . . . . .  C ADDR   25E6H   R   SEG=MAIN   2682 3445 5954#
TEINT. . . . . . .  C ADDR   25F0H   R   SEG=MAIN   3545 5955#
TEIZMK . . . . . .  C ADDR   25A1H   R   SEG=MAIN   2471 3023 5947#
TEKALIB. . . . . .  C ADDR   2550H   R   SEG=MAIN   3735 4477 5935#
TEKD . . . . . . .  C ADDR   2597H   R   SEG=MAIN   4168 5946#
TELIST . . . . . .  C ADDR   25DBH   R   SEG=MAIN   2650 3169 3231 3237 5953#
TEMAX. . . . . . .  C ADDR   262CH   R   SEG=MAIN   3962 5961#
TEMEM. . . . . . .  C ADDR   25C9H   R   SEG=MAIN   5951#
TEMENU . . . . . .  C ADDR   251EH   R   SEG=MAIN   5929#
TEMID. . . . . . .  C ADDR   2636H   R   SEG=MAIN   3970 5962#
TEMIN. . . . . . .  C ADDR   2622H   R   SEG=MAIN   3490 3978 5960#
TEMUL. . . . . . .  C ADDR   0755H   R   SEG=MAIN   1298 1335#
TENMIN . . . . . .  C ADDR   226CH   R   SEG=MAIN   1201 1203 1217 5444#
TEOLI. . . . . . .  C ADDR   2640H   R   SEG=MAIN   1498 5964#
TEOLL. . . . . . .  C ADDR   25B5H   R   SEG=MAIN   1591 5949#
TEOLR. . . . . . .  C ADDR   264AH   R   SEG=MAIN   1494 5965#
TEOUT. . . . . . .  C ADDR   25ABH   R   SEG=MAIN   2479 2560 3014 5948#
TEPAR. . . . . . .  C ADDR   258DH   R   SEG=MAIN   4494 5945#
TES19_2. . . . . .  C ADDR   2583H   R   SEG=MAIN   521 2607 4020 4218 5943#
TES57_6. . . . . .  C ADDR   2579H   R   SEG=MAIN   2601 4014 4214 4490 5942#
TESKOR . . . . . .  C ADDR   253CH   R   SEG=MAIN   4471 5933#
TEST01 . . . . . .  C ADDR   202FH   R   SEG=MAIN   5074# 5097
TEST02 . . . . . .  C ADDR   205EH   R   SEG=MAIN   5094 5096#
TEST04 . . . . . .  C ADDR   203FH   R   SEG=MAIN   5081# 5083
TEST1. . . . . . .  C ADDR   2025H   R   SEG=MAIN   5069# 5085 5106
TEST2. . . . . . .  C ADDR   2057H   R   SEG=MAIN   5074 5093#
TEST22 . . . . . .  C ADDR   19D7H   R   SEG=MAIN   4070 4077#
TEST23 . . . . . .  C ADDR   19DCH   R   SEG=MAIN   4077 4080#
TEST3. . . . . . .  C ADDR   2049H   R   SEG=MAIN   5076 5086#
TEST4. . . . . . .  C ADDR   2037H   R   SEG=MAIN   5077# 5092
TEST5. . . . . . .  C ADDR   2061H   R   SEG=MAIN   5095 5098#
TEST7I . . . . . .  C ADDR   0A5AH   R   SEG=MAIN   1791 1794#
TEST9I . . . . . .  C ADDR   0A53H   R   SEG=MAIN   1786 1791#
TESTAT . . . . . .  C ADDR   2618H   R   SEG=MAIN   2658 3211 5959#
TESTRS . . . . . .  C ADDR   2023H   R   SEG=MAIN   4003 5067#
TESTS. . . . . . .  C ADDR   19CBH   R   SEG=MAIN   4072# 4079 4082
TETE11 . . . . . .  C ADDR   255BH   R   SEG=MAIN   3992 4481 5937#
TETE7. . . . . . .  C ADDR   256FH   R   SEG=MAIN   4059 4487 5939#
TETE9. . . . . . .  C ADDR   2565H   R   SEG=MAIN   4484 5938#
TETESI . . . . . .  C ADDR   2528H   R   SEG=MAIN   2924 4464 5931#
TETESR . . . . . .  C ADDR   2532H   R   SEG=MAIN   4468 5932#
TEVICH . . . . . .  C ADDR   2500H   R   SEG=MAIN   2313 2487 3019 4380 5926#
TEWR . . . . . . .  C ADDR   25D1H   R   SEG=MAIN   2641 3226 5952#
TEXTT. . . . . . .  C ADDR   24C4H   R   SEG=MAIN   5329 5917#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 480
TH1. . . . . . . .  D ADDR   008DH   A      29# 519 523 4117 4119
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   20B8H   R   SEG=MAIN   5148#
TIM1 . . . . . . .  C ADDR   20BAH   R   SEG=MAIN   5149# 5149
TIM2 . . . . . . .  C ADDR   20BDH   R   SEG=MAIN   5130 5133 5140 5144 5152# 5195 5199 6176 6178
TIM3 . . . . . . .  C ADDR   20BFH   R   SEG=MAIN   5153# 5153
TIZMRI . . . . . .  C ADDR   0D7DH   R   SEG=MAIN   2270# 2423
TL0. . . . . . . .  D ADDR   008AH   A      26# 481
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   12F2H   R   SEG=MAIN   3096 3108#
TMOD . . . . . . .  D ADDR   0089H   A      25# 478 511
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 495
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   149

TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 494
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TOME13 . . . . . .  C ADDR   1942H   R   SEG=MAIN   4001 4006#
TOME14 . . . . . .  C ADDR   196FH   R   SEG=MAIN   4006 4027#
TOME15 . . . . . .  C ADDR   1987H   R   SEG=MAIN   4027 4039#
TOME21 . . . . . .  C ADDR   1939H   R   SEG=MAIN   3990 4001#
TOSK19 . . . . . .  C ADDR   1AD1H   R   SEG=MAIN   4213 4218#
TOUTF. . . . . . .  C ADDR   126FH   R   SEG=MAIN   3033# 3036
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TTOUT. . . . . . .  C ADDR   0E5FH   R   SEG=MAIN   2425# 2434
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 5117
UNPACK1. . . . . .  C ADDR   009EH   A      7333# 7527 7661 7791 7905
UNPACK2. . . . . .  C ADDR   00BAH   A      7358# 7528 7662 7792
UP1. . . . . . . .  C ADDR   0138H   A      7478# 7495
UP2. . . . . . . .  C ADDR   014BH   A      7498# 7516
UP2A . . . . . . .  C ADDR   0161H   A      7477 7514#
UPA. . . . . . . .  C ADDR   229BH   R   SEG=MAIN   5499# 5505
UPA1 . . . . . . .  C ADDR   22ABH   R   SEG=MAIN   5517# 5523
UPA2 . . . . . . .  C ADDR   228BH   R   SEG=MAIN   5480# 5486
UPAA . . . . . . .  C ADDR   2787H   R   SEG=MAIN   6224# 6230
UPAA4. . . . . . .  C ADDR   22F6H   R   SEG=MAIN   5580# 5586
UPAB . . . . . . .  C ADDR   2306H   R   SEG=MAIN   5597# 5603
UPAK . . . . . . .  C ADDR   2295H   R   SEG=MAIN   5496#
UPAK1. . . . . . .  C ADDR   2761H   R   SEG=MAIN   6189#
UPAK2. . . . . . .  C ADDR   2285H   R   SEG=MAIN   5477#
UPAK3. . . . . . .  C ADDR   22A5H   R   SEG=MAIN   3688 3783 5514#
UPAK4. . . . . . .  C ADDR   2781H   R   SEG=MAIN   3642 6221#
UPAKA. . . . . . .  C ADDR   22F0H   R   SEG=MAIN   4363 5577#
UPAKB. . . . . . .  C ADDR   2300H   R   SEG=MAIN   4410 5594#
UPAV1. . . . . . .  C ADDR   1A49H   R   SEG=MAIN   4148# 4154
UPAV2. . . . . . .  C ADDR   1B00H   R   SEG=MAIN   4262# 4268
UPK1 . . . . . . .  C ADDR   2773H   R   SEG=MAIN   6197 6200#
UPK2 . . . . . . .  C ADDR   2774H   R   SEG=MAIN   6199 6201#
VICHMAX. . . . . .  C ADDR   1F82H   R   SEG=MAIN   3964 4948#
VICHMEAN . . . . .  C ADDR   1DC6H   R   SEG=MAIN   3972 4660#
VICHMIN. . . . . .  C ADDR   1EA9H   R   SEG=MAIN   3492 3980 4798#
VICHR. . . . . . .  D ADDR   00B1H   A      392# 1256 1782 2310 2319 2453 2466 2571 2579 2927 2931 3008 3075 3187
                                           3724 3732 3741 3985 4036 4050 4166 4354 4393 4425 4462 5732
VIG0 . . . . . . .  C ADDR   0AB0H   R   SEG=MAIN   1859# 1861
VIG4 . . . . . . .  C ADDR   0ABEH   R   SEG=MAIN   1870# 1872
VIOUT. . . . . . .  C ADDR   0E36H   R   SEG=MAIN   2316 2398# 2426
VIOUTF . . . . . .  C ADDR   1268H   R   SEG=MAIN   3030#
VIT2_10. . . . . .  C ADDR   0DA9H   R   SEG=MAIN   2299# 2305
VODM11_15. . . . .  C ADDR   1706H   R   SEG=MAIN   3713# 3731
VOLUME . . . . . .  D ADDR   00D5H   A      407# 2258 3655 6265 6267
VV21_23. . . . . .  C ADDR   19C2H   R   SEG=MAIN   4056 4068#
VVCHIBL. . . . . .  C ADDR   2439H   R   SEG=MAIN   2554 5786#
VVCHIF . . . . . .  C ADDR   2414H   R   SEG=MAIN   5762# 5779
VVINTE . . . . . .  C ADDR   1667H   R   SEG=MAIN   3606 3634#
VVIZKO . . . . . .  C ADDR   12BFH   R   SEG=MAIN   3029 3075#
VVKALI52 . . . . .  C ADDR   1AF3H   R   SEG=MAIN   4246# 4298
VVMENU . . . . . .  C ADDR   1AA9H   R   SEG=MAIN   4131 4201#
VVNOL23. . . . . .  C ADDR   2434H   R   SEG=MAIN   5783# 5787
VVNOL31. . . . . .  C ADDR   242FH   R   SEG=MAIN   5781# 5783
VVNOL41. . . . . .  C ADDR   242DH   R   SEG=MAIN   5779# 5781
VVOD2_10 . . . . .  C ADDR   169FH   R   SEG=MAIN   3196 3315 3415 3665#
VVOD43 . . . . . .  C ADDR   187DH   R   SEG=MAIN   3898 3905#
VVODM11_15 . . . .  C ADDR   1919H   R   SEG=MAIN   3713 3985#
VVOSTA . . . . . .  C ADDR   18DAH   R   SEG=MAIN   3941 3960#
VVOSTAD. . . . . .  C ADDR   18EEH   R   SEG=MAIN   3960 3968#
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   150

VVRR6. . . . . . .  C ADDR   0EBBH   R   SEG=MAIN   2471#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 476 477
WORK . . . . . . .  D ADDR   00B8H   A      396# 1479 1481 1487 1503 1510 1526 1547 1552 1568 1810 1888 3282 3292
                                           3294 3328 3338 3340 3350 3360 3362 3369 3379 3381 3391 3401 3403 4668 4715
                                           4718 4727 4730 4742 4804 4822 4825 4880 4890 4896 4906 4910 4955 4973 4976
                                           5031 5041 5046 5056 5071 5093
WR1. . . . . . . .  C ADDR   274EH   R   SEG=MAIN   6172# 6179
WRITE. . . . . . .  C ADDR   274BH   R   SEG=MAIN   662 5623 5625 5627 5629 5631 5633 5636 5638 5640 5643 5645 5647
                                           6170#
WRITED_X1. . . . .  C ADDR   20C3H   R   SEG=MAIN   5158#
WRITE_X1 . . . . .  C ADDR   20C2H   R   SEG=MAIN   5157#
WRPAGE . . . . . .  C ADDR   0480H   A      4114 4550 4652 8180#
WW5. . . . . . . .  C ADDR   0483H   A      8181# 8189
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 472 504
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 473
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 474 503
XCIKLWR. . . . . .  C ADDR   2668H   R   SEG=MAIN   886 899 901 903 906 909 912 915 918 921 954 956 958 961 964 967
                                           970 973 976 978 981 983 985 988 991 994 997 1000 1003 1055 1057 1059 5972#
XTEMP. . . . . . .  N NUMB   000CH   A      6381# 6745 6746 6747 6748 6834 6836 6837 6839 6840 6842 6843 6845 6867
                                           6868 6869 6870 6888 6889 6893 6894 6897 6901 6902 6905 6909 6910 6914 6915
                                           6917 6918 6919 6921 6925 6926 6928 6929 6933 6934 6939 6940 6942 6943 6947
                                           6948 6953 6955 6956 6957
YBNUL. . . . . . .  C ADDR   1200H   R   SEG=MAIN   2965 2973#
YES. . . . . . . .  C ADDR   29B6H   R   SEG=MAIN   6767 6771 6775 6779 6797# 6860
YES0KEY. . . . . .  C ADDR   02B1H   R   SEG=MAIN   692 704#
YES0KEY1 . . . . .  C ADDR   02BEH   R   SEG=MAIN   711# 718
YESAVP . . . . . .  C ADDR   07B0H   R   SEG=MAIN   1354 1380#
YESBUF . . . . . .  C ADDR   0B0BH   R   SEG=MAIN   1912 1917#
YESIND . . . . . .  C ADDR   0A5CH   R   SEG=MAIN   1781 1790 1793 1796#
YESPRD . . . . . .  C ADDR   0B09H   R   SEG=MAIN   1911 1915#
YESTEST. . . . . .  C ADDR   215DH   R   SEG=MAIN   5244 5276#
YESTT5 . . . . . .  C ADDR   0BADH   R   SEG=MAIN   2005#
YESVICH. . . . . .  C ADDR   07F9H   R   SEG=MAIN   1368 1418#
YESVI_KM . . . . .  C ADDR   1D2FH   R   SEG=MAIN   4497 4577#
YESVI_KR . . . . .  C ADDR   1CA7H   R   SEG=MAIN   4497# 4499
YST1 . . . . . . .  C ADDR   0190H   R   SEG=MAIN   520 524#
YST19. . . . . . .  C ADDR   0188H   R   SEG=MAIN   517 521#
Z01S . . . . . . .  C ADDR   21E2H   R   SEG=MAIN   5393# 5395
Z05S . . . . . . .  C ADDR   21EFH   R   SEG=MAIN   5402# 5404
Z100 . . . . . . .  C ADDR   21B3H   R   SEG=MAIN   5357# 5359
Z15. . . . . . . .  C ADDR   21C1H   R   SEG=MAIN   5369# 5371
Z1S. . . . . . . .  C ADDR   21D5H   R   SEG=MAIN   5385# 5387
ZAPADC . . . . . .  C ADDR   2092H   R   SEG=MAIN   5126#
ZCMP . . . . . . .  C ADDR   26EAH   R   SEG=MAIN   6079#
ZDIV . . . . . . .  C ADDR   26B7H   R   SEG=MAIN   804 1114 1629 3822 6042#
ZER1 . . . . . . .  C ADDR   00B3H   A      7343 7347# 7402 7445
ZER2 . . . . . . .  C ADDR   00D4H   A      7369 7373#
ZMUL . . . . . . .  C ADDR   26ADH   R   SEG=MAIN   6037#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      324# 1704 3847 4769 4940 6050 6053 6056
ZNPLUS . . . . . .  C ADDR   02C8H   R   SEG=MAIN   673 720#
ZZ . . . . . . . .  C ADDR   21C3H   R   SEG=MAIN   5370# 5370
Z_01S. . . . . . .  C ADDR   21DEH   R   SEG=MAIN   2210 2211 2851 5091 5105 5391# 5908
Z_05S. . . . . . .  C ADDR   21EBH   R   SEG=MAIN   1999 2000 2678 3965 3973 3981 5400#
Z_100. . . . . . .  C ADDR   21B1H   R   SEG=MAIN   5356#
Z_15 . . . . . . .  C ADDR   21BFH   R   SEG=MAIN   641 5368#
Z_1MS. . . . . . .  C ADDR   21C8H   R   SEG=MAIN   711 5098 5375#
Z_1S . . . . . . .  C ADDR   21D1H   R   SEG=MAIN   630 638 1414 2315 3493 3766 3887 3939 4206 4290 4392 4574 4575
                                           5383#
Z_5. . . . . . . .  C ADDR   21BAH   R   SEG=MAIN   5162 5172 5363#
Z_9. . . . . . . .  C ADDR   2746H   R   SEG=MAIN   5119 6164#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
A51 MACRO ASSEMBLER  AMP31_1                                                              02/20/2007 15:11:19 PAGE   151

