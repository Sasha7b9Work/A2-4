A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp1_k4.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp1_k4.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236             
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                 jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     ;PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
                     291      ;P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
                     292     ;P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
                     293     ;P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
                     294     ;P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
                     295     ;PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
                     296     ;XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
                     297     ;XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
                     298     ;XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
                     299     
                     300     ;REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
                     301     ;DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
                     302     ;DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
                     303     ;DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
                     304     ;DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
                     305     ;DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
                     306     ;DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
                     307     ;PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
                     308     ;OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
                     309     ; EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
                     310     ;EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
                     311     ;ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
                     312     ;RSTSRC   DATA  0EFH   ; RESET SOURCE
                     313     ;EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
                     314     ;OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL 
                     315     ;P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
                     316       
                     317     ;EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
                     318     ;EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
                     319     ;WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                     320     ;CKCON    DATA  08EH   ; CLOCK CONTROL
                     321     ;PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  00CA               322     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     6

  00CB               323     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     324     ; SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
                     325     ; EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
                     326     ;SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
                     327     ;SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
                     328     ;P5             DATA  85H
                     329     ;P4       DATA  084H   ; PORT 4
                     330     ;P6       DATA  086H   ; PORT 6
                     331     
                     332     ;FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
                     333     ;FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
                     334     
                     335     
                     336     ;P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
                     337     
                     338     ;sbit TXBSY    =   SPI0CN ^ 3;       /* SPI 0 TX BUSY FLAG                      */
                     339     
                     340     
                     341     
                     342                                                     
                     343     Main         SEGMENT  CODE
                     344     
----                 345                                     DSEG
                     346       
  0040               347     bufind  DATA    40h;буффер индикации 12byte
                     348     ;DATA 4ch
  004F               349     abin            DATA    4fh;4byte
  0053               350     adec            DATA    53h;10byte
  006E               351     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               352     mabin           DATA    6fh
  0077               353     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               354     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               355     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       
  003C               356     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               357     movrig      DATA        3bh;крайне правое положение
  003A               358     movleft     DATA        3ah; крайне левое положение                  
                     359                     
                     360     
                     361     ;;;;;
  0020               362      cellbit                DATA    20h
  0000               363     bitznak         BIT     cellbit.0       ;20.0           
  0001               364     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               365     znmat           BIT             cellbit.2       ;20.2
  0003               366     bitrs           BIT             cellbit.3       ;20.3
  0004               367     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               368     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               369     bitvi11         BIT             cellbit.6       ;20.6   бит режима выч R
  0007               370     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us
                     371     
  0021               372     cellbit1                DATA    21h
  0008               373     bitbuf          BIT     cellbit1.0      ;21.0           
  0009               374     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               375     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               376     bitmem          BIT             cellbit1.3      ;21.3
  000C               377     bmem11          BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               378     bmem12          BIT             cellbit1.5      ;21.5    бит ПАМ12
  000E               379     bmem13          BIT             cellbit1.6      ;21.6   бит ПАМ13        
  000F               380     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     381     
  0022               382     cellbit2                DATA    22h
  0010               383     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               384     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               385     bitvi12         BIT             cellbit2.2      ;22.2  
  0013               386     bitvi13         BIT             cellbit2.3      ;22.3
  0014               387     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     7

  0015               388     bitvi21         BIT             cellbit2.5      ;22.5    
  0016               389     bitvi31         BIT             cellbit2.6      ;22.6   бит ПАМ13        
  0017               390     bitoll          BIT             cellbit2.7      ;22.7
                     391     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     392     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     393     ;и выдает т.н. буфер индикации  
  0023               394     cellbit3                DATA    23h
  0018               395     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               396     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               397     bitakt          BIT             cellbit3.2      ;22.2  бит такта
                     398     ;bit            BIT             cellbit3.3      ;22.3
                     399     ;bit            BIT             cellbit3.4      ;22.4    
                     400     ;bit            BIT             cellbit3.5      ;22.5    
                     401     ;bit            BIT             cellbit3.6      ;22.6            
                     402     ;bit            BIT             cellbit3.7      ;22.7
                     403             
  005E               404     rez_Ame   data 5eh;      (РЕЗ1-AN)*K
  0062               405     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               406     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               407     rez_A0  data 6ah;
  007B               408     rez_A2   data 7bh; A2
                     409     
  0098               410     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               411     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               412     chdel    data  83h              ; счетчик задержки
                     413     ;float
  0084               414     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               415     rezAp    data  88h              ;4byte  A+
  008C               416     rezAm    data  8ch              ;4byte  A-
  0090               417     koefKp   data  90h              ;4byte  K+
  0094               418     koefKm   data  94h              ;4byte  K-
                     419     ;hex 
  009A               420     parT     data  9ah              ;параметр времени измерения
  009B               421     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               422     rez_A3   data  9ch              ;A3
                     423     ;FLOAT
  00A0               424     koefKD  data  0a0h         ;KD
  00A4               425     constE  data  0a4h         ;E
  00A8               426     constF  data  0a8h         ;F
  00AC               427     chind   data  0ach         ;счетчик индикации
  00AD               428     chbuf   data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               429     diap    data  0aeh         ;номер диапазона
  00AF               430     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               431     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               432     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               433     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               434     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               435     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               436     work    data  0b8h        ;рабочая ячейка
  00BC               437     konstA  data  0bch        ;     введенная с крана константа A
  00C0               438     konstB  data  0c0h         ;    введенная с крана константа B
  00C4               439     nblok   data  0c4h         ;номер блока
                     440     ;data  0c5h
                     441     
                     442     ;внешнее ОЗУ 64K 
                     443     ;               XSEG AT 100h
                     444             PUBLIC    MASS0
  0080               445     MASS0  xdata 0080h;     массив измерения
  0084               446     MASS1  xdata 0084h;
  0088               447     MASS2  xdata 0088h;
  008C               448     MASS3  xdata 008ch;
  0090               449     MASS4  xdata 0090h;
  0094               450     MASS5  xdata 0094h;
  0098               451     MASS6  xdata 0098h;
  009C               452     MASS7  xdata 009ch;
  00A0               453     MASS8  xdata 00a0h;
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     8

  00A4               454     MASS9  xdata 00a4h;
                     455     ;xdata 0038h;
                     456     
  0000               457                             rr0             EQU 00
  0001               458                     rr1       equ   01
  0006               459                     rr6   equ 06
  0002               460                     rr2       equ   02
  0003               461                     rr3       equ   03
  0007               462                     rr7   equ 07
                     463     
  0008               464                     r8   equ 08
  0009               465                     r9        equ   09
  000A               466                     r10       equ   10
  000B               467                     r11   equ 11
                     468     
                     469                     
                     470        
----                 471                  rseg     Main          ; Switch to this code segment.
                     472     
                     473                  using    0              ; Specify register bank for the following
                     474     
0100                 475     org 100h
                     476     ;$EJECT
                     477     
0100 7581E0          478     begin:     mov  sp, #0e0h
0103 75E900          479                                             mov             PCA0L,#00;=0x00;
0106 75D900          480                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          481                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          482                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          483                                             mov     P2MDOUT,#00;=0x00;
                     484             
0112 75A73F          485             mov     P3MDOUT,#3fh;
0115 75B5FF          486             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          487             mov     REF0CN,#03h;=0x03;
                     488             
011B 75E114          489             mov     XBR0,#14h;= 0x14;
011E 75E200          490             mov     XBR1,#00; =0x00;
0121 75E300          491             mov XBR2,#00;=0x00;
0124 75B0C0          492             mov     P3,#0c0h
0127 75FFDE          493             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          494             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          495             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          496             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          497             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          498             mov     TL0,#0f9h;=0xf9; 
0139 75E680          499             mov     EIE1,#80h;=0x80;
                     500     
013C 75D480          501             mov     DAC0CN,#80h;=0x80;
013F 75D780          502             mov     DAC1CN,#80h;=0x80;
0142 75B167          503             mov     OSCXCN,#67h;=0x67;
                     504     
                     505      
                     506     
0145 E5B1            507     gener:     mov a, oscxcn
0147 B4E7FB          508                cjne a,#11100111b,gener
                     509                            
014A 75B288          510             mov     OSCICN,#88h;=0x84;
014D 75CA00          511         mov TMR2RLL,#0;=0;
0150 75CBD1          512         mov TMR2RLH,#0d1h;=0xd1;
                     513       
0153 D28E            514                     setb  TCON.6                    ;регистр управления
0155 D28C            515                      setb tcon.4
                     516     
0157 75EF00          517             mov     RSTSRC,#0;=00   ;//источники сброса 
                     518     
                     519             
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE     9

015A 75E340          520          mov        XBR2,#40h
015D 75E106          521              mov    XBR0,#06h;16h
0160 75F803          522             mov             SPI0CN,#03
0163 759D31          523             mov             spi0ckr,#31H;;;;;;;;#04
                     524     ;       mov             EIE2,#20H
0166 75E730          525             mov             EIE2,#30H;00110000
0169 75A880          526             mov     IE,#80h;//10000000      ;//Снятие блокировки всех прерываний
                     527     ;ozu
016C E4              528                             clr     a
016D 7800            529                             mov     r0,#00h 
016F F6              530     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
0170 08              531                             inc     r0
0171 B87FFB          532                             cjne    r0,#7fh,mecle
0174 7880            533                             mov     r0,#80h
0176 F6              534     meff:           mov     @r0,a 
0177 F2              535                             movx @r0,a
0178 08              536                             inc     r0
0179 B8DFFA          537                             cjne    r0,#0dfh,meff
017C 120000   F      538                             call    clmassix
017F 7898            539                             mov             r0,#chinkor
0181 7601            540                             mov             @r0,#1;0;02;600;
0183 08              541                             inc             r0
0184 7690            542                             mov             @r0,#90h;0c8h;58h;258h
                     543                             ;;;;
0186 7881            544                             mov             r0,#chavt
0188 7607            545                             mov             @r0,#07h;2eh
018A 08              546                             inc             r0
018B 76D0            547                             mov             @r0,#0d0h;0e0h
                     548     
018D 78B2            549                                     mov             r0,#marker
018F 76FF            550                                     mov             @r0,#0ffh
                     551                             ;mov            r0,#chind
                     552                             ;mov            @r0,#1
0191 74FF            553                             mov             a,#0ffh
0193 F585            554                        mov          p5,a
0195 799A            555                             mov             r1,#parT
0197 7702            556                             mov             @r1,#2                  ;Tizm=1s
0199 79AE            557                             mov             r1,#diap
019B 7705            558                             mov             @r1,#5                  ;10-7a
019D 79AF            559                             mov             r1,#parN
019F 7702            560                             mov             @r1,#2
01A1 7400            561                             mov             a,#00h
01A3 F585            562                             mov             p5,a
01A5 D204            563                             setb    bitizm
                     564     
01A7 799B            565                             mov             r1,#chbefore
01A9 7700            566                             mov             @r1,#0
                     567                             ;;;;;;
01AB 900000   F      568                             mov             dptr,#ch_1              ;1->r2..r5 float
01AE 120000   F      569                             call    ldc_long
01B1 7890            570                             mov             r0,#koefKp         ;1(float)->koefKp
01B3 120000   F      571                             call    saver2
01B6 7894            572                             mov             r0,#koefKm              ;1(float)->koefKm
01B8 120000   F      573                             call    saver2
01BB 78A0            574                             mov             r0,#koefKD
01BD 120000   F      575                             call    saver2  
                     576     ;START
                     577     ;                                       rez_A0=0;
                     578     ;        SUMM=0; //обнуление скользящего массива
                     579     ;        over_mas=0;
                     580     ;        count_mas=0;
                     581     
01C0 7840            582                             mov             r0,#bufind
01C2                 583     age2:
01C2 76FD            584                             mov             @r0,#0fdh         ;погасить индикатор
01C4 08              585                             inc             r0
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    10

01C5 B84CFA          586                             cjne    r0,#bufind+12,age2              
01C8 120000   F      587                             call    ind
01CB 120000   F      588                             call    z_1s
                     589     
                     590                                     ;зажечь все лементы индикации
01CE 7840            591                             mov             r0,#bufind
01D0 76FE            592     ageon:          mov             @r0,#0feh;?
01D2 08              593                             inc             r0
01D3 B84CFA          594                             cjne    r0,#bufind+12,ageon             
01D6 120000   F      595                             call    ind
01D9 120000   F      596                             call    z_1s            ;1sec
                     597     ;;;;;;;;;;;;;;;;
01DC 7840            598                             mov             r0,#bufind
01DE 7630            599                             mov             @r0,#30H;"A"
01E0 08              600                             inc             r0
01E1 7630            601                             mov             @r0,#30H;"В"
01E3 08              602                             inc             r0
01E4 7630            603                             mov             @r0,#30H;"Т"
01E6 08              604                             inc             r0
01E7 7634            605                             mov             @r0,#34H;2dh
01E9 08              606                             inc             r0
01EA 7635            607                             mov             @r0,#35H;"H"
01EC 08              608                             inc             r0
01ED 7636            609                             mov             @r0,#36h
01EF 08              610                             inc             r0
01F0 7637            611                             mov             @r0,#37h
01F2 08              612                             inc             r0
01F3 762D            613                             mov             @r0,#2dh
01F5 08              614                             inc             r0
01F6 7637            615                             mov             @r0,#37h
01F8 08              616                             inc             r0
01F9 7641            617                             mov             @r0,#"A";31h
01FB 08              618                             inc             r0
                     619                     
01FC 120000   F      620     dd:                     call    ind
01FF 120000   F      621                             call    z_15;z_1ms
                     622             ;       jmp             dd
                     623     ;;;;;;;;;;;;;;;;;;;
0202 7C60            624                             mov             r4,#60h;40h
0204 7D00            625                             mov             r5,#00h;04         
0206 120000   F      626                             call    iniacp;инициализация acp
0209 120000   F      627                             call    loadUS          ;us 10-7 A
                     628                             
020C C217            629     rebyte:         clr             bitoll
020E 3095FD          630                             jnb             p1.5,$
0211 2095FD          631                             jb              p1.5,$
0214 E586            632                             mov             a,P6            ;p6.4=0
0216 54EF            633                             anl             a,#0efh
0218 F586            634                             mov             P6,a
021A 00              635                             nop
021B 00              636                             nop
                     637                                     
021C E586            638                             mov             a,P6                    ;p6.4=1 
021E 4410            639                             orl             a,#10h
0220 F586            640                             mov             P6,a                        
0222 7411            641                             mov             a,#11h
0224 120000   F      642                             call    write
                     643                             ;чтение acp
0227 120000   F      644                             call    read    
022A F578            645                             mov     reacp+1,A       ;старший байт 
022C 120000   F      646                             call    read    
022F F579            647                             mov     reacp+2,A       ;средний байт 
0231 120000   F      648                             call    read
0234 F57A            649                             mov     reacp+3,A               ;мл байт
                     650                        ;;;;;;;;;;;
0236 7878            651                        mov          r0,#reacp+1
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    11

0238 E6              652                        mov          a,@r0
0239 20E72D          653                             jb              acc.7,znplus;
023C D200            654                             setb    bitznak
023E 4480            655                             orl             a,#80h  ;ост содерж яч 
0240 F6              656                             mov             @r0,a
                     657                                     
0241 18              658     mmm:            dec             r0;,#reacp
0242 76FF            659                             mov             @r0,#0ffh
0244 802B            660                             jmp             goznak
                     661     
                     662     
0246 750A00          663     labelA:         mov             r10,#0          
0249 750B00          664                             mov             r11,#0
024C 783D            665                             mov             r0,#chkl
024E 120000   F      666                             call    chcmp
0251 7000            667                             jnz             no0key
                     668                             ;разрешить ie6,ie7       
                     669                     ;       mov             EIE2,#30h ;EIE2.5,EIE2.4
                     670                     ;       mov             EIP2,#30h
                     671                        
0253 793D            672     no0key:         mov             r1,#chkl 
0255 120000   F      673                             call    chdec
0258 2004B1          674                             jb              bitizm,rebyte
                     675                              ;буфер 2 выдать на индикацию
                     676     ;3.11.06        
025B 120000   F      677                             call    ind
025E 120000   F      678                             call    z_01s
0261 120000   F      679                             call    z_01s
0264 120000   F      680                             call    z_01s
0267 80DD            681                             jmp             labelA
                     682     
0269 C200            683     znplus:         clr     bitznak
026B 547F            684                             anl             a,#7fh;fdh                      ;+
026D F6              685                             mov             @r0,a
026E 18              686                             dec             r0;,#reacp
026F 7600            687                             mov             @r0,#00h
                     688                             
0271                 689     goznak: 
                     690     ;;;;;;;;;;;;;
0271 787A            691                             mov     r0,#reacp+3
0273 E6              692                             mov             a,@r0
0274 7F05            693                             mov             r7,#5;6
0276 C3              694     sdvig3:         clr             c
0277 13              695                             rrc             a
0278 DFFC            696                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
027A FA              697                             mov             r2,a    ;сохр байт
027B 18              698                             dec             r0              ;       reacp+2
027C E6              699                             mov             a,@r0
027D C0E0            700                             push    acc
027F C3              701                             clr             c
0280 7F03            702                             mov             r7,#3;2
0282 C3              703     sdvig2:         clr             c
0283 33              704                             rlc             a
0284 DFFC            705                             djnz    r7,sdvig2 ;d12..d11      средний байт
0286 4A              706                             orl             a,r2
0287 F57A            707                             mov             reacp+3,a;сформ мл байт
0289 D0E0            708                             pop             acc
                     709                             
028B 7F05            710                             mov             r7,#5;6
028D C3              711     sdvig1:         clr             c
028E 13              712                             rrc             a
028F DFFC            713                             djnz    r7,sdvig1 ;d15,d14        ср байт
0291 FA              714                             mov             r2,a   ;сохр
0292 E578            715                             mov             a,reacp+1
0294 C0E0            716                             push    acc
                     717                     ;;      push    acc
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    12

0296 7F03            718                             mov             r7,#3;2
0298 C3              719     sdvig0:         clr             c
0299 33              720                             rlc             a
029A DFFC            721                             djnz    r7,sdvig0 ;       d21..d16
029C 4A              722                             orl             a,r2
029D F579            723                             mov             reacp+2,a       ; сформ средний  байт
029F D0E0            724                             pop             acc       ;reacp+1
                     725                             ;;;;;;;;;;;;;;
02A1 20E70B          726                             jb              acc.7,sdvm
02A4 C3              727                             clr             c
02A5 7F05            728                             mov             r7,#5;6
02A7 C3              729     sdvig4:         clr             c
02A8 13              730                             rrc             a
02A9 DFFC            731                             djnz    r7,sdvig4 ;       d23,d22
02AB F578            732                             mov             reacp+1,a
02AD 8008            733                             jmp             readyacp;ankor;klmas
                     734     ;;;;;;;;;;;;                                    
02AF 7F05            735     sdvm:           mov             r7,#5;6
02B1 D3              736     sdvig6:         setb            c
02B2 13              737                             rrc             a
02B3 DFFC            738                             djnz    r7,sdvig6 ;       d23,d22
02B5 F578            739                             mov             reacp+1,a
                     740                                                             
                     741     ; reacp..reacp+3-результат чтения асп(hex) 
                     742     ;;;;;;;;;
02B7                 743     readyacp:
02B7 789A            744                             mov             r0,#parT        ;параметр времени
02B9 793F            745                             mov             r1,#chmasN
02BB B60135          746                             cjne    @r0,#1,noparT1
                     747                             ;РЕЗ+РЕЗ                           ;10s-57отсчетов
02BE 7877            748                             mov             r0,#reacp
02C0 120000   F      749                             call    resar2          ;reacp->r2..r5
02C3 78B6            750                             mov             r0,#summa+3;rez_A+3
02C5 120000   F      751                             call    ladd
02C8 78B3            752                             mov             r0,#summa;rez_A
02CA 120000   F      753                             call    saver2
02CD 793F            754                              mov            r1,#chmasN
02CF 770A            755                             mov             @r1,#10
02D1 789B            756                             mov             r0,#chbefore
02D3 B63819          757                             cjne    @r0,#56,nobef99;99,nobef99
                     758                             ;РЕЗ/100
02D6 900000   F      759                             MOV        DPTR,#ch57;ch100 
02D9 120000   F      760     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
02DC 120000   F      761                             call    zdiv;divide
02DF 7862            762                             mov             r0,#rez_A
02E1 120000   F      763                             call    saver2          ;сумма 100 отсчетов /100
                     764                        ;;;;;
02E4 78B3            765                        mov          r0,#summa
02E6 120000   F      766                        call         clear4
                     767     ;                       mov             a,chmas
                     768     ;                       mov             @r1,a   ;->chmasN
02E9 799B            769                             mov             r1,#chbefore
02EB 7700            770                             mov             @r1,#0
02ED 8048            771                             jmp             klmas           ;загр в массив скользящее ср
02EF 06              772     nobef99:        inc             @r0                     ;chbefore
02F0 020000   F      773                             jmp             rebyte;labelA;метка A
                     774     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     775     ;а потом уже располагаем  в скользящий массив  из n
                     776     
                     777     
                     778     
02F3 B6021D          779     noparT1:        cjne    @r0,#2,noparT2
                     780                             ;РЕЗ+РЕЗ
02F6 7877            781                              mov            r0,#reacp
02F8 120000   F      782                             call    resar2          ;reacp->r2..r5
02FB 78B6            783                             mov             r0,#summa+3;rez_A+3
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    13

02FD 120000   F      784                             call    ladd
0300 78B3            785                             mov             r0,#summa;rez_A
0302 120000   F      786                             call    saver2
0305 789B            787                             mov             r0,#chbefore
0307 793F            788                             mov             r1,#chmasN
0309 770A            789                             mov             @r1,#10
030B B613E1          790                             cjne    @r0,#19,nobef99;9,nobef99
                     791                             ;РЕЗ/10
030E 900000   F      792                             MOV        DPTR,#ch20;ch10 
0311 80C6            793                             jmp             allsum
                     794                             ;;;;;;;
                     795                             
                     796     
0313 B60302          797     noparT2:        cjne    @r0,#3,noparT3
0316 8003            798                             jmp             aapar
                     799     
0318 B60410          800     noparT3:        cjne    @r0,#4,noparT4
031B 7877            801     aapar:          mov             r0,#reacp
031D 120000   F      802                             call    resar2          ;reacp->r2..r5
0320 7862            803                             mov             r0,#rez_A
0322 120000   F      804                             call    saver2
0325 793F            805                              mov            r1,#chmasN
0327 770A            806                             mov             @r1,#10
                     807                     ;       mov             @r1,#10         ;n=10
0329 800C            808                             jmp             klmas
032B 7702            809     noparT4:   mov          @r1,#2          ;chmasN n=2
032D 7877            810                             mov             r0,#reacp
032F 120000   F      811                             call    resar2          ;reacp->r2..r5
0332 7862            812                             mov             r0,#rez_A
0334 120000   F      813                             call    saver2
                     814     ;загрузить А в массив из 2/10 значений
                     815     ;;;;;;;;;;;;;;;
0337                 816     klmas:           
0337 793F            817                             mov             r1,#chmasN
0339 B70219          818                             cjne    @r1,#2,mas10
033C 900080          819                             MOV        dptr,#MASS0
033F 120000   F      820                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     821     
0342 7862            822                             mov             r0,#rez_A
0344 120000   F      823                             call    resar2          ;->r2..r5
0347 900080          824                             mov                     dptr,#MASS0
034A 120000   F      825                   call              saveIr2                 ; R2-R5 --> MAS0
                     826                     
034D 900087          827                   MOV          dptr,#MASS1+3
0350 120000   F      828                   CALL       addx
0353 8077            829                       jmp           endsum
0355 9000A0          830     mas10:          mov                     dptr,#MASS8
0358 120000   F      831                     CALL            xCIKLWR         ;MASS8->MASS9
035B 90009C          832                             mov                     dptr,#MASS7
035E 120000   F      833                     CALL            xCIKLWR         ;MASS7->MASS8
0361 900098          834                     MOV       dptr,#MASS6
0364 120000   F      835                     CALL       xCIKLWR         ; MASS6 --> MASS7
0367 900094          836                     MOV        dptr,#MASS5
                     837                    
036A 120000   F      838                    CALL        xCIKLWR        ; MASS5 --> MASS6
036D 900090          839                    MOV         dptr,#MASS4
                     840                    
0370 120000   F      841                    CALL        xCIKLWR        ; MASS4 --> MASS5
0373 90008C          842                             mov                     dptr,#MASS3
                     843     
0376 120000   F      844                    CALL             xCIKLWR         ;MASS3->MASS4
0379 900088          845                     MOV        dptr,#MASS2
                     846                    
037C 120000   F      847                    CALL        xCIKLWR         ; MASS2 --> MASS3
037F 900084          848                    MOV         dptr,#MASS1
                     849                     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    14

0382 120000   F      850                   CALL         xCIKLWR        ; MASS1 --> MASS2
0385 900080          851                    MOV         dptr,#MASS0
                     852                   
0388 120000   F      853                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     854     
                     855                             
038B 7862            856                             mov             r0,#rez_A
038D 120000   F      857                             call    resar2          ;->r2..r5
                     858                                     ;call   aform
0390 900080          859                                     mov                     dptr,#MASS0
0393 120000   F      860                   call              saveIr2                 ; R2-R5 --> MAS0
                     861              
0396 900087          862                   MOV          dptr,#MASS1+3
0399 120000   F      863                   CALL       addx
039C 90008B          864                   MOV          dptr,#MASS2+3
039F 120000   F      865                   CALL       addx
03A2 90008F          866                   MOV          dptr,#MASS3+3
03A5 120000   F      867                  CALL        addx
03A8 900093          868                   MOV       dptr,#MASS4+3
03AB 120000   F      869                   call       addx
03AE 900097          870                     MOV        dptr,#MASS5+3
03B1 120000   F      871                  CALL        addx
03B4 90009B          872                   MOV          dptr,#MASS6+3
03B7 120000   F      873                   CALL       addx
03BA 90009F          874                   MOV          dptr,#MASS7+3
03BD 120000   F      875                  CALL        addx
03C0 9000A3          876                  MOV        dptr,#MASS8+3
03C3 120000   F      877                   call       addx
03C6 9000A7          878                     MOV                     dptr,#MASS9+3
03C9 120000   F      879                  call        addx
                     880             ;23.03          
03CC                 881     endsum:
03CC 786E            882                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
03CE 06              883                                     inc             @r0
03CF E6              884                                     mov             a,@r0   
03D0 200105          885                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                     886                                     
03D3 B53F1B          887                                     cjne    a,chmasN,masx5
03D6 D201            888                                     setb    bitmas                  ;массив заполнен
03D8 853F6E          889     masfull:                mov             chmas,chmasN
03DB 783F            890                                     mov             r0,#chmasN
03DD E6              891                                     mov             a,@r0
                     892     ;masfull:
03DE B40208          893                                     cjne    a,#2,nochn2
03E1 900000   F      894                                     MOV        DPTR,#ch2;10 
03E4 120000   F      895                                     CALL   ldc_ltemp                 ; ltemp <-- 2
03E7 8012            896                                     jmp             mas5div
                     897     
03E9 900000   F      898     nochn2:                 MOV        DPTR,#ch10 
03EC 120000   F      899                                     CALL   ldc_ltemp                 ; ltemp <-- 10
03EF 800A            900                                     jmp             mas5div
                     901     
03F1 856E0B          902     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
03F4 E4              903                                     clr     a
03F5 F50A            904                                     mov     ltemp+2,a
03F7 F509            905                                     mov     ltemp+1,a
03F9 F508            906                                     mov     ltemp,a
                     907     
03FB                 908     mas5div:
03FB 120000   F      909                                     CALL       zdiv;divide                           ; R2-R5 =
                     910                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                     911     
                     912                             
                     913      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    15

                     914     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     915     ;получен результат 3 байта и знак
03FE 7866            916                             mov             r0,#rez_A1
0400 120000   F      917                             call    saver2           ;сохр среднее по массиву
                     918     ;;8.11.06                       mov             chmasN,#0
                     919      ;;;;;;;;;;;;
                     920      ;;;;;;;;;;;;
0403 C3              921                             clr             c
0404 799A            922                             mov             r1,#parT
0406 7402            923                             mov             a,#2
0408 97              924                             subb    a,@r1
0409 5007            925                             jnc             ankor           ;T<3
                     926                             ;A-=РЕЗ1                                ;T>3
040B 785E            927                             mov             r0,#rez_Ame
040D 120000   F      928                             call    saver2
0410 8025            929                             jmp             gotoKD
                     930     
0412                 931     ankor:  ;       mov             r10,#0          
                     932                     ;       mov             r11,#0
0412 7898            933                             mov             r0,#chinkor
0414 E6              934                             mov             a,@r0
0415 30E703          935                             jnb             acc.7,nokorr
                     936                     ;       call    chcmp
                     937                     ;       jnc             nokorr
                     938                             ;коррекция 0
0418 020000   F      939                             jmp             kornul
041B 750A00          940     nokorr:         mov             r10,#00         ;       chavt
041E 750B00          941                             mov             r11,#00h
0421 7881            942                             mov              r0,#chavt      
0423 120000   F      943                             call    chcmp           ;сравн счетчик авто калибровки с 0h
0426 703D            944                             jnz             nonulavt        
0428 750A01          945                             mov             r10,#1;00;02            
042B 750B90          946                             mov             r11,#90h;0c8h;58h
042E 7898            947                             mov             r0,#chinkor
0430 120000   F      948                             call    chcmp
0433 7048            949                             jnz             noavk
                     950                             ;автокалибровка
0435 8046            951                             jmp     noavk;  autoka
                     952     ;;;;;;;;;;
0437 C3              953      gotoKD:                clr             c
0438 799A            954                             mov             r1,#parT
043A 7404            955                             mov             a,#4
043C 97              956                             subb    a,@r1
043D 5072            957                             jnc             afterK          ;T<5
                     958                             ;A1-=A- *KD                     ;T>5
                     959                             
043F 785E            960                             mov             r0,#rez_Ame;->r2..r5   ???????????/
0441 120000   F      961                             call    resar2
0444 120402          962                             call    altof   ;r2..r5->float          
0447 120000   F      963                             call    loadKD;mov              r0,#koefKD;->r8..r11
                     964                             ;call   resar8
044A 120203          965                             call    flmul
044D 120343          966                             call    ftol                    ;float->int
0450 7866            967                             mov             r0,#rez_A1
0452 120000   F      968                             call    saver2
0455 786A            969                             mov             r0,#rez_A0;->r8..r11 hex
0457 120000   F      970                             call    resar8
045A 120000   F      971                             call    lsub            ;A3=A-1-A0
045D 789C            972                             mov             r0,#rez_A3
045F 120000   F      973                             call    saver2
0462 020000   F      974                             jmp             labelB  
                     975      ;;;;;;;;;;; 9.11.06
0465 789A            976     nonulavt:        mov            r0,#parT
0467 E6              977                             mov             a,@r0
0468 6401            978                             xrl             a,#01
046A 700C            979                             jnz             avtdec1
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    16

046C 7982            980                             mov             r1,#chavt+1     ;T=1 chavt-10
046E 120000   F      981                             call    tenmin
0471 7999            982     kordec10:       mov             r1,#chinkor+1
0473 120000   F      983                             call    tenmin
0476 8013            984                             jmp             rezmul
                     985     
0478 7981            986     avtdec1:        mov             r1,#chavt       
047A 120000   F      987                             call    chdec           ;chavt-1
                     988     ;                       jmp             kordec1;rezmul
047D 789A            989     noavk:          mov             r0,#parT
047F E6              990                             mov             a,@r0
0480 6401            991                             xrl             a,#01
0482 7002            992                             jnz             kordec1
                     993                             ;T=1 chinkor-10
0484 8005            994                             jmp             rezmul
0486 7998            995     kordec1:        mov             r1,#chinkor
0488 120000   F      996                             call    chdec           ; chinkor-1
                     997                        ;9.11.06
                     998                             ;;;;;;;;;;;;;;
                     999                             ;;;;;;;;;;;;;
                    1000     ;(РЕЗ1-АN)*K
048B                1001     rezmul:
048B 7866           1002                             mov             r0,#rez_A1;->r2..r5
048D 120000   F     1003                             call    resar2
0490 120402         1004                             call    altof   ;r2..r5->float  6.06    
0493 7884           1005                             mov             r0,#kor0_AN;->r8..r11
0495 120000   F     1006                             call    resar8
                    1007                             ;;call  altof   ;r2..r5->float
0498 1201D1         1008                             call    flsub
049B 7890           1009                             mov             r0,#koefKp;->r8..r11
049D EA             1010                             mov             a,r2
                    1011                             ;jnb            acc.7,nminus
049E 300002         1012                             jnb             bitznak,nminus
                    1013                     
04A1 7894           1014                             mov             r0,#koefKm;->r8..r11
04A3 120000   F     1015     nminus:         call    resar8
04A6 120203         1016                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
                    1017                     
04A9 120343         1018                             call    ftol                    ;float->int
04AC 785E           1019                             mov             r0,#rez_Ame
04AE 120000   F     1020                             call    saver2
                    1021      ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1022      ;;;;;;;;;;;;;;;;;;;;;;;;;;
04B1                1023     afterK:                 
                    1024     ;;;;;;;;;;;;;;
04B1 120402         1025                                     call    altof                   ;r2..r5->float
04B4 EA             1026                                     mov             a,r2
04B5 547F           1027                                     anl             a,#7fh
04B7 FA             1028                                     mov             r2,a
04B8 900000   F     1029                                     mov     dptr,#ch_220;220000
04BB 120000   F     1030                                     call    ldc_ltemp                       ;r8..r11=8
04BE 1201D6         1031                                     call    flcmp
                    1032                             ;       jnc             rmo220          ;A>220000
04C1 785E           1033                                     mov             r0,#rez_Ame
04C3 120000   F     1034                                     call    resar2
04C6 120402         1035                                     call    altof                   ;r2..r5->float
04C9 120000   F     1036                                     call    loadKD;mov              r0,#koefKD              ;KD
                             ->r8..r11
                    1037                                     
04CC 120203         1038                                     call    flmul     ;A1-=A-*KD  fl
                    1039                                     
04CF 120343         1040                                     call    ftol                    ;float->int
04D2 7866           1041                                     mov             r0,#rez_A1
04D4 120000   F     1042                                     call    saver2
04D7 120402         1043                                     call    altof                   ;r2..r5->float
04DA 900000   F     1044                                     mov     dptr,#ch_200;200000
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    17

04DD 120000   F     1045                                     call    ldc_ltemp                       ;r8..r11=8
04E0 1201D6         1046                                     call    flcmp
                    1047                                     ;jnc            mo220           ;A>200000
04E3 301806         1048                                     jnb             knizm,goA2;             bitizm,goA2     
04E6 200526         1049                                     jb              bitavp,yesavp   
04E9 200650         1050     noavp:                  jb              bitvi11,yesvich
04EC                1051     goA2:                    ;A2=A1-
04EC 7866           1052                                      mov            r0,#rez_A1
04EE 120000   F     1053                                     call    resar2
04F1 787B           1054                                     mov             r0,#rez_A2
04F3 120000   F     1055                                     call    saver2
04F6                1056     goA3A2:                  ;A3=A2-A0
04F6 786A           1057                                       mov           r0,#rez_A0
04F8 120000   F     1058                                     call    resar8
04FB 120000   F     1059                                     call    lsub
04FE 789C           1060                                     mov             r0,#rez_A3
0500 120000   F     1061                                     call    saver2
                    1062                                     ;;;;;;
0503                1063     goonin:            ;jmp         goonind;indA3;8.11.06
0503 78AC           1064                                     mov             r0,#chind
0505 B60005         1065                                     cjne    @r0,#0,rnochi0
0508 020000   F     1066                                     jmp             goonind;indA3
                    1067     ;                               clr             P3.4
                    1068     ;                               nop
                    1069     ;                               nop
                    1070     ;                               setb    P3.4      ;??????????????????????/
                    1071     ;                               jmp             nop3_0
                    1072     
                    1073     ;                               jb              P3.0,nop3_0     ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1074     ;                               mov             r0,#rez_A0              ;r2..r5->rez_A0
                    1075     ;                               call    saver2                  ;ЗАПОМНИТЬ СМЕЩЕНИЕ НУЛЯ
                    1076     ;                               jmp             rebyte          ;age2
050B 804B           1077      rmo220:                jmp             mo220
050D 8078           1078      rnochi0:               jmp             nochi0
                    1079     
                    1080     ;;;;;;;;;;;;;;;;
050F EA             1081     yesavp:                 mov             a,r2
0510 547F           1082                                     anl             a,#7fh
0512 FA             1083                                     mov             r2,a
0513 900000   F     1084                                     mov     dptr,#ch_10th;10000
0516 120000   F     1085                                     call    ldc_ltemp                       ;r8..r11=8
0519 1201D6         1086                                     call    flcmp
051C 50CB           1087                                     jnc             noavp           ;A>10000        
051E 78AE           1088                                     mov             r0,#diap                ;10-11
0520 B60902         1089                                     cjne    @r0,#9,avpgo
0523 80C4           1090                                     jmp             noavp
0525                1091     avpgo:                  
0525 06             1092                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
0526 B60A01         1093                                     cjne    @r0,#0ah,clmasv
0529 16             1094                                     dec             @r0
052A                1095     clmasv:         ;сбросить массив
052A 120000   F     1096                             call    loadUS
                    1097                             ;call   louizm
052D 120000   F     1098                             call     clmassix
0530 78B3           1099                                     mov             r0,#summa
0532 120000   F     1100                                     call    clear4
0535 786A           1101                                     mov             r0,#rez_A0
0537 120000   F     1102                                     call    clear4                                             
                                                   
053A 80C7           1103                                jmp     goonin
                    1104     
053C                1105     yesvich:        ;A2=E/A1-+F
053C 78A4           1106                                      mov            r0,#constE
053E 120000   F     1107                                     call    resar2
0541 7866           1108                                       mov           r0,#rez_A1
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    18

0543 120000   F     1109                                     call    resar8
0546 1202B7         1110                                     call    fldiv
0549 78A8           1111                                      mov    r0,#constF
054B 120000   F     1112                                     call    resar8
054E 120166         1113                                     call    fladd
0551 787B           1114                                     mov             r0,#rez_A2
0553 120000   F     1115                                     call    saver2
0556 809E           1116                                     jmp             goA3A2
                    1117     
0558 300508         1118     mo220:             jnb          bitavp,indoll
055B 301805         1119                                jnb          knizm,indoll;bitizm,indoll
055E 78AE           1120                                     mov             r0,#diap
0560 B6000A         1121                                     cjne    @r0,#0,nodi2
                    1122                                ;10-2
0563 900000   F     1123     indoll:                 mov             dptr,#teOLL;OLL
0566 120000   F     1124                                     call    lotext
0569 D217           1125                                     setb    bitoll
056B 8096           1126                                     jmp             goonin  
                    1127     
056D 16             1128     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1129     
056E B6FF01         1130                                     cjne    @r0,#0ffh,nodi9
0571 06             1131                                     inc             @r0
                    1132     
0572 120000   F     1133     nodi9:          call    loadUS
                    1134                                     ;call   louizm
                    1135                                     ;сбросить массив
0575 120000   F     1136                                     call     clmassix
0578 78B3           1137                                     mov             r0,#summa
057A 120000   F     1138                                     call    clear4
057D 786A           1139                                     mov             r0,#rez_A0
057F 120000   F     1140                                     call    clear4  
0582 D207           1141                                     setb    bitzus  ;флаг задержки  после установки us         
                                                                   
0584 020000   F     1142                                jmp     goonin
                    1143     
0587 16             1144     nochi0:                 dec             @r0                     ;СТИ-1
0588 020000   F     1145                                     jmp             labelB  
                    1146     
                    1147             
                    1148     ;;;;;;;;;;;;;;;
                    1149     
058B                1150     nop3_0: ;;      ;rez_A-rez_A0
                    1151                     ;;                      mov             r0,#rez_A0
                    1152                     ;;                      call    resar8
                    1153                     ;;                      call    lsub
                    1154                     ;;                      mov             r0,#rez_A
                    1155                     ;;;                     call    saver2
                    1156      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
058B 789C           1157      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
058D 120000   F     1158                                             call    resar2
0590 900000   F     1159                                             mov             dptr,#ch100              
0593 120000   F     1160                                             call    ldc_ltemp        
0596 120000   F     1161                                             call    zdiv            ;rez_A3/100=r2..r5
                    1162                                     
0599 EC             1163                                             mov             a,r4
059A 20E71E         1164                                             jb              acc.7,aless0
059D 4408           1165                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
059F F5D3           1166                                             mov             DAC0H,a
                    1167                                                                             ;мл байт
05A1 ED             1168                                             mov             a,r5
05A2 F5D2           1169                                             mov             DAC0L,a
05A4 801E           1170                                             jmp             moveA3;
                    1171     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    19

05A6 B70207         1172     no3parN:                        cjne    @r1,#2,no2parN
                    1173                                             ;в байт 0  записать пробел
05A9 7946           1174                                             mov             r1,#bufind+6
05AB 7720           1175                                             mov             @r1,#" ";0fdh;
05AD 020000   F     1176                                             jmp             seeind;moveA3
                    1177     
05B0                1178     no2parN:                        ;в байты 0 и 1 записать пробел
05B0 7945           1179                                             mov             r1,#bufind+5
05B2 7720           1180                                             mov             @r1,#" ";0fdh;" "
05B4 09             1181                                             inc             r1
05B5 7720           1182                                             mov             @r1,#" ";0fdh;" "
05B7 807B           1183                                             jmp             seeind;moveA3
05B9 8079           1184      rseeind:               jmp             seeind
05BB F4             1185     aless0:                         cpl             a
05BC 54F7           1186                                             anl             a,#0f7h         ;d11=0
05BE F5D3           1187                                             mov             DAC0H,a
                    1188                                                                             ;мл байт
05C0 ED             1189                                             mov             a,r5
05C1 F4             1190                                             cpl             a
05C2 F5D2           1191                                             mov             DAC0L,a
05C4                1192     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1193                                     
                    1194                                             
05C4                1195     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1196                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1197                     ;до конца цикла измерения результат не размещать в буфере
                    1198                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1199                     ;и возврату в режим измерения
05C4 201458         1200                                             jb              bitvich,rnorvich
05C7 201055         1201                                             jb              bitt2,rnorvich
05CA 2017EC         1202                                             jb              bitoll,rseeind
                    1203             
                    1204     ;;;;;;;;;;;;;;
05CD 789C           1205                                              mov            r0,#rez_A3
05CF 120000   F     1206                                             call    resar2
05D2 120343         1207                                             call    ftol                    ;float->int r2..r5
                    1208     ;;;;;;;;
05D5 789C           1209                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
05D7 120000   F     1210                                             call    resar2
                    1211                                     
05DA 120000   F     1212                                             call    maform
05DD 784F           1213                                             mov             r0,#abin
05DF 120000   F     1214                                             call    saver2
                    1215     ;;;;;;;;
                    1216                                             
05E2 7853           1217                                             mov             r0,#adec
05E4 7952           1218                                             mov             r1,#abin+3      ;hex->10
05E6 120000   F     1219                                             call    bindec
                    1220                                     
05E9 785C           1221                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
05EB 7946           1222                                             mov             r1,#bufind+6
05ED 7F07           1223                                             mov             r7,#7
05EF E6             1224     bufdec:                         mov             a,@r0
05F0 2430           1225                                             add             a,#30h
05F2 F7             1226                                             mov             @r1,a
05F3 19             1227                                             dec             r1
05F4 18             1228                                             dec             r0
05F5 DFF8           1229                                             djnz    r7,bufdec
05F7 7847           1230                                             mov             r0,#bufind+7
05F9 762D           1231                                             mov             @r0,#2dh
05FB 7840           1232                                             mov             r0,#bufind
05FD 762B           1233                                             mov             @r0,#2bh
05FF 300202         1234                                             jnb             znmat,nozzmi;bitznak,nozzmi
0602 762D           1235                                             mov             @r0,#2dh
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    20

0604 79AE           1236     nozzmi:                         mov             r1,#diap
0606 7848           1237                                             mov             r0,#bufind+8
0608 E7             1238                                             mov             a,@r1
0609 B40808         1239                                             cjne    a,#8,nodi8
060C 7630           1240                                             mov             @r0,#30h
060E 18             1241                                             dec             r0
060F 7663           1242                                             mov             @r0,#63h;31h
0611 08             1243                                             inc             r0
0612 8012           1244                                             jmp             seegoon
0614 B4090C         1245     nodi8:                          cjne    a,#9,nodis9
0617 7631           1246                                             mov             @r0,#31h
0619 18             1247                                             dec             r0
061A 7663           1248                                     mov             @r0,#63h;31h
                    1249                                     
061C 08             1250                                             inc             r0
061D 8007           1251                                             jmp             seegoon
                    1252     
061F 8051           1253     rnorvich:               jmp             norvich
0621 8083           1254     rno3parN:               jmp             no3parN
                    1255     
0623 2432           1256     nodis9:                         add             a,#32h
0625 F6             1257                                             mov             @r0,a;#37h;"T";
0626 08             1258     seegoon:                        inc             r0
0627 7641           1259                                             mov             @r0,#"A";"E";
0629 08             1260                                             inc             r0
062A 7600           1261                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
062C 08             1262                                             inc             r0;             mov             buf
                             ind+11
062D 76C0           1263                                             mov             @r0,#0c0h
                    1264     ;;;;;;;;;;;;;;;
                    1265     ;;;;;;goonind:
062F 79AF           1266                                             mov             r1,#parN        ; ??????
0631 B703ED         1267                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1268                                     
                    1269             
0634                1270     seeind:                         ;;;;;;;;;;;;;
0634 784A           1271                                             mov             r0,#bufind+10
0636 E6             1272                                             mov             a,@r0
0637 300F03         1273                                             jnb             bitnul,nnnul
063A 4408           1274                                             orl             a,#08h
063C F6             1275                                             mov             @r0,a
063D 799A           1276      nnnul:                         mov             r1,#parT
063F B70304         1277                                             cjne    @r1,#3,nsec01
0642 4410           1278                                             orl             a,#10h
0644 800C           1279                                             jmp             nsec10   ;0,1s
0646 B70204         1280      nsec01:                        cjne    @r1,#2,nsec1
0649 4420           1281                                             orl             a,#20h    ;1s
064B 8005           1282                                             jmp             nsec10
064D B70102         1283     nsec1:                          cjne    @r1,#1,nsec10
0650 4440           1284                                             orl             a,#40h
                    1285     
                    1286     ;;;;;;;;;;;;;;;;
0652 F6             1287     nsec10:                         mov             @r0,a
0653 300504         1288                                             jnb             bitavp,nobavp
0656 4404           1289                                             orl             a,#04           ;bufind+10.2
0658 F6             1290                                             mov             @r0,a
0659 F6             1291                                             mov             @r0,a   
065A 301803         1292     nobavp:                    jnb          knizm,nobitizm
065D 4402           1293                                             orl             a,#02
065F F6             1294                                              mov            @r0,a
0660                1295     nobitizm:                       
0660 301A07         1296                                             jnb             bitakt,notakt
0663 C21A           1297                                             clr             bitakt
0665 534AFE         1298                                             anl             bufind+10,#0feh
0668 8005           1299                                             jmp             taktind
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    21

066A D21A           1300     notakt:                         setb    bitakt
066C 434A01         1301                                             orl             bufind+10,#01                      
                                          
066F 120000   F     1302     taktind:                        call    ind        ;пп выдачи на индикатор
0672                1303     norvich: 
0672 789A           1304                                     mov             r0,# parT
0674 79AC           1305                                             mov             r1,#chind
0676 B60177         1306                                             cjne    @r0,#1,rnot1in
0679                1307     labelB:                    ;;;;;;;;;;;
                    1308                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
0679 789F           1309                                                     mov     r0,#rez_A3+3
                    1310                             ;;;;;;;;
067B 79BB           1311                             mov             r1,#work+3
067D E6             1312                             mov             a,@r0
067E 7F07           1313                             mov             r7,#7;кол сдв вправо
0680 C3             1314     dvig3:          clr             c
0681 13             1315                             rrc             a
0682 DFFC           1316                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
0684 FA             1317                             mov             r2,a    ;сохр байт
0685 18             1318                             dec             r0              ;rez_A3+2
0686 E6             1319                             mov             a,@r0
0687 C0E0           1320                             push    acc
0689 C3             1321                             clr             c
068A 7F01           1322                             mov             r7,#1
068C C3             1323     dvig2:          clr             c
068D 33             1324                             rlc             a
068E DFFC           1325                             djnz    r7,dvig2 ;d12..d11       средний байт
0690 4A             1326                             orl             a,r2
0691 F7             1327                             mov             @r1,a;сформ мл байт
0692 19             1328                             dec             r1
0693 D0E0           1329                             pop             acc
                    1330                             
0695 7F07           1331                             mov             r7,#7
0697 C3             1332     dvig1:          clr             c
0698 13             1333                             rrc             a
0699 DFFC           1334                             djnz    r7,dvig1 ;d18     ср байт
069B FA             1335                             mov             r2,a   ;сохр
069C 18             1336                             dec             r0
069D E6             1337                             mov             a,@r0 ;rez_A3+1
069E C0E0           1338                             push    acc
                    1339                     
06A0 7F01           1340                             mov             r7,#1
06A2 C3             1341     dvig0:          clr             c
06A3 33             1342                             rlc             a
06A4 DFFC           1343                             djnz    r7,dvig0 ;        d21..d16
06A6 4A             1344                             orl             a,r2
06A7 F7             1345                             mov             @r1,a   ; сформ средний  байт
06A8 19             1346                             dec             r1
06A9 D0E0           1347                             pop             acc       ;rez_A3+1
                    1348                             ;;;;;;;;;;;;;;
                    1349     ;                       jb              acc.7,dvm
06AB C3             1350                             clr             c
06AC 7F07           1351                             mov             r7,#7
06AE C3             1352     dvig4:          clr             c
06AF 13             1353                             rrc             a
06B0 DFFC           1354                             djnz    r7,dvig4 ;        d22
06B2 FA             1355                             mov             r2,a   ;сохр
06B3 18             1356                             dec             r0;     rez_A3
06B4 E6             1357                             mov             a,@r0
                    1358                             ;;;;;
06B5 7F01           1359                             mov             r7,#1
06B7 C3             1360     vig0:           clr             c
06B8 33             1361                             rlc             a
06B9 DFFC           1362                             djnz    r7,vig0 ;         d24..d30
06BB 4A             1363                             orl             a,r2
06BC F7             1364                             mov             @r1,a   ; сформ   байт
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    22

06BD 19             1365                             dec             r1
06BE E6             1366                             mov             a,@r0
                    1367                             ;;;;;
06BF 20E709         1368                             jb              acc.7,dvm
06C2 C3             1369                             clr             c
06C3 7F07           1370                             mov             r7,#7
06C5 C3             1371     vig4:           clr             c
06C6 13             1372                             rrc             a
06C7 DFFC           1373                             djnz    r7,vig4 ;         d
06C9 8006           1374                             jmp             endsdv
                    1375     ;;;;;;;;;;;;                                    
06CB 7F07           1376     dvm:            mov             r7,#7
06CD D3             1377     dvig6:          setb            c
06CE 13             1378                             rrc             a
06CF DFFC           1379                             djnz    r7,dvig6 ;        d31
06D1 F7             1380     endsdv:         mov             @r1,a
                    1381                                                             
                    1382      ;->work   
                    1383                             
06D2 900000   F     1384                             mov             dptr,#chzap
06D5 120000   F     1385                             call     ldc_long
06D8 78BB           1386                              mov            r0,#work+3
06DA 120000   F     1387                             call    ladd
06DD ED             1388                             mov             a,r5
06DE F5D5           1389                             mov             DAC1L,a
                    1390                             
06E0 EC             1391                             mov             a,r4
06E1 F5D6           1392                             mov             DAC1H,a
                    1393     
                    1394                                             ;;;;;;;;;;
06E3 78AD           1395                                             mov             r0,#chbuf         ;T=1
06E5 B6002F         1396                                             cjne    @r0,#0,nobuf0
06E8 200907         1397                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
06EB 200A06         1398                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
06EE 801A           1399                                             jmp             gocikle
06F0 8028           1400     rnot1in:                jmp             not1in
06F2                1401     yesprd: ;передать   A3 в буфер
06F2 8000           1402                                             jmp             goonT
06F4                1403     yesbuf: ;записать   A3 в буфер
06F4 789A           1404     goonT:                          mov             r0,#parT
06F6 79AD           1405                                             mov             r1,#chbuf
06F8 B60102         1406                                             cjne    @r0,#1,nott1
                    1407                                     ;       mov             @r1,#
06FB 800D           1408                                             jmp             gocikle
                    1409     
06FD B60502         1410     nott1:                          cjne    @r0,#5,nott5
                    1411     
0700 8008           1412                                             jmp             gocikle
                    1413     
0702 C3             1414     nott5:           clr            c
0703 799A           1415                             mov             r1,#parT
0705 7404           1416                             mov             a,#4
0707 97             1417                             subb    a,@r1
0708 500B           1418                             jnc             yestt5          ;T<5
070A 300805         1419     gocikle:        jnb             bitbuf,nofz                                     
070D 120000   F     1420                             call    z_01s    ;0,5c
0710 C208           1421                             clr     bitbuf
0712 020000   F     1422     nofz:           jmp     labelA;rebyte
                    1423     
                    1424     
0715 80F3           1425     yestt5:         jmp             gocikle
                    1426     
0717 16             1427     nobuf0:                         dec             @r0
0718 80F0           1428                                             jmp             gocikle
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    23

                    1429     
                    1430     
071A B60205         1431     not1in:                         cjne    @r0,#2,not2in
071D 7701           1432                                             mov             @r1,#1           ;T=2
071F 020000   F     1433                                             jmp     labelB
                    1434     
0722 B60305         1435     not2in:                         cjne    @r0,#3,not3in
0725 7709           1436                                             mov             @r1,#9          ;T=3
0727 020000   F     1437                                             jmp     labelB
072A 7713           1438     not3in:                         mov             @r1,#19
072C 020000   F     1439                                             jmp     labelB
                    1440     
                    1441     
                    1442     ;;;;;;;;;;;3.11.06
                    1443     
                    1444     ;;коррекция 0
072F 7883           1445     KORnul:         mov             r0,#chdel
0731 B60008         1446                             cjne    @r0,#0,nonuldel
                    1447                                     
                    1448                     ;       mov             a,P5       ;p5.3=1
                    1449                     ;       orl             a,#08
                    1450                     ;       mov             P5,a
                    1451                     ;       nop
                    1452                     ;       nop
                    1453                                     
                    1454                     ;       mov             a,P5              ;p5.0=0
                    1455                     ;       anl             a,#0feh
                    1456                     ;       mov             P5,a
                    1457             
0734 900000   F     1458                             mov             dptr,#kor0us
0737 120000   F     1459                             call    lospus          ;упр слово коррекции 0
073A 8013           1460                             jmp             chdelmo
                    1461     
073C B60716         1462     nonuldel:       cjne    @r0,#7,no4del
                    1463                             ;рез ->AN
073F 7862           1464                             mov             r0,#rez_A;->r2..r5
0741 120000   F     1465                             call    resar2
                    1466                     ;       mov             a,reacp         ;r2..r5 &&&&&&&&&&&
                    1467                     ;               mov             r2,a
                    1468                     ;               mov             a,reacp+1
                    1469                     ;               mov             r3,a
                    1470                     ;               mov             a,reacp+2
                    1471                     ;               mov             r4,a
                    1472                     ;               mov             a,reacp+3
                    1473                     ;               mov             r5,a
                    1474                                     ;;;;;;;;;;
0744 120402         1475                             call    altof           ;r2..r5->float
0747 7884           1476                             mov             r0,#kor0_AN;->kor0_AN
0749 120000   F     1477                             call    saver2
                    1478                                     
                    1479                     ;       mov             a,P5            ;p5.0=1
                    1480                     ;       orl             a,#01
                    1481                     ;       mov             P5,a
                    1482                     ;       nop
                    1483                     ;       nop
                    1484                                     
                    1485                     ;       mov             a,P5                    ;p5.3=0 
                    1486                     ;       anl             a,#0f7h
                    1487                     ;       mov             P5,a                    
074C 120000   F     1488                             call    loadUS          ;восстан исходное упр слово
074F 7883           1489     chdelmo:        mov             r0,#chdel
0751 06             1490                             inc             @r0             ;chdel+1
0752 020000   F     1491                             jmp              rebyte
                    1492     
0755 B60EF7         1493     no4del:         cjne    @r0,#14,chdelmo
0758 7600           1494                             mov             @r0,#0          ;chdel
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    24

075A 7898           1495                             mov             r0,#chinkor
075C 7601           1496                             mov             @r0,#1;00;02;600;
075E 08             1497                             inc             r0
075F 7690           1498                             mov             @r0,#90h;0c8h;58h;258h
0761 120000   F     1499                             call    clmassix;сбросить массив скольз среднего
0764 020000   F     1500                             jmp              rebyte
                    1501     
                    1502     ;автокалибровка
0767                1503     autoka:  ;;  mov                r0,#chavt
                    1504                      ;;  call               chcmp
                    1505                      ;;  jz         nulavt
                    1506                     ;;   mov                r1,#chavt
                    1507                     ;;   call               chdec;chavt-1
                    1508                      ;; jmp         rebyte
0767                1509     nulavt:  ;;;;;
0767 7883           1510                             mov             r0,#chdel
0769 B6000C         1511                             cjne    @r0,#0,nndelch
076C 438508         1512                             orl             P5,#08             ;p5.3=1
076F 00             1513                             nop
0770 00             1514                             nop
0771 5385FD         1515                             anl             P5,#0fdh                ;p5.1=0
0774 06             1516                             inc             @r0
0775 020000   F     1517                             jmp              rebyte
                    1518     
0778 B6643D         1519     nndelch:        cjne    @r0,#100,n4delch
                    1520                             ;pez->A+
                    1521                             ;K+=000/(A+-AN)
                    1522                             ;mov            r0,#rez_A;->r2..r5
                    1523                             ;call   resar2
077B E577           1524                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
077D FA             1525                                     mov             r2,a
077E E578           1526                                     mov             a,reacp+1
0780 FB             1527                                     mov             r3,a
0781 E579           1528                                     mov             a,reacp+2
0783 FC             1529                                     mov             r4,a
0784 E57A           1530                                     mov             a,reacp+3
0786 FD             1531                                     mov             r5,a
                    1532                                     ;;;;;;;;;;;;;;;
0787 120402         1533                             call    altof                   ;r2..r5->float
078A 7888           1534                             mov             r0,#rezAp;->rezAp
078C 120000   F     1535                             call    saver2                          
078F 7884           1536                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0791 120000   F     1537                             call    resar8                          
0794 1201D1         1538                             call    flsub           ; r2..r5(A+-AN)
0797 120000   F     1539                             call    move28     ;r2..r5->r8..r11
079A 900000   F     1540                             mov             dptr,#CHtho;000->r2..r5 float
079D 120000   F     1541                             call    ldc_long                
07A0 1202B7         1542                             call    fldiv
07A3 EA             1543                             mov             a,r2
07A4 547F           1544                             anl             a,#7fh
07A6 FA             1545                             mov             r2,a
07A7 7890           1546                             mov             r0,#koefKp;->koefKp
07A9 120000   F     1547                             call    saver2
                    1548                       
                    1549                     ;       anl             P5,#0feh                ;p5.0=0 
07AC E585           1550                     mov             a,P5
07AE 54FE           1551                             anl             a,#0feh
07B0 F585           1552                             mov             P5,a
07B2 7883           1553                             mov             r0,#chdel
07B4 06             1554                             inc             @r0                       ;ch+1
07B5 020000   F     1555                             jmp             rebyte
                    1556     
07B8 B6C845         1557     n4delch:        cjne    @r0,#200,n8delch
                    1558                             ; pez->A-
                    1559                             ;K-=000/(A--AN)
                    1560                     ;       mov     r0,#rez_A;->r2..r5
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    25

                    1561                     ;       call    resar2
07BB E577           1562                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
07BD FA             1563                                     mov             r2,a
07BE E578           1564                                     mov             a,reacp+1
07C0 FB             1565                                     mov             r3,a
07C1 E579           1566                                     mov             a,reacp+2
07C3 FC             1567                                     mov             r4,a
07C4 E57A           1568                                     mov             a,reacp+3
07C6 FD             1569                                     mov             r5,a
                    1570                                     ;;;;;;;;;;;;;;;
07C7 120402         1571                             call    altof                   ;r2..r5->float
07CA 788C           1572                             mov             r0,#rezAm;->rezAm
07CC 120000   F     1573                             call    saver2                          
07CF 7884           1574                             mov             r0,#kor0_AN;kor0_AN->r8..r11
07D1 120000   F     1575                             call    resar8                          
07D4 1201D1         1576                             call    flsub                   ; r2..r5(A--AN)
07D7 120000   F     1577                             call    move28                  ;r2..r5->r8..r11
07DA 900000   F     1578                             mov             dptr,#CHtho     ;000->r2..r5 float
07DD 120000   F     1579                             call    ldc_long                
07E0 1202B7         1580                             call    fldiv
07E3 EA             1581                             mov             a,r2
07E4 547F           1582                             anl             a,#7fh
07E6 FA             1583                             mov             r2,a
07E7 7894           1584                             mov             r0,#koefKm;->koefKm
07E9 120000   F     1585                             call    saver2
                    1586                        
                    1587                             ;orl            P5,#01                      ;p5.0=1
07EC E585           1588                             mov             a,P5
07EE 4401           1589                             orl             a,#01
07F0 F585           1590                             mov             P5,a
07F2 00             1591                             nop
07F3 00             1592                             nop
                    1593                             ;orl            P5,#02h                 ;p5.1=1 
07F4 E585           1594                             mov             a,P5
07F6 4402           1595                             orl             a,#02
07F8 F585           1596                             mov             P5,a
07FA 7883           1597                             mov             r0,#chdel
07FC 06             1598                             inc             @r0                       ;ch+1
07FD 020000   F     1599                        jmp    rebyte
                    1600     
0800 B6FF0C         1601     n8delch:        cjne    @r0,#255,n12delch
0803 7600           1602                             mov             @r0,#0
0805 7981           1603                             mov             r1,#chavt
0807 779C           1604                             mov             @r1,#9ch;2eh;10=2ee0h
0809 09             1605                             inc             r1
080A 7740           1606                             mov             @r1,#40h;0e0h
080C 020000   F     1607                             jmp             rebyte
080F 06             1608     n12delch:       inc             @r0
0810 020000   F     1609                             jmp             rebyte
                    1610     
                    1611     ;in-r1-count
0813                1612     chdec:          ;mov            r1,#chavt               ;chavt-1
0813 E7             1613                             mov             a,@r1
0814 FC             1614                             mov             r4,a
0815 09             1615                             inc             r1
0816 E7             1616                             mov             a,@r1
0817 FD             1617                             mov             r5,a
0818 C202           1618                             clr             rr2
081A C203           1619                             clr             rr3
081C 900000   F     1620                             mov             dptr,#ch1        
081F 120000   F     1621                             call    ldc_ltemp
0822 120000   F     1622                             call    lsub
0825 ED             1623                             mov             a,r5
0826 F7             1624                             mov             @r1,a
0827 19             1625                             dec             r1
0828 EC             1626                             mov             a,r4
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    26

0829 F7             1627                             mov             @r1,a
082A 22             1628                             ret      
                    1629     
                    1630     
                    1631     
                    1632     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
082B 75E700         1633      ind:   mov             EIE2,#00H;mov   IE,#00h
082E 120000   F     1634                     call    mign
0831 7840           1635                      mov            r0,#bufind;+11
0833 7F0C           1636                      mov            r7,#12
0835 C286           1637      nexin: clr             p0.6
0837 E6             1638                     mov             a,@r0
0838 F59B           1639                     mov             SPI0DAT,a
083A 20FBFD         1640                     jb              TXBSY,$
083D D286           1641                     setb    p0.6
083F 120000   F     1642                     call    z_9             ;25mks
0842 08             1643                     inc             r0;dec          r0
0843 DFF0           1644                     djnz    r7,nexin
0845 75E730         1645                     mov             EIE2,#30H;mov   IE,#80h
0848 22             1646                ret
                    1647     
                    1648     
0849 7A08           1649     zapadc:   mov R2,#8
084B D297           1650     sdv:      setb P1.7
084D 33             1651               rlc A
084E 9296           1652                     mov P1.6,C
0850 120000   F     1653                     call tim2
                    1654                                     
0853 C297           1655                     clr P1.7
0855 120000   F     1656                     call tim2
0858 DAF1           1657                     djnz R2,sdv
085A D296           1658                     setb P1.6
085C 22             1659                     ret
                    1660     
085D 7A08           1661     chtadc:   mov R2,#8
085F D297           1662     sdv1:     setb P1.7
0861 120000   F     1663               call tim2
0864 C297           1664                     clr P1.7
0866 A296           1665                     mov C,P1.6
0868 33             1666                     rlc A
0869 120000   F     1667                     call tim2
086C DAF1           1668                     djnz R2,sdv1
086E 22             1669                     ret
                    1670     
086F 7E30           1671     tim:      mov R6,#30h;38h
0871 DEFE           1672     tim1:     djnz R6,tim1
0873 22             1673               ret
                    1674               
0874 7E10           1675     tim2:     mov R6,#10h;14h
0876 DEFE           1676     tim3:     djnz R6,tim3
0878 22             1677               ret
                    1678     
                    1679     ;запись из acc
0879 C3             1680     write_x1: clr   c
087A                1681     writeD_x1:
087A 92B1           1682                       mov P3.1,c        ;запись
087C F5A0           1683               mov P2,A
087E D2B3           1684                       setb P3.3
0880 120000   F     1685                       call z_5
0883 C2B3           1686                       clr P3.3
0885 75A0FF         1687                       mov P2,#0FFh
0888 22             1688                       ret
                    1689     
                    1690     ;чтение в acc
0889 C3             1691     read_x2:  clr   c  
088A 92B1           1692               mov P3.1,c        ;чтение
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    27

088C D2B2           1693               setb P3.2
088E D2B3           1694                       setb P3.3
0890 120000   F     1695                     call z_5
0893 E5A0           1696                       mov A,P2
0895 C2B3           1697                       clr P3.3
0897 C2B2           1698                       clr P3.2
0899 22             1699                       ret
                    1700     
                    1701     
089A 120000   F     1702     loop:     call read_x2;x2    ;ожидание флага готовности
089D 20E7FA         1703                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
08A0 22             1704                        ret           ;возврат, если бит А(7)<>1
                    1705                                      
                    1706                                        
                    1707     
                    1708     
                    1709     
                    1710     ;dptr+4-приемник
                    1711     ;dptr-источник
                    1712     ;r7-кол байт  
08A1                1713     xCIKLWR:
08A1 7F04           1714                             mov             r7,#4   
08A3 E0             1715     lwrx:   movx    a,@dptr
08A4 C083           1716                             push    dph
08A6 C082           1717                             push    dpl
08A8 A3             1718                             inc             dptr
08A9 A3             1719                             inc             dptr
08AA A3             1720                             inc             dptr
08AB A3             1721                             inc             dptr
08AC F0             1722                             movx    @dptr,a
08AD D082           1723                             pop             dpl
08AF D083           1724                             pop             dph
                    1725                             
08B1 A3             1726                             inc             dptr
08B2 DFEF           1727                             djnz    r7,lwrx
08B4 22             1728                             ret
                    1729     ;r2..r5->@dptr..@dptr+3                         
08B5 EA             1730     saveIr2:                mov     a,r2
08B6 F0             1731                                             movx    @dptr,a
08B7 A3             1732                                             inc     dptr
08B8 EB             1733                                             mov     a,r3
08B9 F0             1734                                             movx    @dptr,a
08BA A3             1735                                             inc     dptr
08BB EC             1736                                             mov     a,r4
08BC F0             1737                                             movx    @dptr,a
08BD A3             1738                                             inc     dptr
08BE ED             1739                                             mov     a,r5
08BF F0             1740                                             movx    @dptr,a
08C0 22             1741                                             ret
                    1742     ;r2..r5-> @r0..@r0+3
                    1743     
08C1 EA             1744     saver2:         mov     a,r2
08C2 F6             1745                                             mov     @r0,a
08C3 08             1746                                             inc     r0
08C4 EB             1747                                             mov     a,r3
08C5 F6             1748                                             mov     @r0,a
08C6 08             1749                                             inc     r0
08C7 EC             1750                                             mov     a,r4
08C8 F6             1751                                             mov     @r0,a
08C9 08             1752                                             inc     r0
08CA ED             1753                                             mov     a,r5
08CB F6             1754                                             mov     @r0,a
08CC 22             1755                                             ret 
08CD 7F28           1756     clmassix:       mov                     r7,#28h
08CF 900080         1757                             mov     dptr,#MASS0        ;забить массив A нулями
08D2 7400           1758     clmax:          mov          a,#00h
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    28

08D4 F0             1759                  movx    @dptr,a
08D5 A3             1760                  inc     dptr
08D6 DFFA           1761                 djnz                r7,clmax                
08D8 F56E           1762                  mov     chmas,a
08DA C201           1763                  clr     bitmas
08DC 22             1764                 ret
                    1765     
                    1766     ;r1-яЁшхьшъ
                    1767     ;r0-шёЄюўшъ
                    1768     ;r7-ъюы срщЄ  
08DD                1769     CIKLWR:
08DD 7F04           1770                             mov             r7,#4   
08DF E6             1771     lwr:    mov     a,@r0
08E0 F7             1772                             mov     @r1,a
08E1 09             1773                             inc             r1
08E2 08             1774                             inc             r0
08E3 DFFA           1775                             djnz    r7,lwr
08E5 22             1776                             ret     
                    1777     ;r2..r5-> @dptr..@dptr+3
                    1778     
08E6 120000   F     1779     zmul:   call    maform
08E9 120000   F     1780                     call    lmul
08EC 120000   F     1781                     call    bform
08EF 22             1782                     ret
                    1783     
08F0 120000   F     1784     zdiv:   call    maform
08F3 120000   F     1785                     call    divide
08F6 120000   F     1786                     call    bform
08F9 22             1787                     ret
                    1788     
08FA EA             1789     maform: mov a,r2
08FB 33             1790             rlc a
08FC 5006           1791             jnc             fo1m
08FE D202           1792                     setb            znmat
0900 120000   F     1793                     call   form4
0903 22             1794                     ret
0904 C202           1795     fo1m:   clr             znmat
0906 22             1796                     ret
                    1797     
0907 300203         1798     bform:  jnb             znmat,fo2m
090A 120000   F     1799                     call    form4
090D 22             1800     fo2m:   ret
                    1801       
                    1802     ;r2..r5 яхЁхтхёЄш т фюя ъюф
090E ED             1803     form4:          mov a,r5
090F F4             1804             cpl a
0910 2401           1805             add a,#1
0912 FD             1806             mov r5,a
0913 EC             1807             mov a,r4
0914 F4             1808             cpl a
0915 3400           1809             addc    a,#0
0917 FC             1810             mov r4,a
0918 EB             1811             mov a,r3
0919 F4             1812                 cpl a
091A 3400           1813             addc    a,#0
091C FB             1814             mov r3,a
091D EA             1815             mov a,r2
091E F4             1816             cpl a
091F 3400           1817             addc    a,#0
0921 FA             1818             mov r2,a
0922 22             1819             ret
                    1820     
0923 120000   F     1821     zcmp:   call            maform
0926 120000   F     1822                     call            lcmp
0929 C0D0           1823                     push            psw
092B 120000   F     1824                     call    bform
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    29

092E D0D0           1825                     pop             psw
0930 22             1826                     ret
                    1827     
                    1828     
                    1829     ;@r0..@r0+3->r8..r11
                    1830     
0931 E6             1831     resar8: mov     a,@r0
0932 F508           1832                     mov     ltemp,a
0934 08             1833                     inc     r0
0935 E6             1834                     mov     a,@r0
0936 F509           1835                     mov     ltemp+1,a
0938 08             1836                     inc     r0
0939 E6             1837                     mov     a,@r0
093A F50A           1838                     mov     ltemp+2,a
093C 08             1839                     inc     r0
093D E6             1840                     mov     a,@r0
093E F50B           1841                     mov     ltemp+3,a
0940 22             1842                     ret
                    1843     
                    1844     ;
                    1845     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                    1846     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                    1847     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                    1848     ;r2 a    ўшёыю 180
                    1849     ;00 b4
                    1850     ;т_ї- mabin..mabin+2
                    1851     ;     80 01 00
                    1852      
0941 C8             1853     cond:   xch     a,r0    
0942 F9             1854                     mov     r1,a
0943 C8             1855                     xch     a,r0
0944 7C03           1856                     mov     r4,#03
0946 7700           1857     dcoa:   mov     @r1,#00
0948 09             1858                     inc     r1
0949 DCFB           1859                     djnz    r4,dcoa
094B 7B10           1860                     mov     r3,#10h
094D C3             1861     dcob:   clr     c
094E 33             1862                     rlc     a
094F CA             1863                     xch     a,r2
0950 33             1864                     rlc     a
0951 CA             1865                     xch     a,r2
0952 C8             1866                     xch     a,r0
0953 F9             1867                     mov     r1,a
0954 C8             1868                     xch     a,r0
0955 7C03           1869                     mov     r4,#03
0957 FD             1870                     mov     r5,a
0958 E7             1871     dcoc:   mov     a,@r1 
0959 37             1872                     addc    a,@r1
095A D4             1873                     da      a
095B F7             1874                     mov     @r1,a
095C 09             1875                     inc     r1
095D DCF9           1876                     djnz    r4,dcoc
095F ED             1877                     mov     a,r5
0960 4003           1878                     jc      dcod
0962 DBE9           1879                     djnz    r3,dcob
0964 C3             1880                     clr     c
0965 00             1881     dcod:   nop
0966 22             1882                     ret
                    1883     
0967 8A08           1884     move28: mov     ltemp,r2                        ;r2..r5->ltemp
0969 850309         1885                     mov     ltemp+1,3
096C 85040A         1886                     mov     ltemp+2,4
096F 85050B         1887                     mov     ltemp+3,5
0972 22             1888                     ret
                    1889     
                    1890     ;@r0..@r0+3->r2..r5
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    30

                    1891     
0973 E6             1892     resar2: mov     a,@r0
0974 FA             1893                     mov     r2,a
0975 08             1894                     inc     r0
0976 E6             1895                     mov     a,@r0
0977 FB             1896                     mov     r3,a
0978 08             1897                     inc     r0
0979 E6             1898                     mov     a,@r0
097A FC             1899                     mov     r4,a
097B 08             1900                     inc     r0
097C E6             1901                     mov     a,@r0
097D FD             1902                     mov     r5,a
097E 22             1903                     ret
                    1904     
                    1905     ;25mkc !!!!!!!!!!!!!!!1
097F 7B4B           1906     z_9:      mov R3,#4Bh      ;загрузка числа
0981 DBFE           1907                    djnz R3,$
0983 22             1908               ret
                    1909     
                    1910     ;запись   передаваемый байт в acc
                    1911     ;передача байта послед кодом старшими разрядами  вперед
0984 7A08           1912     write:     mov R2,#8
0986 C3             1913                             clr  c  
0987 C297           1914     wr1:            clr             p1.7;P1.2
0989 00             1915                         nop 
098A 33             1916                             rlc A
098B 9296           1917                             mov P1.6,C;P1.1,C
098D 120000   F     1918                        call tim2
0990 D297           1919                        setb P1.7;P1.2
0992 120000   F     1920                call tim2
0995 DAF0           1921                       djnz R2,wr1
0997 C296           1922                       clr P1.6;P1.1
0999 22             1923                      ret
                    1924     
                    1925     ;принимаемый байт в acc
                    1926     ;прием байта последовательным кодом старшими разрядами вперед
099A 7A08           1927     read:    mov R2,#8
099C C297           1928     re1:     clr P1.7;P1.2
099E 120000   F     1929              call tim2        ;5mks
09A1 A294           1930                     mov C,P1.4;P1.0
09A3 33             1931                     rlc A           
09A4 D297           1932                     setb P1.7;P1.2
09A6 120000   F     1933                     call tim2
09A9 DAF1           1934                     djnz R2,re1
09AB 22             1935                     ret
                    1936     
                    1937      ;in r0-count   
                    1938     ;r10,r11-значение с котоым сравнивается счетчик
                    1939     ;r2..r5 -значение счетчика
09AC                1940     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
09AC E6             1941                     mov                     a,@r0
09AD FC             1942                     mov                     r4,a
09AE 08             1943                     inc                     r0
09AF E6             1944                     mov                     a,@r0
09B0 FD             1945                     mov                     r5,a
09B1 7B00           1946                     mov                     r3,#0
09B3 7A00           1947                     mov                     r2,#0
09B5 750800         1948                     mov                     r8,#0;clr                       r8
09B8 750900         1949                     mov                     r9,#0;clr                       r9
09BB 120000   F     1950                     call            lcmp
09BE 22             1951                     ret
                    1952     
                    1953     
                    1954     
                    1955     
                    1956     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    31

                    1957     
                    1958                                 
09BF 020000   F     1959     rout6:          jmp             out6
09C2 020000   F     1960     rlabelF:        jmp             labelF  
09C5 020000   F     1961     rknrazr:        jmp             knrazr  
09C8 020000   F     1962     rknopt:         jmp             knopt
09CB 020000   F     1963     rizman:         jmp             izman   
09CE                1964     keyb1:  ;IE6 
09CE C219           1965                                     clr             bitmig
09D0 C0E0           1966                                     push    acc
09D2 C0D0           1967                                     push    psw
09D4 C000           1968                                     push    rr0
09D6 C001           1969                                     push    rr1
09D8 C002           1970                                     push    rr2
09DA C003           1971                                     push    rr3
09DC C004           1972                                     push    rr4
09DE C005           1973                                     push    rr5
09E0 C006           1974                                     push    rr6
09E2 C007           1975                                     push    rr7
09E4 75E700         1976                                     mov             EIE2,#00H
                    1977                       ;;;;;;;;;;;;;;
09E7 120000   F     1978                                     call    z_01s;0,1s
                    1979                                     ;восстан знакоместо при мигании
                    1980                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
09EA 78B2           1981                                     mov             r0,#marker
09EC 7440           1982                                     mov             a,#bufind
09EE 26             1983                                     add             a,@r0                   ;a=bufind+marker
09EF F9             1984                                     mov             r1,a
09F0 A73C           1985                                     mov             @r1,savba
                    1986                                     ;;;;;;;;;;;
09F2 E5B0           1987                             mov             a,p3
09F4 20E6C8         1988                                     jb              acc.6,rout6
09F7 E5B0           1989                                     mov             a,p3
09F9 44FF           1990                                     orl             a,#0ffh         ; p3.(5-0)<-3f
09FB F5B0           1991                                     mov             p3,a
09FD E5B0           1992                                     mov             a,p3
09FF 30E6BD         1993                                     jnb             acc.6,rout6             ;error
0A02 3004BD         1994                                     jnb             bitizm,rlabelF
0A05 75B0FE         1995                                     mov             p3,#0feh                ;реж IZM
0A08 E5B0           1996                                     mov             a,p3
0A0A 30E6BE         1997                                     jnb             acc.6,rizman
0A0D 75B0FD         1998                                     mov             p3,#0fdh
0A10 E5B0           1999                                     mov             a,p3
0A12 30E6B0         2000                                     jnb             acc.6,rknrazr             ;labelC
0A15 75B0FB         2001                                     mov             p3,#0fbh
0A18 E5B0           2002                                     mov             a,p3
0A1A 30E638         2003                                     jnb             acc.6,knright           ;->
0A1D 75B0F7         2004                                     mov             p3,#0f7h
0A20 E5B0           2005                                     mov             a,p3
0A22 30E6A3         2006                                     jnb             acc.6,rknopt                    ;T
0A25 75B0EF         2007                                     mov             p3,#0efh
0A28 E5B0           2008                                mov          a,p3
0A2A 30E60B         2009                                     jnb             acc.6,pyskst                    ;pysk/stop
0A2D 75B0DF         2010                                     mov             p3,#0dfh
0A30 E5B0           2011                                     mov             a,p3
0A32 30E63C         2012                                jnb          acc.6,knvich
0A35 020000   F     2013                                     jmp             izmpaT
                    2014     
0A38 200A05         2015     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0A3B D20A           2016                                     setb    bitbon  ;уст реж буфер вкл
0A3D 020000   F     2017                                     jmp             izmpaT
0A40 C20A           2018     bufon:                  clr             bitbon  ;уст реж буфер выкл
0A42 020000   F     2019                                     jmp             izmpaT
                    2020     
0A45 79B0           2021     tizmri:                 mov             r1,#level
0A47 B70102         2022                                     cjne    @r1,#1,right2
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    32

                    2023                                     ;10s->HET
0A4A 8004           2024                                     jmp             right3
                    2025     
0A4C 07             2026     right2:                 inc             @r1
0A4D 120000   F     2027                                     call    lolevT
                    2028                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0A50 120000   F     2029     right3:                 call    ind
0A53 806A           2030                                     jmp             izmfun
                    2031     
                    2032                             
                    2033                             
0A55                2034     knright:        
                    2035     
0A55 79AE           2036                                     mov             r1,#diap
                    2037                             ;перекл диапазон 1 поз вверх сбр массив
0A57 17             2038                                     dec             @r1
0A58 B7FF04         2039                                     cjne    @r1,#0ffh,diinc
0A5B 7700           2040                                     mov             @r1,#0
0A5D 8060           2041                                     jmp  izmfun
0A5F 120000   F     2042     diinc:                  call     clmassix
0A62 78B3           2043                                     mov             r0,#summa
0A64 120000   F     2044                                     call    clear4
0A67 786A           2045                                     mov             r0,#rez_A0
0A69 120000   F     2046                                     call    clear4  
0A6C 120000   F     2047                                     call    loadUS
0A6F 804E           2048                                      jmp  izmfun
                    2049     
0A71 200610         2050     knvich:            jb           bitvi11,onvich
0A74 C204           2051                                     clr             bitizm
0A76 D214           2052                                     setb    bitvich
                    2053                                     
0A78 78B1           2054                                     mov             r0,#vichR
0A7A 7611           2055                                     mov             @r0,#11h;;????????or 0
                    2056                                     ;ВЫЧИСЛИТЬ
0A7C 900000   F     2057                                     mov     dptr,#teVICH
0A7F 120000   F     2058                                     call    lotext
                    2059                               ; call                ind
0A82 807A           2060                                     jmp              viout;izmpaT
                    2061     
0A84 C214           2062     onvich:                 clr             bitvich
0A86 78B1           2063                                     mov             r0,#vichR
0A88 7600           2064                                     mov             @r0,#0
0A8A 8037           2065                                     jmp              izmpaT
                    2066     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0A8C 301820         2067     louizm:            jnb          knizm,lou
0A8F 79AE           2068                                     mov             r1,#diap
0A91 C3             2069                                     clr             c
0A92 7403           2070                                     mov             a,#3
0A94 97             2071                                     subb    a,@r1
0A95 5006           2072                                     jnc             lldi23    ;10-2..10-5
                    2073                                     ;10-6..10-11
0A97 E584           2074                                     mov             a,p4
0A99 54F7           2075                                     anl             a,#0f7h   ;d3
0A9B F584           2076                                     mov             p4,a
0A9D E7             2077     lldi23:                 mov             a,@r1
0A9E 6403           2078                                     xrl             a,#3
0AA0 7002           2079                                     jnz             lldi3
0AA2 8005           2080                                     jmp             lldi2   ;10-5
0AA4 E7             2081     lldi3:                  mov             a,@r1
0AA5 6402           2082                                     xrl             a,#2            ;
0AA7 7006           2083                                     jnz             lou             
0AA9 E585           2084     lldi2:                  mov             a,p5            ;10-4
0AAB 4408           2085                                     orl             a,#08
0AAD F585           2086                                     mov             p5,a
0AAF 22             2087     lou:                    ret
                    2088                               ;;;;;;
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    33

0AB0 201807         2089     izman:                  jb              knizm,knizmon
0AB3 D218           2090                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2091                             ;       d3(k5 p4),d3(u5 p5)заслать us
0AB5 120000   F     2092                                     call    louizm 
0AB8 8005           2093                                     jmp             izmfun
0ABA C218           2094     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0ABC 120000   F     2095                                     call    loadUS;восстановить us
0ABF                2096     izmfun:                 
0ABF D208           2097                                     setb    bitbuf
0AC1 800E           2098                                     jmp             labelE;;;;;;;;;;;;
                    2099                                     ;;;;;;;;;;;;;;
0AC3                2100     izmpaT:
                    2101     ;;;;;;;;;;;;;;;;;
0AC3 C3             2102                             clr             c
0AC4 79AF           2103                             mov             r1,#parN
                    2104     
0AC6 78AE           2105                             mov             r0,#diap
0AC8 7406           2106                             mov             a,#6            
0ACA 96             2107                             subb    a,@r0
0ACB 5004           2108                             jnc             labelE          ;         ;10-2..10-8
                    2109                               
0ACD 7702           2110                             mov             @r1,#2          ;10-9..10-11            
0ACF 8000           2111                             jmp             labelE
                    2112     
                    2113     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0AD1 789A           2114     labelE:                 mov             r0,#parT
0AD3 793D           2115                                     mov             r1,#chkl
0AD5 B60108         2116                                     cjne    @r0,#1,izmt2
0AD8 7700           2117                                     mov             @r1,#0
0ADA 09             2118                                     inc             r1
0ADB 7702           2119                                     mov             @r1,#2
0ADD 020000   F     2120                                     jmp             out6
0AE0 B60208         2121     izmt2:                  cjne    @r0,#2,izmt3
0AE3 7700           2122                                     mov             @r1,#0
0AE5 09             2123                                     inc             r1
0AE6 7714           2124                                     mov             @r1,#20
0AE8 020000   F     2125                                     jmp             out6
                    2126     
0AEB 7700           2127     izmt3:                  mov             @r1,#0
0AED 09             2128                                     inc             r1
0AEE 77C8           2129                                     mov             @r1,#200
0AF0 020000   F     2130                                     jmp             out6
                    2131     
                    2132     
                    2133     
                    2134     
0AF3                2135     knopt: ;кнопка T
0AF3 C204           2136                                clr          bitizm
0AF5 D210           2137                                setb         bitt2
0AF7 79B7           2138                                mov          r1,#load
0AF9 7704           2139                                mov          @r1,#4;1s
0AFB 120000   F     2140                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2141                                
                    2142     
0AFE 793D           2143     viout:          mov             r1,#chkl
0B00 7703           2144                             mov             @r1,#03
0B02 09             2145                             inc             r1
0B03 77E8           2146                             mov             @r1,#0e8h               ;1000
0B05 020000   F     2147                             jmp             out6
                    2148     
0B08                2149     knrazr:          
0B08 C3             2150     labelC:          clr            c
0B09 78AF           2151                             mov             r0,#parN
0B0B 799A           2152                             mov             r1,#parT
0B0D 7402           2153                             mov             a,#2
0B0F 97             2154                             subb    a,@r1
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    34

0B10 40BF           2155                             jc              labelE          ;T>2
0B12 B60104         2156                             cjne    @r0,#1,noN1c
0B15 7602           2157                             mov             @r0,#2          ;N=2
0B17 80B8           2158                             jmp             labelE
                    2159     
0B19 B60207         2160     noN1c:          cjne    @r0,#2,not_1
0B1C B70104         2161                             cjne    @r1,#1,not_1
                    2162                     ;       clr             c
                    2163                     ;       push    rr0
                    2164                     ;       mov             r0,#diap
                    2165                     ;       mov             a,#6            ;10-2..10-8
                    2166                     ;       subb    a,@r0
                    2167                     ;       jc              not_10
                    2168                     ;       pop             rr0         
0B1F 7603           2169                             mov             @r0,#3          ;N=3      ;10-2..10-8
0B21 80AE           2170                             jmp             labelE
0B23                2171     not_10:         ;pop            rr0
0B23 7601           2172     not_1:          mov             @r0,#1                          ;N=1
0B25 80AA           2173                             jmp     labelE
                    2174     
0B27 020000   F     2175     rtizmri:        jmp             tizmri
0B2A                2176     labelf:                 
0B2A 301021         2177                             jnb             bitt2,nofizm
0B2D 75B0FB         2178                        mov          p3,#0fbh
0B30 E5B0           2179                        mov          a,p3
0B32 20E60F         2180                        jb           acc.6,outF
0B35 79B7           2181                        mov          r1,#load;parT
0B37 B70503         2182                        cjne         @r1,#5,noft1
                    2183                        ;t=10s
0B3A 020000   F     2184                        jmp          out6;ft1izm
                    2185     
0B3D 07             2186     noft1:     inc          @r1;dec         @r1
0B3E 120000   F     2187     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2188                             ;call   ind
0B41 020000   F     2189                     jmp             out6;??????????????/
                    2190     
                    2191                             ;увеличить счетчик задержки клавиатуры
0B44 783D           2192     outF:           mov             r0,#chkl
0B46 7627           2193                             mov             @r0,#27h
0B48 08             2194                             inc             r0
0B49 7610           2195                             mov             @r0,#10h
0B4B 020000   F     2196                             jmp             out6;out7
                    2197     
                    2198     
0B4E 301473         2199     nofizm:         jnb             bitvich,noviR
0B51 78B1           2200                             mov             r0,#vichR
0B53 B61117         2201                             cjne    @r0,#11h,no11v6
0B56 7612           2202                             mov             @r0,#12h                ;11= вычислить
0B58 900000   F     2203     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0B5B 120000   F     2204                             call    lotext
0B5E 80E4           2205                             jmp             outF
                    2206             
                    2207                     
0B60 B61154         2208     nor13:          cjne    @r0,#11h,nor11
0B63 7612           2209                             mov             @r0,#12h
0B65 900000   F     2210                             mov             dptr,#teIZMK    ;       изм конст
0B68 120000   F     2211                         call        lotext             
0B6B 80D7           2212                             jmp             outF
                    2213     
0B6D B6120A         2214     no11v6:         cjne    @r0,#12h,no12v6
0B70 7613           2215                             mov             @r0,#13h
0B72 900000   F     2216                             mov             dptr,#teOUT
0B75 120000   F     2217                             call    lotext
0B78 80CA           2218                             jmp             outF
                    2219                     
0B7A B6130A         2220     no12v6:         cjne    @r0,#13h,no13v6
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    35

0B7D 7611           2221                             mov             @r0,#11h
0B7F 900000   F     2222                             mov             dptr,#teVICH
0B82 120000   F     2223                             call    lotext
0B85 80BD           2224                             jmp             outF
                    2225     
                    2226     
0B87 75B0FB         2227     no13v6:         mov             p3,#0fbh
0B8A E5B0           2228                             mov             a,p3
0B8C 20E611         2229                             jb              acc.6,chanZ
                    2230                     ;clr            bitmig
0B8F 78B2           2231                             mov             r0,#marker      
0B91 B60904         2232                             cjne    @r0,#9,mark0_8          ;курсор справа ?
0B94 7600           2233                             mov             @r0,#0                          ; уст курсор в кр л
                             евую поз+1
0B96 80AC           2234                             jmp             outF
                    2235     
0B98 06             2236     mark0_8:        inc             @r0             ;       сдвинуть курсор вправо на 1
0B99 C219           2237                             clr             bitmig
0B9B B60A00         2238                             cjne    @r0,#10,outma
0B9E 80A4           2239     outma:          jmp             outF
                    2240     
0BA0 75B0FE         2241     chanZ:          mov             p3,#0feh
0BA3 E5B0           2242                             mov             a,p3
0BA5 20E602         2243                             jb              acc.6,chanma
                    2244                             ;изм знак в старшем разряде на противоположн
0BA8 809A           2245                             jmp             outF
0BAA 75B0FD         2246     chanma:         mov             p3,#0fdh
0BAD E5B0           2247                             mov             a,p3
0BAF 20E692         2248                             jb              acc.6,outF;labelL1
                    2249                             ;clr            bitmig
0BB2 120000   F     2250     labelL1:        call    vvchif  ;увеличить цифру 
                    2251     
0BB5 808D           2252                             jmp             outF
                    2253                     
0BB7                2254     nor11:          ;       выход
0BB7 7613           2255                     mov             @r0,#13h  ;12->13
0BB9 900000   F     2256                     mov             dptr,#teOUT
                    2257     ;               jmp             vi1113
                    2258     
                    2259     
                    2260     
0BBC C206           2261     yesviR:         clr             bitvi11;????????/
0BBE 200C77         2262                             jb              bmem11,labelL
0BC1 020000   F     2263                             jmp             out6;???????//
0BC4 30112A         2264     noviR:          jnb             bitmenu,nbimenu
0BC7 75B0FB         2265                             mov             p3,#0fbh; реж кн меню ->
0BCA 20B610         2266                             jb              p3.6,rnorim6
0BCD 79B0           2267                             mov             r1,#level
0BCF B7000E         2268                             cjne    @r1,#0,rimen6
0BD2 900000   F     2269                             mov             dptr,#teKALIB
0BD5 120000   F     2270                             call    lotext
0BD8 7701           2271                             mov             @r1,#1
0BDA 020000   F     2272                             jmp             out6
                    2273     
0BDD 020000   F     2274     rnorim6:                jmp             norim6
                    2275     
0BE0 900000   F     2276     rimen6:         mov             dptr,#teTEsT
0BE3 120000   F     2277                             call    lotext
0BE6 7700           2278                             mov             @r1,#0
0BE8 020000   F     2279                             jmp             out6
                    2280     
0BEB 020000   F     2281     moutF:          jmp             outF
                    2282     
0BEE 020000   F     2283     rnnmemb:        jmp             nnmemb
0BF1 300BFA         2284     nbimenu:        jnb             bitmem,rnnmemb
0BF4 79B0           2285                             mov             r1,#level
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    36

0BF6 B71113         2286                        cjne         @r1,#11h,nomem11
                    2287                        
0BF9 75B0FB         2288                        mov          p3,#0fbh
0BFC E5B0           2289                        mov          a,p3
0BFE 20E6EA         2290                        jb           acc.6,moutF
0C01 7712           2291                        mov          @r1,#12h
0C03 900000   F     2292                        mov          dptr,#teWR
0C06 120000   F     2293                        call         lotext
0C09 020000   F     2294                        jmp          outF
                    2295     
0C0C B71213         2296     nomem11:   cjne         @r1,#12h,nomem12
0C0F 75B0FB         2297                             mov             p3,#0fbh
0C12 E5B0           2298                        mov          a,p3
0C14 20E6D4         2299                        jb           acc.6,moutF
0C17 7713           2300                        mov          @r1,#13h
0C19 900000   F     2301                        mov          dptr,#teLIST
0C1C 120000   F     2302                        call         lotext
0C1F 020000   F     2303                        jmp          outF
0C22 B71313         2304     nomem12:         cjne           @r1,#13h,labelL
0C25 75B0FB         2305                             mov             p3,#0fbh
0C28 E5B0           2306                        mov          a,p3
0C2A 20E6BE         2307                        jb           acc.6,moutF
0C2D 7711           2308                        mov          @r1,#11h
0C2F 900000   F     2309                        mov          dptr,#teCLE
0C32 120000   F     2310                        call         lotext
0C35 020000   F     2311                          jmp                outF
                    2312     
0C38 78B0           2313     labelL:         mov             r0,#level
0C3A B6211B         2314                             cjne    @r0,#21h,labl21
0C3D 75B0FB         2315                             mov             p3,#0fbh
0C40 E5B0           2316                             mov             a,p3
0C42 20E610         2317                             jb              acc.6,loutF
0C45 B62108         2318                             cjne    @r0,#21h,lal22
0C48 7622           2319                             mov             @r0,#22h
                    2320                             ;БЛОК
0C4A 120000   F     2321                             call    lotext
0C4D 020000   F     2322                             jmp             outF
0C50 7621           2323     lal22:          mov             @r0,#21h
                    2324                             ;ПОЛНАЯ
0C52 120000   F     2325                             call    lotext
0C55 020000   F     2326     loutf:          jmp             outF
                    2327     
0C58 B6211B         2328     labl21:    cjne @r0,#21h,nolev1
0C5B 75B0FB         2329                             mov             p3,#0fbh
0C5E E5B0           2330                             mov             a,p3
0C60 20E6F2         2331                             jb              acc.6,loutF
0C63 B62108         2332                             cjne    @r0,#21h,labl22
0C66 7622           2333                             mov             @r0,#22h
                    2334                             ;БЛОК
0C68 120000   F     2335                             call    lotext
0C6B 020000   F     2336                             jmp             outF
0C6E 7621           2337     labl22:         mov             @r0,#21h
                    2338                             ;ПОЛНАЯ
0C70 120000   F     2339                             call    lotext
0C73 020000   F     2340                             jmp             outF
                    2341                      
0C76 B6231A         2342     nolev1:         cjne    @r0,#23h,go31l
0C79 75B0FB         2343     rigblo:         mov             p3,#0fbh
0C7C 20B61E         2344                             jb              p3.6,llev2
0C7F                2345     labL2:    ; mov         r1,#marker;а  уст курсор в правую позицию 
0C7F 78B2           2346                       mov           r0,#marker      ;курсор справа  ?
0C81 E53B           2347                             mov             a,movrig
0C83 C3             2348                             clr             c
0C84 96             2349                             subb    a,@r0
0C85 6006           2350                             jz         equ1l
0C87 E53B           2351                             mov             a,movrig;уст в правую позицию
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    37

0C89 F6             2352                             mov             @r0,a
0C8A 020000   F     2353                             jmp             outF                                             
0C8D E53A           2354     equ1l:          mov             a,movleft;уст в левую позицию
0C8F F6             2355                             mov             @r0,a   
0C90 020000   F     2356                             jmp             outF
                    2357                     
                    2358     
0C93 B63102         2359     go31l:          cjne    @r0,#31h,go41l
0C96 80E1           2360                             jmp             rigblo
0C98 B6410B         2361     go41l:          cjne    @r0,#41h,norig2
0C9B 80DC           2362                             jmp             rigblo
                    2363     
0C9D 75B0FD         2364     llev2:          mov             p3,#0fdh
0CA0 20B6B2         2365                             jb              p3.6,loutF
0CA3 020000   F     2366                             jmp             labelL1
                    2367     
0CA6 C3             2368     norig2:    clr          c               ;32,33,34,42
0CA7 7431           2369                             mov             a,#31h
0CA9 96             2370                             subb    a,@r0
0CAA 50A9           2371                             jnc             loutF
0CAC 75B0FB         2372     rigblok:        mov             p3,#0fbh  ;32,33,34,42
0CAF 20B614         2373                             jb              p3.6,lev2go
0CB2 78B2           2374     labelN:         mov             r0,#marker      ;курсор справа  ?
0CB4 E53B           2375                             mov             a,movrig
0CB6 C3             2376                             clr             c
0CB7 96             2377                             subb    a,@r0
0CB8 7006           2378                             jnz        noequ1
0CBA E53A           2379                             mov             a,movleft;уст в крайнюю левую позицию
0CBC F6             2380                             mov             @r0,a
0CBD 020000   F     2381                             jmp             outF
0CC0 120000   F     2382     noequ1:         call    marri;уст сдвиг в правую        позицию
0CC3 020000   F     2383                             jmp             outF
0CC6 75B0FD         2384     lev2go:         mov             p3,#0fdh
0CC9 30B603         2385                             jnb             p3.6,rlabelL1
0CCC 020000   F     2386                             jmp             outF
                    2387     
0CCF 020000   F     2388     rlabelL1:       jmp             labelL1
0CD2                2389     nnmemb:
0CD2                2390     norim6:    ;kn menu
0CD2 D007           2391     out6:                   pop             rr7     
0CD4 D006           2392                                     pop             rr6
0CD6 D005           2393                                     pop             rr5
0CD8 D004           2394                                     pop             rr4
0CDA D003           2395                                     pop             rr3
0CDC D002           2396                                     pop             rr2
0CDE D001           2397                                     pop             rr1                             
0CE0 D000           2398                                     pop             rr0
0CE2 D0D0           2399                                     pop             psw
0CE4 D0E0           2400                                     pop             acc
0CE6 75E730         2401                                mov          EIE2,#30H
0CE9 E5AD           2402                                mov          a,P3IF
0CEB 54BF           2403                                     anl             a,#0bfh
0CED F5AD           2404                                     mov             P3IF,a
0CEF 75B0C0         2405                                     mov             P3,#0c0h
0CF2 32             2406                             reti
                    2407     
0CF3 020000   F     2408      rknMEM:                        jmp             knMEM
0CF6 020000   F     2409     knKMP:             jmp          out7
0CF9 020000   F     2410     rout7:                  jmp             out7    
0CFC 020000   F     2411     rlabelH:                jmp             labelH
0CFF 020000   F     2412     rknNUL:         jmp             knNUL
0D02 020000   F     2413     rknleft:                jmp             knleft
0D05                2414     keyb2:  ;IE7
0D05 75E700         2415                                     mov             EIE2,#00H
0D08 C0E0           2416                                     push    acc
0D0A C0D0           2417                                     push    psw
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    38

0D0C C000           2418                                     push    rr0
0D0E C001           2419                                     push    rr1
0D10 C002           2420                                     push    rr2
0D12 C003           2421                                     push    rr3
0D14 C004           2422                                     push    rr4
0D16 C005           2423                                     push    rr5
0D18 C006           2424                                     push    rr6
0D1A C007           2425                                     push    rr7
                    2426                                     ;mov            IE,#00h
                    2427                       ;;;;;;;;;;;;;;
0D1C 120000   F     2428                               call  z_01s   ;0,1s
                    2429                               ;восстан знакоместо при мигании
                    2430                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0D1F 78B2           2431                                     mov             r0,#marker
0D21 7440           2432                                     mov             a,#bufind
0D23 26             2433                                     add             a,@r0                   ;a=bufind+marker
0D24 F9             2434                                     mov             r1,a
0D25 A73C           2435                                     mov             @r1,savba
                    2436                                     ;;;;;;;;;;;
0D27 E5B0           2437                             mov             a,p3
0D29 20E7CD         2438                                     jb              acc.7,rout7
0D2C E5B0           2439                                     mov             a,p3
0D2E 74FF           2440                                     mov             a,#0ffh         ; p3.(5-0)<-3f
0D30 F5B0           2441                                     mov             p3,a
0D32 E5B0           2442                                     mov             a,p3
0D34 30E7C2         2443                                     jnb             acc.7,rout7             ;error
0D37 3004C2         2444                                     jnb             bitizm,rlabelH
0D3A 75B0FE         2445                                     mov             p3,#0feh                ;реж IZM
0D3D E5B0           2446                                     mov             a,p3
0D3F 30E7BD         2447                                     jnb             acc.7,rknNUL
0D42 75B0FD         2448                                     mov             p3,#0fdh
0D45 E5B0           2449                                     mov             a,p3
0D47 30E7AC         2450                                     jnb             acc.7,knKMP
0D4A 75B0FB         2451                                     mov             p3,#0fbh
0D4D E5B0           2452                                     mov             a,p3
0D4F 30E7B0         2453                                     jnb             acc.7,rknleft
0D52 75B0F7         2454                                     mov             p3,#0f7h
0D55 E5B0           2455                                     mov             a,p3
0D57 30E74E         2456                                     jnb             acc.7,knAVP
0D5A 75B0EF         2457                                 mov         p3,#0efh
0D5D E5B0           2458                                     mov             a,p3
0D5F 30E791         2459                                     jnb             acc.7,rknMEM
0D62 75B0DF         2460                                     mov             p3,#0dfh
0D65 E5B0           2461                                     mov             a,p3    
0D67 30E72E         2462                                     jnb             acc.7,knmenu
0D6A                2463     an_t7:             ;;;;;;;;;;;;
                    2464                     
0D6A C3             2465                             clr             c
0D6B 79AF           2466                             mov             r1,#parN
                    2467     
0D6D 78AE           2468                             mov             r0,#diap
0D6F 7406           2469                             mov             a,#6            
0D71 96             2470                             subb    a,@r0
0D72 5002           2471                             jnc             goto7           ;         ;10-2..10-8
                    2472                               
0D74 7702           2473                             mov             @r1,#2          ;10-9..10-11            
                    2474                             
                    2475                             ;;;;;;;;;;;;
0D76 799A           2476     goto7:                  mov             r1,#parT
0D78 783D           2477                                     mov             r0,#chkl
0D7A B70108         2478                                     cjne    @r1,#1,not1_7
0D7D 7600           2479                                     mov             @r0,#00
0D7F 08             2480                                     inc             r0
0D80 7602           2481                                     mov             @r0,#2
0D82 020000   F     2482                                     jmp             out7
                    2483                             
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    39

                    2484     
0D85 B70208         2485     not1_7:                 cjne    @r1,#2,not2_7
0D88 760E           2486                                     mov             @r0,#0eh;00
0D8A 08             2487                                     inc             r0
0D8B 7638           2488                                     mov             @r0,#38h;20
0D8D 020000   F     2489                                     jmp             out7
0D90 7600           2490     not2_7:                 mov             @r0,#00
0D92 08             2491                                     inc             r0
0D93 76C8           2492                                     mov             @r0,#200
0D95 020000   F     2493                                     jmp             out7
                    2494     
                    2495     
0D98 C204           2496     knmenu:                  clr            bitizm          ;off IZM
0D9A D211           2497                                     setb            bitmenu
0D9C 900000   F     2498                                     mov             dptr,#teMENU    ;в буф2 записать ТЕСТ-ИЗМЕР
0D9F 120000   F     2499                                     call    lotext
0DA2 120000   F     2500                                     call    ind;???????/
0DA5 020000   F     2501                                     jmp             onmem11
                    2502     
0DA8 200505         2503     knAVP:                  jb              bitavp,meavp
0DAB D205           2504                                     setb    bitavp
0DAD 020000   F     2505                                     jmp             onmem11
0DB0 C205           2506     meavp:                  clr             bitavp
0DB2 020000   F     2507                                     jmp             onmem11
                    2508     
0DB5 79AE           2509     knleft:            mov          r1,#diap
0DB7 07             2510                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
0DB8 B70A03         2511                                     cjne    @r1,#0ah,nodi6
0DBB 17             2512                                     dec             @r1
0DBC 80AC           2513                                     jmp             an_t7
                    2514     
0DBE                2515     nodi6:             ;    cjne    @r1,#0,an_t7
0DBE 120000   F     2516                                      call    clmassix
0DC1 78B3           2517                                     mov             r0,#summa
0DC3 120000   F     2518                                     call    clear4  
0DC6 786A           2519                                     mov             r0,#rez_A0
0DC8 120000   F     2520                                     call    clear4  
0DCB 120000   F     2521                                     call    loadUS
0DCE 809A           2522                                jmp          an_t7
                    2523     
0DD0 200F0E         2524     knNUL:                  jb              bitnul,ybnul
0DD3 D20F           2525                                     setb    bitnul
0DD5 789C           2526                                     mov             r0,#rez_A3      ;A3
0DD7 120000   F     2527                                     call    resar2
0DDA 786A           2528                                     mov             r0,#rez_A0      
0DDC 120000   F     2529                                     call    saver2;A0<-A3
0DDF 8095           2530                                     jmp             goto7;an_t7
                    2531     
0DE1 C20F           2532     ybnul:                  clr             bitnul
0DE3 900000   F     2533                                      mov    DPTR,#ch0 
0DE6 120000   F     2534                                     CALL   ldc_long          ; r2..r5 <-- 0
0DE9 786A           2535                                     mov             r0,#rez_A0      ;A0=0
0DEB 120000   F     2536                                     call    saver2
0DEE 8086           2537                                     jmp             goto7;an_t7
                    2538     
0DF0 30101E         2539     labelH:                 jnb             bitt2,nolah
0DF3 75B0FB         2540                                     mov             p3,#0fbh   ;вход в режим изм Т
0DF6 79B7           2541                                     mov             r1,#load;parT
0DF8 20B70D         2542                                     jb              p3.7,rhnot1
0DFB B70003         2543                                     cjne    @r1,#0,inct;
0DFE 020000   F     2544                                     jmp             out7;hyest6
0E01 17             2545     inct:                   dec             @r1                     ;Tизм+1
                    2546                             
0E02 120000   F     2547                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
0E05                2548     hnot2:          ;       call    ind
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    40

0E05 020000   F     2549                                     jmp             out7
                    2550     
0E08 020000   F     2551      rhnot1:                jmp             hnot1
                    2552      ;rnoviR:       jmp             noviR
0E0B 020000   F     2553      rlabelK:       jmp             labelK
0E0E 020000   F     2554      rlabelI:       jmp             labelI          
                    2555      ;;;;;;;;;;;;;;;;;;;
0E11 3014F7         2556     nolah:          jnb             bitvich,rlabelK 
                    2557                             ;;;;;;
                    2558                             ;увеличить счетчик задержки клавиатуры
                    2559                     ;;              mov             r0,#chkl
                    2560                     ;;              mov             @r0,#27h
                    2561                     ;;              inc             r0
                    2562                     ;;              mov             @r0,#10h
                    2563                             ;;;;;;
                    2564     
0E14 78B1           2565                             mov             r0,#vichR
0E16 B6115D         2566                             cjne    @r0,#11h,hnor11;rlabelI;;
0E19 75B0FB         2567                             mov             p3,#0fbh   ;<-
0E1C 20B722         2568                             jb              p3.7,noh37;routF
0E1F B6110B         2569                     cjne    @r0,#11h,hr12
0E22 7613           2570                             mov             @r0,#13h        ;11= вычислить
0E24 900000   F     2571                             mov             dptr,#teOUT;teVICH
0E27 120000   F     2572     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
0E2A 020000   F     2573                             jmp             goto7;outF
0E2D B61207         2574     hr12:           cjne    @r0,#12h,hnor12
0E30 7611           2575     lovich:         mov             @r0,#11h
0E32 900000   F     2576                             mov             dptr,#teVICH
0E35 80F0           2577                             jmp             hvi1113         
0E37 B6133C         2578     hnor12:         cjne    @r0,#13h,hnor11
0E3A 7612           2579     loizmk:         mov             @r0,#12h
0E3C 900000   F     2580                             mov             dptr,#teIZMK    ;       изм конст
                    2581                                        
0E3F 80E6           2582                             jmp             hvi1113
                    2583     
0E41 75B0F7         2584     noh37:          mov             p3,#0f7h
0E44 20B707         2585                             jb              p3.7,routF
0E47 B61139         2586                             cjne    @r0,#11h,vvizko
0E4A D214           2587                             setb    bitvich    ;нажат ввод ВЫЧИСЛИТЬ
0E4C D204           2588                             setb    bitizm
0E4E 020000   F     2589     routF:          jmp             goto7;outF
                    2590     ;
0E51 B6120A         2591     norr11:         cjne    @r0,#12h,norr12
0E54 75B0FB         2592                             mov             p3,#0fbh   ;<-
0E57 20B7E7         2593                             jb              p3.7,noh37;routF
0E5A 760B           2594                             mov             @r0,#11;12->11
0E5C 80D2           2595                             jmp             lovich
                    2596     
0E5E B613AD         2597     norr12:         cjne    @r0,#13h,rlabelI
0E61 75B0FB         2598                             mov             p3,#0fbh   ;<-
0E64 20B7DA         2599                             jb              p3.7,noh37
0E67 7612           2600                             mov             @r0,#12h
0E69 80CF           2601                             jmp             loizmk
                    2602                             ;;;;
0E6B C214           2603     clrvich:                clr             bitvich
0E6D D204           2604                             setb    bitizm
0E6F A8B2           2605                             mov             r0,marker
0E71 76FF           2606                             mov             @r0,#0ffh
0E73 020000   F     2607                              jmp    goto7;  routF
                    2608     
                    2609      ;ввод изм конст
0E76 B612E5         2610     hnor11:         cjne    @r0,#12h,norr12;clrvich
0E79 75B0FB         2611                              mov            p3,#0fbh   
0E7C 20B7C2         2612                             jb              p3.7,noh37;lovich;;изм конст <-  выч
0E7F 7611           2613                             mov             @r0,#11h
0E81 80AD           2614                             jmp             lovich
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    41

                    2615     
0E83 78B1           2616     vvizko:         mov             r0,#vichR
0E85 E6             2617                             mov             a,@r0
                    2618                     ;       cjne    @r0,#12h,clrvich
0E86 B412E2         2619                             cjne    a,#12h,clrvich
0E89 7621           2620                             mov             @r0,#21h                ;изм конст->a=+0000     (vv
                             od)
0E8B 78B2           2621                             mov             r0,#marker
0E8D 7604           2622                             mov             @r0,#4;9
0E8F 900000   F     2623                             mov             dptr,#teAequ0
0E92 120000   F     2624                             call    lotext
0E95 020000   F     2625                             jmp             goto7;routF
                    2626     ;hnor13:                jmp             hnor12          
0E98 B6210C         2627     izchi:          cjne    @r0,#21h,tlabelI
                    2628     ;<- при вводе цифр А                            
                    2629                     ;        mov            p3,#0fbh   
                    2630                     ;       jnb             p3.7,li21
                    2631             ;clr            bitmig
0E9B 78B2           2632                             mov             r0,#marker
0E9D 16             2633                             dec             @r0
0E9E B60201         2634                             cjne    @r0,#2,li21
0EA1 06             2635                             inc             @r0;marker=3 +/-
0EA2 C219           2636     li21:           clr             bitmig
0EA4 020000   F     2637                             jmp             goto7;outF
                    2638     
0EA7 020000   F     2639     tlabelI:        jmp             labelI
                    2640     
                    2641     ;                       load    0 1 2 3 4 5             
0EAA 06050403       2642     sootv:          db              6,5,4,3,2,1;parT
0EAE 0201                    
                    2643     ;
                    2644     
                    2645     ;нажата кн ввод при наборе Т
0EB0 75B0F7         2646     hnot1:                  mov             p3,#0f7h
0EB3 20B798         2647                                     jb              p3.7,routF;out7
0EB6 B7053E         2648                                     cjne    @r1,#5,nohnot1  ;r1=load
0EB9 794A           2649                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
0EBB E7             2650                                     mov             a,@r1
0EBC 4440           2651                                     orl             a,#40h;.6
0EBE F7             2652                                     mov             @r1,a
0EBF 8000           2653                                     jmp             loadb
                    2654                                     
                    2655                                     
0EC1 789A           2656     loadB:                  mov             r0,#parT
0EC3 900000   F     2657                                     mov             dptr,#sootv
0EC6 79B7           2658                                     mov             r1,#load                
0EC8 E7             2659                                     mov             a,@r1;load
0EC9 93             2660                                     movc    a,@a+dptr
0ECA F6             2661                                     mov             @r0,a
0ECB 120000   F     2662                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    2663                                      ;r4=b1 r5=b2
0ECE 120000   F     2664                                     call    iniacp;инициализация АЦП
0ED1 120000   F     2665                                     call    loadUS
0ED4 D204           2666                                     setb    bitizm
0ED6 C210           2667                                     clr             bitt2
0ED8 C3             2668                                      clr            c
0ED9 789A           2669                                  mov                r0,#parT
0EDB 79AF           2670                                      mov            r1,#parN
0EDD 7402           2671                                  mov                a,#2
0EDF 96             2672                                 subb                a,@r0
0EE0 5005           2673                                 jnc                 loadB2
0EE2 7701           2674                                     mov             @r1,#1;N=1         ;T>=2
0EE4 020000   F     2675     bout7:                  jmp             goto7;out7
                    2676     
0EE7 B702FA         2677     loadB2:                 cjne    @r1,#2,bout7
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    42

0EEA 7702           2678                                     mov             @r1,#2;N=2
0EEC 020000   F     2679                                     jmp             goto7;out7
0EEF                2680     nohnot2:                ;в буфере 1 зажечь <=0,1s
0EEF 794A           2681                                     mov             r1,#bufind+10
0EF1 E7             2682                                     mov             a,@r1
0EF2 4410           2683                                     orl             a,#10h;.4
0EF4 F7             2684                                     mov             @r1,a
0EF5 80CA           2685                                     jmp             loadB
0EF7 B704F5         2686     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
0EFA 794A           2687                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
0EFC E7             2688                                     mov             a,@r1
0EFD 4420           2689                                     orl             a,#20h;.5
0EFF F7             2690                                     mov             @r1,a
0F00 80BF           2691                                     jmp             loadB
                    2692     
                    2693     ;кнопка ПАМЯТЬ
0F02 C204           2694     knMEM:                  clr             bitizm          ;off IZM
0F04 900000   F     2695                                     mov             dptr,#teCLE
0F07 120000   F     2696                                     call    lotext    ;в буф2 записать ОЧИСТКА
0F0A D20B           2697                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
0F0C 78B0           2698                                     mov             r0,#level
0F0E 7611           2699                                     mov             @r0,#11h
0F10 783D           2700     onmem11:                mov             r0,#chkl
0F12 7603           2701                                     mov             @r0,#03
0F14 08             2702                                     inc             r0
0F15 76E8           2703                                     mov             @r0,#0e8h               ;1000
0F17 020000   F     2704                                     jmp             goto7;out7
                    2705     
0F1A 020000   F     2706     rnomemk:                jmp             nomemk          ;
0F1D                2707     labelK:
                    2708     ;;;;;;;;;;;;
                    2709     ;                               jnb             bitmenu,nomenu
                    2710     ;                               mov             p3,#0fbh
                    2711     ;                               mov             r1,#level
                    2712     ;                               jb              p3.7,vvmenu
                    2713                     
                    2714     
                    2715     ;nomenu:                        mov             p3,#0f7h;0efh;0f7h;vvod
                    2716     ;                               jb              p3.7,novvmn
                    2717     ;vvmenu:;ввод меню  (тест-калибровка)
                    2718     ;                               mov             dptr,#teTEST;тест
                    2719     ;                               call    lotext
                    2720     ;                               mov             @r1,#2
                    2721     ;                               jmp             out7
                    2722     ;novvmn:                        mov             p3,#0efh
                    2723     ;                               jb              p3.7,rimenu
                    2724                             
                    2725     ;                               jmp             out7
                    2726     
                    2727      ;rimenu:
                    2728     ;;;;;;;;;;;;
0F1D 300BFA         2729                               jnb           bitmem,rnomemk
0F20 78B0           2730                               mov           r0,#level
0F22 B61132         2731                               cjne          @r0,#11h,klev1;nome11
0F25 75B0FB         2732     lefmem11:         mov           p3,#0fbh
0F28 E5B0           2733                               mov           a,p3
0F2A 20E70E         2734                               jb            acc.7,rkvvod0
0F2D B6110E         2735                               cjne          @r0,#11h,locle          ;<-memory
0F30 7613           2736                               mov           @r0,#13h
0F32 900000   F     2737     lolist:           mov           dptr,#teLIST
0F35 120000   F     2738                               call          lotext           ;ПРОСМОТР
0F38 020000   F     2739                               jmp   goto7;  outF
                    2740     
0F3B 020000   F     2741     rkvvod0:        jmp             kvvod0
                    2742     
                    2743     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    43

0F3E B6120B         2744     locle:          cjne            @r0,#12h,lowr           ;<-memory
0F41 7611           2745                               mov           @r0,#11h                   ;ОЧИСТКА
0F43 900000   F     2746     loadcle:          mov           dptr,#teCLE
0F46 120000   F     2747                               call          lotext
0F49 020000   F     2748                               jmp           goto7;outF
0F4C 7612           2749      lowr:          mov             @r0,#12h
0F4E 900000   F     2750      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
0F51 120000   F     2751                             call    lotext
0F54 020000   F     2752                             jmp             goto7;outF
0F57 B61202         2753      klev1:          cjne   @r0,#12h,klev2
0F5A 80C9           2754                             jmp             lefmem11
0F5C B61302         2755     klev2:           cjne   @r0,#13h,klev22   ;11-13 нет
0F5F 80C4           2756                             jmp             lefmem11
                    2757     
                    2758     ;<- vvod на более низких уровнях
0F61 B62114         2759     klev22:         cjne    @r0,#21h,klev21
0F64 75B0FB         2760     lev220:         mov             p3,#0fbh
0F67 20B72C         2761                             jb              p3.7,kgo23
0F6A B6213D         2762                             cjne    @r0,#21h,kfull
0F6D 7622           2763                             mov             @r0,#22h
0F6F 900000   F     2764                             mov             dptr,#teBL
0F72 120000   F     2765                             call    lotext
0F75 020000   F     2766                             jmp             goto7;outF
                    2767                                     
0F78 B62205         2768     klev21:         cjne    @r0,#22h,klev23
0F7B 80E7           2769                             jmp             lev220
                    2770     
0F7D 020000   F     2771     rlabL2:         jmp             labL2
                    2772     
0F80 B62376         2773     klev23:          cjne   @r0,#23h,labM
0F83 75B0FB         2774                              mov    p3,#0fbh
0F86 20B7F4         2775                              jb             p3.7,rlabL2
0F89 75B0F7         2776                              mov    p3,#0f7h
0F8C 20B748         2777                              jb             p3.7,ddoutf
                    2778                              ;очистить блок памяти с набранным номером
0F8F C20B           2779                              clr    bitmem  ;сбр признак памяти 
0F91 D204           2780                              setb   bitizm
0F93 020000   F     2781                              jmp    goto7;outF
                    2782                             
0F96 75B0F7         2783     kgo23:           mov    p3,#0f7h
0F99 20B73B         2784                             jb              p3.7,ddoutf
0F9C B62107         2785                             cjne    @r0,#21h,go23no
                    2786                             ;очистить память
0F9F C20B           2787                             clr             bitmem
0FA1 D204           2788                             setb    bitizm
0FA3 020000   F     2789                             jmp             goto7;outF
                    2790     
0FA6 7623           2791     go23no:    mov          @r0,#23h
0FA8 8035           2792                             jmp             loblok;БЛОК 00
                    2793     
0FAA 7621           2794     kfull:          mov             @r0,#21h
0FAC 8023           2795                             jmp             gofull          
0FAE                2796     nomemk:
0FAE 020000   F     2797                                     jmp             goto7;outF
                    2798                                     ;;;;;;;;;;
0FB1 75B0FB         2799     nome11:           mov           p3,#0fbh
0FB4 E5B0           2800                               mov           a,p3
0FB6 20E70B         2801                               jb            acc.7,kvvod0
0FB9 B61204         2802                               cjne          @r0,#12h,mem12no        
0FBC 7611           2803                               mov           @r0,#11h                ;ОЧИСТКА
0FBE 8083           2804                               jmp            loadcle
                    2805     
0FC0                2806     mem12no:        ;cjne           @r0,#13h,lowr           
0FC0 7612           2807                               mov           @r0,#12h                   ;
0FC2 808A           2808                               jmp           lowr1                     ;ЗАПИСЬ
                    2809     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    44

0FC4 75B0F7         2810     kvvod0:           mov           p3,#0f7h
0FC7 20B70D         2811                               jb            p3.7,ddoutf
0FCA 78B0           2812                               mov           r0,#level
0FCC B6110B         2813                               cjne          @r0,#11h,mvv11
0FCF 7621           2814                               mov           @r0,#21h                ;ПОЛНАЯ
0FD1 900000   F     2815     gofull:           mov           dptr,#teFULL
0FD4 120000   F     2816                               call          lotext
0FD7 020000   F     2817     ddoutf:                 jmp             goto7;outF
                    2818     
0FDA B61215         2819     mvv11:            cjne          @r0,#12h,mvv12
0FDD 7631           2820                                     mov             @r0,#31h
0FDF 900000   F     2821     loblok:                 mov             dptr,#teBLOK;БЛОК 00
0FE2 120000   F     2822                                     call    lotext
0FE5 78B2           2823                                     mov             r0,#marker
0FE7 7607           2824                                     mov             @r0,#7
0FE9 753B08         2825                                     mov             movrig,#8
0FEC 753A07         2826                                     mov             movleft,#7
0FEF 020000   F     2827                                     jmp             goto7;outF
0FF2 7641           2828     mvv12:                  mov             @r0,#41h                ; БЛОК 00
0FF4 80E9           2829                                     jmp             loblok
                    2830     
                    2831     
                    2832     
0FF6 020000   F     2833     mlabL2:         jmp             labL2
                    2834     
0FF9 B63137         2835     labM:                   cjne    @r0,#31h,nom31
0FFC 75B0FB         2836                                     mov             p3,#0fbh
0FFF 30B7F4         2837                                     jnb             p3.7,mlabL2
1002 75B0F7         2838                                mov          p3,#0f7h
1005 20B7CF         2839                                jb           p3.7,ddoutf
                    2840                                
1008 7632           2841                                mov          @r0,#32h
                    2842                                     ;       считать с индикатора  
100A 7F0A           2843                                     mov             r7,#10
100C 7853           2844                                     mov             r0,#adec
100E 120000   F     2845                                     call    clearN
1011 120000   F     2846                                     call    upak2                   
1014 784F           2847                                     mov             r0,#abin
1016 7953           2848                                     mov             r1,#adec                        ;мл        
                              ст
1018 120000   F     2849                                     call    decbin                  ;abin..abin+3 (hex)
                    2850                                     ;call   loadr2                  ;r2..r5
                    2851                                     ;call   altof                   ;r2..r5->int
101B 78C4           2852                                mov          r0,#nblok       ;   сохранить
101D E54F           2853                                mov          a,abin          ;;мл
101F F6             2854                                mov          @r0,a
1020 900000   F     2855                                mov          dptr,#tebBL;НАЧ БЛОК 000
1023 120000   F     2856                                call         lotext
1026 78B2           2857                                mov          r0,#marker
1028 7607           2858                                mov          @r0,#7
102A 753B09         2859                                mov          movrig,#9
102D 753A07         2860                                mov          movleft,#7
1030 020000   F     2861     rgoto7:            jmp     goto7;outF
                    2862     
1033 B6324C         2863     nom31:             cjne         @r0,#32h,nom32
1036 75B0FB         2864                                     mov             p3,#0fbh
1039 20B714         2865                                     jb              p3.7,no31n
                    2866                                     
103C 78B2           2867     lefcur:         mov             r0,#marker      ;курсор слева?
103E E53A           2868                             mov             a,movleft
1040 C3             2869                             clr             c
1041 96             2870                             subb    a,@r0
1042 7006           2871                             jnz        noequ2
1044 E53B           2872                             mov             a,movrig
1046 F6             2873                             mov             @r0,a;уст в крайнюю правую позицию
1047 020000   F     2874                             jmp             goto7
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    45

104A 120000   F     2875     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
104D 020000   F     2876                             jmp        goto7
                    2877                                     
1050 75B0F7         2878     no31n:             mov          p3,#0f7h
1053 20B7DA         2879                                     jb              p3.7,rgoto7
1056 7633           2880                                     mov             @r0,#33h
                    2881                                     ;запомнить номер ячейки блока
1058 7F0A           2882                                             mov             r7,#10
105A 7853           2883                                     mov             r0,#adec
105C 120000   F     2884                                     call    clearN
105F 120000   F     2885                                     call    upak3                   
1062 784F           2886                                     mov             r0,#abin
1064 7953           2887                                     mov             r1,#adec                        ;мл        
                              ст
1066 120000   F     2888                                     call    decbin                  ;abin..abin+3 (hex)
1069 120000   F     2889                                     call    loadr2                  ;r2..r5
106C 120402         2890                                     call    altof                   ;r2..r5->int
                    2891     
106F 900000   F     2892                                      mov            dptr,#teeBL;КОН БЛОК 000
1072 120000   F     2893                                call         lotext
1075 78B2           2894                                mov          r0,#marker
1077 7607           2895                                mov          @r0,#7
1079 753B09         2896                                mov          movrig,#9
107C 753A07         2897                                mov          movleft,#7
107F 020000   F     2898                                jmp     goto7;
                    2899     
                    2900     
1082 B63328         2901     nom32:           cjne           @r0,#33h,nom33
1085 75B0FB         2902                              mov            p3,#0fbh
1088 30B7B1         2903                              jnb            p3.7,lefcur
108B 75B0F7         2904                              mov            p3,#0f7h
108E 20B79F         2905                              jb             p3.7,rgoto7
                    2906                              ;запомнить номер ячейки конца блока
1091 7634           2907                              mov    @r0,#34h
1093 7F0A           2908     INTn:                   mov             r7,#10
1095 7853           2909                                     mov             r0,#adec
1097 120000   F     2910                                     call    clearN
109A 120000   F     2911                                     call    upak3                   
109D 784F           2912                                     mov             r0,#abin
109F 7953           2913                                     mov             r1,#adec                        ;мл        
                              ст
10A1 120000   F     2914                                     call    decbin                  ;abin..abin+3 (hex)
10A4 120000   F     2915                                     call    loadr2                  ;r2..r5
10A7 120402         2916                                     call    altof                   ;r2..r5->int
10AA 020000   F     2917     dgoto7:                  jmp            goto7
                    2918     
10AD B63415         2919     nom33:          cjne            @r0,#34h,labelP
10B0 75B0FB         2920                               mov           p3,#0fbh
10B3 30B786         2921                              jnb            p3.7,lefcur
10B6 75B0F7         2922                              mov            p3,#0f7h
10B9 20B7EE         2923                              jb             p3.7,dgoto7
10BC 76FF           2924                              mov            @r0,#0ffh
                    2925                              ;T1<-число на индикаторе
10BE C20B           2926                              clr            bitmem            ;vvod КОН БЛ 000
10C0 D204           2927                              setb           bitizm
                    2928                                     
10C2 020000   F     2929                             jmp        goto7
10C5                2930     labelP:                                                         
                    2931     ;;;;;;;
10C5                2932     labelI:
10C5 75B0FE         2933                                     mov             p3,#0feh
10C8 E5B0           2934                                     mov             a,p3
10CA 20E703         2935                                     jb              acc.7,nopoint
                    2936                                     ;
10CD 020000   F     2937                                     jmp             goto7;out7
10D0 75B0FB         2938     nopoint:                mov             p3,#0fbh
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    46

10D3 E5B0           2939                                     mov             a,p3
10D5 20E711         2940                                     jb              acc.7,nopoin7
10D8 78B2           2941                                     mov             r0,#marker
10DA B60405         2942                                     cjne    @r0,#4,nomarl
10DD 7609           2943                                     mov             @r0,#9
10DF 020000   F     2944                                     jmp             goto7;  out7
                    2945     
10E2 16             2946     nomarl:                 dec             @r0                             ;нажата кн <- при в
                             воде цифр A=000000
10E3 C219           2947                                     clr             bitmig
10E5 B6034F         2948                                     cjne    @r0,#3,out7
10E8 06             2949                                     inc             @r0
                    2950     ;нажат ввод А =000000 запомнить константу А
10E9 75B0F7         2951     nopoin7:           mov          p3,#0f7h
10EC E5B0           2952                                     mov             a,p3
10EE 20E746         2953                                     jb              acc.7,out7
10F1 78B1           2954                                     mov             r0,#vichR
10F3 E6             2955                                     mov             a,@r0
10F4 B62120         2956                                     cjne    @r0,#21h,no21p7
10F7 7631           2957                                     mov             @r0,#31h
                    2958                             ;       считать с индикатора  упаковать в плавающий формат
                    2959                             ;   сохранить
10F9 120000   F     2960                                     call    upak                    
10FC 784F           2961                                     mov             r0,#abin
10FE 7953           2962                                     mov             r1,#adec                        ;мл        
                              ст
1100 120000   F     2963                                     call    decbin                  ;abin..abin+3 (hex)
1103 120000   F     2964                                     call    loadr2                  ;r2..r5
1106 120402         2965                                     call    altof                   ;r2..r5->int
1109 78BC           2966                                     mov             r0,#konstA
110B 120000   F     2967                                     call    saver2
                    2968     
                    2969                                     
110E 900000   F     2970                                     mov             dptr,#teBequ0
1111 120000   F     2971                                     call    lotext
                    2972                                     
1114 020000   F     2973                                     jmp             goto7;out7
                    2974     
1117                2975     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    2976                             ;   сохранить
1117 120000   F     2977                                     call    upak                    
111A 784F           2978                                     mov             r0,#abin
111C 7953           2979                                     mov             r1,#adec                        ;мл        
                              ст
111E 120000   F     2980                                     call    decbin                  ;abin..abin+3 (hex)
1121 120000   F     2981                                     call    loadr2                  ;r2..r5
1124 120402         2982                                     call    altof                   ;r2..r5->int
1127 78C0           2983                                     mov             r0,#konstB
1129 120000   F     2984                                     call    saver2
                    2985     
112C 79B2           2986                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
112E 77FF           2987                                     mov             @r1,#0ffh
1130 78B1           2988                                     mov             r0,#vichR
1132 7611           2989                                     mov             @r0,#11h
1134 020000   F     2990                                jmp          lovich     ;ВЫЧИСЛИТЬ
                    2991     
                    2992     
1137                2993     out7:                   ;mov            IE,#80h
1137 D007           2994                                     pop             rr7     
1139 D006           2995                                     pop             rr6
113B D005           2996                                     pop             rr5
113D D004           2997                                     pop             rr4
113F D003           2998                                     pop             rr3
1141 D002           2999                                     pop             rr2
1143 D001           3000                                     pop             rr1                             
1145 D000           3001                                     pop             rr0
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    47

1147 D0D0           3002                                     pop             psw
1149 D0E0           3003                                     pop             acc
114B E5AD           3004                                     mov             a,P3IF
114D 547F           3005                                     anl             a,#7fh
114F F5AD           3006                                     mov             P3IF,a
1151 75B0C0         3007                                     mov             P3,#0c0h
1154 75E730         3008                                     mov             EIE2,#30H
1157 32             3009                                     reti
                    3010     
1158 79AE           3011     loadUS:         mov             r1,#diap
115A E7             3012                             mov             a,@r1
115B 23             3013                             rl              a;*2
115C FC             3014                             mov             r4,a                    ;save a
115D 900000   F     3015                             mov             dptr,#tabus
1160 93             3016                             movc    a,@a+dptr
1161 FA             3017                             mov             r2,a                    ;high byte
1162 E584           3018                             mov             a,p4
1164 5401           3019                             anl             a,#01
1166 4A             3020                             orl             a,r2
1167 F584           3021                             mov             p4,a
1169 0C             3022                             inc             r4
116A EC             3023                             mov             a,r4
116B 93             3024                             movc    a,@a+dptr
116C FB             3025                             mov             r3,a                    ;low byte
116D E585           3026                             mov             a,p5
116F 5401           3027                             anl             a,#01
1171 4B             3028                             orl             a,r3
1172 F585           3029                             mov             p5,a
1174 799A           3030                             mov             r1,#parT
1176 B7010E         3031                             cjne    @r1,#1,bret
1179 79AE           3032                             mov             r1,#diap                  ;10s (parT=1)
117B 7405           3033                             mov             a,#5                      ;10-8..10-11 p4.1=1
117D C3             3034                             clr             c
117E 97             3035                             subb    a,@r1
117F 5006           3036                             jnc             bret
1181 E584           3037                             mov             a,p4
1183 4402           3038                             orl             a,#02
1185 F584           3039                             mov             p4,a                     ;10-8..10-11 p4.1=1
1187 120000   F     3040     bret:      call          louizm         ;us если вкл кн ИЗМЕР
118A 22             3041                             ret
                    3042     
                    3043                             
                    3044     ;загр ус для кор 0,тестов ацп и т.д.
                    3045     ;dptr-
118B E4             3046     lospus:         clr             a
                    3047                             ;movc   a,@a+dptr
                    3048                             ;mov            r2,a                    ;high byte
                    3049                             ;mov            a,p4
                    3050                             ;anl            a,#01
                    3051                             ;orl            a,r2
                    3052                             ;mov            p4,a
                    3053                             ;inc            dptr
118C E4             3054                             clr             a
118D 93             3055                             movc    a,@a+dptr
118E FB             3056                             mov             r3,a                    ;low byte
118F E585           3057                             mov             a,p5
1191 54BF           3058                             anl             a,#0bfh;01
1193 4B             3059                             orl             a,r3
1194 F585           3060                             mov             p5,a
1196 22             3061                             ret
                    3062     
1197 80             3063     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                    3064     
                    3065     ;us кнопка измерения выкл
1198 88D6           3066     tabus:     db           88h,0d6h         ;10-2
119A 88F6           3067                             db      88h,0f6h         ;10-3
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    48

119C 88D6           3068                             db              88h,0d6h         ;10-4
119E 88F6           3069                             db              88h,0f6h         ;10-5
11A0 9AD6           3070                             db      9ah,0d6h         ;10-6
11A2 9AF6           3071                             db              9ah,0f6h         ;10-7
11A4 ACD6           3072                             db              0ach,0d6h        ;10-8
11A6 ACF6           3073                             db      0ach,0f6h        ;10-9
11A8 C8D6           3074                             db              0c8h,0d6h        ;10-10
11AA C8F6           3075                             db              0c8h,0f6h        ;10-11
                    3076     
                    3077     
                    3078      ;загрузка текста в буфер 2 bufind+0..bufind9
                    3079     ;в зав от parT (Tизм)
11AC 79B7           3080     loadT:          mov             r1,#load;parT
11AE 7840           3081     lolevT:         mov             r0,#bufind+0
11B0 7B0A           3082                             mov             r3,#10
11B2 75F00A         3083                             mov             b,#10
11B5 E7             3084                             mov             a,@r1
11B6 A4             3085                             mul             ab
11B7 FC             3086                             mov             r4,a                    ;save a
11B8 900000   F     3087                             mov             dptr,#textT
11BB 93             3088             lod1:   movc    a,@a+dptr
11BC F6             3089                             mov             @r0,a
11BD 08             3090                             inc             r0
11BE 0C             3091                             inc             r4
11BF EC             3092                             mov             a,r4
11C0 DBF9           3093                             djnz    r3,lod1
11C2 22             3094                             ret     
                    3095     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                    3096     ;dptr-адр строки текста         
11C3                3097     lotext:         
11C3 7B0A           3098                             mov             r3,#10
11C5 7840           3099                             mov             r0,#bufind+0
11C7 E4             3100     lodt:           clr             a
11C8 93             3101                             movc    a,@a+dptr
11C9 F6             3102                             mov             @r0,a
11CA 08             3103                             inc             r0
11CB A3             3104                             inc             dptr
11CC DBF9           3105                             djnz    r3,lodt
11CE 22             3106                             ret                                     
                    3107                                     
11CF                3108     textT:          
11CF FD543D32       3109                             db              0fdh,"T","=",32h,"m","S",0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
11D3 6D53FDFD                
11D7 FDFD                    
11D9 FD543D31       3110                             db              0fdh,"T","=",31h,30h,"m","S",0fdh,0fdh,0fdh
11DD 306D53FD                
11E1 FDFD                    
11E3 FD543D35       3111                             db              0fdh,"T","=",35h,30h,"m","S",0fdh,0fdh,0fdh
11E7 306D53FD                
11EB FDFD                    
11ED FD543D30       3112                             db              0fdh,"T","=",30h,".",31h,"S",0fdh,0fdh,0fdh
11F1 2E3153FD                
11F5 FDFD                    
11F7 20202054       3113                             db              " "," "," ","T","=",31h,"S"," "," "," "
11FB 3D315320                
11FF 2020                    
1201 2020543D       3114                             db              " "," ","T","=",31h,30h,"S"," "," "," "  
1205 31305320                
1209 2020                    
                    3115     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                    3116     
120B 42753474       3117      teVICH:        db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
120F 79767454                
1213 7720                    
1215 20413D2B       3118      teAequ0:       db              " ",'A','=','+',30h,30h,30h,30h,30h,30h
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    49

1219 30303030                
121D 3030                    
121F 20423D2B       3119      teBequ0:       db              " ",'B','=','+',30h,30h,30h,30h,30h,30h
1223 30303030                
1227 3030                    
1229 20207145       3120      teMENU:        db              " "," ",71h,"E","H",72h," "," "," "," "
122D 48722020                
1231 2020                    
                    3121     
1233 20205445       3122      teTEST:        db      " "," ","T","E",79h,"T"," "," "," "," "
1237 79542020                
123B 2020                    
                    3123     
123D 204B4176       3124      teKALIB:        db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР
1241 74735020                
1245 202020                  
1248 74337120       3125      teIZMK:        db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
124C 4B304879                
1250 5420                    
1252 20204275       3126      teOUT:         db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
1256 58307820                
125A 2020                    
125C 2020304C       3127      teOLL:         db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
1260 4C202020                
1264 2020                    
1266 20203034       3128      teCLE:         db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
126A 7479544B                
126E 4120                    
1270 20203041       3129      teMEM:         db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
1274 71795420                
1278 20203341       3130      teWR:          db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
127C 61747977                
1280 2020                    
1282 20206150       3131      teLIST:        db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
1286 30797130                
128A 545020                  
128D 20206130       3132      teFULL:        db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
1291 76484162                
1295 2020                    
1297 20207376       3133      teBLOK:        db      " "," ",73h,76h,30h,'K'," ",30h,30h," ";БЛОК 00
129B 304B2030                
129F 3020                    
12A1 20207376       3134      teBL:          db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
12A5 304B2020                
12A9 2020                    
12AB 48413420       3135      tebBL:         db      "H",'A',34h," ",73h,76h," ",30h,30h,30h; НАЧ БЛОК 000
12AF 73762030                
12B3 3030                    
12B5 4B304820       3136      teeBL:         db      "K",30h,"H"," ",73h,76h," ",30h,30h,30h; КОН БЛОК 000
12B9 73762030                
12BD 3030                    
                    3137      ;;;;;;;;;;;;;;;;;;;         
                    3138     ;управление AD7731
                    3139     ;r4=b1 r5=b2
12BF                3140     iniacp: ;управление AD7731
12BF 7403           3141                             mov             a,#03
                    3142     
12C1 120000   F     3143                             call    write
12C4 EC             3144                             mov             a,r4;#80h
12C5 120000   F     3145                             call    write
12C8 ED             3146                             mov             a,r5;#04
12C9 120000   F     3147                             call    write
12CC 7402           3148                             mov             a,#02
12CE 120000   F     3149                             call    write
12D1 74A1           3150                             mov             a,#0a1h
12D3 120000   F     3151                             call    write
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    50

12D6 7474           3152                             mov             a,#74h
12D8 120000   F     3153                             call    write
12DB 2095FD         3154                             jb              p1.5,$;p1.3,$
12DE 7402           3155                             mov             a,#02
12E0 120000   F     3156                             call    write
12E3 7481           3157                             mov             a,#81h
12E5 120000   F     3158                             call    write
12E8 7474           3159                             mov             a,#74h
12EA 120000   F     3160                             call    write
12ED 2095FD         3161                             jb              p1.5,$;p1.3,$
12F0 7402           3162                             mov             a,#02
12F2 120000   F     3163                             call    write
12F5 7421           3164                             mov             a,#21h
12F7 120000   F     3165                             call    write
12FA 7474           3166                             mov             a,#74h
12FC 120000   F     3167                             call    write
12FF 22             3168                             ret
                    3169                             ;;;;;;;;;;;;;;;;
                    3170     ;;;;;;;;;;;;;;;;;
1300 0000           3171     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
1302 6004           3172                                     db              60h,04h;40h,04h         ;10s
1304 6000           3173                                     db              60h,00;40h,04h          ;1s
1306 4004           3174                                     db              40h,04h         ;0,1s
1308 2004           3175                                     db              20h,04h         ;50ms
130A 2004           3176                                     db              20h,04h          ;10ms
130C 1332           3177                                     db              13h,32h         ;2ms
                    3178     ;загр В1,В2 в завис от Т                                
130E 799A           3179     loab12:                 mov             r1,#parT
1310 900000   F     3180                                     mov             dptr,#tabB1_2
1313 E7             3181                                     mov             a,@r1
1314 23             3182                                     rl              a;*2
1315 FF             3183                                     mov             r7,a                    ;save a
1316 93             3184                                     movc    a,@a+dptr
1317 FC             3185                                     mov             r4,a   ;b1
1318 0F             3186                                     inc             r7
1319 EF             3187                                     mov             a,r7
131A 93             3188                                     movc    a,@a+dptr
131B FD             3189                                     mov             r5,a
                    3190                                     ;после загр В1,2 загр упр слово для нового Т
                    3191                             
131C 22             3192                                     ret
                    3193     
                    3194     
                    3195     
                    3196     ;пп мигания индикации
131D 78B2           3197     mign:           mov             r0,#marker
                    3198                                     
131F B6FF03         3199                                     cjne    @r0,#0ffh,mignn
                    3200                                     ;реж изм мигает *
1322 C219           3201                                     clr             bitmig
1324 22             3202                                     ret
                    3203     
1325                3204     mignn:                  ;clr            c
1325 7440           3205                                     mov             a,#bufind
1327 26             3206                                     add             a,@r0                   ;a=bufind+marker
1328 F9             3207                                     mov             r1,a
1329 201907         3208                                     jb              bitmig,onmig
132C 873C           3209                                     mov             savba,@r1
                    3210                             ;       mov             a,@r1
                    3211                             ;       mov             savba,a
132E 7720           3212                                     mov             @r1,#" "
1330 D219           3213                                     setb    bitmig
1332 22             3214                                     ret
                    3215     
1333 A73C           3216     onmig:                  mov             @r1,savba
                    3217                                     ;mov            a,savba
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    51

                    3218                                     ; mov           @r1,a
1335 C219           3219                                     clr             bitmig
1337 120000   F     3220                                     call    z_01s
                    3221                                     
133A 22             3222                                     ret
                    3223     ;bufind=30h..39h                                                                           
                                           ;
133B C219           3224     vvchif:                 clr             bitmig
133D 79B2           3225                                     mov             r1,#marker
133F E7             3226                                     mov             a,@r1                   ;изм цифры
1340 7840           3227                                     mov             r0,#bufind                      ;0000
1342 28             3228                                     add             a,r0
1343 F8             3229                                     mov             r0,a
1344 06             3230                                     inc             @r0
1345 B63A02         3231                                     cjne    @r0,#3ah,chif
1348 7630           3232                                     mov             @r0,#30h
134A                3233     chif:   
134A 22             3234                             ret
                    3235     
                    3236       ;перевод маркера влево
134B                3237     marle:  
134B C219           3238                     clr             bitmig
                    3239                     ;mov            savba,#0   нельзя обнулять
134D 78B2           3240             mov             r0,#marker
134F 16             3241                     dec             @r0
1350 E6             3242                     mov             a,@r0
1351 C3             3243                     clr             c
1352 953A           3244                     subb    a,movleft         ;крайне левое положение
1354 5001           3245                     jnc             rler
1356 06             3246                     inc             @r0
1357 22             3247     rler:   ret
                    3248         
                    3249     ;перевод маркера вправо
1358 C219           3250     marri:  clr             bitmig
135A 78B2           3251                     mov             r0,#marker
135C 06             3252                     inc         @r0
135D E53B           3253                     mov             a,movrig           ;крайне правое положение
135F C3             3254                     clr             c
1360 96             3255                     subb    a,@r0
1361 5001           3256                     jnc             rrir
1363 16             3257                     dec             @r0
1364 22             3258     rrir:   ret
                    3259         
                    3260     
                    3261     
                    3262     
1365 7852           3263     loadr2: mov             r0,#abin+3              ;r2..r5
1367 E6             3264                     mov             a,@r0                   ; ст мл   
1368 FA             3265                     mov             r2,a
1369 18             3266                     dec             r0
136A E6             3267                     mov             a,@r0
136B FB             3268                     mov             r3,a
136C 18             3269                     dec             r0
136D E6             3270                     mov             a,@r0
136E FC             3271                     mov             r4,a
136F 18             3272                     dec             r0
1370 E6             3273                     mov             a,@r0
1371 FD             3274                     mov             r5,a
1372 22             3275                     ret
                    3276                                             
                    3277      ;;;;;;;;;;;;;;;;;;;      
                    3278      ;загрузка KD в зависимости от диап изм  
                    3279      ;koef->r8..r11
1373 78AE           3280     loadKD:                 mov             r0,#diap
1375 E6             3281                                     mov             a,@r0
1376 900000   F     3282                                     mov             dptr,#diKDn
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    52

1379 75F004         3283                                     mov             b,#4
137C A4             3284                                     mul             ab
137D FF             3285                                     mov             r7,a;save
137E 93             3286                                     movc    a,@a+dptr
137F F508           3287                                     mov             r8,a
1381 A3             3288                                     inc             dptr
1382 EF             3289                                     mov             a,r7
1383 93             3290                                     movc    a,@a+dptr
1384 F509           3291                                     mov             r9,a
1386 A3             3292                                     inc             dptr
1387 EF             3293                                     mov             a,r7
1388 93             3294                                     movc    a,@a+dptr
1389 F50A           3295                                     mov             r10,a
138B A3             3296                                     inc             dptr
138C EF             3297                                     mov             a,r7
138D 93             3298                                     movc    a,@a+dptr
138E F50B           3299                                     mov             r11,a
1390 22             3300                                     ret
                    3301     
1391                3302      diKDn: ;       db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
                    3303                     ;               db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
                    3304                     ;               db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
                    3305                     ;               db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
                    3306                     ;               db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
                    3307                     ;                db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
                    3308                     ;               db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
                    3309                     ;               db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
                    3310                     ;               db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
                    3311                     ;               db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
1391 3F800000       3312                             db              3fh,80h,00,00;3fh,50h,6bh,7bh;3fh,80h,00,00        
                                  ;10-2
1395 3F800000       3313                                     db      3fh,80h,00,00;3fh,50h,7fh,0cch;3fh,80h,00,00       
                                  ;10-3
1399 3F800000       3314                                     db              3fh,80h,00,00;3fh,4fh,9dh,0bh;3fh,80h,00,00
                                          ;10-4
139D 3F800000       3315                                     db              3fh,80h,00,00;3fh,4fh,0e8h,69h;3fh,80h,00,0
                             0            ;10-5
13A1 3F800000       3316                                     db              3fh,80h,00,00  ; 10-6
13A5 3F800000       3317                                      db             3fh,80h,00,00;3fh,50h,63h,9eh;3fh,80h,00,00
                                          ;10-7
13A9 3F800000       3318                                     db              3fh,80h,00,00;3fh,4bh,0c9h,0f0h;3fh,80h,00,
                             00           ;10-8
13AD 3F800000       3319                                     db              3fh,80h,00,00;3fh,4ch,06h,3bh;3fh,80h,00,00
                                          ;10-9
13B1 3F800000       3320                                     db              3fh,80h,00,00;3fh,50h,0efh,0ddh;3fh,80h,00,
                             00           ;10-10
13B5 3F800000       3321                                     db      3fh,80h,00,00;  3fh,63h,0e0h,00
                    3322      
                    3323                             
13B9 00000039       3324     ch57:   db      00,00,00,39h;57
13BD 00000014       3325     ch20:   db      00,00,00,14h;20
                    3326                     
                    3327     ;$include (d:\amp\subr2.asm) 
                +1  3328      ;задержка 100 мкс
13C1 7978       +1  3329     z_100:    mov R1,#78h     ;загрузка первого числа
13C3 7A02       +1  3330     z100:     mov R2,#2h     ;загрузка второго числа
13C5 DAFE       +1  3331     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    53

13C7 D9FA       +1  3332               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
13C9 22         +1  3333               ret           
                +1  3334     
                +1  3335     ;задержка 34 мкс
13CA 7B8B       +1  3336     z_5:      mov R3,#8Bh      ;загрузка числа
13CC DBFE       +1  3337     ct:       djnz R3,ct
13CE 22         +1  3338               ret
                +1  3339     
                +1  3340     ;задержка 15 мс
13CF 79FA       +1  3341     z_15:     mov R1,#0FAh    ;загрузка первого числа
13D1 7AED       +1  3342     z15:      mov R2,#0EDh   ;загрузка второго числа
13D3 DAFE       +1  3343     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
13D5 D9FA       +1  3344               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
13D7 22         +1  3345               ret   
                +1  3346                                               
                +1  3347      ;задержка 1 мс
13D8 7910       +1  3348     z_1ms:     mov R1,#10h     
13DA 7AED       +1  3349     ss1:       mov R2,#0EDh    
13DC DAFE       +1  3350                djnz R2, $    
13DE D9FA       +1  3351                djnz R1, ss1   
13E0 22         +1  3352                ret   
                +1  3353     
                +1  3354      ;????????
                +1  3355     ;задержка 1с
13E1 7D1F       +1  3356     z_1s:   mov             r5,#01fh 
13E3 7EFF       +1  3357     co2s:   mov     R6,#0ffh     
13E5 7FFF       +1  3358     z1s:     mov    R7,#0ffh     
13E7 DFFE       +1  3359     co1s:   djnz    R7, co1s        
13E9 DEFA       +1  3360             djnz    R6, z1s 
13EB DDF6       +1  3361                     djnz    r5,co2s
13ED 22         +1  3362               ret
                +1  3363     ;задержка 0,1с
13EE 7D03       +1  3364     z_01s:           mov            r5,#03h 
13F0 7EFF       +1  3365     co02s:          mov     R6,#0ffh     
13F2 7FFF       +1  3366     z01s:           mov     R7,#0ffh     
13F4 DFFE       +1  3367                             djnz    R7, $   
13F6 DEFA       +1  3368                     djnz    R6, z01s 
13F8 DDF6       +1  3369                             djnz    r5,co02s
13FA 22         +1  3370                      ret              
13FB 000007FF   +1  3371     chzap:  db      00,00,07h,0ffh             
13FF 00000000   +1  3372     ch0:    db      00,00,00,00
1403 0000000A   +1  3373     ch10:   db      00,00,00,0ah                            ;10
1407 00000005   +1  3374     ch5:    db      00,00,00,05                                             ;5
140B 000003B9   +1  3375     ch954:  db 00,00,03,0b9h                                                ;954
140F 000003E8   +1  3376     ch10000:        db 00,00,03h,0e8h                                               ;10000
1413 00000064   +1  3377     ch100:  db 00,00,00,64h ;100
1417 00000002   +1  3378     ch2:    db      00,00,00,02                                             
                +1  3379     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  3380     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  3381     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
141B 00000001   +1  3382     ch1:    db  00,00,00,01
141F 3F800000   +1  3383     ch_1:   db      3fh,80h,00,00                   
1423 3F741EDF   +1  3384     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
1427 47C35000   +1  3385     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
142B 3F800347   +1  3386     KD:             db      3fh,80h,03h,47h;1,0001
142F 48435000   +1  3387     CH2tho: db      48h,43h,50h,00;200000
1433 4856D800   +1  3388     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
1437 4856D800   +1  3389     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
143B 461C4000   +1  3390     ch_10th:db  46h,1ch,40h,00;10000-2710h
                +1  3391     
                +1  3392     ;r1- мл байт 2х байтного числа
143F            +1  3393     tenmin:         ;-10
143F C3         +1  3394                             clr             c
1440 E7         +1  3395                     mov             a,@r1
1441 940A       +1  3396                             subb    a,#10
1443 F7         +1  3397                             mov             @r1,a
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    54

1444 19         +1  3398                             dec             r1
1445 E7         +1  3399                             mov             a,@r1
1446 9400       +1  3400                             subb    a,#0
1448 F7         +1  3401                             mov             @r1,a
1449 22         +1  3402                             ret
                +1  3403       ;r0-обнуление ячеек памяти  
144A 7F04       +1  3404       clear4:        mov    r7,#4
144C E4         +1  3405                             clr             a
144D F6         +1  3406       cl4:          mov             @r0,a
144E 08         +1  3407                             inc             r0
144F DFFC       +1  3408                             djnz    r7,cl4
1451 22         +1  3409                             ret     
                +1  3410     
                +1  3411      ;r0-обнуление ячеек памяти 
                +1  3412      ;R7- 
1452            +1  3413       clearN:        
1452 E4         +1  3414                             clr             a
1453 F6         +1  3415       cl4N:         mov             @r0,a
1454 08         +1  3416                             inc             r0
1455 DFFC       +1  3417                             djnz    r7,cl4N
1457 22         +1  3418                             ret     
                +1  3419     
                +1  3420       ;чтение номера байта с индикатора(2байта)
                +1  3421     ;bufind+8..bufind+9
                +1  3422     ;-  - - -
                +1  3423     ;- - - - - - - - - -
                +1  3424     ;adec..adec+9
                +1  3425     ;ст            мл
1458 7848       +1  3426     upak2:  mov             r0,#bufind+8;
145A 795C       +1  3427                     mov             r1,#adec+9
145C 7F02       +1  3428                     mov             r7,#2;2bait
145E C3         +1  3429     upa2:   clr             c
145F E6         +1  3430                     mov             a,@r0
1460 9430       +1  3431                     subb    a,#30h
1462 F7         +1  3432                     mov             @r1,a
1463 18         +1  3433                     dec             r0
1464 19         +1  3434                     dec             r1
1465 DFF7       +1  3435                     djnz    r7,upa2
1467 22         +1  3436                     ret  
                +1  3437         
                +1  3438      ;bufind+4..bufind+9
                +1  3439     ;-  - - -
                +1  3440     ;- - - - - - - - - -
                +1  3441     ;adec..adec+9
                +1  3442     ;ст            мл
1468 7849       +1  3443     upak:   mov             r0,#bufind+9;
146A 795C       +1  3444                     mov             r1,#adec+9
146C 7F06       +1  3445                     mov             r7,#6
146E C3         +1  3446     upa:    clr             c
146F E6         +1  3447                     mov             a,@r0
1470 9430       +1  3448                     subb    a,#30h
1472 F7         +1  3449                     mov             @r1,a
1473 18         +1  3450                     dec             r0
1474 19         +1  3451                     dec             r1
1475 DFF7       +1  3452                     djnz    r7,upa
1477 22         +1  3453                     ret
                +1  3454     
                +1  3455      ;чтение номера байта с индикатора(3байта)
                +1  3456     ;bufind+3..bufind+9
                +1  3457     ;-  - - -
                +1  3458     ;- - - - - - - - - -
                +1  3459     ;adec..adec+9
                +1  3460     ;ст            мл
1478 7849       +1  3461     upak3:  mov             r0,#bufind+9;
147A 795C       +1  3462                     mov             r1,#adec+9
147C 7F03       +1  3463                     mov             r7,#3;3bait
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    55

147E C3         +1  3464     upa1:   clr             c
147F E6         +1  3465                     mov             a,@r0
1480 9430       +1  3466                     subb    a,#30h
1482 F7         +1  3467                     mov             @r1,a
1483 18         +1  3468                     dec             r0
1484 19         +1  3469                     dec             r1
1485 DFF7       +1  3470                     djnz    r7,upa1
1487 22         +1  3471                     ret
                +1  3472     
                +1  3473     ;вых-r2,r3-адрес ячее памяти прогр
1488            +1  3474     findkoef:
1488 79AE       +1  3475                                     mov             r1,#diap
148A E7         +1  3476                                     mov             a,@r1
148B 23         +1  3477                                     rl              a                                          
                                          ;diap*2(2bait )
148C FC         +1  3478                                     mov             r4,a                                    ;sa
                             ve
148D 900000   F +1  3479                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  3480                                     
1490 93         +1  3481                                     movc    a,@a+dptr                       ;ст байт
1491 FA         +1  3482                                     mov             r2,a
1492 A3         +1  3483                                     inc             dptr
1493 EC         +1  3484                                     mov             a,r4
1494 93         +1  3485                                     movc    a,@a+dptr
1495 FB         +1  3486                                     mov             r3,a                    ;мл байт
1496 22         +1  3487                                     ret
                +1  3488     
                +1  3489     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  3490     ;(5000h..5027h)
1497 5000       +1  3491     diKDw:  dw              5000h                   ;10-2
1499 5004       +1  3492                                     dw              5004h                   ;10-3
149B 5008       +1  3493                                     dw              5008h                   ;10-4
149D 500C       +1  3494                                     dw              500ch                   ;10-5
149F 5010       +1  3495                                     dw              5010h                   ;10-6
14A1 5014       +1  3496                                     dw              5014h                   ;10-7
14A3 5018       +1  3497                                     dw              5018h                   ;10-8
14A5 501C       +1  3498                                     dw              501ch                   ;10-9
14A7 5020       +1  3499                                     dw              5020h                   ;10-10
14A9 5024       +1  3500                                     dw              5024h                   ;10-11
14AB 5028       +1  3501     dipar:  dw              5028h                   ;parol
                +1  3502     
14AD 000186A0   +1  3503     chthou: db      00,01,86h,0a0h  ;100.000
                +1  3504     
14B1 AA08       +1  3505     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
14B3 AB09       +1  3506                                             mov     r3,ltemp+1
14B5 AC0A       +1  3507                                             mov     r4,ltemp+2
14B7 AD0B       +1  3508                                             mov     r5,ltemp+3
14B9 22         +1  3509                                             ret
                    3510     
                    3511     ;$include (d:\amp\\sarifm3.asm) 
                +1  3512     ; ” ©« SARIFM.ASM 8.11.95
                +1  3513     ;файл арифметики
                +1  3514       
  0008          +1  3515     ltemp    equ       8           ;long temporary
  000C          +1  3516     xtemp    equ       12          ;other temporaries
  000A          +1  3517     DECSIZE  EQU       10
  0004          +1  3518     NUMSIZE  EQU       4
  0004          +1  3519     RR4  EQU       4
  0005          +1  3520     RR5  EQU       5
                +1  3521     
                +1  3522                                                     
                +1  3523     
                +1  3524                 ; rseg     ARIF          ; Switch to this code segment.
                +1  3525     ;             using    0              ; Specify register bank for the following
                +1  3526                                            ; program code.
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    56

                +1  3527     ;                                               cseg AT 400h
                +1  3528     ; Arithmetics:  CLEARING string
                +1  3529     ; Input:
                +1  3530     ; R0 - pointer to string,
                +1  3531     ; NUMSIZE - byte count if CLRNUM used,
                +1  3532     ; DECSIZE - byte count if CLRDEC used,
                +1  3533     ; R2 - byte count if CLEAR used;
                +1  3534     ; Output:  none.
                +1  3535     
14BA            +1  3536     CLRDEC:
14BA 7A0A       +1  3537         MOV R2, #DECSIZE
14BC 8002       +1  3538         SJMP    CLEAR
14BE            +1  3539     CLRNUM:
14BE 7A04       +1  3540         MOV R2, #NUMSIZE
                +1  3541         ;JMP    CLEAR
14C0            +1  3542     CLEAR:
14C0 E4         +1  3543         CLR A
14C1 F6         +1  3544     CLR11:  MOV @R0, A
14C2 08         +1  3545         INC R0
14C3 DAFC       +1  3546         DJNZ    R2, CLR11
14C5 22         +1  3547         RET
                +1  3548     
                +1  3549     ;**********************************
                +1  3550     ;mov    r1,#abin+3
                +1  3551     ;mov    r0,#adec
                +1  3552     ; _ _ _ _
                +1  3553     ;     03ff
                +1  3554     ;ст     мл   - вход
                +1  3555     ; _ _ _ _ _ _ _ _ _ _
                +1  3556     ;             1 0 2 3
                +1  3557     ;ст                мл 
                +1  3558     ;**********************************
                +1  3559     
14C6            +1  3560     BINDEC:
                +1  3561     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  3562     ; Input:
                +1  3563     ; R0 - pointer to destination (high digit is the first),
                +1  3564     ; R1 - pointer to source,
                +1  3565     ; NUMSIZE - byte count in binary number;
                +1  3566     ; DECSIZE - byte count in decimal number;
                +1  3567     ; Output:  none.
                +1  3568     ; Source saved
                +1  3569     
                +1  3570         ; 1. Clear result
14C6 7A05       +1  3571         MOV R2, #DECSIZE/2
14C8 120000   F +1  3572         CALL   CLEAR  ; incrementing R0
                +1  3573     
                +1  3574         ; 2. Prepare convertion
14CB 18         +1  3575         DEC R0
14CC 8804       +1  3576         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
14CE 8905       +1  3577         MOV RR5, R1 ; R5 - pointer to low byte of binary number
14D0 7B20       +1  3578         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  3579     
                +1  3580         ; 3. Convert cyrcle
14D2            +1  3581     BIN30:
                +1  3582     
                +1  3583         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
14D2 A905       +1  3584         MOV R1, RR5
14D4 7A04       +1  3585         MOV R2, #NUMSIZE
14D6 E7         +1  3586     BIN31:  MOV A, @R1
14D7 33         +1  3587         RLC A
14D8 F7         +1  3588         MOV @R1, A
14D9 19         +1  3589         DEC R1
14DA DAFA       +1  3590         DJNZ    R2, BIN31
14DC A905       +1  3591         MOV R1, RR5
14DE E7         +1  3592         MOV A, @R1
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    57

14DF 92E0       +1  3593         MOV ACC.0, C
14E1 F7         +1  3594         MOV @R1, A
                +1  3595     
                +1  3596         ; 3.2. Doubling decimal result with <Carry>
14E2 A804       +1  3597         MOV R0, RR4
14E4 7A05       +1  3598         MOV R2, #DECSIZE/2
14E6 E6         +1  3599     BIN32:  MOV A, @R0
14E7 36         +1  3600         ADDC    A, @R0
14E8 D4         +1  3601         DA  A
14E9 F6         +1  3602         MOV @R0, A
14EA 18         +1  3603         DEC R0
14EB DAF9       +1  3604         DJNZ    R2, BIN32
                +1  3605     
                +1  3606         ; 3.3. End of convert cyrcle
14ED DBE3       +1  3607         DJNZ    R3, BIN30
                +1  3608     
                +1  3609         ; 4. Make bytes from half-bytes
14EF E8         +1  3610         MOV A, R0
14F0 240A       +1  3611         ADD A, #DECSIZE
14F2 F8         +1  3612         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
14F3 A904       +1  3613         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
14F5 7A05       +1  3614         MOV R2, #DECSIZE/2
14F7 E7         +1  3615     BIN41:  MOV A, @R1
14F8 540F       +1  3616         ANL A, #00FH
14FA F6         +1  3617         MOV @R0, A
14FB 18         +1  3618         DEC R0
14FC E7         +1  3619         MOV A, @R1
14FD C4         +1  3620         SWAP    A
14FE 540F       +1  3621         ANL A, #00FH
1500 F6         +1  3622         MOV @R0, A
1501 18         +1  3623         DEC R0
1502 19         +1  3624         DEC R1
1503 DAF2       +1  3625         DJNZ    R2, BIN41
1505 22         +1  3626         RET
                +1  3627     
                +1  3628     
                +1  3629     ;*********************************
                +1  3630     ;mov    r0,#abin
                +1  3631     ;mov    r1,#adec
                +1  3632     ; _ _ _ _       -выход
                +1  3633     ; ff0000
                +1  3634     ;0004
                +1  3635     ;мл      ст
                +1  3636     
                +1  3637     ;ст                       мл
                +1  3638     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  3639     ;                       2 5 5
                +1  3640     ;                   1 0 2 4
                +1  3641     
1506            +1  3642     DECBIN:
                +1  3643     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  3644     ; Input:
                +1  3645     ; R0 - pointer to destination,
                +1  3646     ; R1 - pointer to source (high digit is the first),
                +1  3647     ; NUMSIZE - byte count in binary number;
                +1  3648     ; DECSIZE - byte count in decimal number;
                +1  3649     ; Output:  none
                +1  3650     ; Source cleared
                +1  3651     
                +1  3652         ; 1. Clear result
1506 120000   F +1  3653         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  3654     
                +1  3655         ; 2. Prepare convertion
1509 18         +1  3656         DEC R0
150A 8804       +1  3657         MOV RR4, R0 ; R4 - pointer to high byte of binary result
150C 8905       +1  3658         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    58

150E 900000   F +1  3659         MOV DPTR, #DECT2
1511 7B20       +1  3660         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  3661     
                +1  3662         ; 3. Convert cyrcle
1513            +1  3663     DEC30:
                +1  3664     
                +1  3665         ; 3.1. Divide decimal number by 2 and prepare <Carry>
1513 C3         +1  3666         CLR C
1514 A905       +1  3667         MOV R1, RR5
1516 7A0A       +1  3668         MOV R2, #DECSIZE
1518 E7         +1  3669     DEC31:  MOV A, @R1
1519 540F       +1  3670         ANL A, #00FH
151B 92E4       +1  3671         MOV ACC.4, C
151D 93         +1  3672         MOVC    A,@A+DPTR
151E F7         +1  3673         MOV @R1, A
151F A2E7       +1  3674         MOV C, ACC.7
1521 09         +1  3675         INC R1
1522 DAF4       +1  3676         DJNZ    R2, DEC31
                +1  3677     
                +1  3678         ; 3.2. Rotate binary result one bit to right with <Carry>
1524 A804       +1  3679         MOV R0, RR4
1526 7A04       +1  3680         MOV R2, #NUMSIZE
1528 E6         +1  3681     DEC32:  MOV A, @R0
1529 13         +1  3682         RRC A
152A F6         +1  3683         MOV @R0, A
152B 18         +1  3684         DEC R0
152C DAFA       +1  3685         DJNZ    R2, DEC32
                +1  3686     
                +1  3687         ; 3.3. End of convert cyrcle
152E DBE3       +1  3688         DJNZ    R3, DEC30
1530 22         +1  3689         RET
                +1  3690     
1531 00800181   +1  3691     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
1535 02820383                
1539 0484                    
153B 00000000   +1  3692         DB  00,00,00,00,00,00
153F 0000                    
1541 05850686   +1  3693         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
1545 07870888                
1549 0989                    
                +1  3694     
                +1  3695     ;   Long comparison
                +1  3696     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  3697     ;   flags and acc set as though a long subtraction was done.
                +1  3698     ;*******************************
                +1  3699     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  3700     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  3701     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  3702     ;*******************************
154B            +1  3703     lcmp:
154B C3         +1  3704         clr c
154C EA         +1  3705         mov a,r2
154D 9508       +1  3706         subb    a,8
154F 700F       +1  3707         jnz done
1551 EB         +1  3708         mov a,r3
1552 9509       +1  3709         subb    a,9
1554 7008       +1  3710         jnz done1
1556 EC         +1  3711         mov a,r4
1557 950A       +1  3712         subb    a,10
1559 7003       +1  3713         jnz done1
155B ED         +1  3714         mov a,r5
155C 950B       +1  3715         subb    a,11
155E            +1  3716     done1:
155E C2D2       +1  3717         clr ov      ;overflow is significant only for top byte
1560            +1  3718     done:
1560 22         +1  3719         ret
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    59

                +1  3720     
                +1  3721     ;   Load long into r2-5 from [dptr]
                +1  3722     
1561            +1  3723     ldc_long:
1561 E583       +1  3724         mov a,dph       ;is it in on board memory
1563 6010       +1  3725         jz  onboard     ;yes
1565 E4         +1  3726         clr a
1566 93         +1  3727         movc    a,@a+dptr
1567 FA         +1  3728         mov r2,a
1568 7401       +1  3729         mov a,#1
156A 93         +1  3730         movc    a,@a+dptr
156B FB         +1  3731         mov r3,a
156C 7402       +1  3732         mov a,#2
156E 93         +1  3733         movc    a,@a+dptr
156F FC         +1  3734         mov r4,a
1570 7403       +1  3735         mov a,#3
1572 93         +1  3736         movc    a,@a+dptr
1573 FD         +1  3737         mov r5,a
1574 22         +1  3738         ret
1575            +1  3739     onboard:
1575 A882       +1  3740         mov r0,dpl
1577 E6         +1  3741         mov a,@r0
1578 FA         +1  3742         mov r2,a
1579 08         +1  3743         inc r0
157A E6         +1  3744         mov a,@r0
157B FB         +1  3745         mov r3,a
157C 08         +1  3746         inc r0
157D E6         +1  3747         mov a,@r0
157E FC         +1  3748         mov r4,a
157F 08         +1  3749         inc r0
1580 E6         +1  3750         mov a,@r0
1581 FD         +1  3751         mov r5,a
1582 22         +1  3752         ret
                +1  3753     
                +1  3754     ;**************************************
                +1  3755     ;загрузить ltemp...+3 из памяти программ
                +1  3756     ;mov    dptr,#CH5
                +1  3757     ;call   ldc_ltemp        ltemp <--5
                +1  3758     ;**************************************
1583            +1  3759     ldc_ltemp:
1583 E583       +1  3760         mov a,dph       ;is it in on board memory
1585 6014       +1  3761         jz  oboard      ;yes
1587 E4         +1  3762         clr a
1588 93         +1  3763         movc    a,@a+dptr
1589 F508       +1  3764         mov 8,a
158B 7401       +1  3765         mov a,#1
158D 93         +1  3766         movc    a,@a+dptr
158E F509       +1  3767         mov 9,a
1590 7402       +1  3768         mov a,#2
1592 93         +1  3769         movc    a,@a+dptr
1593 F50A       +1  3770         mov 10,a
1595 7403       +1  3771         mov a,#3
1597 93         +1  3772         movc    a,@a+dptr
1598 F50B       +1  3773         mov 11,a
159A 22         +1  3774         ret
159B            +1  3775     oboard:
159B A882       +1  3776         mov r0,dpl
159D 8608       +1  3777         mov 8,@r0
159F 08         +1  3778         inc r0
15A0 8609       +1  3779         mov 9,@r0
15A2 08         +1  3780         inc r0
15A3 860A       +1  3781         mov 10,@r0
15A5 08         +1  3782         inc r0
15A6 860B       +1  3783         mov 11,@r0
15A8 22         +1  3784         ret
                +1  3785     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    60

                +1  3786     ;*****************************
                +1  3787     ;mov    dptr,#k1
                +1  3788     ;call   ldx_long
                +1  3789     ;k1->r2..r5
                +1  3790     ;*****************************
                +1  3791     ;   Load long into r2-5 from [dptr]
                +1  3792     ;
                +1  3793     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
15A9            +1  3794     ldx_long:
15A9 E583       +1  3795         mov a,dph       ;is it in on board memory
15AB 6014       +1  3796         jz  onboar1        ;yes
15AD C082       +1  3797         push    dpl
15AF C083       +1  3798         push    dph
15B1 E0         +1  3799         movx    a,@dptr
15B2 FA         +1  3800         mov r2,a
15B3 A3         +1  3801         inc dptr
15B4 E0         +1  3802         movx    a,@dptr
15B5 FB         +1  3803         mov r3,a
15B6 A3         +1  3804         inc dptr
15B7 E0         +1  3805         movx    a,@dptr
15B8 FC         +1  3806         mov r4,a
15B9 A3         +1  3807         inc dptr
15BA E0         +1  3808         movx    a,@dptr
15BB FD         +1  3809         mov r5,a
15BC D083       +1  3810         pop dph
15BE D082       +1  3811         pop dpl
15C0 22         +1  3812         ret
15C1            +1  3813     onboar1:
15C1 A882       +1  3814         mov r0,dpl
15C3 E6         +1  3815         mov a,@r0
15C4 FA         +1  3816         mov r2,a
15C5 08         +1  3817         inc r0
15C6 E6         +1  3818         mov a,@r0
15C7 FB         +1  3819         mov r3,a
15C8 08         +1  3820         inc r0
15C9 E6         +1  3821         mov a,@r0
15CA FC         +1  3822         mov r4,a
15CB 08         +1  3823         inc r0
15CC E6         +1  3824         mov a,@r0
15CD FD         +1  3825         mov r5,a
15CE 22         +1  3826         ret
                +1  3827     
                +1  3828     ;*********************************
                +1  3829     ;mov    dptr,#k2
                +1  3830     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  3831     ;**********************************
15CF            +1  3832     ldx_ltemp:
15CF E583       +1  3833         mov a,dph       ;is it in on board memory
15D1 6010       +1  3834         jz  oboard1     ;yes
15D3 E0         +1  3835         movx    a,@dptr
15D4 F508       +1  3836         mov 8,a
15D6 A3         +1  3837         inc dptr
15D7 E0         +1  3838         movx    a,@dptr
15D8 F509       +1  3839         mov 9,a
15DA A3         +1  3840         inc dptr
15DB E0         +1  3841         movx    a,@dptr
15DC F50A       +1  3842         mov 10,a
15DE A3         +1  3843         inc dptr
15DF E0         +1  3844         movx    a,@dptr
15E0 F50B       +1  3845         mov 11,a
15E2 22         +1  3846         ret
15E3            +1  3847     oboard1:
15E3 A882       +1  3848         mov r0,dpl
15E5 8608       +1  3849         mov 8,@r0
15E7 08         +1  3850         inc r0
15E8 8609       +1  3851         mov 9,@r0
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    61

15EA 08         +1  3852         inc r0
15EB 860A       +1  3853         mov 10,@r0
15ED 08         +1  3854         inc r0
15EE 860B       +1  3855         mov 11,@r0
15F0 22         +1  3856         ret
                +1  3857     ;   Long division routines for 8051
                +1  3858     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  3859     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  3860     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  3861     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  3862     ;   r1 must be saved by the caller.
                +1  3863     ;   This is long unsigned division.
                +1  3864     
                +1  3865     
                +1  3866     ;   Register usage:
                +1  3867     ;       r0 loop counter
                +1  3868     ;       xtemp (12-15) accumulates quotient
                +1  3869     ;       r5-r2 holds dividend
                +1  3870     ;       ltemp holds divisor
                +1  3871     
                +1  3872     ;************************************
                +1  3873     ;r2..r5-делимое
                +1  3874     ;ltemp..-делитель
                +1  3875     ;частное -r2..r5
                +1  3876     ;*************************************
15F1            +1  3877     divide:
15F1 E4         +1  3878         clr a
15F2 F8         +1  3879         mov r0,a        ;initialize count
15F3 F50C       +1  3880         mov xtemp,a     ;zero quotient
15F5 F50D       +1  3881         mov xtemp+1,a
15F7 F50E       +1  3882         mov xtemp+2,a
15F9 F50F       +1  3883         mov xtemp+3,a
15FB ED         +1  3884         mov a,r5        ;check for zero dividend
15FC 4C         +1  3885         orl a,r4
15FD 4B         +1  3886         orl a,r3
15FE 4A         +1  3887         orl a,r2
15FF 600B       +1  3888         jz  jfinis
1601 E508       +1  3889         mov a,ltemp     ;check for zero divisor
1603 4509       +1  3890         orl a,ltemp+1
1605 450A       +1  3891         orl a,ltemp+2
1607 450B       +1  3892         orl a,ltemp+3
1609 7037       +1  3893         jnz midl
160B 22         +1  3894         ret
                +1  3895     
160C 020000   F +1  3896     jfinis: jmp finis
                +1  3897     
160F            +1  3898     loops:
160F EA         +1  3899         mov a,r2
1610 C3         +1  3900         clr c
1611 9508       +1  3901         subb    a,ltemp+0   ;is divisor greater than dividend yet
1613 4033       +1  3902         jc  yes     ;yes, go no further
1615 7013       +1  3903         jnz no
1617 EB         +1  3904         mov a,r3
1618 9509       +1  3905         subb    a,ltemp+1
161A 402C       +1  3906         jc  yes
161C 700C       +1  3907         jnz no
161E EC         +1  3908         mov a,r4
161F 950A       +1  3909         subb    a,ltemp+2
1621 4025       +1  3910         jc  yes
1623 7005       +1  3911         jnz no
1625 ED         +1  3912         mov a,r5
1626 950B       +1  3913         subb    a,ltemp+3
1628 401E       +1  3914         jc  yes
162A            +1  3915     no:
162A E50B       +1  3916         mov a,ltemp+3   ;shift divisor up one bit
162C 250B       +1  3917         add a,ltemp+3
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    62

162E F50B       +1  3918         mov ltemp+3,a
1630 E50A       +1  3919         mov a,ltemp+2
1632 350A       +1  3920         addc    a,ltemp+2
1634 F50A       +1  3921         mov ltemp+2,a
1636 E509       +1  3922         mov a,ltemp+1
1638 3509       +1  3923         addc    a,ltemp+1
163A F509       +1  3924         mov ltemp+1,a
163C E508       +1  3925         mov a,ltemp+0
163E 3508       +1  3926         addc    a,ltemp+0
1640 F508       +1  3927         mov ltemp+0,a
1642            +1  3928     midl:
1642 08         +1  3929         inc r0      ;increment count
1643 E508       +1  3930         mov a,ltemp+0   ;check for safe to shift some more
1645 30E7C7     +1  3931         jnb acc.7,loops  ;loop if top bit clear
1648            +1  3932     yes:
1648 E508       +1  3933         mov a,ltemp+0
164A C3         +1  3934         clr c
164B 9A         +1  3935         subb    a,r2        ;can we subtract now?
164C 401A       +1  3936         jc  dosub       ;yes, go and do it
164E 7015       +1  3937         jnz nosub
1650 E509       +1  3938         mov a,ltemp+1
1652 9B         +1  3939         subb    a,r3
1653 4013       +1  3940         jc  dosub
1655 700E       +1  3941         jnz nosub
1657 E50A       +1  3942         mov a,ltemp+2
1659 9C         +1  3943         subb    a,r4
165A 400C       +1  3944         jc  dosub
165C 7007       +1  3945         jnz nosub
165E E50B       +1  3946         mov a,ltemp+3
1660 9D         +1  3947         subb    a,r5
1661 4005       +1  3948         jc  dosub
1663 6003       +1  3949         jz  dosub
1665            +1  3950     nosub:
1665 C3         +1  3951         clr c
1666 8012       +1  3952         sjmp    dosh
1668            +1  3953     dosub:
1668 C3         +1  3954         clr c       ;subtract divisor from dividend
1669 ED         +1  3955         mov a,r5
166A 950B       +1  3956         subb    a,ltemp+3
166C FD         +1  3957         mov r5,a
166D EC         +1  3958         mov a,r4
166E 950A       +1  3959         subb    a,ltemp+2
1670 FC         +1  3960         mov r4,a
1671 EB         +1  3961         mov a,r3
1672 9509       +1  3962         subb    a,ltemp+1
1674 FB         +1  3963         mov r3,a
1675 EA         +1  3964         mov a,r2
1676 9508       +1  3965         subb    a,ltemp+0
1678 FA         +1  3966         mov r2,a
1679 D3         +1  3967         setb    c       ;now set bit for quotient
167A            +1  3968     dosh:
167A E50F       +1  3969         mov a,xtemp+3
167C 33         +1  3970         rlc a
167D F50F       +1  3971         mov xtemp+3,a
167F E50E       +1  3972         mov a,xtemp+2
1681 33         +1  3973         rlc a
1682 F50E       +1  3974         mov xtemp+2,a
1684 E50D       +1  3975         mov a,xtemp+1
1686 33         +1  3976         rlc a
1687 F50D       +1  3977         mov xtemp+1,a
1689 E50C       +1  3978         mov a,xtemp+0
168B 33         +1  3979         rlc a
168C F50C       +1  3980         mov xtemp+0,a
168E E508       +1  3981         mov a,ltemp+0       ;shift divisor down
1690 C3         +1  3982         clr c
1691 13         +1  3983         rrc a
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    63

1692 F508       +1  3984         mov ltemp+0,a
1694 E509       +1  3985         mov a,ltemp+1
1696 13         +1  3986         rrc a
1697 F509       +1  3987         mov ltemp+1,a
1699 E50A       +1  3988         mov a,ltemp+2
169B 13         +1  3989         rrc a
169C F50A       +1  3990         mov ltemp+2,a
169E E50B       +1  3991         mov a,ltemp+3
16A0 13         +1  3992         rrc a
16A1 F50B       +1  3993         mov ltemp+3,a
                +1  3994     
16A3 D8A3       +1  3995         djnz    r0,yes      ;and continue with the rest
                +1  3996     
16A5            +1  3997     finis:
16A5 8D0B       +1  3998         mov ltemp+3,r5
16A7 8C0A       +1  3999         mov ltemp+2,r4
16A9 8B09       +1  4000         mov ltemp+1,r3
16AB 8A08       +1  4001         mov ltemp+0,r2
16AD AD0F       +1  4002         mov r5,xtemp+3
16AF AC0E       +1  4003         mov r4,xtemp+2
16B1 AB0D       +1  4004         mov r3,xtemp+1
16B3 AA0C       +1  4005         mov r2,xtemp+0
16B5 22         +1  4006         ret         ;and return with the satisfaction of a job well done
                +1  4007     
                +1  4008     
                +1  4009     ;   Long multiplication
                +1  4010     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  4011     ;   other in ltemp. It really doesn't matter which one is where.
                +1  4012     
                +1  4013     ;**********************************
                +1  4014     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  4015     ;ст  мл
                +1  4016     ;**********************************
16B6            +1  4017     llmul:
16B6            +1  4018     almul:
16B6            +1  4019     lmul:
16B6 ED         +1  4020         mov a,r5        ;low order byte
16B7 850BF0     +1  4021         mov b,ltemp+3       ;times low order byte
16BA A4         +1  4022         mul ab
16BB F50F       +1  4023         mov xtemp+3,a       ;store low
16BD 85F00E     +1  4024         mov xtemp+2,b   ;and high
16C0 ED         +1  4025         mov a,r5        ;low order
16C1 850AF0     +1  4026         mov b,ltemp+2   ;times next
16C4 A4         +1  4027         mul ab
16C5 250E       +1  4028         add a,xtemp+2   ;add in
16C7 F50E       +1  4029         mov xtemp+2,a
16C9 E5F0       +1  4030         mov a,b
16CB 3400       +1  4031         addc    a,#0
16CD F50D       +1  4032         mov xtemp+1,a
16CF ED         +1  4033         mov a,r5
16D0 8509F0     +1  4034         mov b,ltemp+1
16D3 A4         +1  4035         mul ab
16D4 250D       +1  4036         add a,xtemp+1
16D6 F50D       +1  4037         mov xtemp+1,a
16D8 E5F0       +1  4038         mov a,b
16DA 3400       +1  4039         addc    a,#0
16DC F50C       +1  4040         mov xtemp+0,a
16DE ED         +1  4041         mov a,r5
16DF 8508F0     +1  4042         mov b,ltemp+0
16E2 A4         +1  4043         mul ab
16E3 250C       +1  4044         add a,xtemp+0
16E5 F50C       +1  4045         mov xtemp+0,a
16E7 EC         +1  4046         mov a,r4
16E8 850BF0     +1  4047         mov b,ltemp+3
16EB A4         +1  4048         mul ab
16EC 250E       +1  4049         add a,xtemp+2
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    64

16EE F50E       +1  4050         mov xtemp+2,a
16F0 E5F0       +1  4051         mov a,b
16F2 350D       +1  4052         addc    a,xtemp+1
16F4 F50D       +1  4053         mov xtemp+1,a
16F6 E50C       +1  4054         mov a,xtemp+0
16F8 3400       +1  4055         addc    a,#0
16FA F50C       +1  4056         mov xtemp+0,a
16FC EC         +1  4057         mov a,r4
16FD 850AF0     +1  4058         mov b,ltemp+2
1700 A4         +1  4059         mul ab
1701 250D       +1  4060         add a,xtemp+1
1703 F50D       +1  4061         mov xtemp+1,a
1705 E5F0       +1  4062         mov a,b
1707 350C       +1  4063         addc    a,xtemp+0
1709 F50C       +1  4064         mov xtemp+0,a
170B EC         +1  4065         mov a,r4
170C 8509F0     +1  4066         mov b,ltemp+1
170F A4         +1  4067         mul ab
1710 250C       +1  4068         add a,xtemp+0
1712 F50C       +1  4069         mov xtemp+0,a
                +1  4070     
1714 EB         +1  4071         mov a,r3
1715 850BF0     +1  4072         mov b,ltemp+3
1718 A4         +1  4073         mul ab
1719 250D       +1  4074         add a,xtemp+1
171B F50D       +1  4075         mov xtemp+1,a
171D E5F0       +1  4076         mov a,b
171F 350C       +1  4077         addc    a,xtemp+0
1721 F50C       +1  4078         mov xtemp+0,a
1723 EB         +1  4079         mov a,r3
1724 850AF0     +1  4080         mov b,ltemp+2
1727 A4         +1  4081         mul ab
1728 250C       +1  4082         add a,xtemp+0
172A F50C       +1  4083         mov xtemp+0,a
                +1  4084     
172C EA         +1  4085         mov a,r2
172D 850BF0     +1  4086         mov b,ltemp+3
1730 A4         +1  4087         mul ab
1731 250C       +1  4088         add a,xtemp+0
1733 FA         +1  4089         mov r2,a
1734 AB0D       +1  4090         mov r3,xtemp+1
1736 AC0E       +1  4091         mov r4,xtemp+2
1738 AD0F       +1  4092         mov r5,xtemp+3
                +1  4093     
173A 22         +1  4094         ret         ;all done
                +1  4095     ;******************************
                +1  4096     ;из содержимого  r2-r5  вычесть
                +1  4097     ;содержимое          ltemp..ltemp+3
                +1  4098     ;******************************
173B            +1  4099     llsub:
173B            +1  4100      lsub:
173B ED         +1  4101         mov a,r5
173C C3         +1  4102         clr c
173D 950B       +1  4103         subb    a,11
173F FD         +1  4104         mov r5,a
1740 EC         +1  4105         mov a,r4
1741 950A       +1  4106         subb    a,10
1743 FC         +1  4107         mov r4,a
1744 EB         +1  4108         mov a,r3
1745 9509       +1  4109         subb    a,9
1747 FB         +1  4110         mov r3,a
1748 EA         +1  4111         mov a,r2
1749 9508       +1  4112         subb    a,8
174B FA         +1  4113         mov r2,a
174C 22         +1  4114         ret
                +1  4115     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    65

                +1  4116     ;***********************************************
                +1  4117     ;                                                      ст мл
                +1  4118     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4119     ;  r0- адрес младшего байта !!!
                +1  4120     ;результат- r2..r5
                +1  4121     ;***********************************************
                +1  4122     
174D C3         +1  4123     ladd:    clr       c
174E ED         +1  4124          mov       a,r5
174F 26         +1  4125          add       a,@r0
1750 FD         +1  4126          mov       r5,a
1751 18         +1  4127          dec       r0
1752 EC         +1  4128          mov       a,r4
1753 36         +1  4129          addc      a,@r0
1754 FC         +1  4130          mov       r4,a
1755 18         +1  4131          dec       r0
1756 EB         +1  4132          mov       a,r3
1757 36         +1  4133          addc      a,@r0
1758 FB         +1  4134          mov       r3,a
1759 18         +1  4135          dec       r0
175A EA         +1  4136          mov       a,r2
175B 36         +1  4137          addc      a,@r0
175C FA         +1  4138          mov       r2,a
175D 22         +1  4139          ret
                +1  4140     ;***********************************************
                +1  4141     ;                                                      ст мл
                +1  4142     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4143     ;  r0- адрес младшего байта !!!
                +1  4144     ;результат- r2..r5
                +1  4145     ;***********************************************
                +1  4146     
175E C3         +1  4147     laddx:    clr       c
175F E2         +1  4148                                             movx            a,@r0
1760 2D         +1  4149                                             add                     a,r5
1761 FD         +1  4150               mov     r5,a
1762 18         +1  4151                             dec     r0
1763 E2         +1  4152                             movx    a,@r0
1764 3C         +1  4153                             addc    a,r4
1765 FC         +1  4154                             mov     r4,a
1766 18         +1  4155                             dec     r0
1767 E2         +1  4156                             movx    a,@r0
1768 3B         +1  4157                             addc    a,r3
1769 FB         +1  4158                             mov     r3,a
176A 18         +1  4159                             dec     r0
176B E2         +1  4160                             movx    a,@r0
176C 3A         +1  4161                             addc    a,r2
176D FA         +1  4162                             mov       r2,a
176E 22         +1  4163                             ret
                +1  4164     
                +1  4165     ;***********************************************
                +1  4166     ;                                                      ст мл
                +1  4167     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4168     ;  dptr- адрес младшего байта !!!
                +1  4169     ;результат- r2..r5
                +1  4170     ;***********************************************
                +1  4171     
176F C3         +1  4172     addx:    clr       c
1770 E0         +1  4173                                             movx            a,@dptr
1771 2D         +1  4174                                             add                     a,r5
1772 FD         +1  4175               mov     r5,a
1773 120000   F +1  4176                             call            dedptr;dec     dptr
1776 E0         +1  4177                             movx    a,@dptr
1777 3C         +1  4178                             addc    a,r4
1778 FC         +1  4179                             mov     r4,a
1779 120000   F +1  4180                             call            dedptr;dec     dptr
177C E0         +1  4181                             movx    a,@dptr
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    66

177D 3B         +1  4182                             addc    a,r3
177E FB         +1  4183                             mov     r3,a
177F 120000   F +1  4184                             call            dedptr;dec     dptr
1782 E0         +1  4185                             movx    a,@dptr
1783 3A         +1  4186                             addc    a,r2
1784 FA         +1  4187                             mov       r2,a
1785 22         +1  4188                             ret
                +1  4189     
1786 C0D0       +1  4190     dedptr:         push    psw
1788 C3         +1  4191                                             clr             c
1789 E582       +1  4192                                             mov             a,dpl
178B 9401       +1  4193                                             subb    a,#1
178D F582       +1  4194                                             mov             dpl,a
178F E583       +1  4195                                             mov             a,dph
1791 9400       +1  4196                                             subb    a,#0
1793 F583       +1  4197                                             mov             dph,a
1795 D0D0       +1  4198                                             pop             psw
1797 22         +1  4199                                             ret
                    4200     
                    4201     ;$include (d:\amp\\floatm.asm)
                +1  4202     ;       Copyright (C) 1988 HI-TECH Software
                +1  4203     
                +1  4204     ;       Single Precision Floating point arithmetic routines for 8051
                +1  4205     
                +1  4206     ;       The format of floating point numbers is as follows:
                +1  4207     
                +1  4208     ;       -----------------
                +1  4209     ;       *     sign      *  1 bit
                +1  4210     ;       -----------------
                +1  4211     ;       *   exponent    *  8 bits
                +1  4212     ;       -----------------
                +1  4213     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  4214     ;       -----------------
                +1  4215     
                +1  4216     
                +1  4217     ;       As usual for the 8051 the memory layout has the most significant
                +1  4218     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  4219     ;       lowest address.
                +1  4220     
                +1  4221     ;       Calling conventions:
                +1  4222     
                +1  4223     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  4224     ;
                +1  4225     ;       Return value is in r2-r5
                +1  4226     
                +1  4227     ;       Naming conventions: A routine name is constructed by
                +1  4228     
                +1  4229     ;             ASOP
                +1  4230     
                +1  4231     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  4232     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  4233     ;       Conversion routines are named
                +1  4234     
                +1  4235     ;               AStof
                +1  4236     
                +1  4237     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  4238     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  4239     ;       Conversion from float to integer is ftol.
                +1  4240     
                +1  4241     ;               .ORG  5000h
                +1  4242     ;               .CODE
                +1  4243     ;       seg     c_text
                +1  4244     
                +1  4245     ;;      $MOD812
----            +1  4246             CSEG
                +1  4247             ;ORG 1000h
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    67

                +1  4248     
                +1  4249                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  4250             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  4251     
                +1  4252     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  4253     ;       macros
                +1  4254     
                +1  4255     saveregs        macro
                +1  4256             push    7
                +1  4257             push    6
                +1  4258             push    1
                +1  4259             push    0
                +1  4260             endm
                +1  4261     
                +1  4262     restregs        macro
                +1  4263             pop     0
                +1  4264             pop     1
                +1  4265             pop     6
                +1  4266             pop     7
                +1  4267             endm
                +1  4268     
                +1  4269     ;addr   
                +1  4270     dan     macro   pad
                +1  4271             mov     a,r5
                +1  4272             add     a,pad+3
                +1  4273             mov     pad+3,a
                +1  4274             mov     a,pad+2
                +1  4275             addc    a,r4
                +1  4276             mov     pad+2,a
                +1  4277             mov     a,pad+1
                +1  4278             addc    a,r3
                +1  4279             mov     pad+1,a
                +1  4280             mov     a,pad+0
                +1  4281             addc    a,r2
                +1  4282             mov     pad,a
                +1  4283             endm
                +1  4284     
                +1  4285     addl    macro  addr
                +1  4286             mov     a,r5
                +1  4287             add     a,addr+3
                +1  4288             mov     r5,a
                +1  4289             mov     a,addr+2
                +1  4290             addc    a,r4
                +1  4291             mov     r4,a
                +1  4292             mov     a,addr+1
                +1  4293             addc    a,r3
                +1  4294             mov     r3,a
                +1  4295             mov     a,addr+0
                +1  4296             addc    a,r2
                +1  4297             mov     r2,a
                +1  4298             endm
                +1  4299     
                +1  4300     
                +1  4301     add1    macro
                +1  4302             mov     a,r5
                +1  4303             add     a,#1
                +1  4304             mov     r5,a
                +1  4305             clr     a
                +1  4306             addc    a,r4
                +1  4307             mov     r4,a
                +1  4308             clr     a
                +1  4309             addc    a,r3
                +1  4310             mov     r3,a
                +1  4311             clr     a
                +1  4312             addc    a,r2
                +1  4313             mov     r2,a
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    68

                +1  4314             endm
                +1  4315     
                +1  4316     shfdn   macro  addr
                +1  4317             clr     c
                +1  4318             mov     a,addr
                +1  4319             rrc     a
                +1  4320             mov     addr,a
                +1  4321             mov     a,addr+1
                +1  4322             rrc     a
                +1  4323             mov     addr+1,a
                +1  4324             mov     a,addr+2
                +1  4325             rrc     a
                +1  4326             mov     addr+2,a
                +1  4327             mov     a,addr+3
                +1  4328             rrc     a
                +1  4329             mov     addr+3,a
                +1  4330             endm
                +1  4331     
                +1  4332     shfup   macro  addr
                +1  4333             clr     c
                +1  4334             mov     a,addr+3
                +1  4335             rlc     a
                +1  4336             mov     addr+3,a
                +1  4337             mov     a,addr+2
                +1  4338             rlc     a
                +1  4339             mov     addr+2,a
                +1  4340             mov     a,addr+1
                +1  4341             rlc     a
                +1  4342             mov     addr+1,a
                +1  4343             mov     a,addr
                +1  4344             rlc     a
                +1  4345             mov     addr,a
                +1  4346             endm
                +1  4347     
                +1  4348     rshift  macro
                +1  4349             clr     c
                +1  4350             mov     a,r2
                +1  4351             rrc     a
                +1  4352             mov     r2,a
                +1  4353             mov     a,r3
                +1  4354             rrc     a
                +1  4355             mov     r3,a
                +1  4356             mov     a,r4
                +1  4357             rrc     a
                +1  4358             mov     r4,a
                +1  4359             mov     a,r5
                +1  4360             rrc     a
                +1  4361             mov     r5,a
                +1  4362             endm
                +1  4363     rshift1 macro
                +1  4364             setb    c
                +1  4365             mov     a,r2
                +1  4366             rrc     a
                +1  4367             mov     r2,a
                +1  4368             mov     a,r3
                +1  4369             rrc     a
                +1  4370             mov     r3,a
                +1  4371             mov     a,r4
                +1  4372             rrc     a
                +1  4373             mov     r4,a
                +1  4374             mov     a,r5
                +1  4375             rrc     a
                +1  4376             mov     r5,a
                +1  4377             endm
                +1  4378     
                +1  4379     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    69

                +1  4380     lshift  macro
                +1  4381             mov     a,r5
                +1  4382             rlc     a
                +1  4383             mov     r5,a
                +1  4384             mov     a,r4
                +1  4385             rlc     a
                +1  4386             mov     r4,a
                +1  4387             mov     a,r3
                +1  4388             rlc     a
                +1  4389             mov     r3,a
                +1  4390             mov     a,r2
                +1  4391             rlc     a
                +1  4392             mov     r2,a
                +1  4393             endm
                +1  4394     
                +1  4395     neg1    macro
                +1  4396             clr     c
                +1  4397             clr     a
                +1  4398             subb    a,r5
                +1  4399             mov     r5,a
                +1  4400             clr     a
                +1  4401             subb    a,r4
                +1  4402             mov     r4,a
                +1  4403             clr     a
                +1  4404             subb    a,r3
                +1  4405             mov     r3,a
                +1  4406             clr     a
                +1  4407             subb    a,r2
                +1  4408             mov     r2,a
                +1  4409             endm
                +1  4410     
                +1  4411     negm    macro  addr
                +1  4412             clr     c
                +1  4413             clr     a
                +1  4414             subb    a,addr+3
                +1  4415             mov     addr+3,a
                +1  4416             clr     a
                +1  4417             subb    a,addr+2
                +1  4418             mov     addr+2,a
                +1  4419             clr     a
                +1  4420             subb    a,addr+1
                +1  4421             mov     addr+1,a
                +1  4422             clr     a
                +1  4423             subb    a,addr
                +1  4424             mov     addr,a
                +1  4425             endm
                +1  4426     
                +1  4427     copytor macro  addr
                +1  4428             mov     r2,addr
                +1  4429             mov     r3,addr+1
                +1  4430             mov     r4,addr+2
                +1  4431             mov     r5,addr+3
                +1  4432             endm
                +1  4433     
                +1  4434     
                +1  4435     copyrto macro  addr
                +1  4436             mov     addr,r2
                +1  4437             mov     addr+1,r3
                +1  4438             mov     addr+2,r4
                +1  4439             mov     addr+3,r5
                +1  4440             endm
                +1  4441     
                +1  4442     
                +1  4443     ;       Internal representation: in this set of routines a floating number
                +1  4444     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  4445     
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    70

                +1  4446     ;       Stack offset values
                +1  4447     ;ltemp   equ     28h
                +1  4448     
  0006          +1  4449     cntr    equ     6               ;r6 is the counter
  0007          +1  4450     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  4451     exp1    equ     0               ;exponent 1 in r0
  0002          +1  4452     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  4453     exp2    equ     1               ;exponent 1 in r1
  0008          +1  4454     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  4455     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  4456     
                +1  4457     
                +1  4458     
                +1  4459     
                +1  4460     
                +1  4461     ;DECSIZE EQU     10
                +1  4462     ;NUMSIZE EQU     4
                +1  4463     ;RR4     EQU     4
                +1  4464     ;RR5     EQU     5
                +1  4465     
                +1  4466     ;       unpack1 - unpacks the left operand
                +1  4467     
009E            +1  4468     unpack1:
009E EA         +1  4469             mov     a,r2            ;get sign
009F 5480       +1  4470             anl     a,#80h
00A1 530740     +1  4471             anl     sign,#40h       ;clear other bits
00A4 4207       +1  4472             orl     sign,a          ;store sign
00A6 EB         +1  4473             mov     a,r3            ;get lsb of exponent
00A7 33         +1  4474             rlc     a               ;rotate into carry
00A8 EA         +1  4475             mov     a,r2            ;get rest of exponent
00A9 33         +1  4476             rlc     a               ;and make it 8 bits
00AA F8         +1  4477             mov     r0,a            ;store it
00AB 6006       +1  4478             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  4479             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  4480             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  4481             ret
00B3            +1  4482     zer1:
00B3 E4         +1  4483             clr     a
00B4 FA         +1  4484             mov     r2,a
00B5 FB         +1  4485             mov     r3,a
00B6 FC         +1  4486             mov     r4,a
00B7 FD         +1  4487             mov     r5,a            ;zero mantissa
00B8 F8         +1  4488             mov     r0,a            ;zero exponent
00B9 22         +1  4489             ret
                +1  4490     
                +1  4491     ;       unpack2 - unpacks right operand
                +1  4492     
00BA            +1  4493     unpack2:
00BA E508       +1  4494             mov     a,ltemp         ;get sign
00BC 13         +1  4495             rrc     a               ;shift down
00BD 5440       +1  4496             anl     a,#40h          ;mask out sign
00BF 530780     +1  4497             anl     sign,#80h       ;clear old bit
00C2 4207       +1  4498             orl     sign,a
00C4 E509       +1  4499             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  4500             rlc     a               ;rotate into carry
00C7 E508       +1  4501             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  4502             rlc     a               ;and make it 8 bits
00CA F9         +1  4503             mov     r1,a            ;store it
00CB 6007       +1  4504             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  4505             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  4506             mov     mant2,#0        ;clear upper byte
00D3 22         +1  4507             ret
00D4            +1  4508     zer2:
00D4 E4         +1  4509             clr     a
00D5 F508       +1  4510             mov     ltemp,a
00D7 F509       +1  4511             mov     ltemp+1,a
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    71

00D9 F50A       +1  4512             mov     ltemp+2,a
00DB F50B       +1  4513             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  4514             ret
                +1  4515     
                +1  4516     ;       pack1 - put operand 1 back into float format
                +1  4517     
00DE            +1  4518     pack1:
00DE E8         +1  4519             mov     a,r0            ;get exponent
00DF C3         +1  4520             clr     c
00E0 13         +1  4521             rrc     a               ;shift down 1 bit
00E1 530780     +1  4522             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  4523             orl     a,r7            ;or in sign bit
00E5 FA         +1  4524             mov     r2,a            ;store
00E6 E8         +1  4525             mov     a,r0            ;get other bit
00E7 03         +1  4526             rr      a               ;rotate into hi bit
00E8 5480       +1  4527             anl     a,#80h          ;mask
00EA 53037F     +1  4528             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  4529             orl     mant1+1,a       ;put in
00EF 22         +1  4530             ret
                +1  4531     
                +1  4532     
                +1  4533     ;       norm1 - normalize the unpacked value in 1
                +1  4534     
00F0            +1  4535     norm1:
00F0 E8         +1  4536             mov     a,r0            ;get exponent
00F1 60C0       +1  4537             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  4538             mov     a,r2            ;get hi byte
00F4 6023       +1  4539             jz      norup           ;zero, so shift up if anything
00F6            +1  4540     nordn:
00F6 EA         +1  4541             mov     a,r2            ;get hi byte
00F7 B4010D     +1  4542             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  4543+3           add1                    ;add in a rounding bit
00FA ED         +1  4544+1           mov     a,r5
00FB 2401       +1  4545+1           add     a,#1
00FD FD         +1  4546+1           mov     r5,a
00FE E4         +1  4547+1           clr     a
00FF 3C         +1  4548+1           addc    a,r4
0100 FC         +1  4549+1           mov     r4,a
0101 E4         +1  4550+1           clr     a
0102 3B         +1  4551+1           addc    a,r3
0103 FB         +1  4552+1           mov     r3,a
0104 E4         +1  4553+1           clr     a
0105 3A         +1  4554+1           addc    a,r2
0106 FA         +1  4555+1           mov     r2,a
0107            +1  4556     nordn1:
                +1  4557+3           rshift                  ;shift down 1 bit
0107 C3         +1  4558+1           clr     c
0108 EA         +1  4559+1           mov     a,r2
0109 13         +1  4560+1           rrc     a
010A FA         +1  4561+1           mov     r2,a
010B EB         +1  4562+1           mov     a,r3
010C 13         +1  4563+1           rrc     a
010D FB         +1  4564+1           mov     r3,a
010E EC         +1  4565+1           mov     a,r4
010F 13         +1  4566+1           rrc     a
0110 FC         +1  4567+1           mov     r4,a
0111 ED         +1  4568+1           mov     a,r5
0112 13         +1  4569+1           rrc     a
0113 FD         +1  4570+1           mov     r5,a
0114 08         +1  4571             inc     r0              ;adjust exponent
0115 EA         +1  4572             mov     a,r2            ;test high byte
0116 70DE       +1  4573             jnz     nordn           ;loop
0118 22         +1  4574             ret                     ;done
                +1  4575     
0119            +1  4576     norup:
0119 4B         +1  4577             orl     a,r3
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    72

011A 4C         +1  4578             orl     a,r4
011B 4D         +1  4579             orl     a,r5            ;test for zero mantissa
011C 6095       +1  4580             jz      zer1            ;it is - make it true zero
011E            +1  4581     norup1:
011E EB         +1  4582             mov     a,r3            ;get mantissa byte
011F 20E710     +1  4583             jb      acc.7,norup2    ;jump if set
0122 C3         +1  4584             clr     c
                +1  4585+3           lshift                  ;shift mantissa up
0123 ED         +1  4586+1           mov     a,r5
0124 33         +1  4587+1           rlc     a
0125 FD         +1  4588+1           mov     r5,a
0126 EC         +1  4589+1           mov     a,r4
0127 33         +1  4590+1           rlc     a
0128 FC         +1  4591+1           mov     r4,a
0129 EB         +1  4592+1           mov     a,r3
012A 33         +1  4593+1           rlc     a
012B FB         +1  4594+1           mov     r3,a
012C EA         +1  4595+1           mov     a,r2
012D 33         +1  4596+1           rlc     a
012E FA         +1  4597+1           mov     r2,a
012F 18         +1  4598             dec     r0              ;adjust exponent
0130 80EC       +1  4599             jmp     norup1
0132            +1  4600     norup2:
0132 22         +1  4601             ret                     ;finito
                +1  4602     
                +1  4603     
                +1  4604     ;       fpdenorm - denormalize one of the two operands so that their
                +1  4605     ;       exponents are equal. This requires the smaller number to have
                +1  4606     ;       its exponent incremented and its mantissa shifted right.
                +1  4607     
0133            +1  4608     denorm:
0133 E8         +1  4609             mov     a,r0
0134 C3         +1  4610             clr     c
0135 99         +1  4611             subb    a,r1            ;compare exponents
0136 5029       +1  4612             jnc     up2a            ;shift operand 2
0138            +1  4613     up1:
0138 08         +1  4614             inc     r0              ;increment exponent
                +1  4615+3           rshift                  ;shift mantissa down
0139 C3         +1  4616+1           clr     c
013A EA         +1  4617+1           mov     a,r2
013B 13         +1  4618+1           rrc     a
013C FA         +1  4619+1           mov     r2,a
013D EB         +1  4620+1           mov     a,r3
013E 13         +1  4621+1           rrc     a
013F FB         +1  4622+1           mov     r3,a
0140 EC         +1  4623+1           mov     a,r4
0141 13         +1  4624+1           rrc     a
0142 FC         +1  4625+1           mov     r4,a
0143 ED         +1  4626+1           mov     a,r5
0144 13         +1  4627+1           rrc     a
0145 FD         +1  4628+1           mov     r5,a
0146 E8         +1  4629             mov     a,r0
0147 B501EE     +1  4630             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  4631             ret
                +1  4632     
014B            +1  4633     up2:
014B 09         +1  4634             inc     r1              ;increment exponent 2
                +1  4635+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  4636+1           clr     c
014D E508       +1  4637+1           mov     a,mant2
014F 13         +1  4638+1           rrc     a
0150 F508       +1  4639+1           mov     mant2,a
0152 E509       +1  4640+1           mov     a,mant2+1
0154 13         +1  4641+1           rrc     a
0155 F509       +1  4642+1           mov     mant2+1,a
0157 E50A       +1  4643+1           mov     a,mant2+2
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    73

0159 13         +1  4644+1           rrc     a
015A F50A       +1  4645+1           mov     mant2+2,a
015C E50B       +1  4646+1           mov     a,mant2+3
015E 13         +1  4647+1           rrc     a
015F F50B       +1  4648+1           mov     mant2+3,a
0161            +1  4649     up2a:
0161 E8         +1  4650             mov     a,r0            ;compare exponents
0162 B501E6     +1  4651             cjne    a,exp2,up2
0165 22         +1  4652             ret                     ;all done
                +1  4653     ;------------------------------------------------------------------
                +1  4654     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  4655     
0166            +1  4656     fladd:
                +1  4657+3           saveregs
0166 C007       +1  4658+1           push    7
0168 C006       +1  4659+1           push    6
016A C001       +1  4660+1           push    1
016C C000       +1  4661+1           push    0
016E 119E       +1  4662             call    unpack1
0170 11BA       +1  4663             call    unpack2
0172 3133       +1  4664             call    denorm
0174 E507       +1  4665             mov     a,sign
0176 30E70D     +1  4666             jnb     acc.7,ok1       ;test left sign
                +1  4667+3           neg1                    ;negate op1
0179 C3         +1  4668+1           clr     c
017A E4         +1  4669+1           clr     a
017B 9D         +1  4670+1           subb    a,r5
017C FD         +1  4671+1           mov     r5,a
017D E4         +1  4672+1           clr     a
017E 9C         +1  4673+1           subb    a,r4
017F FC         +1  4674+1           mov     r4,a
0180 E4         +1  4675+1           clr     a
0181 9B         +1  4676+1           subb    a,r3
0182 FB         +1  4677+1           mov     r3,a
0183 E4         +1  4678+1           clr     a
0184 9A         +1  4679+1           subb    a,r2
0185 FA         +1  4680+1           mov     r2,a
0186            +1  4681     ok1:
0186 E507       +1  4682             mov     a,sign
0188 30E615     +1  4683             jnb     acc.6,ok2       ;test right sign
                +1  4684+3           negm    mant2           ;negate op2
018B C3         +1  4685+1           clr     c
018C E4         +1  4686+1           clr     a
018D 950B       +1  4687+1           subb    a,mant2+3
018F F50B       +1  4688+1           mov     mant2+3,a
0191 E4         +1  4689+1           clr     a
0192 950A       +1  4690+1           subb    a,mant2+2
0194 F50A       +1  4691+1           mov     mant2+2,a
0196 E4         +1  4692+1           clr     a
0197 9509       +1  4693+1           subb    a,mant2+1
0199 F509       +1  4694+1           mov     mant2+1,a
019B E4         +1  4695+1           clr     a
019C 9508       +1  4696+1           subb    a,mant2
019E F508       +1  4697+1           mov     mant2,a
01A0            +1  4698     ok2:
                +1  4699+3           addl    mant2           ;add mantissas
01A0 ED         +1  4700+1           mov     a,r5
01A1 250B       +1  4701+1           add     a,mant2+3
01A3 FD         +1  4702+1           mov     r5,a
01A4 E50A       +1  4703+1           mov     a,mant2+2
01A6 3C         +1  4704+1           addc    a,r4
01A7 FC         +1  4705+1           mov     r4,a
01A8 E509       +1  4706+1           mov     a,mant2+1
01AA 3B         +1  4707+1           addc    a,r3
01AB FB         +1  4708+1           mov     r3,a
01AC E508       +1  4709+1           mov     a,mant2+0
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    74

01AE 3A         +1  4710+1           addc    a,r2
01AF FA         +1  4711+1           mov     r2,a
01B0 E4         +1  4712             clr     a
01B1 FF         +1  4713             mov     r7,a            ;clear sign
01B2 EA         +1  4714             mov     a,r2            ;get sign of result
01B3 30E70E     +1  4715             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  4716             mov     r7,a            ;store sign
                +1  4717+3           neg1                    ;negate mantissa
01B7 C3         +1  4718+1           clr     c
01B8 E4         +1  4719+1           clr     a
01B9 9D         +1  4720+1           subb    a,r5
01BA FD         +1  4721+1           mov     r5,a
01BB E4         +1  4722+1           clr     a
01BC 9C         +1  4723+1           subb    a,r4
01BD FC         +1  4724+1           mov     r4,a
01BE E4         +1  4725+1           clr     a
01BF 9B         +1  4726+1           subb    a,r3
01C0 FB         +1  4727+1           mov     r3,a
01C1 E4         +1  4728+1           clr     a
01C2 9A         +1  4729+1           subb    a,r2
01C3 FA         +1  4730+1           mov     r2,a
01C4            +1  4731     ok3:
01C4 11F0       +1  4732             call    norm1
01C6 11DE       +1  4733             call    pack1           ;pack normalized result
                +1  4734+3           restregs                ;and return
01C8 D000       +1  4735+1           pop     0
01CA D001       +1  4736+1           pop     1
01CC D006       +1  4737+1           pop     6
01CE D007       +1  4738+1           pop     7
01D0 22         +1  4739             ret
                +1  4740     ;-------------------------------------------------------------
                +1  4741     ;       Subtract the number ltemp from the number in r2-r5
                +1  4742     
01D1            +1  4743     flsub:
01D1 630880     +1  4744             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  4745             jmp     fladd           ;and add!
                +1  4746     
                +1  4747     ;================================================================
                +1  4748     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  4749     
01D6            +1  4750     flcmp:
01D6 EA         +1  4751            mov     a,r2            ;get sign of left
01D7 6508       +1  4752            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  4753            jnb     acc.7,cexp      ;same, go check exponent
                +1  4754     ;ifdef SMALL_MODEL
01DC EA         +1  4755             mov     a,r2            ;get sign of left again
01DD 33         +1  4756             rlc     a
01DE 5001       +1  4757             jnc     flout
                +1  4758     ;endif
01E0 D3         +1  4759             setb    c
01E1 22         +1  4760     flout:          ret                    ;return with acc < 0
                +1  4761     
01E2            +1  4762     cexp:
01E2 C3         +1  4763            clr     c
01E3 EA         +1  4764            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  4765            subb    a,ltemp
01E6 7010       +1  4766            jnz     fnd
01E8 EB         +1  4767            mov     a,r3
01E9 9509       +1  4768            subb    a,ltemp+1
01EB 700B       +1  4769            jnz     fnd
01ED EC         +1  4770            mov     a,r4
01EE 950A       +1  4771            subb    a,ltemp+2
01F0 7006       +1  4772            jnz     fnd
01F2 ED         +1  4773            mov     a,r5
01F3 950B       +1  4774            subb    a,ltemp+3
01F5 7001       +1  4775            jnz     fnd
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    75

01F7            +1  4776     cdone:
01F7 22         +1  4777            ret                     ;return with acc == 0
01F8            +1  4778     fnd:
01F8 8AF0       +1  4779           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  4780          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  4781            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  4782                         orl         a,#1                          ;make non-zero
0201 B3         +1  4783             cpl     c               ;c=0->1,c=1->0
0202 22         +1  4784             ret
                +1  4785     ;==============================================================
                +1  4786     
                +1  4787     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  4788     ;       the result in r2-r5
                +1  4789     
0203            +1  4790     flmul:
                +1  4791+3           saveregs
0203 C007       +1  4792+1           push    7
0205 C006       +1  4793+1           push    6
0207 C001       +1  4794+1           push    1
0209 C000       +1  4795+1           push    0
020B 119E       +1  4796             call    unpack1
020D 11BA       +1  4797             call    unpack2
020F E4         +1  4798             clr     a
0210 F50C       +1  4799             mov     prod,a
0212 F50D       +1  4800             mov     prod+1,a        ;clear product
0214 F50E       +1  4801             mov     prod+2,a
0216 F50F       +1  4802             mov     prod+3,a
0218 7E07       +1  4803             mov     r6,#7           ;initialize counter
021A            +1  4804     mup1:
                +1  4805+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  4806+1           clr     c
021B E508       +1  4807+1           mov     a,mant2
021D 13         +1  4808+1           rrc     a
021E F508       +1  4809+1           mov     mant2,a
0220 E509       +1  4810+1           mov     a,mant2+1
0222 13         +1  4811+1           rrc     a
0223 F509       +1  4812+1           mov     mant2+1,a
0225 E50A       +1  4813+1           mov     a,mant2+2
0227 13         +1  4814+1           rrc     a
0228 F50A       +1  4815+1           mov     mant2+2,a
022A E50B       +1  4816+1           mov     a,mant2+3
022C 13         +1  4817+1           rrc     a
022D F50B       +1  4818+1           mov     mant2+3,a
022F 5014       +1  4819             jnc     nobit           ;skip if lsb was zero
                +1  4820+3           dan     prod            ;add multiplicand to product
0231 ED         +1  4821+1           mov     a,r5
0232 250F       +1  4822+1           add     a,prod+3
0234 F50F       +1  4823+1           mov     prod+3,a
0236 E50E       +1  4824+1           mov     a,prod+2
0238 3C         +1  4825+1           addc    a,r4
0239 F50E       +1  4826+1           mov     prod+2,a
023B E50D       +1  4827+1           mov     a,prod+1
023D 3B         +1  4828+1           addc    a,r3
023E F50D       +1  4829+1           mov     prod+1,a
0240 E50C       +1  4830+1           mov     a,prod+0
0242 3A         +1  4831+1           addc    a,r2
0243 F50C       +1  4832+1           mov     prod,a
0245            +1  4833     nobit:
                +1  4834+3           lshift                  ;shift multiplicand up
0245 ED         +1  4835+1           mov     a,r5
0246 33         +1  4836+1           rlc     a
0247 FD         +1  4837+1           mov     r5,a
0248 EC         +1  4838+1           mov     a,r4
0249 33         +1  4839+1           rlc     a
024A FC         +1  4840+1           mov     r4,a
024B EB         +1  4841+1           mov     a,r3
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    76

024C 33         +1  4842+1           rlc     a
024D FB         +1  4843+1           mov     r3,a
024E EA         +1  4844+1           mov     a,r2
024F 33         +1  4845+1           rlc     a
0250 FA         +1  4846+1           mov     r2,a
0251 DEC7       +1  4847             djnz    r6,mup1         ;loop if more
                +1  4848     
0253 7E11       +1  4849             mov     r6,#17          ;re-initalize counter
0255 8015       +1  4850             sjmp    mup3
0257            +1  4851     mup11:
                +1  4852+3           shfdn   prod            ;shift product right
0257 C3         +1  4853+1           clr     c
0258 E50C       +1  4854+1           mov     a,prod
025A 13         +1  4855+1           rrc     a
025B F50C       +1  4856+1           mov     prod,a
025D E50D       +1  4857+1           mov     a,prod+1
025F 13         +1  4858+1           rrc     a
0260 F50D       +1  4859+1           mov     prod+1,a
0262 E50E       +1  4860+1           mov     a,prod+2
0264 13         +1  4861+1           rrc     a
0265 F50E       +1  4862+1           mov     prod+2,a
0267 E50F       +1  4863+1           mov     a,prod+3
0269 13         +1  4864+1           rrc     a
026A F50F       +1  4865+1           mov     prod+3,a
026C            +1  4866     mup3:
                +1  4867+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  4868+1           clr     c
026D E508       +1  4869+1           mov     a,mant2
026F 13         +1  4870+1           rrc     a
0270 F508       +1  4871+1           mov     mant2,a
0272 E509       +1  4872+1           mov     a,mant2+1
0274 13         +1  4873+1           rrc     a
0275 F509       +1  4874+1           mov     mant2+1,a
0277 E50A       +1  4875+1           mov     a,mant2+2
0279 13         +1  4876+1           rrc     a
027A F50A       +1  4877+1           mov     mant2+2,a
027C E50B       +1  4878+1           mov     a,mant2+3
027E 13         +1  4879+1           rrc     a
027F F50B       +1  4880+1           mov     mant2+3,a
0281 5014       +1  4881             jnc     mup2            ;skip if bit not set
                +1  4882+3           dan     prod            ;add to prod
0283 ED         +1  4883+1           mov     a,r5
0284 250F       +1  4884+1           add     a,prod+3
0286 F50F       +1  4885+1           mov     prod+3,a
0288 E50E       +1  4886+1           mov     a,prod+2
028A 3C         +1  4887+1           addc    a,r4
028B F50E       +1  4888+1           mov     prod+2,a
028D E50D       +1  4889+1           mov     a,prod+1
028F 3B         +1  4890+1           addc    a,r3
0290 F50D       +1  4891+1           mov     prod+1,a
0292 E50C       +1  4892+1           mov     a,prod+0
0294 3A         +1  4893+1           addc    a,r2
0295 F50C       +1  4894+1           mov     prod,a
0297            +1  4895     mup2:
0297 DEBE       +1  4896             djnz    r6,mup11        ;loop if more
0299 E8         +1  4897             mov     a,r0            ;get exp1
029A 29         +1  4898             add     a,r1            ;add exp2
029B 247A       +1  4899             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  4900             mov     r0,a            ;store
029E EF         +1  4901             mov     a,r7            ;get sign
029F 23         +1  4902             rl      a               ;rotate bit into msb
02A0 6207       +1  4903             xrl     sign,a          ;xor with other bit
                +1  4904+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  4905+1           mov     r2,prod
02A4 AB0D       +1  4906+1           mov     r3,prod+1
02A6 AC0E       +1  4907+1           mov     r4,prod+2
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    77

02A8 AD0F       +1  4908+1           mov     r5,prod+3
02AA 11F0       +1  4909             call    norm1           ;normalize
02AC 11DE       +1  4910             call    pack1
                +1  4911+3           restregs
02AE D000       +1  4912+1           pop     0
02B0 D001       +1  4913+1           pop     1
02B2 D006       +1  4914+1           pop     6
02B4 D007       +1  4915+1           pop     7
02B6 22         +1  4916             ret
                +1  4917     ;-----------------------------------------------------------
                +1  4918     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  4919     
02B7            +1  4920     fldiv:
                +1  4921+3           saveregs
02B7 C007       +1  4922+1           push    7
02B9 C006       +1  4923+1           push    6
02BB C001       +1  4924+1           push    1
02BD C000       +1  4925+1           push    0
02BF 119E       +1  4926             call    unpack1
02C1 11BA       +1  4927             call    unpack2
02C3 E4         +1  4928             clr     a
02C4 F50C       +1  4929             mov     prod,a
02C6 F50D       +1  4930             mov     prod+1,a
02C8 F50E       +1  4931             mov     prod+2,a
02CA F50F       +1  4932             mov     prod+3,a
02CC E9         +1  4933             mov     a,r1            ;check for zero divisor
02CD 6067       +1  4934             jz      div9
02CF E8         +1  4935             mov     a,r0            ;check for zero dividend
02D0 6064       +1  4936             jz      div9
02D2 C3         +1  4937             clr     c
02D3 99         +1  4938             subb    a,r1            ;compute new exponent
02D4 2478       +1  4939             add     a,#127-7        ;unbias
02D6 F8         +1  4940             mov     r0,a            ;store back
02D7 EF         +1  4941             mov     a,r7            ;get sign
02D8 23         +1  4942             rl      a
02D9 6207       +1  4943             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  4944             mov     r6,#24+7        ;initialize counter
02DD            +1  4945     div1:
                +1  4946+3           shfup   prod            ;shift quotient up
02DD C3         +1  4947+1           clr     c
02DE E50F       +1  4948+1           mov     a,prod+3
02E0 33         +1  4949+1           rlc     a
02E1 F50F       +1  4950+1           mov     prod+3,a
02E3 E50E       +1  4951+1           mov     a,prod+2
02E5 33         +1  4952+1           rlc     a
02E6 F50E       +1  4953+1           mov     prod+2,a
02E8 E50D       +1  4954+1           mov     a,prod+1
02EA 33         +1  4955+1           rlc     a
02EB F50D       +1  4956+1           mov     prod+1,a
02ED E50C       +1  4957+1           mov     a,prod
02EF 33         +1  4958+1           rlc     a
02F0 F50C       +1  4959+1           mov     prod,a
02F2 C3         +1  4960             clr     c
02F3 EA         +1  4961             mov     a,r2            ;compare values
02F4 9508       +1  4962             subb    a,mant2
02F6 4028       +1  4963             jc      div2            ;skip if bigger
02F8 7013       +1  4964             jnz     div3
02FA EB         +1  4965             mov     a,r3            ;compare values
02FB 9509       +1  4966             subb    a,mant2+1
02FD 4021       +1  4967             jc      div2            ;skip if bigger
02FF 700C       +1  4968             jnz     div3
0301 EC         +1  4969             mov     a,r4            ;compare values
0302 950A       +1  4970             subb    a,mant2+2
0304 401A       +1  4971             jc      div2            ;skip if bigger
0306 7005       +1  4972             jnz     div3
0308 ED         +1  4973             mov     a,r5            ;compare values
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    78

0309 950B       +1  4974             subb    a,mant2+3
030B 4013       +1  4975             jc      div2            ;skip if bigger
030D            +1  4976     div3:
030D ED         +1  4977             mov     a,r5
030E 950B       +1  4978             subb    a,mant2+3
0310 FD         +1  4979             mov     r5,a
0311 EC         +1  4980             mov     a,r4
0312 950A       +1  4981             subb    a,mant2+2               ;do subtraction
0314 FC         +1  4982             mov     r4,a
0315 EB         +1  4983             mov     a,r3
0316 9509       +1  4984             subb    a,mant2+1               ;do subtraction
0318 FB         +1  4985             mov     r3,a
0319 EA         +1  4986             mov     a,r2
031A 9508       +1  4987             subb    a,mant2         ;do subtraction
031C FA         +1  4988             mov     r2,a
031D 430F01     +1  4989             orl     prod+3,#1       ;set lsb in quotient
0320            +1  4990     div2:
                +1  4991+3           lshift                  ;shift dividend up
0320 ED         +1  4992+1           mov     a,r5
0321 33         +1  4993+1           rlc     a
0322 FD         +1  4994+1           mov     r5,a
0323 EC         +1  4995+1           mov     a,r4
0324 33         +1  4996+1           rlc     a
0325 FC         +1  4997+1           mov     r4,a
0326 EB         +1  4998+1           mov     a,r3
0327 33         +1  4999+1           rlc     a
0328 FB         +1  5000+1           mov     r3,a
0329 EA         +1  5001+1           mov     a,r2
032A 33         +1  5002+1           rlc     a
032B FA         +1  5003+1           mov     r2,a
032C DEAF       +1  5004             djnz    r6,div1         ;loop if more
                +1  5005+3           copytor prod            ;copy quotient
032E AA0C       +1  5006+1           mov     r2,prod
0330 AB0D       +1  5007+1           mov     r3,prod+1
0332 AC0E       +1  5008+1           mov     r4,prod+2
0334 AD0F       +1  5009+1           mov     r5,prod+3
0336            +1  5010     div9:
0336 11F0       +1  5011             call    norm1           ;now normalize result
0338 11DE       +1  5012             call    pack1           ;pack it up
                +1  5013+3           restregs                ;restore registers
033A D000       +1  5014+1           pop     0
033C D001       +1  5015+1           pop     1
033E D006       +1  5016+1           pop     6
0340 D007       +1  5017+1           pop     7
0342 22         +1  5018             ret
                +1  5019     ;------------------------------------------------------------------
                +1  5020     
                +1  5021     ;       Float to long conversion: if the exponent is less than the
                +1  5022     ;       excess value, the result is zero. If the exponent is so large
                +1  5023     ;       that the value would be shifted out, the result is overflow.
                +1  5024     ;       Otherwise shift the mantissa up or down as required.
                +1  5025     
0343            +1  5026     ftol:
                +1  5027+3           saveregs
0343 C007       +1  5028+1           push    7
0345 C006       +1  5029+1           push    6
0347 C001       +1  5030+1           push    1
0349 C000       +1  5031+1           push    0
034B EA         +1  5032             mov     a,r2
034C B4BF09     +1  5033             cjne    a,#0bfh,ne05
034F EB         +1  5034             mov     a,r3
0350 7006       +1  5035             jnz     ne05
0352 EC         +1  5036             mov     a,r4
0353 7003       +1  5037             jnz     ne05
0355 ED         +1  5038             mov     a,r5
0356 6024       +1  5039             jz      ftol1
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    79

0358 119E       +1  5040     ne05:   call    unpack1
035A E8         +1  5041             mov     a,r0            ;get exponent
035B 2482       +1  5042             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  5043             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  5044             mov     a,r7            ;get sign
0361 30E70D     +1  5045             jnb     acc.7,ftol4     ;skip if +ve
                +1  5046+3           neg1                    ;negate it
0364 C3         +1  5047+1           clr     c
0365 E4         +1  5048+1           clr     a
0366 9D         +1  5049+1           subb    a,r5
0367 FD         +1  5050+1           mov     r5,a
0368 E4         +1  5051+1           clr     a
0369 9C         +1  5052+1           subb    a,r4
036A FC         +1  5053+1           mov     r4,a
036B E4         +1  5054+1           clr     a
036C 9B         +1  5055+1           subb    a,r3
036D FB         +1  5056+1           mov     r3,a
036E E4         +1  5057+1           clr     a
036F 9A         +1  5058+1           subb    a,r2
0370 FA         +1  5059+1           mov     r2,a
0371            +1  5060     ftol4:
0371 E8         +1  5061             mov     a,r0            ;get exponent
0372 246A       +1  5062             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  5063             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  5064             mov     r0,a            ;save it
0378 24F8       +1  5065             add     a,#-8           ;if > 8, too big
037A 500E       +1  5066             jnc     ftol3
037C            +1  5067     ftol1:
037C E4         +1  5068             clr     a
037D FA         +1  5069             mov     r2,a
037E FB         +1  5070             mov     r3,a
037F FC         +1  5071             mov     r4,a
0380 FD         +1  5072             mov     r5,a
0381            +1  5073     ftol9:
                +1  5074+3           restregs
0381 D000       +1  5075+1           pop     0
0383 D001       +1  5076+1           pop     1
0385 D006       +1  5077+1           pop     6
0387 D007       +1  5078+1           pop     7
0389 22         +1  5079             ret
038A            +1  5080     ftol3:
038A E8         +1  5081             mov     a,r0
038B FE         +1  5082             mov     r6,a            ;store in counter
038C 60F3       +1  5083             jz      ftol9           ;if zero, do nothing
038E            +1  5084     ftol33:
                +1  5085+3           lshift                  ;shift up
038E ED         +1  5086+1           mov     a,r5
038F 33         +1  5087+1           rlc     a
0390 FD         +1  5088+1           mov     r5,a
0391 EC         +1  5089+1           mov     a,r4
0392 33         +1  5090+1           rlc     a
0393 FC         +1  5091+1           mov     r4,a
0394 EB         +1  5092+1           mov     a,r3
0395 33         +1  5093+1           rlc     a
0396 FB         +1  5094+1           mov     r3,a
0397 EA         +1  5095+1           mov     a,r2
0398 33         +1  5096+1           rlc     a
0399 FA         +1  5097+1           mov     r2,a
039A DEF2       +1  5098             djnz    r6,ftol33       ;and loop
039C 80E3       +1  5099             sjmp    ftol9
039E            +1  5100     ftol2:
039E F4         +1  5101             cpl     a               ;complement
039F FE         +1  5102             mov     r6,a
03A0 6022       +1  5103             jz      ftol22
03A2            +1  5104     ftol23:
03A2 EF         +1  5105             mov     a,r7
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    80

03A3 30E70F     +1  5106             jnb     acc.7,ftol24
                +1  5107+3           rshift1
03A6 D3         +1  5108+1           setb    c
03A7 EA         +1  5109+1           mov     a,r2
03A8 13         +1  5110+1           rrc     a
03A9 FA         +1  5111+1           mov     r2,a
03AA EB         +1  5112+1           mov     a,r3
03AB 13         +1  5113+1           rrc     a
03AC FB         +1  5114+1           mov     r3,a
03AD EC         +1  5115+1           mov     a,r4
03AE 13         +1  5116+1           rrc     a
03AF FC         +1  5117+1           mov     r4,a
03B0 ED         +1  5118+1           mov     a,r5
03B1 13         +1  5119+1           rrc     a
03B2 FD         +1  5120+1           mov     r5,a
03B3 800D       +1  5121             jmp     ftol25
03B5            +1  5122+3   ftol24: rshift                  ;shift down
03B5 C3         +1  5123+1           clr     c
03B6 EA         +1  5124+1           mov     a,r2
03B7 13         +1  5125+1           rrc     a
03B8 FA         +1  5126+1           mov     r2,a
03B9 EB         +1  5127+1           mov     a,r3
03BA 13         +1  5128+1           rrc     a
03BB FB         +1  5129+1           mov     r3,a
03BC EC         +1  5130+1           mov     a,r4
03BD 13         +1  5131+1           rrc     a
03BE FC         +1  5132+1           mov     r4,a
03BF ED         +1  5133+1           mov     a,r5
03C0 13         +1  5134+1           rrc     a
03C1 FD         +1  5135+1           mov     r5,a
03C2 DEDE       +1  5136     ftol25: djnz    r6,ftol23
03C4            +1  5137     ftol22:
                +1  5138+3           add1                    ;round
03C4 ED         +1  5139+1           mov     a,r5
03C5 2401       +1  5140+1           add     a,#1
03C7 FD         +1  5141+1           mov     r5,a
03C8 E4         +1  5142+1           clr     a
03C9 3C         +1  5143+1           addc    a,r4
03CA FC         +1  5144+1           mov     r4,a
03CB E4         +1  5145+1           clr     a
03CC 3B         +1  5146+1           addc    a,r3
03CD FB         +1  5147+1           mov     r3,a
03CE E4         +1  5148+1           clr     a
03CF 3A         +1  5149+1           addc    a,r2
03D0 FA         +1  5150+1           mov     r2,a
03D1 EF         +1  5151             mov     a,r7
03D2 30E70F     +1  5152             jnb     acc.7,ftol26
                +1  5153+3           rshift1
03D5 D3         +1  5154+1           setb    c
03D6 EA         +1  5155+1           mov     a,r2
03D7 13         +1  5156+1           rrc     a
03D8 FA         +1  5157+1           mov     r2,a
03D9 EB         +1  5158+1           mov     a,r3
03DA 13         +1  5159+1           rrc     a
03DB FB         +1  5160+1           mov     r3,a
03DC EC         +1  5161+1           mov     a,r4
03DD 13         +1  5162+1           rrc     a
03DE FC         +1  5163+1           mov     r4,a
03DF ED         +1  5164+1           mov     a,r5
03E0 13         +1  5165+1           rrc     a
03E1 FD         +1  5166+1           mov     r5,a
03E2 809D       +1  5167             jmp     ftol9
03E4            +1  5168+3   ftol26: rshift
03E4 C3         +1  5169+1           clr     c
03E5 EA         +1  5170+1           mov     a,r2
03E6 13         +1  5171+1           rrc     a
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    81

03E7 FA         +1  5172+1           mov     r2,a
03E8 EB         +1  5173+1           mov     a,r3
03E9 13         +1  5174+1           rrc     a
03EA FB         +1  5175+1           mov     r3,a
03EB EC         +1  5176+1           mov     a,r4
03EC 13         +1  5177+1           rrc     a
03ED FC         +1  5178+1           mov     r4,a
03EE ED         +1  5179+1           mov     a,r5
03EF 13         +1  5180+1           rrc     a
03F0 FD         +1  5181+1           mov     r5,a
03F1 808E       +1  5182             jmp     ftol9
                +1  5183     
                +1  5184     ;       arithmetic integer to floating conversions
                +1  5185     
03F3            +1  5186     abtof:
03F3 ED         +1  5187             mov     a,r5
03F4 23         +1  5188             rl      a
03F5 FC         +1  5189             mov     r4,a
03F6 9C         +1  5190             subb    a,r4
03F7 FC         +1  5191             mov     r4,a
03F8 FB         +1  5192             mov     r3,a
03F9 FA         +1  5193             mov     r2,a
03FA 8006       +1  5194             jmp     altof
03FC            +1  5195     awtof:
03FC EC         +1  5196             mov     a,r4
03FD 23         +1  5197             rl      a
03FE FB         +1  5198             mov     r3,a
03FF 9B         +1  5199             subb    a,r3
0400 FB         +1  5200             mov     r3,a
0401 FA         +1  5201             mov     r2,a
0402            +1  5202     altof:
                +1  5203+3           saveregs
0402 C007       +1  5204+1           push    7
0404 C006       +1  5205+1           push    6
0406 C001       +1  5206+1           push    1
0408 C000       +1  5207+1           push    0
040A EA         +1  5208             mov     a,r2            ;get sign
040B 5480       +1  5209             anl     a,#80h
040D FF         +1  5210             mov     r7,a            ;store it
040E 30E70D     +1  5211             jnb     acc.7,altof1    ;skip if +ve
                +1  5212+3           neg1
0411 C3         +1  5213+1           clr     c
0412 E4         +1  5214+1           clr     a
0413 9D         +1  5215+1           subb    a,r5
0414 FD         +1  5216+1           mov     r5,a
0415 E4         +1  5217+1           clr     a
0416 9C         +1  5218+1           subb    a,r4
0417 FC         +1  5219+1           mov     r4,a
0418 E4         +1  5220+1           clr     a
0419 9B         +1  5221+1           subb    a,r3
041A FB         +1  5222+1           mov     r3,a
041B E4         +1  5223+1           clr     a
041C 9A         +1  5224+1           subb    a,r2
041D FA         +1  5225+1           mov     r2,a
041E            +1  5226     altof1:
041E 7896       +1  5227             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  5228             call    norm1           ;normalize it
0422 11DE       +1  5229             call    pack1           ;and pack up
                +1  5230+3           restregs
0424 D000       +1  5231+1           pop     0
0426 D001       +1  5232+1           pop     1
0428 D006       +1  5233+1           pop     6
042A D007       +1  5234+1           pop     7
042C 22         +1  5235             ret
                +1  5236     
042D            +1  5237     lbtof:
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    82

042D 7C00       +1  5238             mov     r4,#0
042F            +1  5239     lwtof:
042F E4         +1  5240             clr     a
0430 FB         +1  5241             mov     r3,a
0431 FA         +1  5242             mov     r2,a
0432            +1  5243     lltof:
                +1  5244+3           saveregs
0432 C007       +1  5245+1           push    7
0434 C006       +1  5246+1           push    6
0436 C001       +1  5247+1           push    1
0438 C000       +1  5248+1           push    0
043A 7F00       +1  5249             mov     r7,#0           ;zero sign
043C 80E0       +1  5250             sjmp    altof1
                +1  5251     
                +1  5252     ;-------------------------------------------------------
                +1  5253     
                +1  5254     
                    5255     
                    5256     ;$include (d:\amp\\wriread.asm)
                +1  5257     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  5258     cle256:          mov            IE,#00H
0441 75B601     +1  5259                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  5260                              MOV            PSCTL,#03
                +1  5261                                             
0447 7400       +1  5262                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  5263                                     movx    @dptr,a                         ;wr
044A 758F00     +1  5264                                     mov             PSCTL,#00
044D 75B600     +1  5265                                 mov         FLSCL,#00
0450 75A880     +1  5266                               mov           IE,#80H
0453 22         +1  5267                                     ret
                +1  5268     
                +1  5269     ;чтение памяти программ в r8..r11
                +1  5270     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  5271     re4byte:        mov                     dph,r2
0456 8B82       +1  5272                                             mov                     dpl,r3
0458 E4         +1  5273                                             clr                     a
0459 93         +1  5274                                             movc            a,@a+dptr
045A F508       +1  5275                                             mov                     r8,a
045C A3         +1  5276                                             inc                     dptr
045D E4         +1  5277                                             clr                     a
045E 93         +1  5278                                             movc            a,@a+dptr
045F F509       +1  5279                                             mov                     r9,a
0461 A3         +1  5280                                             inc                     dptr
0462 E4         +1  5281                                             clr                     a
0463 93         +1  5282                                             movc            a,@a+dptr
0464 F50A       +1  5283                                             mov                     r10,a
0466 A3         +1  5284                                             inc                     dptr
0467 E4         +1  5285                                             clr                     a
0468 93         +1  5286                                             movc            a,@a+dptr
0469 F50B       +1  5287                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  5288                                             ret
                +1  5289      ;чтение памяти программ в r2..r5
                +1  5290     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  5291     rebyte2:        mov                     dph,r2
046E 8B82       +1  5292                                             mov                     dpl,r3
0470 E4         +1  5293                                             clr                     a
0471 93         +1  5294                                             movc            a,@a+dptr
0472 FA         +1  5295                                             mov                     r2,a
0473 A3         +1  5296                                             inc                     dptr
0474 E4         +1  5297                                             clr                     a
0475 93         +1  5298                                             movc            a,@a+dptr
0476 FB         +1  5299                                             mov                     r3,a
0477 A3         +1  5300                                             inc                     dptr
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    83

0478 E4         +1  5301                                             clr                     a
0479 93         +1  5302                                             movc            a,@a+dptr
047A FC         +1  5303                                             mov                     r4,a
047B A3         +1  5304                                             inc                     dptr
047C E4         +1  5305                                             clr                     a
047D 93         +1  5306                                             movc            a,@a+dptr
047E FD         +1  5307                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  5308                                             ret
                +1  5309      
                +1  5310     
                +1  5311      ;r7-количество байт
                +1  5312     ;dptr-адр ячейки для записи
                +1  5313     ;r1-адр ячейки  внешнего озу
                +1  5314     
0480 75A800     +1  5315     wrpage:  mov            IE,#00H
0483 75B601     +1  5316     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  5317                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  5318                      movx           a,@r1
048A F0         +1  5319                      movx           @dptr,a                         ;wr
048B 758F00     +1  5320                      mov            PSCTL,#0
048E 75B600     +1  5321                      mov            FLSCL,#00
0491 A3         +1  5322                     inc                     dptr
0492 09         +1  5323                     inc                     r1
0493 DFEE       +1  5324                     djnz            r7,WW5
0495 75A880     +1  5325                     mov             IE,#80H
0498 22         +1  5326                     ret
                +1  5327                             
                +1  5328     
                +1  5329     
                +1  5330                                                             
                +1  5331     
                +1  5332     
                +1  5333     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  5334     ;чтение памяти программ во внешнее озу
                +1  5335     ;вх-r2,r3-адр яч памяти прогр
                +1  5336     ;r1- яч внешнее озу
0499 8A83       +1  5337     copyPP:         mov                     dph,r2
049B 8B82       +1  5338                                             mov                     dpl,r3
049D 7FFF       +1  5339                                             mov                     r7,#0ffh
049F E4         +1  5340     copy1:          clr                     a
04A0 93         +1  5341                                             movc            a,@a+dptr
04A1 F3         +1  5342                                             movx                    @r1,a
04A2 A3         +1  5343                                             inc                     dptr
04A3 09         +1  5344                                             inc                     r1
04A4 DFF9       +1  5345                                             djnz            r7,copy1
04A6 22         +1  5346                                             ret
                +1  5347     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  5348     
                +1  5349                                     
                +1  5350     
                +1  5351     ;r8..r11->@r0..@r0+3
                +1  5352     ;r0-адр ячейки
                +1  5353     ;сохранить в ячейке озу
04A7 E508       +1  5354     savelte:        mov     a,ltemp
04A9 F6         +1  5355                                             mov     @r0,a
04AA 08         +1  5356                                             inc     r0
04AB E509       +1  5357                                             mov     a,ltemp+1
04AD F6         +1  5358                                             mov     @r0,a
04AE 08         +1  5359                                             inc     r0
04AF E50A       +1  5360                                             mov     a,ltemp+2
04B1 F6         +1  5361                                             mov     @r0,a
04B2 08         +1  5362                                             inc     r0
04B3 E50B       +1  5363                                             mov     a,ltemp+3
04B5 F6         +1  5364                                             mov     @r0,a
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    84

04B6 22         +1  5365                                             ret
                +1  5366     
                +1  5367     ;
                +1  5368     
                +1  5369     
                +1  5370     
                +1  5371     
                +1  5372     
                +1  5373                     
                +1  5374     
                +1  5375     
                +1  5376     
                +1  5377     
                +1  5378      
                    5379     
                    5380                                                   
                    5381     END
                                                                             
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    85

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   031BH   R   SEG=MAIN   798 801#
ABIN . . . . . . .  D ADDR   004FH   A      349# 1213 1218 2847 2853 2886 2912 2961 2978 3263
ABTOF. . . . . . .  C ADDR   03F3H   A      5186#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 653 700 708 716 724 726 935 1164 1320 1329 1338 1347 1368 1703 1966
                                           1988 1993 1997 2000 2003 2006 2009 2012 2180 2229 2243 2248 2290 2299 2307
                                           2317 2331 2400 2416 2438 2443 2447 2450 2453 2456 2459 2462 2734 2801 2935
                                           2940 2953 3003 3593 3671 3674 3931 4583 4666 4683 4715 4753 4781 5043 5045
                                           5063 5106 5152 5211
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   176FH   R   SEG=MAIN   828 863 865 867 869 871 873 875 877 879 4172#
ADEC . . . . . . .  D ADDR   0053H   A      350# 1217 1221 2844 2848 2883 2887 2909 2913 2962 2979 3427 3444 3462
AFTERK . . . . . .  C ADDR   04B1H   R   SEG=MAIN   957 1023#
AGE2 . . . . . . .  C ADDR   01C2H   R   SEG=MAIN   583# 586
AGEON. . . . . . .  C ADDR   01D0H   R   SEG=MAIN   592# 594
ALESS0 . . . . . .  C ADDR   05BBH   R   SEG=MAIN   1164 1185#
ALLSUM . . . . . .  C ADDR   02D9H   R   SEG=MAIN   760# 793
ALMUL. . . . . . .  C ADDR   16B6H   R   SEG=MAIN   4018#
ALTOF. . . . . . .  C ADDR   0402H   A      962 1004 1025 1035 1043 1475 1533 1571 2890 2916 2965 2982 5194 5202#
ALTOF1 . . . . . .  C ADDR   041EH   A      5211 5226# 5250
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   0412H   R   SEG=MAIN   925 931#
AN_T7. . . . . . .  C ADDR   0D6AH   R   SEG=MAIN   2463# 2513 2522
AUTOKA . . . . . .  C ADDR   0767H   R   SEG=MAIN   1503#
AVPGO. . . . . . .  C ADDR   0525H   R   SEG=MAIN   1089 1091#
AVTDEC1. . . . . .  C ADDR   0478H   R   SEG=MAIN   979 986#
AWTOF. . . . . . .  C ADDR   03FCH   A      5195#
B. . . . . . . . .  D ADDR   00F0H   A      122# 3083 3283 4021 4024 4026 4030 4034 4038 4042 4047 4051 4058 4062
                                           4066 4072 4076 4080 4086 4779 4780
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 478#
BFORM. . . . . . .  C ADDR   0907H   R   SEG=MAIN   1781 1786 1798# 1824
BIN30. . . . . . .  C ADDR   14D2H   R   SEG=MAIN   3581# 3607
BIN31. . . . . . .  C ADDR   14D6H   R   SEG=MAIN   3586# 3590
BIN32. . . . . . .  C ADDR   14E6H   R   SEG=MAIN   3599# 3604
BIN41. . . . . . .  C ADDR   14F7H   R   SEG=MAIN   3615# 3625
BINDEC . . . . . .  C ADDR   14C6H   R   SEG=MAIN   1219 3560#
BITAKT . . . . . .  B ADDR   0023H.2 A      397# 1296 1297 1300
BITAVP . . . . . .  B ADDR   0020H.5 A      368# 1049 1118 1288 2503 2504 2506
BITBON . . . . . .  B ADDR   0021H.2 A      375# 1398 2015 2016 2018
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    86

BITBUF . . . . . .  B ADDR   0021H.0 A      373# 1419 1421 2097
BITIZM . . . . . .  B ADDR   0020H.4 A      367# 563 674 1994 2051 2136 2444 2496 2588 2604 2666 2694 2780 2788 2927
BITMAS . . . . . .  B ADDR   0020H.1 A      364# 885 888 1763
BITMEM . . . . . .  B ADDR   0021H.3 A      376# 2284 2697 2729 2779 2787 2926
BITMENU. . . . . .  B ADDR   0022H.1 A      384# 2264 2497
BITMIG . . . . . .  B ADDR   0023H.1 A      396# 1965 2237 2636 2947 3201 3208 3213 3219 3224 3238 3250
BITNUL . . . . . .  B ADDR   0021H.7 A      380# 1273 2524 2525 2532
BITOLL . . . . . .  B ADDR   0022H.7 A      390# 629 1125 1202
BITPRD . . . . . .  B ADDR   0021H.1 A      374# 1397
BITRS. . . . . . .  B ADDR   0020H.3 A      366#
BITT2. . . . . . .  B ADDR   0022H.0 A      383# 1201 2137 2177 2539 2667
BITVI11. . . . . .  B ADDR   0020H.6 A      369# 1050 2050 2261
BITVI12. . . . . .  B ADDR   0022H.2 A      385#
BITVI13. . . . . .  B ADDR   0022H.3 A      386#
BITVI21. . . . . .  B ADDR   0022H.5 A      388#
BITVI31. . . . . .  B ADDR   0022H.6 A      389#
BITVICH. . . . . .  B ADDR   0022H.4 A      387# 1200 2052 2062 2199 2556 2587 2603
BITZNAK. . . . . .  B ADDR   0020H.0 A      363# 654 683 1012
BITZUS . . . . . .  B ADDR   0020H.7 A      370# 1141
BMEM11 . . . . . .  B ADDR   0021H.4 A      377# 2262
BMEM12 . . . . . .  B ADDR   0021H.5 A      378#
BMEM13 . . . . . .  B ADDR   0021H.6 A      379#
BOUT7. . . . . . .  C ADDR   0EE4H   R   SEG=MAIN   2675# 2677
BRET . . . . . . .  C ADDR   1187H   R   SEG=MAIN   3031 3036 3040#
BUFDEC . . . . . .  C ADDR   05EFH   R   SEG=MAIN   1224# 1229
BUFIND . . . . . .  D ADDR   0040H   A      347# 582 586 591 594 598 1174 1179 1222 1230 1232 1237 1271 1298 1301
                                           1635 1982 2432 2649 2681 2687 3081 3099 3205 3227 3426 3443 3461
BUFON. . . . . . .  C ADDR   0A40H   R   SEG=MAIN   2015 2018#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      4776# 4780
CELLBIT. . . . . .  D ADDR   0020H   A      362# 363 364 365 366 367 368 369 370
CELLBIT1 . . . . .  D ADDR   0021H   A      372# 373 374 375 376 377 378 379 380
CELLBIT2 . . . . .  D ADDR   0022H   A      382# 383 384 385 386 387 388 389 390
CELLBIT3 . . . . .  D ADDR   0023H   A      394# 395 396 397
CEXP . . . . . . .  C ADDR   01E2H   A      4753 4762#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   13FFH   R   SEG=MAIN   2533 3372#
CH1. . . . . . . .  C ADDR   141BH   R   SEG=MAIN   1620 3382#
CH10 . . . . . . .  C ADDR   1403H   R   SEG=MAIN   898 3373#
CH100. . . . . . .  C ADDR   1413H   R   SEG=MAIN   1159 3377#
CH10000. . . . . .  C ADDR   140FH   R   SEG=MAIN   3376#
CH2. . . . . . . .  C ADDR   1417H   R   SEG=MAIN   894 3378#
CH20 . . . . . . .  C ADDR   13BDH   R   SEG=MAIN   792 3325#
CH2THO . . . . . .  C ADDR   142FH   R   SEG=MAIN   3387#
CH5. . . . . . . .  C ADDR   1407H   R   SEG=MAIN   3374#
CH57 . . . . . . .  C ADDR   13B9H   R   SEG=MAIN   759 3324#
CH954. . . . . . .  C ADDR   140BH   R   SEG=MAIN   3375#
CHANMA . . . . . .  C ADDR   0BAAH   R   SEG=MAIN   2243 2246#
CHANZ. . . . . . .  C ADDR   0BA0H   R   SEG=MAIN   2229 2241#
CHAVT. . . . . . .  D ADDR   0081H   A      411# 544 942 980 986 1603
CHBEFORE . . . . .  D ADDR   009BH   A      421# 565 756 769 787
CHBUF. . . . . . .  D ADDR   00ADH   A      428# 1395 1405
CHCMP. . . . . . .  C ADDR   09ACH   R   SEG=MAIN   666 943 948 1940#
CHDEC. . . . . . .  C ADDR   0813H   R   SEG=MAIN   673 987 996 1612#
CHDEL. . . . . . .  D ADDR   0083H   A      412# 1445 1489 1510 1553 1597
CHDELMO. . . . . .  C ADDR   074FH   R   SEG=MAIN   1460 1489# 1493
CHIF . . . . . . .  C ADDR   134AH   R   SEG=MAIN   3231 3233#
CHIND. . . . . . .  D ADDR   00ACH   A      427# 1064 1305
CHINKOR. . . . . .  D ADDR   0098H   A      410# 539 933 947 982 995 1495
CHKL . . . . . . .  D ADDR   003DH   A      354# 665 672 2115 2143 2192 2477 2700
CHMAS. . . . . . .  D ADDR   006EH   A      351# 882 889 902 1762
CHMASN . . . . . .  D ADDR   003FH   A      355# 745 754 788 805 817 887 889 890
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    87

CHTADC . . . . . .  C ADDR   085DH   R   SEG=MAIN   1661#
CHTHO. . . . . . .  C ADDR   1427H   R   SEG=MAIN   1540 1578 3385#
CHTHOU . . . . . .  C ADDR   14ADH   R   SEG=MAIN   3503#
CHZAP. . . . . . .  C ADDR   13FBH   R   SEG=MAIN   1384 3371#
CH_1 . . . . . . .  C ADDR   141FH   R   SEG=MAIN   568 3383#
CH_10TH. . . . . .  C ADDR   143BH   R   SEG=MAIN   1084 3390#
CH_200 . . . . . .  C ADDR   1437H   R   SEG=MAIN   1044 3389#
CH_220 . . . . . .  C ADDR   1433H   R   SEG=MAIN   1029 3388#
CH_953 . . . . . .  C ADDR   1423H   R   SEG=MAIN   3384#
CIKLWR . . . . . .  C ADDR   08DDH   R   SEG=MAIN   1769#
CKCON. . . . . . .  D ADDR   008EH   A      30# 496
CL4. . . . . . . .  C ADDR   144DH   R   SEG=MAIN   3406# 3408
CL4N . . . . . . .  C ADDR   1453H   R   SEG=MAIN   3415# 3417
CLE256 . . . . . .  C ADDR   043EH   A      5258#
CLEAR. . . . . . .  C ADDR   14C0H   R   SEG=MAIN   3538 3542# 3572
CLEAR4 . . . . . .  C ADDR   144AH   R   SEG=MAIN   766 1100 1102 1138 1140 2044 2046 2518 2520 3404#
CLEARN . . . . . .  C ADDR   1452H   R   SEG=MAIN   2845 2884 2910 3413#
CLMASSIX . . . . .  C ADDR   08CDH   R   SEG=MAIN   538 1098 1136 1499 1756# 2042 2516
CLMASV . . . . . .  C ADDR   052AH   R   SEG=MAIN   1093 1095#
CLMAX. . . . . . .  C ADDR   08D2H   R   SEG=MAIN   1758# 1761
CLR11. . . . . . .  C ADDR   14C1H   R   SEG=MAIN   3544# 3546
CLRDEC . . . . . .  C ADDR   14BAH   R   SEG=MAIN   3536#
CLRNUM . . . . . .  C ADDR   14BEH   R   SEG=MAIN   3539# 3653
CLRVICH. . . . . .  C ADDR   0E6BH   R   SEG=MAIN   2603# 2619
CNTR . . . . . . .  N NUMB   0006H   A      4449#
CO02S. . . . . . .  C ADDR   13F0H   R   SEG=MAIN   3365# 3369
CO1S . . . . . . .  C ADDR   13E7H   R   SEG=MAIN   3359# 3359
CO2S . . . . . . .  C ADDR   13E3H   R   SEG=MAIN   3357# 3361
COND . . . . . . .  C ADDR   0941H   R   SEG=MAIN   1853#
CONSTE . . . . . .  D ADDR   00A4H   A      425# 1106
CONSTF . . . . . .  D ADDR   00A8H   A      426# 1111
COPY1. . . . . . .  C ADDR   049FH   A      5340# 5345
COPYPP . . . . . .  C ADDR   0499H   A      5337#
COUNT. . . . . . .  C ADDR   13C5H   R   SEG=MAIN   3331# 3331
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   13CCH   R   SEG=MAIN   3337# 3337
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 501
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1166 1187
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1169 1191
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 502
DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1392
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1389
DCOA . . . . . . .  C ADDR   0946H   R   SEG=MAIN   1857# 1859
DCOB . . . . . . .  C ADDR   094DH   R   SEG=MAIN   1861# 1879
DCOC . . . . . . .  C ADDR   0958H   R   SEG=MAIN   1871# 1876
DCOD . . . . . . .  C ADDR   0965H   R   SEG=MAIN   1878 1881#
DD . . . . . . . .  C ADDR   01FCH   R   SEG=MAIN   620#
DDOUTF . . . . . .  C ADDR   0FD7H   R   SEG=MAIN   2777 2784 2811 2817# 2839
DEC30. . . . . . .  C ADDR   1513H   R   SEG=MAIN   3663# 3688
DEC31. . . . . . .  C ADDR   1518H   R   SEG=MAIN   3669# 3676
DEC32. . . . . . .  C ADDR   1528H   R   SEG=MAIN   3681# 3685
DECBIN . . . . . .  C ADDR   1506H   R   SEG=MAIN   2849 2888 2914 2963 2980 3642#
DECSIZE. . . . . .  N NUMB   000AH   A      3517# 3537 3571 3598 3611 3614 3668
DECT2. . . . . . .  C ADDR   1531H   R   SEG=MAIN   3659 3691#
DEDPTR . . . . . .  C ADDR   1786H   R   SEG=MAIN   4176 4180 4184 4190#
DENORM . . . . . .  C ADDR   0133H   A      4608# 4664
DGOTO7 . . . . . .  C ADDR   10AAH   R   SEG=MAIN   2917# 2923
DIAP . . . . . . .  D ADDR   00AEH   A      429# 557 1088 1120 1236 2036 2068 2105 2468 2509 3011 3032 3280 3475
DIINC. . . . . . .  C ADDR   0A5FH   R   SEG=MAIN   2039 2042#
DIKDN. . . . . . .  C ADDR   1391H   R   SEG=MAIN   3282 3302#
DIKDW. . . . . . .  C ADDR   1497H   R   SEG=MAIN   3479 3491#
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    88

DIPAR. . . . . . .  C ADDR   14ABH   R   SEG=MAIN   3501#
DIV1 . . . . . . .  C ADDR   02DDH   A      4945# 5004
DIV2 . . . . . . .  C ADDR   0320H   A      4963 4967 4971 4975 4990#
DIV3 . . . . . . .  C ADDR   030DH   A      4964 4968 4972 4976#
DIV9 . . . . . . .  C ADDR   0336H   A      4934 4936 5010#
DIVIDE . . . . . .  C ADDR   15F1H   R   SEG=MAIN   1785 3877#
DONE . . . . . . .  C ADDR   1560H   R   SEG=MAIN   3707 3718#
DONE1. . . . . . .  C ADDR   155EH   R   SEG=MAIN   3710 3713 3716#
DOSH . . . . . . .  C ADDR   167AH   R   SEG=MAIN   3952 3968#
DOSUB. . . . . . .  C ADDR   1668H   R   SEG=MAIN   3936 3940 3944 3948 3949 3953#
DPH. . . . . . . .  D ADDR   0083H   A      19# 1716 1724 3724 3760 3795 3798 3810 3833 4195 4197 5271 5291 5337
DPL. . . . . . . .  D ADDR   0082H   A      18# 1717 1723 3740 3776 3797 3811 3814 3848 4192 4194 5272 5292 5338
DVIG0. . . . . . .  C ADDR   06A2H   R   SEG=MAIN   1341# 1343
DVIG1. . . . . . .  C ADDR   0697H   R   SEG=MAIN   1332# 1334
DVIG2. . . . . . .  C ADDR   068CH   R   SEG=MAIN   1323# 1325
DVIG3. . . . . . .  C ADDR   0680H   R   SEG=MAIN   1314# 1316
DVIG4. . . . . . .  C ADDR   06AEH   R   SEG=MAIN   1352# 1354
DVIG6. . . . . . .  C ADDR   06CDH   R   SEG=MAIN   1377# 1379
DVM. . . . . . . .  C ADDR   06CBH   R   SEG=MAIN   1368 1376#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 499
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 525 1633 1645 1976 2401 2415 3008
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDSDV . . . . . .  C ADDR   06D1H   R   SEG=MAIN   1374 1380#
ENDSUM . . . . . .  C ADDR   03CCH   R   SEG=MAIN   829 881#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU1L. . . . . . .  C ADDR   0C8DH   R   SEG=MAIN   2350 2354#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      4451#
EXP2 . . . . . . .  N NUMB   0001H   A      4453# 4630 4651
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDKOEF . . . . .  C ADDR   1488H   R   SEG=MAIN   3474#
FINIS. . . . . . .  C ADDR   16A5H   R   SEG=MAIN   3896 3997#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      1113 4656# 4745
FLCMP. . . . . . .  C ADDR   01D6H   A      1031 1046 1086 4750#
FLDIV. . . . . . .  C ADDR   02B7H   A      1110 1542 1580 4920#
FLMUL. . . . . . .  C ADDR   0203H   A      965 1016 1038 4790#
FLOUT. . . . . . .  C ADDR   01E1H   A      4757 4760#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 5259 5265 5316 5321
FLSUB. . . . . . .  C ADDR   01D1H   A      1008 1538 1576 4743#
FND. . . . . . . .  C ADDR   01F8H   A      4766 4769 4772 4775 4778#
FO1M . . . . . . .  C ADDR   0904H   R   SEG=MAIN   1791 1795#
FO2M . . . . . . .  C ADDR   090DH   R   SEG=MAIN   1798 1800#
FORM4. . . . . . .  C ADDR   090EH   R   SEG=MAIN   1793 1799 1803#
FT1IZM . . . . . .  C ADDR   0B3EH   R   SEG=MAIN   2187#
FTOL . . . . . . .  C ADDR   0343H   A      966 1018 1040 1207 5026#
FTOL1. . . . . . .  C ADDR   037CH   A      5039 5043 5067#
FTOL2. . . . . . .  C ADDR   039EH   A      5063 5100#
FTOL22 . . . . . .  C ADDR   03C4H   A      5103 5137#
FTOL23 . . . . . .  C ADDR   03A2H   A      5104# 5136
FTOL24 . . . . . .  C ADDR   03B5H   A      5106 5122#
FTOL25 . . . . . .  C ADDR   03C2H   A      5121 5136#
FTOL26 . . . . . .  C ADDR   03E4H   A      5152 5168#
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    89

FTOL3. . . . . . .  C ADDR   038AH   A      5066 5080#
FTOL33 . . . . . .  C ADDR   038EH   A      5084# 5098
FTOL4. . . . . . .  C ADDR   0371H   A      5045 5060#
FTOL9. . . . . . .  C ADDR   0381H   A      5073# 5083 5099 5167 5182
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   507# 508
GO23NO . . . . . .  C ADDR   0FA6H   R   SEG=MAIN   2785 2791#
GO31L. . . . . . .  C ADDR   0C93H   R   SEG=MAIN   2342 2359#
GO41L. . . . . . .  C ADDR   0C98H   R   SEG=MAIN   2359 2361#
GOA2 . . . . . . .  C ADDR   04ECH   R   SEG=MAIN   1048 1051#
GOA3A2 . . . . . .  C ADDR   04F6H   R   SEG=MAIN   1056# 1116
GOCIKLE. . . . . .  C ADDR   070AH   R   SEG=MAIN   1399 1408 1412 1419# 1425 1428
GOFULL . . . . . .  C ADDR   0FD1H   R   SEG=MAIN   2795 2815#
GOONIN . . . . . .  C ADDR   0503H   R   SEG=MAIN   1063# 1103 1126 1142
GOONIND. . . . . .  C ADDR   05C4H   R   SEG=MAIN   1066 1192#
GOONT. . . . . . .  C ADDR   06F4H   R   SEG=MAIN   1402 1404#
GOTO7. . . . . . .  C ADDR   0D76H   R   SEG=MAIN   2471 2476# 2530 2537 2573 2589 2607 2625 2637 2675 2679 2704 2739
                                           2748 2752 2766 2781 2789 2797 2817 2827 2861 2874 2876 2898 2917 2929 2937
                                           2944 2973
GOTOKD . . . . . .  C ADDR   0437H   R   SEG=MAIN   929 953#
GOZNAK . . . . . .  C ADDR   0271H   R   SEG=MAIN   660 689#
HNOR11 . . . . . .  C ADDR   0E76H   R   SEG=MAIN   2566 2578 2610#
HNOR12 . . . . . .  C ADDR   0E37H   R   SEG=MAIN   2574 2578#
HNOT1. . . . . . .  C ADDR   0EB0H   R   SEG=MAIN   2551 2646#
HNOT2. . . . . . .  C ADDR   0E05H   R   SEG=MAIN   2548#
HR12 . . . . . . .  C ADDR   0E2DH   R   SEG=MAIN   2569 2574#
HVI1113. . . . . .  C ADDR   0E27H   R   SEG=MAIN   2572# 2577 2582
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 526 5258 5266 5315 5325
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   0E01H   R   SEG=MAIN   2543 2545#
IND. . . . . . . .  C ADDR   082BH   R   SEG=MAIN   587 595 620 677 1302 1633# 2029 2500
INDA3. . . . . . .  C ADDR   058BH   R   SEG=MAIN   1157#
INDOLL . . . . . .  C ADDR   0563H   R   SEG=MAIN   1118 1119 1123#
INIACP . . . . . .  C ADDR   12BFH   R   SEG=MAIN   626 2664 3140#
INTN . . . . . . .  C ADDR   1093H   R   SEG=MAIN   2908#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   0E98H   R   SEG=MAIN   2627#
IZMAN. . . . . . .  C ADDR   0AB0H   R   SEG=MAIN   1963 2089#
IZMFUN . . . . . .  C ADDR   0ABFH   R   SEG=MAIN   2030 2041 2048 2093 2096#
IZMPAT . . . . . .  C ADDR   0AC3H   R   SEG=MAIN   2013 2017 2019 2065 2100#
IZMT2. . . . . . .  C ADDR   0AE0H   R   SEG=MAIN   2116 2121#
IZMT3. . . . . . .  C ADDR   0AEBH   R   SEG=MAIN   2121 2127#
JFINIS . . . . . .  C ADDR   160CH   R   SEG=MAIN   3888 3896#
KD . . . . . . . .  C ADDR   142BH   R   SEG=MAIN   3386#
KEYB1. . . . . . .  C ADDR   09CEH   R   SEG=MAIN   283 1964#
KEYB2. . . . . . .  C ADDR   0D05H   R   SEG=MAIN   286 2414#
KFULL. . . . . . .  C ADDR   0FAAH   R   SEG=MAIN   2762 2794#
KGO23. . . . . . .  C ADDR   0F96H   R   SEG=MAIN   2761 2783#
KLEV1. . . . . . .  C ADDR   0F57H   R   SEG=MAIN   2731 2753#
KLEV2. . . . . . .  C ADDR   0F5CH   R   SEG=MAIN   2753 2755#
KLEV21 . . . . . .  C ADDR   0F78H   R   SEG=MAIN   2759 2768#
KLEV22 . . . . . .  C ADDR   0F61H   R   SEG=MAIN   2755 2759#
KLEV23 . . . . . .  C ADDR   0F80H   R   SEG=MAIN   2768 2773#
KLMAS. . . . . . .  C ADDR   0337H   R   SEG=MAIN   771 808 816#
KNAVP. . . . . . .  C ADDR   0DA8H   R   SEG=MAIN   2456 2503#
KNIZM. . . . . . .  B ADDR   0023H.0 A      395# 1048 1119 1292 2067 2089 2090 2094
KNIZMON. . . . . .  C ADDR   0ABAH   R   SEG=MAIN   2089 2094#
KNKMP. . . . . . .  C ADDR   0CF6H   R   SEG=MAIN   2409# 2450
KNLEFT . . . . . .  C ADDR   0DB5H   R   SEG=MAIN   2413 2509#
KNMEM. . . . . . .  C ADDR   0F02H   R   SEG=MAIN   2408 2694#
KNMENU . . . . . .  C ADDR   0D98H   R   SEG=MAIN   2462 2496#
KNNUL. . . . . . .  C ADDR   0DD0H   R   SEG=MAIN   2412 2524#
KNOPT. . . . . . .  C ADDR   0AF3H   R   SEG=MAIN   1962 2135#
KNRAZR . . . . . .  C ADDR   0B08H   R   SEG=MAIN   1961 2149#
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    90

KNRIGHT. . . . . .  C ADDR   0A55H   R   SEG=MAIN   2003 2034#
KNVICH . . . . . .  C ADDR   0A71H   R   SEG=MAIN   2012 2050#
KOEFKD . . . . . .  D ADDR   00A0H   A      424# 574
KOEFKM . . . . . .  D ADDR   0094H   A      418# 572 1014 1584
KOEFKP . . . . . .  D ADDR   0090H   A      417# 570 1009 1546
KONSTA . . . . . .  D ADDR   00BCH   A      437# 2966
KONSTB . . . . . .  D ADDR   00C0H   A      438# 2983
KOR0US . . . . . .  C ADDR   1197H   R   SEG=MAIN   1458 3063#
KOR0_AN. . . . . .  D ADDR   0084H   A      414# 1005 1476 1536 1574
KORDEC1. . . . . .  C ADDR   0486H   R   SEG=MAIN   992 995#
KORDEC10 . . . . .  C ADDR   0471H   R   SEG=MAIN   982#
KORNUL . . . . . .  C ADDR   072FH   R   SEG=MAIN   939 1445#
KVVOD0 . . . . . .  C ADDR   0FC4H   R   SEG=MAIN   2741 2801 2810#
LABELA . . . . . .  C ADDR   0246H   R   SEG=MAIN   663# 681 1422
LABELB . . . . . .  C ADDR   0679H   R   SEG=MAIN   974 1145 1307# 1433 1437 1439
LABELC . . . . . .  C ADDR   0B08H   R   SEG=MAIN   2150#
LABELE . . . . . .  C ADDR   0AD1H   R   SEG=MAIN   2098 2108 2111 2114# 2155 2158 2170 2173
LABELF . . . . . .  C ADDR   0B2AH   R   SEG=MAIN   1960 2176#
LABELH . . . . . .  C ADDR   0DF0H   R   SEG=MAIN   2411 2539#
LABELI . . . . . .  C ADDR   10C5H   R   SEG=MAIN   2554 2639 2932#
LABELK . . . . . .  C ADDR   0F1DH   R   SEG=MAIN   2553 2707#
LABELL . . . . . .  C ADDR   0C38H   R   SEG=MAIN   2262 2304 2313#
LABELL1. . . . . .  C ADDR   0BB2H   R   SEG=MAIN   2250# 2366 2388
LABELN . . . . . .  C ADDR   0CB2H   R   SEG=MAIN   2374#
LABELP . . . . . .  C ADDR   10C5H   R   SEG=MAIN   2919 2930#
LABL2. . . . . . .  C ADDR   0C7FH   R   SEG=MAIN   2345# 2771 2833
LABL21 . . . . . .  C ADDR   0C58H   R   SEG=MAIN   2314 2328#
LABL22 . . . . . .  C ADDR   0C6EH   R   SEG=MAIN   2332 2337#
LABM . . . . . . .  C ADDR   0FF9H   R   SEG=MAIN   2773 2835#
LADD . . . . . . .  C ADDR   174DH   R   SEG=MAIN   751 784 1387 4123#
LADDX. . . . . . .  C ADDR   175EH   R   SEG=MAIN   4147#
LAL22. . . . . . .  C ADDR   0C50H   R   SEG=MAIN   2318 2323#
LBTOF. . . . . . .  C ADDR   042DH   A      5237#
LCMP . . . . . . .  C ADDR   154BH   R   SEG=MAIN   1822 1950 3703#
LDC_LONG . . . . .  C ADDR   1561H   R   SEG=MAIN   569 1385 1541 1579 2534 3723#
LDC_LTEMP. . . . .  C ADDR   1583H   R   SEG=MAIN   760 895 899 1030 1045 1085 1160 1621 3759#
LDX_LONG . . . . .  C ADDR   15A9H   R   SEG=MAIN   3794#
LDX_LTEMP. . . . .  C ADDR   15CFH   R   SEG=MAIN   3832#
LEFCUR . . . . . .  C ADDR   103CH   R   SEG=MAIN   2867# 2903 2921
LEFMEM11 . . . . .  C ADDR   0F25H   R   SEG=MAIN   2732# 2754 2756
LEV220 . . . . . .  C ADDR   0F64H   R   SEG=MAIN   2760# 2769
LEV2GO . . . . . .  C ADDR   0CC6H   R   SEG=MAIN   2373 2384#
LEVEL. . . . . . .  D ADDR   00B0H   A      431# 2021 2267 2285 2313 2698 2730 2812
LI21 . . . . . . .  C ADDR   0EA2H   R   SEG=MAIN   2634 2636#
LLDI2. . . . . . .  C ADDR   0AA9H   R   SEG=MAIN   2080 2084#
LLDI23 . . . . . .  C ADDR   0A9DH   R   SEG=MAIN   2072 2077#
LLDI3. . . . . . .  C ADDR   0AA4H   R   SEG=MAIN   2079 2081#
LLEV2. . . . . . .  C ADDR   0C9DH   R   SEG=MAIN   2344 2364#
LLMUL. . . . . . .  C ADDR   16B6H   R   SEG=MAIN   4017#
LLSUB. . . . . . .  C ADDR   173BH   R   SEG=MAIN   4099#
LLTOF. . . . . . .  C ADDR   0432H   A      5243#
LMUL . . . . . . .  C ADDR   16B6H   R   SEG=MAIN   1780 4019#
LOAB12 . . . . . .  C ADDR   130EH   R   SEG=MAIN   2662 3179#
LOAD . . . . . . .  D ADDR   00B7H   A      435# 2138 2181 2541 2658 3080
LOADB. . . . . . .  C ADDR   0EC1H   R   SEG=MAIN   2653 2656# 2685 2691
LOADB2 . . . . . .  C ADDR   0EE7H   R   SEG=MAIN   2673 2677#
LOADCLE. . . . . .  C ADDR   0F43H   R   SEG=MAIN   2746# 2804
LOADKD . . . . . .  C ADDR   1373H   R   SEG=MAIN   963 1036 3280#
LOADR2 . . . . . .  C ADDR   1365H   R   SEG=MAIN   2889 2915 2964 2981 3263#
LOADT. . . . . . .  C ADDR   11ACH   R   SEG=MAIN   2140 2187 2547 3080#
LOADUS . . . . . .  C ADDR   1158H   R   SEG=MAIN   627 1096 1133 1488 2047 2095 2521 2665 3011#
LOBLOK . . . . . .  C ADDR   0FDFH   R   SEG=MAIN   2792 2821# 2829
LOCLE. . . . . . .  C ADDR   0F3EH   R   SEG=MAIN   2735 2744#
LOD1 . . . . . . .  C ADDR   11BBH   R   SEG=MAIN   3088# 3093
LODT . . . . . . .  C ADDR   11C7H   R   SEG=MAIN   3100# 3105
LOIZMK . . . . . .  C ADDR   0E3AH   R   SEG=MAIN   2579# 2601
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    91

LOLEVT . . . . . .  C ADDR   11AEH   R   SEG=MAIN   2027 3081#
LOLIST . . . . . .  C ADDR   0F32H   R   SEG=MAIN   2737#
LOOP . . . . . . .  C ADDR   089AH   R   SEG=MAIN   1702# 1703
LOOPS. . . . . . .  C ADDR   160FH   R   SEG=MAIN   3898# 3931
LOSPUS . . . . . .  C ADDR   118BH   R   SEG=MAIN   1459 3046#
LOTEXT . . . . . .  C ADDR   11C3H   R   SEG=MAIN   1124 2058 2204 2211 2217 2223 2270 2277 2293 2302 2310 2321 2325
                                           2335 2339 2499 2572 2624 2696 2738 2747 2751 2765 2816 2822 2856 2893 2971
                                           3097#
LOU. . . . . . . .  C ADDR   0AAFH   R   SEG=MAIN   2067 2083 2087#
LOUIZM . . . . . .  C ADDR   0A8CH   R   SEG=MAIN   2067# 2092 3040
LOUTF. . . . . . .  C ADDR   0C55H   R   SEG=MAIN   2317 2326# 2331 2365 2371
LOVICH . . . . . .  C ADDR   0E30H   R   SEG=MAIN   2575# 2595 2614 2990
LOWR . . . . . . .  C ADDR   0F4CH   R   SEG=MAIN   2744 2749#
LOWR1. . . . . . .  C ADDR   0F4EH   R   SEG=MAIN   2750# 2808
LSUB . . . . . . .  C ADDR   173BH   R   SEG=MAIN   971 1059 1622 4100#
LTEMP. . . . . . .  N NUMB   0008H   A      902 904 905 906 1832 1835 1838 1841 1884 1885 1886 1887 3505 3506 3507
                                           3508 3515# 3889 3890 3891 3892 3901 3905 3909 3913 3916 3917 3918 3919
                                           3920 3921 3922 3923 3924 3925 3926 3927 3930 3933 3938 3942 3946 3956 3959
                                           3962 3965 3981 3984 3985 3987 3988 3990 3991 3993 3998 3999 4000 4001 4021
                                           4026 4034 4042 4047 4058 4066 4072 4080 4086 4454 4455 4494 4499 4501 4510
                                           4511 4512 4513 4744 4752 4765 4768 4771 4774 5354 5357 5360 5363
LWR. . . . . . . .  C ADDR   08DFH   R   SEG=MAIN   1771# 1775
LWRX . . . . . . .  C ADDR   08A3H   R   SEG=MAIN   1715# 1727
LWTOF. . . . . . .  C ADDR   042FH   A      5239#
MABIN. . . . . . .  D ADDR   006FH   A      352#
MAFORM . . . . . .  C ADDR   08FAH   R   SEG=MAIN   1212 1779 1784 1789# 1821
MAIN . . . . . . .  C SEG    1798H       REL=UNIT   237 343# 471
MANT1. . . . . . .  N NUMB   0002H   A      4452# 4479 4528 4529
MANT2. . . . . . .  N NUMB   0008H   A      4454# 4505 4506 4637 4639 4640 4642 4643 4645 4646 4648 4687 4688 4690
                                           4691 4693 4694 4696 4697 4701 4703 4706 4709 4807 4809 4810 4812 4813 4815
                                           4816 4818 4869 4871 4872 4874 4875 4877 4878 4880 4962 4966 4970 4974 4978
                                           4981 4984 4987
MARK0_8. . . . . .  C ADDR   0B98H   R   SEG=MAIN   2232 2236#
MARKER . . . . . .  D ADDR   00B2H   A      433# 549 1981 2231 2346 2374 2431 2605 2621 2632 2823 2857 2867 2894 2941
                                           2986 3197 3225 3240 3251
MARLE. . . . . . .  C ADDR   134BH   R   SEG=MAIN   2875 3237#
MARRI. . . . . . .  C ADDR   1358H   R   SEG=MAIN   2382 3250#
MAS10. . . . . . .  C ADDR   0355H   R   SEG=MAIN   818 830#
MAS5DIV. . . . . .  C ADDR   03FBH   R   SEG=MAIN   896 900 908#
MASFULL. . . . . .  C ADDR   03D8H   R   SEG=MAIN   885 889#
MASS0. . . . . . .  X ADDR   0080H   A      444 445# 819 824 851 859 1757
MASS1. . . . . . .  X ADDR   0084H   A      446# 827 848 862
MASS2. . . . . . .  X ADDR   0088H   A      447# 845 864
MASS3. . . . . . .  X ADDR   008CH   A      448# 842 866
MASS4. . . . . . .  X ADDR   0090H   A      449# 839 868
MASS5. . . . . . .  X ADDR   0094H   A      450# 836 870
MASS6. . . . . . .  X ADDR   0098H   A      451# 834 872
MASS7. . . . . . .  X ADDR   009CH   A      452# 832 874
MASS8. . . . . . .  X ADDR   00A0H   A      453# 830 876
MASS9. . . . . . .  X ADDR   00A4H   A      454# 878
MASX5. . . . . . .  C ADDR   03F1H   R   SEG=MAIN   887 902#
MEAVP. . . . . . .  C ADDR   0DB0H   R   SEG=MAIN   2503 2506#
MECLE. . . . . . .  C ADDR   016FH   R   SEG=MAIN   530# 532
MEFF . . . . . . .  C ADDR   0176H   R   SEG=MAIN   534# 537
MEM12NO. . . . . .  C ADDR   0FC0H   R   SEG=MAIN   2802 2806#
MIDL . . . . . . .  C ADDR   1642H   R   SEG=MAIN   3893 3928#
MIGN . . . . . . .  C ADDR   131DH   R   SEG=MAIN   1634 3197#
MIGNN. . . . . . .  C ADDR   1325H   R   SEG=MAIN   3199 3204#
MLABL2 . . . . . .  C ADDR   0FF6H   R   SEG=MAIN   2833# 2837
MMM. . . . . . . .  C ADDR   0241H   R   SEG=MAIN   658#
MO220. . . . . . .  C ADDR   0558H   R   SEG=MAIN   1077 1118#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   0BEBH   R   SEG=MAIN   2281# 2290 2299 2307
MOVE28 . . . . . .  C ADDR   0967H   R   SEG=MAIN   1539 1577 1884#
MOVE82 . . . . . .  C ADDR   14B1H   R   SEG=MAIN   3505#
MOVEA3 . . . . . .  C ADDR   05C4H   R   SEG=MAIN   1170 1195#
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    92

MOVLEFT. . . . . .  D ADDR   003AH   A      358# 2354 2379 2826 2860 2868 2897 3244
MOVRIG . . . . . .  D ADDR   003BH   A      357# 2347 2351 2375 2825 2859 2872 2896 3253
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      4804# 4847
MUP11. . . . . . .  C ADDR   0257H   A      4851# 4896
MUP2 . . . . . . .  C ADDR   0297H   A      4881 4895#
MUP3 . . . . . . .  C ADDR   026CH   A      4850 4866#
MVV11. . . . . . .  C ADDR   0FDAH   R   SEG=MAIN   2813 2819#
MVV12. . . . . . .  C ADDR   0FF2H   R   SEG=MAIN   2819 2828#
N12DELCH . . . . .  C ADDR   080FH   R   SEG=MAIN   1601 1608#
N4DELCH. . . . . .  C ADDR   07B8H   R   SEG=MAIN   1519 1557#
N8DELCH. . . . . .  C ADDR   0800H   R   SEG=MAIN   1557 1601#
NBIMENU. . . . . .  C ADDR   0BF1H   R   SEG=MAIN   2264 2284#
NBLOK. . . . . . .  D ADDR   00C4H   A      439# 2852
NE05 . . . . . . .  C ADDR   0358H   A      5033 5035 5037 5040#
NEXIN. . . . . . .  C ADDR   0835H   R   SEG=MAIN   1637# 1644
NMINUS . . . . . .  C ADDR   04A3H   R   SEG=MAIN   1012 1015#
NNDELCH. . . . . .  C ADDR   0778H   R   SEG=MAIN   1511 1519#
NNMEMB . . . . . .  C ADDR   0CD2H   R   SEG=MAIN   2283 2389#
NNNUL. . . . . . .  C ADDR   063DH   R   SEG=MAIN   1273 1276#
NO . . . . . . . .  C ADDR   162AH   R   SEG=MAIN   3903 3907 3911 3915#
NO0KEY . . . . . .  C ADDR   0253H   R   SEG=MAIN   667 672#
NO11V6 . . . . . .  C ADDR   0B6DH   R   SEG=MAIN   2201 2214#
NO12V6 . . . . . .  C ADDR   0B7AH   R   SEG=MAIN   2214 2220#
NO13V6 . . . . . .  C ADDR   0B87H   R   SEG=MAIN   2220 2227#
NO21P7 . . . . . .  C ADDR   1117H   R   SEG=MAIN   2956 2975#
NO2PARN. . . . . .  C ADDR   05B0H   R   SEG=MAIN   1172 1178#
NO31N. . . . . . .  C ADDR   1050H   R   SEG=MAIN   2865 2878#
NO3PARN. . . . . .  C ADDR   05A6H   R   SEG=MAIN   1172# 1254
NO4DEL . . . . . .  C ADDR   0755H   R   SEG=MAIN   1462 1493#
NOAVK. . . . . . .  C ADDR   047DH   R   SEG=MAIN   949 951 989#
NOAVP. . . . . . .  C ADDR   04E9H   R   SEG=MAIN   1050# 1087 1090
NOBAVP . . . . . .  C ADDR   065AH   R   SEG=MAIN   1288 1292#
NOBEF99. . . . . .  C ADDR   02EFH   R   SEG=MAIN   757 772# 790
NOBIT. . . . . . .  C ADDR   0245H   A      4819 4833#
NOBITIZM . . . . .  C ADDR   0660H   R   SEG=MAIN   1292 1295#
NOBUF0 . . . . . .  C ADDR   0717H   R   SEG=MAIN   1396 1427#
NOCHI0 . . . . . .  C ADDR   0587H   R   SEG=MAIN   1078 1144#
NOCHN2 . . . . . .  C ADDR   03E9H   R   SEG=MAIN   893 898#
NODI2. . . . . . .  C ADDR   056DH   R   SEG=MAIN   1121 1128#
NODI6. . . . . . .  C ADDR   0DBEH   R   SEG=MAIN   2511 2515#
NODI8. . . . . . .  C ADDR   0614H   R   SEG=MAIN   1239 1245#
NODI9. . . . . . .  C ADDR   0572H   R   SEG=MAIN   1130 1133#
NODIS9 . . . . . .  C ADDR   0623H   R   SEG=MAIN   1245 1256#
NOEQU1 . . . . . .  C ADDR   0CC0H   R   SEG=MAIN   2378 2382#
NOEQU2 . . . . . .  C ADDR   104AH   R   SEG=MAIN   2871 2875#
NOFIZM . . . . . .  C ADDR   0B4EH   R   SEG=MAIN   2177 2199#
NOFT1. . . . . . .  C ADDR   0B3DH   R   SEG=MAIN   2182 2186#
NOFZ . . . . . . .  C ADDR   0712H   R   SEG=MAIN   1419 1422#
NOH37. . . . . . .  C ADDR   0E41H   R   SEG=MAIN   2568 2584# 2593 2599 2612
NOHNOT1. . . . . .  C ADDR   0EF7H   R   SEG=MAIN   2648 2686#
NOHNOT2. . . . . .  C ADDR   0EEFH   R   SEG=MAIN   2680# 2686
NOKORR . . . . . .  C ADDR   041BH   R   SEG=MAIN   935 940#
NOLAH. . . . . . .  C ADDR   0E11H   R   SEG=MAIN   2539 2556#
NOLEV1 . . . . . .  C ADDR   0C76H   R   SEG=MAIN   2328 2342#
NOM31. . . . . . .  C ADDR   1033H   R   SEG=MAIN   2835 2863#
NOM32. . . . . . .  C ADDR   1082H   R   SEG=MAIN   2863 2901#
NOM33. . . . . . .  C ADDR   10ADH   R   SEG=MAIN   2901 2919#
NOMARL . . . . . .  C ADDR   10E2H   R   SEG=MAIN   2942 2946#
NOME11 . . . . . .  C ADDR   0FB1H   R   SEG=MAIN   2799#
NOMEM11. . . . . .  C ADDR   0C0CH   R   SEG=MAIN   2286 2296#
NOMEM12. . . . . .  C ADDR   0C22H   R   SEG=MAIN   2296 2304#
NOMEMK . . . . . .  C ADDR   0FAEH   R   SEG=MAIN   2706 2796#
NON1C. . . . . . .  C ADDR   0B19H   R   SEG=MAIN   2156 2160#
NONULAVT . . . . .  C ADDR   0465H   R   SEG=MAIN   944 976#
NONULDEL . . . . .  C ADDR   073CH   R   SEG=MAIN   1446 1462#
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    93

NOP3_0 . . . . . .  C ADDR   058BH   R   SEG=MAIN   1150#
NOPART1. . . . . .  C ADDR   02F3H   R   SEG=MAIN   746 779#
NOPART2. . . . . .  C ADDR   0313H   R   SEG=MAIN   779 797#
NOPART3. . . . . .  C ADDR   0318H   R   SEG=MAIN   797 800#
NOPART4. . . . . .  C ADDR   032BH   R   SEG=MAIN   800 809#
NOPOIN7. . . . . .  C ADDR   10E9H   R   SEG=MAIN   2940 2951#
NOPOINT. . . . . .  C ADDR   10D0H   R   SEG=MAIN   2935 2938#
NOR11. . . . . . .  C ADDR   0BB7H   R   SEG=MAIN   2208 2254#
NOR13. . . . . . .  C ADDR   0B60H   R   SEG=MAIN   2208#
NORDN. . . . . . .  C ADDR   00F6H   A      4540# 4573
NORDN1 . . . . . .  C ADDR   0107H   A      4542 4556#
NORIG2 . . . . . .  C ADDR   0CA6H   R   SEG=MAIN   2361 2368#
NORIM6 . . . . . .  C ADDR   0CD2H   R   SEG=MAIN   2274 2390#
NORM1. . . . . . .  C ADDR   00F0H   A      4535# 4732 4909 5011 5228
NORR11 . . . . . .  C ADDR   0E51H   R   SEG=MAIN   2591#
NORR12 . . . . . .  C ADDR   0E5EH   R   SEG=MAIN   2591 2597# 2610
NORUP. . . . . . .  C ADDR   0119H   A      4539 4576#
NORUP1 . . . . . .  C ADDR   011EH   A      4581# 4599
NORUP2 . . . . . .  C ADDR   0132H   A      4583 4600#
NORVICH. . . . . .  C ADDR   0672H   R   SEG=MAIN   1253 1303#
NOSUB. . . . . . .  C ADDR   1665H   R   SEG=MAIN   3937 3941 3945 3950#
NOT1IN . . . . . .  C ADDR   071AH   R   SEG=MAIN   1400 1431#
NOT1_7 . . . . . .  C ADDR   0D85H   R   SEG=MAIN   2478 2485#
NOT2IN . . . . . .  C ADDR   0722H   R   SEG=MAIN   1431 1435#
NOT2_7 . . . . . .  C ADDR   0D90H   R   SEG=MAIN   2485 2490#
NOT3IN . . . . . .  C ADDR   072AH   R   SEG=MAIN   1435 1438#
NOTAKT . . . . . .  C ADDR   066AH   R   SEG=MAIN   1296 1300#
NOTT1. . . . . . .  C ADDR   06FDH   R   SEG=MAIN   1406 1410#
NOTT5. . . . . . .  C ADDR   0702H   R   SEG=MAIN   1410 1414#
NOT_1. . . . . . .  C ADDR   0B23H   R   SEG=MAIN   2160 2161 2172#
NOT_10 . . . . . .  C ADDR   0B23H   R   SEG=MAIN   2171#
NOVIR. . . . . . .  C ADDR   0BC4H   R   SEG=MAIN   2199 2264#
NOZZMI . . . . . .  C ADDR   0604H   R   SEG=MAIN   1234 1236#
NSEC01 . . . . . .  C ADDR   0646H   R   SEG=MAIN   1277 1280#
NSEC1. . . . . . .  C ADDR   064DH   R   SEG=MAIN   1280 1283#
NSEC10 . . . . . .  C ADDR   0652H   R   SEG=MAIN   1279 1282 1283 1287#
NULAVT . . . . . .  C ADDR   0767H   R   SEG=MAIN   1509#
NUMSIZE. . . . . .  N NUMB   0004H   A      3518# 3540 3578 3585 3660 3680
OBOARD . . . . . .  C ADDR   159BH   R   SEG=MAIN   3761 3775#
OBOARD1. . . . . .  C ADDR   15E3H   R   SEG=MAIN   3834 3847#
OK1. . . . . . . .  C ADDR   0186H   A      4666 4681#
OK2. . . . . . . .  C ADDR   01A0H   A      4683 4698#
OK3. . . . . . . .  C ADDR   01C4H   A      4715 4731#
ONBOAR1. . . . . .  C ADDR   15C1H   R   SEG=MAIN   3796 3813#
ONBOARD. . . . . .  C ADDR   1575H   R   SEG=MAIN   3725 3739#
ONMEM11. . . . . .  C ADDR   0F10H   R   SEG=MAIN   2501 2505 2507 2700#
ONMIG. . . . . . .  C ADDR   1333H   R   SEG=MAIN   3208 3216#
ONVICH . . . . . .  C ADDR   0A84H   R   SEG=MAIN   2050 2062#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 510
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 503 507
OUT6 . . . . . . .  C ADDR   0CD2H   R   SEG=MAIN   1959 2120 2125 2130 2147 2184 2189 2196 2263 2272 2279 2391#
OUT7 . . . . . . .  C ADDR   1137H   R   SEG=MAIN   2409 2410 2482 2489 2493 2544 2549 2948 2953 2993#
OUTF . . . . . . .  C ADDR   0B44H   R   SEG=MAIN   2180 2192# 2205 2212 2218 2224 2234 2239 2245 2248 2252 2281 2294
                                           2303 2311 2322 2326 2336 2340 2353 2356 2381 2383 2386
OUTMA. . . . . . .  C ADDR   0B9EH   R   SEG=MAIN   2238 2239#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 3717
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 1637 1641
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 481
P1 . . . . . . . .  D ADDR   0090H   A      32# 630 631 1650 1652 1655 1658 1662 1664 1665 1914 1917 1919 1922 1928
                                           1930 1932 3154 3161
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 482
P2 . . . . . . . .  D ADDR   00A0H   A      47# 1683 1687 1696
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 483
P3 . . . . . . . .  D ADDR   00B0H   A      62# 492 1682 1684 1686 1692 1693 1694 1697 1698 1987 1989 1991 1992 1995
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    94

                                           1996 1998 1999 2001 2002 2004 2005 2007 2008 2010 2011 2178 2179 2227 2228
                                           2241 2242 2246 2247 2265 2266 2288 2289 2297 2298 2305 2306 2315 2316 2329
                                           2330 2343 2344 2364 2365 2372 2373 2384 2385 2405 2437 2439 2441 2442 2445
                                           2446 2448 2449 2451 2452 2454 2455 2457 2458 2460 2461 2540 2542 2567 2568
                                           2584 2585 2592 2593 2598 2599 2611 2612 2646 2647 2732 2733 2760 2761 2774
                                           2775 2776 2777 2783 2784 2799 2800 2810 2811 2836 2837 2838 2839 2864 2865
                                           2878 2879 2902 2903 2904 2905 2920 2921 2922 2923 2933 2934 2938 2939 2951
                                           2952 3007
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2402 2404 3004 3006
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 485
P4 . . . . . . . .  D ADDR   0084H   A      20# 2074 2076 3018 3021 3037 3039
P5 . . . . . . . .  D ADDR   0085H   A      21# 554 562 1512 1515 1550 1552 1588 1590 1594 1596 2084 2086 3026 3029
                                           3057 3060
P6 . . . . . . . .  D ADDR   0086H   A      22# 632 634 638 640
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 486
PACK1. . . . . . .  C ADDR   00DEH   A      4518# 4733 4910 5012 5229
PARN . . . . . . .  D ADDR   00AFH   A      430# 559 1266 2103 2151 2466 2670
PART . . . . . . .  D ADDR   009AH   A      420# 555 744 922 954 976 989 1276 1304 1404 1415 2114 2152 2476 2656 2669
                                           3030 3179
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 479
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 480
PCON . . . . . . .  D ADDR   0087H   A      23#
PROD . . . . . . .  N NUMB   000CH   A      4455# 4799 4800 4801 4802 4822 4823 4824 4826 4827 4829 4830 4832 4854
                                           4856 4857 4859 4860 4862 4863 4865 4884 4885 4886 4888 4889 4891 4892 4894
                                           4905 4906 4907 4908 4929 4930 4931 4932 4948 4950 4951 4953 4954 4956 4957
                                           4959 4989 5006 5007 5008 5009
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 5260 5264 5317 5320
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 1823 1825 1967 2399 2417 3002 4190
                                           4198
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0A38H   R   SEG=MAIN   2009 2015#
R10. . . . . . . .  N NUMB   000AH   A      466# 663 940 945 3295 5283
R11. . . . . . . .  N NUMB   000BH   A      467# 664 941 946 3299 5287
R8 . . . . . . . .  N NUMB   0008H   A      464# 1948 3287 5275
R9 . . . . . . . .  N NUMB   0009H   A      465# 1949 3291 5279
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RE1. . . . . . . .  C ADDR   099CH   R   SEG=MAIN   1928# 1934
RE4BYTE. . . . . .  C ADDR   0454H   A      5271#
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    95

REACP. . . . . . .  D ADDR   0077H   A      353# 645 647 649 651 691 707 715 723 732 739 748 781 801 810 1524 1526
                                           1528 1530 1562 1564 1566 1568
READ . . . . . . .  C ADDR   099AH   R   SEG=MAIN   644 646 648 1927#
READYACP . . . . .  C ADDR   02B7H   R   SEG=MAIN   733 743#
READ_X2. . . . . .  C ADDR   0889H   R   SEG=MAIN   1691# 1702
REBYTE . . . . . .  C ADDR   020CH   R   SEG=MAIN   629# 674 773 1491 1500 1517 1555 1599 1607 1609
REBYTE2. . . . . .  C ADDR   046CH   A      5291#
REF0CN . . . . . .  D ADDR   00D1H   A      92# 487
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RESAR2 . . . . . .  C ADDR   0973H   R   SEG=MAIN   749 782 802 811 823 857 961 1003 1034 1053 1107 1158 1206 1210
                                           1465 1892# 2527
RESAR8 . . . . . .  C ADDR   0931H   R   SEG=MAIN   970 1006 1015 1058 1109 1112 1537 1575 1831#
REZAM. . . . . . .  D ADDR   008CH   A      416# 1572
REZAP. . . . . . .  D ADDR   0088H   A      415# 1534
REZMUL . . . . . .  C ADDR   048BH   R   SEG=MAIN   984 994 1001#
REZ_A. . . . . . .  D ADDR   0062H   A      405# 762 803 812 822 856 1464
REZ_A0 . . . . . .  D ADDR   006AH   A      407# 969 1057 1101 1139 2045 2519 2528 2535
REZ_A1 . . . . . .  D ADDR   0066H   A      406# 916 967 1002 1041 1052 1108
REZ_A2 . . . . . .  D ADDR   007BH   A      408# 1054 1114
REZ_A3 . . . . . .  D ADDR   009CH   A      422# 972 1060 1157 1205 1209 1309 2526
REZ_AME. . . . . .  D ADDR   005EH   A      404# 927 960 1019 1033
RGOTO7 . . . . . .  C ADDR   1030H   R   SEG=MAIN   2861# 2879 2905
RHNOT1 . . . . . .  C ADDR   0E08H   R   SEG=MAIN   2542 2551#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RIGBLO . . . . . .  C ADDR   0C79H   R   SEG=MAIN   2343# 2360 2362
RIGBLOK. . . . . .  C ADDR   0CACH   R   SEG=MAIN   2372#
RIGHT2 . . . . . .  C ADDR   0A4CH   R   SEG=MAIN   2022 2026#
RIGHT3 . . . . . .  C ADDR   0A50H   R   SEG=MAIN   2024 2029#
RIMEN6 . . . . . .  C ADDR   0BE0H   R   SEG=MAIN   2268 2276#
RIZMAN . . . . . .  C ADDR   09CBH   R   SEG=MAIN   1963# 1997
RKNLEFT. . . . . .  C ADDR   0D02H   R   SEG=MAIN   2413# 2453
RKNMEM . . . . . .  C ADDR   0CF3H   R   SEG=MAIN   2408# 2459
RKNNUL . . . . . .  C ADDR   0CFFH   R   SEG=MAIN   2412# 2447
RKNOPT . . . . . .  C ADDR   09C8H   R   SEG=MAIN   1962# 2006
RKNRAZR. . . . . .  C ADDR   09C5H   R   SEG=MAIN   1961# 2000
RKVVOD0. . . . . .  C ADDR   0F3BH   R   SEG=MAIN   2734 2741#
RLABELF. . . . . .  C ADDR   09C2H   R   SEG=MAIN   1960# 1994
RLABELH. . . . . .  C ADDR   0CFCH   R   SEG=MAIN   2411# 2444
RLABELI. . . . . .  C ADDR   0E0EH   R   SEG=MAIN   2554# 2597
RLABELK. . . . . .  C ADDR   0E0BH   R   SEG=MAIN   2553# 2556
RLABELL1 . . . . .  C ADDR   0CCFH   R   SEG=MAIN   2385 2388#
RLABL2 . . . . . .  C ADDR   0F7DH   R   SEG=MAIN   2771# 2775
RLER . . . . . . .  C ADDR   1357H   R   SEG=MAIN   3245 3247#
RMO220 . . . . . .  C ADDR   050BH   R   SEG=MAIN   1077#
RNNMEMB. . . . . .  C ADDR   0BEEH   R   SEG=MAIN   2283# 2284
RNO3PARN . . . . .  C ADDR   0621H   R   SEG=MAIN   1254# 1267
RNOCHI0. . . . . .  C ADDR   050DH   R   SEG=MAIN   1065 1078#
RNOMEMK. . . . . .  C ADDR   0F1AH   R   SEG=MAIN   2706# 2729
RNORIM6. . . . . .  C ADDR   0BDDH   R   SEG=MAIN   2266 2274#
RNORVICH . . . . .  C ADDR   061FH   R   SEG=MAIN   1200 1201 1253#
RNOT1IN. . . . . .  C ADDR   06F0H   R   SEG=MAIN   1306 1400#
ROUT6. . . . . . .  C ADDR   09BFH   R   SEG=MAIN   1959# 1988 1993
ROUT7. . . . . . .  C ADDR   0CF9H   R   SEG=MAIN   2410# 2438 2443
ROUTF. . . . . . .  C ADDR   0E4EH   R   SEG=MAIN   2585 2589# 2647
RR0. . . . . . . .  N NUMB   0000H   A      457# 1968 2398 2418 3001
RR1. . . . . . . .  N NUMB   0001H   A      458# 1969 2397 2419 3000
RR2. . . . . . . .  N NUMB   0002H   A      460# 1618 1970 2396 2420 2999
RR3. . . . . . . .  N NUMB   0003H   A      461# 1619 1971 2395 2421 2998
RR4. . . . . . . .  N NUMB   0004H   A      1972 2394 2422 2997 3519# 3576 3597 3613 3657 3679
RR5. . . . . . . .  N NUMB   0005H   A      1973 2393 2423 2996 3520# 3577 3584 3591 3658 3667
RR6. . . . . . . .  N NUMB   0006H   A      459# 1974 2392 2424 2995
RR7. . . . . . . .  N NUMB   0007H   A      462# 1975 2391 2425 2994
RRIR . . . . . . .  C ADDR   1364H   R   SEG=MAIN   3256 3258#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   05B9H   R   SEG=MAIN   1184# 1202
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    96

RSTSRC . . . . . .  D ADDR   00EFH   A      121# 517
RTIZMRI. . . . . .  C ADDR   0B27H   R   SEG=MAIN   2175#
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SAVBA. . . . . . .  D ADDR   003CH   A      356# 1985 2435 3209 3216
SAVEIR2. . . . . .  C ADDR   08B5H   R   SEG=MAIN   825 860 1730#
SAVELTE. . . . . .  C ADDR   04A7H   A      5354#
SAVER2 . . . . . .  C ADDR   08C1H   R   SEG=MAIN   571 573 575 753 763 786 804 813 917 928 968 973 1020 1042 1055
                                           1061 1115 1214 1477 1535 1547 1573 1585 1744# 2529 2536 2967 2984
SBUF0. . . . . . .  D ADDR   0099H   A      40#
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   084BH   R   SEG=MAIN   1650# 1657
SDV1 . . . . . . .  C ADDR   085FH   R   SEG=MAIN   1662# 1668
SDVIG0 . . . . . .  C ADDR   0298H   R   SEG=MAIN   719# 721
SDVIG1 . . . . . .  C ADDR   028DH   R   SEG=MAIN   711# 713
SDVIG2 . . . . . .  C ADDR   0282H   R   SEG=MAIN   703# 705
SDVIG3 . . . . . .  C ADDR   0276H   R   SEG=MAIN   694# 696
SDVIG4 . . . . . .  C ADDR   02A7H   R   SEG=MAIN   729# 731
SDVIG6 . . . . . .  C ADDR   02B1H   R   SEG=MAIN   736# 738
SDVM . . . . . . .  C ADDR   02AFH   R   SEG=MAIN   726 735#
SEEGOON. . . . . .  C ADDR   0626H   R   SEG=MAIN   1244 1251 1258#
SEEIND . . . . . .  C ADDR   0634H   R   SEG=MAIN   1176 1183 1184 1270#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      4450# 4471 4472 4497 4498 4522 4665 4682 4903 4943
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   0EAAH   R   SEG=MAIN   2642# 2657
SP . . . . . . . .  D ADDR   0081H   A      17# 478
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 523
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 522
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 1639
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SS1. . . . . . . .  C ADDR   13DAH   R   SEG=MAIN   3349# 3351
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      434# 750 752 765 783 785 1099 1137 2043 2517
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   1300H   R   SEG=MAIN   3171# 3180
TABUS. . . . . . .  C ADDR   1198H   R   SEG=MAIN   3015 3066#
TAKTIND. . . . . .  C ADDR   066FH   R   SEG=MAIN   1299 1302#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 514 515
TEAEQU0. . . . . .  C ADDR   1215H   R   SEG=MAIN   2623 3118#
TEBBL. . . . . . .  C ADDR   12ABH   R   SEG=MAIN   2855 3135#
TEBEQU0. . . . . .  C ADDR   121FH   R   SEG=MAIN   2970 3119#
TEBL . . . . . . .  C ADDR   12A1H   R   SEG=MAIN   2764 3134#
TEBLOK . . . . . .  C ADDR   1297H   R   SEG=MAIN   2821 3133#
TECLE. . . . . . .  C ADDR   1266H   R   SEG=MAIN   2309 2695 2746 3128#
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    97

TEEBL. . . . . . .  C ADDR   12B5H   R   SEG=MAIN   2892 3136#
TEFULL . . . . . .  C ADDR   128DH   R   SEG=MAIN   2815 3132#
TEIZMK . . . . . .  C ADDR   1248H   R   SEG=MAIN   2203 2210 2580 3125#
TEKALIB. . . . . .  C ADDR   123DH   R   SEG=MAIN   2269 3124#
TELIST . . . . . .  C ADDR   1282H   R   SEG=MAIN   2301 2737 3131#
TEMEM. . . . . . .  C ADDR   1270H   R   SEG=MAIN   3129#
TEMENU . . . . . .  C ADDR   1229H   R   SEG=MAIN   2498 3120#
TENMIN . . . . . .  C ADDR   143FH   R   SEG=MAIN   981 983 3393#
TEOLL. . . . . . .  C ADDR   125CH   R   SEG=MAIN   1123 3127#
TEOUT. . . . . . .  C ADDR   1252H   R   SEG=MAIN   2216 2256 2571 3126#
TETEST . . . . . .  C ADDR   1233H   R   SEG=MAIN   2276 3122#
TEVICH . . . . . .  C ADDR   120BH   R   SEG=MAIN   2057 2222 2576 3117#
TEWR . . . . . . .  C ADDR   1278H   R   SEG=MAIN   2292 2750 3130#
TEXTT. . . . . . .  C ADDR   11CFH   R   SEG=MAIN   3087 3108#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 497
TH1. . . . . . . .  D ADDR   008DH   A      29#
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   086FH   R   SEG=MAIN   1671#
TIM1 . . . . . . .  C ADDR   0871H   R   SEG=MAIN   1672# 1672
TIM2 . . . . . . .  C ADDR   0874H   R   SEG=MAIN   1653 1656 1663 1667 1675# 1918 1920 1929 1933
TIM3 . . . . . . .  C ADDR   0876H   R   SEG=MAIN   1676# 1676
TIZMRI . . . . . .  C ADDR   0A45H   R   SEG=MAIN   2021# 2175
TL0. . . . . . . .  D ADDR   008AH   A      26# 498
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   0EA7H   R   SEG=MAIN   2627 2639#
TMOD . . . . . . .  D ADDR   0089H   A      25# 495
TMR2RLH. . . . . .  D ADDR   00CBH   A      323# 512
TMR2RLL. . . . . .  D ADDR   00CAH   A      322# 511
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 1640
UNPACK1. . . . . .  C ADDR   009EH   A      4468# 4662 4796 4926 5040
UNPACK2. . . . . .  C ADDR   00BAH   A      4493# 4663 4797 4927
UP1. . . . . . . .  C ADDR   0138H   A      4613# 4630
UP2. . . . . . . .  C ADDR   014BH   A      4633# 4651
UP2A . . . . . . .  C ADDR   0161H   A      4612 4649#
UPA. . . . . . . .  C ADDR   146EH   R   SEG=MAIN   3446# 3452
UPA1 . . . . . . .  C ADDR   147EH   R   SEG=MAIN   3464# 3470
UPA2 . . . . . . .  C ADDR   145EH   R   SEG=MAIN   3429# 3435
UPAK . . . . . . .  C ADDR   1468H   R   SEG=MAIN   2960 2977 3443#
UPAK2. . . . . . .  C ADDR   1458H   R   SEG=MAIN   2846 3426#
UPAK3. . . . . . .  C ADDR   1478H   R   SEG=MAIN   2885 2911 3461#
VICHR. . . . . . .  D ADDR   00B1H   A      432# 2054 2063 2200 2565 2616 2954 2988
VIG0 . . . . . . .  C ADDR   06B7H   R   SEG=MAIN   1360# 1362
VIG4 . . . . . . .  C ADDR   06C5H   R   SEG=MAIN   1371# 1373
VIOUT. . . . . . .  C ADDR   0AFEH   R   SEG=MAIN   2060 2143#
VVCHIF . . . . . .  C ADDR   133BH   R   SEG=MAIN   2250 3224#
VVIZKO . . . . . .  C ADDR   0E83H   R   SEG=MAIN   2586 2616#
VVRR6. . . . . . .  C ADDR   0B58H   R   SEG=MAIN   2203#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 493 494
WORK . . . . . . .  D ADDR   00B8H   A      436# 1311 1386
WR1. . . . . . . .  C ADDR   0987H   R   SEG=MAIN   1914# 1921
A51 MACRO ASSEMBLER  AMP1_K4                                                              12/21/2006 10:37:54 PAGE    98

WRITE. . . . . . .  C ADDR   0984H   R   SEG=MAIN   642 1912# 3143 3145 3147 3149 3151 3153 3156 3158 3160 3163 3165
                                           3167
WRITED_X1. . . . .  C ADDR   087AH   R   SEG=MAIN   1681#
WRITE_X1 . . . . .  C ADDR   0879H   R   SEG=MAIN   1680#
WRPAGE . . . . . .  C ADDR   0480H   A      5315#
WW5. . . . . . . .  C ADDR   0483H   A      5316# 5324
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 489 521
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 490
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 491 520
XCIKLWR. . . . . .  C ADDR   08A1H   R   SEG=MAIN   820 831 833 835 838 841 844 847 850 853 1713#
XTEMP. . . . . . .  N NUMB   000CH   A      3516# 3880 3881 3882 3883 3969 3971 3972 3974 3975 3977 3978 3980 4002
                                           4003 4004 4005 4023 4024 4028 4029 4032 4036 4037 4040 4044 4045 4049 4050
                                           4052 4053 4054 4056 4060 4061 4063 4064 4068 4069 4074 4075 4077 4078 4082
                                           4083 4088 4090 4091 4092
YBNUL. . . . . . .  C ADDR   0DE1H   R   SEG=MAIN   2524 2532#
YES. . . . . . . .  C ADDR   1648H   R   SEG=MAIN   3902 3906 3910 3914 3932# 3995
YESAVP . . . . . .  C ADDR   050FH   R   SEG=MAIN   1049 1081#
YESBUF . . . . . .  C ADDR   06F4H   R   SEG=MAIN   1398 1403#
YESPRD . . . . . .  C ADDR   06F2H   R   SEG=MAIN   1397 1401#
YESTT5 . . . . . .  C ADDR   0715H   R   SEG=MAIN   1418 1425#
YESVICH. . . . . .  C ADDR   053CH   R   SEG=MAIN   1050 1105#
YESVIR . . . . . .  C ADDR   0BBCH   R   SEG=MAIN   2261#
Z01S . . . . . . .  C ADDR   13F2H   R   SEG=MAIN   3366# 3368
Z100 . . . . . . .  C ADDR   13C3H   R   SEG=MAIN   3330# 3332
Z15. . . . . . . .  C ADDR   13D1H   R   SEG=MAIN   3342# 3344
Z1S. . . . . . . .  C ADDR   13E5H   R   SEG=MAIN   3358# 3360
ZAPADC . . . . . .  C ADDR   0849H   R   SEG=MAIN   1649#
ZCMP . . . . . . .  C ADDR   0923H   R   SEG=MAIN   1821#
ZDIV . . . . . . .  C ADDR   08F0H   R   SEG=MAIN   761 909 1161 1784#
ZER1 . . . . . . .  C ADDR   00B3H   A      4478 4482# 4537 4580
ZER2 . . . . . . .  C ADDR   00D4H   A      4504 4508#
ZMUL . . . . . . .  C ADDR   08E6H   R   SEG=MAIN   1779#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      365# 1234 1792 1795 1798
ZNPLUS . . . . . .  C ADDR   0269H   R   SEG=MAIN   653 683#
ZZ . . . . . . . .  C ADDR   13D3H   R   SEG=MAIN   3343# 3343
Z_01S. . . . . . .  C ADDR   13EEH   R   SEG=MAIN   678 679 680 1420 1978 2428 3220 3364#
Z_100. . . . . . .  C ADDR   13C1H   R   SEG=MAIN   3329#
Z_15 . . . . . . .  C ADDR   13CFH   R   SEG=MAIN   621 3341#
Z_1MS. . . . . . .  C ADDR   13D8H   R   SEG=MAIN   3348#
Z_1S . . . . . . .  C ADDR   13E1H   R   SEG=MAIN   588 596 3356#
Z_5. . . . . . . .  C ADDR   13CAH   R   SEG=MAIN   1685 1695 3336#
Z_9. . . . . . . .  C ADDR   097FH   R   SEG=MAIN   1642 1906#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
