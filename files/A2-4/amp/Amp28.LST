A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     1


MACRO ASSEMBLER A51 V6.14a
OBJECT MODULE PLACED IN Amp28.OBJ
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp28.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236             
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                        jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti   
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;53h..5dh 10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
  0039               310     nuerr                           DATA    39h;номер ошибки (для интерфейса)       
  0038               311     nblok                           DATA    38h;номер введенного блока
  0037               312     nelem                           DATA    37h;номер лемента в блоке 0..200
                     313     ;;;;;
  0020               314      cellbit                DATA    20h
  0000               315     bitznak         BIT     cellbit.0       ;20.0           
  0001               316     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               317     znmat           BIT             cellbit.2       ;20.2
  0003               318     bitrs           BIT             cellbit.3       ;20.3
  0004               319     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               320     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     6

  0006               321     bitvi11         BIT             cellbit.6       ;20.6   бит нажатия ввод режима вычислить R
                             !!!
  0007               322     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us 
                                  
                     323     
  0021               324     cellbit1                DATA    21h
  0008               325     bitbuf          BIT     cellbit1.0      ;21.0   
  0009               326     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               327     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               328     bitmem          BIT             cellbit1.3      ;21.3 нажата кн память
  000C               329     bmem11          BIT             cellbit1.4      ;21.4    бит ПАМ11
                     330     ;bmem12         BIT             cellbit1.5      ;21.5    
                     331     ;bmem13         BIT             cellbit1.6      ;21.6            
  000F               332     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     333     
  0022               334     cellbit2                DATA    22h
  0010               335     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               336     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               337     bitklb          BIT             cellbit2.2      ;22.2  признак калибровки
  0013               338     bitv19          BIT             cellbit2.3      ;22.3           бит установки скор итерфейс
                             а 19.6
  0014               339     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               340     biteizm         BIT             cellbit2.5      ;22.5   признак теста измерения 
  0016               341     bitpar          BIT             cellbit2.6      ;22.6   бит проведенного 1раз пароля 
  0017               342     bitoll          BIT             cellbit2.7      ;22.7 бит перегрузки
                     343     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     344     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     345     ;и выдает т.н. буфер индикации  
  0023               346     cellbit3                DATA    23h
  0018               347     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               348     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               349     bitakt          BIT             cellbit3.2      ;22.2  бит такта
  001B               350     bitznB          BIT             cellbit3.3      ;22.3 БИТ ЗНАКА ПРИ ВВОДЕ константы В
                     351     ;bit            BIT             cellbit3.4      ;22.4    
                     352     ;bit            BIT             cellbit3.5      ;22.5    
                     353     ;bit            BIT             cellbit3.6      ;22.6            
                     354     ;bit            BIT             cellbit3.7      ;22.7
                     355             
  005E               356     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     357     ;hex
  0062               358     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               359     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               360     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               361     rez_A2   data 7bh; A2
                     362     
  0098               363     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               364     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               365     chdel    data  83h              ; счетчик задержки
                     366     ;float
  0084               367     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               368     rezAp    data  88h              ;4byte  A+
  008C               369     rezAm    data  8ch              ;4byte  A-
  0090               370     koefKp   data  90h              ;4byte  K+
  0094               371     koefKm   data  94h              ;4byte  K-
                     372     ;hex 
  009A               373     parT     data  9ah              ;параметр времени измерения
  009B               374     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               375     rez_A3   data  9ch              ;A3
                     376     ;FLOAT
  00A0               377     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               378     rez_Ak  data  0a4h         ;Ak
  00A8               379     parol           data  0a8h         ;храним в памяти пароль
  00AC               380     chind   data  0ach         ;счетчик индикации
                     381     ;chbuf  data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               382     diap    data  0aeh         ;номер диапазона
  00AF               383     parN    data  0afh         ;N  пар разрядности индикатора
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     7

  00B0               384     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               385     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               386     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               387     summa   data  0b3h         ;ячейка длясуммирования      rez_A
  00B7               388     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               389     work    data  0b8h        ;рабочая ячейка
  00BC               390     konstA  data  0bch        ;     введенная с крана константа A
  00C0               391     konstB  data  0c0h         ;    введенная с крана константа B
                     392     ;       data  0c4h         ;
  00C5               393     Rez_del data  0c5h      ;сумма n-значений /n
  00C9               394     rez_R           data    0c9h            ;рез вычисления R 4baita
  00CD               395     interva data  0cdh;значение интервала (запись)2baita
  00CF               396     chbuf   data  0cfh         ;счетчик периода загрузки в буфер и интерфейс
  00D3               397     saven_bl        data  0d3h;номер ячейки в блоке 2 baita
  00D5               398     volume          data    0d5h;объем блока
  00D6               399     chblok          data    0d6h;volume;кол измерений блока
  00D7               400     copy_hl         data  0d7h;копия адреса последней записанной ячейки блока saven_bl
                     401     ;data           0d9h
                     402     
                     403     ;внешнее ОЗУ 64K 
                     404     ;в обл внешнего озу 0..ffh читается страница рпзу и при записи в любую
                     405     ;ячейку  стирается целая страница 0..ffh рпзу
                     406     ;               XSEG AT 100h
                     407             PUBLIC    MASS0
  0100               408     MASS0  xdata 0100h;     скользящий массив измерения
  0104               409     MASS1  xdata 0104h;
  0108               410     MASS2  xdata 0108h;
  010C               411     MASS3  xdata 010ch;
  0110               412     MASS4  xdata 0110h;
  0114               413     MASS5  xdata 0114h;
  0118               414     MASS6  xdata 0118h;
  011C               415     MASS7  xdata 011ch;
  0120               416     MASS8  xdata 0120h;
  0124               417     MASS9  xdata 0124h;
  0128               418     MASS10  xdata 0128h;
  012C               419     MASS11  xdata 012ch;
  0130               420     MASS12  xdata 0130h;
  0134               421     MASS13  xdata 0134h;
  0138               422     MASS14  xdata 0138h;
  013C               423     MASS15  xdata 013ch;
  0140               424     MASS16  xdata 0140h;
  0144               425     MASS17  xdata 0144h;
  0148               426     MASS18  xdata 0148h;
  014C               427     MASS19  xdata 014ch;
                     428     ;xdata 
                     429     
  0000               430                             rr0             EQU 00
  0001               431                     rr1       equ   01
  0006               432                     rr6   equ 06
  0002               433                     rr2       equ   02
  0003               434                     rr3       equ   03
  0007               435                     rr7   equ 07
                     436     
  0008               437                     r8   equ 08
  0009               438                     r9        equ   09
  000A               439                     r10       equ   10
  000B               440                     r11   equ 11
                     441     
                     442                     
                     443        
----                 444                  rseg     Main          ; Switch to this code segment.
                     445     
                     446                  using    0              ; Specify register bank for the following
                     447     
0100                 448     org 100h
                     449     ;$EJECT
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     8

                     450     
0100 7581E0          451     begin:     mov  sp, #0e0h
0103 75E900          452                                             mov             PCA0L,#00;=0x00;
0106 75D900          453                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          454                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          455                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          456                                             mov     P2MDOUT,#00;=0x00;
                     457             
0112 75A73F          458             mov     P3MDOUT,#3fh;
0115 75B5FF          459             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          460             mov     REF0CN,#03h;=0x03;
                     461             
011B 75E114          462             mov     XBR0,#14h;= 0x14;
011E 75E200          463             mov     XBR1,#00; =0x00;
0121 75E300          464             mov XBR2,#00;=0x00;
0124 75B0C0          465             mov     P3,#0c0h
0127 75FFDE          466             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          467             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          468             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          469             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          470             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          471             mov     TL0,#0f9h;=0xf9; 
0139 75E680          472             mov     EIE1,#80h;=0x80;
                     473     
013C 75D480          474             mov     DAC0CN,#80h;=0x80;
013F 75D780          475             mov     DAC1CN,#80h;=0x80;
0142 75B167          476             mov     OSCXCN,#67h;=0x67;
                     477     
                     478      
                     479     
0145 E5B1            480     gener:     mov a, oscxcn
0147 B4E7FB          481                cjne a,#11100111b,gener
                     482                            
014A 75B288          483             mov     OSCICN,#88h;=0x84;
014D 75CA00          484         mov TMR2RLL,#0;=0;
0150 75CBD1          485         mov TMR2RLH,#0d1h;=0xd1;
                     486       
0153 D28E            487                     setb  TCON.6                    ;регистр управления
0155 D28C            488                      setb tcon.4
                     489     
0157 75EF00          490             mov     RSTSRC,#0;=00   ;//источники сброса 
                     491     
                     492             
015A 75E340          493          mov        XBR2,#40h
015D 75E106          494              mov    XBR0,#06h;16h
0160 75F803          495             mov             SPI0CN,#03
0163 759D31          496             mov             spi0ckr,#31H;;;;;;;;#04
                     497     ;установка скорости
0166 759850          498                                             mov             SCON0,#50h;01010000;скорость обмена
                              определяется таймером1
0169 758780          499                                             mov             PCON,#10000000b;удвоенная скорость 
                             передачи SMOD0=1
016C 758E10          500                                             mov             CKCON,#00010000b;TIM=1
016F 758920          501                                             mov             TMOD,#00100000b;реж2 внутр ист синх
                             р
0172 758840          502                                             mov             TCON,#01000000b;счетчик запущен
0175 7A50            503                                             mov                     r2,#50h                    
                                  ;57.6->19.2
0177 7B2C            504                                             mov                     r3,#2ch
0179 120454          505                                             call            re4byte                 ;502ch 1 ba
                             it skor
017C E508            506                                             mov                     a,r8
017E B40007          507                                             cjne            a,#00,yst19
0181 C213            508                                             clr                     bitv19                  ;57
                             .6
0183 758DF4          509                                             mov                     TH1,#244
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE     9

0186 8008            510                                             jmp               yst1
0188 900000   F      511     yst19:          mov                     dptr,#teS19_2
018B D213            512                                             setb            bitv19                  ;19,2
018D 758DDC          513                                             mov                     TH1,#220
0190                 514     yst1:
0190 75E730          515                                             mov             EIE2,#30H;00110000
0193 75A880          516                                             mov     IE,#80h;//10000000      ;//Снятие блокировк
                             и всех прерываний
                     517     ;ozu
0196 E4              518                                             clr     a
0197 7800            519                                             mov     r0,#00h 
0199 F6              520     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
019A 08              521                                             inc     r0
019B B87FFB          522                                             cjne    r0,#7fh,mecle
019E 7880            523                                             mov     r0,#80h
01A0 F6              524     meff:                   mov     @r0,a 
01A1 F2              525                                             movx @r0,a
01A2 08              526                                             inc     r0
01A3 B8DFFA          527                             cjne    r0,#0dfh,meff
01A6 120000   F      528                             call    clmassix
                     529     ;обнулить внешнее озу 4кбайта
01A9 900000          530                                     mov                     dptr,#0
01AC E4              531     extcle: clr                     a
01AD F0              532                                     movx            @dptr,a
01AE A3              533                                     inc                     dptr
01AF E583            534                                     mov                     a,dph
01B1 B410F8          535                                     cjne            a,#10h,extcle
                     536     
01B4 7898            537                             mov             r0,#chinkor
01B6 7600            538                             mov             @r0,#0;1;
01B8 08              539                             inc             r0
01B9 7664            540                             mov             @r0,#64h;0c8h;90h;
                     541                             ;;;;
01BB 7881            542                             mov             r0,#chavt
01BD 7601            543                             mov             @r0,#1
01BF 08              544                             inc             r0
01C0 7690            545                             mov             @r0,#90h
                     546     
01C2 78B2            547                                     mov             r0,#marker
01C4 76FF            548                                     mov             @r0,#0ffh
                     549                             ;mov            r0,#chind
                     550                             ;mov            @r0,#1
                     551                     
01C6 74FF            552                             mov             a,#0ffh
01C8 F585            553                        mov          p5,a
01CA 799A            554                             mov             r1,#parT
01CC 7702            555                             mov             @r1,#2                  ;Tizm=1s
01CE 79AE            556                             mov             r1,#diap
01D0 7705            557                             mov             @r1,#5                  ;10-7a
01D2 79AF            558                             mov             r1,#parN
01D4 7702            559                             mov             @r1,#2
01D6 7400            560                             mov             a,#00h
01D8 F585            561                             mov             p5,a
01DA D204            562                             setb    bitizm
                     563     
01DC 799B            564                             mov             r1,#chbefore
01DE 7700            565                             mov             @r1,#0
                     566                             ;;;;;;
01E0 900000   F      567                             mov             dptr,#ch_1              ;1->r2..r5 float
01E3 120000   F      568                             call    ldc_long
01E6 7890            569                             mov             r0,#koefKp         ;1(float)->koefKp
01E8 120000   F      570                             call    saver2
01EB 7894            571                             mov             r0,#koefKm              ;1(float)->koefKm
01ED 120000   F      572                             call    saver2
01F0 78A0            573                             mov             r0,#koefKD
01F2 120000   F      574                             call    saver2
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    10

01F5 78CF            575                             mov                     r0,#chbuf
01F7 120000   F      576                             call    saver2  
                     577     ;START
                     578     ;                                       rez_A0=0;
                     579     ;        SUMM=0; //обнуление скользящего массива
                     580     ;        over_mas=0;
                     581     ;        count_mas=0;
                     582     
01FA 7840            583                             mov             r0,#bufind
01FC                 584     age2:
01FC 76FD            585                             mov             @r0,#0fdh         ;погасить индикатор
01FE 08              586                             inc             r0
01FF B84CFA          587                             cjne    r0,#bufind+12,age2              
0202 120000   F      588                             call    ind
0205 120000   F      589                             call    z_1s
                     590     
                     591                                     ;зажечь все лементы индикации
0208 7840            592                             mov             r0,#bufind
020A 7669            593     ageon:          mov             @r0,#69h;0feh;?
020C 08              594                             inc             r0
020D B84CFA          595                             cjne    r0,#bufind+12,ageon             
0210 120000   F      596                             call    ind
0213 120000   F      597                             call    z_1s            ;1sec
                     598     ;;;;;;;;;;;;;;;;
                     599                     
0216 120000   F      600                             call    z_15;z_1ms
0219 434B10          601                             orl             bufind+11,#10h;бит точки после 1 знакоместа
                     602     ;;;;;;;;;;;;;;;;;;;
021C 7C60            603                             mov             r4,#60h
021E 7D00            604                             mov             r5,#00         
0220 120000   F      605                             call    iniacp;инициализация acp
0223 120000   F      606                             call    loadUS          ;us 10-7 A
                     607                             
0226 C217            608     rebyte:         clr             bitoll
0228 3095FD          609                             jnb             p1.5,$
022B 2095FD          610                             jb              p1.5,$
022E E586            611                             mov             a,P6            ;p6.4=0
0230 54EF            612                             anl             a,#0efh
0232 F586            613                             mov             P6,a
0234 00              614                             nop
0235 00              615                             nop
                     616                                     
0236 E586            617                             mov             a,P6                    ;p6.4=1 
0238 4410            618                             orl             a,#10h
023A F586            619                             mov             P6,a                        
023C 7411            620                             mov             a,#11h
023E 120000   F      621                             call    write
                     622                             ;чтение acp
0241 120000   F      623                             call    read    
0244 F578            624                             mov     reacp+1,A       ;старший байт 
0246 120000   F      625                             call    read    
0249 F579            626                             mov     reacp+2,A       ;средний байт 
024B 120000   F      627                             call    read
024E F57A            628                             mov     reacp+3,A               ;мл байт
                     629                        ;;;;;;;;;;;
0250 7878            630                        mov          r0,#reacp+1
0252 E6              631                        mov          a,@r0
0253 20E72D          632                             jb              acc.7,znplus;
0256 D200            633                             setb    bitznak
0258 4480            634                             orl             a,#80h  ;ост содерж яч 
025A F6              635                             mov             @r0,a
                     636                                     
025B 18              637     mmm:            dec             r0;,#reacp
025C 76FF            638                             mov             @r0,#0ffh
025E 802B            639                             jmp             goznak
                     640     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    11

                     641     
0260 750A00          642     labelA:         mov             r10,#0          
0263 750B00          643                             mov             r11,#0
0266 783D            644                             mov             r0,#chkl
0268 120000   F      645                             call    chcmp
026B 7000            646                             jnz             no0key
                     647                             ;разрешить ie6,ie7       
                     648                     ;       mov             EIE2,#30h ;EIE2.5,EIE2.4
                     649                     ;       mov             EIP2,#30h
                     650                        
026D 793D            651     no0key:         mov             r1,#chkl 
026F 120000   F      652                             call    chdec
0272 2004B1          653                             jb              bitizm,rebyte
                     654                              ;буфер 2 выдать на индикацию
                     655     
0275 120000   F      656                             call    ind
0278 120000   F      657                             call    z_01s
027B 120000   F      658                             call    z_01s
027E 120000   F      659                             call    z_01s
0281 80DD            660                             jmp             labelA
                     661     
0283 C200            662     znplus:         clr     bitznak
0285 547F            663                             anl             a,#7fh;fdh                      ;+
0287 F6              664                             mov             @r0,a
0288 18              665                             dec             r0;,#reacp
0289 7600            666                             mov             @r0,#00h
                     667                             
028B                 668     goznak: 
                     669     ;;;;;;;;;;;;;
028B 787A            670                             mov     r0,#reacp+3
028D E6              671                             mov             a,@r0
028E 7F05            672                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
0290 C3              673     sdvig3:         clr             c
0291 13              674                             rrc             a
0292 DFFC            675                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
0294 FA              676                             mov             r2,a    ;сохр байт
0295 18              677                             dec             r0              ;       reacp+2
0296 E6              678                             mov             a,@r0
0297 C0E0            679                             push    acc
0299 C3              680                             clr             c
029A 7F03            681                             mov             r7,#3;2
029C C3              682     sdvig2:         clr             c
029D 33              683                             rlc             a
029E DFFC            684                             djnz    r7,sdvig2 ;d12..d11      средний байт
02A0 4A              685                             orl             a,r2
02A1 F57A            686                             mov             reacp+3,a;сформ мл байт
02A3 D0E0            687                             pop             acc
                     688                             
02A5 7F05            689                             mov             r7,#5;6
02A7 C3              690     sdvig1:         clr             c
02A8 13              691                             rrc             a
02A9 DFFC            692                             djnz    r7,sdvig1 ;d15,d14        ср байт
02AB FA              693                             mov             r2,a   ;сохр
02AC E578            694                             mov             a,reacp+1
02AE C0E0            695                             push    acc
                     696                     ;;      push    acc
02B0 7F03            697                             mov             r7,#3;2
02B2 C3              698     sdvig0:         clr             c
02B3 33              699                             rlc             a
02B4 DFFC            700                             djnz    r7,sdvig0 ;       d21..d16
02B6 4A              701                             orl             a,r2
02B7 F579            702                             mov             reacp+2,a       ; сформ средний  байт
02B9 D0E0            703                             pop             acc       ;reacp+1
                     704                             ;;;;;;;;;;;;;;
02BB 20E70B          705                             jb              acc.7,sdvm
02BE C3              706                             clr             c
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    12

02BF 7F05            707                             mov             r7,#5;6
02C1 C3              708     sdvig4:         clr             c
02C2 13              709                             rrc             a
02C3 DFFC            710                             djnz    r7,sdvig4 ;       d23,d22
02C5 F578            711                             mov             reacp+1,a
02C7 8008            712                             jmp             readyacp;ankor;klmas
                     713     ;;;;;;;;;;;;                                    
02C9 7F05            714     sdvm:           mov             r7,#5;6
02CB D3              715     sdvig6:         setb            c
02CC 13              716                             rrc             a
02CD DFFC            717                             djnz    r7,sdvig6 ;       d23,d22
02CF F578            718                             mov             reacp+1,a
                     719                                                             
                     720     ; reacp..reacp+3-результат чтения асп(hex) 
                     721     ;;;;;;;;;
02D1                 722     readyacp:
02D1 7898            723                                             mov             r0,#chinkor
02D3 E6              724                             mov             a,@r0
02D4 30E702          725                             jnb             acc.7,gopart
02D7 8044            726                                     jmp             sumt2
                     727                     
02D9                 728     gopart:
02D9 789A            729                             mov             r0,#parT        ;параметр времени
02DB 793F            730                             mov             r1,#chmasN
02DD B6013A          731                             cjne    @r0,#1,noparT1
                     732                             ;РЕЗ+РЕЗ
02E0 7877            733                             mov             r0,#reacp
02E2 120000   F      734                             call    resar2          ;reacp->r2..r5
02E5 78B6            735                             mov             r0,#summa+3;rez_A+3
02E7 120000   F      736                             call    ladd
02EA 78B3            737                             mov             r0,#summa;rez_A
02EC 120000   F      738                             call    saver2
02EF 793F            739                              mov            r1,#chmasN
02F1 7714            740                             mov             @r1,#20;10
02F3 789B            741                             mov             r0,#chbefore
02F5 B6631E          742                             cjne    @r0,#99,nobef99
                     743                             ;РЕЗ/100
02F8 900000   F      744                             MOV        DPTR,#ch100 
02FB 120000   F      745     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
02FE 120000   F      746                             call    zdiv;divide
0301 7862            747                             mov             r0,#rez_A
0303 120000   F      748                             call    saver2          ;сумма 100 отсчетов /100
0306 78C5            749                             mov             r0,#Rez_del
0308 120000   F      750                             call    saver2  
                     751                        ;;;;;
030B 78B3            752                        mov          r0,#summa
030D 120000   F      753                        call         clear4
                     754     
0310 799B            755                             mov             r1,#chbefore
0312 7700            756                             mov             @r1,#0
0314 8070            757                             jmp             klmas           ;загр в массив скользящее ср
0316 06              758     nobef99:        inc             @r0                     ;chbefore
0317 020000   F      759                             jmp             rebyte;labelA;метка A
                     760     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     761     ;а потом уже располагаем  в скользящий массив  из n
                     762     
                     763     
                     764     
031A B6021D          765     noparT1:        cjne    @r0,#2,noparT2
                     766                             ;РЕЗ+РЕЗ
031D                 767     sumt2:
031D 7877            768                              mov            r0,#reacp
031F 120000   F      769                             call    resar2          ;reacp->r2..r5
0322 78B6            770                             mov             r0,#summa+3;rez_A+3
0324 120000   F      771                             call    ladd
0327 78B3            772                             mov             r0,#summa;rez_A
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    13

0329 120000   F      773                             call    saver2
032C 789B            774                             mov             r0,#chbefore
032E 793F            775                             mov             r1,#chmasN
0330 770A            776                             mov             @r1,#10
0332 B613E1          777                             cjne    @r0,#19,nobef99;9,nobef99
                     778                             ;РЕЗ/20
0335 900000   F      779                             MOV        DPTR,#ch20;ch10 
0338 80C1            780                             jmp             allsum
                     781                             ;;;;;;;
                     782                             
                     783     
033A B6031D          784     noparT2:        cjne    @r0,#3,noparT3
033D 7877            785                                                              mov            r0,#reacp
033F 120000   F      786                             call    resar2          ;reacp->r2..r5
0342 78B6            787                             mov             r0,#summa+3;rez_A+3
0344 120000   F      788                             call    ladd
0347 78B3            789                             mov             r0,#summa;rez_A
0349 120000   F      790                             call    saver2
034C 789B            791                             mov             r0,#chbefore
034E 793F            792                             mov             r1,#chmasN
0350 7704            793                             mov             @r1,#4                                  ;n=4
0352 B60AC1          794                             cjne    @r0,#10,nobef99;9,nobef99
                     795                             ;РЕЗ/10
0355 900000   F      796                             MOV        DPTR,#ch10 
0358 80A1            797                             jmp             allsum
                     798                             
035A B6041D          799     noparT3:        cjne    @r0,#4,noparT4
035D                 800     aapar:          
035D 7877            801              mov            r0,#reacp
035F 120000   F      802                             call    resar2          ;reacp->r2..r5
0362 78B6            803                             mov             r0,#summa+3;rez_A+3
0364 120000   F      804                             call    ladd
0367 78B3            805                             mov             r0,#summa;rez_A
0369 120000   F      806                             call    saver2
036C 789B            807                             mov             r0,#chbefore
036E 793F            808                             mov             r1,#chmasN
0370 7704            809                             mov             @r1,#4
0372 B605A1          810                             cjne    @r0,#5,nobef99;9,nobef99
                     811                             ;РЕЗ/10
0375 900000   F      812                             MOV        DPTR,#ch5
0378 8081            813                             jmp             allsum
                     814     
                     815                     
037A 7702            816     noparT4:   mov          @r1,#2          ;chmasN n=2
037C 7877            817                             mov             r0,#reacp
037E 120000   F      818                             call    resar2          ;reacp->r2..r5
0381 7862            819                             mov             r0,#rez_A
0383 120000   F      820                             call    saver2
                     821     ;загрузить А в массив из 2/10 значений
                     822     ;;;;;;;;;;;;;;;
0386                 823     klmas:           
0386 793F            824                             mov             r1,#chmasN
0388 B7021A          825                             cjne    @r1,#2,mas10
038B 900100          826                             MOV        dptr,#MASS0
038E 120000   F      827                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     828     
0391 7862            829                             mov             r0,#rez_A
0393 120000   F      830                             call    resar2          ;->r2..r5
0396 900100          831                             mov                     dptr,#MASS0
0399 120000   F      832                   call              saveIr2                 ; R2-R5 --> MAS0
                     833                     
039C 900107          834                   MOV          dptr,#MASS1+3
039F 120000   F      835                   CALL       addx
03A2 020000   F      836                       jmp           endsum
                     837     ;массив из 10-ти измерений
03A5 B70A7D          838     mas10:                  cjne    @r1,#10,mas20
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    14

03A8 900120          839                                             mov                     dptr,#MASS8
03AB 120000   F      840                     CALL            xCIKLWR         ;MASS8->MASS9
03AE 90011C          841                                             mov                     dptr,#MASS7
03B1 120000   F      842                     CALL            xCIKLWR         ;MASS7->MASS8
03B4 900118          843                     MOV       dptr,#MASS6
03B7 120000   F      844                     CALL       xCIKLWR         ; MASS6 --> MASS7
03BA 900114          845                     MOV        dptr,#MASS5
                     846                    
03BD 120000   F      847                    CALL        xCIKLWR        ; MASS5 --> MASS6
03C0 900110          848                    MOV         dptr,#MASS4
                     849                    
03C3 120000   F      850                    CALL        xCIKLWR        ; MASS4 --> MASS5
03C6 90010C          851                             mov                     dptr,#MASS3
                     852     
03C9 120000   F      853                    CALL             xCIKLWR         ;MASS3->MASS4
03CC 900108          854                     MOV        dptr,#MASS2
                     855                    
03CF 120000   F      856                    CALL        xCIKLWR         ; MASS2 --> MASS3
03D2 900104          857                    MOV         dptr,#MASS1
                     858                     
03D5 120000   F      859                   CALL         xCIKLWR        ; MASS1 --> MASS2
03D8 900100          860                    MOV         dptr,#MASS0
                     861                   
03DB 120000   F      862                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     863     
                     864                             
03DE 7862            865                             mov             r0,#rez_A
03E0 120000   F      866                             call    resar2          ;->r2..r5
                     867                                     ;call   aform
03E3 900100          868                                     mov                     dptr,#MASS0
03E6 120000   F      869                   call              saveIr2                 ; R2-R5 --> MAS0
                     870              
03E9 900107          871                   MOV          dptr,#MASS1+3
03EC 120000   F      872                   CALL       addx
03EF 90010B          873                   MOV          dptr,#MASS2+3
03F2 120000   F      874                   CALL       addx
03F5 90010F          875                   MOV          dptr,#MASS3+3
03F8 120000   F      876                  CALL        addx
03FB 900113          877                   MOV       dptr,#MASS4+3
03FE 120000   F      878                   call       addx
0401 900117          879                     MOV        dptr,#MASS5+3
0404 120000   F      880                  CALL        addx
0407 90011B          881                   MOV          dptr,#MASS6+3
040A 120000   F      882                   CALL       addx
040D 90011F          883                   MOV          dptr,#MASS7+3
0410 120000   F      884                  CALL        addx
0413 900123          885                  MOV        dptr,#MASS8+3
0416 120000   F      886                   call       addx
0419 900127          887                     MOV                     dptr,#MASS9+3
041C 120000   F      888                  call        addx
041F 020000   F      889                              jmp            endsum
                     890     
0422 020000   F      891     rmas4:          jmp                     mas4
                     892     ;массив из 20-ти измерений
0425 B714FA          893     mas20:          cjne    @r1,#20,rmas4
0428 900148          894                                             mov                     dptr,#MASS18
042B 120000   F      895                     CALL            xCIKLWR         ;MASS18->MASS19
042E 900144          896                                             mov                     dptr,#MASS17
0431 120000   F      897                     CALL            xCIKLWR         ;MASS17->MASS18
0434 900140          898                     MOV       dptr,#MASS16
0437 120000   F      899                     CALL       xCIKLWR         ; MASS16 --> MASS17
043A 90013C          900                     MOV        dptr,#MASS15
                     901                    
043D 120000   F      902                    CALL        xCIKLWR        ; MASS15 --> MASS16
0440 900138          903                    MOV         dptr,#MASS14
                     904                    
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    15

0443 120000   F      905                    CALL        xCIKLWR        ; MASS14 --> MASS15
0446 900134          906                             mov                     dptr,#MASS13
                     907     
0449 120000   F      908                    CALL             xCIKLWR         ;MASS13->MASS14
044C 900130          909                     MOV        dptr,#MASS12
                     910                    
044F 120000   F      911                    CALL        xCIKLWR         ; MASS12 --> MASS13
0452 90012C          912                    MOV         dptr,#MASS11
                     913                     
0455 120000   F      914                   CALL         xCIKLWR        ; MASS11 --> MASS12
0458 900128          915                    MOV         dptr,#MASS10
                     916                   
045B 120000   F      917                    CALL        xCIKLWR        ; MASS10 --> MASS11
045E 900124          918                                      MOV       dptr,#MASS9
0461 120000   F      919                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     920     
0464 900120          921                                             mov                     dptr,#MASS8
0467 120000   F      922                     CALL            xCIKLWR         ;MASS8->MASS9
046A 90011C          923                                             mov                     dptr,#MASS7
046D 120000   F      924                     CALL            xCIKLWR         ;MASS7->MASS8
0470 900118          925                     MOV       dptr,#MASS6
0473 120000   F      926                     CALL       xCIKLWR         ; MASS6 --> MASS7
0476 900114          927                     MOV        dptr,#MASS5
                     928                    
0479 120000   F      929                    CALL        xCIKLWR        ; MASS5 --> MASS6
047C 900110          930                    MOV         dptr,#MASS4
                     931                    
047F 120000   F      932                    CALL        xCIKLWR        ; MASS4 --> MASS5
0482 90010C          933                             mov                     dptr,#MASS3
                     934     
0485 120000   F      935                    CALL             xCIKLWR         ;MASS3->MASS4
0488 900108          936                     MOV        dptr,#MASS2
                     937                    
048B 120000   F      938                    CALL        xCIKLWR         ; MASS2 --> MASS3
048E 900104          939                    MOV         dptr,#MASS1
                     940                     
0491 120000   F      941                   CALL         xCIKLWR        ; MASS1 --> MASS2
0494 900100          942                    MOV         dptr,#MASS0
                     943                   
0497 120000   F      944                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     945     
                     946                             
049A 7862            947                             mov             r0,#rez_A
049C 120000   F      948                             call    resar2          ;->r2..r5
                     949                                     ;call   aform
049F 900100          950                                     mov                     dptr,#MASS0
04A2 120000   F      951                   call              saveIr2                 ; R2-R5 --> MAS0
                     952              
04A5 900107          953                   MOV          dptr,#MASS1+3
04A8 120000   F      954                   CALL       addx
04AB 90010B          955                   MOV          dptr,#MASS2+3
04AE 120000   F      956                   CALL       addx
04B1 90010F          957                   MOV          dptr,#MASS3+3
04B4 120000   F      958                  CALL        addx
04B7 900113          959                   MOV       dptr,#MASS4+3
04BA 120000   F      960                   call       addx
04BD 900117          961                     MOV        dptr,#MASS5+3
04C0 120000   F      962                  CALL        addx
04C3 90011B          963                   MOV          dptr,#MASS6+3
04C6 120000   F      964                   CALL       addx
04C9 90011F          965                   MOV          dptr,#MASS7+3
04CC 120000   F      966                  CALL        addx
04CF 900123          967                  MOV        dptr,#MASS8+3
04D2 120000   F      968                   call       addx
04D5 900127          969                     MOV                     dptr,#MASS9+3
04D8 120000   F      970                  call        addx
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    16

                     971     ;27
04DB 90012B          972                                     MOV        dptr,#MASS10+3
04DE 120000   F      973                   CALL       addx
04E1 90012F          974                                     MOV        dptr,#MASS11+3
04E4 120000   F      975                   CALL       addx
04E7 900133          976                   MOV          dptr,#MASS12+3
04EA 120000   F      977                   CALL       addx
04ED 900137          978                   MOV          dptr,#MASS13+3
04F0 120000   F      979                  CALL        addx
04F3 90013B          980                   MOV       dptr,#MASS14+3
04F6 120000   F      981                   call       addx
04F9 90013F          982                                     MOV        dptr,#MASS15+3
04FC 120000   F      983                     CALL     addx
04FF 900143          984                   MOV          dptr,#MASS16+3
0502 120000   F      985                   CALL       addx
0505 900147          986                   MOV          dptr,#MASS17+3
0508 120000   F      987                  CALL        addx
050B 90014B          988                  MOV        dptr,#MASS18+3
050E 120000   F      989                   call       addx
0511 90014F          990                                     MOV                     dptr,#MASS19+3
0514 120000   F      991                  call        addx
0517 802F            992                                     jmp             endsum
                     993     ;массив из 4х измерений
0519                 994     mas4:                   
0519 900108          995                                             MOV        dptr,#MASS2
051C 120000   F      996                    CALL        xCIKLWR         ; MASS2 --> MASS3
051F 900104          997                    MOV         dptr,#MASS1
0522 120000   F      998                    CALL        xCIKLWR        ; MASS1 --> MASS2
0525 900100          999                    MOV         dptr,#MASS0
0528 120000   F     1000                    CALL        xCIKLWR        ; MASS0 --> MASS1
                    1001     
                    1002                             
052B 7862           1003                             mov             r0,#rez_A
052D 120000   F     1004                             call    resar2          ;->r2..r5
                    1005                                     ;call   aform
0530 900100         1006                                     mov                     dptr,#MASS0
0533 120000   F     1007                   call              saveIr2                 ; R2-R5 --> MAS0
                    1008              
0536 900107         1009                   MOV          dptr,#MASS1+3
0539 120000   F     1010                   CALL       addx
053C 90010B         1011                   MOV          dptr,#MASS2+3
053F 120000   F     1012                   CALL       addx
0542 90010F         1013                   MOV          dptr,#MASS3+3
0545 120000   F     1014                  CALL        addx
                    1015                  
                    1016             ;23.03          
0548                1017     endsum:
0548 786E           1018                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
054A 06             1019                                     inc             @r0
054B E6             1020                                     mov             a,@r0   
054C 200105         1021                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                    1022                                     
054F B53F31         1023                                     cjne    a,chmasN,masx5
0552 D201           1024                                     setb    bitmas                  ;массив заполнен
0554 853F6E         1025     masfull:                mov             chmas,chmasN
0557 783F           1026                                     mov             r0,#chmasN
0559 E6             1027                                     mov             a,@r0
                    1028     ;masfull:
055A B40208         1029                                     cjne    a,#2,nochn2
055D 900000   F     1030                                     MOV        DPTR,#ch2;10 
0560 120000   F     1031                                     CALL   ldc_ltemp                 ; ltemp <-- 2
0563 8028           1032                                     jmp             mas5div
                    1033     
0565 B40A08         1034     nochn2:         cjne    a,#10,nochn10
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    17

0568 900000   F     1035                                                     MOV        DPTR,#ch10 
056B 120000   F     1036                                     CALL   ldc_ltemp                 ; ltemp <-- 10
056E 801D           1037                                     jmp             mas5div
                    1038     
0570 B41408         1039     nochn10:        cjne    a,#20,nochn20
0573 900000   F     1040                                                     MOV        DPTR,#ch20 
0576 120000   F     1041                                     CALL   ldc_ltemp                 ; ltemp <-- 20
0579 8012           1042                                     jmp             mas5div
                    1043     
057B 900000   F     1044     nochn20:        MOV        DPTR,#ch4 
057E 120000   F     1045                                     CALL   ldc_ltemp                 ; ltemp <-- 4
0581 800A           1046                                     jmp             mas5div
                    1047     
0583 856E0B         1048     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
0586 E4             1049                                     clr     a
0587 F50A           1050                                     mov     ltemp+2,a
0589 F509           1051                                     mov     ltemp+1,a
058B F508           1052                                     mov     ltemp,a
                    1053     
058D                1054     mas5div:
058D 120000   F     1055                                     CALL       zdiv;divide                           ; R2-R5 =
                    1056                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                    1057     
                    1058                             
                    1059      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1060     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1061     ;получен результат 3 байта и знак
0590 7866           1062                             mov             r0,#rez_A1
0592 120000   F     1063                             call    saver2           ;сохр среднее по массиву
                    1064     ;;8.11.06                       mov             chmasN,#0
                    1065      ;;;;;;;;;;;;
                    1066      ;;;;;;;;;;;;
0595 C3             1067                             clr             c
0596 799A           1068                             mov             r1,#parT
0598 7402           1069                             mov             a,#2
059A 97             1070                             subb    a,@r1
059B 501D           1071                             jnc             ankor           ;T<3
                    1072                             ;A-=РЕЗ1                                ;T>3
059D 120402         1073                             call    altof                   ;r2..r5->float
05A0 785E           1074                             mov             r0,#rez_Ame
05A2 120000   F     1075                             call    saver2
                    1076                             ;;;;
05A5 7890           1077                             mov             r0,#koefKp;->r8..r11
05A7 EA             1078                             mov             a,r2
05A8 30E702         1079                             jnb             acc.7,nminus3
05AB 7894           1080                             mov             r0,#koefKm;->r8..r11
05AD 120000   F     1081     nminus3:                call    resar8
05B0 120203         1082                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
05B3 785E           1083                             mov             r0,#rez_Ame
05B5 120000   F     1084                             call    saver2
05B8 8021           1085                             jmp             gotoKD
                    1086     
05BA                1087     ankor:  
05BA 7898           1088                             mov             r0,#chinkor
05BC E6             1089                             mov             a,@r0
05BD 30E703         1090                             jnb             acc.7,nokorr
                    1091                             ;коррекция 0
05C0 020000   F     1092                             jmp             kornul
05C3                1093     nokorr: 
                    1094                             ;mov            r10,#00         ;       chavt
                    1095                             ;mov            r11,#00h
05C3 7881           1096                             mov              r0,#chavt      
05C5 E6             1097                             mov                     a,@r0;call      chcmp           ;сравн счет
                             чик авто калибровки с 0h
05C6 30E737         1098                             jnb             acc.7,nonulavt;jnz              nonulavt        
05C9 750A00         1099                             mov             r10,#0;1;00;02          
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    18

05CC 750BC8         1100                             mov             r11,#0c8h;90h;0c8h;58h
05CF 7898           1101                             mov             r0,#chinkor
05D1 120000   F     1102                             call    chcmp
05D4 7045           1103                             jnz             noavk
                    1104                             ;автокалибровка
05D6 020000   F     1105                             jmp             autoka;noavk;
                    1106     
05D9 8076           1107     rafterK:                jmp             afterK
                    1108     ;;;;;;;;;;
05DB C3             1109      gotoKD:                clr             c
05DC 799A           1110                             mov             r1,#parT
05DE 7404           1111                             mov             a,#4
05E0 97             1112                             subb    a,@r1
05E1 50F6           1113                             jnc             rafterK         ;T<5
                    1114                             ;A1-=A- *KD                     ;T>5
                    1115                             ;call           findkoef                                ;r2,r3-hex
                    1116                             ;       call            rebyte2                         ;r2..r5- he
                             x
                    1117                                     
                    1118                             ;       call    altof                   ;r2..r5->float
                    1119                             ;       mov     dptr,#CHtho;100000
                    1120                             ;       call    ldc_ltemp                       ;r8..r11
                    1121                             ;       call    fldiv
                    1122                             ;       call    move28
                    1123                             
05E3 785E           1124                             mov             r0,#rez_Ame;->r2..r5   ???????????/
05E5 120000   F     1125                             call    resar2
                    1126                                     ;call   flmul
05E8 120343         1127                             call    ftol                    ;float->int
05EB 7866           1128                             mov             r0,#rez_A1
05ED 120000   F     1129                             call    saver2
05F0 786A           1130                             mov             r0,#rez_A0;->r8..r11 hex
05F2 120000   F     1131                             call    resar8
05F5 120000   F     1132                             call    lsub            ;A3=A-1-A0
05F8 789C           1133                             mov             r0,#rez_A3
05FA 120000   F     1134                             call    saver2
05FD 020000   F     1135                             jmp             labelB  
                    1136      ;;;;;;;;;;; 9.11.06
0600 789A           1137     nonulavt:        mov            r0,#parT
0602 E6             1138                             mov             a,@r0
0603 6401           1139                             xrl             a,#01
0605 700F           1140                             jnz             avtdec1
0607 7982           1141                             mov             r1,#chavt+1     ;T=1 chavt-10
0609 120000   F     1142                             call    tenmin
060C 7999           1143     kordec10:       mov             r1,#chinkor+1
060E 120000   F     1144                             call    tenmin
0611 801B           1145                             jmp             rezmul
                    1146     
0613 020000   F     1147     rmo220:         jmp             mo220
                    1148     
0616 7981           1149     avtdec1:        mov             r1,#chavt       
0618 120000   F     1150                             call    chdec           ;chavt-1
                    1151     ;                       jmp             kordec1;rezmul
061B 789A           1152     noavk:          mov             r0,#parT
061D E6             1153                             mov             a,@r0
061E 6401           1154                             xrl             a,#01
0620 7007           1155                             jnz             kordec1
                    1156                             ;T=1 chinkor-10
0622 7999           1157                     mov             r1,#chinkor+1
0624 120000   F     1158                             call    tenmin
0627 8005           1159                             jmp             rezmul
0629 7998           1160     kordec1:        mov             r1,#chinkor
062B 120000   F     1161                             call    chdec           ; chinkor-1
                    1162                        ;9.11.06
                    1163                             ;;;;;;;;;;;;;;
                    1164                             ;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    19

                    1165     ;(РЕЗ1-АN)*K
062E                1166     rezmul:
062E 7866           1167                             mov             r0,#rez_A1;->r2..r5
0630 120000   F     1168                             call    resar2
0633 120402         1169                             call    altof   ;r2..r5->float  6.06    
0636 7884           1170                             mov             r0,#kor0_AN;->r8..r11
0638 120000   F     1171                             call    resar8
063B 1201D1         1172                             call    flsub
063E 7890           1173                             mov             r0,#koefKp;->r8..r11
0640 EA             1174                             mov             a,r2
0641 30E702         1175                             jnb             acc.7,nminus
                    1176                             ;jnb            bitznak,nminus
                    1177                     
0644 7894           1178                             mov             r0,#koefKm;->r8..r11
0646 120000   F     1179     nminus:         call    resar8
0649 120203         1180                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
064C 785E           1181                             mov             r0,#rez_Ame
064E 120000   F     1182                             call    saver2
                    1183      
0651                1184     afterK:                 
                    1185     ;;;;;;;;;;;;;;
0651 EA             1186                                     mov             a,r2
0652 547F           1187                                     anl             a,#7fh
0654 FA             1188                                     mov             r2,a
0655 900000   F     1189                                     mov     dptr,#ch_250;220;220000
0658 120000   F     1190                                     call    ldc_ltemp                       ;r8..r11=8
065B 1201D6         1191                                     call    flcmp
065E 50B3           1192                                     jnc             rmo220          ;A>220000
                    1193                                     ;;;;;;;;;
0660 30156D         1194                                     jnb                     biteizm,notestizm
0663 78B1           1195                                     mov                     r0,#vichR
0665 B62135         1196                                     cjne            @r0,#21h,note21
0668 7A50           1197                                     mov                     r2,#50h                 ;-11a
066A 7B18           1198                                     mov                     r3,#18h                 ;k8
066C 12046C         1199                                     call            rebyte2                         ;r2..r5- he
                             x
066F 120402         1200                                     call            altof                   ;r2..r5->float
0672 C002           1201                                     push            rr2
0674 C003           1202                                     push            rr3
0676 C004           1203                                     push            rr4
0678 C005           1204                                     push            rr5
067A 7A50           1205                                     mov                     r2,#50h                 ;k10
067C 7B20           1206                                     mov                     r3,#20h
067E 12046C         1207     re11_7: call            rebyte2                 ;r2..r5
0681 120402         1208                                     call            altof                   ;r2..r5->float
0684 120000   F     1209                                     call            move28
0687 D005           1210                                     pop                     rr5
0689 D004           1211                                     pop                     rr4
068B D003           1212                                     pop                     rr3
068D D002           1213                                     pop                     rr2
068F 1202B7         1214                                     call            fldiv
0692 900000   F     1215                                     mov                     dptr,#ch_10
0695 120000   F     1216                                     call            ldc_ltemp                       ;r8..r11
0698 120203         1217                                     call            flmul
069B 8050           1218                                     jmp                     temul   
069D B62218         1219     note21: cjne            @r0,#22h,note22
06A0 7A50           1220                                     mov                     r2,#50h                 ;-09a
06A2 7B10           1221                                     mov                     r3,#10h                 ;k6
06A4 12046C         1222                                     call            rebyte2                         ;r2..r5- he
                             x
06A7 120402         1223                                     call            altof                   ;r2..r5->float
06AA C002           1224                                     push            rr2
06AC C003           1225                                     push            rr3
06AE C004           1226                                     push            rr4
06B0 C005           1227                                     push            rr5
06B2 7A50           1228                                     mov                     r2,#50h                 ;k8
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    20

06B4 7B18           1229                                     mov                     r3,#18h
06B6 80C6           1230                                     jmp                     re11_7
06B8 7A50           1231     note22: mov                     r2,#50h                 ;-7a
06BA 7B08           1232                                     mov                     r3,#08h                 ;k4
06BC 12046C         1233                                     call            rebyte2                         ;r2..r5- he
                             x
06BF 120402         1234                                     call            altof                   ;r2..r5->float
06C2 C002           1235                                     push            rr2
06C4 C003           1236                                     push            rr3
06C6 C004           1237                                     push            rr4
06C8 C005           1238                                     push            rr5
06CA 7A50           1239                                     mov                     r2,#50h                 ;k6
06CC 7B10           1240                                     mov                     r3,#10h
06CE 80AE           1241                                     jmp                     re11_7  
                    1242                                     ;;;;;;;;;
06D0                1243     notestizm:
06D0 301208         1244                                     jnb             bitklb,komulpz
06D3 900000   F     1245                                     mov     dptr,#chk;100000
06D6 120000   F     1246                                     call    ldc_long                        ;r2..r5
06D9 8006           1247                                     jmp             komul
06DB 120000   F     1248     komulpz:call            findkoef                                ;r2,r3-hex
06DE 12046C         1249                                     call            rebyte2                         ;r2..r5- he
                             x
                    1250                                     
06E1 120402         1251     komul:  call    altof                   ;r2..r5->float
06E4 900000   F     1252                                     mov     dptr,#CHtho;100000
06E7 120000   F     1253                             call    ldc_ltemp                       ;r8..r11=8
06EA 1202B7         1254                                     call    fldiv
06ED 120000   F     1255     temul:                          call    move28
06F0 785E           1256                                     mov             r0,#rez_Ame
06F2 120000   F     1257                                     call    resar2
                    1258                     
06F5 120203         1259                                     call    flmul     ;A1-=A-*KD  fl
                    1260                                     
06F8 120343         1261                                     call    ftol                    ;float->int
06FB 7866           1262                                     mov             r0,#rez_A1
06FD 120000   F     1263                                     call    saver2
0700 120402         1264                                     call    altof                   ;r2..r5->float
0703 900000   F     1265                                     mov     dptr,#ch_220;200;200000
0706 120000   F     1266                                     call    ldc_ltemp                       ;r8..r11=8
0709 1201D6         1267                                     call    flcmp
070C 502D           1268                                     jnc             rrmo220         ;A>200000
                    1269                             ;       jnb             knizm,noavp;goA2;               bitizm,goA2
                                  
                    1270                             ;       jb              bitavp,yesavp
070E 301808         1271                                     jnb             knizm,goA2
0711 300602         1272                                     jnb             bitvi11,qu_avp
0714 8003           1273                                     jmp             goA2
0716 20052F         1274     qu_avp:                 jb              bitavp,yesavp
0719                1275     noavp:  ;               jb              bitvi11,yesvich  ;уст после ввода A B (ввод ВЫЧИСЛИ
                             ТЬ)
0719                1276     goA2:                    ;A2=A1-
0719 7866           1277                                      mov            r0,#rez_A1
071B 120000   F     1278                                     call    resar2
071E 787B           1279                                     mov             r0,#rez_A2
0720 120000   F     1280                                     call    saver2
0723                1281     goA3A2:                  ;A3=A2-A0
0723 786A           1282                                       mov           r0,#rez_A0
0725 120000   F     1283                                     call    resar8
0728 120000   F     1284                                     call    lsub
072B 789C           1285                                     mov             r0,#rez_A3
072D 120000   F     1286                                     call    saver2
                    1287                                     ;;;;;;
0730 200644         1288                                     jb              bitvi11,yesvich
0733                1289     goonin:            ;jmp         goonind;indA3;8.11.06
0733 78AC           1290                                     mov             r0,#chind
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    21

0735 B60006         1291                                     cjne    @r0,#0,rnochi0
0738 020000   F     1292                                     jmp             goonind;indA3
                    1293     ;                               clr             P3.4
                    1294     ;                               nop
                    1295     ;                               nop
                    1296     ;                               setb    P3.4      ;??????????????????????/
                    1297     ;                               jmp             nop3_0
                    1298     
                    1299     ;                               jb              P3.0,nop3_0     ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1300     ;                               mov             r0,#rez_A0              ;r2..r5->rez_A0
                    1301     ;                               call    saver2                  ;ЗАПОМНИТЬ СМЕЩЕНИЕ НУЛЯ
                    1302     ;                               jmp             rebyte          ;age2
073B 020000   F     1303     rrmo220:                jmp             mo220
073E 020000   F     1304     rnochi0:                jmp             nochi0
0741 7866           1305     gokaA2:                 mov             r0,#rez_A1                      ;(float)
0743 120000   F     1306                                                     call    saver2                          ;то
                              необх для калибровки ,goA2 работает с тим знач
0746 80D1           1307                                             jmp             goA2
                    1308     ;;;;;;;;;;;;;;;;
0748 EA             1309     yesavp:                 mov             a,r2
0749 547F           1310                                     anl             a,#7fh
074B FA             1311                                     mov             r2,a
074C 900000   F     1312                                     mov     dptr,#ch_10th;10000
074F 120000   F     1313                                     call    ldc_ltemp                       ;r8..r11=8
0752 1201D6         1314                                     call    flcmp
0755 50C2           1315                                     jnc             noavp           ;A>10000        
0757 78AE           1316                                     mov             r0,#diap                ;10-11
0759 B60902         1317                                     cjne    @r0,#9,avpgo
075C 80BB           1318                                     jmp             noavp
075E                1319     avpgo:                  
075E 06             1320                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
075F B60A01         1321                                     cjne    @r0,#0ah,clmasv
0762 16             1322                                     dec             @r0
0763                1323     clmasv:         ;сбросить массив
0763 120000   F     1324                             call    loadUS
                    1325                             ;call   louizm
0766 120000   F     1326                             call     clmassix
0769 78B3           1327                                     mov             r0,#summa
076B 120000   F     1328                                     call    clear4
076E 786A           1329                                     mov             r0,#rez_A0
0770 120000   F     1330                                     call    clear4
0773 D207           1331                                     setb            bitzus;bitbuf;;;;;;;;;;;;                  
                                                                                   
0775 80BC           1332                                jmp     goonin
                    1333     
0777                1334     yesvich:        
                    1335                     ;                       mov             r0,#konstB
                    1336                     ;               call    resar2
                    1337                     ;               call    move28
0777 789C           1338                                     mov             r0,#rez_A3;A1
0779 120000   F     1339                                     call    resar2                          ;HEX
                    1340                                     
077C 120402         1341                                     call            altof                   ;r2..r5->float
077F EA             1342                                     mov             a,r2                    ;модуль
0780 547F           1343                                     anl             a,#7fh
0782 FA             1344                                     mov             r2,a
                    1345                     ;               call            fladd                           ;A1+B
                    1346                                     
0783 900000   F     1347                                     mov     dptr,#CH_500;
0786 120000   F     1348                                     call    ldc_ltemp                       ;r8..r11
0789 1201D6         1349                                     call    flcmp
078C 4073           1350                                     jc                      mo500R;error <500 >22000
078E 900000   F     1351                                     mov     dptr,#CH_22T;
0791 120000   F     1352                                     call    ldc_ltemp                       ;r8..r11
0794 1201D6         1353                                     call    flcmp
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    22

0797 5074           1354                                     jnc             mo500I          ;error
                    1355                                     ;;;;;;;;;;;;
0799 120000   F     1356                                     call            move28
079C C008           1357                                     push            r8
079E C009           1358                                     push            r9
07A0 C00A           1359                                     push            r10
07A2 C00B           1360                                     push            r11
07A4 78BC           1361                                     mov             r0,#konstA
07A6 120000   F     1362                                     call    resar2
07A9 900000   F     1363                                     mov             dptr,#CH_B
07AC 120000   F     1364                                     CALL   ldc_ltemp                 ; ltemp <-- 10-7
07AF 120203         1365                                     call            flmul                           ;A*10-7
07B2 D00B           1366                                     pop                     r11
07B4 D00A           1367                                     pop                     r10
07B6 D009           1368                                     pop                     r9
07B8 D008           1369                                     pop                     r8
07BA 1202B7         1370                                     call            fldiv                   ;результат R
07BD 78C9           1371                                     mov                     r0,#rez_R
07BF 120000   F     1372                                     call            saver2
07C2 120343         1373                                     call            ftol                    ;float->hex
                    1374                                     ;;;;;;;;;;
07C5 784F           1375                                             mov             r0,#abin
07C7 120000   F     1376                                             call    saver2
                    1377     ;;;;;;;;
07CA 7840           1378                                                     mov             r0,#bufind
07CC                1379     age9:
07CC 7620           1380                             mov             @r0,#" "          ;погасить индикатор
07CE 08             1381                             inc             r0
07CF B84BFA         1382                             cjne    r0,#bufind+11,age9
                    1383                                             
07D2 78C9           1384                                             mov             r0,#rez_R
07D4 120000   F     1385                                             call            resar2
                    1386     ;;;;;;;;;;
07D7 900000   F     1387                                     mov             dptr,#CH_fl
07DA 120000   F     1388                                     CALL   ldc_ltemp
07DD 1202B7         1389                                     call            fldiv
                    1390     
07E0 78B8           1391                                     mov             r0,#work                ;степень +
07E2 7600           1392                                     mov             @r0,#0
07E4 78B9           1393                                     mov             r0,#work+1;степень -
07E6 7600           1394                                     mov             @r0,#0
07E8 900000   F     1395     compa1: mov     dptr,#ch_1;
07EB 120000   F     1396                                     call    ldc_ltemp                       ;r8..r11
07EE 1201D6         1397                                     call    flcmp
07F1 4026           1398                                     jc              equ0            ;<1
07F3 78B8           1399                                     mov             r0,#work                        ;степень +
07F5 06             1400                                     inc             @r0
07F6 900000   F     1401                                     mov             dptr,#ch_10;
07F9 120000   F     1402                                     call    ldc_ltemp                       ;r8..r11
07FC 1202B7         1403                                     call            fldiv
07FF 80E7           1404                                     jmp             compa1                          ;work значе
                             ние степени n(hex)  
                    1405                                     ;;;;;;;;;;;;;;;;;;;
0801 900000   F     1406     mo500R: mov             dptr,#teOLR
0804 120000   F     1407                               call          lotext           
0807 120000   F     1408                                     call            ind
080A 020000   F     1409                                     jmp                     nobavp;nobitizm
080D 900000   F     1410     mo500I: mov             dptr,#teOLI
0810 120000   F     1411                               call          lotext           
0813 120000   F     1412                                     call            ind
0816 020000   F     1413                                     jmp                     nobavp;nobitizm
0819                1414     equ0:           ;;;;;   call            ftol                    ;float->int
0819 78B8           1415                                     mov             r0,#work                ;степень +
081B B60019         1416                                     cjne    @r0,#0,equ00
                    1417                                     
081E 900000   F     1418     compa2: mov     dptr,#ch_1;
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    23

0821 120000   F     1419                                     call    ldc_ltemp                       ;r8..r11
0824 1201D6         1420                                     call    flcmp
0827 500E           1421                                     jnc             equ00           ;>1
0829 78B9           1422                                     mov             r0,#work+1                      ;степень -
082B 16             1423                                     dec             @r0                                        
                                          ;0,ff(-1),fe(-2)...
082C 900000   F     1424                                     mov             dptr,#ch_10;
082F 120000   F     1425                                     call    ldc_ltemp                       ;r8..r11
0832 120203         1426                                     call            flmul
0835 80E7           1427                                     jmp             compa2                          ;work значе
                             ние степени n(hex)  
                    1428     
                    1429     
0837                1430     equ00:          
0837 7853           1431                                                     mov             r0,#adec
0839 7952           1432                                             mov             r1,#abin+3      ;hex->10
083B 120000   F     1433                                             call    bindec
                    1434     
                    1435                                                     ;если степень полож убирать младший байт
                    1436                                                     ;чтобы уложиться в 5 разрядов, если отриц р
                             асполагать
                    1437                                                     ;число в bufind..bufind+5
083E 78B8           1438                                             mov             r0,#work
0840 B60021         1439                                             cjne    @r0,#0,outr
0843 08             1440                                             inc             r0                      ;work+1
0844 B6FF05         1441                                             cjne            @r0,#0ffh,bufr3         ;6разрядов 
                             нужно вывести 5
0847 06             1442                                             inc                     @r0;!!!!!!!!!?
0848 785B           1443                                             mov                     r0,#adec+8;разместить в буф
                             ер индикации R
084A 8003           1444                                             jmp                     bufr30
                    1445                                             ;;;;;;;;;;;;;;
084C 06             1446     bufr3:          inc             @r0                     ;?!!!!!!!!n+1
084D 785C           1447                                                     mov             r0,#adec+9
084F 7945           1448     bufr30:         mov             r1,#bufind+5;6
0851 7F05           1449                                             mov             r7,#5;7
0853 E6             1450     bufr2:                          mov             a,@r0
0854 2430           1451                                             add             a,#30h
0856 F7             1452                                             mov             @r1,a
0857 19             1453                                             dec             r1
0858 18             1454                                             dec             r0
0859 DFF8           1455                                             djnz    r7,bufr2
                    1456     
085B 784F           1457                                             mov             r0,#abin
085D 120000   F     1458                                             call            clear4
0860 78B9           1459                                             mov             r0,#work+1
0862 801C           1460                                     jmp             outr5
                    1461     ;work!=0 значит после дел на 10**9 получили число > с чем 6 разрядов                       
                                          
0864 785C           1462     outr:                   mov             r0,#adec+9;разместить в буфер индикации R
0866 C3             1463                                             clr             c
0867 79B8           1464                                             mov             r1,#work
0869 E8             1465                                             mov             a,r0
086A 14             1466                                             dec             a                                  
                                  ;n-1
086B 97             1467                                             subb    a,@r1
086C F8             1468                                             mov             r0,a                    ;adec+9-n !
                             !!!!!!!!!!!!!!
086D 7945           1469                                     mov             r1,#bufind+5;т к число разрядов > чем знако
                             мест
086F 7F05           1470                                             mov             r7,#5;7
0871 E6             1471     bufr:                           mov             a,@r0
0872 2430           1472                                             add             a,#30h
0874 F7             1473                                             mov             @r1,a
0875 19             1474                                             dec             r1
0876 18             1475                                             dec             r0
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    24

0877 DFF8           1476                                             djnz    r7,bufr
                    1477     
0879 784F           1478                                             mov             r0,#abin
087B 120000   F     1479                                             call            clear4
087E 78B8           1480                                     mov             r0,#work
0880 E6             1481     outr5:                  mov             a,@r0
0881 F552           1482                                             mov             abin+3,a
                    1483                                                                     ;n(hex)->abin
0883 120000   F     1484                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
0886 2552           1485                                             add             a,abin+3
0888 F552           1486                                             mov             abin+3,a
088A 7853           1487                                             mov             r0,#adec
088C 7952           1488                                             mov             r1,#abin+3      ;hex->10
088E 120000   F     1489                                             call    bindec
0891 855C48         1490                                             mov             bufind+8,adec+9
0894 855B47         1491                                             mov             bufind+7,adec+8
0897 754966         1492                                             mov             bufind+9,#66h
089A 020000   F     1493                                             jmp             nobavp;nobitizm;        goonin;call
                                  ind
                    1494                                             
                    1495                                     ;;;;;;;;;;;;;;;;;;;;;
                    1496     ;;;;;;;;;;;;;
                    1497     
089D 300508         1498     mo220:             jnb          bitavp,indoll
08A0 301805         1499                                jnb          knizm,indoll;bitizm,indoll
08A3 78AE           1500                                     mov             r0,#diap
08A5 B6000B         1501                                     cjne    @r0,#0,nodi2
                    1502                                ;10-2
08A8 900000   F     1503     indoll:                 mov             dptr,#teOLL;OLL
08AB 120000   F     1504                                     call    lotext
08AE D217           1505                                     setb    bitoll
08B0 020000   F     1506                                     jmp             goonin  
                    1507     
08B3 16             1508     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1509     
08B4 B6FF01         1510                                     cjne    @r0,#0ffh,nodi9
08B7 06             1511                                     inc             @r0
                    1512     
08B8 120000   F     1513     nodi9:          call    loadUS
                    1514                                     ;call   louizm
                    1515                                     ;сбросить массив
08BB 120000   F     1516                                     call     clmassix
08BE 78B3           1517                                     mov             r0,#summa
08C0 120000   F     1518                                     call    clear4
08C3 786A           1519                                     mov             r0,#rez_A0
08C5 120000   F     1520                                     call    clear4  
08C8 D207           1521                                     setb    bitzus;bitbuf   ;флаг задержки  после установки us 
                                                                           
08CA 020000   F     1522                                jmp     goonin
                    1523     
08CD 16             1524     nochi0:                 dec             @r0                     ;СТИ-1
08CE 020000   F     1525                                     jmp             labelB  
                    1526     
                    1527             
                    1528     ;;;;;;;;;;;;;;;
                    1529     
08D1                1530     nop3_0: ;;      ;rez_A-rez_A0
                    1531                     ;;                      mov             r0,#rez_A0
                    1532                     ;;                      call    resar8
                    1533                     ;;                      call    lsub
                    1534                     ;;                      mov             r0,#rez_A
                    1535                     ;;;                     call    saver2
                    1536      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
08D1 789C           1537      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    25

08D3 120000   F     1538                                             call    resar2
08D6 900000   F     1539                                             mov             dptr,#ch100              
08D9 120000   F     1540                                             call    ldc_ltemp        
08DC 120000   F     1541                                             call    zdiv            ;rez_A3/100=r2..r5
                    1542                                     
08DF EC             1543                                             mov             a,r4
08E0 20E71E         1544                                             jb              acc.7,aless0
08E3 4408           1545                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
08E5 F5D3           1546                                             mov             DAC0H,a
                    1547                                                                             ;мл байт
08E7 ED             1548                                             mov             a,r5
08E8 F5D2           1549                                             mov             DAC0L,a
08EA 801E           1550                                             jmp             moveA3;
                    1551     
08EC B70207         1552     no3parN:                        cjne    @r1,#2,no2parN
                    1553                                             ;в байт 0  записать пробел
08EF 7946           1554                                             mov             r1,#bufind+6
08F1 7720           1555                                             mov             @r1,#" ";0fdh;
08F3 020000   F     1556                                             jmp             seeind;moveA3
                    1557     
08F6                1558     no2parN:                        ;в байты 0 и 1 записать пробел
08F6 7945           1559                                             mov             r1,#bufind+5
08F8 7720           1560                                             mov             @r1,#" ";0fdh;" "
08FA 09             1561                                             inc             r1
08FB 7720           1562                                             mov             @r1,#" ";0fdh;" "
08FD 8079           1563                                             jmp             seeind;moveA3
08FF 8077           1564      rseeind:               jmp             seeind
0901 F4             1565     aless0:                         cpl             a
0902 54F7           1566                                             anl             a,#0f7h         ;d11=0
0904 F5D3           1567                                             mov             DAC0H,a
                    1568                                                                             ;мл байт
0906 ED             1569                                             mov             a,r5
0907 F4             1570                                             cpl             a
0908 F5D2           1571                                             mov             DAC0L,a
090A                1572     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1573                                     
                    1574                                             
090A                1575     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1576                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1577                     ;до конца цикла измерения результат не размещать в буфере
                    1578                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1579                     ;и возврату в режим измерения
090A 201456         1580                                             jb              bitvich,rnorvich
090D 201053         1581                                             jb              bitt2,rnorvich
0910 2017EC         1582                                             jb              bitoll,rseeind
                    1583                                             
0913 2011E9         1584                                             jb              bitmenu,rseeind
0916 200BE6         1585                                             jb              bitmem,rseeind
                    1586     ;;;;;;;;;;;;;;
                    1587                                             ; mov           r0,#rez_A3
                    1588                                             ;call   resar2
                    1589                                             ;call   ftol                    ;float->int r2..r5
                    1590     ;;;;;;;;
0919 789C           1591                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
091B 120000   F     1592                                             call    resar2;????????????????17.01.07
                    1593                                     
091E 120000   F     1594                                             call    maform
0921 784F           1595                                             mov             r0,#abin
0923 120000   F     1596                                             call    saver2
                    1597     ;;;;;;;;
                    1598                                             
0926 7853           1599                                             mov             r0,#adec
0928 7952           1600                                             mov             r1,#abin+3      ;hex->10
092A 120000   F     1601                                             call    bindec
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    26

                    1602                                     
092D 785C           1603                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
092F 7946           1604                                             mov             r1,#bufind+6
0931 7F07           1605                                             mov             r7,#7
0933 E6             1606     bufdec:                         mov             a,@r0
0934 2430           1607                                             add             a,#30h
0936 F7             1608                                             mov             @r1,a
0937 19             1609                                             dec             r1
0938 18             1610                                             dec             r0
0939 DFF8           1611                                             djnz    r7,bufdec
093B 7847           1612                                             mov             r0,#bufind+7
093D 762D           1613                                             mov             @r0,#2dh          ;-2..-9
093F 7840           1614                                             mov             r0,#bufind
0941 762B           1615                                             mov             @r0,#2bh
0943 300202         1616                                             jnb             znmat,nozzmi;bitznak,nozzmi
0946 762D           1617                                             mov             @r0,#2dh
0948 79AE           1618     nozzmi:                         mov             r1,#diap
094A 7848           1619                                             mov             r0,#bufind+8
094C E7             1620                                             mov             a,@r1
094D B40808         1621                                             cjne    a,#8,nodi8
0950 7630           1622                                             mov             @r0,#30h                 ;10-10
0952 18             1623                                             dec             r0
0953 7663           1624                                             mov             @r0,#63h;31h
0955 08             1625                                             inc             r0
0956 8012           1626                                             jmp             seegoon
0958 B4090C         1627     nodi8:                          cjne    a,#9,nodis9
                    1628                                     
095B 7631           1629                                             mov             @r0,#31h           ;10-11
095D 18             1630                                             dec             r0
095E 7663           1631                                             mov             @r0,#63h;31h
                    1632                                     
0960 08             1633                                             inc             r0
0961 8007           1634                                             jmp             seegoon
                    1635     
0963 807C           1636     rnorvich:               jmp             norvich
0965 8085           1637     rno3parN:               jmp             no3parN
                    1638     
0967 2432           1639     nodis9:                         add             a,#32h
0969 F6             1640                                             mov             @r0,a;#37h;"T";
096A 08             1641     seegoon:                        inc             r0
096B 7641           1642                                             mov             @r0,#"A";"E";
096D 08             1643                                             inc             r0
096E 7600           1644                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
0970 08             1645                                             inc             r0;             mov             buf
                             ind+11
0971 7610           1646                                             mov             @r0,#010h               ;bufind+11.
                             4 точка после первой цифры
                    1647                                             
                    1648     ;;;;;;;;;;;;;;;
                    1649     ;;;;;;goonind:
0973 79AF           1650                                             mov             r1,#parN        ; ??????
0975 B703ED         1651                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1652             
0978                1653     seeind:                         ;;;;;;;;;;;;;
0978 784A           1654                                             mov             r0,#bufind+10
097A E6             1655                                             mov             a,@r0
097B 300F03         1656                                             jnb             bitnul,nnnul
097E 4408           1657                                             orl             a,#08h
0980 F6             1658                                             mov             @r0,a
0981 799A           1659      nnnul:                         mov             r1,#parT
0983 B70304         1660                                             cjne    @r1,#3,nsec01
0986 4410           1661                                             orl             a,#10h
0988 800C           1662                                             jmp             nsec10   ;0,1s
098A B70204         1663      nsec01:                        cjne    @r1,#2,nsec1
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    27

098D 4420           1664                                             orl             a,#20h    ;1s
098F 8005           1665                                             jmp             nsec10
0991 B70102         1666     nsec1:                          cjne    @r1,#1,nsec10
0994 4440           1667                                             orl             a,#40h
                    1668     
                    1669     ;;;;;;;;;;;;;;;;
0996 784A           1670     nsec10:                 mov             r0,#bufind+10   
0998 F6             1671                                             mov             @r0,a
0999 300504         1672                                             jnb             bitavp,nobavp
099C 4404           1673                                             orl             a,#04           ;bufind+10.2
099E F6             1674                                             mov             @r0,a
099F F6             1675                                             mov             @r0,a   
09A0 784A           1676     nobavp:         mov             r0,#bufind+10   
09A2 F6             1677                                             mov             @r0,a   
09A3 301803         1678                                        jnb          knizm,nobitizm
09A6 4402           1679                                             orl             a,#02
09A8 F6             1680                                              mov            @r0,a
09A9                1681     nobitizm:                       
09A9 301A07         1682                                             jnb             bitakt,notakt
09AC C21A           1683                                             clr             bitakt
09AE 534AFE         1684                                             anl             bufind+10,#0feh
09B1 8005           1685                                             jmp             taktind
09B3 D21A           1686     notakt:                         setb    bitakt
09B5 434A01         1687                                             orl             bufind+10,#01                      
                                          
09B8                1688     taktind:                
                    1689     ;;;;;;;;;
09B8 301517         1690                                             jnb             biteizm,yesind
09BB 79B1           1691                                             mov             r1,#vichR
09BD 7848           1692                                             mov             r0,#bufind+8
09BF B72107         1693                                             cjne    @r1,#21h,test9i
09C2 7631           1694                                             mov             @r0,#31h;11A
09C4 18             1695                                             dec             r0
09C5 7663           1696                                             mov             @r0,#63h
09C7 8009           1697                                             jmp             yesind
09C9 B72204         1698     test9i:         cjne    @r1,#22h,test7i
09CC 7639           1699                                             mov             @r0,#39h;09A
09CE 8002           1700                                             jmp             yesind
09D0 7637           1701     test7i:         mov             @r0,#37h;07A
                    1702                                     
                    1703     ;;;;;;;;;
09D2                1704     yesind:         
09D2 301203         1705                                             jnb             bitklb,noklb
09D5 434A80         1706                                             orl             bufind+10,#80h; on kmp
09D8 300A03         1707     noklb:          jnb             bitbon,nobuf
09DB 434B02         1708                                             orl             bufind+11,#02h; on pysk
09DE 120000   F     1709     nobuf:          call    ind        ;пп выдачи на индикатор
09E1                1710     norvich: 
09E1 789A           1711                                     mov             r0,# parT
09E3 79AC           1712                                             mov             r1,#chind
09E5 B60152         1713                                             cjne    @r0,#1,rnot1in
09E8                1714     labelB:                    ;;;;;;;;;;;
                    1715                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
09E8 789F           1716                                                     mov     r0,#rez_A3+3
                    1717                             ;;;;;;;;
09EA 79BB           1718                             mov             r1,#work+3
09EC E6             1719                             mov             a,@r0
09ED 7F07           1720                             mov             r7,#7;кол сдв вправо
09EF C3             1721     dvig3:          clr             c
09F0 13             1722                             rrc             a
09F1 DFFC           1723                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
09F3 FA             1724                             mov             r2,a    ;сохр байт
09F4 18             1725                             dec             r0              ;rez_A3+2
09F5 E6             1726                             mov             a,@r0
09F6 C0E0           1727                             push    acc
09F8 C3             1728                             clr             c
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    28

09F9 7F01           1729                             mov             r7,#1
09FB C3             1730     dvig2:          clr             c
09FC 33             1731                             rlc             a
09FD DFFC           1732                             djnz    r7,dvig2 ;d12..d11       средний байт
09FF 4A             1733                             orl             a,r2
0A00 F7             1734                             mov             @r1,a;сформ мл байт
0A01 19             1735                             dec             r1
0A02 D0E0           1736                             pop             acc
                    1737                             
0A04 7F07           1738                             mov             r7,#7
0A06 C3             1739     dvig1:          clr             c
0A07 13             1740                             rrc             a
0A08 DFFC           1741                             djnz    r7,dvig1 ;d18     ср байт
0A0A FA             1742                             mov             r2,a   ;сохр
0A0B 18             1743                             dec             r0
0A0C E6             1744                             mov             a,@r0 ;rez_A3+1
0A0D C0E0           1745                             push    acc
                    1746                     
0A0F 7F01           1747                             mov             r7,#1
0A11 C3             1748     dvig0:          clr             c
0A12 33             1749                             rlc             a
0A13 DFFC           1750                             djnz    r7,dvig0 ;        d21..d16
0A15 4A             1751                             orl             a,r2
0A16 F7             1752                             mov             @r1,a   ; сформ средний  байт
0A17 19             1753                             dec             r1
0A18 D0E0           1754                             pop             acc       ;rez_A3+1
                    1755                             ;;;;;;;;;;;;;;
                    1756     ;                       jb              acc.7,dvm
0A1A C3             1757                             clr             c
0A1B 7F07           1758                             mov             r7,#7
0A1D C3             1759     dvig4:          clr             c
0A1E 13             1760                             rrc             a
0A1F DFFC           1761                             djnz    r7,dvig4 ;        d22
0A21 FA             1762                             mov             r2,a   ;сохр
0A22 18             1763                             dec             r0;     rez_A3
0A23 E6             1764                             mov             a,@r0
                    1765                             ;;;;;
0A24 7F01           1766                             mov             r7,#1
0A26 C3             1767     vig0:           clr             c
0A27 33             1768                             rlc             a
0A28 DFFC           1769                             djnz    r7,vig0 ;         d24..d30
0A2A 4A             1770                             orl             a,r2
0A2B F7             1771                             mov             @r1,a   ; сформ   байт
0A2C 19             1772                             dec             r1
0A2D E6             1773                             mov             a,@r0
                    1774                             ;;;;;
0A2E 20E70C         1775                             jb              acc.7,dvm
0A31 C3             1776                             clr             c
0A32 7F07           1777                             mov             r7,#7
0A34 C3             1778     vig4:           clr             c
0A35 13             1779                             rrc             a
0A36 DFFC           1780                             djnz    r7,vig4 ;         d
0A38 8009           1781                             jmp             endsdv
                    1782     
0A3A 020000   F     1783     rnot1in:                jmp             not1in
                    1784     
                    1785     ;;;;;;;;;;;;                                    
0A3D 7F07           1786     dvm:            mov             r7,#7
0A3F D3             1787     dvig6:          setb            c
0A40 13             1788                             rrc             a
0A41 DFFC           1789                             djnz    r7,dvig6 ;        d31
0A43 F7             1790     endsdv:         mov             @r1,a
                    1791                                                             
                    1792      ;->work   
                    1793                             
0A44 900000   F     1794                             mov             dptr,#chzap
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    29

0A47 120000   F     1795                             call     ldc_long
0A4A 78BB           1796                              mov            r0,#work+3
0A4C 120000   F     1797                             call    ladd
0A4F ED             1798                             mov             a,r5
0A50 F5D5           1799                             mov             DAC1L,a
                    1800                             
0A52 EC             1801                             mov             a,r4
0A53 F5D6           1802                             mov             DAC1H,a
                    1803     
                    1804                                             ;;;;;;;;;;
0A55 78CF           1805                                             mov                     r0,#chbuf       
0A57 120000   F     1806                                             call            resar2  
0A5A 900000   F     1807                                             mov                     dptr,#ch_1       
0A5D 120000   F     1808                                             call            ldc_ltemp
0A60 1201D1         1809                                             call            flsub
0A63 78CF           1810                                             mov                     r0,#chbuf       
0A65 120000   F     1811                                             call            saver2  
0A68 900000   F     1812                                             mov                     dptr,#ch_1
0A6B 120000   F     1813                                             call            ldc_ltemp
0A6E 1201D6         1814                                             call            flcmp
                    1815                                             
                    1816                                             
                    1817                                             
0A71 505D           1818                                             jnc                     nobuf0
0A73 200905         1819                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
0A76 200A04         1820                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0A79 8045           1821                                             jmp             gocikle
                    1822     
0A7B                1823     yesprd: ;передать   A3 в буфер
0A7B 8009           1824                                             jmp             goonT
0A7D                1825     yesbuf:         ;записать   A3 в буфер
0A7D 120000   F     1826                                             call            resa_hl;dptr-
0A80 120000   F     1827                                             call            loA3_X  ;адрес след ячейки внешн оз
                             у храним
                    1828                                                                             ;в ячейке saven_bl
0A83 120000   F     1829                                             call            save_hl
                    1830                                             
0A86 78CD           1831     goonT:                          mov             r0,#interva;high  byte loadr2
0A88 E6             1832                                             mov             a,@r0
0A89 FC             1833                                             mov             r4,a
0A8A 08             1834                                             inc             r0
0A8B E6             1835                                             mov             a,@r0
0A8C FD             1836                                             mov             r5,a
0A8D E4             1837                                             clr             a
0A8E FB             1838                                             mov             r3,a
0A8F FA             1839                                             mov             r2,a                            ;r2
                             ..r5-interval(hex)
0A90 120402         1840                                             call            altof                   ;r2..r5->in
                             terval (float)
                    1841     
0A93 789A           1842                                                                             mov             r0,
                             #parT
0A95 B60110         1843                                                                     cjne    @r0,#1,nott1
                    1844                                     
0A98 900000   F     1845                                     mov                     dptr,#ch_2       
0A9B 120000   F     1846                                     call            ldc_ltemp
0A9E 120203         1847     intmul: call            flmul
0AA1 78CF           1848                                     mov                     r0,#chbuf
0AA3 120000   F     1849                                     call            saver2          ;*2
0AA6 8018           1850                                     jmp             gocikle
                    1851     
0AA8 B60208         1852     nott1:                  cjne    @r0,#2,nott2
0AAB 900000   F     1853                                                     mov                     dptr,#ch_10      
0AAE 120000   F     1854                                     call            ldc_ltemp
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    30

0AB1 80EB           1855                                     jmp                     intmul                             
                                  ;*10
                    1856     
0AB3 B60502         1857     nott2:                  cjne    @r0,#5,nott5
                    1858     
0AB6 8008           1859                                             jmp             gocikle
                    1860     
0AB8 C3             1861     nott5:           clr            c
0AB9 799A           1862                             mov             r1,#parT
0ABB 7404           1863                             mov             a,#4
0ABD 97             1864                             subb    a,@r1
0ABE 500E           1865                             jnc             yestt5          ;T<5
0AC0 300708         1866     gocikle:        jnb             bitzus,nofz;bitbuf,nofz                                 
0AC3 120000   F     1867                             call    z_05s    ;0,5c
0AC6 120000   F     1868                             call    z_05s    ;0,5c
0AC9 C207           1869                             clr     bitzus;bitbuf бит задержки засылки us
0ACB 020000   F     1870     nofz:           jmp     labelA;rebyte
                    1871     
                    1872     
0ACE 80F0           1873     yestt5:         jmp             gocikle
                    1874     
0AD0 78CF           1875     nobuf0:                         mov             r0,#chbuf
0AD2 120000   F     1876                                                             call            resar2
0AD5 900000   F     1877                                                                     mov                     dpt
                             r,#ch_1       
0AD8 120000   F     1878                                     call            ldc_ltemp
0ADB 1201D1         1879                                     call            flsub
0ADE 80E0           1880                                             jmp             gocikle
                    1881     
                    1882     
0AE0 B60205         1883     not1in:                         cjne    @r0,#2,not2in
0AE3 7701           1884                                             mov             @r1,#1           ;T=2
0AE5 020000   F     1885                                             jmp     labelB
                    1886     
0AE8 B60305         1887     not2in:                         cjne    @r0,#3,not3in
0AEB 7702           1888                                             mov             @r1,#2;9                ;T=3
0AED 020000   F     1889                                             jmp     labelB
0AF0 7704           1890     not3in:                         mov             @r1,#4;19
0AF2 020000   F     1891                                             jmp     labelB
                    1892     
                    1893     
                    1894     ;;;;;;;;;;;3.11.06
                    1895     
                    1896     ;;коррекция 0
0AF5 7883           1897     KORnul:         mov             r0,#chdel
0AF7 B60008         1898                             cjne    @r0,#0,nonuldel
                    1899                                     
                    1900                     
0AFA 900000   F     1901                             mov             dptr,#kor0us
0AFD 120000   F     1902                             call    lospus          ;упр слово коррекции 0
0B00 8013           1903                             jmp             chdelmo
                    1904     
0B02                1905     nonuldel:       ;cjne   @r0,#7,no4del
0B02 B60316         1906                                                     cjne    @r0,#3,no4del
                    1907                             ;рез ->AN
0B05 7862           1908                             mov             r0,#rez_A;->r2..r5
0B07 120000   F     1909                             call    resar2
                    1910             
                    1911                                     ;;;;;;;;;;
0B0A 120402         1912                             call    altof           ;r2..r5->float
0B0D 7884           1913                             mov             r0,#kor0_AN;->kor0_AN
0B0F 120000   F     1914                             call    saver2
                    1915                                     
0B12 120000   F     1916                             call    loadUS          ;восстан исходное упр слово
0B15 7883           1917     chdelmo:        mov             r0,#chdel
0B17 06             1918                             inc             @r0             ;chdel+1
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    31

0B18 020000   F     1919                             jmp              rebyte
                    1920     
0B1B                1921     no4del:         ;cjne   @r0,#14,chdelmo
0B1B B606F7         1922                                             cjne    @r0,#6,chdelmo
0B1E 7600           1923                             mov             @r0,#0          ;chdel
0B20 7898           1924                             mov             r0,#chinkor
0B22 7600           1925                             mov             @r0,#00;1;00;02;600;
0B24 08             1926                             inc             r0
0B25 76C8           1927                             mov             @r0,#0c8h;90h;0c8h;58h;258h
0B27 120000   F     1928                             call    clmassix;сбросить массив скольз среднего
0B2A 020000   F     1929                             jmp              rebyte
                    1930     
                    1931     ;автокалибровка
0B2D                1932     autoka:  ;;  mov                r0,#chavt
                    1933                      ;;  call               chcmp
                    1934                      ;;  jz         nulavt
                    1935                     ;;   mov                r1,#chavt
                    1936                     ;;   call               chdec;chavt-1
                    1937                      ;; jmp         rebyte
0B2D                1938     nulavt:  ;;;;;
0B2D 7883           1939                             mov             r0,#chdel
0B2F B6000E         1940                             cjne    @r0,#0,nndelch
0B32 E585           1941                             mov   a,p5
0B34 4404           1942                             orl             a,#04              ;p5.2=1
0B36 00             1943                             nop
0B37 00             1944                             nop
0B38 543F           1945                             anl             a,#3fh          ;p5.6,p5.7=0
0B3A F585           1946                             mov   p5,a
0B3C 06             1947                             inc             @r0
0B3D 020000   F     1948                             jmp              rebyte
                    1949     
0B40 B6033D         1950     nndelch:        cjne    @r0,#3,n4delch
                    1951                             ;pez->A+
                    1952                             ;K+=000/(A+-AN)
                    1953                             ;mov            r0,#rez_A;->r2..r5
                    1954                             ;call   resar2
0B43 E577           1955                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0B45 FA             1956                                     mov             r2,a
0B46 E578           1957                                     mov             a,reacp+1
0B48 FB             1958                                     mov             r3,a
0B49 E579           1959                                     mov             a,reacp+2
0B4B FC             1960                                     mov             r4,a
0B4C E57A           1961                                     mov             a,reacp+3
0B4E FD             1962                                     mov             r5,a
                    1963                                     ;;;;;;;;;;;;;;;
0B4F 120402         1964                             call    altof                   ;r2..r5->float
0B52 7888           1965                             mov             r0,#rezAp;->rezAp
0B54 120000   F     1966                             call    saver2                          
0B57 7884           1967                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0B59 120000   F     1968                             call    resar8                          
0B5C 1201D1         1969                             call    flsub           ; r2..r5(A+-AN)
0B5F 120000   F     1970                             call    move28     ;r2..r5->r8..r11
0B62 900000   F     1971                             mov             dptr,#CH2tho;000->r2..r5 float
0B65 120000   F     1972                             call    ldc_long                
0B68 1202B7         1973                             call    fldiv
0B6B EA             1974                             mov             a,r2
0B6C 547F           1975                             anl             a,#7fh
0B6E FA             1976                             mov             r2,a
0B6F 7890           1977                             mov             r0,#koefKp;->koefKp
0B71 120000   F     1978                             call    saver2
                    1979                       
                    1980                     ;       anl             P5,#0feh                ;p5.0=0 
0B74 E585           1981                     mov             a,P5
0B76 543B           1982                             anl             a,#3bh;acp-
0B78 F585           1983                             mov             P5,a
0B7A 7883           1984                             mov             r0,#chdel
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    32

0B7C 06             1985                             inc             @r0                       ;ch+1
0B7D 020000   F     1986                             jmp             rebyte
                    1987     
0B80 B6063A         1988     n4delch:        cjne    @r0,#6,n8delch
                    1989                             ; pez->A-
                    1990                             ;K-=000/(A--AN)
                    1991                     ;       mov     r0,#rez_A;->r2..r5
                    1992                     ;       call    resar2
0B83 E577           1993                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
0B85 FA             1994                                     mov             r2,a
0B86 E578           1995                                     mov             a,reacp+1
0B88 FB             1996                                     mov             r3,a
0B89 E579           1997                                     mov             a,reacp+2
0B8B FC             1998                                     mov             r4,a
0B8C E57A           1999                                     mov             a,reacp+3
0B8E FD             2000                                     mov             r5,a
                    2001                                     ;;;;;;;;;;;;;;;
0B8F 120402         2002                             call    altof                   ;r2..r5->float
0B92 788C           2003                             mov             r0,#rezAm;->rezAm
0B94 120000   F     2004                             call    saver2                          
0B97 7884           2005                             mov             r0,#kor0_AN;kor0_AN->r8..r11
0B99 120000   F     2006                             call    resar8                          
0B9C 1201D1         2007                             call    flsub                   ; r2..r5(A--AN)
0B9F 120000   F     2008                             call    move28                  ;r2..r5->r8..r11
0BA2 900000   F     2009                             mov             dptr,#CH2tho    ;000->r2..r5 float
0BA5 120000   F     2010                             call    ldc_long                
0BA8 1202B7         2011                             call    fldiv
0BAB EA             2012                             mov             a,r2
0BAC 547F           2013                             anl             a,#7fh
0BAE FA             2014                             mov             r2,a
0BAF 7894           2015                             mov             r0,#koefKm;->koefKm
0BB1 120000   F     2016                             call    saver2
                    2017                        
0BB4 120000   F     2018                             call    loadus
0BB7 7883           2019                             mov             r0,#chdel
0BB9 06             2020                             inc             @r0                       ;ch+1
0BBA 020000   F     2021                        jmp    rebyte
                    2022     
0BBD B6090F         2023     n8delch:        cjne    @r0,#9,n12delch
0BC0 7600           2024                             mov             @r0,#0
0BC2 7981           2025                             mov             r1,#chavt
0BC4 770C           2026                             mov             @r1,#0ch;6;1;
0BC6 09             2027                             inc             r1
0BC7 7780           2028                             mov             @r1,#80h;40h;
0BC9 120000   F     2029                             call   clmassix     ;сбросить массив среднего
0BCC 020000   F     2030                             jmp             rebyte
0BCF 06             2031     n12delch:       inc             @r0
0BD0 020000   F     2032                             jmp             rebyte
                    2033     
                    2034     
                    2035     
                    2036                                 
0BD3 020000   F     2037     rout6:          jmp             out6
0BD6 020000   F     2038     rlabelF:        jmp             labelF  
0BD9 020000   F     2039     rknrazr:        jmp             knrazr  
0BDC 020000   F     2040     rknopt:         jmp             knopt
0BDF 020000   F     2041     rizman:         jmp             izman   
0BE2                2042     keyb1:  ;IE6 
0BE2 75E700         2043                                     mov             EIE2,#00H
                    2044                                     
0BE5 C0E0           2045                                     push    acc
0BE7 C0D0           2046                                     push    psw
0BE9 C000           2047                                     push    rr0
0BEB C001           2048                                     push    rr1
0BED C002           2049                                     push    rr2
0BEF C003           2050                                     push    rr3
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    33

0BF1 C004           2051                                     push    rr4
0BF3 C005           2052                                     push    rr5
0BF5 C006           2053                                     push    rr6
0BF7 C007           2054                                     push    rr7
                    2055                                     ;clr            bitmig
                    2056                       ;;;;;;;;;;;;;;
0BF9 120000   F     2057                                     call    z_01s;0,1s
                    2058                                     ;восстан знакоместо при мигании
                    2059                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0BFC 78B2           2060                                     mov             r0,#marker
0BFE 7440           2061                                     mov             a,#bufind
0C00 26             2062                                     add             a,@r0                   ;a=bufind+marker
0C01 F9             2063                                     mov             r1,a
0C02 A73C           2064                                     mov             @r1,savba
                    2065                                     ;;;;;;;;;;;
0C04 E5B0           2066                             mov             a,p3
0C06 20E644         2067                                     jb              acc.6,outviR;выход из режима выч R
0C09 E5B0           2068     gout6:                          mov             a,p3
0C0B 44FF           2069                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0C0D F5B0           2070                                     mov             p3,a
0C0F E5B0           2071                                     mov             a,p3
0C11 30E6BF         2072                                     jnb             acc.6,rout6             ;error
0C14 3004BF         2073                                     jnb             bitizm,rlabelF
0C17 75B0FE         2074                                     mov             p3,#0feh                ;реж IZM
0C1A E5B0           2075                                     mov             a,p3
0C1C 30E6C0         2076                                     jnb             acc.6,rizman
                    2077                                     ;;;;;;
0C1F 201232         2078                                     jb              bitklb,goklb
0C22 75B0FD         2079                                     mov             p3,#0fdh
0C25 E5B0           2080                                     mov             a,p3
0C27 30E6AF         2081                                     jnb             acc.6,rknrazr             ;labelC
0C2A 75B0FB         2082                                     mov             p3,#0fbh
0C2D E5B0           2083                                     mov             a,p3
0C2F 30E649         2084                                     jnb             acc.6,knright           ;->
0C32 75B0F7         2085                                     mov             p3,#0f7h
0C35 E5B0           2086                                     mov             a,p3
0C37 30E6A2         2087                                     jnb             acc.6,rknopt                    ;T
0C3A 75B0EF         2088                                     mov             p3,#0efh
0C3D E5B0           2089                                mov          a,p3
0C3F 30E615         2090                                     jnb             acc.6,pyskst                    ;pysk/stop
0C42 75B0DF         2091                                     mov             p3,#0dfh
0C45 E5B0           2092                                     mov             a,p3
0C47 30E64D         2093                                jnb          acc.6,knvich
0C4A 020000   F     2094                                     jmp             izmpaT
                    2095     
0C4D 3006B9         2096     outviR: jnb             bitvi11,gout6   
0C50 C214           2097                                     clr             bitvich                         ;выход из р
                             ежима выч R  
0C52 C206           2098                                     clr             bitvi11
                    2099                                     
0C54 020000   F     2100     goklb:          jmp             out6
                    2101     
0C57 200A0C         2102     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0C5A D20A           2103                                     setb    bitbon  ;уст реж буфер вкл
0C5C 79D5           2104                                     mov                     r1,#volume;work         ;обьем блок
                             а
0C5E 7700           2105                                     mov                     @r1,#00
0C60 09             2106                                     inc                     r1
0C61 77C7           2107                                     mov                     @r1,#0c7h                       ;32
                             0h/4
0C63 020000   F     2108                                     jmp             izmpaT
0C66 C20A           2109     bufon:                  clr             bitbon  ;уст реж буфер выкл
0C68 020000   F     2110                                     jmp             izmpaT
                    2111     
0C6B 79B0           2112     tizmri:                 mov             r1,#level
0C6D B70102         2113                                     cjne    @r1,#1,right2
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    34

                    2114                                     ;10s->HET
0C70 8004           2115                                     jmp             right3
                    2116     
0C72 07             2117     right2:                 inc             @r1
0C73 120000   F     2118                                     call    lolevT
                    2119                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0C76 120000   F     2120     right3:                 call    ind
0C79 806D           2121                                     jmp             izmfun
                    2122     
                    2123                             
                    2124                             
0C7B                2125     knright:        
                    2126     
0C7B 79AE           2127                                     mov             r1,#diap
                    2128                             ;перекл диапазон 1 поз вверх сбр массив
0C7D 17             2129                                     dec             @r1
0C7E B7FF04         2130                                     cjne    @r1,#0ffh,diinc
0C81 7700           2131                                     mov             @r1,#0
0C83 8063           2132                                     jmp  izmfun
0C85 120000   F     2133     diinc:                  call     clmassix
0C88 78B3           2134                                     mov             r0,#summa
0C8A 120000   F     2135                                     call    clear4
0C8D 786A           2136                                     mov             r0,#rez_A0
0C8F 120000   F     2137                                     call    clear4  
0C92 120000   F     2138                                     call    loadUS
0C95 8051           2139                                      jmp  izmfun
                    2140     
0C97 200613         2141     knvich:            jb           bitvi11,onvich
0C9A C204           2142                                     clr             bitizm
0C9C D214           2143                                     setb    bitvich
                    2144                                     
0C9E 78B1           2145                                     mov             r0,#vichR
0CA0 7611           2146                                     mov             @r0,#11h;;????????or 0
                    2147                                     ;ВЫЧИСЛИТЬ
0CA2 900000   F     2148                                     mov     dptr,#teVICH
0CA5 120000   F     2149                                     call    lotext
0CA8 120000   F     2150                                call         z_1s;;;;;;;
0CAB 806C           2151                                     jmp              viout;izmpaT
                    2152     
0CAD C214           2153     onvich:                 clr             bitvich
0CAF 78B1           2154                                     mov             r0,#vichR
0CB1 7600           2155                                     mov             @r0,#0
0CB3 8037           2156                                     jmp              izmpaT
                    2157     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0CB5 301820         2158     louizm:            jnb          knizm,lou
0CB8 79AE           2159                                     mov             r1,#diap
0CBA C3             2160                                     clr             c
0CBB 7403           2161                                     mov             a,#3
0CBD 97             2162                                     subb    a,@r1
0CBE 5006           2163                                     jnc             lldi23    ;10-2..10-5
                    2164                                     ;10-6..10-11
0CC0 E584           2165                                     mov             a,p4
0CC2 54F7           2166                                     anl             a,#0f7h   ;d3
0CC4 F584           2167                                     mov             p4,a
0CC6 E7             2168     lldi23:                 mov             a,@r1
0CC7 6403           2169                                     xrl             a,#3
0CC9 7002           2170                                     jnz             lldi3
0CCB 8005           2171                                     jmp             lldi2   ;10-5
0CCD E7             2172     lldi3:                  mov             a,@r1
0CCE 6402           2173                                     xrl             a,#2            ;
0CD0 7006           2174                                     jnz             lou             
0CD2 E585           2175     lldi2:                  mov             a,p5            ;10-4
0CD4 4408           2176                                     orl             a,#08
0CD6 F585           2177                                     mov             p5,a
0CD8 22             2178     lou:                    ret
                    2179                               ;;;;;;
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    35

0CD9 201807         2180     izman:                  jb              knizm,knizmon
0CDC D218           2181                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2182                             ;       d3(k5 p4),d3(u5 p5)заслать us
0CDE 120000   F     2183                                     call    louizm 
0CE1 8005           2184                                     jmp             izmfun
0CE3 C218           2185     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0CE5 120000   F     2186                                     call    loadUS;восстановить us
0CE8                2187     izmfun:                 
0CE8 D207           2188                                     setb    bitzus;bitbuf
0CEA 8000           2189                                     jmp             labelE;;;;;;;;;;;;
                    2190                                     ;;;;;;;;;;;;;;
0CEC                2191     izmpaT:
                    2192     ;;;;;;;;;;;;;;;;;
                    2193                     ;       clr             c 
                    2194                     ;       mov             r1,#parN
                    2195     
                    2196                     ;       mov             r0,#diap
                    2197                     ;       mov             a,#6            
                    2198                     ;       subb    a,@r0
                    2199                     ;       jnc             labelE          ;         ;10-2..10-8
                    2200                               
                    2201                     ;       mov             @r1,#2          ;10-9..10-11            
                    2202                     ;       jmp             labelE
                    2203     
                    2204     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0CEC 789A           2205     labelE:                 mov             r0,#parT
0CEE 793D           2206                                     mov             r1,#chkl
0CF0 B60108         2207                                     cjne    @r0,#1,izmt2
0CF3 7700           2208                                     mov             @r1,#0
0CF5 09             2209                                     inc             r1
0CF6 7702           2210                                     mov             @r1,#2
0CF8 020000   F     2211                                     jmp             out6
0CFB B60208         2212     izmt2:                  cjne    @r0,#2,izmt3
0CFE 7700           2213                                     mov             @r1,#0
0D00 09             2214                                     inc             r1
0D01 7714           2215                                     mov             @r1,#20
0D03 020000   F     2216                                     jmp             out6
                    2217     
0D06 7700           2218     izmt3:                  mov             @r1,#0
0D08 09             2219                                     inc             r1
0D09 77C8           2220                                     mov             @r1,#200
0D0B 020000   F     2221                                     jmp             out6
                    2222     
                    2223     
                    2224     
                    2225     
0D0E                2226     knopt: ;кнопка T
0D0E C204           2227                                clr          bitizm
0D10 D210           2228                                setb         bitt2
0D12 79B7           2229                                mov          r1,#load
0D14 7704           2230                                mov          @r1,#4;1s
0D16 120000   F     2231                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2232                                
                    2233     
0D19 793D           2234     viout:          mov             r1,#chkl
0D1B 7703           2235                             mov             @r1,#03
0D1D 09             2236                             inc             r1
0D1E 77E8           2237                             mov             @r1,#0e8h               ;1000
0D20 020000   F     2238                             jmp             out6
                    2239     
0D23                2240     knrazr:          
0D23 C3             2241     labelC:          clr            c
0D24 78AF           2242                             mov             r0,#parN
0D26 799A           2243                             mov             r1,#parT
0D28 7402           2244                             mov             a,#2
0D2A 97             2245                             subb    a,@r1
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    36

0D2B 40BF           2246                             jc              labelE          ;T>2
0D2D B60104         2247                             cjne    @r0,#1,noN1c
0D30 7602           2248                             mov             @r0,#2          ;N=2
0D32 80B8           2249                             jmp             labelE
                    2250     
0D34 B60204         2251     noN1c:          cjne    @r0,#2,not_1
0D37 7603           2252                             mov             @r0,#3          ;N=3      ;10-2..10-8
0D39 80B1           2253                             jmp             labelE
                    2254     
0D3B                2255     not_10: 
0D3B 7601           2256     not_1:          mov             @r0,#1                          ;N=1
0D3D 80AD           2257                             jmp     labelE
                    2258     
0D3F 020000   F     2259     rtizmri:        jmp             tizmri
0D42                2260     labelf:                 
0D42 301037         2261                             jnb             bitt2,nofizm
0D45 75B0FB         2262                        mov          p3,#0fbh
0D48 E5B0           2263                        mov          a,p3
0D4A 20E60F         2264                        jb           acc.6,outF
0D4D 79B7           2265                        mov          r1,#load;parT
0D4F B70503         2266                        cjne         @r1,#5,noft1
                    2267                        ;t=10s
0D52 020000   F     2268                        jmp          out6;ft1izm
                    2269     
0D55 07             2270     noft1:     inc          @r1;dec         @r1
0D56 120000   F     2271     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
                    2272                             ;call   ind
0D59 020000   F     2273                     jmp             out6;??????????????/
                    2274     
                    2275                             ;увеличить счетчик задержки клавиатуры
0D5C 783D           2276     outF:           mov             r0,#chkl
0D5E 7627           2277                             mov             @r0,#27h
0D60 08             2278                             inc             r0
0D61 7610           2279                             mov             @r0,#10h
0D63 020000   F     2280                             jmp             out6;out7
                    2281     
0D66 020000   F     2282     noviR1:         jmp             noviR
0D69 78B1           2283     outvich:        mov                     r0,#vichR
0D6B 7600           2284                                             mov                     @r0,#0
0D6D C214           2285                                             clr                     bitvich
0D6F C206           2286                                             clr                     bitvi11
0D71 C211           2287                                             clr                     bitmenu
0D73 D204           2288                                             setb            bitizm
0D75 78B2           2289                                             mov                     r0,#marker
0D77 76FF           2290                                             mov                     @r0,#0ffh
0D79 020000   F     2291                                             jmp                     out6    
                    2292     
0D7C 3014E7         2293     nofizm:         jnb             bitvich,noviR1
0D7F 75B0DF         2294                                                     mov             p3,#0dfh
0D82 30B6E4         2295                                                     jnb             p3.6,outvich;отжатие кнопки
                              вычR
0D85 78B1           2296                             mov             r0,#vichR
0D87 B61110         2297                             cjne    @r0,#11h,no11v6
0D8A 75B0FB         2298                             mov                     p3,#0fbh;->
0D8D 20B6CC         2299                             jb                      p3.6,outF
0D90 7612           2300                             mov             @r0,#12h                ;11= вычислить
0D92 900000   F     2301     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0D95 120000   F     2302                             call    lotext
0D98 80C2           2303                             jmp             outF
                    2304             
0D9A B61210         2305     no11v6:         cjne    @r0,#12h,no12v6
0D9D 75B0FB         2306                             mov             p3,#0fbh;->
0DA0 20B6B9         2307                             jb              p3.6,outF
0DA3 7613           2308                             mov             @r0,#13h
0DA5 900000   F     2309                             mov             dptr,#teOUT
0DA8 120000   F     2310                             call    lotext
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    37

0DAB 80AF           2311                             jmp             outF
                    2312                     
0DAD B61310         2313     no12v6:         cjne    @r0,#13h,no13v6
0DB0 75B0FB         2314                                                     mov             p3,#0fbh;->
0DB3 20B6A6         2315                             jb              p3.6,outF
0DB6 7611           2316                             mov             @r0,#11h
0DB8 900000   F     2317                             mov             dptr,#teVICH
0DBB 120000   F     2318                             call    lotext
0DBE 809C           2319                             jmp             outF
                    2320     
                    2321     ;кн -> A= 0000
                    2322     ;кн -> B= +00000
0DC0 75B0FB         2323     no13v6:         mov             p3,#0fbh
0DC3 E5B0           2324                             mov             a,p3
0DC5 20E635         2325                             jb              acc.6,chanZ
0DC8 E53B           2326                             mov             a,movrig
0DCA B40714         2327                             cjne    a,#7,kon_B      
0DCD 78B2           2328                             mov             r0,#marker      ;A= 0000
0DCF B60716         2329                             cjne    @r0,#7,mark0_8          ;курсор справа ?
0DD2 E53A           2330     rikn:           mov             a,movleft
0DD4 F6             2331                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2332     ;                               29.12.06
                    2333     ;;;;;;;;;;;;;;;;;;
                    2334     ;необходимо не портить цифру в следуюем справа знакоместе
                    2335     ;т е сохранить ее в ячейке для мигания в противном случае
                    2336     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2337     ;       знакоместа
0DD5 78B2           2338                                     mov             r0,#marker
0DD7 7440           2339                                     mov             a,#bufind
0DD9 26             2340                                             add             a,@r0                   ;a=bufind+m
                             arker
0DDA F9             2341                                             mov             r1,a
0DDB 09             2342                                             inc             r1
0DDC 873C           2343                                             mov             savba,@r1
0DDE 020000   F     2344                                     jmp             outF
                    2345     
0DE1 78B2           2346     kon_B:          mov             r0,#marker      ;B= +00000
0DE3 B60802         2347                                             cjne    @r0,#8,mark0_8          ;курсор справа ?
0DE6 80EA           2348                                             jmp             rikn
0DE8                2349     mark0_8:
                    2350     ;                               29.12.06
                    2351     ;;;;;;;;;;;;;;;;;;
                    2352     ;необходимо не портить цифру в следуюем справа знакоместе
                    2353     ;т е сохранить ее в ячейке для мигания в противном случае
                    2354     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2355     ;       знакоместа ->B=+00000
0DE8 78B2           2356                                             mov             r0,#marker
0DEA 7440           2357                                     mov             a,#bufind
0DEC 26             2358                                             add             a,@r0                   ;a=bufind+m
                             arker
0DED F9             2359                                             mov             r1,a
0DEE 09             2360                                             inc             r1
0DEF 873C           2361                                             mov             savba,@r1
0DF1 78B2           2362                             mov             r0,#marker
0DF3 06             2363                             inc             @r0             ;       сдвинуть курсор вправо на 1
0DF4 C219           2364                             clr             bitmig
0DF6 B60901         2365                             cjne    @r0,#9,outma
0DF9 18             2366                             dec             r0;ppp
0DFA 020000   F     2367     outma:          jmp             outF
                    2368     
0DFD 75B0FE         2369     chanZ:          mov             p3,#0feh
0E00 E5B0           2370                             mov             a,p3
0E02 20E611         2371                             jb              acc.6,chanma
                    2372                             ;изм знак в старшем разряде на противоположн
0E05 E543           2373                             mov             a,bufind+3
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    38

0E07 B42B06         2374                             cjne            a,#2bh,noplus
0E0A 75432D         2375                             mov                     bufind+3,#2dh           ;+->-   
0E0D 020000   F     2376                             jmp             outF
0E10                2377     noplus:
0E10 75432B         2378                             mov                     bufind+3,#2bh           ;-/+-
0E13 020000   F     2379                             jmp             outF
0E16 75B0FD         2380     chanma:         mov             p3,#0fdh
0E19 E5B0           2381                             mov             a,p3
0E1B 20E603         2382                             jb              acc.6,outFl;labelL1
                    2383                             ;clr            bitmig
0E1E 120000   F     2384     labelL1:        call    vvchibl;f       ;увеличить цифру 
                    2385     
0E21 020000   F     2386     outFl:                  jmp             outF
                    2387                     
0E24                2388     nor11:          ;       выход
0E24 7613           2389                     mov             @r0,#13h  ;12->13
0E26 900000   F     2390                     mov             dptr,#teOUT
                    2391     ;               jmp             vi1113
                    2392     
                    2393     ;;;;;;;;;кнопка -> в режиме кнопки меню
                    2394     
                    2395     ;yesviR:                clr             bitvi11;????????/
                    2396     ;                       jb              bmem11,rlabelL
                    2397     ;                       jmp             out6;???????//
                    2398     
0E29 020000   F     2399     rlabelL:        jmp                     labelL
                    2400     ;findmem:               jmp             out6
0E2C 301171         2401     noviR:          jnb                     bitmenu,findmem;17.01.07
                    2402     ;;;;;;;;;;;;;
0E2F 78B1           2403                                             mov                     r0,#vichR
0E31 7415           2404                                             mov                     a,#15h
0E33 C3             2405                                             clr                     c
0E34 96             2406                                             subb            a,@r0
0E35 4016           2407                                             jc                      ri21_23
                    2408     
0E37 75B0FB         2409                                             mov             p3,#0fbh; реж кн меню ->
0E3A 20B60A         2410                                             jb              p3.6,ri6
0E3D 78B1           2411                                             mov             r0,#vichR
0E3F B61508         2412                                             cjne    @r0,#15h,norime
0E42 7611           2413                                             mov             @r0,#11h
0E44 120000   F     2414     norime1:        call            lomenu
0E47 020000   F     2415     ri6:                    jmp             out6
0E4A 06             2416     norime:         inc             @r0
0E4B 80F7           2417                                             jmp             norime1
                    2418             
0E4D 7423           2419     ri21_23:        mov                     a,#23h          ;->
0E4F C3             2420                                             clr                     c
0E50 96             2421                                             subb            a,@r0
0E51 4014           2422                                             jc                      ri_31
0E53 75B0FB         2423                                             mov                     p3,#0fbh
0E56 20B6EE         2424                                             jb                      p3.6,ri6
0E59 B62308         2425                                             cjne            @r0,#23h,no23ri
0E5C 7621           2426                                             mov                     @r0,#21h
0E5E 120000   F     2427                                             call            lomenu
0E61 020000   F     2428                                             jmp                     out6
0E64 06             2429     no23ri:         inc                     @r0
0E65 80DD           2430                                             jmp                     norime1
0E67 B63119         2431     ri_31:          cjne            @r0,#31h,no31ri;->19.2->57.6->19.2
0E6A 30130B         2432                                             jnb                     bitv19,gosk19
0E6D 900000   F     2433                                             mov                     dptr,#teS57_6;57,6
0E70 120000   F     2434                                             call            lotext
0E73 C213           2435                                             clr                     bitv19
0E75 020000   F     2436                                             jmp             out6
0E78 900000   F     2437     gosk19:         mov                     dptr,#teS19_2
0E7B 120000   F     2438                                             call            lotext
0E7E D213           2439                                             setb            bitv19
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    39

0E80 020000   F     2440                                             jmp                     out6
                    2441     
                    2442     
                    2443     
                    2444     ;labelS2:       jmp                     out6
                    2445     
0E83 7452           2446     no31ri:         mov                     a,#52h;42h              ;->
0E85 C3             2447                                             clr                     c
0E86 96             2448                                             subb            a,@r0
0E87 40BE           2449                                             jc                      ri6
0E89 75B0FB         2450                                             mov                     p3,#0fbh                   
                                  ;41,42
0E8C 30B608         2451                                             jnb                     p3.6,rlabelN    ;кнопка ->(
                             пароль 000)
0E8F 75B0FD         2452                                             mov                     p3,#0fdh
0E92 20B6B2         2453                                             jb                      p3.6,ri6
0E95 8087           2454                                             jmp             labelL1                            
                                  ;кнопка 0..9  (пароль 000)
0E97 020000   F     2455     rlabelN:                jmp             labelN
0E9A 020000   F     2456     moutF:          jmp             outF
                    2457     ;;;;;;;;;;;;;;;;;;;;;;;;;
0E9D 020000   F     2458     rnnmemb:        jmp             nnmemb
                    2459     
0EA0                2460     nbimenu:
0EA0 300BFA         2461     findmem:        jnb             bitmem,rnnmemb
0EA3 79B0           2462                             mov             r1,#level                                          
                                          ;-> кн ПАМЯТЬ (ОЧИСТКА ->ЗАПИСЬ-> ПРОСМОТР)
0EA5 B71113         2463                        cjne         @r1,#11h,nomem11
                    2464                        
0EA8 75B0FB         2465                        mov          p3,#0fbh
0EAB E5B0           2466                        mov          a,p3
0EAD 20E6EA         2467                        jb           acc.6,moutF
0EB0 7712           2468                        mov          @r1,#12h
0EB2 900000   F     2469                        mov          dptr,#teWR      ;                       ЗАПИСЬ
0EB5 120000   F     2470                        call         lotext
0EB8 020000   F     2471                        jmp          outF
                    2472     
0EBB B71213         2473     nomem11:   cjne         @r1,#12h,nomem12
0EBE 75B0FB         2474                             mov             p3,#0fbh
0EC1 E5B0           2475                        mov          a,p3
0EC3 20E6D4         2476                        jb           acc.6,moutF
0EC6 7713           2477                        mov          @r1,#13h
0EC8 900000   F     2478                        mov          dptr,#teLIST            ;ПРОСМОТР
0ECB 120000   F     2479                        call         lotext
0ECE 020000   F     2480                        jmp          outF
0ED1 B71313         2481     nomem12:         cjne           @r1,#13h,nomem13
0ED4 75B0FB         2482                                             mov             p3,#0fbh
0ED7 E5B0           2483                        mov          a,p3
0ED9 20E6BE         2484                        jb           acc.6,moutF
0EDC 7714           2485                        mov          @r1,#14h
0EDE 900000   F     2486                        mov          dptr,#teSTAT                    ;СТАТИСТИКА
0EE1 120000   F     2487                        call         lotext
0EE4 020000   F     2488                          jmp                outF
                    2489                             
0EE7 B71413         2490     nomem13:cjne            @r1,#14h,labelL
0EEA 75B0FB         2491                             mov             p3,#0fbh
0EED E5B0           2492                        mov          a,p3
0EEF 20E6A8         2493                        jb           acc.6,moutF
0EF2 7711           2494                        mov          @r1,#11h
0EF4 900000   F     2495                        mov          dptr,#teCLE                     ;ОЧИСТКА
0EF7 120000   F     2496                        call         lotext
0EFA 020000   F     2497                          jmp                outF
0EFD                2498     labelL: 
                    2499                             ;ПОЛНАЯ->БЛОК 00(level 21->22) 
0EFD 78B0           2500                                     mov                     r0,#level
0EFF B6210E         2501                                     cjne            @r0,#21h,nobl21
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    40

0F02 7622           2502                                     mov                     @r0,#22h                ;->БЛОК 
0F04 900000   F     2503                                     mov                     dptr,#teBL
0F07 120000   F     2504     me21_22:call            lotext
0F0A 120000   F     2505                                     call            z_05s;задержка чтобы не проскакивала пргр н
                             а следующий уровень
0F0D 020000   F     2506                                     jmp                     outF
                    2507     
0F10 B62207         2508     nobl21: cjne            @r0,#22h,nobl22
0F13 900000   F     2509                                     mov                     dptr,#teFULL
0F16 7621           2510                                     mov                     @r0,#21h                ;->ПОЛНАЯ
                    2511     
0F18 80ED           2512                                     jmp                     me21_22
                    2513     
                    2514     ;labl21:           cjne @r0,#21h,nolev1
                    2515     ;                       mov             p3,#0fbh
                    2516     ;                       mov             a,p3
                    2517     ;                       jb              acc.6,loutF
                    2518     ;                       cjne    @r0,#21h,labl22
                    2519     ;                       mov             @r0,#22h
                    2520                             ;БЛОК
                    2521     ;                       call    lotext
                    2522     ;                       jmp             outF
                    2523     ;labl22:                mov             @r0,#21h
                    2524                             ;ПОЛНАЯ
                    2525     ;                       call    lotext
                    2526     ;                       jmp             outF
                    2527                      
0F1A B62325         2528     nobl22:         cjne    @r0,#23h,go31l
0F1D 75B0FB         2529     rigblo:         mov             p3,#0fbh
0F20 20B629         2530                                             jb              p3.6,llev2
0F23                2531     labL2:    ;  уст курсор в правую позицию 
                    2532                                     ;       кнопка                  ->
                    2533     ;;;;;;;;;;;;;;;;;;
                    2534     ;необходимо не портить цифру в следуюем справа знакоместе
                    2535     ;т е сохранить ее в ячейке для мигания в противном случае
                    2536     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2537     ;       знакоместа
0F23 78B2           2538                                             mov             r0,#marker
0F25 7440           2539                                     mov             a,#bufind
0F27 26             2540                                             add             a,@r0                   ;a=bufind+m
                             arker
0F28 F9             2541                                             mov             r1,a
0F29 09             2542                                             inc             r1
0F2A 873C           2543                                             mov             savba,@r1
0F2C C219           2544                                             clr             bitmig
                    2545     ;;;;;;;;;;;;;;;;
0F2E 78B2           2546                       mov           r0,#marker      ;курсор справа  ?
0F30 E53B           2547                             mov             a,movrig
0F32 C3             2548                             clr             c
0F33 96             2549                             subb    a,@r0
0F34 6006           2550                             jz         equ1l
0F36 E53B           2551                             mov             a,movrig;уст в правую позицию
0F38 F6             2552                             mov             @r0,a
0F39 020000   F     2553                             jmp             outF                                     
0F3C E53A           2554     equ1l:          mov             a,movleft;уст в левую позицию
0F3E F6             2555                             mov             @r0,a   
0F3F 020000   F     2556     loutF:  jmp             outF
                    2557                     
                    2558     
0F42 B63102         2559     go31l:          cjne    @r0,#31h,go41l
0F45 80D6           2560                             jmp             rigblo
0F47 B6410B         2561     go41l:          cjne    @r0,#41h,norig2
0F4A 80D1           2562                             jmp             rigblo
                    2563     
0F4C 75B0FD         2564     llev2:          mov             p3,#0fdh
0F4F 20B6ED         2565                             jb              p3.6,loutF
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    41

0F52 020000   F     2566                             jmp             labelL1
                    2567     
                    2568     ;->
0F55 C3             2569     norig2:    clr          c               ;32,33,34,42
0F56 7431           2570                             mov             a,#31h
0F58 96             2571                             subb    a,@r0
0F59 50E4           2572                             jnc             loutF
0F5B 75B0FB         2573     rigblok:        mov             p3,#0fbh  ;32,33,34,42
0F5E 20B626         2574                             jb              p3.6,lev2go
0F61                2575     labelN: 
                    2576                             ;                               29.12.06
                    2577     ;;;;;;;;;;;;;;;;;;
                    2578     ;необходимо не портить цифру в следуюем справа знакоместе
                    2579     ;т е сохранить ее в ячейке для мигания в противном случае
                    2580     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2581     ;       знакоместа
0F61 78B2           2582                                             mov             r0,#marker
0F63 7440           2583                                     mov             a,#bufind
0F65 26             2584                                             add             a,@r0                   ;a=bufind+m
                             arker
0F66 F9             2585                                             mov             r1,a
0F67 09             2586                                             inc             r1
0F68 873C           2587                                             mov             savba,@r1
                    2588     ;;;;;;;;;;;;;;;;;;;
0F6A 78B2           2589                             mov             r0,#marker      ;курсор справа  ?
0F6C E53B           2590                             mov             a,movrig
0F6E C3             2591                             clr             c
0F6F 96             2592                             subb    a,@r0
0F70 7006           2593                             jnz        noequ1
0F72 E53A           2594                             mov             a,movleft;уст в крайнюю левую позицию
0F74 F6             2595                             mov             @r0,a
0F75 020000   F     2596                             jmp             outF
0F78                2597     noequ1: ;29.12.06
                    2598     ;;;;;;;;;;;;;;;;;;
                    2599                             ;восстан знакоместо при мигании
                    2600                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0F78 78B2           2601                                     mov             r0,#marker
0F7A 7440           2602                                     mov             a,#bufind
0F7C 26             2603                                     add             a,@r0                   ;a=bufind+marker
0F7D F9             2604                                     mov             r1,a
                    2605                                     ;mov            @r1,savba
0F7E 09             2606                                     inc             r1
0F7F 873C           2607                                     mov             savba,@r1
                    2608     ;;;;;;;;;;;;;;;;        
0F81 120000   F     2609                             call    marri;уст сдвиг в правую        позицию
0F84 020000   F     2610                             jmp             outF
0F87 75B0FD         2611     lev2go:         mov             p3,#0fdh
0F8A 30B603         2612                             jnb             p3.6,rlabelL1
0F8D 020000   F     2613                             jmp             outF
                    2614     
0F90 020000   F     2615     rlabelL1:       jmp             labelL1
                    2616     
0F93                2617     nnmemb:
                    2618                                     
                    2619     
                    2620     
0F93                2621     norim6:    ;kn menu
0F93                2622     out6:           
0F93 D007           2623                                     pop             rr7     
0F95 D006           2624                                     pop             rr6
0F97 D005           2625                                     pop             rr5
0F99 D004           2626                                     pop             rr4
0F9B D003           2627                                     pop             rr3
0F9D D002           2628                                     pop             rr2
0F9F D001           2629                                     pop             rr1                             
0FA1 D000           2630                                     pop             rr0
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    42

0FA3 D0D0           2631                                     pop             psw
0FA5 D0E0           2632                                     pop             acc
                    2633     ;clr            bitmig
0FA7 75E730         2634                                mov          EIE2,#30H
0FAA E5AD           2635                                mov          a,P3IF
0FAC 54BF           2636                                     anl             a,#0bfh
0FAE F5AD           2637                                     mov             P3IF,a
0FB0 75B0C0         2638                                     mov             P3,#0c0h
0FB3 C219           2639     clr             bitmig
0FB5 32             2640                             reti
                    2641     
0FB6 020000   F     2642     rknMEM:                 jmp             knMEM
0FB9 020000   F     2643     knKMP:             jmp          out7
0FBC 020000   F     2644     rout7:                  jmp             out7    
0FBF 020000   F     2645     rlabelH:                jmp             labelH
0FC2 020000   F     2646     rknNUL:         jmp             knNUL
0FC5 020000   F     2647     rknleft:                jmp             knleft
0FC8                2648     keyb2:  ;IE7
0FC8 75E700         2649                                     mov             EIE2,#00H
0FCB C0E0           2650                                     push    acc
0FCD C0D0           2651                                     push    psw
0FCF C000           2652                                     push    rr0
0FD1 C001           2653                                     push    rr1
0FD3 C002           2654                                     push    rr2
0FD5 C003           2655                                     push    rr3
0FD7 C004           2656                                     push    rr4
0FD9 C005           2657                                     push    rr5
0FDB C006           2658                                     push    rr6
0FDD C007           2659                                     push    rr7
0FDF C082           2660                                     push    dpl
0FE1 C083           2661                                     push    dph
                    2662                                     ;clr            bitmig
                    2663                       ;;;;;;;;;;;;;;
0FE3 120000   F     2664                               call  z_01s   ;0,1s
                    2665                               ;восстан знакоместо при мигании
                    2666                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0FE6 78B2           2667                                     mov             r0,#marker
0FE8 7440           2668                                     mov             a,#bufind
0FEA 26             2669                                     add             a,@r0                   ;a=bufind+marker
0FEB F9             2670                                     mov             r1,a
0FEC A73C           2671                                     mov             @r1,savba
                    2672                                     ;;;;;;;;;;;
                    2673     
0FEE E5B0           2674                             mov             a,p3
0FF0 20E7C9         2675                                     jb              acc.7,rout7
0FF3 E5B0           2676                                     mov             a,p3
0FF5 74FF           2677                                     mov             a,#0ffh         ; p3.(5-0)<-3f
0FF7 F5B0           2678                                     mov             p3,a
0FF9 E5B0           2679                                     mov             a,p3
0FFB 30E7BE         2680                                     jnb             acc.7,rout7             ;error
0FFE 3004BE         2681                                     jnb             bitizm,rlabelH
1001 75B0FE         2682                                     mov             p3,#0feh                ;реж IZM
1004 E5B0           2683                                     mov             a,p3
1006 30E7B9         2684                                     jnb             acc.7,rknNUL
1009 75B0FD         2685                                     mov             p3,#0fdh
100C E5B0           2686                                     mov             a,p3
100E 30E7A8         2687                                     jnb             acc.7,knKMP
1011 75B0FB         2688                                     mov             p3,#0fbh
1014 E5B0           2689                                     mov             a,p3
1016 30E7AC         2690                                     jnb             acc.7,rknleft
1019 75B0F7         2691                                     mov             p3,#0f7h
101C E5B0           2692                                     mov             a,p3
101E 30E75B         2693                                     jnb             acc.7,knAVP
1021 75B0EF         2694                                 mov         p3,#0efh
1024 E5B0           2695                                     mov             a,p3
1026 30E78D         2696                                     jnb             acc.7,rknMEM
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    43

1029 75B0DF         2697                                     mov             p3,#0dfh
102C E5B0           2698                                     mov             a,p3    
102E 30E722         2699                                     jnb             acc.7,knmenu
1031                2700     an_t7:             ;;;;;;;;;;;;
                    2701                     
                    2702     ;       clr             c
                    2703     ;       mov             r1,#parN
                    2704     ;
                    2705     ;                       mov             r0,#diap
                    2706     ;                       mov             a,#6            
                    2707     ;                       subb    a,@r0
                    2708     ;                       jnc             goto7           ;         ;10-2..10-8
                    2709                               
                    2710     ;                       mov             @r1,#2          ;10-9..10-11            
                    2711                             
                    2712                             ;;;;;;;;;;;;
1031 799A           2713     goto7:                  mov             r1,#parT
1033 783D           2714                                     mov             r0,#chkl
1035 B70108         2715                                     cjne    @r1,#1,not1_7
1038 7600           2716                                     mov             @r0,#00
103A 08             2717                                     inc             r0
103B 7602           2718                                     mov             @r0,#2
103D 020000   F     2719                                     jmp             out7
                    2720                             
                    2721     
1040 B70208         2722     not1_7:                 cjne    @r1,#2,not2_7
1043 760E           2723                                             mov             @r0,#0eh;00
1045 08             2724                                     inc             r0
1046 7638           2725                                     mov             @r0,#38h;20
1048 020000   F     2726                                     jmp             out7
104B 7600           2727     not2_7:                 mov             @r0,#00
104D 08             2728                                     inc             r0
104E 76C8           2729                                     mov             @r0,#200
1050 020000   F     2730     merr:           jmp             out7
                    2731     
                    2732     
1053 2006FA         2733     knmenu: jb              bitvi11,merr
1056 201511         2734                                     jb              biteizm,menuoff
1059 C204           2735                              clr            bitizm          ;off IZM
105B D211           2736                                     setb            bitmenu
105D 900000   F     2737                                     mov             dptr,#teTESI    ;в буф2 записать ТЕСТ-ИЗМЕР
1060 120000   F     2738                                     call    lotext
                    2739                                     
1063 78B1           2740                                     mov             r0,#vichR
1065 7611           2741                                     mov             @r0,#11h
1067 020000   F     2742                                     jmp             onmem11
106A                2743     menuoff:
106A 78B1           2744                                     mov             r0,#vichR
106C 7600           2745                                     mov             @r0,#00
106E C215           2746                                     clr             biteizm
1070 120000   F     2747                                     call    loadus
1073 020000   F     2748                                     jmp             out7
1076 75EF10         2749                                     mov             RSTSRC,#10h
                    2750                                     ;jmp            begin;onmem11
                    2751     
1079 020000   F     2752     rendkalib:              jmp             endkalib
                    2753     
107C 2012FA         2754     knAVP:  jb              bitklb,rendkalib        
107F 200505         2755                                     jb              bitavp,meavp
1082 D205           2756                                     setb    bitavp
1084 020000   F     2757                                     jmp             onmem11
1087 C205           2758     meavp:                  clr             bitavp
1089 020000   F     2759                                     jmp             onmem11
                    2760     
108C 201207         2761     knleft: jb              bitklb,lefkl
                    2762                                     ;;;;;;;;
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    44

108F 79AE           2763                                mov          r1,#diap
1091 07             2764                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
1092 B70A03         2765                                     cjne    @r1,#0ah,nodi6
1095 17             2766                                     dec             @r1
1096 8099           2767     lefkl:  jmp             an_t7
                    2768     
1098                2769     nodi6:             ;    cjne    @r1,#0,an_t7
1098 120000   F     2770                                      call    clmassix
109B 78B3           2771                                     mov             r0,#summa
109D 120000   F     2772                                     call    clear4  
10A0 786A           2773                                     mov             r0,#rez_A0
10A2 120000   F     2774                                     call    clear4  
10A5 120000   F     2775                                     call    loadUS
10A8 8087           2776                                jmp          an_t7
                    2777     
10AA 200F0F         2778     knNUL:                  jb              bitnul,ybnul
10AD D20F           2779                                     setb    bitnul
10AF 789C           2780                                     mov             r0,#rez_A3      ;A3
10B1 120000   F     2781                                     call    resar2
10B4 786A           2782                                     mov             r0,#rez_A0      
10B6 120000   F     2783                                     call    saver2;A0<-A3
10B9 020000   F     2784                                     jmp             goto7;an_t7
                    2785     
10BC C20F           2786     ybnul:                  clr             bitnul
10BE 900000   F     2787                                      mov    DPTR,#ch0 
10C1 120000   F     2788                                     CALL   ldc_long          ; r2..r5 <-- 0
10C4 786A           2789                                     mov             r0,#rez_A0      ;A0=0
10C6 120000   F     2790                                     call    saver2
10C9 020000   F     2791                                     jmp             goto7;an_t7
                    2792     
10CC 30101E         2793     labelH:                 jnb             bitt2,nolah
10CF 75B0FB         2794                                     mov             p3,#0fbh   ;вход в режим изм Т
10D2 79B7           2795                                     mov             r1,#load;parT
10D4 20B70D         2796                                     jb              p3.7,rhnot1
10D7 B70003         2797                                     cjne    @r1,#0,inct;
10DA 020000   F     2798                                     jmp             out7;hyest6
10DD 17             2799     inct:                   dec             @r1                     ;Tизм+1
                    2800                             
10DE 120000   F     2801                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
10E1                2802     hnot2:          ;       call    ind
10E1 020000   F     2803                                     jmp             out7
                    2804     
10E4 020000   F     2805      rhnot1:                jmp             hnot1
                    2806      ;rnoviR:       jmp             noviR
10E7 020000   F     2807      rlabelK:       jmp             labelK
10EA 020000   F     2808      rlabelI:       jmp             labelI          
                    2809      ;;;;;;;;;;;;;;;;;;;
10ED 3014F7         2810     nolah:          jnb             bitvich,rlabelK 
                    2811                                     
                    2812                             ;;;;;;
                    2813                             ;увеличить счетчик задержки клавиатуры
                    2814                     ;;              mov             r0,#chkl
                    2815                     ;;              mov             @r0,#27h
                    2816                     ;;              inc             r0
                    2817                     ;;              mov             @r0,#10h
                    2818                             ;;;;;;
                    2819     
10F0 78B1           2820                             mov             r0,#vichR
10F2 B61128         2821                             cjne    @r0,#11h,rhnor11;rlabelI;;
10F5 75B0FB         2822                             mov             p3,#0fbh   ;<-
10F8 20B729         2823                             jb              p3.7,noh37;routF
10FB B6110B         2824                     cjne    @r0,#11h,hr12
10FE 7613           2825                             mov             @r0,#13h        ;11= вычислить
1100 900000   F     2826                             mov             dptr,#teOUT;teVICH
1103 120000   F     2827     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    45

1106 020000   F     2828                             jmp             goto7;outF
1109 B61207         2829     hr12:           cjne    @r0,#12h,hnor12
110C 7611           2830     lovich:         mov             @r0,#11h
110E 900000   F     2831                             mov             dptr,#teVICH
1111 80F0           2832                             jmp             hvi1113         
1113 B61307         2833     hnor12:         cjne    @r0,#13h,rhnor11
1116 7612           2834     loizmk:         mov             @r0,#12h
1118 900000   F     2835                             mov             dptr,#teIZMK    ;       изм конст
                    2836                                        
111B 80E6           2837                             jmp             hvi1113
                    2838     
111D 8045           2839     rhnor11:                jmp             hnor11
                    2840     
111F 8050           2841     rvvizko:                jmp             vvizko
1121 020000   F     2842     toutF:                  jmp     outF
                    2843     
1124 75B0F7         2844     noh37:          mov             p3,#0f7h
1127 20B7F7         2845                             jb              p3.7,toutF
112A B611F2         2846                             cjne    @r0,#11h,rvvizko
112D D206           2847                             setb    bitvi11    ;нажат ввод ВЫЧИСЛИТЬ
112F D204           2848              setb   bitizm
1131 534B07         2849                              anl            bufind+11,#07h
1134 434B10         2850                              orl            bufind+11,#10h;точка после 1 знакоместа
1137 020000   F     2851     routF:          jmp             out7;goto7;outF
                    2852     
                    2853     
                    2854     
113A 80E8           2855     rnoh37:         jmp             noh37
                    2856     
113C B6120D         2857     norr11:         cjne    @r0,#12h,norr12
113F 75B0FB         2858                             mov             p3,#0fbh   ;<-
1142 20B7F5         2859                             jb              p3.7,rnoh37;routF
1145 760B           2860                             mov             @r0,#11;12->11
1147 80C3           2861                             jmp             lovich
                    2862     
1149 020000   F     2863     labelI2:                jmp             labelI
114C B613FA         2864     norr12:         cjne    @r0,#13h,labelI2
114F 75B0FB         2865                             mov             p3,#0fbh   ;<-
1152 20B7E5         2866                             jb              p3.7,rnoh37
1155 7612           2867                             mov             @r0,#12h
1157 80BD           2868                             jmp             loizmk
                    2869                             ;;;;
1159 C214           2870     clrvich:                clr             bitvich
115B D204           2871                             setb    bitizm
115D A8B2           2872                             mov             r0,marker
115F 76FF           2873                             mov             @r0,#0ffh
1161 020000   F     2874                              jmp    goto7;  routF
                    2875     
                    2876     ;rnoh37:                jmp             noh37
                    2877      ;ввод изм конст
1164 B612E5         2878     hnor11:         cjne    @r0,#12h,norr12;clrvich
1167 75B0FB         2879                              mov            p3,#0fbh   
116A 20B7CD         2880                             jb              p3.7,rnoh37;lovich;;изм конст <-  выч
116D 7611           2881                             mov             @r0,#11h
116F 809B           2882                             jmp             lovich
                    2883     
1171 78B1           2884     vvizko:         mov             r0,#vichR
1173 E6             2885                             mov             a,@r0
                    2886                     ;       cjne    @r0,#12h,clrvich
1174 B412E2         2887                             cjne    a,#12h,clrvich
1177 7621           2888                             mov             @r0,#21h                ;изм конст->U=+0000     (vv
                             od)
1179 78B2           2889                             mov             r0,#marker
117B 7604           2890                             mov             @r0,#4;9
117D 753A04         2891                             mov             movleft,#4
1180 753B07         2892                             mov             movrig,#7
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    46

1183 900000   F     2893                             mov             dptr,#teAequ0
1186 120000   F     2894                             call    lotext
                    2895                             
1189 120000   F     2896                             call    outA
118C 534B0F         2897                             anl                     bufind+11,#0fh
                    2898             ;       mov             a,bufind+11
                    2899             ;       anl             a,#0f0h
                    2900             ;       mov             bufind+11,a
118F 434B40         2901                             orl             bufind+11,#40h;бит точки после 7 знакоместа(a=000.0
                              v)
                    2902                             
1192 020000   F     2903                             jmp             goto7;routF
                    2904     ;hnor13:                jmp             hnor12          
1195 B6210C         2905     izchi:          cjne    @r0,#21h,tlabelI
                    2906     ;<- при вводе цифр А                            
                    2907                     ;        mov            p3,#0fbh   
                    2908                     ;       jnb             p3.7,li21
                    2909             ;clr            bitmig
1198 78B2           2910                             mov             r0,#marker
119A 16             2911                             dec             @r0
119B B60201         2912                             cjne    @r0,#2,li21
119E 06             2913                             inc             @r0;marker=3 +/-
119F C219           2914     li21:           clr             bitmig
11A1 020000   F     2915                             jmp             goto7;outF
                    2916     
11A4 020000   F     2917     tlabelI:        jmp             labelI
                    2918     
                    2919     ;                       load    0 1 2 3 4 5             
11A7 06050403       2920     sootv:          db              6,5,4,3,2,1;parT
11AB 0201                    
                    2921     ;
                    2922     
                    2923     ;нажата кн ввод при наборе Т
11AD 75B0F7         2924     hnot1:                  mov             p3,#0f7h
11B0 20B784         2925                                     jb              p3.7,routF;out7
11B3 B70541         2926                                     cjne    @r1,#5,nohnot1  ;r1=load
11B6 794A           2927                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
11B8 E7             2928                                     mov             a,@r1
11B9 4440           2929                                     orl             a,#40h;.6
11BB F7             2930                                     mov             @r1,a
11BC 8000           2931                                     jmp             loadb
                    2932                                     
                    2933                                     
11BE 789A           2934     loadB:                  mov             r0,#parT
11C0 900000   F     2935                                     mov             dptr,#sootv
11C3 79B7           2936                                     mov             r1,#load                
11C5 E7             2937                                     mov             a,@r1;load
11C6 93             2938                                     movc    a,@a+dptr
11C7 F6             2939                                     mov             @r0,a
11C8 120000   F     2940                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    2941                                      ;r4=b1 r5=b2
11CB 120000   F     2942                                     call    iniacp;инициализация АЦП
11CE 120000   F     2943                                     call    loadUS
11D1 120000   F     2944                                     call    clmassix        
11D4 D204           2945                                     setb    bitizm
11D6 C210           2946                                     clr             bitt2
11D8 C3             2947                                      clr            c
11D9 789A           2948                                  mov                r0,#parT
11DB 79AF           2949                                      mov            r1,#parN
11DD 7402           2950                                  mov                a,#2
11DF 96             2951                                 subb                a,@r0
11E0 5005           2952                                 jnc                 loadB2
11E2 7701           2953                                     mov             @r1,#1;N=1         ;T>=2
11E4 020000   F     2954     bout7:                  jmp             goto7;out7
                    2955     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    47

11E7 B702FA         2956     loadB2:                 cjne    @r1,#2,bout7
11EA 7702           2957                                     mov             @r1,#2;N=2
11EC 020000   F     2958                                     jmp             goto7;out7
11EF                2959     nohnot2:                ;в буфере 1 зажечь <=0,1s
11EF 794A           2960                                     mov             r1,#bufind+10
11F1 E7             2961                                     mov             a,@r1
11F2 4410           2962                                     orl             a,#10h;.4
11F4 F7             2963                                     mov             @r1,a
11F5 80C7           2964                                     jmp             loadB
11F7 B704F5         2965     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
11FA 794A           2966                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
11FC E7             2967                                     mov             a,@r1
11FD 4420           2968                                     orl             a,#20h;.5
11FF F7             2969                                     mov             @r1,a
1200 80BC           2970                                     jmp             loadB
                    2971     
                    2972     ;кнопка ПАМЯТЬ
1202 C204           2973     knMEM:                  clr             bitizm          ;off IZM
1204 900000   F     2974                                     mov             dptr,#teCLE
1207 120000   F     2975                                     call    lotext    ;в буф2 записать ОЧИСТКА
120A D20B           2976                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
120C 534BEF         2977                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
120F 78B0           2978                                     mov             r0,#level
1211 7611           2979                                     mov             @r0,#11h
1213 783D           2980     onmem11:                mov             r0,#chkl
1215 7603           2981                                     mov             @r0,#03
1217 08             2982                                     inc             r0
1218 76E8           2983                                     mov             @r0,#0e8h               ;1000
121A 020000   F     2984                                     jmp             out7;goto7;out7
                    2985     
121D 020000   F     2986     rnomemk:                jmp             nomemk          ;
                    2987     
1220 78B0           2988     outkmem:        mov                     r0,#level
1222 7600           2989                                             mov                     @r0,#0
1224 78B1           2990                                             mov                     r0,#vichR
1226 7600           2991                                             mov                     @r0,#0
1228 C20B           2992                                             clr                     bitmem
122A C214           2993                                             clr                     bitvich
122C C206           2994                                             clr                     bitvi11
122E C211           2995                                             clr                     bitmenu
1230 D204           2996                                             setb            bitizm
1232 78B2           2997                                             mov                     r0,#marker
1234 76FF           2998                                             mov                     @r0,#0ffh
1236 020000   F     2999                                             jmp                     goto7   
1239                3000     labelK:
                    3001     
                    3002     ;;;;;;;;;;;;
1239 300BE1         3003                               jnb           bitmem,rnomemk          ;кн память (ввод и <-)
123C 75B0EF         3004                                     mov                     p3,#0efh
123F 30B7DE         3005                                     jnb                     p3.7,outkmem            ;отжатие кн
                              память на любом уровне обработки памяти
1242 78B0           3006                                      mov            r0,#level
1244 B6114E         3007                               cjne          @r0,#11h,klev1;nome11
1247 75B0FB         3008     lefmem11:         mov           p3,#0fbh
124A E5B0           3009                               mov           a,p3
124C 20E70E         3010                               jb            acc.7,rkvvod0
124F B6110E         3011                               cjne          @r0,#11h,locle          ;<-memory
1252 7614           3012                               mov           @r0,#14h
1254 900000   F     3013     lolist:           mov           dptr,#teSTAT
1257 120000   F     3014                               call          lotext           ;СТАТИСТИКА
125A 020000   F     3015                               jmp   goto7;  outF
                    3016     
125D 020000   F     3017     rkvvod0:        jmp             kvvod0
                    3018     
                    3019     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    48

1260 B6120B         3020     locle:          cjne            @r0,#12h,lowr           ;<-memory
1263 7611           3021                               mov           @r0,#11h                   ;ОЧИСТКА
1265 900000   F     3022     loadcle:          mov           dptr,#teCLE
1268 120000   F     3023                               call          lotext
126B 020000   F     3024                               jmp           goto7;outF
                    3025     
126E B6130B         3026     lowr:                   cjne    @r0,#13h,lostat
1271 7612           3027                                             mov             @r0,#12h
1273 900000   F     3028      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
1276 120000   F     3029                             call    lotext
1279 020000   F     3030                             jmp             goto7;outF
                    3031     
127C 7613           3032     lostat:         mov             @r0,#13h
127E 900000   F     3033                                     mov             dptr,#teLIST              ;ПРОСМОТР
1281 120000   F     3034                             call    lotext
1284 020000   F     3035                             jmp             goto7;outF
                    3036     
1287 B6141A         3037     me_14:cjne              @r0,#14h,klev22
128A 7613           3038                                             mov             @r0,#13h
128C 900000   F     3039                             mov             dptr,#teLIST              ;;ПРОСМОТР
128F 120000   F     3040                             call    lotext
1292 020000   F     3041                             jmp             goto7
1295 B61202         3042      klev1:          cjne   @r0,#12h,klev2
1298 80AD           3043                             jmp             lefmem11
129A B61302         3044     klev2:           cjne   @r0,#13h,klev3;11-14   klev22     ;11-13 нет
129D 80A8           3045                             jmp             lefmem11
129F B61402         3046     klev3:           cjne   @r0,#14h,klev22;
12A2 80A3           3047                             jmp             lefmem11
                    3048     ;<- vvod на более низких уровнях
12A4 B62117         3049     klev22:         cjne    @r0,#21h,klev21
12A7 75B0FB         3050     lev220:         mov             p3,#0fbh
12AA 20B763         3051                             jb              p3.7,kgo23
12AD B6210B         3052                             cjne    @r0,#21h,kfullr
12B0 7622           3053                             mov             @r0,#22h
12B2 900000   F     3054                             mov             dptr,#teBL
12B5 120000   F     3055                             call    lotext
12B8 020000   F     3056                             jmp             goto7;outF
12BB 020000   F     3057     kfullr:         jmp             kfull                           
12BE B6220E         3058     klev21:         cjne    @r0,#22h,klev23
12C1 80E4           3059                             jmp             lev220
                    3060     
12C3 020000   F     3061     rlabL2:         jmp             labL2
12C6 020000   F     3062     rlabM:          jmp             labM
12C9 020000   F     3063     ques:                   jmp             out7
12CC 020000   F     3064     ddoutfr:        jmp             ddoutf
                    3065     
12CF B623F4         3066     klev23:          cjne   @r0,#23h,rlabM
12D2 75B0FB         3067                              mov    p3,#0fbh
12D5 30B7F1         3068                              jnb            p3.7,ques;errr labL2
12D8 75B0F7         3069                              mov    p3,#0f7h
12DB 20B7EE         3070                              jb             p3.7,ddoutfr
                    3071                                             ;       считать с индикатора  
12DE C3             3072                                     clr                     c
12DF E547           3073                                mov          a,bufind+7      
12E1 9430           3074                                      subb           a,#30h
12E3 B40002         3075                                      cjne           a,#0,chaibl
12E6 7401           3076                                      mov            a,#1                    ;номера блоков 1..4
12E8 F538           3077     chaibl:  mov            nblok,a
                    3078                                
                    3079                              ;очистить блок памяти с набранным номером
                    3080                              ;150h..1000h( 150h+nblok*320h)
12EA 120000   F     3081                                     call            adrblok         ;dptr-
                    3082     
12ED 79B8           3083                                     mov                     r1,#work                ;обьем блок
                             а
12EF 7703           3084                                     mov                     @r1,#03
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    49

12F1 09             3085                                     inc                     r1
12F2 7720           3086                                     mov                     @r1,#20h                        ;32
                             0h
                    3087     
12F4                3088     goonoff:
12F4 E4             3089                                     clr                     a
12F5 F0             3090                                     movx            @dptr,a
12F6 A3             3091                                     inc                     dptr
                    3092     
12F7 79B9           3093                                     mov                     r1,#work+1
12F9 120000   F     3094                                     call            chminus
12FC 78B8           3095                                     mov             r0,#work
12FE E6             3096                             mov             a,@r0
12FF 30E7F2         3097                             jnb             acc.7,goonoff
                    3098     
1302 C20B           3099                              clr    bitmem  ;сбр признак памяти 
1304 D204           3100                              setb   bitizm
1306 78B2           3101                              mov            r0,#marker
1308 76FF           3102                              mov            @r0,#0ffh
130A 020000   F     3103                              jmp    goto7
                    3104     
130D 020000   F     3105     rddoutf:        jmp             ddoutf
                    3106     
                    3107     ;vvod   БЛОК->БЛОК 00           
1310 75B0F7         3108     kgo23:           mov    p3,#0f7h
1313 20B7F7         3109                             jb              p3.7,rddoutf
1316 B6216B         3110                             cjne    @r0,#21h,go23no
                    3111                             ;очистить память 150..dd0h
                    3112                             ;1й блок
1319 900150         3113                              mov                    dptr,#150h
131C 79B8           3114                                     mov                     r1,#work                ;обьем блок
                             а
131E 7703           3115                                     mov                     @r1,#03
1320 09             3116                                     inc                     r1
1321 7720           3117                                     mov                     @r1,#20h                        ;32
                             0h
                    3118     
1323                3119     gooff1:
1323 E4             3120                                     clr                     a
1324 F0             3121                                     movx            @dptr,a
1325 A3             3122                                     inc                     dptr
                    3123     
1326 79B9           3124                                     mov                     r1,#work+1
1328 120000   F     3125                                     call            chminus
132B 78B8           3126                                     mov             r0,#work
132D E6             3127                             mov             a,@r0
132E 30E7F2         3128                             jnb             acc.7,gooff1
                    3129     ;2й блок
1331 900470         3130     mov                     dptr,#470h
1334 79B8           3131                                     mov                     r1,#work                ;обьем блок
                             а
1336 7703           3132                                     mov                     @r1,#03
1338 09             3133                                     inc                     r1
1339 7720           3134                                     mov                     @r1,#20h                        ;32
                             0h
                    3135     
133B                3136     gooff2:
133B E4             3137                                     clr                     a
133C F0             3138                                     movx            @dptr,a
133D A3             3139                                     inc                     dptr
                    3140     
133E 79B9           3141                                     mov                     r1,#work+1
1340 120000   F     3142                                     call            chminus
1343 78B8           3143                                     mov             r0,#work
1345 E6             3144                             mov             a,@r0
1346 30E7F2         3145                             jnb             acc.7,gooff2
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    50

                    3146     
                    3147     ;3й блок
1349 900490         3148                             mov                     dptr,#490h
134C 79B8           3149                                     mov                     r1,#work                ;обьем блок
                             а
134E 7703           3150                                     mov                     @r1,#03
1350 09             3151                                     inc                     r1
1351 7720           3152                                     mov                     @r1,#20h                        ;32
                             0h
                    3153     
1353                3154     gooff3:
1353 E4             3155                                     clr                     a
1354 F0             3156                                     movx            @dptr,a
1355 A3             3157                                     inc                     dptr
                    3158     
1356 79B9           3159                                     mov                     r1,#work+1
1358 120000   F     3160                                     call            chminus
135B 78B8           3161                                     mov             r0,#work
135D E6             3162                             mov             a,@r0
135E 30E7F2         3163                             jnb             acc.7,gooff3
                    3164     ;4й блок
1361 900AB0         3165     mov                     dptr,#0ab0h
1364 79B8           3166                                     mov                     r1,#work                ;обьем блок
                             а
1366 7703           3167                                     mov                     @r1,#03h
1368 09             3168                                     inc                     r1
1369 7720           3169                                     mov                     @r1,#20h                        ;32
                             0h
                    3170     
136B                3171     gooff4:
136B E4             3172                                     clr                     a
136C F0             3173                                     movx            @dptr,a
136D A3             3174                                     inc                     dptr
                    3175     
136E 79B9           3176                                     mov                     r1,#work+1
1370 120000   F     3177                                     call            chminus
1373 78B8           3178                                     mov             r0,#work
1375 E6             3179                             mov             a,@r0
1376 30E7F2         3180                             jnb             acc.7,gooff4
1379 C20B           3181                             clr             bitmem
137B D204           3182                             setb    bitizm
137D 78B2           3183                                     mov             r0,#marker
137F 76FF           3184                              mov            @r0,#0ffh
1381 020000   F     3185                             jmp             goto7
                    3186     
1384 7623           3187     go23no:    mov          @r0,#23h
1386 753B08         3188                                             mov                     movrig,#8
1389 753A07         3189                                             mov             movleft,#7
138C 8055           3190                             jmp             loblok;БЛОК 00
                    3191     
138E 7621           3192     kfull:          mov             @r0,#21h
1390 8025           3193                             jmp             gofull
                    3194                             
                    3195                                             
1392 020000   F     3196     nomemk:         jmp             labelS                  ;нажат ввод меню
                    3197                             
1395 75B0FB         3198     nome11:           mov           p3,#0fbh
1398 E5B0           3199                               mov           a,p3
139A 20E70D         3200                               jb            acc.7,kvvod0
139D B61205         3201                               cjne          @r0,#12h,mem12no        
13A0 7611           3202                               mov           @r0,#11h                ;ОЧИСТКА
13A2 020000   F     3203                               jmp            loadcle
                    3204     
13A5                3205     mem12no:        ;cjne           @r0,#13h,lowr           
13A5 7612           3206                               mov           @r0,#12h                   ;
13A7 020000   F     3207                               jmp           lowr1                     ;ЗАПИСЬ
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    51

                    3208     
13AA 75B0F7         3209     kvvod0:           mov           p3,#0f7h                        ;knopka vvod
13AD 20B70F         3210                               jb            p3.7,ddoutf
13B0 78B0           3211                               mov           r0,#level
13B2 B61129         3212                               cjne          @r0,#11h,mvv11
13B5 7621           3213                               mov           @r0,#21h                ;ПОЛНАЯ
13B7 900000   F     3214     gofull:           mov           dptr,#teFULL
13BA 120000   F     3215                               call          lotext
13BD 8049           3216                                     jmp             mlabL2  ;<-????????/
                    3217     
13BF                3218     ddoutf:         ;<- БЛОК 00(ОЧИСТКА)
                    3219     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3220     ;т е сохранить ее в ячейке для мигания в противном случае
                    3221     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3222     ;       знакоместа
13BF 78B2           3223                                                     mov             r0,#marker
13C1 7440           3224                                     mov             a,#bufind
13C3 26             3225                                             add             a,@r0                   ;a=bufind+m
                             arker
13C4 F9             3226                                             mov             r1,a
13C5 19             3227                                             dec             r1      ;       inc             r1
13C6 873C           3228                                             mov             savba,@r1
13C8 C219           3229                                             clr             bitmig
                    3230     ;;;;;;;;;;;;;;;;
13CA 78B2           3231                       mov           r0,#marker      ;курсор слева   ?
13CC E53A           3232                             mov             a,movleft
13CE C3             3233                             clr             c
13CF 96             3234                             subb    a,@r0
13D0 7006           3235                             jnz        left21
13D2 E53B           3236                             mov             a,movrig;уст в правую позицию
13D4 F6             3237                             mov             @r0,a
                    3238     
13D5 020000   F     3239                             jmp             goto7                                            
13D8 E53A           3240     left21:         mov             a,movleft;уст в левую позицию
13DA F6             3241                             mov             @r0,a   
13DB 020000   F     3242                             jmp             goto7
                    3243     
                    3244     
13DE B6120F         3245     mvv11:            cjne          @r0,#12h,mvv12
13E1 7631           3246                                     mov             @r0,#31h
13E3 900000   F     3247     loblok:                 mov             dptr,#teBL0;БЛОК 0
13E6 120000   F     3248                                     call    lotext
13E9 78B2           3249                                     mov             r0,#marker
13EB 7607           3250                                     mov             @r0,#7
                    3251                                     ;mov            movrig,#9
                    3252                                     ;mov            movleft,#6
13ED 020000   F     3253                                     jmp             goto7;outF
13F0 B61411         3254     mvv12:  cjne            @r0,#14h,bl_li
13F3 7661           3255                                     mov                     @r0,#61h
13F5 900000   F     3256                                     mov             dptr,#teMIN;
13F8 120000   F     3257                                     call    lotext
13FB 120000   F     3258                                     call    vichmin
13FE 120000   F     3259                                     call    z_1s
1401 020000   F     3260                                     jmp             out7;goto7;outF
                    3261     
1404 7641           3262     bl_li:          mov             @r0,#41h                ; БЛОК 00(ЗАПИСЬ И ПРОСМОТР)
1406 80DB           3263                                     jmp             loblok
                    3264     
                    3265     
                    3266     
1408                3267     mlabL2:         ;jmp            labL2
                    3268                                             ;  уст курсор в правую позицию 
                    3269                                     ;                               29.12.06
                    3270     ;;;;;;;;;;;;;;;;;;
                    3271     ;необходимо не портить цифру в следуюем справа знакоместе
                    3272     ;т е сохранить ее в ячейке для мигания в противном случае
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    52

                    3273     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3274     ;       знакоместа
1408 78B2           3275                                             mov             r0,#marker
140A 7440           3276                                     mov             a,#bufind
140C 26             3277                                             add             a,@r0                   ;a=bufind+m
                             arker
140D F9             3278                                             mov             r1,a
140E 09             3279                                             inc             r1
140F 873C           3280                                             mov             savba,@r1
                    3281     ;;;;;;;;;;;;;;;;
1411 78B2           3282                       mov           r0,#marker      ;курсор справа  ?
1413 E53B           3283                             mov             a,movrig
1415 C3             3284                             clr             c
1416 96             3285                             subb    a,@r0
1417 6006           3286                             jz         equ2l
1419 E53B           3287                             mov             a,movrig;уст в правую позицию
141B F6             3288                             mov             @r0,a
                    3289     ;                       lool
141C 020000   F     3290                             jmp             goto7                                            
141F E53A           3291     equ2l:          mov             a,movleft;уст в левую позицию
1421 F6             3292                             mov             @r0,a   
1422 020000   F     3293                             jmp             goto7
                    3294                     
                    3295     
1425 B63159         3296     labM:                   cjne    @r0,#31h,nom31
1428 75B0FB         3297                                     mov             p3,#0fbh
142B 30B7DA         3298                                     jnb             p3.7,mlabL2
142E 75B0F7         3299                                mov          p3,#0f7h
1431 20B78B         3300                                jb           p3.7,ddoutf
                    3301                                
1434 7632           3302                                mov          @r0,#32h                        ;ИНТ 0000
                    3303                                     ;       считать с индикатора  
1436 C3             3304     blokvv:         clr                     c
1437 E547           3305                                mov          a,bufind+7      
1439 9430           3306                                      subb           a,#30h
143B B40002         3307                                      cjne           a,#0,blokvvc
143E 7401           3308                                      mov            a,#1                    ;номера блоков 1..4
                    3309     
1440 F538           3310     blokvvc: mov            nblok,a
1442 900000   F     3311                                mov          dptr,#teINT;ИНТ 0000c
1445 120000   F     3312                                call         lotext
                    3313                                      ;anl           bufind+11,#0efh
1448 78B2           3314                                mov          r0,#marker
144A 7605           3315                                mov          @r0,#5
144C 753B08         3316                                mov          movrig,#8
144F 753A05         3317                                mov          movleft,#5
1452 789A           3318                                      mov            r0,#parT
1454 B60609         3319                                     cjne            @r0,#6,innot6
1457 534BF0         3320                                     anl                     bufind+11,#0f0h;after 5- 0.000c
145A 434B80         3321                                     orl                     bufind+11,#80h
145D 020000   F     3322                                     jmp                     goto7
1460 B60309         3323     innot6: cjne            @r0,#3,innot3
1463 534BF0         3324                                     anl                     bufind+11,#0f0h;after 7- 000.0c
1466 434B20         3325                                     orl                     bufind+11,#20h
                    3326                                     ;call           ind
1469 020000   F     3327                                     jmp                     out7;goto7
146C C3             3328     innot3: clr                     c
146D 7403           3329                                     mov                     a,#3
146F 96             3330                                     subb            a,@r0
1470 5009           3331                                     jnc                     innot1_2
1472 534BF0         3332                                     anl                     bufind+11,#0f0h;after 6- 00.00c
1475 434B40         3333                                     orl                     bufind+11,#40h
1478 020000   F     3334                                     jmp                     goto7
                    3335     
147B                3336     innot1_2:
147B 534BF0         3337                                     anl                     bufind+11,#0f0h;0000c
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    53

                    3338                                                                     
147E 020000   F     3339     rgoto7: jmp        goto7;outF
                    3340     
1481 B63260         3341     nom31:             cjne         @r0,#32h,nom32
1484 75B0FB         3342                                     mov             p3,#0fbh
1487 20B71F         3343                                     jb              p3.7,vvinte             ;ввод интервал;no31
                             n
                    3344                                     
148A                3345     lefcur:         ;;кн <- 32 нач блок 000
                    3346     ;необходимо не портить цифру в следуюем сслева знакоместе
                    3347     ;т е сохранить ее в ячейке для мигания в противном случае
                    3348     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3349     ;       знакоместа
148A C219           3350                                                     clr             bitmig
148C 78B2           3351                                                     mov             r0,#marker;нажата кн <- при
                              вводе цифр нач блок 000
148E 7440           3352                                     mov             a,#bufind
1490 26             3353                                             add             a,@r0                   ;a=bufind+m
                             arker
1491 F9             3354                                             mov             r1,a
1492 19             3355                                             dec             r1;;;;;;;;;;;
1493 873C           3356                                             mov             savba,@r1
                    3357                                             
1495 78B2           3358                                                     mov             r0,#marker      ;курсор сле
                             ва?
1497 E53A           3359                             mov             a,movleft
1499 C3             3360                             clr             c
149A 96             3361                             subb    a,@r0
149B 7006           3362                             jnz        noequ2
149D E53B           3363                             mov             a,movrig
149F F6             3364                             mov             @r0,a;уст в крайнюю правую позицию
14A0 020000   F     3365                             jmp             goto7
14A3 120000   F     3366     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
14A6 020000   F     3367                             jmp        goto7        
                    3368                                                                       
                    3369     
                    3370     ;;;;;;;;;;;;;;;;;;
14A9                3371     vvinte:         ;ввод интервал                          
14A9 75B0F7         3372     no31n:             mov          p3,#0f7h
14AC 20B7CF         3373                                     jb              p3.7,rgoto7
14AF 7633           3374                                     mov             @r0,#33h
                    3375                                     ;считать с индикатора введенный интервал
14B1 7F0A           3376                                             mov             r7,#10
14B3 7853           3377                                     mov             r0,#adec
14B5 120000   F     3378                                     call    clearN
14B8 120000   F     3379                                     call    upak4                   
14BB 784F           3380                                     mov             r0,#abin
14BD 7953           3381                                     mov             r1,#adec                        ;мл        
                              ст
14BF 120000   F     3382                                     call    decbin                  ;abin..abin+3 (hex)
14C2 794F           3383                                     mov             r1,#abin
14C4 78CE           3384                                     mov             r0,#interva+1
14C6 E7             3385                                     mov             a,@r1
14C7 F6             3386                                     mov             @r0,a
14C8 18             3387                                     dec             r0
14C9 09             3388                                     inc             r1
14CA E7             3389                                     mov             a,@r1
14CB F6             3390                                     mov             @r0,a
                    3391                                     
14CC 78D5           3392                                     mov             r0,#volume                      ;объем блок
                             а
14CE 7600           3393                                     mov             @r0,#0
14D0 08             3394                                     inc             r0
14D1 76C7           3395                                     mov             @r0,#0c7h
14D3 120000   F     3396                                     call            adrblok;dptr
14D6 120000   F     3397                                     call            save_hl;1я ячейка блока
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    54

14D9 78B2           3398                                mov          r0,#marker
14DB 76FF           3399                                mov          @r0,#0ffh
14DD D204           3400                                      setb           bitizm
14DF C20B           3401                                      clr            bitmem
14E1 020000   F     3402                                jmp     goto7;
                    3403     
                    3404     
14E4 B6332B         3405     nom32:           cjne           @r0,#33h,nom33
14E7 75B0FB         3406                              mov            p3,#0fbh
14EA 30B79D         3407                              jnb            p3.7,lefcur
14ED 75B0F7         3408                              mov            p3,#0f7h
14F0 20B78B         3409                              jb             p3.7,rgoto7
                    3410                              ;запомнить номер ячейки конца блока
14F3 7634           3411                              mov    @r0,#34h
14F5 7F0A           3412     INTn:                   mov             r7,#10
14F7 7853           3413                                     mov             r0,#adec
14F9 120000   F     3414                                     call    clearN
14FC 120000   F     3415                                     call    upak3                   
14FF 784F           3416                                     mov             r0,#abin
1501 7953           3417                                     mov             r1,#adec                        ;мл        
                              ст
1503 120000   F     3418                                     call    decbin                  ;abin..abin+3 (hex)
1506 120000   F     3419                                     call    loadr2                  ;r2..r5
1509 120402         3420                                     call    altof                   ;r2..r5->int
150C 020000   F     3421     dgoto7:                  jmp            goto7
                    3422     
150F 020000   F     3423     rlefcur:                jmp             lefcur
                    3424     
1512 B6345B         3425     nom33:          cjne            @r0,#34h,labelP
1515 75B0FB         3426                               mov           p3,#0fbh
1518 30B7F4         3427                              jnb            p3.7,rlefcur
151B 75B0F7         3428                              mov            p3,#0f7h
151E 20B7EB         3429                              jb             p3.7,dgoto7
1521 7635           3430                              mov            @r0,#35h
1523 78B2           3431                              mov            r0,#marker
1525 76FF           3432                              mov            @r0,#0ffh
                    3433                              ;T1<-число на индикаторе
                    3434                                               ;vvod КОН БЛ 000
1527 78CF           3435                              mov            r0,#chbuf               ;счетчик периода загрузки в
                              буфер и интерфейс
1529 7630           3436                              mov            @r0,#30h  
152B C20B           3437                              clr            bitmem
152D D204           3438                              setb           bitizm;;;;      
152F 020000   F     3439                             jmp        goto7
1532 020000   F     3440     vodm11_15:                      jmp             vvodm11_15
1535 020000   F     3441     me11_15de:                      jmp             me11_15dec
1538 020000   F     3442     moutkmem:                               jmp             outkmem
                    3443     
                    3444     ;обработка кнопки меню ввод
153B 301132         3445     labelS:         jnb                     bitmenu,labelP
153E 75B0DF         3446                                             mov                     p3,#0dfh
1541 30B7F4         3447                                             jnb                     p3.7,moutkmem
1544 78B1           3448                                             mov                     r0,#vichR
1546 7415           3449                                             mov                     a,#15h
1548 C3             3450                                             clr                     c
1549 96             3451                                             subb            a,@r0
154A 4021           3452                                             jc                      rme21_23
                    3453                             
154C 75B0FB         3454                                             mov                     p3,#0fbh
154F 20B7E0         3455                                             jb                      p3.7,vodm11_15
1552 78B1           3456                                             mov                     r0,#vichR
1554 B611DE         3457                                             cjne                    @r0,#11h,me11_15de;<-
1557 7615           3458                                             mov                     @r0,#15h
1559 900000   F     3459                                             mov                     dptr,#teKALIB
155C 120000   F     3460                                             call            lotext
155F 020000   F     3461                                             jmp                     onmem11
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    55

1562 C211           3462     menuon:         clr             bitmenu                 ;off menu
1564 D204           3463                                             setb    bitizm
                    3464     
1566 78B1           3465                                     mov             r0,#vichR
1568 7600           3466                                     mov             @r0,#0
156A 020000   F     3467                                     jmp             onmem11
                    3468     
                    3469                                             ;;;;;
                    3470             
156D 020000   F     3471     rme21_23:               jmp             me21_23 
                    3472                             
                    3473     ;режим просмотра
1570 B64130         3474     labelP:                 cjne            @r0,#41h,govvlist
1573 7642           3475                                                     mov                     @r0,#42h
                    3476                                                     ;       считать с индикатора  
1575 C3             3477                                             clr                     c
1576 E547           3478                                mov          a,bufind+7      
1578 9430           3479                                      subb           a,#30h
157A B40002         3480                                      cjne           a,#0,chaipr
157D 7401           3481                                      mov            a,#1
157F F538           3482     chaipr:                          mov            nblok,a
1581 900000   F     3483                                mov          dptr,#teCH;ОТСЧЕТ 000
1584 120000   F     3484                                call         lotext
1587 534BEF         3485                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
                             та
158A 78B2           3486                                mov          r0,#marker
158C 7607           3487                                mov          @r0,#7
158E 753B09         3488                                mov          movrig,#9
1591 753A07         3489                                mov          movleft,#7
1594 120000   F     3490                                             call            z_1s
1597 020000   F     3491                        jmp     goto7;outF
159A 020000   F     3492     label43:                jmp             label7
                    3493     
159D 020000   F     3494     rlist_43:                       jmp                     list_43                            
                                  
15A0 020000   F     3495     mlabL2r:                        jmp                     mlabL2
15A3 B642F7         3496     govvlist:                       cjne            @r0,#42h,rlist_43
15A6 75B0FB         3497                                                                     mov                     p3,
                             #0fbh
15A9 30B7F4         3498                                                             jnb                     p3.7,mlabL2
                             r;кн <- ОТСЧЕТ 000
15AC 75B0F7         3499                                                             mov                     p3,#0f7h
15AF 20B7E8         3500                                                             jb                      p3.7,label4
                             3
15B2 7643           3501                                                             mov                     @r0,#43h;vv
                             od 
15B4 78B2           3502                                                             mov                     r0,#marker
15B6 76FF           3503                                                             mov                     @r0,#0ffh
15B8 7F0A           3504                                                                     mov             r7,#10
15BA 7853           3505                                     mov             r0,#adec
15BC 120000   F     3506                                     call    clearN
15BF 120000   F     3507                                     call    upak3                   
15C2 784F           3508                                     mov             r0,#abin
15C4 7953           3509                                     mov             r1,#adec                        ;мл        
                              ст
15C6 120000   F     3510                                     call    decbin                  ;abin..abin+3 (hex)
15C9 120000   F     3511                                     call    loadr2                  ;r2..r5
15CC ED             3512                                     mov             a,r5                            ;сохр номер
                              лемента
15CD F537           3513                                     mov             nelem,a
15CF 120402         3514                                     call    altof                   ;r2..r5->int
15D2 900000   F     3515                                     mov             dptr,#ch_1;
15D5 120000   F     3516                                     call    ldc_ltemp                       ;r8..r11
15D8 1201D1         3517                                     call    flsub
15DB 900000   F     3518                                     mov             dptr,#ch_4;
15DE 120000   F     3519                                     call    ldc_ltemp                       ;r8..r11
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    56

15E1 120203         3520                                     call    flmul                           ;(n(номер отсчета)-
                             1)*4+адр нач блока
15E4 120343         3521                                     call            ftol                    ;r2..r5->hex
15E7 C002           3522                                     push            rr2
15E9 C003           3523                                     push            rr3
15EB C004           3524                                     push            rr4
15ED C005           3525                                     push            rr5
15EF 120000   F     3526                                     call            adrblok;dptr-
15F2 D005           3527                                     pop                     rr5
15F4 D004           3528                                     pop                     rr4
15F6 D003           3529                                     pop                     rr3
15F8 D002           3530                                     pop                     rr2
15FA 79D8           3531                                     mov                     r1,#copy_hl+1;saven_bl+1;сохр адрес
                              внешн озу введенного лемента
15FC E582           3532                                     mov                     a,dpl
15FE 2D             3533                                     add                     a,r5
15FF F582           3534                                     mov                     dpl,a
1601 F7             3535                                     mov                     @r1,a           ;low
1602 E583           3536                                     mov                     a,dph
1604 3C             3537                                     addc            a,r4
1605 F583           3538                                     mov                     dph,a
1607 19             3539                                     dec                     r1
1608 F7             3540                                     mov                     @r1,a                   ;high
                    3541                             
1609                3542     li42_43:
1609 120000   F     3543                                     call            reA3_X          ;r2..r5/выдать рез из внешн
                              пам на индикатор
160C 900000   F     3544                                     mov             dptr,#ch10;
160F 120000   F     3545                                     call    ldc_ltemp
1612 120000   F     3546                                     call    zdiv    
                    3547                                     ;;;;;;;;;;;
1615 120000   F     3548                                     call    maform
                    3549                                     ;;;;
                    3550     
                    3551                                     ;;;;;;;
1618 784F           3552                                             mov             r0,#abin
161A 120000   F     3553                                             call    saver2
161D 7853           3554                                             mov             r0,#adec
161F 7952           3555                                             mov             r1,#abin+3      ;hex->10
1621 120000   F     3556                                             call    bindec
                    3557                                     
1624 785C           3558                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1626 7945           3559                                             mov             r1,#bufind+5
1628 7F07           3560                                             mov             r7,#7
162A E6             3561     ch43:                           mov             a,@r0
162B 2430           3562                                             add             a,#30h
162D F7             3563                                             mov             @r1,a
162E 19             3564                                             dec             r1
162F 18             3565                                             dec             r0
1630 DFF8           3566                                             djnz    r7,ch43
1632 7847           3567                                             mov             r0,#bufind+7
1634 762D           3568                                             mov             @r0,#2dh          ;-2..-9
1636 7840           3569                                             mov             r0,#bufind
1638 762B           3570                                             mov             @r0,#2bh
163A 300202         3571                                             jnb             znmat,nozzmi43;bitznak,nozzmi
163D 762D           3572                                             mov             @r0,#2dh
163F 79AE           3573     nozzmi43:                               mov             r1,#diap
1641 7848           3574                                             mov             r0,#bufind+8
1643 E7             3575                                             mov             a,@r1
1644 B40808         3576                                             cjne    a,#8,nodi8_43
1647 7630           3577                                             mov             @r0,#30h                 ;10-10
1649 18             3578                                             dec             r0
164A 7663           3579                                             mov             @r0,#63h;31h
164C 08             3580                                             inc             r0
164D 800E           3581                                             jmp             see_l43
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    57

164F B40908         3582     nodi8_43:       cjne    a,#9,nodi9_43
                    3583                                     
1652 7631           3584                                             mov             @r0,#31h           ;10-11
1654 18             3585                                             dec             r0
1655 7663           3586                                             mov             @r0,#63h;31h
                    3587                                     
1657 08             3588                                             inc             r0
1658 8003           3589                                             jmp             see_l43
165A 2432           3590     nodi9_43:               add             a,#32h
165C F6             3591                                             mov             @r0,a;
165D 08             3592     see_l43:                        inc             r0
165E 7641           3593                                             mov             @r0,#"A";"E";
1660 08             3594                                             inc             r0
1661 7600           3595                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
1663 08             3596                                             inc             r0;             mov             buf
                             ind+11
1664 76D0           3597                                             mov             @r0,#0d0h               ;bufind+11.
                             4 точка после первой цифры
1666 120000   F     3598     out43:          call            ind
1669 120000   F     3599                                             call            z_1s
166C 020000   F     3600                                             jmp             out7                               
                                  
                    3601     
                    3602                                     ;;;;;;;;        
166F 783D           3603     label7: mov             r0,#chkl
1671 7604           3604                                     mov             @r0,#04;3
1673 08             3605                                     inc             r0
1674 76E8           3606                                     mov             @r0,#0e8h               ;1000
1676 020000   F     3607                                     jmp             out7;
1679 B64351         3608     list_43:                cjne    @r0,#43h,noli_43
167C 75B0FB         3609                                                     mov             p3,#0fbh                ;43
                             h <-
167F 20B70A         3610                                                     jb              p3.7,vvod43             ;vv
                             od
1682 C20B           3611                                                     clr             bitmem
1684 D204           3612                                                     setb    bitizm
1686 78B2           3613                                                     mov             r0,#marker
1688 76FF           3614                                                     mov             @r0,#0ffh
168A 80E3           3615                                                     jmp             label7;по кн <- выход из пр
                             осмотра
                    3616     
168C 7644           3617     vvod43:                 mov             @r0,#44h
168E E537           3618                                                     mov             a,nelem;вывод порядкового н
                             омера в блоке 
1690 F552           3619                                                     mov             abin+3,a
1692 04             3620                                                     inc             a
1693 F537           3621                                                     mov             nelem,a
1695 E4             3622                                                     clr             a
1696 F551           3623                                                     mov             abin+2,a
1698 F550           3624                                                     mov             abin+1,a
169A F54F           3625                                                     mov             abin,a
                    3626                                             
169C 7853           3627                                             mov             r0,#adec
169E 7952           3628                                             mov             r1,#abin+3      ;hex->10
16A0 120000   F     3629                                             call    bindec
16A3 7840           3630                                             mov             r0,#bufind;почистить индикатор
16A5 7F0A           3631                                             mov             r7,#10
16A7 7420           3632                                             mov             a,#20h
16A9 F6             3633     cle20:          mov             @r0,a
16AA 08             3634                                             inc             r0
16AB DFFC           3635                                             djnz    r7,cle20
                    3636                                             ;;;;;;
16AD 900000   F     3637                                             mov             dptr,#teCH;ОТСЧЕТ 000
16B0 120000   F     3638                                call         lotext
16B3 534BEF         3639                                     anl             bufind+11,#0efh;убрать точку с 1го знакомес
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    58

                             та
16B6 785C           3640                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
16B8 7949           3641                                             mov             r1,#bufind+9
16BA 7F03           3642                                             mov             r7,#3
16BC E6             3643     ch43_42:                                mov             a,@r0
16BD 2430           3644                                             add             a,#30h
16BF F7             3645                                             mov             @r1,a
16C0 19             3646                                             dec             r1
16C1 18             3647                                             dec             r0
16C2 DFF8           3648                                             djnz    r7,ch43_42
16C4 120000   F     3649                                             call            ind
16C7 120000   F     3650                                             call            z_1s
16CA 020000   F     3651                                             jmp             out7
16CD B64419         3652     noli_43:        cjne            @r0,#44h,vvosta
16D0 7643           3653                                             mov                     @r0,#43h
16D2 79D8           3654                                                     mov                     r1,#copy_hl+1;saven
                             _bl+1
16D4 E7             3655                                                     mov                     a,@r1
16D5 F582           3656                                                     mov                     dpl,a
16D7 19             3657                                                     dec                     r1
16D8 E7             3658                                                     mov                     a,@r1;high
16D9 F583           3659                                                     mov                     dph,a
16DB A3             3660                                                     inc                     dptr
16DC A3             3661                                                     inc                     dptr
16DD A3             3662                                                     inc                     dptr
16DE A3             3663                                                     inc                     dptr
16DF E583           3664                                                     mov                     a,dph
16E1 F7             3665                                                     mov                     @r1,a
16E2 09             3666                                                     inc                     r1
16E3 E582           3667                                                     mov                     a,dpl
16E5 F7             3668                                                     mov                     @r1,a              
                                          ;сохр адр внешн озу
16E6 020000   F     3669                                             jmp                     li42_43;вывод значения след
                             ующего в блоке
                    3670     
16E9 B66111         3671     vvosta:                 cjne            @r0,#61h,vvostad
16EC 7662           3672                                                     mov                     @r0,#62h
16EE 900000   F     3673                                                     mov                     dptr,#teMAX;
16F1 120000   F     3674                                                     call            lotext
16F4 120000   F     3675                                                     call            vichmax
16F7 120000   F     3676                                                     call            z_1s
16FA 020000   F     3677                                                     jmp             goto7
                    3678     
16FD                3679     vvostad:                ;cjne           @r0,#61h
16FD 7663           3680                                                     mov                     @r0,#63h
16FF 900000   F     3681                                                     mov             dptr,#teMid;
1702 120000   F     3682                                                     call    lotext
1705 120000   F     3683                                                     call            vichmean
1708 020000   F     3684                                                     jmp             goto7
                    3685     
170B 020000   F     3686     rLABELP:                jmp                     LABELP
170E 78B1           3687     vvodm11_15:     mov                     r0,#vichR;vvod
1710 75B0F7         3688                                                     mov                     p3,#0f7h
1713 20B7F5         3689                                             jb                      p3.7,rLABELP;????
                    3690                                     
                    3691     
1716 B61112         3692                                             cjne                    @r0,#11h,tome21
1719 7621           3693                                             mov                     @r0,#21h;vvod
171B 900000   F     3694                                             mov                     dptr,#teTE11
171E 120000   F     3695                                             call            lotext
1721 020000   F     3696                                             jmp                     onmem11
                    3697     
1724 16             3698     me11_15dec:             dec             @r0                             ;<-
1725 120000   F     3699     lokame1:        call            lomenu
1728 020000   F     3700                                             jmp                     onmem11
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    59

                    3701     
172B B61206         3702     tome21:         cjne                    @r0,#12h,tome13
                    3703                                             ;вкл тест интерфейса
172E 020000   F     3704                                             jmp             testrs;??????????
1731 020000   F     3705                                             jmp                     onmem11
                    3706     
1734 B61324         3707     tome13:         cjne                    @r0,#13h,tome14
1737 7631           3708                                             mov                     @r0,#31h
                    3709                                             
1739 7A50           3710                                             mov                     r2,#50h                    
                                  ;57.6->19.2
173B 7B2C           3711                                             mov                     r3,#2ch
173D 120454         3712                                             call            re4byte                 ;28..2bh 3b
                             ait-parol,1 bait skor
1740 E508           3713                                             mov                     a,r8
1742 B4000B         3714                                             cjne            a,#00,skor19
1745 900000   F     3715                                             mov                     dptr,#teS57_6;57,6
1748 120000   F     3716                                             call            lotext
174B C213           3717                                             clr                     bitv19
                    3718     
174D 020000   F     3719                                             jmp             onmem11
1750 900000   F     3720     skor19:         mov                     dptr,#teS19_2
1753 120000   F     3721                                             call            lotext
1756 D213           3722                                             setb            bitv19
                    3723             
1758 020000   F     3724                                             jmp                     onmem11
                    3725                                             
                    3726     
175B B61415         3727     tome14:         cjne                    @r0,#14h,tome15
175E D204           3728                                             setb            bitizm
1760 7881           3729                                             mov                     r0,#chavt
1762 7600           3730                                             mov                     @r0,#0
1764 08             3731                                             inc                     r0
1765 7600           3732                                             mov                     @r0,#0
1767 C211           3733     outmenu:        clr                     bitmenu
1769 020000   F     3734                                             jmp                     out7
                    3735     
176C 78B1           3736     goparom:        mov             r0,#vichR               ;режим меню 52
176E 7652           3737                                             mov                     @r0,#52h                   
                                  ;пароль уже ввели
1770 020000   F     3738                                             jmp                     goparol
1773 2016F6         3739     tome15:         jb              bitpar,goparom  
1776 7651           3740                                             mov                     @r0,#51h;ПАРОЛЬ 000
1778 120000   F     3741                                             call            lomenu
177B 78B2           3742                                             mov                     r0,#marker
177D 7607           3743                                             mov                     @r0,#7
177F 753B09         3744                                             mov                     movrig,#9
1782 753A07         3745                                             mov                     movleft,#7
                    3746                                             ;setb           bitizm
1785 020000   F     3747                                             jmp                     onmem11
                    3748     
                    3749     
1788 78B1           3750     me21_23:        mov                     r0,#vichR               ;<-
178A 7423           3751                                             mov                     a,#23h
178C C3             3752                                             clr                     c
178D 96             3753                                             subb            a,@r0
178E 403D           3754                                             jc                      labelS1
1790 75B0FB         3755                                             mov                     p3,#0fbh
1793 20B718         3756                                             jb                      p3.7,vv21_23
1796 B6210B         3757                                             cjne            @r0,#21h,me21_23dec;-<
1799 7623           3758                                             mov                     @r0,#23h
179B 900000   F     3759                                             mov                     dptr,#teTE7
179E 120000   F     3760                                             call            lotext
17A1 020000   F     3761                                             jmp                     onmem11
17A4                3762     me21_23dec:     
17A4 16             3763                                             dec                     @r0
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    60

17A5 120000   F     3764                                             call            lomenu
17A8 020000   F     3765                                             jmp                     onmem11
17AB 020000   F     3766     onmem12:        jmp             outF    ;(ie7)                          
                    3767                                                     
17AE 75B0F7         3768     vv21_23:        mov             p3,#0f7h                ;vvod
17B1 20B7F7         3769                                             jb              p3.7,onmem12
17B4 B6210C         3770                                             cjne            @r0,#21h,test22
                    3771                                             ;mov                    dptr,#tabt11;заслать ус 11А
17B7 120000   F     3772     tests:          call            lotpus
17BA D215           3773                                             setb            biteizm;запомнить режим ТИ
17BC D204           3774                                             setb            bitizm
17BE C211           3775                                             clr                     bitmenu;обнулить т к не буд
                             ет индикации измерения       
17C0 020000   F     3776                                             jmp                     onmem11
17C3 B62202         3777     test22:         cjne            @r0,#22h,test23
                    3778                                     ;       mov                     dptr,#tabt9;заслать ус 9А
17C6 80EF           3779                                             jmp             tests   
17C8                3780     test23:
                    3781                                     ;       mov                     dptr,#tabt7;заслать ус 7А
17C8 80ED           3782                                             jmp             tests   
17CA 020000   F     3783     left_s:         jmp                     left_sk
17CD B63149         3784     labelS1:        cjne            @r0,#31h,me_41
17D0 75B0FB         3785                                             mov                     p3,#0fbh                   
                                  ;<-
17D3 30B7F4         3786                                             jnb                     p3.7,left_s
17D6 75B0F7         3787                                             mov                     p3,#0f7h
17D9 20B7CF         3788                                             jb                      p3.7,onmem12
                    3789                                             ;запомнить признак установленной скорости в рпзу
                    3790     
                    3791     ;чтение пам прогр(5000h) 1 страница(ffh)
                    3792     ;и запись во внешнее озу(0000h)
17DC 7900           3793                                             mov             r1,#0                   ;
17DE 7A50           3794                                     mov             r2,#50h
17E0 7B00           3795                                     mov             r3,#00
17E2 120499         3796                                     call    copyPP
                    3797                                     ;внести изменения во внешн озу
                    3798                                     ;KD=00 01 86 A0 (KD=1)
                    3799                                     ;кофф *100000 и переведенный в hex формат
                    3800                                     ;согласно адресов диапазонов и адресов яч вн озу 
17E5 792C           3801                                     mov             r1,#2ch
17E7 7400           3802                                     mov             a,#0;57,6
17E9 301302         3803                                     jnb             bitv19,spwri
17EC 7401           3804                                     mov             a,#1;19.6
17EE F3             3805     spwri:  movx    @r1,a
                    3806     ;стереть страницу пап прогр 
17EF 905000         3807                                     mov             dptr,#5000h
17F2 7FFF           3808                                     mov             r7,#0ffh
17F4 12043E         3809                                     call    cle256
                    3810     ;и запись в ячейки кофф памяти прогр (3000h) 
17F7 7FFF           3811                                     mov             r7,#0ffh
17F9 7900           3812                                     mov             r1,#0                           ;external r
                             am
17FB 905000         3813                                     mov             dptr,#5000h
17FE 120480         3814                                     call    wrpage
                    3815             
1801 201305         3816                                     jb              bitv19,outsko1  ;загр Т1 в соотв с установл
                             енной скоростью
1804 758DF4         3817                                             mov                     TH1,#244                ;57
                             .6
1807 8003           3818                                             jmp                     outsko
1809 758DDC         3819     outsko1:                                        mov                     TH1,#220           
                                  ;19.6
180C C211           3820     outsko:         clr             bitmenu
180E D204           3821                                             setb            bitizm
1810 020000   F     3822                                             jmp                     out7
                    3823     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    61

1813 020000   F     3824     rlabels4:               jmp             labels4
1816 020000   F     3825     rlabelS13:      jmp             labelS13
                    3826     
1819 B651F7         3827     me_41:          cjne            @r0,#51h,rlabels4
181C 75B0FB         3828                                             mov             p3,#0fbh;<-
181F 30B7F4         3829                                             jnb             p3.7,rlabelS13
1822 75B0F7         3830                                             mov             p3,#0f7h
1825 20B76D         3831                                             jb              p3.7,vvmenu
                    3832                                             ;ввод пароля
                    3833                                     
                    3834     ;       считать с индикатора 
1828 7F0E           3835                                     mov             r7,#14
182A 784F           3836                                     mov             r0,#abin
182C 120000   F     3837                                     call    clearN                  
                    3838                                     
                    3839     ;чтение номера байта с индикатора(3байта)
                    3840     ;bufind+3..bufind+9
                    3841     ;-  - - -
                    3842     ;- - - - - - - - - -
                    3843     ;adec..adec+9
                    3844     ;ст            мл
182F 7849           3845                                     mov             r0,#bufind+9;
1831 795C           3846                                     mov             r1,#adec+9
1833 7F03           3847                                     mov             r7,#3;3bait
1835 C3             3848     upav1:          clr             c
1836 E6             3849                                     mov             a,@r0
1837 9430           3850                                     subb    a,#30h
1839 F7             3851                                     mov             @r1,a
183A 18             3852                                     dec             r0
183B 19             3853                                     dec             r1
183C DFF7           3854                                     djnz    r7,upav1;adec+7..adec+9
183E 7A50           3855                                             mov                     r2,#50h                    
                                  ;parol 000x    (5028h )
1840 7B28           3856                                             mov                     r3,#28h
1842 120454         3857                                             call            re4byte                 ;r8..r11(3 
                             bait parol)
1845 800F           3858     jmp                     goparol
1847 E508           3859                                     mov                     a,r8                    ;сравнить п
                             ароль с индикатором
1849 B55A4C         3860                                     cjne            a,adec+7,parerr
184C E509           3861                                     mov                     a,r9    
184E B55B47         3862                                     cjne            a,adec+8,parerr
1851 E50A           3863                                     mov                     a,r10
1853 B55C42         3864                                     cjne            a,adec+9,parerr
                    3865                                     ;равны
1856 78B1           3866     goparol:        mov             r0,#vichR               ;режим меню 52
1858 7652           3867                                             mov             @r0,#52h                ;0000-n
185A 900000   F     3868                                             mov             dptr,#teKD;00000-nA
185D 120000   F     3869                                             call            lotext
                    3870                                             ;;;;;;;;;
                    3871                                                     ;n(hex)->abin
1860 120000   F     3872                                             call    findR                           ;a=2(10-2).
                             ..11(10-11)
1863 2552           3873                                             add             a,abin+3
1865 F552           3874                                             mov             abin+3,a
1867 7853           3875                                             mov             r0,#adec
1869 7952           3876                                             mov             r1,#abin+3      ;hex->10
186B 120000   F     3877                                             call    bindec
186E 855C48         3878                                             mov             bufind+8,adec+9
1871 75472D         3879                                             mov             bufind+7,#2dh
                    3880     
1874 79AE           3881                                             mov             r1,#diap
1876 7848           3882                                             mov             r0,#bufind+8
1878 E7             3883                                             mov             a,@r1
1879 B40807         3884                                             cjne    a,#8,nodi8k
187C 7630           3885                                             mov             @r0,#30h                 ;10-10
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    62

187E 18             3886                                             dec             r0
187F 7663           3887                                             mov             @r0,#63h;31h
1881 8008           3888                                             jmp             nodisk9
1883 B40905         3889     nodi8k:                         cjne    a,#9,nodisk9
                    3890                                     
1886 7631           3891                                             mov             @r0,#31h           ;10-11
1888 18             3892                                             dec             r0
1889 7663           3893                                             mov             @r0,#63h;31h
                    3894                                     
                    3895     
188B 78B2           3896     nodisk9:        mov                     r0,#marker
188D 7601           3897                                             mov                     @r0,#1
188F 753A01         3898                                             mov                     movleft,#1
1892 753B05         3899                                             mov                     movrig,#5
                    3900                                             
1895 020000   F     3901     vvmenu:         jmp             goto7
                    3902     
1898 753932         3903     parerr:         mov                     nuerr,#32h
189B 120000   F     3904                                             call            error
189E 120000   F     3905                                             call            ind
18A1 120000   F     3906                                             call            z_1s
18A4 C211           3907                                             clr                     bitmenu
18A6 D204           3908                                             setb            bitizm
18A8 78B2           3909                                             mov                     r0,#marker
18AA 76FF           3910                                             mov                     @r0,#0ffh
18AC 020000   F     3911                                             jmp             goto7
                    3912     
18AF 30130B         3913     left_sk:                jnb                     bitv19,tosk19;<-
18B2 900000   F     3914                                             mov                     dptr,#teS57_6;57,6
18B5 120000   F     3915                                             call            lotext
18B8 C213           3916                                             clr                     bitv19
18BA 020000   F     3917                                             jmp             out7
18BD 900000   F     3918     tosk19:         mov                     dptr,#teS19_2
18C0 120000   F     3919                                             call            lotext
18C3 D213           3920                                             setb            bitv19
18C5 020000   F     3921                                             jmp             out7
                    3922     
18C8                3923     labelS13:;<- MENU(ПАРОЛЬ 000)
                    3924             
                    3925     ;;;;;;;;;;;;;;;;;;
                    3926     ;необходимо не портить цифру в следуюем справа знакоместе
                    3927     ;т е сохранить ее в ячейке для мигания в противном случае
                    3928     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3929     ;       знакоместа
18C8 78B2           3930                                     mov             r0,#marker
18CA 7440           3931                                     mov             a,#bufind
18CC 26             3932                                             add             a,@r0                   ;a=bufind+m
                             arker
18CD F9             3933                                             mov             r1,a
18CE 19             3934                                             dec             r1;inc          r1
18CF 873C           3935                                             mov             savba,@r1
                    3936                                                     
18D1 78B2           3937                                                     mov             r0,#marker
18D3 16             3938                                                     dec             @r0                        
                                  
18D4 C219           3939                                     clr             bitmig
18D6 E53A           3940                                     mov                     a,movleft
18D8 B6064F         3941                                     cjne    @r0,#6,onmem13;;нажата кн <- при вводе цифр ПАРОЛЬ 
                             000
18DB 06             3942                                     inc             @r0
18DC 020000   F     3943                                             jmp             goto7
                    3944     ;;;;;;;
                    3945     
18DF                3946     vvkali52:       ;введено значение для калибровки
                    3947                                             ;число на индикаторе ->Ak  (52h)
                    3948                                             ;       считать с индикатора 
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    63

18DF 7F0E           3949                                     mov             r7,#14
18E1 784F           3950                                     mov             r0,#abin
18E3 120000   F     3951                                     call    clearN                  
                    3952                                     
                    3953     ;чтение номера байта с индикатора(3байта)
                    3954     ;bufind+1..bufind+5
                    3955     ;-  - - -
                    3956     ;- - - - - - - - - -
                    3957     ;adec..adec+9
                    3958     ;ст            мл
18E6 7845           3959                                     mov             r0,#bufind+5;
18E8 795C           3960                                     mov             r1,#adec+9
18EA 7F05           3961                                     mov             r7,#5;5bait
18EC C3             3962     upav2:          clr             c
18ED E6             3963                                     mov             a,@r0
18EE 9430           3964                                     subb    a,#30h
18F0 F7             3965                                     mov             @r1,a
18F1 18             3966                                     dec             r0
18F2 19             3967                                     dec             r1
18F3 DFF7           3968                                     djnz    r7,upav2;adec+7..adec+9
                    3969     
18F5 784F           3970                                     mov             r0,#abin
18F7 7953           3971                                     mov             r1,#adec                        ;мл        
                              ст
18F9 120000   F     3972                                     call    decbin                  ;abin..abin+3 (hex)
18FC 120000   F     3973                                     call    loadr2                  ;r2..r5
18FF 120402         3974                                     call    altof   ;r2..r5->float
1902 900000   F     3975                                     mov     dptr,#ch_10;10
1905 120000   F     3976                                     call    ldc_ltemp                       ;r8..r11=8
1908 120203         3977                                     call    flmul
190B 78A4           3978                                     mov             r0,#rez_Ak
190D 120000   F     3979                                     call    saver2
1910 C211           3980                                             clr                     bitmenu
1912 D212           3981                                             setb            bitklb
                    3982                                             ;зажечь KMП
1914 D204           3983                                             setb            bitizm;бит калибровки уже установле
                             н
1916 78B2           3984                                             mov                     r0,#marker
1918 76FF           3985                                             mov                     @r0,#0ffh
191A 783D           3986                                     mov             r0,#chkl
191C 76FF           3987                                     mov             @r0,#0ffh
191E 08             3988                                     inc             r0
191F 76FF           3989                                     mov             @r0,#0ffh;38h
1921 120000   F     3990                                     call            z_1s
1924 020000   F     3991                                     jmp             out7
                    3992     
                    3993     
1927 020000   F     3994                                             jmp             goto7
                    3995                                              
192A 020000   F     3996     onmem13:        jmp             goto7   ;(ie7)
                    3997     
192D B642AF         3998     labels4:        cjne            @r0,#42h,vvkali52
1930 75B0FB         3999                                             mov                     p3,#0fbh;<-
1933 30B7F4         4000                                             jnb             p3.7,onmem13
1936 75B0F7         4001                                             mov             p3,#0f7h;vvod
1939 20B7EE         4002                                             jb              p3.7,onmem13
                    4003                                             
                    4004             
193C 020000   F     4005     jmp             out7                                                    
                    4006     ;;;;;;;
193F                4007     labelI:
193F 75B0FE         4008                                     mov             p3,#0feh
1942 E5B0           4009                                     mov             a,p3
1944 20E703         4010                                     jb              acc.7,nopoint
                    4011                                     ;
1947 020000   F     4012                                     jmp             goto7;out7
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    64

                    4013     
194A 75B0FB         4014     nopoint:                mov             p3,#0fbh
194D E5B0           4015                                     mov             a,p3
194F 20E72C         4016                                     jb              acc.7,nopoin7
1952 78B2           4017     labelS3:mov             r0,#marker
1954 E53A           4018                                     mov             a,movleft
1956 B40309         4019                                     cjne    a,#3,poina1
1959 B6030B         4020                                     cjne    @r0,#3,nomarl;26
                    4021                                     ;mov            @r0,#9
195C E53B           4022     poina2: mov                     a,movrig                ;кн <- B=+00000
195E F6             4023                                     mov                     @r0,a
195F 020000   F     4024                                     jmp             goto7;  out7
                    4025     
1962 B60402         4026     poina1:         cjne    @r0,#4,nomarl;кн <- A= 0000
1965 80F5           4027                                             jmp             poina2
                    4028     
                    4029     
1967                4030     nomarl:                 ;                               29.12.06
                    4031     ;;;;;;;;;;;;;;;;;;
                    4032     ;необходимо не портить цифру в следуюем справа знакоместе
                    4033     ;т е сохранить ее в ячейке для мигания в противном случае
                    4034     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    4035     ;       знакоместа
1967 78B2           4036                                     mov             r0,#marker
1969 7440           4037                                     mov             a,#bufind
196B 26             4038                                             add             a,@r0                   ;a=bufind+m
                             arker
196C F9             4039                                             mov             r1,a
196D 09             4040                                             inc             r1
196E 873C           4041                                             mov             savba,@r1
                    4042                                                     
1970 78B2           4043                                                     mov             r0,#marker
1972 16             4044                                                     dec             @r0                        
                                  
1973 C219           4045                                     clr             bitmig
1975 E53A           4046                                     mov                     a,movleft
1977 B40340         4047                                     cjne            a,#3,poinA
197A B60270         4048                                     cjne    @r0,#2,out7;;нажата кн <- при вводе цифр B=+00000
197D 06             4049     poin3:  inc             @r0
                    4050     ;нажат ввод А =000000 запомнить константу А
197E 75B0F7         4051     nopoin7:           mov          p3,#0f7h
1981 E5B0           4052                                     mov             a,p3
1983 20E767         4053                                     jb              acc.7,out7
1986 78B1           4054                                     mov             r0,#vichR
1988 E6             4055                                     mov             a,@r0
1989 B62133         4056                                     cjne    @r0,#21h,no21p7
198C 7611           4057                                     mov             @r0,#11h
                    4058                             ;       считать с индикатора  упаковать в плавающий формат
                    4059                             ;   сохранить
198E 7F0E           4060                                     mov             r7,#14
1990 784F           4061                                     mov             r0,#abin
1992 120000   F     4062                                     call    clearN                  
1995 120000   F     4063                                     call    upakA
                    4064                                     
1998 784F           4065                                     mov             r0,#abin
199A 7953           4066                                     mov             r1,#adec                        ;мл        
                              ст
199C 120000   F     4067                                     call    decbin                  ;abin..abin+3 (hex)
199F 120000   F     4068                                     call    loadr2                  ;r2..r5
19A2 120402         4069                                     call    altof                   ;r2..r5->int
19A5 78BC           4070                                     mov             r0,#konstA
19A7 120000   F     4071                                     call    saver2
                    4072     ;26
19AA 78B2           4073                                     mov             r0,#marker
19AC 76FF           4074                                     mov             @r0,#0ffh
                    4075                                     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    65

19AE 900000   F     4076                                     mov             dptr,#teVICH;teBequ0
19B1 120000   F     4077                                     call    lotext
                    4078                             ;       call            outB
19B4 534BBF         4079                                     anl             bufind+11,#0bfh         ;гашение точки bufi
                             nd+7
                    4080                             ;       orl             bufind+11,#80h
19B7 020000   F     4081                                     jmp             goto7;out7
                    4082     
19BA B60330         4083     poinA:          cjne    @r0,#3,out7;;нажата кн <- при вводе цифр A= 0000
19BD 80BE           4084                                             jmp             poin3
                    4085     
19BF                4086     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    4087                             ;   сохранить
19BF 7F0E           4088                                     mov             r7,#14
19C1 784F           4089                                     mov             r0,#abin
19C3 120000   F     4090                                     call    clearN                  
19C6 120000   F     4091                                     call    upakB                   
19C9 784F           4092                                     mov             r0,#abin
19CB 7953           4093                                     mov             r1,#adec                        ;мл        
                              ст
19CD 120000   F     4094                                     call    decbin                  ;abin..abin+3 (hex)
19D0 120000   F     4095                                     call    loadr2                  ;r2..r5
19D3 120402         4096                                     call    altof                   ;r2..r5->int
19D6 301B04         4097                                     jnb             bitznB,pozB
19D9 EA             4098                                     mov             a,r2
19DA 4480           4099                                     orl             a,#80h
19DC FA             4100                                     mov             r2,a                    ;знак-
19DD 78C0           4101     pozB:           mov             r0,#konstB
19DF 120000   F     4102                                     call    saver2
                    4103     
19E2 79B2           4104                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
19E4 77FF           4105                                     mov             @r1,#0ffh
19E6 78B1           4106                                     mov             r0,#vichR
19E8 7611           4107                                     mov             @r0,#11h
19EA 020000   F     4108                               jmp           lovich     ;3.01.07ВЫЧИСЛИТЬ
                    4109                                     
                    4110     
19ED                4111     out7:                   ;mov            IE,#80h
19ED D083           4112                                     pop             dph
19EF D082           4113                                     pop             dpl
19F1 D007           4114                                     pop             rr7     
19F3 D006           4115                                     pop             rr6
19F5 D005           4116                                     pop             rr5
19F7 D004           4117                                     pop             rr4
19F9 D003           4118                                     pop             rr3
19FB D002           4119                                     pop             rr2
19FD D001           4120                                     pop             rr1                             
19FF D000           4121                                     pop             rr0
1A01 D0D0           4122                                     pop             psw
1A03 D0E0           4123                                     pop             acc
1A05 E5AD           4124                                     mov             a,P3IF
1A07 547F           4125                                     anl             a,#7fh
1A09 F5AD           4126                                     mov             P3IF,a
1A0B 75B0C0         4127                                     mov             P3,#0c0h
                    4128     ;clr            bitmig
1A0E 75E730         4129                                     mov             EIE2,#30H
1A11 C219           4130     clr             bitmig
1A13 32             4131                                     reti
                    4132     
                    4133     
                    4134                                     
                    4135     
                    4136     
1A14 78B1           4137     lomenu:         mov             r0,#vichR
1A16 B61107         4138                                             cjne    @r0,#11h,menu12
1A19 900000   F     4139                                             mov             dptr,#teTESI
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    66

1A1C 120000   F     4140     lome1:                  call    lotexT
1A1F 22             4141                                             ret
1A20 B61205         4142     menu12:         cjne    @r0,#12h,menu13
1A23 900000   F     4143                                             mov             dptr,#teTESR
1A26 80F4           4144                                             jmp             lome1
1A28 B61305         4145     menu13:         cjne    @r0,#13h,menu14
1A2B 900000   F     4146                                             mov             dptr,#teSKOR
1A2E 80EC           4147                                             jmp             lome1
1A30 B61405         4148     menu14:         cjne    @r0,#14h,menu15
1A33 900000   F     4149                                             mov             dptr,#teAVK
1A36 80E4           4150                                             jmp             lome1
1A38 B61505         4151     menu15:                 cjne    @r0,#15h,menu21
1A3B 900000   F     4152                                             mov             dptr,#teKALIB
1A3E 80DC           4153                                             jmp             lome1
                    4154     
1A40 B62105         4155     menu21: cjne    @r0,#21h,menu22
1A43 900000   F     4156                                             mov             dptr,#teTE11
1A46 80D4           4157                                             jmp             lome1
1A48 B62205         4158     menu22:         cjne    @r0,#22h,menu23
1A4B 900000   F     4159                                             mov             dptr,#teTE9
1A4E 80CC           4160                                             jmp             lome1
1A50 B62305         4161     menu23:         cjne    @r0,#23h,menu31
1A53 900000   F     4162                                             mov             dptr,#teTE7
1A56 80C4           4163                                             jmp             lome1
1A58 B63105         4164     menu31:         cjne    @r0,#31h,menu41
1A5B 900000   F     4165                                             mov             dptr,#teS57_6
1A5E 80BC           4166                                             jmp             lome1
                    4167     
1A60                4168     menu41:         
1A60 900000   F     4169                                             mov             dptr,#tePAR
1A63 80B7           4170                                             jmp             lome1
                    4171     
                    4172     
1A65                4173     endkalib:;KD=Ak/A3
1A65 789C           4174                                             mov                     r0,#rez_A3
1A67 120000   F     4175                                             call            resar2
                    4176                                     
1A6A 120402         4177                                     call    altof                   ;->float
1A6D EA             4178                                             mov                     a,r2
1A6E 547F           4179                                             anl                     a,#7fh
1A70 FA             4180                                             mov                     r2,a
1A71 120000   F     4181                                     call            move28
1A74 78A4           4182                                             mov                     r0,#rez_Ak
1A76 120000   F     4183                                             call            resar2
1A79 1202B7         4184                                             call            fldiv
                    4185                                                     
1A7C 900000   F     4186                                     mov     dptr,#CHtho;100000
1A7F 120000   F     4187                                     call    ldc_ltemp                       ;r8..r11=8
1A82 120203         4188                                     call    flmul
1A85 120343         4189                                     call    ftol            ;r2..r5->hex кофф KD (РЕЗ ИЗМ ЧИСЛО
                              6разрядное)
                    4190     
1A88 78A0           4191                                             mov                     r0,#koefKD
1A8A 120000   F     4192                                             call            saver2
                    4193                                             ;запись в рпзу в соотв ячейку
                    4194                             
1A8D 7900           4195                                             mov             r1,#0                   ;счит рпзу 
                             во внешн озу
1A8F 7A50           4196                                     mov             r2,#50h
1A91 7B00           4197                                     mov             r3,#00
1A93 120499         4198                                     call    copyPP
                    4199                                     ;внести изменения во внешн озу
1A96 120000   F     4200                                     call            findext                 ;r1-внешн озу
1A99 78A0           4201                                     mov                     r0,#koefKD
1A9B 120000   F     4202                                             call            resar2
1A9E EA             4203                                             mov                     a,r2
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    67

1A9F F3             4204                                             movx            @r1,a
1AA0 09             4205                                             inc                     r1
1AA1 EB             4206                                             mov                     a,r3
1AA2 F3             4207                                             movx            @r1,a
1AA3 09             4208                                             inc                     r1
1AA4 EC             4209                                             mov                     a,r4
1AA5 F3             4210                                             movx            @r1,a
1AA6 09             4211                                             inc                     r1
1AA7 ED             4212                                             mov                     a,r5
1AA8 F3             4213                                             movx            @r1,a
                    4214                                     ;кофф *100000 и переведенный в hex формат
                    4215                                     ;согласно адресов диапазонов и адресов яч вн озу 
                    4216     ;стереть страницу пап прогр 
1AA9 905000         4217                                     mov             dptr,#5000h
1AAC 7FFF           4218                                     mov             r7,#0ffh
1AAE 12043E         4219                                     call    cle256
                    4220     ;и запись в ячейки кофф памяти прогр (3000h) 
1AB1 7FFF           4221                                     mov             r7,#0ffh
1AB3 7900           4222                                     mov             r1,#0                           ;external r
                             am
1AB5 905000         4223                                     mov             dptr,#5000h
1AB8 120480         4224                                     call    wrpage
                    4225     
                    4226     
1ABB C212           4227                                             clr             bitklb
1ABD D216           4228                                             setb    bitpar                  ;пароль провели 1 р
                             аз успешно
1ABF 900000   F     4229                                             mov             dptr,#teEND
1AC2 120000   F     4230                                             call    lotext
1AC5 120000   F     4231                                             call    ind
1AC8 120000   F     4232                                             call    z_1s
1ACB 120000   F     4233                                             call    z_1s
1ACE 020000   F     4234                                             jmp             goto7
                    4235     
                    4236     ;выч среднего по блоку
                    4237     ;вых r2..r5
1AD1                4238     vichmean:       
1AD1 120000   F     4239                                             call            resa_hl;save_bl->dptr
1AD4 78D7           4240                                             mov                     r0,#copy_hl
1AD6 E583           4241                                             mov                     a,dph
1AD8 F6             4242                                             mov                     @r0,a
1AD9 08             4243                                             inc                     r0
1ADA E582           4244                                             mov                     a,dpl
1ADC F6             4245                                             mov                     @r0,a
1ADD 78B8           4246                                             mov                     r0,#work
1ADF 120000   F     4247                                             call            clear4
1AE2 78D6           4248                                             mov                     r0,#chblok;volume
1AE4 7600           4249                                             mov                     @r0,#0
1AE6 120000   F     4250     meng:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1AE9 E582           4251                                             mov                     a,dpl
1AEB FF             4252                                             mov                     r7,a
1AEC E583           4253                                             mov                     a,dph
1AEE FE             4254                                             mov                     r6,a
                    4255     
1AEF 78D7           4256                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1AF1 E6             4257                                             mov                     a,@r0
1AF2 F583           4258                                             mov                     dph,a
1AF4 08             4259                                             inc                     r0
1AF5 E6             4260                                             mov                     a,@r0
1AF6 F582           4261                                             mov                     dpl,a
                    4262                                             
1AF8 C3             4263                                             clr                     c;-4
1AF9 E582           4264                                             mov                     a,dpl
1AFB 9404           4265                                             subb            a,#4
1AFD F582           4266                                             mov                     dpl,a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    68

1AFF E583           4267                                             mov                     a,dph
1B01 9400           4268                                             subb            a,#0
1B03 F583           4269                                             mov                     dph,a;dptr-4
                    4270                                             ;;;;;;;;
1B05 79D7           4271                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1B07 E583           4272                                                     mov             a,dph
1B09 F7             4273                                               mov           @r1,a
1B0A 09             4274                                                     inc             r1
1B0B E582           4275                                                     mov             a,dpl
1B0D F7             4276                                                     mov             @r1,a
                    4277                                                     ;;;;;;;;;
1B0E C3             4278                                                     clr             c;пришли в начало блока?
1B0F E582           4279                                                     mov                     a,dpl
1B11 9F             4280                                                     subb            a,r7
1B12 FF             4281                                                     mov                     r7,a
1B13 7006           4282                                                     jnz                     nextmea
1B15 E583           4283                                                     mov                     a,dph
1B17 9E             4284                                                     subb            a,r6
1B18 FE             4285                                                     mov                     r6,a
1B19 601B           4286                                                     jz                      outmea;
                    4287                                                     
                    4288                                                     ;продолжаем сравнение
                    4289                                                     ;;;;;;;;;;;             
1B1B 120000   F     4290     nextmea:                call            loahl_r2        ;из яч внешн озу ->r2..r5
1B1E 120402         4291                                             call            altof;->float
1B21 120000   F     4292                                             call            move28                  ;r8..r11
1B24 78B8           4293                                             mov                     r0,#work
1B26 120000   F     4294                                             call            resar2
1B29 120166         4295                                             call            fladd
1B2C 78B8           4296                                             mov                     r0,#work
1B2E 120000   F     4297                                             call            saver2
1B31 78D6           4298                                             mov                     r0,#chblok;volume;кол измер
                             ений блока
1B33 06             4299                                             inc                     @r0
1B34 80B0           4300                                             jmp                     meng
1B36                4301     outmea:         
1B36 120000   F     4302                                             call            loahl_r2        ;из яч внешн озу ->
                             r2..r5
1B39 120402         4303                                             call            altof;->float
1B3C 120000   F     4304                                             call            move28                  ;r8..r11
1B3F 78B8           4305                                             mov                     r0,#work
1B41 120000   F     4306                                             call            resar2
1B44 120166         4307                                             call            fladd
1B47 78B8           4308                                             mov                     r0,#work
1B49 120000   F     4309                                             call            saver2
1B4C E4             4310                                             clr                     a
1B4D FA             4311                                             mov                     r2,a
1B4E FB             4312                                             mov                     r3,a
1B4F FC             4313                                             mov                     r4,a
1B50 78D6           4314                                             mov                     r0,#chblok;volume;кол измер
                             ений блока...200d
1B52 E6             4315                                             mov                     a,@r0
1B53 2401           4316                                             add                     a,#1
1B55 FD             4317                                             mov                     r5,a
1B56 120402         4318                                             call            altof;r2..r5 float
1B59 120000   F     4319                                             call            move28
1B5C 78B8           4320                                             mov                     r0,#work
1B5E 120000   F     4321                                             call            resar2
1B61 1202B7         4322                                             call            fldiv
1B64 900000   F     4323                                             mov                     dptr,#ch_10      
1B67 120000   F     4324                                     call            ldc_ltemp
1B6A 1202B7         4325                                     call            fldiv
1B6D 120343         4326                                             call            ftol                            ;->
                             hex
1B70 120000   F     4327                                             call    maform
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    69

1B73 784F           4328                                             mov             r0,#abin
1B75 120000   F     4329                                             call    saver2
                    4330     ;;;;;;;;
                    4331                                             
1B78 7853           4332                                             mov             r0,#adec
1B7A 7952           4333                                             mov             r1,#abin+3      ;hex->10
1B7C 120000   F     4334                                             call    bindec
                    4335                                     
1B7F 785C           4336                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1B81 7949           4337                                             mov             r1,#bufind+9
1B83 7F05           4338                                             mov             r7,#5
1B85 E6             4339     bufmea:                         mov             a,@r0
1B86 2430           4340                                             add             a,#30h
1B88 F7             4341                                             mov             @r1,a
1B89 19             4342                                             dec             r1
1B8A 18             4343                                             dec             r0
1B8B DFF8           4344                                             djnz    r7,bufmea
1B8D 7844           4345                                             mov             r0,#bufind+4
1B8F 762B           4346                                             mov             @r0,#2bh          
1B91 300202         4347                                             jnb             znmat,nozmea
1B94 762D           4348                                             mov             @r0,#2dh
1B96 434B05         4349     nozmea:         orl             bufind+11,#05h
1B99 22             4350                                             ret
                    4351     
                    4352     
1B9A E0             4353     loahl_r2:       movx            a,@dptr         ;из яч внешн озу ->r2..r5
1B9B FA             4354                                             mov                     r2,a
1B9C A3             4355                                             inc                     dptr
1B9D E0             4356                                             movx            a,@dptr
1B9E FB             4357                                             mov                     r3,a
1B9F A3             4358                                             inc                     dptr
1BA0 E0             4359                                             movx            a,@dptr
1BA1 FC             4360                                             mov                     r4,a
1BA2 A3             4361                                             inc                     dptr
1BA3 E0             4362                                             movx            a,@dptr
1BA4 FD             4363                                             mov                     r5,a    
1BA5 22             4364                                             ret
                    4365     
1BA6 C3             4366     min4_hl:        clr                     c;-4
1BA7 E582           4367                                             mov                     a,dpl
1BA9 9404           4368                                             subb            a,#4
1BAB F582           4369                                             mov                     dpl,a
1BAD E583           4370                                             mov                     a,dph
1BAF 9400           4371                                             subb            a,#0
1BB1 F583           4372                                             mov                     dph,a;dptr-4
1BB3 22             4373                                             ret
                    4374     
                    4375     ;мин значение по по блоку
1BB4                4376     vichmin:        
1BB4 120000   F     4377                                             call            resa_hl;save_bl->dptr
                    4378                                                                                     
                    4379     ;с конца блока адрес 2го измерение
1BB7 120000   F     4380                                             call            min4_hl
                    4381                                             
1BBA 78B8           4382                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4383                                             
1BBC E0             4384                                             movx            a,@dptr
1BBD F6             4385                                             mov                     @r0,a
1BBE 08             4386                                             inc                     r0
1BBF A3             4387                                             inc                     dptr
1BC0 E0             4388                                             movx            a,@dptr
1BC1 F6             4389                                             mov                     @r0,a
1BC2 08             4390                                             inc                     r0
1BC3 A3             4391                                             inc                     dptr
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    70

1BC4 E0             4392                                             movx            a,@dptr
1BC5 F6             4393                                             mov                     @r0,a
1BC6 08             4394                                             inc                     r0
1BC7 A3             4395                                             inc                     dptr
1BC8 E0             4396                                             movx            a,@dptr
1BC9 F6             4397                                             mov                     @r0,a
1BCA A3             4398                                             inc                     dptr
                    4399                                             
1BCB 78B8           4400                                             mov                     r0,#work
1BCD 120000   F     4401                                             call            resar2
1BD0 120402         4402                                             call            altof;->float;r2..r5
1BD3 78B8           4403                                             mov                     r0,#work
1BD5 120000   F     4404                                             call            saver2
                    4405     
1BD8 120000   F     4406                                             call            min4_hl
                    4407                                             ;call           min4_hl
                    4408     
1BDB 78D7           4409                                             mov                     r0,#copy_hl
1BDD E583           4410                                             mov                     a,dph
1BDF F6             4411                                             mov                     @r0,a
1BE0 08             4412                                             inc                     r0
1BE1 E582           4413                                             mov                     a,dpl
1BE3 F6             4414                                             mov                     @r0,a
                    4415                                     
1BE4 78D6           4416                                             mov                     r0,#chblok;volume
1BE6 7600           4417                                             mov                     @r0,#0
1BE8 120000   F     4418     ming:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1BEB E582           4419                                             mov                     a,dpl
1BED FF             4420                                             mov                     r7,a
1BEE E583           4421                                             mov                     a,dph
1BF0 FE             4422                                             mov                     r6,a
                    4423     
1BF1 78D7           4424                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1BF3 E6             4425                                             mov                     a,@r0
1BF4 F583           4426                                             mov                     dph,a
1BF6 08             4427                                             inc                     r0
1BF7 E6             4428                                             mov                     a,@r0
1BF8 F582           4429                                             mov                     dpl,a
                    4430                                             
1BFA C3             4431                                             clr                     c;-4
1BFB E582           4432                                             mov                     a,dpl
1BFD 9404           4433                                             subb            a,#4
1BFF F582           4434                                             mov                     dpl,a
1C01 E583           4435                                             mov                     a,dph
1C03 9400           4436                                             subb            a,#0
1C05 F583           4437                                             mov                     dph,a;dptr-4
                    4438                                             ;;;;;;;;
1C07 79D7           4439                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1C09 E583           4440                                                     mov             a,dph
1C0B F7             4441                                               mov           @r1,a
1C0C 09             4442                                                     inc             r1
1C0D E582           4443                                                     mov             a,dpl
1C0F F7             4444                                                     mov             @r1,a
                    4445                                                     ;;;;;;;;;
1C10 C3             4446                                                     clr             c;пришли в начало блока?
1C11 E582           4447                                                     mov                     a,dpl
1C13 9F             4448                                                     subb            a,r7
1C14 FF             4449                                                     mov                     r7,a
1C15 7006           4450                                                     jnz                     nextmin
1C17 E583           4451                                                     mov                     a,dph
1C19 9E             4452                                                     subb            a,r6
1C1A FE             4453                                                     mov                     r6,a
1C1B 601D           4454                                                     jz                      outmin;
                    4455                                                     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    71

                    4456                                                     ;продолжаем сравнение
                    4457                                                     ;;;;;;;;;;;             
1C1D 78B8           4458     nextmin:        mov                     r0,#work
1C1F 120000   F     4459                                             call            resar2
                    4460                                             ;call           altof;->float;r2..r5
1C22 120000   F     4461                                             call            move28;->r8..r11
1C25 120000   F     4462                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4463     
1C28 120402         4464                                             call            altof;->float;r2..r5
                    4465                                             
1C2B 1201D6         4466                                             call            flcmp
1C2E 5005           4467                                             jnc                     nomini
1C30 78B8           4468                                             mov                     r0,#work;<
1C32 120000   F     4469                                             call            saver2;r2..r5
1C35 78D6           4470     nomini:                 mov                     r0,#chblok;volume;кол измерений блока
1C37 06             4471                                             inc                     @r0
1C38 80AE           4472                                             jmp                     ming
                    4473     
1C3A 78B8           4474     outmin:         mov                     r0,#work;1ое измерение блока
1C3C 120000   F     4475                                             call            resar2
                    4476                                     ;       call            altof;->float;r2..r5
1C3F 120000   F     4477                                             call            move28;->r8..r11
1C42 120000   F     4478                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4479     
1C45 120402         4480                                             call            altof;->float;r2..r5
                    4481                                             
1C48 1201D6         4482                                             call            flcmp
1C4B 5005           4483                                             jnc                     minivix
1C4D 78B8           4484                                             mov                     r0,#work;<
1C4F 120000   F     4485                                             call            saver2;r2..r5
                    4486                                             ;;;;;;;;;
                    4487     
1C52 78B8           4488     minivix:        mov                     r0,#work
1C54 120000   F     4489                                             call            resar2
                    4490     
                    4491                                             ;call           altof;->float
                    4492                                     
1C57 900000   F     4493                                             mov                     dptr,#ch_10      
1C5A 120000   F     4494                                             call            ldc_ltemp
1C5D 1202B7         4495                                             call            fldiv
1C60 120343         4496                                             call            ftol                            ;->
                             hex
                    4497                                             ;;;
1C63 120000   F     4498                                             call            maform
1C66 784F           4499                                             mov                     r0,#abin
1C68 120000   F     4500                                             call            saver2
                    4501     ;;;;;;;;
                    4502                                             
1C6B 7853           4503                                             mov             r0,#adec
1C6D 7952           4504                                             mov             r1,#abin+3      ;hex->10
1C6F 120000   F     4505                                             call    bindec
                    4506                                     
1C72 785C           4507                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
1C74 7949           4508                                             mov             r1,#bufind+9
1C76 7F05           4509                                             mov             r7,#5
1C78 E6             4510     bufmin:                         mov             a,@r0
1C79 2430           4511                                             add             a,#30h
1C7B F7             4512                                             mov             @r1,a
1C7C 19             4513                                             dec             r1
1C7D 18             4514                                             dec             r0
1C7E DFF8           4515                                             djnz    r7,bufmin
1C80 7844           4516                                             mov             r0,#bufind+4
1C82 762B           4517                                             mov             @r0,#2bh          
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    72

1C84 300202         4518                                             jnb             znmat,nozmin
1C87 762D           4519                                             mov             @r0,#2dh
1C89 434B05         4520     nozmin:         orl             bufind+11,#05h
1C8C 22             4521                                             ret
                    4522     
                    4523     
                    4524     
                    4525     ;мин значение по по блоку
1C8D                4526     vichmax:        
1C8D 120000   F     4527                                             call            resa_hl;save_bl->dptr
                    4528                                             
                    4529                                             
                    4530     ;с конца блока адрес 2го измерение
1C90 120000   F     4531                                             call            min4_hl
                    4532                                             
1C93 78B8           4533                                                     mov                     r0,#work        ;бл
                             ок анализируется с конца 1я измерение загружается в work
                    4534                                             
1C95 E0             4535                                             movx            a,@dptr
1C96 F6             4536                                             mov                     @r0,a
1C97 08             4537                                             inc                     r0
1C98 A3             4538                                             inc                     dptr
1C99 E0             4539                                             movx            a,@dptr
1C9A F6             4540                                             mov                     @r0,a
1C9B 08             4541                                             inc                     r0
1C9C A3             4542                                             inc                     dptr
1C9D E0             4543                                             movx            a,@dptr
1C9E F6             4544                                             mov                     @r0,a
1C9F 08             4545                                             inc                     r0
1CA0 A3             4546                                             inc                     dptr
1CA1 E0             4547                                             movx            a,@dptr
1CA2 F6             4548                                             mov                     @r0,a
1CA3 A3             4549                                             inc                     dptr
                    4550                                             
1CA4 78B8           4551                                             mov                     r0,#work
1CA6 120000   F     4552                                             call            resar2
1CA9 120402         4553                                             call            altof;->float;r2..r5
1CAC 78B8           4554                                             mov                     r0,#work
1CAE 120000   F     4555                                             call            saver2
                    4556     
1CB1 120000   F     4557                                             call            min4_hl
                    4558                                     ;       call            min4_hl
                    4559     
1CB4 78D7           4560                                             mov                     r0,#copy_hl
1CB6 E583           4561                                             mov                     a,dph
1CB8 F6             4562                                             mov                     @r0,a
1CB9 08             4563                                             inc                     r0
1CBA E582           4564                                             mov                     a,dpl
1CBC F6             4565                                             mov                     @r0,a
                    4566                                     
1CBD 78D6           4567                                             mov                     r0,#chblok;volume
1CBF 7600           4568                                             mov                     @r0,#0
1CC1 120000   F     4569     maxg:                   call            adrblok;dptr-адр ячейки 1й соотв блока 
1CC4 E582           4570                                             mov                     a,dpl
1CC6 FF             4571                                             mov                     r7,a
1CC7 E583           4572                                             mov                     a,dph
1CC9 FE             4573                                             mov                     r6,a
                    4574     
1CCA 78D7           4575                                             mov                     r0,#copy_hl;call           
                                  resa_hl;save_bl->dptr
1CCC E6             4576                                             mov                     a,@r0
1CCD F583           4577                                             mov                     dph,a
1CCF 08             4578                                             inc                     r0
1CD0 E6             4579                                             mov                     a,@r0
1CD1 F582           4580                                             mov                     dpl,a
                    4581                                             
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    73

1CD3 C3             4582                                             clr                     c;-4
1CD4 E582           4583                                             mov                     a,dpl
1CD6 9404           4584                                             subb            a,#4
1CD8 F582           4585                                             mov                     dpl,a
1CDA E583           4586                                             mov                     a,dph
1CDC 9400           4587                                             subb            a,#0
1CDE F583           4588                                             mov                     dph,a;dptr-4
                    4589                                             ;;;;;;;;
1CE0 79D7           4590                                                     mov             r1,#copy_hl;saven_bl    ;со
                             хранить dptr 
1CE2 E583           4591                                                     mov             a,dph
1CE4 F7             4592                                               mov           @r1,a
1CE5 09             4593                                                     inc             r1
1CE6 E582           4594                                                     mov             a,dpl
1CE8 F7             4595                                                     mov             @r1,a
                    4596                                                     ;;;;;;;;;
1CE9 C3             4597                                                     clr             c;пришли в начало блока?
1CEA E582           4598                                                     mov                     a,dpl
1CEC 9F             4599                                                     subb            a,r7
1CED FF             4600                                                     mov                     r7,a
1CEE 7006           4601                                                     jnz                     nextmax
1CF0 E583           4602                                                     mov                     a,dph
1CF2 9E             4603                                                     subb            a,r6
1CF3 FE             4604                                                     mov                     r6,a
1CF4 601D           4605                                                     jz                      outmax;
                    4606                                                     
                    4607                                                     ;продолжаем сравнение
                    4608                                                     ;;;;;;;;;;;             
1CF6 78B8           4609     nextmax:        mov                     r0,#work
1CF8 120000   F     4610                                             call            resar2
                    4611                                             ;call           altof;->float;r2..r5
1CFB 120000   F     4612                                             call            move28;->r8..r11
1CFE 120000   F     4613                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4614     
1D01 120402         4615                                             call            altof;->float;r2..r5
                    4616                                             
1D04 1201D6         4617                                             call            flcmp
1D07 4005           4618                                             jc                      nomaxi
1D09 78B8           4619                                             mov                     r0,#work;>
1D0B 120000   F     4620                                             call            saver2;r2..r5
1D0E 78D6           4621     nomaxi:                 mov                     r0,#chblok;volume;кол измерений блока
1D10 06             4622                                             inc                     @r0
1D11 80AE           4623                                             jmp                     maxg
1D13 78B8           4624     outmax:         mov                     r0,#work;1ое измерение блока
1D15 120000   F     4625                                             call            resar2
                    4626                                     ;       call            altof;->float;r2..r5
1D18 120000   F     4627                                             call            move28;->r8..r11
1D1B 120000   F     4628                                             call            loahl_r2                ;из яч внеш
                             н озу ->r2..r5
                    4629     
1D1E 120402         4630                                             call            altof;->float;r2..r5
                    4631                                             
1D21 1201D6         4632                                             call            flcmp
1D24 4005           4633                                             jc                      maxvix
1D26 78B8           4634                                             mov                     r0,#work;>
1D28 120000   F     4635                                             call            saver2;r2..r5
                    4636                                             ;;;;;;;;;
                    4637     
1D2B 020000   F     4638     maxvix:         jmp             minivix
                    4639     
                    4640     
                    4641     
                    4642     
                    4643     ;$include (d:\amp\subr5.asm) 
                +1  4644     ;
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    74

                +1  4645     ;goprogr:       jmp     izm
                +1  4646     ;тест интерфейса
1D2E            +1  4647     testrs: ;jb     p0.3,goprogr
1D2E C2AC       +1  4648                                     clr     IE.4
1D30 759955     +1  4649     test1:  mov     SBUF0,#55h
1D33 3099FD     +1  4650                                     jnb     SCON0.1,$
1D36 78B8       +1  4651                                     mov     r0,#work;chtest
1D38 76BE       +1  4652                                     mov     @r0,#190d;60
                +1  4653     
1D3A 309825     +1  4654     test01: jnb     SCON0.0,test2
1D3D E599       +1  4655                                     mov     a,SBUF0
1D3F B45512     +1  4656                                     cjne    a,#55h,test3
1D42 C299       +1  4657     test4:  clr     SCON0.1
1D44 C298       +1  4658                                     clr     SCON0.0
1D46 7D0A       +1  4659                                     mov     r5,#10
1D48 7840       +1  4660                                     mov     r0,#bufind              ;- - - -
1D4A 762D       +1  4661     test04: mov     @r0,#2dh
1D4C 08         +1  4662                                     inc     r0
1D4D DDFB       +1  4663                                     djnz    r5,test04
1D4F 120000   F +1  4664                                     call    ind
1D52 80DC       +1  4665                                     jmp     test1
1D54            +1  4666     test3:  
1D54 753933     +1  4667                                     mov     nuerr,#33h
1D57 120000   F +1  4668                                     call    error           ;на кран прибора ERR 3
                +1  4669                             
1D5A 120000   F +1  4670                                     call    ind;
1D5D 120000   F +1  4671                                     call    z_01s           ;100ms
1D60 80E0       +1  4672                                     jmp     test4
1D62 78B8       +1  4673     test2:  mov     r0,#work;chtest
1D64 B60002     +1  4674                                     cjne    @r0,#0,test02
1D67 8003       +1  4675                                     jmp     test5
1D69 16         +1  4676     test02: dec     @r0
1D6A 80CE       +1  4677                                     jmp     test01
1D6C 120000   F +1  4678     test5:  call    z_1ms           ;1ms
1D6F C299       +1  4679                                     clr     SCON0.1
                +1  4680             
1D71 753933     +1  4681                                     mov     nuerr,#33h
1D74 120000   F +1  4682                                     call    error           ;на кран прибора ERR 3
                +1  4683                                     
1D77 120000   F +1  4684                                     call    ind
1D7A 120000   F +1  4685                                     call    z_01s           ;100ms
1D7D 80B1       +1  4686                                     jmp     test1   
                +1  4687     
                +1  4688     
                +1  4689     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
1D7F 75E700     +1  4690      ind:   mov             EIE2,#00H;mov   IE,#00h
1D82 120000   F +1  4691                     call    mign
1D85 7840       +1  4692                      mov            r0,#bufind;+11
1D87 7F0C       +1  4693                      mov            r7,#12
1D89 C286       +1  4694      nexin: clr             p0.6
1D8B E6         +1  4695                     mov             a,@r0
1D8C F59B       +1  4696                     mov             SPI0DAT,a
1D8E 20FBFD     +1  4697                     jb              TXBSY,$
1D91 D286       +1  4698                     setb    p0.6
1D93 120000   F +1  4699                     call    z_9             ;25mks
1D96 08         +1  4700                     inc             r0;dec          r0
1D97 DFF0       +1  4701                     djnz    r7,nexin
1D99 75E730     +1  4702                     mov             EIE2,#30H;mov   IE,#80h
1D9C 22         +1  4703                ret
                +1  4704     
                +1  4705     
1D9D 7A08       +1  4706     zapadc:   mov R2,#8
1D9F D297       +1  4707     sdv:      setb P1.7
1DA1 33         +1  4708               rlc A
1DA2 9296       +1  4709                     mov P1.6,C
1DA4 120000   F +1  4710                     call tim2
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    75

                +1  4711                                     
1DA7 C297       +1  4712                     clr P1.7
1DA9 120000   F +1  4713                     call tim2
1DAC DAF1       +1  4714                     djnz R2,sdv
1DAE D296       +1  4715                     setb P1.6
1DB0 22         +1  4716                     ret
                +1  4717     
1DB1 7A08       +1  4718     chtadc:   mov R2,#8
1DB3 D297       +1  4719     sdv1:     setb P1.7
1DB5 120000   F +1  4720               call tim2
1DB8 C297       +1  4721                     clr P1.7
1DBA A296       +1  4722                     mov C,P1.6
1DBC 33         +1  4723                     rlc A
1DBD 120000   F +1  4724                     call tim2
1DC0 DAF1       +1  4725                     djnz R2,sdv1
1DC2 22         +1  4726                     ret
                +1  4727     
1DC3 7E30       +1  4728     tim:      mov R6,#30h;38h
1DC5 DEFE       +1  4729     tim1:     djnz R6,tim1
1DC7 22         +1  4730               ret
                +1  4731               
1DC8 7E10       +1  4732     tim2:     mov R6,#10h;14h
1DCA DEFE       +1  4733     tim3:     djnz R6,tim3
1DCC 22         +1  4734               ret
                +1  4735     
                +1  4736     ;запись из acc
1DCD C3         +1  4737     write_x1: clr   c
1DCE            +1  4738     writeD_x1:
1DCE 92B1       +1  4739                       mov P3.1,c        ;запись
1DD0 F5A0       +1  4740               mov P2,A
1DD2 D2B3       +1  4741                       setb P3.3
1DD4 120000   F +1  4742                       call z_5
1DD7 C2B3       +1  4743                       clr P3.3
1DD9 75A0FF     +1  4744                       mov P2,#0FFh
1DDC 22         +1  4745                       ret
                +1  4746     
                +1  4747     ;чтение в acc
1DDD C3         +1  4748     read_x2:  clr   c  
1DDE 92B1       +1  4749               mov P3.1,c        ;чтение
1DE0 D2B2       +1  4750               setb P3.2
1DE2 D2B3       +1  4751                       setb P3.3
1DE4 120000   F +1  4752                     call z_5
1DE7 E5A0       +1  4753                       mov A,P2
1DE9 C2B3       +1  4754                       clr P3.3
1DEB C2B2       +1  4755                       clr P3.2
1DED 22         +1  4756                       ret
                +1  4757     
                +1  4758     
1DEE 120000   F +1  4759     loop:     call read_x2;x2    ;ожидание флага готовности
1DF1 20E7FA     +1  4760                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
1DF4 22         +1  4761                        ret           ;возврат, если бит А(7)<>1
                +1  4762                                      
                +1  4763                                        
                +1  4764     
                +1  4765     
                +1  4766     
                +1  4767     
                +1  4768     
                +1  4769     
                +1  4770     
                +1  4771     ;принимаемый байт в acc
                +1  4772     ;прием байта последовательным кодом старшими разрядами вперед
1DF5 7A08       +1  4773     read:    mov R2,#8
1DF7 C297       +1  4774     re1:     clr P1.7;P1.2
1DF9 120000   F +1  4775              call tim2        ;5mks
1DFC A294       +1  4776                     mov C,P1.4;P1.0
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    76

1DFE 33         +1  4777                     rlc A           
1DFF D297       +1  4778                     setb P1.7;P1.2
1E01 120000   F +1  4779                     call tim2
1E04 DAF1       +1  4780                     djnz R2,re1
1E06 22         +1  4781                     ret
                +1  4782     
                +1  4783      ;in r0-count   
                +1  4784     ;r10,r11-значение с котоым сравнивается счетчик
                +1  4785     ;r2..r5 -значение счетчика
1E07            +1  4786     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
1E07 E6         +1  4787                     mov                     a,@r0
1E08 FC         +1  4788                     mov                     r4,a
1E09 08         +1  4789                     inc                     r0
1E0A E6         +1  4790                     mov                     a,@r0
1E0B FD         +1  4791                     mov                     r5,a
1E0C 7B00       +1  4792                     mov                     r3,#0
1E0E 7A00       +1  4793                     mov                     r2,#0
1E10 750800     +1  4794                     mov                     r8,#0;clr                       r8
1E13 750900     +1  4795                     mov                     r9,#0;clr                       r9
1E16 120000   F +1  4796                     call            lcmp
1E19 22         +1  4797                     ret
                +1  4798     
                +1  4799     
                +1  4800     ;in-r1-count
1E1A            +1  4801     chdec:          ;mov            r1,#chavt               ;chavt-1
1E1A E7         +1  4802                             mov             a,@r1
1E1B FC         +1  4803                             mov             r4,a
1E1C 09         +1  4804                             inc             r1
1E1D E7         +1  4805                             mov             a,@r1
1E1E FD         +1  4806                             mov             r5,a
1E1F C202       +1  4807                             clr             rr2
1E21 C203       +1  4808                             clr             rr3
1E23 900000   F +1  4809                             mov             dptr,#ch1        
1E26 120000   F +1  4810                             call    ldc_ltemp
1E29 120000   F +1  4811                             call    lsub
1E2C ED         +1  4812                             mov             a,r5
1E2D F7         +1  4813                             mov             @r1,a
1E2E 19         +1  4814                             dec             r1
1E2F EC         +1  4815                             mov             a,r4
1E30 F7         +1  4816                             mov             @r1,a
1E31 22         +1  4817                             ret      
                +1  4818     
                +1  4819     
                +1  4820     
                +1  4821     
1E32            +1  4822     loadUS: ;если идет тест измерения ус восстановить для теста
1E32 201533     +1  4823                                     jb              biteizm,yestest
1E35 79AE       +1  4824                                             mov             r1,#diap
1E37 E7         +1  4825                             mov             a,@r1
1E38 23         +1  4826                             rl              a;*2
1E39 FC         +1  4827                             mov             r4,a                    ;save a
1E3A 900000   F +1  4828                             mov             dptr,#tabus
1E3D 93         +1  4829                             movc    a,@a+dptr
1E3E FA         +1  4830                             mov             r2,a                    ;high byte
1E3F E584       +1  4831                             mov             a,p4
1E41 5401       +1  4832                             anl             a,#01
1E43 4A         +1  4833                             orl             a,r2
1E44 F584       +1  4834                             mov             p4,a
1E46 0C         +1  4835                             inc             r4
1E47 EC         +1  4836                             mov             a,r4
1E48 93         +1  4837                             movc    a,@a+dptr
1E49 FB         +1  4838                             mov             r3,a                    ;low byte
1E4A E585       +1  4839                             mov             a,p5
1E4C 5401       +1  4840                             anl             a,#01
1E4E 4B         +1  4841                             orl             a,r3
1E4F F585       +1  4842                             mov             p5,a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    77

1E51 799A       +1  4843                             mov             r1,#parT
1E53 B7010E     +1  4844                             cjne    @r1,#1,bret
1E56 79AE       +1  4845                             mov             r1,#diap                  ;10s (parT=1)
1E58 7405       +1  4846                             mov             a,#5                      ;10-8..10-11 p4.1=1
1E5A C3         +1  4847                             clr             c
1E5B 97         +1  4848                             subb    a,@r1
1E5C 5006       +1  4849                             jnc             bret
1E5E E584       +1  4850                             mov             a,p4
1E60 4402       +1  4851                             orl             a,#02
1E62 F584       +1  4852                             mov             p4,a                     ;10-8..10-11 p4.1=1
1E64 120000   F +1  4853     bret:      call          louizm         ;us если вкл кн ИЗМЕР
1E67 22         +1  4854                             ret
1E68            +1  4855     yestest:
1E68 120000   F +1  4856                             call            lotpus          ;ус теста измерения
1E6B 22         +1  4857                             ret
                +1  4858                             
                +1  4859     ;загр ус для кор 0
                +1  4860     ;dptr-
1E6C E4         +1  4861     lospus:         clr             a
                +1  4862                             ;movc   a,@a+dptr
                +1  4863                             ;mov            r2,a                    ;high byte
                +1  4864                             ;mov            a,p4
                +1  4865                             ;anl            a,#01
                +1  4866                             ;orl            a,r2
                +1  4867                             ;mov            p4,a
                +1  4868                             ;inc            dptr
1E6D E4         +1  4869                             clr             a
1E6E 93         +1  4870                             movc    a,@a+dptr
1E6F FB         +1  4871                             mov             r3,a                    ;low byte
1E70 E585       +1  4872                             mov             a,p5
1E72 54BF       +1  4873                             anl             a,#0bfh;01
1E74 4B         +1  4874                             orl             a,r3
1E75 F585       +1  4875                             mov             p5,a
1E77 22         +1  4876                             ret
                +1  4877     
1E78 80         +1  4878     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                +1  4879     
                +1  4880     ;us кнопка измерения выкл
1E79 88D6       +1  4881     tabus:     db           88h,0d6h         ;10-2
1E7B 88F6       +1  4882                             db      88h,0f6h         ;10-3
1E7D 88D6       +1  4883                             db              88h,0d6h         ;10-4
1E7F 88F6       +1  4884                             db              88h,0f6h         ;10-5
1E81 9AD6       +1  4885                             db      9ah,0d6h         ;10-6
1E83 9AF6       +1  4886                             db              9ah,0f6h         ;10-7
1E85 ACD6       +1  4887                             db              0ach,0d6h        ;10-8
1E87 ACF6       +1  4888                             db      0ach,0f6h        ;10-9
1E89 C8D6       +1  4889                             db              0c8h,0d6h        ;10-10
1E8B C8F6       +1  4890                             db              0c8h,0f6h        ;10-11
                +1  4891     
1E8D            +1  4892     tabt11: 
1E8D 66E6       +1  4893                             db              66h,0e6h;10-11
1E8F            +1  4894     tabt9:  
1E8F 32E6       +1  4895                             db              32h,0e6h;10-9
1E91            +1  4896     tabt7:  
1E91 18EE       +1  4897                             db              18h,0eeh;10-7
                +1  4898     
                +1  4899      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  4900     ;в зав от parT (Tизм)
1E93 79B7       +1  4901     loadT:          mov             r1,#load;parT
1E95 7840       +1  4902     lolevT:         mov             r0,#bufind+0
1E97 7B0A       +1  4903                             mov             r3,#10
1E99 75F00A     +1  4904                             mov             b,#10
1E9C E7         +1  4905                             mov             a,@r1
1E9D A4         +1  4906                             mul             ab
1E9E FC         +1  4907                             mov             r4,a                    ;save a
1E9F 900000   F +1  4908                             mov             dptr,#textT
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    78

1EA2 93         +1  4909             lod1:   movc    a,@a+dptr
1EA3 F6         +1  4910                             mov             @r0,a
1EA4 08         +1  4911                             inc             r0
1EA5 0C         +1  4912                             inc             r4
1EA6 EC         +1  4913                             mov             a,r4
1EA7 DBF9       +1  4914                             djnz    r3,lod1
1EA9 22         +1  4915                             ret     
                +1  4916     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  4917     ;dptr-адр строки текста         
1EAA            +1  4918     lotext:         
1EAA 7B0A       +1  4919                             mov             r3,#10
1EAC 7840       +1  4920                             mov             r0,#bufind+0
1EAE E4         +1  4921     lodt:           clr             a
1EAF 93         +1  4922                             movc    a,@a+dptr
1EB0 F6         +1  4923                             mov             @r0,a
1EB1 08         +1  4924                             inc             r0
1EB2 A3         +1  4925                             inc             dptr
1EB3 DBF9       +1  4926                             djnz    r3,lodt
1EB5 22         +1  4927                             ret                                     
                +1  4928     
                +1  4929     
                +1  4930     
                +1  4931     
                +1  4932      ;задержка 100 мкс
1EB6 7978       +1  4933     z_100:    mov R1,#78h     ;загрузка первого числа
1EB8 7A02       +1  4934     z100:     mov R2,#2h     ;загрузка второго числа
1EBA DAFE       +1  4935     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
1EBC D9FA       +1  4936               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
1EBE 22         +1  4937               ret           
                +1  4938     
                +1  4939     ;задержка 34 мкс
1EBF 7B8B       +1  4940     z_5:      mov R3,#8Bh      ;загрузка числа
1EC1 DBFE       +1  4941     ct:       djnz R3,ct
1EC3 22         +1  4942               ret
                +1  4943     
                +1  4944     ;задержка 15 мс
1EC4 79FA       +1  4945     z_15:     mov R1,#0FAh    ;загрузка первого числа
1EC6 7AED       +1  4946     z15:      mov R2,#0EDh   ;загрузка второго числа
1EC8 DAFE       +1  4947     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
1ECA D9FA       +1  4948               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
1ECC 22         +1  4949               ret   
                +1  4950                                               
                +1  4951      ;задержка 1 мс
1ECD 7910       +1  4952     z_1ms:     mov R1,#10h     
1ECF 7AED       +1  4953     ss1:       mov R2,#0EDh    
1ED1 DAFE       +1  4954                djnz R2, $    
1ED3 D9FA       +1  4955                djnz R1, ss1   
1ED5 22         +1  4956                ret   
                +1  4957     
                +1  4958      ;????????
                +1  4959     ;задержка 1с
1ED6 7D1F       +1  4960     z_1s:   mov             r5,#01fh 
1ED8 7EFF       +1  4961     co2s:   mov     R6,#0ffh     
1EDA 7FFF       +1  4962     z1s:     mov    R7,#0ffh     
1EDC DFFE       +1  4963     co1s:   djnz    R7, co1s        
1EDE DEFA       +1  4964             djnz    R6, z1s 
1EE0 DDF6       +1  4965                     djnz    r5,co2s
1EE2 22         +1  4966               ret
                +1  4967     ;задержка 0,1с
1EE3 7D03       +1  4968     z_01s:           mov            r5,#03h 
1EE5 7EFF       +1  4969     co02s:          mov     R6,#0ffh     
1EE7 7FFF       +1  4970     z01s:           mov     R7,#0ffh     
1EE9 DFFE       +1  4971                             djnz    R7, $   
1EEB DEFA       +1  4972                     djnz    R6, z01s 
1EED DDF6       +1  4973                             djnz    r5,co02s
1EEF 22         +1  4974                      ret
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    79

                +1  4975                                               
                +1  4976     ;задержка 0,5с
1EF0 7D0D       +1  4977     z_05s:           mov            r5,#0dh 
1EF2 7EFF       +1  4978     co05s:                  mov     R6,#0ffh     
1EF4 7FFF       +1  4979     z05s:           mov     R7,#0ffh     
1EF6 DFFE       +1  4980                                     djnz    R7, $   
1EF8 DEFA       +1  4981                     djnz    R6, z05s 
1EFA DDF6       +1  4982                                             djnz    r5,co05s
1EFC 22         +1  4983                      ret                                                     
                +1  4984                                                               
1EFD 000007FF   +1  4985     chzap:  db      00,00,07h,0ffh             
1F01 00000000   +1  4986     ch0:    db      00,00,00,00
1F05 0000000A   +1  4987     ch10:   db      00,00,00,0ah                            ;10
1F09 00000005   +1  4988     ch5:    db      00,00,00,05                                             ;5
1F0D 00000004   +1  4989     ch4:    db      00,00,00,04                                             ;4
1F11 000003B9   +1  4990     ch954:  db 00,00,03,0b9h                                                ;954
1F15 000003E8   +1  4991     ch10000:        db 00,00,03h,0e8h                                               ;10000
1F19 00000064   +1  4992     ch100:  db 00,00,00,64h ;100
1F1D 00000002   +1  4993     ch2:    db      00,00,00,02                                             
                +1  4994     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  4995     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  4996     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
1F21 00000001   +1  4997     ch1:    db  00,00,00,01
1F25 49742400   +1  4998     ch_mln: db      49h,74h,24h,00;10*6
1F29 3F800000   +1  4999     ch_1:   db      3fh,80h,00,00   
1F2D 40000000   +1  5000     ch_2:   db      40h,00,00,00;2
1F31 40800000   +1  5001     ch_4:   db      40h,80h,00,00;4         
1F35 3F741EDF   +1  5002     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
1F39 47C35000   +1  5003     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
1F3D 3F800347   +1  5004     KD:             db      3fh,80h,03h,47h;1,0001
1F41 48435000   +1  5005     CH2tho: db      48h,43h,50h,00;200000
1F45 4856D800   +1  5006     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
1F49 4856D800   +1  5007     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
1F4D 461C4000   +1  5008     ch_10th:db  46h,1ch,40h,00;10000-2710h
1F51 41200000   +1  5009     ch_10:  db      41h,20h,00,00;10d
1F55 48742400   +1  5010     ch_250: db      48h,74h,24h,00;250000
1F59 000186A0   +1  5011     chk:            db      00,01,86h,0a0h;
1F5D 00000320   +1  5012     ch320h: db      00,00,03h,20h;320h=800d
1F61 00000150   +1  5013     ch150h: db      00,00,01h,50h;150h
                +1  5014     ;r1- мл байт 2х байтного числа
1F65            +1  5015     tenmin:         ;-10
1F65 C3         +1  5016                             clr             c
1F66 E7         +1  5017                     mov             a,@r1
1F67 9405       +1  5018                             subb    a,#5;10
1F69 F7         +1  5019                             mov             @r1,a
1F6A 19         +1  5020                             dec             r1
1F6B E7         +1  5021                             mov             a,@r1
1F6C 9400       +1  5022                             subb    a,#0
1F6E F7         +1  5023                             mov             @r1,a
1F6F 22         +1  5024                             ret
                +1  5025       ;r0-обнуление ячеек памяти  
1F70 7F04       +1  5026       clear4:        mov    r7,#4
1F72 E4         +1  5027                             clr             a
1F73 F6         +1  5028       cl4:          mov             @r0,a
1F74 08         +1  5029                             inc             r0
1F75 DFFC       +1  5030                             djnz    r7,cl4
1F77 22         +1  5031                             ret     
                +1  5032     
                +1  5033      ;r0-обнуление ячеек памяти 
                +1  5034      ;R7- 
1F78            +1  5035       clearN:        
1F78 E4         +1  5036                             clr             a
1F79 F6         +1  5037       cl4N:         mov             @r0,a
1F7A 08         +1  5038                             inc             r0
1F7B DFFC       +1  5039                             djnz    r7,cl4N
1F7D 22         +1  5040                             ret     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    80

                +1  5041     
                +1  5042       ;чтение номера байта с индикатора(2байта)
                +1  5043     ;bufind+8..bufind+9
                +1  5044     ;-  - - -
                +1  5045     ;- - - - - - - - - -
                +1  5046     ;adec..adec+9
                +1  5047     ;ст            мл
1F7E 7848       +1  5048     upak2:  mov             r0,#bufind+8;
1F80 795C       +1  5049                     mov             r1,#adec+9
1F82 7F02       +1  5050                     mov             r7,#2;2bait
1F84 C3         +1  5051     upa2:   clr             c
1F85 E6         +1  5052                     mov             a,@r0
1F86 9430       +1  5053                     subb    a,#30h
1F88 F7         +1  5054                     mov             @r1,a
1F89 18         +1  5055                     dec             r0
1F8A 19         +1  5056                     dec             r1
1F8B DFF7       +1  5057                     djnz    r7,upa2
1F8D 22         +1  5058                     ret  
                +1  5059     
                +1  5060     
                +1  5061         
                +1  5062      ;bufind+4..bufind+9
                +1  5063     ;-  - - -
                +1  5064     ;- - - - - - - - - -
                +1  5065     ;adec..adec+9
                +1  5066     ;ст            мл
1F8E 7849       +1  5067     upak:   mov             r0,#bufind+9;
1F90 795C       +1  5068                     mov             r1,#adec+9
1F92 7F06       +1  5069                     mov             r7,#6
1F94 C3         +1  5070     upa:    clr             c
1F95 E6         +1  5071                     mov             a,@r0
1F96 9430       +1  5072                     subb    a,#30h
1F98 F7         +1  5073                     mov             @r1,a
1F99 18         +1  5074                     dec             r0
1F9A 19         +1  5075                     dec             r1
1F9B DFF7       +1  5076                     djnz    r7,upa
1F9D 22         +1  5077                     ret
                +1  5078     
                +1  5079      ;чтение номера байта с индикатора(3байта)
                +1  5080     ;bufind+3..bufind+9
                +1  5081     ;-  - - -
                +1  5082     ;- - - - - - - - - -
                +1  5083     ;adec..adec+9
                +1  5084     ;ст            мл
1F9E 7849       +1  5085     upak3:  mov             r0,#bufind+9;
1FA0 795C       +1  5086                     mov             r1,#adec+9
1FA2 7F03       +1  5087                     mov             r7,#3;3bait
1FA4 C3         +1  5088     upa1:   clr             c
1FA5 E6         +1  5089                     mov             a,@r0
1FA6 9430       +1  5090                     subb    a,#30h
1FA8 F7         +1  5091                     mov             @r1,a
1FA9 18         +1  5092                     dec             r0
1FAA 19         +1  5093                     dec             r1
1FAB DFF7       +1  5094                     djnz    r7,upa1
1FAD 22         +1  5095                     ret
                +1  5096     
                +1  5097     ;вых-r2,r3-адрес ячее памяти прогр
1FAE            +1  5098     findkoef:
1FAE 79AE       +1  5099                                     mov             r1,#diap
1FB0 E7         +1  5100                                     mov             a,@r1
1FB1 23         +1  5101                                     rl              a                                          
                                          ;diap*2(2bait )
1FB2 FC         +1  5102                                     mov             r4,a                                    ;sa
                             ve
1FB3 900000   F +1  5103                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    81

                +1  5104                                     
1FB6 93         +1  5105                                     movc    a,@a+dptr                       ;ст байт
1FB7 FA         +1  5106                                     mov             r2,a
1FB8 A3         +1  5107                                     inc             dptr
1FB9 EC         +1  5108                                     mov             a,r4
1FBA 93         +1  5109                                     movc    a,@a+dptr
1FBB FB         +1  5110                                     mov             r3,a                    ;мл байт
1FBC 22         +1  5111                                     ret
                +1  5112     ;r2..r5 в опр яч внешн озу
1FBD            +1  5113     findext:
1FBD 79AE       +1  5114                                     mov             r1,#diap
1FBF E7         +1  5115                                     mov             a,@r1
1FC0 23         +1  5116                                     rl              a                                          
                                          ;diap*2(2bait )
1FC1 23         +1  5117                                     rl              a                                          
                                          ;diap*2(2bait )
1FC2 F9         +1  5118                                     mov             r1,a                                    ;r1
                             -номер ячейки внешнего озу
                +1  5119                                     
1FC3 22         +1  5120                                     ret
                +1  5121     
                +1  5122     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  5123     ;(5000h..5027h)
1FC4 5000       +1  5124     diKDw:  dw              5000h                   ;10-2
1FC6 5004       +1  5125                                     dw              5004h                   ;10-3
1FC8 5008       +1  5126                                     dw              5008h                   ;10-4
1FCA 500C       +1  5127                                     dw              500ch                   ;10-5
1FCC 5010       +1  5128                                     dw              5010h                   ;10-6
1FCE 5014       +1  5129                                     dw              5014h                   ;10-7
1FD0 5018       +1  5130                                     dw              5018h                   ;10-8
1FD2 501C       +1  5131                                     dw              501ch                   ;10-9
1FD4 5020       +1  5132                                     dw              5020h                   ;10-10
1FD6 5024       +1  5133                                     dw              5024h                   ;10-11
1FD8 5028       +1  5134     dipar:  dw              5028h                   ;parol
                +1  5135     
1FDA 000186A0   +1  5136     chthou: db      00,01,86h,0a0h  ;100.000
                +1  5137     
1FDE AA08       +1  5138     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
1FE0 AB09       +1  5139                                             mov     r3,ltemp+1
1FE2 AC0A       +1  5140                                             mov     r4,ltemp+2
1FE4 AD0B       +1  5141                                             mov     r5,ltemp+3
1FE6 22         +1  5142                                             ret
                +1  5143     ;bufind+4..bufind+9
                +1  5144     ;-  - - -
                +1  5145     ;- - - - - - - - - -
                +1  5146     ;adec..adec+9
                +1  5147     ;ст            мл
1FE7 7847       +1  5148     upakA:  mov             r0,#bufind+7;
1FE9 795C       +1  5149                     mov             r1,#adec+9
1FEB 7F04       +1  5150                     mov             r7,#4
1FED C3         +1  5151     upaa4:  clr             c
1FEE E6         +1  5152                     mov             a,@r0
1FEF 9430       +1  5153                     subb    a,#30h
1FF1 F7         +1  5154                     mov             @r1,a
1FF2 18         +1  5155                     dec             r0
1FF3 19         +1  5156                     dec             r1
1FF4 DFF7       +1  5157                     djnz    r7,upaa4
1FF6 22         +1  5158                     ret
                +1  5159     
                +1  5160     ;bufind+4..bufind+9
                +1  5161     ;-  - - -
                +1  5162     ;- - - - - - - - - -
                +1  5163     ;adec..adec+9
                +1  5164     ;ст            мл
1FF7 7848       +1  5165     upakB:  mov             r0,#bufind+8;
1FF9 795C       +1  5166                     mov             r1,#adec+9
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    82

1FFB 7F05       +1  5167                     mov             r7,#5
1FFD C3         +1  5168     upab:   clr             c
1FFE E6         +1  5169                     mov             a,@r0
1FFF 9430       +1  5170                     subb    a,#30h
2001 F7         +1  5171                     mov             @r1,a
2002 18         +1  5172                     dec             r0
2003 19         +1  5173                     dec             r1
2004 DFF7       +1  5174                     djnz    r7,upab
2006 C21B       +1  5175                     clr                     bitznB
2008 E543       +1  5176                     mov             a,bufind+3
200A B42D02     +1  5177                     cjne            a,#2dh,abret
200D D21B       +1  5178                     setb            bitznB
200F            +1  5179     abret:
200F 22         +1  5180                     ret
2010            +1  5181     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
2010 4E6E6AA8   +1  5182                                             db      4eh,6eh,6ah,0a8h;10**9
2014 43FA0000   +1  5183     CH_500:         db              43h,0fah,00,00;1fah=500
2018 4856D800   +1  5184     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
201C 49742400   +1  5185     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  5186     
                +1  5187     
                +1  5188     
                +1  5189     ;управление AD7731
                +1  5190     ;r4=b1 r5=b2
2020            +1  5191     iniacp: ;управление AD7731
2020 7403       +1  5192                             mov             a,#03
                +1  5193     
2022 120000   F +1  5194                             call    write
2025 EC         +1  5195                             mov             a,r4;#80h
2026 120000   F +1  5196                             call    write
2029 ED         +1  5197                             mov             a,r5;#04
202A 120000   F +1  5198                             call    write
202D 7402       +1  5199                             mov             a,#02
202F 120000   F +1  5200                             call    write
2032 74A1       +1  5201                             mov             a,#0a1h
2034 120000   F +1  5202                             call    write
2037 7474       +1  5203                             mov             a,#74h
2039 120000   F +1  5204                             call    write
203C 2095FD     +1  5205                             jb              p1.5,$;p1.3,$
203F 7402       +1  5206                             mov             a,#02
2041 120000   F +1  5207                             call    write
2044 7481       +1  5208                             mov             a,#81h
2046 120000   F +1  5209                             call    write
2049 7474       +1  5210                             mov             a,#74h
204B 120000   F +1  5211                             call    write
204E 2095FD     +1  5212                             jb              p1.5,$;p1.3,$
2051 7402       +1  5213                             mov             a,#02
2053 120000   F +1  5214                             call    write
2056 7421       +1  5215                             mov             a,#21h
2058 120000   F +1  5216                             call    write
205B 7474       +1  5217                             mov             a,#74h
205D 120000   F +1  5218                             call    write
2060 22         +1  5219                             ret
                +1  5220                             ;;;;;;;;;;;;;;;;
                +1  5221     ;;;;;;;;;;;;;;;;;
                +1  5222     ;;;;;;;;;;;;;;;;;
2061 0000       +1  5223     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
2063 6000       +1  5224                                     db              60h,00h;40h,04h         ;10s
2065 6000       +1  5225                                     db              60h,00;40h,04h          ;1s
2067 6000       +1  5226                                     db              60h,00h;40h,04h         ;0,1s
2069 6000       +1  5227                                     db              60h,00h;20h,04h         ;50ms
206B 6000       +1  5228                                     db              60h,00h;20h,04h          ;10ms
206D 1332       +1  5229                                     db              13h,32h         ;2ms
                +1  5230     
                +1  5231     ;загр В1,В2 в завис от Т                                
206F 799A       +1  5232     loab12:                 mov             r1,#parT
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    83

2071 900000   F +1  5233                                     mov             dptr,#tabB1_2
2074 E7         +1  5234                                     mov             a,@r1
2075 23         +1  5235                                     rl              a;*2
2076 FF         +1  5236                                     mov             r7,a                    ;save a
2077 93         +1  5237                                     movc    a,@a+dptr
2078 FC         +1  5238                                     mov             r4,a   ;b1
2079 0F         +1  5239                                     inc             r7
207A EF         +1  5240                                     mov             a,r7
207B 93         +1  5241                                     movc    a,@a+dptr
207C FD         +1  5242                                     mov             r5,a
                +1  5243                                     ;после загр В1,2 загр упр слово для нового Т
                +1  5244                             
207D 22         +1  5245                                     ret
                +1  5246     
                +1  5247     
207E 7852       +1  5248     loadr2: mov             r0,#abin+3              ;r2..r5
2080 E6         +1  5249                     mov             a,@r0                   ; ст мл   
2081 FA         +1  5250                     mov             r2,a
2082 18         +1  5251                     dec             r0
2083 E6         +1  5252                     mov             a,@r0
2084 FB         +1  5253                     mov             r3,a
2085 18         +1  5254                     dec             r0
2086 E6         +1  5255                     mov             a,@r0
2087 FC         +1  5256                     mov             r4,a
2088 18         +1  5257                     dec             r0
2089 E6         +1  5258                     mov             a,@r0
208A FD         +1  5259                     mov             r5,a
208B 22         +1  5260                     ret
                +1  5261                                             
                +1  5262      ;;;;;;;;;;;;;;;;;;;      
                +1  5263      ;загрузка KD в зависимости от диап изм  
                +1  5264      ;koef->r8..r11
208C 78AE       +1  5265     loadKD:                 mov             r0,#diap
208E E6         +1  5266                                     mov             a,@r0
208F 900000   F +1  5267                                     mov             dptr,#diKDn
2092 75F004     +1  5268                                     mov             b,#4
2095 A4         +1  5269                                     mul             ab
2096 FF         +1  5270                                     mov             r7,a;save
2097 93         +1  5271                                     movc    a,@a+dptr
2098 F508       +1  5272                                     mov             r8,a
209A A3         +1  5273                                     inc             dptr
209B EF         +1  5274                                     mov             a,r7
209C 93         +1  5275                                     movc    a,@a+dptr
209D F509       +1  5276                                     mov             r9,a
209F A3         +1  5277                                     inc             dptr
20A0 EF         +1  5278                                     mov             a,r7
20A1 93         +1  5279                                     movc    a,@a+dptr
20A2 F50A       +1  5280                                     mov             r10,a
20A4 A3         +1  5281                                     inc             dptr
20A5 EF         +1  5282                                     mov             a,r7
20A6 93         +1  5283                                     movc    a,@a+dptr
20A7 F50B       +1  5284                                     mov             r11,a
20A9 22         +1  5285                                     ret
                +1  5286     
20AA 3F506B7B   +1  5287      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
20AE 3F507FCC   +1  5288                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
20B2 3F4F9D0B   +1  5289                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
20B6 3F4FE869   +1  5290                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
20BA 3F50294A   +1  5291                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
20BE 3F50639E   +1  5292                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
20C2 3F4BC9F0   +1  5293                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    84

                             -8
20C6 3F4C063B   +1  5294                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
20CA 3F50EFDD   +1  5295                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
20CE 3F512AD9   +1  5296                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  5297     
20D2 00000039   +1  5298     ch57:   db      00,00,00,39h;57
20D6 00000014   +1  5299     ch20:   db      00,00,00,14h;20
                +1  5300     
                +1  5301     ;загр ус для тестов ацп 
                +1  5302     ;dptr-
20DA 78B1       +1  5303     lotpus: mov             r0,#vichR
20DC B6210D     +1  5304                                     cjne    @r0,#21h,te22
20DF 900000   F +1  5305                                     mov                     dptr,#tabt11;заслать ус 11А
20E2 E4         +1  5306     lotp:           clr             a
20E3 93         +1  5307                             movc    a,@a+dptr                               ;high byte
20E4 F584       +1  5308                             mov             p4,a
20E6 A3         +1  5309                             inc             dptr
20E7 E4         +1  5310                             clr             a
20E8 93         +1  5311                             movc    a,@a+dptr                               ;low byte
20E9 F585       +1  5312                             mov             p5,a
20EB 22         +1  5313                             ret
20EC B62205     +1  5314     te22:                   cjne    @r0,#22h,te23
20EF 900000   F +1  5315                             mov                     dptr,#tabt9;заслать ус 9А       
20F2 80EE       +1  5316                             jmp                     lotp
                +1  5317     
20F4 900000   F +1  5318     te23:   mov                     dptr,#tabt7;заслать ус 7А       
20F7 80E9       +1  5319                             jmp                     lotp
                +1  5320     
                +1  5321     
                +1  5322     
                +1  5323     
                +1  5324     
20F9 02030405   +1  5325     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
20FD 06070809                
2101 0A0B                    
                +1  5326     
2103 78AE       +1  5327     findR:                  mov                     r0,#diap
2105 E6         +1  5328                                                     mov                     a,@r0
2106 900000   F +1  5329                                                     mov                     dptr,#Tabn
2109 93         +1  5330                                                     movc            a,@a+dptr
210A 22         +1  5331                                                     ret
                +1  5332     
                +1  5333     ;bufind=30h..39h                                                                           
                                           ;
210B C219       +1  5334     vvchif:                 clr             bitmig
210D 79B2       +1  5335                                     mov             r1,#marker
210F E7         +1  5336                                     mov             a,@r1                   ;изм цифры
2110 7840       +1  5337                                     mov             r0,#bufind                      ;0000
2112 28         +1  5338                                     add             a,r0
2113 F8         +1  5339                                     mov             r0,a
2114 06         +1  5340                                     inc             @r0
2115 B63A02     +1  5341                                     cjne    @r0,#3ah,chif
2118 7630       +1  5342                                     mov             @r0,#30h
211A            +1  5343     chif:   
211A 22         +1  5344                             ret
211B            +1  5345     vvchibl:        ;mov                    r0,#level
                +1  5346                                             ;cjne           @r0,#32h,vvchibl4;при наборе цифр в
                              блоке
211B 80EE       +1  5347                                             jmp                     vvchif  ;при наборе цифр в 
                             интервале                                    
211D            +1  5348     vvchibl4:
211D C219       +1  5349                             clr             bitmig
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    85

211F 79B2       +1  5350                                     mov             r1,#marker
2121 E7         +1  5351                                     mov             a,@r1                   ;изм цифры
2122 7840       +1  5352                                     mov             r0,#bufind                      ;1..4
2124 28         +1  5353                                     add             a,r0
2125 F8         +1  5354                                     mov             r0,a
2126 06         +1  5355                                     inc             @r0
2127 B63504     +1  5356                                     cjne    @r0,#35h,chifb
212A 7631       +1  5357                                     mov             @r0,#31h
212C 8005       +1  5358                                     jmp             chifb1
212E B63002     +1  5359     chifb:  cjne    @r0,#30h,chifb1
2131 7631       +1  5360                                     mov             @r0,#31h
2133            +1  5361     chifb1:
2133 22         +1  5362             ret
                +1  5363       ;перевод маркера влево
2134            +1  5364     marle:  
2134 C219       +1  5365                     clr             bitmig
                +1  5366                     ;mov            savba,#0   нельзя обнулять
2136 78B2       +1  5367             mov             r0,#marker
2138 16         +1  5368                     dec             @r0
2139 E6         +1  5369                     mov             a,@r0
213A C3         +1  5370                     clr             c
213B 953A       +1  5371                     subb    a,movleft         ;крайне левое положение
213D 5001       +1  5372                     jnc             rler
213F 06         +1  5373                     inc             @r0
2140 22         +1  5374     rler:   ret
                +1  5375         
                +1  5376     ;перевод маркера вправо
2141 C219       +1  5377     marri:  clr             bitmig
2143 78B2       +1  5378                     mov             r0,#marker
2145 06         +1  5379                     inc         @r0
2146 E53B       +1  5380                     mov             a,movrig           ;крайне правое положение
2148 C3         +1  5381                     clr             c
2149 96         +1  5382                     subb    a,@r0
214A 5001       +1  5383                     jnc             rrir
214C 16         +1  5384                     dec             @r0
214D 22         +1  5385     rrir:   ret
                +1  5386         
                +1  5387     ;konstA->bufind+4..bufind+7
214E 78BC       +1  5388     outA:           mov                     r0,#konstA
2150 120000   F +1  5389                                     call            resar2
2153 120343     +1  5390                                     call            ftol                    ;->hex
2156 784F       +1  5391                                     mov             r0,#abin
2158 120000   F +1  5392                                     call            saver2
215B 7853       +1  5393                                     mov                     r0,#adec
215D 7952       +1  5394                                     mov             r1,#abin+3
215F 120000   F +1  5395                                     call            bindec
2162 785C       +1  5396                                     mov                     r0,#adec+9
2164 7947       +1  5397                                     mov                     r1,#bufind+7
2166 7F04       +1  5398                                     mov                     r7,#4
2168 E6         +1  5399     outa2:  mov             a,@r0
2169 2430       +1  5400                               add           a,#30h
216B F7         +1  5401                                     mov             @r1,a
216C 19         +1  5402                                     dec             r1
216D 18         +1  5403                                     dec             r0
216E DFF8       +1  5404                                     djnz    r7,outa2
2170 22         +1  5405                                     ret
                +1  5406                                             
                +1  5407     ;konstB->bufind+4..bufind+8
2171 78C0       +1  5408     outB:           mov                     r0,#konstB
2173 120000   F +1  5409                                     call            resar2
2176 EA         +1  5410                                     mov                     a,r2
2177 5480       +1  5411                                     anl                     a,#80h
2179 6007       +1  5412                                     jz                      outb3
217B EA         +1  5413     mov                     a,r2
217C 547F       +1  5414                                     anl                     a,#7fh
217E FA         +1  5415                                     mov                     r2,a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    86

217F 75432D     +1  5416                                     mov                     bufind+3,#2dh
2182 120343     +1  5417     outb3:  call            ftol                    ;->hex
2185 784F       +1  5418                                     mov             r0,#abin
2187 120000   F +1  5419                                     call            saver2
218A 7853       +1  5420                                     mov                     r0,#adec
218C 7952       +1  5421                                     mov             r1,#abin+3
218E 120000   F +1  5422                                     call            bindec
2191 785C       +1  5423                                     mov                     r0,#adec+9
2193 7948       +1  5424                                     mov                     r1,#bufind+8
2195 7F05       +1  5425                                     mov                     r7,#5
2197 E6         +1  5426     outb2:  mov             a,@r0
2198 2430       +1  5427                               add           a,#30h
219A F7         +1  5428                                     mov             @r1,a
219B 19         +1  5429                                     dec             r1
219C 18         +1  5430                                     dec             r0
219D DFF8       +1  5431                                     djnz    r7,outb2
219F 22         +1  5432                                     ret
                +1  5433     
                +1  5434     
                +1  5435     ;пп мигания индикации
21A0 78B2       +1  5436     mign:           mov             r0,#marker
                +1  5437                                     
21A2 B6FF03     +1  5438                                     cjne    @r0,#0ffh,mignn
                +1  5439                                     ;реж изм мигает *
21A5 C219       +1  5440                                     clr             bitmig
21A7 22         +1  5441                                     ret
                +1  5442     
21A8            +1  5443     mignn:                  ;clr            c
21A8 7440       +1  5444                                     mov             a,#bufind
21AA 26         +1  5445                                     add             a,@r0                   ;a=bufind+marker
21AB F9         +1  5446                                     mov             r1,a
21AC 201907     +1  5447                                     jb              bitmig,onmig
21AF 873C       +1  5448                                     mov             savba,@r1
                +1  5449                             ;       mov             a,@r1
                +1  5450                             ;       mov             savba,a
21B1 7720       +1  5451                                     mov             @r1,#" "
                +1  5452                                     
21B3 D219       +1  5453                                     setb    bitmig
21B5 22         +1  5454                                     ret
                +1  5455     
21B6 A73C       +1  5456     onmig:                  mov             @r1,savba
                +1  5457                                     ;mov            a,savba
                +1  5458                                     ; mov           @r1,a
21B8 C219       +1  5459                                     clr             bitmig
21BA 120000   F +1  5460                                     call    z_01s
21BD 22         +1  5461                                     ret
                +1  5462     ;номер ошибки bufind+6
21BE 900000   F +1  5463     error:          mov             dptr,#teERR
21C1 120000   F +1  5464                                             call    lotext
21C4 853946     +1  5465                                             mov             bufind+6,nuerr
21C7 22         +1  5466                                     ret
                +1  5467     
                +1  5468     
21C8            +1  5469     textT:          
21C8 FD543D32   +1  5470                             db              0fdh,"T","=",32h,"m",67h,0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
21CC 6D67FDFD                
21D0 FDFD                    
21D2 FD543D31   +1  5471                             db              0fdh,"T","=",31h,30h,"m",67h,0fdh,0fdh,0fdh
21D6 306D67FD                
21DA FDFD                    
21DC FD543D35   +1  5472                             db              0fdh,"T","=",35h,30h,"m",67h,0fdh,0fdh,0fdh
21E0 306D67FD                
21E4 FDFD                    
21E6 FD543D64   +1  5473                             db              0fdh,"T","=",64h,31h,67h,0fdh,0fdh,0fdh,0fdh
21EA 3167FDFD                
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    87

21EE FDFD                    
21F0 20202054   +1  5474                             db              " "," "," ","T","=",31h,67h," "," "," "
21F4 3D316720                
21F8 2020                    
21FA 2020543D   +1  5475                             db              " "," ","T","=",31h,30h,67h," "," "," "  
21FE 31306720                
2202 2020                    
                +1  5476     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                +1  5477     
2204 42753474   +1  5478     teVICH: db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
2208 79767454                
220C 7720                    
220E 20553D20   +1  5479     teAequ0:        db              " ",'U','='," "," "," "," "," "," ",65h
2212 20202020                
2216 2065                    
2218 20423D2B   +1  5480     teBequ0:        db              " ",'B','=','+'," "," "," "," "," "," "
221C 20202020                
2220 2020                    
2222 20207145   +1  5481     teMENU: db              " "," ",71h,"E","H",72h," "," "," "," "
2226 48722020                
222A 2020                    
                +1  5482     
222C 20544579   +1  5483     teTESI: db      " ","T","E",79h,"T",2dh,74h,33h,71h," ";ТЕСТ -ИЗМ    11
2230 542D7433                
2234 7120                    
2236 54457954   +1  5484     teTESR: db      "T","E",79h,"T"," ","R",35h," "," "," ";ТЕСТ RS 12
223A 20523520                
223E 2020                    
2240 20794B30   +1  5485     teSKOR: db      " ",79h,'K',30h,"P"," ","R",35h," "," ";СКОР 232      13
2244 50205235                
2248 2020                    
224A 20204142   +1  5486     teAVK:  db      " "," ",'A','B','K'," "," "," "," "," "  ;AВK                              
                                  14
224E 4B202020                
2252 2020                    
2254 204B4176   +1  5487     teKALIB:         db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР    15
2258 74735020                
225C 202020                  
                +1  5488     
225F 20544579   +1  5489     teTE11:         db              " ",'T',"E",79h,'T'," ",2dh,31h,31h,'A';          21
2263 54202D31                
2267 3141                    
2269 20544579   +1  5490     teTE9:          db              " ",'T',"E",79h,'T'," ",2dh,30h,39h,'A';                   
                                                  22
226D 54202D30                
2271 3941                    
2273 20544579   +1  5491     teTE7:          db              " ",'T',"E",79h,'T'," ",2dh,30h,37h,'A';                   
                                                  23
2277 54202D30                
227B 3741                    
                +1  5492     
                +1  5493     
227D 20203537   +1  5494     teS57_6:                db              " "," ",35h,37h,36h," "," "," "," "," ";57.6
2281 36202020                
2285 2020                    
2287 20203139   +1  5495     teS19_2:                db              " "," ",31h,39h,32h," "," "," "," "," ";19,2
228B 32202020                
228F 2020                    
                +1  5496     
2291 61415030   +1  5497     tePAR:          db              61h,'A',"P",30h,76h,77h," ",30h,30h,30h;пароль
2295 76772030                
2299 3030                    
229B 20303030   +1  5498     teKD:                   db              " ",30h,30h,30h,30h,30h," "," "," ",'A';00000
229F 30302020                
22A3 2041                    
22A5 74337120   +1  5499     teIZMK: db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    88

22A9 4B304879                
22AD 5420                    
22AF 20204275   +1  5500     teOUT:          db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
22B3 58307820                
22B7 2020                    
22B9 2020304C   +1  5501     teOLL:          db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
22BD 4C202020                
22C1 2020                    
22C3 20203034   +1  5502     teCLE:          db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
22C7 7479544B                
22CB 4120                    
22CD 20203041   +1  5503     teMEM:          db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
22D1 71795420                
22D5 20203341   +1  5504     teWR:           db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
22D9 61747977                
22DD 2020                    
22DF 20206150   +1  5505     teLIST: db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
22E3 30797130                
22E7 545020                  
22EA 20206130   +1  5506     teFULL: db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
22EE 76484162                
22F2 2020                    
22F4 20744854   +1  5507     teINT:  db      " ",74h,"H",'T'," ",30h,30h,30h,30h,67h;ИНТ 0000
22F8 20303030                
22FC 3067                    
22FE 20207376   +1  5508     teBL:           db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
2302 304B2020                
2306 2020                    
2308 20207376   +1  5509     teBL0:  db      " "," ",73h,76h,30h,'K'," ",30h," "," ";БЛОК 0
230C 304B2030                
2310 2020                    
2312 30547934   +1  5510     teCH:           db      30h,'T',79h,34h,"E",'T'," ",30h,30h,30h;ОТСЧЕТ 000
2316 45542030                
231A 3030                    
231C 79544154   +1  5511     teSTAT:         db      79h,'T','A','T',74h,79h,'T',74h,'K','A';СТАТИСТИКА
2320 74795474                
2324 4B41                    
2326 71744820   +1  5512     teMIN:  db      71h,74h,"H"," "," "," "," "," "," "," ";МИН  00000
232A 20202020                
232E 2020                    
2330 71414B79   +1  5513     teMAX:  db      71h,'A','K',79h," "," "," "," "," "," ";МАКС 00000
2334 20202020                
2338 2020                    
233A 79504578   +1  5514     teMID:  db      79h,"P","E",78h," "," "," "," "," "," ";СРЕД 00000
233E 20202020                
2342 2020                    
                +1  5515      ;;;;;;;;;;;;;;;;;;;         
2344 2020304C   +1  5516     teOLI:  db              " "," ",30h,"L","L"," ","I"," "," "," "
2348 4C204920                
234C 2020                    
234E 2020304C   +1  5517     teOLR:  db              " "," ",30h,"L","L"," ",66h," "," "," "
2352 4C206620                
2356 2020                    
2358 20204552   +1  5518     teERR:  db              " "," ","E","R","R"," "," "," "," "," " ;ERR
235C 52202020                
2360 2020                    
2362 2020454E   +1  5519     teEND:  db              " "," ","E","N","D"," "," "," "," "," " ;END
2366 44202020                
236A 2020                    
                +1  5520     
                +1  5521     ;dptr+4-приемник
                +1  5522     ;dptr-источник
                +1  5523     ;r7-кол байт  
236C            +1  5524     xCIKLWR:
236C 7F04       +1  5525                             mov             r7,#4   
236E E0         +1  5526     lwrx:   movx    a,@dptr
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    89

236F C083       +1  5527                             push    dph
2371 C082       +1  5528                             push    dpl
2373 A3         +1  5529                             inc             dptr
2374 A3         +1  5530                             inc             dptr
2375 A3         +1  5531                             inc             dptr
2376 A3         +1  5532                             inc             dptr
2377 F0         +1  5533                             movx    @dptr,a
2378 D082       +1  5534                             pop             dpl
237A D083       +1  5535                             pop             dph
                +1  5536                             
237C A3         +1  5537                             inc             dptr
237D DFEF       +1  5538                             djnz    r7,lwrx
237F 22         +1  5539                             ret
                +1  5540     ;r2..r5->@dptr..@dptr+3                         
2380 EA         +1  5541     saveIr2:                mov     a,r2
2381 F0         +1  5542                                             movx    @dptr,a
2382 A3         +1  5543                                             inc     dptr
2383 EB         +1  5544                                             mov     a,r3
2384 F0         +1  5545                                             movx    @dptr,a
2385 A3         +1  5546                                             inc     dptr
2386 EC         +1  5547                                             mov     a,r4
2387 F0         +1  5548                                             movx    @dptr,a
2388 A3         +1  5549                                             inc     dptr
2389 ED         +1  5550                                             mov     a,r5
238A F0         +1  5551                                             movx    @dptr,a
238B 22         +1  5552                                             ret
                +1  5553     ;r2..r5-> @r0..@r0+3
                +1  5554     
238C EA         +1  5555     saver2:         mov     a,r2
238D F6         +1  5556                                             mov     @r0,a
238E 08         +1  5557                                             inc     r0
238F EB         +1  5558                                             mov     a,r3
2390 F6         +1  5559                                             mov     @r0,a
2391 08         +1  5560                                             inc     r0
2392 EC         +1  5561                                             mov     a,r4
2393 F6         +1  5562                                             mov     @r0,a
2394 08         +1  5563                                             inc     r0
2395 ED         +1  5564                                             mov     a,r5
2396 F6         +1  5565                                             mov     @r0,a
2397 22         +1  5566                                             ret 
2398 7F50       +1  5567     clmassix:       mov                     r7,#50h;28h
239A 900100     +1  5568                             mov     dptr,#MASS0        ;забить массив A нулями
239D 7400       +1  5569     clmax:          mov          a,#00h
239F F0         +1  5570                  movx    @dptr,a
23A0 A3         +1  5571                  inc     dptr
23A1 DFFA       +1  5572                 djnz                r7,clmax                
23A3 F56E       +1  5573                  mov     chmas,a
23A5 C201       +1  5574                  clr     bitmas
23A7 22         +1  5575                 ret
                +1  5576     ;r1-яЁшхьшъ
                +1  5577     ;r0-шёЄюўшъ
                +1  5578     ;r7-ъюы срщЄ  
23A8            +1  5579     CIKLWR:
23A8 7F04       +1  5580                             mov             r7,#4   
23AA E6         +1  5581     lwr:    mov     a,@r0
23AB F7         +1  5582                             mov     @r1,a
23AC 09         +1  5583                             inc             r1
23AD 08         +1  5584                             inc             r0
23AE DFFA       +1  5585                             djnz    r7,lwr
23B0 22         +1  5586                             ret     
                +1  5587     ;r2..r5-> @dptr..@dptr+3
                +1  5588     
23B1 120000   F +1  5589     zmul:   call    maform
23B4 120000   F +1  5590                     call    lmul
23B7 120000   F +1  5591                     call    bform
23BA 22         +1  5592                     ret
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    90

                +1  5593     
23BB 120000   F +1  5594     zdiv:   call    maform
23BE 120000   F +1  5595                     call    divide
23C1 120000   F +1  5596                     call    bform
23C4 22         +1  5597                     ret
                +1  5598     
23C5 EA         +1  5599     maform: mov a,r2
23C6 33         +1  5600             rlc a
23C7 5006       +1  5601             jnc             fo1m
23C9 D202       +1  5602                     setb            znmat
23CB 120000   F +1  5603                     call   form4
23CE 22         +1  5604                     ret
23CF C202       +1  5605     fo1m:   clr             znmat
23D1 22         +1  5606                     ret
                +1  5607     
23D2 300203     +1  5608     bform:  jnb             znmat,fo2m
23D5 120000   F +1  5609                     call    form4
23D8 22         +1  5610     fo2m:   ret
                +1  5611       
                +1  5612     ;r2..r5 яхЁхтхёЄш т фюя ъюф
23D9 ED         +1  5613     form4:          mov a,r5
23DA F4         +1  5614             cpl a
23DB 2401       +1  5615             add a,#1
23DD FD         +1  5616             mov r5,a
23DE EC         +1  5617             mov a,r4
23DF F4         +1  5618             cpl a
23E0 3400       +1  5619             addc    a,#0
23E2 FC         +1  5620             mov r4,a
23E3 EB         +1  5621             mov a,r3
23E4 F4         +1  5622                 cpl a
23E5 3400       +1  5623             addc    a,#0
23E7 FB         +1  5624             mov r3,a
23E8 EA         +1  5625             mov a,r2
23E9 F4         +1  5626             cpl a
23EA 3400       +1  5627             addc    a,#0
23EC FA         +1  5628             mov r2,a
23ED 22         +1  5629             ret
                +1  5630     
23EE 120000   F +1  5631     zcmp:   call            maform
23F1 120000   F +1  5632                     call            lcmp
23F4 C0D0       +1  5633                     push            psw
23F6 120000   F +1  5634                     call    bform
23F9 D0D0       +1  5635                     pop             psw
23FB 22         +1  5636                     ret
                +1  5637     
                +1  5638     
                +1  5639     ;@r0..@r0+3->r8..r11
                +1  5640     
23FC E6         +1  5641     resar8: mov     a,@r0
23FD F508       +1  5642                     mov     ltemp,a
23FF 08         +1  5643                     inc     r0
2400 E6         +1  5644                     mov     a,@r0
2401 F509       +1  5645                     mov     ltemp+1,a
2403 08         +1  5646                     inc     r0
2404 E6         +1  5647                     mov     a,@r0
2405 F50A       +1  5648                     mov     ltemp+2,a
2407 08         +1  5649                     inc     r0
2408 E6         +1  5650                     mov     a,@r0
2409 F50B       +1  5651                     mov     ltemp+3,a
240B 22         +1  5652                     ret
                +1  5653     
                +1  5654     ;
                +1  5655     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                +1  5656     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                +1  5657     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                +1  5658     ;r2 a    ўшёыю 180
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    91

                +1  5659     ;00 b4
                +1  5660     ;т_ї- mabin..mabin+2
                +1  5661     ;     80 01 00
                +1  5662      
240C C8         +1  5663     cond:   xch     a,r0    
240D F9         +1  5664                     mov     r1,a
240E C8         +1  5665                     xch     a,r0
240F 7C03       +1  5666                     mov     r4,#03
2411 7700       +1  5667     dcoa:   mov     @r1,#00
2413 09         +1  5668                     inc     r1
2414 DCFB       +1  5669                     djnz    r4,dcoa
2416 7B10       +1  5670                     mov     r3,#10h
2418 C3         +1  5671     dcob:   clr     c
2419 33         +1  5672                     rlc     a
241A CA         +1  5673                     xch     a,r2
241B 33         +1  5674                     rlc     a
241C CA         +1  5675                     xch     a,r2
241D C8         +1  5676                     xch     a,r0
241E F9         +1  5677                     mov     r1,a
241F C8         +1  5678                     xch     a,r0
2420 7C03       +1  5679                     mov     r4,#03
2422 FD         +1  5680                     mov     r5,a
2423 E7         +1  5681     dcoc:   mov     a,@r1 
2424 37         +1  5682                     addc    a,@r1
2425 D4         +1  5683                     da      a
2426 F7         +1  5684                     mov     @r1,a
2427 09         +1  5685                     inc     r1
2428 DCF9       +1  5686                     djnz    r4,dcoc
242A ED         +1  5687                     mov     a,r5
242B 4003       +1  5688                     jc      dcod
242D DBE9       +1  5689                     djnz    r3,dcob
242F C3         +1  5690                     clr     c
2430 00         +1  5691     dcod:   nop
2431 22         +1  5692                     ret
                +1  5693     
2432 8A08       +1  5694     move28: mov     ltemp,r2                        ;r2..r5->ltemp
2434 850309     +1  5695                     mov     ltemp+1,3
2437 85040A     +1  5696                     mov     ltemp+2,4
243A 85050B     +1  5697                     mov     ltemp+3,5
243D 22         +1  5698                     ret
                +1  5699     
                +1  5700     ;@r0..@r0+3->r2..r5
                +1  5701     
243E E6         +1  5702     resar2: mov     a,@r0
243F FA         +1  5703                     mov     r2,a
2440 08         +1  5704                     inc     r0
2441 E6         +1  5705                     mov     a,@r0
2442 FB         +1  5706                     mov     r3,a
2443 08         +1  5707                     inc     r0
2444 E6         +1  5708                     mov     a,@r0
2445 FC         +1  5709                     mov     r4,a
2446 08         +1  5710                     inc     r0
2447 E6         +1  5711                     mov     a,@r0
2448 FD         +1  5712                     mov     r5,a
2449 22         +1  5713                     ret
                +1  5714     
                +1  5715     ;25mkc !!!!!!!!!!!!!!!1
244A 7B4B       +1  5716     z_9:      mov R3,#4Bh      ;загрузка числа
244C DBFE       +1  5717                    djnz R3,$
244E 22         +1  5718               ret
                +1  5719     
                +1  5720     ;запись   передаваемый байт в acc
                +1  5721     ;передача байта послед кодом старшими разрядами  вперед
244F 7A08       +1  5722     write:     mov R2,#8
2451 C3         +1  5723                             clr  c  
2452 C297       +1  5724     wr1:            clr             p1.7;P1.2
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    92

2454 00         +1  5725                         nop 
2455 33         +1  5726                             rlc A
2456 9296       +1  5727                             mov P1.6,C;P1.1,C
2458 120000   F +1  5728                        call tim2
245B D297       +1  5729                        setb P1.7;P1.2
245D 120000   F +1  5730                call tim2
2460 DAF0       +1  5731                       djnz R2,wr1
2462 C296       +1  5732                       clr P1.6;P1.1
2464 22         +1  5733                                              ret
                +1  5734     
                +1  5735     ;чтение номера байта с индикатора(2байта)
                +1  5736     ;bufind+8..bufind+9
                +1  5737     ;-  - - -
                +1  5738     ;- - - - - - - - - -
                +1  5739     ;adec..adec+9
                +1  5740     ;ст            мл
2465 7847       +1  5741     upak1:  mov             r0,#bufind+7;
2467 795C       +1  5742                                     mov             r1,#adec+9
2469 C3         +1  5743                                     clr             c
246A E6         +1  5744                                     mov             a,@r0
246B 9430       +1  5745                                     subb    a,#30h
246D FF         +1  5746                                     mov             r7,a
246E C3         +1  5747                                     clr             c
246F 9405       +1  5748                                     subb    a,#5
2471 4004       +1  5749                                     jc              upk1
2473 7404       +1  5750                                     mov             a,#4
2475 8001       +1  5751                                     jmp             upk2
2477 EF         +1  5752     upk1:           mov             a,r7
2478 F7         +1  5753     upk2:           mov             @r1,a
2479 22         +1  5754                                     ret  
                +1  5755     ;r1-мл байт счетчика ячеек
247A C3         +1  5756     chminus:        clr                     c
247B E7         +1  5757                                             mov                     a,@r1
247C 9401       +1  5758                                             subb            a,#01
247E F7         +1  5759                                             mov                     @r1,a;low
247F 19         +1  5760                                             dec                     r1
2480 E7         +1  5761                                             mov                     a,@r1
2481 9400       +1  5762                                             subb            a,#00
2483 F7         +1  5763                                             mov                     @r1,a
2484 22         +1  5764                                             ret
                +1  5765     
                +1  5766     
                +1  5767     ;чтение номера байта с индикатора(4байта)
                +1  5768     ;bufind+6..bufind+9
                +1  5769     ;-  - - -
                +1  5770     ;- - - - - - - - - -
                +1  5771     ;adec..adec+9
                +1  5772     ;ст            мл
2485 7848       +1  5773     upak4:  mov             r0,#bufind+8;
2487 795C       +1  5774                     mov             r1,#adec+9
2489 7F04       +1  5775                     mov             r7,#4
248B C3         +1  5776     upaa:   clr             c
248C E6         +1  5777                     mov             a,@r0
248D 9430       +1  5778                     subb    a,#30h
248F F7         +1  5779                     mov             @r1,a
2490 18         +1  5780                     dec             r0
2491 19         +1  5781                     dec             r1
2492 DFF7       +1  5782                     djnz    r7,upaa
2494 22         +1  5783                     ret
                +1  5784     
                +1  5785     ;dptr-адр ячейки 1й соотв блока 
2495 E538       +1  5786     adrblok:         mov            a,nblok
2497 C3         +1  5787                              clr            c
2498 9401       +1  5788                              subb           a,#1
249A FD         +1  5789                              mov            r5,a
249B E4         +1  5790                              clr            a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    93

249C FC         +1  5791                              mov            r4,a
249D FB         +1  5792                              mov            r3,a
249E FA         +1  5793                              mov            r2,a
249F 900000   F +1  5794                                     mov                     dptr,#ch320h
24A2 120000   F +1  5795                                     CALL   ldc_ltemp                 ; ltemp <-320
24A5 120000   F +1  5796                                     call            lmul;r2..r5
24A8 ED         +1  5797                                     mov                     a,r5
24A9 2450       +1  5798                                     add                     a,#50h
24AB F582       +1  5799                                     mov                     dpl,a
24AD EC         +1  5800                                     mov                     a,r4
24AE 3401       +1  5801                                     addc            a,#01           
24B0 F583       +1  5802                                     mov                     dph,a                   ;dptr-
24B2 22         +1  5803                                     ret
                +1  5804     
                +1  5805     ;
                +1  5806     ;saven_bl<-dptr  адрес след ячейки внешн озу 
24B3 79D3       +1  5807     save_hl:                mov             r1,#saven_bl
24B5 E583       +1  5808                                                     mov             a,dph
24B7 F7         +1  5809                                               mov           @r1,a
24B8 09         +1  5810                                                     inc             r1
24B9 E582       +1  5811                                                     mov             a,dpl
24BB F7         +1  5812                                                     mov             @r1,a
                +1  5813                                                     ;;;;;;;;;не конец ли блока
                +1  5814                             
                +1  5815     
24BC 79D6       +1  5816                                     mov                     r1,#volume+1;work+1
24BE 120000   F +1  5817                                     call            chminus
24C1 78D5       +1  5818                                     mov             r0,#volume
24C3 E6         +1  5819                                     mov             a,@r0
24C4 30E702     +1  5820                                     jnb             acc.7,noendli
24C7 C20A       +1  5821                                     clr                     bitbon                  ;блок закон
                             чился
                +1  5822                             
24C9            +1  5823     noendli:        
24C9 22         +1  5824                                             ret
                +1  5825     ;загрузка dptr сохр ранее значением адреса ячейки
24CA 79D3       +1  5826     resa_hl:                mov             r1,#saven_bl
24CC E7         +1  5827                                                     mov             a,@r1
24CD F583       +1  5828                                                     mov             dph,a
                +1  5829                                               
24CF 09         +1  5830                                                     inc             r1
24D0 E7         +1  5831                                                     mov             a,@r1
24D1 F582       +1  5832                                                     mov             dpl,a
24D3 22         +1  5833                                                     ret
                +1  5834     ;загрузка rez_A3 в соотв яч внешн озу
24D4 789C       +1  5835     loA3_X:                 mov             r0,#rez_A3
24D6 120000   F +1  5836                                                     call    resar2
                +1  5837                                                     
24D9 EA         +1  5838                                                     mov             a,r2                    ;
24DA F0         +1  5839                                                     movx    @dptr,a
24DB A3         +1  5840                                                     inc             dptr
24DC EB         +1  5841                                                     mov             a,r3
24DD F0         +1  5842                                                     movx    @dptr,a
24DE A3         +1  5843                                                     inc             dptr
24DF EC         +1  5844                                                     mov             a,r4
24E0 F0         +1  5845                                                     movx    @dptr,a
24E1 A3         +1  5846                                                     inc             dptr
24E2 ED         +1  5847                                                     mov             a,r5
24E3 F0         +1  5848                                                     movx    @dptr,a
24E4 A3         +1  5849                                                     inc             dptr;адрес след ячейки внеш
                             н озу храним
24E5 22         +1  5850                                                     ret             ;в ячейке saven_bl
                +1  5851     ;чтение в rez_A3 из соотв яч внешн озу
24E6            +1  5852     reA3_X:         
                +1  5853                                                     
24E6 E0         +1  5854                                                     movx    a,@dptr
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    94

24E7 FA         +1  5855                                                     mov             r2,a
24E8 A3         +1  5856                                                     inc             dptr
24E9 E0         +1  5857                                                     movx    a,@dptr
24EA FB         +1  5858                                                     mov             r3,a
24EB A3         +1  5859                                                     inc             dptr
24EC E0         +1  5860                                                     movx    a,@dptr
24ED FC         +1  5861                                                     mov             r4,a
24EE A3         +1  5862                                                     inc             dptr
24EF E0         +1  5863                                                     movx    a,@dptr
24F0 FD         +1  5864                                                     mov             r5,a
24F1 A3         +1  5865                                                     inc             dptr
24F2 789C       +1  5866                                                     mov             r0,#rez_A3
24F4 120000   F +1  5867                                                     call    saver2
24F7 22         +1  5868                                                     ret
                    5869     
                    5870     ;$include (d:\amp\sarifm3.asm) 
                +1  5871     ; ” ©« SARIFM.ASM 8.11.95
                +1  5872     ;файл арифметики
                +1  5873       
  0008          +1  5874     ltemp    equ       8           ;long temporary
  000C          +1  5875     xtemp    equ       12          ;other temporaries
  000A          +1  5876     DECSIZE  EQU       10
  0004          +1  5877     NUMSIZE  EQU       4
  0004          +1  5878     RR4  EQU       4
  0005          +1  5879     RR5  EQU       5
                +1  5880     
                +1  5881                                                     
                +1  5882     
                +1  5883                 ; rseg     ARIF          ; Switch to this code segment.
                +1  5884     ;             using    0              ; Specify register bank for the following
                +1  5885                                            ; program code.
                +1  5886     ;                                               cseg AT 400h
                +1  5887     ; Arithmetics:  CLEARING string
                +1  5888     ; Input:
                +1  5889     ; R0 - pointer to string,
                +1  5890     ; NUMSIZE - byte count if CLRNUM used,
                +1  5891     ; DECSIZE - byte count if CLRDEC used,
                +1  5892     ; R2 - byte count if CLEAR used;
                +1  5893     ; Output:  none.
                +1  5894     
24F8            +1  5895     CLRDEC:
24F8 7A0A       +1  5896         MOV R2, #DECSIZE
24FA 8002       +1  5897         SJMP    CLEAR
24FC            +1  5898     CLRNUM:
24FC 7A04       +1  5899         MOV R2, #NUMSIZE
                +1  5900         ;JMP    CLEAR
24FE            +1  5901     CLEAR:
24FE E4         +1  5902         CLR A
24FF F6         +1  5903     CLR11:  MOV @R0, A
2500 08         +1  5904         INC R0
2501 DAFC       +1  5905         DJNZ    R2, CLR11
2503 22         +1  5906         RET
                +1  5907     
                +1  5908     ;**********************************
                +1  5909     ;mov    r1,#abin+3
                +1  5910     ;mov    r0,#adec
                +1  5911     ; _ _ _ _
                +1  5912     ;     03ff
                +1  5913     ;ст     мл   - вход
                +1  5914     ; _ _ _ _ _ _ _ _ _ _
                +1  5915     ;             1 0 2 3
                +1  5916     ;ст                мл 
                +1  5917     ;**********************************
                +1  5918     
2504            +1  5919     BINDEC:
                +1  5920     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    95

                +1  5921     ; Input:
                +1  5922     ; R0 - pointer to destination (high digit is the first),
                +1  5923     ; R1 - pointer to source,
                +1  5924     ; NUMSIZE - byte count in binary number;
                +1  5925     ; DECSIZE - byte count in decimal number;
                +1  5926     ; Output:  none.
                +1  5927     ; Source saved
                +1  5928     
                +1  5929         ; 1. Clear result
2504 7A05       +1  5930         MOV R2, #DECSIZE/2
2506 120000   F +1  5931         CALL   CLEAR  ; incrementing R0
                +1  5932     
                +1  5933         ; 2. Prepare convertion
2509 18         +1  5934         DEC R0
250A 8804       +1  5935         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
250C 8905       +1  5936         MOV RR5, R1 ; R5 - pointer to low byte of binary number
250E 7B20       +1  5937         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  5938     
                +1  5939         ; 3. Convert cyrcle
2510            +1  5940     BIN30:
                +1  5941     
                +1  5942         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
2510 A905       +1  5943         MOV R1, RR5
2512 7A04       +1  5944         MOV R2, #NUMSIZE
2514 E7         +1  5945     BIN31:  MOV A, @R1
2515 33         +1  5946         RLC A
2516 F7         +1  5947         MOV @R1, A
2517 19         +1  5948         DEC R1
2518 DAFA       +1  5949         DJNZ    R2, BIN31
251A A905       +1  5950         MOV R1, RR5
251C E7         +1  5951         MOV A, @R1
251D 92E0       +1  5952         MOV ACC.0, C
251F F7         +1  5953         MOV @R1, A
                +1  5954     
                +1  5955         ; 3.2. Doubling decimal result with <Carry>
2520 A804       +1  5956         MOV R0, RR4
2522 7A05       +1  5957         MOV R2, #DECSIZE/2
2524 E6         +1  5958     BIN32:  MOV A, @R0
2525 36         +1  5959         ADDC    A, @R0
2526 D4         +1  5960         DA  A
2527 F6         +1  5961         MOV @R0, A
2528 18         +1  5962         DEC R0
2529 DAF9       +1  5963         DJNZ    R2, BIN32
                +1  5964     
                +1  5965         ; 3.3. End of convert cyrcle
252B DBE3       +1  5966         DJNZ    R3, BIN30
                +1  5967     
                +1  5968         ; 4. Make bytes from half-bytes
252D E8         +1  5969         MOV A, R0
252E 240A       +1  5970         ADD A, #DECSIZE
2530 F8         +1  5971         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
2531 A904       +1  5972         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
2533 7A05       +1  5973         MOV R2, #DECSIZE/2
2535 E7         +1  5974     BIN41:  MOV A, @R1
2536 540F       +1  5975         ANL A, #00FH
2538 F6         +1  5976         MOV @R0, A
2539 18         +1  5977         DEC R0
253A E7         +1  5978         MOV A, @R1
253B C4         +1  5979         SWAP    A
253C 540F       +1  5980         ANL A, #00FH
253E F6         +1  5981         MOV @R0, A
253F 18         +1  5982         DEC R0
2540 19         +1  5983         DEC R1
2541 DAF2       +1  5984         DJNZ    R2, BIN41
2543 22         +1  5985         RET
                +1  5986     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    96

                +1  5987     
                +1  5988     ;*********************************
                +1  5989     ;mov    r0,#abin
                +1  5990     ;mov    r1,#adec
                +1  5991     ; _ _ _ _       -выход
                +1  5992     ; ff0000
                +1  5993     ;0004
                +1  5994     ;мл      ст
                +1  5995     
                +1  5996     ;ст                       мл
                +1  5997     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  5998     ;                       2 5 5
                +1  5999     ;                   1 0 2 4
                +1  6000     
2544            +1  6001     DECBIN:
                +1  6002     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  6003     ; Input:
                +1  6004     ; R0 - pointer to destination,
                +1  6005     ; R1 - pointer to source (high digit is the first),
                +1  6006     ; NUMSIZE - byte count in binary number;
                +1  6007     ; DECSIZE - byte count in decimal number;
                +1  6008     ; Output:  none
                +1  6009     ; Source cleared
                +1  6010     
                +1  6011         ; 1. Clear result
2544 120000   F +1  6012         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  6013     
                +1  6014         ; 2. Prepare convertion
2547 18         +1  6015         DEC R0
2548 8804       +1  6016         MOV RR4, R0 ; R4 - pointer to high byte of binary result
254A 8905       +1  6017         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
254C 900000   F +1  6018         MOV DPTR, #DECT2
254F 7B20       +1  6019         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  6020     
                +1  6021         ; 3. Convert cyrcle
2551            +1  6022     DEC30:
                +1  6023     
                +1  6024         ; 3.1. Divide decimal number by 2 and prepare <Carry>
2551 C3         +1  6025         CLR C
2552 A905       +1  6026         MOV R1, RR5
2554 7A0A       +1  6027         MOV R2, #DECSIZE
2556 E7         +1  6028     DEC31:  MOV A, @R1
2557 540F       +1  6029         ANL A, #00FH
2559 92E4       +1  6030         MOV ACC.4, C
255B 93         +1  6031         MOVC    A,@A+DPTR
255C F7         +1  6032         MOV @R1, A
255D A2E7       +1  6033         MOV C, ACC.7
255F 09         +1  6034         INC R1
2560 DAF4       +1  6035         DJNZ    R2, DEC31
                +1  6036     
                +1  6037         ; 3.2. Rotate binary result one bit to right with <Carry>
2562 A804       +1  6038         MOV R0, RR4
2564 7A04       +1  6039         MOV R2, #NUMSIZE
2566 E6         +1  6040     DEC32:  MOV A, @R0
2567 13         +1  6041         RRC A
2568 F6         +1  6042         MOV @R0, A
2569 18         +1  6043         DEC R0
256A DAFA       +1  6044         DJNZ    R2, DEC32
                +1  6045     
                +1  6046         ; 3.3. End of convert cyrcle
256C DBE3       +1  6047         DJNZ    R3, DEC30
256E 22         +1  6048         RET
                +1  6049     
256F 00800181   +1  6050     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
2573 02820383                
2577 0484                    
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    97

2579 00000000   +1  6051         DB  00,00,00,00,00,00
257D 0000                    
257F 05850686   +1  6052         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
2583 07870888                
2587 0989                    
                +1  6053     
                +1  6054     ;   Long comparison
                +1  6055     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  6056     ;   flags and acc set as though a long subtraction was done.
                +1  6057     ;*******************************
                +1  6058     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  6059     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  6060     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  6061     ;*******************************
2589            +1  6062     lcmp:
2589 C3         +1  6063         clr c
258A EA         +1  6064         mov a,r2
258B 9508       +1  6065         subb    a,8
258D 700F       +1  6066         jnz done
258F EB         +1  6067         mov a,r3
2590 9509       +1  6068         subb    a,9
2592 7008       +1  6069         jnz done1
2594 EC         +1  6070         mov a,r4
2595 950A       +1  6071         subb    a,10
2597 7003       +1  6072         jnz done1
2599 ED         +1  6073         mov a,r5
259A 950B       +1  6074         subb    a,11
259C            +1  6075     done1:
259C C2D2       +1  6076         clr ov      ;overflow is significant only for top byte
259E            +1  6077     done:
259E 22         +1  6078         ret
                +1  6079     
                +1  6080     ;   Load long into r2-5 from [dptr]
                +1  6081     
259F            +1  6082     ldc_long:
259F E583       +1  6083         mov a,dph       ;is it in on board memory
25A1 6010       +1  6084         jz  onboard     ;yes
25A3 E4         +1  6085         clr a
25A4 93         +1  6086         movc    a,@a+dptr
25A5 FA         +1  6087         mov r2,a
25A6 7401       +1  6088         mov a,#1
25A8 93         +1  6089         movc    a,@a+dptr
25A9 FB         +1  6090         mov r3,a
25AA 7402       +1  6091         mov a,#2
25AC 93         +1  6092         movc    a,@a+dptr
25AD FC         +1  6093         mov r4,a
25AE 7403       +1  6094         mov a,#3
25B0 93         +1  6095         movc    a,@a+dptr
25B1 FD         +1  6096         mov r5,a
25B2 22         +1  6097         ret
25B3            +1  6098     onboard:
25B3 A882       +1  6099         mov r0,dpl
25B5 E6         +1  6100         mov a,@r0
25B6 FA         +1  6101         mov r2,a
25B7 08         +1  6102         inc r0
25B8 E6         +1  6103         mov a,@r0
25B9 FB         +1  6104         mov r3,a
25BA 08         +1  6105         inc r0
25BB E6         +1  6106         mov a,@r0
25BC FC         +1  6107         mov r4,a
25BD 08         +1  6108         inc r0
25BE E6         +1  6109         mov a,@r0
25BF FD         +1  6110         mov r5,a
25C0 22         +1  6111         ret
                +1  6112     
                +1  6113     ;**************************************
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    98

                +1  6114     ;загрузить ltemp...+3 из памяти программ
                +1  6115     ;mov    dptr,#CH5
                +1  6116     ;call   ldc_ltemp        ltemp <--5
                +1  6117     ;**************************************
25C1            +1  6118     ldc_ltemp:
25C1 E583       +1  6119         mov a,dph       ;is it in on board memory
25C3 6014       +1  6120         jz  oboard      ;yes
25C5 E4         +1  6121         clr a
25C6 93         +1  6122         movc    a,@a+dptr
25C7 F508       +1  6123         mov 8,a
25C9 7401       +1  6124         mov a,#1
25CB 93         +1  6125         movc    a,@a+dptr
25CC F509       +1  6126         mov 9,a
25CE 7402       +1  6127         mov a,#2
25D0 93         +1  6128         movc    a,@a+dptr
25D1 F50A       +1  6129         mov 10,a
25D3 7403       +1  6130         mov a,#3
25D5 93         +1  6131         movc    a,@a+dptr
25D6 F50B       +1  6132         mov 11,a
25D8 22         +1  6133         ret
25D9            +1  6134     oboard:
25D9 A882       +1  6135         mov r0,dpl
25DB 8608       +1  6136         mov 8,@r0
25DD 08         +1  6137         inc r0
25DE 8609       +1  6138         mov 9,@r0
25E0 08         +1  6139         inc r0
25E1 860A       +1  6140         mov 10,@r0
25E3 08         +1  6141         inc r0
25E4 860B       +1  6142         mov 11,@r0
25E6 22         +1  6143         ret
                +1  6144     
                +1  6145     ;*****************************
                +1  6146     ;mov    dptr,#k1
                +1  6147     ;call   ldx_long
                +1  6148     ;k1->r2..r5
                +1  6149     ;*****************************
                +1  6150     ;   Load long into r2-5 from [dptr]
                +1  6151     ;
                +1  6152     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
25E7            +1  6153     ldx_long:
25E7 E583       +1  6154         mov a,dph       ;is it in on board memory
25E9 6014       +1  6155         jz  onboar1        ;yes
25EB C082       +1  6156         push    dpl
25ED C083       +1  6157         push    dph
25EF E0         +1  6158         movx    a,@dptr
25F0 FA         +1  6159         mov r2,a
25F1 A3         +1  6160         inc dptr
25F2 E0         +1  6161         movx    a,@dptr
25F3 FB         +1  6162         mov r3,a
25F4 A3         +1  6163         inc dptr
25F5 E0         +1  6164         movx    a,@dptr
25F6 FC         +1  6165         mov r4,a
25F7 A3         +1  6166         inc dptr
25F8 E0         +1  6167         movx    a,@dptr
25F9 FD         +1  6168         mov r5,a
25FA D083       +1  6169         pop dph
25FC D082       +1  6170         pop dpl
25FE 22         +1  6171         ret
25FF            +1  6172     onboar1:
25FF A882       +1  6173         mov r0,dpl
2601 E6         +1  6174         mov a,@r0
2602 FA         +1  6175         mov r2,a
2603 08         +1  6176         inc r0
2604 E6         +1  6177         mov a,@r0
2605 FB         +1  6178         mov r3,a
2606 08         +1  6179         inc r0
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE    99

2607 E6         +1  6180         mov a,@r0
2608 FC         +1  6181         mov r4,a
2609 08         +1  6182         inc r0
260A E6         +1  6183         mov a,@r0
260B FD         +1  6184         mov r5,a
260C 22         +1  6185         ret
                +1  6186     
                +1  6187     ;*********************************
                +1  6188     ;mov    dptr,#k2
                +1  6189     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  6190     ;**********************************
260D            +1  6191     ldx_ltemp:
260D E583       +1  6192         mov a,dph       ;is it in on board memory
260F 6010       +1  6193         jz  oboard1     ;yes
2611 E0         +1  6194         movx    a,@dptr
2612 F508       +1  6195         mov 8,a
2614 A3         +1  6196         inc dptr
2615 E0         +1  6197         movx    a,@dptr
2616 F509       +1  6198         mov 9,a
2618 A3         +1  6199         inc dptr
2619 E0         +1  6200         movx    a,@dptr
261A F50A       +1  6201         mov 10,a
261C A3         +1  6202         inc dptr
261D E0         +1  6203         movx    a,@dptr
261E F50B       +1  6204         mov 11,a
2620 22         +1  6205         ret
2621            +1  6206     oboard1:
2621 A882       +1  6207         mov r0,dpl
2623 8608       +1  6208         mov 8,@r0
2625 08         +1  6209         inc r0
2626 8609       +1  6210         mov 9,@r0
2628 08         +1  6211         inc r0
2629 860A       +1  6212         mov 10,@r0
262B 08         +1  6213         inc r0
262C 860B       +1  6214         mov 11,@r0
262E 22         +1  6215         ret
                +1  6216     ;   Long division routines for 8051
                +1  6217     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  6218     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
                +1  6219     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  6220     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  6221     ;   r1 must be saved by the caller.
                +1  6222     ;   This is long unsigned division.
                +1  6223     
                +1  6224     
                +1  6225     ;   Register usage:
                +1  6226     ;       r0 loop counter
                +1  6227     ;       xtemp (12-15) accumulates quotient
                +1  6228     ;       r5-r2 holds dividend
                +1  6229     ;       ltemp holds divisor
                +1  6230     
                +1  6231     ;************************************
                +1  6232     ;r2..r5-делимое
                +1  6233     ;ltemp..-делитель
                +1  6234     ;частное -r2..r5
                +1  6235     ;*************************************
262F            +1  6236     divide:
262F E4         +1  6237         clr a
2630 F8         +1  6238         mov r0,a        ;initialize count
2631 F50C       +1  6239         mov xtemp,a     ;zero quotient
2633 F50D       +1  6240         mov xtemp+1,a
2635 F50E       +1  6241         mov xtemp+2,a
2637 F50F       +1  6242         mov xtemp+3,a
2639 ED         +1  6243         mov a,r5        ;check for zero dividend
263A 4C         +1  6244         orl a,r4
263B 4B         +1  6245         orl a,r3
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   100

263C 4A         +1  6246         orl a,r2
263D 600B       +1  6247         jz  jfinis
263F E508       +1  6248         mov a,ltemp     ;check for zero divisor
2641 4509       +1  6249         orl a,ltemp+1
2643 450A       +1  6250         orl a,ltemp+2
2645 450B       +1  6251         orl a,ltemp+3
2647 7037       +1  6252         jnz midl
2649 22         +1  6253         ret
                +1  6254     
264A 020000   F +1  6255     jfinis: jmp finis
                +1  6256     
264D            +1  6257     loops:
264D EA         +1  6258         mov a,r2
264E C3         +1  6259         clr c
264F 9508       +1  6260         subb    a,ltemp+0   ;is divisor greater than dividend yet
2651 4033       +1  6261         jc  yes     ;yes, go no further
2653 7013       +1  6262         jnz no
2655 EB         +1  6263         mov a,r3
2656 9509       +1  6264         subb    a,ltemp+1
2658 402C       +1  6265         jc  yes
265A 700C       +1  6266         jnz no
265C EC         +1  6267         mov a,r4
265D 950A       +1  6268         subb    a,ltemp+2
265F 4025       +1  6269         jc  yes
2661 7005       +1  6270         jnz no
2663 ED         +1  6271         mov a,r5
2664 950B       +1  6272         subb    a,ltemp+3
2666 401E       +1  6273         jc  yes
2668            +1  6274     no:
2668 E50B       +1  6275         mov a,ltemp+3   ;shift divisor up one bit
266A 250B       +1  6276         add a,ltemp+3
266C F50B       +1  6277         mov ltemp+3,a
266E E50A       +1  6278         mov a,ltemp+2
2670 350A       +1  6279         addc    a,ltemp+2
2672 F50A       +1  6280         mov ltemp+2,a
2674 E509       +1  6281         mov a,ltemp+1
2676 3509       +1  6282         addc    a,ltemp+1
2678 F509       +1  6283         mov ltemp+1,a
267A E508       +1  6284         mov a,ltemp+0
267C 3508       +1  6285         addc    a,ltemp+0
267E F508       +1  6286         mov ltemp+0,a
2680            +1  6287     midl:
2680 08         +1  6288         inc r0      ;increment count
2681 E508       +1  6289         mov a,ltemp+0   ;check for safe to shift some more
2683 30E7C7     +1  6290         jnb acc.7,loops  ;loop if top bit clear
2686            +1  6291     yes:
2686 E508       +1  6292         mov a,ltemp+0
2688 C3         +1  6293         clr c
2689 9A         +1  6294         subb    a,r2        ;can we subtract now?
268A 401A       +1  6295         jc  dosub       ;yes, go and do it
268C 7015       +1  6296         jnz nosub
268E E509       +1  6297         mov a,ltemp+1
2690 9B         +1  6298         subb    a,r3
2691 4013       +1  6299         jc  dosub
2693 700E       +1  6300         jnz nosub
2695 E50A       +1  6301         mov a,ltemp+2
2697 9C         +1  6302         subb    a,r4
2698 400C       +1  6303         jc  dosub
269A 7007       +1  6304         jnz nosub
269C E50B       +1  6305         mov a,ltemp+3
269E 9D         +1  6306         subb    a,r5
269F 4005       +1  6307         jc  dosub
26A1 6003       +1  6308         jz  dosub
26A3            +1  6309     nosub:
26A3 C3         +1  6310         clr c
26A4 8012       +1  6311         sjmp    dosh
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   101

26A6            +1  6312     dosub:
26A6 C3         +1  6313         clr c       ;subtract divisor from dividend
26A7 ED         +1  6314         mov a,r5
26A8 950B       +1  6315         subb    a,ltemp+3
26AA FD         +1  6316         mov r5,a
26AB EC         +1  6317         mov a,r4
26AC 950A       +1  6318         subb    a,ltemp+2
26AE FC         +1  6319         mov r4,a
26AF EB         +1  6320         mov a,r3
26B0 9509       +1  6321         subb    a,ltemp+1
26B2 FB         +1  6322         mov r3,a
26B3 EA         +1  6323         mov a,r2
26B4 9508       +1  6324         subb    a,ltemp+0
26B6 FA         +1  6325         mov r2,a
26B7 D3         +1  6326         setb    c       ;now set bit for quotient
26B8            +1  6327     dosh:
26B8 E50F       +1  6328         mov a,xtemp+3
26BA 33         +1  6329         rlc a
26BB F50F       +1  6330         mov xtemp+3,a
26BD E50E       +1  6331         mov a,xtemp+2
26BF 33         +1  6332         rlc a
26C0 F50E       +1  6333         mov xtemp+2,a
26C2 E50D       +1  6334         mov a,xtemp+1
26C4 33         +1  6335         rlc a
26C5 F50D       +1  6336         mov xtemp+1,a
26C7 E50C       +1  6337         mov a,xtemp+0
26C9 33         +1  6338         rlc a
26CA F50C       +1  6339         mov xtemp+0,a
26CC E508       +1  6340         mov a,ltemp+0       ;shift divisor down
26CE C3         +1  6341         clr c
26CF 13         +1  6342         rrc a
26D0 F508       +1  6343         mov ltemp+0,a
26D2 E509       +1  6344         mov a,ltemp+1
26D4 13         +1  6345         rrc a
26D5 F509       +1  6346         mov ltemp+1,a
26D7 E50A       +1  6347         mov a,ltemp+2
26D9 13         +1  6348         rrc a
26DA F50A       +1  6349         mov ltemp+2,a
26DC E50B       +1  6350         mov a,ltemp+3
26DE 13         +1  6351         rrc a
26DF F50B       +1  6352         mov ltemp+3,a
                +1  6353     
26E1 D8A3       +1  6354         djnz    r0,yes      ;and continue with the rest
                +1  6355     
26E3            +1  6356     finis:
26E3 8D0B       +1  6357         mov ltemp+3,r5
26E5 8C0A       +1  6358         mov ltemp+2,r4
26E7 8B09       +1  6359         mov ltemp+1,r3
26E9 8A08       +1  6360         mov ltemp+0,r2
26EB AD0F       +1  6361         mov r5,xtemp+3
26ED AC0E       +1  6362         mov r4,xtemp+2
26EF AB0D       +1  6363         mov r3,xtemp+1
26F1 AA0C       +1  6364         mov r2,xtemp+0
26F3 22         +1  6365         ret         ;and return with the satisfaction of a job well done
                +1  6366     
                +1  6367     
                +1  6368     ;   Long multiplication
                +1  6369     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  6370     ;   other in ltemp. It really doesn't matter which one is where.
                +1  6371     
                +1  6372     ;**********************************
                +1  6373     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  6374     ;ст  мл
                +1  6375     ;**********************************
26F4            +1  6376     llmul:
26F4            +1  6377     almul:
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   102

26F4            +1  6378     lmul:
26F4 ED         +1  6379         mov a,r5        ;low order byte
26F5 850BF0     +1  6380         mov b,ltemp+3       ;times low order byte
26F8 A4         +1  6381         mul ab
26F9 F50F       +1  6382         mov xtemp+3,a       ;store low
26FB 85F00E     +1  6383         mov xtemp+2,b   ;and high
26FE ED         +1  6384         mov a,r5        ;low order
26FF 850AF0     +1  6385         mov b,ltemp+2   ;times next
2702 A4         +1  6386         mul ab
2703 250E       +1  6387         add a,xtemp+2   ;add in
2705 F50E       +1  6388         mov xtemp+2,a
2707 E5F0       +1  6389         mov a,b
2709 3400       +1  6390         addc    a,#0
270B F50D       +1  6391         mov xtemp+1,a
270D ED         +1  6392         mov a,r5
270E 8509F0     +1  6393         mov b,ltemp+1
2711 A4         +1  6394         mul ab
2712 250D       +1  6395         add a,xtemp+1
2714 F50D       +1  6396         mov xtemp+1,a
2716 E5F0       +1  6397         mov a,b
2718 3400       +1  6398         addc    a,#0
271A F50C       +1  6399         mov xtemp+0,a
271C ED         +1  6400         mov a,r5
271D 8508F0     +1  6401         mov b,ltemp+0
2720 A4         +1  6402         mul ab
2721 250C       +1  6403         add a,xtemp+0
2723 F50C       +1  6404         mov xtemp+0,a
2725 EC         +1  6405         mov a,r4
2726 850BF0     +1  6406         mov b,ltemp+3
2729 A4         +1  6407         mul ab
272A 250E       +1  6408         add a,xtemp+2
272C F50E       +1  6409         mov xtemp+2,a
272E E5F0       +1  6410         mov a,b
2730 350D       +1  6411         addc    a,xtemp+1
2732 F50D       +1  6412         mov xtemp+1,a
2734 E50C       +1  6413         mov a,xtemp+0
2736 3400       +1  6414         addc    a,#0
2738 F50C       +1  6415         mov xtemp+0,a
273A EC         +1  6416         mov a,r4
273B 850AF0     +1  6417         mov b,ltemp+2
273E A4         +1  6418         mul ab
273F 250D       +1  6419         add a,xtemp+1
2741 F50D       +1  6420         mov xtemp+1,a
2743 E5F0       +1  6421         mov a,b
2745 350C       +1  6422         addc    a,xtemp+0
2747 F50C       +1  6423         mov xtemp+0,a
2749 EC         +1  6424         mov a,r4
274A 8509F0     +1  6425         mov b,ltemp+1
274D A4         +1  6426         mul ab
274E 250C       +1  6427         add a,xtemp+0
2750 F50C       +1  6428         mov xtemp+0,a
                +1  6429     
2752 EB         +1  6430         mov a,r3
2753 850BF0     +1  6431         mov b,ltemp+3
2756 A4         +1  6432         mul ab
2757 250D       +1  6433         add a,xtemp+1
2759 F50D       +1  6434         mov xtemp+1,a
275B E5F0       +1  6435         mov a,b
275D 350C       +1  6436         addc    a,xtemp+0
275F F50C       +1  6437         mov xtemp+0,a
2761 EB         +1  6438         mov a,r3
2762 850AF0     +1  6439         mov b,ltemp+2
2765 A4         +1  6440         mul ab
2766 250C       +1  6441         add a,xtemp+0
2768 F50C       +1  6442         mov xtemp+0,a
                +1  6443     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   103

276A EA         +1  6444         mov a,r2
276B 850BF0     +1  6445         mov b,ltemp+3
276E A4         +1  6446         mul ab
276F 250C       +1  6447         add a,xtemp+0
2771 FA         +1  6448         mov r2,a
2772 AB0D       +1  6449         mov r3,xtemp+1
2774 AC0E       +1  6450         mov r4,xtemp+2
2776 AD0F       +1  6451         mov r5,xtemp+3
                +1  6452     
2778 22         +1  6453         ret         ;all done
                +1  6454     ;******************************
                +1  6455     ;из содержимого  r2-r5  вычесть
                +1  6456     ;содержимое          ltemp..ltemp+3
                +1  6457     ;******************************
2779            +1  6458     llsub:
2779            +1  6459      lsub:
2779 ED         +1  6460         mov a,r5
277A C3         +1  6461         clr c
277B 950B       +1  6462         subb    a,11
277D FD         +1  6463         mov r5,a
277E EC         +1  6464         mov a,r4
277F 950A       +1  6465         subb    a,10
2781 FC         +1  6466         mov r4,a
2782 EB         +1  6467         mov a,r3
2783 9509       +1  6468         subb    a,9
2785 FB         +1  6469         mov r3,a
2786 EA         +1  6470         mov a,r2
2787 9508       +1  6471         subb    a,8
2789 FA         +1  6472         mov r2,a
278A 22         +1  6473         ret
                +1  6474     
                +1  6475     ;***********************************************
                +1  6476     ;                                                      ст мл
                +1  6477     ; cложение содержимого  r2..r5 с числом по адресу
                +1  6478     ;  r0- адрес младшего байта !!!
                +1  6479     ;результат- r2..r5
                +1  6480     ;***********************************************
                +1  6481     
278B C3         +1  6482     ladd:    clr       c
278C ED         +1  6483          mov       a,r5
278D 26         +1  6484          add       a,@r0
278E FD         +1  6485          mov       r5,a
278F 18         +1  6486          dec       r0
2790 EC         +1  6487          mov       a,r4
2791 36         +1  6488          addc      a,@r0
2792 FC         +1  6489          mov       r4,a
2793 18         +1  6490          dec       r0
2794 EB         +1  6491          mov       a,r3
2795 36         +1  6492          addc      a,@r0
2796 FB         +1  6493          mov       r3,a
2797 18         +1  6494          dec       r0
2798 EA         +1  6495          mov       a,r2
2799 36         +1  6496          addc      a,@r0
279A FA         +1  6497          mov       r2,a
279B 22         +1  6498          ret
                +1  6499     ;***********************************************
                +1  6500     ;                                                      ст мл
                +1  6501     ; cложение содержимого  r2..r5 с числом по адресу
                +1  6502     ;  r0- адрес младшего байта !!!
                +1  6503     ;результат- r2..r5
                +1  6504     ;***********************************************
                +1  6505     
279C C3         +1  6506     laddx:    clr       c
279D E2         +1  6507                                             movx            a,@r0
279E 2D         +1  6508                                             add                     a,r5
279F FD         +1  6509               mov     r5,a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   104

27A0 18         +1  6510                             dec     r0
27A1 E2         +1  6511                             movx    a,@r0
27A2 3C         +1  6512                             addc    a,r4
27A3 FC         +1  6513                             mov     r4,a
27A4 18         +1  6514                             dec     r0
27A5 E2         +1  6515                             movx    a,@r0
27A6 3B         +1  6516                             addc    a,r3
27A7 FB         +1  6517                             mov     r3,a
27A8 18         +1  6518                             dec     r0
27A9 E2         +1  6519                             movx    a,@r0
27AA 3A         +1  6520                             addc    a,r2
27AB FA         +1  6521                             mov       r2,a
27AC 22         +1  6522                             ret
                +1  6523     
                +1  6524     ;***********************************************
                +1  6525     ;                                                      ст мл
                +1  6526     ; cложение содержимого  r2..r5 с числом по адресу
                +1  6527     ;  dptr- адрес младшего байта !!!
                +1  6528     ;результат- r2..r5
                +1  6529     ;***********************************************
                +1  6530     
27AD C3         +1  6531     addx:    clr       c
27AE E0         +1  6532                                             movx            a,@dptr
27AF 2D         +1  6533                                             add                     a,r5
27B0 FD         +1  6534               mov     r5,a
27B1 120000   F +1  6535                             call            dedptr;dec     dptr
27B4 E0         +1  6536                             movx    a,@dptr
27B5 3C         +1  6537                             addc    a,r4
27B6 FC         +1  6538                             mov     r4,a
27B7 120000   F +1  6539                             call            dedptr;dec     dptr
27BA E0         +1  6540                             movx    a,@dptr
27BB 3B         +1  6541                             addc    a,r3
27BC FB         +1  6542                             mov     r3,a
27BD 120000   F +1  6543                             call            dedptr;dec     dptr
27C0 E0         +1  6544                             movx    a,@dptr
27C1 3A         +1  6545                             addc    a,r2
27C2 FA         +1  6546                             mov       r2,a
27C3 22         +1  6547                             ret
                +1  6548     
27C4 C0D0       +1  6549     dedptr:         push    psw
27C6 C3         +1  6550                                             clr             c
27C7 E582       +1  6551                                             mov             a,dpl
27C9 9401       +1  6552                                             subb    a,#1
27CB F582       +1  6553                                             mov             dpl,a
27CD E583       +1  6554                                             mov             a,dph
27CF 9400       +1  6555                                             subb    a,#0
27D1 F583       +1  6556                                             mov             dph,a
27D3 D0D0       +1  6557                                             pop             psw
27D5 22         +1  6558                                             ret
                    6559     
                    6560     ;$include (d:\amp\floatm.asm)
                +1  6561     ;       Copyright (C) 1988 HI-TECH Software
                +1  6562     
                +1  6563     ;       Single Precision Floating point arithmetic routines for 8051
                +1  6564     
                +1  6565     ;       The format of floating point numbers is as follows:
                +1  6566     
                +1  6567     ;       -----------------
                +1  6568     ;       *     sign      *  1 bit
                +1  6569     ;       -----------------
                +1  6570     ;       *   exponent    *  8 bits
                +1  6571     ;       -----------------
                +1  6572     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  6573     ;       -----------------
                +1  6574     
                +1  6575     
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   105

                +1  6576     ;       As usual for the 8051 the memory layout has the most significant
                +1  6577     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  6578     ;       lowest address.
                +1  6579     
                +1  6580     ;       Calling conventions:
                +1  6581     
                +1  6582     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  6583     ;
                +1  6584     ;       Return value is in r2-r5
                +1  6585     
                +1  6586     ;       Naming conventions: A routine name is constructed by
                +1  6587     
                +1  6588     ;             ASOP
                +1  6589     
                +1  6590     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  6591     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  6592     ;       Conversion routines are named
                +1  6593     
                +1  6594     ;               AStof
                +1  6595     
                +1  6596     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  6597     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  6598     ;       Conversion from float to integer is ftol.
                +1  6599     
                +1  6600     ;               .ORG  5000h
                +1  6601     ;               .CODE
                +1  6602     ;       seg     c_text
                +1  6603     
                +1  6604     ;;      $MOD812
----            +1  6605             CSEG
                +1  6606             ;ORG 1000h
                +1  6607     
                +1  6608                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  6609             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  6610     
                +1  6611     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  6612     ;       macros
                +1  6613     
                +1  6614     saveregs        macro
                +1  6615             push    7
                +1  6616             push    6
                +1  6617             push    1
                +1  6618             push    0
                +1  6619             endm
                +1  6620     
                +1  6621     restregs        macro
                +1  6622             pop     0
                +1  6623             pop     1
                +1  6624             pop     6
                +1  6625             pop     7
                +1  6626             endm
                +1  6627     
                +1  6628     ;addr   
                +1  6629     dan     macro   pad
                +1  6630             mov     a,r5
                +1  6631             add     a,pad+3
                +1  6632             mov     pad+3,a
                +1  6633             mov     a,pad+2
                +1  6634             addc    a,r4
                +1  6635             mov     pad+2,a
                +1  6636             mov     a,pad+1
                +1  6637             addc    a,r3
                +1  6638             mov     pad+1,a
                +1  6639             mov     a,pad+0
                +1  6640             addc    a,r2
                +1  6641             mov     pad,a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   106

                +1  6642             endm
                +1  6643     
                +1  6644     addl    macro  addr
                +1  6645             mov     a,r5
                +1  6646             add     a,addr+3
                +1  6647             mov     r5,a
                +1  6648             mov     a,addr+2
                +1  6649             addc    a,r4
                +1  6650             mov     r4,a
                +1  6651             mov     a,addr+1
                +1  6652             addc    a,r3
                +1  6653             mov     r3,a
                +1  6654             mov     a,addr+0
                +1  6655             addc    a,r2
                +1  6656             mov     r2,a
                +1  6657             endm
                +1  6658     
                +1  6659     
                +1  6660     add1    macro
                +1  6661             mov     a,r5
                +1  6662             add     a,#1
                +1  6663             mov     r5,a
                +1  6664             clr     a
                +1  6665             addc    a,r4
                +1  6666             mov     r4,a
                +1  6667             clr     a
                +1  6668             addc    a,r3
                +1  6669             mov     r3,a
                +1  6670             clr     a
                +1  6671             addc    a,r2
                +1  6672             mov     r2,a
                +1  6673             endm
                +1  6674     
                +1  6675     shfdn   macro  addr
                +1  6676             clr     c
                +1  6677             mov     a,addr
                +1  6678             rrc     a
                +1  6679             mov     addr,a
                +1  6680             mov     a,addr+1
                +1  6681             rrc     a
                +1  6682             mov     addr+1,a
                +1  6683             mov     a,addr+2
                +1  6684             rrc     a
                +1  6685             mov     addr+2,a
                +1  6686             mov     a,addr+3
                +1  6687             rrc     a
                +1  6688             mov     addr+3,a
                +1  6689             endm
                +1  6690     
                +1  6691     shfup   macro  addr
                +1  6692             clr     c
                +1  6693             mov     a,addr+3
                +1  6694             rlc     a
                +1  6695             mov     addr+3,a
                +1  6696             mov     a,addr+2
                +1  6697             rlc     a
                +1  6698             mov     addr+2,a
                +1  6699             mov     a,addr+1
                +1  6700             rlc     a
                +1  6701             mov     addr+1,a
                +1  6702             mov     a,addr
                +1  6703             rlc     a
                +1  6704             mov     addr,a
                +1  6705             endm
                +1  6706     
                +1  6707     rshift  macro
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   107

                +1  6708             clr     c
                +1  6709             mov     a,r2
                +1  6710             rrc     a
                +1  6711             mov     r2,a
                +1  6712             mov     a,r3
                +1  6713             rrc     a
                +1  6714             mov     r3,a
                +1  6715             mov     a,r4
                +1  6716             rrc     a
                +1  6717             mov     r4,a
                +1  6718             mov     a,r5
                +1  6719             rrc     a
                +1  6720             mov     r5,a
                +1  6721             endm
                +1  6722     rshift1 macro
                +1  6723             setb    c
                +1  6724             mov     a,r2
                +1  6725             rrc     a
                +1  6726             mov     r2,a
                +1  6727             mov     a,r3
                +1  6728             rrc     a
                +1  6729             mov     r3,a
                +1  6730             mov     a,r4
                +1  6731             rrc     a
                +1  6732             mov     r4,a
                +1  6733             mov     a,r5
                +1  6734             rrc     a
                +1  6735             mov     r5,a
                +1  6736             endm
                +1  6737     
                +1  6738     
                +1  6739     lshift  macro
                +1  6740             mov     a,r5
                +1  6741             rlc     a
                +1  6742             mov     r5,a
                +1  6743             mov     a,r4
                +1  6744             rlc     a
                +1  6745             mov     r4,a
                +1  6746             mov     a,r3
                +1  6747             rlc     a
                +1  6748             mov     r3,a
                +1  6749             mov     a,r2
                +1  6750             rlc     a
                +1  6751             mov     r2,a
                +1  6752             endm
                +1  6753     
                +1  6754     neg1    macro
                +1  6755             clr     c
                +1  6756             clr     a
                +1  6757             subb    a,r5
                +1  6758             mov     r5,a
                +1  6759             clr     a
                +1  6760             subb    a,r4
                +1  6761             mov     r4,a
                +1  6762             clr     a
                +1  6763             subb    a,r3
                +1  6764             mov     r3,a
                +1  6765             clr     a
                +1  6766             subb    a,r2
                +1  6767             mov     r2,a
                +1  6768             endm
                +1  6769     
                +1  6770     negm    macro  addr
                +1  6771             clr     c
                +1  6772             clr     a
                +1  6773             subb    a,addr+3
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   108

                +1  6774             mov     addr+3,a
                +1  6775             clr     a
                +1  6776             subb    a,addr+2
                +1  6777             mov     addr+2,a
                +1  6778             clr     a
                +1  6779             subb    a,addr+1
                +1  6780             mov     addr+1,a
                +1  6781             clr     a
                +1  6782             subb    a,addr
                +1  6783             mov     addr,a
                +1  6784             endm
                +1  6785     
                +1  6786     copytor macro  addr
                +1  6787             mov     r2,addr
                +1  6788             mov     r3,addr+1
                +1  6789             mov     r4,addr+2
                +1  6790             mov     r5,addr+3
                +1  6791             endm
                +1  6792     
                +1  6793     
                +1  6794     copyrto macro  addr
                +1  6795             mov     addr,r2
                +1  6796             mov     addr+1,r3
                +1  6797             mov     addr+2,r4
                +1  6798             mov     addr+3,r5
                +1  6799             endm
                +1  6800     
                +1  6801     
                +1  6802     ;       Internal representation: in this set of routines a floating number
                +1  6803     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  6804     
                +1  6805     ;       Stack offset values
                +1  6806     ;ltemp   equ     28h
                +1  6807     
  0006          +1  6808     cntr    equ     6               ;r6 is the counter
  0007          +1  6809     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  6810     exp1    equ     0               ;exponent 1 in r0
  0002          +1  6811     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  6812     exp2    equ     1               ;exponent 1 in r1
  0008          +1  6813     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  6814     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  6815     
                +1  6816     
                +1  6817     
                +1  6818     
                +1  6819     
                +1  6820     ;DECSIZE EQU     10
                +1  6821     ;NUMSIZE EQU     4
                +1  6822     ;RR4     EQU     4
                +1  6823     ;RR5     EQU     5
                +1  6824     
                +1  6825     ;       unpack1 - unpacks the left operand
                +1  6826     
009E            +1  6827     unpack1:
009E EA         +1  6828             mov     a,r2            ;get sign
009F 5480       +1  6829             anl     a,#80h
00A1 530740     +1  6830             anl     sign,#40h       ;clear other bits
00A4 4207       +1  6831             orl     sign,a          ;store sign
00A6 EB         +1  6832             mov     a,r3            ;get lsb of exponent
00A7 33         +1  6833             rlc     a               ;rotate into carry
00A8 EA         +1  6834             mov     a,r2            ;get rest of exponent
00A9 33         +1  6835             rlc     a               ;and make it 8 bits
00AA F8         +1  6836             mov     r0,a            ;store it
00AB 6006       +1  6837             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  6838             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  6839             mov     r2,#0           ;clear upper byte of mantissa
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   109

00B2 22         +1  6840             ret
00B3            +1  6841     zer1:
00B3 E4         +1  6842             clr     a
00B4 FA         +1  6843             mov     r2,a
00B5 FB         +1  6844             mov     r3,a
00B6 FC         +1  6845             mov     r4,a
00B7 FD         +1  6846             mov     r5,a            ;zero mantissa
00B8 F8         +1  6847             mov     r0,a            ;zero exponent
00B9 22         +1  6848             ret
                +1  6849     
                +1  6850     ;       unpack2 - unpacks right operand
                +1  6851     
00BA            +1  6852     unpack2:
00BA E508       +1  6853             mov     a,ltemp         ;get sign
00BC 13         +1  6854             rrc     a               ;shift down
00BD 5440       +1  6855             anl     a,#40h          ;mask out sign
00BF 530780     +1  6856             anl     sign,#80h       ;clear old bit
00C2 4207       +1  6857             orl     sign,a
00C4 E509       +1  6858             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  6859             rlc     a               ;rotate into carry
00C7 E508       +1  6860             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  6861             rlc     a               ;and make it 8 bits
00CA F9         +1  6862             mov     r1,a            ;store it
00CB 6007       +1  6863             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  6864             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  6865             mov     mant2,#0        ;clear upper byte
00D3 22         +1  6866             ret
00D4            +1  6867     zer2:
00D4 E4         +1  6868             clr     a
00D5 F508       +1  6869             mov     ltemp,a
00D7 F509       +1  6870             mov     ltemp+1,a
00D9 F50A       +1  6871             mov     ltemp+2,a
00DB F50B       +1  6872             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  6873             ret
                +1  6874     
                +1  6875     ;       pack1 - put operand 1 back into float format
                +1  6876     
00DE            +1  6877     pack1:
00DE E8         +1  6878             mov     a,r0            ;get exponent
00DF C3         +1  6879             clr     c
00E0 13         +1  6880             rrc     a               ;shift down 1 bit
00E1 530780     +1  6881             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  6882             orl     a,r7            ;or in sign bit
00E5 FA         +1  6883             mov     r2,a            ;store
00E6 E8         +1  6884             mov     a,r0            ;get other bit
00E7 03         +1  6885             rr      a               ;rotate into hi bit
00E8 5480       +1  6886             anl     a,#80h          ;mask
00EA 53037F     +1  6887             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  6888             orl     mant1+1,a       ;put in
00EF 22         +1  6889             ret
                +1  6890     
                +1  6891     
                +1  6892     ;       norm1 - normalize the unpacked value in 1
                +1  6893     
00F0            +1  6894     norm1:
00F0 E8         +1  6895             mov     a,r0            ;get exponent
00F1 60C0       +1  6896             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  6897             mov     a,r2            ;get hi byte
00F4 6023       +1  6898             jz      norup           ;zero, so shift up if anything
00F6            +1  6899     nordn:
00F6 EA         +1  6900             mov     a,r2            ;get hi byte
00F7 B4010D     +1  6901             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  6902+3           add1                    ;add in a rounding bit
00FA ED         +1  6903+1           mov     a,r5
00FB 2401       +1  6904+1           add     a,#1
00FD FD         +1  6905+1           mov     r5,a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   110

00FE E4         +1  6906+1           clr     a
00FF 3C         +1  6907+1           addc    a,r4
0100 FC         +1  6908+1           mov     r4,a
0101 E4         +1  6909+1           clr     a
0102 3B         +1  6910+1           addc    a,r3
0103 FB         +1  6911+1           mov     r3,a
0104 E4         +1  6912+1           clr     a
0105 3A         +1  6913+1           addc    a,r2
0106 FA         +1  6914+1           mov     r2,a
0107            +1  6915     nordn1:
                +1  6916+3           rshift                  ;shift down 1 bit
0107 C3         +1  6917+1           clr     c
0108 EA         +1  6918+1           mov     a,r2
0109 13         +1  6919+1           rrc     a
010A FA         +1  6920+1           mov     r2,a
010B EB         +1  6921+1           mov     a,r3
010C 13         +1  6922+1           rrc     a
010D FB         +1  6923+1           mov     r3,a
010E EC         +1  6924+1           mov     a,r4
010F 13         +1  6925+1           rrc     a
0110 FC         +1  6926+1           mov     r4,a
0111 ED         +1  6927+1           mov     a,r5
0112 13         +1  6928+1           rrc     a
0113 FD         +1  6929+1           mov     r5,a
0114 08         +1  6930             inc     r0              ;adjust exponent
0115 EA         +1  6931             mov     a,r2            ;test high byte
0116 70DE       +1  6932             jnz     nordn           ;loop
0118 22         +1  6933             ret                     ;done
                +1  6934     
0119            +1  6935     norup:
0119 4B         +1  6936             orl     a,r3
011A 4C         +1  6937             orl     a,r4
011B 4D         +1  6938             orl     a,r5            ;test for zero mantissa
011C 6095       +1  6939             jz      zer1            ;it is - make it true zero
011E            +1  6940     norup1:
011E EB         +1  6941             mov     a,r3            ;get mantissa byte
011F 20E710     +1  6942             jb      acc.7,norup2    ;jump if set
0122 C3         +1  6943             clr     c
                +1  6944+3           lshift                  ;shift mantissa up
0123 ED         +1  6945+1           mov     a,r5
0124 33         +1  6946+1           rlc     a
0125 FD         +1  6947+1           mov     r5,a
0126 EC         +1  6948+1           mov     a,r4
0127 33         +1  6949+1           rlc     a
0128 FC         +1  6950+1           mov     r4,a
0129 EB         +1  6951+1           mov     a,r3
012A 33         +1  6952+1           rlc     a
012B FB         +1  6953+1           mov     r3,a
012C EA         +1  6954+1           mov     a,r2
012D 33         +1  6955+1           rlc     a
012E FA         +1  6956+1           mov     r2,a
012F 18         +1  6957             dec     r0              ;adjust exponent
0130 80EC       +1  6958             jmp     norup1
0132            +1  6959     norup2:
0132 22         +1  6960             ret                     ;finito
                +1  6961     
                +1  6962     
                +1  6963     ;       fpdenorm - denormalize one of the two operands so that their
                +1  6964     ;       exponents are equal. This requires the smaller number to have
                +1  6965     ;       its exponent incremented and its mantissa shifted right.
                +1  6966     
0133            +1  6967     denorm:
0133 E8         +1  6968             mov     a,r0
0134 C3         +1  6969             clr     c
0135 99         +1  6970             subb    a,r1            ;compare exponents
0136 5029       +1  6971             jnc     up2a            ;shift operand 2
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   111

0138            +1  6972     up1:
0138 08         +1  6973             inc     r0              ;increment exponent
                +1  6974+3           rshift                  ;shift mantissa down
0139 C3         +1  6975+1           clr     c
013A EA         +1  6976+1           mov     a,r2
013B 13         +1  6977+1           rrc     a
013C FA         +1  6978+1           mov     r2,a
013D EB         +1  6979+1           mov     a,r3
013E 13         +1  6980+1           rrc     a
013F FB         +1  6981+1           mov     r3,a
0140 EC         +1  6982+1           mov     a,r4
0141 13         +1  6983+1           rrc     a
0142 FC         +1  6984+1           mov     r4,a
0143 ED         +1  6985+1           mov     a,r5
0144 13         +1  6986+1           rrc     a
0145 FD         +1  6987+1           mov     r5,a
0146 E8         +1  6988             mov     a,r0
0147 B501EE     +1  6989             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  6990             ret
                +1  6991     
014B            +1  6992     up2:
014B 09         +1  6993             inc     r1              ;increment exponent 2
                +1  6994+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  6995+1           clr     c
014D E508       +1  6996+1           mov     a,mant2
014F 13         +1  6997+1           rrc     a
0150 F508       +1  6998+1           mov     mant2,a
0152 E509       +1  6999+1           mov     a,mant2+1
0154 13         +1  7000+1           rrc     a
0155 F509       +1  7001+1           mov     mant2+1,a
0157 E50A       +1  7002+1           mov     a,mant2+2
0159 13         +1  7003+1           rrc     a
015A F50A       +1  7004+1           mov     mant2+2,a
015C E50B       +1  7005+1           mov     a,mant2+3
015E 13         +1  7006+1           rrc     a
015F F50B       +1  7007+1           mov     mant2+3,a
0161            +1  7008     up2a:
0161 E8         +1  7009             mov     a,r0            ;compare exponents
0162 B501E6     +1  7010             cjne    a,exp2,up2
0165 22         +1  7011             ret                     ;all done
                +1  7012     ;------------------------------------------------------------------
                +1  7013     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  7014     
0166            +1  7015     fladd:
                +1  7016+3           saveregs
0166 C007       +1  7017+1           push    7
0168 C006       +1  7018+1           push    6
016A C001       +1  7019+1           push    1
016C C000       +1  7020+1           push    0
016E 119E       +1  7021             call    unpack1
0170 11BA       +1  7022             call    unpack2
0172 3133       +1  7023             call    denorm
0174 E507       +1  7024             mov     a,sign
0176 30E70D     +1  7025             jnb     acc.7,ok1       ;test left sign
                +1  7026+3           neg1                    ;negate op1
0179 C3         +1  7027+1           clr     c
017A E4         +1  7028+1           clr     a
017B 9D         +1  7029+1           subb    a,r5
017C FD         +1  7030+1           mov     r5,a
017D E4         +1  7031+1           clr     a
017E 9C         +1  7032+1           subb    a,r4
017F FC         +1  7033+1           mov     r4,a
0180 E4         +1  7034+1           clr     a
0181 9B         +1  7035+1           subb    a,r3
0182 FB         +1  7036+1           mov     r3,a
0183 E4         +1  7037+1           clr     a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   112

0184 9A         +1  7038+1           subb    a,r2
0185 FA         +1  7039+1           mov     r2,a
0186            +1  7040     ok1:
0186 E507       +1  7041             mov     a,sign
0188 30E615     +1  7042             jnb     acc.6,ok2       ;test right sign
                +1  7043+3           negm    mant2           ;negate op2
018B C3         +1  7044+1           clr     c
018C E4         +1  7045+1           clr     a
018D 950B       +1  7046+1           subb    a,mant2+3
018F F50B       +1  7047+1           mov     mant2+3,a
0191 E4         +1  7048+1           clr     a
0192 950A       +1  7049+1           subb    a,mant2+2
0194 F50A       +1  7050+1           mov     mant2+2,a
0196 E4         +1  7051+1           clr     a
0197 9509       +1  7052+1           subb    a,mant2+1
0199 F509       +1  7053+1           mov     mant2+1,a
019B E4         +1  7054+1           clr     a
019C 9508       +1  7055+1           subb    a,mant2
019E F508       +1  7056+1           mov     mant2,a
01A0            +1  7057     ok2:
                +1  7058+3           addl    mant2           ;add mantissas
01A0 ED         +1  7059+1           mov     a,r5
01A1 250B       +1  7060+1           add     a,mant2+3
01A3 FD         +1  7061+1           mov     r5,a
01A4 E50A       +1  7062+1           mov     a,mant2+2
01A6 3C         +1  7063+1           addc    a,r4
01A7 FC         +1  7064+1           mov     r4,a
01A8 E509       +1  7065+1           mov     a,mant2+1
01AA 3B         +1  7066+1           addc    a,r3
01AB FB         +1  7067+1           mov     r3,a
01AC E508       +1  7068+1           mov     a,mant2+0
01AE 3A         +1  7069+1           addc    a,r2
01AF FA         +1  7070+1           mov     r2,a
01B0 E4         +1  7071             clr     a
01B1 FF         +1  7072             mov     r7,a            ;clear sign
01B2 EA         +1  7073             mov     a,r2            ;get sign of result
01B3 30E70E     +1  7074             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  7075             mov     r7,a            ;store sign
                +1  7076+3           neg1                    ;negate mantissa
01B7 C3         +1  7077+1           clr     c
01B8 E4         +1  7078+1           clr     a
01B9 9D         +1  7079+1           subb    a,r5
01BA FD         +1  7080+1           mov     r5,a
01BB E4         +1  7081+1           clr     a
01BC 9C         +1  7082+1           subb    a,r4
01BD FC         +1  7083+1           mov     r4,a
01BE E4         +1  7084+1           clr     a
01BF 9B         +1  7085+1           subb    a,r3
01C0 FB         +1  7086+1           mov     r3,a
01C1 E4         +1  7087+1           clr     a
01C2 9A         +1  7088+1           subb    a,r2
01C3 FA         +1  7089+1           mov     r2,a
01C4            +1  7090     ok3:
01C4 11F0       +1  7091             call    norm1
01C6 11DE       +1  7092             call    pack1           ;pack normalized result
                +1  7093+3           restregs                ;and return
01C8 D000       +1  7094+1           pop     0
01CA D001       +1  7095+1           pop     1
01CC D006       +1  7096+1           pop     6
01CE D007       +1  7097+1           pop     7
01D0 22         +1  7098             ret
                +1  7099     ;-------------------------------------------------------------
                +1  7100     ;       Subtract the number ltemp from the number in r2-r5
                +1  7101     
01D1            +1  7102     flsub:
01D1 630880     +1  7103             xrl     ltemp,#80h      ;toggle sign bit
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   113

01D4 8090       +1  7104             jmp     fladd           ;and add!
                +1  7105     
                +1  7106     ;================================================================
                +1  7107     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  7108     
01D6            +1  7109     flcmp:
01D6 EA         +1  7110            mov     a,r2            ;get sign of left
01D7 6508       +1  7111            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  7112            jnb     acc.7,cexp      ;same, go check exponent
                +1  7113     ;ifdef SMALL_MODEL
01DC EA         +1  7114             mov     a,r2            ;get sign of left again
01DD 33         +1  7115             rlc     a
01DE 5001       +1  7116             jnc     flout
                +1  7117     ;endif
01E0 D3         +1  7118             setb    c
01E1 22         +1  7119     flout:          ret                    ;return with acc < 0
                +1  7120     
01E2            +1  7121     cexp:
01E2 C3         +1  7122            clr     c
01E3 EA         +1  7123            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  7124            subb    a,ltemp
01E6 7010       +1  7125            jnz     fnd
01E8 EB         +1  7126            mov     a,r3
01E9 9509       +1  7127            subb    a,ltemp+1
01EB 700B       +1  7128            jnz     fnd
01ED EC         +1  7129            mov     a,r4
01EE 950A       +1  7130            subb    a,ltemp+2
01F0 7006       +1  7131            jnz     fnd
01F2 ED         +1  7132            mov     a,r5
01F3 950B       +1  7133            subb    a,ltemp+3
01F5 7001       +1  7134            jnz     fnd
01F7            +1  7135     cdone:
01F7 22         +1  7136            ret                     ;return with acc == 0
01F8            +1  7137     fnd:
01F8 8AF0       +1  7138           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  7139          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  7140            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  7141                         orl         a,#1                          ;make non-zero
0201 B3         +1  7142             cpl     c               ;c=0->1,c=1->0
0202 22         +1  7143             ret
                +1  7144     ;==============================================================
                +1  7145     
                +1  7146     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  7147     ;       the result in r2-r5
                +1  7148     
0203            +1  7149     flmul:
                +1  7150+3           saveregs
0203 C007       +1  7151+1           push    7
0205 C006       +1  7152+1           push    6
0207 C001       +1  7153+1           push    1
0209 C000       +1  7154+1           push    0
020B 119E       +1  7155             call    unpack1
020D 11BA       +1  7156             call    unpack2
020F E4         +1  7157             clr     a
0210 F50C       +1  7158             mov     prod,a
0212 F50D       +1  7159             mov     prod+1,a        ;clear product
0214 F50E       +1  7160             mov     prod+2,a
0216 F50F       +1  7161             mov     prod+3,a
0218 7E07       +1  7162             mov     r6,#7           ;initialize counter
021A            +1  7163     mup1:
                +1  7164+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  7165+1           clr     c
021B E508       +1  7166+1           mov     a,mant2
021D 13         +1  7167+1           rrc     a
021E F508       +1  7168+1           mov     mant2,a
0220 E509       +1  7169+1           mov     a,mant2+1
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   114

0222 13         +1  7170+1           rrc     a
0223 F509       +1  7171+1           mov     mant2+1,a
0225 E50A       +1  7172+1           mov     a,mant2+2
0227 13         +1  7173+1           rrc     a
0228 F50A       +1  7174+1           mov     mant2+2,a
022A E50B       +1  7175+1           mov     a,mant2+3
022C 13         +1  7176+1           rrc     a
022D F50B       +1  7177+1           mov     mant2+3,a
022F 5014       +1  7178             jnc     nobit           ;skip if lsb was zero
                +1  7179+3           dan     prod            ;add multiplicand to product
0231 ED         +1  7180+1           mov     a,r5
0232 250F       +1  7181+1           add     a,prod+3
0234 F50F       +1  7182+1           mov     prod+3,a
0236 E50E       +1  7183+1           mov     a,prod+2
0238 3C         +1  7184+1           addc    a,r4
0239 F50E       +1  7185+1           mov     prod+2,a
023B E50D       +1  7186+1           mov     a,prod+1
023D 3B         +1  7187+1           addc    a,r3
023E F50D       +1  7188+1           mov     prod+1,a
0240 E50C       +1  7189+1           mov     a,prod+0
0242 3A         +1  7190+1           addc    a,r2
0243 F50C       +1  7191+1           mov     prod,a
0245            +1  7192     nobit:
                +1  7193+3           lshift                  ;shift multiplicand up
0245 ED         +1  7194+1           mov     a,r5
0246 33         +1  7195+1           rlc     a
0247 FD         +1  7196+1           mov     r5,a
0248 EC         +1  7197+1           mov     a,r4
0249 33         +1  7198+1           rlc     a
024A FC         +1  7199+1           mov     r4,a
024B EB         +1  7200+1           mov     a,r3
024C 33         +1  7201+1           rlc     a
024D FB         +1  7202+1           mov     r3,a
024E EA         +1  7203+1           mov     a,r2
024F 33         +1  7204+1           rlc     a
0250 FA         +1  7205+1           mov     r2,a
0251 DEC7       +1  7206             djnz    r6,mup1         ;loop if more
                +1  7207     
0253 7E11       +1  7208             mov     r6,#17          ;re-initalize counter
0255 8015       +1  7209             sjmp    mup3
0257            +1  7210     mup11:
                +1  7211+3           shfdn   prod            ;shift product right
0257 C3         +1  7212+1           clr     c
0258 E50C       +1  7213+1           mov     a,prod
025A 13         +1  7214+1           rrc     a
025B F50C       +1  7215+1           mov     prod,a
025D E50D       +1  7216+1           mov     a,prod+1
025F 13         +1  7217+1           rrc     a
0260 F50D       +1  7218+1           mov     prod+1,a
0262 E50E       +1  7219+1           mov     a,prod+2
0264 13         +1  7220+1           rrc     a
0265 F50E       +1  7221+1           mov     prod+2,a
0267 E50F       +1  7222+1           mov     a,prod+3
0269 13         +1  7223+1           rrc     a
026A F50F       +1  7224+1           mov     prod+3,a
026C            +1  7225     mup3:
                +1  7226+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  7227+1           clr     c
026D E508       +1  7228+1           mov     a,mant2
026F 13         +1  7229+1           rrc     a
0270 F508       +1  7230+1           mov     mant2,a
0272 E509       +1  7231+1           mov     a,mant2+1
0274 13         +1  7232+1           rrc     a
0275 F509       +1  7233+1           mov     mant2+1,a
0277 E50A       +1  7234+1           mov     a,mant2+2
0279 13         +1  7235+1           rrc     a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   115

027A F50A       +1  7236+1           mov     mant2+2,a
027C E50B       +1  7237+1           mov     a,mant2+3
027E 13         +1  7238+1           rrc     a
027F F50B       +1  7239+1           mov     mant2+3,a
0281 5014       +1  7240             jnc     mup2            ;skip if bit not set
                +1  7241+3           dan     prod            ;add to prod
0283 ED         +1  7242+1           mov     a,r5
0284 250F       +1  7243+1           add     a,prod+3
0286 F50F       +1  7244+1           mov     prod+3,a
0288 E50E       +1  7245+1           mov     a,prod+2
028A 3C         +1  7246+1           addc    a,r4
028B F50E       +1  7247+1           mov     prod+2,a
028D E50D       +1  7248+1           mov     a,prod+1
028F 3B         +1  7249+1           addc    a,r3
0290 F50D       +1  7250+1           mov     prod+1,a
0292 E50C       +1  7251+1           mov     a,prod+0
0294 3A         +1  7252+1           addc    a,r2
0295 F50C       +1  7253+1           mov     prod,a
0297            +1  7254     mup2:
0297 DEBE       +1  7255             djnz    r6,mup11        ;loop if more
0299 E8         +1  7256             mov     a,r0            ;get exp1
029A 29         +1  7257             add     a,r1            ;add exp2
029B 247A       +1  7258             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  7259             mov     r0,a            ;store
029E EF         +1  7260             mov     a,r7            ;get sign
029F 23         +1  7261             rl      a               ;rotate bit into msb
02A0 6207       +1  7262             xrl     sign,a          ;xor with other bit
                +1  7263+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  7264+1           mov     r2,prod
02A4 AB0D       +1  7265+1           mov     r3,prod+1
02A6 AC0E       +1  7266+1           mov     r4,prod+2
02A8 AD0F       +1  7267+1           mov     r5,prod+3
02AA 11F0       +1  7268             call    norm1           ;normalize
02AC 11DE       +1  7269             call    pack1
                +1  7270+3           restregs
02AE D000       +1  7271+1           pop     0
02B0 D001       +1  7272+1           pop     1
02B2 D006       +1  7273+1           pop     6
02B4 D007       +1  7274+1           pop     7
02B6 22         +1  7275             ret
                +1  7276     ;-----------------------------------------------------------
                +1  7277     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  7278     
02B7            +1  7279     fldiv:
                +1  7280+3           saveregs
02B7 C007       +1  7281+1           push    7
02B9 C006       +1  7282+1           push    6
02BB C001       +1  7283+1           push    1
02BD C000       +1  7284+1           push    0
02BF 119E       +1  7285             call    unpack1
02C1 11BA       +1  7286             call    unpack2
02C3 E4         +1  7287             clr     a
02C4 F50C       +1  7288             mov     prod,a
02C6 F50D       +1  7289             mov     prod+1,a
02C8 F50E       +1  7290             mov     prod+2,a
02CA F50F       +1  7291             mov     prod+3,a
02CC E9         +1  7292             mov     a,r1            ;check for zero divisor
02CD 6067       +1  7293             jz      div9
02CF E8         +1  7294             mov     a,r0            ;check for zero dividend
02D0 6064       +1  7295             jz      div9
02D2 C3         +1  7296             clr     c
02D3 99         +1  7297             subb    a,r1            ;compute new exponent
02D4 2478       +1  7298             add     a,#127-7        ;unbias
02D6 F8         +1  7299             mov     r0,a            ;store back
02D7 EF         +1  7300             mov     a,r7            ;get sign
02D8 23         +1  7301             rl      a
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   116

02D9 6207       +1  7302             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  7303             mov     r6,#24+7        ;initialize counter
02DD            +1  7304     div1:
                +1  7305+3           shfup   prod            ;shift quotient up
02DD C3         +1  7306+1           clr     c
02DE E50F       +1  7307+1           mov     a,prod+3
02E0 33         +1  7308+1           rlc     a
02E1 F50F       +1  7309+1           mov     prod+3,a
02E3 E50E       +1  7310+1           mov     a,prod+2
02E5 33         +1  7311+1           rlc     a
02E6 F50E       +1  7312+1           mov     prod+2,a
02E8 E50D       +1  7313+1           mov     a,prod+1
02EA 33         +1  7314+1           rlc     a
02EB F50D       +1  7315+1           mov     prod+1,a
02ED E50C       +1  7316+1           mov     a,prod
02EF 33         +1  7317+1           rlc     a
02F0 F50C       +1  7318+1           mov     prod,a
02F2 C3         +1  7319             clr     c
02F3 EA         +1  7320             mov     a,r2            ;compare values
02F4 9508       +1  7321             subb    a,mant2
02F6 4028       +1  7322             jc      div2            ;skip if bigger
02F8 7013       +1  7323             jnz     div3
02FA EB         +1  7324             mov     a,r3            ;compare values
02FB 9509       +1  7325             subb    a,mant2+1
02FD 4021       +1  7326             jc      div2            ;skip if bigger
02FF 700C       +1  7327             jnz     div3
0301 EC         +1  7328             mov     a,r4            ;compare values
0302 950A       +1  7329             subb    a,mant2+2
0304 401A       +1  7330             jc      div2            ;skip if bigger
0306 7005       +1  7331             jnz     div3
0308 ED         +1  7332             mov     a,r5            ;compare values
0309 950B       +1  7333             subb    a,mant2+3
030B 4013       +1  7334             jc      div2            ;skip if bigger
030D            +1  7335     div3:
030D ED         +1  7336             mov     a,r5
030E 950B       +1  7337             subb    a,mant2+3
0310 FD         +1  7338             mov     r5,a
0311 EC         +1  7339             mov     a,r4
0312 950A       +1  7340             subb    a,mant2+2               ;do subtraction
0314 FC         +1  7341             mov     r4,a
0315 EB         +1  7342             mov     a,r3
0316 9509       +1  7343             subb    a,mant2+1               ;do subtraction
0318 FB         +1  7344             mov     r3,a
0319 EA         +1  7345             mov     a,r2
031A 9508       +1  7346             subb    a,mant2         ;do subtraction
031C FA         +1  7347             mov     r2,a
031D 430F01     +1  7348             orl     prod+3,#1       ;set lsb in quotient
0320            +1  7349     div2:
                +1  7350+3           lshift                  ;shift dividend up
0320 ED         +1  7351+1           mov     a,r5
0321 33         +1  7352+1           rlc     a
0322 FD         +1  7353+1           mov     r5,a
0323 EC         +1  7354+1           mov     a,r4
0324 33         +1  7355+1           rlc     a
0325 FC         +1  7356+1           mov     r4,a
0326 EB         +1  7357+1           mov     a,r3
0327 33         +1  7358+1           rlc     a
0328 FB         +1  7359+1           mov     r3,a
0329 EA         +1  7360+1           mov     a,r2
032A 33         +1  7361+1           rlc     a
032B FA         +1  7362+1           mov     r2,a
032C DEAF       +1  7363             djnz    r6,div1         ;loop if more
                +1  7364+3           copytor prod            ;copy quotient
032E AA0C       +1  7365+1           mov     r2,prod
0330 AB0D       +1  7366+1           mov     r3,prod+1
0332 AC0E       +1  7367+1           mov     r4,prod+2
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   117

0334 AD0F       +1  7368+1           mov     r5,prod+3
0336            +1  7369     div9:
0336 11F0       +1  7370             call    norm1           ;now normalize result
0338 11DE       +1  7371             call    pack1           ;pack it up
                +1  7372+3           restregs                ;restore registers
033A D000       +1  7373+1           pop     0
033C D001       +1  7374+1           pop     1
033E D006       +1  7375+1           pop     6
0340 D007       +1  7376+1           pop     7
0342 22         +1  7377             ret
                +1  7378     ;------------------------------------------------------------------
                +1  7379     
                +1  7380     ;       Float to long conversion: if the exponent is less than the
                +1  7381     ;       excess value, the result is zero. If the exponent is so large
                +1  7382     ;       that the value would be shifted out, the result is overflow.
                +1  7383     ;       Otherwise shift the mantissa up or down as required.
                +1  7384     
0343            +1  7385     ftol:
                +1  7386+3           saveregs
0343 C007       +1  7387+1           push    7
0345 C006       +1  7388+1           push    6
0347 C001       +1  7389+1           push    1
0349 C000       +1  7390+1           push    0
034B EA         +1  7391             mov     a,r2
034C B4BF09     +1  7392             cjne    a,#0bfh,ne05
034F EB         +1  7393             mov     a,r3
0350 7006       +1  7394             jnz     ne05
0352 EC         +1  7395             mov     a,r4
0353 7003       +1  7396             jnz     ne05
0355 ED         +1  7397             mov     a,r5
0356 6024       +1  7398             jz      ftol1
0358 119E       +1  7399     ne05:   call    unpack1
035A E8         +1  7400             mov     a,r0            ;get exponent
035B 2482       +1  7401             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  7402             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  7403             mov     a,r7            ;get sign
0361 30E70D     +1  7404             jnb     acc.7,ftol4     ;skip if +ve
                +1  7405+3           neg1                    ;negate it
0364 C3         +1  7406+1           clr     c
0365 E4         +1  7407+1           clr     a
0366 9D         +1  7408+1           subb    a,r5
0367 FD         +1  7409+1           mov     r5,a
0368 E4         +1  7410+1           clr     a
0369 9C         +1  7411+1           subb    a,r4
036A FC         +1  7412+1           mov     r4,a
036B E4         +1  7413+1           clr     a
036C 9B         +1  7414+1           subb    a,r3
036D FB         +1  7415+1           mov     r3,a
036E E4         +1  7416+1           clr     a
036F 9A         +1  7417+1           subb    a,r2
0370 FA         +1  7418+1           mov     r2,a
0371            +1  7419     ftol4:
0371 E8         +1  7420             mov     a,r0            ;get exponent
0372 246A       +1  7421             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  7422             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  7423             mov     r0,a            ;save it
0378 24F8       +1  7424             add     a,#-8           ;if > 8, too big
037A 500E       +1  7425             jnc     ftol3
037C            +1  7426     ftol1:
037C E4         +1  7427             clr     a
037D FA         +1  7428             mov     r2,a
037E FB         +1  7429             mov     r3,a
037F FC         +1  7430             mov     r4,a
0380 FD         +1  7431             mov     r5,a
0381            +1  7432     ftol9:
                +1  7433+3           restregs
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   118

0381 D000       +1  7434+1           pop     0
0383 D001       +1  7435+1           pop     1
0385 D006       +1  7436+1           pop     6
0387 D007       +1  7437+1           pop     7
0389 22         +1  7438             ret
038A            +1  7439     ftol3:
038A E8         +1  7440             mov     a,r0
038B FE         +1  7441             mov     r6,a            ;store in counter
038C 60F3       +1  7442             jz      ftol9           ;if zero, do nothing
038E            +1  7443     ftol33:
                +1  7444+3           lshift                  ;shift up
038E ED         +1  7445+1           mov     a,r5
038F 33         +1  7446+1           rlc     a
0390 FD         +1  7447+1           mov     r5,a
0391 EC         +1  7448+1           mov     a,r4
0392 33         +1  7449+1           rlc     a
0393 FC         +1  7450+1           mov     r4,a
0394 EB         +1  7451+1           mov     a,r3
0395 33         +1  7452+1           rlc     a
0396 FB         +1  7453+1           mov     r3,a
0397 EA         +1  7454+1           mov     a,r2
0398 33         +1  7455+1           rlc     a
0399 FA         +1  7456+1           mov     r2,a
039A DEF2       +1  7457             djnz    r6,ftol33       ;and loop
039C 80E3       +1  7458             sjmp    ftol9
039E            +1  7459     ftol2:
039E F4         +1  7460             cpl     a               ;complement
039F FE         +1  7461             mov     r6,a
03A0 6022       +1  7462             jz      ftol22
03A2            +1  7463     ftol23:
03A2 EF         +1  7464             mov     a,r7
03A3 30E70F     +1  7465             jnb     acc.7,ftol24
                +1  7466+3           rshift1
03A6 D3         +1  7467+1           setb    c
03A7 EA         +1  7468+1           mov     a,r2
03A8 13         +1  7469+1           rrc     a
03A9 FA         +1  7470+1           mov     r2,a
03AA EB         +1  7471+1           mov     a,r3
03AB 13         +1  7472+1           rrc     a
03AC FB         +1  7473+1           mov     r3,a
03AD EC         +1  7474+1           mov     a,r4
03AE 13         +1  7475+1           rrc     a
03AF FC         +1  7476+1           mov     r4,a
03B0 ED         +1  7477+1           mov     a,r5
03B1 13         +1  7478+1           rrc     a
03B2 FD         +1  7479+1           mov     r5,a
03B3 800D       +1  7480             jmp     ftol25
03B5            +1  7481+3   ftol24: rshift                  ;shift down
03B5 C3         +1  7482+1           clr     c
03B6 EA         +1  7483+1           mov     a,r2
03B7 13         +1  7484+1           rrc     a
03B8 FA         +1  7485+1           mov     r2,a
03B9 EB         +1  7486+1           mov     a,r3
03BA 13         +1  7487+1           rrc     a
03BB FB         +1  7488+1           mov     r3,a
03BC EC         +1  7489+1           mov     a,r4
03BD 13         +1  7490+1           rrc     a
03BE FC         +1  7491+1           mov     r4,a
03BF ED         +1  7492+1           mov     a,r5
03C0 13         +1  7493+1           rrc     a
03C1 FD         +1  7494+1           mov     r5,a
03C2 DEDE       +1  7495     ftol25: djnz    r6,ftol23
03C4            +1  7496     ftol22:
                +1  7497+3           add1                    ;round
03C4 ED         +1  7498+1           mov     a,r5
03C5 2401       +1  7499+1           add     a,#1
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   119

03C7 FD         +1  7500+1           mov     r5,a
03C8 E4         +1  7501+1           clr     a
03C9 3C         +1  7502+1           addc    a,r4
03CA FC         +1  7503+1           mov     r4,a
03CB E4         +1  7504+1           clr     a
03CC 3B         +1  7505+1           addc    a,r3
03CD FB         +1  7506+1           mov     r3,a
03CE E4         +1  7507+1           clr     a
03CF 3A         +1  7508+1           addc    a,r2
03D0 FA         +1  7509+1           mov     r2,a
03D1 EF         +1  7510             mov     a,r7
03D2 30E70F     +1  7511             jnb     acc.7,ftol26
                +1  7512+3           rshift1
03D5 D3         +1  7513+1           setb    c
03D6 EA         +1  7514+1           mov     a,r2
03D7 13         +1  7515+1           rrc     a
03D8 FA         +1  7516+1           mov     r2,a
03D9 EB         +1  7517+1           mov     a,r3
03DA 13         +1  7518+1           rrc     a
03DB FB         +1  7519+1           mov     r3,a
03DC EC         +1  7520+1           mov     a,r4
03DD 13         +1  7521+1           rrc     a
03DE FC         +1  7522+1           mov     r4,a
03DF ED         +1  7523+1           mov     a,r5
03E0 13         +1  7524+1           rrc     a
03E1 FD         +1  7525+1           mov     r5,a
03E2 809D       +1  7526             jmp     ftol9
03E4            +1  7527+3   ftol26: rshift
03E4 C3         +1  7528+1           clr     c
03E5 EA         +1  7529+1           mov     a,r2
03E6 13         +1  7530+1           rrc     a
03E7 FA         +1  7531+1           mov     r2,a
03E8 EB         +1  7532+1           mov     a,r3
03E9 13         +1  7533+1           rrc     a
03EA FB         +1  7534+1           mov     r3,a
03EB EC         +1  7535+1           mov     a,r4
03EC 13         +1  7536+1           rrc     a
03ED FC         +1  7537+1           mov     r4,a
03EE ED         +1  7538+1           mov     a,r5
03EF 13         +1  7539+1           rrc     a
03F0 FD         +1  7540+1           mov     r5,a
03F1 808E       +1  7541             jmp     ftol9
                +1  7542     
                +1  7543     ;       arithmetic integer to floating conversions
                +1  7544     
03F3            +1  7545     abtof:
03F3 ED         +1  7546             mov     a,r5
03F4 23         +1  7547             rl      a
03F5 FC         +1  7548             mov     r4,a
03F6 9C         +1  7549             subb    a,r4
03F7 FC         +1  7550             mov     r4,a
03F8 FB         +1  7551             mov     r3,a
03F9 FA         +1  7552             mov     r2,a
03FA 8006       +1  7553             jmp     altof
03FC            +1  7554     awtof:
03FC EC         +1  7555             mov     a,r4
03FD 23         +1  7556             rl      a
03FE FB         +1  7557             mov     r3,a
03FF 9B         +1  7558             subb    a,r3
0400 FB         +1  7559             mov     r3,a
0401 FA         +1  7560             mov     r2,a
0402            +1  7561     altof:
                +1  7562+3           saveregs
0402 C007       +1  7563+1           push    7
0404 C006       +1  7564+1           push    6
0406 C001       +1  7565+1           push    1
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   120

0408 C000       +1  7566+1           push    0
040A EA         +1  7567             mov     a,r2            ;get sign
040B 5480       +1  7568             anl     a,#80h
040D FF         +1  7569             mov     r7,a            ;store it
040E 30E70D     +1  7570             jnb     acc.7,altof1    ;skip if +ve
                +1  7571+3           neg1
0411 C3         +1  7572+1           clr     c
0412 E4         +1  7573+1           clr     a
0413 9D         +1  7574+1           subb    a,r5
0414 FD         +1  7575+1           mov     r5,a
0415 E4         +1  7576+1           clr     a
0416 9C         +1  7577+1           subb    a,r4
0417 FC         +1  7578+1           mov     r4,a
0418 E4         +1  7579+1           clr     a
0419 9B         +1  7580+1           subb    a,r3
041A FB         +1  7581+1           mov     r3,a
041B E4         +1  7582+1           clr     a
041C 9A         +1  7583+1           subb    a,r2
041D FA         +1  7584+1           mov     r2,a
041E            +1  7585     altof1:
041E 7896       +1  7586             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  7587             call    norm1           ;normalize it
0422 11DE       +1  7588             call    pack1           ;and pack up
                +1  7589+3           restregs
0424 D000       +1  7590+1           pop     0
0426 D001       +1  7591+1           pop     1
0428 D006       +1  7592+1           pop     6
042A D007       +1  7593+1           pop     7
042C 22         +1  7594             ret
                +1  7595     
042D            +1  7596     lbtof:
042D 7C00       +1  7597             mov     r4,#0
042F            +1  7598     lwtof:
042F E4         +1  7599             clr     a
0430 FB         +1  7600             mov     r3,a
0431 FA         +1  7601             mov     r2,a
0432            +1  7602     lltof:
                +1  7603+3           saveregs
0432 C007       +1  7604+1           push    7
0434 C006       +1  7605+1           push    6
0436 C001       +1  7606+1           push    1
0438 C000       +1  7607+1           push    0
043A 7F00       +1  7608             mov     r7,#0           ;zero sign
043C 80E0       +1  7609             sjmp    altof1
                +1  7610     
                +1  7611     ;-------------------------------------------------------
                +1  7612     
                +1  7613     
                    7614     
                    7615     ;$include (d:\amp\wriread.asm)
                +1  7616     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  7617     cle256:          mov            IE,#00H
0441 75B601     +1  7618                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  7619                              MOV            PSCTL,#03
                +1  7620                                             
0447 7400       +1  7621                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  7622                                     movx    @dptr,a                         ;wr
044A 758F00     +1  7623                                     mov             PSCTL,#00
044D 75B600     +1  7624                                 mov         FLSCL,#00
0450 75A880     +1  7625                               mov           IE,#80H
0453 22         +1  7626                                     ret
                +1  7627     
                +1  7628     ;чтение памяти программ в r8..r11
                +1  7629     ;вх-r2,r3-адр яч памяти прогр
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   121

0454 8A83       +1  7630     re4byte:        mov                     dph,r2
0456 8B82       +1  7631                                             mov                     dpl,r3
0458 E4         +1  7632                                             clr                     a
0459 93         +1  7633                                             movc            a,@a+dptr
045A F508       +1  7634                                             mov                     r8,a
045C A3         +1  7635                                             inc                     dptr
045D E4         +1  7636                                             clr                     a
045E 93         +1  7637                                             movc            a,@a+dptr
045F F509       +1  7638                                             mov                     r9,a
0461 A3         +1  7639                                             inc                     dptr
0462 E4         +1  7640                                             clr                     a
0463 93         +1  7641                                             movc            a,@a+dptr
0464 F50A       +1  7642                                             mov                     r10,a
0466 A3         +1  7643                                             inc                     dptr
0467 E4         +1  7644                                             clr                     a
0468 93         +1  7645                                             movc            a,@a+dptr
0469 F50B       +1  7646                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  7647                                             ret
                +1  7648      ;чтение памяти программ в r2..r5
                +1  7649     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  7650     rebyte2:        mov                     dph,r2
046E 8B82       +1  7651                                             mov                     dpl,r3
0470 E4         +1  7652                                             clr                     a
0471 93         +1  7653                                             movc            a,@a+dptr
0472 FA         +1  7654                                             mov                     r2,a
0473 A3         +1  7655                                             inc                     dptr
0474 E4         +1  7656                                             clr                     a
0475 93         +1  7657                                             movc            a,@a+dptr
0476 FB         +1  7658                                             mov                     r3,a
0477 A3         +1  7659                                             inc                     dptr
0478 E4         +1  7660                                             clr                     a
0479 93         +1  7661                                             movc            a,@a+dptr
047A FC         +1  7662                                             mov                     r4,a
047B A3         +1  7663                                             inc                     dptr
047C E4         +1  7664                                             clr                     a
047D 93         +1  7665                                             movc            a,@a+dptr
047E FD         +1  7666                                             mov                     r5,a                       
                                                  ;r8..r11
047F 22         +1  7667                                             ret
                +1  7668      
                +1  7669     
                +1  7670      ;r7-количество байт
                +1  7671     ;dptr-адр ячейки для записи
                +1  7672     ;r1-адр ячейки  внешнего озу
                +1  7673     
0480 75A800     +1  7674     wrpage:  mov            IE,#00H
0483 75B601     +1  7675     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  7676                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  7677                      movx           a,@r1
048A F0         +1  7678                      movx           @dptr,a                         ;wr
048B 758F00     +1  7679                      mov            PSCTL,#0
048E 75B600     +1  7680                      mov            FLSCL,#00
0491 A3         +1  7681                     inc                     dptr
0492 09         +1  7682                     inc                     r1
0493 DFEE       +1  7683                     djnz            r7,WW5
0495 75A880     +1  7684                     mov             IE,#80H
0498 22         +1  7685                     ret
                +1  7686                             
                +1  7687     
                +1  7688     
                +1  7689                                                             
                +1  7690     
                +1  7691     
                +1  7692     ;;;;;;;;;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   122

                +1  7693     ;чтение памяти программ во внешнее озу
                +1  7694     ;вх-r2,r3-адр яч памяти прогр
                +1  7695     ;r1- яч внешнее озу
0499 8A83       +1  7696     copyPP:         mov                     dph,r2
049B 8B82       +1  7697                                             mov                     dpl,r3
049D 7FFF       +1  7698                                             mov                     r7,#0ffh
049F E4         +1  7699     copy1:          clr                     a
04A0 93         +1  7700                                             movc            a,@a+dptr
04A1 F3         +1  7701                                             movx                    @r1,a
04A2 A3         +1  7702                                             inc                     dptr
04A3 09         +1  7703                                             inc                     r1
04A4 DFF9       +1  7704                                             djnz            r7,copy1
04A6 22         +1  7705                                             ret
                +1  7706     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  7707     
                +1  7708                                     
                +1  7709     
                +1  7710     ;r8..r11->@r0..@r0+3
                +1  7711     ;r0-адр ячейки
                +1  7712     ;сохранить в ячейке озу
04A7 E508       +1  7713     savelte:        mov     a,ltemp
04A9 F6         +1  7714                                             mov     @r0,a
04AA 08         +1  7715                                             inc     r0
04AB E509       +1  7716                                             mov     a,ltemp+1
04AD F6         +1  7717                                             mov     @r0,a
04AE 08         +1  7718                                             inc     r0
04AF E50A       +1  7719                                             mov     a,ltemp+2
04B1 F6         +1  7720                                             mov     @r0,a
04B2 08         +1  7721                                             inc     r0
04B3 E50B       +1  7722                                             mov     a,ltemp+3
04B5 F6         +1  7723                                             mov     @r0,a
04B6 22         +1  7724                                             ret
                +1  7725     
                +1  7726     ;
                +1  7727     
                +1  7728     
                +1  7729     
                +1  7730     
                +1  7731     
                +1  7732                     
                +1  7733     
                +1  7734     
                +1  7735     
                +1  7736     
                +1  7737      
                    7738     
                    7739                                                   
                    7740     END
                                                                             
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   123

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   035DH   R   SEG=MAIN   800#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1375 1432 1457 1478 1482 1485 1486 1488 1595 1600 3380 3383 3416
                                           3508 3552 3555 3619 3623 3624 3625 3628 3836 3873 3874 3876 3950 3970 4061
                                           4065 4089 4092 4328 4333 4499 4504 5248 5391 5394 5418 5421
ABRET. . . . . . .  C ADDR   200FH   R   SEG=MAIN   5177 5179#
ABTOF. . . . . . .  C ADDR   03F3H   A      7545#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 632 679 687 695 703 705 725 1079 1090 1098 1175 1544 1727 1736 1745
                                           1754 1775 2045 2067 2072 2076 2081 2084 2087 2090 2093 2264 2325 2371 2382
                                           2467 2476 2484 2493 2632 2650 2675 2680 2684 2687 2690 2693 2696 2699 3010
                                           3097 3128 3145 3163 3180 3200 4010 4016 4053 4123 4760 5820 5952 6030 6033
                                           6290 6942 7025 7042 7074 7112 7140 7402 7404 7422 7465 7511 7570
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   27ADH   R   SEG=MAIN   835 872 874 876 878 880 882 884 886 888 954 956 958 960 962 964
                                           966 968 970 973 975 977 979 981 983 985 987 989 991 1010 1012 1014 6531#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1431 1443 1447 1462 1487 1490 1491 1599 1603 3377 3381 3413 3417
                                           3505 3509 3554 3558 3627 3640 3846 3860 3862 3864 3875 3878 3960 3971 4066
                                           4093 4332 4336 4503 4507 5049 5068 5086 5149 5166 5393 5396 5420 5423 5742
                                           5774
ADRBLOK. . . . . .  C ADDR   2495H   R   SEG=MAIN   3081 3396 3526 4250 4418 4569 5786#
AFTERK . . . . . .  C ADDR   0651H   R   SEG=MAIN   1107 1184#
AGE2 . . . . . . .  C ADDR   01FCH   R   SEG=MAIN   584# 587
AGE9 . . . . . . .  C ADDR   07CCH   R   SEG=MAIN   1379# 1382
AGEON. . . . . . .  C ADDR   020AH   R   SEG=MAIN   593# 595
ALESS0 . . . . . .  C ADDR   0901H   R   SEG=MAIN   1544 1565#
ALLSUM . . . . . .  C ADDR   02FBH   R   SEG=MAIN   745# 780 797 813
ALMUL. . . . . . .  C ADDR   26F4H   R   SEG=MAIN   6377#
ALTOF. . . . . . .  C ADDR   0402H   A      1073 1169 1200 1208 1223 1234 1251 1264 1341 1840 1912 1964 2002 3420
                                           3514 3974 4069 4096 4177 4291 4303 4318 4402 4464 4480 4553 4615 4630 7553
                                           7561#
ALTOF1 . . . . . .  C ADDR   041EH   A      7570 7585# 7609
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   05BAH   R   SEG=MAIN   1071 1087#
AN_T7. . . . . . .  C ADDR   1031H   R   SEG=MAIN   2700# 2767 2776
AUTOKA . . . . . .  C ADDR   0B2DH   R   SEG=MAIN   1105 1932#
AVPGO. . . . . . .  C ADDR   075EH   R   SEG=MAIN   1317 1319#
AVTDEC1. . . . . .  C ADDR   0616H   R   SEG=MAIN   1140 1149#
AWTOF. . . . . . .  C ADDR   03FCH   A      7554#
B. . . . . . . . .  D ADDR   00F0H   A      122# 4904 5268 6380 6383 6385 6389 6393 6397 6401 6406 6410 6417 6421
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   124

                                           6425 6431 6435 6439 6445 7138 7139
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 451#
BFORM. . . . . . .  C ADDR   23D2H   R   SEG=MAIN   5591 5596 5608# 5634
BIN30. . . . . . .  C ADDR   2510H   R   SEG=MAIN   5940# 5966
BIN31. . . . . . .  C ADDR   2514H   R   SEG=MAIN   5945# 5949
BIN32. . . . . . .  C ADDR   2524H   R   SEG=MAIN   5958# 5963
BIN41. . . . . . .  C ADDR   2535H   R   SEG=MAIN   5974# 5984
BINDEC . . . . . .  C ADDR   2504H   R   SEG=MAIN   1433 1489 1601 3556 3629 3877 4334 4505 5395 5422 5919#
BITAKT . . . . . .  B ADDR   0023H.2 A      349# 1682 1683 1686
BITAVP . . . . . .  B ADDR   0020H.5 A      320# 1274 1498 1672 2755 2756 2758
BITBON . . . . . .  B ADDR   0021H.2 A      327# 1707 1820 2102 2103 2109 5821
BITBUF . . . . . .  B ADDR   0021H.0 A      325#
BITEIZM. . . . . .  B ADDR   0022H.5 A      340# 1194 1690 2734 2746 3773 4823
BITIZM . . . . . .  B ADDR   0020H.4 A      319# 562 653 2073 2142 2227 2288 2681 2735 2848 2871 2945 2973 2996 3100
                                           3182 3400 3438 3463 3612 3728 3774 3821 3908 3983
BITKLB . . . . . .  B ADDR   0022H.2 A      337# 1244 1705 2078 2754 2761 3981 4227
BITMAS . . . . . .  B ADDR   0020H.1 A      316# 1021 1024 5574
BITMEM . . . . . .  B ADDR   0021H.3 A      328# 1585 2461 2976 2992 3003 3099 3181 3401 3437 3611
BITMENU. . . . . .  B ADDR   0022H.1 A      336# 1584 2287 2401 2736 2995 3445 3462 3733 3775 3820 3907 3980
BITMIG . . . . . .  B ADDR   0023H.1 A      348# 2364 2544 2639 2914 3229 3350 3939 4045 4130 5334 5349 5365 5377
                                           5440 5447 5453 5459
BITNUL . . . . . .  B ADDR   0021H.7 A      332# 1656 2778 2779 2786
BITOLL . . . . . .  B ADDR   0022H.7 A      342# 608 1505 1582
BITPAR . . . . . .  B ADDR   0022H.6 A      341# 3739 4228
BITPRD . . . . . .  B ADDR   0021H.1 A      326# 1819
BITRS. . . . . . .  B ADDR   0020H.3 A      318#
BITT2. . . . . . .  B ADDR   0022H.0 A      335# 1581 2228 2261 2793 2946
BITV19 . . . . . .  B ADDR   0022H.3 A      338# 508 512 2432 2435 2439 3717 3722 3803 3816 3913 3916 3920
BITVI11. . . . . .  B ADDR   0020H.6 A      321# 1272 1288 2096 2098 2141 2286 2733 2847 2994
BITVICH. . . . . .  B ADDR   0022H.4 A      339# 1580 2097 2143 2153 2285 2293 2810 2870 2993
BITZNAK. . . . . .  B ADDR   0020H.0 A      315# 633 662
BITZNB . . . . . .  B ADDR   0023H.3 A      350# 4097 5175 5178
BITZUS . . . . . .  B ADDR   0020H.7 A      322# 1331 1521 1866 1869 2188
BLOKVV . . . . . .  C ADDR   1436H   R   SEG=MAIN   3304#
BLOKVVC. . . . . .  C ADDR   1440H   R   SEG=MAIN   3307 3310#
BL_LI. . . . . . .  C ADDR   1404H   R   SEG=MAIN   3254 3262#
BMEM11 . . . . . .  B ADDR   0021H.4 A      329#
BOUT7. . . . . . .  C ADDR   11E4H   R   SEG=MAIN   2954# 2956
BRET . . . . . . .  C ADDR   1E64H   R   SEG=MAIN   4844 4849 4853#
BUFDEC . . . . . .  C ADDR   0933H   R   SEG=MAIN   1606# 1611
BUFIND . . . . . .  D ADDR   0040H   A      298# 583 587 592 595 601 1378 1382 1448 1469 1490 1491 1492 1554 1559
                                           1604 1612 1614 1619 1654 1670 1676 1684 1687 1692 1706 1708 2061 2339 2357
                                           2373 2375 2378 2539 2583 2602 2668 2849 2850 2897 2901 2927 2960 2966 2977
                                           3073 3224 3276 3305 3320 3321 3324 3325 3332 3333 3337 3352 3478 3485 3559
                                           3567 3569 3574 3630 3639 3641 3845 3878 3879 3882 3931 3959 4037 4079 4337
                                           4345 4349 4508 4516 4520 4660 4692 4902 4920 5048 5067 5085 5148 5165 5176
                                           5337 5352 5397 5416 5424 5444 5465 5741 5773
BUFMEA . . . . . .  C ADDR   1B85H   R   SEG=MAIN   4339# 4344
BUFMIN . . . . . .  C ADDR   1C78H   R   SEG=MAIN   4510# 4515
BUFON. . . . . . .  C ADDR   0C66H   R   SEG=MAIN   2102 2109#
BUFR . . . . . . .  C ADDR   0871H   R   SEG=MAIN   1471# 1476
BUFR2. . . . . . .  C ADDR   0853H   R   SEG=MAIN   1450# 1455
BUFR3. . . . . . .  C ADDR   084CH   R   SEG=MAIN   1441 1446#
BUFR30 . . . . . .  C ADDR   084FH   R   SEG=MAIN   1444 1448#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      7135# 7139
CELLBIT. . . . . .  D ADDR   0020H   A      314# 315 316 317 318 319 320 321 322
CELLBIT1 . . . . .  D ADDR   0021H   A      324# 325 326 327 328 329 332
CELLBIT2 . . . . .  D ADDR   0022H   A      334# 335 336 337 338 339 340 341 342
CELLBIT3 . . . . .  D ADDR   0023H   A      346# 347 348 349 350
CEXP . . . . . . .  C ADDR   01E2H   A      7112 7121#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   125

CH0. . . . . . . .  C ADDR   1F01H   R   SEG=MAIN   2787 4986#
CH1. . . . . . . .  C ADDR   1F21H   R   SEG=MAIN   4809 4997#
CH10 . . . . . . .  C ADDR   1F05H   R   SEG=MAIN   796 1035 3544 4987#
CH100. . . . . . .  C ADDR   1F19H   R   SEG=MAIN   744 1539 4992#
CH10000. . . . . .  C ADDR   1F15H   R   SEG=MAIN   4991#
CH150H . . . . . .  C ADDR   1F61H   R   SEG=MAIN   5013#
CH2. . . . . . . .  C ADDR   1F1DH   R   SEG=MAIN   1030 4993#
CH20 . . . . . . .  C ADDR   20D6H   R   SEG=MAIN   779 1040 5299#
CH2THO . . . . . .  C ADDR   1F41H   R   SEG=MAIN   1971 2009 5005#
CH320H . . . . . .  C ADDR   1F5DH   R   SEG=MAIN   5012# 5794
CH4. . . . . . . .  C ADDR   1F0DH   R   SEG=MAIN   1044 4989#
CH43 . . . . . . .  C ADDR   162AH   R   SEG=MAIN   3561# 3566
CH43_42. . . . . .  C ADDR   16BCH   R   SEG=MAIN   3643# 3648
CH5. . . . . . . .  C ADDR   1F09H   R   SEG=MAIN   812 4988#
CH57 . . . . . . .  C ADDR   20D2H   R   SEG=MAIN   5298#
CH954. . . . . . .  C ADDR   1F11H   R   SEG=MAIN   4990#
CHAIBL . . . . . .  C ADDR   12E8H   R   SEG=MAIN   3075 3077#
CHAIPR . . . . . .  C ADDR   157FH   R   SEG=MAIN   3480 3482#
CHANMA . . . . . .  C ADDR   0E16H   R   SEG=MAIN   2371 2380#
CHANZ. . . . . . .  C ADDR   0DFDH   R   SEG=MAIN   2325 2369#
CHAVT. . . . . . .  D ADDR   0081H   A      364# 542 1096 1141 1149 2025 3729
CHBEFORE . . . . .  D ADDR   009BH   A      374# 564 741 755 774 791 807
CHBLOK . . . . . .  D ADDR   00D6H   A      399# 4248 4298 4314 4416 4470 4567 4621
CHBUF. . . . . . .  D ADDR   00CFH   A      396# 575 1805 1810 1848 1875 3435
CHCMP. . . . . . .  C ADDR   1E07H   R   SEG=MAIN   645 1102 4786#
CHDEC. . . . . . .  C ADDR   1E1AH   R   SEG=MAIN   652 1150 1161 4801#
CHDEL. . . . . . .  D ADDR   0083H   A      365# 1897 1917 1939 1984 2019
CHDELMO. . . . . .  C ADDR   0B15H   R   SEG=MAIN   1903 1917# 1922
CHIF . . . . . . .  C ADDR   211AH   R   SEG=MAIN   5341 5343#
CHIFB. . . . . . .  C ADDR   212EH   R   SEG=MAIN   5356 5359#
CHIFB1 . . . . . .  C ADDR   2133H   R   SEG=MAIN   5358 5359 5361#
CHIND. . . . . . .  D ADDR   00ACH   A      380# 1290 1712
CHINKOR. . . . . .  D ADDR   0098H   A      363# 537 723 1088 1101 1143 1157 1160 1924
CHK. . . . . . . .  C ADDR   1F59H   R   SEG=MAIN   1245 5011#
CHKL . . . . . . .  D ADDR   003DH   A      305# 644 651 2206 2234 2276 2714 2980 3603 3986
CHMAS. . . . . . .  D ADDR   006EH   A      302# 1018 1025 1048 5573
CHMASN . . . . . .  D ADDR   003FH   A      306# 730 739 775 792 808 824 1023 1025 1026
CHMINUS. . . . . .  C ADDR   247AH   R   SEG=MAIN   3094 3125 3142 3160 3177 5756# 5817
CHTADC . . . . . .  C ADDR   1DB1H   R   SEG=MAIN   4718#
CHTHO. . . . . . .  C ADDR   1F39H   R   SEG=MAIN   1252 4186 5003#
CHTHOU . . . . . .  C ADDR   1FDAH   R   SEG=MAIN   5136#
CHZAP. . . . . . .  C ADDR   1EFDH   R   SEG=MAIN   1794 4985#
CH_1 . . . . . . .  C ADDR   1F29H   R   SEG=MAIN   567 1395 1418 1807 1812 1877 3515 4999#
CH_10. . . . . . .  C ADDR   1F51H   R   SEG=MAIN   1215 1401 1424 1853 3975 4323 4493 5009#
CH_10TH. . . . . .  C ADDR   1F4DH   R   SEG=MAIN   1312 5008#
CH_2 . . . . . . .  C ADDR   1F2DH   R   SEG=MAIN   1845 5000#
CH_200 . . . . . .  C ADDR   1F49H   R   SEG=MAIN   5007#
CH_220 . . . . . .  C ADDR   1F45H   R   SEG=MAIN   1265 5006#
CH_22T . . . . . .  C ADDR   2018H   R   SEG=MAIN   1351 5184#
CH_250 . . . . . .  C ADDR   1F55H   R   SEG=MAIN   1189 5010#
CH_4 . . . . . . .  C ADDR   1F31H   R   SEG=MAIN   3518 5001#
CH_500 . . . . . .  C ADDR   2014H   R   SEG=MAIN   1347 5183#
CH_953 . . . . . .  C ADDR   1F35H   R   SEG=MAIN   5002#
CH_B . . . . . . .  C ADDR   2010H   R   SEG=MAIN   1363 5181#
CH_FL. . . . . . .  C ADDR   201CH   R   SEG=MAIN   1387 5185#
CH_MLN . . . . . .  C ADDR   1F25H   R   SEG=MAIN   4998#
CIKLWR . . . . . .  C ADDR   23A8H   R   SEG=MAIN   5579#
CKCON. . . . . . .  D ADDR   008EH   A      30# 469 500
CL4. . . . . . . .  C ADDR   1F73H   R   SEG=MAIN   5028# 5030
CL4N . . . . . . .  C ADDR   1F79H   R   SEG=MAIN   5037# 5039
CLE20. . . . . . .  C ADDR   16A9H   R   SEG=MAIN   3633# 3635
CLE256 . . . . . .  C ADDR   043EH   A      3809 4219 7617#
CLEAR. . . . . . .  C ADDR   24FEH   R   SEG=MAIN   5897 5901# 5931
CLEAR4 . . . . . .  C ADDR   1F70H   R   SEG=MAIN   753 1328 1330 1458 1479 1518 1520 2135 2137 2772 2774 4247 5026#
CLEARN . . . . . .  C ADDR   1F78H   R   SEG=MAIN   3378 3414 3506 3837 3951 4062 4090 5035#
CLMASSIX . . . . .  C ADDR   2398H   R   SEG=MAIN   528 1326 1516 1928 2029 2133 2770 2944 5567#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   126

CLMASV . . . . . .  C ADDR   0763H   R   SEG=MAIN   1321 1323#
CLMAX. . . . . . .  C ADDR   239DH   R   SEG=MAIN   5569# 5572
CLR11. . . . . . .  C ADDR   24FFH   R   SEG=MAIN   5903# 5905
CLRDEC . . . . . .  C ADDR   24F8H   R   SEG=MAIN   5895#
CLRNUM . . . . . .  C ADDR   24FCH   R   SEG=MAIN   5898# 6012
CLRVICH. . . . . .  C ADDR   1159H   R   SEG=MAIN   2870# 2887
CNTR . . . . . . .  N NUMB   0006H   A      6808#
CO02S. . . . . . .  C ADDR   1EE5H   R   SEG=MAIN   4969# 4973
CO05S. . . . . . .  C ADDR   1EF2H   R   SEG=MAIN   4978# 4982
CO1S . . . . . . .  C ADDR   1EDCH   R   SEG=MAIN   4963# 4963
CO2S . . . . . . .  C ADDR   1ED8H   R   SEG=MAIN   4961# 4965
COMPA1 . . . . . .  C ADDR   07E8H   R   SEG=MAIN   1395# 1404
COMPA2 . . . . . .  C ADDR   081EH   R   SEG=MAIN   1418# 1427
COND . . . . . . .  C ADDR   240CH   R   SEG=MAIN   5663#
COPY1. . . . . . .  C ADDR   049FH   A      7699# 7704
COPYPP . . . . . .  C ADDR   0499H   A      3796 4198 7696#
COPY_HL. . . . . .  D ADDR   00D7H   A      400# 3531 3654 4240 4256 4271 4409 4424 4439 4560 4575 4590
COUNT. . . . . . .  C ADDR   1EBAH   R   SEG=MAIN   4935# 4935
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   1EC1H   R   SEG=MAIN   4941# 4941
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 474
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1546 1567
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1549 1571
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 475
DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1802
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1799
DCOA . . . . . . .  C ADDR   2411H   R   SEG=MAIN   5667# 5669
DCOB . . . . . . .  C ADDR   2418H   R   SEG=MAIN   5671# 5689
DCOC . . . . . . .  C ADDR   2423H   R   SEG=MAIN   5681# 5686
DCOD . . . . . . .  C ADDR   2430H   R   SEG=MAIN   5688 5691#
DDOUTF . . . . . .  C ADDR   13BFH   R   SEG=MAIN   3064 3105 3210 3218# 3300
DDOUTFR. . . . . .  C ADDR   12CCH   R   SEG=MAIN   3064# 3070
DEC30. . . . . . .  C ADDR   2551H   R   SEG=MAIN   6022# 6047
DEC31. . . . . . .  C ADDR   2556H   R   SEG=MAIN   6028# 6035
DEC32. . . . . . .  C ADDR   2566H   R   SEG=MAIN   6040# 6044
DECBIN . . . . . .  C ADDR   2544H   R   SEG=MAIN   3382 3418 3510 3972 4067 4094 6001#
DECSIZE. . . . . .  N NUMB   000AH   A      5876# 5896 5930 5957 5970 5973 6027
DECT2. . . . . . .  C ADDR   256FH   R   SEG=MAIN   6018 6050#
DEDPTR . . . . . .  C ADDR   27C4H   R   SEG=MAIN   6535 6539 6543 6549#
DENORM . . . . . .  C ADDR   0133H   A      6967# 7023
DGOTO7 . . . . . .  C ADDR   150CH   R   SEG=MAIN   3421# 3429
DIAP . . . . . . .  D ADDR   00AEH   A      382# 556 1316 1500 1618 2127 2159 2763 3573 3881 4824 4845 5099 5114 5265
                                           5327
DIINC. . . . . . .  C ADDR   0C85H   R   SEG=MAIN   2130 2133#
DIKDN. . . . . . .  C ADDR   20AAH   R   SEG=MAIN   5267 5287#
DIKDW. . . . . . .  C ADDR   1FC4H   R   SEG=MAIN   5103 5124#
DIPAR. . . . . . .  C ADDR   1FD8H   R   SEG=MAIN   5134#
DIV1 . . . . . . .  C ADDR   02DDH   A      7304# 7363
DIV2 . . . . . . .  C ADDR   0320H   A      7322 7326 7330 7334 7349#
DIV3 . . . . . . .  C ADDR   030DH   A      7323 7327 7331 7335#
DIV9 . . . . . . .  C ADDR   0336H   A      7293 7295 7369#
DIVIDE . . . . . .  C ADDR   262FH   R   SEG=MAIN   5595 6236#
DONE . . . . . . .  C ADDR   259EH   R   SEG=MAIN   6066 6077#
DONE1. . . . . . .  C ADDR   259CH   R   SEG=MAIN   6069 6072 6075#
DOSH . . . . . . .  C ADDR   26B8H   R   SEG=MAIN   6311 6327#
DOSUB. . . . . . .  C ADDR   26A6H   R   SEG=MAIN   6295 6299 6303 6307 6308 6312#
DPH. . . . . . . .  D ADDR   0083H   A      19# 534 2661 3536 3538 3659 3664 4112 4241 4253 4258 4267 4269 4272 4283
                                           4370 4372 4410 4421 4426 4435 4437 4440 4451 4561 4572 4577 4586 4588 4591
                                           4602 5527 5535 5802 5808 5828 6083 6119 6154 6157 6169 6192 6554 6556 7630
                                           7650 7696
DPL. . . . . . . .  D ADDR   0082H   A      18# 2660 3532 3534 3656 3667 4113 4244 4251 4261 4264 4266 4275 4279 4367
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   127

                                           4369 4413 4419 4429 4432 4434 4443 4447 4564 4570 4580 4583 4585 4594 4598
                                           5528 5534 5799 5811 5832 6099 6135 6156 6170 6173 6207 6551 6553 7631 7651
                                           7697
DVIG0. . . . . . .  C ADDR   0A11H   R   SEG=MAIN   1748# 1750
DVIG1. . . . . . .  C ADDR   0A06H   R   SEG=MAIN   1739# 1741
DVIG2. . . . . . .  C ADDR   09FBH   R   SEG=MAIN   1730# 1732
DVIG3. . . . . . .  C ADDR   09EFH   R   SEG=MAIN   1721# 1723
DVIG4. . . . . . .  C ADDR   0A1DH   R   SEG=MAIN   1759# 1761
DVIG6. . . . . . .  C ADDR   0A3FH   R   SEG=MAIN   1787# 1789
DVM. . . . . . . .  C ADDR   0A3DH   R   SEG=MAIN   1775 1786#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 472
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 515 2043 2634 2649 4129 4690 4702
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDKALIB . . . . .  C ADDR   1A65H   R   SEG=MAIN   2752 4173#
ENDSDV . . . . . .  C ADDR   0A43H   R   SEG=MAIN   1781 1790#
ENDSUM . . . . . .  C ADDR   0548H   R   SEG=MAIN   836 889 992 1017#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU0 . . . . . . .  C ADDR   0819H   R   SEG=MAIN   1398 1414#
EQU00. . . . . . .  C ADDR   0837H   R   SEG=MAIN   1416 1421 1430#
EQU1L. . . . . . .  C ADDR   0F3CH   R   SEG=MAIN   2550 2554#
EQU2L. . . . . . .  C ADDR   141FH   R   SEG=MAIN   3286 3291#
ERROR. . . . . . .  C ADDR   21BEH   R   SEG=MAIN   3904 4668 4682 5463#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      6810#
EXP2 . . . . . . .  N NUMB   0001H   A      6812# 6989 7010
EXTCLE . . . . . .  C ADDR   01ACH   R   SEG=MAIN   531# 535
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDEXT. . . . . .  C ADDR   1FBDH   R   SEG=MAIN   4200 5113#
FINDKOEF . . . . .  C ADDR   1FAEH   R   SEG=MAIN   1248 5098#
FINDMEM. . . . . .  C ADDR   0EA0H   R   SEG=MAIN   2401 2461#
FINDR. . . . . . .  C ADDR   2103H   R   SEG=MAIN   1484 3872 5327#
FINIS. . . . . . .  C ADDR   26E3H   R   SEG=MAIN   6255 6356#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      4295 4307 7015# 7104
FLCMP. . . . . . .  C ADDR   01D6H   A      1191 1267 1314 1349 1353 1397 1420 1814 4466 4482 4617 4632 7109#
FLDIV. . . . . . .  C ADDR   02B7H   A      1214 1254 1370 1389 1403 1973 2011 4184 4322 4325 4495 7279#
FLMUL. . . . . . .  C ADDR   0203H   A      1082 1180 1217 1259 1365 1426 1847 3520 3977 4188 7149#
FLOUT. . . . . . .  C ADDR   01E1H   A      7116 7119#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 7618 7624 7675 7680
FLSUB. . . . . . .  C ADDR   01D1H   A      1172 1809 1879 1969 2007 3517 7102#
FND. . . . . . . .  C ADDR   01F8H   A      7125 7128 7131 7134 7137#
FO1M . . . . . . .  C ADDR   23CFH   R   SEG=MAIN   5601 5605#
FO2M . . . . . . .  C ADDR   23D8H   R   SEG=MAIN   5608 5610#
FORM4. . . . . . .  C ADDR   23D9H   R   SEG=MAIN   5603 5609 5613#
FT1IZM . . . . . .  C ADDR   0D56H   R   SEG=MAIN   2271#
FTOL . . . . . . .  C ADDR   0343H   A      1127 1261 1373 3521 4189 4326 4496 5390 5417 7385#
FTOL1. . . . . . .  C ADDR   037CH   A      7398 7402 7426#
FTOL2. . . . . . .  C ADDR   039EH   A      7422 7459#
FTOL22 . . . . . .  C ADDR   03C4H   A      7462 7496#
FTOL23 . . . . . .  C ADDR   03A2H   A      7463# 7495
FTOL24 . . . . . .  C ADDR   03B5H   A      7465 7481#
FTOL25 . . . . . .  C ADDR   03C2H   A      7480 7495#
FTOL26 . . . . . .  C ADDR   03E4H   A      7511 7527#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   128

FTOL3. . . . . . .  C ADDR   038AH   A      7425 7439#
FTOL33 . . . . . .  C ADDR   038EH   A      7443# 7457
FTOL4. . . . . . .  C ADDR   0371H   A      7404 7419#
FTOL9. . . . . . .  C ADDR   0381H   A      7432# 7442 7458 7526 7541
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   480# 481
GO23NO . . . . . .  C ADDR   1384H   R   SEG=MAIN   3110 3187#
GO31L. . . . . . .  C ADDR   0F42H   R   SEG=MAIN   2528 2559#
GO41L. . . . . . .  C ADDR   0F47H   R   SEG=MAIN   2559 2561#
GOA2 . . . . . . .  C ADDR   0719H   R   SEG=MAIN   1271 1273 1276# 1307
GOA3A2 . . . . . .  C ADDR   0723H   R   SEG=MAIN   1281#
GOCIKLE. . . . . .  C ADDR   0AC0H   R   SEG=MAIN   1821 1850 1859 1866# 1873 1880
GOFULL . . . . . .  C ADDR   13B7H   R   SEG=MAIN   3193 3214#
GOKAA2 . . . . . .  C ADDR   0741H   R   SEG=MAIN   1305#
GOKLB. . . . . . .  C ADDR   0C54H   R   SEG=MAIN   2078 2100#
GOOFF1 . . . . . .  C ADDR   1323H   R   SEG=MAIN   3119# 3128
GOOFF2 . . . . . .  C ADDR   133BH   R   SEG=MAIN   3136# 3145
GOOFF3 . . . . . .  C ADDR   1353H   R   SEG=MAIN   3154# 3163
GOOFF4 . . . . . .  C ADDR   136BH   R   SEG=MAIN   3171# 3180
GOONIN . . . . . .  C ADDR   0733H   R   SEG=MAIN   1289# 1332 1506 1522
GOONIND. . . . . .  C ADDR   090AH   R   SEG=MAIN   1292 1572#
GOONOFF. . . . . .  C ADDR   12F4H   R   SEG=MAIN   3088# 3097
GOONT. . . . . . .  C ADDR   0A86H   R   SEG=MAIN   1824 1831#
GOPAROL. . . . . .  C ADDR   1856H   R   SEG=MAIN   3738 3858 3866#
GOPAROM. . . . . .  C ADDR   176CH   R   SEG=MAIN   3736# 3739
GOPART . . . . . .  C ADDR   02D9H   R   SEG=MAIN   725 728#
GOSK19 . . . . . .  C ADDR   0E78H   R   SEG=MAIN   2432 2437#
GOTO7. . . . . . .  C ADDR   1031H   R   SEG=MAIN   2713# 2784 2791 2828 2874 2903 2915 2954 2958 2999 3015 3024 3030
                                           3035 3041 3056 3103 3185 3239 3242 3253 3290 3293 3322 3334 3339 3365 3367
                                           3402 3421 3439 3491 3677 3684 3901 3911 3943 3994 3996 4012 4024 4081 4234
GOTOKD . . . . . .  C ADDR   05DBH   R   SEG=MAIN   1085 1109#
GOUT6. . . . . . .  C ADDR   0C09H   R   SEG=MAIN   2068# 2096
GOVVLIST . . . . .  C ADDR   15A3H   R   SEG=MAIN   3474 3496#
GOZNAK . . . . . .  C ADDR   028BH   R   SEG=MAIN   639 668#
HNOR11 . . . . . .  C ADDR   1164H   R   SEG=MAIN   2839 2878#
HNOR12 . . . . . .  C ADDR   1113H   R   SEG=MAIN   2829 2833#
HNOT1. . . . . . .  C ADDR   11ADH   R   SEG=MAIN   2805 2924#
HNOT2. . . . . . .  C ADDR   10E1H   R   SEG=MAIN   2802#
HR12 . . . . . . .  C ADDR   1109H   R   SEG=MAIN   2824 2829#
HVI1113. . . . . .  C ADDR   1103H   R   SEG=MAIN   2827# 2832 2837
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 516 4648 7617 7625 7674 7684
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   10DDH   R   SEG=MAIN   2797 2799#
IND. . . . . . . .  C ADDR   1D7FH   R   SEG=MAIN   588 596 656 1408 1412 1709 2120 3598 3649 3905 4231 4664 4670
                                           4684 4690#
INDA3. . . . . . .  C ADDR   08D1H   R   SEG=MAIN   1537#
INDOLL . . . . . .  C ADDR   08A8H   R   SEG=MAIN   1498 1499 1503#
INIACP . . . . . .  C ADDR   2020H   R   SEG=MAIN   605 2942 5191#
INNOT1_2 . . . . .  C ADDR   147BH   R   SEG=MAIN   3331 3336#
INNOT3 . . . . . .  C ADDR   146CH   R   SEG=MAIN   3323 3328#
INNOT6 . . . . . .  C ADDR   1460H   R   SEG=MAIN   3319 3323#
INTERVA. . . . . .  D ADDR   00CDH   A      395# 1831 3384
INTMUL . . . . . .  C ADDR   0A9EH   R   SEG=MAIN   1847# 1855
INTN . . . . . . .  C ADDR   14F5H   R   SEG=MAIN   3412#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   1195H   R   SEG=MAIN   2905#
IZMAN. . . . . . .  C ADDR   0CD9H   R   SEG=MAIN   2041 2180#
IZMFUN . . . . . .  C ADDR   0CE8H   R   SEG=MAIN   2121 2132 2139 2184 2187#
IZMPAT . . . . . .  C ADDR   0CECH   R   SEG=MAIN   2094 2108 2110 2156 2191#
IZMT2. . . . . . .  C ADDR   0CFBH   R   SEG=MAIN   2207 2212#
IZMT3. . . . . . .  C ADDR   0D06H   R   SEG=MAIN   2212 2218#
JFINIS . . . . . .  C ADDR   264AH   R   SEG=MAIN   6247 6255#
KD . . . . . . . .  C ADDR   1F3DH   R   SEG=MAIN   5004#
KEYB1. . . . . . .  C ADDR   0BE2H   R   SEG=MAIN   283 2042#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   129

KEYB2. . . . . . .  C ADDR   0FC8H   R   SEG=MAIN   286 2648#
KFULL. . . . . . .  C ADDR   138EH   R   SEG=MAIN   3057 3192#
KFULLR . . . . . .  C ADDR   12BBH   R   SEG=MAIN   3052 3057#
KGO23. . . . . . .  C ADDR   1310H   R   SEG=MAIN   3051 3108#
KLEV1. . . . . . .  C ADDR   1295H   R   SEG=MAIN   3007 3042#
KLEV2. . . . . . .  C ADDR   129AH   R   SEG=MAIN   3042 3044#
KLEV21 . . . . . .  C ADDR   12BEH   R   SEG=MAIN   3049 3058#
KLEV22 . . . . . .  C ADDR   12A4H   R   SEG=MAIN   3037 3046 3049#
KLEV23 . . . . . .  C ADDR   12CFH   R   SEG=MAIN   3058 3066#
KLEV3. . . . . . .  C ADDR   129FH   R   SEG=MAIN   3044 3046#
KLMAS. . . . . . .  C ADDR   0386H   R   SEG=MAIN   757 823#
KNAVP. . . . . . .  C ADDR   107CH   R   SEG=MAIN   2693 2754#
KNIZM. . . . . . .  B ADDR   0023H.0 A      347# 1271 1499 1678 2158 2180 2181 2185
KNIZMON. . . . . .  C ADDR   0CE3H   R   SEG=MAIN   2180 2185#
KNKMP. . . . . . .  C ADDR   0FB9H   R   SEG=MAIN   2643# 2687
KNLEFT . . . . . .  C ADDR   108CH   R   SEG=MAIN   2647 2761#
KNMEM. . . . . . .  C ADDR   1202H   R   SEG=MAIN   2642 2973#
KNMENU . . . . . .  C ADDR   1053H   R   SEG=MAIN   2699 2733#
KNNUL. . . . . . .  C ADDR   10AAH   R   SEG=MAIN   2646 2778#
KNOPT. . . . . . .  C ADDR   0D0EH   R   SEG=MAIN   2040 2226#
KNRAZR . . . . . .  C ADDR   0D23H   R   SEG=MAIN   2039 2240#
KNRIGHT. . . . . .  C ADDR   0C7BH   R   SEG=MAIN   2084 2125#
KNVICH . . . . . .  C ADDR   0C97H   R   SEG=MAIN   2093 2141#
KOEFKD . . . . . .  D ADDR   00A0H   A      377# 573 4191 4201
KOEFKM . . . . . .  D ADDR   0094H   A      371# 571 1080 1178 2015
KOEFKP . . . . . .  D ADDR   0090H   A      370# 569 1077 1173 1977
KOMUL. . . . . . .  C ADDR   06E1H   R   SEG=MAIN   1247 1251#
KOMULPZ. . . . . .  C ADDR   06DBH   R   SEG=MAIN   1244 1248#
KONSTA . . . . . .  D ADDR   00BCH   A      390# 1361 4070 5388
KONSTB . . . . . .  D ADDR   00C0H   A      391# 4101 5408
KON_B. . . . . . .  C ADDR   0DE1H   R   SEG=MAIN   2327 2346#
KOR0US . . . . . .  C ADDR   1E78H   R   SEG=MAIN   1901 4878#
KOR0_AN. . . . . .  D ADDR   0084H   A      367# 1170 1913 1967 2005
KORDEC1. . . . . .  C ADDR   0629H   R   SEG=MAIN   1155 1160#
KORDEC10 . . . . .  C ADDR   060CH   R   SEG=MAIN   1143#
KORNUL . . . . . .  C ADDR   0AF5H   R   SEG=MAIN   1092 1897#
KVVOD0 . . . . . .  C ADDR   13AAH   R   SEG=MAIN   3017 3200 3209#
LABEL43. . . . . .  C ADDR   159AH   R   SEG=MAIN   3492# 3500
LABEL7 . . . . . .  C ADDR   166FH   R   SEG=MAIN   3492 3603# 3615
LABELA . . . . . .  C ADDR   0260H   R   SEG=MAIN   642# 660 1870
LABELB . . . . . .  C ADDR   09E8H   R   SEG=MAIN   1135 1525 1714# 1885 1889 1891
LABELC . . . . . .  C ADDR   0D23H   R   SEG=MAIN   2241#
LABELE . . . . . .  C ADDR   0CECH   R   SEG=MAIN   2189 2205# 2246 2249 2253 2257
LABELF . . . . . .  C ADDR   0D42H   R   SEG=MAIN   2038 2260#
LABELH . . . . . .  C ADDR   10CCH   R   SEG=MAIN   2645 2793#
LABELI . . . . . .  C ADDR   193FH   R   SEG=MAIN   2808 2863 2917 4007#
LABELI2. . . . . .  C ADDR   1149H   R   SEG=MAIN   2863# 2864
LABELK . . . . . .  C ADDR   1239H   R   SEG=MAIN   2807 3000#
LABELL . . . . . .  C ADDR   0EFDH   R   SEG=MAIN   2399 2490 2498#
LABELL1. . . . . .  C ADDR   0E1EH   R   SEG=MAIN   2384# 2454 2566 2615
LABELN . . . . . .  C ADDR   0F61H   R   SEG=MAIN   2455 2575#
LABELP . . . . . .  C ADDR   1570H   R   SEG=MAIN   3425 3445 3474# 3686
LABELS . . . . . .  C ADDR   153BH   R   SEG=MAIN   3196 3445#
LABELS1. . . . . .  C ADDR   17CDH   R   SEG=MAIN   3754 3784#
LABELS13 . . . . .  C ADDR   18C8H   R   SEG=MAIN   3825 3923#
LABELS3. . . . . .  C ADDR   1952H   R   SEG=MAIN   4017#
LABELS4. . . . . .  C ADDR   192DH   R   SEG=MAIN   3824 3998#
LABL2. . . . . . .  C ADDR   0F23H   R   SEG=MAIN   2531# 3061
LABM . . . . . . .  C ADDR   1425H   R   SEG=MAIN   3062 3296#
LADD . . . . . . .  C ADDR   278BH   R   SEG=MAIN   736 771 788 804 1797 6482#
LADDX. . . . . . .  C ADDR   279CH   R   SEG=MAIN   6506#
LBTOF. . . . . . .  C ADDR   042DH   A      7596#
LCMP . . . . . . .  C ADDR   2589H   R   SEG=MAIN   4796 5632 6062#
LDC_LONG . . . . .  C ADDR   259FH   R   SEG=MAIN   568 1246 1795 1972 2010 2788 6082#
LDC_LTEMP. . . . .  C ADDR   25C1H   R   SEG=MAIN   745 1031 1036 1041 1045 1190 1216 1253 1266 1313 1348 1352 1364
                                           1388 1396 1402 1419 1425 1540 1808 1813 1846 1854 1878 3516 3519 3545 3976
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   130

                                           4187 4324 4494 4810 5795 6118#
LDX_LONG . . . . .  C ADDR   25E7H   R   SEG=MAIN   6153#
LDX_LTEMP. . . . .  C ADDR   260DH   R   SEG=MAIN   6191#
LEFCUR . . . . . .  C ADDR   148AH   R   SEG=MAIN   3345# 3407 3423
LEFKL. . . . . . .  C ADDR   1096H   R   SEG=MAIN   2761 2767#
LEFMEM11 . . . . .  C ADDR   1247H   R   SEG=MAIN   3008# 3043 3045 3047
LEFT21 . . . . . .  C ADDR   13D8H   R   SEG=MAIN   3235 3240#
LEFT_S . . . . . .  C ADDR   17CAH   R   SEG=MAIN   3783# 3786
LEFT_SK. . . . . .  C ADDR   18AFH   R   SEG=MAIN   3783 3913#
LEV220 . . . . . .  C ADDR   12A7H   R   SEG=MAIN   3050# 3059
LEV2GO . . . . . .  C ADDR   0F87H   R   SEG=MAIN   2574 2611#
LEVEL. . . . . . .  D ADDR   00B0H   A      384# 2112 2462 2500 2978 2988 3006 3211
LI21 . . . . . . .  C ADDR   119FH   R   SEG=MAIN   2912 2914#
LI42_43. . . . . .  C ADDR   1609H   R   SEG=MAIN   3542# 3669
LIST_43. . . . . .  C ADDR   1679H   R   SEG=MAIN   3494 3608#
LLDI2. . . . . . .  C ADDR   0CD2H   R   SEG=MAIN   2171 2175#
LLDI23 . . . . . .  C ADDR   0CC6H   R   SEG=MAIN   2163 2168#
LLDI3. . . . . . .  C ADDR   0CCDH   R   SEG=MAIN   2170 2172#
LLEV2. . . . . . .  C ADDR   0F4CH   R   SEG=MAIN   2530 2564#
LLMUL. . . . . . .  C ADDR   26F4H   R   SEG=MAIN   6376#
LLSUB. . . . . . .  C ADDR   2779H   R   SEG=MAIN   6458#
LLTOF. . . . . . .  C ADDR   0432H   A      7602#
LMUL . . . . . . .  C ADDR   26F4H   R   SEG=MAIN   5590 5796 6378#
LOA3_X . . . . . .  C ADDR   24D4H   R   SEG=MAIN   1827 5835#
LOAB12 . . . . . .  C ADDR   206FH   R   SEG=MAIN   2940 5232#
LOAD . . . . . . .  D ADDR   00B7H   A      388# 2229 2265 2795 2936 4901
LOADB. . . . . . .  C ADDR   11BEH   R   SEG=MAIN   2931 2934# 2964 2970
LOADB2 . . . . . .  C ADDR   11E7H   R   SEG=MAIN   2952 2956#
LOADCLE. . . . . .  C ADDR   1265H   R   SEG=MAIN   3022# 3203
LOADKD . . . . . .  C ADDR   208CH   R   SEG=MAIN   5265#
LOADR2 . . . . . .  C ADDR   207EH   R   SEG=MAIN   3419 3511 3973 4068 4095 5248#
LOADT. . . . . . .  C ADDR   1E93H   R   SEG=MAIN   2231 2271 2801 4901#
LOADUS . . . . . .  C ADDR   1E32H   R   SEG=MAIN   606 1324 1513 1916 2018 2138 2186 2747 2775 2943 4822#
LOAHL_R2 . . . . .  C ADDR   1B9AH   R   SEG=MAIN   4290 4302 4353# 4462 4478 4613 4628
LOBLOK . . . . . .  C ADDR   13E3H   R   SEG=MAIN   3190 3247# 3263
LOCLE. . . . . . .  C ADDR   1260H   R   SEG=MAIN   3011 3020#
LOD1 . . . . . . .  C ADDR   1EA2H   R   SEG=MAIN   4909# 4914
LODT . . . . . . .  C ADDR   1EAEH   R   SEG=MAIN   4921# 4926
LOIZMK . . . . . .  C ADDR   1116H   R   SEG=MAIN   2834# 2868
LOKAME1. . . . . .  C ADDR   1725H   R   SEG=MAIN   3699#
LOLEVT . . . . . .  C ADDR   1E95H   R   SEG=MAIN   2118 4902#
LOLIST . . . . . .  C ADDR   1254H   R   SEG=MAIN   3013#
LOME1. . . . . . .  C ADDR   1A1CH   R   SEG=MAIN   4140# 4144 4147 4150 4153 4157 4160 4163 4166 4170
LOMENU . . . . . .  C ADDR   1A14H   R   SEG=MAIN   2414 2427 3699 3741 3764 4137#
LOOP . . . . . . .  C ADDR   1DEEH   R   SEG=MAIN   4759# 4760
LOOPS. . . . . . .  C ADDR   264DH   R   SEG=MAIN   6257# 6290
LOSPUS . . . . . .  C ADDR   1E6CH   R   SEG=MAIN   1902 4861#
LOSTAT . . . . . .  C ADDR   127CH   R   SEG=MAIN   3026 3032#
LOTEXT . . . . . .  C ADDR   1EAAH   R   SEG=MAIN   1407 1411 1504 2149 2302 2310 2318 2434 2438 2470 2479 2487 2496
                                           2504 2738 2827 2894 2975 3014 3023 3029 3034 3040 3055 3215 3248 3257 3312
                                           3460 3484 3638 3674 3682 3695 3716 3721 3760 3869 3915 3919 4077 4140 4230
                                           4918# 5464
LOTP . . . . . . .  C ADDR   20E2H   R   SEG=MAIN   5306# 5316 5319
LOTPUS . . . . . .  C ADDR   20DAH   R   SEG=MAIN   3772 4856 5303#
LOU. . . . . . . .  C ADDR   0CD8H   R   SEG=MAIN   2158 2174 2178#
LOUIZM . . . . . .  C ADDR   0CB5H   R   SEG=MAIN   2158# 2183 4853
LOUTF. . . . . . .  C ADDR   0F3FH   R   SEG=MAIN   2556# 2565 2572
LOVICH . . . . . .  C ADDR   110CH   R   SEG=MAIN   2830# 2861 2882 4108
LOWR . . . . . . .  C ADDR   126EH   R   SEG=MAIN   3020 3026#
LOWR1. . . . . . .  C ADDR   1273H   R   SEG=MAIN   3028# 3207
LSUB . . . . . . .  C ADDR   2779H   R   SEG=MAIN   1132 1284 4811 6459#
LTEMP. . . . . . .  N NUMB   0008H   A      1048 1050 1051 1052 5138 5139 5140 5141 5642 5645 5648 5651 5694 5695
                                           5696 5697 5874# 6248 6249 6250 6251 6260 6264 6268 6272 6275 6276 6277
                                           6278 6279 6280 6281 6282 6283 6284 6285 6286 6289 6292 6297 6301 6305 6315
                                           6318 6321 6324 6340 6343 6344 6346 6347 6349 6350 6352 6357 6358 6359 6360
                                           6380 6385 6393 6401 6406 6417 6425 6431 6439 6445 6813 6814 6853 6858 6860
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   131

                                           6869 6870 6871 6872 7103 7111 7124 7127 7130 7133 7713 7716 7719 7722
LWR. . . . . . . .  C ADDR   23AAH   R   SEG=MAIN   5581# 5585
LWRX . . . . . . .  C ADDR   236EH   R   SEG=MAIN   5526# 5538
LWTOF. . . . . . .  C ADDR   042FH   A      7598#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   23C5H   R   SEG=MAIN   1594 3548 4327 4498 5589 5594 5599# 5631
MAIN . . . . . . .  C SEG    27D6H       REL=UNIT   237 294# 444
MANT1. . . . . . .  N NUMB   0002H   A      6811# 6838 6887 6888
MANT2. . . . . . .  N NUMB   0008H   A      6813# 6864 6865 6996 6998 6999 7001 7002 7004 7005 7007 7046 7047 7049
                                           7050 7052 7053 7055 7056 7060 7062 7065 7068 7166 7168 7169 7171 7172 7174
                                           7175 7177 7228 7230 7231 7233 7234 7236 7237 7239 7321 7325 7329 7333 7337
                                           7340 7343 7346
MARK0_8. . . . . .  C ADDR   0DE8H   R   SEG=MAIN   2329 2347 2349#
MARKER . . . . . .  D ADDR   00B2H   A      386# 547 2060 2289 2328 2338 2346 2356 2362 2538 2546 2582 2589 2601 2667
                                           2872 2889 2910 2997 3101 3183 3223 3231 3249 3275 3282 3314 3351 3358 3398
                                           3431 3486 3502 3613 3742 3896 3909 3930 3937 3984 4017 4036 4043 4073 4104
                                           5335 5350 5367 5378 5436
MARLE. . . . . . .  C ADDR   2134H   R   SEG=MAIN   3366 5364#
MARRI. . . . . . .  C ADDR   2141H   R   SEG=MAIN   2609 5377#
MAS10. . . . . . .  C ADDR   03A5H   R   SEG=MAIN   825 838#
MAS20. . . . . . .  C ADDR   0425H   R   SEG=MAIN   838 893#
MAS4 . . . . . . .  C ADDR   0519H   R   SEG=MAIN   891 994#
MAS5DIV. . . . . .  C ADDR   058DH   R   SEG=MAIN   1032 1037 1042 1046 1054#
MASFULL. . . . . .  C ADDR   0554H   R   SEG=MAIN   1021 1025#
MASS0. . . . . . .  X ADDR   0100H   A      407 408# 826 831 860 868 942 950 999 1006 5568
MASS1. . . . . . .  X ADDR   0104H   A      409# 834 857 871 939 953 997 1009
MASS10 . . . . . .  X ADDR   0128H   A      418# 915 972
MASS11 . . . . . .  X ADDR   012CH   A      419# 912 974
MASS12 . . . . . .  X ADDR   0130H   A      420# 909 976
MASS13 . . . . . .  X ADDR   0134H   A      421# 906 978
MASS14 . . . . . .  X ADDR   0138H   A      422# 903 980
MASS15 . . . . . .  X ADDR   013CH   A      423# 900 982
MASS16 . . . . . .  X ADDR   0140H   A      424# 898 984
MASS17 . . . . . .  X ADDR   0144H   A      425# 896 986
MASS18 . . . . . .  X ADDR   0148H   A      426# 894 988
MASS19 . . . . . .  X ADDR   014CH   A      427# 990
MASS2. . . . . . .  X ADDR   0108H   A      410# 854 873 936 955 995 1011
MASS3. . . . . . .  X ADDR   010CH   A      411# 851 875 933 957 1013
MASS4. . . . . . .  X ADDR   0110H   A      412# 848 877 930 959
MASS5. . . . . . .  X ADDR   0114H   A      413# 845 879 927 961
MASS6. . . . . . .  X ADDR   0118H   A      414# 843 881 925 963
MASS7. . . . . . .  X ADDR   011CH   A      415# 841 883 923 965
MASS8. . . . . . .  X ADDR   0120H   A      416# 839 885 921 967
MASS9. . . . . . .  X ADDR   0124H   A      417# 887 918 969
MASX5. . . . . . .  C ADDR   0583H   R   SEG=MAIN   1023 1048#
MAXG . . . . . . .  C ADDR   1CC1H   R   SEG=MAIN   4569# 4623
MAXVIX . . . . . .  C ADDR   1D2BH   R   SEG=MAIN   4633 4638#
ME11_15DE. . . . .  C ADDR   1535H   R   SEG=MAIN   3441# 3457
ME11_15DEC . . . .  C ADDR   1724H   R   SEG=MAIN   3441 3698#
ME21_22. . . . . .  C ADDR   0F07H   R   SEG=MAIN   2504# 2512
ME21_23. . . . . .  C ADDR   1788H   R   SEG=MAIN   3471 3750#
ME21_23DEC . . . .  C ADDR   17A4H   R   SEG=MAIN   3757 3762#
MEAVP. . . . . . .  C ADDR   1087H   R   SEG=MAIN   2755 2758#
MECLE. . . . . . .  C ADDR   0199H   R   SEG=MAIN   520# 522
MEFF . . . . . . .  C ADDR   01A0H   R   SEG=MAIN   524# 527
MEM12NO. . . . . .  C ADDR   13A5H   R   SEG=MAIN   3201 3205#
MENG . . . . . . .  C ADDR   1AE6H   R   SEG=MAIN   4250# 4300
MENU12 . . . . . .  C ADDR   1A20H   R   SEG=MAIN   4138 4142#
MENU13 . . . . . .  C ADDR   1A28H   R   SEG=MAIN   4142 4145#
MENU14 . . . . . .  C ADDR   1A30H   R   SEG=MAIN   4145 4148#
MENU15 . . . . . .  C ADDR   1A38H   R   SEG=MAIN   4148 4151#
MENU21 . . . . . .  C ADDR   1A40H   R   SEG=MAIN   4151 4155#
MENU22 . . . . . .  C ADDR   1A48H   R   SEG=MAIN   4155 4158#
MENU23 . . . . . .  C ADDR   1A50H   R   SEG=MAIN   4158 4161#
MENU31 . . . . . .  C ADDR   1A58H   R   SEG=MAIN   4161 4164#
MENU41 . . . . . .  C ADDR   1A60H   R   SEG=MAIN   4164 4168#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   132

MENUOFF. . . . . .  C ADDR   106AH   R   SEG=MAIN   2734 2743#
MENUON . . . . . .  C ADDR   1562H   R   SEG=MAIN   3462#
MERR . . . . . . .  C ADDR   1050H   R   SEG=MAIN   2730# 2733
ME_14. . . . . . .  C ADDR   1287H   R   SEG=MAIN   3037#
ME_41. . . . . . .  C ADDR   1819H   R   SEG=MAIN   3784 3827#
MIDL . . . . . . .  C ADDR   2680H   R   SEG=MAIN   6252 6287#
MIGN . . . . . . .  C ADDR   21A0H   R   SEG=MAIN   4691 5436#
MIGNN. . . . . . .  C ADDR   21A8H   R   SEG=MAIN   5438 5443#
MIN4_HL. . . . . .  C ADDR   1BA6H   R   SEG=MAIN   4366# 4380 4406 4531 4557
MING . . . . . . .  C ADDR   1BE8H   R   SEG=MAIN   4418# 4472
MINIVIX. . . . . .  C ADDR   1C52H   R   SEG=MAIN   4483 4488# 4638
MLABL2 . . . . . .  C ADDR   1408H   R   SEG=MAIN   3216 3267# 3298 3495
MLABL2R. . . . . .  C ADDR   15A0H   R   SEG=MAIN   3495# 3498
MMM. . . . . . . .  C ADDR   025BH   R   SEG=MAIN   637#
MO220. . . . . . .  C ADDR   089DH   R   SEG=MAIN   1147 1303 1498#
MO500I . . . . . .  C ADDR   080DH   R   SEG=MAIN   1354 1410#
MO500R . . . . . .  C ADDR   0801H   R   SEG=MAIN   1350 1406#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   0E9AH   R   SEG=MAIN   2456# 2467 2476 2484 2493
MOUTKMEM . . . . .  C ADDR   1538H   R   SEG=MAIN   3442# 3447
MOVE28 . . . . . .  C ADDR   2432H   R   SEG=MAIN   1209 1255 1356 1970 2008 4181 4292 4304 4319 4461 4477 4612 4627
                                           5694#
MOVE82 . . . . . .  C ADDR   1FDEH   R   SEG=MAIN   5138#
MOVEA3 . . . . . .  C ADDR   090AH   R   SEG=MAIN   1550 1575#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2330 2554 2594 2891 3189 3232 3240 3291 3317 3359 3489 3745 3898
                                           3940 4018 4046 5371
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2326 2547 2551 2590 2892 3188 3236 3283 3287 3316 3363 3488 3744
                                           3899 4022 5380
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      7163# 7206
MUP11. . . . . . .  C ADDR   0257H   A      7210# 7255
MUP2 . . . . . . .  C ADDR   0297H   A      7240 7254#
MUP3 . . . . . . .  C ADDR   026CH   A      7209 7225#
MVV11. . . . . . .  C ADDR   13DEH   R   SEG=MAIN   3212 3245#
MVV12. . . . . . .  C ADDR   13F0H   R   SEG=MAIN   3245 3254#
N12DELCH . . . . .  C ADDR   0BCFH   R   SEG=MAIN   2023 2031#
N4DELCH. . . . . .  C ADDR   0B80H   R   SEG=MAIN   1950 1988#
N8DELCH. . . . . .  C ADDR   0BBDH   R   SEG=MAIN   1988 2023#
NBIMENU. . . . . .  C ADDR   0EA0H   R   SEG=MAIN   2460#
NBLOK. . . . . . .  D ADDR   0038H   A      311# 3077 3310 3482 5786
NE05 . . . . . . .  C ADDR   0358H   A      7392 7394 7396 7399#
NELEM. . . . . . .  D ADDR   0037H   A      312# 3513 3618 3621
NEXIN. . . . . . .  C ADDR   1D89H   R   SEG=MAIN   4694# 4701
NEXTMAX. . . . . .  C ADDR   1CF6H   R   SEG=MAIN   4601 4609#
NEXTMEA. . . . . .  C ADDR   1B1BH   R   SEG=MAIN   4282 4290#
NEXTMIN. . . . . .  C ADDR   1C1DH   R   SEG=MAIN   4450 4458#
NMINUS . . . . . .  C ADDR   0646H   R   SEG=MAIN   1175 1179#
NMINUS3. . . . . .  C ADDR   05ADH   R   SEG=MAIN   1079 1081#
NNDELCH. . . . . .  C ADDR   0B40H   R   SEG=MAIN   1940 1950#
NNMEMB . . . . . .  C ADDR   0F93H   R   SEG=MAIN   2458 2617#
NNNUL. . . . . . .  C ADDR   0981H   R   SEG=MAIN   1656 1659#
NO . . . . . . . .  C ADDR   2668H   R   SEG=MAIN   6262 6266 6270 6274#
NO0KEY . . . . . .  C ADDR   026DH   R   SEG=MAIN   646 651#
NO11V6 . . . . . .  C ADDR   0D9AH   R   SEG=MAIN   2297 2305#
NO12V6 . . . . . .  C ADDR   0DADH   R   SEG=MAIN   2305 2313#
NO13V6 . . . . . .  C ADDR   0DC0H   R   SEG=MAIN   2313 2323#
NO21P7 . . . . . .  C ADDR   19BFH   R   SEG=MAIN   4056 4086#
NO23RI . . . . . .  C ADDR   0E64H   R   SEG=MAIN   2425 2429#
NO2PARN. . . . . .  C ADDR   08F6H   R   SEG=MAIN   1552 1558#
NO31N. . . . . . .  C ADDR   14A9H   R   SEG=MAIN   3372#
NO31RI . . . . . .  C ADDR   0E83H   R   SEG=MAIN   2431 2446#
NO3PARN. . . . . .  C ADDR   08ECH   R   SEG=MAIN   1552# 1637
NO4DEL . . . . . .  C ADDR   0B1BH   R   SEG=MAIN   1906 1921#
NOAVK. . . . . . .  C ADDR   061BH   R   SEG=MAIN   1103 1152#
NOAVP. . . . . . .  C ADDR   0719H   R   SEG=MAIN   1275# 1315 1318
NOBAVP . . . . . .  C ADDR   09A0H   R   SEG=MAIN   1409 1413 1493 1672 1676#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   133

NOBEF99. . . . . .  C ADDR   0316H   R   SEG=MAIN   742 758# 777 794 810
NOBIT. . . . . . .  C ADDR   0245H   A      7178 7192#
NOBITIZM . . . . .  C ADDR   09A9H   R   SEG=MAIN   1678 1681#
NOBL21 . . . . . .  C ADDR   0F10H   R   SEG=MAIN   2501 2508#
NOBL22 . . . . . .  C ADDR   0F1AH   R   SEG=MAIN   2508 2528#
NOBUF. . . . . . .  C ADDR   09DEH   R   SEG=MAIN   1707 1709#
NOBUF0 . . . . . .  C ADDR   0AD0H   R   SEG=MAIN   1818 1875#
NOCHI0 . . . . . .  C ADDR   08CDH   R   SEG=MAIN   1304 1524#
NOCHN10. . . . . .  C ADDR   0570H   R   SEG=MAIN   1034 1039#
NOCHN2 . . . . . .  C ADDR   0565H   R   SEG=MAIN   1029 1034#
NOCHN20. . . . . .  C ADDR   057BH   R   SEG=MAIN   1039 1044#
NODI2. . . . . . .  C ADDR   08B3H   R   SEG=MAIN   1501 1508#
NODI6. . . . . . .  C ADDR   1098H   R   SEG=MAIN   2765 2769#
NODI8. . . . . . .  C ADDR   0958H   R   SEG=MAIN   1621 1627#
NODI8K . . . . . .  C ADDR   1883H   R   SEG=MAIN   3884 3889#
NODI8_43 . . . . .  C ADDR   164FH   R   SEG=MAIN   3576 3582#
NODI9. . . . . . .  C ADDR   08B8H   R   SEG=MAIN   1510 1513#
NODI9_43 . . . . .  C ADDR   165AH   R   SEG=MAIN   3582 3590#
NODIS9 . . . . . .  C ADDR   0967H   R   SEG=MAIN   1627 1639#
NODISK9. . . . . .  C ADDR   188BH   R   SEG=MAIN   3888 3889 3896#
NOENDLI. . . . . .  C ADDR   24C9H   R   SEG=MAIN   5820 5823#
NOEQU1 . . . . . .  C ADDR   0F78H   R   SEG=MAIN   2593 2597#
NOEQU2 . . . . . .  C ADDR   14A3H   R   SEG=MAIN   3362 3366#
NOFIZM . . . . . .  C ADDR   0D7CH   R   SEG=MAIN   2261 2293#
NOFT1. . . . . . .  C ADDR   0D55H   R   SEG=MAIN   2266 2270#
NOFZ . . . . . . .  C ADDR   0ACBH   R   SEG=MAIN   1866 1870#
NOH37. . . . . . .  C ADDR   1124H   R   SEG=MAIN   2823 2844# 2855
NOHNOT1. . . . . .  C ADDR   11F7H   R   SEG=MAIN   2926 2965#
NOHNOT2. . . . . .  C ADDR   11EFH   R   SEG=MAIN   2959# 2965
NOKLB. . . . . . .  C ADDR   09D8H   R   SEG=MAIN   1705 1707#
NOKORR . . . . . .  C ADDR   05C3H   R   SEG=MAIN   1090 1093#
NOLAH. . . . . . .  C ADDR   10EDH   R   SEG=MAIN   2793 2810#
NOLI_43. . . . . .  C ADDR   16CDH   R   SEG=MAIN   3608 3652#
NOM31. . . . . . .  C ADDR   1481H   R   SEG=MAIN   3296 3341#
NOM32. . . . . . .  C ADDR   14E4H   R   SEG=MAIN   3341 3405#
NOM33. . . . . . .  C ADDR   1512H   R   SEG=MAIN   3405 3425#
NOMARL . . . . . .  C ADDR   1967H   R   SEG=MAIN   4020 4026 4030#
NOMAXI . . . . . .  C ADDR   1D0EH   R   SEG=MAIN   4618 4621#
NOME11 . . . . . .  C ADDR   1395H   R   SEG=MAIN   3198#
NOMEM11. . . . . .  C ADDR   0EBBH   R   SEG=MAIN   2463 2473#
NOMEM12. . . . . .  C ADDR   0ED1H   R   SEG=MAIN   2473 2481#
NOMEM13. . . . . .  C ADDR   0EE7H   R   SEG=MAIN   2481 2490#
NOMEMK . . . . . .  C ADDR   1392H   R   SEG=MAIN   2986 3196#
NOMINI . . . . . .  C ADDR   1C35H   R   SEG=MAIN   4467 4470#
NON1C. . . . . . .  C ADDR   0D34H   R   SEG=MAIN   2247 2251#
NONULAVT . . . . .  C ADDR   0600H   R   SEG=MAIN   1098 1137#
NONULDEL . . . . .  C ADDR   0B02H   R   SEG=MAIN   1898 1905#
NOP3_0 . . . . . .  C ADDR   08D1H   R   SEG=MAIN   1530#
NOPART1. . . . . .  C ADDR   031AH   R   SEG=MAIN   731 765#
NOPART2. . . . . .  C ADDR   033AH   R   SEG=MAIN   765 784#
NOPART3. . . . . .  C ADDR   035AH   R   SEG=MAIN   784 799#
NOPART4. . . . . .  C ADDR   037AH   R   SEG=MAIN   799 816#
NOPLUS . . . . . .  C ADDR   0E10H   R   SEG=MAIN   2374 2377#
NOPOIN7. . . . . .  C ADDR   197EH   R   SEG=MAIN   4016 4051#
NOPOINT. . . . . .  C ADDR   194AH   R   SEG=MAIN   4010 4014#
NOR11. . . . . . .  C ADDR   0E24H   R   SEG=MAIN   2388#
NORDN. . . . . . .  C ADDR   00F6H   A      6899# 6932
NORDN1 . . . . . .  C ADDR   0107H   A      6901 6915#
NORIG2 . . . . . .  C ADDR   0F55H   R   SEG=MAIN   2561 2569#
NORIM6 . . . . . .  C ADDR   0F93H   R   SEG=MAIN   2621#
NORIME . . . . . .  C ADDR   0E4AH   R   SEG=MAIN   2412 2416#
NORIME1. . . . . .  C ADDR   0E44H   R   SEG=MAIN   2414# 2417 2430
NORM1. . . . . . .  C ADDR   00F0H   A      6894# 7091 7268 7370 7587
NORR11 . . . . . .  C ADDR   113CH   R   SEG=MAIN   2857#
NORR12 . . . . . .  C ADDR   114CH   R   SEG=MAIN   2857 2864# 2878
NORUP. . . . . . .  C ADDR   0119H   A      6898 6935#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   134

NORUP1 . . . . . .  C ADDR   011EH   A      6940# 6958
NORUP2 . . . . . .  C ADDR   0132H   A      6942 6959#
NORVICH. . . . . .  C ADDR   09E1H   R   SEG=MAIN   1636 1710#
NOSUB. . . . . . .  C ADDR   26A3H   R   SEG=MAIN   6296 6300 6304 6309#
NOT1IN . . . . . .  C ADDR   0AE0H   R   SEG=MAIN   1783 1883#
NOT1_7 . . . . . .  C ADDR   1040H   R   SEG=MAIN   2715 2722#
NOT2IN . . . . . .  C ADDR   0AE8H   R   SEG=MAIN   1883 1887#
NOT2_7 . . . . . .  C ADDR   104BH   R   SEG=MAIN   2722 2727#
NOT3IN . . . . . .  C ADDR   0AF0H   R   SEG=MAIN   1887 1890#
NOTAKT . . . . . .  C ADDR   09B3H   R   SEG=MAIN   1682 1686#
NOTE21 . . . . . .  C ADDR   069DH   R   SEG=MAIN   1196 1219#
NOTE22 . . . . . .  C ADDR   06B8H   R   SEG=MAIN   1219 1231#
NOTESTIZM. . . . .  C ADDR   06D0H   R   SEG=MAIN   1194 1243#
NOTT1. . . . . . .  C ADDR   0AA8H   R   SEG=MAIN   1843 1852#
NOTT2. . . . . . .  C ADDR   0AB3H   R   SEG=MAIN   1852 1857#
NOTT5. . . . . . .  C ADDR   0AB8H   R   SEG=MAIN   1857 1861#
NOT_1. . . . . . .  C ADDR   0D3BH   R   SEG=MAIN   2251 2256#
NOT_10 . . . . . .  C ADDR   0D3BH   R   SEG=MAIN   2255#
NOVIR. . . . . . .  C ADDR   0E2CH   R   SEG=MAIN   2282 2401#
NOVIR1 . . . . . .  C ADDR   0D66H   R   SEG=MAIN   2282# 2293
NOZMEA . . . . . .  C ADDR   1B96H   R   SEG=MAIN   4347 4349#
NOZMIN . . . . . .  C ADDR   1C89H   R   SEG=MAIN   4518 4520#
NOZZMI . . . . . .  C ADDR   0948H   R   SEG=MAIN   1616 1618#
NOZZMI43 . . . . .  C ADDR   163FH   R   SEG=MAIN   3571 3573#
NSEC01 . . . . . .  C ADDR   098AH   R   SEG=MAIN   1660 1663#
NSEC1. . . . . . .  C ADDR   0991H   R   SEG=MAIN   1663 1666#
NSEC10 . . . . . .  C ADDR   0996H   R   SEG=MAIN   1662 1665 1666 1670#
NUERR. . . . . . .  D ADDR   0039H   A      310# 3903 4667 4681 5465
NULAVT . . . . . .  C ADDR   0B2DH   R   SEG=MAIN   1938#
NUMSIZE. . . . . .  N NUMB   0004H   A      5877# 5899 5937 5944 6019 6039
OBOARD . . . . . .  C ADDR   25D9H   R   SEG=MAIN   6120 6134#
OBOARD1. . . . . .  C ADDR   2621H   R   SEG=MAIN   6193 6206#
OK1. . . . . . . .  C ADDR   0186H   A      7025 7040#
OK2. . . . . . . .  C ADDR   01A0H   A      7042 7057#
OK3. . . . . . . .  C ADDR   01C4H   A      7074 7090#
ONBOAR1. . . . . .  C ADDR   25FFH   R   SEG=MAIN   6155 6172#
ONBOARD. . . . . .  C ADDR   25B3H   R   SEG=MAIN   6084 6098#
ONMEM11. . . . . .  C ADDR   1213H   R   SEG=MAIN   2742 2757 2759 2980# 3461 3467 3696 3700 3705 3719 3724 3747 3761
                                           3765 3776
ONMEM12. . . . . .  C ADDR   17ABH   R   SEG=MAIN   3766# 3769 3788
ONMEM13. . . . . .  C ADDR   192AH   R   SEG=MAIN   3941 3996# 4000 4002
ONMIG. . . . . . .  C ADDR   21B6H   R   SEG=MAIN   5447 5456#
ONVICH . . . . . .  C ADDR   0CADH   R   SEG=MAIN   2141 2153#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 483
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 476 480
OUT43. . . . . . .  C ADDR   1666H   R   SEG=MAIN   3598#
OUT6 . . . . . . .  C ADDR   0F93H   R   SEG=MAIN   2037 2100 2211 2216 2221 2238 2268 2273 2280 2291 2415 2428 2436
                                           2440 2622#
OUT7 . . . . . . .  C ADDR   19EDH   R   SEG=MAIN   2643 2644 2719 2726 2730 2748 2798 2803 2851 2984 3063 3260 3327
                                           3600 3607 3651 3734 3822 3917 3921 3991 4005 4048 4053 4083 4111#
OUTA . . . . . . .  C ADDR   214EH   R   SEG=MAIN   2896 5388#
OUTA2. . . . . . .  C ADDR   2168H   R   SEG=MAIN   5399# 5404
OUTB . . . . . . .  C ADDR   2171H   R   SEG=MAIN   5408#
OUTB2. . . . . . .  C ADDR   2197H   R   SEG=MAIN   5426# 5431
OUTB3. . . . . . .  C ADDR   2182H   R   SEG=MAIN   5412 5417#
OUTF . . . . . . .  C ADDR   0D5CH   R   SEG=MAIN   2264 2276# 2299 2303 2307 2311 2315 2319 2344 2367 2376 2379 2386
                                           2456 2471 2480 2488 2497 2506 2553 2556 2596 2610 2613 2842 3766
OUTFL. . . . . . .  C ADDR   0E21H   R   SEG=MAIN   2382 2386#
OUTKMEM. . . . . .  C ADDR   1220H   R   SEG=MAIN   2988# 3005 3442
OUTMA. . . . . . .  C ADDR   0DFAH   R   SEG=MAIN   2365 2367#
OUTMAX . . . . . .  C ADDR   1D13H   R   SEG=MAIN   4605 4624#
OUTMEA . . . . . .  C ADDR   1B36H   R   SEG=MAIN   4286 4301#
OUTMENU. . . . . .  C ADDR   1767H   R   SEG=MAIN   3733#
OUTMIN . . . . . .  C ADDR   1C3AH   R   SEG=MAIN   4454 4474#
OUTR . . . . . . .  C ADDR   0864H   R   SEG=MAIN   1439 1462#
OUTR5. . . . . . .  C ADDR   0880H   R   SEG=MAIN   1460 1481#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   135

OUTSKO . . . . . .  C ADDR   180CH   R   SEG=MAIN   3818 3820#
OUTSKO1. . . . . .  C ADDR   1809H   R   SEG=MAIN   3816 3819#
OUTVICH. . . . . .  C ADDR   0D69H   R   SEG=MAIN   2283# 2295
OUTVIR . . . . . .  C ADDR   0C4DH   R   SEG=MAIN   2067 2096#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 6076
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 4694 4698
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 454
P1 . . . . . . . .  D ADDR   0090H   A      32# 609 610 4707 4709 4712 4715 4719 4721 4722 4774 4776 4778 5205 5212
                                           5724 5727 5729 5732
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 455
P2 . . . . . . . .  D ADDR   00A0H   A      47# 4740 4744 4753
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 456
P3 . . . . . . . .  D ADDR   00B0H   A      62# 465 2066 2068 2070 2071 2074 2075 2079 2080 2082 2083 2085 2086 2088
                                           2089 2091 2092 2262 2263 2294 2295 2298 2299 2306 2307 2314 2315 2323 2324
                                           2369 2370 2380 2381 2409 2410 2423 2424 2450 2451 2452 2453 2465 2466 2474
                                           2475 2482 2483 2491 2492 2529 2530 2564 2565 2573 2574 2611 2612 2638 2674
                                           2676 2678 2679 2682 2683 2685 2686 2688 2689 2691 2692 2694 2695 2697 2698
                                           2794 2796 2822 2823 2844 2845 2858 2859 2865 2866 2879 2880 2924 2925 3004
                                           3005 3008 3009 3050 3051 3067 3068 3069 3070 3108 3109 3198 3199 3209 3210
                                           3297 3298 3299 3300 3342 3343 3372 3373 3406 3407 3408 3409 3426 3427 3428
                                           3429 3446 3447 3454 3455 3497 3498 3499 3500 3609 3610 3688 3689 3755 3756
                                           3768 3769 3785 3786 3787 3788 3828 3829 3830 3831 3999 4000 4001 4002 4008
                                           4009 4014 4015 4051 4052 4127 4739 4741 4743 4749 4750 4751 4754 4755
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2635 2637 4124 4126
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 458
P4 . . . . . . . .  D ADDR   0084H   A      20# 2165 2167 4831 4834 4850 4852 5308
P5 . . . . . . . .  D ADDR   0085H   A      21# 553 561 1941 1946 1981 1983 2175 2177 4839 4842 4872 4875 5312
P6 . . . . . . . .  D ADDR   0086H   A      22# 611 613 617 619
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 459
PACK1. . . . . . .  C ADDR   00DEH   A      6877# 7092 7269 7371 7588
PARERR . . . . . .  C ADDR   1898H   R   SEG=MAIN   3860 3862 3864 3903#
PARN . . . . . . .  D ADDR   00AFH   A      383# 558 1650 2242 2949
PAROL. . . . . . .  D ADDR   00A8H   A      379#
PART . . . . . . .  D ADDR   009AH   A      373# 554 729 1068 1110 1137 1152 1659 1711 1842 1862 2205 2243 2713 2934
                                           2948 3318 4843 5232
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 452
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 453
PCON . . . . . . .  D ADDR   0087H   A      23# 499
POIN3. . . . . . .  C ADDR   197DH   R   SEG=MAIN   4049# 4084
POINA. . . . . . .  C ADDR   19BAH   R   SEG=MAIN   4047 4083#
POINA1 . . . . . .  C ADDR   1962H   R   SEG=MAIN   4019 4026#
POINA2 . . . . . .  C ADDR   195CH   R   SEG=MAIN   4022# 4027
POZB . . . . . . .  C ADDR   19DDH   R   SEG=MAIN   4097 4101#
PROD . . . . . . .  N NUMB   000CH   A      6814# 7158 7159 7160 7161 7181 7182 7183 7185 7186 7188 7189 7191 7213
                                           7215 7216 7218 7219 7221 7222 7224 7243 7244 7245 7247 7248 7250 7251 7253
                                           7264 7265 7266 7267 7288 7289 7290 7291 7307 7309 7310 7312 7313 7315 7316
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   136

                                           7318 7348 7365 7366 7367 7368
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 7619 7623 7676 7679
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 2046 2631 2651 4122 5633 5635 6549
                                           6557
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0C57H   R   SEG=MAIN   2090 2102#
QUES . . . . . . .  C ADDR   12C9H   R   SEG=MAIN   3063# 3068
QU_AVP . . . . . .  C ADDR   0716H   R   SEG=MAIN   1272 1274#
R10. . . . . . . .  N NUMB   000AH   A      439# 642 1099 1359 1367 3863 5280 7642
R11. . . . . . . .  N NUMB   000BH   A      440# 643 1100 1360 1366 5284 7646
R8 . . . . . . . .  N NUMB   0008H   A      437# 506 1357 1369 3713 3859 4794 5272 7634
R9 . . . . . . . .  N NUMB   0009H   A      438# 1358 1368 3861 4795 5276 7638
RAFTERK. . . . . .  C ADDR   05D9H   R   SEG=MAIN   1107# 1113
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RDDOUTF. . . . . .  C ADDR   130DH   R   SEG=MAIN   3105# 3109
RE1. . . . . . . .  C ADDR   1DF7H   R   SEG=MAIN   4774# 4780
RE11_7 . . . . . .  C ADDR   067EH   R   SEG=MAIN   1207# 1230 1241
RE4BYTE. . . . . .  C ADDR   0454H   A      505 3712 3857 7630#
REA3_X . . . . . .  C ADDR   24E6H   R   SEG=MAIN   3543 5852#
REACP. . . . . . .  D ADDR   0077H   A      304# 624 626 628 630 670 686 694 702 711 718 733 768 785 801 817 1955
                                           1957 1959 1961 1993 1995 1997 1999
READ . . . . . . .  C ADDR   1DF5H   R   SEG=MAIN   623 625 627 4773#
READYACP . . . . .  C ADDR   02D1H   R   SEG=MAIN   712 722#
READ_X2. . . . . .  C ADDR   1DDDH   R   SEG=MAIN   4748# 4759
REBYTE . . . . . .  C ADDR   0226H   R   SEG=MAIN   608# 653 759 1919 1929 1948 1986 2021 2030 2032
REBYTE2. . . . . .  C ADDR   046CH   A      1199 1207 1222 1233 1249 7650#
REF0CN . . . . . .  D ADDR   00D1H   A      92# 460
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RENDKALIB. . . . .  C ADDR   1079H   R   SEG=MAIN   2752# 2754
RESAR2 . . . . . .  C ADDR   243EH   R   SEG=MAIN   734 769 786 802 818 830 866 948 1004 1125 1168 1257 1278 1339
                                           1362 1385 1538 1592 1806 1876 1909 2781 4175 4183 4202 4294 4306 4321 4401
                                           4459 4475 4489 4552 4610 4625 5389 5409 5702# 5836
RESAR8 . . . . . .  C ADDR   23FCH   R   SEG=MAIN   1081 1131 1171 1179 1283 1968 2006 5641#
RESA_HL. . . . . .  C ADDR   24CAH   R   SEG=MAIN   1826 4239 4377 4527 5826#
REZAM. . . . . . .  D ADDR   008CH   A      369# 2003
REZAP. . . . . . .  D ADDR   0088H   A      368# 1965
REZMUL . . . . . .  C ADDR   062EH   R   SEG=MAIN   1145 1159 1166#
REZ_A. . . . . . .  D ADDR   0062H   A      358# 747 819 829 865 947 1003 1908
REZ_A0 . . . . . .  D ADDR   006AH   A      360# 1130 1282 1329 1519 2136 2773 2782 2789
REZ_A1 . . . . . .  D ADDR   0066H   A      359# 1062 1128 1167 1262 1277 1305
REZ_A2 . . . . . .  D ADDR   007BH   A      361# 1279
REZ_A3 . . . . . .  D ADDR   009CH   A      375# 1133 1285 1338 1537 1591 1716 2780 4174 5835 5866
REZ_AK . . . . . .  D ADDR   00A4H   A      378# 3978 4182
REZ_AME. . . . . .  D ADDR   005EH   A      356# 1074 1083 1124 1181 1256
REZ_DEL. . . . . .  D ADDR   00C5H   A      393# 749
REZ_R. . . . . . .  D ADDR   00C9H   A      394# 1371 1384
RGOTO7 . . . . . .  C ADDR   147EH   R   SEG=MAIN   3339# 3373 3409
RHNOR11. . . . . .  C ADDR   111DH   R   SEG=MAIN   2821 2833 2839#
RHNOT1 . . . . . .  C ADDR   10E4H   R   SEG=MAIN   2796 2805#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RI21_23. . . . . .  C ADDR   0E4DH   R   SEG=MAIN   2407 2419#
RI6. . . . . . . .  C ADDR   0E47H   R   SEG=MAIN   2410 2415# 2424 2449 2453
RIGBLO . . . . . .  C ADDR   0F1DH   R   SEG=MAIN   2529# 2560 2562
RIGBLOK. . . . . .  C ADDR   0F5BH   R   SEG=MAIN   2573#
RIGHT2 . . . . . .  C ADDR   0C72H   R   SEG=MAIN   2113 2117#
RIGHT3 . . . . . .  C ADDR   0C76H   R   SEG=MAIN   2115 2120#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   137

RIKN . . . . . . .  C ADDR   0DD2H   R   SEG=MAIN   2330# 2348
RIZMAN . . . . . .  C ADDR   0BDFH   R   SEG=MAIN   2041# 2076
RI_31. . . . . . .  C ADDR   0E67H   R   SEG=MAIN   2422 2431#
RKNLEFT. . . . . .  C ADDR   0FC5H   R   SEG=MAIN   2647# 2690
RKNMEM . . . . . .  C ADDR   0FB6H   R   SEG=MAIN   2642# 2696
RKNNUL . . . . . .  C ADDR   0FC2H   R   SEG=MAIN   2646# 2684
RKNOPT . . . . . .  C ADDR   0BDCH   R   SEG=MAIN   2040# 2087
RKNRAZR. . . . . .  C ADDR   0BD9H   R   SEG=MAIN   2039# 2081
RKVVOD0. . . . . .  C ADDR   125DH   R   SEG=MAIN   3010 3017#
RLABELF. . . . . .  C ADDR   0BD6H   R   SEG=MAIN   2038# 2073
RLABELH. . . . . .  C ADDR   0FBFH   R   SEG=MAIN   2645# 2681
RLABELI. . . . . .  C ADDR   10EAH   R   SEG=MAIN   2808#
RLABELK. . . . . .  C ADDR   10E7H   R   SEG=MAIN   2807# 2810
RLABELL. . . . . .  C ADDR   0E29H   R   SEG=MAIN   2399#
RLABELL1 . . . . .  C ADDR   0F90H   R   SEG=MAIN   2612 2615#
RLABELN. . . . . .  C ADDR   0E97H   R   SEG=MAIN   2451 2455#
RLABELP. . . . . .  C ADDR   170BH   R   SEG=MAIN   3686# 3689
RLABELS13. . . . .  C ADDR   1816H   R   SEG=MAIN   3825# 3829
RLABELS4 . . . . .  C ADDR   1813H   R   SEG=MAIN   3824# 3827
RLABL2 . . . . . .  C ADDR   12C3H   R   SEG=MAIN   3061#
RLABM. . . . . . .  C ADDR   12C6H   R   SEG=MAIN   3062# 3066
RLEFCUR. . . . . .  C ADDR   150FH   R   SEG=MAIN   3423# 3427
RLER . . . . . . .  C ADDR   2140H   R   SEG=MAIN   5372 5374#
RLIST_43 . . . . .  C ADDR   159DH   R   SEG=MAIN   3494# 3496
RMAS4. . . . . . .  C ADDR   0422H   R   SEG=MAIN   891# 893
RME21_23 . . . . .  C ADDR   156DH   R   SEG=MAIN   3452 3471#
RMO220 . . . . . .  C ADDR   0613H   R   SEG=MAIN   1147# 1192
RNNMEMB. . . . . .  C ADDR   0E9DH   R   SEG=MAIN   2458# 2461
RNO3PARN . . . . .  C ADDR   0965H   R   SEG=MAIN   1637# 1651
RNOCHI0. . . . . .  C ADDR   073EH   R   SEG=MAIN   1291 1304#
RNOH37 . . . . . .  C ADDR   113AH   R   SEG=MAIN   2855# 2859 2866 2880
RNOMEMK. . . . . .  C ADDR   121DH   R   SEG=MAIN   2986# 3003
RNORVICH . . . . .  C ADDR   0963H   R   SEG=MAIN   1580 1581 1636#
RNOT1IN. . . . . .  C ADDR   0A3AH   R   SEG=MAIN   1713 1783#
ROUT6. . . . . . .  C ADDR   0BD3H   R   SEG=MAIN   2037# 2072
ROUT7. . . . . . .  C ADDR   0FBCH   R   SEG=MAIN   2644# 2675 2680
ROUTF. . . . . . .  C ADDR   1137H   R   SEG=MAIN   2851# 2925
RR0. . . . . . . .  N NUMB   0000H   A      430# 2047 2630 2652 4121
RR1. . . . . . . .  N NUMB   0001H   A      431# 2048 2629 2653 4120
RR2. . . . . . . .  N NUMB   0002H   A      433# 1201 1213 1224 1235 2049 2628 2654 3522 3530 4119 4807
RR3. . . . . . . .  N NUMB   0003H   A      434# 1202 1212 1225 1236 2050 2627 2655 3523 3529 4118 4808
RR4. . . . . . . .  N NUMB   0004H   A      1203 1211 1226 1237 2051 2626 2656 3524 3528 4117 5878# 5935 5956 5972
                                           6016 6038
RR5. . . . . . . .  N NUMB   0005H   A      1204 1210 1227 1238 2052 2625 2657 3525 3527 4116 5879# 5936 5943 5950
                                           6017 6026
RR6. . . . . . . .  N NUMB   0006H   A      432# 2053 2624 2658 4115
RR7. . . . . . . .  N NUMB   0007H   A      435# 2054 2623 2659 4114
RRIR . . . . . . .  C ADDR   214DH   R   SEG=MAIN   5383 5385#
RRMO220. . . . . .  C ADDR   073BH   R   SEG=MAIN   1268 1303#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   08FFH   R   SEG=MAIN   1564# 1582 1584 1585
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 490 2749
RTIZMRI. . . . . .  C ADDR   0D3FH   R   SEG=MAIN   2259#
RVVIZKO. . . . . .  C ADDR   111FH   R   SEG=MAIN   2841# 2846
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2064 2343 2361 2543 2587 2607 2671 3228 3280 3356 3935 4041 5448
                                           5456
SAVEIR2. . . . . .  C ADDR   2380H   R   SEG=MAIN   832 869 951 1007 5541#
SAVELTE. . . . . .  C ADDR   04A7H   A      7713#
SAVEN_BL . . . . .  D ADDR   00D3H   A      397# 5807 5826
SAVER2 . . . . . .  C ADDR   238CH   R   SEG=MAIN   570 572 574 576 738 748 750 773 790 806 820 1063 1075 1084 1129
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   138

                                           1134 1182 1263 1280 1286 1306 1372 1376 1596 1811 1849 1914 1966 1978 2004
                                           2016 2783 2790 3553 3979 4071 4102 4192 4297 4309 4329 4404 4469 4485 4500
                                           4555 4620 4635 5392 5419 5555# 5867
SAVE_HL. . . . . .  C ADDR   24B3H   R   SEG=MAIN   1829 3397 5807#
SBUF0. . . . . . .  D ADDR   0099H   A      40# 4649 4655
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160 498 4650 4654 4657 4658 4679
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   1D9FH   R   SEG=MAIN   4707# 4714
SDV1 . . . . . . .  C ADDR   1DB3H   R   SEG=MAIN   4719# 4725
SDVIG0 . . . . . .  C ADDR   02B2H   R   SEG=MAIN   698# 700
SDVIG1 . . . . . .  C ADDR   02A7H   R   SEG=MAIN   690# 692
SDVIG2 . . . . . .  C ADDR   029CH   R   SEG=MAIN   682# 684
SDVIG3 . . . . . .  C ADDR   0290H   R   SEG=MAIN   673# 675
SDVIG4 . . . . . .  C ADDR   02C1H   R   SEG=MAIN   708# 710
SDVIG6 . . . . . .  C ADDR   02CBH   R   SEG=MAIN   715# 717
SDVM . . . . . . .  C ADDR   02C9H   R   SEG=MAIN   705 714#
SEEGOON. . . . . .  C ADDR   096AH   R   SEG=MAIN   1626 1634 1641#
SEEIND . . . . . .  C ADDR   0978H   R   SEG=MAIN   1556 1563 1564 1653#
SEE_L43. . . . . .  C ADDR   165DH   R   SEG=MAIN   3581 3589 3592#
SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      6809# 6830 6831 6856 6857 6881 7024 7041 7262 7302
SKOR19 . . . . . .  C ADDR   1750H   R   SEG=MAIN   3714 3720#
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   11A7H   R   SEG=MAIN   2920# 2935
SP . . . . . . . .  D ADDR   0081H   A      17# 451
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 496
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 495
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 4696
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SPWRI. . . . . . .  C ADDR   17EEH   R   SEG=MAIN   3803 3805#
SS1. . . . . . . .  C ADDR   1ECFH   R   SEG=MAIN   4953# 4955
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      387# 735 737 752 770 772 787 789 803 805 1327 1517 2134 2771
SUMT2. . . . . . .  C ADDR   031DH   R   SEG=MAIN   726 767#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   2061H   R   SEG=MAIN   5223# 5233
TABN . . . . . . .  C ADDR   20F9H   R   SEG=MAIN   5325# 5329
TABT11 . . . . . .  C ADDR   1E8DH   R   SEG=MAIN   4892# 5305
TABT7. . . . . . .  C ADDR   1E91H   R   SEG=MAIN   4896# 5318
TABT9. . . . . . .  C ADDR   1E8FH   R   SEG=MAIN   4894# 5315
TABUS. . . . . . .  C ADDR   1E79H   R   SEG=MAIN   4828 4881#
TAKTIND. . . . . .  C ADDR   09B8H   R   SEG=MAIN   1685 1688#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 487 488 502
TE22 . . . . . . .  C ADDR   20ECH   R   SEG=MAIN   5304 5314#
TE23 . . . . . . .  C ADDR   20F4H   R   SEG=MAIN   5314 5318#
TEAEQU0. . . . . .  C ADDR   220EH   R   SEG=MAIN   2893 5479#
TEAVK. . . . . . .  C ADDR   224AH   R   SEG=MAIN   4149 5486#
TEBEQU0. . . . . .  C ADDR   2218H   R   SEG=MAIN   5480#
TEBL . . . . . . .  C ADDR   22FEH   R   SEG=MAIN   2503 3054 5508#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   139

TEBL0. . . . . . .  C ADDR   2308H   R   SEG=MAIN   3247 5509#
TECH . . . . . . .  C ADDR   2312H   R   SEG=MAIN   3483 3637 5510#
TECLE. . . . . . .  C ADDR   22C3H   R   SEG=MAIN   2495 2974 3022 5502#
TEEND. . . . . . .  C ADDR   2362H   R   SEG=MAIN   4229 5519#
TEERR. . . . . . .  C ADDR   2358H   R   SEG=MAIN   5463 5518#
TEFULL . . . . . .  C ADDR   22EAH   R   SEG=MAIN   2509 3214 5506#
TEINT. . . . . . .  C ADDR   22F4H   R   SEG=MAIN   3311 5507#
TEIZMK . . . . . .  C ADDR   22A5H   R   SEG=MAIN   2301 2835 5499#
TEKALIB. . . . . .  C ADDR   2254H   R   SEG=MAIN   3459 4152 5487#
TEKD . . . . . . .  C ADDR   229BH   R   SEG=MAIN   3868 5498#
TELIST . . . . . .  C ADDR   22DFH   R   SEG=MAIN   2478 3033 3039 5505#
TEMAX. . . . . . .  C ADDR   2330H   R   SEG=MAIN   3673 5513#
TEMEM. . . . . . .  C ADDR   22CDH   R   SEG=MAIN   5503#
TEMENU . . . . . .  C ADDR   2222H   R   SEG=MAIN   5481#
TEMID. . . . . . .  C ADDR   233AH   R   SEG=MAIN   3681 5514#
TEMIN. . . . . . .  C ADDR   2326H   R   SEG=MAIN   3256 5512#
TEMUL. . . . . . .  C ADDR   06EDH   R   SEG=MAIN   1218 1255#
TENMIN . . . . . .  C ADDR   1F65H   R   SEG=MAIN   1142 1144 1158 5015#
TEOLI. . . . . . .  C ADDR   2344H   R   SEG=MAIN   1410 5516#
TEOLL. . . . . . .  C ADDR   22B9H   R   SEG=MAIN   1503 5501#
TEOLR. . . . . . .  C ADDR   234EH   R   SEG=MAIN   1406 5517#
TEOUT. . . . . . .  C ADDR   22AFH   R   SEG=MAIN   2309 2390 2826 5500#
TEPAR. . . . . . .  C ADDR   2291H   R   SEG=MAIN   4169 5497#
TES19_2. . . . . .  C ADDR   2287H   R   SEG=MAIN   511 2437 3720 3918 5495#
TES57_6. . . . . .  C ADDR   227DH   R   SEG=MAIN   2433 3715 3914 4165 5494#
TESKOR . . . . . .  C ADDR   2240H   R   SEG=MAIN   4146 5485#
TEST01 . . . . . .  C ADDR   1D3AH   R   SEG=MAIN   4654# 4677
TEST02 . . . . . .  C ADDR   1D69H   R   SEG=MAIN   4674 4676#
TEST04 . . . . . .  C ADDR   1D4AH   R   SEG=MAIN   4661# 4663
TEST1. . . . . . .  C ADDR   1D30H   R   SEG=MAIN   4649# 4665 4686
TEST2. . . . . . .  C ADDR   1D62H   R   SEG=MAIN   4654 4673#
TEST22 . . . . . .  C ADDR   17C3H   R   SEG=MAIN   3770 3777#
TEST23 . . . . . .  C ADDR   17C8H   R   SEG=MAIN   3777 3780#
TEST3. . . . . . .  C ADDR   1D54H   R   SEG=MAIN   4656 4666#
TEST4. . . . . . .  C ADDR   1D42H   R   SEG=MAIN   4657# 4672
TEST5. . . . . . .  C ADDR   1D6CH   R   SEG=MAIN   4675 4678#
TEST7I . . . . . .  C ADDR   09D0H   R   SEG=MAIN   1698 1701#
TEST9I . . . . . .  C ADDR   09C9H   R   SEG=MAIN   1693 1698#
TESTAT . . . . . .  C ADDR   231CH   R   SEG=MAIN   2486 3013 5511#
TESTRS . . . . . .  C ADDR   1D2EH   R   SEG=MAIN   3704 4647#
TESTS. . . . . . .  C ADDR   17B7H   R   SEG=MAIN   3772# 3779 3782
TETE11 . . . . . .  C ADDR   225FH   R   SEG=MAIN   3694 4156 5489#
TETE7. . . . . . .  C ADDR   2273H   R   SEG=MAIN   3759 4162 5491#
TETE9. . . . . . .  C ADDR   2269H   R   SEG=MAIN   4159 5490#
TETESI . . . . . .  C ADDR   222CH   R   SEG=MAIN   2737 4139 5483#
TETESR . . . . . .  C ADDR   2236H   R   SEG=MAIN   4143 5484#
TEVICH . . . . . .  C ADDR   2204H   R   SEG=MAIN   2148 2317 2831 4076 5478#
TEWR . . . . . . .  C ADDR   22D5H   R   SEG=MAIN   2469 3028 5504#
TEXTT. . . . . . .  C ADDR   21C8H   R   SEG=MAIN   4908 5469#
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 470
TH1. . . . . . . .  D ADDR   008DH   A      29# 509 513 3817 3819
TH2. . . . . . . .  D ADDR   00CDH   A      89#
TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   1DC3H   R   SEG=MAIN   4728#
TIM1 . . . . . . .  C ADDR   1DC5H   R   SEG=MAIN   4729# 4729
TIM2 . . . . . . .  C ADDR   1DC8H   R   SEG=MAIN   4710 4713 4720 4724 4732# 4775 4779 5728 5730
TIM3 . . . . . . .  C ADDR   1DCAH   R   SEG=MAIN   4733# 4733
TIZMRI . . . . . .  C ADDR   0C6BH   R   SEG=MAIN   2112# 2259
TL0. . . . . . . .  D ADDR   008AH   A      26# 471
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   140

TLABELI. . . . . .  C ADDR   11A4H   R   SEG=MAIN   2905 2917#
TMOD . . . . . . .  D ADDR   0089H   A      25# 468 501
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 485
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 484
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TOME13 . . . . . .  C ADDR   1734H   R   SEG=MAIN   3702 3707#
TOME14 . . . . . .  C ADDR   175BH   R   SEG=MAIN   3707 3727#
TOME15 . . . . . .  C ADDR   1773H   R   SEG=MAIN   3727 3739#
TOME21 . . . . . .  C ADDR   172BH   R   SEG=MAIN   3692 3702#
TOSK19 . . . . . .  C ADDR   18BDH   R   SEG=MAIN   3913 3918#
TOUTF. . . . . . .  C ADDR   1121H   R   SEG=MAIN   2842# 2845
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 4697
UNPACK1. . . . . .  C ADDR   009EH   A      6827# 7021 7155 7285 7399
UNPACK2. . . . . .  C ADDR   00BAH   A      6852# 7022 7156 7286
UP1. . . . . . . .  C ADDR   0138H   A      6972# 6989
UP2. . . . . . . .  C ADDR   014BH   A      6992# 7010
UP2A . . . . . . .  C ADDR   0161H   A      6971 7008#
UPA. . . . . . . .  C ADDR   1F94H   R   SEG=MAIN   5070# 5076
UPA1 . . . . . . .  C ADDR   1FA4H   R   SEG=MAIN   5088# 5094
UPA2 . . . . . . .  C ADDR   1F84H   R   SEG=MAIN   5051# 5057
UPAA . . . . . . .  C ADDR   248BH   R   SEG=MAIN   5776# 5782
UPAA4. . . . . . .  C ADDR   1FEDH   R   SEG=MAIN   5151# 5157
UPAB . . . . . . .  C ADDR   1FFDH   R   SEG=MAIN   5168# 5174
UPAK . . . . . . .  C ADDR   1F8EH   R   SEG=MAIN   5067#
UPAK1. . . . . . .  C ADDR   2465H   R   SEG=MAIN   5741#
UPAK2. . . . . . .  C ADDR   1F7EH   R   SEG=MAIN   5048#
UPAK3. . . . . . .  C ADDR   1F9EH   R   SEG=MAIN   3415 3507 5085#
UPAK4. . . . . . .  C ADDR   2485H   R   SEG=MAIN   3379 5773#
UPAKA. . . . . . .  C ADDR   1FE7H   R   SEG=MAIN   4063 5148#
UPAKB. . . . . . .  C ADDR   1FF7H   R   SEG=MAIN   4091 5165#
UPAV1. . . . . . .  C ADDR   1835H   R   SEG=MAIN   3848# 3854
UPAV2. . . . . . .  C ADDR   18ECH   R   SEG=MAIN   3962# 3968
UPK1 . . . . . . .  C ADDR   2477H   R   SEG=MAIN   5749 5752#
UPK2 . . . . . . .  C ADDR   2478H   R   SEG=MAIN   5751 5753#
VICHMAX. . . . . .  C ADDR   1C8DH   R   SEG=MAIN   3675 4526#
VICHMEAN . . . . .  C ADDR   1AD1H   R   SEG=MAIN   3683 4238#
VICHMIN. . . . . .  C ADDR   1BB4H   R   SEG=MAIN   3258 4376#
VICHR. . . . . . .  D ADDR   00B1H   A      385# 1195 1691 2145 2154 2283 2296 2403 2411 2740 2744 2820 2884 2990
                                           3448 3456 3465 3687 3736 3750 3866 4054 4106 4137 5303
VIG0 . . . . . . .  C ADDR   0A26H   R   SEG=MAIN   1767# 1769
VIG4 . . . . . . .  C ADDR   0A34H   R   SEG=MAIN   1778# 1780
VIOUT. . . . . . .  C ADDR   0D19H   R   SEG=MAIN   2151 2234#
VODM11_15. . . . .  C ADDR   1532H   R   SEG=MAIN   3440# 3455
VOLUME . . . . . .  D ADDR   00D5H   A      398# 2104 3392 5816 5818
VV21_23. . . . . .  C ADDR   17AEH   R   SEG=MAIN   3756 3768#
VVCHIBL. . . . . .  C ADDR   211BH   R   SEG=MAIN   2384 5345#
VVCHIBL4 . . . . .  C ADDR   211DH   R   SEG=MAIN   5348#
VVCHIF . . . . . .  C ADDR   210BH   R   SEG=MAIN   5334# 5347
VVINTE . . . . . .  C ADDR   14A9H   R   SEG=MAIN   3343 3371#
VVIZKO . . . . . .  C ADDR   1171H   R   SEG=MAIN   2841 2884#
VVKALI52 . . . . .  C ADDR   18DFH   R   SEG=MAIN   3946# 3998
VVMENU . . . . . .  C ADDR   1895H   R   SEG=MAIN   3831 3901#
VVOD43 . . . . . .  C ADDR   168CH   R   SEG=MAIN   3610 3617#
VVODM11_15 . . . .  C ADDR   170EH   R   SEG=MAIN   3440 3687#
VVOSTA . . . . . .  C ADDR   16E9H   R   SEG=MAIN   3652 3671#
VVOSTAD. . . . . .  C ADDR   16FDH   R   SEG=MAIN   3671 3679#
VVRR6. . . . . . .  C ADDR   0D92H   R   SEG=MAIN   2301#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 466 467
A51 MACRO ASSEMBLER  AMP28                                                                02/02/2007 09:09:46 PAGE   141

WORK . . . . . . .  D ADDR   00B8H   A      389# 1391 1393 1399 1415 1422 1438 1459 1464 1480 1718 1796 3083 3093
                                           3095 3114 3124 3126 3131 3141 3143 3149 3159 3161 3166 3176 3178 4246 4293
                                           4296 4305 4308 4320 4382 4400 4403 4458 4468 4474 4484 4488 4533 4551 4554
                                           4609 4619 4624 4634 4651 4673
WR1. . . . . . . .  C ADDR   2452H   R   SEG=MAIN   5724# 5731
WRITE. . . . . . .  C ADDR   244FH   R   SEG=MAIN   621 5194 5196 5198 5200 5202 5204 5207 5209 5211 5214 5216 5218
                                           5722#
WRITED_X1. . . . .  C ADDR   1DCEH   R   SEG=MAIN   4738#
WRITE_X1 . . . . .  C ADDR   1DCDH   R   SEG=MAIN   4737#
WRPAGE . . . . . .  C ADDR   0480H   A      3814 4224 7674#
WW5. . . . . . . .  C ADDR   0483H   A      7675# 7683
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 462 494
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 463
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 464 493
XCIKLWR. . . . . .  C ADDR   236CH   R   SEG=MAIN   827 840 842 844 847 850 853 856 859 862 895 897 899 902 905 908
                                           911 914 917 919 922 924 926 929 932 935 938 941 944 996 998 1000 5524#
XTEMP. . . . . . .  N NUMB   000CH   A      5875# 6239 6240 6241 6242 6328 6330 6331 6333 6334 6336 6337 6339 6361
                                           6362 6363 6364 6382 6383 6387 6388 6391 6395 6396 6399 6403 6404 6408 6409
                                           6411 6412 6413 6415 6419 6420 6422 6423 6427 6428 6433 6434 6436 6437 6441
                                           6442 6447 6449 6450 6451
YBNUL. . . . . . .  C ADDR   10BCH   R   SEG=MAIN   2778 2786#
YES. . . . . . . .  C ADDR   2686H   R   SEG=MAIN   6261 6265 6269 6273 6291# 6354
YESAVP . . . . . .  C ADDR   0748H   R   SEG=MAIN   1274 1309#
YESBUF . . . . . .  C ADDR   0A7DH   R   SEG=MAIN   1820 1825#
YESIND . . . . . .  C ADDR   09D2H   R   SEG=MAIN   1690 1697 1700 1704#
YESPRD . . . . . .  C ADDR   0A7BH   R   SEG=MAIN   1819 1823#
YESTEST. . . . . .  C ADDR   1E68H   R   SEG=MAIN   4823 4855#
YESTT5 . . . . . .  C ADDR   0ACEH   R   SEG=MAIN   1865 1873#
YESVICH. . . . . .  C ADDR   0777H   R   SEG=MAIN   1288 1334#
YST1 . . . . . . .  C ADDR   0190H   R   SEG=MAIN   510 514#
YST19. . . . . . .  C ADDR   0188H   R   SEG=MAIN   507 511#
Z01S . . . . . . .  C ADDR   1EE7H   R   SEG=MAIN   4970# 4972
Z05S . . . . . . .  C ADDR   1EF4H   R   SEG=MAIN   4979# 4981
Z100 . . . . . . .  C ADDR   1EB8H   R   SEG=MAIN   4934# 4936
Z15. . . . . . . .  C ADDR   1EC6H   R   SEG=MAIN   4946# 4948
Z1S. . . . . . . .  C ADDR   1EDAH   R   SEG=MAIN   4962# 4964
ZAPADC . . . . . .  C ADDR   1D9DH   R   SEG=MAIN   4706#
ZCMP . . . . . . .  C ADDR   23EEH   R   SEG=MAIN   5631#
ZDIV . . . . . . .  C ADDR   23BBH   R   SEG=MAIN   746 1055 1541 3546 5594#
ZER1 . . . . . . .  C ADDR   00B3H   A      6837 6841# 6896 6939
ZER2 . . . . . . .  C ADDR   00D4H   A      6863 6867#
ZMUL . . . . . . .  C ADDR   23B1H   R   SEG=MAIN   5589#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      317# 1616 3571 4347 4518 5602 5605 5608
ZNPLUS . . . . . .  C ADDR   0283H   R   SEG=MAIN   632 662#
ZZ . . . . . . . .  C ADDR   1EC8H   R   SEG=MAIN   4947# 4947
Z_01S. . . . . . .  C ADDR   1EE3H   R   SEG=MAIN   657 658 659 2057 2664 4671 4685 4968# 5460
Z_05S. . . . . . .  C ADDR   1EF0H   R   SEG=MAIN   1867 1868 2505 4977#
Z_100. . . . . . .  C ADDR   1EB6H   R   SEG=MAIN   4933#
Z_15 . . . . . . .  C ADDR   1EC4H   R   SEG=MAIN   600 4945#
Z_1MS. . . . . . .  C ADDR   1ECDH   R   SEG=MAIN   4678 4952#
Z_1S . . . . . . .  C ADDR   1ED6H   R   SEG=MAIN   589 597 2150 3259 3490 3599 3650 3676 3906 3990 4232 4233 4960#
Z_5. . . . . . . .  C ADDR   1EBFH   R   SEG=MAIN   4742 4752 4940#
Z_9. . . . . . . .  C ADDR   244AH   R   SEG=MAIN   4699 5716#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
