A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     1


MACRO ASSEMBLER A51 V6.14a
NO OBJECT MODULE REQUESTED
ASSEMBLER INVOKED BY: D:\PROGRAM FILES\CYGNAL\IDEFILES\C51\BIN\A51.EXE Amp21.asm XR GEN DB EP NOMOD51

LOC  OBJ            LINE     SOURCE

                       1        ;$include (c8051f020.inc) ; Include register definition file.
                +1     2     ;-----------------------------------------------------------------------------
                +1     3     ;       Copyright (C) 2001 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ;       All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ;       FILE NAME       : C8051F020.INC 
                +1     8     ;       TARGET MCUs     : C8051F020, 'F021, 'F022, 'F023 
                +1     9     ;       DESCRIPTION     : Register/bit definitions for the C8051F02x product family.  
                +1    10     ;
                +1    11     ;       REVISION 1.0    
                +1    12     ;
                +1    13     ;-----------------------------------------------------------------------------
                +1    14     ;REGISTER DEFINITIONS
                +1    15     ;
  0080          +1    16     P0       DATA  080H   ; PORT 0
  0081          +1    17     SP       DATA  081H   ; STACK POINTER
  0082          +1    18     DPL      DATA  082H   ; DATA POINTER - LOW BYTE
  0083          +1    19     DPH      DATA  083H   ; DATA POINTER - HIGH BYTE
  0084          +1    20     P4       DATA  084H   ; PORT 4
  0085          +1    21     P5       DATA  085H   ; PORT 5
  0086          +1    22     P6       DATA  086H   ; PORT 6
  0087          +1    23     PCON     DATA  087H   ; POWER CONTROL
  0088          +1    24     TCON     DATA  088H   ; TIMER CONTROL
  0089          +1    25     TMOD     DATA  089H   ; TIMER MODE
  008A          +1    26     TL0      DATA  08AH   ; TIMER 0 - LOW BYTE
  008B          +1    27     TL1      DATA  08BH   ; TIMER 1 - LOW BYTE
  008C          +1    28     TH0      DATA  08CH   ; TIMER 0 - HIGH BYTE
  008D          +1    29     TH1      DATA  08DH   ; TIMER 1 - HIGH BYTE
  008E          +1    30     CKCON    DATA  08EH   ; CLOCK CONTROL
  008F          +1    31     PSCTL    DATA  08FH   ; PROGRAM STORE R/W CONTROL
  0090          +1    32     P1       DATA  090H   ; PORT 1
  0091          +1    33     TMR3CN   DATA  091H   ; TIMER 3 CONTROL
  0092          +1    34     TMR3RLL  DATA  092H   ; TIMER 3 RELOAD REGISTER - LOW BYTE
  0093          +1    35     TMR3RLH  DATA  093H   ; TIMER 3 RELOAD REGISTER - HIGH BYTE
  0094          +1    36     TMR3L    DATA  094H   ; TIMER 3 - LOW BYTE
  0095          +1    37     TMR3H    DATA  095H   ; TIMER 3 - HIGH BYTE
  0096          +1    38     P7       DATA  096H   ; PORT 7
  0098          +1    39     SCON0    DATA  098H   ; SERIAL PORT 0 CONTROL
  0099          +1    40     SBUF0    DATA  099H   ; SERIAL PORT 0 BUFFER
  009A          +1    41     SPI0CFG  DATA  09AH   ; SERIAL PERIPHERAL INTERFACE 0 CONFIGURATION
  009B          +1    42     SPI0DAT  DATA  09BH   ; SERIAL PERIPHERAL INTERFACE 0 DATA
  009C          +1    43     ADC1     DATA  09CH   ; ADC 1 DATA
  009D          +1    44     SPI0CKR  DATA  09DH   ; SERIAL PERIPHERAL INTERFACE 0 CLOCK RATE CONTROL
  009E          +1    45     CPT0CN   DATA  09EH   ; COMPARATOR 0 CONTROL
  009F          +1    46     CPT1CN   DATA  09FH   ; COMPARATOR 1 CONTROL 
  00A0          +1    47     P2       DATA  0A0H   ; PORT 2
  00A1          +1    48     EMI0TC   DATA  0A1H   ; EMIF TIMING CONTROL
  00A3          +1    49     EMI0CF   DATA  0A3H   ; EXTERNAL MEMORY INTERFACE (EMIF) CONFIGURATION
  00A4          +1    50     P0MDOUT  DATA  0A4H   ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    51     P1MDOUT  DATA  0A5H   ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    52     P2MDOUT  DATA  0A6H   ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    53     P3MDOUT  DATA  0A7H   ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    54     IE       DATA  0A8H   ; INTERRUPT ENABLE
  00A9          +1    55     SADDR0   DATA  0A9H   ; SERIAL PORT 0 SLAVE ADDRESS
  00AA          +1    56     ADC1CN  DATA  0AAH   ; ADC 1 CONTROL
  00AB          +1    57     ADC1CF   DATA  0ABH   ; ADC 1 ANALOG MUX CONFIGURATION
  00AC          +1    58     AMX1SL   DATA  0ACH   ; ADC 1 ANALOG MUX CHANNEL SELECT
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     2

  00AD          +1    59     P3IF     DATA  0ADH   ; PORT 3 EXTERNAL INTERRUPT FLAGS
  00AE          +1    60     SADEN1   DATA  0AEH   ; SERIAL PORT 1 SLAVE ADDRESS MASK
  00AF          +1    61     EMI0CN   DATA  0AFH   ; EXTERNAL MEMORY INTERFACE CONTROL
  00B0          +1    62     P3       DATA  0B0H   ; PORT 3
  00B1          +1    63     OSCXCN   DATA  0B1H   ; EXTERNAL OSCILLATOR CONTROL
  00B2          +1    64     OSCICN   DATA  0B2H   ; INTERNAL OSCILLATOR CONTROL
  00B5          +1    65     P74OUT   DATA  0B5H   ; PORTS 4 - 7 OUTPUT MODE
  00B6          +1    66     FLSCL    DATA  0B6H   ; FLASH MEMORY TIMING PRESCALER
  00B7          +1    67     FLACL    DATA  0B7H   ; FLASH ACESS LIMIT 
  00B8          +1    68     IP       DATA  0B8H   ; INTERRUPT PRIORITY
  00B9          +1    69     SADEN0   DATA  0B9H   ; SERIAL PORT 0 SLAVE ADDRESS MASK
  00BA          +1    70     AMX0CF   DATA  0BAH   ; ADC 0 MUX CONFIGURATION
  00BB          +1    71     AMX0SL   DATA  0BBH   ; ADC 0 MUX CHANNEL SELECTION
  00BC          +1    72     ADC0CF   DATA  0BCH   ; ADC 0 CONFIGURATION
  00BD          +1    73     P1MDIN   DATA  0BDH   ; PORT 1 INPUT MODE
  00BE          +1    74     ADC0L    DATA  0BEH   ; ADC 0 DATA - LOW BYTE
  00BF          +1    75     ADC0H    DATA  0BFH   ; ADC 0 DATA - HIGH BYTE 
  00C0          +1    76     SMB0CN   DATA  0C0H   ; SMBUS 0 CONTROL
  00C1          +1    77     SMB0STA  DATA  0C1H   ; SMBUS 0 STATUS
  00C2          +1    78     SMB0DAT  DATA  0C2H   ; SMBUS 0 DATA 
  00C3          +1    79     SMB0ADR  DATA  0C3H   ; SMBUS 0 SLAVE ADDRESS
  00C4          +1    80     ADC0GTL  DATA  0C4H   ; ADC 0 GREATER-THAN REGISTER - LOW BYTE
  00C5          +1    81     ADC0GTH  DATA  0C5H   ; ADC 0 GREATER-THAN REGISTER - HIGH BYTE
  00C6          +1    82     ADC0LTL  DATA  0C6H   ; ADC 0 LESS-THAN REGISTER - LOW BYTE
  00C7          +1    83     ADC0LTH  DATA  0C7H   ; ADC 0 LESS-THAN REGISTER - HIGH BYTE
  00C8          +1    84     T2CON    DATA  0C8H   ; TIMER 2 CONTROL
  00C9          +1    85     T4CON    DATA  0C9H   ; TIMER 4 CONTROL
  00CA          +1    86     RCAP2L   DATA  0CAH   ; TIMER 2 CAPTURE REGISTER - LOW BYTE
  00CB          +1    87     RCAP2H   DATA  0CBH   ; TIMER 2 CAPTURE REGISTER - HIGH BYTE
  00CC          +1    88     TL2      DATA  0CCH   ; TIMER 2 - LOW BYTE
  00CD          +1    89     TH2      DATA  0CDH   ; TIMER 2 - HIGH BYTE
  00CF          +1    90     SMB0CR   DATA  0CFH   ; SMBUS 0 CLOCK RATE
  00D0          +1    91     PSW      DATA  0D0H   ; PROGRAM STATUS WORD
  00D1          +1    92     REF0CN   DATA  0D1H   ; VOLTAGE REFERENCE 0 CONTROL
  00D2          +1    93     DAC0L    DATA  0D2H   ; DAC 0 REGISTER - LOW BYTE
  00D3          +1    94     DAC0H    DATA  0D3H   ; DAC 0 REGISTER - HIGH BYTE
  00D4          +1    95     DAC0CN   DATA  0D4H   ; DAC 0 CONTROL
  00D5          +1    96     DAC1L    DATA  0D5H   ; DAC 1 REGISTER - LOW BYTE
  00D6          +1    97     DAC1H    DATA  0D6H   ; DAC 1 REGISTER - HIGH BYTE
  00D7          +1    98     DAC1CN   DATA  0D7H   ; DAC 1 CONTROL
  00D8          +1    99     PCA0CN   DATA  0D8H   ; PCA 0 COUNTER CONTROL
  00D9          +1   100     PCA0MD   DATA  0D9H   ; PCA 0 COUNTER MODE
  00DA          +1   101     PCA0CPM0 DATA  0DAH   ; CONTROL REGISTER FOR PCA 0 MODULE 0
  00DB          +1   102     PCA0CPM1 DATA  0DBH   ; CONTROL REGISTER FOR PCA 0 MODULE 1
  00DC          +1   103     PCA0CPM2 DATA  0DCH   ; CONTROL REGISTER FOR PCA 0 MODULE 2
  00DD          +1   104     PCA0CPM3 DATA  0DDH   ; CONTROL REGISTER FOR PCA 0 MODULE 3
  00DE          +1   105     PCA0CPM4 DATA  0DEH   ; CONTROL REGISTER FOR PCA 0 MODULE 4
  00E0          +1   106     ACC      DATA  0E0H   ; ACCUMULATOR
  00E1          +1   107     XBR0     DATA  0E1H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0
  00E2          +1   108     XBR1     DATA  0E2H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1
  00E3          +1   109     XBR2     DATA  0E3H   ; DIGITAL CROSSBAR CONFIGURATION REGISTER 2
  00E4          +1   110     RCAP4L   DATA  0E4H   ; TIMER 4 CAPTURE REGISTER - LOW BYTE
  00E5          +1   111     RCAP4H   DATA  0E5H   ; TIMER 4 CAPTURE REGISTER - HIGH BYTE
  00E6          +1   112     EIE1     DATA  0E6H   ; EXTERNAL INTERRUPT ENABLE 1
  00E7          +1   113     EIE2     DATA  0E7H   ; EXTERNAL INTERRUPT ENABLE 2
  00E8          +1   114     ADC0CN   DATA  0E8H   ; ADC 0 CONTROL
  00E9          +1   115     PCA0L    DATA  0E9H   ; PCA 0 TIMER - LOW BYTE
  00EA          +1   116     PCA0CPL0 DATA  0EAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - LOW BYTE
  00EB          +1   117     PCA0CPL1 DATA  0EBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - LOW BYTE
  00EC          +1   118     PCA0CPL2 DATA  0ECH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - LOW BYTE
  00ED          +1   119     PCA0CPL3 DATA  0EDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - LOW BYTE
  00EE          +1   120     PCA0CPL4 DATA  0EEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - LOW BYTE
  00EF          +1   121     RSTSRC   DATA  0EFH   ; RESET SOURCE 
  00F0          +1   122     B        DATA  0F0H   ; B REGISTER
  00F1          +1   123     SCON1    DATA  0F1H   ; SERIAL PORT 1 CONTROL
  00F2          +1   124     SBUF1    DATA  0F2H   ; SERAIL PORT 1 DATA
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     3

  00F3          +1   125     SADDR1   DATA  0F3H   ; SERAIL PORT 1 
  00F4          +1   126     TL4      DATA  0F4H   ; TIMER 4 DATA - LOW BYTE
  00F5          +1   127     TH4      DATA  0F5H   ; TIMER 4 DATA - HIGH BYTE
  00F6          +1   128     EIP1     DATA  0F6H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 1
  00F7          +1   129     EIP2     DATA  0F7H   ; EXTERNAL INTERRUPT PRIORITY REGISTER 2
  00F8          +1   130     SPI0CN   DATA  0F8H   ; SERIAL PERIPHERAL INTERFACE 0 CONTROL 
  00F9          +1   131     PCA0H    DATA  0F9H   ; PCA 0 TIMER - HIGH BYTE
  00FA          +1   132     PCA0CPH0 DATA  0FAH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 0 - HIGH BYTE
  00FB          +1   133     PCA0CPH1 DATA  0FBH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 1 - HIGH BYTE
  00FC          +1   134     PCA0CPH2 DATA  0FCH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 2 - HIGH BYTE
  00FD          +1   135     PCA0CPH3 DATA  0FDH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 3 - HIGH BYTE
  00FE          +1   136     PCA0CPH4 DATA  0FEH   ; CAPTURE/COMPARE REGISTER FOR PCA 0 MODULE 4 - HIGH BYTE
  00FF          +1   137     WDTCN    DATA  0FFH   ; WATCHDOG TIMER CONTROL 
                +1   138     ;
                +1   139     ;------------------------------------------------------------------------------
                +1   140     ;BIT DEFINITIONS
                +1   141     ;
                +1   142     ; TCON 88H
  0088          +1   143     IT0      BIT   TCON.0 ; EXT. INTERRUPT 0 TYPE
  0089          +1   144     IE0      BIT   TCON.1 ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   145     IT1      BIT   TCON.2 ; EXT. INTERRUPT 1 TYPE
  008B          +1   146     IE1      BIT   TCON.3 ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   147     TR0      BIT   TCON.4 ; TIMER 0 ON/OFF CONTROL
  008D          +1   148     TF0      BIT   TCON.5 ; TIMER 0 OVERFLOW FLAG
  008E          +1   149     TR1      BIT   TCON.6 ; TIMER 1 ON/OFF CONTROL
  008F          +1   150     TF1      BIT   TCON.7 ; TIMER 1 OVERFLOW FLAG
                +1   151     ;
                +1   152     ; SCON0 98H
  0098          +1   153     RI       BIT   SCON0.0 ; RECEIVE INTERRUPT FLAG
  0099          +1   154     TI       BIT   SCON0.1 ; TRANSMIT INTERRUPT FLAG
  009A          +1   155     RB8      BIT   SCON0.2 ; RECEIVE BIT 8
  009B          +1   156     TB8      BIT   SCON0.3 ; TRANSMIT BIT 8
  009C          +1   157     REN      BIT   SCON0.4 ; RECEIVE ENABLE
  009D          +1   158     SM2      BIT   SCON0.5 ; MULTIPROCESSOR COMMUNICATION ENABLE
  009E          +1   159     SM1      BIT   SCON0.6 ; SERIAL MODE CONTROL BIT 1
  009F          +1   160     SM0      BIT   SCON0.7 ; SERIAL MODE CONTROL BIT 0
                +1   161     ; 
                +1   162     ; IE A8H
  00A8          +1   163     EX0      BIT   IE.0   ; EXTERNAL INTERRUPT 0 ENABLE
  00A9          +1   164     ET0      BIT   IE.1   ; TIMER 0 INTERRUPT ENABLE
  00AA          +1   165     EX1      BIT   IE.2   ; EXTERNAL INTERRUPT 1 ENABLE
  00AB          +1   166     ET1      BIT   IE.3   ; TIMER 1 INTERRUPT ENABLE
  00AC          +1   167     ES       BIT   IE.4   ; SERIAL PORT INTERRUPT ENABLE
  00AD          +1   168     ET2      BIT   IE.5   ; TIMER 2 INTERRUPT ENABLE
  00AF          +1   169     EA       BIT   IE.7   ; GLOBAL INTERRUPT ENABLE
                +1   170     ;
                +1   171     ; IP B8H
  00B8          +1   172     PX0      BIT   IP.0   ; EXTERNAL INTERRUPT 0 PRIORITY
  00B9          +1   173     PT0      BIT   IP.1   ; TIMER 0 PRIORITY
  00BA          +1   174     PX1      BIT   IP.2   ; EXTERNAL INTERRUPT 1 PRIORITY
  00BB          +1   175     PT1      BIT   IP.3   ; TIMER 1 PRIORITY
  00BC          +1   176     PS       BIT   IP.4   ; SERIAL PORT PRIORITY
  00BD          +1   177     PT2      BIT   IP.5   ; TIMER 2 PRIORITY
                +1   178     ;
                +1   179     ; SMB0CN C0H
  00C0          +1   180     SMBTOE   BIT   SMB0CN.0 ; SMBUS 0 TIMEOUT ENABLE
  00C1          +1   181     SMBFTE   BIT   SMB0CN.1 ; SMBUS 0 FREE TIMER ENABLE
  00C2          +1   182     AA       BIT   SMB0CN.2 ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C3          +1   183     SI       BIT   SMB0CN.3 ; SMBUS 0 INTERRUPT PENDING FLAG
  00C4          +1   184     STO      BIT   SMB0CN.4 ; SMBUS 0 STOP FLAG
  00C5          +1   185     STA      BIT   SMB0CN.5 ; SMBUS 0 START FLAG
  00C6          +1   186     ENSMB    BIT   SMB0CN.6 ; SMBUS 0 ENABLE 
                +1   187     ;
                +1   188     ; T2CON C8H
  00C8          +1   189     CPRL2    BIT   T2CON.0 ; CAPTURE OR RELOAD SELECT
  00C9          +1   190     CT2      BIT   T2CON.1 ; TIMER OR COUNTER SELECT
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     4

  00CA          +1   191     TR2      BIT   T2CON.2 ; TIMER 2 ON/OFF CONTROL
  00CB          +1   192     EXEN2    BIT   T2CON.3 ; TIMER 2 EXTERNAL ENABLE FLAG
  00CC          +1   193     TCLK     BIT   T2CON.4 ; TRANSMIT CLOCK FLAG
  00CD          +1   194     RCLK     BIT   T2CON.5 ; RECEIVE CLOCK FLAG
  00CE          +1   195     EXF2     BIT   T2CON.6 ; EXTERNAL FLAG
  00CF          +1   196     TF2      BIT   T2CON.7 ; TIMER 2 OVERFLOW FLAG
                +1   197     ;
                +1   198     ; PSW D0H
  00D0          +1   199     P        BIT   PSW.0  ; ACCUMULATOR PARITY FLAG
  00D1          +1   200     F1       BIT   PSW.1  ; USER FLAG 1
  00D2          +1   201     OV       BIT   PSW.2  ; OVERFLOW FLAG
  00D3          +1   202     RS0      BIT   PSW.3  ; REGISTER BANK SELECT 0
  00D4          +1   203     RS1      BIT   PSW.4  ; REGISTER BANK SELECT 1
  00D5          +1   204     F0       BIT   PSW.5  ; USER FLAG 0
  00D6          +1   205     AC       BIT   PSW.6  ; AUXILIARY CARRY FLAG
  00D7          +1   206     CY       BIT   PSW.7  ; CARRY FLAG
                +1   207     ;
                +1   208     ; PCA0CN D8H
  00D8          +1   209     CCF0     BIT   PCA0CN.0 ; PCA 0 MODULE 0 INTERRUPT FLAG
  00D9          +1   210     CCF1     BIT   PCA0CN.1 ; PCA 0 MODULE 1 INTERRUPT FLAG
  00DA          +1   211     CCF2     BIT   PCA0CN.2 ; PCA 0 MODULE 2 INTERRUPT FLAG
  00DB          +1   212     CCF3     BIT   PCA0CN.3 ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DC          +1   213     CCF4     BIT   PCA0CN.4 ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DE          +1   214     CR       BIT   PCA0CN.6 ; PCA 0 COUNTER RUN CONTROL BIT
  00DF          +1   215     CF       BIT   PCA0CN.7 ; PCA 0 COUNTER OVERFLOW FLAG
                +1   216     ;
                +1   217     ; ADC0CN E8H
  00E8          +1   218     AD0LJST  BIT   ADC0CN.0 ; ADC 0 RIGHT JUSTIFY DATA BIT
  00E9          +1   219     AD0WINT  BIT   ADC0CN.1 ; ADC 0 WINDOW COMPARE INTERRUPT FLAG
  00EA          +1   220     AD0STM0  BIT   ADC0CN.2 ; ADC 0 START OF CONVERSION MODE BIT 0
  00EB          +1   221     AD0STM1  BIT   ADC0CN.3 ; ADC 0 START OF CONVERSION MODE BIT 1
  00EC          +1   222     AD0BUSY  BIT   ADC0CN.4 ; ADC 0 BUSY FLAG
  00ED          +1   223     AD0INT   BIT   ADC0CN.5 ; ADC 0 CONVERISION COMPLETE INTERRUPT FLAG 
  00EE          +1   224     AD0TM    BIT   ADC0CN.6 ; ADC 0 TRACK MODE
  00EF          +1   225     AD0EN    BIT   ADC0CN.7 ; ADC 0 ENABLE
                +1   226     ;
                +1   227     ; SPI0CN F8H
  00F8          +1   228     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE
  00F9          +1   229     MSTEN    BIT   SPI0CN.1 ; SPI 0 MASTER ENABLE
  00FA          +1   230     SLVSEL   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT
  00FB          +1   231     TXBSY    BIT   SPI0CN.3 ; SPI 0 TX BUSY FLAG
  00FC          +1   232     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG
  00FD          +1   233     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG
  00FE          +1   234     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG
  00FF          +1   235     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG
                     236             
                     237     NAME    MAIN
                     238                      ;      EXTRN  CODE(end1)
                     239                      ;      EXTRN CODE(numb)
                     240                       ; EXTRN CODE(SOROS)
                     241                        ;EXTRN  CODE(Abegin)
                     242     
                     243                             
                     244                             ;PUBLIC gener,bitmas,bitrs,bitznak
                     245                             ;PUBLIC meff
                     246                             ;PUBLIC rez_A, rez_A0;  !!!!!!!!!!!!!
0000                 247                             org 0h;    cseg AT 0
                     248     
0000 020000   F      249                       jmp begin;;Main               ; Locate a jump to the start of code at 
                     250                                             
0003                 251                                                     org 3
0003 32              252                                                     reti
000B                 253                                                     org 0bh
000B 32              254                                                     reti
0013                 255                                                     org 13h
0013 32              256                                                     reti
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     5

001B                 257                                                     org 1bh
001B 32              258                                                     reti
0023                 259                                                     org 23h
0023 32              260                                                     reti
002B                 261                                                     org 2bh
002B 32              262                                                     reti
0033                 263                                                     org 33h
0033 32              264                                                     reti
003B                 265                                                     org 3bh
003B 32              266                                                     reti
0043                 267                                                     org 43h
0043 32              268                                                     reti
004B                 269                                                     org 4bh
004B 32              270                                                     reti
0053                 271                                                     org 53h
0053 32              272                                                     reti
005B                 273                                                     org 5bh
                     274                                                     
005B 32              275                                                     reti
0063                 276                                                     org 63h
0063 32              277                                                     reti
006B                 278                                                     org 6bh
006B 32              279                                                     reti
0073                 280                                                      org 73h
0073 32              281                                                     reti
0093                 282                                                     org     93h
0093 020000   F      283                                                     jmp             keyb1           ;IE6
                     284     
009B                 285                                                     org     9bh
009B 020000   F      286                                                     jmp             keyb2      ;IE7
                     287     
                     288     
                     289     
                     290     
  00CA               291     TMR2RLL  DATA 0cah;    // TIMER 2 RELOAD LOW                                       */
  00CB               292     TMR2RLH  DATA 0cbh;    // TIMER 2 RELOAD HIGH 
                     293      
                     294     Main         SEGMENT  CODE
                     295     
----                 296                                     DSEG
                     297       
  0040               298     bufind  DATA    40h;буффер индикации 12byte
                     299     ;DATA 4ch
  004F               300     abin            DATA    4fh;4byte
  0053               301     adec            DATA    53h;10byte
  006E               302     chmas           DATA    6eh;счетчик л-тов незаполн массива
  006F               303     mabin           DATA    6fh
  0077               304     reacp           DATA    77h;результат чтения асп 4byte int (hex)
  003D               305     chkl            DATA    3dh             ;счетчик задержки клавиатуры 2bait                 
                                     
  003F               306     chmasN          DATA    3fh             ;n=2,n=10 суммирование n значений       =20(27.12.0
                             6)
  003C               307     savba           DATA    3ch;сохр байта индикации при миганиии   
  003B               308     movrig      DATA        3bh;крайне правое положение
  003A               309     movleft     DATA        3ah; крайне левое положение                  
                     310                     
                     311     
                     312     ;;;;;
  0020               313      cellbit                DATA    20h
  0000               314     bitznak         BIT     cellbit.0       ;20.0           
  0001               315     bitmas          BIT     cellbit.1       ;20.1 бит заполнения массива            
  0002               316     znmat           BIT             cellbit.2       ;20.2
  0003               317     bitrs           BIT             cellbit.3       ;20.3
  0004               318     bitizm          BIT             cellbit.4       ;20.4 вкл реж измерения
  0005               319     bitavp          BIT             cellbit.5       ;20.5  бит режима avp
  0006               320     bitvi11         BIT             cellbit.6       ;20.6   бит режима выч R
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     6

  0007               321     bitzus          BIT             cellbit.7       ;20.7;флаг задержки     после установки us
                     322     
  0021               323     cellbit1                DATA    21h
  0008               324     bitbuf          BIT     cellbit1.0      ;21.0           
  0009               325     bitprd          BIT     cellbit1.1      ;21.1  выдача вкл       
  000A               326     bitbon          BIT             cellbit1.2      ;21.2  буфер вкл
  000B               327     bitmem          BIT             cellbit1.3      ;21.3
  000C               328     bmem11          BIT             cellbit1.4      ;21.4    бит ПАМ11
  000D               329     bmem12          BIT             cellbit1.5      ;21.5    бит ПАМ12
  000E               330     bmem13          BIT             cellbit1.6      ;21.6   бит ПАМ13        
  000F               331     bitnul          BIT             cellbit1.7      ;21.7 бит кнопки НУЛЬ
                     332     
  0022               333     cellbit2                DATA    22h
  0010               334     bitt2           BIT     cellbit2.0      ;22.0 уст признак Tизм2 нажата кнопка Т 
  0011               335     bitmenu         BIT     cellbit2.1      ;22.1  бит режима меню(нажата кн меню)  
  0012               336     bitvi12         BIT             cellbit2.2      ;22.2  
  0013               337     bitvi13         BIT             cellbit2.3      ;22.3
  0014               338     bitvich         BIT             cellbit2.4      ;22.4    1-е нажатие кн ВЫЧ R (режим ВЫЧ R)
  0015               339     bitvi21         BIT             cellbit2.5      ;22.5    
  0016               340     bitvi31         BIT             cellbit2.6      ;22.6   бит ПАМ13        
  0017               341     bitoll          BIT             cellbit2.7      ;22.7
                     342     ;в реж измерения прибор измеряет (кнопка ИЗМ не нажата )
                     343     ;при нажатии кнопок (T,МЕНЮ ,ПАМЯТЬ ,ВЫЧ R)прибор выходит из реж измерения
                     344     ;и выдает т.н. буфер индикации  
  0023               345     cellbit3                DATA    23h
  0018               346     knizm           BIT     cellbit3.0      ;22.0 уст признак нажата кнопка ИЗМ     
  0019               347     bitmig          BIT     cellbit3.1      ;22.1 бит мигания при наборе конст      
  001A               348     bitakt          BIT             cellbit3.2      ;22.2  бит такта
                     349     ;bit            BIT             cellbit3.3      ;22.3
                     350     ;bit            BIT             cellbit3.4      ;22.4    
                     351     ;bit            BIT             cellbit3.5      ;22.5    
                     352     ;bit            BIT             cellbit3.6      ;22.6            
                     353     ;bit            BIT             cellbit3.7      ;22.7
                     354             
  005E               355     rez_Ame   data 5eh;float         (РЕЗ1-AN)*K
                     356     ;hex
  0062               357     rez_A    data 62h       ;РЕЗ сумма 100 (10)отсчетов измерения    
  0066               358     rez_A1  data 66h        ;РЕЗ1  среднее по массиву из 2,10 ти лементов int (hex)
  006A               359     rez_A0  data 6ah;рез изм по нажатию кн НУЛЬ
  007B               360     rez_A2   data 7bh; A2
                     361     
  0098               362     chinkor  data  98h;80h          ;счетчик интервала коррекции  2byte
  0081               363     chavt    data  81h              ;счетчик автокалибровки  2byte
  0083               364     chdel    data  83h              ; счетчик задержки
                     365     ;float
  0084               366     kor0_AN  data  84h              ;4byte  AN      результат коррекции 0
  0088               367     rezAp    data  88h              ;4byte  A+
  008C               368     rezAm    data  8ch              ;4byte  A-
  0090               369     koefKp   data  90h              ;4byte  K+
  0094               370     koefKm   data  94h              ;4byte  K-
                     371     ;hex 
  009A               372     parT     data  9ah              ;параметр времени измерения
  009B               373     chbefore data  9bh              ;счетчик предварительного суммирования
  009C               374     rez_A3   data  9ch              ;A3
                     375     ;FLOAT
  00A0               376     koefKD  data  0a0h         ;KD кофф диапазона
  00A4               377     constE  data  0a4h         ;констант E
  00A8               378     constF  data  0a8h         ;констант F
  00AC               379     chind   data  0ach         ;счетчик индикации
  00AD               380     chbuf   data  0adh         ;счетчик периода загрузки в буфер и интерфейс
  00AE               381     diap    data  0aeh         ;номер диапазона
  00AF               382     parN    data  0afh         ;N  пар разрядности индикатора
  00B0               383     level   data  0b0h              ;уровень в меню, выч    ,Tизм
  00B1               384     vichR   data  0b1h              ;параметр =11,12,13,21
  00B2               385     marker  data  0b2h         ;номер мигающего знакоместа
  00B3               386     summa   data  0b3h         ;ячейка длясуммирования      rez_A
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     7

  00B7               387     load    data  0b7h         ;яч для загрузки текстов на индикатор
  00B8               388     work    data  0b8h        ;рабочая ячейка
  00BC               389     konstA  data  0bch        ;     введенная с крана константа A
  00C0               390     konstB  data  0c0h         ;    введенная с крана константа B
  00C4               391     nblok   data  0c4h         ;номер блока
  00C5               392     Rez_del data  0c5h      ;сумма n-значений /n
                     393     ;data  0c9h
                     394     
                     395     ;внешнее ОЗУ 64K 
                     396     ;               XSEG AT 100h
                     397             PUBLIC    MASS0
  0080               398     MASS0  xdata 0080h;     скользящий массив измерения
  0084               399     MASS1  xdata 0084h;
  0088               400     MASS2  xdata 0088h;
  008C               401     MASS3  xdata 008ch;
  0090               402     MASS4  xdata 0090h;
  0094               403     MASS5  xdata 0094h;
  0098               404     MASS6  xdata 0098h;
  009C               405     MASS7  xdata 009ch;
  00A0               406     MASS8  xdata 00a0h;
  00A4               407     MASS9  xdata 00a4h;
  00A8               408     MASS10  xdata 00a8h;
  00AC               409     MASS11  xdata 00ach;
  00B0               410     MASS12  xdata 00b0h;
  00B4               411     MASS13  xdata 00b4h;
  00B8               412     MASS14  xdata 00b8h;
  00BC               413     MASS15  xdata 00bch;
  00C0               414     MASS16  xdata 00c0h;
  00C4               415     MASS17  xdata 00c4h;
  00C8               416     MASS18  xdata 00c8h;
  00CC               417     MASS19  xdata 00cch;
                     418     ;xdata 0038h;
                     419     
  0000               420                             rr0             EQU 00
  0001               421                     rr1       equ   01
  0006               422                     rr6   equ 06
  0002               423                     rr2       equ   02
  0003               424                     rr3       equ   03
  0007               425                     rr7   equ 07
                     426     
  0008               427                     r8   equ 08
  0009               428                     r9        equ   09
  000A               429                     r10       equ   10
  000B               430                     r11   equ 11
                     431     
                     432                     
                     433        
----                 434                  rseg     Main          ; Switch to this code segment.
                     435     
                     436                  using    0              ; Specify register bank for the following
                     437     
0100                 438     org 100h
                     439     ;$EJECT
                     440     
0100 7581E0          441     begin:     mov  sp, #0e0h
0103 75E900          442                                             mov             PCA0L,#00;=0x00;
0106 75D900          443                                             mov     PCA0MD,#00;= 0x00;
0109 75A41F          444                                             mov     P0MDOUT,#1fh;=0x1f;
010C 75A5CD          445                                             mov     P1MDOUT,#0cdh;86h;8fh;=0x8f;
010F 75A600          446                                             mov     P2MDOUT,#00;=0x00;
                     447             
0112 75A73F          448             mov     P3MDOUT,#3fh;
0115 75B5FF          449             mov     P74OUT ,#0ffh;=0xff;
0118 75D103          450             mov     REF0CN,#03h;=0x03;
                     451             
011B 75E114          452             mov     XBR0,#14h;= 0x14;
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     8

011E 75E200          453             mov     XBR1,#00; =0x00;
0121 75E300          454             mov XBR2,#00;=0x00;
0124 75B0C0          455             mov     P3,#0c0h
0127 75FFDE          456             mov     WDTCN,#0deh;=0xde;       //запрет работы WDT
012A 75FFAD          457             mov     WDTCN,#0adh;=0xad;                                   
012D 758922          458             mov     TMOD,#22h;=0x22;        //регистр режимов
0130 758E30          459             mov     CKCON,#30h;=0x30; //сист частота/12     
0133 758CF9          460             mov     TH0,#0f9h;=0xf9;//      ; Установка таймера
0136 758AF9          461             mov     TL0,#0f9h;=0xf9; 
0139 75E680          462             mov     EIE1,#80h;=0x80;
                     463     
013C 75D480          464             mov     DAC0CN,#80h;=0x80;
013F 75D780          465             mov     DAC1CN,#80h;=0x80;
0142 75B167          466             mov     OSCXCN,#67h;=0x67;
                     467     
                     468      
                     469     
0145 E5B1            470     gener:     mov a, oscxcn
0147 B4E7FB          471                cjne a,#11100111b,gener
                     472                            
014A 75B288          473             mov     OSCICN,#88h;=0x84;
014D 75CA00          474         mov TMR2RLL,#0;=0;
0150 75CBD1          475         mov TMR2RLH,#0d1h;=0xd1;
                     476       
0153 D28E            477                     setb  TCON.6                    ;регистр управления
0155 D28C            478                      setb tcon.4
                     479     
0157 75EF00          480             mov     RSTSRC,#0;=00   ;//источники сброса 
                     481     
                     482             
015A 75E340          483          mov        XBR2,#40h
015D 75E106          484              mov    XBR0,#06h;16h
0160 75F803          485             mov             SPI0CN,#03
0163 759D31          486             mov             spi0ckr,#31H;;;;;;;;#04
                     487     ;       mov             EIE2,#20H
0166 75E730          488             mov             EIE2,#30H;00110000
0169 75A880          489             mov     IE,#80h;//10000000      ;//Снятие блокировки всех прерываний
                     490     ;ozu
016C E4              491                             clr     a
016D 7800            492                             mov     r0,#00h 
016F F6              493     mecle:          mov     @r0,a                   ;обнулить озу 256 байт
0170 08              494                             inc     r0
0171 B87FFB          495                             cjne    r0,#7fh,mecle
0174 7880            496                             mov     r0,#80h
0176 F6              497     meff:           mov     @r0,a 
0177 F2              498                             movx @r0,a
0178 08              499                             inc     r0
0179 B8DFFA          500                             cjne    r0,#0dfh,meff
017C 120000   F      501                             call    clmassix
017F 7898            502                             mov             r0,#chinkor
0181 7600            503                             mov             @r0,#0;1;
0183 08              504                             inc             r0
0184 76C8            505                             mov             @r0,#0c8h;90h;
                     506                             ;;;;
0186 7881            507                             mov             r0,#chavt
0188 7603            508                             mov             @r0,#3;1
018A 08              509                             inc             r0
018B 7620            510                             mov             @r0,#20h;90h
                     511     
018D 78B2            512                                     mov             r0,#marker
018F 76FF            513                                     mov             @r0,#0ffh
                     514                             ;mov            r0,#chind
                     515                             ;mov            @r0,#1
                     516                     
0191 74FF            517                             mov             a,#0ffh
0193 F585            518                        mov          p5,a
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE     9

0195 799A            519                             mov             r1,#parT
0197 7702            520                             mov             @r1,#2                  ;Tizm=1s
0199 79AE            521                             mov             r1,#diap
019B 7705            522                             mov             @r1,#5                  ;10-7a
019D 79AF            523                             mov             r1,#parN
019F 7702            524                             mov             @r1,#2
01A1 7400            525                             mov             a,#00h
01A3 F585            526                             mov             p5,a
01A5 D204            527                             setb    bitizm
                     528     
01A7 799B            529                             mov             r1,#chbefore
01A9 7700            530                             mov             @r1,#0
                     531                             ;;;;;;
01AB 900000   F      532                             mov             dptr,#ch_1              ;1->r2..r5 float
01AE 120000   F      533                             call    ldc_long
01B1 7890            534                             mov             r0,#koefKp         ;1(float)->koefKp
01B3 120000   F      535                             call    saver2
01B6 7894            536                             mov             r0,#koefKm              ;1(float)->koefKm
01B8 120000   F      537                             call    saver2
01BB 78A0            538                             mov             r0,#koefKD
01BD 120000   F      539                             call    saver2  
                     540     ;START
                     541     ;                                       rez_A0=0;
                     542     ;        SUMM=0; //обнуление скользящего массива
                     543     ;        over_mas=0;
                     544     ;        count_mas=0;
                     545     
01C0 7840            546                             mov             r0,#bufind
01C2                 547     age2:
01C2 76FD            548                             mov             @r0,#0fdh         ;погасить индикатор
01C4 08              549                             inc             r0
01C5 B84CFA          550                             cjne    r0,#bufind+12,age2              
01C8 120000   F      551                             call    ind
01CB 120000   F      552                             call    z_1s
                     553     
                     554                                     ;зажечь все лементы индикации
01CE 7840            555                             mov             r0,#bufind
01D0 76FE            556     ageon:          mov             @r0,#0feh;?
01D2 08              557                             inc             r0
01D3 B84CFA          558                             cjne    r0,#bufind+12,ageon             
01D6 120000   F      559                             call    ind
01D9 120000   F      560                             call    z_1s            ;1sec
                     561     ;;;;;;;;;;;;;;;;
01DC 7840            562                             mov             r0,#bufind
01DE 7630            563                             mov             @r0,#30H;"A"
01E0 08              564                             inc             r0
01E1 7630            565                             mov             @r0,#30H;"В"
01E3 08              566                             inc             r0
01E4 7630            567                             mov             @r0,#30H;"Т"
01E6 08              568                             inc             r0
01E7 7634            569                             mov             @r0,#34H;2dh
01E9 08              570                             inc             r0
01EA 7635            571                             mov             @r0,#35H;"H"
01EC 08              572                             inc             r0
01ED 7636            573                             mov             @r0,#36h
01EF 08              574                             inc             r0
01F0 7637            575                             mov             @r0,#37h
01F2 08              576                             inc             r0
01F3 762D            577                             mov             @r0,#2dh
01F5 08              578                             inc             r0
01F6 7637            579                             mov             @r0,#37h
01F8 08              580                             inc             r0
01F9 7641            581                             mov             @r0,#"A";31h
01FB 08              582                             inc             r0
                     583                     
01FC 120000   F      584     dd:                     call    ind
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    10

01FF 120000   F      585                             call    z_15;z_1ms
                     586             ;       jmp             dd
                     587     ;;;;;;;;;;;;;;;;;;;
0202 7C60            588                             mov             r4,#60h
0204 7D00            589                             mov             r5,#00         
0206 120000   F      590                             call    iniacp;инициализация acp
0209 120000   F      591                             call    loadUS          ;us 10-7 A
                     592                             
020C C217            593     rebyte:         clr             bitoll
020E 3095FD          594                             jnb             p1.5,$
0211 2095FD          595                             jb              p1.5,$
0214 E586            596                             mov             a,P6            ;p6.4=0
0216 54EF            597                             anl             a,#0efh
0218 F586            598                             mov             P6,a
021A 00              599                             nop
021B 00              600                             nop
                     601                                     
021C E586            602                             mov             a,P6                    ;p6.4=1 
021E 4410            603                             orl             a,#10h
0220 F586            604                             mov             P6,a                        
0222 7411            605                             mov             a,#11h
0224 120000   F      606                             call    write
                     607                             ;чтение acp
0227 120000   F      608                             call    read    
022A F578            609                             mov     reacp+1,A       ;старший байт 
022C 120000   F      610                             call    read    
022F F579            611                             mov     reacp+2,A       ;средний байт 
0231 120000   F      612                             call    read
0234 F57A            613                             mov     reacp+3,A               ;мл байт
                     614                        ;;;;;;;;;;;
0236 7878            615                        mov          r0,#reacp+1
0238 E6              616                        mov          a,@r0
0239 20E72D          617                             jb              acc.7,znplus;
023C D200            618                             setb    bitznak
023E 4480            619                             orl             a,#80h  ;ост содерж яч 
0240 F6              620                             mov             @r0,a
                     621                                     
0241 18              622     mmm:            dec             r0;,#reacp
0242 76FF            623                             mov             @r0,#0ffh
0244 802B            624                             jmp             goznak
                     625     
                     626     
0246 750A00          627     labelA:         mov             r10,#0          
0249 750B00          628                             mov             r11,#0
024C 783D            629                             mov             r0,#chkl
024E 120000   F      630                             call    chcmp
0251 7000            631                             jnz             no0key
                     632                             ;разрешить ie6,ie7       
                     633                     ;       mov             EIE2,#30h ;EIE2.5,EIE2.4
                     634                     ;       mov             EIP2,#30h
                     635                        
0253 793D            636     no0key:         mov             r1,#chkl 
0255 120000   F      637                             call    chdec
0258 2004B1          638                             jb              bitizm,rebyte
                     639                              ;буфер 2 выдать на индикацию
                     640     ;3.11.06        
025B 120000   F      641                             call    ind
025E 120000   F      642                             call    z_01s
0261 120000   F      643                             call    z_01s
0264 120000   F      644                             call    z_01s
0267 80DD            645                             jmp             labelA
                     646     
0269 C200            647     znplus:         clr     bitznak
026B 547F            648                             anl             a,#7fh;fdh                      ;+
026D F6              649                             mov             @r0,a
026E 18              650                             dec             r0;,#reacp
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    11

026F 7600            651                             mov             @r0,#00h
                     652                             
0271                 653     goznak: 
                     654     ;;;;;;;;;;;;;
0271 787A            655                             mov     r0,#reacp+3
0273 E6              656                             mov             a,@r0
0274 7F05            657                             mov             r7,#5;6 сдвиг на 5 разрядов вправо
0276 C3              658     sdvig3:         clr             c
0277 13              659                             rrc             a
0278 DFFC            660                             djnz    r7,sdvig3 ;d7,d6,d5       мл байт
027A FA              661                             mov             r2,a    ;сохр байт
027B 18              662                             dec             r0              ;       reacp+2
027C E6              663                             mov             a,@r0
027D C0E0            664                             push    acc
027F C3              665                             clr             c
0280 7F03            666                             mov             r7,#3;2
0282 C3              667     sdvig2:         clr             c
0283 33              668                             rlc             a
0284 DFFC            669                             djnz    r7,sdvig2 ;d12..d11      средний байт
0286 4A              670                             orl             a,r2
0287 F57A            671                             mov             reacp+3,a;сформ мл байт
0289 D0E0            672                             pop             acc
                     673                             
028B 7F05            674                             mov             r7,#5;6
028D C3              675     sdvig1:         clr             c
028E 13              676                             rrc             a
028F DFFC            677                             djnz    r7,sdvig1 ;d15,d14        ср байт
0291 FA              678                             mov             r2,a   ;сохр
0292 E578            679                             mov             a,reacp+1
0294 C0E0            680                             push    acc
                     681                     ;;      push    acc
0296 7F03            682                             mov             r7,#3;2
0298 C3              683     sdvig0:         clr             c
0299 33              684                             rlc             a
029A DFFC            685                             djnz    r7,sdvig0 ;       d21..d16
029C 4A              686                             orl             a,r2
029D F579            687                             mov             reacp+2,a       ; сформ средний  байт
029F D0E0            688                             pop             acc       ;reacp+1
                     689                             ;;;;;;;;;;;;;;
02A1 20E70B          690                             jb              acc.7,sdvm
02A4 C3              691                             clr             c
02A5 7F05            692                             mov             r7,#5;6
02A7 C3              693     sdvig4:         clr             c
02A8 13              694                             rrc             a
02A9 DFFC            695                             djnz    r7,sdvig4 ;       d23,d22
02AB F578            696                             mov             reacp+1,a
02AD 8008            697                             jmp             readyacp;ankor;klmas
                     698     ;;;;;;;;;;;;                                    
02AF 7F05            699     sdvm:           mov             r7,#5;6
02B1 D3              700     sdvig6:         setb            c
02B2 13              701                             rrc             a
02B3 DFFC            702                             djnz    r7,sdvig6 ;       d23,d22
02B5 F578            703                             mov             reacp+1,a
                     704                                                             
                     705     ; reacp..reacp+3-результат чтения асп(hex) 
                     706     ;;;;;;;;;
02B7                 707     readyacp:
02B7 7898            708                                             mov             r0,#chinkor
02B9 E6              709                             mov             a,@r0
02BA 30E702          710                             jnb             acc.7,gopart
02BD 8044            711                                     jmp             sumt2
                     712                     
02BF                 713     gopart:
02BF 789A            714                             mov             r0,#parT        ;параметр времени
02C1 793F            715                             mov             r1,#chmasN
02C3 B6013A          716                             cjne    @r0,#1,noparT1
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    12

                     717                             ;РЕЗ+РЕЗ
02C6 7877            718                             mov             r0,#reacp
02C8 120000   F      719                             call    resar2          ;reacp->r2..r5
02CB 78B6            720                             mov             r0,#summa+3;rez_A+3
02CD 120000   F      721                             call    ladd
02D0 78B3            722                             mov             r0,#summa;rez_A
02D2 120000   F      723                             call    saver2
02D5 793F            724                              mov            r1,#chmasN
02D7 7714            725                             mov             @r1,#20;10
02D9 789B            726                             mov             r0,#chbefore
02DB B6631E          727                             cjne    @r0,#99,nobef99
                     728                             ;РЕЗ/100
02DE 900000   F      729                             MOV        DPTR,#ch100 
02E1 120000   F      730     allsum:         CALL   ldc_ltemp                 ; ltemp <-- 100
02E4 120000   F      731                             call    zdiv;divide
02E7 7862            732                             mov             r0,#rez_A
02E9 120000   F      733                             call    saver2          ;сумма 100 отсчетов /100
02EC 78C5            734                             mov             r0,#Rez_del
02EE 120000   F      735                             call    saver2  
                     736                        ;;;;;
02F1 78B3            737                        mov          r0,#summa
02F3 120000   F      738                        call         clear4
                     739     ;                       mov             a,chmas
                     740     ;                       mov             @r1,a   ;->chmasN
02F6 799B            741                             mov             r1,#chbefore
02F8 7700            742                             mov             @r1,#0
02FA 8048            743                             jmp             klmas           ;загр в массив скользящее ср
02FC 06              744     nobef99:        inc             @r0                     ;chbefore
02FD 020000   F      745                             jmp             rebyte;labelA;метка A
                     746     ;сначала суммируем 100 знач (не выводим на индикатор не расп в скользящий массив )
                     747     ;а потом уже располагаем  в скользящий массив  из n
                     748     
                     749     
                     750     
0300 B6021D          751     noparT1:        cjne    @r0,#2,noparT2
                     752                             ;РЕЗ+РЕЗ
0303                 753     sumt2:
0303 7877            754                              mov            r0,#reacp
0305 120000   F      755                             call    resar2          ;reacp->r2..r5
0308 78B6            756                             mov             r0,#summa+3;rez_A+3
030A 120000   F      757                             call    ladd
030D 78B3            758                             mov             r0,#summa;rez_A
030F 120000   F      759                             call    saver2
0312 789B            760                             mov             r0,#chbefore
0314 793F            761                             mov             r1,#chmasN
0316 770A            762                             mov             @r1,#10
0318 B613E1          763                             cjne    @r0,#19,nobef99;9,nobef99
                     764                             ;РЕЗ/10
031B 900000   F      765                             MOV        DPTR,#ch20;ch10 
031E 80C1            766                             jmp             allsum
                     767                             ;;;;;;;
                     768                             
                     769     
0320 B60302          770     noparT2:        cjne    @r0,#3,noparT3
0323 8003            771                             jmp             aapar
                     772     
0325 B60410          773     noparT3:        cjne    @r0,#4,noparT4
0328 7877            774     aapar:          mov             r0,#reacp
032A 120000   F      775                             call    resar2          ;reacp->r2..r5
032D 7862            776                             mov             r0,#rez_A
032F 120000   F      777                             call    saver2
0332 793F            778                              mov            r1,#chmasN
0334 770A            779                             mov             @r1,#10
                     780                     ;       mov             @r1,#10         ;n=10
0336 800C            781                             jmp             klmas
0338 7702            782     noparT4:   mov          @r1,#2          ;chmasN n=2
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    13

033A 7877            783                             mov             r0,#reacp
033C 120000   F      784                             call    resar2          ;reacp->r2..r5
033F 7862            785                             mov             r0,#rez_A
0341 120000   F      786                             call    saver2
                     787     ;загрузить А в массив из 2/10 значений
                     788     ;;;;;;;;;;;;;;;
0344                 789     klmas:           
0344 793F            790                             mov             r1,#chmasN
0346 B7021A          791                             cjne    @r1,#2,mas10
0349 900080          792                             MOV        dptr,#MASS0
034C 120000   F      793                     CALL       xCIKLWR        ; MASS0 --> MASS1
                     794     
034F 7862            795                             mov             r0,#rez_A
0351 120000   F      796                             call    resar2          ;->r2..r5
0354 900080          797                             mov                     dptr,#MASS0
0357 120000   F      798                   call              saveIr2                 ; R2-R5 --> MAS0
                     799                     
035A 900087          800                   MOV          dptr,#MASS1+3
035D 120000   F      801                   CALL       addx
0360 020000   F      802                       jmp           endsum
0363 B70A7A          803     mas10:                  cjne    @r1,#10,mas20
0366 9000A0          804                                             mov                     dptr,#MASS8
0369 120000   F      805                     CALL            xCIKLWR         ;MASS8->MASS9
036C 90009C          806                                             mov                     dptr,#MASS7
036F 120000   F      807                     CALL            xCIKLWR         ;MASS7->MASS8
0372 900098          808                     MOV       dptr,#MASS6
0375 120000   F      809                     CALL       xCIKLWR         ; MASS6 --> MASS7
0378 900094          810                     MOV        dptr,#MASS5
                     811                    
037B 120000   F      812                    CALL        xCIKLWR        ; MASS5 --> MASS6
037E 900090          813                    MOV         dptr,#MASS4
                     814                    
0381 120000   F      815                    CALL        xCIKLWR        ; MASS4 --> MASS5
0384 90008C          816                             mov                     dptr,#MASS3
                     817     
0387 120000   F      818                    CALL             xCIKLWR         ;MASS3->MASS4
038A 900088          819                     MOV        dptr,#MASS2
                     820                    
038D 120000   F      821                    CALL        xCIKLWR         ; MASS2 --> MASS3
0390 900084          822                    MOV         dptr,#MASS1
                     823                     
0393 120000   F      824                   CALL         xCIKLWR        ; MASS1 --> MASS2
0396 900080          825                    MOV         dptr,#MASS0
                     826                   
0399 120000   F      827                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     828     
                     829                             
039C 7862            830                             mov             r0,#rez_A
039E 120000   F      831                             call    resar2          ;->r2..r5
                     832                                     ;call   aform
03A1 900080          833                                     mov                     dptr,#MASS0
03A4 120000   F      834                   call              saveIr2                 ; R2-R5 --> MAS0
                     835              
03A7 900087          836                   MOV          dptr,#MASS1+3
03AA 120000   F      837                   CALL       addx
03AD 90008B          838                   MOV          dptr,#MASS2+3
03B0 120000   F      839                   CALL       addx
03B3 90008F          840                   MOV          dptr,#MASS3+3
03B6 120000   F      841                  CALL        addx
03B9 900093          842                   MOV       dptr,#MASS4+3
03BC 120000   F      843                   call       addx
03BF 900097          844                     MOV        dptr,#MASS5+3
03C2 120000   F      845                  CALL        addx
03C5 90009B          846                   MOV          dptr,#MASS6+3
03C8 120000   F      847                   CALL       addx
03CB 90009F          848                   MOV          dptr,#MASS7+3
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    14

03CE 120000   F      849                  CALL        addx
03D1 9000A3          850                  MOV        dptr,#MASS8+3
03D4 120000   F      851                   call       addx
03D7 9000A7          852                     MOV                     dptr,#MASS9+3
03DA 120000   F      853                  call        addx
03DD 020000   F      854                              jmp            endsum
                     855     
03E0 9000C8          856     mas20:          mov                     dptr,#MASS18
03E3 120000   F      857                     CALL            xCIKLWR         ;MASS18->MASS19
03E6 9000C4          858                                             mov                     dptr,#MASS17
03E9 120000   F      859                     CALL            xCIKLWR         ;MASS17->MASS18
03EC 9000C0          860                     MOV       dptr,#MASS16
03EF 120000   F      861                     CALL       xCIKLWR         ; MASS16 --> MASS17
03F2 9000BC          862                     MOV        dptr,#MASS15
                     863                    
03F5 120000   F      864                    CALL        xCIKLWR        ; MASS15 --> MASS16
03F8 9000B8          865                    MOV         dptr,#MASS14
                     866                    
03FB 120000   F      867                    CALL        xCIKLWR        ; MASS14 --> MASS15
03FE 9000B4          868                             mov                     dptr,#MASS13
                     869     
0401 120000   F      870                    CALL             xCIKLWR         ;MASS13->MASS14
0404 9000B0          871                     MOV        dptr,#MASS12
                     872                    
0407 120000   F      873                    CALL        xCIKLWR         ; MASS12 --> MASS13
040A 9000AC          874                    MOV         dptr,#MASS11
                     875                     
040D 120000   F      876                   CALL         xCIKLWR        ; MASS11 --> MASS12
0410 9000A8          877                    MOV         dptr,#MASS10
                     878                   
0413 120000   F      879                    CALL        xCIKLWR        ; MASS10 --> MASS11
0416 9000A4          880                                      MOV       dptr,#MASS9
0419 120000   F      881                     CALL       xCIKLWR        ; MASS9 --> MASS10
                     882     
041C 9000A0          883                                             mov                     dptr,#MASS8
041F 120000   F      884                     CALL            xCIKLWR         ;MASS8->MASS9
0422 90009C          885                                             mov                     dptr,#MASS7
0425 120000   F      886                     CALL            xCIKLWR         ;MASS7->MASS8
0428 900098          887                     MOV       dptr,#MASS6
042B 120000   F      888                     CALL       xCIKLWR         ; MASS6 --> MASS7
042E 900094          889                     MOV        dptr,#MASS5
                     890                    
0431 120000   F      891                    CALL        xCIKLWR        ; MASS5 --> MASS6
0434 900090          892                    MOV         dptr,#MASS4
                     893                    
0437 120000   F      894                    CALL        xCIKLWR        ; MASS4 --> MASS5
043A 90008C          895                             mov                     dptr,#MASS3
                     896     
043D 120000   F      897                    CALL             xCIKLWR         ;MASS3->MASS4
0440 900088          898                     MOV        dptr,#MASS2
                     899                    
0443 120000   F      900                    CALL        xCIKLWR         ; MASS2 --> MASS3
0446 900084          901                    MOV         dptr,#MASS1
                     902                     
0449 120000   F      903                   CALL         xCIKLWR        ; MASS1 --> MASS2
044C 900080          904                    MOV         dptr,#MASS0
                     905                   
044F 120000   F      906                    CALL        xCIKLWR        ; MASS0 --> MASS1
                     907     
                     908                             
0452 7862            909                             mov             r0,#rez_A
0454 120000   F      910                             call    resar2          ;->r2..r5
                     911                                     ;call   aform
0457 900080          912                                     mov                     dptr,#MASS0
045A 120000   F      913                   call              saveIr2                 ; R2-R5 --> MAS0
                     914              
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    15

045D 900087          915                   MOV          dptr,#MASS1+3
0460 120000   F      916                   CALL       addx
0463 90008B          917                   MOV          dptr,#MASS2+3
0466 120000   F      918                   CALL       addx
0469 90008F          919                   MOV          dptr,#MASS3+3
046C 120000   F      920                  CALL        addx
046F 900093          921                   MOV       dptr,#MASS4+3
0472 120000   F      922                   call       addx
0475 900097          923                     MOV        dptr,#MASS5+3
0478 120000   F      924                  CALL        addx
047B 90009B          925                   MOV          dptr,#MASS6+3
047E 120000   F      926                   CALL       addx
0481 90009F          927                   MOV          dptr,#MASS7+3
0484 120000   F      928                  CALL        addx
0487 9000A3          929                  MOV        dptr,#MASS8+3
048A 120000   F      930                   call       addx
048D 9000A7          931                     MOV                     dptr,#MASS9+3
0490 120000   F      932                  call        addx
                     933     ;27
0493 9000AB          934                                     MOV        dptr,#MASS10+3
0496 120000   F      935                   CALL       addx
0499 9000AF          936                                     MOV        dptr,#MASS11+3
049C 120000   F      937                   CALL       addx
049F 9000B3          938                   MOV          dptr,#MASS12+3
04A2 120000   F      939                   CALL       addx
04A5 9000B7          940                   MOV          dptr,#MASS13+3
04A8 120000   F      941                  CALL        addx
04AB 9000BB          942                   MOV       dptr,#MASS14+3
04AE 120000   F      943                   call       addx
04B1 9000BF          944                                     MOV        dptr,#MASS15+3
04B4 120000   F      945                     CALL     addx
04B7 9000C3          946                   MOV          dptr,#MASS16+3
04BA 120000   F      947                   CALL       addx
04BD 9000C7          948                   MOV          dptr,#MASS17+3
04C0 120000   F      949                  CALL        addx
04C3 9000CB          950                  MOV        dptr,#MASS18+3
04C6 120000   F      951                   call       addx
04C9 9000CF          952                                     MOV                     dptr,#MASS19+3
04CC 120000   F      953                  call        addx
                     954     
                     955     
                     956     
                     957             ;23.03          
04CF                 958     endsum:
04CF 786E            959                                     mov             r0,#chmas;8.11.06               ;0..n(0..2,
                             0..10)
04D1 06              960                                     inc             @r0
04D2 E6              961                                     mov             a,@r0   
04D3 200105          962                                     jb              bitmas,masfull          ;массив заполнен 2/
                             10 значениями
                     963                                     
04D6 B53F26          964                                     cjne    a,chmasN,masx5
04D9 D201            965                                     setb    bitmas                  ;массив заполнен
04DB 853F6E          966     masfull:                mov             chmas,chmasN
04DE 783F            967                                     mov             r0,#chmasN
04E0 E6              968                                     mov             a,@r0
                     969     ;masfull:
04E1 B40208          970                                     cjne    a,#2,nochn2
04E4 900000   F      971                                     MOV        DPTR,#ch2;10 
04E7 120000   F      972                                     CALL   ldc_ltemp                 ; ltemp <-- 2
04EA 801D            973                                     jmp             mas5div
                     974     
04EC B40A08          975     nochn2:         cjne    a,#10,nochn10
04EF 900000   F      976                                                     MOV        DPTR,#ch10 
04F2 120000   F      977                                     CALL   ldc_ltemp                 ; ltemp <-- 10
04F5 8012            978                                     jmp             mas5div
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    16

                     979     
04F7                 980     nochn10:
04F7 900000   F      981                                                     MOV        DPTR,#ch20 
04FA 120000   F      982                                     CALL   ldc_ltemp                 ; ltemp <-- 20
04FD 800A            983                                     jmp             mas5div
04FF 856E0B          984     masx5:                  mov     ltemp+3,chmas                   ;массив не заполнен
0502 E4              985                                     clr     a
0503 F50A            986                                     mov     ltemp+2,a
0505 F509            987                                     mov     ltemp+1,a
0507 F508            988                                     mov     ltemp,a
                     989     
0509                 990     mas5div:
0509 120000   F      991                                     CALL       zdiv;divide                           ; R2-R5 =
                     992                                              ; = (MAS0+MAS1+MAS2+MAS3+MAS4)/5
                     993     
                     994                             
                     995      ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     996     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     997     ;получен результат 3 байта и знак
050C 7866            998                             mov             r0,#rez_A1
050E 120000   F      999                             call    saver2           ;сохр среднее по массиву
                    1000     ;;8.11.06                       mov             chmasN,#0
                    1001      ;;;;;;;;;;;;
                    1002      ;;;;;;;;;;;;
0511 C3             1003                             clr             c
0512 799A           1004                             mov             r1,#parT
0514 7402           1005                             mov             a,#2
0516 97             1006                             subb    a,@r1
0517 500A           1007                             jnc             ankor           ;T<3
                    1008                             ;A-=РЕЗ1                                ;T>3
0519 120402         1009                             call    altof                   ;r2..r5->float
051C 785E           1010                             mov             r0,#rez_Ame
051E 120000   F     1011                             call    saver2
0521 8022           1012                             jmp             gotoKD
                    1013     
0523                1014     ankor:  
0523 7898           1015                             mov             r0,#chinkor
0525 E6             1016                             mov             a,@r0
0526 30E703         1017                             jnb             acc.7,nokorr
                    1018                             ;коррекция 0
0529 020000   F     1019                             jmp             kornul
052C                1020     nokorr: 
                    1021                             ;mov            r10,#00         ;       chavt
                    1022                             ;mov            r11,#00h
052C 7881           1023                             mov              r0,#chavt      
052E E6             1024                             mov                     a,@r0;call      chcmp           ;сравн счет
                             чик авто калибровки с 0h
052F 30E750         1025                             jnb             acc.7,nonulavt;jnz              nonulavt        
0532 750A00         1026                             mov             r10,#0;1;00;02          
0535 750BC8         1027                             mov             r11,#0c8h;90h;0c8h;58h
0538 7898           1028                             mov             r0,#chinkor
053A 120000   F     1029                             call    chcmp
053D 705B           1030                             jnz             noavk
                    1031                             ;автокалибровка
053F 020000   F     1032                             jmp             autoka;noavk;
                    1033     
0542 020000   F     1034     rafterK:                jmp             afterK
                    1035     ;;;;;;;;;;
0545 C3             1036      gotoKD:                clr             c
0546 799A           1037                             mov             r1,#parT
0548 7404           1038                             mov             a,#4
054A 97             1039                             subb    a,@r1
054B 50F5           1040                             jnc             rafterK         ;T<5
                    1041                             ;A1-=A- *KD                     ;T>5
054D 120000   F     1042                             call            findkoef                                ;r2,r3-hex
0550 12046C         1043                                     call            rebyte2                         ;r2..r5- he
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    17

                             x
                    1044                                     
0553 120402         1045                                     call    altof                   ;r2..r5->float
0556 900000   F     1046                                     mov     dptr,#CHtho;100000
0559 120000   F     1047                                     call    ldc_ltemp                       ;r8..r11
055C 1202B7         1048                                     call    fldiv
055F 120000   F     1049                                     call    move28
                    1050                             
0562 785E           1051                             mov             r0,#rez_Ame;->r2..r5   ???????????/
0564 120000   F     1052                             call    resar2
0567 120203         1053                                     call    flmul
056A 120343         1054                             call    ftol                    ;float->int
056D 7866           1055                             mov             r0,#rez_A1
056F 120000   F     1056                             call    saver2
0572 786A           1057                             mov             r0,#rez_A0;->r8..r11 hex
0574 120000   F     1058                             call    resar8
0577 120000   F     1059                             call    lsub            ;A3=A-1-A0
057A 789C           1060                             mov             r0,#rez_A3
057C 120000   F     1061                             call    saver2
057F 020000   F     1062                             jmp             labelB  
                    1063      ;;;;;;;;;;; 9.11.06
0582 789A           1064     nonulavt:        mov            r0,#parT
0584 E6             1065                             mov             a,@r0
0585 6401           1066                             xrl             a,#01
0587 700C           1067                             jnz             avtdec1
0589 7982           1068                             mov             r1,#chavt+1     ;T=1 chavt-10
058B 120000   F     1069                             call    tenmin
058E 7999           1070     kordec10:       mov             r1,#chinkor+1
0590 120000   F     1071                             call    tenmin
0593 8018           1072                             jmp             rezmul
                    1073     
0595 7981           1074     avtdec1:        mov             r1,#chavt       
0597 120000   F     1075                             call    chdec           ;chavt-1
                    1076     ;                       jmp             kordec1;rezmul
059A 789A           1077     noavk:          mov             r0,#parT
059C E6             1078                             mov             a,@r0
059D 6401           1079                             xrl             a,#01
059F 7007           1080                             jnz             kordec1
                    1081                             ;T=1 chinkor-10
05A1 7999           1082                     mov             r1,#chinkor+1
05A3 120000   F     1083                             call    tenmin
05A6 8005           1084                             jmp             rezmul
05A8 7998           1085     kordec1:        mov             r1,#chinkor
05AA 120000   F     1086                             call    chdec           ; chinkor-1
                    1087                        ;9.11.06
                    1088                             ;;;;;;;;;;;;;;
                    1089                             ;;;;;;;;;;;;;
                    1090     ;(РЕЗ1-АN)*K
05AD                1091     rezmul:
05AD 7866           1092                             mov             r0,#rez_A1;->r2..r5
05AF 120000   F     1093                             call    resar2
05B2 120402         1094                             call    altof   ;r2..r5->float  6.06    
05B5 7884           1095                             mov             r0,#kor0_AN;->r8..r11
05B7 120000   F     1096                             call    resar8
                    1097                             ;;call  altof   ;r2..r5->float
05BA 1201D1         1098                             call    flsub
05BD 7890           1099                             mov             r0,#koefKp;->r8..r11
05BF EA             1100                             mov             a,r2
05C0 30E702         1101                             jnb             acc.7,nminus
                    1102                             ;jnb            bitznak,nminus
                    1103                     
05C3 7894           1104                             mov             r0,#koefKm;->r8..r11
05C5 120000   F     1105     nminus:         call    resar8
05C8 120203         1106                             call    flmul  ;результат в плавающем формате м.б. его сохранить?
                    1107                     
                    1108                     ;;;;;;;;        call    ftol                    ;float->int
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    18

05CB 785E           1109                             mov             r0,#rez_Ame
05CD 120000   F     1110                             call    saver2
                    1111      ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1112      ;;;;;;;;;;;;;;;;;;;;;;;;;;
05D0                1113     afterK:                 
                    1114     ;;;;;;;;;;;;;;
                    1115                             ;;;;;;  call    altof                   ;r2..r5->float
05D0 EA             1116                                     mov             a,r2
05D1 547F           1117                                     anl             a,#7fh
05D3 FA             1118                                     mov             r2,a
05D4 900000   F     1119                                     mov     dptr,#ch_220;220000
05D7 120000   F     1120                                     call    ldc_ltemp                       ;r8..r11=8
05DA 1201D6         1121                                     call    flcmp
                    1122                             ;       jnc             rmo220          ;A>220000
05DD 120000   F     1123                                     call            findkoef                                ;r2
                             ,r3-hex
05E0 12046C         1124                                     call            rebyte2                         ;r2..r5- he
                             x
                    1125                                     
05E3 120402         1126                                     call    altof                   ;r2..r5->float
05E6 900000   F     1127                                     mov     dptr,#CHtho;100000
05E9 120000   F     1128                                     call    ldc_ltemp                       ;r8..r11=8
05EC 1202B7         1129                                     call    fldiv
05EF 120000   F     1130                                     call    move28
05F2 785E           1131                                     mov             r0,#rez_Ame
05F4 120000   F     1132                                     call    resar2
                    1133                     
05F7 120203         1134                                     call    flmul     ;A1-=A-*KD  fl
                    1135                                     
05FA 120343         1136                                     call    ftol                    ;float->int
05FD 7866           1137                                     mov             r0,#rez_A1
05FF 120000   F     1138                                     call    saver2
0602 120402         1139                                     call    altof                   ;r2..r5->float
0605 900000   F     1140                                     mov     dptr,#ch_200;200000
0608 120000   F     1141                                     call    ldc_ltemp                       ;r8..r11=8
060B 1201D6         1142                                     call    flcmp
                    1143                                     ;jnc            mo220           ;A>200000
060E 301806         1144                                     jnb             knizm,goA2;             bitizm,goA2     
0611 200526         1145                                     jb              bitavp,yesavp   
0614 200650         1146     noavp:                  jb              bitvi11,yesvich
0617                1147     goA2:                    ;A2=A1-
0617 7866           1148                                      mov            r0,#rez_A1
0619 120000   F     1149                                     call    resar2
061C 787B           1150                                     mov             r0,#rez_A2
061E 120000   F     1151                                     call    saver2
0621                1152     goA3A2:                  ;A3=A2-A0
0621 786A           1153                                       mov           r0,#rez_A0
0623 120000   F     1154                                     call    resar8
0626 120000   F     1155                                     call    lsub
0629 789C           1156                                     mov             r0,#rez_A3
062B 120000   F     1157                                     call    saver2
                    1158                                     ;;;;;;
062E                1159     goonin:            ;jmp         goonind;indA3;8.11.06
062E 78AC           1160                                     mov             r0,#chind
0630 B60005         1161                                     cjne    @r0,#0,rnochi0
0633 020000   F     1162                                     jmp             goonind;indA3
                    1163     ;                               clr             P3.4
                    1164     ;                               nop
                    1165     ;                               nop
                    1166     ;                               setb    P3.4      ;??????????????????????/
                    1167     ;                               jmp             nop3_0
                    1168     
                    1169     ;                               jb              P3.0,nop3_0     ;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1170     ;                               mov             r0,#rez_A0              ;r2..r5->rez_A0
                    1171     ;                               call    saver2                  ;ЗАПОМНИТЬ СМЕЩЕНИЕ НУЛЯ
                    1172     ;                               jmp             rebyte          ;age2
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    19

0636 804B           1173      rmo220:                jmp             mo220
0638 8078           1174      rnochi0:               jmp             nochi0
                    1175     
                    1176     ;;;;;;;;;;;;;;;;
063A EA             1177     yesavp:                 mov             a,r2
063B 547F           1178                                     anl             a,#7fh
063D FA             1179                                     mov             r2,a
063E 900000   F     1180                                     mov     dptr,#ch_10th;10000
0641 120000   F     1181                                     call    ldc_ltemp                       ;r8..r11=8
0644 1201D6         1182                                     call    flcmp
0647 50CB           1183                                     jnc             noavp           ;A>10000        
0649 78AE           1184                                     mov             r0,#diap                ;10-11
064B B60902         1185                                     cjne    @r0,#9,avpgo
064E 80C4           1186                                     jmp             noavp
0650                1187     avpgo:                  
0650 06             1188                                     inc             @r0             ;переключ диапазон на 1 поз
                             ицию вниз
0651 B60A01         1189                                     cjne    @r0,#0ah,clmasv
0654 16             1190                                     dec             @r0
0655                1191     clmasv:         ;сбросить массив
0655 120000   F     1192                             call    loadUS
                    1193                             ;call   louizm
0658 120000   F     1194                             call     clmassix
065B 78B3           1195                                     mov             r0,#summa
065D 120000   F     1196                                     call    clear4
0660 786A           1197                                     mov             r0,#rez_A0
0662 120000   F     1198                                     call    clear4                                             
                                                   
0665 80C7           1199                                jmp     goonin
                    1200     
0667                1201     yesvich:        ;A2=E/A1-+F
0667 78A4           1202                                      mov            r0,#constE
0669 120000   F     1203                                     call    resar2
066C 7866           1204                                       mov           r0,#rez_A1
066E 120000   F     1205                                     call    resar8
0671 1202B7         1206                                     call    fldiv
0674 78A8           1207                                      mov    r0,#constF
0676 120000   F     1208                                     call    resar8
0679 120166         1209                                     call    fladd
067C 787B           1210                                     mov             r0,#rez_A2
067E 120000   F     1211                                     call    saver2
0681 809E           1212                                     jmp             goA3A2
                    1213     
0683 300508         1214     mo220:             jnb          bitavp,indoll
0686 301805         1215                                jnb          knizm,indoll;bitizm,indoll
0689 78AE           1216                                     mov             r0,#diap
068B B6000A         1217                                     cjne    @r0,#0,nodi2
                    1218                                ;10-2
068E 900000   F     1219     indoll:                 mov             dptr,#teOLL;OLL
0691 120000   F     1220                                     call    lotext
0694 D217           1221                                     setb    bitoll
0696 8096           1222                                     jmp             goonin  
                    1223     
0698 16             1224     nodi2:             dec          @r0     ;переключить на 1 позицию вверх
                    1225     
0699 B6FF01         1226                                     cjne    @r0,#0ffh,nodi9
069C 06             1227                                     inc             @r0
                    1228     
069D 120000   F     1229     nodi9:          call    loadUS
                    1230                                     ;call   louizm
                    1231                                     ;сбросить массив
06A0 120000   F     1232                                     call     clmassix
06A3 78B3           1233                                     mov             r0,#summa
06A5 120000   F     1234                                     call    clear4
06A8 786A           1235                                     mov             r0,#rez_A0
06AA 120000   F     1236                                     call    clear4  
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    20

06AD D207           1237                                     setb    bitzus  ;флаг задержки  после установки us         
                                                                   
06AF 020000   F     1238                                jmp     goonin
                    1239     
06B2 16             1240     nochi0:                 dec             @r0                     ;СТИ-1
06B3 020000   F     1241                                     jmp             labelB  
                    1242     
                    1243             
                    1244     ;;;;;;;;;;;;;;;
                    1245     
06B6                1246     nop3_0: ;;      ;rez_A-rez_A0
                    1247                     ;;                      mov             r0,#rez_A0
                    1248                     ;;                      call    resar8
                    1249                     ;;                      call    lsub
                    1250                     ;;                      mov             r0,#rez_A
                    1251                     ;;;                     call    saver2
                    1252      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
06B6 789C           1253      indA3:                         mov             r0,#rez_A3       ;A3 ->в десятич форму(6дес
                              разрядов и в кои)
06B8 120000   F     1254                                             call    resar2
06BB 900000   F     1255                                             mov             dptr,#ch100              
06BE 120000   F     1256                                             call    ldc_ltemp        
06C1 120000   F     1257                                             call    zdiv            ;rez_A3/100=r2..r5
                    1258                                     
06C4 EC             1259                                             mov             a,r4
06C5 20E71E         1260                                             jb              acc.7,aless0
06C8 4408           1261                                             orl             a,#08                   ;rez_A>0 d1
                             1=1
06CA F5D3           1262                                             mov             DAC0H,a
                    1263                                                                             ;мл байт
06CC ED             1264                                             mov             a,r5
06CD F5D2           1265                                             mov             DAC0L,a
06CF 801E           1266                                             jmp             moveA3;
                    1267     
06D1 B70207         1268     no3parN:                        cjne    @r1,#2,no2parN
                    1269                                             ;в байт 0  записать пробел
06D4 7946           1270                                             mov             r1,#bufind+6
06D6 7720           1271                                             mov             @r1,#" ";0fdh;
06D8 020000   F     1272                                             jmp             seeind;moveA3
                    1273     
06DB                1274     no2parN:                        ;в байты 0 и 1 записать пробел
06DB 7945           1275                                             mov             r1,#bufind+5
06DD 7720           1276                                             mov             @r1,#" ";0fdh;" "
06DF 09             1277                                             inc             r1
06E0 7720           1278                                             mov             @r1,#" ";0fdh;" "
06E2 807B           1279                                             jmp             seeind;moveA3
06E4 8079           1280      rseeind:               jmp             seeind
06E6 F4             1281     aless0:                         cpl             a
06E7 54F7           1282                                             anl             a,#0f7h         ;d11=0
06E9 F5D3           1283                                             mov             DAC0H,a
                    1284                                                                             ;мл байт
06EB ED             1285                                             mov             a,r5
06EC F4             1286                                             cpl             a
06ED F5D2           1287                                             mov             DAC0L,a
06EF                1288     goonind:                  ; ВЫДАЧА НА ИНДИКАТОР РЕЗУЛЬТАТА
                    1289                                     
                    1290                                             
06EF                1291     moveA3: ;нажата кн вычR не выдавать на индикатор не портить bufind..
                    1292                     ;по нажатию кн по прерыванию по выходу из прерыв прог доходит
                    1293                     ;до конца цикла измерения результат не размещать в буфере
                    1294                     ;не забывать сбрасывать по выходу из режима обр кнопки 
                    1295                     ;и возврату в режим измерения
06EF 201458         1296                                             jb              bitvich,rnorvich
06F2 201055         1297                                             jb              bitt2,rnorvich
06F5 2017EC         1298                                             jb              bitoll,rseeind
                    1299             
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    21

                    1300     ;;;;;;;;;;;;;;
06F8 789C           1301                                              mov            r0,#rez_A3
06FA 120000   F     1302                                             call    resar2
06FD 120343         1303                                             call    ftol                    ;float->int r2..r5
                    1304     ;;;;;;;;
0700 789C           1305                                             mov             r0,#rez_A3;->r2..r5       передать 
                             A3 в индикатор
0702 120000   F     1306                                             call    resar2
                    1307                                     
0705 120000   F     1308                                             call    maform
0708 784F           1309                                             mov             r0,#abin
070A 120000   F     1310                                             call    saver2
                    1311     ;;;;;;;;
                    1312                                             
070D 7853           1313                                             mov             r0,#adec
070F 7952           1314                                             mov             r1,#abin+3      ;hex->10
0711 120000   F     1315                                             call    bindec
                    1316                                     
0714 785C           1317                                             mov             r0,#adec+9;разместить в буфер индик
                             ации
0716 7946           1318                                             mov             r1,#bufind+6
0718 7F07           1319                                             mov             r7,#7
071A E6             1320     bufdec:                         mov             a,@r0
071B 2430           1321                                             add             a,#30h
071D F7             1322                                             mov             @r1,a
071E 19             1323                                             dec             r1
071F 18             1324                                             dec             r0
0720 DFF8           1325                                             djnz    r7,bufdec
0722 7847           1326                                             mov             r0,#bufind+7
0724 762D           1327                                             mov             @r0,#2dh          ;-2..-9
0726 7840           1328                                             mov             r0,#bufind
0728 762B           1329                                             mov             @r0,#2bh
072A 300202         1330                                             jnb             znmat,nozzmi;bitznak,nozzmi
072D 762D           1331                                             mov             @r0,#2dh
072F 79AE           1332     nozzmi:                         mov             r1,#diap
0731 7848           1333                                             mov             r0,#bufind+8
0733 E7             1334                                             mov             a,@r1
0734 B40808         1335                                             cjne    a,#8,nodi8
0737 7630           1336                                             mov             @r0,#30h                 ;10-10
0739 18             1337                                             dec             r0
073A 7663           1338                                             mov             @r0,#63h;31h
073C 08             1339                                             inc             r0
073D 8012           1340                                             jmp             seegoon
073F B4090C         1341     nodi8:                          cjne    a,#9,nodis9
                    1342                                     
0742 7631           1343                                             mov             @r0,#31h           ;10-11
0744 18             1344                                             dec             r0
0745 7663           1345                                             mov             @r0,#63h;31h
                    1346                                     
0747 08             1347                                             inc             r0
0748 8007           1348                                             jmp             seegoon
                    1349     
074A 8051           1350     rnorvich:               jmp             norvich
074C 8083           1351     rno3parN:               jmp             no3parN
                    1352     
074E 2432           1353     nodis9:                         add             a,#32h
0750 F6             1354                                             mov             @r0,a;#37h;"T";
0751 08             1355     seegoon:                        inc             r0
0752 7641           1356                                             mov             @r0,#"A";"E";
0754 08             1357                                             inc             r0
0755 7600           1358                                             mov             @r0,#00h ;=feh в нач установе для п
                             оджига всех сегм
0757 08             1359                                             inc             r0;             mov             buf
                             ind+11
0758 76C0           1360                                             mov             @r0,#0c0h
                    1361                                             
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    22

                    1362     ;;;;;;;;;;;;;;;
                    1363     ;;;;;;goonind:
075A 79AF           1364                                             mov             r1,#parN        ; ??????
075C B703ED         1365                                             cjne    @r1,#3,rno3parN ;  8.11.06
                    1366                                     
                    1367             
075F                1368     seeind:                         ;;;;;;;;;;;;;
075F 784A           1369                                             mov             r0,#bufind+10
0761 E6             1370                                             mov             a,@r0
0762 300F03         1371                                             jnb             bitnul,nnnul
0765 4408           1372                                             orl             a,#08h
0767 F6             1373                                             mov             @r0,a
0768 799A           1374      nnnul:                         mov             r1,#parT
076A B70304         1375                                             cjne    @r1,#3,nsec01
076D 4410           1376                                             orl             a,#10h
076F 800C           1377                                             jmp             nsec10   ;0,1s
0771 B70204         1378      nsec01:                        cjne    @r1,#2,nsec1
0774 4420           1379                                             orl             a,#20h    ;1s
0776 8005           1380                                             jmp             nsec10
0778 B70102         1381     nsec1:                          cjne    @r1,#1,nsec10
077B 4440           1382                                             orl             a,#40h
                    1383     
                    1384     ;;;;;;;;;;;;;;;;
077D F6             1385     nsec10:                         mov             @r0,a
077E 300504         1386                                             jnb             bitavp,nobavp
0781 4404           1387                                             orl             a,#04           ;bufind+10.2
0783 F6             1388                                             mov             @r0,a
0784 F6             1389                                             mov             @r0,a   
0785 301803         1390     nobavp:                    jnb          knizm,nobitizm
0788 4402           1391                                             orl             a,#02
078A F6             1392                                              mov            @r0,a
078B                1393     nobitizm:                       
078B 301A07         1394                                             jnb             bitakt,notakt
078E C21A           1395                                             clr             bitakt
0790 534AFE         1396                                             anl             bufind+10,#0feh
0793 8005           1397                                             jmp             taktind
0795 D21A           1398     notakt:                         setb    bitakt
0797 434A01         1399                                             orl             bufind+10,#01                      
                                          
079A 120000   F     1400     taktind:                        call    ind        ;пп выдачи на индикатор
079D                1401     norvich: 
079D 789A           1402                                     mov             r0,# parT
079F 79AC           1403                                             mov             r1,#chind
07A1 B60177         1404                                             cjne    @r0,#1,rnot1in
07A4                1405     labelB:                    ;;;;;;;;;;;
                    1406                                             ;сдвиг по алгоритму чтобы посмотреть в цапе 
07A4 789F           1407                                                     mov     r0,#rez_A3+3
                    1408                             ;;;;;;;;
07A6 79BB           1409                             mov             r1,#work+3
07A8 E6             1410                             mov             a,@r0
07A9 7F07           1411                             mov             r7,#7;кол сдв вправо
07AB C3             1412     dvig3:          clr             c
07AC 13             1413                             rrc             a
07AD DFFC           1414                             djnz    r7,dvig3 ;d7,d6,d5        мл байт
07AF FA             1415                             mov             r2,a    ;сохр байт
07B0 18             1416                             dec             r0              ;rez_A3+2
07B1 E6             1417                             mov             a,@r0
07B2 C0E0           1418                             push    acc
07B4 C3             1419                             clr             c
07B5 7F01           1420                             mov             r7,#1
07B7 C3             1421     dvig2:          clr             c
07B8 33             1422                             rlc             a
07B9 DFFC           1423                             djnz    r7,dvig2 ;d12..d11       средний байт
07BB 4A             1424                             orl             a,r2
07BC F7             1425                             mov             @r1,a;сформ мл байт
07BD 19             1426                             dec             r1
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    23

07BE D0E0           1427                             pop             acc
                    1428                             
07C0 7F07           1429                             mov             r7,#7
07C2 C3             1430     dvig1:          clr             c
07C3 13             1431                             rrc             a
07C4 DFFC           1432                             djnz    r7,dvig1 ;d18     ср байт
07C6 FA             1433                             mov             r2,a   ;сохр
07C7 18             1434                             dec             r0
07C8 E6             1435                             mov             a,@r0 ;rez_A3+1
07C9 C0E0           1436                             push    acc
                    1437                     
07CB 7F01           1438                             mov             r7,#1
07CD C3             1439     dvig0:          clr             c
07CE 33             1440                             rlc             a
07CF DFFC           1441                             djnz    r7,dvig0 ;        d21..d16
07D1 4A             1442                             orl             a,r2
07D2 F7             1443                             mov             @r1,a   ; сформ средний  байт
07D3 19             1444                             dec             r1
07D4 D0E0           1445                             pop             acc       ;rez_A3+1
                    1446                             ;;;;;;;;;;;;;;
                    1447     ;                       jb              acc.7,dvm
07D6 C3             1448                             clr             c
07D7 7F07           1449                             mov             r7,#7
07D9 C3             1450     dvig4:          clr             c
07DA 13             1451                             rrc             a
07DB DFFC           1452                             djnz    r7,dvig4 ;        d22
07DD FA             1453                             mov             r2,a   ;сохр
07DE 18             1454                             dec             r0;     rez_A3
07DF E6             1455                             mov             a,@r0
                    1456                             ;;;;;
07E0 7F01           1457                             mov             r7,#1
07E2 C3             1458     vig0:           clr             c
07E3 33             1459                             rlc             a
07E4 DFFC           1460                             djnz    r7,vig0 ;         d24..d30
07E6 4A             1461                             orl             a,r2
07E7 F7             1462                             mov             @r1,a   ; сформ   байт
07E8 19             1463                             dec             r1
07E9 E6             1464                             mov             a,@r0
                    1465                             ;;;;;
07EA 20E709         1466                             jb              acc.7,dvm
07ED C3             1467                             clr             c
07EE 7F07           1468                             mov             r7,#7
07F0 C3             1469     vig4:           clr             c
07F1 13             1470                             rrc             a
07F2 DFFC           1471                             djnz    r7,vig4 ;         d
07F4 8006           1472                             jmp             endsdv
                    1473     ;;;;;;;;;;;;                                    
07F6 7F07           1474     dvm:            mov             r7,#7
07F8 D3             1475     dvig6:          setb            c
07F9 13             1476                             rrc             a
07FA DFFC           1477                             djnz    r7,dvig6 ;        d31
07FC F7             1478     endsdv:         mov             @r1,a
                    1479                                                             
                    1480      ;->work   
                    1481                             
07FD 900000   F     1482                             mov             dptr,#chzap
0800 120000   F     1483                             call     ldc_long
0803 78BB           1484                              mov            r0,#work+3
0805 120000   F     1485                             call    ladd
0808 ED             1486                             mov             a,r5
0809 F5D5           1487                             mov             DAC1L,a
                    1488                             
080B EC             1489                             mov             a,r4
080C F5D6           1490                             mov             DAC1H,a
                    1491     
                    1492                                             ;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    24

080E 78AD           1493                                             mov             r0,#chbuf         ;T=1
0810 B6002F         1494                                             cjne    @r0,#0,nobuf0
0813 200907         1495                                             jb              bitprd,yesprd   ;передать   A3 в бу
                             фер
0816 200A06         1496                                             jb              bitbon,yesbuf   ;записать   A3 в бу
                             фер
0819 801A           1497                                             jmp             gocikle
081B 8028           1498     rnot1in:                jmp             not1in
081D                1499     yesprd: ;передать   A3 в буфер
081D 8000           1500                                             jmp             goonT
081F                1501     yesbuf: ;записать   A3 в буфер
081F 789A           1502     goonT:                          mov             r0,#parT
0821 79AD           1503                                             mov             r1,#chbuf
0823 B60102         1504                                             cjne    @r0,#1,nott1
                    1505                                     ;       mov             @r1,#
0826 800D           1506                                             jmp             gocikle
                    1507     
0828 B60502         1508     nott1:                          cjne    @r0,#5,nott5
                    1509     
082B 8008           1510                                             jmp             gocikle
                    1511     
082D C3             1512     nott5:           clr            c
082E 799A           1513                             mov             r1,#parT
0830 7404           1514                             mov             a,#4
0832 97             1515                             subb    a,@r1
0833 500B           1516                             jnc             yestt5          ;T<5
0835 300805         1517     gocikle:        jnb             bitbuf,nofz                                     
0838 120000   F     1518                             call    z_01s    ;0,5c
083B C208           1519                             clr     bitbuf
083D 020000   F     1520     nofz:           jmp     labelA;rebyte
                    1521     
                    1522     
0840 80F3           1523     yestt5:         jmp             gocikle
                    1524     
0842 16             1525     nobuf0:                         dec             @r0
0843 80F0           1526                                             jmp             gocikle
                    1527     
                    1528     
0845 B60205         1529     not1in:                         cjne    @r0,#2,not2in
0848 7701           1530                                             mov             @r1,#1           ;T=2
084A 020000   F     1531                                             jmp     labelB
                    1532     
084D B60305         1533     not2in:                         cjne    @r0,#3,not3in
0850 7709           1534                                             mov             @r1,#9          ;T=3
0852 020000   F     1535                                             jmp     labelB
0855 7713           1536     not3in:                         mov             @r1,#19
0857 020000   F     1537                                             jmp     labelB
                    1538     
                    1539     
                    1540     ;;;;;;;;;;;3.11.06
                    1541     
                    1542     ;;коррекция 0
085A 7883           1543     KORnul:         mov             r0,#chdel
085C B60008         1544                             cjne    @r0,#0,nonuldel
                    1545                                     
                    1546                     ;       mov             a,P5       ;p5.3=1
                    1547                     ;       orl             a,#08
                    1548                     ;       mov             P5,a
                    1549                     ;       nop
                    1550                     ;       nop
                    1551                                     
                    1552                     ;       mov             a,P5              ;p5.0=0
                    1553                     ;       anl             a,#0feh
                    1554                     ;       mov             P5,a
                    1555             
085F 900000   F     1556                             mov             dptr,#kor0us
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    25

0862 120000   F     1557                             call    lospus          ;упр слово коррекции 0
0865 8013           1558                             jmp             chdelmo
                    1559     
0867                1560     nonuldel:       ;cjne   @r0,#7,no4del
0867 B60316         1561                                                     cjne    @r0,#3,no4del
                    1562                             ;рез ->AN
086A 7862           1563                             mov             r0,#rez_A;->r2..r5
086C 120000   F     1564                             call    resar2
                    1565                     ;       mov             a,reacp         ;r2..r5 &&&&&&&&&&&
                    1566                     ;               mov             r2,a
                    1567                     ;               mov             a,reacp+1
                    1568                     ;               mov             r3,a
                    1569                     ;               mov             a,reacp+2
                    1570                     ;               mov             r4,a
                    1571                     ;               mov             a,reacp+3
                    1572                     ;               mov             r5,a
                    1573                                     ;;;;;;;;;;
086F 120402         1574                             call    altof           ;r2..r5->float
0872 7884           1575                             mov             r0,#kor0_AN;->kor0_AN
0874 120000   F     1576                             call    saver2
                    1577                                     
                    1578                     ;       mov             a,P5            ;p5.0=1
                    1579                     ;       orl             a,#01
                    1580                     ;       mov             P5,a
                    1581                     ;       nop
                    1582                     ;       nop
                    1583                                     
                    1584                     ;       mov             a,P5                    ;p5.3=0 
                    1585                     ;       anl             a,#0f7h
                    1586                     ;       mov             P5,a                    
0877 120000   F     1587                             call    loadUS          ;восстан исходное упр слово
087A 7883           1588     chdelmo:        mov             r0,#chdel
087C 06             1589                             inc             @r0             ;chdel+1
087D 020000   F     1590                             jmp              rebyte
                    1591     
0880                1592     no4del:         ;cjne   @r0,#14,chdelmo
0880 B606F7         1593                                             cjne    @r0,#6,chdelmo
0883 7600           1594                             mov             @r0,#0          ;chdel
0885 7898           1595                             mov             r0,#chinkor
0887 7600           1596                             mov             @r0,#00;1;00;02;600;
0889 08             1597                             inc             r0
088A 76C8           1598                             mov             @r0,#0c8h;90h;0c8h;58h;258h
088C 120000   F     1599                             call    clmassix;сбросить массив скольз среднего
088F 020000   F     1600                             jmp              rebyte
                    1601     
                    1602     ;автокалибровка
0892                1603     autoka:  ;;  mov                r0,#chavt
                    1604                      ;;  call               chcmp
                    1605                      ;;  jz         nulavt
                    1606                     ;;   mov                r1,#chavt
                    1607                     ;;   call               chdec;chavt-1
                    1608                      ;; jmp         rebyte
0892                1609     nulavt:  ;;;;;
0892 7883           1610                             mov             r0,#chdel
0894 B6000E         1611                             cjne    @r0,#0,nndelch
0897 E585           1612                             mov   a,p5
0899 4404           1613                             orl             a,#04              ;p5.2=1
089B 00             1614                             nop
089C 00             1615                             nop
089D 543F           1616                             anl             a,#3fh          ;p5.6,p5.7=0
089F F585           1617                             mov   p5,a
08A1 06             1618                             inc             @r0
08A2 020000   F     1619                             jmp              rebyte
                    1620     
08A5 B6033D         1621     nndelch:        cjne    @r0,#3,n4delch
                    1622                             ;pez->A+
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    26

                    1623                             ;K+=000/(A+-AN)
                    1624                             ;mov            r0,#rez_A;->r2..r5
                    1625                             ;call   resar2
08A8 E577           1626                                     mov             a,reacp         ;r2..r5 &&&&&&&&&&&
08AA FA             1627                                     mov             r2,a
08AB E578           1628                                     mov             a,reacp+1
08AD FB             1629                                     mov             r3,a
08AE E579           1630                                     mov             a,reacp+2
08B0 FC             1631                                     mov             r4,a
08B1 E57A           1632                                     mov             a,reacp+3
08B3 FD             1633                                     mov             r5,a
                    1634                                     ;;;;;;;;;;;;;;;
08B4 120402         1635                             call    altof                   ;r2..r5->float
08B7 7888           1636                             mov             r0,#rezAp;->rezAp
08B9 120000   F     1637                             call    saver2                          
08BC 7884           1638                             mov             r0,#kor0_AN;kor0_AN->r8..r11
08BE 120000   F     1639                             call    resar8                          
08C1 1201D1         1640                             call    flsub           ; r2..r5(A+-AN)
08C4 120000   F     1641                             call    move28     ;r2..r5->r8..r11
08C7 900000   F     1642                             mov             dptr,#CH2tho;000->r2..r5 float
08CA 120000   F     1643                             call    ldc_long                
08CD 1202B7         1644                             call    fldiv
08D0 EA             1645                             mov             a,r2
08D1 547F           1646                             anl             a,#7fh
08D3 FA             1647                             mov             r2,a
08D4 7890           1648                             mov             r0,#koefKp;->koefKp
08D6 120000   F     1649                             call    saver2
                    1650                       
                    1651                     ;       anl             P5,#0feh                ;p5.0=0 
08D9 E585           1652                     mov             a,P5
08DB 543B           1653                             anl             a,#3bh;acp-
08DD F585           1654                             mov             P5,a
08DF 7883           1655                             mov             r0,#chdel
08E1 06             1656                             inc             @r0                       ;ch+1
08E2 020000   F     1657                             jmp             rebyte
                    1658     
08E5 B6063A         1659     n4delch:        cjne    @r0,#6,n8delch
                    1660                             ; pez->A-
                    1661                             ;K-=000/(A--AN)
                    1662                     ;       mov     r0,#rez_A;->r2..r5
                    1663                     ;       call    resar2
08E8 E577           1664                             mov             a,reacp         ;r2..r5 &&&&&&&&&&&
08EA FA             1665                                     mov             r2,a
08EB E578           1666                                     mov             a,reacp+1
08ED FB             1667                                     mov             r3,a
08EE E579           1668                                     mov             a,reacp+2
08F0 FC             1669                                     mov             r4,a
08F1 E57A           1670                                     mov             a,reacp+3
08F3 FD             1671                                     mov             r5,a
                    1672                                     ;;;;;;;;;;;;;;;
08F4 120402         1673                             call    altof                   ;r2..r5->float
08F7 788C           1674                             mov             r0,#rezAm;->rezAm
08F9 120000   F     1675                             call    saver2                          
08FC 7884           1676                             mov             r0,#kor0_AN;kor0_AN->r8..r11
08FE 120000   F     1677                             call    resar8                          
0901 1201D1         1678                             call    flsub                   ; r2..r5(A--AN)
0904 120000   F     1679                             call    move28                  ;r2..r5->r8..r11
0907 900000   F     1680                             mov             dptr,#CH2tho    ;000->r2..r5 float
090A 120000   F     1681                             call    ldc_long                
090D 1202B7         1682                             call    fldiv
0910 EA             1683                             mov             a,r2
0911 547F           1684                             anl             a,#7fh
0913 FA             1685                             mov             r2,a
0914 7894           1686                             mov             r0,#koefKm;->koefKm
0916 120000   F     1687                             call    saver2
                    1688                        
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    27

0919 120000   F     1689                             call    loadus
091C 7883           1690                             mov             r0,#chdel
091E 06             1691                             inc             @r0                       ;ch+1
091F 020000   F     1692                        jmp    rebyte
                    1693     
0922 B6090F         1694     n8delch:        cjne    @r0,#9,n12delch
0925 7600           1695                             mov             @r0,#0
0927 7981           1696                             mov             r1,#chavt
0929 770C           1697                             mov             @r1,#0ch;6;1;
092B 09             1698                             inc             r1
092C 7780           1699                             mov             @r1,#80h;40h;
092E 120000   F     1700                             call   clmassix     ;сбросить массив среднего
0931 020000   F     1701                             jmp             rebyte
0934 06             1702     n12delch:       inc             @r0
0935 020000   F     1703                             jmp             rebyte
                    1704     
                    1705     ;in-r1-count
0938                1706     chdec:          ;mov            r1,#chavt               ;chavt-1
0938 E7             1707                             mov             a,@r1
0939 FC             1708                             mov             r4,a
093A 09             1709                             inc             r1
093B E7             1710                             mov             a,@r1
093C FD             1711                             mov             r5,a
093D C202           1712                             clr             rr2
093F C203           1713                             clr             rr3
0941 900000   F     1714                             mov             dptr,#ch1        
0944 120000   F     1715                             call    ldc_ltemp
0947 120000   F     1716                             call    lsub
094A ED             1717                             mov             a,r5
094B F7             1718                             mov             @r1,a
094C 19             1719                             dec             r1
094D EC             1720                             mov             a,r4
094E F7             1721                             mov             @r1,a
094F 22             1722                             ret      
                    1723     
                    1724     
                    1725     
                    1726     ;пп выдачи на индикатор 12 байт   bufind..bufind+11
0950 75E700         1727      ind:   mov             EIE2,#00H;mov   IE,#00h
0953 120000   F     1728                     call    mign
0956 7840           1729                      mov            r0,#bufind;+11
0958 7F0C           1730                      mov            r7,#12
095A C286           1731      nexin: clr             p0.6
095C E6             1732                     mov             a,@r0
095D F59B           1733                     mov             SPI0DAT,a
095F 20FBFD         1734                     jb              TXBSY,$
0962 D286           1735                     setb    p0.6
0964 120000   F     1736                     call    z_9             ;25mks
0967 08             1737                     inc             r0;dec          r0
0968 DFF0           1738                     djnz    r7,nexin
096A 75E730         1739                     mov             EIE2,#30H;mov   IE,#80h
096D 22             1740                ret
                    1741     
                    1742     
096E 7A08           1743     zapadc:   mov R2,#8
0970 D297           1744     sdv:      setb P1.7
0972 33             1745               rlc A
0973 9296           1746                     mov P1.6,C
0975 120000   F     1747                     call tim2
                    1748                                     
0978 C297           1749                     clr P1.7
097A 120000   F     1750                     call tim2
097D DAF1           1751                     djnz R2,sdv
097F D296           1752                     setb P1.6
0981 22             1753                     ret
                    1754     
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    28

0982 7A08           1755     chtadc:   mov R2,#8
0984 D297           1756     sdv1:     setb P1.7
0986 120000   F     1757               call tim2
0989 C297           1758                     clr P1.7
098B A296           1759                     mov C,P1.6
098D 33             1760                     rlc A
098E 120000   F     1761                     call tim2
0991 DAF1           1762                     djnz R2,sdv1
0993 22             1763                     ret
                    1764     
0994 7E30           1765     tim:      mov R6,#30h;38h
0996 DEFE           1766     tim1:     djnz R6,tim1
0998 22             1767               ret
                    1768               
0999 7E10           1769     tim2:     mov R6,#10h;14h
099B DEFE           1770     tim3:     djnz R6,tim3
099D 22             1771               ret
                    1772     
                    1773     ;запись из acc
099E C3             1774     write_x1: clr   c
099F                1775     writeD_x1:
099F 92B1           1776                       mov P3.1,c        ;запись
09A1 F5A0           1777               mov P2,A
09A3 D2B3           1778                       setb P3.3
09A5 120000   F     1779                       call z_5
09A8 C2B3           1780                       clr P3.3
09AA 75A0FF         1781                       mov P2,#0FFh
09AD 22             1782                       ret
                    1783     
                    1784     ;чтение в acc
09AE C3             1785     read_x2:  clr   c  
09AF 92B1           1786               mov P3.1,c        ;чтение
09B1 D2B2           1787               setb P3.2
09B3 D2B3           1788                       setb P3.3
09B5 120000   F     1789                     call z_5
09B8 E5A0           1790                       mov A,P2
09BA C2B3           1791                       clr P3.3
09BC C2B2           1792                       clr P3.2
09BE 22             1793                       ret
                    1794     
                    1795     
09BF 120000   F     1796     loop:     call read_x2;x2    ;ожидание флага готовности
09C2 20E7FA         1797                       jb ACC.7,loop     ;переход на чтение, если бит А(7)=1
09C5 22             1798                        ret           ;возврат, если бит А(7)<>1
                    1799                                      
                    1800                                        
                    1801     
                    1802     
                    1803     
                    1804     ;dptr+4-приемник
                    1805     ;dptr-источник
                    1806     ;r7-кол байт  
09C6                1807     xCIKLWR:
09C6 7F04           1808                             mov             r7,#4   
09C8 E0             1809     lwrx:   movx    a,@dptr
09C9 C083           1810                             push    dph
09CB C082           1811                             push    dpl
09CD A3             1812                             inc             dptr
09CE A3             1813                             inc             dptr
09CF A3             1814                             inc             dptr
09D0 A3             1815                             inc             dptr
09D1 F0             1816                             movx    @dptr,a
09D2 D082           1817                             pop             dpl
09D4 D083           1818                             pop             dph
                    1819                             
09D6 A3             1820                             inc             dptr
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    29

09D7 DFEF           1821                             djnz    r7,lwrx
09D9 22             1822                             ret
                    1823     ;r2..r5->@dptr..@dptr+3                         
09DA EA             1824     saveIr2:                mov     a,r2
09DB F0             1825                                             movx    @dptr,a
09DC A3             1826                                             inc     dptr
09DD EB             1827                                             mov     a,r3
09DE F0             1828                                             movx    @dptr,a
09DF A3             1829                                             inc     dptr
09E0 EC             1830                                             mov     a,r4
09E1 F0             1831                                             movx    @dptr,a
09E2 A3             1832                                             inc     dptr
09E3 ED             1833                                             mov     a,r5
09E4 F0             1834                                             movx    @dptr,a
09E5 22             1835                                             ret
                    1836     ;r2..r5-> @r0..@r0+3
                    1837     
09E6 EA             1838     saver2:         mov     a,r2
09E7 F6             1839                                             mov     @r0,a
09E8 08             1840                                             inc     r0
09E9 EB             1841                                             mov     a,r3
09EA F6             1842                                             mov     @r0,a
09EB 08             1843                                             inc     r0
09EC EC             1844                                             mov     a,r4
09ED F6             1845                                             mov     @r0,a
09EE 08             1846                                             inc     r0
09EF ED             1847                                             mov     a,r5
09F0 F6             1848                                             mov     @r0,a
09F1 22             1849                                             ret 
09F2 7F50           1850     clmassix:       mov                     r7,#50h;28h
09F4 900080         1851                             mov     dptr,#MASS0        ;забить массив A нулями
09F7 7400           1852     clmax:          mov          a,#00h
09F9 F0             1853                  movx    @dptr,a
09FA A3             1854                  inc     dptr
09FB DFFA           1855                 djnz                r7,clmax                
09FD F56E           1856                  mov     chmas,a
09FF C201           1857                  clr     bitmas
0A01 22             1858                 ret
                    1859     
                    1860     ;r1-яЁшхьшъ
                    1861     ;r0-шёЄюўшъ
                    1862     ;r7-ъюы срщЄ  
0A02                1863     CIKLWR:
0A02 7F04           1864                             mov             r7,#4   
0A04 E6             1865     lwr:    mov     a,@r0
0A05 F7             1866                             mov     @r1,a
0A06 09             1867                             inc             r1
0A07 08             1868                             inc             r0
0A08 DFFA           1869                             djnz    r7,lwr
0A0A 22             1870                             ret     
                    1871     ;r2..r5-> @dptr..@dptr+3
                    1872     
0A0B 120000   F     1873     zmul:   call    maform
0A0E 120000   F     1874                     call    lmul
0A11 120000   F     1875                     call    bform
0A14 22             1876                     ret
                    1877     
0A15 120000   F     1878     zdiv:   call    maform
0A18 120000   F     1879                     call    divide
0A1B 120000   F     1880                     call    bform
0A1E 22             1881                     ret
                    1882     
0A1F EA             1883     maform: mov a,r2
0A20 33             1884             rlc a
0A21 5006           1885             jnc             fo1m
0A23 D202           1886                     setb            znmat
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    30

0A25 120000   F     1887                     call   form4
0A28 22             1888                     ret
0A29 C202           1889     fo1m:   clr             znmat
0A2B 22             1890                     ret
                    1891     
0A2C 300203         1892     bform:  jnb             znmat,fo2m
0A2F 120000   F     1893                     call    form4
0A32 22             1894     fo2m:   ret
                    1895       
                    1896     ;r2..r5 яхЁхтхёЄш т фюя ъюф
0A33 ED             1897     form4:          mov a,r5
0A34 F4             1898             cpl a
0A35 2401           1899             add a,#1
0A37 FD             1900             mov r5,a
0A38 EC             1901             mov a,r4
0A39 F4             1902             cpl a
0A3A 3400           1903             addc    a,#0
0A3C FC             1904             mov r4,a
0A3D EB             1905             mov a,r3
0A3E F4             1906                 cpl a
0A3F 3400           1907             addc    a,#0
0A41 FB             1908             mov r3,a
0A42 EA             1909             mov a,r2
0A43 F4             1910             cpl a
0A44 3400           1911             addc    a,#0
0A46 FA             1912             mov r2,a
0A47 22             1913             ret
                    1914     
0A48 120000   F     1915     zcmp:   call            maform
0A4B 120000   F     1916                     call            lcmp
0A4E C0D0           1917                     push            psw
0A50 120000   F     1918                     call    bform
0A53 D0D0           1919                     pop             psw
0A55 22             1920                     ret
                    1921     
                    1922     
                    1923     ;@r0..@r0+3->r8..r11
                    1924     
0A56 E6             1925     resar8: mov     a,@r0
0A57 F508           1926                     mov     ltemp,a
0A59 08             1927                     inc     r0
0A5A E6             1928                     mov     a,@r0
0A5B F509           1929                     mov     ltemp+1,a
0A5D 08             1930                     inc     r0
0A5E E6             1931                     mov     a,@r0
0A5F F50A           1932                     mov     ltemp+2,a
0A61 08             1933                     inc     r0
0A62 E6             1934                     mov     a,@r0
0A63 F50B           1935                     mov     ltemp+3,a
0A65 22             1936                     ret
                    1937     
                    1938     ;
                    1939     ;r0- рфЁхё _ўхщъш єяръютрюую фтюшўюую ўшёыр  
                    1940     ;r2,a фтюшўюх ўшёыю 2 срщЄр 
                    1941     ;т_ї- @r0 єяръютрюх фхё_Єшўюх ўшёыю BCD 3 срщЄр 
                    1942     ;r2 a    ўшёыю 180
                    1943     ;00 b4
                    1944     ;т_ї- mabin..mabin+2
                    1945     ;     80 01 00
                    1946      
0A66 C8             1947     cond:   xch     a,r0    
0A67 F9             1948                     mov     r1,a
0A68 C8             1949                     xch     a,r0
0A69 7C03           1950                     mov     r4,#03
0A6B 7700           1951     dcoa:   mov     @r1,#00
0A6D 09             1952                     inc     r1
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    31

0A6E DCFB           1953                     djnz    r4,dcoa
0A70 7B10           1954                     mov     r3,#10h
0A72 C3             1955     dcob:   clr     c
0A73 33             1956                     rlc     a
0A74 CA             1957                     xch     a,r2
0A75 33             1958                     rlc     a
0A76 CA             1959                     xch     a,r2
0A77 C8             1960                     xch     a,r0
0A78 F9             1961                     mov     r1,a
0A79 C8             1962                     xch     a,r0
0A7A 7C03           1963                     mov     r4,#03
0A7C FD             1964                     mov     r5,a
0A7D E7             1965     dcoc:   mov     a,@r1 
0A7E 37             1966                     addc    a,@r1
0A7F D4             1967                     da      a
0A80 F7             1968                     mov     @r1,a
0A81 09             1969                     inc     r1
0A82 DCF9           1970                     djnz    r4,dcoc
0A84 ED             1971                     mov     a,r5
0A85 4003           1972                     jc      dcod
0A87 DBE9           1973                     djnz    r3,dcob
0A89 C3             1974                     clr     c
0A8A 00             1975     dcod:   nop
0A8B 22             1976                     ret
                    1977     
0A8C 8A08           1978     move28: mov     ltemp,r2                        ;r2..r5->ltemp
0A8E 850309         1979                     mov     ltemp+1,3
0A91 85040A         1980                     mov     ltemp+2,4
0A94 85050B         1981                     mov     ltemp+3,5
0A97 22             1982                     ret
                    1983     
                    1984     ;@r0..@r0+3->r2..r5
                    1985     
0A98 E6             1986     resar2: mov     a,@r0
0A99 FA             1987                     mov     r2,a
0A9A 08             1988                     inc     r0
0A9B E6             1989                     mov     a,@r0
0A9C FB             1990                     mov     r3,a
0A9D 08             1991                     inc     r0
0A9E E6             1992                     mov     a,@r0
0A9F FC             1993                     mov     r4,a
0AA0 08             1994                     inc     r0
0AA1 E6             1995                     mov     a,@r0
0AA2 FD             1996                     mov     r5,a
0AA3 22             1997                     ret
                    1998     
                    1999     ;25mkc !!!!!!!!!!!!!!!1
0AA4 7B4B           2000     z_9:      mov R3,#4Bh      ;загрузка числа
0AA6 DBFE           2001                    djnz R3,$
0AA8 22             2002               ret
                    2003     
                    2004     ;запись   передаваемый байт в acc
                    2005     ;передача байта послед кодом старшими разрядами  вперед
0AA9 7A08           2006     write:     mov R2,#8
0AAB C3             2007                             clr  c  
0AAC C297           2008     wr1:            clr             p1.7;P1.2
0AAE 00             2009                         nop 
0AAF 33             2010                             rlc A
0AB0 9296           2011                             mov P1.6,C;P1.1,C
0AB2 120000   F     2012                        call tim2
0AB5 D297           2013                        setb P1.7;P1.2
0AB7 120000   F     2014                call tim2
0ABA DAF0           2015                       djnz R2,wr1
0ABC C296           2016                       clr P1.6;P1.1
0ABE 22             2017                      ret
                    2018     
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    32

                    2019     ;принимаемый байт в acc
                    2020     ;прием байта последовательным кодом старшими разрядами вперед
0ABF 7A08           2021     read:    mov R2,#8
0AC1 C297           2022     re1:     clr P1.7;P1.2
0AC3 120000   F     2023              call tim2        ;5mks
0AC6 A294           2024                     mov C,P1.4;P1.0
0AC8 33             2025                     rlc A           
0AC9 D297           2026                     setb P1.7;P1.2
0ACB 120000   F     2027                     call tim2
0ACE DAF1           2028                     djnz R2,re1
0AD0 22             2029                     ret
                    2030     
                    2031      ;in r0-count   
                    2032     ;r10,r11-значение с котоым сравнивается счетчик
                    2033     ;r2..r5 -значение счетчика
0AD1                2034     chcmp:; mov              r0,#chavt                                      ;>=7500(1d4ch
0AD1 E6             2035                     mov                     a,@r0
0AD2 FC             2036                     mov                     r4,a
0AD3 08             2037                     inc                     r0
0AD4 E6             2038                     mov                     a,@r0
0AD5 FD             2039                     mov                     r5,a
0AD6 7B00           2040                     mov                     r3,#0
0AD8 7A00           2041                     mov                     r2,#0
0ADA 750800         2042                     mov                     r8,#0;clr                       r8
0ADD 750900         2043                     mov                     r9,#0;clr                       r9
0AE0 120000   F     2044                     call            lcmp
0AE3 22             2045                     ret
                    2046     
                    2047     
                    2048     
                    2049     
                    2050     
                    2051     
                    2052                                 
0AE4 020000   F     2053     rout6:          jmp             out6
0AE7 020000   F     2054     rlabelF:        jmp             labelF  
0AEA 020000   F     2055     rknrazr:        jmp             knrazr  
0AED 020000   F     2056     rknopt:         jmp             knopt
0AF0 020000   F     2057     rizman:         jmp             izman   
0AF3                2058     keyb1:  ;IE6 
0AF3 75E700         2059                                     mov             EIE2,#00H
                    2060                                     
0AF6 C0E0           2061                                     push    acc
0AF8 C0D0           2062                                     push    psw
0AFA C000           2063                                     push    rr0
0AFC C001           2064                                     push    rr1
0AFE C002           2065                                     push    rr2
0B00 C003           2066                                     push    rr3
0B02 C004           2067                                     push    rr4
0B04 C005           2068                                     push    rr5
0B06 C006           2069                                     push    rr6
0B08 C007           2070                                     push    rr7
                    2071                                     ;clr            bitmig
                    2072                       ;;;;;;;;;;;;;;
0B0A 120000   F     2073                                     call    z_01s;0,1s
                    2074                                     ;восстан знакоместо при мигании
                    2075                                     ;т к в соотв яч буфера индикации пишется 20h(пробел)
0B0D 78B2           2076                                     mov             r0,#marker
0B0F 7440           2077                                     mov             a,#bufind
0B11 26             2078                                     add             a,@r0                   ;a=bufind+marker
0B12 F9             2079                                     mov             r1,a
0B13 A73C           2080                                     mov             @r1,savba
                    2081                                     ;;;;;;;;;;;
0B15 E5B0           2082                             mov             a,p3
0B17 20E6CA         2083                                     jb              acc.6,rout6
0B1A E5B0           2084                                     mov             a,p3
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    33

0B1C 44FF           2085                                     orl             a,#0ffh         ; p3.(5-0)<-3f
0B1E F5B0           2086                                     mov             p3,a
0B20 E5B0           2087                                     mov             a,p3
0B22 30E6BF         2088                                     jnb             acc.6,rout6             ;error
0B25 3004BF         2089                                     jnb             bitizm,rlabelF
0B28 75B0FE         2090                                     mov             p3,#0feh                ;реж IZM
0B2B E5B0           2091                                     mov             a,p3
0B2D 30E6C0         2092                                     jnb             acc.6,rizman
0B30 75B0FD         2093                                     mov             p3,#0fdh
0B33 E5B0           2094                                     mov             a,p3
0B35 30E6B2         2095                                     jnb             acc.6,rknrazr             ;labelC
0B38 75B0FB         2096                                     mov             p3,#0fbh
0B3B E5B0           2097                                     mov             a,p3
0B3D 30E638         2098                                     jnb             acc.6,knright           ;->
0B40 75B0F7         2099                                     mov             p3,#0f7h
0B43 E5B0           2100                                     mov             a,p3
0B45 30E6A5         2101                                     jnb             acc.6,rknopt                    ;T
0B48 75B0EF         2102                                     mov             p3,#0efh
0B4B E5B0           2103                                mov          a,p3
0B4D 30E60B         2104                                     jnb             acc.6,pyskst                    ;pysk/stop
0B50 75B0DF         2105                                     mov             p3,#0dfh
0B53 E5B0           2106                                     mov             a,p3
0B55 30E63C         2107                                jnb          acc.6,knvich
0B58 020000   F     2108                                     jmp             izmpaT
                    2109     
0B5B 200A05         2110     pyskst:                 jb      bitbon,bufon            ;pysk/stop
0B5E D20A           2111                                     setb    bitbon  ;уст реж буфер вкл
0B60 020000   F     2112                                     jmp             izmpaT
0B63 C20A           2113     bufon:                  clr             bitbon  ;уст реж буфер выкл
0B65 020000   F     2114                                     jmp             izmpaT
                    2115     
0B68 79B0           2116     tizmri:                 mov             r1,#level
0B6A B70102         2117                                     cjne    @r1,#1,right2
                    2118                                     ;10s->HET
0B6D 8004           2119                                     jmp             right3
                    2120     
0B6F 07             2121     right2:                 inc             @r1
0B70 120000   F     2122                                     call    lolevT
                    2123                                     ;call   loadT   ;нажата кн-> в реж Tизм 
0B73 120000   F     2124     right3:                 call    ind
0B76 806A           2125                                     jmp             izmfun
                    2126     
                    2127                             
                    2128                             
0B78                2129     knright:        
                    2130     
0B78 79AE           2131                                     mov             r1,#diap
                    2132                             ;перекл диапазон 1 поз вверх сбр массив
0B7A 17             2133                                     dec             @r1
0B7B B7FF04         2134                                     cjne    @r1,#0ffh,diinc
0B7E 7700           2135                                     mov             @r1,#0
0B80 8060           2136                                     jmp  izmfun
0B82 120000   F     2137     diinc:                  call     clmassix
0B85 78B3           2138                                     mov             r0,#summa
0B87 120000   F     2139                                     call    clear4
0B8A 786A           2140                                     mov             r0,#rez_A0
0B8C 120000   F     2141                                     call    clear4  
0B8F 120000   F     2142                                     call    loadUS
0B92 804E           2143                                      jmp  izmfun
                    2144     
0B94 200610         2145     knvich:            jb           bitvi11,onvich
0B97 C204           2146                                     clr             bitizm
0B99 D214           2147                                     setb    bitvich
                    2148                                     
0B9B 78B1           2149                                     mov             r0,#vichR
0B9D 7611           2150                                     mov             @r0,#11h;;????????or 0
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    34

                    2151                                     ;ВЫЧИСЛИТЬ
0B9F 900000   F     2152                                     mov     dptr,#teVICH
0BA2 120000   F     2153                                     call    lotext
                    2154                               ; call                ind
0BA5 807A           2155                                     jmp              viout;izmpaT
                    2156     
0BA7 C214           2157     onvich:                 clr             bitvich
0BA9 78B1           2158                                     mov             r0,#vichR
0BAB 7600           2159                                     mov             @r0,#0
0BAD 8037           2160                                     jmp              izmpaT
                    2161     ; изм упр слова при нажатии ИЗМ d3(k5 p4),d3(u5 p5)
0BAF 301820         2162     louizm:            jnb          knizm,lou
0BB2 79AE           2163                                     mov             r1,#diap
0BB4 C3             2164                                     clr             c
0BB5 7403           2165                                     mov             a,#3
0BB7 97             2166                                     subb    a,@r1
0BB8 5006           2167                                     jnc             lldi23    ;10-2..10-5
                    2168                                     ;10-6..10-11
0BBA E584           2169                                     mov             a,p4
0BBC 54F7           2170                                     anl             a,#0f7h   ;d3
0BBE F584           2171                                     mov             p4,a
0BC0 E7             2172     lldi23:                 mov             a,@r1
0BC1 6403           2173                                     xrl             a,#3
0BC3 7002           2174                                     jnz             lldi3
0BC5 8005           2175                                     jmp             lldi2   ;10-5
0BC7 E7             2176     lldi3:                  mov             a,@r1
0BC8 6402           2177                                     xrl             a,#2            ;
0BCA 7006           2178                                     jnz             lou             
0BCC E585           2179     lldi2:                  mov             a,p5            ;10-4
0BCE 4408           2180                                     orl             a,#08
0BD0 F585           2181                                     mov             p5,a
0BD2 22             2182     lou:                    ret
                    2183                               ;;;;;;
0BD3 201807         2184     izman:                  jb              knizm,knizmon
0BD6 D218           2185                                     setb    knizm           ;уст реж ИЗМ ВКЛ
                    2186                             ;       d3(k5 p4),d3(u5 p5)заслать us
0BD8 120000   F     2187                                     call    louizm 
0BDB 8005           2188                                     jmp             izmfun
0BDD C218           2189     knizmon:                clr             knizm           ;уст реж ИЗМ ВЫКЛ
0BDF 120000   F     2190                                     call    loadUS;восстановить us
0BE2                2191     izmfun:                 
0BE2 D208           2192                                     setb    bitbuf
0BE4 800E           2193                                     jmp             labelE;;;;;;;;;;;;
                    2194                                     ;;;;;;;;;;;;;;
0BE6                2195     izmpaT:
                    2196     ;;;;;;;;;;;;;;;;;
0BE6 C3             2197                             clr             c
0BE7 79AF           2198                             mov             r1,#parN
                    2199     
0BE9 78AE           2200                             mov             r0,#diap
0BEB 7406           2201                             mov             a,#6            
0BED 96             2202                             subb    a,@r0
0BEE 5004           2203                             jnc             labelE          ;         ;10-2..10-8
                    2204                               
0BF0 7702           2205                             mov             @r1,#2          ;10-9..10-11            
0BF2 8000           2206                             jmp             labelE
                    2207     
                    2208     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0BF4 789A           2209     labelE:                 mov             r0,#parT
0BF6 793D           2210                                     mov             r1,#chkl
0BF8 B60108         2211                                     cjne    @r0,#1,izmt2
0BFB 7700           2212                                     mov             @r1,#0
0BFD 09             2213                                     inc             r1
0BFE 7702           2214                                     mov             @r1,#2
0C00 020000   F     2215                                     jmp             out6
0C03 B60208         2216     izmt2:                  cjne    @r0,#2,izmt3
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    35

0C06 7700           2217                                     mov             @r1,#0
0C08 09             2218                                     inc             r1
0C09 7714           2219                                     mov             @r1,#20
0C0B 020000   F     2220                                     jmp             out6
                    2221     
0C0E 7700           2222     izmt3:                  mov             @r1,#0
0C10 09             2223                                     inc             r1
0C11 77C8           2224                                     mov             @r1,#200
0C13 020000   F     2225                                     jmp             out6
                    2226     
                    2227     
                    2228     
                    2229     
0C16                2230     knopt: ;кнопка T
0C16 C204           2231                                clr          bitizm
0C18 D210           2232                                setb         bitt2
0C1A 79B7           2233                                mov          r1,#load
0C1C 7704           2234                                mov          @r1,#4;1s
0C1E 120000   F     2235                                call         loadT           ;T=1S,10S,HET,0.1S,50mS,
                    2236                                
                    2237     
0C21 793D           2238     viout:          mov             r1,#chkl
0C23 7703           2239                             mov             @r1,#03
0C25 09             2240                             inc             r1
0C26 77E8           2241                             mov             @r1,#0e8h               ;1000
0C28 020000   F     2242                             jmp             out6
                    2243     
0C2B                2244     knrazr:          
0C2B C3             2245     labelC:          clr            c
0C2C 78AF           2246                             mov             r0,#parN
0C2E 799A           2247                             mov             r1,#parT
0C30 7402           2248                             mov             a,#2
0C32 97             2249                             subb    a,@r1
0C33 40BF           2250                             jc              labelE          ;T>2
0C35 B60104         2251                             cjne    @r0,#1,noN1c
0C38 7602           2252                             mov             @r0,#2          ;N=2
0C3A 80B8           2253                             jmp             labelE
                    2254     
0C3C B60207         2255     noN1c:          cjne    @r0,#2,not_1
0C3F B70104         2256                             cjne    @r1,#1,not_1
                    2257                     ;       clr             c
                    2258                     ;       push    rr0
                    2259                     ;       mov             r0,#diap
                    2260                     ;       mov             a,#6            ;10-2..10-8
                    2261                     ;       subb    a,@r0
                    2262                     ;       jc              not_10
                    2263                     ;       pop             rr0         
0C42 7603           2264                             mov             @r0,#3          ;N=3      ;10-2..10-8
0C44 80AE           2265                             jmp             labelE
0C46                2266     not_10:         ;pop            rr0
0C46 7601           2267     not_1:          mov             @r0,#1                          ;N=1
0C48 80AA           2268                             jmp     labelE
                    2269     
0C4A 020000   F     2270     rtizmri:        jmp             tizmri
0C4D                2271     labelf:                 
0C4D 301024         2272                             jnb             bitt2,nofizm
0C50 75B0FB         2273                        mov          p3,#0fbh
0C53 E5B0           2274                        mov          a,p3
0C55 20E60F         2275                        jb           acc.6,outF
0C58 79B7           2276                        mov          r1,#load;parT
0C5A B70503         2277                        cjne         @r1,#5,noft1
                    2278                        ;t=10s
0C5D 020000   F     2279                        jmp          out6;ft1izm
                    2280     
0C60 07             2281     noft1:     inc          @r1;dec         @r1
0C61 120000   F     2282     ft1izm:         call    loadT;в буфер 2 записать текст с соотв load(parT)
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    36

                    2283                             ;call   ind
0C64 020000   F     2284                     jmp             out6;??????????????/
                    2285     
                    2286                             ;увеличить счетчик задержки клавиатуры
0C67 783D           2287     outF:           mov             r0,#chkl
0C69 7627           2288                             mov             @r0,#27h
0C6B 08             2289                             inc             r0
0C6C 7610           2290                             mov             @r0,#10h
0C6E 020000   F     2291                             jmp             out6;out7
                    2292     
0C71 020000   F     2293     noviR1:         jmp             noviR
0C74 3014FA         2294     nofizm:         jnb             bitvich,noviR1
0C77 78B1           2295                             mov             r0,#vichR
0C79 B61117         2296                             cjne    @r0,#11h,no11v6
0C7C 7612           2297                             mov             @r0,#12h                ;11= вычислить
0C7E 900000   F     2298     vvrr6:          mov             dptr,#teIZMK    ;       изм конст;teVICH
0C81 120000   F     2299                             call    lotext
0C84 80E1           2300                             jmp             outF
                    2301             
                    2302                     
0C86 B61179         2303     nor13:          cjne    @r0,#11h,nor11
0C89 7612           2304                             mov             @r0,#12h
0C8B 900000   F     2305                             mov             dptr,#teIZMK    ;       изм конст
0C8E 120000   F     2306                         call        lotext             
0C91 80D4           2307                             jmp             outF
                    2308     
0C93 B6120A         2309     no11v6:         cjne    @r0,#12h,no12v6
0C96 7613           2310                             mov             @r0,#13h
0C98 900000   F     2311                             mov             dptr,#teOUT
0C9B 120000   F     2312                             call    lotext
0C9E 80C7           2313                             jmp             outF
                    2314                     
0CA0 B6130A         2315     no12v6:         cjne    @r0,#13h,no13v6
0CA3 7611           2316                             mov             @r0,#11h
0CA5 900000   F     2317                             mov             dptr,#teVICH
0CA8 120000   F     2318                             call    lotext
0CAB 80BA           2319                             jmp             outF
                    2320     
                    2321     
0CAD 75B0FB         2322     no13v6:         mov             p3,#0fbh
0CB0 E5B0           2323                             mov             a,p3
0CB2 20E626         2324                             jb              acc.6,chanZ
                    2325                     ;clr            bitmig
0CB5 78B2           2326                             mov             r0,#marker      
0CB7 B6090E         2327                             cjne    @r0,#9,mark0_8          ;курсор справа ?
0CBA E53A           2328                             mov             a,movleft
0CBC F6             2329                             mov             @r0,a                           ; уст курсор в кр л
                             евую поз+1
                    2330     ;                               29.12.06
                    2331     ;;;;;;;;;;;;;;;;;;
                    2332     ;необходимо не портить цифру в следуюем справа знакоместе
                    2333     ;т е сохранить ее в ячейке для мигания в противном случае
                    2334     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2335     ;       знакоместа
0CBD 78B2           2336                                     mov             r0,#marker
0CBF 7440           2337                                     mov             a,#bufind
0CC1 26             2338                                             add             a,@r0                   ;a=bufind+m
                             arker
0CC2 F9             2339                                             mov             r1,a
0CC3 09             2340                                             inc             r1
0CC4 873C           2341                                             mov             savba,@r1
0CC6 809F           2342                                     jmp             outF
                    2343     
0CC8                2344     mark0_8:
                    2345     ;                               29.12.06
                    2346     ;;;;;;;;;;;;;;;;;;
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    37

                    2347     ;необходимо не портить цифру в следуюем справа знакоместе
                    2348     ;т е сохранить ее в ячейке для мигания в противном случае
                    2349     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2350     ;       знакоместа
0CC8 78B2           2351                                             mov             r0,#marker
0CCA 7440           2352                                     mov             a,#bufind
0CCC 26             2353                                             add             a,@r0                   ;a=bufind+m
                             arker
0CCD F9             2354                                             mov             r1,a
0CCE 09             2355                                             inc             r1
0CCF 873C           2356                                             mov             savba,@r1
0CD1 78B2           2357                             mov             r0,#marker
0CD3 06             2358                             inc             @r0             ;       сдвинуть курсор вправо на 1
0CD4 C219           2359                             clr             bitmig
0CD6 B60A00         2360                             cjne    @r0,#10,outma
0CD9 808C           2361     outma:          jmp             outF
                    2362     
0CDB 75B0FE         2363     chanZ:          mov             p3,#0feh
0CDE E5B0           2364                             mov             a,p3
0CE0 20E611         2365                             jb              acc.6,chanma
                    2366                             ;изм знак в старшем разряде на противоположн
0CE3 E543           2367                             mov             a,bufind+3
0CE5 B42B06         2368                             cjne            a,#2bh,noplus
0CE8 75432D         2369                             mov                     bufind+3,#2dh           ;+->-   
0CEB 020000   F     2370                             jmp             outF
0CEE                2371     noplus:
0CEE 75432B         2372                             mov                     bufind+3,#2bh           ;-/+-
0CF1 020000   F     2373                             jmp             outF
0CF4 75B0FD         2374     chanma:         mov             p3,#0fdh
0CF7 E5B0           2375                             mov             a,p3
0CF9 20E603         2376                             jb              acc.6,outFl;labelL1
                    2377                             ;clr            bitmig
0CFC 120000   F     2378     labelL1:        call    vvchif  ;увеличить цифру 
                    2379     
0CFF 020000   F     2380     outFl:                  jmp             outF
                    2381                     
0D02                2382     nor11:          ;       выход
0D02 7613           2383                     mov             @r0,#13h  ;12->13
0D04 900000   F     2384                     mov             dptr,#teOUT
                    2385     ;               jmp             vi1113
                    2386     
                    2387     
                    2388     
0D07 C206           2389     yesviR:         clr             bitvi11;????????/
0D09 200C77         2390                             jb              bmem11,labelL
0D0C 020000   F     2391                             jmp             out6;???????//
0D0F 30112A         2392     noviR:          jnb             bitmenu,nbimenu
0D12 75B0FB         2393                             mov             p3,#0fbh; реж кн меню ->
0D15 20B610         2394                             jb              p3.6,rnorim6
0D18 79B0           2395                             mov             r1,#level
0D1A B7000E         2396                             cjne    @r1,#0,rimen6
0D1D 900000   F     2397                             mov             dptr,#teKALIB
0D20 120000   F     2398                             call    lotext
0D23 7701           2399                             mov             @r1,#1
0D25 020000   F     2400                             jmp             out6
                    2401     
0D28 020000   F     2402     rnorim6:                jmp             norim6
                    2403     
0D2B 900000   F     2404     rimen6:         mov             dptr,#teTEsT
0D2E 120000   F     2405                             call    lotext
0D31 7700           2406                             mov             @r1,#0
0D33 020000   F     2407                             jmp             out6
                    2408     
0D36 020000   F     2409     moutF:          jmp             outF
                    2410     
0D39 020000   F     2411     rnnmemb:        jmp             nnmemb
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    38

0D3C 300BFA         2412     nbimenu:        jnb             bitmem,rnnmemb
0D3F 79B0           2413                             mov             r1,#level
0D41 B71113         2414                        cjne         @r1,#11h,nomem11
                    2415                        
0D44 75B0FB         2416                        mov          p3,#0fbh
0D47 E5B0           2417                        mov          a,p3
0D49 20E6EA         2418                        jb           acc.6,moutF
0D4C 7712           2419                        mov          @r1,#12h
0D4E 900000   F     2420                        mov          dptr,#teWR
0D51 120000   F     2421                        call         lotext
0D54 020000   F     2422                        jmp          outF
                    2423     
0D57 B71213         2424     nomem11:   cjne         @r1,#12h,nomem12
0D5A 75B0FB         2425                             mov             p3,#0fbh
0D5D E5B0           2426                        mov          a,p3
0D5F 20E6D4         2427                        jb           acc.6,moutF
0D62 7713           2428                        mov          @r1,#13h
0D64 900000   F     2429                        mov          dptr,#teLIST
0D67 120000   F     2430                        call         lotext
0D6A 020000   F     2431                        jmp          outF
0D6D B71313         2432     nomem12:         cjne           @r1,#13h,labelL
0D70 75B0FB         2433                             mov             p3,#0fbh
0D73 E5B0           2434                        mov          a,p3
0D75 20E6BE         2435                        jb           acc.6,moutF
0D78 7711           2436                        mov          @r1,#11h
0D7A 900000   F     2437                        mov          dptr,#teCLE
0D7D 120000   F     2438                        call         lotext
0D80 020000   F     2439                          jmp                outF
                    2440     
0D83 78B0           2441     labelL:         mov             r0,#level
0D85 B6211B         2442                             cjne    @r0,#21h,labl21
0D88 75B0FB         2443                             mov             p3,#0fbh
0D8B E5B0           2444                             mov             a,p3
0D8D 20E610         2445                             jb              acc.6,loutF
0D90 B62108         2446                             cjne    @r0,#21h,lal22
0D93 7622           2447                             mov             @r0,#22h
                    2448                             ;БЛОК
0D95 120000   F     2449                             call    lotext
0D98 020000   F     2450                             jmp             outF
0D9B 7621           2451     lal22:          mov             @r0,#21h
                    2452                             ;ПОЛНАЯ
0D9D 120000   F     2453                             call    lotext
0DA0 020000   F     2454     loutf:          jmp             outF
                    2455     
0DA3 B6211B         2456     labl21:    cjne @r0,#21h,nolev1
0DA6 75B0FB         2457                             mov             p3,#0fbh
0DA9 E5B0           2458                             mov             a,p3
0DAB 20E6F2         2459                             jb              acc.6,loutF
0DAE B62108         2460                             cjne    @r0,#21h,labl22
0DB1 7622           2461                             mov             @r0,#22h
                    2462                             ;БЛОК
0DB3 120000   F     2463                             call    lotext
0DB6 020000   F     2464                             jmp             outF
0DB9 7621           2465     labl22:         mov             @r0,#21h
                    2466                             ;ПОЛНАЯ
0DBB 120000   F     2467                             call    lotext
0DBE 020000   F     2468                             jmp             outF
                    2469                      
0DC1 B62323         2470     nolev1:         cjne    @r0,#23h,go31l
0DC4 75B0FB         2471     rigblo:         mov             p3,#0fbh
0DC7 20B627         2472                             jb              p3.6,llev2
0DCA                2473     labL2:    ;  уст курсор в правую позицию 
                    2474                                     ;                               29.12.06
                    2475     ;;;;;;;;;;;;;;;;;;
                    2476     ;необходимо не портить цифру в следуюем справа знакоместе
                    2477     ;т е сохранить ее в ячейке для мигания в противном случае
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    39

                    2478     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2479     ;       знакоместа
0DCA 78B2           2480                                             mov             r0,#marker
0DCC 7440           2481                                     mov             a,#bufind
0DCE 26             2482                                             add             a,@r0                   ;a=bufind+m
                             arker
0DCF F9             2483                                             mov             r1,a
0DD0 09             2484                                             inc             r1
0DD1 873C           2485                                             mov             savba,@r1
                    2486     ;;;;;;;;;;;;;;;;
0DD3 78B2           2487                       mov           r0,#marker      ;курсор справа  ?
0DD5 E53B           2488                             mov             a,movrig
0DD7 C3             2489                             clr             c
0DD8 96             2490                             subb    a,@r0
0DD9 6006           2491                             jz         equ1l
0DDB E53B           2492                             mov             a,movrig;уст в правую позицию
0DDD F6             2493                             mov             @r0,a
0DDE 020000   F     2494                             jmp             outF;goto7                                         
                                   
0DE1 E53A           2495     equ1l:          mov             a,movleft;уст в левую позицию
0DE3 F6             2496                             mov             @r0,a   
0DE4 020000   F     2497                             jmp             outF;goto7
                    2498                     
                    2499     
0DE7 B63102         2500     go31l:          cjne    @r0,#31h,go41l
0DEA 80D8           2501                             jmp             rigblo
0DEC B6410B         2502     go41l:          cjne    @r0,#41h,norig2
0DEF 80D3           2503                             jmp             rigblo
                    2504     
0DF1 75B0FD         2505     llev2:          mov             p3,#0fdh
0DF4 20B6A9         2506                             jb              p3.6,loutF
0DF7 020000   F     2507                             jmp             labelL1
                    2508     
                    2509     ;->
0DFA C3             2510     norig2:    clr          c               ;32,33,34,42
0DFB 7431           2511                             mov             a,#31h
0DFD 96             2512                             subb    a,@r0
0DFE 50A0           2513                             jnc             loutF
0E00 75B0FB         2514     rigblok:        mov             p3,#0fbh  ;32,33,34,42
0E03 20B626         2515                             jb              p3.6,lev2go
0E06                2516     labelN: 
                    2517                             ;                               29.12.06
                    2518     ;;;;;;;;;;;;;;;;;;
                    2519     ;необходимо не портить цифру в следуюем справа знакоместе
                    2520     ;т е сохранить ее в ячейке для мигания в противном случае
                    2521     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    2522     ;       знакоместа
0E06 78B2           2523                                             mov             r0,#marker
0E08 7440           2524                                     mov             a,#bufind
0E0A 26             2525                                             add             a,@r0                   ;a=bufind+m
                             arker
0E0B F9             2526                                             mov             r1,a
0E0C 09             2527                                             inc             r1
0E0D 873C           2528                                             mov             savba,@r1
                    2529     ;;;;;;;;;;;;;;;;;;;
0E0F 78B2           2530                             mov             r0,#marker      ;курсор справа  ?
0E11 E53B           2531                             mov             a,movrig
0E13 C3             2532                             clr             c
0E14 96             2533                             subb    a,@r0
0E15 7006           2534                             jnz        noequ1
0E17 E53A           2535                             mov             a,movleft;уст в крайнюю левую позицию
0E19 F6             2536                             mov             @r0,a
0E1A 020000   F     2537                             jmp             outF
0E1D                2538     noequ1: ;29.12.06
                    2539     ;;;;;;;;;;;;;;;;;;
                    2540                             ;восстан знакоместо при мигании
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    40

                    2541                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0E1D 78B2           2542                                     mov             r0,#marker
0E1F 7440           2543                                     mov             a,#bufind
0E21 26             2544                                     add             a,@r0                   ;a=bufind+marker
0E22 F9             2545                                     mov             r1,a
                    2546                                     ;mov            @r1,savba
0E23 09             2547                                     inc             r1
0E24 873C           2548                                     mov             savba,@r1
                    2549     ;;;;;;;;;;;;;;;;        
0E26 120000   F     2550                             call    marri;уст сдвиг в правую        позицию
0E29 020000   F     2551                             jmp             outF
0E2C 75B0FD         2552     lev2go:         mov             p3,#0fdh
0E2F 30B603         2553                             jnb             p3.6,rlabelL1
0E32 020000   F     2554                             jmp             outF
                    2555     
0E35 020000   F     2556     rlabelL1:       jmp             labelL1
0E38                2557     nnmemb:
0E38                2558     norim6:    ;kn menu
0E38                2559     out6:           
0E38 D007           2560                                     pop             rr7     
0E3A D006           2561                                     pop             rr6
0E3C D005           2562                                     pop             rr5
0E3E D004           2563                                     pop             rr4
0E40 D003           2564                                     pop             rr3
0E42 D002           2565                                     pop             rr2
0E44 D001           2566                                     pop             rr1                             
0E46 D000           2567                                     pop             rr0
0E48 D0D0           2568                                     pop             psw
0E4A D0E0           2569                                     pop             acc
                    2570     ;clr            bitmig
0E4C 75E730         2571                                mov          EIE2,#30H
0E4F E5AD           2572                                mov          a,P3IF
0E51 54BF           2573                                     anl             a,#0bfh
0E53 F5AD           2574                                     mov             P3IF,a
0E55 75B0C0         2575                                     mov             P3,#0c0h
0E58 C219           2576     clr             bitmig
0E5A 32             2577                             reti
                    2578     
0E5B 020000   F     2579     rknMEM:                 jmp             knMEM
0E5E 020000   F     2580     knKMP:             jmp          out7
0E61 020000   F     2581     rout7:                  jmp             out7    
0E64 020000   F     2582     rlabelH:                jmp             labelH
0E67 020000   F     2583     rknNUL:         jmp             knNUL
0E6A 020000   F     2584     rknleft:                jmp             knleft
0E6D                2585     keyb2:  ;IE7
0E6D 75E700         2586                                     mov             EIE2,#00H
0E70 C0E0           2587                                     push    acc
0E72 C0D0           2588                                     push    psw
0E74 C000           2589                                     push    rr0
0E76 C001           2590                                     push    rr1
0E78 C002           2591                                     push    rr2
0E7A C003           2592                                     push    rr3
0E7C C004           2593                                     push    rr4
0E7E C005           2594                                     push    rr5
0E80 C006           2595                                     push    rr6
0E82 C007           2596                                     push    rr7
0E84 C082           2597                                     push    dpl
0E86 C083           2598                                     push    dph
                    2599                                     ;clr            bitmig
                    2600                       ;;;;;;;;;;;;;;
0E88 120000   F     2601                               call  z_01s   ;0,1s
                    2602                               ;восстан знакоместо при мигании
                    2603                               ;т к в соотв яч буфера индикации пишется 20h(пробел)
0E8B 78B2           2604                                     mov             r0,#marker
0E8D 7440           2605                                     mov             a,#bufind
0E8F 26             2606                                     add             a,@r0                   ;a=bufind+marker
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    41

0E90 F9             2607                                     mov             r1,a
0E91 A73C           2608                                     mov             @r1,savba
                    2609                                     ;;;;;;;;;;;
                    2610     
0E93 E5B0           2611                             mov             a,p3
0E95 20E7C9         2612                                     jb              acc.7,rout7
0E98 E5B0           2613                                     mov             a,p3
0E9A 74FF           2614                                     mov             a,#0ffh         ; p3.(5-0)<-3f
0E9C F5B0           2615                                     mov             p3,a
0E9E E5B0           2616                                     mov             a,p3
0EA0 30E7BE         2617                                     jnb             acc.7,rout7             ;error
0EA3 3004BE         2618                                     jnb             bitizm,rlabelH
0EA6 75B0FE         2619                                     mov             p3,#0feh                ;реж IZM
0EA9 E5B0           2620                                     mov             a,p3
0EAB 30E7B9         2621                                     jnb             acc.7,rknNUL
0EAE 75B0FD         2622                                     mov             p3,#0fdh
0EB1 E5B0           2623                                     mov             a,p3
0EB3 30E7A8         2624                                     jnb             acc.7,knKMP
0EB6 75B0FB         2625                                     mov             p3,#0fbh
0EB9 E5B0           2626                                     mov             a,p3
0EBB 30E7AC         2627                                     jnb             acc.7,rknleft
0EBE 75B0F7         2628                                     mov             p3,#0f7h
0EC1 E5B0           2629                                     mov             a,p3
0EC3 30E74E         2630                                     jnb             acc.7,knAVP
0EC6 75B0EF         2631                                 mov         p3,#0efh
0EC9 E5B0           2632                                     mov             a,p3
0ECB 30E78D         2633                                     jnb             acc.7,rknMEM
0ECE 75B0DF         2634                                     mov             p3,#0dfh
0ED1 E5B0           2635                                     mov             a,p3    
0ED3 30E72E         2636                                     jnb             acc.7,knmenu
0ED6                2637     an_t7:             ;;;;;;;;;;;;
                    2638                     
0ED6 C3             2639                             clr             c
0ED7 79AF           2640                             mov             r1,#parN
                    2641     
0ED9 78AE           2642                             mov             r0,#diap
0EDB 7406           2643                             mov             a,#6            
0EDD 96             2644                             subb    a,@r0
0EDE 5002           2645                             jnc             goto7           ;         ;10-2..10-8
                    2646                               
0EE0 7702           2647                             mov             @r1,#2          ;10-9..10-11            
                    2648                             
                    2649                             ;;;;;;;;;;;;
0EE2 799A           2650     goto7:                  mov             r1,#parT
0EE4 783D           2651                                     mov             r0,#chkl
0EE6 B70108         2652                                     cjne    @r1,#1,not1_7
0EE9 7600           2653                                     mov             @r0,#00
0EEB 08             2654                                     inc             r0
0EEC 7602           2655                                     mov             @r0,#2
0EEE 020000   F     2656                                     jmp             out7
                    2657                             
                    2658     
0EF1 B70208         2659     not1_7:                 cjne    @r1,#2,not2_7
0EF4 760E           2660                                     mov             @r0,#0eh;00
0EF6 08             2661                                     inc             r0
0EF7 7638           2662                                     mov             @r0,#38h;20
0EF9 020000   F     2663                                     jmp             out7
0EFC 7600           2664     not2_7:                 mov             @r0,#00
0EFE 08             2665                                     inc             r0
0EFF 76C8           2666                                     mov             @r0,#200
0F01 020000   F     2667                                     jmp             out7
                    2668     
                    2669     
0F04 C204           2670     knmenu:                  clr            bitizm          ;off IZM
0F06 D211           2671                                     setb            bitmenu
0F08 900000   F     2672                                     mov             dptr,#teMENU    ;в буф2 записать ТЕСТ-ИЗМЕР
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    42

0F0B 120000   F     2673                                     call    lotext
0F0E 120000   F     2674                                     call    ind;???????/
0F11 020000   F     2675                                     jmp             onmem11
                    2676     
0F14 200505         2677     knAVP:                  jb              bitavp,meavp
0F17 D205           2678                                     setb    bitavp
0F19 020000   F     2679                                     jmp             onmem11
0F1C C205           2680     meavp:                  clr             bitavp
0F1E 020000   F     2681                                     jmp             onmem11
                    2682     
0F21 79AE           2683     knleft:            mov          r1,#diap
0F23 07             2684                                     inc             @r1             ;перекл диапазон 1 поз в сб
                             р массив
0F24 B70A03         2685                                     cjne    @r1,#0ah,nodi6
0F27 17             2686                                     dec             @r1
0F28 80AC           2687                                     jmp             an_t7
                    2688     
0F2A                2689     nodi6:             ;    cjne    @r1,#0,an_t7
0F2A 120000   F     2690                                      call    clmassix
0F2D 78B3           2691                                     mov             r0,#summa
0F2F 120000   F     2692                                     call    clear4  
0F32 786A           2693                                     mov             r0,#rez_A0
0F34 120000   F     2694                                     call    clear4  
0F37 120000   F     2695                                     call    loadUS
0F3A 809A           2696                                jmp          an_t7
                    2697     
0F3C 200F0E         2698     knNUL:                  jb              bitnul,ybnul
0F3F D20F           2699                                     setb    bitnul
0F41 789C           2700                                     mov             r0,#rez_A3      ;A3
0F43 120000   F     2701                                     call    resar2
0F46 786A           2702                                     mov             r0,#rez_A0      
0F48 120000   F     2703                                     call    saver2;A0<-A3
0F4B 8095           2704                                     jmp             goto7;an_t7
                    2705     
0F4D C20F           2706     ybnul:                  clr             bitnul
0F4F 900000   F     2707                                      mov    DPTR,#ch0 
0F52 120000   F     2708                                     CALL   ldc_long          ; r2..r5 <-- 0
0F55 786A           2709                                     mov             r0,#rez_A0      ;A0=0
0F57 120000   F     2710                                     call    saver2
0F5A 8086           2711                                     jmp             goto7;an_t7
                    2712     
0F5C 30101E         2713     labelH:                 jnb             bitt2,nolah
0F5F 75B0FB         2714                                     mov             p3,#0fbh   ;вход в режим изм Т
0F62 79B7           2715                                     mov             r1,#load;parT
0F64 20B70D         2716                                     jb              p3.7,rhnot1
0F67 B70003         2717                                     cjne    @r1,#0,inct;
0F6A 020000   F     2718                                     jmp             out7;hyest6
0F6D 17             2719     inct:                   dec             @r1                     ;Tизм+1
                    2720                             
0F6E 120000   F     2721                             call    loadT   ;в буфер2 записать текст  в соотв с     Tизм
0F71                2722     hnot2:          ;       call    ind
0F71 020000   F     2723                                     jmp             out7
                    2724     
0F74 020000   F     2725      rhnot1:                jmp             hnot1
                    2726      ;rnoviR:       jmp             noviR
0F77 020000   F     2727      rlabelK:       jmp             labelK
0F7A 020000   F     2728      rlabelI:       jmp             labelI          
                    2729      ;;;;;;;;;;;;;;;;;;;
0F7D 3014F7         2730     nolah:          jnb             bitvich,rlabelK 
                    2731                             ;;;;;;
                    2732                             ;увеличить счетчик задержки клавиатуры
                    2733                     ;;              mov             r0,#chkl
                    2734                     ;;              mov             @r0,#27h
                    2735                     ;;              inc             r0
                    2736                     ;;              mov             @r0,#10h
                    2737                             ;;;;;;
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    43

                    2738     
0F80 78B1           2739                             mov             r0,#vichR
0F82 B6115D         2740                             cjne    @r0,#11h,hnor11;rlabelI;;
0F85 75B0FB         2741                             mov             p3,#0fbh   ;<-
0F88 20B722         2742                             jb              p3.7,noh37;routF
0F8B B6110B         2743                     cjne    @r0,#11h,hr12
0F8E 7613           2744                             mov             @r0,#13h        ;11= вычислить
0F90 900000   F     2745                             mov             dptr,#teOUT;teVICH
0F93 120000   F     2746     hvi1113:        call    lotext  ;в буфер 2 записать текст в соотв с состоянием
0F96 020000   F     2747                             jmp             goto7;outF
0F99 B61207         2748     hr12:           cjne    @r0,#12h,hnor12
0F9C 7611           2749     lovich:         mov             @r0,#11h
0F9E 900000   F     2750                             mov             dptr,#teVICH
0FA1 80F0           2751                             jmp             hvi1113         
0FA3 B6133C         2752     hnor12:         cjne    @r0,#13h,hnor11
0FA6 7612           2753     loizmk:         mov             @r0,#12h
0FA8 900000   F     2754                             mov             dptr,#teIZMK    ;       изм конст
                    2755                                        
0FAB 80E6           2756                             jmp             hvi1113
                    2757     
0FAD 75B0F7         2758     noh37:          mov             p3,#0f7h
0FB0 20B707         2759                             jb              p3.7,routF
0FB3 B61139         2760                             cjne    @r0,#11h,vvizko
0FB6 D214           2761                             setb    bitvich    ;нажат ввод ВЫЧИСЛИТЬ
0FB8 D204           2762                             setb    bitizm
0FBA 020000   F     2763     routF:          jmp             goto7;outF
                    2764     ;
0FBD B6120A         2765     norr11:         cjne    @r0,#12h,norr12
0FC0 75B0FB         2766                             mov             p3,#0fbh   ;<-
0FC3 20B7E7         2767                             jb              p3.7,noh37;routF
0FC6 760B           2768                             mov             @r0,#11;12->11
0FC8 80D2           2769                             jmp             lovich
                    2770     
0FCA B613AD         2771     norr12:         cjne    @r0,#13h,rlabelI
0FCD 75B0FB         2772                             mov             p3,#0fbh   ;<-
0FD0 20B7DA         2773                             jb              p3.7,noh37
0FD3 7612           2774                             mov             @r0,#12h
0FD5 80CF           2775                             jmp             loizmk
                    2776                             ;;;;
0FD7 C214           2777     clrvich:                clr             bitvich
0FD9 D204           2778                             setb    bitizm
0FDB A8B2           2779                             mov             r0,marker
0FDD 76FF           2780                             mov             @r0,#0ffh
0FDF 020000   F     2781                              jmp    goto7;  routF
                    2782     
                    2783      ;ввод изм конст
0FE2 B612E5         2784     hnor11:         cjne    @r0,#12h,norr12;clrvich
0FE5 75B0FB         2785                              mov            p3,#0fbh   
0FE8 20B7C2         2786                             jb              p3.7,noh37;lovich;;изм конст <-  выч
0FEB 7611           2787                             mov             @r0,#11h
0FED 80AD           2788                             jmp             lovich
                    2789     
0FEF 78B1           2790     vvizko:         mov             r0,#vichR
0FF1 E6             2791                             mov             a,@r0
                    2792                     ;       cjne    @r0,#12h,clrvich
0FF2 B412E2         2793                             cjne    a,#12h,clrvich
0FF5 7621           2794                             mov             @r0,#21h                ;изм конст->a=+0000     (vv
                             od)
0FF7 78B2           2795                             mov             r0,#marker
0FF9 7603           2796                             mov             @r0,#3;9
0FFB 753A03         2797                             mov             movleft,#3
0FFE 900000   F     2798                             mov             dptr,#teAequ0
1001 120000   F     2799                             call    lotext
1004 020000   F     2800                             jmp             goto7;routF
                    2801     ;hnor13:                jmp             hnor12          
1007 B6210C         2802     izchi:          cjne    @r0,#21h,tlabelI
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    44

                    2803     ;<- при вводе цифр А                            
                    2804                     ;        mov            p3,#0fbh   
                    2805                     ;       jnb             p3.7,li21
                    2806             ;clr            bitmig
100A 78B2           2807                             mov             r0,#marker
100C 16             2808                             dec             @r0
100D B60201         2809                             cjne    @r0,#2,li21
1010 06             2810                             inc             @r0;marker=3 +/-
1011 C219           2811     li21:           clr             bitmig
1013 020000   F     2812                             jmp             goto7;outF
                    2813     
1016 020000   F     2814     tlabelI:        jmp             labelI
                    2815     
                    2816     ;                       load    0 1 2 3 4 5             
1019 06050403       2817     sootv:          db              6,5,4,3,2,1;parT
101D 0201                    
                    2818     ;
                    2819     
                    2820     ;нажата кн ввод при наборе Т
101F 75B0F7         2821     hnot1:                  mov             p3,#0f7h
1022 20B795         2822                                     jb              p3.7,routF;out7
1025 B70541         2823                                     cjne    @r1,#5,nohnot1  ;r1=load
1028 794A           2824                                     mov             r1,#bufind+10;в буфере 1 зажечь 10s
102A E7             2825                                     mov             a,@r1
102B 4440           2826                                     orl             a,#40h;.6
102D F7             2827                                     mov             @r1,a
102E 8000           2828                                     jmp             loadb
                    2829                                     
                    2830                                     
1030 789A           2831     loadB:                  mov             r0,#parT
1032 900000   F     2832                                     mov             dptr,#sootv
1035 79B7           2833                                     mov             r1,#load                
1037 E7             2834                                     mov             a,@r1;load
1038 93             2835                                     movc    a,@a+dptr
1039 F6             2836                                     mov             @r0,a
103A 120000   F     2837                                     call            loab12  ;установить B1,B2 в соотв с Tизм   
                             ??????
                    2838                                      ;r4=b1 r5=b2
103D 120000   F     2839                                     call    iniacp;инициализация АЦП
1040 120000   F     2840                                     call    loadUS
1043 120000   F     2841                                     call    clmassix        
1046 D204           2842                                     setb    bitizm
1048 C210           2843                                     clr             bitt2
104A C3             2844                                      clr            c
104B 789A           2845                                  mov                r0,#parT
104D 79AF           2846                                      mov            r1,#parN
104F 7402           2847                                  mov                a,#2
1051 96             2848                                 subb                a,@r0
1052 5005           2849                                 jnc                 loadB2
1054 7701           2850                                     mov             @r1,#1;N=1         ;T>=2
1056 020000   F     2851     bout7:                  jmp             goto7;out7
                    2852     
1059 B702FA         2853     loadB2:                 cjne    @r1,#2,bout7
105C 7702           2854                                     mov             @r1,#2;N=2
105E 020000   F     2855                                     jmp             goto7;out7
1061                2856     nohnot2:                ;в буфере 1 зажечь <=0,1s
1061 794A           2857                                     mov             r1,#bufind+10
1063 E7             2858                                     mov             a,@r1
1064 4410           2859                                     orl             a,#10h;.4
1066 F7             2860                                     mov             @r1,a
1067 80C7           2861                                     jmp             loadB
1069 B704F5         2862     nohnot1:                cjne    @r1,#4,nohnot2  ;ввод кнопка Т  
106C 794A           2863                                     mov             r1,#bufind+10;в буфере 1 зажечь 1s
106E E7             2864                                     mov             a,@r1
106F 4420           2865                                     orl             a,#20h;.5
1071 F7             2866                                     mov             @r1,a
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    45

1072 80BC           2867                                     jmp             loadB
                    2868     
                    2869     ;кнопка ПАМЯТЬ
1074 C204           2870     knMEM:                  clr             bitizm          ;off IZM
1076 900000   F     2871                                     mov             dptr,#teCLE
1079 120000   F     2872                                     call    lotext    ;в буф2 записать ОЧИСТКА
107C D20B           2873                                     setb    bitmem     ;нажата кнопка ПАМЯТЬ
107E 78B0           2874                                     mov             r0,#level
1080 7611           2875                                     mov             @r0,#11h
1082 783D           2876     onmem11:                mov             r0,#chkl
1084 7603           2877                                     mov             @r0,#03
1086 08             2878                                     inc             r0
1087 76E8           2879                                     mov             @r0,#0e8h               ;1000
1089 020000   F     2880                                     jmp             goto7;out7
                    2881     
108C 020000   F     2882     rnomemk:                jmp             nomemk          ;
108F                2883     labelK:
                    2884     ;;;;;;;;;;;;
                    2885     ;                               jnb             bitmenu,nomenu
                    2886     ;                               mov             p3,#0fbh
                    2887     ;                               mov             r1,#level
                    2888     ;                               jb              p3.7,vvmenu
                    2889                     
                    2890     
                    2891     ;nomenu:                        mov             p3,#0f7h;0efh;0f7h;vvod
                    2892     ;                               jb              p3.7,novvmn
                    2893     ;vvmenu:;ввод меню  (тест-калибровка)
                    2894     ;                               mov             dptr,#teTEST;тест
                    2895     ;                               call    lotext
                    2896     ;                               mov             @r1,#2
                    2897     ;                               jmp             out7
                    2898     ;novvmn:                        mov             p3,#0efh
                    2899     ;                               jb              p3.7,rimenu
                    2900                             
                    2901     ;                               jmp             out7
                    2902     
                    2903      ;rimenu:
                    2904     ;;;;;;;;;;;;
108F 300BFA         2905                               jnb           bitmem,rnomemk
1092 78B0           2906                               mov           r0,#level
1094 B61132         2907                               cjne          @r0,#11h,klev1;nome11
1097 75B0FB         2908     lefmem11:         mov           p3,#0fbh
109A E5B0           2909                               mov           a,p3
109C 20E70E         2910                               jb            acc.7,rkvvod0
109F B6110E         2911                               cjne          @r0,#11h,locle          ;<-memory
10A2 7613           2912                               mov           @r0,#13h
10A4 900000   F     2913     lolist:           mov           dptr,#teLIST
10A7 120000   F     2914                               call          lotext           ;ПРОСМОТР
10AA 020000   F     2915                               jmp   goto7;  outF
                    2916     
10AD 020000   F     2917     rkvvod0:        jmp             kvvod0
                    2918     
                    2919     
10B0 B6120B         2920     locle:          cjne            @r0,#12h,lowr           ;<-memory
10B3 7611           2921                               mov           @r0,#11h                   ;ОЧИСТКА
10B5 900000   F     2922     loadcle:          mov           dptr,#teCLE
10B8 120000   F     2923                               call          lotext
10BB 020000   F     2924                               jmp           goto7;outF
10BE 7612           2925      lowr:          mov             @r0,#12h
10C0 900000   F     2926      lowr1:         mov             dptr,#teWR                ;ЗАПИСЬ
10C3 120000   F     2927                             call    lotext
10C6 020000   F     2928                             jmp             goto7;outF
10C9 B61202         2929      klev1:          cjne   @r0,#12h,klev2
10CC 80C9           2930                             jmp             lefmem11
10CE B61302         2931     klev2:           cjne   @r0,#13h,klev22   ;11-13 нет
10D1 80C4           2932                             jmp             lefmem11
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    46

                    2933     
                    2934     ;<- vvod на более низких уровнях
10D3 B62114         2935     klev22:         cjne    @r0,#21h,klev21
10D6 75B0FB         2936     lev220:         mov             p3,#0fbh
10D9 20B72F         2937                             jb              p3.7,kgo23
10DC B62146         2938                             cjne    @r0,#21h,kfull
10DF 7622           2939                             mov             @r0,#22h
10E1 900000   F     2940                             mov             dptr,#teBL
10E4 120000   F     2941                             call    lotext
10E7 020000   F     2942                             jmp             goto7;outF
                    2943                                     
10EA B62208         2944     klev21:         cjne    @r0,#22h,klev23
10ED 80E7           2945                             jmp             lev220
                    2946     
10EF 020000   F     2947     rlabL2:         jmp             labL2
10F2 020000   F     2948     rlabM:          jmp             labM
                    2949     
10F5 B623FA         2950     klev23:          cjne   @r0,#23h,rlabM
10F8 75B0FB         2951                              mov    p3,#0fbh
10FB 20B7F1         2952                              jb             p3.7,rlabL2
10FE 75B0F7         2953                              mov    p3,#0f7h
1101 20B74F         2954                              jb             p3.7,ddoutf
                    2955                              ;очистить блок памяти с набранным номером
1104 C20B           2956                              clr    bitmem  ;сбр признак памяти 
1106 D204           2957                              setb   bitizm
1108 020000   F     2958                              jmp    goto7;outF
                    2959                             
110B 75B0F7         2960     kgo23:           mov    p3,#0f7h
110E 20B742         2961                             jb              p3.7,ddoutf
1111 B62107         2962                             cjne    @r0,#21h,go23no
                    2963                             ;очистить память
1114 C20B           2964                             clr             bitmem
1116 D204           2965                             setb    bitizm
1118 020000   F     2966                             jmp             goto7;outF
                    2967     
111B 7623           2968     go23no:    mov          @r0,#23h
111D 753B08         2969                                             mov                     movrig,#8
1120 753A07         2970                                             mov             movleft,#7
1123 8038           2971                             jmp             loblok;БЛОК 00
                    2972     
1125 7621           2973     kfull:          mov             @r0,#21h
1127 8024           2974                             jmp             gofull          
1129                2975     nomemk:
1129 020000   F     2976                                     jmp             goto7;outF
                    2977                                     ;;;;;;;;;;
112C 75B0FB         2978     nome11:           mov           p3,#0fbh
112F E5B0           2979                               mov           a,p3
1131 20E70C         2980                               jb            acc.7,kvvod0
1134 B61205         2981                               cjne          @r0,#12h,mem12no        
1137 7611           2982                               mov           @r0,#11h                ;ОЧИСТКА
1139 020000   F     2983                               jmp            loadcle
                    2984     
113C                2985     mem12no:        ;cjne           @r0,#13h,lowr           
113C 7612           2986                               mov           @r0,#12h                   ;
113E 8080           2987                               jmp           lowr1                     ;ЗАПИСЬ
                    2988     
1140 75B0F7         2989     kvvod0:           mov           p3,#0f7h
1143 20B70D         2990                               jb            p3.7,ddoutf
1146 78B0           2991                               mov           r0,#level
1148 B6110D         2992                               cjne          @r0,#11h,mvv11
114B 7621           2993                               mov           @r0,#21h                ;ПОЛНАЯ
114D 900000   F     2994     gofull:           mov           dptr,#teFULL
1150 120000   F     2995                               call          lotext
1153 801F           2996     ddoutf:         jmp             mlabL2  ;<-
                    2997     
1155 020000   F     2998     jmp             goto7
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    47

                    2999     
1158 B61215         3000     mvv11:            cjne          @r0,#12h,mvv12
115B 7631           3001                                     mov             @r0,#31h
115D 900000   F     3002     loblok:                 mov             dptr,#teBLOK;БЛОК 00
1160 120000   F     3003                                     call    lotext
1163 78B2           3004                                     mov             r0,#marker
1165 7607           3005                                     mov             @r0,#7
1167 753B08         3006                                     mov             movrig,#8
116A 753A07         3007                                     mov             movleft,#7
116D 020000   F     3008                                     jmp             goto7;outF
1170 7641           3009     mvv12:                  mov             @r0,#41h                ; БЛОК 00
1172 80E9           3010                                     jmp             loblok
                    3011     
                    3012     
                    3013     
1174                3014     mlabL2:         ;jmp            labL2
                    3015                                             ;  уст курсор в правую позицию 
                    3016                                     ;                               29.12.06
                    3017     ;;;;;;;;;;;;;;;;;;
                    3018     ;необходимо не портить цифру в следуюем справа знакоместе
                    3019     ;т е сохранить ее в ячейке для мигания в противном случае
                    3020     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3021     ;       знакоместа
1174 78B2           3022                                             mov             r0,#marker
1176 7440           3023                                     mov             a,#bufind
1178 26             3024                                             add             a,@r0                   ;a=bufind+m
                             arker
1179 F9             3025                                             mov             r1,a
117A 09             3026                                             inc             r1
117B 873C           3027                                             mov             savba,@r1
                    3028     ;;;;;;;;;;;;;;;;
117D 78B2           3029                       mov           r0,#marker      ;курсор справа  ?
117F E53B           3030                             mov             a,movrig
1181 C3             3031                             clr             c
1182 96             3032                             subb    a,@r0
1183 6006           3033                             jz         equ2l
1185 E53B           3034                             mov             a,movrig;уст в правую позицию
1187 F6             3035                             mov             @r0,a
                    3036                             l
*** _________________________________________________^
*** ERROR #A9 IN 3036 (Amp21.asm, LINE 2802): SYNTAX ERROR
1188 020000   F     3037                             jmp             goto7                                            
118B E53A           3038     equ2l:          mov             a,movleft;уст в левую позицию
118D F6             3039                             mov             @r0,a   
118E 020000   F     3040                             jmp             goto7
                    3041                     
                    3042     
1191 B63137         3043     labM:                   cjne    @r0,#31h,nom31
1194 75B0FB         3044                                     mov             p3,#0fbh
1197 30B7DA         3045                                     jnb             p3.7,mlabL2
119A 75B0F7         3046                                mov          p3,#0f7h
119D 20B7B3         3047                                jb           p3.7,ddoutf
                    3048                                
11A0 7632           3049                                mov          @r0,#32h
                    3050                                     ;       считать с индикатора  
11A2 7F0A           3051                                     mov             r7,#10
11A4 7853           3052                                     mov             r0,#adec
11A6 120000   F     3053                                     call    clearN
11A9 120000   F     3054                                     call    upak2                   
11AC 784F           3055                                     mov             r0,#abin
11AE 7953           3056                                     mov             r1,#adec                        ;мл        
                              ст
11B0 120000   F     3057                                     call    decbin                  ;abin..abin+3 (hex)
                    3058                                     ;call   loadr2                  ;r2..r5
                    3059                                     ;call   altof                   ;r2..r5->int
11B3 78C4           3060                                mov          r0,#nblok       ;   сохранить
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    48

11B5 E54F           3061                                mov          a,abin          ;;мл
11B7 F6             3062                                mov          @r0,a
11B8 900000   F     3063                                mov          dptr,#tebBL;НАЧ БЛОК 000
11BB 120000   F     3064                                call         lotext
11BE 78B2           3065                                mov          r0,#marker
11C0 7607           3066                                mov          @r0,#7
11C2 753B09         3067                                mov          movrig,#9
11C5 753A07         3068                                mov          movleft,#7
11C8 020000   F     3069     rgoto7:            jmp     goto7;outF
                    3070     
11CB B6324C         3071     nom31:             cjne         @r0,#32h,nom32
11CE 75B0FB         3072                                     mov             p3,#0fbh
11D1 20B714         3073                                     jb              p3.7,no31n
                    3074                                     
11D4 78B2           3075     lefcur:         mov             r0,#marker      ;курсор слева?
11D6 E53A           3076                             mov             a,movleft
11D8 C3             3077                             clr             c
11D9 96             3078                             subb    a,@r0
11DA 7006           3079                             jnz        noequ2
11DC E53B           3080                             mov             a,movrig
11DE F6             3081                             mov             @r0,a;уст в крайнюю правую позицию
11DF 020000   F     3082                             jmp             goto7
11E2 120000   F     3083     noequ2:         call    marle;сдвинуть курсор в  лево на 1позицию       
11E5 020000   F     3084                             jmp        goto7
                    3085                                     
11E8 75B0F7         3086     no31n:             mov          p3,#0f7h
11EB 20B7DA         3087                                     jb              p3.7,rgoto7
11EE 7633           3088                                     mov             @r0,#33h
                    3089                                     ;запомнить номер ячейки блока
11F0 7F0A           3090                                             mov             r7,#10
11F2 7853           3091                                     mov             r0,#adec
11F4 120000   F     3092                                     call    clearN
11F7 120000   F     3093                                     call    upak3                   
11FA 784F           3094                                     mov             r0,#abin
11FC 7953           3095                                     mov             r1,#adec                        ;мл        
                              ст
11FE 120000   F     3096                                     call    decbin                  ;abin..abin+3 (hex)
1201 120000   F     3097                                     call    loadr2                  ;r2..r5
1204 120402         3098                                     call    altof                   ;r2..r5->int
                    3099     
1207 900000   F     3100                                      mov            dptr,#teeBL;КОН БЛОК 000
120A 120000   F     3101                                call         lotext
120D 78B2           3102                                mov          r0,#marker
120F 7607           3103                                mov          @r0,#7
1211 753B09         3104                                mov          movrig,#9
1214 753A07         3105                                mov          movleft,#7
1217 020000   F     3106                                jmp     goto7;
                    3107     
                    3108     
121A B63328         3109     nom32:           cjne           @r0,#33h,nom33
121D 75B0FB         3110                              mov            p3,#0fbh
1220 30B7B1         3111                              jnb            p3.7,lefcur
1223 75B0F7         3112                              mov            p3,#0f7h
1226 20B79F         3113                              jb             p3.7,rgoto7
                    3114                              ;запомнить номер ячейки конца блока
1229 7634           3115                              mov    @r0,#34h
122B 7F0A           3116     INTn:                   mov             r7,#10
122D 7853           3117                                     mov             r0,#adec
122F 120000   F     3118                                     call    clearN
1232 120000   F     3119                                     call    upak3                   
1235 784F           3120                                     mov             r0,#abin
1237 7953           3121                                     mov             r1,#adec                        ;мл        
                              ст
1239 120000   F     3122                                     call    decbin                  ;abin..abin+3 (hex)
123C 120000   F     3123                                     call    loadr2                  ;r2..r5
123F 120402         3124                                     call    altof                   ;r2..r5->int
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    49

1242 020000   F     3125     dgoto7:                  jmp            goto7
                    3126     
1245 B63415         3127     nom33:          cjne            @r0,#34h,labelP
1248 75B0FB         3128                               mov           p3,#0fbh
124B 30B786         3129                              jnb            p3.7,lefcur
124E 75B0F7         3130                              mov            p3,#0f7h
1251 20B7EE         3131                              jb             p3.7,dgoto7
1254 76FF           3132                              mov            @r0,#0ffh
                    3133                              ;T1<-число на индикаторе
1256 C20B           3134                              clr            bitmem            ;vvod КОН БЛ 000
1258 D204           3135                              setb           bitizm
                    3136                                     
125A 020000   F     3137                             jmp        goto7
125D                3138     labelP:                                                         
                    3139     ;;;;;;;
125D                3140     labelI:
125D 75B0FE         3141                                     mov             p3,#0feh
1260 E5B0           3142                                     mov             a,p3
1262 20E703         3143                                     jb              acc.7,nopoint
                    3144                                     ;
1265 020000   F     3145                                     jmp             goto7;out7
1268 75B0FB         3146     nopoint:                mov             p3,#0fbh
126B E5B0           3147                                     mov             a,p3
126D 20E71C         3148                                     jb              acc.7,nopoin7
1270 78B2           3149                                     mov             r0,#marker
1272 B60305         3150                                     cjne    @r0,#3,nomarl;26
1275 7609           3151                                     mov             @r0,#9
1277 020000   F     3152                                     jmp             goto7;  out7
                    3153     
127A                3154     nomarl:                 ;                               29.12.06
                    3155     ;;;;;;;;;;;;;;;;;;
                    3156     ;необходимо не портить цифру в следуюем справа знакоместе
                    3157     ;т е сохранить ее в ячейке для мигания в противном случае
                    3158     ;при сдвиге курсора мигания вправо переносилась цифра с предыдущего 
                    3159     ;       знакоместа
127A 78B2           3160                                     mov             r0,#marker
127C 7440           3161                                     mov             a,#bufind
127E 26             3162                                             add             a,@r0                   ;a=bufind+m
                             arker
127F F9             3163                                             mov             r1,a
1280 09             3164                                             inc             r1
1281 873C           3165                                             mov             savba,@r1
                    3166                                                     
1283 78B2           3167                                                     mov             r0,#marker
1285 16             3168                                                     dec             @r0                        
                                  ;нажата кн <- при вводе цифр A=000000
1286 C219           3169                                     clr             bitmig
1288 B60253         3170                                     cjne    @r0,#2,out7;26
128B 06             3171                                     inc             @r0
                    3172     ;нажат ввод А =000000 запомнить константу А
128C 75B0F7         3173     nopoin7:           mov          p3,#0f7h
128F E5B0           3174                                     mov             a,p3
1291 20E74A         3175                                     jb              acc.7,out7
1294 78B1           3176                                     mov             r0,#vichR
1296 E6             3177                                     mov             a,@r0
1297 B62124         3178                                     cjne    @r0,#21h,no21p7
129A 7631           3179                                     mov             @r0,#31h
                    3180                             ;       считать с индикатора  упаковать в плавающий формат
                    3181                             ;   сохранить
129C 120000   F     3182                                     call    upak                    
129F 784F           3183                                     mov             r0,#abin
12A1 7953           3184                                     mov             r1,#adec                        ;мл        
                              ст
12A3 120000   F     3185                                     call    decbin                  ;abin..abin+3 (hex)
12A6 120000   F     3186                                     call    loadr2                  ;r2..r5
12A9 120402         3187                                     call    altof                   ;r2..r5->int
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    50

12AC 78BC           3188                                     mov             r0,#konstA
12AE 120000   F     3189                                     call    saver2
                    3190     ;26
12B1 78B2           3191                                     mov             r0,#marker
12B3 7603           3192                                     mov             @r0,#3
12B5 900000   F     3193                                     mov             dptr,#teBequ0
12B8 120000   F     3194                                     call    lotext
                    3195                                     
12BB 020000   F     3196                                     jmp             goto7;out7
                    3197     
12BE                3198     no21p7:                 ;       считать с индикатора  упаковать в плавающий формат
                    3199                             ;   сохранить
12BE 120000   F     3200                                     call    upak                    
12C1 784F           3201                                     mov             r0,#abin
12C3 7953           3202                                     mov             r1,#adec                        ;мл        
                              ст
12C5 120000   F     3203                                     call    decbin                  ;abin..abin+3 (hex)
12C8 120000   F     3204                                     call    loadr2                  ;r2..r5
12CB 120402         3205                                     call    altof                   ;r2..r5->int
12CE 78C0           3206                                     mov             r0,#konstB
12D0 120000   F     3207                                     call    saver2
                    3208     
12D3 79B2           3209                                     mov             r1,#marker       ;B=000000-> ВЫЧИСЛИТЬ
12D5 77FF           3210                                     mov             @r1,#0ffh
12D7 78B1           3211                                     mov             r0,#vichR
12D9 7611           3212                                     mov             @r0,#11h
12DB 020000   F     3213                                jmp          lovich     ;ВЫЧИСЛИТЬ
                    3214     
                    3215     
12DE                3216     out7:                   ;mov            IE,#80h
12DE D083           3217                                     pop             dph
12E0 D082           3218                                     pop             dpl
12E2 D007           3219                                     pop             rr7     
12E4 D006           3220                                     pop             rr6
12E6 D005           3221                                     pop             rr5
12E8 D004           3222                                     pop             rr4
12EA D003           3223                                     pop             rr3
12EC D002           3224                                     pop             rr2
12EE D001           3225                                     pop             rr1                             
12F0 D000           3226                                     pop             rr0
12F2 D0D0           3227                                     pop             psw
12F4 D0E0           3228                                     pop             acc
12F6 E5AD           3229                                     mov             a,P3IF
12F8 547F           3230                                     anl             a,#7fh
12FA F5AD           3231                                     mov             P3IF,a
12FC 75B0C0         3232                                     mov             P3,#0c0h
                    3233     ;clr            bitmig
12FF 75E730         3234                                     mov             EIE2,#30H
1302 C219           3235     clr             bitmig
1304 32             3236                                     reti
                    3237     
1305 79AE           3238     loadUS:         mov             r1,#diap
1307 E7             3239                             mov             a,@r1
1308 23             3240                             rl              a;*2
1309 FC             3241                             mov             r4,a                    ;save a
130A 900000   F     3242                             mov             dptr,#tabus
130D 93             3243                             movc    a,@a+dptr
130E FA             3244                             mov             r2,a                    ;high byte
130F E584           3245                             mov             a,p4
1311 5401           3246                             anl             a,#01
1313 4A             3247                             orl             a,r2
1314 F584           3248                             mov             p4,a
1316 0C             3249                             inc             r4
1317 EC             3250                             mov             a,r4
1318 93             3251                             movc    a,@a+dptr
1319 FB             3252                             mov             r3,a                    ;low byte
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    51

131A E585           3253                             mov             a,p5
131C 5401           3254                             anl             a,#01
131E 4B             3255                             orl             a,r3
131F F585           3256                             mov             p5,a
1321 799A           3257                             mov             r1,#parT
1323 B7010E         3258                             cjne    @r1,#1,bret
1326 79AE           3259                             mov             r1,#diap                  ;10s (parT=1)
1328 7405           3260                             mov             a,#5                      ;10-8..10-11 p4.1=1
132A C3             3261                             clr             c
132B 97             3262                             subb    a,@r1
132C 5006           3263                             jnc             bret
132E E584           3264                             mov             a,p4
1330 4402           3265                             orl             a,#02
1332 F584           3266                             mov             p4,a                     ;10-8..10-11 p4.1=1
1334 120000   F     3267     bret:      call          louizm         ;us если вкл кн ИЗМЕР
1337 22             3268                             ret
                    3269     
                    3270                             
                    3271     ;загр ус для кор 0,тестов ацп и т.д.
                    3272     ;dptr-
1338 E4             3273     lospus:         clr             a
                    3274                             ;movc   a,@a+dptr
                    3275                             ;mov            r2,a                    ;high byte
                    3276                             ;mov            a,p4
                    3277                             ;anl            a,#01
                    3278                             ;orl            a,r2
                    3279                             ;mov            p4,a
                    3280                             ;inc            dptr
1339 E4             3281                             clr             a
133A 93             3282                             movc    a,@a+dptr
133B FB             3283                             mov             r3,a                    ;low byte
133C E585           3284                             mov             a,p5
133E 54BF           3285                             anl             a,#0bfh;01
1340 4B             3286                             orl             a,r3
1341 F585           3287                             mov             p5,a
1343 22             3288                             ret
                    3289     
1344 80             3290     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
                    3291     
                    3292     ;us кнопка измерения выкл
1345 88D6           3293     tabus:     db           88h,0d6h         ;10-2
1347 88F6           3294                             db      88h,0f6h         ;10-3
1349 88D6           3295                             db              88h,0d6h         ;10-4
134B 88F6           3296                             db              88h,0f6h         ;10-5
134D 9AD6           3297                             db      9ah,0d6h         ;10-6
134F 9AF6           3298                             db              9ah,0f6h         ;10-7
1351 ACD6           3299                             db              0ach,0d6h        ;10-8
1353 ACF6           3300                             db      0ach,0f6h        ;10-9
1355 C8D6           3301                             db              0c8h,0d6h        ;10-10
1357 C8F6           3302                             db              0c8h,0f6h        ;10-11
                    3303     
                    3304     
                    3305      ;загрузка текста в буфер 2 bufind+0..bufind9
                    3306     ;в зав от parT (Tизм)
1359 79B7           3307     loadT:          mov             r1,#load;parT
135B 7840           3308     lolevT:         mov             r0,#bufind+0
135D 7B0A           3309                             mov             r3,#10
135F 75F00A         3310                             mov             b,#10
1362 E7             3311                             mov             a,@r1
1363 A4             3312                             mul             ab
1364 FC             3313                             mov             r4,a                    ;save a
1365 900000   F     3314                             mov             dptr,#textT
1368 93             3315             lod1:   movc    a,@a+dptr
1369 F6             3316                             mov             @r0,a
136A 08             3317                             inc             r0
136B 0C             3318                             inc             r4
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    52

136C EC             3319                             mov             a,r4
136D DBF9           3320                             djnz    r3,lod1
136F 22             3321                             ret     
                    3322     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                    3323     ;dptr-адр строки текста         
1370                3324     lotext:         
1370 7B0A           3325                             mov             r3,#10
1372 7840           3326                             mov             r0,#bufind+0
1374 E4             3327     lodt:           clr             a
1375 93             3328                             movc    a,@a+dptr
1376 F6             3329                             mov             @r0,a
1377 08             3330                             inc             r0
1378 A3             3331                             inc             dptr
1379 DBF9           3332                             djnz    r3,lodt
137B 22             3333                             ret                                     
                    3334                                     
137C                3335     textT:          
137C FD543D32       3336                             db              0fdh,"T","=",32h,"m","S",0fdh,0fdh,0fdh,0fdh ;load=
                             0..5
1380 6D53FDFD                
1384 FDFD                    
1386 FD543D31       3337                             db              0fdh,"T","=",31h,30h,"m","S",0fdh,0fdh,0fdh
138A 306D53FD                
138E FDFD                    
1390 FD543D35       3338                             db              0fdh,"T","=",35h,30h,"m","S",0fdh,0fdh,0fdh
1394 306D53FD                
1398 FDFD                    
139A FD543D64       3339                             db              0fdh,"T","=",64h,31h,"S",0fdh,0fdh,0fdh,0fdh
139E 3153FDFD                
13A2 FDFD                    
13A4 20202054       3340                             db              " "," "," ","T","=",31h,"S"," "," "," "
13A8 3D315320                
13AC 2020                    
13AE 2020543D       3341                             db              " "," ","T","=",31h,30h,"S"," "," "," "  
13B2 31305320                
13B6 2020                    
                    3342     ;teNO:          db              0fdh,0fdh,0fdh,"H","E","T",0fdh,0fdh,0fdh,0fdh
                    3343     
13B8 42753474       3344      teVICH:        db              "B",75h,34h,74h,79h,76h,74h,"T",77h," ";вычислить
13BC 79767454                
13C0 7720                    
13C2 20413D2B       3345      teAequ0:       db              " ",'A','=','+',30h,30h,30h,30h,30h,30h
13C6 30303030                
13CA 3030                    
13CC 20423D2B       3346      teBequ0:       db              " ",'B','=','+',30h,30h,30h,30h,30h,30h
13D0 30303030                
13D4 3030                    
13D6 20207145       3347      teMENU:        db              " "," ",71h,"E","H",72h," "," "," "," "
13DA 48722020                
13DE 2020                    
                    3348     
13E0 20205445       3349      teTEST:        db      " "," ","T","E",79h,"T"," "," "," "," "
13E4 79542020                
13E8 2020                    
                    3350     
13EA 204B4176       3351      teKALIB:        db     " " ,'K','A',76h,74h,73h,"P "," "," "," ";КАЛИБР
13EE 74735020                
13F2 202020                  
13F5 74337120       3352      teIZMK:        db      74h,33h,71h," ","K",30h,"H",79h,"T"," "
13F9 4B304879                
13FD 5420                    
13FF 20204275       3353      teOUT:         db      " "," ","B",75h,"X",30h,78h," "," "," "  ;ВЫХОД
1403 58307820                
1407 2020                    
1409 2020304C       3354      teOLL:         db      " "," ",30h,'L','L'," "," "," "," "," "  ;OLL
140D 4C202020                
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    53

1411 2020                    
1413 20203034       3355      teCLE:         db      " "," ",30h,34h,74h,79h,'T','K','A' ," " ;ОЧИСТКА
1417 7479544B                
141B 4120                    
141D 20203041       3356      teMEM:         db      " "," ",30h,'A',71h,79h,'T'," " ; ПАМЯТЬ
1421 71795420                
1425 20203341       3357      teWR:          db      " "," ",33h,'A',61h,74h,79h,77h," "," ";ЗАПИСЬ
1429 61747977                
142D 2020                    
142F 20206150       3358      teLIST:        db      " "," ",61h,'P',30h,79h,71h,30h,"T","P ";;ПРОСМОТР
1433 30797130                
1437 545020                  
143A 20206130       3359      teFULL:        db      " "," ",61h,30h,76h,"H",'A',62h," "," ";ПОЛНАЯ
143E 76484162                
1442 2020                    
1444 20207376       3360      teBLOK:        db      " "," ",73h,76h,30h,'K'," ",30h,30h," ";БЛОК 00
1448 304B2030                
144C 3020                    
144E 20207376       3361      teBL:          db      " "," ",73h,76h,30h,'K'," "," "," "," ";БЛОК
1452 304B2020                
1456 2020                    
1458 48413420       3362      tebBL:         db      "H",'A',34h," ",73h,76h," ",30h,30h,30h; НАЧ БЛОК 000
145C 73762030                
1460 3030                    
1462 4B304820       3363      teeBL:         db      "K",30h,"H"," ",73h,76h," ",30h,30h,30h; КОН БЛОК 000
1466 73762030                
146A 3030                    
                    3364      ;;;;;;;;;;;;;;;;;;;         
                    3365     ;управление AD7731
                    3366     ;r4=b1 r5=b2
146C                3367     iniacp: ;управление AD7731
146C 7403           3368                             mov             a,#03
                    3369     
146E 120000   F     3370                             call    write
1471 EC             3371                             mov             a,r4;#80h
1472 120000   F     3372                             call    write
1475 ED             3373                             mov             a,r5;#04
1476 120000   F     3374                             call    write
1479 7402           3375                             mov             a,#02
147B 120000   F     3376                             call    write
147E 74A1           3377                             mov             a,#0a1h
1480 120000   F     3378                             call    write
1483 7474           3379                             mov             a,#74h
1485 120000   F     3380                             call    write
1488 2095FD         3381                             jb              p1.5,$;p1.3,$
148B 7402           3382                             mov             a,#02
148D 120000   F     3383                             call    write
1490 7481           3384                             mov             a,#81h
1492 120000   F     3385                             call    write
1495 7474           3386                             mov             a,#74h
1497 120000   F     3387                             call    write
149A 2095FD         3388                             jb              p1.5,$;p1.3,$
149D 7402           3389                             mov             a,#02
149F 120000   F     3390                             call    write
14A2 7421           3391                             mov             a,#21h
14A4 120000   F     3392                             call    write
14A7 7474           3393                             mov             a,#74h
14A9 120000   F     3394                             call    write
14AC 22             3395                             ret
                    3396                             ;;;;;;;;;;;;;;;;
                    3397     ;;;;;;;;;;;;;;;;;
                    3398     ;;;;;;;;;;;;;;;;;
14AD 0000           3399     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
14AF 6000           3400                                     db              60h,00h;40h,04h         ;10s
14B1 6000           3401                                     db              60h,00;40h,04h          ;1s
14B3 4004           3402                                     db              40h,04h         ;0,1s
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    54

14B5 2004           3403                                     db              20h,04h         ;50ms
14B7 2004           3404                                     db              20h,04h          ;10ms
14B9 1332           3405                                     db              13h,32h         ;2ms
                    3406     
                    3407     ;загр В1,В2 в завис от Т                                
14BB 799A           3408     loab12:                 mov             r1,#parT
14BD 900000   F     3409                                     mov             dptr,#tabB1_2
14C0 E7             3410                                     mov             a,@r1
14C1 23             3411                                     rl              a;*2
14C2 FF             3412                                     mov             r7,a                    ;save a
14C3 93             3413                                     movc    a,@a+dptr
14C4 FC             3414                                     mov             r4,a   ;b1
14C5 0F             3415                                     inc             r7
14C6 EF             3416                                     mov             a,r7
14C7 93             3417                                     movc    a,@a+dptr
14C8 FD             3418                                     mov             r5,a
                    3419                                     ;после загр В1,2 загр упр слово для нового Т
                    3420                             
14C9 22             3421                                     ret
                    3422     
                    3423     
                    3424     
                    3425     ;пп мигания индикации
14CA 78B2           3426     mign:           mov             r0,#marker
                    3427                                     
14CC B6FF03         3428                                     cjne    @r0,#0ffh,mignn
                    3429                                     ;реж изм мигает *
14CF C219           3430                                     clr             bitmig
14D1 22             3431                                     ret
                    3432     
14D2                3433     mignn:                  ;clr            c
14D2 7440           3434                                     mov             a,#bufind
14D4 26             3435                                     add             a,@r0                   ;a=bufind+marker
14D5 F9             3436                                     mov             r1,a
14D6 201907         3437                                     jb              bitmig,onmig
14D9 873C           3438                                     mov             savba,@r1
                    3439                             ;       mov             a,@r1
                    3440                             ;       mov             savba,a
14DB 7720           3441                                     mov             @r1,#" "
                    3442                                     
14DD D219           3443                                     setb    bitmig
14DF 22             3444                                     ret
                    3445     
14E0 A73C           3446     onmig:                  mov             @r1,savba
                    3447                                     ;mov            a,savba
                    3448                                     ; mov           @r1,a
14E2 C219           3449                                     clr             bitmig
14E4 120000   F     3450                                     call    z_01s
14E7 22             3451                                     ret
                    3452     ;bufind=30h..39h                                                                           
                                           ;
14E8 C219           3453     vvchif:                 clr             bitmig
14EA 79B2           3454                                     mov             r1,#marker
14EC E7             3455                                     mov             a,@r1                   ;изм цифры
14ED 7840           3456                                     mov             r0,#bufind                      ;0000
14EF 28             3457                                     add             a,r0
14F0 F8             3458                                     mov             r0,a
14F1 06             3459                                     inc             @r0
14F2 B63A02         3460                                     cjne    @r0,#3ah,chif
14F5 7630           3461                                     mov             @r0,#30h
14F7                3462     chif:   
14F7 22             3463                             ret
                    3464     
                    3465       ;перевод маркера влево
14F8                3466     marle:  
14F8 C219           3467                     clr             bitmig
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    55

                    3468                     ;mov            savba,#0   нельзя обнулять
14FA 78B2           3469             mov             r0,#marker
14FC 16             3470                     dec             @r0
14FD E6             3471                     mov             a,@r0
14FE C3             3472                     clr             c
14FF 953A           3473                     subb    a,movleft         ;крайне левое положение
1501 5001           3474                     jnc             rler
1503 06             3475                     inc             @r0
1504 22             3476     rler:   ret
                    3477         
                    3478     ;перевод маркера вправо
1505 C219           3479     marri:  clr             bitmig
1507 78B2           3480                     mov             r0,#marker
1509 06             3481                     inc         @r0
150A E53B           3482                     mov             a,movrig           ;крайне правое положение
150C C3             3483                     clr             c
150D 96             3484                     subb    a,@r0
150E 5001           3485                     jnc             rrir
1510 16             3486                     dec             @r0
1511 22             3487     rrir:   ret
                    3488         
                    3489     
                    3490     
                    3491     
1512 7852           3492     loadr2: mov             r0,#abin+3              ;r2..r5
1514 E6             3493                     mov             a,@r0                   ; ст мл   
1515 FA             3494                     mov             r2,a
1516 18             3495                     dec             r0
1517 E6             3496                     mov             a,@r0
1518 FB             3497                     mov             r3,a
1519 18             3498                     dec             r0
151A E6             3499                     mov             a,@r0
151B FC             3500                     mov             r4,a
151C 18             3501                     dec             r0
151D E6             3502                     mov             a,@r0
151E FD             3503                     mov             r5,a
151F 22             3504                     ret
                    3505                                             
                    3506      ;;;;;;;;;;;;;;;;;;;      
                    3507      ;загрузка KD в зависимости от диап изм  
                    3508      ;koef->r8..r11
1520 78AE           3509     loadKD:                 mov             r0,#diap
1522 E6             3510                                     mov             a,@r0
1523 900000   F     3511                                     mov             dptr,#diKDn
1526 75F004         3512                                     mov             b,#4
1529 A4             3513                                     mul             ab
152A FF             3514                                     mov             r7,a;save
152B 93             3515                                     movc    a,@a+dptr
152C F508           3516                                     mov             r8,a
152E A3             3517                                     inc             dptr
152F EF             3518                                     mov             a,r7
1530 93             3519                                     movc    a,@a+dptr
1531 F509           3520                                     mov             r9,a
1533 A3             3521                                     inc             dptr
1534 EF             3522                                     mov             a,r7
1535 93             3523                                     movc    a,@a+dptr
1536 F50A           3524                                     mov             r10,a
1538 A3             3525                                     inc             dptr
1539 EF             3526                                     mov             a,r7
153A 93             3527                                     movc    a,@a+dptr
153B F50B           3528                                     mov             r11,a
153D 22             3529                                     ret
                    3530     
153E 3F506B7B       3531      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
1542 3F507FCC       3532                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    56

1546 3F4F9D0B       3533                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
154A 3F4FE869       3534                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
154E 3F50294A       3535                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
1552 3F50639E       3536                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
1556 3F4BC9F0       3537                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
155A 3F4C063B       3538                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
155E 3F50EFDD       3539                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
1562 3F512AD9       3540                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                    3541     
1566 00000039       3542     ch57:   db      00,00,00,39h;57
156A 00000014       3543     ch20:   db      00,00,00,14h;20
                    3544     
                    3545     
                    3546     
                    3547     
                    3548     ;$include (d:\amp\subr2.asm) 
1305            +1  3549     loadUS: ;если идет тест измерения ус восстановить для теста
*** _________________________^
*** ERROR #A8 IN 3549 (d:\amp\subr2.asm, LINE 1): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
                +1  3550                                     ;jb             biteizm,yestest
156E 79AE       +1  3551                                             mov             r1,#diap
1570 E7         +1  3552                             mov             a,@r1
1571 23         +1  3553                             rl              a;*2
1572 FC         +1  3554                             mov             r4,a                    ;save a
1573 900000   F +1  3555                             mov             dptr,#tabus
1576 93         +1  3556                             movc    a,@a+dptr
1577 FA         +1  3557                             mov             r2,a                    ;high byte
1578 E584       +1  3558                             mov             a,p4
157A 5401       +1  3559                             anl             a,#01
157C 4A         +1  3560                             orl             a,r2
157D F584       +1  3561                             mov             p4,a
157F 0C         +1  3562                             inc             r4
1580 EC         +1  3563                             mov             a,r4
1581 93         +1  3564                             movc    a,@a+dptr
1582 FB         +1  3565                             mov             r3,a                    ;low byte
1583 E585       +1  3566                             mov             a,p5
1585 5401       +1  3567                             anl             a,#01
1587 4B         +1  3568                             orl             a,r3
1588 F585       +1  3569                             mov             p5,a
158A 799A       +1  3570                             mov             r1,#parT
158C B701A5     +1  3571                             cjne    @r1,#1,bret
*** ________________________________________________________________^
*** ERROR #A51 IN 3571 (d:\amp\subr2.asm, LINE 23): TARGET OUT OF RANGE
158F 79AE       +1  3572                             mov             r1,#diap                  ;10s (parT=1)
1591 7405       +1  3573                             mov             a,#5                      ;10-8..10-11 p4.1=1
1593 C3         +1  3574                             clr             c
1594 97         +1  3575                             subb    a,@r1
1595 509D       +1  3576                             jnc             bret
*** _________________________________________________________________^
*** ERROR #A51 IN 3576 (d:\amp\subr2.asm, LINE 28): TARGET OUT OF RANGE
1597 E584       +1  3577                             mov             a,p4
1599 4402       +1  3578                             orl             a,#02
159B F584       +1  3579                             mov             p4,a                     ;10-8..10-11 p4.1=1
159D 120000   F +1  3580     bret:      call          louizm         ;us если вкл кн ИЗМЕР
*** _________________________^
*** ERROR #A8 IN 3580 (d:\amp\subr2.asm, LINE 32): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
15A0 22         +1  3581                             ret
15A1            +1  3582     yestest:
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    57

15A1 120000   F +1  3583                             call            lotpus          ;ус теста измерения
15A4 22         +1  3584                             ret
                +1  3585                             
                +1  3586     ;загр ус для кор 0
                +1  3587     ;dptr-
15A5 E4         +1  3588     lospus:         clr             a
*** _________________________^
*** ERROR #A8 IN 3588 (d:\amp\subr2.asm, LINE 40): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
                +1  3589                             ;movc   a,@a+dptr
                +1  3590                             ;mov            r2,a                    ;high byte
                +1  3591                             ;mov            a,p4
                +1  3592                             ;anl            a,#01
                +1  3593                             ;orl            a,r2
                +1  3594                             ;mov            p4,a
                +1  3595                             ;inc            dptr
15A6 E4         +1  3596                             clr             a
15A7 93         +1  3597                             movc    a,@a+dptr
15A8 FB         +1  3598                             mov             r3,a                    ;low byte
15A9 E585       +1  3599                             mov             a,p5
15AB 54BF       +1  3600                             anl             a,#0bfh;01
15AD 4B         +1  3601                             orl             a,r3
15AE F585       +1  3602                             mov             p5,a
15B0 22         +1  3603                             ret
                +1  3604     
15B1 80         +1  3605     kor0us:         db              80h;18h,2eh             ;us режима коррекции 0
*** _________________________^
*** ERROR #A8 IN 3605 (d:\amp\subr2.asm, LINE 57): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
                +1  3606     
                +1  3607     ;us кнопка измерения выкл
15B2 88D6       +1  3608     tabus:     db           88h,0d6h         ;10-2
*** _________________________^
*** ERROR #A8 IN 3608 (d:\amp\subr2.asm, LINE 60): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
15B4 88F6       +1  3609                             db      88h,0f6h         ;10-3
15B6 88D6       +1  3610                             db              88h,0d6h         ;10-4
15B8 88F6       +1  3611                             db              88h,0f6h         ;10-5
15BA 9AD6       +1  3612                             db      9ah,0d6h         ;10-6
15BC 9AF6       +1  3613                             db              9ah,0f6h         ;10-7
15BE ACD6       +1  3614                             db              0ach,0d6h        ;10-8
15C0 ACF6       +1  3615                             db      0ach,0f6h        ;10-9
15C2 C8D6       +1  3616                             db              0c8h,0d6h        ;10-10
15C4 C8F6       +1  3617                             db              0c8h,0f6h        ;10-11
                +1  3618     
15C6            +1  3619     tabt11: 
15C6 66E6       +1  3620                             db              66h,0e6h;10-11
15C8            +1  3621     tabt9:  
15C8 32E6       +1  3622                             db              32h,0e6h;10-9
15CA            +1  3623     tabt7:  
15CA 18EE       +1  3624                             db              18h,0eeh;10-7
                +1  3625     
                +1  3626      ;загрузка текста в буфер 2 bufind+0..bufind9
                +1  3627     ;в зав от parT (Tизм)
15CC 79B7       +1  3628     loadT:          mov             r1,#load;parT
*** _________________________^
*** ERROR #A8 IN 3628 (d:\amp\subr2.asm, LINE 80): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
15CE 7840       +1  3629     lolevT:         mov             r0,#bufind+0
*** _________________________^
*** ERROR #A8 IN 3629 (d:\amp\subr2.asm, LINE 81): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
15D0 7B0A       +1  3630                             mov             r3,#10
15D2 75F00A     +1  3631                             mov             b,#10
15D5 E7         +1  3632                             mov             a,@r1
15D6 A4         +1  3633                             mul             ab
15D7 FC         +1  3634                             mov             r4,a                    ;save a
15D8 900000   F +1  3635                             mov             dptr,#textT
15DB 93         +1  3636             lod1:   movc    a,@a+dptr
*** _________________________________^
*** ERROR #A8 IN 3636 (d:\amp\subr2.asm, LINE 88): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    58

15DC F6         +1  3637                             mov             @r0,a
15DD 08         +1  3638                             inc             r0
15DE 0C         +1  3639                             inc             r4
15DF EC         +1  3640                             mov             a,r4
15E0 DB86       +1  3641                             djnz    r3,lod1
*** ____________________________________________________________^
*** ERROR #A51 IN 3641 (d:\amp\subr2.asm, LINE 93): TARGET OUT OF RANGE
15E2 22         +1  3642                             ret     
                +1  3643     ;загрузка текста в буфер 2 bufind+0..bufind9                    
                +1  3644     ;dptr-адр строки текста         
1370            +1  3645     lotext:         
*** _________________________^
*** ERROR #A8 IN 3645 (d:\amp\subr2.asm, LINE 97): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
15E3 7B0A       +1  3646                             mov             r3,#10
15E5 7840       +1  3647                             mov             r0,#bufind+0
15E7 E4         +1  3648     lodt:           clr             a
*** _________________________^
*** ERROR #A8 IN 3648 (d:\amp\subr2.asm, LINE 100): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
15E8 93         +1  3649                             movc    a,@a+dptr
15E9 F6         +1  3650                             mov             @r0,a
15EA 08         +1  3651                             inc             r0
15EB A3         +1  3652                             inc             dptr
15EC DB86       +1  3653                             djnz    r3,lodt
*** ____________________________________________________________^
*** ERROR #A51 IN 3653 (d:\amp\subr2.asm, LINE 105): TARGET OUT OF RANGE
15EE 22         +1  3654                             ret                                     
                +1  3655     
                +1  3656     
                +1  3657     
                +1  3658     
                +1  3659      ;задержка 100 мкс
15EF 7978       +1  3660     z_100:    mov R1,#78h     ;загрузка первого числа
15F1 7A02       +1  3661     z100:     mov R2,#2h     ;загрузка второго числа
15F3 DAFE       +1  3662     count:    djnz R2, count;декремент R2 и внутренний цикл, если R2<>0     
15F5 D9FA       +1  3663               djnz R1, z100 ;декремент R1 и внутренний цикл, если R1<>0
15F7 22         +1  3664               ret           
                +1  3665     
                +1  3666     ;задержка 34 мкс
15F8 7B8B       +1  3667     z_5:      mov R3,#8Bh      ;загрузка числа
15FA DBFE       +1  3668     ct:       djnz R3,ct
15FC 22         +1  3669               ret
                +1  3670     
                +1  3671     ;задержка 15 мс
15FD 79FA       +1  3672     z_15:     mov R1,#0FAh    ;загрузка первого числа
15FF 7AED       +1  3673     z15:      mov R2,#0EDh   ;загрузка второго числа
1601 DAFE       +1  3674     zz:       djnz R2, zz   ;декремент R2 и внутренний цикл, если R2<>0
1603 D9FA       +1  3675               djnz R1, z15  ;декремент R1 и внутренний цикл, если R1<>0
1605 22         +1  3676               ret   
                +1  3677                                               
                +1  3678      ;задержка 1 мс
1606 7910       +1  3679     z_1ms:     mov R1,#10h     
1608 7AED       +1  3680     ss1:       mov R2,#0EDh    
160A DAFE       +1  3681                djnz R2, $    
160C D9FA       +1  3682                djnz R1, ss1   
160E 22         +1  3683                ret   
                +1  3684     
                +1  3685      ;????????
                +1  3686     ;задержка 1с
160F 7D1F       +1  3687     z_1s:   mov             r5,#01fh 
1611 7EFF       +1  3688     co2s:   mov     R6,#0ffh     
1613 7FFF       +1  3689     z1s:     mov    R7,#0ffh     
1615 DFFE       +1  3690     co1s:   djnz    R7, co1s        
1617 DEFA       +1  3691             djnz    R6, z1s 
1619 DDF6       +1  3692                     djnz    r5,co2s
161B 22         +1  3693               ret
                +1  3694     ;задержка 0,1с
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    59

161C 7D03       +1  3695     z_01s:           mov            r5,#03h 
161E 7EFF       +1  3696     co02s:          mov     R6,#0ffh     
1620 7FFF       +1  3697     z01s:           mov     R7,#0ffh     
1622 DFFE       +1  3698                             djnz    R7, $   
1624 DEFA       +1  3699                     djnz    R6, z01s 
1626 DDF6       +1  3700                             djnz    r5,co02s
1628 22         +1  3701                      ret              
1629 000007FF   +1  3702     chzap:  db      00,00,07h,0ffh             
162D 00000000   +1  3703     ch0:    db      00,00,00,00
1631 0000000A   +1  3704     ch10:   db      00,00,00,0ah                            ;10
1635 00000005   +1  3705     ch5:    db      00,00,00,05                                             ;5
1639 000003B9   +1  3706     ch954:  db 00,00,03,0b9h                                                ;954
163D 000003E8   +1  3707     ch10000:        db 00,00,03h,0e8h                                               ;10000
1641 00000064   +1  3708     ch100:  db 00,00,00,64h ;100
1645 00000002   +1  3709     ch2:    db      00,00,00,02                                             
                +1  3710     ;CH_953:        db 3fh,74h,37h,72h;0,953971
                +1  3711     ;CH_953:        db 3fh,74h,1ch,71h;0,953558
                +1  3712     ;CH_953:        db 3fh,74h,02,0d2h;0.953168
1649 00000001   +1  3713     ch1:    db  00,00,00,01
164D 3F800000   +1  3714     ch_1:   db      3fh,80h,00,00                   
1651 3F741EDF   +1  3715     CH_953: db 3fh,74h,1eh,0dfh             ;0,953596
1655 47C35000   +1  3716     CHtho:  db      47h,0c3h,50h,00;48h,43h,50h,00;30d40 h  -000
1659 3F800347   +1  3717     KD:             db      3fh,80h,03h,47h;1,0001
165D 48435000   +1  3718     CH2tho: db      48h,43h,50h,00;200000
1661 4856D800   +1  3719     ch_220: db  48h,56h,0d8h,00;220000 -035b60 h
1665 4856D800   +1  3720     ch_200: db  48h,56h,0d8h,00;200000 -030d40 h
1669 461C4000   +1  3721     ch_10th:db  46h,1ch,40h,00;10000-2710h
166D 41200000   +1  3722     ch_10:  db      41h,20h,00,00;10d
1671 48742400   +1  3723     ch_250: db      48h,74h,24h,00;250000
                +1  3724     ;r1- мл байт 2х байтного числа
1675            +1  3725     tenmin:         ;-10
1675 C3         +1  3726                             clr             c
1676 E7         +1  3727                     mov             a,@r1
1677 9405       +1  3728                             subb    a,#5;10
1679 F7         +1  3729                             mov             @r1,a
167A 19         +1  3730                             dec             r1
167B E7         +1  3731                             mov             a,@r1
167C 9400       +1  3732                             subb    a,#0
167E F7         +1  3733                             mov             @r1,a
167F 22         +1  3734                             ret
                +1  3735       ;r0-обнуление ячеек памяти  
1680 7F04       +1  3736       clear4:        mov    r7,#4
1682 E4         +1  3737                             clr             a
1683 F6         +1  3738       cl4:          mov             @r0,a
1684 08         +1  3739                             inc             r0
1685 DFFC       +1  3740                             djnz    r7,cl4
1687 22         +1  3741                             ret     
                +1  3742     
                +1  3743      ;r0-обнуление ячеек памяти 
                +1  3744      ;R7- 
1688            +1  3745       clearN:        
1688 E4         +1  3746                             clr             a
1689 F6         +1  3747       cl4N:         mov             @r0,a
168A 08         +1  3748                             inc             r0
168B DFFC       +1  3749                             djnz    r7,cl4N
168D 22         +1  3750                             ret     
                +1  3751     
                +1  3752       ;чтение номера байта с индикатора(2байта)
                +1  3753     ;bufind+8..bufind+9
                +1  3754     ;-  - - -
                +1  3755     ;- - - - - - - - - -
                +1  3756     ;adec..adec+9
                +1  3757     ;ст            мл
168E 7848       +1  3758     upak2:  mov             r0,#bufind+8;
1690 795C       +1  3759                     mov             r1,#adec+9
1692 7F02       +1  3760                     mov             r7,#2;2bait
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    60

1694 C3         +1  3761     upa2:   clr             c
1695 E6         +1  3762                     mov             a,@r0
1696 9430       +1  3763                     subb    a,#30h
1698 F7         +1  3764                     mov             @r1,a
1699 18         +1  3765                     dec             r0
169A 19         +1  3766                     dec             r1
169B DFF7       +1  3767                     djnz    r7,upa2
169D 22         +1  3768                     ret  
                +1  3769         
                +1  3770      ;bufind+4..bufind+9
                +1  3771     ;-  - - -
                +1  3772     ;- - - - - - - - - -
                +1  3773     ;adec..adec+9
                +1  3774     ;ст            мл
169E 7849       +1  3775     upak:   mov             r0,#bufind+9;
16A0 795C       +1  3776                     mov             r1,#adec+9
16A2 7F06       +1  3777                     mov             r7,#6
16A4 C3         +1  3778     upa:    clr             c
16A5 E6         +1  3779                     mov             a,@r0
16A6 9430       +1  3780                     subb    a,#30h
16A8 F7         +1  3781                     mov             @r1,a
16A9 18         +1  3782                     dec             r0
16AA 19         +1  3783                     dec             r1
16AB DFF7       +1  3784                     djnz    r7,upa
16AD 22         +1  3785                     ret
                +1  3786     
                +1  3787      ;чтение номера байта с индикатора(3байта)
                +1  3788     ;bufind+3..bufind+9
                +1  3789     ;-  - - -
                +1  3790     ;- - - - - - - - - -
                +1  3791     ;adec..adec+9
                +1  3792     ;ст            мл
16AE 7849       +1  3793     upak3:  mov             r0,#bufind+9;
16B0 795C       +1  3794                     mov             r1,#adec+9
16B2 7F03       +1  3795                     mov             r7,#3;3bait
16B4 C3         +1  3796     upa1:   clr             c
16B5 E6         +1  3797                     mov             a,@r0
16B6 9430       +1  3798                     subb    a,#30h
16B8 F7         +1  3799                     mov             @r1,a
16B9 18         +1  3800                     dec             r0
16BA 19         +1  3801                     dec             r1
16BB DFF7       +1  3802                     djnz    r7,upa1
16BD 22         +1  3803                     ret
                +1  3804     
                +1  3805     ;вых-r2,r3-адрес ячее памяти прогр
16BE            +1  3806     findkoef:
16BE 79AE       +1  3807                                     mov             r1,#diap
16C0 E7         +1  3808                                     mov             a,@r1
16C1 23         +1  3809                                     rl              a                                          
                                          ;diap*2(2bait )
16C2 FC         +1  3810                                     mov             r4,a                                    ;sa
                             ve
16C3 900000   F +1  3811                                     mov             dptr,#diKDw             ;адрес таблицы поис
                             ка коффициентов
                +1  3812                                     
16C6 93         +1  3813                                     movc    a,@a+dptr                       ;ст байт
16C7 FA         +1  3814                                     mov             r2,a
16C8 A3         +1  3815                                     inc             dptr
16C9 EC         +1  3816                                     mov             a,r4
16CA 93         +1  3817                                     movc    a,@a+dptr
16CB FB         +1  3818                                     mov             r3,a                    ;мл байт
16CC 22         +1  3819                                     ret
                +1  3820     
                +1  3821     ;адрес ячеек прзу  коффициентов диапазона KD
                +1  3822     ;(5000h..5027h)
16CD 5000       +1  3823     diKDw:  dw              5000h                   ;10-2
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    61

16CF 5004       +1  3824                                     dw              5004h                   ;10-3
16D1 5008       +1  3825                                     dw              5008h                   ;10-4
16D3 500C       +1  3826                                     dw              500ch                   ;10-5
16D5 5010       +1  3827                                     dw              5010h                   ;10-6
16D7 5014       +1  3828                                     dw              5014h                   ;10-7
16D9 5018       +1  3829                                     dw              5018h                   ;10-8
16DB 501C       +1  3830                                     dw              501ch                   ;10-9
16DD 5020       +1  3831                                     dw              5020h                   ;10-10
16DF 5024       +1  3832                                     dw              5024h                   ;10-11
16E1 5028       +1  3833     dipar:  dw              5028h                   ;parol
                +1  3834     
16E3 000186A0   +1  3835     chthou: db      00,01,86h,0a0h  ;100.000
                +1  3836     
16E7 AA08       +1  3837     move82:         mov     r2,ltemp                        ;ltemp->r2..r5
16E9 AB09       +1  3838                                             mov     r3,ltemp+1
16EB AC0A       +1  3839                                             mov     r4,ltemp+2
16ED AD0B       +1  3840                                             mov     r5,ltemp+3
16EF 22         +1  3841                                             ret
                +1  3842     ;bufind+4..bufind+9
                +1  3843     ;-  - - -
                +1  3844     ;- - - - - - - - - -
                +1  3845     ;adec..adec+9
                +1  3846     ;ст            мл
16F0 7847       +1  3847     upakA:  mov             r0,#bufind+7;
16F2 795C       +1  3848                     mov             r1,#adec+9
16F4 7F04       +1  3849                     mov             r7,#4
16F6 C3         +1  3850     upaa:   clr             c
16F7 E6         +1  3851                     mov             a,@r0
16F8 9430       +1  3852                     subb    a,#30h
16FA F7         +1  3853                     mov             @r1,a
16FB 18         +1  3854                     dec             r0
16FC 19         +1  3855                     dec             r1
16FD DFF7       +1  3856                     djnz    r7,upaa
16FF 22         +1  3857                     ret
                +1  3858     
                +1  3859     ;bufind+4..bufind+9
                +1  3860     ;-  - - -
                +1  3861     ;- - - - - - - - - -
                +1  3862     ;adec..adec+9
                +1  3863     ;ст            мл
1700 7848       +1  3864     upakB:  mov             r0,#bufind+8;
1702 795C       +1  3865                     mov             r1,#adec+9
1704 7F05       +1  3866                     mov             r7,#5
1706 C3         +1  3867     upab:   clr             c
1707 E6         +1  3868                     mov             a,@r0
1708 9430       +1  3869                     subb    a,#30h
170A F7         +1  3870                     mov             @r1,a
170B 18         +1  3871                     dec             r0
170C 19         +1  3872                     dec             r1
170D DFF7       +1  3873                     djnz    r7,upab
170F            +1  3874                     clr                     bitznB
*** _________________________________________________________________^
*** ERROR #A45 IN 3874 (d:\amp\subr2.asm, LINE 326): UNDEFINED SYMBOL (PASS-2)
1711 E543       +1  3875                     mov             a,bufind+3
1713 B42D02     +1  3876                     cjne            a,#2dh,abret
1716            +1  3877                     setb            bitznB
*** _________________________________________________________^
*** ERROR #A45 IN 3877 (d:\amp\subr2.asm, LINE 329): UNDEFINED SYMBOL (PASS-2)
1718            +1  3878     abret:
1718 22         +1  3879                     ret
1719            +1  3880     CH_B:                   db      ;       4bh,18h,96h,80h;989680h=10 **7
1719 4E6E6AA8   +1  3881                                             db      4eh,6eh,6ah,0a8h;10**9
171D 43FA0000   +1  3882     CH_500:         db              43h,0fah,00,00;1fah=500
1721 4856D800   +1  3883     CH_22T:         db              48h,56h,0d8h,00;46h,0abh,0e0h,00;55f0h=22000
1725 49742400   +1  3884     CH_fl:  db      49h,74h,24h,00;47h,0c3h,50h,00;100000
                +1  3885     
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    62

                +1  3886     
                +1  3887     
                +1  3888     ;управление AD7731
                +1  3889     ;r4=b1 r5=b2
146C            +1  3890     iniacp: ;управление AD7731
*** _________________________^
*** ERROR #A8 IN 3890 (d:\amp\subr2.asm, LINE 342): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
1729 7403       +1  3891                             mov             a,#03
                +1  3892     
172B 120000   F +1  3893                             call    write
172E EC         +1  3894                             mov             a,r4;#80h
172F 120000   F +1  3895                             call    write
1732 ED         +1  3896                             mov             a,r5;#04
1733 120000   F +1  3897                             call    write
1736 7402       +1  3898                             mov             a,#02
1738 120000   F +1  3899                             call    write
173B 74A1       +1  3900                             mov             a,#0a1h
173D 120000   F +1  3901                             call    write
1740 7474       +1  3902                             mov             a,#74h
1742 120000   F +1  3903                             call    write
1745 2095FD     +1  3904                             jb              p1.5,$;p1.3,$
1748 7402       +1  3905                             mov             a,#02
174A 120000   F +1  3906                             call    write
174D 7481       +1  3907                             mov             a,#81h
174F 120000   F +1  3908                             call    write
1752 7474       +1  3909                             mov             a,#74h
1754 120000   F +1  3910                             call    write
1757 2095FD     +1  3911                             jb              p1.5,$;p1.3,$
175A 7402       +1  3912                             mov             a,#02
175C 120000   F +1  3913                             call    write
175F 7421       +1  3914                             mov             a,#21h
1761 120000   F +1  3915                             call    write
1764 7474       +1  3916                             mov             a,#74h
1766 120000   F +1  3917                             call    write
1769 22         +1  3918                             ret
                +1  3919                             ;;;;;;;;;;;;;;;;
                +1  3920     ;;;;;;;;;;;;;;;;;
                +1  3921     ;;;;;;;;;;;;;;;;;
176A 0000       +1  3922     tabB1_2:                db              00,00            ;B1,B2 в соотв с Tизм  
*** _________________________^
*** ERROR #A8 IN 3922 (d:\amp\subr2.asm, LINE 374): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
176C 6000       +1  3923                                     db              60h,00h;40h,04h         ;10s
176E 6000       +1  3924                                     db              60h,00;40h,04h          ;1s
1770 4004       +1  3925                                     db              40h,04h         ;0,1s
1772 2004       +1  3926                                     db              20h,04h         ;50ms
1774 2004       +1  3927                                     db              20h,04h          ;10ms
1776 1332       +1  3928                                     db              13h,32h         ;2ms
                +1  3929     
                +1  3930     ;загр В1,В2 в завис от Т                                
1778 799A       +1  3931     loab12:                 mov             r1,#parT
*** _________________________^
*** ERROR #A8 IN 3931 (d:\amp\subr2.asm, LINE 383): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
177A 900000   F +1  3932                                     mov             dptr,#tabB1_2
177D E7         +1  3933                                     mov             a,@r1
177E 23         +1  3934                                     rl              a;*2
177F FF         +1  3935                                     mov             r7,a                    ;save a
1780 93         +1  3936                                     movc    a,@a+dptr
1781 FC         +1  3937                                     mov             r4,a   ;b1
1782 0F         +1  3938                                     inc             r7
1783 EF         +1  3939                                     mov             a,r7
1784 93         +1  3940                                     movc    a,@a+dptr
1785 FD         +1  3941                                     mov             r5,a
                +1  3942                                     ;после загр В1,2 загр упр слово для нового Т
                +1  3943                             
1786 22         +1  3944                                     ret
                +1  3945     
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    63

                +1  3946     
1787 7852       +1  3947     loadr2: mov             r0,#abin+3              ;r2..r5
*** _________________________^
*** ERROR #A8 IN 3947 (d:\amp\subr2.asm, LINE 399): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
1789 E6         +1  3948                     mov             a,@r0                   ; ст мл   
178A FA         +1  3949                     mov             r2,a
178B 18         +1  3950                     dec             r0
178C E6         +1  3951                     mov             a,@r0
178D FB         +1  3952                     mov             r3,a
178E 18         +1  3953                     dec             r0
178F E6         +1  3954                     mov             a,@r0
1790 FC         +1  3955                     mov             r4,a
1791 18         +1  3956                     dec             r0
1792 E6         +1  3957                     mov             a,@r0
1793 FD         +1  3958                     mov             r5,a
1794 22         +1  3959                     ret
                +1  3960                                             
                +1  3961      ;;;;;;;;;;;;;;;;;;;      
                +1  3962      ;загрузка KD в зависимости от диап изм  
                +1  3963      ;koef->r8..r11
1795 78AE       +1  3964     loadKD:                 mov             r0,#diap
*** _________________________^
*** ERROR #A8 IN 3964 (d:\amp\subr2.asm, LINE 416): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
1797 E6         +1  3965                                     mov             a,@r0
1798 900000   F +1  3966                                     mov             dptr,#diKDn
179B 75F004     +1  3967                                     mov             b,#4
179E A4         +1  3968                                     mul             ab
179F FF         +1  3969                                     mov             r7,a;save
17A0 93         +1  3970                                     movc    a,@a+dptr
17A1 F508       +1  3971                                     mov             r8,a
17A3 A3         +1  3972                                     inc             dptr
17A4 EF         +1  3973                                     mov             a,r7
17A5 93         +1  3974                                     movc    a,@a+dptr
17A6 F509       +1  3975                                     mov             r9,a
17A8 A3         +1  3976                                     inc             dptr
17A9 EF         +1  3977                                     mov             a,r7
17AA 93         +1  3978                                     movc    a,@a+dptr
17AB F50A       +1  3979                                     mov             r10,a
17AD A3         +1  3980                                     inc             dptr
17AE EF         +1  3981                                     mov             a,r7
17AF 93         +1  3982                                     movc    a,@a+dptr
17B0 F50B       +1  3983                                     mov             r11,a
17B2 22         +1  3984                                     ret
                +1  3985     
17B3 3F506B7B   +1  3986      diKDn:                 db              3fh,50h,6bh,7bh;3fh,80h,00,00           ;10-2
*** __________________________^
*** ERROR #A8 IN 3986 (d:\amp\subr2.asm, LINE 438): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
17B7 3F507FCC   +1  3987                                     db              3fh,50h,7fh,0cch;3fh,80h,00,00          ;10
                             -3
17BB 3F4F9D0B   +1  3988                                     db              3fh,4fh,9dh,0bh;3fh,80h,00,00           ;10
                             -4
17BF 3F4FE869   +1  3989                                     db              3fh,4fh,0e8h,69h;3fh,80h,00,00          ;10
                             -5
17C3 3F50294A   +1  3990                                     db              3fh,50h,29h,4ah;3fh,80h,00,00;4fh,0e9h,11h 
                                  ;0,81215   10-6
17C7 3F50639E   +1  3991                                      db             3fh,50h,63h,9eh;3fh,80h,00,00           ;10
                             -7
17CB 3F4BC9F0   +1  3992                                     db              3fh,4bh,0c9h,0f0h;3fh,80h,00,00         ;10
                             -8
17CF 3F4C063B   +1  3993                                     db              3fh,4ch,06h,3bh;3fh,80h,00,00           ;10
                             -9
17D3 3F50EFDD   +1  3994                                     db              3fh,50h,0efh,0ddh;3fh,80h,00,00         ;10
                             -10
17D7 3F512AD9   +1  3995                                     db              3fh,51h,2ah,0d9h;3fh,80h,00,00          ;10
                             -11
                +1  3996     
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    64

17DB 00000039   +1  3997     ch57:   db      00,00,00,39h;57
*** _________________________^
*** ERROR #A8 IN 3997 (d:\amp\subr2.asm, LINE 449): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
17DF 00000014   +1  3998     ch20:   db      00,00,00,14h;20
*** _________________________^
*** ERROR #A8 IN 3998 (d:\amp\subr2.asm, LINE 450): ATTEMPT TO DEFINE AN ALREADY DEFINED LABEL
                +1  3999     
                +1  4000     ;загр ус для тестов ацп 
                +1  4001     ;dptr-
17E3 78B1       +1  4002     lotpus: mov             r0,#vichR
17E5 B6210D     +1  4003                                     cjne    @r0,#21h,te22
17E8 900000   F +1  4004                                     mov                     dptr,#tabt11;заслать ус 11А
17EB E4         +1  4005     lotp:           clr             a
17EC 93         +1  4006                             movc    a,@a+dptr                               ;high byte
17ED F584       +1  4007                             mov             p4,a
17EF A3         +1  4008                             inc             dptr
17F0 E4         +1  4009                             clr             a
17F1 93         +1  4010                             movc    a,@a+dptr                               ;low byte
17F2 F585       +1  4011                             mov             p5,a
17F4 22         +1  4012                             ret
17F5 B62205     +1  4013     te22:                   cjne    @r0,#22h,te23
17F8 900000   F +1  4014                             mov                     dptr,#tabt9;заслать ус 9А       
17FB 80EE       +1  4015                             jmp                     lotp
                +1  4016     
17FD 900000   F +1  4017     te23:   mov                     dptr,#tabt7;заслать ус 7А       
1800 80E9       +1  4018                             jmp                     lotp
                +1  4019     
                +1  4020     
                +1  4021     
                +1  4022     
                +1  4023     
1802 02030405   +1  4024     Tabn:           db              2,3,4,5,6,7,8,9,10,11                           ;порядок ди
                             апазонов степени
1806 06070809                
180A 0A0B                    
                +1  4025     
180C 78AE       +1  4026     findR:                  mov                     r0,#diap
180E E6         +1  4027                                                     mov                     a,@r0
180F 900000   F +1  4028                                                     mov                     dptr,#Tabn
1812 93         +1  4029                                                     movc            a,@a+dptr
1813 22         +1  4030                                                     ret
                    4031     
                    4032     ;$include (d:\amp\sarifm3.asm) 
                +1  4033     ; ” ©« SARIFM.ASM 8.11.95
                +1  4034     ;файл арифметики
                +1  4035       
  0008          +1  4036     ltemp    equ       8           ;long temporary
  000C          +1  4037     xtemp    equ       12          ;other temporaries
  000A          +1  4038     DECSIZE  EQU       10
  0004          +1  4039     NUMSIZE  EQU       4
  0004          +1  4040     RR4  EQU       4
  0005          +1  4041     RR5  EQU       5
                +1  4042     
                +1  4043                                                     
                +1  4044     
                +1  4045                 ; rseg     ARIF          ; Switch to this code segment.
                +1  4046     ;             using    0              ; Specify register bank for the following
                +1  4047                                            ; program code.
                +1  4048     ;                                               cseg AT 400h
                +1  4049     ; Arithmetics:  CLEARING string
                +1  4050     ; Input:
                +1  4051     ; R0 - pointer to string,
                +1  4052     ; NUMSIZE - byte count if CLRNUM used,
                +1  4053     ; DECSIZE - byte count if CLRDEC used,
                +1  4054     ; R2 - byte count if CLEAR used;
                +1  4055     ; Output:  none.
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    65

                +1  4056     
1814            +1  4057     CLRDEC:
1814 7A0A       +1  4058         MOV R2, #DECSIZE
1816 8002       +1  4059         SJMP    CLEAR
1818            +1  4060     CLRNUM:
1818 7A04       +1  4061         MOV R2, #NUMSIZE
                +1  4062         ;JMP    CLEAR
181A            +1  4063     CLEAR:
181A E4         +1  4064         CLR A
181B F6         +1  4065     CLR11:  MOV @R0, A
181C 08         +1  4066         INC R0
181D DAFC       +1  4067         DJNZ    R2, CLR11
181F 22         +1  4068         RET
                +1  4069     
                +1  4070     ;**********************************
                +1  4071     ;mov    r1,#abin+3
                +1  4072     ;mov    r0,#adec
                +1  4073     ; _ _ _ _
                +1  4074     ;     03ff
                +1  4075     ;ст     мл   - вход
                +1  4076     ; _ _ _ _ _ _ _ _ _ _
                +1  4077     ;             1 0 2 3
                +1  4078     ;ст                мл 
                +1  4079     ;**********************************
                +1  4080     
1820            +1  4081     BINDEC:
                +1  4082     ; Arithmetics:  CONVERTING from binary into decimal "4->10"
                +1  4083     ; Input:
                +1  4084     ; R0 - pointer to destination (high digit is the first),
                +1  4085     ; R1 - pointer to source,
                +1  4086     ; NUMSIZE - byte count in binary number;
                +1  4087     ; DECSIZE - byte count in decimal number;
                +1  4088     ; Output:  none.
                +1  4089     ; Source saved
                +1  4090     
                +1  4091         ; 1. Clear result
1820 7A05       +1  4092         MOV R2, #DECSIZE/2
1822 120000   F +1  4093         CALL   CLEAR  ; incrementing R0
                +1  4094     
                +1  4095         ; 2. Prepare convertion
1825 18         +1  4096         DEC R0
1826 8804       +1  4097         MOV RR4, R0 ; R4 - pointer to low byte of packed decimal result
1828 8905       +1  4098         MOV RR5, R1 ; R5 - pointer to low byte of binary number
182A 7B20       +1  4099         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  4100     
                +1  4101         ; 3. Convert cyrcle
182C            +1  4102     BIN30:
                +1  4103     
                +1  4104         ; 3.1. Rotate binary number one bit to left and prepare <Carry>
182C A905       +1  4105         MOV R1, RR5
182E 7A04       +1  4106         MOV R2, #NUMSIZE
1830 E7         +1  4107     BIN31:  MOV A, @R1
1831 33         +1  4108         RLC A
1832 F7         +1  4109         MOV @R1, A
1833 19         +1  4110         DEC R1
1834 DAFA       +1  4111         DJNZ    R2, BIN31
1836 A905       +1  4112         MOV R1, RR5
1838 E7         +1  4113         MOV A, @R1
1839 92E0       +1  4114         MOV ACC.0, C
183B F7         +1  4115         MOV @R1, A
                +1  4116     
                +1  4117         ; 3.2. Doubling decimal result with <Carry>
183C A804       +1  4118         MOV R0, RR4
183E 7A05       +1  4119         MOV R2, #DECSIZE/2
1840 E6         +1  4120     BIN32:  MOV A, @R0
1841 36         +1  4121         ADDC    A, @R0
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    66

1842 D4         +1  4122         DA  A
1843 F6         +1  4123         MOV @R0, A
1844 18         +1  4124         DEC R0
1845 DAF9       +1  4125         DJNZ    R2, BIN32
                +1  4126     
                +1  4127         ; 3.3. End of convert cyrcle
1847 DBE3       +1  4128         DJNZ    R3, BIN30
                +1  4129     
                +1  4130         ; 4. Make bytes from half-bytes
1849 E8         +1  4131         MOV A, R0
184A 240A       +1  4132         ADD A, #DECSIZE
184C F8         +1  4133         MOV R0, A   ; R0 - pointer to low byte of unpacked decimal result
184D A904       +1  4134         MOV R1, RR4 ; R1 - pointer to low byte of packed decimal result
184F 7A05       +1  4135         MOV R2, #DECSIZE/2
1851 E7         +1  4136     BIN41:  MOV A, @R1
1852 540F       +1  4137         ANL A, #00FH
1854 F6         +1  4138         MOV @R0, A
1855 18         +1  4139         DEC R0
1856 E7         +1  4140         MOV A, @R1
1857 C4         +1  4141         SWAP    A
1858 540F       +1  4142         ANL A, #00FH
185A F6         +1  4143         MOV @R0, A
185B 18         +1  4144         DEC R0
185C 19         +1  4145         DEC R1
185D DAF2       +1  4146         DJNZ    R2, BIN41
185F 22         +1  4147         RET
                +1  4148     
                +1  4149     
                +1  4150     ;*********************************
                +1  4151     ;mov    r0,#abin
                +1  4152     ;mov    r1,#adec
                +1  4153     ; _ _ _ _       -выход
                +1  4154     ; ff0000
                +1  4155     ;0004
                +1  4156     ;мл      ст
                +1  4157     
                +1  4158     ;ст                       мл
                +1  4159     ;_ _ _ _ _ _ _ _ _ _     вход
                +1  4160     ;                       2 5 5
                +1  4161     ;                   1 0 2 4
                +1  4162     
1860            +1  4163     DECBIN:
                +1  4164     ; Arithmetics:  CONVERTING from decimal into binary "10->4"
                +1  4165     ; Input:
                +1  4166     ; R0 - pointer to destination,
                +1  4167     ; R1 - pointer to source (high digit is the first),
                +1  4168     ; NUMSIZE - byte count in binary number;
                +1  4169     ; DECSIZE - byte count in decimal number;
                +1  4170     ; Output:  none
                +1  4171     ; Source cleared
                +1  4172     
                +1  4173         ; 1. Clear result
1860 120000   F +1  4174         CALL    CLRNUM    ; + increment R0 by NUMSIZE
                +1  4175     
                +1  4176         ; 2. Prepare convertion
1863 18         +1  4177         DEC R0
1864 8804       +1  4178         MOV RR4, R0 ; R4 - pointer to high byte of binary result
1866 8905       +1  4179         MOV RR5, R1 ; R5 - pointer to high byte of packed decimal number
1868 900000   F +1  4180         MOV DPTR, #DECT2
186B 7B20       +1  4181         MOV R3, #NUMSIZE*8  ; R3 - bit counter in binary number
                +1  4182     
                +1  4183         ; 3. Convert cyrcle
186D            +1  4184     DEC30:
                +1  4185     
                +1  4186         ; 3.1. Divide decimal number by 2 and prepare <Carry>
186D C3         +1  4187         CLR C
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    67

186E A905       +1  4188         MOV R1, RR5
1870 7A0A       +1  4189         MOV R2, #DECSIZE
1872 E7         +1  4190     DEC31:  MOV A, @R1
1873 540F       +1  4191         ANL A, #00FH
1875 92E4       +1  4192         MOV ACC.4, C
1877 93         +1  4193         MOVC    A,@A+DPTR
1878 F7         +1  4194         MOV @R1, A
1879 A2E7       +1  4195         MOV C, ACC.7
187B 09         +1  4196         INC R1
187C DAF4       +1  4197         DJNZ    R2, DEC31
                +1  4198     
                +1  4199         ; 3.2. Rotate binary result one bit to right with <Carry>
187E A804       +1  4200         MOV R0, RR4
1880 7A04       +1  4201         MOV R2, #NUMSIZE
1882 E6         +1  4202     DEC32:  MOV A, @R0
1883 13         +1  4203         RRC A
1884 F6         +1  4204         MOV @R0, A
1885 18         +1  4205         DEC R0
1886 DAFA       +1  4206         DJNZ    R2, DEC32
                +1  4207     
                +1  4208         ; 3.3. End of convert cyrcle
1888 DBE3       +1  4209         DJNZ    R3, DEC30
188A 22         +1  4210         RET
                +1  4211     
188B 00800181   +1  4212     DECT2:  DB  00,80H,001,81H,02,82H,03,83H,04,84H
188F 02820383                
1893 0484                    
1895 00000000   +1  4213         DB  00,00,00,00,00,00
1899 0000                    
189B 05850686   +1  4214         DB  05,85H,06,86H,07,87H,08H,88H,09H,89H
189F 07870888                
18A3 0989                    
                +1  4215     
                +1  4216     ;   Long comparison
                +1  4217     ;   Lcmp - called with arg1 in r2-r5 and arg2 in ltemp - returns with
                +1  4218     ;   flags and acc set as though a long subtraction was done.
                +1  4219     ;*******************************
                +1  4220     ;сравнить r2..r5 с (ltemp..ltemp+3)
                +1  4221     ;c=1     r2..r5< ltemp..ltemp+3     a<b
                +1  4222     ;c=0       r2..r5> ltemp..ltemp+3   a>b
                +1  4223     ;*******************************
18A5            +1  4224     lcmp:
18A5 C3         +1  4225         clr c
18A6 EA         +1  4226         mov a,r2
18A7 9508       +1  4227         subb    a,8
18A9 700F       +1  4228         jnz done
18AB EB         +1  4229         mov a,r3
18AC 9509       +1  4230         subb    a,9
18AE 7008       +1  4231         jnz done1
18B0 EC         +1  4232         mov a,r4
18B1 950A       +1  4233         subb    a,10
18B3 7003       +1  4234         jnz done1
18B5 ED         +1  4235         mov a,r5
18B6 950B       +1  4236         subb    a,11
18B8            +1  4237     done1:
18B8 C2D2       +1  4238         clr ov      ;overflow is significant only for top byte
18BA            +1  4239     done:
18BA 22         +1  4240         ret
                +1  4241     
                +1  4242     ;   Load long into r2-5 from [dptr]
                +1  4243     
18BB            +1  4244     ldc_long:
18BB E583       +1  4245         mov a,dph       ;is it in on board memory
18BD 6010       +1  4246         jz  onboard     ;yes
18BF E4         +1  4247         clr a
18C0 93         +1  4248         movc    a,@a+dptr
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    68

18C1 FA         +1  4249         mov r2,a
18C2 7401       +1  4250         mov a,#1
18C4 93         +1  4251         movc    a,@a+dptr
18C5 FB         +1  4252         mov r3,a
18C6 7402       +1  4253         mov a,#2
18C8 93         +1  4254         movc    a,@a+dptr
18C9 FC         +1  4255         mov r4,a
18CA 7403       +1  4256         mov a,#3
18CC 93         +1  4257         movc    a,@a+dptr
18CD FD         +1  4258         mov r5,a
18CE 22         +1  4259         ret
18CF            +1  4260     onboard:
18CF A882       +1  4261         mov r0,dpl
18D1 E6         +1  4262         mov a,@r0
18D2 FA         +1  4263         mov r2,a
18D3 08         +1  4264         inc r0
18D4 E6         +1  4265         mov a,@r0
18D5 FB         +1  4266         mov r3,a
18D6 08         +1  4267         inc r0
18D7 E6         +1  4268         mov a,@r0
18D8 FC         +1  4269         mov r4,a
18D9 08         +1  4270         inc r0
18DA E6         +1  4271         mov a,@r0
18DB FD         +1  4272         mov r5,a
18DC 22         +1  4273         ret
                +1  4274     
                +1  4275     ;**************************************
                +1  4276     ;загрузить ltemp...+3 из памяти программ
                +1  4277     ;mov    dptr,#CH5
                +1  4278     ;call   ldc_ltemp        ltemp <--5
                +1  4279     ;**************************************
18DD            +1  4280     ldc_ltemp:
18DD E583       +1  4281         mov a,dph       ;is it in on board memory
18DF 6014       +1  4282         jz  oboard      ;yes
18E1 E4         +1  4283         clr a
18E2 93         +1  4284         movc    a,@a+dptr
18E3 F508       +1  4285         mov 8,a
18E5 7401       +1  4286         mov a,#1
18E7 93         +1  4287         movc    a,@a+dptr
18E8 F509       +1  4288         mov 9,a
18EA 7402       +1  4289         mov a,#2
18EC 93         +1  4290         movc    a,@a+dptr
18ED F50A       +1  4291         mov 10,a
18EF 7403       +1  4292         mov a,#3
18F1 93         +1  4293         movc    a,@a+dptr
18F2 F50B       +1  4294         mov 11,a
18F4 22         +1  4295         ret
18F5            +1  4296     oboard:
18F5 A882       +1  4297         mov r0,dpl
18F7 8608       +1  4298         mov 8,@r0
18F9 08         +1  4299         inc r0
18FA 8609       +1  4300         mov 9,@r0
18FC 08         +1  4301         inc r0
18FD 860A       +1  4302         mov 10,@r0
18FF 08         +1  4303         inc r0
1900 860B       +1  4304         mov 11,@r0
1902 22         +1  4305         ret
                +1  4306     
                +1  4307     ;*****************************
                +1  4308     ;mov    dptr,#k1
                +1  4309     ;call   ldx_long
                +1  4310     ;k1->r2..r5
                +1  4311     ;*****************************
                +1  4312     ;   Load long into r2-5 from [dptr]
                +1  4313     ;
                +1  4314     ; 01/30/90 JLZ      Updated from new library; added save/restore DPH, DPL
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    69

1903            +1  4315     ldx_long:
1903 E583       +1  4316         mov a,dph       ;is it in on board memory
1905 6014       +1  4317         jz  onboar1        ;yes
1907 C082       +1  4318         push    dpl
1909 C083       +1  4319         push    dph
190B E0         +1  4320         movx    a,@dptr
190C FA         +1  4321         mov r2,a
190D A3         +1  4322         inc dptr
190E E0         +1  4323         movx    a,@dptr
190F FB         +1  4324         mov r3,a
1910 A3         +1  4325         inc dptr
1911 E0         +1  4326         movx    a,@dptr
1912 FC         +1  4327         mov r4,a
1913 A3         +1  4328         inc dptr
1914 E0         +1  4329         movx    a,@dptr
1915 FD         +1  4330         mov r5,a
1916 D083       +1  4331         pop dph
1918 D082       +1  4332         pop dpl
191A 22         +1  4333         ret
191B            +1  4334     onboar1:
191B A882       +1  4335         mov r0,dpl
191D E6         +1  4336         mov a,@r0
191E FA         +1  4337         mov r2,a
191F 08         +1  4338         inc r0
1920 E6         +1  4339         mov a,@r0
1921 FB         +1  4340         mov r3,a
1922 08         +1  4341         inc r0
1923 E6         +1  4342         mov a,@r0
1924 FC         +1  4343         mov r4,a
1925 08         +1  4344         inc r0
1926 E6         +1  4345         mov a,@r0
1927 FD         +1  4346         mov r5,a
1928 22         +1  4347         ret
                +1  4348     
                +1  4349     ;*********************************
                +1  4350     ;mov    dptr,#k2
                +1  4351     ;call   ldx_ltemp       ;k2->ltemp..ltemp+3
                +1  4352     ;**********************************
1929            +1  4353     ldx_ltemp:
1929 E583       +1  4354         mov a,dph       ;is it in on board memory
192B 6010       +1  4355         jz  oboard1     ;yes
192D E0         +1  4356         movx    a,@dptr
192E F508       +1  4357         mov 8,a
1930 A3         +1  4358         inc dptr
1931 E0         +1  4359         movx    a,@dptr
1932 F509       +1  4360         mov 9,a
1934 A3         +1  4361         inc dptr
1935 E0         +1  4362         movx    a,@dptr
1936 F50A       +1  4363         mov 10,a
1938 A3         +1  4364         inc dptr
1939 E0         +1  4365         movx    a,@dptr
193A F50B       +1  4366         mov 11,a
193C 22         +1  4367         ret
193D            +1  4368     oboard1:
193D A882       +1  4369         mov r0,dpl
193F 8608       +1  4370         mov 8,@r0
1941 08         +1  4371         inc r0
1942 8609       +1  4372         mov 9,@r0
1944 08         +1  4373         inc r0
1945 860A       +1  4374         mov 10,@r0
1947 08         +1  4375         inc r0
1948 860B       +1  4376         mov 11,@r0
194A 22         +1  4377         ret
                +1  4378     ;   Long division routines for 8051
                +1  4379     ;   Divide is called with the divisor in ltemp, the dividend in r5-r2
                +1  4380     ;   It returns with the quotient in r5-r2 and the remainder in ltemp
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    70

                +1  4381     ;   The top of bank 1 (locations 12-15) are used as a long temporary
                +1  4382     ;   and registers r0 and r1 in bank 0 are used as temporaries. R0 and
                +1  4383     ;   r1 must be saved by the caller.
                +1  4384     ;   This is long unsigned division.
                +1  4385     
                +1  4386     
                +1  4387     ;   Register usage:
                +1  4388     ;       r0 loop counter
                +1  4389     ;       xtemp (12-15) accumulates quotient
                +1  4390     ;       r5-r2 holds dividend
                +1  4391     ;       ltemp holds divisor
                +1  4392     
                +1  4393     ;************************************
                +1  4394     ;r2..r5-делимое
                +1  4395     ;ltemp..-делитель
                +1  4396     ;частное -r2..r5
                +1  4397     ;*************************************
194B            +1  4398     divide:
194B E4         +1  4399         clr a
194C F8         +1  4400         mov r0,a        ;initialize count
194D F50C       +1  4401         mov xtemp,a     ;zero quotient
194F F50D       +1  4402         mov xtemp+1,a
1951 F50E       +1  4403         mov xtemp+2,a
1953 F50F       +1  4404         mov xtemp+3,a
1955 ED         +1  4405         mov a,r5        ;check for zero dividend
1956 4C         +1  4406         orl a,r4
1957 4B         +1  4407         orl a,r3
1958 4A         +1  4408         orl a,r2
1959 600B       +1  4409         jz  jfinis
195B E508       +1  4410         mov a,ltemp     ;check for zero divisor
195D 4509       +1  4411         orl a,ltemp+1
195F 450A       +1  4412         orl a,ltemp+2
1961 450B       +1  4413         orl a,ltemp+3
1963 7037       +1  4414         jnz midl
1965 22         +1  4415         ret
                +1  4416     
1966 020000   F +1  4417     jfinis: jmp finis
                +1  4418     
1969            +1  4419     loops:
1969 EA         +1  4420         mov a,r2
196A C3         +1  4421         clr c
196B 9508       +1  4422         subb    a,ltemp+0   ;is divisor greater than dividend yet
196D 4033       +1  4423         jc  yes     ;yes, go no further
196F 7013       +1  4424         jnz no
1971 EB         +1  4425         mov a,r3
1972 9509       +1  4426         subb    a,ltemp+1
1974 402C       +1  4427         jc  yes
1976 700C       +1  4428         jnz no
1978 EC         +1  4429         mov a,r4
1979 950A       +1  4430         subb    a,ltemp+2
197B 4025       +1  4431         jc  yes
197D 7005       +1  4432         jnz no
197F ED         +1  4433         mov a,r5
1980 950B       +1  4434         subb    a,ltemp+3
1982 401E       +1  4435         jc  yes
1984            +1  4436     no:
1984 E50B       +1  4437         mov a,ltemp+3   ;shift divisor up one bit
1986 250B       +1  4438         add a,ltemp+3
1988 F50B       +1  4439         mov ltemp+3,a
198A E50A       +1  4440         mov a,ltemp+2
198C 350A       +1  4441         addc    a,ltemp+2
198E F50A       +1  4442         mov ltemp+2,a
1990 E509       +1  4443         mov a,ltemp+1
1992 3509       +1  4444         addc    a,ltemp+1
1994 F509       +1  4445         mov ltemp+1,a
1996 E508       +1  4446         mov a,ltemp+0
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    71

1998 3508       +1  4447         addc    a,ltemp+0
199A F508       +1  4448         mov ltemp+0,a
199C            +1  4449     midl:
199C 08         +1  4450         inc r0      ;increment count
199D E508       +1  4451         mov a,ltemp+0   ;check for safe to shift some more
199F 30E7C7     +1  4452         jnb acc.7,loops  ;loop if top bit clear
19A2            +1  4453     yes:
19A2 E508       +1  4454         mov a,ltemp+0
19A4 C3         +1  4455         clr c
19A5 9A         +1  4456         subb    a,r2        ;can we subtract now?
19A6 401A       +1  4457         jc  dosub       ;yes, go and do it
19A8 7015       +1  4458         jnz nosub
19AA E509       +1  4459         mov a,ltemp+1
19AC 9B         +1  4460         subb    a,r3
19AD 4013       +1  4461         jc  dosub
19AF 700E       +1  4462         jnz nosub
19B1 E50A       +1  4463         mov a,ltemp+2
19B3 9C         +1  4464         subb    a,r4
19B4 400C       +1  4465         jc  dosub
19B6 7007       +1  4466         jnz nosub
19B8 E50B       +1  4467         mov a,ltemp+3
19BA 9D         +1  4468         subb    a,r5
19BB 4005       +1  4469         jc  dosub
19BD 6003       +1  4470         jz  dosub
19BF            +1  4471     nosub:
19BF C3         +1  4472         clr c
19C0 8012       +1  4473         sjmp    dosh
19C2            +1  4474     dosub:
19C2 C3         +1  4475         clr c       ;subtract divisor from dividend
19C3 ED         +1  4476         mov a,r5
19C4 950B       +1  4477         subb    a,ltemp+3
19C6 FD         +1  4478         mov r5,a
19C7 EC         +1  4479         mov a,r4
19C8 950A       +1  4480         subb    a,ltemp+2
19CA FC         +1  4481         mov r4,a
19CB EB         +1  4482         mov a,r3
19CC 9509       +1  4483         subb    a,ltemp+1
19CE FB         +1  4484         mov r3,a
19CF EA         +1  4485         mov a,r2
19D0 9508       +1  4486         subb    a,ltemp+0
19D2 FA         +1  4487         mov r2,a
19D3 D3         +1  4488         setb    c       ;now set bit for quotient
19D4            +1  4489     dosh:
19D4 E50F       +1  4490         mov a,xtemp+3
19D6 33         +1  4491         rlc a
19D7 F50F       +1  4492         mov xtemp+3,a
19D9 E50E       +1  4493         mov a,xtemp+2
19DB 33         +1  4494         rlc a
19DC F50E       +1  4495         mov xtemp+2,a
19DE E50D       +1  4496         mov a,xtemp+1
19E0 33         +1  4497         rlc a
19E1 F50D       +1  4498         mov xtemp+1,a
19E3 E50C       +1  4499         mov a,xtemp+0
19E5 33         +1  4500         rlc a
19E6 F50C       +1  4501         mov xtemp+0,a
19E8 E508       +1  4502         mov a,ltemp+0       ;shift divisor down
19EA C3         +1  4503         clr c
19EB 13         +1  4504         rrc a
19EC F508       +1  4505         mov ltemp+0,a
19EE E509       +1  4506         mov a,ltemp+1
19F0 13         +1  4507         rrc a
19F1 F509       +1  4508         mov ltemp+1,a
19F3 E50A       +1  4509         mov a,ltemp+2
19F5 13         +1  4510         rrc a
19F6 F50A       +1  4511         mov ltemp+2,a
19F8 E50B       +1  4512         mov a,ltemp+3
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    72

19FA 13         +1  4513         rrc a
19FB F50B       +1  4514         mov ltemp+3,a
                +1  4515     
19FD D8A3       +1  4516         djnz    r0,yes      ;and continue with the rest
                +1  4517     
19FF            +1  4518     finis:
19FF 8D0B       +1  4519         mov ltemp+3,r5
1A01 8C0A       +1  4520         mov ltemp+2,r4
1A03 8B09       +1  4521         mov ltemp+1,r3
1A05 8A08       +1  4522         mov ltemp+0,r2
1A07 AD0F       +1  4523         mov r5,xtemp+3
1A09 AC0E       +1  4524         mov r4,xtemp+2
1A0B AB0D       +1  4525         mov r3,xtemp+1
1A0D AA0C       +1  4526         mov r2,xtemp+0
1A0F 22         +1  4527         ret         ;and return with the satisfaction of a job well done
                +1  4528     
                +1  4529     
                +1  4530     ;   Long multiplication
                +1  4531     ;   The main multiply thingo. Called with one operand in r5-r2 and the
                +1  4532     ;   other in ltemp. It really doesn't matter which one is where.
                +1  4533     
                +1  4534     ;**********************************
                +1  4535     ;(r2..r5)*(ltemp..ltemp+3)=r2..r5
                +1  4536     ;ст  мл
                +1  4537     ;**********************************
1A10            +1  4538     llmul:
1A10            +1  4539     almul:
1A10            +1  4540     lmul:
1A10 ED         +1  4541         mov a,r5        ;low order byte
1A11 850BF0     +1  4542         mov b,ltemp+3       ;times low order byte
1A14 A4         +1  4543         mul ab
1A15 F50F       +1  4544         mov xtemp+3,a       ;store low
1A17 85F00E     +1  4545         mov xtemp+2,b   ;and high
1A1A ED         +1  4546         mov a,r5        ;low order
1A1B 850AF0     +1  4547         mov b,ltemp+2   ;times next
1A1E A4         +1  4548         mul ab
1A1F 250E       +1  4549         add a,xtemp+2   ;add in
1A21 F50E       +1  4550         mov xtemp+2,a
1A23 E5F0       +1  4551         mov a,b
1A25 3400       +1  4552         addc    a,#0
1A27 F50D       +1  4553         mov xtemp+1,a
1A29 ED         +1  4554         mov a,r5
1A2A 8509F0     +1  4555         mov b,ltemp+1
1A2D A4         +1  4556         mul ab
1A2E 250D       +1  4557         add a,xtemp+1
1A30 F50D       +1  4558         mov xtemp+1,a
1A32 E5F0       +1  4559         mov a,b
1A34 3400       +1  4560         addc    a,#0
1A36 F50C       +1  4561         mov xtemp+0,a
1A38 ED         +1  4562         mov a,r5
1A39 8508F0     +1  4563         mov b,ltemp+0
1A3C A4         +1  4564         mul ab
1A3D 250C       +1  4565         add a,xtemp+0
1A3F F50C       +1  4566         mov xtemp+0,a
1A41 EC         +1  4567         mov a,r4
1A42 850BF0     +1  4568         mov b,ltemp+3
1A45 A4         +1  4569         mul ab
1A46 250E       +1  4570         add a,xtemp+2
1A48 F50E       +1  4571         mov xtemp+2,a
1A4A E5F0       +1  4572         mov a,b
1A4C 350D       +1  4573         addc    a,xtemp+1
1A4E F50D       +1  4574         mov xtemp+1,a
1A50 E50C       +1  4575         mov a,xtemp+0
1A52 3400       +1  4576         addc    a,#0
1A54 F50C       +1  4577         mov xtemp+0,a
1A56 EC         +1  4578         mov a,r4
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    73

1A57 850AF0     +1  4579         mov b,ltemp+2
1A5A A4         +1  4580         mul ab
1A5B 250D       +1  4581         add a,xtemp+1
1A5D F50D       +1  4582         mov xtemp+1,a
1A5F E5F0       +1  4583         mov a,b
1A61 350C       +1  4584         addc    a,xtemp+0
1A63 F50C       +1  4585         mov xtemp+0,a
1A65 EC         +1  4586         mov a,r4
1A66 8509F0     +1  4587         mov b,ltemp+1
1A69 A4         +1  4588         mul ab
1A6A 250C       +1  4589         add a,xtemp+0
1A6C F50C       +1  4590         mov xtemp+0,a
                +1  4591     
1A6E EB         +1  4592         mov a,r3
1A6F 850BF0     +1  4593         mov b,ltemp+3
1A72 A4         +1  4594         mul ab
1A73 250D       +1  4595         add a,xtemp+1
1A75 F50D       +1  4596         mov xtemp+1,a
1A77 E5F0       +1  4597         mov a,b
1A79 350C       +1  4598         addc    a,xtemp+0
1A7B F50C       +1  4599         mov xtemp+0,a
1A7D EB         +1  4600         mov a,r3
1A7E 850AF0     +1  4601         mov b,ltemp+2
1A81 A4         +1  4602         mul ab
1A82 250C       +1  4603         add a,xtemp+0
1A84 F50C       +1  4604         mov xtemp+0,a
                +1  4605     
1A86 EA         +1  4606         mov a,r2
1A87 850BF0     +1  4607         mov b,ltemp+3
1A8A A4         +1  4608         mul ab
1A8B 250C       +1  4609         add a,xtemp+0
1A8D FA         +1  4610         mov r2,a
1A8E AB0D       +1  4611         mov r3,xtemp+1
1A90 AC0E       +1  4612         mov r4,xtemp+2
1A92 AD0F       +1  4613         mov r5,xtemp+3
                +1  4614     
1A94 22         +1  4615         ret         ;all done
                +1  4616     ;******************************
                +1  4617     ;из содержимого  r2-r5  вычесть
                +1  4618     ;содержимое          ltemp..ltemp+3
                +1  4619     ;******************************
1A95            +1  4620     llsub:
1A95            +1  4621      lsub:
1A95 ED         +1  4622         mov a,r5
1A96 C3         +1  4623         clr c
1A97 950B       +1  4624         subb    a,11
1A99 FD         +1  4625         mov r5,a
1A9A EC         +1  4626         mov a,r4
1A9B 950A       +1  4627         subb    a,10
1A9D FC         +1  4628         mov r4,a
1A9E EB         +1  4629         mov a,r3
1A9F 9509       +1  4630         subb    a,9
1AA1 FB         +1  4631         mov r3,a
1AA2 EA         +1  4632         mov a,r2
1AA3 9508       +1  4633         subb    a,8
1AA5 FA         +1  4634         mov r2,a
1AA6 22         +1  4635         ret
                +1  4636     
                +1  4637     ;***********************************************
                +1  4638     ;                                                      ст мл
                +1  4639     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4640     ;  r0- адрес младшего байта !!!
                +1  4641     ;результат- r2..r5
                +1  4642     ;***********************************************
                +1  4643     
1AA7 C3         +1  4644     ladd:    clr       c
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    74

1AA8 ED         +1  4645          mov       a,r5
1AA9 26         +1  4646          add       a,@r0
1AAA FD         +1  4647          mov       r5,a
1AAB 18         +1  4648          dec       r0
1AAC EC         +1  4649          mov       a,r4
1AAD 36         +1  4650          addc      a,@r0
1AAE FC         +1  4651          mov       r4,a
1AAF 18         +1  4652          dec       r0
1AB0 EB         +1  4653          mov       a,r3
1AB1 36         +1  4654          addc      a,@r0
1AB2 FB         +1  4655          mov       r3,a
1AB3 18         +1  4656          dec       r0
1AB4 EA         +1  4657          mov       a,r2
1AB5 36         +1  4658          addc      a,@r0
1AB6 FA         +1  4659          mov       r2,a
1AB7 22         +1  4660          ret
                +1  4661     ;***********************************************
                +1  4662     ;                                                      ст мл
                +1  4663     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4664     ;  r0- адрес младшего байта !!!
                +1  4665     ;результат- r2..r5
                +1  4666     ;***********************************************
                +1  4667     
1AB8 C3         +1  4668     laddx:    clr       c
1AB9 E2         +1  4669                                             movx            a,@r0
1ABA 2D         +1  4670                                             add                     a,r5
1ABB FD         +1  4671               mov     r5,a
1ABC 18         +1  4672                             dec     r0
1ABD E2         +1  4673                             movx    a,@r0
1ABE 3C         +1  4674                             addc    a,r4
1ABF FC         +1  4675                             mov     r4,a
1AC0 18         +1  4676                             dec     r0
1AC1 E2         +1  4677                             movx    a,@r0
1AC2 3B         +1  4678                             addc    a,r3
1AC3 FB         +1  4679                             mov     r3,a
1AC4 18         +1  4680                             dec     r0
1AC5 E2         +1  4681                             movx    a,@r0
1AC6 3A         +1  4682                             addc    a,r2
1AC7 FA         +1  4683                             mov       r2,a
1AC8 22         +1  4684                             ret
                +1  4685     
                +1  4686     ;***********************************************
                +1  4687     ;                                                      ст мл
                +1  4688     ; cложение содержимого  r2..r5 с числом по адресу
                +1  4689     ;  dptr- адрес младшего байта !!!
                +1  4690     ;результат- r2..r5
                +1  4691     ;***********************************************
                +1  4692     
1AC9 C3         +1  4693     addx:    clr       c
1ACA E0         +1  4694                                             movx            a,@dptr
1ACB 2D         +1  4695                                             add                     a,r5
1ACC FD         +1  4696               mov     r5,a
1ACD 120000   F +1  4697                             call            dedptr;dec     dptr
1AD0 E0         +1  4698                             movx    a,@dptr
1AD1 3C         +1  4699                             addc    a,r4
1AD2 FC         +1  4700                             mov     r4,a
1AD3 120000   F +1  4701                             call            dedptr;dec     dptr
1AD6 E0         +1  4702                             movx    a,@dptr
1AD7 3B         +1  4703                             addc    a,r3
1AD8 FB         +1  4704                             mov     r3,a
1AD9 120000   F +1  4705                             call            dedptr;dec     dptr
1ADC E0         +1  4706                             movx    a,@dptr
1ADD 3A         +1  4707                             addc    a,r2
1ADE FA         +1  4708                             mov       r2,a
1ADF 22         +1  4709                             ret
                +1  4710     
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    75

1AE0 C0D0       +1  4711     dedptr:         push    psw
1AE2 C3         +1  4712                                             clr             c
1AE3 E582       +1  4713                                             mov             a,dpl
1AE5 9401       +1  4714                                             subb    a,#1
1AE7 F582       +1  4715                                             mov             dpl,a
1AE9 E583       +1  4716                                             mov             a,dph
1AEB 9400       +1  4717                                             subb    a,#0
1AED F583       +1  4718                                             mov             dph,a
1AEF D0D0       +1  4719                                             pop             psw
1AF1 22         +1  4720                                             ret
                    4721     
                    4722     ;$include (d:\amp\floatm.asm)
                +1  4723     ;       Copyright (C) 1988 HI-TECH Software
                +1  4724     
                +1  4725     ;       Single Precision Floating point arithmetic routines for 8051
                +1  4726     
                +1  4727     ;       The format of floating point numbers is as follows:
                +1  4728     
                +1  4729     ;       -----------------
                +1  4730     ;       *     sign      *  1 bit
                +1  4731     ;       -----------------
                +1  4732     ;       *   exponent    *  8 bits
                +1  4733     ;       -----------------
                +1  4734     ;       *   mantissa    *  23 bits + 1 implied bit = 24 bits
                +1  4735     ;       -----------------
                +1  4736     
                +1  4737     
                +1  4738     ;       As usual for the 8051 the memory layout has the most significant
                +1  4739     ;       byte (i.e. that containing the sign) coming first, i.e. at the
                +1  4740     ;       lowest address.
                +1  4741     
                +1  4742     ;       Calling conventions:
                +1  4743     
                +1  4744     ;       Left operand in r2-r5, right operand in ltemp (r0'-r3')
                +1  4745     ;
                +1  4746     ;       Return value is in r2-r5
                +1  4747     
                +1  4748     ;       Naming conventions: A routine name is constructed by
                +1  4749     
                +1  4750     ;             ASOP
                +1  4751     
                +1  4752     ;       Where A is the arithmetic type (f for float), and op is the operation,
                +1  4753     ;       one of mul, div, mod, add, sub and cmp. S is the size, always l.
                +1  4754     ;       Conversion routines are named
                +1  4755     
                +1  4756     ;               AStof
                +1  4757     
                +1  4758     ;       where A is the arithmetic type (a for integer, l for unsigned)
                +1  4759     ;       S is the integer size, one of b (byte), w (word) or l (long).
                +1  4760     ;       Conversion from float to integer is ftol.
                +1  4761     
                +1  4762     ;               .ORG  5000h
                +1  4763     ;               .CODE
                +1  4764     ;       seg     c_text
                +1  4765     
                +1  4766     ;;      $MOD812
----            +1  4767             CSEG
                +1  4768             ;ORG 1000h
                +1  4769     
                +1  4770                     ;;;PUBLIC       flmul,fldiv,fladd,flsub,flcmp
                +1  4771             ;;;PUBLIC       ftol,altof,lltof,awtof,lwtof,abtof,lbtof
                +1  4772     
                +1  4773     ;       EXTERNAL DELAY,KKOFU0,AKNCH,XNULLU
                +1  4774     ;       macros
                +1  4775     
                +1  4776     saveregs        macro
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    76

                +1  4777             push    7
                +1  4778             push    6
                +1  4779             push    1
                +1  4780             push    0
                +1  4781             endm
                +1  4782     
                +1  4783     restregs        macro
                +1  4784             pop     0
                +1  4785             pop     1
                +1  4786             pop     6
                +1  4787             pop     7
                +1  4788             endm
                +1  4789     
                +1  4790     ;addr   
                +1  4791     dan     macro   pad
                +1  4792             mov     a,r5
                +1  4793             add     a,pad+3
                +1  4794             mov     pad+3,a
                +1  4795             mov     a,pad+2
                +1  4796             addc    a,r4
                +1  4797             mov     pad+2,a
                +1  4798             mov     a,pad+1
                +1  4799             addc    a,r3
                +1  4800             mov     pad+1,a
                +1  4801             mov     a,pad+0
                +1  4802             addc    a,r2
                +1  4803             mov     pad,a
                +1  4804             endm
                +1  4805     
                +1  4806     addl    macro  addr
                +1  4807             mov     a,r5
                +1  4808             add     a,addr+3
                +1  4809             mov     r5,a
                +1  4810             mov     a,addr+2
                +1  4811             addc    a,r4
                +1  4812             mov     r4,a
                +1  4813             mov     a,addr+1
                +1  4814             addc    a,r3
                +1  4815             mov     r3,a
                +1  4816             mov     a,addr+0
                +1  4817             addc    a,r2
                +1  4818             mov     r2,a
                +1  4819             endm
                +1  4820     
                +1  4821     
                +1  4822     add1    macro
                +1  4823             mov     a,r5
                +1  4824             add     a,#1
                +1  4825             mov     r5,a
                +1  4826             clr     a
                +1  4827             addc    a,r4
                +1  4828             mov     r4,a
                +1  4829             clr     a
                +1  4830             addc    a,r3
                +1  4831             mov     r3,a
                +1  4832             clr     a
                +1  4833             addc    a,r2
                +1  4834             mov     r2,a
                +1  4835             endm
                +1  4836     
                +1  4837     shfdn   macro  addr
                +1  4838             clr     c
                +1  4839             mov     a,addr
                +1  4840             rrc     a
                +1  4841             mov     addr,a
                +1  4842             mov     a,addr+1
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    77

                +1  4843             rrc     a
                +1  4844             mov     addr+1,a
                +1  4845             mov     a,addr+2
                +1  4846             rrc     a
                +1  4847             mov     addr+2,a
                +1  4848             mov     a,addr+3
                +1  4849             rrc     a
                +1  4850             mov     addr+3,a
                +1  4851             endm
                +1  4852     
                +1  4853     shfup   macro  addr
                +1  4854             clr     c
                +1  4855             mov     a,addr+3
                +1  4856             rlc     a
                +1  4857             mov     addr+3,a
                +1  4858             mov     a,addr+2
                +1  4859             rlc     a
                +1  4860             mov     addr+2,a
                +1  4861             mov     a,addr+1
                +1  4862             rlc     a
                +1  4863             mov     addr+1,a
                +1  4864             mov     a,addr
                +1  4865             rlc     a
                +1  4866             mov     addr,a
                +1  4867             endm
                +1  4868     
                +1  4869     rshift  macro
                +1  4870             clr     c
                +1  4871             mov     a,r2
                +1  4872             rrc     a
                +1  4873             mov     r2,a
                +1  4874             mov     a,r3
                +1  4875             rrc     a
                +1  4876             mov     r3,a
                +1  4877             mov     a,r4
                +1  4878             rrc     a
                +1  4879             mov     r4,a
                +1  4880             mov     a,r5
                +1  4881             rrc     a
                +1  4882             mov     r5,a
                +1  4883             endm
                +1  4884     rshift1 macro
                +1  4885             setb    c
                +1  4886             mov     a,r2
                +1  4887             rrc     a
                +1  4888             mov     r2,a
                +1  4889             mov     a,r3
                +1  4890             rrc     a
                +1  4891             mov     r3,a
                +1  4892             mov     a,r4
                +1  4893             rrc     a
                +1  4894             mov     r4,a
                +1  4895             mov     a,r5
                +1  4896             rrc     a
                +1  4897             mov     r5,a
                +1  4898             endm
                +1  4899     
                +1  4900     
                +1  4901     lshift  macro
                +1  4902             mov     a,r5
                +1  4903             rlc     a
                +1  4904             mov     r5,a
                +1  4905             mov     a,r4
                +1  4906             rlc     a
                +1  4907             mov     r4,a
                +1  4908             mov     a,r3
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    78

                +1  4909             rlc     a
                +1  4910             mov     r3,a
                +1  4911             mov     a,r2
                +1  4912             rlc     a
                +1  4913             mov     r2,a
                +1  4914             endm
                +1  4915     
                +1  4916     neg1    macro
                +1  4917             clr     c
                +1  4918             clr     a
                +1  4919             subb    a,r5
                +1  4920             mov     r5,a
                +1  4921             clr     a
                +1  4922             subb    a,r4
                +1  4923             mov     r4,a
                +1  4924             clr     a
                +1  4925             subb    a,r3
                +1  4926             mov     r3,a
                +1  4927             clr     a
                +1  4928             subb    a,r2
                +1  4929             mov     r2,a
                +1  4930             endm
                +1  4931     
                +1  4932     negm    macro  addr
                +1  4933             clr     c
                +1  4934             clr     a
                +1  4935             subb    a,addr+3
                +1  4936             mov     addr+3,a
                +1  4937             clr     a
                +1  4938             subb    a,addr+2
                +1  4939             mov     addr+2,a
                +1  4940             clr     a
                +1  4941             subb    a,addr+1
                +1  4942             mov     addr+1,a
                +1  4943             clr     a
                +1  4944             subb    a,addr
                +1  4945             mov     addr,a
                +1  4946             endm
                +1  4947     
                +1  4948     copytor macro  addr
                +1  4949             mov     r2,addr
                +1  4950             mov     r3,addr+1
                +1  4951             mov     r4,addr+2
                +1  4952             mov     r5,addr+3
                +1  4953             endm
                +1  4954     
                +1  4955     
                +1  4956     copyrto macro  addr
                +1  4957             mov     addr,r2
                +1  4958             mov     addr+1,r3
                +1  4959             mov     addr+2,r4
                +1  4960             mov     addr+3,r5
                +1  4961             endm
                +1  4962     
                +1  4963     
                +1  4964     ;       Internal representation: in this set of routines a floating number
                +1  4965     ;       is unpacked into seperate mantissa, exponent and sign parts.
                +1  4966     
                +1  4967     ;       Stack offset values
                +1  4968     ;ltemp   equ     28h
                +1  4969     
  0006          +1  4970     cntr    equ     6               ;r6 is the counter
  0007          +1  4971     sign    equ     7               ;signs in r7 - left sign in bit 7, right in 6
  0000          +1  4972     exp1    equ     0               ;exponent 1 in r0
  0002          +1  4973     mant1   equ     2               ;mantissa 1 in r2-5
  0001          +1  4974     exp2    equ     1               ;exponent 1 in r1
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    79

  0008          +1  4975     mant2   equ     ltemp           ;mantissa 2 in ltemp
  000C          +1  4976     prod    equ     ltemp+4         ;product/quotient in ltemp+4 (r4'-r7')
                +1  4977     
                +1  4978     
                +1  4979     
                +1  4980     
                +1  4981     
                +1  4982     ;DECSIZE EQU     10
                +1  4983     ;NUMSIZE EQU     4
                +1  4984     ;RR4     EQU     4
                +1  4985     ;RR5     EQU     5
                +1  4986     
                +1  4987     ;       unpack1 - unpacks the left operand
                +1  4988     
009E            +1  4989     unpack1:
009E EA         +1  4990             mov     a,r2            ;get sign
009F 5480       +1  4991             anl     a,#80h
00A1 530740     +1  4992             anl     sign,#40h       ;clear other bits
00A4 4207       +1  4993             orl     sign,a          ;store sign
00A6 EB         +1  4994             mov     a,r3            ;get lsb of exponent
00A7 33         +1  4995             rlc     a               ;rotate into carry
00A8 EA         +1  4996             mov     a,r2            ;get rest of exponent
00A9 33         +1  4997             rlc     a               ;and make it 8 bits
00AA F8         +1  4998             mov     r0,a            ;store it
00AB 6006       +1  4999             jz      zer1            ;if zero, the whole thing is zero
00AD 430380     +1  5000             orl     mant1+1,#80h    ;set hidden bit
00B0 7A00       +1  5001             mov     r2,#0           ;clear upper byte of mantissa
00B2 22         +1  5002             ret
00B3            +1  5003     zer1:
00B3 E4         +1  5004             clr     a
00B4 FA         +1  5005             mov     r2,a
00B5 FB         +1  5006             mov     r3,a
00B6 FC         +1  5007             mov     r4,a
00B7 FD         +1  5008             mov     r5,a            ;zero mantissa
00B8 F8         +1  5009             mov     r0,a            ;zero exponent
00B9 22         +1  5010             ret
                +1  5011     
                +1  5012     ;       unpack2 - unpacks right operand
                +1  5013     
00BA            +1  5014     unpack2:
00BA E508       +1  5015             mov     a,ltemp         ;get sign
00BC 13         +1  5016             rrc     a               ;shift down
00BD 5440       +1  5017             anl     a,#40h          ;mask out sign
00BF 530780     +1  5018             anl     sign,#80h       ;clear old bit
00C2 4207       +1  5019             orl     sign,a
00C4 E509       +1  5020             mov     a,ltemp+1       ;get lsb of exponent
00C6 33         +1  5021             rlc     a               ;rotate into carry
00C7 E508       +1  5022             mov     a,ltemp         ;get rest of exponent
00C9 33         +1  5023             rlc     a               ;and make it 8 bits
00CA F9         +1  5024             mov     r1,a            ;store it
00CB 6007       +1  5025             jz      zer2            ;if zero, the whole thing is zero
00CD 430980     +1  5026             orl     mant2+1,#80h    ;set hidden bit
00D0 750800     +1  5027             mov     mant2,#0        ;clear upper byte
00D3 22         +1  5028             ret
00D4            +1  5029     zer2:
00D4 E4         +1  5030             clr     a
00D5 F508       +1  5031             mov     ltemp,a
00D7 F509       +1  5032             mov     ltemp+1,a
00D9 F50A       +1  5033             mov     ltemp+2,a
00DB F50B       +1  5034             mov     ltemp+3,a               ;zero mantissa
00DD 22         +1  5035             ret
                +1  5036     
                +1  5037     ;       pack1 - put operand 1 back into float format
                +1  5038     
00DE            +1  5039     pack1:
00DE E8         +1  5040             mov     a,r0            ;get exponent
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    80

00DF C3         +1  5041             clr     c
00E0 13         +1  5042             rrc     a               ;shift down 1 bit
00E1 530780     +1  5043             anl     sign,#80h       ;mask sign bit
00E4 4F         +1  5044             orl     a,r7            ;or in sign bit
00E5 FA         +1  5045             mov     r2,a            ;store
00E6 E8         +1  5046             mov     a,r0            ;get other bit
00E7 03         +1  5047             rr      a               ;rotate into hi bit
00E8 5480       +1  5048             anl     a,#80h          ;mask
00EA 53037F     +1  5049             anl     mant1+1,#7Fh    ;clear hidden bit
00ED 4203       +1  5050             orl     mant1+1,a       ;put in
00EF 22         +1  5051             ret
                +1  5052     
                +1  5053     
                +1  5054     ;       norm1 - normalize the unpacked value in 1
                +1  5055     
00F0            +1  5056     norm1:
00F0 E8         +1  5057             mov     a,r0            ;get exponent
00F1 60C0       +1  5058             jz      zer1            ;zero the mantissa if so
00F3 EA         +1  5059             mov     a,r2            ;get hi byte
00F4 6023       +1  5060             jz      norup           ;zero, so shift up if anything
00F6            +1  5061     nordn:
00F6 EA         +1  5062             mov     a,r2            ;get hi byte
00F7 B4010D     +1  5063             cjne    a,#1,nordn1     ;if not about to do last shift, skip
                +1  5064+3           add1                    ;add in a rounding bit
00FA ED         +1  5065+1           mov     a,r5
00FB 2401       +1  5066+1           add     a,#1
00FD FD         +1  5067+1           mov     r5,a
00FE E4         +1  5068+1           clr     a
00FF 3C         +1  5069+1           addc    a,r4
0100 FC         +1  5070+1           mov     r4,a
0101 E4         +1  5071+1           clr     a
0102 3B         +1  5072+1           addc    a,r3
0103 FB         +1  5073+1           mov     r3,a
0104 E4         +1  5074+1           clr     a
0105 3A         +1  5075+1           addc    a,r2
0106 FA         +1  5076+1           mov     r2,a
0107            +1  5077     nordn1:
                +1  5078+3           rshift                  ;shift down 1 bit
0107 C3         +1  5079+1           clr     c
0108 EA         +1  5080+1           mov     a,r2
0109 13         +1  5081+1           rrc     a
010A FA         +1  5082+1           mov     r2,a
010B EB         +1  5083+1           mov     a,r3
010C 13         +1  5084+1           rrc     a
010D FB         +1  5085+1           mov     r3,a
010E EC         +1  5086+1           mov     a,r4
010F 13         +1  5087+1           rrc     a
0110 FC         +1  5088+1           mov     r4,a
0111 ED         +1  5089+1           mov     a,r5
0112 13         +1  5090+1           rrc     a
0113 FD         +1  5091+1           mov     r5,a
0114 08         +1  5092             inc     r0              ;adjust exponent
0115 EA         +1  5093             mov     a,r2            ;test high byte
0116 70DE       +1  5094             jnz     nordn           ;loop
0118 22         +1  5095             ret                     ;done
                +1  5096     
0119            +1  5097     norup:
0119 4B         +1  5098             orl     a,r3
011A 4C         +1  5099             orl     a,r4
011B 4D         +1  5100             orl     a,r5            ;test for zero mantissa
011C 6095       +1  5101             jz      zer1            ;it is - make it true zero
011E            +1  5102     norup1:
011E EB         +1  5103             mov     a,r3            ;get mantissa byte
011F 20E710     +1  5104             jb      acc.7,norup2    ;jump if set
0122 C3         +1  5105             clr     c
                +1  5106+3           lshift                  ;shift mantissa up
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    81

0123 ED         +1  5107+1           mov     a,r5
0124 33         +1  5108+1           rlc     a
0125 FD         +1  5109+1           mov     r5,a
0126 EC         +1  5110+1           mov     a,r4
0127 33         +1  5111+1           rlc     a
0128 FC         +1  5112+1           mov     r4,a
0129 EB         +1  5113+1           mov     a,r3
012A 33         +1  5114+1           rlc     a
012B FB         +1  5115+1           mov     r3,a
012C EA         +1  5116+1           mov     a,r2
012D 33         +1  5117+1           rlc     a
012E FA         +1  5118+1           mov     r2,a
012F 18         +1  5119             dec     r0              ;adjust exponent
0130 80EC       +1  5120             jmp     norup1
0132            +1  5121     norup2:
0132 22         +1  5122             ret                     ;finito
                +1  5123     
                +1  5124     
                +1  5125     ;       fpdenorm - denormalize one of the two operands so that their
                +1  5126     ;       exponents are equal. This requires the smaller number to have
                +1  5127     ;       its exponent incremented and its mantissa shifted right.
                +1  5128     
0133            +1  5129     denorm:
0133 E8         +1  5130             mov     a,r0
0134 C3         +1  5131             clr     c
0135 99         +1  5132             subb    a,r1            ;compare exponents
0136 5029       +1  5133             jnc     up2a            ;shift operand 2
0138            +1  5134     up1:
0138 08         +1  5135             inc     r0              ;increment exponent
                +1  5136+3           rshift                  ;shift mantissa down
0139 C3         +1  5137+1           clr     c
013A EA         +1  5138+1           mov     a,r2
013B 13         +1  5139+1           rrc     a
013C FA         +1  5140+1           mov     r2,a
013D EB         +1  5141+1           mov     a,r3
013E 13         +1  5142+1           rrc     a
013F FB         +1  5143+1           mov     r3,a
0140 EC         +1  5144+1           mov     a,r4
0141 13         +1  5145+1           rrc     a
0142 FC         +1  5146+1           mov     r4,a
0143 ED         +1  5147+1           mov     a,r5
0144 13         +1  5148+1           rrc     a
0145 FD         +1  5149+1           mov     r5,a
0146 E8         +1  5150             mov     a,r0
0147 B501EE     +1  5151             cjne    a,exp2,up1      ;loop if still not equal
014A 22         +1  5152             ret
                +1  5153     
014B            +1  5154     up2:
014B 09         +1  5155             inc     r1              ;increment exponent 2
                +1  5156+3           shfdn   mant2           ;shift mantissa down
014C C3         +1  5157+1           clr     c
014D E508       +1  5158+1           mov     a,mant2
014F 13         +1  5159+1           rrc     a
0150 F508       +1  5160+1           mov     mant2,a
0152 E509       +1  5161+1           mov     a,mant2+1
0154 13         +1  5162+1           rrc     a
0155 F509       +1  5163+1           mov     mant2+1,a
0157 E50A       +1  5164+1           mov     a,mant2+2
0159 13         +1  5165+1           rrc     a
015A F50A       +1  5166+1           mov     mant2+2,a
015C E50B       +1  5167+1           mov     a,mant2+3
015E 13         +1  5168+1           rrc     a
015F F50B       +1  5169+1           mov     mant2+3,a
0161            +1  5170     up2a:
0161 E8         +1  5171             mov     a,r0            ;compare exponents
0162 B501E6     +1  5172             cjne    a,exp2,up2
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    82

0165 22         +1  5173             ret                     ;all done
                +1  5174     ;------------------------------------------------------------------
                +1  5175     ;       Add the number in op1 to the number in op2 and return the result in r2-r5
                +1  5176     
0166            +1  5177     fladd:
                +1  5178+3           saveregs
0166 C007       +1  5179+1           push    7
0168 C006       +1  5180+1           push    6
016A C001       +1  5181+1           push    1
016C C000       +1  5182+1           push    0
016E 119E       +1  5183             call    unpack1
0170 11BA       +1  5184             call    unpack2
0172 3133       +1  5185             call    denorm
0174 E507       +1  5186             mov     a,sign
0176 30E70D     +1  5187             jnb     acc.7,ok1       ;test left sign
                +1  5188+3           neg1                    ;negate op1
0179 C3         +1  5189+1           clr     c
017A E4         +1  5190+1           clr     a
017B 9D         +1  5191+1           subb    a,r5
017C FD         +1  5192+1           mov     r5,a
017D E4         +1  5193+1           clr     a
017E 9C         +1  5194+1           subb    a,r4
017F FC         +1  5195+1           mov     r4,a
0180 E4         +1  5196+1           clr     a
0181 9B         +1  5197+1           subb    a,r3
0182 FB         +1  5198+1           mov     r3,a
0183 E4         +1  5199+1           clr     a
0184 9A         +1  5200+1           subb    a,r2
0185 FA         +1  5201+1           mov     r2,a
0186            +1  5202     ok1:
0186 E507       +1  5203             mov     a,sign
0188 30E615     +1  5204             jnb     acc.6,ok2       ;test right sign
                +1  5205+3           negm    mant2           ;negate op2
018B C3         +1  5206+1           clr     c
018C E4         +1  5207+1           clr     a
018D 950B       +1  5208+1           subb    a,mant2+3
018F F50B       +1  5209+1           mov     mant2+3,a
0191 E4         +1  5210+1           clr     a
0192 950A       +1  5211+1           subb    a,mant2+2
0194 F50A       +1  5212+1           mov     mant2+2,a
0196 E4         +1  5213+1           clr     a
0197 9509       +1  5214+1           subb    a,mant2+1
0199 F509       +1  5215+1           mov     mant2+1,a
019B E4         +1  5216+1           clr     a
019C 9508       +1  5217+1           subb    a,mant2
019E F508       +1  5218+1           mov     mant2,a
01A0            +1  5219     ok2:
                +1  5220+3           addl    mant2           ;add mantissas
01A0 ED         +1  5221+1           mov     a,r5
01A1 250B       +1  5222+1           add     a,mant2+3
01A3 FD         +1  5223+1           mov     r5,a
01A4 E50A       +1  5224+1           mov     a,mant2+2
01A6 3C         +1  5225+1           addc    a,r4
01A7 FC         +1  5226+1           mov     r4,a
01A8 E509       +1  5227+1           mov     a,mant2+1
01AA 3B         +1  5228+1           addc    a,r3
01AB FB         +1  5229+1           mov     r3,a
01AC E508       +1  5230+1           mov     a,mant2+0
01AE 3A         +1  5231+1           addc    a,r2
01AF FA         +1  5232+1           mov     r2,a
01B0 E4         +1  5233             clr     a
01B1 FF         +1  5234             mov     r7,a            ;clear sign
01B2 EA         +1  5235             mov     a,r2            ;get sign of result
01B3 30E70E     +1  5236             jnb     acc.7,ok3       ;all ok
01B6 FF         +1  5237             mov     r7,a            ;store sign
                +1  5238+3           neg1                    ;negate mantissa
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    83

01B7 C3         +1  5239+1           clr     c
01B8 E4         +1  5240+1           clr     a
01B9 9D         +1  5241+1           subb    a,r5
01BA FD         +1  5242+1           mov     r5,a
01BB E4         +1  5243+1           clr     a
01BC 9C         +1  5244+1           subb    a,r4
01BD FC         +1  5245+1           mov     r4,a
01BE E4         +1  5246+1           clr     a
01BF 9B         +1  5247+1           subb    a,r3
01C0 FB         +1  5248+1           mov     r3,a
01C1 E4         +1  5249+1           clr     a
01C2 9A         +1  5250+1           subb    a,r2
01C3 FA         +1  5251+1           mov     r2,a
01C4            +1  5252     ok3:
01C4 11F0       +1  5253             call    norm1
01C6 11DE       +1  5254             call    pack1           ;pack normalized result
                +1  5255+3           restregs                ;and return
01C8 D000       +1  5256+1           pop     0
01CA D001       +1  5257+1           pop     1
01CC D006       +1  5258+1           pop     6
01CE D007       +1  5259+1           pop     7
01D0 22         +1  5260             ret
                +1  5261     ;-------------------------------------------------------------
                +1  5262     ;       Subtract the number ltemp from the number in r2-r5
                +1  5263     
01D1            +1  5264     flsub:
01D1 630880     +1  5265             xrl     ltemp,#80h      ;toggle sign bit
01D4 8090       +1  5266             jmp     fladd           ;and add!
                +1  5267     
                +1  5268     ;================================================================
                +1  5269     ;       Compare r2-r5 with the right operand and set flags accordingly
                +1  5270     
01D6            +1  5271     flcmp:
01D6 EA         +1  5272            mov     a,r2            ;get sign of left
01D7 6508       +1  5273            xrl     a,ltemp         ;calculate new sign
01D9 30E706     +1  5274            jnb     acc.7,cexp      ;same, go check exponent
                +1  5275     ;ifdef SMALL_MODEL
01DC EA         +1  5276             mov     a,r2            ;get sign of left again
01DD 33         +1  5277             rlc     a
01DE 5001       +1  5278             jnc     flout
                +1  5279     ;endif
01E0 D3         +1  5280             setb    c
01E1 22         +1  5281     flout:          ret                    ;return with acc < 0
                +1  5282     
01E2            +1  5283     cexp:
01E2 C3         +1  5284            clr     c
01E3 EA         +1  5285            mov     a,r2            ;compare exponent and mantissa
01E4 9508       +1  5286            subb    a,ltemp
01E6 7010       +1  5287            jnz     fnd
01E8 EB         +1  5288            mov     a,r3
01E9 9509       +1  5289            subb    a,ltemp+1
01EB 700B       +1  5290            jnz     fnd
01ED EC         +1  5291            mov     a,r4
01EE 950A       +1  5292            subb    a,ltemp+2
01F0 7006       +1  5293            jnz     fnd
01F2 ED         +1  5294            mov     a,r5
01F3 950B       +1  5295            subb    a,ltemp+3
01F5 7001       +1  5296            jnz     fnd
01F7            +1  5297     cdone:
01F7 22         +1  5298            ret                     ;return with acc == 0
01F8            +1  5299     fnd:
01F8 8AF0       +1  5300           mov     b,r2             ;get sign of left value
01FA 30F7FA     +1  5301          jnb     b.7,cdone       ;if positive, finished
01FD B2E7       +1  5302            cpl   acc.7             ;toggle sign???????/
01FF 4401       +1  5303                         orl         a,#1                          ;make non-zero
0201 B3         +1  5304             cpl     c               ;c=0->1,c=1->0
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    84

0202 22         +1  5305             ret
                +1  5306     ;==============================================================
                +1  5307     
                +1  5308     ;       Multiply the float in r2-r5 by the float in ltemp and return
                +1  5309     ;       the result in r2-r5
                +1  5310     
0203            +1  5311     flmul:
                +1  5312+3           saveregs
0203 C007       +1  5313+1           push    7
0205 C006       +1  5314+1           push    6
0207 C001       +1  5315+1           push    1
0209 C000       +1  5316+1           push    0
020B 119E       +1  5317             call    unpack1
020D 11BA       +1  5318             call    unpack2
020F E4         +1  5319             clr     a
0210 F50C       +1  5320             mov     prod,a
0212 F50D       +1  5321             mov     prod+1,a        ;clear product
0214 F50E       +1  5322             mov     prod+2,a
0216 F50F       +1  5323             mov     prod+3,a
0218 7E07       +1  5324             mov     r6,#7           ;initialize counter
021A            +1  5325     mup1:
                +1  5326+3           shfdn   mant2           ;shift multiplier right
021A C3         +1  5327+1           clr     c
021B E508       +1  5328+1           mov     a,mant2
021D 13         +1  5329+1           rrc     a
021E F508       +1  5330+1           mov     mant2,a
0220 E509       +1  5331+1           mov     a,mant2+1
0222 13         +1  5332+1           rrc     a
0223 F509       +1  5333+1           mov     mant2+1,a
0225 E50A       +1  5334+1           mov     a,mant2+2
0227 13         +1  5335+1           rrc     a
0228 F50A       +1  5336+1           mov     mant2+2,a
022A E50B       +1  5337+1           mov     a,mant2+3
022C 13         +1  5338+1           rrc     a
022D F50B       +1  5339+1           mov     mant2+3,a
022F 5014       +1  5340             jnc     nobit           ;skip if lsb was zero
                +1  5341+3           dan     prod            ;add multiplicand to product
0231 ED         +1  5342+1           mov     a,r5
0232 250F       +1  5343+1           add     a,prod+3
0234 F50F       +1  5344+1           mov     prod+3,a
0236 E50E       +1  5345+1           mov     a,prod+2
0238 3C         +1  5346+1           addc    a,r4
0239 F50E       +1  5347+1           mov     prod+2,a
023B E50D       +1  5348+1           mov     a,prod+1
023D 3B         +1  5349+1           addc    a,r3
023E F50D       +1  5350+1           mov     prod+1,a
0240 E50C       +1  5351+1           mov     a,prod+0
0242 3A         +1  5352+1           addc    a,r2
0243 F50C       +1  5353+1           mov     prod,a
0245            +1  5354     nobit:
                +1  5355+3           lshift                  ;shift multiplicand up
0245 ED         +1  5356+1           mov     a,r5
0246 33         +1  5357+1           rlc     a
0247 FD         +1  5358+1           mov     r5,a
0248 EC         +1  5359+1           mov     a,r4
0249 33         +1  5360+1           rlc     a
024A FC         +1  5361+1           mov     r4,a
024B EB         +1  5362+1           mov     a,r3
024C 33         +1  5363+1           rlc     a
024D FB         +1  5364+1           mov     r3,a
024E EA         +1  5365+1           mov     a,r2
024F 33         +1  5366+1           rlc     a
0250 FA         +1  5367+1           mov     r2,a
0251 DEC7       +1  5368             djnz    r6,mup1         ;loop if more
                +1  5369     
0253 7E11       +1  5370             mov     r6,#17          ;re-initalize counter
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    85

0255 8015       +1  5371             sjmp    mup3
0257            +1  5372     mup11:
                +1  5373+3           shfdn   prod            ;shift product right
0257 C3         +1  5374+1           clr     c
0258 E50C       +1  5375+1           mov     a,prod
025A 13         +1  5376+1           rrc     a
025B F50C       +1  5377+1           mov     prod,a
025D E50D       +1  5378+1           mov     a,prod+1
025F 13         +1  5379+1           rrc     a
0260 F50D       +1  5380+1           mov     prod+1,a
0262 E50E       +1  5381+1           mov     a,prod+2
0264 13         +1  5382+1           rrc     a
0265 F50E       +1  5383+1           mov     prod+2,a
0267 E50F       +1  5384+1           mov     a,prod+3
0269 13         +1  5385+1           rrc     a
026A F50F       +1  5386+1           mov     prod+3,a
026C            +1  5387     mup3:
                +1  5388+3           shfdn   mant2           ;shift multiplier down
026C C3         +1  5389+1           clr     c
026D E508       +1  5390+1           mov     a,mant2
026F 13         +1  5391+1           rrc     a
0270 F508       +1  5392+1           mov     mant2,a
0272 E509       +1  5393+1           mov     a,mant2+1
0274 13         +1  5394+1           rrc     a
0275 F509       +1  5395+1           mov     mant2+1,a
0277 E50A       +1  5396+1           mov     a,mant2+2
0279 13         +1  5397+1           rrc     a
027A F50A       +1  5398+1           mov     mant2+2,a
027C E50B       +1  5399+1           mov     a,mant2+3
027E 13         +1  5400+1           rrc     a
027F F50B       +1  5401+1           mov     mant2+3,a
0281 5014       +1  5402             jnc     mup2            ;skip if bit not set
                +1  5403+3           dan     prod            ;add to prod
0283 ED         +1  5404+1           mov     a,r5
0284 250F       +1  5405+1           add     a,prod+3
0286 F50F       +1  5406+1           mov     prod+3,a
0288 E50E       +1  5407+1           mov     a,prod+2
028A 3C         +1  5408+1           addc    a,r4
028B F50E       +1  5409+1           mov     prod+2,a
028D E50D       +1  5410+1           mov     a,prod+1
028F 3B         +1  5411+1           addc    a,r3
0290 F50D       +1  5412+1           mov     prod+1,a
0292 E50C       +1  5413+1           mov     a,prod+0
0294 3A         +1  5414+1           addc    a,r2
0295 F50C       +1  5415+1           mov     prod,a
0297            +1  5416     mup2:
0297 DEBE       +1  5417             djnz    r6,mup11        ;loop if more
0299 E8         +1  5418             mov     a,r0            ;get exp1
029A 29         +1  5419             add     a,r1            ;add exp2
029B 247A       +1  5420             add     a,#7ah;;;;;;;;;;;;;;;;;;;(-127-7) & 0FFh    ;adjust
029D F8         +1  5421             mov     r0,a            ;store
029E EF         +1  5422             mov     a,r7            ;get sign
029F 23         +1  5423             rl      a               ;rotate bit into msb
02A0 6207       +1  5424             xrl     sign,a          ;xor with other bit
                +1  5425+3           copytor prod            ;copy prod to mant1
02A2 AA0C       +1  5426+1           mov     r2,prod
02A4 AB0D       +1  5427+1           mov     r3,prod+1
02A6 AC0E       +1  5428+1           mov     r4,prod+2
02A8 AD0F       +1  5429+1           mov     r5,prod+3
02AA 11F0       +1  5430             call    norm1           ;normalize
02AC 11DE       +1  5431             call    pack1
                +1  5432+3           restregs
02AE D000       +1  5433+1           pop     0
02B0 D001       +1  5434+1           pop     1
02B2 D006       +1  5435+1           pop     6
02B4 D007       +1  5436+1           pop     7
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    86

02B6 22         +1  5437             ret
                +1  5438     ;-----------------------------------------------------------
                +1  5439     ;       Floating divide: divide the number in r2-r5 by ltemp
                +1  5440     
02B7            +1  5441     fldiv:
                +1  5442+3           saveregs
02B7 C007       +1  5443+1           push    7
02B9 C006       +1  5444+1           push    6
02BB C001       +1  5445+1           push    1
02BD C000       +1  5446+1           push    0
02BF 119E       +1  5447             call    unpack1
02C1 11BA       +1  5448             call    unpack2
02C3 E4         +1  5449             clr     a
02C4 F50C       +1  5450             mov     prod,a
02C6 F50D       +1  5451             mov     prod+1,a
02C8 F50E       +1  5452             mov     prod+2,a
02CA F50F       +1  5453             mov     prod+3,a
02CC E9         +1  5454             mov     a,r1            ;check for zero divisor
02CD 6067       +1  5455             jz      div9
02CF E8         +1  5456             mov     a,r0            ;check for zero dividend
02D0 6064       +1  5457             jz      div9
02D2 C3         +1  5458             clr     c
02D3 99         +1  5459             subb    a,r1            ;compute new exponent
02D4 2478       +1  5460             add     a,#127-7        ;unbias
02D6 F8         +1  5461             mov     r0,a            ;store back
02D7 EF         +1  5462             mov     a,r7            ;get sign
02D8 23         +1  5463             rl      a
02D9 6207       +1  5464             xrl     sign,a          ;compute new sign
02DB 7E1F       +1  5465             mov     r6,#24+7        ;initialize counter
02DD            +1  5466     div1:
                +1  5467+3           shfup   prod            ;shift quotient up
02DD C3         +1  5468+1           clr     c
02DE E50F       +1  5469+1           mov     a,prod+3
02E0 33         +1  5470+1           rlc     a
02E1 F50F       +1  5471+1           mov     prod+3,a
02E3 E50E       +1  5472+1           mov     a,prod+2
02E5 33         +1  5473+1           rlc     a
02E6 F50E       +1  5474+1           mov     prod+2,a
02E8 E50D       +1  5475+1           mov     a,prod+1
02EA 33         +1  5476+1           rlc     a
02EB F50D       +1  5477+1           mov     prod+1,a
02ED E50C       +1  5478+1           mov     a,prod
02EF 33         +1  5479+1           rlc     a
02F0 F50C       +1  5480+1           mov     prod,a
02F2 C3         +1  5481             clr     c
02F3 EA         +1  5482             mov     a,r2            ;compare values
02F4 9508       +1  5483             subb    a,mant2
02F6 4028       +1  5484             jc      div2            ;skip if bigger
02F8 7013       +1  5485             jnz     div3
02FA EB         +1  5486             mov     a,r3            ;compare values
02FB 9509       +1  5487             subb    a,mant2+1
02FD 4021       +1  5488             jc      div2            ;skip if bigger
02FF 700C       +1  5489             jnz     div3
0301 EC         +1  5490             mov     a,r4            ;compare values
0302 950A       +1  5491             subb    a,mant2+2
0304 401A       +1  5492             jc      div2            ;skip if bigger
0306 7005       +1  5493             jnz     div3
0308 ED         +1  5494             mov     a,r5            ;compare values
0309 950B       +1  5495             subb    a,mant2+3
030B 4013       +1  5496             jc      div2            ;skip if bigger
030D            +1  5497     div3:
030D ED         +1  5498             mov     a,r5
030E 950B       +1  5499             subb    a,mant2+3
0310 FD         +1  5500             mov     r5,a
0311 EC         +1  5501             mov     a,r4
0312 950A       +1  5502             subb    a,mant2+2               ;do subtraction
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    87

0314 FC         +1  5503             mov     r4,a
0315 EB         +1  5504             mov     a,r3
0316 9509       +1  5505             subb    a,mant2+1               ;do subtraction
0318 FB         +1  5506             mov     r3,a
0319 EA         +1  5507             mov     a,r2
031A 9508       +1  5508             subb    a,mant2         ;do subtraction
031C FA         +1  5509             mov     r2,a
031D 430F01     +1  5510             orl     prod+3,#1       ;set lsb in quotient
0320            +1  5511     div2:
                +1  5512+3           lshift                  ;shift dividend up
0320 ED         +1  5513+1           mov     a,r5
0321 33         +1  5514+1           rlc     a
0322 FD         +1  5515+1           mov     r5,a
0323 EC         +1  5516+1           mov     a,r4
0324 33         +1  5517+1           rlc     a
0325 FC         +1  5518+1           mov     r4,a
0326 EB         +1  5519+1           mov     a,r3
0327 33         +1  5520+1           rlc     a
0328 FB         +1  5521+1           mov     r3,a
0329 EA         +1  5522+1           mov     a,r2
032A 33         +1  5523+1           rlc     a
032B FA         +1  5524+1           mov     r2,a
032C DEAF       +1  5525             djnz    r6,div1         ;loop if more
                +1  5526+3           copytor prod            ;copy quotient
032E AA0C       +1  5527+1           mov     r2,prod
0330 AB0D       +1  5528+1           mov     r3,prod+1
0332 AC0E       +1  5529+1           mov     r4,prod+2
0334 AD0F       +1  5530+1           mov     r5,prod+3
0336            +1  5531     div9:
0336 11F0       +1  5532             call    norm1           ;now normalize result
0338 11DE       +1  5533             call    pack1           ;pack it up
                +1  5534+3           restregs                ;restore registers
033A D000       +1  5535+1           pop     0
033C D001       +1  5536+1           pop     1
033E D006       +1  5537+1           pop     6
0340 D007       +1  5538+1           pop     7
0342 22         +1  5539             ret
                +1  5540     ;------------------------------------------------------------------
                +1  5541     
                +1  5542     ;       Float to long conversion: if the exponent is less than the
                +1  5543     ;       excess value, the result is zero. If the exponent is so large
                +1  5544     ;       that the value would be shifted out, the result is overflow.
                +1  5545     ;       Otherwise shift the mantissa up or down as required.
                +1  5546     
0343            +1  5547     ftol:
                +1  5548+3           saveregs
0343 C007       +1  5549+1           push    7
0345 C006       +1  5550+1           push    6
0347 C001       +1  5551+1           push    1
0349 C000       +1  5552+1           push    0
034B EA         +1  5553             mov     a,r2
034C B4BF09     +1  5554             cjne    a,#0bfh,ne05
034F EB         +1  5555             mov     a,r3
0350 7006       +1  5556             jnz     ne05
0352 EC         +1  5557             mov     a,r4
0353 7003       +1  5558             jnz     ne05
0355 ED         +1  5559             mov     a,r5
0356 6024       +1  5560             jz      ftol1
0358 119E       +1  5561     ne05:   call    unpack1
035A E8         +1  5562             mov     a,r0            ;get exponent
035B 2482       +1  5563             add     a,#-(127-1)     ;unbias
035D 20E71C     +1  5564             jb      acc.7,ftol1     ;jump if < 0
0360 EF         +1  5565             mov     a,r7            ;get sign
0361 30E70D     +1  5566             jnb     acc.7,ftol4     ;skip if +ve
                +1  5567+3           neg1                    ;negate it
0364 C3         +1  5568+1           clr     c
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    88

0365 E4         +1  5569+1           clr     a
0366 9D         +1  5570+1           subb    a,r5
0367 FD         +1  5571+1           mov     r5,a
0368 E4         +1  5572+1           clr     a
0369 9C         +1  5573+1           subb    a,r4
036A FC         +1  5574+1           mov     r4,a
036B E4         +1  5575+1           clr     a
036C 9B         +1  5576+1           subb    a,r3
036D FB         +1  5577+1           mov     r3,a
036E E4         +1  5578+1           clr     a
036F 9A         +1  5579+1           subb    a,r2
0370 FA         +1  5580+1           mov     r2,a
0371            +1  5581     ftol4:
0371 E8         +1  5582             mov     a,r0            ;get exponent
0372 246A       +1  5583             add     a,#6ah;;;;;;;;(-(127-1+23+1)) & 0FFh
0374 20E727     +1  5584             jb      acc.7,ftol2     ;shift has to be right
0377 F8         +1  5585             mov     r0,a            ;save it
0378 24F8       +1  5586             add     a,#-8           ;if > 8, too big
037A 500E       +1  5587             jnc     ftol3
037C            +1  5588     ftol1:
037C E4         +1  5589             clr     a
037D FA         +1  5590             mov     r2,a
037E FB         +1  5591             mov     r3,a
037F FC         +1  5592             mov     r4,a
0380 FD         +1  5593             mov     r5,a
0381            +1  5594     ftol9:
                +1  5595+3           restregs
0381 D000       +1  5596+1           pop     0
0383 D001       +1  5597+1           pop     1
0385 D006       +1  5598+1           pop     6
0387 D007       +1  5599+1           pop     7
0389 22         +1  5600             ret
038A            +1  5601     ftol3:
038A E8         +1  5602             mov     a,r0
038B FE         +1  5603             mov     r6,a            ;store in counter
038C 60F3       +1  5604             jz      ftol9           ;if zero, do nothing
038E            +1  5605     ftol33:
                +1  5606+3           lshift                  ;shift up
038E ED         +1  5607+1           mov     a,r5
038F 33         +1  5608+1           rlc     a
0390 FD         +1  5609+1           mov     r5,a
0391 EC         +1  5610+1           mov     a,r4
0392 33         +1  5611+1           rlc     a
0393 FC         +1  5612+1           mov     r4,a
0394 EB         +1  5613+1           mov     a,r3
0395 33         +1  5614+1           rlc     a
0396 FB         +1  5615+1           mov     r3,a
0397 EA         +1  5616+1           mov     a,r2
0398 33         +1  5617+1           rlc     a
0399 FA         +1  5618+1           mov     r2,a
039A DEF2       +1  5619             djnz    r6,ftol33       ;and loop
039C 80E3       +1  5620             sjmp    ftol9
039E            +1  5621     ftol2:
039E F4         +1  5622             cpl     a               ;complement
039F FE         +1  5623             mov     r6,a
03A0 6022       +1  5624             jz      ftol22
03A2            +1  5625     ftol23:
03A2 EF         +1  5626             mov     a,r7
03A3 30E70F     +1  5627             jnb     acc.7,ftol24
                +1  5628+3           rshift1
03A6 D3         +1  5629+1           setb    c
03A7 EA         +1  5630+1           mov     a,r2
03A8 13         +1  5631+1           rrc     a
03A9 FA         +1  5632+1           mov     r2,a
03AA EB         +1  5633+1           mov     a,r3
03AB 13         +1  5634+1           rrc     a
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    89

03AC FB         +1  5635+1           mov     r3,a
03AD EC         +1  5636+1           mov     a,r4
03AE 13         +1  5637+1           rrc     a
03AF FC         +1  5638+1           mov     r4,a
03B0 ED         +1  5639+1           mov     a,r5
03B1 13         +1  5640+1           rrc     a
03B2 FD         +1  5641+1           mov     r5,a
03B3 800D       +1  5642             jmp     ftol25
03B5            +1  5643+3   ftol24: rshift                  ;shift down
03B5 C3         +1  5644+1           clr     c
03B6 EA         +1  5645+1           mov     a,r2
03B7 13         +1  5646+1           rrc     a
03B8 FA         +1  5647+1           mov     r2,a
03B9 EB         +1  5648+1           mov     a,r3
03BA 13         +1  5649+1           rrc     a
03BB FB         +1  5650+1           mov     r3,a
03BC EC         +1  5651+1           mov     a,r4
03BD 13         +1  5652+1           rrc     a
03BE FC         +1  5653+1           mov     r4,a
03BF ED         +1  5654+1           mov     a,r5
03C0 13         +1  5655+1           rrc     a
03C1 FD         +1  5656+1           mov     r5,a
03C2 DEDE       +1  5657     ftol25: djnz    r6,ftol23
03C4            +1  5658     ftol22:
                +1  5659+3           add1                    ;round
03C4 ED         +1  5660+1           mov     a,r5
03C5 2401       +1  5661+1           add     a,#1
03C7 FD         +1  5662+1           mov     r5,a
03C8 E4         +1  5663+1           clr     a
03C9 3C         +1  5664+1           addc    a,r4
03CA FC         +1  5665+1           mov     r4,a
03CB E4         +1  5666+1           clr     a
03CC 3B         +1  5667+1           addc    a,r3
03CD FB         +1  5668+1           mov     r3,a
03CE E4         +1  5669+1           clr     a
03CF 3A         +1  5670+1           addc    a,r2
03D0 FA         +1  5671+1           mov     r2,a
03D1 EF         +1  5672             mov     a,r7
03D2 30E70F     +1  5673             jnb     acc.7,ftol26
                +1  5674+3           rshift1
03D5 D3         +1  5675+1           setb    c
03D6 EA         +1  5676+1           mov     a,r2
03D7 13         +1  5677+1           rrc     a
03D8 FA         +1  5678+1           mov     r2,a
03D9 EB         +1  5679+1           mov     a,r3
03DA 13         +1  5680+1           rrc     a
03DB FB         +1  5681+1           mov     r3,a
03DC EC         +1  5682+1           mov     a,r4
03DD 13         +1  5683+1           rrc     a
03DE FC         +1  5684+1           mov     r4,a
03DF ED         +1  5685+1           mov     a,r5
03E0 13         +1  5686+1           rrc     a
03E1 FD         +1  5687+1           mov     r5,a
03E2 809D       +1  5688             jmp     ftol9
03E4            +1  5689+3   ftol26: rshift
03E4 C3         +1  5690+1           clr     c
03E5 EA         +1  5691+1           mov     a,r2
03E6 13         +1  5692+1           rrc     a
03E7 FA         +1  5693+1           mov     r2,a
03E8 EB         +1  5694+1           mov     a,r3
03E9 13         +1  5695+1           rrc     a
03EA FB         +1  5696+1           mov     r3,a
03EB EC         +1  5697+1           mov     a,r4
03EC 13         +1  5698+1           rrc     a
03ED FC         +1  5699+1           mov     r4,a
03EE ED         +1  5700+1           mov     a,r5
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    90

03EF 13         +1  5701+1           rrc     a
03F0 FD         +1  5702+1           mov     r5,a
03F1 808E       +1  5703             jmp     ftol9
                +1  5704     
                +1  5705     ;       arithmetic integer to floating conversions
                +1  5706     
03F3            +1  5707     abtof:
03F3 ED         +1  5708             mov     a,r5
03F4 23         +1  5709             rl      a
03F5 FC         +1  5710             mov     r4,a
03F6 9C         +1  5711             subb    a,r4
03F7 FC         +1  5712             mov     r4,a
03F8 FB         +1  5713             mov     r3,a
03F9 FA         +1  5714             mov     r2,a
03FA 8006       +1  5715             jmp     altof
03FC            +1  5716     awtof:
03FC EC         +1  5717             mov     a,r4
03FD 23         +1  5718             rl      a
03FE FB         +1  5719             mov     r3,a
03FF 9B         +1  5720             subb    a,r3
0400 FB         +1  5721             mov     r3,a
0401 FA         +1  5722             mov     r2,a
0402            +1  5723     altof:
                +1  5724+3           saveregs
0402 C007       +1  5725+1           push    7
0404 C006       +1  5726+1           push    6
0406 C001       +1  5727+1           push    1
0408 C000       +1  5728+1           push    0
040A EA         +1  5729             mov     a,r2            ;get sign
040B 5480       +1  5730             anl     a,#80h
040D FF         +1  5731             mov     r7,a            ;store it
040E 30E70D     +1  5732             jnb     acc.7,altof1    ;skip if +ve
                +1  5733+3           neg1
0411 C3         +1  5734+1           clr     c
0412 E4         +1  5735+1           clr     a
0413 9D         +1  5736+1           subb    a,r5
0414 FD         +1  5737+1           mov     r5,a
0415 E4         +1  5738+1           clr     a
0416 9C         +1  5739+1           subb    a,r4
0417 FC         +1  5740+1           mov     r4,a
0418 E4         +1  5741+1           clr     a
0419 9B         +1  5742+1           subb    a,r3
041A FB         +1  5743+1           mov     r3,a
041B E4         +1  5744+1           clr     a
041C 9A         +1  5745+1           subb    a,r2
041D FA         +1  5746+1           mov     r2,a
041E            +1  5747     altof1:
041E 7896       +1  5748             mov     r0,#127+23      ;initialize exponent
0420 11F0       +1  5749             call    norm1           ;normalize it
0422 11DE       +1  5750             call    pack1           ;and pack up
                +1  5751+3           restregs
0424 D000       +1  5752+1           pop     0
0426 D001       +1  5753+1           pop     1
0428 D006       +1  5754+1           pop     6
042A D007       +1  5755+1           pop     7
042C 22         +1  5756             ret
                +1  5757     
042D            +1  5758     lbtof:
042D 7C00       +1  5759             mov     r4,#0
042F            +1  5760     lwtof:
042F E4         +1  5761             clr     a
0430 FB         +1  5762             mov     r3,a
0431 FA         +1  5763             mov     r2,a
0432            +1  5764     lltof:
                +1  5765+3           saveregs
0432 C007       +1  5766+1           push    7
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    91

0434 C006       +1  5767+1           push    6
0436 C001       +1  5768+1           push    1
0438 C000       +1  5769+1           push    0
043A 7F00       +1  5770             mov     r7,#0           ;zero sign
043C 80E0       +1  5771             sjmp    altof1
                +1  5772     
                +1  5773     ;-------------------------------------------------------
                +1  5774     
                +1  5775     
                    5776     
                    5777     ;$include (d:\amp\wriread.asm)
                +1  5778     ;dptr-адрес ячейки страницы памяти
043E 75A800     +1  5779     cle256:          mov            IE,#00H
0441 75B601     +1  5780                              mov            FLSCL,#01                       ;стирание страницы 
                             байт(запись в ячейки ff)
0444 758F03     +1  5781                              MOV            PSCTL,#03
                +1  5782                                             
0447 7400       +1  5783                                     mov             a,#00h  ;запись любого значения стирает стр
                             аницу
0449 F0         +1  5784                                     movx    @dptr,a                         ;wr
044A 758F00     +1  5785                                     mov             PSCTL,#00
044D 75B600     +1  5786                                 mov         FLSCL,#00
0450 75A880     +1  5787                               mov           IE,#80H
0453 22         +1  5788                                     ret
                +1  5789     
                +1  5790     ;чтение памяти программ в r8..r11
                +1  5791     ;вх-r2,r3-адр яч памяти прогр
0454 8A83       +1  5792     re4byte:        mov                     dph,r2
0456 8B82       +1  5793                                             mov                     dpl,r3
0458 E4         +1  5794                                             clr                     a
0459 93         +1  5795                                             movc            a,@a+dptr
045A F508       +1  5796                                             mov                     r8,a
045C A3         +1  5797                                             inc                     dptr
045D E4         +1  5798                                             clr                     a
045E 93         +1  5799                                             movc            a,@a+dptr
045F F509       +1  5800                                             mov                     r9,a
0461 A3         +1  5801                                             inc                     dptr
0462 E4         +1  5802                                             clr                     a
0463 93         +1  5803                                             movc            a,@a+dptr
0464 F50A       +1  5804                                             mov                     r10,a
0466 A3         +1  5805                                             inc                     dptr
0467 E4         +1  5806                                             clr                     a
0468 93         +1  5807                                             movc            a,@a+dptr
0469 F50B       +1  5808                                             mov                     r11,a                      
                                                  ;r8..r11
046B 22         +1  5809                                             ret
                +1  5810      ;чтение памяти программ в r2..r5
                +1  5811     ;вх-r2,r3-адр яч памяти прогр
046C 8A83       +1  5812     rebyte2:        mov                     dph,r2
046E 8B82       +1  5813                                             mov                     dpl,r3
0470 E4         +1  5814                                             clr                     a
0471 93         +1  5815                                             movc            a,@a+dptr
0472 FA         +1  5816                                             mov                     r2,a
0473 A3         +1  5817                                             inc                     dptr
0474 E4         +1  5818                                             clr                     a
0475 93         +1  5819                                             movc            a,@a+dptr
0476 FB         +1  5820                                             mov                     r3,a
0477 A3         +1  5821                                             inc                     dptr
0478 E4         +1  5822                                             clr                     a
0479 93         +1  5823                                             movc            a,@a+dptr
047A FC         +1  5824                                             mov                     r4,a
047B A3         +1  5825                                             inc                     dptr
047C E4         +1  5826                                             clr                     a
047D 93         +1  5827                                             movc            a,@a+dptr
047E FD         +1  5828                                             mov                     r5,a                       
                                                  ;r8..r11
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    92

047F 22         +1  5829                                             ret
                +1  5830      
                +1  5831     
                +1  5832      ;r7-количество байт
                +1  5833     ;dptr-адр ячейки для записи
                +1  5834     ;r1-адр ячейки  внешнего озу
                +1  5835     
0480 75A800     +1  5836     wrpage:  mov            IE,#00H
0483 75B601     +1  5837     WW5:     mov            FLSCL,#01               ;обязательно для каждого записи байта
0486 758F01     +1  5838                      mov            PSCTL,#01               ;обязательно для каждого записи бай
                             та
0489 E3         +1  5839                      movx           a,@r1
048A F0         +1  5840                      movx           @dptr,a                         ;wr
048B 758F00     +1  5841                      mov            PSCTL,#0
048E 75B600     +1  5842                      mov            FLSCL,#00
0491 A3         +1  5843                     inc                     dptr
0492 09         +1  5844                     inc                     r1
0493 DFEE       +1  5845                     djnz            r7,WW5
0495 75A880     +1  5846                     mov             IE,#80H
0498 22         +1  5847                     ret
                +1  5848                             
                +1  5849     
                +1  5850     
                +1  5851                                                             
                +1  5852     
                +1  5853     
                +1  5854     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  5855     ;чтение памяти программ во внешнее озу
                +1  5856     ;вх-r2,r3-адр яч памяти прогр
                +1  5857     ;r1- яч внешнее озу
0499 8A83       +1  5858     copyPP:         mov                     dph,r2
049B 8B82       +1  5859                                             mov                     dpl,r3
049D 7FFF       +1  5860                                             mov                     r7,#0ffh
049F E4         +1  5861     copy1:          clr                     a
04A0 93         +1  5862                                             movc            a,@a+dptr
04A1 F3         +1  5863                                             movx                    @r1,a
04A2 A3         +1  5864                                             inc                     dptr
04A3 09         +1  5865                                             inc                     r1
04A4 DFF9       +1  5866                                             djnz            r7,copy1
04A6 22         +1  5867                                             ret
                +1  5868     ;;;;;;;;;;;;;;;;;;;;;;;;;
                +1  5869     
                +1  5870                                     
                +1  5871     
                +1  5872     ;r8..r11->@r0..@r0+3
                +1  5873     ;r0-адр ячейки
                +1  5874     ;сохранить в ячейке озу
04A7 E508       +1  5875     savelte:        mov     a,ltemp
04A9 F6         +1  5876                                             mov     @r0,a
04AA 08         +1  5877                                             inc     r0
04AB E509       +1  5878                                             mov     a,ltemp+1
04AD F6         +1  5879                                             mov     @r0,a
04AE 08         +1  5880                                             inc     r0
04AF E50A       +1  5881                                             mov     a,ltemp+2
04B1 F6         +1  5882                                             mov     @r0,a
04B2 08         +1  5883                                             inc     r0
04B3 E50B       +1  5884                                             mov     a,ltemp+3
04B5 F6         +1  5885                                             mov     @r0,a
04B6 22         +1  5886                                             ret
                +1  5887     
                +1  5888     ;
                +1  5889     
                +1  5890     
                +1  5891     
                +1  5892     
                +1  5893     
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    93

                +1  5894                     
                +1  5895     
                +1  5896     
                +1  5897     
                +1  5898     
                +1  5899      
                    5900     
                    5901                                                   
                    5902     END
                                                                             
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    94

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

AA . . . . . . . .  B ADDR   00C0H.2 A      182#
AAPAR. . . . . . .  C ADDR   0328H   R   SEG=MAIN   771 774#
ABIN . . . . . . .  D ADDR   004FH   A      300# 1309 1314 3055 3061 3094 3120 3183 3201 3492 3947
ABRET. . . . . . .  C ADDR   1718H   R   SEG=MAIN   3876 3878#
ABTOF. . . . . . .  C ADDR   03F3H   A      5707#
AC . . . . . . . .  B ADDR   00D0H.6 A      205#
ACC. . . . . . . .  D ADDR   00E0H   A      106# 617 664 672 680 688 690 710 1017 1025 1101 1260 1418 1427 1436 1445
                                           1466 1797 2061 2083 2088 2092 2095 2098 2101 2104 2107 2275 2324 2365 2376
                                           2418 2427 2435 2445 2459 2569 2587 2612 2617 2621 2624 2627 2630 2633 2636
                                           2910 2980 3143 3148 3175 3228 4114 4192 4195 4452 5104 5187 5204 5236 5274
                                           5302 5564 5566 5584 5627 5673 5732
AD0BUSY. . . . . .  B ADDR   00E8H.4 A      222#
AD0EN. . . . . . .  B ADDR   00E8H.7 A      225#
AD0INT . . . . . .  B ADDR   00E8H.5 A      223#
AD0LJST. . . . . .  B ADDR   00E8H.0 A      218#
AD0STM0. . . . . .  B ADDR   00E8H.2 A      220#
AD0STM1. . . . . .  B ADDR   00E8H.3 A      221#
AD0TM. . . . . . .  B ADDR   00E8H.6 A      224#
AD0WINT. . . . . .  B ADDR   00E8H.1 A      219#
ADC0CF . . . . . .  D ADDR   00BCH   A      72#
ADC0CN . . . . . .  D ADDR   00E8H   A      114# 218 219 220 221 222 223 224 225
ADC0GTH. . . . . .  D ADDR   00C5H   A      81#
ADC0GTL. . . . . .  D ADDR   00C4H   A      80#
ADC0H. . . . . . .  D ADDR   00BFH   A      75#
ADC0L. . . . . . .  D ADDR   00BEH   A      74#
ADC0LTH. . . . . .  D ADDR   00C7H   A      83#
ADC0LTL. . . . . .  D ADDR   00C6H   A      82#
ADC1 . . . . . . .  D ADDR   009CH   A      43#
ADC1CF . . . . . .  D ADDR   00ABH   A      57#
ADC1CN . . . . . .  D ADDR   00AAH   A      56#
ADDX . . . . . . .  C ADDR   1AC9H   R   SEG=MAIN   801 837 839 841 843 845 847 849 851 853 916 918 920 922 924 926
                                           928 930 932 935 937 939 941 943 945 947 949 951 953 4693#
ADEC . . . . . . .  D ADDR   0053H   A      301# 1313 1317 3052 3056 3091 3095 3117 3121 3184 3202 3759 3776 3794
                                           3848 3865
AFTERK . . . . . .  C ADDR   05D0H   R   SEG=MAIN   1034 1113#
AGE2 . . . . . . .  C ADDR   01C2H   R   SEG=MAIN   547# 550
AGEON. . . . . . .  C ADDR   01D0H   R   SEG=MAIN   556# 558
ALESS0 . . . . . .  C ADDR   06E6H   R   SEG=MAIN   1260 1281#
ALLSUM . . . . . .  C ADDR   02E1H   R   SEG=MAIN   730# 766
ALMUL. . . . . . .  C ADDR   1A10H   R   SEG=MAIN   4539#
ALTOF. . . . . . .  C ADDR   0402H   A      1009 1045 1094 1126 1139 1574 1635 1673 3098 3124 3187 3205 5715 5723#
ALTOF1 . . . . . .  C ADDR   041EH   A      5732 5747# 5771
AMX0CF . . . . . .  D ADDR   00BAH   A      70#
AMX0SL . . . . . .  D ADDR   00BBH   A      71#
AMX1SL . . . . . .  D ADDR   00ACH   A      58#
ANKOR. . . . . . .  C ADDR   0523H   R   SEG=MAIN   1007 1014#
AN_T7. . . . . . .  C ADDR   0ED6H   R   SEG=MAIN   2637# 2687 2696
AUTOKA . . . . . .  C ADDR   0892H   R   SEG=MAIN   1032 1603#
AVPGO. . . . . . .  C ADDR   0650H   R   SEG=MAIN   1185 1187#
AVTDEC1. . . . . .  C ADDR   0595H   R   SEG=MAIN   1067 1074#
AWTOF. . . . . . .  C ADDR   03FCH   A      5716#
B. . . . . . . . .  D ADDR   00F0H   A      122# 3310 3512 3631 3967 4542 4545 4547 4551 4555 4559 4563 4568 4572
                                           4579 4583 4587 4593 4597 4601 4607 5300 5301
BEGIN. . . . . . .  C ADDR   0100H   R   SEG=MAIN   249 441#
BFORM. . . . . . .  C ADDR   0A2CH   R   SEG=MAIN   1875 1880 1892# 1918
BIN30. . . . . . .  C ADDR   182CH   R   SEG=MAIN   4102# 4128
BIN31. . . . . . .  C ADDR   1830H   R   SEG=MAIN   4107# 4111
BIN32. . . . . . .  C ADDR   1840H   R   SEG=MAIN   4120# 4125
BIN41. . . . . . .  C ADDR   1851H   R   SEG=MAIN   4136# 4146
BINDEC . . . . . .  C ADDR   1820H   R   SEG=MAIN   1315 4081#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    95

BITAKT . . . . . .  B ADDR   0023H.2 A      348# 1394 1395 1398
BITAVP . . . . . .  B ADDR   0020H.5 A      319# 1145 1214 1386 2677 2678 2680
BITBON . . . . . .  B ADDR   0021H.2 A      326# 1496 2110 2111 2113
BITBUF . . . . . .  B ADDR   0021H.0 A      324# 1517 1519 2192
BITIZM . . . . . .  B ADDR   0020H.4 A      318# 527 638 2089 2146 2231 2618 2670 2762 2778 2842 2870 2957 2965 3135
BITMAS . . . . . .  B ADDR   0020H.1 A      315# 962 965 1857
BITMEM . . . . . .  B ADDR   0021H.3 A      327# 2412 2873 2905 2956 2964 3134
BITMENU. . . . . .  B ADDR   0022H.1 A      335# 2392 2671
BITMIG . . . . . .  B ADDR   0023H.1 A      347# 2359 2576 2811 3169 3235 3430 3437 3443 3449 3453 3467 3479
BITNUL . . . . . .  B ADDR   0021H.7 A      331# 1371 2698 2699 2706
BITOLL . . . . . .  B ADDR   0022H.7 A      341# 593 1221 1298
BITPRD . . . . . .  B ADDR   0021H.1 A      325# 1495
BITRS. . . . . . .  B ADDR   0020H.3 A      317#
BITT2. . . . . . .  B ADDR   0022H.0 A      334# 1297 2232 2272 2713 2843
BITVI11. . . . . .  B ADDR   0020H.6 A      320# 1146 2145 2389
BITVI12. . . . . .  B ADDR   0022H.2 A      336#
BITVI13. . . . . .  B ADDR   0022H.3 A      337#
BITVI21. . . . . .  B ADDR   0022H.5 A      339#
BITVI31. . . . . .  B ADDR   0022H.6 A      340#
BITVICH. . . . . .  B ADDR   0022H.4 A      338# 1296 2147 2157 2294 2730 2761 2777
BITZNAK. . . . . .  B ADDR   0020H.0 A      314# 618 647
BITZNB . . . . . .    ----   -----          3874 3877
BITZUS . . . . . .  B ADDR   0020H.7 A      321# 1237
BMEM11 . . . . . .  B ADDR   0021H.4 A      328# 2390
BMEM12 . . . . . .  B ADDR   0021H.5 A      329#
BMEM13 . . . . . .  B ADDR   0021H.6 A      330#
BOUT7. . . . . . .  C ADDR   1056H   R   SEG=MAIN   2851# 2853
BRET . . . . . . .  C ADDR   1334H   R   SEG=MAIN   3258 3263 3267# 3571 3576 3580#
BUFDEC . . . . . .  C ADDR   071AH   R   SEG=MAIN   1320# 1325
BUFIND . . . . . .  D ADDR   0040H   A      298# 546 550 555 558 562 1270 1275 1318 1326 1328 1333 1369 1396 1399
                                           1729 2077 2337 2352 2367 2369 2372 2481 2524 2543 2605 2824 2857 2863 3023
                                           3161 3308 3326 3434 3456 3629 3647 3758 3775 3793 3847 3864 3875
BUFON. . . . . . .  C ADDR   0B63H   R   SEG=MAIN   2110 2113#
CCF0 . . . . . . .  B ADDR   00D8H.0 A      209#
CCF1 . . . . . . .  B ADDR   00D8H.1 A      210#
CCF2 . . . . . . .  B ADDR   00D8H.2 A      211#
CCF3 . . . . . . .  B ADDR   00D8H.3 A      212#
CCF4 . . . . . . .  B ADDR   00D8H.4 A      213#
CDONE. . . . . . .  C ADDR   01F7H   A      5297# 5301
CELLBIT. . . . . .  D ADDR   0020H   A      313# 314 315 316 317 318 319 320 321
CELLBIT1 . . . . .  D ADDR   0021H   A      323# 324 325 326 327 328 329 330 331
CELLBIT2 . . . . .  D ADDR   0022H   A      333# 334 335 336 337 338 339 340 341
CELLBIT3 . . . . .  D ADDR   0023H   A      345# 346 347 348
CEXP . . . . . . .  C ADDR   01E2H   A      5274 5283#
CF . . . . . . . .  B ADDR   00D8H.7 A      215#
CH0. . . . . . . .  C ADDR   162DH   R   SEG=MAIN   2707 3703#
CH1. . . . . . . .  C ADDR   1649H   R   SEG=MAIN   1714 3713#
CH10 . . . . . . .  C ADDR   1631H   R   SEG=MAIN   976 3704#
CH100. . . . . . .  C ADDR   1641H   R   SEG=MAIN   729 1255 3708#
CH10000. . . . . .  C ADDR   163DH   R   SEG=MAIN   3707#
CH2. . . . . . . .  C ADDR   1645H   R   SEG=MAIN   971 3709#
CH20 . . . . . . .  C ADDR   156AH   R   SEG=MAIN   765 981 3543# 3998#
CH2THO . . . . . .  C ADDR   165DH   R   SEG=MAIN   1642 1680 3718#
CH5. . . . . . . .  C ADDR   1635H   R   SEG=MAIN   3705#
CH57 . . . . . . .  C ADDR   1566H   R   SEG=MAIN   3542# 3997#
CH954. . . . . . .  C ADDR   1639H   R   SEG=MAIN   3706#
CHANMA . . . . . .  C ADDR   0CF4H   R   SEG=MAIN   2365 2374#
CHANZ. . . . . . .  C ADDR   0CDBH   R   SEG=MAIN   2324 2363#
CHAVT. . . . . . .  D ADDR   0081H   A      363# 507 1023 1068 1074 1696
CHBEFORE . . . . .  D ADDR   009BH   A      373# 529 726 741 760
CHBUF. . . . . . .  D ADDR   00ADH   A      380# 1493 1503
CHCMP. . . . . . .  C ADDR   0AD1H   R   SEG=MAIN   630 1029 2034#
CHDEC. . . . . . .  C ADDR   0938H   R   SEG=MAIN   637 1075 1086 1706#
CHDEL. . . . . . .  D ADDR   0083H   A      364# 1543 1588 1610 1655 1690
CHDELMO. . . . . .  C ADDR   087AH   R   SEG=MAIN   1558 1588# 1593
CHIF . . . . . . .  C ADDR   14F7H   R   SEG=MAIN   3460 3462#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    96

CHIND. . . . . . .  D ADDR   00ACH   A      379# 1160 1403
CHINKOR. . . . . .  D ADDR   0098H   A      362# 502 708 1015 1028 1070 1082 1085 1595
CHKL . . . . . . .  D ADDR   003DH   A      305# 629 636 2210 2238 2287 2651 2876
CHMAS. . . . . . .  D ADDR   006EH   A      302# 959 966 984 1856
CHMASN . . . . . .  D ADDR   003FH   A      306# 715 724 761 778 790 964 966 967
CHTADC . . . . . .  C ADDR   0982H   R   SEG=MAIN   1755#
CHTHO. . . . . . .  C ADDR   1655H   R   SEG=MAIN   1046 1127 3716#
CHTHOU . . . . . .  C ADDR   16E3H   R   SEG=MAIN   3835#
CHZAP. . . . . . .  C ADDR   1629H   R   SEG=MAIN   1482 3702#
CH_1 . . . . . . .  C ADDR   164DH   R   SEG=MAIN   532 3714#
CH_10. . . . . . .  C ADDR   166DH   R   SEG=MAIN   3722#
CH_10TH. . . . . .  C ADDR   1669H   R   SEG=MAIN   1180 3721#
CH_200 . . . . . .  C ADDR   1665H   R   SEG=MAIN   1140 3720#
CH_220 . . . . . .  C ADDR   1661H   R   SEG=MAIN   1119 3719#
CH_22T . . . . . .  C ADDR   1721H   R   SEG=MAIN   3883#
CH_250 . . . . . .  C ADDR   1671H   R   SEG=MAIN   3723#
CH_500 . . . . . .  C ADDR   171DH   R   SEG=MAIN   3882#
CH_953 . . . . . .  C ADDR   1651H   R   SEG=MAIN   3715#
CH_B . . . . . . .  C ADDR   1719H   R   SEG=MAIN   3880#
CH_FL. . . . . . .  C ADDR   1725H   R   SEG=MAIN   3884#
CIKLWR . . . . . .  C ADDR   0A02H   R   SEG=MAIN   1863#
CKCON. . . . . . .  D ADDR   008EH   A      30# 459
CL4. . . . . . . .  C ADDR   1683H   R   SEG=MAIN   3738# 3740
CL4N . . . . . . .  C ADDR   1689H   R   SEG=MAIN   3747# 3749
CLE256 . . . . . .  C ADDR   043EH   A      5779#
CLEAR. . . . . . .  C ADDR   181AH   R   SEG=MAIN   4059 4063# 4093
CLEAR4 . . . . . .  C ADDR   1680H   R   SEG=MAIN   738 1196 1198 1234 1236 2139 2141 2692 2694 3736#
CLEARN . . . . . .  C ADDR   1688H   R   SEG=MAIN   3053 3092 3118 3745#
CLMASSIX . . . . .  C ADDR   09F2H   R   SEG=MAIN   501 1194 1232 1599 1700 1850# 2137 2690 2841
CLMASV . . . . . .  C ADDR   0655H   R   SEG=MAIN   1189 1191#
CLMAX. . . . . . .  C ADDR   09F7H   R   SEG=MAIN   1852# 1855
CLR11. . . . . . .  C ADDR   181BH   R   SEG=MAIN   4065# 4067
CLRDEC . . . . . .  C ADDR   1814H   R   SEG=MAIN   4057#
CLRNUM . . . . . .  C ADDR   1818H   R   SEG=MAIN   4060# 4174
CLRVICH. . . . . .  C ADDR   0FD7H   R   SEG=MAIN   2777# 2793
CNTR . . . . . . .  N NUMB   0006H   A      4970#
CO02S. . . . . . .  C ADDR   161EH   R   SEG=MAIN   3696# 3700
CO1S . . . . . . .  C ADDR   1615H   R   SEG=MAIN   3690# 3690
CO2S . . . . . . .  C ADDR   1611H   R   SEG=MAIN   3688# 3692
COND . . . . . . .  C ADDR   0A66H   R   SEG=MAIN   1947#
CONSTE . . . . . .  D ADDR   00A4H   A      377# 1202
CONSTF . . . . . .  D ADDR   00A8H   A      378# 1207
COPY1. . . . . . .  C ADDR   049FH   A      5861# 5866
COPYPP . . . . . .  C ADDR   0499H   A      5858#
COUNT. . . . . . .  C ADDR   15F3H   R   SEG=MAIN   3662# 3662
CPRL2. . . . . . .  B ADDR   00C8H.0 A      189#
CPT0CN . . . . . .  D ADDR   009EH   A      45#
CPT1CN . . . . . .  D ADDR   009FH   A      46#
CR . . . . . . . .  B ADDR   00D8H.6 A      214#
CT . . . . . . . .  C ADDR   15FAH   R   SEG=MAIN   3668# 3668
CT2. . . . . . . .  B ADDR   00C8H.1 A      190#
CY . . . . . . . .  B ADDR   00D0H.7 A      206#
DAC0CN . . . . . .  D ADDR   00D4H   A      95# 464
DAC0H. . . . . . .  D ADDR   00D3H   A      94# 1262 1283
DAC0L. . . . . . .  D ADDR   00D2H   A      93# 1265 1287
DAC1CN . . . . . .  D ADDR   00D7H   A      98# 465
DAC1H. . . . . . .  D ADDR   00D6H   A      97# 1490
DAC1L. . . . . . .  D ADDR   00D5H   A      96# 1487
DCOA . . . . . . .  C ADDR   0A6BH   R   SEG=MAIN   1951# 1953
DCOB . . . . . . .  C ADDR   0A72H   R   SEG=MAIN   1955# 1973
DCOC . . . . . . .  C ADDR   0A7DH   R   SEG=MAIN   1965# 1970
DCOD . . . . . . .  C ADDR   0A8AH   R   SEG=MAIN   1972 1975#
DD . . . . . . . .  C ADDR   01FCH   R   SEG=MAIN   584#
DDOUTF . . . . . .  C ADDR   1153H   R   SEG=MAIN   2954 2961 2990 2996# 3047
DEC30. . . . . . .  C ADDR   186DH   R   SEG=MAIN   4184# 4209
DEC31. . . . . . .  C ADDR   1872H   R   SEG=MAIN   4190# 4197
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    97

DEC32. . . . . . .  C ADDR   1882H   R   SEG=MAIN   4202# 4206
DECBIN . . . . . .  C ADDR   1860H   R   SEG=MAIN   3057 3096 3122 3185 3203 4163#
DECSIZE. . . . . .  N NUMB   000AH   A      4038# 4058 4092 4119 4132 4135 4189
DECT2. . . . . . .  C ADDR   188BH   R   SEG=MAIN   4180 4212#
DEDPTR . . . . . .  C ADDR   1AE0H   R   SEG=MAIN   4697 4701 4705 4711#
DENORM . . . . . .  C ADDR   0133H   A      5129# 5185
DGOTO7 . . . . . .  C ADDR   1242H   R   SEG=MAIN   3125# 3131
DIAP . . . . . . .  D ADDR   00AEH   A      381# 521 1184 1216 1332 2131 2163 2200 2642 2683 3238 3259 3509 3551 3572
                                           3807 3964 4026
DIINC. . . . . . .  C ADDR   0B82H   R   SEG=MAIN   2134 2137#
DIKDN. . . . . . .  C ADDR   153EH   R   SEG=MAIN   3511 3531# 3966 3986#
DIKDW. . . . . . .  C ADDR   16CDH   R   SEG=MAIN   3811 3823#
DIPAR. . . . . . .  C ADDR   16E1H   R   SEG=MAIN   3833#
DIV1 . . . . . . .  C ADDR   02DDH   A      5466# 5525
DIV2 . . . . . . .  C ADDR   0320H   A      5484 5488 5492 5496 5511#
DIV3 . . . . . . .  C ADDR   030DH   A      5485 5489 5493 5497#
DIV9 . . . . . . .  C ADDR   0336H   A      5455 5457 5531#
DIVIDE . . . . . .  C ADDR   194BH   R   SEG=MAIN   1879 4398#
DONE . . . . . . .  C ADDR   18BAH   R   SEG=MAIN   4228 4239#
DONE1. . . . . . .  C ADDR   18B8H   R   SEG=MAIN   4231 4234 4237#
DOSH . . . . . . .  C ADDR   19D4H   R   SEG=MAIN   4473 4489#
DOSUB. . . . . . .  C ADDR   19C2H   R   SEG=MAIN   4457 4461 4465 4469 4470 4474#
DPH. . . . . . . .  D ADDR   0083H   A      19# 1810 1818 2598 3217 4245 4281 4316 4319 4331 4354 4716 4718 5792 5812
                                           5858
DPL. . . . . . . .  D ADDR   0082H   A      18# 1811 1817 2597 3218 4261 4297 4318 4332 4335 4369 4713 4715 5793 5813
                                           5859
DVIG0. . . . . . .  C ADDR   07CDH   R   SEG=MAIN   1439# 1441
DVIG1. . . . . . .  C ADDR   07C2H   R   SEG=MAIN   1430# 1432
DVIG2. . . . . . .  C ADDR   07B7H   R   SEG=MAIN   1421# 1423
DVIG3. . . . . . .  C ADDR   07ABH   R   SEG=MAIN   1412# 1414
DVIG4. . . . . . .  C ADDR   07D9H   R   SEG=MAIN   1450# 1452
DVIG6. . . . . . .  C ADDR   07F8H   R   SEG=MAIN   1475# 1477
DVM. . . . . . . .  C ADDR   07F6H   R   SEG=MAIN   1466 1474#
EA . . . . . . . .  B ADDR   00A8H.7 A      169#
EIE1 . . . . . . .  D ADDR   00E6H   A      112# 462
EIE2 . . . . . . .  D ADDR   00E7H   A      113# 488 1727 1739 2059 2571 2586 3234
EIP1 . . . . . . .  D ADDR   00F6H   A      128#
EIP2 . . . . . . .  D ADDR   00F7H   A      129#
EMI0CF . . . . . .  D ADDR   00A3H   A      49#
EMI0CN . . . . . .  D ADDR   00AFH   A      61#
EMI0TC . . . . . .  D ADDR   00A1H   A      48#
ENDSDV . . . . . .  C ADDR   07FCH   R   SEG=MAIN   1472 1478#
ENDSUM . . . . . .  C ADDR   04CFH   R   SEG=MAIN   802 854 958#
ENSMB. . . . . . .  B ADDR   00C0H.6 A      186#
EQU1L. . . . . . .  C ADDR   0DE1H   R   SEG=MAIN   2491 2495#
EQU2L. . . . . . .  C ADDR   118BH   R   SEG=MAIN   3033 3038#
ES . . . . . . . .  B ADDR   00A8H.4 A      167#
ET0. . . . . . . .  B ADDR   00A8H.1 A      164#
ET1. . . . . . . .  B ADDR   00A8H.3 A      166#
ET2. . . . . . . .  B ADDR   00A8H.5 A      168#
EX0. . . . . . . .  B ADDR   00A8H.0 A      163#
EX1. . . . . . . .  B ADDR   00A8H.2 A      165#
EXEN2. . . . . . .  B ADDR   00C8H.3 A      192#
EXF2 . . . . . . .  B ADDR   00C8H.6 A      195#
EXP1 . . . . . . .  N NUMB   0000H   A      4972#
EXP2 . . . . . . .  N NUMB   0001H   A      4974# 5151 5172
F0 . . . . . . . .  B ADDR   00D0H.5 A      204#
F1 . . . . . . . .  B ADDR   00D0H.1 A      200#
FINDKOEF . . . . .  C ADDR   16BEH   R   SEG=MAIN   1042 1123 3806#
FINDR. . . . . . .  C ADDR   180CH   R   SEG=MAIN   4026#
FINIS. . . . . . .  C ADDR   19FFH   R   SEG=MAIN   4417 4518#
FLACL. . . . . . .  D ADDR   00B7H   A      67#
FLADD. . . . . . .  C ADDR   0166H   A      1209 5177# 5266
FLCMP. . . . . . .  C ADDR   01D6H   A      1121 1142 1182 5271#
FLDIV. . . . . . .  C ADDR   02B7H   A      1048 1129 1206 1644 1682 5441#
FLMUL. . . . . . .  C ADDR   0203H   A      1053 1106 1134 5311#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    98

FLOUT. . . . . . .  C ADDR   01E1H   A      5278 5281#
FLSCL. . . . . . .  D ADDR   00B6H   A      66# 5780 5786 5837 5842
FLSUB. . . . . . .  C ADDR   01D1H   A      1098 1640 1678 5264#
FND. . . . . . . .  C ADDR   01F8H   A      5287 5290 5293 5296 5299#
FO1M . . . . . . .  C ADDR   0A29H   R   SEG=MAIN   1885 1889#
FO2M . . . . . . .  C ADDR   0A32H   R   SEG=MAIN   1892 1894#
FORM4. . . . . . .  C ADDR   0A33H   R   SEG=MAIN   1887 1893 1897#
FT1IZM . . . . . .  C ADDR   0C61H   R   SEG=MAIN   2282#
FTOL . . . . . . .  C ADDR   0343H   A      1054 1136 1303 5547#
FTOL1. . . . . . .  C ADDR   037CH   A      5560 5564 5588#
FTOL2. . . . . . .  C ADDR   039EH   A      5584 5621#
FTOL22 . . . . . .  C ADDR   03C4H   A      5624 5658#
FTOL23 . . . . . .  C ADDR   03A2H   A      5625# 5657
FTOL24 . . . . . .  C ADDR   03B5H   A      5627 5643#
FTOL25 . . . . . .  C ADDR   03C2H   A      5642 5657#
FTOL26 . . . . . .  C ADDR   03E4H   A      5673 5689#
FTOL3. . . . . . .  C ADDR   038AH   A      5587 5601#
FTOL33 . . . . . .  C ADDR   038EH   A      5605# 5619
FTOL4. . . . . . .  C ADDR   0371H   A      5566 5581#
FTOL9. . . . . . .  C ADDR   0381H   A      5594# 5604 5620 5688 5703
GENER. . . . . . .  C ADDR   0145H   R   SEG=MAIN   470# 471
GO23NO . . . . . .  C ADDR   111BH   R   SEG=MAIN   2962 2968#
GO31L. . . . . . .  C ADDR   0DE7H   R   SEG=MAIN   2470 2500#
GO41L. . . . . . .  C ADDR   0DECH   R   SEG=MAIN   2500 2502#
GOA2 . . . . . . .  C ADDR   0617H   R   SEG=MAIN   1144 1147#
GOA3A2 . . . . . .  C ADDR   0621H   R   SEG=MAIN   1152# 1212
GOCIKLE. . . . . .  C ADDR   0835H   R   SEG=MAIN   1497 1506 1510 1517# 1523 1526
GOFULL . . . . . .  C ADDR   114DH   R   SEG=MAIN   2974 2994#
GOONIN . . . . . .  C ADDR   062EH   R   SEG=MAIN   1159# 1199 1222 1238
GOONIND. . . . . .  C ADDR   06EFH   R   SEG=MAIN   1162 1288#
GOONT. . . . . . .  C ADDR   081FH   R   SEG=MAIN   1500 1502#
GOPART . . . . . .  C ADDR   02BFH   R   SEG=MAIN   710 713#
GOTO7. . . . . . .  C ADDR   0EE2H   R   SEG=MAIN   2645 2650# 2704 2711 2747 2763 2781 2800 2812 2851 2855 2880 2915
                                           2924 2928 2942 2958 2966 2976 2998 3008 3037 3040 3069 3082 3084 3106 3125
                                           3137 3145 3152 3196
GOTOKD . . . . . .  C ADDR   0545H   R   SEG=MAIN   1012 1036#
GOZNAK . . . . . .  C ADDR   0271H   R   SEG=MAIN   624 653#
HNOR11 . . . . . .  C ADDR   0FE2H   R   SEG=MAIN   2740 2752 2784#
HNOR12 . . . . . .  C ADDR   0FA3H   R   SEG=MAIN   2748 2752#
HNOT1. . . . . . .  C ADDR   101FH   R   SEG=MAIN   2725 2821#
HNOT2. . . . . . .  C ADDR   0F71H   R   SEG=MAIN   2722#
HR12 . . . . . . .  C ADDR   0F99H   R   SEG=MAIN   2743 2748#
HVI1113. . . . . .  C ADDR   0F93H   R   SEG=MAIN   2746# 2751 2756
IE . . . . . . . .  D ADDR   00A8H   A      54# 163 164 165 166 167 168 169 489 5779 5787 5836 5846
IE0. . . . . . . .  B ADDR   0088H.1 A      144#
IE1. . . . . . . .  B ADDR   0088H.3 A      146#
INCT . . . . . . .  C ADDR   0F6DH   R   SEG=MAIN   2717 2719#
IND. . . . . . . .  C ADDR   0950H   R   SEG=MAIN   551 559 584 641 1400 1727# 2124 2674
INDA3. . . . . . .  C ADDR   06B6H   R   SEG=MAIN   1253#
INDOLL . . . . . .  C ADDR   068EH   R   SEG=MAIN   1214 1215 1219#
INIACP . . . . . .  C ADDR   146CH   R   SEG=MAIN   590 2839 3367# 3890#
INTN . . . . . . .  C ADDR   122BH   R   SEG=MAIN   3116#
IP . . . . . . . .  D ADDR   00B8H   A      68# 172 173 174 175 176 177
IT0. . . . . . . .  B ADDR   0088H.0 A      143#
IT1. . . . . . . .  B ADDR   0088H.2 A      145#
IZCHI. . . . . . .  C ADDR   1007H   R   SEG=MAIN   2802#
IZMAN. . . . . . .  C ADDR   0BD3H   R   SEG=MAIN   2057 2184#
IZMFUN . . . . . .  C ADDR   0BE2H   R   SEG=MAIN   2125 2136 2143 2188 2191#
IZMPAT . . . . . .  C ADDR   0BE6H   R   SEG=MAIN   2108 2112 2114 2160 2195#
IZMT2. . . . . . .  C ADDR   0C03H   R   SEG=MAIN   2211 2216#
IZMT3. . . . . . .  C ADDR   0C0EH   R   SEG=MAIN   2216 2222#
JFINIS . . . . . .  C ADDR   1966H   R   SEG=MAIN   4409 4417#
KD . . . . . . . .  C ADDR   1659H   R   SEG=MAIN   3717#
KEYB1. . . . . . .  C ADDR   0AF3H   R   SEG=MAIN   283 2058#
KEYB2. . . . . . .  C ADDR   0E6DH   R   SEG=MAIN   286 2585#
KFULL. . . . . . .  C ADDR   1125H   R   SEG=MAIN   2938 2973#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE    99

KGO23. . . . . . .  C ADDR   110BH   R   SEG=MAIN   2937 2960#
KLEV1. . . . . . .  C ADDR   10C9H   R   SEG=MAIN   2907 2929#
KLEV2. . . . . . .  C ADDR   10CEH   R   SEG=MAIN   2929 2931#
KLEV21 . . . . . .  C ADDR   10EAH   R   SEG=MAIN   2935 2944#
KLEV22 . . . . . .  C ADDR   10D3H   R   SEG=MAIN   2931 2935#
KLEV23 . . . . . .  C ADDR   10F5H   R   SEG=MAIN   2944 2950#
KLMAS. . . . . . .  C ADDR   0344H   R   SEG=MAIN   743 781 789#
KNAVP. . . . . . .  C ADDR   0F14H   R   SEG=MAIN   2630 2677#
KNIZM. . . . . . .  B ADDR   0023H.0 A      346# 1144 1215 1390 2162 2184 2185 2189
KNIZMON. . . . . .  C ADDR   0BDDH   R   SEG=MAIN   2184 2189#
KNKMP. . . . . . .  C ADDR   0E5EH   R   SEG=MAIN   2580# 2624
KNLEFT . . . . . .  C ADDR   0F21H   R   SEG=MAIN   2584 2683#
KNMEM. . . . . . .  C ADDR   1074H   R   SEG=MAIN   2579 2870#
KNMENU . . . . . .  C ADDR   0F04H   R   SEG=MAIN   2636 2670#
KNNUL. . . . . . .  C ADDR   0F3CH   R   SEG=MAIN   2583 2698#
KNOPT. . . . . . .  C ADDR   0C16H   R   SEG=MAIN   2056 2230#
KNRAZR . . . . . .  C ADDR   0C2BH   R   SEG=MAIN   2055 2244#
KNRIGHT. . . . . .  C ADDR   0B78H   R   SEG=MAIN   2098 2129#
KNVICH . . . . . .  C ADDR   0B94H   R   SEG=MAIN   2107 2145#
KOEFKD . . . . . .  D ADDR   00A0H   A      376# 538
KOEFKM . . . . . .  D ADDR   0094H   A      370# 536 1104 1686
KOEFKP . . . . . .  D ADDR   0090H   A      369# 534 1099 1648
KONSTA . . . . . .  D ADDR   00BCH   A      389# 3188
KONSTB . . . . . .  D ADDR   00C0H   A      390# 3206
KOR0US . . . . . .  C ADDR   1344H   R   SEG=MAIN   1556 3290# 3605#
KOR0_AN. . . . . .  D ADDR   0084H   A      366# 1095 1575 1638 1676
KORDEC1. . . . . .  C ADDR   05A8H   R   SEG=MAIN   1080 1085#
KORDEC10 . . . . .  C ADDR   058EH   R   SEG=MAIN   1070#
KORNUL . . . . . .  C ADDR   085AH   R   SEG=MAIN   1019 1543#
KVVOD0 . . . . . .  C ADDR   1140H   R   SEG=MAIN   2917 2980 2989#
L. . . . . . . . .    ----   -----          3036
LABELA . . . . . .  C ADDR   0246H   R   SEG=MAIN   627# 645 1520
LABELB . . . . . .  C ADDR   07A4H   R   SEG=MAIN   1062 1241 1405# 1531 1535 1537
LABELC . . . . . .  C ADDR   0C2BH   R   SEG=MAIN   2245#
LABELE . . . . . .  C ADDR   0BF4H   R   SEG=MAIN   2193 2203 2206 2209# 2250 2253 2265 2268
LABELF . . . . . .  C ADDR   0C4DH   R   SEG=MAIN   2054 2271#
LABELH . . . . . .  C ADDR   0F5CH   R   SEG=MAIN   2582 2713#
LABELI . . . . . .  C ADDR   125DH   R   SEG=MAIN   2728 2814 3140#
LABELK . . . . . .  C ADDR   108FH   R   SEG=MAIN   2727 2883#
LABELL . . . . . .  C ADDR   0D83H   R   SEG=MAIN   2390 2432 2441#
LABELL1. . . . . .  C ADDR   0CFCH   R   SEG=MAIN   2378# 2507 2556
LABELN . . . . . .  C ADDR   0E06H   R   SEG=MAIN   2516#
LABELP . . . . . .  C ADDR   125DH   R   SEG=MAIN   3127 3138#
LABL2. . . . . . .  C ADDR   0DCAH   R   SEG=MAIN   2473# 2947
LABL21 . . . . . .  C ADDR   0DA3H   R   SEG=MAIN   2442 2456#
LABL22 . . . . . .  C ADDR   0DB9H   R   SEG=MAIN   2460 2465#
LABM . . . . . . .  C ADDR   1191H   R   SEG=MAIN   2948 3043#
LADD . . . . . . .  C ADDR   1AA7H   R   SEG=MAIN   721 757 1485 4644#
LADDX. . . . . . .  C ADDR   1AB8H   R   SEG=MAIN   4668#
LAL22. . . . . . .  C ADDR   0D9BH   R   SEG=MAIN   2446 2451#
LBTOF. . . . . . .  C ADDR   042DH   A      5758#
LCMP . . . . . . .  C ADDR   18A5H   R   SEG=MAIN   1916 2044 4224#
LDC_LONG . . . . .  C ADDR   18BBH   R   SEG=MAIN   533 1483 1643 1681 2708 4244#
LDC_LTEMP. . . . .  C ADDR   18DDH   R   SEG=MAIN   730 972 977 982 1047 1120 1128 1141 1181 1256 1715 4280#
LDX_LONG . . . . .  C ADDR   1903H   R   SEG=MAIN   4315#
LDX_LTEMP. . . . .  C ADDR   1929H   R   SEG=MAIN   4353#
LEFCUR . . . . . .  C ADDR   11D4H   R   SEG=MAIN   3075# 3111 3129
LEFMEM11 . . . . .  C ADDR   1097H   R   SEG=MAIN   2908# 2930 2932
LEV220 . . . . . .  C ADDR   10D6H   R   SEG=MAIN   2936# 2945
LEV2GO . . . . . .  C ADDR   0E2CH   R   SEG=MAIN   2515 2552#
LEVEL. . . . . . .  D ADDR   00B0H   A      383# 2116 2395 2413 2441 2874 2906 2991
LI21 . . . . . . .  C ADDR   1011H   R   SEG=MAIN   2809 2811#
LLDI2. . . . . . .  C ADDR   0BCCH   R   SEG=MAIN   2175 2179#
LLDI23 . . . . . .  C ADDR   0BC0H   R   SEG=MAIN   2167 2172#
LLDI3. . . . . . .  C ADDR   0BC7H   R   SEG=MAIN   2174 2176#
LLEV2. . . . . . .  C ADDR   0DF1H   R   SEG=MAIN   2472 2505#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   100

LLMUL. . . . . . .  C ADDR   1A10H   R   SEG=MAIN   4538#
LLSUB. . . . . . .  C ADDR   1A95H   R   SEG=MAIN   4620#
LLTOF. . . . . . .  C ADDR   0432H   A      5764#
LMUL . . . . . . .  C ADDR   1A10H   R   SEG=MAIN   1874 4540#
LOAB12 . . . . . .  C ADDR   14BBH   R   SEG=MAIN   2837 3408# 3931#
LOAD . . . . . . .  D ADDR   00B7H   A      387# 2233 2276 2715 2833 3307 3628
LOADB. . . . . . .  C ADDR   1030H   R   SEG=MAIN   2828 2831# 2861 2867
LOADB2 . . . . . .  C ADDR   1059H   R   SEG=MAIN   2849 2853#
LOADCLE. . . . . .  C ADDR   10B5H   R   SEG=MAIN   2922# 2983
LOADKD . . . . . .  C ADDR   1520H   R   SEG=MAIN   3509# 3964#
LOADR2 . . . . . .  C ADDR   1512H   R   SEG=MAIN   3097 3123 3186 3204 3492# 3947#
LOADT. . . . . . .  C ADDR   1359H   R   SEG=MAIN   2235 2282 2721 3307# 3628#
LOADUS . . . . . .  C ADDR   1305H   R   SEG=MAIN   591 1192 1229 1587 1689 2142 2190 2695 2840 3238# 3549#
LOBLOK . . . . . .  C ADDR   115DH   R   SEG=MAIN   2971 3002# 3010
LOCLE. . . . . . .  C ADDR   10B0H   R   SEG=MAIN   2911 2920#
LOD1 . . . . . . .  C ADDR   1368H   R   SEG=MAIN   3315# 3320 3636# 3641
LODT . . . . . . .  C ADDR   1374H   R   SEG=MAIN   3327# 3332 3648# 3653
LOIZMK . . . . . .  C ADDR   0FA6H   R   SEG=MAIN   2753# 2775
LOLEVT . . . . . .  C ADDR   135BH   R   SEG=MAIN   2122 3308# 3629#
LOLIST . . . . . .  C ADDR   10A4H   R   SEG=MAIN   2913#
LOOP . . . . . . .  C ADDR   09BFH   R   SEG=MAIN   1796# 1797
LOOPS. . . . . . .  C ADDR   1969H   R   SEG=MAIN   4419# 4452
LOSPUS . . . . . .  C ADDR   1338H   R   SEG=MAIN   1557 3273# 3588#
LOTEXT . . . . . .  C ADDR   1370H   R   SEG=MAIN   1220 2153 2299 2306 2312 2318 2398 2405 2421 2430 2438 2449 2453
                                           2463 2467 2673 2746 2799 2872 2914 2923 2927 2941 2995 3003 3064 3101 3194
                                           3324# 3645#
LOTP . . . . . . .  C ADDR   17EBH   R   SEG=MAIN   4005# 4015 4018
LOTPUS . . . . . .  C ADDR   17E3H   R   SEG=MAIN   3583 4002#
LOU. . . . . . . .  C ADDR   0BD2H   R   SEG=MAIN   2162 2178 2182#
LOUIZM . . . . . .  C ADDR   0BAFH   R   SEG=MAIN   2162# 2187 3267 3580
LOUTF. . . . . . .  C ADDR   0DA0H   R   SEG=MAIN   2445 2454# 2459 2506 2513
LOVICH . . . . . .  C ADDR   0F9CH   R   SEG=MAIN   2749# 2769 2788 3213
LOWR . . . . . . .  C ADDR   10BEH   R   SEG=MAIN   2920 2925#
LOWR1. . . . . . .  C ADDR   10C0H   R   SEG=MAIN   2926# 2987
LSUB . . . . . . .  C ADDR   1A95H   R   SEG=MAIN   1059 1155 1716 4621#
LTEMP. . . . . . .  N NUMB   0008H   A      984 986 987 988 1926 1929 1932 1935 1978 1979 1980 1981 3837 3838 3839
                                           3840 4036# 4410 4411 4412 4413 4422 4426 4430 4434 4437 4438 4439 4440
                                           4441 4442 4443 4444 4445 4446 4447 4448 4451 4454 4459 4463 4467 4477 4480
                                           4483 4486 4502 4505 4506 4508 4509 4511 4512 4514 4519 4520 4521 4522 4542
                                           4547 4555 4563 4568 4579 4587 4593 4601 4607 4975 4976 5015 5020 5022 5031
                                           5032 5033 5034 5265 5273 5286 5289 5292 5295 5875 5878 5881 5884
LWR. . . . . . . .  C ADDR   0A04H   R   SEG=MAIN   1865# 1869
LWRX . . . . . . .  C ADDR   09C8H   R   SEG=MAIN   1809# 1821
LWTOF. . . . . . .  C ADDR   042FH   A      5760#
MABIN. . . . . . .  D ADDR   006FH   A      303#
MAFORM . . . . . .  C ADDR   0A1FH   R   SEG=MAIN   1308 1873 1878 1883# 1915
MAIN . . . . . . .  C SEG    1AF2H       REL=UNIT   237 294# 434
MANT1. . . . . . .  N NUMB   0002H   A      4973# 5000 5049 5050
MANT2. . . . . . .  N NUMB   0008H   A      4975# 5026 5027 5158 5160 5161 5163 5164 5166 5167 5169 5208 5209 5211
                                           5212 5214 5215 5217 5218 5222 5224 5227 5230 5328 5330 5331 5333 5334 5336
                                           5337 5339 5390 5392 5393 5395 5396 5398 5399 5401 5483 5487 5491 5495 5499
                                           5502 5505 5508
MARK0_8. . . . . .  C ADDR   0CC8H   R   SEG=MAIN   2327 2344#
MARKER . . . . . .  D ADDR   00B2H   A      385# 512 2076 2326 2336 2351 2357 2480 2487 2523 2530 2542 2604 2779 2795
                                           2807 3004 3022 3029 3065 3075 3102 3149 3160 3167 3191 3209 3426 3454 3469
                                           3480
MARLE. . . . . . .  C ADDR   14F8H   R   SEG=MAIN   3083 3466#
MARRI. . . . . . .  C ADDR   1505H   R   SEG=MAIN   2550 3479#
MAS10. . . . . . .  C ADDR   0363H   R   SEG=MAIN   791 803#
MAS20. . . . . . .  C ADDR   03E0H   R   SEG=MAIN   803 856#
MAS5DIV. . . . . .  C ADDR   0509H   R   SEG=MAIN   973 978 983 990#
MASFULL. . . . . .  C ADDR   04DBH   R   SEG=MAIN   962 966#
MASS0. . . . . . .  X ADDR   0080H   A      397 398# 792 797 825 833 904 912 1851
MASS1. . . . . . .  X ADDR   0084H   A      399# 800 822 836 901 915
MASS10 . . . . . .  X ADDR   00A8H   A      408# 877 934
MASS11 . . . . . .  X ADDR   00ACH   A      409# 874 936
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   101

MASS12 . . . . . .  X ADDR   00B0H   A      410# 871 938
MASS13 . . . . . .  X ADDR   00B4H   A      411# 868 940
MASS14 . . . . . .  X ADDR   00B8H   A      412# 865 942
MASS15 . . . . . .  X ADDR   00BCH   A      413# 862 944
MASS16 . . . . . .  X ADDR   00C0H   A      414# 860 946
MASS17 . . . . . .  X ADDR   00C4H   A      415# 858 948
MASS18 . . . . . .  X ADDR   00C8H   A      416# 856 950
MASS19 . . . . . .  X ADDR   00CCH   A      417# 952
MASS2. . . . . . .  X ADDR   0088H   A      400# 819 838 898 917
MASS3. . . . . . .  X ADDR   008CH   A      401# 816 840 895 919
MASS4. . . . . . .  X ADDR   0090H   A      402# 813 842 892 921
MASS5. . . . . . .  X ADDR   0094H   A      403# 810 844 889 923
MASS6. . . . . . .  X ADDR   0098H   A      404# 808 846 887 925
MASS7. . . . . . .  X ADDR   009CH   A      405# 806 848 885 927
MASS8. . . . . . .  X ADDR   00A0H   A      406# 804 850 883 929
MASS9. . . . . . .  X ADDR   00A4H   A      407# 852 880 931
MASX5. . . . . . .  C ADDR   04FFH   R   SEG=MAIN   964 984#
MEAVP. . . . . . .  C ADDR   0F1CH   R   SEG=MAIN   2677 2680#
MECLE. . . . . . .  C ADDR   016FH   R   SEG=MAIN   493# 495
MEFF . . . . . . .  C ADDR   0176H   R   SEG=MAIN   497# 500
MEM12NO. . . . . .  C ADDR   113CH   R   SEG=MAIN   2981 2985#
MIDL . . . . . . .  C ADDR   199CH   R   SEG=MAIN   4414 4449#
MIGN . . . . . . .  C ADDR   14CAH   R   SEG=MAIN   1728 3426#
MIGNN. . . . . . .  C ADDR   14D2H   R   SEG=MAIN   3428 3433#
MLABL2 . . . . . .  C ADDR   1174H   R   SEG=MAIN   2996 3014# 3045
MMM. . . . . . . .  C ADDR   0241H   R   SEG=MAIN   622#
MO220. . . . . . .  C ADDR   0683H   R   SEG=MAIN   1173 1214#
MODF . . . . . . .  B ADDR   00F8H.5 A      233#
MOUTF. . . . . . .  C ADDR   0D36H   R   SEG=MAIN   2409# 2418 2427 2435
MOVE28 . . . . . .  C ADDR   0A8CH   R   SEG=MAIN   1049 1130 1641 1679 1978#
MOVE82 . . . . . .  C ADDR   16E7H   R   SEG=MAIN   3837#
MOVEA3 . . . . . .  C ADDR   06EFH   R   SEG=MAIN   1266 1291#
MOVLEFT. . . . . .  D ADDR   003AH   A      309# 2328 2495 2535 2797 2970 3007 3038 3068 3076 3105 3473
MOVRIG . . . . . .  D ADDR   003BH   A      308# 2488 2492 2531 2969 3006 3030 3034 3067 3080 3104 3482
MSTEN. . . . . . .  B ADDR   00F8H.1 A      229#
MUP1 . . . . . . .  C ADDR   021AH   A      5325# 5368
MUP11. . . . . . .  C ADDR   0257H   A      5372# 5417
MUP2 . . . . . . .  C ADDR   0297H   A      5402 5416#
MUP3 . . . . . . .  C ADDR   026CH   A      5371 5387#
MVV11. . . . . . .  C ADDR   1158H   R   SEG=MAIN   2992 3000#
MVV12. . . . . . .  C ADDR   1170H   R   SEG=MAIN   3000 3009#
N12DELCH . . . . .  C ADDR   0934H   R   SEG=MAIN   1694 1702#
N4DELCH. . . . . .  C ADDR   08E5H   R   SEG=MAIN   1621 1659#
N8DELCH. . . . . .  C ADDR   0922H   R   SEG=MAIN   1659 1694#
NBIMENU. . . . . .  C ADDR   0D3CH   R   SEG=MAIN   2392 2412#
NBLOK. . . . . . .  D ADDR   00C4H   A      391# 3060
NE05 . . . . . . .  C ADDR   0358H   A      5554 5556 5558 5561#
NEXIN. . . . . . .  C ADDR   095AH   R   SEG=MAIN   1731# 1738
NMINUS . . . . . .  C ADDR   05C5H   R   SEG=MAIN   1101 1105#
NNDELCH. . . . . .  C ADDR   08A5H   R   SEG=MAIN   1611 1621#
NNMEMB . . . . . .  C ADDR   0E38H   R   SEG=MAIN   2411 2557#
NNNUL. . . . . . .  C ADDR   0768H   R   SEG=MAIN   1371 1374#
NO . . . . . . . .  C ADDR   1984H   R   SEG=MAIN   4424 4428 4432 4436#
NO0KEY . . . . . .  C ADDR   0253H   R   SEG=MAIN   631 636#
NO11V6 . . . . . .  C ADDR   0C93H   R   SEG=MAIN   2296 2309#
NO12V6 . . . . . .  C ADDR   0CA0H   R   SEG=MAIN   2309 2315#
NO13V6 . . . . . .  C ADDR   0CADH   R   SEG=MAIN   2315 2322#
NO21P7 . . . . . .  C ADDR   12BEH   R   SEG=MAIN   3178 3198#
NO2PARN. . . . . .  C ADDR   06DBH   R   SEG=MAIN   1268 1274#
NO31N. . . . . . .  C ADDR   11E8H   R   SEG=MAIN   3073 3086#
NO3PARN. . . . . .  C ADDR   06D1H   R   SEG=MAIN   1268# 1351
NO4DEL . . . . . .  C ADDR   0880H   R   SEG=MAIN   1561 1592#
NOAVK. . . . . . .  C ADDR   059AH   R   SEG=MAIN   1030 1077#
NOAVP. . . . . . .  C ADDR   0614H   R   SEG=MAIN   1146# 1183 1186
NOBAVP . . . . . .  C ADDR   0785H   R   SEG=MAIN   1386 1390#
NOBEF99. . . . . .  C ADDR   02FCH   R   SEG=MAIN   727 744# 763
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   102

NOBIT. . . . . . .  C ADDR   0245H   A      5340 5354#
NOBITIZM . . . . .  C ADDR   078BH   R   SEG=MAIN   1390 1393#
NOBUF0 . . . . . .  C ADDR   0842H   R   SEG=MAIN   1494 1525#
NOCHI0 . . . . . .  C ADDR   06B2H   R   SEG=MAIN   1174 1240#
NOCHN10. . . . . .  C ADDR   04F7H   R   SEG=MAIN   975 980#
NOCHN2 . . . . . .  C ADDR   04ECH   R   SEG=MAIN   970 975#
NODI2. . . . . . .  C ADDR   0698H   R   SEG=MAIN   1217 1224#
NODI6. . . . . . .  C ADDR   0F2AH   R   SEG=MAIN   2685 2689#
NODI8. . . . . . .  C ADDR   073FH   R   SEG=MAIN   1335 1341#
NODI9. . . . . . .  C ADDR   069DH   R   SEG=MAIN   1226 1229#
NODIS9 . . . . . .  C ADDR   074EH   R   SEG=MAIN   1341 1353#
NOEQU1 . . . . . .  C ADDR   0E1DH   R   SEG=MAIN   2534 2538#
NOEQU2 . . . . . .  C ADDR   11E2H   R   SEG=MAIN   3079 3083#
NOFIZM . . . . . .  C ADDR   0C74H   R   SEG=MAIN   2272 2294#
NOFT1. . . . . . .  C ADDR   0C60H   R   SEG=MAIN   2277 2281#
NOFZ . . . . . . .  C ADDR   083DH   R   SEG=MAIN   1517 1520#
NOH37. . . . . . .  C ADDR   0FADH   R   SEG=MAIN   2742 2758# 2767 2773 2786
NOHNOT1. . . . . .  C ADDR   1069H   R   SEG=MAIN   2823 2862#
NOHNOT2. . . . . .  C ADDR   1061H   R   SEG=MAIN   2856# 2862
NOKORR . . . . . .  C ADDR   052CH   R   SEG=MAIN   1017 1020#
NOLAH. . . . . . .  C ADDR   0F7DH   R   SEG=MAIN   2713 2730#
NOLEV1 . . . . . .  C ADDR   0DC1H   R   SEG=MAIN   2456 2470#
NOM31. . . . . . .  C ADDR   11CBH   R   SEG=MAIN   3043 3071#
NOM32. . . . . . .  C ADDR   121AH   R   SEG=MAIN   3071 3109#
NOM33. . . . . . .  C ADDR   1245H   R   SEG=MAIN   3109 3127#
NOMARL . . . . . .  C ADDR   127AH   R   SEG=MAIN   3150 3154#
NOME11 . . . . . .  C ADDR   112CH   R   SEG=MAIN   2978#
NOMEM11. . . . . .  C ADDR   0D57H   R   SEG=MAIN   2414 2424#
NOMEM12. . . . . .  C ADDR   0D6DH   R   SEG=MAIN   2424 2432#
NOMEMK . . . . . .  C ADDR   1129H   R   SEG=MAIN   2882 2975#
NON1C. . . . . . .  C ADDR   0C3CH   R   SEG=MAIN   2251 2255#
NONULAVT . . . . .  C ADDR   0582H   R   SEG=MAIN   1025 1064#
NONULDEL . . . . .  C ADDR   0867H   R   SEG=MAIN   1544 1560#
NOP3_0 . . . . . .  C ADDR   06B6H   R   SEG=MAIN   1246#
NOPART1. . . . . .  C ADDR   0300H   R   SEG=MAIN   716 751#
NOPART2. . . . . .  C ADDR   0320H   R   SEG=MAIN   751 770#
NOPART3. . . . . .  C ADDR   0325H   R   SEG=MAIN   770 773#
NOPART4. . . . . .  C ADDR   0338H   R   SEG=MAIN   773 782#
NOPLUS . . . . . .  C ADDR   0CEEH   R   SEG=MAIN   2368 2371#
NOPOIN7. . . . . .  C ADDR   128CH   R   SEG=MAIN   3148 3173#
NOPOINT. . . . . .  C ADDR   1268H   R   SEG=MAIN   3143 3146#
NOR11. . . . . . .  C ADDR   0D02H   R   SEG=MAIN   2303 2382#
NOR13. . . . . . .  C ADDR   0C86H   R   SEG=MAIN   2303#
NORDN. . . . . . .  C ADDR   00F6H   A      5061# 5094
NORDN1 . . . . . .  C ADDR   0107H   A      5063 5077#
NORIG2 . . . . . .  C ADDR   0DFAH   R   SEG=MAIN   2502 2510#
NORIM6 . . . . . .  C ADDR   0E38H   R   SEG=MAIN   2402 2558#
NORM1. . . . . . .  C ADDR   00F0H   A      5056# 5253 5430 5532 5749
NORR11 . . . . . .  C ADDR   0FBDH   R   SEG=MAIN   2765#
NORR12 . . . . . .  C ADDR   0FCAH   R   SEG=MAIN   2765 2771# 2784
NORUP. . . . . . .  C ADDR   0119H   A      5060 5097#
NORUP1 . . . . . .  C ADDR   011EH   A      5102# 5120
NORUP2 . . . . . .  C ADDR   0132H   A      5104 5121#
NORVICH. . . . . .  C ADDR   079DH   R   SEG=MAIN   1350 1401#
NOSUB. . . . . . .  C ADDR   19BFH   R   SEG=MAIN   4458 4462 4466 4471#
NOT1IN . . . . . .  C ADDR   0845H   R   SEG=MAIN   1498 1529#
NOT1_7 . . . . . .  C ADDR   0EF1H   R   SEG=MAIN   2652 2659#
NOT2IN . . . . . .  C ADDR   084DH   R   SEG=MAIN   1529 1533#
NOT2_7 . . . . . .  C ADDR   0EFCH   R   SEG=MAIN   2659 2664#
NOT3IN . . . . . .  C ADDR   0855H   R   SEG=MAIN   1533 1536#
NOTAKT . . . . . .  C ADDR   0795H   R   SEG=MAIN   1394 1398#
NOTT1. . . . . . .  C ADDR   0828H   R   SEG=MAIN   1504 1508#
NOTT5. . . . . . .  C ADDR   082DH   R   SEG=MAIN   1508 1512#
NOT_1. . . . . . .  C ADDR   0C46H   R   SEG=MAIN   2255 2256 2267#
NOT_10 . . . . . .  C ADDR   0C46H   R   SEG=MAIN   2266#
NOVIR. . . . . . .  C ADDR   0D0FH   R   SEG=MAIN   2293 2392#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   103

NOVIR1 . . . . . .  C ADDR   0C71H   R   SEG=MAIN   2293# 2294
NOZZMI . . . . . .  C ADDR   072FH   R   SEG=MAIN   1330 1332#
NSEC01 . . . . . .  C ADDR   0771H   R   SEG=MAIN   1375 1378#
NSEC1. . . . . . .  C ADDR   0778H   R   SEG=MAIN   1378 1381#
NSEC10 . . . . . .  C ADDR   077DH   R   SEG=MAIN   1377 1380 1381 1385#
NULAVT . . . . . .  C ADDR   0892H   R   SEG=MAIN   1609#
NUMSIZE. . . . . .  N NUMB   0004H   A      4039# 4061 4099 4106 4181 4201
OBOARD . . . . . .  C ADDR   18F5H   R   SEG=MAIN   4282 4296#
OBOARD1. . . . . .  C ADDR   193DH   R   SEG=MAIN   4355 4368#
OK1. . . . . . . .  C ADDR   0186H   A      5187 5202#
OK2. . . . . . . .  C ADDR   01A0H   A      5204 5219#
OK3. . . . . . . .  C ADDR   01C4H   A      5236 5252#
ONBOAR1. . . . . .  C ADDR   191BH   R   SEG=MAIN   4317 4334#
ONBOARD. . . . . .  C ADDR   18CFH   R   SEG=MAIN   4246 4260#
ONMEM11. . . . . .  C ADDR   1082H   R   SEG=MAIN   2675 2679 2681 2876#
ONMIG. . . . . . .  C ADDR   14E0H   R   SEG=MAIN   3437 3446#
ONVICH . . . . . .  C ADDR   0BA7H   R   SEG=MAIN   2145 2157#
OSCICN . . . . . .  D ADDR   00B2H   A      64# 473
OSCXCN . . . . . .  D ADDR   00B1H   A      63# 466 470
OUT6 . . . . . . .  C ADDR   0E38H   R   SEG=MAIN   2053 2215 2220 2225 2242 2279 2284 2291 2391 2400 2407 2559#
OUT7 . . . . . . .  C ADDR   12DEH   R   SEG=MAIN   2580 2581 2656 2663 2667 2718 2723 3170 3175 3216#
OUTF . . . . . . .  C ADDR   0C67H   R   SEG=MAIN   2275 2287# 2300 2307 2313 2319 2342 2361 2370 2373 2380 2409 2422
                                           2431 2439 2450 2454 2464 2468 2494 2497 2537 2551 2554
OUTFL. . . . . . .  C ADDR   0CFFH   R   SEG=MAIN   2376 2380#
OUTMA. . . . . . .  C ADDR   0CD9H   R   SEG=MAIN   2360 2361#
OV . . . . . . . .  B ADDR   00D0H.2 A      201# 4238
P. . . . . . . . .  B ADDR   00D0H.0 A      199#
P0 . . . . . . . .  D ADDR   0080H   A      16# 1731 1735
P0MDOUT. . . . . .  D ADDR   00A4H   A      50# 444
P1 . . . . . . . .  D ADDR   0090H   A      32# 594 595 1744 1746 1749 1752 1756 1758 1759 2008 2011 2013 2016 2022
                                           2024 2026 3381 3388 3904 3911
P1MDIN . . . . . .  D ADDR   00BDH   A      73#
P1MDOUT. . . . . .  D ADDR   00A5H   A      51# 445
P2 . . . . . . . .  D ADDR   00A0H   A      47# 1777 1781 1790
P2MDOUT. . . . . .  D ADDR   00A6H   A      52# 446
P3 . . . . . . . .  D ADDR   00B0H   A      62# 455 1776 1778 1780 1786 1787 1788 1791 1792 2082 2084 2086 2087 2090
                                           2091 2093 2094 2096 2097 2099 2100 2102 2103 2105 2106 2273 2274 2322 2323
                                           2363 2364 2374 2375 2393 2394 2416 2417 2425 2426 2433 2434 2443 2444 2457
                                           2458 2471 2472 2505 2506 2514 2515 2552 2553 2575 2611 2613 2615 2616 2619
                                           2620 2622 2623 2625 2626 2628 2629 2631 2632 2634 2635 2714 2716 2741 2742
                                           2758 2759 2766 2767 2772 2773 2785 2786 2821 2822 2908 2909 2936 2937 2951
                                           2952 2953 2954 2960 2961 2978 2979 2989 2990 3044 3045 3046 3047 3072 3073
                                           3086 3087 3110 3111 3112 3113 3128 3129 3130 3131 3141 3142 3146 3147 3173
                                           3174 3232
P3IF . . . . . . .  D ADDR   00ADH   A      59# 2572 2574 3229 3231
P3MDOUT. . . . . .  D ADDR   00A7H   A      53# 448
P4 . . . . . . . .  D ADDR   0084H   A      20# 2169 2171 3245 3248 3264 3266 3558 3561 3577 3579 4007
P5 . . . . . . . .  D ADDR   0085H   A      21# 518 526 1612 1617 1652 1654 2179 2181 3253 3256 3284 3287 3566 3569
                                           3599 3602 4011
P6 . . . . . . . .  D ADDR   0086H   A      22# 596 598 602 604
P7 . . . . . . . .  D ADDR   0096H   A      38#
P74OUT . . . . . .  D ADDR   00B5H   A      65# 449
PACK1. . . . . . .  C ADDR   00DEH   A      5039# 5254 5431 5533 5750
PARN . . . . . . .  D ADDR   00AFH   A      382# 523 1364 2198 2246 2640 2846
PART . . . . . . .  D ADDR   009AH   A      372# 519 714 1004 1037 1064 1077 1374 1402 1502 1513 2209 2247 2650 2831
                                           2845 3257 3408 3570 3931
PCA0CN . . . . . .  D ADDR   00D8H   A      99# 209 210 211 212 213 214 215
PCA0CPH0 . . . . .  D ADDR   00FAH   A      132#
PCA0CPH1 . . . . .  D ADDR   00FBH   A      133#
PCA0CPH2 . . . . .  D ADDR   00FCH   A      134#
PCA0CPH3 . . . . .  D ADDR   00FDH   A      135#
PCA0CPH4 . . . . .  D ADDR   00FEH   A      136#
PCA0CPL0 . . . . .  D ADDR   00EAH   A      116#
PCA0CPL1 . . . . .  D ADDR   00EBH   A      117#
PCA0CPL2 . . . . .  D ADDR   00ECH   A      118#
PCA0CPL3 . . . . .  D ADDR   00EDH   A      119#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   104

PCA0CPL4 . . . . .  D ADDR   00EEH   A      120#
PCA0CPM0 . . . . .  D ADDR   00DAH   A      101#
PCA0CPM1 . . . . .  D ADDR   00DBH   A      102#
PCA0CPM2 . . . . .  D ADDR   00DCH   A      103#
PCA0CPM3 . . . . .  D ADDR   00DDH   A      104#
PCA0CPM4 . . . . .  D ADDR   00DEH   A      105#
PCA0H. . . . . . .  D ADDR   00F9H   A      131#
PCA0L. . . . . . .  D ADDR   00E9H   A      115# 442
PCA0MD . . . . . .  D ADDR   00D9H   A      100# 443
PCON . . . . . . .  D ADDR   0087H   A      23#
PROD . . . . . . .  N NUMB   000CH   A      4976# 5320 5321 5322 5323 5343 5344 5345 5347 5348 5350 5351 5353 5375
                                           5377 5378 5380 5381 5383 5384 5386 5405 5406 5407 5409 5410 5412 5413 5415
                                           5426 5427 5428 5429 5450 5451 5452 5453 5469 5471 5472 5474 5475 5477 5478
                                           5480 5510 5527 5528 5529 5530
PS . . . . . . . .  B ADDR   00B8H.4 A      176#
PSCTL. . . . . . .  D ADDR   008FH   A      31# 5781 5785 5838 5841
PSW. . . . . . . .  D ADDR   00D0H   A      91# 199 200 201 202 203 204 205 206 1917 1919 2062 2568 2588 3227 4711
                                           4719
PT0. . . . . . . .  B ADDR   00B8H.1 A      173#
PT1. . . . . . . .  B ADDR   00B8H.3 A      175#
PT2. . . . . . . .  B ADDR   00B8H.5 A      177#
PX0. . . . . . . .  B ADDR   00B8H.0 A      172#
PX1. . . . . . . .  B ADDR   00B8H.2 A      174#
PYSKST . . . . . .  C ADDR   0B5BH   R   SEG=MAIN   2104 2110#
R10. . . . . . . .  N NUMB   000AH   A      429# 627 1026 3524 3979 5804
R11. . . . . . . .  N NUMB   000BH   A      430# 628 1027 3528 3983 5808
R8 . . . . . . . .  N NUMB   0008H   A      427# 2042 3516 3971 5796
R9 . . . . . . . .  N NUMB   0009H   A      428# 2043 3520 3975 5800
RAFTERK. . . . . .  C ADDR   0542H   R   SEG=MAIN   1034# 1040
RB8. . . . . . . .  B ADDR   0098H.2 A      155#
RCAP2H . . . . . .  D ADDR   00CBH   A      87#
RCAP2L . . . . . .  D ADDR   00CAH   A      86#
RCAP4H . . . . . .  D ADDR   00E5H   A      111#
RCAP4L . . . . . .  D ADDR   00E4H   A      110#
RCLK . . . . . . .  B ADDR   00C8H.5 A      194#
RE1. . . . . . . .  C ADDR   0AC1H   R   SEG=MAIN   2022# 2028
RE4BYTE. . . . . .  C ADDR   0454H   A      5792#
REACP. . . . . . .  D ADDR   0077H   A      304# 609 611 613 615 655 671 679 687 696 703 718 754 774 783 1626 1628
                                           1630 1632 1664 1666 1668 1670
READ . . . . . . .  C ADDR   0ABFH   R   SEG=MAIN   608 610 612 2021#
READYACP . . . . .  C ADDR   02B7H   R   SEG=MAIN   697 707#
READ_X2. . . . . .  C ADDR   09AEH   R   SEG=MAIN   1785# 1796
REBYTE . . . . . .  C ADDR   020CH   R   SEG=MAIN   593# 638 745 1590 1600 1619 1657 1692 1701 1703
REBYTE2. . . . . .  C ADDR   046CH   A      1043 1124 5812#
REF0CN . . . . . .  D ADDR   00D1H   A      92# 450
REN. . . . . . . .  B ADDR   0098H.4 A      157#
RESAR2 . . . . . .  C ADDR   0A98H   R   SEG=MAIN   719 755 775 784 796 831 910 1052 1093 1132 1149 1203 1254 1302
                                           1306 1564 1986# 2701
RESAR8 . . . . . .  C ADDR   0A56H   R   SEG=MAIN   1058 1096 1105 1154 1205 1208 1639 1677 1925#
REZAM. . . . . . .  D ADDR   008CH   A      368# 1674
REZAP. . . . . . .  D ADDR   0088H   A      367# 1636
REZMUL . . . . . .  C ADDR   05ADH   R   SEG=MAIN   1072 1084 1091#
REZ_A. . . . . . .  D ADDR   0062H   A      357# 732 776 785 795 830 909 1563
REZ_A0 . . . . . .  D ADDR   006AH   A      359# 1057 1153 1197 1235 2140 2693 2702 2709
REZ_A1 . . . . . .  D ADDR   0066H   A      358# 998 1055 1092 1137 1148 1204
REZ_A2 . . . . . .  D ADDR   007BH   A      360# 1150 1210
REZ_A3 . . . . . .  D ADDR   009CH   A      374# 1060 1156 1253 1301 1305 1407 2700
REZ_AME. . . . . .  D ADDR   005EH   A      355# 1010 1051 1109 1131
REZ_DEL. . . . . .  D ADDR   00C5H   A      392# 734
RGOTO7 . . . . . .  C ADDR   11C8H   R   SEG=MAIN   3069# 3087 3113
RHNOT1 . . . . . .  C ADDR   0F74H   R   SEG=MAIN   2716 2725#
RI . . . . . . . .  B ADDR   0098H.0 A      153#
RIGBLO . . . . . .  C ADDR   0DC4H   R   SEG=MAIN   2471# 2501 2503
RIGBLOK. . . . . .  C ADDR   0E00H   R   SEG=MAIN   2514#
RIGHT2 . . . . . .  C ADDR   0B6FH   R   SEG=MAIN   2117 2121#
RIGHT3 . . . . . .  C ADDR   0B73H   R   SEG=MAIN   2119 2124#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   105

RIMEN6 . . . . . .  C ADDR   0D2BH   R   SEG=MAIN   2396 2404#
RIZMAN . . . . . .  C ADDR   0AF0H   R   SEG=MAIN   2057# 2092
RKNLEFT. . . . . .  C ADDR   0E6AH   R   SEG=MAIN   2584# 2627
RKNMEM . . . . . .  C ADDR   0E5BH   R   SEG=MAIN   2579# 2633
RKNNUL . . . . . .  C ADDR   0E67H   R   SEG=MAIN   2583# 2621
RKNOPT . . . . . .  C ADDR   0AEDH   R   SEG=MAIN   2056# 2101
RKNRAZR. . . . . .  C ADDR   0AEAH   R   SEG=MAIN   2055# 2095
RKVVOD0. . . . . .  C ADDR   10ADH   R   SEG=MAIN   2910 2917#
RLABELF. . . . . .  C ADDR   0AE7H   R   SEG=MAIN   2054# 2089
RLABELH. . . . . .  C ADDR   0E64H   R   SEG=MAIN   2582# 2618
RLABELI. . . . . .  C ADDR   0F7AH   R   SEG=MAIN   2728# 2771
RLABELK. . . . . .  C ADDR   0F77H   R   SEG=MAIN   2727# 2730
RLABELL1 . . . . .  C ADDR   0E35H   R   SEG=MAIN   2553 2556#
RLABL2 . . . . . .  C ADDR   10EFH   R   SEG=MAIN   2947# 2952
RLABM. . . . . . .  C ADDR   10F2H   R   SEG=MAIN   2948# 2950
RLER . . . . . . .  C ADDR   1504H   R   SEG=MAIN   3474 3476#
RMO220 . . . . . .  C ADDR   0636H   R   SEG=MAIN   1173#
RNNMEMB. . . . . .  C ADDR   0D39H   R   SEG=MAIN   2411# 2412
RNO3PARN . . . . .  C ADDR   074CH   R   SEG=MAIN   1351# 1365
RNOCHI0. . . . . .  C ADDR   0638H   R   SEG=MAIN   1161 1174#
RNOMEMK. . . . . .  C ADDR   108CH   R   SEG=MAIN   2882# 2905
RNORIM6. . . . . .  C ADDR   0D28H   R   SEG=MAIN   2394 2402#
RNORVICH . . . . .  C ADDR   074AH   R   SEG=MAIN   1296 1297 1350#
RNOT1IN. . . . . .  C ADDR   081BH   R   SEG=MAIN   1404 1498#
ROUT6. . . . . . .  C ADDR   0AE4H   R   SEG=MAIN   2053# 2083 2088
ROUT7. . . . . . .  C ADDR   0E61H   R   SEG=MAIN   2581# 2612 2617
ROUTF. . . . . . .  C ADDR   0FBAH   R   SEG=MAIN   2759 2763# 2822
RR0. . . . . . . .  N NUMB   0000H   A      420# 2063 2567 2589 3226
RR1. . . . . . . .  N NUMB   0001H   A      421# 2064 2566 2590 3225
RR2. . . . . . . .  N NUMB   0002H   A      423# 1712 2065 2565 2591 3224
RR3. . . . . . . .  N NUMB   0003H   A      424# 1713 2066 2564 2592 3223
RR4. . . . . . . .  N NUMB   0004H   A      2067 2563 2593 3222 4040# 4097 4118 4134 4178 4200
RR5. . . . . . . .  N NUMB   0005H   A      2068 2562 2594 3221 4041# 4098 4105 4112 4179 4188
RR6. . . . . . . .  N NUMB   0006H   A      422# 2069 2561 2595 3220
RR7. . . . . . . .  N NUMB   0007H   A      425# 2070 2560 2596 3219
RRIR . . . . . . .  C ADDR   1511H   R   SEG=MAIN   3485 3487#
RS0. . . . . . . .  B ADDR   00D0H.3 A      202#
RS1. . . . . . . .  B ADDR   00D0H.4 A      203#
RSEEIND. . . . . .  C ADDR   06E4H   R   SEG=MAIN   1280# 1298
RSTSRC . . . . . .  D ADDR   00EFH   A      121# 480
RTIZMRI. . . . . .  C ADDR   0C4AH   R   SEG=MAIN   2270#
RXOVRN . . . . . .  B ADDR   00F8H.4 A      232#
SADDR0 . . . . . .  D ADDR   00A9H   A      55#
SADDR1 . . . . . .  D ADDR   00F3H   A      125#
SADEN0 . . . . . .  D ADDR   00B9H   A      69#
SADEN1 . . . . . .  D ADDR   00AEH   A      60#
SAVBA. . . . . . .  D ADDR   003CH   A      307# 2080 2341 2356 2485 2528 2548 2608 3027 3165 3438 3446
SAVEIR2. . . . . .  C ADDR   09DAH   R   SEG=MAIN   798 834 913 1824#
SAVELTE. . . . . .  C ADDR   04A7H   A      5875#
SAVER2 . . . . . .  C ADDR   09E6H   R   SEG=MAIN   535 537 539 723 733 735 759 777 786 999 1011 1056 1061 1110 1138
                                           1151 1157 1211 1310 1576 1637 1649 1675 1687 1838# 2703 2710 3189 3207
SBUF0. . . . . . .  D ADDR   0099H   A      40#
SBUF1. . . . . . .  D ADDR   00F2H   A      124#
SCON0. . . . . . .  D ADDR   0098H   A      39# 153 154 155 156 157 158 159 160
SCON1. . . . . . .  D ADDR   00F1H   A      123#
SDV. . . . . . . .  C ADDR   0970H   R   SEG=MAIN   1744# 1751
SDV1 . . . . . . .  C ADDR   0984H   R   SEG=MAIN   1756# 1762
SDVIG0 . . . . . .  C ADDR   0298H   R   SEG=MAIN   683# 685
SDVIG1 . . . . . .  C ADDR   028DH   R   SEG=MAIN   675# 677
SDVIG2 . . . . . .  C ADDR   0282H   R   SEG=MAIN   667# 669
SDVIG3 . . . . . .  C ADDR   0276H   R   SEG=MAIN   658# 660
SDVIG4 . . . . . .  C ADDR   02A7H   R   SEG=MAIN   693# 695
SDVIG6 . . . . . .  C ADDR   02B1H   R   SEG=MAIN   700# 702
SDVM . . . . . . .  C ADDR   02AFH   R   SEG=MAIN   690 699#
SEEGOON. . . . . .  C ADDR   0751H   R   SEG=MAIN   1340 1348 1355#
SEEIND . . . . . .  C ADDR   075FH   R   SEG=MAIN   1272 1279 1280 1368#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   106

SI . . . . . . . .  B ADDR   00C0H.3 A      183#
SIGN . . . . . . .  N NUMB   0007H   A      4971# 4992 4993 5018 5019 5043 5186 5203 5424 5464
SLVSEL . . . . . .  B ADDR   00F8H.2 A      230#
SM0. . . . . . . .  B ADDR   0098H.7 A      160#
SM1. . . . . . . .  B ADDR   0098H.6 A      159#
SM2. . . . . . . .  B ADDR   0098H.5 A      158#
SMB0ADR. . . . . .  D ADDR   00C3H   A      79#
SMB0CN . . . . . .  D ADDR   00C0H   A      76# 180 181 182 183 184 185 186
SMB0CR . . . . . .  D ADDR   00CFH   A      90#
SMB0DAT. . . . . .  D ADDR   00C2H   A      78#
SMB0STA. . . . . .  D ADDR   00C1H   A      77#
SMBFTE . . . . . .  B ADDR   00C0H.1 A      181#
SMBTOE . . . . . .  B ADDR   00C0H.0 A      180#
SOOTV. . . . . . .  C ADDR   1019H   R   SEG=MAIN   2817# 2832
SP . . . . . . . .  D ADDR   0081H   A      17# 441
SPI0CFG. . . . . .  D ADDR   009AH   A      41#
SPI0CKR. . . . . .  D ADDR   009DH   A      44# 486
SPI0CN . . . . . .  D ADDR   00F8H   A      130# 228 229 230 231 232 233 234 235 485
SPI0DAT. . . . . .  D ADDR   009BH   A      42# 1733
SPIEN. . . . . . .  B ADDR   00F8H.0 A      228#
SPIF . . . . . . .  B ADDR   00F8H.7 A      235#
SS1. . . . . . . .  C ADDR   1608H   R   SEG=MAIN   3680# 3682
STA. . . . . . . .  B ADDR   00C0H.5 A      185#
STO. . . . . . . .  B ADDR   00C0H.4 A      184#
SUMMA. . . . . . .  D ADDR   00B3H   A      386# 720 722 737 756 758 1195 1233 2138 2691
SUMT2. . . . . . .  C ADDR   0303H   R   SEG=MAIN   711 753#
T2CON. . . . . . .  D ADDR   00C8H   A      84# 189 190 191 192 193 194 195 196
T4CON. . . . . . .  D ADDR   00C9H   A      85#
TABB1_2. . . . . .  C ADDR   14ADH   R   SEG=MAIN   3399# 3409 3922# 3932
TABN . . . . . . .  C ADDR   1802H   R   SEG=MAIN   4024# 4028
TABT11 . . . . . .  C ADDR   15C6H   R   SEG=MAIN   3619# 4004
TABT7. . . . . . .  C ADDR   15CAH   R   SEG=MAIN   3623# 4017
TABT9. . . . . . .  C ADDR   15C8H   R   SEG=MAIN   3621# 4014
TABUS. . . . . . .  C ADDR   1345H   R   SEG=MAIN   3242 3293# 3555 3608#
TAKTIND. . . . . .  C ADDR   079AH   R   SEG=MAIN   1397 1400#
TB8. . . . . . . .  B ADDR   0098H.3 A      156#
TCLK . . . . . . .  B ADDR   00C8H.4 A      193#
TCON . . . . . . .  D ADDR   0088H   A      24# 143 144 145 146 147 148 149 150 477 478
TE22 . . . . . . .  C ADDR   17F5H   R   SEG=MAIN   4003 4013#
TE23 . . . . . . .  C ADDR   17FDH   R   SEG=MAIN   4013 4017#
TEAEQU0. . . . . .  C ADDR   13C2H   R   SEG=MAIN   2798 3345#
TEBBL. . . . . . .  C ADDR   1458H   R   SEG=MAIN   3063 3362#
TEBEQU0. . . . . .  C ADDR   13CCH   R   SEG=MAIN   3193 3346#
TEBL . . . . . . .  C ADDR   144EH   R   SEG=MAIN   2940 3361#
TEBLOK . . . . . .  C ADDR   1444H   R   SEG=MAIN   3002 3360#
TECLE. . . . . . .  C ADDR   1413H   R   SEG=MAIN   2437 2871 2922 3355#
TEEBL. . . . . . .  C ADDR   1462H   R   SEG=MAIN   3100 3363#
TEFULL . . . . . .  C ADDR   143AH   R   SEG=MAIN   2994 3359#
TEIZMK . . . . . .  C ADDR   13F5H   R   SEG=MAIN   2298 2305 2754 3352#
TEKALIB. . . . . .  C ADDR   13EAH   R   SEG=MAIN   2397 3351#
TELIST . . . . . .  C ADDR   142FH   R   SEG=MAIN   2429 2913 3358#
TEMEM. . . . . . .  C ADDR   141DH   R   SEG=MAIN   3356#
TEMENU . . . . . .  C ADDR   13D6H   R   SEG=MAIN   2672 3347#
TENMIN . . . . . .  C ADDR   1675H   R   SEG=MAIN   1069 1071 1083 3725#
TEOLL. . . . . . .  C ADDR   1409H   R   SEG=MAIN   1219 3354#
TEOUT. . . . . . .  C ADDR   13FFH   R   SEG=MAIN   2311 2384 2745 3353#
TETEST . . . . . .  C ADDR   13E0H   R   SEG=MAIN   2404 3349#
TEVICH . . . . . .  C ADDR   13B8H   R   SEG=MAIN   2152 2317 2750 3344#
TEWR . . . . . . .  C ADDR   1425H   R   SEG=MAIN   2420 2926 3357#
TEXTT. . . . . . .  C ADDR   137CH   R   SEG=MAIN   3314 3335# 3635
TF0. . . . . . . .  B ADDR   0088H.5 A      148#
TF1. . . . . . . .  B ADDR   0088H.7 A      150#
TF2. . . . . . . .  B ADDR   00C8H.7 A      196#
TH0. . . . . . . .  D ADDR   008CH   A      28# 460
TH1. . . . . . . .  D ADDR   008DH   A      29#
TH2. . . . . . . .  D ADDR   00CDH   A      89#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   107

TH4. . . . . . . .  D ADDR   00F5H   A      127#
TI . . . . . . . .  B ADDR   0098H.1 A      154#
TIM. . . . . . . .  C ADDR   0994H   R   SEG=MAIN   1765#
TIM1 . . . . . . .  C ADDR   0996H   R   SEG=MAIN   1766# 1766
TIM2 . . . . . . .  C ADDR   0999H   R   SEG=MAIN   1747 1750 1757 1761 1769# 2012 2014 2023 2027
TIM3 . . . . . . .  C ADDR   099BH   R   SEG=MAIN   1770# 1770
TIZMRI . . . . . .  C ADDR   0B68H   R   SEG=MAIN   2116# 2270
TL0. . . . . . . .  D ADDR   008AH   A      26# 461
TL1. . . . . . . .  D ADDR   008BH   A      27#
TL2. . . . . . . .  D ADDR   00CCH   A      88#
TL4. . . . . . . .  D ADDR   00F4H   A      126#
TLABELI. . . . . .  C ADDR   1016H   R   SEG=MAIN   2802 2814#
TMOD . . . . . . .  D ADDR   0089H   A      25# 458
TMR2RLH. . . . . .  D ADDR   00CBH   A      292# 475
TMR2RLL. . . . . .  D ADDR   00CAH   A      291# 474
TMR3CN . . . . . .  D ADDR   0091H   A      33#
TMR3H. . . . . . .  D ADDR   0095H   A      37#
TMR3L. . . . . . .  D ADDR   0094H   A      36#
TMR3RLH. . . . . .  D ADDR   0093H   A      35#
TMR3RLL. . . . . .  D ADDR   0092H   A      34#
TR0. . . . . . . .  B ADDR   0088H.4 A      147#
TR1. . . . . . . .  B ADDR   0088H.6 A      149#
TR2. . . . . . . .  B ADDR   00C8H.2 A      191#
TXBSY. . . . . . .  B ADDR   00F8H.3 A      231# 1734
UNPACK1. . . . . .  C ADDR   009EH   A      4989# 5183 5317 5447 5561
UNPACK2. . . . . .  C ADDR   00BAH   A      5014# 5184 5318 5448
UP1. . . . . . . .  C ADDR   0138H   A      5134# 5151
UP2. . . . . . . .  C ADDR   014BH   A      5154# 5172
UP2A . . . . . . .  C ADDR   0161H   A      5133 5170#
UPA. . . . . . . .  C ADDR   16A4H   R   SEG=MAIN   3778# 3784
UPA1 . . . . . . .  C ADDR   16B4H   R   SEG=MAIN   3796# 3802
UPA2 . . . . . . .  C ADDR   1694H   R   SEG=MAIN   3761# 3767
UPAA . . . . . . .  C ADDR   16F6H   R   SEG=MAIN   3850# 3856
UPAB . . . . . . .  C ADDR   1706H   R   SEG=MAIN   3867# 3873
UPAK . . . . . . .  C ADDR   169EH   R   SEG=MAIN   3182 3200 3775#
UPAK2. . . . . . .  C ADDR   168EH   R   SEG=MAIN   3054 3758#
UPAK3. . . . . . .  C ADDR   16AEH   R   SEG=MAIN   3093 3119 3793#
UPAKA. . . . . . .  C ADDR   16F0H   R   SEG=MAIN   3847#
UPAKB. . . . . . .  C ADDR   1700H   R   SEG=MAIN   3864#
VICHR. . . . . . .  D ADDR   00B1H   A      384# 2149 2158 2295 2739 2790 3176 3211 4002
VIG0 . . . . . . .  C ADDR   07E2H   R   SEG=MAIN   1458# 1460
VIG4 . . . . . . .  C ADDR   07F0H   R   SEG=MAIN   1469# 1471
VIOUT. . . . . . .  C ADDR   0C21H   R   SEG=MAIN   2155 2238#
VVCHIF . . . . . .  C ADDR   14E8H   R   SEG=MAIN   2378 3453#
VVIZKO . . . . . .  C ADDR   0FEFH   R   SEG=MAIN   2760 2790#
VVRR6. . . . . . .  C ADDR   0C7EH   R   SEG=MAIN   2298#
WCOL . . . . . . .  B ADDR   00F8H.6 A      234#
WDTCN. . . . . . .  D ADDR   00FFH   A      137# 456 457
WORK . . . . . . .  D ADDR   00B8H   A      388# 1409 1484
WR1. . . . . . . .  C ADDR   0AACH   R   SEG=MAIN   2008# 2015
WRITE. . . . . . .  C ADDR   0AA9H   R   SEG=MAIN   606 2006# 3370 3372 3374 3376 3378 3380 3383 3385 3387 3390 3392
                                           3394 3893 3895 3897 3899 3901 3903 3906 3908 3910 3913 3915 3917
WRITED_X1. . . . .  C ADDR   099FH   R   SEG=MAIN   1775#
WRITE_X1 . . . . .  C ADDR   099EH   R   SEG=MAIN   1774#
WRPAGE . . . . . .  C ADDR   0480H   A      5836#
WW5. . . . . . . .  C ADDR   0483H   A      5837# 5845
XBR0 . . . . . . .  D ADDR   00E1H   A      107# 452 484
XBR1 . . . . . . .  D ADDR   00E2H   A      108# 453
XBR2 . . . . . . .  D ADDR   00E3H   A      109# 454 483
XCIKLWR. . . . . .  C ADDR   09C6H   R   SEG=MAIN   793 805 807 809 812 815 818 821 824 827 857 859 861 864 867 870
                                           873 876 879 881 884 886 888 891 894 897 900 903 906 1807#
XTEMP. . . . . . .  N NUMB   000CH   A      4037# 4401 4402 4403 4404 4490 4492 4493 4495 4496 4498 4499 4501 4523
                                           4524 4525 4526 4544 4545 4549 4550 4553 4557 4558 4561 4565 4566 4570 4571
                                           4573 4574 4575 4577 4581 4582 4584 4585 4589 4590 4595 4596 4598 4599 4603
                                           4604 4609 4611 4612 4613
YBNUL. . . . . . .  C ADDR   0F4DH   R   SEG=MAIN   2698 2706#
A51 MACRO ASSEMBLER  AMP21                                                                01/17/2007 14:24:05 PAGE   108

YES. . . . . . . .  C ADDR   19A2H   R   SEG=MAIN   4423 4427 4431 4435 4453# 4516
YESAVP . . . . . .  C ADDR   063AH   R   SEG=MAIN   1145 1177#
YESBUF . . . . . .  C ADDR   081FH   R   SEG=MAIN   1496 1501#
YESPRD . . . . . .  C ADDR   081DH   R   SEG=MAIN   1495 1499#
YESTEST. . . . . .  C ADDR   15A1H   R   SEG=MAIN   3582#
YESTT5 . . . . . .  C ADDR   0840H   R   SEG=MAIN   1516 1523#
YESVICH. . . . . .  C ADDR   0667H   R   SEG=MAIN   1146 1201#
YESVIR . . . . . .  C ADDR   0D07H   R   SEG=MAIN   2389#
Z01S . . . . . . .  C ADDR   1620H   R   SEG=MAIN   3697# 3699
Z100 . . . . . . .  C ADDR   15F1H   R   SEG=MAIN   3661# 3663
Z15. . . . . . . .  C ADDR   15FFH   R   SEG=MAIN   3673# 3675
Z1S. . . . . . . .  C ADDR   1613H   R   SEG=MAIN   3689# 3691
ZAPADC . . . . . .  C ADDR   096EH   R   SEG=MAIN   1743#
ZCMP . . . . . . .  C ADDR   0A48H   R   SEG=MAIN   1915#
ZDIV . . . . . . .  C ADDR   0A15H   R   SEG=MAIN   731 991 1257 1878#
ZER1 . . . . . . .  C ADDR   00B3H   A      4999 5003# 5058 5101
ZER2 . . . . . . .  C ADDR   00D4H   A      5025 5029#
ZMUL . . . . . . .  C ADDR   0A0BH   R   SEG=MAIN   1873#
ZNMAT. . . . . . .  B ADDR   0020H.2 A      316# 1330 1886 1889 1892
ZNPLUS . . . . . .  C ADDR   0269H   R   SEG=MAIN   617 647#
ZZ . . . . . . . .  C ADDR   1601H   R   SEG=MAIN   3674# 3674
Z_01S. . . . . . .  C ADDR   161CH   R   SEG=MAIN   642 643 644 1518 2073 2601 3450 3695#
Z_100. . . . . . .  C ADDR   15EFH   R   SEG=MAIN   3660#
Z_15 . . . . . . .  C ADDR   15FDH   R   SEG=MAIN   585 3672#
Z_1MS. . . . . . .  C ADDR   1606H   R   SEG=MAIN   3679#
Z_1S . . . . . . .  C ADDR   160FH   R   SEG=MAIN   552 560 3687#
Z_5. . . . . . . .  C ADDR   15F8H   R   SEG=MAIN   1779 1789 3667#
Z_9. . . . . . . .  C ADDR   0AA4H   R   SEG=MAIN   1736 2000#


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 25 ERROR(S)
